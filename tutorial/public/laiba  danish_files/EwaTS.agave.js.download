'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[9],{1008:function(y,x,a){a.d(x,"a",function(){return b});y=a(0);class c{constructor(){this.title=this.id=this.tabs=null}}Object(y.a)(c,"AddInDataTransferObject",null,[]);class b{constructor(f,r,d){this.Aac=f;this.adh=r;this.bdh=d}get NB(){return this.Aac}get Fuh(){return this.adh}get Guh(){return this.bdh}static QOb(f){return(f=f.G6)?Object.assign(new c,{tabs:f.NB.toArray(),id:f.Fuh,title:f.Guh}):null}}Object(y.a)(b,
"OneLineRibbonExtensibility",null,[])},1029:function(y,x,a){a.d(x,"a",function(){return c});y=a(0);var c;(function(b){b[b.OK=0]="OK";b[b.lql=1]="notReady";b[b.Qrl=2]="storeDisabled";b[b.bjl=3]="invokeFailure";b[b.xrl=4]="serviceDisabled";b[b.jhl=5]="builtinAddinDetails"})(c||(c={}));Object(y.b)("AddinDetailsQueryError",c)},1031:function(y,x,a){a.d(x,"a",function(){return c});a.d(x,"b",function(){return b});const c=f=>{let r=null;switch(f){case 0:r="omex";break;case 1:r="spcatalog";break;case 2:r=
"spapp";break;case 3:r="filesystem";break;case 4:r="exchange";break;case 6:r="registry";break;case 7:r="inmemory";break;case 8:r="uploadfiledevcatalog";break;case 9:r="hardcodedpreinstall";break;case 10:r="excatalog";break;case 16:r="wopicatalog"}return r},b=f=>{let r=-1;switch(f.toLowerCase()){case "omex":r=0;break;case "spcatalog":r=1;break;case "spapp":r=2;break;case "filesystem":r=3;break;case "exchange":r=4;break;case "registry":r=6;break;case "inmemory":r=7;break;case "uploadfiledevcatalog":r=
8;break;case "hardcodedpreinstall":r=9;break;case "excatalog":r=10;break;case "wopicatalog":r=16}return r}},1032:function(y,x,a){a.d(x,"a",function(){return f});var c=a(6),b=a(59);const f=(r,d)=>b.a.Q_d(66,()=>window.OfficeExtension&&!!window.OfficeExtension.WacRuntime,c.AFrameworkApplication.fa.vj("MaxRetriesForLoadingScript",0),r,d)},1091:function(y,x,a){x=a(476);a=a(1427);a=a.kv?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);x(a,{insert:"head",AC:!1});y.exports=a.oH||{}},1094:function(y,x,a){a.d(x,
"a",function(){return c});y=a(0);var c;(function(b){b[b.xFj=0]="myAddins";b[b.qCh=1]="adminManaged";b[b.Pql=2]="popular"})(c||(c={}));Object(y.b)("AddinCollectionType",c)},1095:function(y,x,a){a.d(x,"a",function(){return b});y=a(0);var c=a(12);class b{constructor(){this.Ouf={["tabhome"]:"Ribbon.Home",["tabinsert"]:"Ribbon.Insert",["tabdata"]:"Ribbon.Data",["tabreview"]:"Ribbon.Review",["tabview"]:"Ribbon.View"};this.Luf={["tabpagelayoutexcel"]:["Ribbon.PageLayoutExcel",c.a.instance.ia(1633),c.a.instance.ia(1637)],
["tabformulas"]:["Ribbon.Formulas",c.a.instance.ia(1634),c.a.instance.ia(1638)],["tabdeveloper"]:["Ribbon.Developer",c.a.instance.ia(1635),c.a.instance.ia(1639)],["tabaddins"]:["Ribbon.AddIns",c.a.instance.ia(1636),c.a.instance.ia(1640)]};this.pvc=null}get Hua(){return"SourceControlId"}get QX(){return"Workbook"}get formFactor(){return"DesktopFormFactor"}MNi(){if(!this.pvc){this.pvc={};for(const f of Object.keys(this.Ouf))this.pvc[f]=this.Ouf[f];for(const f of Object.keys(this.Luf))this.pvc[f]=this.Luf[f][0]}}}
Object(y.a)(b,"AddinCommandsStringProvider",null,[347])},1097:function(y,x,a){a.d(x,"a",function(){return c});y=a(0);class c{constructor(){this.f_a=0;this.fua=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.iCc=!1;this.xQf=this.fva=null}}Object(y.a)(c,"AddInCommandsNotificationParameters",null,[])},1099:function(y,x,a){a.d(x,"a",function(){return c});const c=b=>b.ka.Ug(34)},1145:function(y,x,a){a.d(x,"a",function(){return R});y=a(0);var c=a(42),b=a(14),f=a(139),r=a(168),
d=a(17),k=a(475),t=a(23);class m extends Sys.UI.Control{constructor(O,U,K,F){super(document.createElement("div"));this.x2=this.v2=this.UE=this.hRa=this.oQ=this.ACa=this.aEa=null;this.jBb=this.pDa=!1;this.content=this.Ux=null;this.Eca=0;this.Z6e=null;this.H3=0;this.sng=null;this.iX=()=>{this.dismiss();return!0};this.iWe=O;this.jRe=U;this.PZ=K;this.SJ=F;this.Mm=U.ownerDocument;this.GBc=this.hC=this.EBb=!1}get I6(){this.aEa||(this.aEa=this.Mm.createElement("div"),this.aEa.id=this.Jo("WACCalloutOuter"),
this.aEa.className="WACCalloutOuter",this.aEa.setAttribute(k.a.Oj,k.a.GUa),this.aEa.style.width=this.Eca+"px");return this.aEa}get HHb(){if(!this.ACa){this.ACa=this.Mm.createElement("div");this.ACa.id=this.Jo("WACCalloutBeakContainer");this.ACa.className="WACCalloutBeakContainer";var O="CalloutBeakTopFilled_32x16x32";if(5===this.H3||6===this.H3||4===this.H3)O="CalloutBeakBottomFilled_32x16x32";O=r.a(32,16,O,"WACCalloutBeak",!0,"");this.ACa.appendChild(O)}return this.ACa}set HHb(O){this.ACa=O}get a0a(){return this.EBb}get title(){return this.Ux}set title(O){this.Ux!==
O&&(this.Ux=O,this.v2&&(this.v2.innerText=this.Ux))}get hC(){return this.pDa}set hC(O){this.pDa!==O&&(this.pDa=O,this.oQ&&(this.oQ.contains(this.UE)&&!this.pDa?this.oQ.removeChild(this.UE):!this.oQ.contains(this.UE)&&this.pDa&&this.yZe()))}get GBc(){return this.jBb}set GBc(O){this.jBb!==O&&(this.jBb=O,this.oQ&&(this.oQ.contains(this.v2)&&!this.jBb?this.oQ.removeChild(this.v2):!this.oQ.contains(this.v2)&&this.jBb&&this.U_e()))}show(){this.EBb||(this.U1h(),this.lu(),this.jRe.appendChild(this.I6),this.I6.style.display=
"Block",this.qDk(),this.EBb=!0,this.sng&&this.sng())}dismiss(){this.EBb&&(this.Xea(),this.jRe.removeChild(this.I6),this.EBb=!1,this.SJ&&this.SJ())}dispose(){this.dismiss();this.v2=this.UE=this.hRa=this.ACa=this.oQ=this.aEa=null;Sys.Component.prototype.dispose.call(this)}Jo(O){return this.get_element().id+O}U1h(){this.oQ=this.Mm.createElement("div");this.oQ.id=this.Jo("WACCalloutHeader");this.oQ.className="WACCalloutHeader";this.hC&&this.yZe();this.GBc&&this.U_e();this.hRa=this.Mm.createElement("div");
this.hRa.id=this.Jo("WACCalloutContent");this.hRa.className="WACCalloutContent";this.hRa.style.width=190<this.Eca?this.Eca-26+"px":"164px";this.hRa.appendChild(this.content);this.I6.appendChild(this.HHb);this.I6.appendChild(this.oQ);this.I6.appendChild(this.hRa)}yZe(){this.UE=this.Mm.createElement("a");this.UE.className="WACCalloutCloseAnchor";this.UE.id=this.Jo("WACCalloutCloseAnchor");this.UE.href="#";this.oQ.appendChild(this.UE);const O=r.a(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",
!0,Object(t.a)("DialogClose"));this.UE.appendChild(O)}U_e(){this.v2=this.Mm.createElement("div");this.v2.className="WACCalloutTitle UIFontBold";this.v2.style.width=190<this.Eca?this.Eca-30+"px":"160px";this.v2.id=this.Jo("WACCalloutTitle");this.v2.innerText=this.title;this.oQ.contains(this.UE)?this.oQ.insertBefore(this.v2,this.UE):this.oQ.appendChild(this.v2)}qDk(){var O=this.iWe;let U;if(1===this.H3){var K=this.Z6e.y+16;U=-16}else 2===this.H3||3===this.H3||0===this.H3?(K=O.y+O.height+15,U=-15):(K=
O.y-this.I6.clientHeight-15-2,U=this.I6.clientHeight-1);this.I6.style.top=K+"px";this.HHb.style.top=U+"px";1===this.H3?(O=this.Z6e.x-16,this.I6.style.left="50%",this.I6.style.marginLeft=-this.Eca/2+"px",K=Sys.UI.DomElement.getBounds(this.I6),this.HHb.style.left=O-K.x+"px"):(K=O.x+this.iWe.width/2,2===this.H3||5===this.H3?(O=20,K-=36):0===this.H3||4===this.H3?(O=this.Eca/2-16,K-=this.Eca/2):(O=this.Eca-20-32,K=K-this.Eca+36),this.I6.style.left=K+"px",this.HHb.style.left=O+"px")}lu(){this.hC&&!this.x2&&
(this.x2=this.iX,this.PZ.ya(d.a.click,this.UE,this.x2,null))}Xea(){this.hC&&this.x2&&(this.PZ.Na(d.a.click,this.UE,this.x2),this.x2=null)}}Object(y.a)(m,"Callout",Sys.UI.Control,[439]);class e extends m{constructor(O,U,K,F,I,P){super(O,K,I.X7,void 0===P?null:P);this.mPe=0;this.fj=()=>{this.dismiss();return!0};this.Eca=this.UNi(F);this.acb=U;this.vm=I;this.FWk=7;this.kt=this.acb.ownerDocument.createElement("div");this.kt.className="ModalCalloutControlOverlay";this.kt.tabIndex=0;this.acb.insertBefore(this.kt,
this.acb.firstChild)}show(){this.a0a||(this.vm.iQc(),this.vm.l_(!1),this.kt.style.zIndex=String(this.vm.Hda),super.show(),this.fq(),this.mPe=window.setTimeout(Object(f.a)(this,this.dismiss,"dismiss"),1E3*this.FWk))}dismiss(){this.a0a&&(this.vm.rX(!1),this.$o(),this.acb&&this.acb.contains(this.kt)&&this.acb.removeChild(this.kt),super.dismiss(),window.clearTimeout(this.mPe))}fq(){this.vm.iFa(Object(f.a)(this,this.dismiss,"dismiss"));this.vm.kJ.ya(d.a.click,this.kt,this.fj)}$o(){this.vm.mtb(Object(f.a)(this,
this.dismiss,"dismiss"));this.vm.kJ.Na(d.a.click,this.kt,this.fj)}UNi(O){let U=0;switch(O){case 0:U=190;break;case 1:U=250;break;case 2:U=300;break;case 3:U=360}return U}}Object(y.a)(e,"ModalCallout",m,[]);var w=a(528),l=a(181);class u extends e{constructor(O,U,K,F,I,P){super(O,U,K,F,I,void 0===P?null:P);this.zfc=null}show(){if(!this.a0a){const O=Object.assign(new w.a,{onShow:()=>{e.prototype.show.call(this)}});l.a.hK().then(U=>{const K=U.externalNotification();this.zfc=U.addNotification(K,O);return null},
U=>{b.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",U);return null})}}dismiss(){this.a0a&&this.zfc&&(l.a.hK().then(O=>{O.removeNotification(this.zfc);return this.zfc=null},O=>{b.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",O);return null}),super.dismiss())}}Object(y.a)(u,"ReactManagedModalCallout",e,[]);var n=a(6);class v{static G3h(O,U,K){var F=void 0===F?null:F;return n.AFrameworkApplication.ra.$d.cY?new u(O,U,K,3,n.AFrameworkApplication.ra,
F):new e(O,U,K,3,n.AFrameworkApplication.ra,F)}}Object(y.a)(v,"ModalCalloutControlFactory",null,[]);var B=a(85),z=a(1092),C=a(686),D=a(1093),J=a(187),W=a(67),N=a(60),M=a(1008),Q=a(890);class R{static get Idb(){return R.u8||(R.u8=c.a.instance.mo("Common.Utils.IAriaNotifier"))}static xgf(O,U,K,F){R.hT&&R.hT.a0a&&R.hT.dismiss();R.hT=v.G3h(U,O,O);R.hT.content=K;Q.b(F)||(R.hT.title=F,R.hT.GBc=!0);O=new Sys.UI.Bounds(0,0,W.a.RQb(),W.a.QQb());R.hT.H3=R.qEi(O,U,R.hT.Eca);R.hT.show();R.Idb&&R.Idb.xAa(K.innerText,
!0)}static swd(O,U,K,F){F=void 0===F?null:F;l.a.hK().then(I=>{let P=null;R.BDb&&(I.removeNotification(R.BDb),R.BDb=null);const Y=I.callout(Object.assign(new z.a,{target:O,title:U,content:K,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new D.a,{onDismiss:()=>{I.removeNotification(P)},directionalHint:null!=F?F:null})})),ea=Object.assign(new w.a,{expirationOptions:Object.assign(new C.a,{displayTimeoutSeconds:7,onExpire:()=>{I.removeNotification(R.BDb)}})});
P=R.BDb=I.addNotification(Y,ea);return null},I=>{b.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",I);return null})}static Ope(O,U){U=void 0===U?null:U;R.hT&&R.hT.a0a&&R.hT.dismiss();const K=new J.a;K.VOa=!1;K.Bh=0;K.jG(B.a.Xsj,Object(t.a)("DialogError"),Q.b(O)?R.aDf():O,U)}static Ppe(O){R.hT&&R.hT.a0a&&R.hT.dismiss();b.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",O.errorCode));const U=Q.b(O.description)?R.aDf():O.description,
K=new J.a;let F=null;O.fua?(K.Bh=1,K.Yh(1,O.buttonText),K.mia(1)):K.Bh=0;F=I=>{1===I?O.fua():O.fva&&O.fva()};K.VOa=!1;0===O.f_a?K.jG(O.errorCode,O.title?O.title:Object(t.a)("DialogError"),U,F):1===O.f_a?K.QV(O.title?O.title:Object(t.a)("DialogWarning"),U,F):K.XAa(O.title?O.title:Object(t.a)("DialogInfo"),U,F)}static qEi(O,U,K){let F=4;const I=O.x+O.width-U.x-U.width;U.x-O.x+U.width/2<=K/2?F=5:I+U.width/2<=K/2&&(F=6);return F}static IKk(O,U,K,F){F=void 0===F?!1:F;(U=M.a.QOb(U))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&
appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(U,I=>{I&&(F||R.swd(I,K,O,5))})}static JKk(O,U,K){K=void 0===K?!1:K;R.IKk(U.startedNode?U.startedNode.description:String.format(Object(t.a)("NewAddInLoadedContent"),O),U,U.startedNode?U.startedNode.title:String.format(Object(t.a)("NewAddInLoadedTitle"),O),K)}static HKk(O,U,K,F){if(R.v4g)O=String.format(Object(t.a)("ErrorLoadingAddInsContentOuterString"),String.format(Object(t.a)("ErrorLoadingAddInsContentInnerString"),K,F,Object(t.a)("InsertionDialogRefresh"))),
R.swd(U,Object(t.a)("ErrorLoadingAddInsTitle"),O,1);else{U=N.a.wv(U);var I=Object(t.a)("ErrorLoadingAddInsContentOuterString").split("{0}"),P=document.createElement("span");P.innerText=I[0];var Y=document.createElement("span");Y.innerText=String.format(Object(t.a)("ErrorLoadingAddInsContentInnerString"),K,F,Object(t.a)("InsertionDialogRefresh"));Y.className="UIFontBold";K=document.createElement("span");K.innerText=I[1];F=document.createElement("div");Sys.UI.DomElement.addCssClass(F,"ModalCalloutControl");
F.appendChild(P);F.appendChild(Y);F.appendChild(K);R.xgf(O,U,F,Object(t.a)("ErrorLoadingAddInsTitle"))}}static rMk(O,U,K,F){R.v4g?R.swd(U,K,F):(U=N.a.wv(U),R.xgf(O,U,R.HMh(F),K))}static HMh(O){const U=document.createElement("div");Sys.UI.DomElement.addCssClass(U,"ModalCalloutControl");U.innerText=O;return U}static aDf(){return Object(t.a)("InternalError")+" "+Object(t.a)("InternalError_Directive")}static get v4g(){return n.AFrameworkApplication.ra.$d.Aq&&n.AFrameworkApplication.ra.$d.cY}}R.hT=null;
R.BDb=null;R.u8=null;Object(y.a)(R,"AddInCommandsNotificationFactory",null,[])},1151:function(y,x,a){a.r(x);a.d(x,"DynamicRibbon",function(){return n});y=a(0);var c=a(14),b=a(180),f=a(125),r=a(908),d=a(928),k=a(386);class t{constructor(v,B,z,C){this.Ku=!1;this._id=v;this.tG=B;this.Tca=z;this.uj=C}get enabled(){return this.Ku}set enabled(v){const {DynamicRibbon:B}=a(1151);var z=this.uj.OwnerAddinStoreType?this.uj.OwnerAddinStoreType:this.uj.PrimaryMarketplace.MarketplaceType;const C=this.uj.PrimaryMarketplace.MarketplaceRef,
D=this.uj.AssetMarketplace?this.uj.AssetMarketplace.SolutionId:null,J=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.tG,z,null,null,null,C);z={["addinSolutionId"]:J,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.uj.OwnerAddinSolutionId,z,D,null,null,C),["ownerAddinStoreType"]:z,["ribbonControlType"]:"Button",["toggle"]:v};b.a.sendTelemetryEvent(Object.assign(new k.a,{name:B.$Zc+"ControlUpdate",dataFields:f.a.rn(z)}));this.Ku=v;this.Tca.xU(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:1,
["SolutionId"]:this.tG,["PrivacyCompliantSolutionId"]:J,["SourceControlId"]:this.id,["MethodData"]:this.Ku})}get id(){return this._id}get label(){return null}setEnabled(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonButton"}invokePropertyGet(v){switch(v){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);}invokePropertyGetAsync(v){v=this.invokePropertyGet(v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)}invokePropertySet(v,
B){switch(v){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);}invokePropertySetAsync(v,B){this.invokePropertySet(v,B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(v,B){switch(v){case 5:return this.Lzk(B);case 1:return this.zQa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);}invokeMethodAsync(v,B){v=this.invokeMethod(v,
B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)}Lzk(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"boolean");this.setEnabled(v);return null}zQa(){this._OnAccess();return null}}Object(y.a)(t,"RibbonButton",null,[]);class m{constructor(v,B,z,C){this._id=v;this.tG=B;this.Tca=z;this.uj=C}get id(){return this._id}setVisibility(v){const {DynamicRibbon:B}=a(1151),z=this.uj.OwnerAddinStoreType?this.uj.OwnerAddinStoreType:this.uj.PrimaryMarketplace.MarketplaceType;
var C=this.uj.PrimaryMarketplace.MarketplaceRef;const D=this.uj.AssetMarketplace?this.uj.AssetMarketplace.SolutionId:null,J=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.tG,z,D,null,null,C);C={["addinSolutionId"]:J,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.uj.OwnerAddinSolutionId,z,D,null,null,C),["ownerAddinStoreType"]:z,["ribbonControlType"]:"Tab",["toggle"]:v};b.a.sendTelemetryEvent(Object.assign(new k.a,{name:B.$Zc+"ControlUpdate",dataFields:f.a.rn(C)}));this.Tca.xU(-1014260128,
{["DynamicAddinCommandsMethodDispatchId"]:2,["SolutionId"]:this.tG,["PrivacyCompliantSolutionId"]:J,["StoreType"]:z,["SourceControlId"]:this.id,["MethodData"]:v})}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonTab"}invokePropertyGet(v){switch(v){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);}invokePropertyGetAsync(v){v=this.invokePropertyGet(v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)}invokePropertySet(v){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);
}invokePropertySetAsync(v,B){this.invokePropertySet(v,B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(v,B){switch(v){case 3:return this.YDk(B);case 1:return this.zQa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);}invokeMethodAsync(v,B){v=this.invokeMethod(v,B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)}YDk(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"boolean");this.setVisibility(v);
return null}zQa(){this._OnAccess();return null}}Object(y.a)(m,"RibbonTab",null,[]);var e=a(1242),w=a(175),l=a(1551),u;(function(v){v[v.static=0]="static";v[v.dynamic=1]="dynamic"})(u||(u={}));Object(y.b)("RibbonExtensionGenerateType",u);class n{constructor(v,B,z,C,D){this.tG=v;this.Ox=z;this.Tca=C;this.uj=D;this.Mzb=this.Ox.wl;this.YH=this.Mzb.getOsfControl(B);this.xlh=this.YH.getManifest()}get buttons(){return null}executeRequestCreate(v){try{var B=this.uj.OwnerAddinStoreType?this.uj.OwnerAddinStoreType:
this.uj.PrimaryMarketplace.MarketplaceType;const C=this.uj.PrimaryMarketplace.MarketplaceRef,D=this.uj.AssetMarketplace?this.uj.AssetMarketplace.SolutionId:null;var z=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.tG,B,D,null,null,C);const J={["addinSolutionId"]:z,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.uj.OwnerAddinSolutionId,B,D,null,null,C),["ownerAddinStoreType"]:this.uj.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};b.a.sendTelemetryEvent(Object.assign(new k.a,
{name:n.$Zc+"ExecuteRequestCreate",dataFields:f.a.rn(J)}));const W=w.a.Gp(v);v={};B={};B[r.a.jXa]=this.YH;B[r.a.kXa]=W;B[r.a.EAd]=this.uj;v[r.a.IMb]=3;v[r.a.efa]=this.tG;v[r.a.Rtc]=z;v[r.a.dfa]=B;this.Tca.xU(-1014260128,v);let N=n.sxc("ExecuteRequestCreate",!0,"");c.ULS.sendTraceTag(538572826,0,50,N)}catch(C){z=n.sxc("ExecuteRequestCreate",!1,C.toString()),c.ULS.sendTraceTag(538572825,0,50,z)}return null}executeRequestUpdate(v){try{var B=this.uj.OwnerAddinStoreType?this.uj.OwnerAddinStoreType:this.uj.PrimaryMarketplace.MarketplaceType;
const C=this.uj.PrimaryMarketplace.MarketplaceRef,D=this.uj.AssetMarketplace?this.uj.AssetMarketplace.SolutionId:null;var z=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.tG,B,D,null,null,C);const J={["addinSolutionId"]:z,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.uj.OwnerAddinSolutionId,B,D,null,null,C),["ownerAddinStoreType"]:this.uj.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};b.a.sendTelemetryEvent(Object.assign(new k.a,{name:n.$Zc+"ExecuteRequestUpdate",
dataFields:f.a.rn(J)}));const W=w.a.Gp(v);v={};B={};B[r.a.jXa]=this.YH;B[r.a.kXa]=W;B[r.a.EAd]=this.uj;v[r.a.IMb]=3;v[r.a.efa]=this.tG;v[r.a.Rtc]=z;v[r.a.dfa]=B;this.Tca.xU(-1014260128,v);let N=n.sxc("ExecuteRequestUpdate",!0,"");c.ULS.sendTraceTag(538572824,0,50,N)}catch(C){z=n.sxc("ExecuteRequestUpdate",!1,C.toString()),c.ULS.sendTraceTag(538572823,0,50,z)}return null}getButton(v){let B=null;if(!this.vVf())return this.Agf();if(v&&0<v.length){if(!this.nbf(v))return this.Sgf(v);B=new t(v,this.tG,
this.Tca,this.uj)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}getTab(v){let B=null;if(!this.vVf())return this.Agf();if(this.YH.getOwnerAddinControlRecreated())return this.S2h();if(v&&0<v.length){if(!this.nbf(v))return this.Sgf(v);B=new m(v,this.tG,this.Tca,this.uj)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.DynamicRibbon"}invokePropertyGet(v){switch(v){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);
}invokePropertyGetAsync(v){v=this.invokePropertyGet(v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)}invokePropertySet(v){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);}invokePropertySetAsync(v,B){this.invokePropertySet(v,B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(v){switch(v){case 1:return this.zQa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);}invokeMethodAsync(v,B){switch(v){case 7:return this.jri(B);
case 6:return this.kri(B);case 3:return this.UDi(B);case 5:return this.QVi(B)}v=this.invokeMethod(v,B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)}jri(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"string");return this.executeRequestCreate(v)}kri(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"string");return this.executeRequestUpdate(v)}UDi(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"string");return this.getButton(v)}QVi(v){v=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"string");return this.getTab(v)}zQa(){this._OnAccess();return null}Sgf(v){return e.a(d.a.kZh,w.a.ia(1771)+v)}Agf(){return e.a(d.a.Lqk,w.a.ia(1767))}S2h(){return e.a(d.a.hostRestartNeeded,w.a.ia(1772))}vVf(){var v=this.YH.getSharedRuntimeId();v=!!v&&0<v.length;c.ULS.sendTraceTag(538572822,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",v));return v}nbf(v){const B=this.xlh.getRibbonExtensionControlMap();return v in
B||this.mSh(v)}mSh(v){var B=this.Qui();if(B){B=B.hof;for(const z of B.tabs){if(z.id===v)return!0;for(const C of z.groups)for(const D of C.controls){if(D.id===v)return!0;if("Menu"===D.type){B=D;for(const J of B.items)if(J.id===v)return!0}}}}return!1}Qui(){return l.a.getInstance().Iva(this.uj.PrimaryMarketplace.MarketplaceType,this.uj.PrimaryMarketplace.SolutionId,u.dynamic)}static sxc(v,B,z){const C={};C.methodName="DynamicRibbon."+v;C.result=B?"Succeeded":"Failed";C.message=z;return w.a.li(C)}}n.$Zc=
"Office.Online.Extensibility.Ribbon.";Object(y.a)(n,"DynamicRibbon",null,[])},1233:function(y,x,a){a.d(x,"a",function(){return c});const c=(b,f)=>{let r=!1;b&&(b=f.osfControl,(f=b.getManifest())&&f.getSharedRuntimeForCustomFunctions("Workbook")&&!b.getIsUpgrading()&&(r=!0));return r}},1238:function(y,x,a){a.d(x,"a",function(){return c});y=a(0);class c{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.Nta=this.xPa=this.QJd=this.OQb=this.qJa=this.xte=null}}Object(y.a)(c,"AppsForOfficeOauthResult",
null,[])},1239:function(y,x,a){a.r(x);a.d(x,"WebExtensionView",function(){return C});y=a(0);var c=a(96),b=a(158);x=a(371);var f=a(68),r=a(19),d=a(270),k=a(55),t=a(283),m=a(1099),e=a(454),w=a(77),l=a(63),u=a(16),n=a(74),v=a(97),B=a(5),z=a(1091);a.n(z);Object(v.b)(B.Fg,{yk:"singleton"})(D=>No(function*(){const J=yield v.a.resolve(B.Lb,D);return new C(J,new e.FloatingObjectBlockManager(J,J.ea,J.pa.JG,3,0),J.ll.appendChild(J.ll.ownerDocument.createElement("div")))}));class C extends x.a{constructor(D,
J,W){super(W,D);this.tJa=this.hashCode=null;this.Xpc=!1;this.Ww=(N,M)=>{M.Ti.hash===this.hashCode&&this.tJa&&Object(b.a)(a(922).DdaFacade,this.$.ka.Ug(35)).PLk(this.tJa.InstanceId)};this.onBlockCacheItemChanged=(N,M)=>{switch(M.Ti.block.state){case 1:case 3:case 5:this.HAa(M)}};this.Xo=()=>{this.YQc(!0)};this.onActiveItemChanging=(N,M)=>{this.isVisible&&this.z8a(M.mB);this.clearCache()};this.onActiveItemChanged=(N,M)=>{this.DUg(M.na,!!M.mB)};this.XI=()=>{this.$.ea.EMa()};this.f9a=J;this.domElement.classList.add(f.rb);
this.domElement.classList.add(r.a.YG);W.tabIndex=0;this.DUg(this.$.na,!1);this.Wi.Aa("mousedown",this.XI);this.Wi.Aa("contextmenu",N=>{n.g(N)});this.$.sa.QW(this.onActiveItemChanging);this.$.Gh.QW(this.onActiveItemChanging);this.$.Gh.Qm(this.onActiveItemChanged);this.$.sa.Qm(this.onActiveItemChanged);this.za.Vy(this.onBlockCacheItemChanged);this.za.wT(this.Ww);this.za.Uy(this.Xo);this.Mz(this.hqb)}get za(){return this.f9a}dispose(){this.$&&(this.$.sa.t1(this.onActiveItemChanging),this.$.Gh.t1(this.onActiveItemChanging),
this.$.Gh.hn(this.onActiveItemChanged),this.$.sa.hn(this.onActiveItemChanged));this.f9a&&(this.f9a.Fy(this.onBlockCacheItemChanged),this.f9a.rV(this.Ww),this.f9a.Ix(this.Xo));this.xE(this.hqb);this.clearCache();c.a.Ng(this.f9a);this.f9a=null;u.DOMElementExtensions.Km(this.domElement);super.dispose()}eLg(D){u.DOMElementExtensions.Km(u.DOMElementExtensions.getElementById(this.domElement,D.id));this.domElement.appendChild(D)}RSb(){if(this.tJa&&!this.Xpc){var D=Object(b.a)(a(922).DdaFacade,t.a(this.$)).Er(this.tJa.InstanceId);
D&&(D.resize(this.tJa.Width,this.tJa.Height),D.Aa(this.domElement),D.showHide(!0),this.Xpc=!0)}}iWb(){return!0}HAa(D){this.tJa=D.Ti.block.Fj;this.Xpc=!1;this.RSb()}z8a(D){this.$.ea.J5&&D&&(D.xA||(D.xA=new d.a),D.xA.Xm=new k.a(this.domElement.scrollLeft,this.domElement.scrollTop),D.xA.c1b=20)}clearCache(){this.za.btb(this.hashCode,"ClearCacheWebExtensionView");this.tJa=this.hashCode=null;this.Xpc=!1}DUg(D,J){if(this.isVisible=!!D&&w.n(D))this.hashCode=this.za.aFa(D,l.a.Jyd,this.hashCode,!1),this.JWc(J)}static yHb(D){if(!m.a(D)){const J=
D.ll;D.ka.ph(34,new C(D,new e.FloatingObjectBlockManager(D,D.ea,D.pa.JG,3,0),J.appendChild(J.ownerDocument.createElement("div"))))}}}Object(y.a)(C,"WebExtensionView",x.a,[341,1,2]);String(z);window.___1708742439215_closurehack=z},1242:function(y,x,a){a.d(x,"a",function(){return c});const c=(b,f)=>OfficeExtension.WacRuntime.Utility.createPromise((r,d)=>{d(OfficeExtension.WacRuntime.Utility.createRichApiException(b,f))})},1354:function(y,x,a){a.r(x);a.d(x,"CustomFunctionsInstaller",function(){return bb});
y=a(0);var c=a(2),b=a(14),f=a(6),r=a(182),d=a(208),k=a(158),t=a(212),m=a(62),e=a(40),w=a(255),l=a(122),u=a(614);class n{constructor(ra){ra=ra.split("|");this.tG=ra[1];this.did=ra[2];this.rse=ra[3]}get solutionId(){return this.tG}get solutionVersion(){return this.did}get needToRestoreManifest(){return this.rse===OSF.StoreTypeEnum.Registry.toString()}}Object(y.a)(n,"AddinStoreInfo",null,[]);class v{}Object(y.a)(v,"CustomFunctionRegistrationInfos",null,[]);var B=a(221),z=a(78);const C=(ra,Da,oa)=>D(ra,
Da,B.a.none,z.a.current,oa),D=(ra,Da,oa,Ha,ka)=>{oa=ra.continueWith(()=>{Da(ra)},3,oa,Ha);oa.continueWith(()=>{b.ULS.sendTraceTag(537163463,0,10,ka)},4);return oa},J=(ra,Da,oa)=>W(ra,Da,B.a.none,z.a.current,oa),W=(ra,Da,oa,Ha,ka)=>{oa=ra.RA(()=>Da(ra),3,oa,Ha);oa.continueWith(()=>{b.ULS.sendTraceTag(537163462,0,10,ka)},4);return e.TaskExtensions.K0c(oa)},N=(ra,Da,oa)=>M(ra,Da,B.a.none,z.a.current,oa),M=(ra,Da,oa,Ha,ka)=>{oa=ra.RA(()=>Da(ra),3,oa,Ha);oa.continueWith(()=>{b.ULS.sendTraceTag(537163461,
0,10,ka)},4);return oa},Q=(ra,Da,oa)=>R(ra,Da,B.a.none,z.a.current,oa),R=(ra,Da,oa,Ha,ka)=>{oa=ra.RA(()=>Da(ra),3,oa,Ha);oa.continueWith(()=>{b.ULS.sendTraceTag(537163460,0,10,ka)},4);return e.TaskExtensions.K0c(oa)},O=(ra,Da,oa)=>U(ra,Da,B.a.none,z.a.current,oa),U=(ra,Da,oa,Ha,ka)=>{oa=ra.continueWith(()=>{Da(ra)},3,oa,Ha);oa.continueWith(()=>{b.ULS.sendTraceTag(537163459,0,10,ka)},4);return oa},K=(ra,Da)=>{N(a(1354).CustomFunctionsInstaller.GFf("CustomFunctionsRuntimeLogging"),oa=>{if(oa.result&&
window.console)switch(oa=F(ra.severity)+" "+ra.message+Da,ra.severity){case 2:window.console.log&&window.console.log(oa);break;case 0:window.console.info&&window.console.info(oa);break;case 1:window.console.error&&window.console.error(oa)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")},F=ra=>{switch(ra){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};var I=a(1233);class P{}Object(y.a)(P,"InstallationInfo",
null,[]);class Y{}Object(y.a)(Y,"UninstallationInfo",null,[]);var ea=a(32),Ba=a(86),Fa=a(39),za=a(35),xa=a(1),fa=a(27),V=a(262),ba=a(1016),la=a(66);class Ta{constructor(ra,Da){this.uhd=ra;this._message=Da}get severity(){return this.uhd}get message(){return this._message}}Object(y.a)(Ta,"CustomFunctionLog",null,[]);var Ea=a(5),sa=a(93),Ya=a(97);class bb{constructor(ra,Da,oa){this.Jna=!1;this.UO={};this.$=ra;this.Ys=Da;this.ARd().nAa();this.indexedDB=oa;this.indexedDB.jl()&&(this.Jna=!0,this.indexedDB.initialize(bb.rlb,
bb.slb))}get C5(){return this.Ys.C5}ySf(ra,Da,oa,Ha){if(Ha.invariantNamespace)for(let ka=0;ka<Ha.invariantNamespace.length;++ka){const wa=Ha.invariantNamespace.charAt(ka);if("."!==wa&&"_"!==wa&&"a">wa&&"z"<wa&&"A">wa&&"Z"<wa&&"0">wa&&"9"<wa)throw b.ULS.sendTraceTag(537163552,0,10,`CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='${wa}', Position=${ka}.`),Error.create("InvariantNamespace validation failed");}return J(this.TNh(oa,Ha.manifest),()=>J(this.Ade(ra),
ka=>{let wa=ka.result;return(null===wa||void 0===wa?0:wa.isDynamicMetadata)?this.Fee(ra,Da,wa,!1,!1,!1):J(this.Hbl(ra,Da,Ha),Za=>{wa=new P;wa.addinId=oa;wa.locale=Ha.locale;wa.addinInvariantNamespace=Ha.invariantNamespace;wa.addinNamespace=Ha.namespace;wa.addinTitle=Ha.title;wa.isXllCompatible=Ha.isXllCompatible;wa.metadataContent=JSON.stringify(JSON.parse(Za.result));return this.Fee(ra,Da,wa,!1,bb.msi(Ha.osfControl.getStoreType()),I.a(this.$,Ha))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},
"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed"),"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")}zSf(ra,Da,oa,Ha){if(!bb.WXd(oa))throw b.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Error.create("Invalid Metadata JSON");return J(this.Ade(ra),ka=>{ka=ka.result;if(!ka&&(ka=Fa.a.gj(this.C5,ra),!ka))throw b.ULS.sendTraceTag(537163550,0,10,`CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId ${Telemetry.PrivacyRules.GetPrivacyCompliantId(ra,
Da,null)} hasn't been installed yet.`),Error.create("Customfunctions dynamic registration failed");ka.metadataContent=JSON.stringify(JSON.parse(oa));ka.isDynamicMetadata=!0;return this.Fee(ra,Da,ka,!0,!0,Ha)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")}B0g(ra,Da){this.Ys.tva();const oa=Object(c.a)(new Y,{solutionId:ra}),Ha=`CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(ra,
Da,null)}.`;return J(this.rfe(ra),()=>J(this.zfe(ra),()=>this.cwe(this.Ys,ra,Da,oa),"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed"),Ha)}Hbl(ra,Da,oa){const Ha=new r.a;OSF.OUtil.xhrGet(oa.metadataUrl,ka=>{ka?Ha.setResult(ka):Ha.setException(Error.create("Invalid manifest"))},ka=>{b.ULS.sendTraceTag(537163548,0,10,`CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(ra,
Da,null)}. ErrorCode: ${ka}.`);Ha.xC()});return Ha.task}ARd(){return J(this.nRc(),ra=>{const Da=ra.result;if(!Da.length)return la.Task.Va(!0);b.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");ra=new d.a;const oa=[];for(let Ha=0;Ha<Da.length;Ha++){const ka=Object(k.a)(String,Da[Ha]);ra.add(N(this.Ade(ka),wa=>{if(wa=wa.result){const Za=Fa.a.gj(this.UO,wa.addinId);Za&&Za===wa.metadataContent||(this.UO[wa.addinId]=
wa.metadataContent,this.C5[ka]=wa,oa.push(wa))}return!0},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"))}return Q(la.Task.WhenAllEnumerable(ra),()=>{if(oa.length){const Ha=new v;Ha.registrationInfos=oa;return this.Bmc(this.Ys,Da,Ha)}b.ULS.sendTraceTag(537163546,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");return la.Task.Va(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},
"CustomFunctionsInstaller::InstallFromCacheAsync failed")}ASf(){var ra=new r.a;const Da=[],oa=[];Object.keys(this.C5).forEach(Ha=>{Ha=Object(k.a)(String,Ha);const ka=Fa.a.gj(this.C5,Ha);Da.push(ka);oa.push(Ha)});if(!oa.length)return ra.setResult(!0),ra.task;ra=Object(c.a)(new v,{registrationInfos:Da});return this.Bmc(this.Ys,oa,ra)}nRc(){return N(this.lKd(u.a.$cb),ra=>{ra=ra.result;return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(ra||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(ra||
"[]"):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")}j7g(ra){return this.Eme(u.a.$cb,Sys.Serialization.JavaScriptSerializer.serialize(ra))}Ade(ra){return J(this.lKd(u.a.Rjb(ra)),Da=>{Da=Da.result||"";return 0<Da.length?la.Task.Va(Sys.Serialization.JavaScriptSerializer.deserialize(Da,!0)):la.Task.Va(null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")}xbl(ra,Da){return J(this.bqf(ra),
()=>J(this.Eme(u.a.Rjb(ra),Sys.Serialization.JavaScriptSerializer.serialize(Da)),()=>bb.Fme(u.a.yOd,"true"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")}rfe(ra){return J(this.nAg(ra),()=>J(this.KAg(u.a.Rjb(ra)),()=>J(this.nRc(),Da=>Da.result.length?la.Task.Va(!0):bb.Fme(u.a.yOd,"false"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed"),
"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}Jxg(ra){return this.lKd(u.a.Qjb(ra))}g7g(ra,Da){return J(this.bqf(ra),()=>this.Eme(u.a.Qjb(ra),Da),"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")}zfe(ra){return J(this.nAg(ra),()=>this.KAg(u.a.Qjb(ra)),"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}bqf(ra){return J(this.nRc(),
Da=>{Da=Da.result;const oa=ra.toLowerCase();if(Da.includes(oa))return la.Task.Va(!0);Da.push(oa);return this.j7g(Da)},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}nAg(ra){return J(this.nRc(),Da=>{Da=Da.result;const oa=ra.toLowerCase();return Da.includes(oa)?(Da.splice(Array.indexOf(Da,oa),1),this.j7g(Da)):la.Task.Va(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}TNh(ra,
Da){if(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return ra=new OSF.AddinIdInfo(ra),ra.needToRestoreManifest()?this.g7g(ra.getSolutionId(),Da):la.Task.Va(!0);ra=new n(ra);return ra.needToRestoreManifest?this.g7g(ra.solutionId,Da):la.Task.Va(!0)}hqk(ra){if(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){const oa=new OSF.AddinIdInfo(ra);return oa.needToRestoreManifest()?N(this.Jxg(oa.getSolutionId()),Ha=>{(Ha=Ha.result)&&
OSF.OsfManifestManager.cacheManifestFromXml(oa.getSolutionId(),oa.getSolutionVersion(),Ha,this.$.ua.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):la.Task.Va(!0)}const Da=new n(ra);return Da.needToRestoreManifest?N(this.Jxg(Da.solutionId),oa=>{(oa=oa.result)&&OSF.OsfManifestManager.cacheManifestFromXml(Da.solutionId,Da.solutionVersion,oa,this.$.ua.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):
la.Task.Va(!0)}KAg(ra){return this.Jna?this.indexedDB.bzd(ra):bb.jhk(ra)}Eme(ra,Da){return this.Jna?this.indexedDB.W5a(new ba.a(ra,Da)):bb.Fme(ra,Da)}lKd(ra){return this.Jna?this.indexedDB.MYa(ra):bb.GFf(ra)}Fee(ra,Da,oa,Ha,ka,wa){const Za=`CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(ra,Da,null)}.`;return e.TaskExtensions.K0c(N(this.Gee(this.Ys,ra,Da,oa,!1,Ha,wa),()=>ka?this.xbl(ra,oa):la.Task.Va(!0),
Za))}Gee(ra,Da,oa,Ha,ka,wa,Za){if(!wa&&(wa=Fa.a.gj(this.UO,Ha.addinId))&&wa===Ha.metadataContent)return la.Task.Va(!0);this.UO[Ha.addinId]=Ha.metadataContent;this.C5[Da]=Ha;Za||ra.K2b(Da);ra.tva();return J(this.oek(Da,oa,Ha),()=>this.bce(Ha.addinId,ka),"Failed to register functions for customfunction addin")}oek(ra,Da,oa){const Ha=new r.a,ka=this.eVa(oa);return this.rfa(wa=>{K(bb.tLb,ra);(wa=wa.Result)&&204===wa.ResponseStatusCode?Ha.setResult(!0):(delete this.UO[oa.addinId],delete this.C5[ra],C(this.rfe(ra),
()=>{C(this.zfe(ra),()=>{this.ZQg()},"Failed to show customfunctions installation error info")},`CustomFunctionsInstaller: Failed to register Custom Functions for solution: ${ra}. Received status code ${wa?wa.ResponseStatusCode.toString():"Unknown"}.`),Ha.setResult(!1))},wa=>{wa=l.a.Qj(wa.data);b.ULS.sendTraceTag(537163544,0,10,`CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(ra,Da,null)}. Errors: ${za.a.Kh(wa)}.`);
K(bb.sLb,ra);delete this.UO[oa.addinId];delete this.C5[ra];Ha.setResult(!1)},ka,Ha,!0)}Bmc(ra,Da,oa){const Ha=new r.a,ka=ea.a.Tg.qk.m;Da.forEach(Za=>{Za=Object(k.a)(String,Za);ra.Taf(Za)});ra.tva();const wa=this.ird(oa);return this.rfa(Za=>{K(bb.tLb,Sys.Serialization.JavaScriptSerializer.serialize(Da));Za=Za.Result;let ab=!0,db=[];if(null===Za||void 0===Za?0:Za.ResponseBody){var mb=Sys.Serialization.JavaScriptSerializer.deserialize(Za.ResponseBody.toString());Array.isArray(mb.value)&&(db=mb.value)}mb=
new d.a;for(let Ia=0;Ia<db.length;Ia++)if(!db[Ia]){ab=!1;const pa=`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code ${Za.ResponseStatusCode}.`;mb.add(J(this.rfe(Da[Ia]),()=>{delete this.UO[oa.registrationInfos[Ia].addinId];delete this.C5[Da[Ia]];return this.zfe(Da[Ia])},pa))}O(la.Task.WhenAllEnumerable(mb),()=>{C(this.bce("",!1),()=>{b.ULS.sendTraceTag(537163542,0,50,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes ${ea.a.Tg.qk.m-
ka} Millisecond.`);ab?Ha.setResult(ab):O(this.ZQg(),()=>{Ha.setResult(ab)},"Failed to show customfunctions installation error info")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},Za=>{Za=l.a.Qj(Za.data);b.ULS.sendTraceTag(537163541,0,10,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: ${za.a.Kh(Za)}.`);
K(bb.sLb,Sys.Serialization.JavaScriptSerializer.serialize(Da));for(Za=0;Za<oa.registrationInfos.length;Za++)delete this.UO[oa.registrationInfos[Za].addinId],delete this.C5[Da[Za]];Ha.setResult(!1)},wa,Ha,!0)}cwe(ra,Da,oa,Ha){return J(this.P1k(ra,Da,oa,Ha),()=>this.bce(Ha.solutionId,!1),"Failed to unregister functions for customfunction addin")}P1k(ra,Da,oa,Ha){const ka=new r.a;ra.K2b(Da);(ra=Fa.a.gj(this.C5,Da))&&delete this.UO[ra.addinId];delete this.C5[Da];Ha=this.yrd(Ha);return this.rfa(()=>{K(bb.cyd,
Da);ka.setResult(!0)},wa=>{wa=l.a.Qj(wa.data);b.ULS.sendTraceTag(537163539,0,10,`CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Da,oa,null)}. Errors: ${za.a.Kh(wa)}.`);K(bb.byd,Da);ka.setResult(!1)},Ha,ka,!1)}rfa(ra,Da,oa,Ha,ka){const wa=this.$.userOperationManager,Za=this.$.pa;let ab=null,db=null,mb=null;const Ia=()=>{if(wa.dWa()||0<Za.ta.sfa||0<Za.JG.sfa)return!1;ab&&wa.Hv(ab);db&&Za.MK(db);
mb&&Za.VY(mb);const pa=oa.request;wa.vO(new t.a(507,0,(lb,ha,ua)=>{K(ka?bb.ayd:bb.dyd,pa.RequestBody);return m.h(Za.ta,"ExecuteRichApiRequest",oa,V.c(lb,ra),V.b(ha,Da),ua,null,0)},pa.RequestFlags&1&&256!==(pa.RequestFlags&256)?64:80));return!0};Ia()||(ab=()=>{Ia()},db=()=>{Ia()},mb=()=>{Ia()},wa.px(ab),Za.iI(db),Za.WW(mb));return Ha.task}eVa(ra){const Da={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};Da.RequestBody=JSON.stringify(ra);Da.RequestFlags=1;Da.RequestFlags|=
256;ra=this.$.pa.ta.Za(1);ra.request=Da;return ra}ird(ra){const Da={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};Da.RequestBody=JSON.stringify(ra);Da.RequestFlags=1;Da.RequestFlags|=256;ra=this.$.pa.ta.Za(1);ra.request=Da;return ra}yrd(ra){const Da={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};Da.RequestBody=JSON.stringify(ra);Da.RequestFlags=1;Da.RequestFlags|=256;ra=this.$.pa.ta.Za(1);ra.request=Da;return ra}bce(ra,Da){const oa=
Object(sa.d)(Ya.a.resolve(Ea.Rc,{va:1}));return W(oa,()=>{oa.result.kie();return ra&&Da?this.hqk(ra):la.Task.Va(!0)},this.$.xa,w.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")}ZQg(){const ra=new Ba.a(1949669462,0,this.$.Rh,0,null);return this.$.Ma.dh(ra)}static GFf(ra){try{return la.Task.Va(localStorage.getItem(ra))}catch(Da){return b.ULS.sendTraceTag(537163537,0,50,`CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: ${Da.message||
"Unknown"}`),la.Task.Va(null)}}static Fme(ra,Da){try{return localStorage.setItem(ra,Da),la.Task.Va(!0)}catch(oa){return b.ULS.sendTraceTag(537163536,0,50,`CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: ${oa.message||"Unknown"}`),la.Task.Va(!1)}}static jhk(ra){try{return localStorage.removeItem(ra),la.Task.Va(!0)}catch(Da){return b.ULS.sendTraceTag(537163535,0,50,`CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: ${Da.message||
"Unknown"}`),la.Task.Va(!1)}}static msi(ra){return fa.a.equals(ra,"registry",!0)||fa.a.equals(ra,"uploadfiledevcatalog",!0)||f.AFrameworkApplication.userNameUnknown||f.AFrameworkApplication.limitedEdit}static WXd(ra){if(!ra)return!1;try{JSON.parse(ra)}catch(Da){return!1}return!0}}bb.rlb="CustomFunctionCache";bb.slb="CustomFunction";bb.ayd=new Ta(2,"CustomFunctions [Registration] [Begin] SolutionId=");bb.tLb=new Ta(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");bb.sLb=new Ta(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
bb.dyd=new Ta(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");bb.cyd=new Ta(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");bb.byd=new Ta(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(y.a)(bb,"CustomFunctionsInstaller",null,[493])},1355:function(y,x,a){a.r(x);a.d(x,"CustomFunctionsLegacyInstaller",function(){return P});y=a(0);var c=a(2),b=a(14),f=a(1145),r=a(182),d=a(158),k=a(212),t=a(62),m=a(79),e=a(40),w=a(122),l=a(614),u=a(1233);class n{constructor(Y){Y=
Y.split("|");this.tG=Y[1];this.did=Y[2];this.rse=Y[3]}get solutionId(){return this.tG}get solutionVersion(){return this.did}get needToRestoreManifest(){return this.rse===OSF.StoreTypeEnum.Registry.toString()}}Object(y.a)(n,"AddinStoreInfo",null,[]);class v{}Object(y.a)(v,"CustomFunctionRegistrationInfos",null,[]);const B=(Y,ea)=>{if(a(1355).CustomFunctionsLegacyInstaller.fQb("CustomFunctionsRuntimeLogging")&&window.console)switch(ea=z(Y.severity)+" "+Y.message+ea,Y.severity){case 2:window.console.log&&
window.console.log(ea);break;case 0:window.console.info&&window.console.info(ea);break;case 1:window.console.error&&window.console.error(ea)}},z=Y=>{switch(Y){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};class C{}Object(y.a)(C,"InstallationInfo",null,[]);class D{}Object(y.a)(D,"UninstallationInfo",null,[]);var J=a(197),W=a(39),N=a(35),M=a(12),Q=a(262),R=a(1097),O=a(66);class U{constructor(Y,ea){this.uhd=Y;this._message=ea}get severity(){return this.uhd}get message(){return this._message}}
Object(y.a)(U,"CustomFunctionLog",null,[]);var K=a(5),F=a(93),I=a(97);class P{constructor(Y){this.UO={};this.$=Y;this.ARd().nAa()}ySf(Y,ea,Ba,Fa){const za=new r.a;if(Fa.invariantNamespace)for(ea=0;ea<Fa.invariantNamespace.length;++ea){const fa=Fa.invariantNamespace.charAt(ea);if("."!==fa&&"_"!==fa&&"a">fa&&"z"<fa&&"A">fa&&"Z"<fa&&"0">fa&&"9"<fa)return b.ULS.sendTraceTag(537163530,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='${fa}', Position=${ea}.`),
za.setResult(!1),za.task}P.cacheManifest(Ba,Fa.manifest);let xa=P.Bde(Y);(null===xa||void 0===xa?0:xa.isDynamicMetadata)?this.Eee(Y,xa,za,!1,!1):OSF.OUtil.xhrGet(Fa.metadataUrl,fa=>{xa=Object(c.a)(new C,{addinId:Ba,locale:Fa.locale,addinInvariantNamespace:Fa.invariantNamespace,addinNamespace:Fa.namespace,addinTitle:Fa.title,isXllCompatible:Fa.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(fa))});this.Eee(Y,xa,za,!1,u.a(this.$,Fa))},fa=>{b.ULS.sendTraceTag(537163528,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution ${Y}. ErrorCode: ${fa}.`);
za.setResult(!1)});return za.task}zSf(Y,ea,Ba,Fa){ea=new r.a;if(!P.WXd(Ba))return b.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),ea.setResult(!1),ea.task;const za=P.Bde(Y);if(!za)return b.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),ea.setResult(!1),ea.task;za.metadataContent=JSON.stringify(JSON.parse(Ba));za.isDynamicMetadata=
!0;this.Eee(Y,za,ea,!0,Fa);return ea.task}B0g(Y){const ea=new r.a,Ba=K.vb.Ha()?Object(F.d)(I.a.resolve(K.vb,{va:1})):m.GetServiceTaskFactory.create(this.$.ka,106,this.$.xa,1);e.TaskExtensions.Ua(Ba,()=>{const Fa=Ba.result;Fa.tva();const za=Object(c.a)(new D,{solutionId:Y});P.sfe(Y);P.Afe(Y);e.TaskExtensions.Ua(this.cwe(Fa,Y,za),xa=>{J.b(xa)?ea.setResult(xa.result):(xa.om?b.ULS.sendTraceTag(537163524,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${Y}.`):
xa.Sn&&b.ULS.sendTraceTag(537163523,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: ${Y}.`),ea.setResult(!1))},this.$.xa,0)},this.$.xa,3);return ea.task}ARd(){const Y=new r.a,ea=P.Fde();0<ea.length&&b.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");const Ba=[];ea.forEach(za=>{za=Object(d.a)(String,za);if(za=P.Bde(za)){const xa=W.a.gj(this.UO,za.addinId);
xa&&xa===za.metadataContent||(this.UO[za.addinId]=za.metadataContent,Ba.push(za))}});if(!Ba.length)return Y.setResult(!0),b.ULS.sendTraceTag(537163521,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),Y.task;const Fa=K.vb.Ha()?Object(F.d)(I.a.resolve(K.vb,{va:1})):m.GetServiceTaskFactory.create(this.$.ka,106,this.$.xa,1);e.TaskExtensions.Ua(Fa,()=>{const za=Fa.result,xa=Object(c.a)(new v,{registrationInfos:Ba});e.TaskExtensions.Ua(this.Bmc(za,
ea,xa),fa=>{J.b(fa)?Y.setResult(fa.result):(fa.om?b.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):fa.Sn&&b.ULS.sendTraceTag(537163490,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),Y.setResult(!1))},this.$.xa,0)},this.$.xa,3);return Y.task}gqk(Y){Y=new n(Y);if(Y.needToRestoreManifest){const ea=P.obk(Y.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(Y.solutionId,
Y.solutionVersion,ea,this.$.ua.UICultureTag)}}Eee(Y,ea,Ba,Fa,za){const xa=K.vb.Ha()?Object(F.d)(I.a.resolve(K.vb,{va:1})):m.GetServiceTaskFactory.create(this.$.ka,106,this.$.xa,1);e.TaskExtensions.Ua(xa,()=>{e.TaskExtensions.Ua(this.Gee(xa.result,Y,ea,!1,Fa,za),fa=>{J.b(fa)?((fa=fa.result)&&P.ybl(Y,ea),Ba.setResult(fa)):(fa.om?b.ULS.sendTraceTag(537163488,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: ${Y}.`):fa.Sn&&b.ULS.sendTraceTag(537163487,
0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: ${Y}.`),Ba.setResult(!1))},this.$.xa,0)},this.$.xa,3)}Gee(Y,ea,Ba,Fa,za,xa){if(!za&&(za=W.a.gj(this.UO,Ba.addinId))&&za===Ba.metadataContent)return O.Task.Va(!0);this.UO[Ba.addinId]=Ba.metadataContent;const fa=new r.a;xa||Y.K2b(ea);Y.tva();Y=this.eVa(Ba);return this.rfa(V=>{B(P.tLb,ea);const ba=V.Result;204===ba.ResponseStatusCode?e.TaskExtensions.Ua(this.ace(fa,Ba.addinId,Fa),la=>{la.om?ea?b.ULS.sendTraceTag(537163485,
0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${ea}.`):b.ULS.sendTraceTag(537163484,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId ${Ba.addinId}.`):la.Sn&&(ea?b.ULS.sendTraceTag(537163483,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution ${ea}.`):b.ULS.sendTraceTag(537163482,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId ${Ba.addinId}.`));
fa.setResult(!1)},this.$.xa,4):(V=()=>{delete this.UO[Ba.addinId];P.sfe(ea);P.Afe(ea);b.ULS.sendTraceTag(537163481,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: ${ea}. Received status code ${ba.ResponseStatusCode}.`);fa.setResult(!1)},V=Object(c.a)(new R.a,{f_a:OSF.InfoType.Error,title:Ba.addinTitle,description:String.format(M.a.instance.$g(153),M.a.instance.ia(1892)),buttonText:M.a.instance.ia(4),fua:V,iCc:!1,fva:V,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),
f.a.Ppe(V))},V=>{V=w.a.Qj(V.data);b.ULS.sendTraceTag(537163480,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${ea}. Errors: ${N.a.Kh(V)}.`);B(P.sLb,ea);delete this.UO[Ba.addinId];fa.setResult(!1)},Y,fa,!0)}Bmc(Y,ea,Ba){const Fa=new r.a;ea.forEach(xa=>{xa=Object(d.a)(String,xa);Y.Taf(xa)});Y.tva();const za=this.ird(Ba);return this.rfa(xa=>{B(P.tLb,Sys.Serialization.JavaScriptSerializer.serialize(ea));xa=xa.Result;let fa=!0;var V=
[];V=Sys.Serialization.JavaScriptSerializer.deserialize(xa.ResponseBody.toString()),V=Array.isArray(V.value)?V.value:null;for(let ba=0;ba<V.length;ba++)V[ba]||(fa=!1,delete this.UO[Ba.registrationInfos[ba].addinId],P.sfe(ea[ba]),P.Afe(ea[ba]),b.ULS.sendTraceTag(537163478,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: ${ea[ba]}. Received status code ${xa.ResponseStatusCode}.`));e.TaskExtensions.Ua(this.ace(Fa,"",!1),ba=>{ba.om?b.ULS.sendTraceTag(537163477,
0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):ba.Sn&&b.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");Fa.setResult(!1)},this.$.xa,4);Fa.setResult(fa)},xa=>{xa=w.a.Qj(xa.data);b.ULS.sendTraceTag(537163475,0,10,`CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds ${Sys.Serialization.JavaScriptSerializer.serialize(ea)}. Errors: ${N.a.Kh(xa)}.`);
B(P.sLb,Sys.Serialization.JavaScriptSerializer.serialize(ea));for(const fa of Ba.registrationInfos)delete this.UO[fa.addinId];Fa.setResult(!1)},za,Fa,!0)}cwe(Y,ea,Ba){const Fa=new r.a;Y.K2b(ea);Y=this.yrd(Ba);return this.rfa(()=>{B(P.cyd,ea);e.TaskExtensions.Ua(this.ace(Fa,Ba.solutionId,!1),za=>{za.om?ea&&b.ULS.sendTraceTag(537163473,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${ea}.`):za.Sn&&ea&&b.ULS.sendTraceTag(537163472,
0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution ${ea}.`);Fa.setResult(!1)},this.$.xa,4)},za=>{za=w.a.Qj(za.data);b.ULS.sendTraceTag(537163471,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${ea}. Errors: ${N.a.Kh(za)}.`);B(P.byd,ea);Fa.setResult(!1)},Y,Fa,!1)}rfa(Y,ea,Ba,Fa,za){const xa=this.$.userOperationManager,fa=this.$.pa;let V=null,ba=null,
la=null;const Ta=()=>{if(xa.dWa()||0<fa.ta.sfa||0<fa.JG.sfa)return!1;V&&xa.Hv(V);ba&&fa.MK(ba);la&&fa.VY(la);const Ea=Ba.request;xa.vO(new k.a(507,0,(sa,Ya,bb)=>{B(za?P.ayd:P.dyd,Ea.RequestBody);return t.h(fa.ta,"ExecuteRichApiRequest",Ba,Q.c(sa,Y),Q.b(Ya,ea),bb,null,0)},(Ea.RequestFlags&1?0:16)|64));return!0};Ta()||(V=()=>{Ta()},ba=()=>{Ta()},la=()=>{Ta()},xa.px(V),fa.iI(ba),fa.WW(la));return Fa.task}eVa(Y){const ea={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};ea.RequestBody=
JSON.stringify(Y);ea.RequestFlags=1;Y=this.$.pa.ta.Za(1);Y.request=ea;return Y}ird(Y){const ea={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};ea.RequestBody=JSON.stringify(Y);ea.RequestFlags=1;Y=this.$.pa.ta.Za(1);Y.request=ea;return Y}yrd(Y){const ea={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};ea.RequestBody=JSON.stringify(Y);ea.RequestFlags=1;Y=this.$.pa.ta.Za(1);Y.request=ea;return Y}ace(Y,ea,Ba){const Fa=Object(F.d)(I.a.resolve(K.Rc,
{va:1}));e.TaskExtensions.Ua(Fa,()=>{Fa.result.kie();ea&&Ba&&this.gqk(ea);Y.setResult(!0)},this.$.xa,3);return Fa}ASf(){return O.Task.Va(!0)}static Fde(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(P.fQb(l.a.$cb)||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(P.fQb(l.a.$cb)||"[]"):null)||[]}static k7g(Y){P.Gme(l.a.$cb,Sys.Serialization.JavaScriptSerializer.serialize(Y))}static Bde(Y){Y=P.fQb(l.a.Rjb(Y))||"";return 0<Y.length?Sys.Serialization.JavaScriptSerializer.deserialize(Y,
!0):null}static ybl(Y,ea){P.aqf(Y);P.Gme(l.a.Rjb(Y),Sys.Serialization.JavaScriptSerializer.serialize(ea))}static sfe(Y){P.mAg(Y);P.LAg(l.a.Rjb(Y))}static obk(Y){return P.fQb(l.a.Qjb(Y))}static zbl(Y,ea){P.aqf(Y);P.Gme(l.a.Qjb(Y),ea)}static Afe(Y){P.mAg(Y);P.LAg(l.a.Qjb(Y))}static aqf(Y){const ea=P.Fde();Y=Y.toLowerCase();ea.includes(Y)||(ea.push(Y),P.k7g(ea))}static mAg(Y){const ea=P.Fde();Y=Y.toLowerCase();ea.includes(Y)&&(ea.splice(Array.indexOf(ea,Y),1),P.k7g(ea))}static cacheManifest(Y,ea){Y=
new n(Y);Y.needToRestoreManifest&&P.zbl(Y.solutionId,ea)}static fQb(Y){try{return localStorage.getItem(Y)}catch(ea){return b.ULS.sendTraceTag(537163469,0,50,`CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: ${ea.message||"Unknown"}`),null}}static Gme(Y,ea){try{localStorage.setItem(Y,ea)}catch(Ba){b.ULS.sendTraceTag(537163468,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${Ba.message||
"Unknown"}`)}}static LAg(Y){try{localStorage.removeItem(Y)}catch(ea){b.ULS.sendTraceTag(537163467,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${ea.message||"Unknown"}`)}}static WXd(Y){if(!Y)return!1;try{JSON.parse(Y)}catch(ea){return!1}return!0}}P.ayd=new U(2,"CustomFunctions [Registration] [Begin] SolutionId=");P.tLb=new U(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");P.sLb=new U(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
P.dyd=new U(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");P.cyd=new U(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");P.byd=new U(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(y.a)(P,"CustomFunctionsLegacyInstaller",null,[493])},1366:function(y,x,a){a.d(x,"a",function(){return C});y=a(0);var c=a(221),b=a(14);class f{}Object(y.a)(f,"AddinCommandsHost",null,[]);var r=a(1428),d=a(1534),k=a(1095),t=a(62);const m=(D,J,W,N,M,Q)=>{const R=D.Za(9);
R.sharedInfo=J;return t.h(D,"InsertAgaveTaskpane",R,W,N,M,Q,0)};var e=a(419),w=a(212),l=a(40),u=a(1),n=a(262);x=a(236);class v extends x.a{constructor(D){super();this.Lk=this.rRa="AddInCommandsDialog";this.Bh=5;this.dialogWidth=695;this.dialogHeight=438;this.tYh="100%";this.qYh="408px";this.rYh="15px";this.sYh="0";this.imh=D}get containerDiv(){return this.zo}WF(){super.WF();this.zo.style.width=this.tYh;this.zo.style.height=this.qYh;this.zo.style.marginTop=this.rYh;this.zo.style.padding=this.sYh}GS(){super.GS();
this.Xg.style.width=String.format("{0}px",this.dialogWidth);this.Xg.style.height=String.format("{0}px",this.dialogHeight)}dispose(){super.dispose();this.imh()}}Object(y.a)(v,"AddInCommandsDialog",x.a,[]);var B=a(66),z=a(78);a=a(106);class C extends f{constructor(D,J,W,N,M){N=void 0===N?null:N;M=void 0===M?null:M;super();this.$=D;this.ri=J;this.ownerAddinInfo=W;this.Ah=M;this.Ttb=N||B.Task.Va(!0)}nYh(){const D=this.Ttb;this.Ttb=B.Task.Va(!0);return D}disposeHost(D){this.ri.h5a(D)}setOwnerAddinEToken(D){this.ownerAddinInfo.eToken=
D}showTaskpane(D,J,W){b.ULS.sendTraceTag(537170642,220,50,"ShowTaskpane action called.");let N=null,M=!1;const Q=(new r.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.solutionId,new k.a,!0)).Kjf(D.solutionId.substr(this.ownerAddinInfo.solutionId.length));N=J.getSharedRuntimeForTaskpane("Workbook",Q);M=!!N&&1===N.LifeTime;this.ri.Waf(M?this.ownerAddinInfo.solutionId:D.solutionId,M?N:null,null)||(this.v6f(M,!0),this.Ttb=this.yRd(D,N,(R,O)=>{R?(M&&(R.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,
R.SharedRuntime=N),R.WebExtensionOsfControlType=3,this.ri.vWa(R),W(R.InstanceId,O),this.v6f(M,!1),u.EwaSettings.isChangeGateEnabled("OfficeVSO:6085876_TelemetryForActiveAddinSuccessOnExcelWacEnabled")&&b.ULS.sendTraceTag(524818146,220,50,"ShowTaskpane: succeed to call.")):(b.ULS.sendTraceTag(17306640,220,10,"ShowTaskpane: instance id is null."),W(null,O))}))}getSettings(D,J){const W=this.ri.R4(D.solutionId);W?J(this.ri.wX(W).OsfPropertyBag):this.Ttb=this.yRd(D,null,N=>{N?J(N.OsfPropertyBag):b.ULS.sendTraceTag(537170641,
220,10,"GetSettings: insertData is null.")})}showDialog(D,J,W){b.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");const N=this.$.pa.ta,M=R=>{const O=R.Result,U=O?O.AgaveData:null;U?(this.ri.zif(U,()=>{const K=new v(()=>{this.disposeHost(U.InstanceId)});K.initializeAndShow("",null,null);return K.containerDiv}),W(U.InstanceId,0)):(b.ULS.sendTraceTag(537170638,220,10,"ShowDialog: instance id is null."),W(null,R.Errors?R.Errors[0].ErrorCause:5001))},Q=C.CGa(D,this.ownerAddinInfo);this.Ttb=
e.a(this.$.userOperationManager,(R,O,U)=>m(N,Q,n.c(R,M),O,U,null),R=>new w.a(500,0,R,64),this.Ah)}createUILessSandbox(D,J,W){b.ULS.sendTraceTag(537170637,220,50,"UILess action called.");const N=J.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),M=!!N&&1===N.LifeTime;(J=this.ri.Uui(M?this.ownerAddinInfo.solutionId:D.solutionId,M?N:null))?W(J,0):this.Ttb=this.yRd(D,N,(Q,R)=>{Q?(M?(Q.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,Q.SharedRuntime=N,Q.TaskpaneVisible=!1,Q.WebExtensionOsfControlType=
3,this.ri.vWa(Q)):(Q.WebExtensionOsfControlType=4,this.ri.zif(Q,()=>{C.wxb.ga(Q.InstanceId,new d.a);return C.wxb.ma(Q.InstanceId).Vla})),W(Q.InstanceId,R)):(b.ULS.sendTraceTag(537170636,220,10,"UILess: instance id is null."),W(null,R))})}yRd(D,J,W){let N=null;const M=this.$.pa.ta,Q=F=>{const I=F.Result;(N=I?I.AgaveData:null)||W(null,F.Errors?F.Errors[0].ErrorCause:5001)},R=C.CGa(D,this.ownerAddinInfo);J&&(b.ULS.sendTraceTag(537170634,220,50,"Shared runtime agave is inserted."),R.SharedRuntimeId=J.Resid);
let O=500;var U=(F,I,P)=>m(M,R,n.c(F,Q),I,P,null);let K=0;void 0===R.IsToBePersisted||null===R.IsToBePersisted||R.IsToBePersisted||(O=538,U=(F,I,P)=>{b.ULS.sendTraceTag(537170633,220,50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ownerAddinInfo.solutionId,this.ownerAddinInfo.storeType,this.ownerAddinInfo.assetId,null,null,this.ownerAddinInfo.storeId));F=n.c(F,Q);const Y=M.Za(9,null);Y.sharedInfo=R;return t.h(M,
"ShowAgaveTaskpane",Y,F,I,P,null,0)},K=16);K|=64;U=e.a(this.$.userOperationManager,U,F=>new w.a(O,0,F,K),this.Ah);return l.TaskExtensions.ts(U,()=>N?this.R_d(M,N.InstanceId,(F,I)=>{if(F){J||(N.PrimaryMarketplace.MarketplaceType=D.storeType);D.assetId?D.assetId.toLowerCase().startsWith("wa")?N.AssetMarketplace={SolutionId:D.assetId,SolutionVersion:D.version,MarketplaceType:OSF.StoreType.OMEX,MarketplaceRef:D.assetStoreId}:(N.AssetMarketplace=null,b.ULS.sendTraceTag(512325019,344,10,"WACExcelAddinCommandsHost: AssetId is not a valid value")):
N.AssetMarketplace=null;N.OwnerAddinSolutionId=this.ownerAddinInfo.solutionId;N.OwnerAddinStoreType=this.ownerAddinInfo.storeType;N.OsfPropertyBag=[];for(I=0;I<F.Settings.length;I++){const P=[];P[0]=F.Settings[I].Name;P[1]=F.Settings[I].Value;N.OsfPropertyBag[I]=P}W(N,0)}else W(null,I.Errors?I.Errors[0].ErrorCause:5001)}):B.Task.Va(!1),c.a.none,3,z.a.current)}R_d(D,J,W){const N=M=>{W(M.Result,M)};return e.a(this.$.userOperationManager,(M,Q,R)=>{M=n.c(M,N);const O=D.Za(1);O.controlId=J;return t.h(D,
"DdaLoadSettings",O,M,Q,R,null,0)},M=>new w.a(501,0,M,80),this.Ah)}v6f(D,J){var W;D&&(null===(W=window.performance)||void 0===W?0:W.memory)&&b.ULS.sendTraceTag(537170630,220,50,`Shared runtime memory usage: before=${J}, jsHeapSizeLimit=${window.performance.memory.jsHeapSizeLimit}, totalJSHeapSize=${window.performance.memory.totalJSHeapSize}, usedJSHeapSize=${window.performance.memory.usedJSHeapSize}`)}static showUILessDialog(D){C.wxb.Vg(D)&&C.wxb.ma(D).initializeAndShowWithTitle()}static hideUILessDialog(D){C.wxb.Vg(D)&&
C.wxb.ma(D).hide()}static CGa(D,J){var W,N;const M={};M.SolutionId=D.solutionId;M.Version=D.version;M.StoreType=J.storeType;M.StoreId=D.storeId;M.AssetId=null!==(W=D.assetId)&&void 0!==W?W:D.solutionId;M.AssetStoreId=null!==(N=D.assetStoreId)&&void 0!==N?N:"omex";M.TargetType=1;M.Width=350;M.OwnerAddinSolutionId=J.solutionId;M.OwnerAddinStoreType=J.storeType;M.SharedRuntimeId=null;M.Preload=!1;return M}}C.wxb=new a.a;Object(y.a)(C,"WACExcelAddinCommandsHost",f,[])},1382:function(y,x,a){a.d(x,"a",
function(){return e});y=a(0);var c=a(208),b=a(374),f=a(14);class r{}r.getUserId="getUserId";r.getLastStoreUpdate="laststoreupdate";r.getEntitlement="getEntitlements";r.getEToken="getEToken";r.getManifest="getManifest";r.getAppState="getAppState";r.getKilledApps="getRemovedAddins";r.getAppDetails="getAppDetails";r.removeApps="removeAddin";r.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";r.getPrivateCatalogAddIns="getAddIns";r.getPrivateCatalogManifests="getAppManifests";r.isStoreDisabled=
"isStoreDisabled";Object(y.a)(r,"S2SWebRequestActions",null,[]);var d=a(6),k=a(284),t=a(31),m=a(666);class e{getUserId(w,l){const u=new c.a;u.add(new b.a("corr",w));this.x7(r.getUserId,u,1,l)}getLastStoreUpdate(w,l,u){const n=new c.a;n.add(new b.a("lc",w));n.add(new b.a("corr",l));this.x7(r.getLastStoreUpdate,n,1,u)}getEntitlement(w,l,u,n){w=new c.a;w.add(new b.a("av",l));w.add(new b.a("corr",u));this.x7(r.getEntitlement,w,1,n)}getEToken(w,l,u,n,v,B){const z=new c.a;z.add(new b.a("cmu",w));z.add(new b.a("cmf",
l));z.add(new b.a("assetid",u));z.add(new b.a("expver",n));z.add(new b.a("corr",v));this.x7(r.getEToken,z,1,B)}getManifest(w,l,u,n){const v=new c.a;v.add(new b.a("cmu",w));v.add(new b.a("assetid",l));v.add(new b.a("corr",u));this.x7(r.getManifest,v,1,n)}getAppState(w,l,u){const n=new c.a;n.add(new b.a("ma",w));n.add(new b.a("corr",l));this.x7(r.getAppState,n,1,u)}getKilledApps(w,l){const u=new c.a;u.add(new b.a("corr",w));this.x7(r.getKilledApps,u,1,l)}getAppDetails(w,l,u,n){const v=new c.a;v.add(new b.a("cmo",
w));v.add(new b.a("corr",u));this.sendWithBody(r.getAppDetails,v,l,2,n,!1)}removeApps(w,l,u){const n=new c.a;n.add(new b.a("corr",l));this.sendWithBody(r.removeApps,n,w,2,u,!1)}getLastPrivateCatalogUpdate(w,l,u,n,v,B){const z=new c.a;z.add(new b.a("catalog","privatecatalog"));z.add(new b.a("clientCode",w));z.add(new b.a("clientVersion",l));z.add(new b.a("corr",v));w=String.format("authorizationCode={0}&refreshToken={1}",u?t.a.kl(u):"",n?t.a.kl(n):"");this.sendWithBody(r.getLastPrivateCatalogUpdate,
z,w,2,B,!0)}getPrivateCatalogAddIns(w,l,u,n,v,B){const z=new c.a;z.add(new b.a("catalog","privatecatalog"));z.add(new b.a("clientCode",w));z.add(new b.a("clientVersion",l));z.add(new b.a("corr",v));w=String.format("authorizationCode={0}&refreshToken={1}",u?t.a.kl(u):"",n?t.a.kl(n):"");this.sendWithBody(r.getPrivateCatalogAddIns,z,w,2,B,!0)}getPrivateCatalogManifests(w,l,u,n,v){const B=new c.a;B.add(new b.a("catalog","privatecatalog"));B.add(new b.a("corr",n));w=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",
t.a.kl(w),l?t.a.kl(l):"",u?t.a.kl(u):"");this.sendWithBody(r.getPrivateCatalogManifests,B,w,2,v,!0)}isStoreDisabled(w,l){const u=new c.a;u.add(new b.a("corr",w));this.x7(r.isStoreDisabled,u,2,l)}x7(w,l,u,n){this.sendWithBody(w,l,null,u,n,!1)}sendWithBody(w,l,u,n,v,B){const z=new k.QueryStringBuilder("AddinServiceHandler.ashx");z.Kp("action",w);z.Kp("app",m.a[d.AFrameworkApplication.ra.$d.Om]);for(const C of l)z.Kp(C.key,C.value);l=String.format("{0}{1}&{2}",d.AFrameworkApplication.ra.$d.Y0,z.toString(),
d.AFrameworkApplication.qo);d.AFrameworkApplication.$i.Ou(l,n,u,null,!1,2,C=>{let D=null,J=null;C&&C.data&&(C.data.responseHeaders["X-BlockedForMinor"]&&"1"===C.data.responseHeaders["X-BlockedForMinor"].toString()&&(C.data.httpStatus=451),D=C.data.responseData,J=C.data.responseHeaders);v(C.data.httpStatus,D,J)},C=>{var D=null;let J=null;B&&C&&C.data&&C.data.responseData&&(D=C.data.responseData,J=C.data.responseHeaders);v(C.data.httpStatus,D,J);if(d.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",
!0)){D={message:"AddinServiceHandler request failed"};D.code=C.data.httpStatus;D.action=w;if(C.data.request||C.data.request.get_headers())D["X-UserSessionId"]=C.data.request.get_headers()["X-UserSessionId"];408===C.data.httpStatus||503===C.data.httpStatus?f.ULS.sendTraceTag(538784582,220,50,JSON.stringify(D)):f.ULS.sendTraceTag(18392345,220,50,JSON.stringify(D))}else f.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",C.data.httpStatus)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+
w,void 0,void 0,void 0,["X-UserKey"])}}Object(y.a)(e,"S2SWebRequestManager",null,[])},1383:function(y,x,a){a.d(x,"a",function(){return t});y=a(0);var c=a(641),b=a(14),f=a(237);class r{constructor(m,e,w){this.SMf=l=>{try{if(l&&l.rawEvent&&l.rawEvent.origin&&this.iframe&&this.iframe.id){var u=this.Aqg(l.rawEvent.origin);const n=this.Aqg(document.domain);if(c.a.lm().equals(n,u))if(l.rawEvent.source&&l.rawEvent.source.frameElement&&l.rawEvent.source.frameElement.id&&c.a.lm().equals(l.rawEvent.source.frameElement.id,
this.iframe.id)){u=null;try{u=JSON.parse(l.rawEvent.data)}catch(v){b.ULS.sendTraceTag(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",v.message)}u?(u.statusCode!==f.a.jN||void 0!==u.error&&u.error?(b.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",u.statusCode,u.error),this.onError()):(b.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),
this.f1(u.authorizationCode?u.authorizationCode:u.signInUrl)),$removeHandler(window,"message",this.SMf),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):b.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):b.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):b.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else b.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");
else b.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else b.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(n){b.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",n.message)}};this.iframe=m;this.f1=e;this.onError=w;$addHandler(window,"message",this.SMf)}Aqg(m){let e="";try{m&&(e=-1<m.indexOf("//")?m.split("/")[2]:
m.split("/")[0])&&(e=e.split(":")[0],e=e.split("?")[0])}catch(w){b.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",w.message)}return e}static Aa(m,e,w){new r(m,e,w)}}Object(y.a)(r,"ResponseHandler",null,[]);var d=a(6),k=a(284);class t{constructor(m){this.ITa=m}tryAuthenticate(m,e){this.Erb(t.cjh,()=>{m()},e)}tryAuthorize(m,e){this.Erb(t.$dh,m,e)}getSignInUrl(m,e){this.Erb(t.hVe,m,e)}signOut(m,e){this.Erb(t.pph,m,e)}Erb(m,e,w){var l=new k.QueryStringBuilder("AuthenticationProxyHandler.aspx");
l.Kp("responseType",m);d.AFrameworkApplication.Dcb(l);l=String.format("{0}{1}&{2}",this.ITa,l.toString(),d.AFrameworkApplication.qo);const u=document.createElement("iframe");u.setAttribute("id","privateCatalogIframe");u.setAttribute("name","privateCatalogIframe");u.setAttribute("style","display: none");c.a.lm().equals(m,t.hVe)||u.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");r.Aa(u,e,w);u.setAttribute("src",l);document.body.appendChild(u)}}t.$dh=
"authcode";t.cjh="identitytoken";t.hVe="signinurl";t.pph="signout";Object(y.a)(t,"AuthenticationProxy",null,[])},1427:function(y,x,a){x=a(477)(!1);x.push([y.i,".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}",""]);y.exports=x},1428:function(y,x,a){a.d(x,"a",function(){return b});y=a(0);a(14);var c=a(6);class b{constructor(f,r,d,k){this.MCb=f;c.AFrameworkApplication.fa.la("AddInCommandsMissingTabIsEnabled")&&
d.MNi();this.tG=r;this.Xoh=k}get WYb(){return this.MCb}get solutionId(){return this.tG}get gpe(){return this.Xoh}GYa(f){f=this.WYb+this.solutionId+f;return this.gpe?(f in b.Vkc||(b.Vkc[f]="AddinControl"+b.vBh++),b.Vkc[f]):f}Kjf(f){if(this.gpe){const d=b.Vkc;for(const k in d){var r=k;if(f===d[k])return r.substr(this.WYb.length+this.solutionId.length)}}return f}vJf(f){f=this.WYb+this.solutionId+f;return this.gpe?(f in b.Mnd||(b.Mnd[f]="AddinTab"+b.NBh++),b.Mnd[f]):f}}b.Vkc={};b.Mnd={};b.NBh=0;b.vBh=
0;Object(y.a)(b,"DefaultRibbonNamingProvider",null,[381])},1490:function(y,x,a){a.d(x,"a",function(){return N});y=a(0);var c=a(208),b=a(14),f=a(106);class r{constructor(){this.startTime=0;this.callback=null}}Object(y.a)(r,"SSOCallbackInfo",null,[]);class d{constructor(){this.accessToken=null}}Object(y.a)(d,"AccessTokenInformation",null,[410]);var k=a(1238);class t{constructor(){this.token=null;this.expiresOn=0;this.Nta=this.authChallenge=null}}Object(y.a)(t,"CachedTokenInfo",null,[]);class m{constructor(){this.nbc=
new c.a;this.Lka=this.Kka=!1;this.ABa=this.authChallenge=null;this.startTime=this.retryCount=0;this.T1e=null}get callbacks(){return this.nbc}}Object(y.a)(m,"SSORequestInfo",null,[]);class e extends m{constructor(){super();this.errorCode=0}}Object(y.a)(e,"SSOFailedRequestInfo",m,[]);var w=a(6),l=a(125),u=a(180),n=a(386);class v{static Uga(M,Q,R,O){var U=M.startTime;let K=0;0<U&&(K=v.wF()-U);U={["callInstanceId"]:U.toString(),["callDuration"]:K.toString(),["errorCode"]:Q.toString()};if(O)for(const F in O)U[F]=
O[F];b.ULS.sendTraceTag(51401116,344,50,"{0}",U);u.a.sendTelemetryEvent(Object.assign(new n.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:l.a.rn(U)}));M.callback(Q,R)}static wF(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(M){}return Date.now()}}Object(y.a)(v,"AppsForOfficeSingleSignOnManagerStatic",null,[]);class B{constructor(M,Q,R,O){this.a3=new c.a;this.jQ=new c.a;this.GCa=null;this.gbb=new c.a;this.HNe=Promise.resolve(null);
this.fVe=!1;this.Ngc=Q;this.bT=M;this.MVe=R;this.gdh=O}static zpf(){return w.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ReduceAddinSSOThrottleErrors")}JIk(M){if(this.GCa&&this.GCa.authChallenge===M.authChallenge){if(Date.now()/1E3+B.ACj>this.GCa.expiresOn)return this.GCa=null,!1;M=new k.a;M.token=this.GCa.token;M.expiresOn=this.GCa.expiresOn;M.Nta=this.GCa.Nta;M.xPa=!0;M.qJa=0;this.oRb(M);return!0}return!1}dHk(M){for(let Q=0;Q<this.jQ.count;Q++)if(this.jQ.ma(Q).authChallenge===
M.authChallenge&&this.jQ.ma(Q).ABa===M.ABa){let R;(R=this.jQ.ma(Q)).retryCount=R.retryCount+1;M.retryCount=this.jQ.ma(Q).retryCount;if(this.jQ.ma(Q).retryCount<B.aDj||!this.jQ.ma(Q).Kka&&M.Kka||!this.jQ.ma(Q).Lka&&M.Lka){if(!this.jQ.ma(Q).Kka&&M.Kka||!this.jQ.ma(Q).Lka&&M.Lka)M.retryCount=0;this.jQ.removeAt(Q);break}M=new k.a;M.errorCode=this.jQ.ma(Q).errorCode;this.oRb(M);return!0}return!1}Dwh(M,Q){for(let R=0;R<this.jQ.count;R++)if(this.jQ.ma(R).ABa===M.ABa&&this.jQ.ma(R).authChallenge===M.authChallenge)return;
this.jQ.add(Object.assign(new e,{Kka:M.Kka,Lka:M.Lka,authChallenge:M.authChallenge,ABa:M.ABa,errorCode:Q,retryCount:M.retryCount}))}get resource(){return this.Ngc}hHd(M,Q,R,O,U,K){""===R&&(R=null);if(this.fVe)v.Uga(K,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var F=null;for(const I of this.a3)if(I.Kka===M&&I.Lka===Q&&I.authChallenge===R&&I.ABa===U){F=I;break}F||(F=Object.assign(new m,{Kka:M,Lka:Q,authChallenge:R,T1e:O,ABa:U,retryCount:0,startTime:v.wF()}),this.a3.add(F));
F.retryCount=0;F.callbacks.add(K);this.HNe=this.HNe.then(()=>{if(0<this.a3.count){var I=this.a3.ma(0);if(this.JIk(I)||this.dHk(I))return null;for(var P=0;P<this.gbb.count;)this.gbb.ma(P)+B.CVk<v.wF()?this.gbb.removeAt(P):P++;P=B.zpf()?B.WCj:B.XCj;if(this.gbb.count>=P||this.a3.count>=B.vCj)return I=new k.a,I.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.oRb(I),null;let Y=null;w.AFrameworkApplication.ra&&(P=w.AFrameworkApplication.ra.cL)&&(Y=P.vi("ComponentAttach",this.bT+B.Lph));
return I.ABa.msh(this.resource,I.Kka,I.Lka,I.authChallenge,this.gdh,I.T1e).then(ea=>{Y&&Y.stop();this.oRb(ea)},()=>{Y&&Y.stop();const ea=new k.a;ea.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.oRb(ea)})}return null})}}oRb(M){try{if(this.a3.count){var Q=this.a3.ma(0);this.a3.removeAt(0);var R=null;M.errorCode||(R=new d,R.accessToken=M.token);M.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&M.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&
M.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&M.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.Dwh(Q,M.errorCode);var O={};null!=M.qJa&&(O.getTokenSilentTime=M.qJa.toString());null!=M.OQb&&(O.getTokenPopupTime=M.OQb.toString());null!=M.QJd&&(O.getIDTokenTime=M.QJd.toString());null!=M.xPa&&(O.tokenCached=M.xPa.toString());M.xte&&(O.detailedError=M.xte);M.Nta&&(O.authLibrary=M.Nta);Q.retryCount&&(O.retryCount=Q.retryCount);for(var U of Q.callbacks)v.Uga(U,
M.errorCode,R,O);if(B.zpf()){const K=Number.isFinite(M.qJa)&&0<=M.qJa&&M.qJa<B.Bsi;(0<M.OQb||!K&&!M.xPa)&&this.gbb.add(Q.startTime)}else null!=M.xPa&&M.xPa||this.gbb.add(Q.startTime);if(!M.errorCode)for(null!=M.expiresOn&&(this.GCa=Object.assign(new t,{token:M.token,expiresOn:M.expiresOn,authChallenge:Q.authChallenge,Nta:M.Nta})),this.jQ.clear(),U=0;U<this.a3.count;)if(this.a3.ma(U).authChallenge===Q.authChallenge){for(const K of this.a3.ma(U).callbacks)v.Uga(K,M.errorCode,R,O);this.a3.removeAt(U)}else U++}}catch(K){b.ULS.sendTraceTag(21628945,
344,10,"ReceivedAccessTokenHandler: exception message: {0}",K.message)}}shutdown(){this.fVe=!0;this.a3.clear()}}B.CVk=6E4;B.XCj=6;B.WCj=8;B.vCj=6;B.aDj=3;B.ACj=300;B.Bsi=100;B.Lph="GetAccessToken";Object(y.a)(B,"SSOCallbackManager",null,[]);var z=a(908),C=a(596),D=a(81),J=a(34),W=a(31);class N{constructor(M,Q,R){R=void 0===R?null:R;this.Q4c=new f.a;const O=new c.a;Q&&O.add(Q.NAj);R&&O.addRange(R);this.jr=M;this.Oqh=O}iHd(M,Q,R,O,U,K,F,I,P,Y){Y=Object.assign(new r,{startTime:v.wF(),callback:Y});try{const Fa=
!!R&&""!==R;var ea=Y.startTime;const za=this.getOsfControl(M);let xa=za.getStoreType()||"",fa=za.getOwnerAddinStoreType()||"",V=za.getSolutionId()||"";const ba=za.getVersion()||"";xa=xa.toLowerCase();fa=fa.toLowerCase();V=V.toLowerCase();var Ba=D.a.OJd(Q)||"";const la=D.a.OJd(za.getIframeUrl())||"",Ta=Ba.toLowerCase()===la.toLowerCase();Ba=xa;"inmemory"===xa&&(Ba=fa);const Ea=Telemetry.PrivacyRules.GetPrivacyCompliantId(V,Ba,za.getAssetId(),null,null,za.getStoreId()),sa={["callInstanceId"]:ea.toString(),
["controlSolutionId"]:Ea,["controlVersion"]:ba,["storeType"]:xa,["ownerStoreType"]:fa,["allowConsentPrompt"]:O.toString(),["forMSGraphAccess"]:U.toString(),["allowSignInPrompt"]:K.toString(),["hasAddinAuthChallenge"]:Fa.toString(),["securityOriginEqualsSourceLocation"]:Ta.toString(),["singleSignOnEnabled"]:F.toString(),["accountTypeFilter"]:I||""};b.ULS.sendTraceTag(51401115,344,50,"{0}",sa);u.a.sendTelemetryEvent(Object.assign(new n.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",
dataFields:l.a.rn(sa)}));ea=!0;const Ya=w.AFrameworkApplication.fa.Xa("HostAuthType");switch(I){case "aad":ea="aad"===Ya;break;case "msa":ea="msa"===Ya;break;default:ea=!I||"noFilter"===I}if(ea){I=null;if(F)for(const bb of this.Oqh)if(bb.Lhj(V)){I=bb;break}I?this.isSSOAddin(M)?(F=!0,"omex"===Ba&&(F=!1),"spapp"===Ba||"spcatalog"===Ba?(b.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),v.Uga(Y,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,
null,null)):U&&!F?(b.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),v.Uga(Y,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(U&&"exchange"===Ba&&(O=!1),this.hHd(M,Q,R,Ba,O,K,P,I,Y))):(b.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),v.Uga(Y,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):v.Uga(Y,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,
null)}else v.Uga(Y,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(Fa){this.GJc(),b.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",Fa.message),v.Uga(Y,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(M,Q,R,O){this.iHd(M,R[z.a.Knd]||null,R[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,R[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,R[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||
!1,R[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,Q,R[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||null,R[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,O)}hHd(M,Q,R,O,U,K,F,I,P){this.Q4c.Vg(M)?O=this.Q4c.ma(M):(O=new B(M,this.getWebApplicationResource(M).split(",")[0],O,this.getDefaultDisplayName(M)),this.Q4c.add(M,O));const Y=O.resource;M=N.SSi(Y,this.getWebApplicationId(M));const ea=OfficeExt.WACUtils.getHostSecure(Q);
M&&ea?M.toLowerCase()===ea.toLowerCase()?O.hHd(U,K,R,F,I,P):(N.Y1a('SSO Resource "'+Y+'" cannot be used from "'+Q+'" origin due to domain mismatch.'),b.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),v.Uga(P,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(M||b.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),ea||b.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),v.Uga(P,
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))}GJc(){b.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(M){return this.jr.getOsfControl(M)}isSSOAddin(M){return this.getOsfControl(M).getManifest().isSSOAddin()}getWebApplicationId(M){return this.getOsfControl(M).getManifest().getWebApplicationId()}getWebApplicationResource(M){return this.getOsfControl(M).getManifest().getWebApplicationResource()}getDefaultDisplayName(M){return this.getOsfControl(M).getManifest().getDefaultDisplayName()}static OUi(){try{const M=
{};J.a.PKa&&C.a.cSb&&(M.UiHostSupportsAuthTokenAddinList=N.nxf);M.UiHostSupportsAuthToken=C.a.cSb;return M}catch(M){b.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",M.message)}return null}static getInstance(M,Q,R){N.Wa||(N.Wa=new N(M,void 0===R?null:R));return N.Wa}static Y1a(M){window.console.warn&&window.console.warn(M)}static SSi(M,Q){if(!M)return"";Q||(Q="");let R=M.toLowerCase();var O=Q.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(O)||
(N.Y1a('SSO App Id "'+Q+'" is not a valid format. It will be rejected from store submission.'),b.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));R.endsWith(O)||(N.Y1a('SSO Resource "'+M+'" does not end with App Id "'+Q+'". It will be rejected from store submission.'),b.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!R.startsWith("https://")&&!R.startsWith("api://"))return N.Y1a('SSO Resource "'+M+'" must be https:// or api:// protocol.'),b.ULS.sendTraceTag(590962909,
344,10,"Resource not using https or api protocol."),"";for(Q=0;Q<M.length;Q++){O=M.charAt(Q);const U=W.a.charCodeAt(M,Q);if(33>U||126<U||"&"===O||"?"===O||"#"===O||"%"===O||"\\"===O)return N.Y1a('SSO Resource "'+M+'" contains an invalid character "'+O+'".'),b.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+O+"' in resource URI."),""}if(0<=M.indexOf("::"))return N.Y1a('SSO Resource "'+M+'" contains an invalid string "::".'),b.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<
M.length)return N.Y1a('SSO Resource "'+M+'" is '+M.length+" characters and exceeds the max length of 120 characters."),b.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+M.length+"."),"";R.startsWith("api://")&&(R="https://"+R.substring(6,R.length));return 8===R.length?"":OfficeExt.WACUtils.getHostSecure(R)||""}}N.nxf="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5 wa200003233 ad3bb869-dfe9-409b-95f2-98016482b42 wa200003251 b2177d0c-a1d8-4c60-bc46-b1d116be3eee".split(" ");
N.Wa=null;Object(y.a)(N,"AppsForOfficeSingleSignOnManager",null,[362])},1499:function(y,x,a){a.r(x);a.d(x,"DdaEventDispatch",function(){return n});y=a(0);var c=a(14),b=a(158),f;(function(v){v[v.none=0]="none";v[v.testEvent=1]="testEvent";v[v.test1Event=2]="test1Event";v[v.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";v[v.worksheetActivatedEvent=11]="worksheetActivatedEvent";v[v.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";v[v.worksheetAddedEvent=13]="worksheetAddedEvent";
v[v.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";v[v.worksheetDeletedEvent=15]="worksheetDeletedEvent";v[v.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";v[v.worksheetFilteredEvent=17]="worksheetFilteredEvent";v[v.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";v[v.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";v[v.worksheetColumnSortedEvent=20]="worksheetColumnSortedEvent";v[v.worksheetSingleClickedEvent=21]="worksheetSingleClickedEvent";v[v.worksheetRowHiddenChangedEvent=
22]="worksheetRowHiddenChangedEvent";v[v.worksheetFormulaChangedEvent=23]="worksheetFormulaChangedEvent";v[v.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";v[v.worksheetNameChangedEvent=25]="worksheetNameChangedEvent";v[v.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";v[v.worksheetMovedEvent=27]="worksheetMovedEvent";v[v.worksheetNavigationObjectChangedEvent=28]="worksheetNavigationObjectChangedEvent";v[v.worksheetRowHeightChangedEvent=29]="worksheetRowHeightChangedEvent";
v[v.workbookFormulaReferenceStyleChangedEvent=30]="workbookFormulaReferenceStyleChangedEvent";v[v.chartAddedEvent=50]="chartAddedEvent";v[v.chartActivatedEvent=51]="chartActivatedEvent";v[v.chartDeactivatedEvent=52]="chartDeactivatedEvent";v[v.chartDeletedEvent=53]="chartDeletedEvent";v[v.tableSelectionChangedEvent=100]="tableSelectionChangedEvent";v[v.tableDataChangedEvent=101]="tableDataChangedEvent";v[v.tableAddedEvent=102]="tableAddedEvent";v[v.tableDeletedEvent=103]="tableDeletedEvent";v[v.tableFilteredEvent=
104]="tableFilteredEvent";v[v.agaveVisualUpdateEvent=150]="agaveVisualUpdateEvent";v[v.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";v[v.customFunctionExecutionEndEvent=201]="customFunctionExecutionEndEvent";v[v.commentAddedEvent=250]="commentAddedEvent";v[v.commentDeletedEvent=251]="commentDeletedEvent";v[v.commentChangedEvent=252]="commentChangedEvent";v[v.invocationMessage=1E3]="invocationMessage";v[v.cancellationMessage=1001]="cancellationMessage";v[v.metadataMessage=
1002]="metadataMessage";v[v.visualSelectionChangedEvent=2E3]="visualSelectionChangedEvent";v[v.visualChangeEvent=2001]="visualChangeEvent";v[v.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";v[v.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";v[v.shapeActivatedEvent=2101]="shapeActivatedEvent";v[v.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";v[v.shapeAddedEvent=2103]="shapeAddedEvent";v[v.shapeDeletedEvent=2104]="shapeDeletedEvent";v[v.workbookAutoSaveSettingChangedEvent=
2200]="workbookAutoSaveSettingChangedEvent";v[v.wacOperationEvent=2201]="wacOperationEvent";v[v.recordingStateChangedEvent=2202]="recordingStateChangedEvent";v[v.workbookActivatedEvent=2203]="workbookActivatedEvent";v[v.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";v[v.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";v[v.linkedDataTypeRefreshRequestCompletedEvent=2500]="linkedDataTypeRefreshRequestCompletedEvent";v[v.linkedDataTypeRefreshModeChangedEvent=
2501]="linkedDataTypeRefreshModeChangedEvent";v[v.linkedDataTypeLinkedDataTypeAddedEvent=2502]="linkedDataTypeLinkedDataTypeAddedEvent";v[v.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";v[v.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";v[v.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";v[v.rangePickerDeactivatedEvent=2701]="rangePickerDeactivatedEvent";v[v.lineageActivityUpdateAvailableEvent=2800]=
"lineageActivityUpdateAvailableEvent";v[v.lineageActivityFilterUpdatedEvent=2801]="lineageActivityFilterUpdatedEvent";v[v.lineageActivityLoadCompletedEvent=2802]="lineageActivityLoadCompletedEvent";v[v.pivotTableAddedEvent=2900]="pivotTableAddedEvent";v[v.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";v[v.namedItemAddedEvent=3E3]="namedItemAddedEvent";v[v.namedItemDeletedEvent=3001]="namedItemDeletedEvent";v[v.guidedReapplyManagerUpdateAvailableEvent=3100]="guidedReapplyManagerUpdateAvailableEvent";
v[v.vbaRecorderRecordingChangedEvent=3200]="vbaRecorderRecordingChangedEvent";v[v.vbaRecorderRecordingChanged2Event=3202]="vbaRecorderRecordingChanged2Event";v[v.workbookActionRecordedEvent=3201]="workbookActionRecordedEvent";v[v.externalCodeServiceDiagnosticsNewEntryEvent=3300]="externalCodeServiceDiagnosticsNewEntryEvent";v[v.externalCodeServiceDiagnosticsFilterUpdatedEvent=3301]="externalCodeServiceDiagnosticsFilterUpdatedEvent";v[v.rangeValuesPreviewDismissedEvent=3400]="rangeValuesPreviewDismissedEvent";
v[v.applicationUndoChangedEvent=3500]="applicationUndoChangedEvent";v[v.linkedEntityDataDomainLinkedEntityDataDomainAddedEvent=3600]="linkedEntityDataDomainLinkedEntityDataDomainAddedEvent";v[v.linkedEntityDataDomainRefreshCompletedEvent=3601]="linkedEntityDataDomainRefreshCompletedEvent";v[v.linkedEntityDataDomainRefreshModeChangedEvent=3602]="linkedEntityDataDomainRefreshModeChangedEvent";v[v.externalCodeServiceInitializationSettingsOnEnvironmentDefinitionInitializationResponseReceivedEvent=3603]=
"externalCodeServiceInitializationSettingsOnEnvironmentDefinitionInitializationResponseReceivedEvent";v[v.tableApplyPowerQueryTableUpdatePlanCompletedEvent=3604]="tableApplyPowerQueryTableUpdatePlanCompletedEvent";v[v.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";v[v.beforeCloseNotifiactionCancelledEvent=65540]="beforeCloseNotifiactionCancelledEvent";v[v.augmentationLoopAnnotationAddedEvent=65541]="augmentationLoopAnnotationAddedEvent";v[v.premiumLicenseChangedEvent=65542]=
"premiumLicenseChangedEvent"})(f||(f={}));Object(y.b)("MessageType",f);var r=a(966),d=a(283),k=a(922),t=a(65),m=a(40),e=a(197),w=a(1),l=a(765),u=a(5);class n{constructor(v,B){this.aK=null;this.cZg={};this.eZg={};this.VEd={};this.$4d={};this.iOd=(z,C)=>{z=this.$.qh.vi("Task","DdaEventDispatch.HandleServerEvent");C=C.gKg;for(let N=0;N<C.length;N++)switch(C[N].EventType){case 2:var D=C[N],J={};J.Name=D.Name;J.BindingType=D.BindingType;J.ColCount=D.ColCount;J.RowCount=D.RowCount;this.zJa(D.InstanceId,
OSF.DDA.EventDispId.dispidBindingDataChangedEvent,J,null);break;case 4:this.zJa(C[N].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(D=C[N],D.InstanceId){J=Array(D.Entries.length);for(var W=0;W<D.Entries.length;W++)J[W]=n.bAc(D.Entries[W],D.IsRemoteOverride);0<D.Entries.length&&1===D.Entries[0].Category?this.D7j(D.InstanceId,J):D.InstanceId&&this.zJa(D.InstanceId,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,J)}else{this.VEd={};this.$4d={};for(J=0;J<D.Entries.length;J++)this.ymf(D.Entries[J],
D.IsRemoteOverride);D=JSON.stringify(this.VEd);J=JSON.stringify(this.$4d);W=JSON.stringify(this.cZg);const M=JSON.stringify(this.eZg);c.ULS.sendTraceTag(537170593,0,50,`Number of Fired event: ${D}, Number of Not Fired event: ${J}, Total Number of Fired event: ${W}, Total Number of Not Fired event: ${M}`)}}z.stop()};this.S4b=(z,C)=>{this.zJa(z,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,C)};this.$=v;this.ddaFacade=B;this.EVc=this.iOd}Bkc(v){v&&(this.tva(),this.aK.push(v))}NSc(v){this.aK&&(Array.remove(this.aK,
v),this.aK.length||(this.$.wantServerEvents=!1,this.$.Xkk(this.EVc),this.aK=null))}D7j(v,B){const z=l.f.Ha()?this.ddaFacade:Object(b.a)(k.DdaFacade,d.a(this.$));m.TaskExtensions.Ua(z.JPi(v),C=>{if(e.b(C)){var D=C.result;C=z.Er(D);if(D)if(C.wGc)this.zJa(D,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,B);else if(C.Lrc)for(D=0;D<B.length;D++)C.Lrc.push(B[D]);else C.Lrc=B}else C.om?c.ULS.sendTraceTag(537170591,0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):
C.Sn&&c.ULS.sendTraceTag(537170590,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.xa,0)}Y7j(v,B){const z=u.vb.Ha()?this.ddaFacade:Object(b.a)(k.DdaFacade,d.a(this.$)),C=z.QBi(v);C?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(C,B,this.S4b):z.$_h(v,B)}ymf(v,B){let z=!1;const C=parseInt(v.Type,10);var D=v.Target;const J=u.vb.Ha()?this.ddaFacade:Object(b.a)(k.DdaFacade,d.a(this.$));if((D=J.un.TPi(C,D))&&0<Object.keys(D).length){z=
!0;for(const N in D)if(D=N,J.un.Wlc(D)){const M=Array(1);M[0]=n.bAc(v,B);if(w.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var W=M[0][3];if(void 0!==W&&null!==W&&(W=Object(b.a)(Object,t.a.Gp(W)))&&void 0!==W.triggerControlId&&null!==W.triggerControlId&&void 0!==W.triggerSource&&null!==W.triggerSource){let Q=!1;B?(W.triggerSource="Unknown",Q=!0):J.cdi(W.triggerControlId,D)&&(W.triggerSource="ThisLocalAddin",Q=!0);Q&&(M[0][3]=t.a.li(W))}}this.zJa(D,OSF.DDA.EventDispId.dispidRichApiMessageEvent,
null,M)}}z?(this.TCc(f[C],this.VEd),this.TCc(f[C],this.cZg)):(this.TCc(f[C],this.$4d),this.TCc(f[C],this.eZg))}tva(){this.aK||(this.aK=[],this.$.w1e(this.EVc),this.$.wantServerEvents=!0)}TCc(v,B){v in B||(B[v]=0);B[v]+=1}iM(v,B,z){const C={};C.Target=B;C.Category=65536;C.Type=v;C.Message=z;C.Id=-1;this.ymf(C,!1)}kvi(v,B){const z={Target:"",Category:2,Type:1E3};z.Message=B;z.Id=0;B=Array(1);B[0]=n.bAc(z,!1);this.Y7j(v,B)}wwc(v,B,z,C){const D={};D.Target=z;D.Category=65536;D.Type=B;D.Message=C;D.Id=
-1;B=Array(1);B[0]=n.bAc(D,!1);this.zJa(v,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,B)}jvi(v,B){this.zJa(v,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,B)}zJa(v,B,z,C){if(this.aK){var D=u.vb.Ha()?this.ddaFacade:Object(b.a)(k.DdaFacade,d.a(this.$));if(!D||B!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&B!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||D.un.Wlc(v)){v=new r.a(B,v,z,C);for(let J=0,W=this.aK.length;J<W;J++)(B=this.aK[J])&&B(v)}}}static bAc(v,B){const z=Array(6);
z[0]=v.Category;z[1]=v.Type;z[2]=v.Target;z[3]=v.Message;z[4]=v.Id;z[5]=B;return z}}Object(y.a)(n,"DdaEventDispatch",null,[])},1534:function(y,x,a){a.d(x,"a",function(){return f});y=a(0);x=a(236);var c=a(475),b=a(23);class f extends x.a{constructor(){super(void 0,void 0,void 0,!0);this.rRa="AddinCommandsUILessDialog";this.pjd="WACDialogTitleText";this.y8="0";this.tN=380;this.qL=190;this.Lk=this.rRa;this.Bh=5;this.Gfh=String.format("{0}px",this.tN);this.x8=String.format("{0}px",this.qL);this.qNf=this.hC=
!1;this.WF()}WF(){super.WF();this.zo.style.width=this.Gfh;this.zo.style.height=this.x8;this.zo.style.padding=this.y8}VK(r){this.GS();document.getElementById(this.Jo(this.pjd)).innerText=r}GS(){super.GS();this.Xg.style.width=String.format("{0}px",this.tN);this.Xg.style.height=String.format("{0}px",this.qL);this.Xg.removeAttribute(c.a.Oj);this.Xg.removeAttribute(c.a.BT)}hide(){this.Tkb()}get Vla(){return this.zo}initializeAndShowWithTitle(){this.initializeAndShow(Object(b.a)("NotificationUITitle"),
null,null)}}Object(y.a)(f,"AddinCommandsUILessDialog",x.a,[388])},1551:function(y,x,a){a.d(x,"a",function(){return d});y=a(0);var c=a(208),b=a(113);class f{constructor(){this.hof=this.displayName=this.iKb=this.qw=this.EK=null;this.isUpgraded=!1}a_f(k,t){return this.EK.getStoreType().toLowerCase()===k.toLowerCase()&&this.EK.getSolutionId().toLowerCase()===t.toLowerCase()}}Object(y.a)(f,"AddinCommandsResourceItem",null,[]);var r=a(23);class d{constructor(){this.S4c=null;this.h$c=0;this.Uad=!1;this.Rg=
new b.a;this.vjh=new c.a}hxh(k){this.Rg.addHandler("AddinCommandsLoadingMessageChanged",k)}Yhk(k){this.Rg.removeHandler("AddinCommandsLoadingMessageChanged",k)}get lFa(){return this.S4c}gvb(k){k!==this.S4c&&(this.S4c=k,this.Rg.raiseEvent("AddinCommandsLoadingMessageChanged"))}ryk(){this.h$c++;this.lFa||this.gvb(Object(r.a)("LoadingAddInsTitle"))}lme(){this.h$c--;this.zJc()&&(this.Uad?this.lFa!==Object(r.a)("ErrorLoadingAddInsTitle")&&this.gvb(Object(r.a)("ErrorLoadingAddInsTitle")):this.gvb(null))}BLg(k){this.Uad=
!0;this.gvb((void 0===k?0:k)?Object(r.a)("InstallingCustomFunctionsErrorStatusBarMsg"):Object(r.a)("ErrorLoadingAddInsTitle"))}Cbf(){this.Uad=!1;this.zJc()?this.gvb(null):this.gvb(Object(r.a)("LoadingAddInsTitle"))}zJc(){return 0>=this.h$c}get ylb(){return this.vjh}Iva(k,t,m){m=void 0===m?0:m;for(const e of this.ylb)if(e.a_f(k,t)&&(!e.qw||e.qw.lBi===m))return e;return null}l_e(k,t,m,e){const w=new f;w.EK=k;w.qw=t;w.iKb=m;w.displayName=e;this.ylb.add(w)}avh(k,t,m,e){const w=new f;w.EK=k;w.qw=t;w.iKb=
null;w.hof=m;w.displayName=e;this.ylb.add(w)}jgk(k,t){let m=0;for(const e of this.ylb)e.EK.getStoreType()===k&&e.EK.getSolutionId()===t?this.ylb.removeAt(m):m++}static getInstance(){d.Wa||(d.Wa=new d);return d.Wa}}d.Wa=null;Object(y.a)(d,"AddinCommandsResourceManager",null,[])},357:function(y,x,a){function c(H,va){var ub=document.getElementById(H);ub?va?ub.innerHTML=va:ub.remove():va&&(ub=document.createElement("style"),ub.id=H,ub.type="text/css",ub.innerHTML=va,document.head.appendChild(ub))}function b(H){H=
H.map(va=>`[data-icon-name=${"AddinFlyoutControl"+va}]::after {
      content: "";
      position: absolute;
      top: 9px;
      right: 18px;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background-color: #CC4A31;
    }`).join("");c("RedDotNotification",H)}function f(H){H=H.map(va=>`[data-icon-name=${"AddinFlyoutControl"+va}]::after {
        content: "New";
        position: absolute;
        top: 6px;
        right: 10px;
        width: 30px;
        height: 16px;
        border-radius: 50%/100%;
        border: white 1px solid;
        background-color: #185abd;
        color: white;
        font-size: 10px;
        font-style: normal;
    }`).join("");c("NewStringNotification",H)}function r(H){c("ButtonGroupHighlight",`#${H}[type="button"] { font-weight: 600; background-color: var(--legacy_themeDark); color: white; }`)}function d(H){return No(function*(){let va;for(let je=0;10>je;++je)(va=document.getElementById("fluent-default-layer-host"))||(yield new Promise(Ue=>setTimeout(Ue,1E3)));if(!va)throw Error("Cannot find the flyout container.");let ub=!1,kc=performance.now(),Oc;const pd=je=>{const Ue=performance.now();je?(ub=!0,H(!0,
0),kc=Ue):ub&&(ub=!1,H(!1,Ue-kc))},Sd=je=>{Oc&&Oc.disconnect();const Ue=je.querySelector('[id="InsertAddInFlyoutMenuId"]');Ue?(Oc=new MutationObserver(G=>{for(const da of G)"attributes"===da.type&&da.target instanceof HTMLElement&&("InsertAddInFlyoutMenuId"!==da.target.id?pd(!1):pd(!0))}),Oc.observe(Ue,{attributes:!0,attributeFilter:["id"]}),pd(!0)):(Oc=new MutationObserver(G=>{for(const da of G)"attributes"===da.type&&da.target instanceof HTMLElement&&("hidden"===da.target.style.visibility?pd(!1):
pd(!0))}),Oc.observe(je,{attributes:!0,attributeFilter:["style"]}),"hidden"!==je.style.visibility&&pd(!0))},Wd=new WeakSet,ee=new MutationObserver(je=>{for(const G of je){for(je=0;je<G.addedNodes.length;++je){var Ue=G.addedNodes.item(je);Ue instanceof HTMLElement&&(Ue.querySelector('[id="Ribbon-InsertAddInFlyoutDropdown"]')||Ue.querySelector('[id="InsertAddInFlyoutMenuId"]'))&&(Sd(Ue.querySelector(".ms-Callout-container")),Wd.add(Ue))}for(je=0;je<G.removedNodes.length;++je)Ue=G.removedNodes.item(je),
Wd.has(Ue)&&(Wd.delete(Ue),pd(!1))}});ee.observe(va,{attributes:!1,childList:!0});return{dispose:()=>{ee.disconnect();null===Oc||void 0===Oc?void 0:Oc.disconnect()}}})}function k(H,va){const ub=[];va=new vh(va);for(var kc=0;30>kc;kc++)Array.add(ub,va.next(H.count));va=0;for(const Oc of H){kc=!1;for(const pd of ub)if(va===pd){kc=!0;break}va++;if(kc){let pd;(pd=Oc.addinInfo).AUP=20*pd.AUP}else if(1===Oc.addinInfo.priority){let pd;(pd=Oc.addinInfo).AUP=4*pd.AUP}else if(2===Oc.addinInfo.priority){let pd;
(pd=Oc.addinInfo).AUP=2*pd.AUP}}H.Sc((Oc,pd)=>Oc.addinInfo.AUP<pd.addinInfo.AUP?1:-1);return H}function t(H){return Telemetry.PrivacyRules.GetPrivacyCompliantId(H.solutionId,H.storeType,H.assetId,null,null,H.storeId)}function m(H,va){return Object.assign(new H,va)}function e(H,va,ub){c(H,va?`
  [id="Ribbon-InsertAddInFlyoutDropdown"], [id="InsertAddInFlyoutMenuId"] {
    [class^="container-"] {
      >ul>li:nth-child(${ub}) {
        width: 330px;
        background-color: var(--colorBrandBackground2);
        border-radius: 8px;
        margin-left: 18px;
        margin-bottom: 14px;

        [id$="ErrorView"] {
          width: 100%;
          height: 102px;
          display: flex;
          flex-direction: row;

          >i {
            width: 100%;
            height: 102px;
            margin-left: 20px;

            >svg {
              width: 330px;
              border-radius: 8px 8px 0px 0px;
            }
          }
          >div {
            margin-top: 0;

            >label {
              font-weight: 600;
              text-align: left;
              color: var(--colorNeutralForeground1);
            }
          }
        }

        button {
        }
      }
    }
  }

  @media screen and (-ms-high-contrast: active), screen and (forced-colors: active) {
    [id="Ribbon-InsertAddInFlyoutDropdown"], [id="InsertAddInFlyoutMenuId"] {
      [class^="container-"] {
        >ul>li:nth-child(${ub}) {
          button {
          }
        }
      }
    }
  }

  .addin-flyout-highlight {
    transition: all 0.5s;
    background-color: var(--legacy_themeLighter);
  }

  .addin-flyout-highlighted {
    background-color: rgba(0, 0, 0, 0);
  }

  button[id^=FRECarouselSwitchIcon_LEFT], button[id^=FRECarouselSwitchIcon_RIGHT] {
    width: 16px;
    height: 18px;
    font-size: 8px;
    background-color: transparent;

    >span >i {
      font-weight: 600;
      color: var(--legacy_white);
    }

    cursor: pointer;
  }

  button[id^=FRECarouselSwitchIcon_MIDDLE] {
    width: 34px;
    height: 14px;
    font-size: 10px;
    background-color: transparent;

    >span >div {
      font-weight: 600;
      color: var(--legacy_white);
      margin: 0px;
      overflow-x: visible;
    }
  }

  [id=FRECarouselDescriptionIconView] {
    padding-left: 0;
    margin-left: 0;
  }

  [id=FRECarouselDescriptionIconView]>span {
    height: unset;
    background-color: var(--colorNeutralBackground1);
    padding: 6px 4px;
    box-sizing: border-box;
    border: 1px solid var(--border-color);
    display: inline-block;
    text-decoration: none;
    text-align: center;
    cursor: pointer;
    vertical-align: top;
    border-radius: 4px;
    font-size: 11px;
    font-weight: 700;
    position: relative;
    word-break: keep-all;
    user-select: none;
    white-space: nowrap;
  }

  [id^=FRECarouselDescriptionIcon] {
    cursor: pointer;
  }
  `:"")}function w(){return Object(La.a)("AddinsFlyoutSeeAllButtonText")}function l(H){const va={["Word"]:{["APID"]:Object(La.a)("AddInCategoryDescriptionAddingPicturesIconsDiagramsWord")||"Add photos, icons, and diagrams to your documents.",["ER"]:Object(La.a)("AddInCategoryDescriptionEducationalResources")||"Resources for educators and students.",["IPWAI"]:Object(La.a)("AddInCategoryDescriptionImprovingProductivityWithAIWord")||"Draft and summarize with the power of generative AI.",["WF"]:Object(La.a)("AddInCategoryDescriptionWritingFluently")||
"Get help with spelling, grammar, and more."},["Excel"]:{["APID"]:Object(La.a)("AddInCategoryDescriptionAddingPicturesIconsDiagramsExcel")||"Add photos, icons, and diagrams to spreadsheets.",["DA"]:Object(La.a)("AddInCategoryDescriptionDataAnalytics")||"Get key insights about the data in your speadsheets",["IPWAI"]:Object(La.a)("AddInCategoryDescriptionImprovingProductivityWithAIExcel")||"Use the power of AI to capture and understand your data.",["FA"]:Object(La.a)("AddInCategoryDescriptionFinancialAnalytics")||
"Track expenses, budget, and more."},["PowerPoint"]:{["IPWAI"]:Object(La.a)("AddInCategoryDescriptionImprovingProductivityWithAIPowerPoint")||"Use the power of AI in your presentations.",["APID"]:Object(La.a)("AddInCategoryDescriptionAddingPicturesIconsDiagramsPowerPoint")||"Add photos, icons, and diagrams to slides.",["CAIP"]:Object(La.a)("AddInCategoryDescriptionCreatingAnInteractivePresentation")||"Add polls, timers, and more.",["DWT"]:Object(La.a)("AddInCategoryDescriptionDesigningWithTemplates")||
"Create beautiful slides with templates you can customize."},vOg:{["BBM"]:Object(La.a)("AddInCategoryDescriptionBuildByMicrosoft")||"Create surveys, visualize data, and more, all from Microsoft.",["TD"]:Object(La.a)("AddInCategoryDescriptionTrending")||"Recently added by others.",["WN"]:Object(La.a)("AddInCategoryDescriptionWhatsNew")||"Brand new or updated add ins.",["PAIYO"]:Object(La.a)("AddInCategoryDescriptionPopularAddinsInYourOrg")||"Add ins people add and use the most in your organization."}}.Word[H];
return va?va:"IPWAI"===H?Object(La.a)("AddinsFREDescriptionWordAI"):"WF"===H?Object(La.a)("AddinsFREDescriptionWordWriting"):"APID"===H?Object(La.a)("AddinsFREDescriptionWordInsertGraphics"):"FlyoutBannerCommon"}function u(H,va,ub){const kc=Sd=>{switch(Sd){case li.LEFT:return Object(La.a)("AddinsFRECarouselPreviousButton");case li.RIGHT:return Object(La.a)("AddinsFRECarouselNextButton");case li.cja:return`${ub+1} of ${va}`;default:return""}},Oc=[li.LEFT,li.cja,li.RIGHT],pd=m(Mj.a,{Id:"AddInFlyoutFREBanner",
ExternalId:"AddInFlyoutFREBanner",IconName:"IPWAI"===H?"FREWordBannerAI":"WF"===H?"FREWordBannerWriting":"APID"===H?"FREWordBannerInsertGraphics":"FREWordBannerGPTForExcelWord"});return m(kh.a,{ControlList:[...Oc.map(Sd=>{var Wd=Nj.a,ee=Vf.a.EZc.toString();a:switch(Sd){case li.LEFT:var je="ChevronLeft";break a;case li.RIGHT:je="ChevronRight";break a;default:je=null}Wd=m(Wd,{Id:`FRECarouselSwitchIcon_${Sd}_${va}`,ExternalId:`FRECarouselSwitchIcon_${Sd}_${va}`,Command:ee,Icon:je,FullIconStyle:{["root"]:{position:"absolute",
width:"100%",height:"100%"}},Role:"button",Alt:kc(Sd),LabelText:Sd===li.cja?`${ub+1} of ${va}`:null});Wd=m(Xj,{SectionId:"FRECarouselSwitchIconSection_"+Sd,GalleryButtons:[Wd]});return m(fk.a,{Id:"FRECarouselSwitchButton_"+Sd,ExternalId:"FRECarouselSwitchButton_"+Sd,GalleryStyle:{["galleryStack"]:{["root"]:{position:"absolute",maxWidth:"unset",width:Sd===li.cja?"35px":"16px",height:"18px",padding:"0px",zIndex:Sd===li.cja?"2":"3",top:"79px",left:Sd===li.LEFT?"267px":Sd===li.cja?"279px":"309px",borderRadius:Sd===
li.LEFT?"18px 0px 0px 18px":Sd===li.cja?"none":"0px 18px 18px 0px",backgroundColor:"var(--legacy_themeDarker)"},["inner"]:{margin:"0px",width:Sd===li.cja?"34px":"18px",height:"18px"}}},Type:4,GallerySections:[Wd],DismissHostingSurfaceOnExecute:!1})}),pd,m(fk.a,{Id:"FRECarouselDescription",ExternalId:"FRECarouselDescription",GalleryStyle:{["galleryStack"]:{["root"]:{["maxWidth"]:"100%",["padding"]:"0px",["cursor"]:"pointer"},["inner"]:{["padding"]:"2px",["flex-wrap"]:"nowrap"}},["galleryButtonInExpanded"]:{["root"]:{"white-space":"normal",
backgroundColor:"transparent",textAlign:"left",width:"unset",height:"unset",fontWeight:500,fontSize:13,padding:"4px 6px 8px"},["flexContainer"]:{},["label"]:{}}},Type:4,GallerySections:[m(Xj,{SectionId:"FRECarouselDescriptionSection",GalleryButtons:[m(Nj.a,{Id:"FRECarouselDescriptionIcon",Command:Vf.a.DZc.toString(),ExternalId:"FRECarouselDescriptionIcon",FullIconStyle:{["root"]:{["display"]:"none"}},Alt:l(H),Role:"button",LabelText:l(H)}),m(Nj.a,{Id:"FRECarouselDescriptionIconView",Command:Vf.a.DZc.toString(),
ExternalId:"FRECarouselDescriptionIconView",FullIconStyle:{["root"]:{["display"]:"none"}},Alt:w(),Role:"button",LabelText:w()})]})],DismissHostingSurfaceOnExecute:!1})]})}function n(H,va,ub){c(H,va?`
  [id="Ribbon-InsertAddInFlyoutDropdown"], [id="InsertAddInFlyoutMenuId"] {
    [class^="container-"] {
      >ul>li:nth-child(${ub}) {
        width: 330px;
        background-color: var(--colorBrandBackground2);
        border-radius: 8px;
        margin-left: 18px;
        margin-bottom: 5px;

        [id$="ErrorView"] {
          width: 100%;
          height: 102px;
          display: flex;
          flex-direction: row;

          >i {
            width: 100%;
            height: 102px;
            margin-left: 20px;

            >svg {
              width: 330px;
              border-radius: 8px 8px 0px 0px;
            }
          }
          >div {
            margin-top: 0;

            >label {
              font-weight: 600;
              text-align: left;
              color: var(--colorNeutralForeground1);
            }
          }
        }

        button[role="menuitem"] {
          margin-left: 0px;
          width: 100%;
          padding: 15px 13px;
          box-sizing: border-box;

          >i {
            border: none;
            min-width: 36px;
            height: 36px;
            padding: 3px;
            background-color: #fff;
          }

          >div>div>span {
            white-space: normal;
            text-align: left;
            margin-bottom: 5px;
          }

          &:hover {
            background-color: transparent;
            border-color: transparent;
          }

          &:focus {
            background-color: transparent;
          }
        }
      }
    }
  }

  @media screen and (-ms-high-contrast: active), screen and (forced-colors: active) {
    [id="Ribbon-InsertAddInFlyoutDropdown"], [id="InsertAddInFlyoutMenuId"] {
      [class^="container-"] {
        >ul>li:nth-child(${ub}) {
          button[role="menuitem"] {
            &:hover {
              background-color: highlight;
            }
          }
        }
      }
    }
  }
  `:"")}function v(H,va){if(!H)switch(va){case "Word":return["wa200005502"];case "Excel":return["wa200005502"];case "PowerPoint":return["wa200005566"];default:return[]}return H.split("|")}function B(H,va){a:{var ub=va.solutionId;switch(null===ub||void 0===ub?void 0:ub.toLowerCase()){case "wa200005502":if("Word"===H){ub="FREWordBannerGPTForExcelWord";break a}if("Excel"===H){ub="FREBannerGPTForExcelWord";break a}}ub="FlyoutBannerCommon"}a:{var kc;switch(H){case "Excel":H="Boost your productivity in Excel with this ChatGPT add-in.";
break a;case "PowerPoint":H=null!==(kc=Object(La.a)("AddinsFlyoutFREDescriptionPPT"))&&void 0!==kc?kc:"Elevate your slides! Add-ins for flawless presentations.";break a;default:H="Boost your productivity in Word with this ChatGPT add-in."}}va=m(cl.a,{Id:"AddInFlyoutPopularBannerAction",iconSet:null,ExternalId:"AddInFlyoutPopularBannerAction",CommandId:"AddInFlyoutPopularBannerAction",CommandIdMapped:Vf.a.nob.toString(),SecondaryLabel:null,Label:H,ActionText:Object(La.a)("AddinListAdd"),Links:[m(Mk,
{text:Object(La.a)("AddinOneLink"),href:"https://appsource.microsoft.com/en-us/product/office/"+va.solutionId})],ActionId:Vf.a.o_a.toString(),ActionIdMapped:Vf.a.o_a.toString(),ActionCommandValueId:va.solutionId,CommandValueId:va.solutionId});va=[m(Mj.a,{Id:"AddInFlyoutPopularBanner",ExternalId:"AddInFlyoutPopularBanner",IconName:ub}),va];return m(kh.a,{ControlList:va})}function z(H){H.MenuSectionList.some(va=>va.ControlList.some(ub=>"AddInFlyoutPopularBanner"===ub.Id))||n("PopularBanner",!1,-1)}
function C(H,va,ub,kc,Oc,pd,Sd){kc.concat(Oc).find(Wd=>Wd.solutionId.toLowerCase()===H.solutionId.toLowerCase())?va.MenuSectionList.push(ub):(kc=B(Sd,H))?(Oc=va.MenuSectionList.some(Wd=>"MRUAddinsSection"===Wd.Id),pd=pd&&Oc?2:3,va.MenuSectionList.push(m(kh.a,Object.assign({},ub,{ControlList:ub.ControlList.slice(0,pd)}))),va.MenuSectionList.push(kc),n("PopularBanner",!0,va.MenuSectionList.length),va.MenuSectionList.push(m(kh.a,Object.assign({},ub,{ControlList:ub.ControlList.slice(pd),Title:null})))):
va.MenuSectionList.push(ub)}function D(H){const va=document.createElement("div");va.innerHTML=`
  ${'<svg style="animation: addin-flyout-bounce 1.5s infinite;" width="16" height="10" viewBox="0 0 9 6" xmlns="http://www.w3.org/2000/svg">\n  <path class=\'OfficeIconColors_HighContrast\' d="M7.89612 4.86822C8.09952 5.07162 8.42929 5.07162 8.63269 4.86822C8.83609 4.66482 8.83609 4.33505 8.63269 4.13165L4.86926 0.36822C4.76734 0.266293 4.63367 0.215444 4.50008 0.215672C4.36676 0.215652 4.23343 0.266502 4.13171 0.368221L0.368285 4.13165C0.164887 4.33505 0.164887 4.66482 0.368285 4.86822C0.571683 5.07162 0.901456 5.07162 1.10485 4.86822L4.50049 1.47259L7.89612 4.86822Z"/>\n  <path style="fill: var(--colorNeutralForeground1)" d="M7.89612 4.86822C8.09952 5.07162 8.42929 5.07162 8.63269 4.86822C8.83609 4.66482 8.83609 4.33505 8.63269 4.13165L4.86926 0.36822C4.76734 0.266293 4.63367 0.215444 4.50008 0.215672C4.36676 0.215652 4.23343 0.266502 4.13171 0.368221L0.368285 4.13165C0.164887 4.33505 0.164887 4.66482 0.368285 4.86822C0.571683 5.07162 0.901456 5.07162 1.10485 4.86822L4.50049 1.47259L7.89612 4.86822Z"/>\n  </svg>'}
  <div style="font-weight: 600; font-size: 18px; font-family: "Segoe UI Semibold", "Segoe UI Semibold_EmbeddedFont", "Segoe UI Semibold_MSFontService", sans-serif;">${H}</div>`;return va}function J(){const H=[];document.body.querySelectorAll('\n  [id="Ribbon-InsertAddInFlyoutDropdown"] [class^="container-"], [id="InsertAddInFlyoutMenuId"] [class^="container-"]').forEach(va=>{H.push(va)});return H}function W(){c("AppsFlyoutScrollIndicator","\n  @keyframes addin-flyout-bounce {\n    0% {\n      transform: translateY(0);\n    }\n    50% {\n      transform: translateY(-5px);\n    }\n    100% {\n      transform: translateY(0);\n    }\n  }\n  ");
d(H=>{var va;if(H&&!("MRUAddinsGalleryControl"in appChrome.selectors.getFlyoutAnchorMenuItems("InsertAddInFlyout"))){var ub=J();if(0!==ub.length){H=kc=>{if(!(0>=kc.deltaY)){kc=kc.currentTarget;var Oc=kc.querySelector("#apps-flyout-scroll-indicator");!Oc||10>kc.scrollTop||(Oc.style.opacity="0",Bc.a.sendTelemetryEvent(m(Ob.a,{name:"Office.Extensibility.Host.AddInFlyoutFREScrolled"})))}};for(const kc of ub)kc.style.position="relative",kc.removeEventListener("wheel",H),kc.addEventListener("wheel",H),
null===(va=kc.querySelector("#apps-flyout-scroll-indicator"))||void 0===va?void 0:va.remove(),ub=D(Object(La.a)("AddinsFlyoutScrollDownHintText")||"Scroll up to explore more!"),ub.setAttribute("style","pointer-events: none; transition: all 0.5s ease-out; padding: 30px 0 5px 0; width: 100%; position: fixed; left: 0; bottom: 69px; display: flex; flex-direction: column; justify-content: center; align-items: center; background: linear-gradient(rgb(from var(--colorNeutralBackground1) r g b / 0%) 5px, rgb(from var(--colorNeutralBackground1) r g b / 80%), rgb(from var(--colorNeutralBackground1) r g b / 90%));"),
ub.id="apps-flyout-scroll-indicator",kc.appendChild(ub)}}})}a.r(x);var N={};a.r(N);a.d(N,"AgaveCommandHandler",function(){return Ea});var M={};a.r(M);a.d(M,"AgaveListenerHandler",function(){return Ya});var Q={};a.r(Q);a.d(Q,"AgaveOnSelectedReadoutHandler",function(){return ka});var R={};a.r(R);a.d(R,"DdaMethodHandler",function(){return bf});var O={};a.r(O);a.d(O,"MacroRecorderEventHandler",function(){return Ci});var U={};a.r(U);var K={};a.r(K);a.d(K,"SmartLookupCommandHandler",function(){return Oh});
var F=a(179),I=a(0),P=a(6),Y=a(956),ea=a(24),Ba=a(25),Fa=a(40),za=a(1),xa=a(209),fa=a(35),V=a(356),ba=a(5),la=a(765),Ta=a(97);let Ea=class{constructor(H,va){this.$=H;this.agaveCommandManager=va;this.ha=ea.f(this.$).ha;this.qa=this.ha.qa}Ji(){return!1}Bi(){return!1}ni(H,va,ub,kc){let Oc=!1;switch(va.command){case -684355545:Oc=!0;break;case -741808261:Oc=!!ub;break;case -859308420:Oc=!!kc&&1===kc.ZN;break;case 418618014:Oc=1===H&&!!kc&&1===kc.ZN;break;case -167264441:Oc=Ba.a.eUb(this.$)&&1===H&&!!kc&&
1===kc.ZN;break;case -515602470:Oc=1===H&&!!kc&&1===kc.ZN;break;case -1444574190:case -336193495:Oc=1===H&&!!kc&&1===kc.ZN;break;case 1296389134:Oc=1===H&&!!kc&&1===kc.ZN;break;case 1221897806:Oc=za.EwaSettings.Ra(155)&&2===H;break;case 1172793074:case 1930653487:Oc=za.EwaSettings.Ra(155)&&2===H;break;case -1753056834:Oc=!0;break;case 932597253:Oc=!0;break;case 301511274:Oc=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:Oc=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",
!0)&&this.$.isEditMode;break;case 1723441034:Oc=this.$.isEditMode&&this.$.ea.g6b;break;case -1997160483:Oc=Ba.a.FU()&&this.$.isEditMode&&this.qa.FI();break;case 1485761473:Oc=Ba.a.FU()&&this.$.isEditMode;break;case 762629271:Oc=Ba.a.FU()&&za.EwaSettings.isChangeGateEnabled("OfficeVSO:8386937_NoCopilotTaskPaneWhenNoExtractPermissions")}return Oc}executeCommand(H,va,ub){H=Fa.TaskExtensions.sq();const kc=va.command;switch(va.command){case 1296389134:P.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowFlyoutSurveyOnExcelEnabled",
!1)&&Y.a.instance.getItem("removeFlyoutTaskTimeoutId")&&(window.clearTimeout(Number(Y.a.instance.getItem("removeFlyoutTaskTimeoutId"))),Y.a.instance.removeItem("removeFlyoutTaskTimeoutId"));this.agaveCommandManager.YQk(ub.SourceControlId,ub.LabelText);break;case -684355545:this.agaveCommandManager.isd();break;case -741808261:H=this.agaveCommandManager.insertAgave(ub,va);break;case 1172793074:za.EwaSettings.Ra(155)&&(H=this.agaveCommandManager.TNd(ub,va));break;case -1997160483:case 1485761473:if(za.EwaSettings.isChangeGateEnabled("OfficeVSO:8386937_NoCopilotTaskPaneWhenNoExtractPermissions")&&
this.Idi()){this.y1h();break}Ba.a.dTd()&&void Ta.a.resolve(ba.gb,{va:0}).then(Oc=>{Oc.d1c(!0)});H=this.agaveCommandManager.TNd(ub,va);break;case -859308420:case -515602470:case -167264441:case -336193495:case -1444574190:case 418618014:case 1221897806:case 1930653487:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:case 762629271:H=this.agaveCommandManager.TNd(ub,va);break;default:H=xa.a(kc)}return H}Idi(){var H=this.$.Tj;const va=H.get(1),ub=H.get(4);H=H.get(117);return(va||
ub)&&!H}y1h(){const H=fa.a.Yi(1,1,751,2407,0,0,"CopilotNoExtractPermissionsErrorDialog");new V.a(this.$,H)}};Ea=Object(F.__decorate)([Object(Ta.d)(ba.h),Object(F.__param)(0,Object(ba.Lb)()),Object(F.__param)(1,Object(la.a)())],Ea);Object(I.a)(Ea,"AgaveCommandHandler",null,[39]);var sa=a(14);let Ya=class{constructor(H){this.$=H;this.FMf=va=>{if(null!==va&&void 0!==va&&va.data&&(va=va.data)&&"OfficeCopilotExcelTaskPane"===va.Origin)switch(va.Event){case "Office.Excel.Copilot.AnalyzeReceived":this.oca(-168711560);
break;case "Office.Excel.Copilot.GenerateReceived":this.oca(-1805433217);break;case "Office.Excel.Copilot.CommandReceived":this.oca(-112212005);break;case "Office.Excel.Copilot.AnalyzeApplied":this.oca(347349230);break;case "Office.Excel.Copilot.GenerateApplied":this.oca(-2005275355);break;case "Office.Excel.Copilot.CommandApplied":this.oca(306959157);break;default:sa.ULS.sendTraceTag(508044939,0,10,"AgaveListenerHandler.handleMessageReceived - Unhandled Event.")}}}addListener(){window.addEventListener("message",
this.FMf,!1)}removeListener(){window.removeEventListener("message",this.FMf,!1)}oca(H){this.$.ei(H,-1,0,null)}};Ya=Object(F.__decorate)([Object(Ta.d)(ba.i),Object(F.__param)(0,Object(ba.Lb)())],Ya);Object(I.a)(Ya,"AgaveListenerHandler",null,[]);var bb=a(96),ra=a(353),Da=a(158),oa=a(58),Ha=a(54);let ka=class{constructor(H,va){this.F4a=this.G4a=null;this.LZg=(ub,kc)=>{let Oc=null,pd=null,Sd=null;kc?(Object(ra.a)(318,kc)?(Oc=kc.EGb,Sd=kc.instanceId):Object(ra.a)(440,kc)&&(Oc=kc.get_element(),Sd=kc.instanceId),
Oc)?(pd=Object(Da.a)(321,ub),pd)?this.Rxg(Sd,Oc,pd)||Sd in this.F4a||(this.G4a[Sd]=0,this.F4a[Sd]=oa.a.instance.jO(()=>{10<=this.G4a[Sd]||this.Rxg(Sd,Oc,pd)?(delete this.G4a[Sd],this.F4a[Sd].dispose(),delete this.F4a[Sd]):this.G4a[Sd]+=1},500,Ha.a.zCh,!0,!1)):sa.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):sa.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):sa.ULS.sendTraceTag(537170626,0,10,
"Invalid parameter for ReadoutSelection")};this.ariaLiveNotifier=H;this.$=va;this.Hpd=!1}Aa(H){this.Hpd?sa.ULS.sendTraceTag(537170629,0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):(this.Hpd=!0,this.F4a={},this.G4a={},H?H.Xxh(this.LZg):sa.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))}detach(H){if(H){H.Gik(this.LZg);H=this.F4a;for(const va in H)bb.a.Ng(H[va]);this.G4a=this.F4a=null;this.Hpd=!1}else sa.ULS.sendTraceTag(537170627,
0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")}Rxg(H,va,ub){if(this.pej(ub,H))return!1;H=va.querySelector("iframe");if(!H)return sa.ULS.sendTraceTag(537170595,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;H=H.title;if(!H||!H.length)return sa.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;this.ariaLiveNotifier.readText(H);return!0}pej(H,va){return(H=H.wl.getOsfControl(va))?
H.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0}};ka=Object(F.__decorate)([Object(Ta.d)(ba.j),Object(F.__param)(0,Object(ba.l)()),Object(F.__param)(1,Object(ba.Lb)())],ka);Object(I.a)(ka,"AgaveOnSelectedReadoutHandler",null,[441]);var wa=a(922),Za=a(1490);class ab{constructor(){this.context=null;this.errorCode=0}}Object(I.a)(ab,"NestedAppAuthContextResult",null,[]);class db{static CKd(H,va){const ub=new ab;(H=H.getOsfControl(va))&&H.isFirstParty()?(ub.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,
H={},va=P.AFrameworkApplication.fa.Xa("AADUserObjectId"),H.userObjectId=va?va:P.AFrameworkApplication.fa.Xa("LoggableUserId"),H.userPrincipalName=P.AFrameworkApplication.fa.Xa("UserPrincipalName"),H.tenantId=P.AFrameworkApplication.fa.Xa("TenantId"),H.puid=P.AFrameworkApplication.fa.Xa("Puid"),H.authorityBaseUrl=P.AFrameworkApplication.fa.Xa("HostAuthAuthority"),va=(P.AFrameworkApplication.fa.Xa("HostAuthType")||"").toLowerCase(),H.authorityType="aad"===va?"aad":"msa"===va?"msa":"other",ub.context=
H):ub.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeAccessDenied;return ub}}Object(I.a)(db,"NestedAppAuthUtil",null,[]);var mb=a(1103),Ia=a(1238),pa=a(1156);class lb{}lb.generalException="generalException";lb.invalidArgument="invalidArgument";lb.Qbg="notAllowed";lb.wlc="apiNotAvailable";lb.k2k="unresolvedPendingRequest";lb.timeout="timeout";lb.xld="adalTimeout";lb.$xe="userNotSignedIn";lb.$xb="userAborted";lb.$Sg="silentSignInFailed";lb.Alb="invalidResourceUrl";lb.FDc="invalidGrant";lb.Kef="connectionLost";
lb.Yoc="clientError";lb.serverError="serverError";Object(I.a)(lb,"WopiHostErrorCodes",null,[]);var ha=a(908),ua=a(596);class fb{}Object(I.a)(fb,"OAuthCallerMetadata",null,[]);var Ka=a(34),La=a(23);class ib{constructor(H){this.zya=H;this.Zgh=P.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}msh(H,va,ub,kc,Oc,pd){if(!this.zya)return kc=new Ia.a,kc.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(kc);const Sd=new fb;
Sd.AddinName=Oc;Sd.AddinTrustId=pd;let Wd=-1,ee=-1;pd=null;const je=P.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.EnableAddinPopupTimerTelemetry"),Ue=(G,da,$a,Sb,Mc)=>{const sd=Date.now();return this.zya.e0c(G,da,$a,Sb,Mc).then(Od=>{ee=Date.now()-sd;return Od})};if(kc&&this.xXf())pd=je?Ue(ha.a.Nwb,H,kc,ib.Ozc(Oc),Sd):this.zya.e0c(ha.a.Nwb,H,kc,ib.Ozc(Oc),Sd);else{const G=Date.now();pd=this.zya.JD(ha.a.Nwb,H,Sd).then(da=>{Wd=Date.now()-G;const $a=(va||ub)&&
("login_required"===da.ErrorCode||"Cookies Disabled"===da.ErrorCode);return(va&&("interaction_required"===da.ErrorCode||"consent_required"===da.ErrorCode||"invalid_grant"===da.ErrorCode||"UserInteractionRequired"===da.ErrorCode)||$a)&&this.xXf()?je?Ue(ha.a.Nwb,H,null,ib.Ozc(Oc),Sd):this.zya.e0c(ha.a.Nwb,H,null,ib.Ozc(Oc),Sd):Promise.resolve(da)})}return pd.then(G=>{const da=new Ia.a;G.IsSuccess?(da.token=G.Token,G.Telemetry&&(da.xPa=G.Telemetry.fromCache,da.expiresOn=G.Telemetry.expiresOn)):(da.errorCode=
this.LBj(G),da.xte=this.a1j(G));return da}).catch(()=>{const G=new Ia.a;G.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(G)}).then(G=>{G.Nta="OauthManager";0<=Wd&&(G.qJa=Wd);0<=ee&&(G.OQb=ee);return G})}Lhj(H){const va=(P.AFrameworkApplication.fa.Xa(P.AFrameworkApplication.vZ)||"").toLowerCase();return(P.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.Enable3rdPartySsoApiForTeams")||!(Ka.a.PKa||"teams"===va&&ua.a.cSb)||
ib.nhj(H))&&this.zya&&this.zya.D_a()?!0:!1}xXf(){return this.Zgh||1!==pa.a.Gxc()}LBj(H){switch(H.ErrorCode){case "UserCancelled":case "interaction_required":H=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "UserInteractionRequired":case "consent_required":case "invalid_grant":H=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":H=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":H=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":H=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":H=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:H=H.ErrorCode===lb.$xb?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:H.ErrorCode===lb.$Sg?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:H.ErrorCode===lb.Alb?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:H.ErrorCode===
lb.FDc?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:H.ErrorCode===lb.Kef?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return H}a1j(H){let va="";(H=RegExp("AADSTS(\\d+)").exec(H.ErrorMessage))&&1<H.length&&(va=H[1]);return va}static Ozc(H){return String.format(Object(La.a)("SSOSignInNeededNotification_Description_Text_Addins"),H)}static nhj(H){if(!H)return!1;H=H.toLowerCase();for(const va of Za.a.nxf)if(va===H)return!0;return!1}}
Object(I.a)(ib,"AppsforOfficeTokenFromOauthManager",null,[421]);class Yb{constructor(H){this.NAj=H}static LBa(){if(P.AFrameworkApplication.fa.la("AppForOfficeSSOV2IsEnabled")){var H=null;try{H=Object(mb.a)()}catch(va){sa.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+va)}H=new ib(H);Yb.Wa=new Yb(H)}}static getInstance(){Yb.FKe||(Yb.LBa(),Yb.FKe=!0);return Yb.Wa}}Yb.Wa=null;Yb.FKe=!1;Object(I.a)(Yb,"AppsForOfficeOauthManagerFactory",null,[405]);var Wc=a(42),Qc=a(188),Wb=a(1409),
Jc=a(187);class ma{constructor(H,va,ub,kc){this.menuItemId=H;this.FE=va;this.pSk=ub;this.pti=kc}}Object(I.a)(ma,"NewDocumentParameters",null,[]);var Hc=a(10);const Kb=H=>{var va=H.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var ub=va.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);ub.addParameter("shortcuts","String[]",1,null,0);va.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);ub=va.addMethod("ReplaceShortcuts",
2,"Void",0,0,"ReplaceShortcuts",0);ub.addParameter("shortcuts","Object",1,null,0);va=H.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);ub=va.addMethod("GetSharedFilePickerResponse",1,"Object",1,1,"SharedFilePickerResponse",0);ub.addParameter("pickerCustomizationJsonString","String",1,null,0);va=H.addType("Microsoft.Office.Auth","{8f3d8395-fba3-422f-9e98-33e38d23c2ba}","{e1b105a8-d9d5-4fc8-aa4e-3d90aeb48abf}",3,2);ub=
va.addMethod("GetAccessTokenFirstPartyOAuth",1,"Object",1,1,"AccessTokenFirstPartyOAuth",4);ub.addParameter("appName","String",1,null,0);ub.addParameter("target","String",1,null,0);va=H.addType("Microsoft.Office.AugLoopHostMessageReceivedEventArgs","{52ebe40e-6476-4f8d-81cb-89f5c90e2e76}","{891f2f5b-6598-4c8e-af9d-dc48bf34839f}",2,0);va.addProperty("Data",4,"String",1,!1,null,0);va=H.addType("Microsoft.Office.AugLoopEventService","{846cb932-2065-4d2e-b051-5d6673cca2d9}","{019765ca-6d77-447a-9bd8-b07dc47bc657}",
3,2);ub=va.addMethod("SendMessage",1,"Void",0,1,"SendMessage",4);ub.addParameter("data","String",1,null,0);va.addMethod("_RegisterHostMessageReceivedEvent",2,"Void",0,1,"_RegisterHostMessageReceivedEvent",4);va.addMethod("_UnregisterHostMessageReceivedEvent",3,"Void",0,1,"_UnregisterHostMessageReceivedEvent",4);va=H.addType("Microsoft.Office.CopilotOperationStartedEventArgs","{45400499-b374-4bc9-a709-18989d9cebd1}","{a7c458d5-f043-4d71-b091-03160b2c450e}",2,0);va.addProperty("BatchId",6,"String",
1,!1,null,0);va=H.addType("Microsoft.Office.UndoService","{69f39738-6c6b-4497-9833-02728cf72dc3}","{9628bdd5-9267-4ca8-8162-82d0a7e484f8}",3,2);ub=va.addMethod("EndCopilotOperation",5,"Void",0,0,"EndCopilotOperation",4);ub.addParameter("batchId","String",1,null,0);ub=va.addMethod("StartCopilotOperation",4,"Boolean",1,0,"StartCopilotOperation",4);ub.addParameter("batchId","String",1,null,0);va.addMethod("Undo",1,"Boolean",1,0,"Undo",4);va.addMethod("_RegisterUndoStackChangedEvent",2,"Void",0,1,"_RegisterUndoStackChangedEvent",
4);va.addMethod("_UnregisterUndoStackChangedEvent",3,"Void",0,1,"_UnregisterUndoStackChangedEvent",4);va=H.addEnumType("Microsoft.Office.UserFeedbackType");va.addEnumField("Like",0);va.addEnumField("Dislike",1);va.addEnumField("Idea",2);va.addEnumField("Unclassified",3);va=H.addEnumType("Microsoft.Office.UserFeedbackUIType");va.addEnumField("ModalDialog",0);va.addEnumField("Taskpane",1);va=H.addType("Microsoft.Office.UserFeedbackService","{92a3da31-eaf9-4225-b909-6c696483a7fb}","{c6f22ae8-52fa-45d5-a1bf-6b7b67f60f8b}",
3,2);va.addMethod("CanCollectUserFeedback",27,"Boolean",1,1,"CanCollectUserFeedback",4);ub=va.addMethod("CollectUserFeedback",1,"Void",0,1,"CollectUserFeedback",4);ub.addParameter("feedbacktype","Microsoft.Office.UserFeedbackType",1,null,0);ub.addParameter("UIType","Microsoft.Office.UserFeedbackUIType",1,null,0);ub.addParameter("featureArea","String",1,null,0);ub.addParameter("options","Object",1,null,0);va.addMethod("_RegisterUserFeedbackResponseEvent",28,"Void",0,1,"_RegisterUserFeedbackResponseEvent",
4);va.addMethod("_RegisterUserFeedbackUIDismissedEvent",18,"Void",0,1,"_RegisterUserFeedbackUIDismissedEvent",4);va.addMethod("_UnregisterUserFeedbackResponseEvent",29,"Void",0,1,"_UnregisterUserFeedbackResponseEvent",4);va.addMethod("_UnregisterUserFeedbackUIDismissedEvent",19,"Void",0,1,"_UnregisterUserFeedbackUIDismissedEvent",4);va=H.addType("Microsoft.Office.NotificationService","{d9d9f329-4dbd-46fd-937d-8534fca075f2}","{f665e4ed-18e6-496d-9693-4622a232c1bc}",3,2);ub=va.addMethod("AddNotification",
1,"String",1,0,"AddNotification",4);ub.addParameter("props","String",1,null,0);ub.addParameter("options","String",1,null,0);ub=va.addMethod("RemoveNotification",3,"Void",0,0,"RemoveNotification",4);ub.addParameter("id","String",1,null,0);ub=va.addMethod("UpdateNotification",2,"Void",0,0,"UpdateNotification",4);ub.addParameter("id","String",1,null,0);ub.addParameter("props","String",1,null,0);va=H.addType("Microsoft.Office.SensitivityLabelInfo","{9c48b796-11fa-4374-9910-4495541ed32f}","{57df5dd1-1d5c-49c2-954e-54cdce9d6082}",
2,0);va.addProperty("Color",15,"String",1,!1,null,0);va.addProperty("Description",13,"String",1,!1,null,0);va.addProperty("DisplayName",12,"String",1,!1,null,0);va.addProperty("EncryptionType",8,"Microsoft.Office.EncryptionType",1,!1,null,0);va.addProperty("HasExtractForUser",10,"Boolean",1,!1,null,0);va.addProperty("IsDke",9,"Boolean",1,!1,null,0);va.addProperty("IsEnabled",7,"Boolean",1,!1,null,0);va.addProperty("LabelId",5,"String",1,!1,null,0);va.addProperty("Order",11,"Int32",1,!1,null,0);va.addProperty("ParentName",
14,"String",1,!1,null,0);va.addProperty("TenantId",6,"String",1,!1,null,0);va.addProperty("Version",4,"Int32",1,!1,null,0);va=H.addType("Microsoft.Office.SensitivityLabelChangedEventArgs","{ca0930bd-14ec-4274-baf8-b0d81b2cd6af}","{afcf1725-5270-469f-91c8-ad4f0268a459}",2,0);va.addProperty("Context",20,"String",1,!1,null,0);va.addProperty("Error",21,"Microsoft.Office.TryUpgradeLabelError",1,!1,null,0);va.addProperty("NewLabel",19,"Microsoft.Office.SensitivityLabelInfo",2,!1,null,0);va.addProperty("PreviousLabel",
18,"Microsoft.Office.SensitivityLabelInfo",2,!1,null,0);va=H.addType("Microsoft.Office.SensitivityService","{c7d4ae5b-a48c-4bfd-bf0b-1532a604d330}","{774bff62-b736-4038-a7a8-7bc1eeef213e}",3,2);ub=va.addMethod("GetHighestSensitivityLabel",3,"Microsoft.Office.SensitivityLabelInfo",2,0,"HighestSensitivityLabel",4);ub.addParameter("sensitivityLabelInfo","Microsoft.Office.SensitivityLabelInfo[]",2,null,0);va.addMethod("GetLabel",1,"Microsoft.Office.SensitivityLabelInfo",2,0,"Label",4);ub=va.addMethod("TryUpgradeLabel",
2,"Void",0,0,"TryUpgradeLabel",4);ub.addParameter("sensitivityLabelInfo","Microsoft.Office.SensitivityLabelInfo",2,null,0);ub.addParameter("context","String",1,null,0);va.addMethod("_RegisterSensitivityLabelChangedEvent",16,"Void",0,1,"_RegisterSensitivityLabelChangedEvent",4);va.addMethod("_UnregisterSensitivityLabelChangedEvent",17,"Void",0,1,"_UnregisterSensitivityLabelChangedEvent",4);va=H.addType("Microsoft.Office.CopilotService","{d81cdd7f-f828-45a1-89fd-b1f6d0af7f76}","{c86a3d8f-7782-4ef9-8ded-2b569327f30c}",
3,2);ub=va.addMethod("LaunchHelpPaneByArticleId",2,"Void",0,0,"LaunchHelpPaneByArticleId",4);ub.addParameter("articleId","Int32",1,null,0);ub=va.addMethod("LaunchHelpPaneByArticleIdString",3,"Void",0,0,"LaunchHelpPaneByArticleIdString",4);ub.addParameter("articleId","String",1,null,0);ub=va.addMethod("LaunchHelpPaneByQuery",1,"Void",0,0,"LaunchHelpPaneByQuery",4);ub.addParameter("query","String",1,null,0);va=H.addEnumType("Microsoft.Office.BusinessBarType");va.addEnumField("Info",0);va.addEnumField("Error",
1);va.addEnumField("Blocked",2);va.addEnumField("SevereWarning",3);va.addEnumField("Success",4);va.addEnumField("Warning",5);va=H.addType("Microsoft.Office.BusinessBarShowArgs","{9cd04f48-f89b-4720-affd-b69cda192318}","{fb97b13e-bd55-46f2-a1bc-92cf8525546f}",2,0);va.addProperty("HideCloseButton",6,"Boolean",1,!1,null,0);va.addProperty("Message",4,"String",1,!1,null,0);va.addProperty("MessageType",5,"Microsoft.Office.BusinessBarType",1,!1,null,0);va.addProperty("Title",3,"String",1,!1,null,0);va=H.addType("Microsoft.Office.BusinessBarService",
"{0234fef7-ca58-4b3e-9ae8-6972ccf29564}","{8787e4f8-8270-480c-8721-5854ecbc8227}",3,2);ub=va.addMethod("Hide",2,"Void",0,0,"Hide",4);ub.addParameter("caller","String",1,null,0);ub=va.addMethod("Show",1,"Void",0,0,"Show",4);ub.addParameter("caller","String",1,null,0);ub.addParameter("options","Microsoft.Office.BusinessBarShowArgs",2,null,0);va=H.addEnumType("Microsoft.Office.SimpleDialogCategory");va.addEnumField("information",0);va.addEnumField("error",1);va.addEnumField("warning",2);va.addEnumField("question",
3);va.addEnumField("other",4);va=H.addType("Microsoft.Office.ShowSimpleDialog","{55fc9dc0-9f07-4859-8ba1-f33c353972da}","{f55bd118-7884-4f60-9e0e-e3a7972b7ecb}",3,2);ub=va.addMethod("LaunchSimpleDialog",1,"Microsoft.Office.SimpleDialogState",1,0,"LaunchSimpleDialog",4);ub.addParameter("title","String",1,null,0);ub.addParameter("description","String",1,null,0);ub.addParameter("telemetryid","String",1,null,0);ub.addParameter("Category","Microsoft.Office.SimpleDialogCategory",1,null,0);ub.addParameter("hasButton",
"Boolean",1,null,0);ub.addParameter("buttonLabel","String",1,null,0);ub.addParameter("hasCheckbox","Boolean",1,null,0);ub.addParameter("checkboxLabel","String",1,null,0);va=H.addType("Microsoft.Office.DispatchApiService","{1e3afc74-fb27-4b5d-a37b-fda697c46f78}","{82297de7-ac3a-4ee2-853d-26598d2e90e2}",3,2);ub=va.addMethod("Execute",1,"String",1,1,"Execute",4);ub.addParameter("apiName","String",1,null,0);ub.addParameter("paramsData","String",1,null,0);va=H.addType("Microsoft.ExcelServices.WacWorkbook",
"{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);ub=va.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",0);ub.addParameter("base64File","String",1,null,0);va=H.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}","",3,0);va.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);ub=va.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);ub.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",
1,null,0);va=H.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);va.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,0);ub=va.addMethod("Register",1,"Void",0,0,"Register",0);ub.addParameter("metadata","String",1,null,0);ub.addParameter("javascript","String",1,null,0);va=H.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}",
"",2,0);va.addProperty("Enabled",1,"Boolean",1,!1,null,0);va.addProperty("NativeRuntime",3,"Boolean",1,!1,null,0);va.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);va=H.addEnumType("Microsoft.Authentication.IdentityType");va.addEnumField("OrganizationAccount",0);va.addEnumField("MicrosoftAccount",1);va=H.addEnumType("Microsoft.Authentication.AuthorityType");va.addEnumField("External",0);va.addEnumField("Msa",1);va.addEnumField("Aad",2);va=H.addType("Microsoft.Authentication.OfficeIdentityInfo",
"{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);va.addProperty("DisplayName",4,"String",1,!1,null,0);va.addProperty("Email",3,"String",1,!1,null,0);va.addProperty("FederationProvider",2,"String",1,!1,null,0);va.addProperty("IdentityType",1,"Microsoft.Authentication.IdentityType",1,!1,null,0);va=H.addType("Microsoft.Authentication.AuthContext","{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);va.addProperty("AppId",4,"String",
1,!1,null,0);va.addProperty("Authority",2,"String",1,!1,null,0);va.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);va.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);va.addProperty("TenantId",6,"String",1,!1,null,0);va.addProperty("Upn",1,"String",1,!1,null,0);va=H.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}","{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);va.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",
3,!0,null,0);ub=va.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4);ub.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);va.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",2,1,"AuthContext",0);va.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",2,1,"PrimaryIdentityInfo",4);va=H.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}",
"{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);va.addProperty("AuthChallenge",3,"String",1,!1,null,0);va.addProperty("CorrelationId",7,"String",1,!1,null,0);va.addProperty("Policy",4,"String",1,!1,null,0);va.addProperty("Resource",2,"String",1,!1,null,0);va.addProperty("Scope",5,"String",1,!1,null,0);va.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);va=H.addType("Microsoft.Authentication.SingleSignOnToken","{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);va.addProperty("AccessToken",
2,"String",1,!1,null,0);va.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);va=H.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);va.addProperty("Id",1,"String",1,!0,null,0);va.addProperty("Value",2,"Object",1,!1,null,0);va=H.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}","",3,0);ub=va.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",
0);ub.addParameter("id","String",1,null,0);ub=va.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0);ub.addParameter("id","String",1,null,0);va=H.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);va.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);ub=va.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",
0);ub.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);va=H.addEnumType("Microsoft.AppRuntime.AppRuntimeState");va.addEnumField("Inactive",0);va.addEnumField("Background",1);va.addEnumField("Visible",2);va=H.addEnumType("Microsoft.AppRuntime.Visibility");va.addEnumField("Hidden",1);va.addEnumField("Visible",2);va=H.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);va.addProperty("Buttons",
4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);ub=va.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);ub.addParameter("jsonCreate","String",1,null,0);ub=va.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);ub.addParameter("jsonUpdate","String",1,null,0);ub=va.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);ub.addParameter("id","String",1,null,0);ub=va.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",
3,1,"Tab",0);ub.addParameter("id","String",1,null,0);va.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);va=H.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);va.addProperty("Id",2,"String",1,!0,null,0);ub=va.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",0);ub.addParameter("visibility","Boolean",1,null,0);va.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);va=H.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}",
"",3,0);va.addProperty("Enabled",3,"Boolean",1,!1,null,0);va.addProperty("Id",2,"String",1,!0,null,0);va.addProperty("Label",4,"String",1,!0,null,0);ub=va.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);ub.addParameter("enabled","Boolean",1,null,0);va.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);va=H.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);va.addMethod("GetCount",3,"Int32",1,1,"Count",0);ub=va.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",
3,0);ub.addParameter("key","String",1,null,0);va.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);va.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);va=H.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");va.addEnumField("Unknown",0);va.addEnumField("Basic",1);va.addEnumField("Premium",2);va=H.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);ub=va.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",
1,1,"FeatureTier",0);ub.addParameter("feature","String",1,null,0);ub.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);ub=va.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0);ub.addParameter("feature","String",1,null,0);ub=va.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);ub.addParameter("feature","String",1,null,0);ub.addParameter("fallbackValue","Boolean",1,null,0);va.addMethod("IsFreemiumUpsellEnabled",
3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);ub=va.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);ub.addParameter("experienceId","String",1,null,0);ub=va.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4);ub.addParameter("feature","String",1,null,0);va=H.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);va.addProperty("Id",5,"String",1,!0,null,0);va.addMethod("_RegisterStateChange",6,"Void",
0,1,"_RegisterStateChange",0);va.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);va=H.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);va.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);va=H.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification","{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",
3,0);va.addMethod("Disable",3,"Void",0,1,"Disable",0);va.addMethod("Enable",2,"Void",0,1,"Enable",0);va.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)};var pc=a(928),$b=a(175);class Ib{constructor(H,va){this.ylh=H;this.Slh=va}createAndOpenWorkbook(H){if(H&&H.length>this.ylh)throw sa.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",H.length),OfficeExtension.WacRuntime.Utility.createRichApiException(pc.a.invalidArgument,$b.a.ia(1769));const va=new ma("blank","agave",H?"streamBase64":
"streamEmpty",H);let ub=null;return OfficeExtension.WacRuntime.Utility.createPromise((kc,Oc)=>{const pd=new Jc.a,Sd=$b.a.iyc("GeneralAddInMessageDialogTitle"),Wd=$b.a.iyc("NewFileAPIConsentMessage");pd.Bh=4;pd.Io(Sd,Wd,1,ee=>{2===ee||0===ee?Oc("Cancelled"):(ub=window.open(""),this.Slh.create(kc,Oc,va).jgb())})}).then(kc=>{if(!kc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(pc.a.generalException,$b.a.ia(1765));try{ub.top.location.href=kc}catch(Oc){sa.ULS.sendTraceTag(538572820,0,
10,"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",Ka.a.Av,Oc),sa.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),ub.location.replace(kc)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},kc=>{if("Cancelled"===kc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(pc.a.D9d,$b.a.ia(1768));ub.close();this.JVk();return null})}getTypeName(){return"Microsoft.ExcelServices.WacWorkbook"}invokePropertyGet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);
}invokePropertyGetAsync(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}invokePropertySet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertySetAsync(H,va){this.invokePropertySet(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokeMethodAsync(H,va){switch(H){case 1:return this.o0h(va)}H=this.invokeMethod(H,
va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}o0h(H){H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"string");return this.createAndOpenWorkbook(H)}JVk(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(pc.a.generalException,$b.a.ia(1765));}}Object(I.a)(Ib,"WacWorkbook",null,[]);const Zb=(H,va)=>{console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+typeof H+", objectId="+H+", value="+va);return null},Eb=H=>{H.add("InternalTest",
"PreviewExecutionMethod",Zb)};var ob=a(283),Na=a(926),nb=a(927);class Hb{constructor(H){this.fh=H}get $(){return this.fh}}Object(I.a)(Hb,"RichApiPreviewExecutionContext",null,[]);var na=a(26),Gb=a(77),Xa=a(69),Jb=a(65),qb=a(45),Db=a(1241),gb=a(79),ya=a(527),Aa=a(238),sb=a(31),nc=a(243),Bb=a(146),uc=a(19),Pc=a(16),wd=a(13),Md=a(27);class Nd extends nc.a{constructor(H,va,ub,kc,Oc){super(H,"Select Data");this.MHb=null;this.Zjf=va;this.Cyd=ub;this.ji=Oc;this.callback=kc}get ki(){return"DdaBindingPrompt"}start(H,
va){let ub="<div class='"+Bb.l+" "+uc.a.YG+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+Bb.c+"' /></div>";ub=String.format(ub,sb.a.Xq(this.Cyd.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");this.ji.hr(this.dj,ub);this.MHb=Pc.DOMElementExtensions.getElementById(this.dj,"bindingText");H=va?H.tib(va,this.Cyd.DdaBindingsMethod.BindingId):null;(null===H||void 0===H?0:H.IsValidRef)?(va=new na.Range(H.Reference.FirstRow+1,H.Reference.FirstColumn+
1,H.Reference.LastRow+1,H.Reference.LastColumn+1,!1,!1),this.MHb.value=H.Reference.SheetName+"!"+va):(H=ea.f(this.$).ha,this.MHb.value=Gb.f(this.$.na)||!H.qa.Gn?"":H.Vua);this.initialize();this.us()}CE(){this.ztd();this.addButton(0);this.addButton(1);super.CE()}setFocus(){Pc.DOMElementExtensions.setFocus(this.MHb)}validate(){return!0}commit(){let H=this.MHb.value.trim();const va=H.indexOf("!");-1!==va&&(H=this.yUi(H.substring(0,va))+H.substr(va));this.Zjf.addBinding(this.Cyd,H,0,this.callback);return!0}FIb(){this.Zjf.Q_.Rn(Na.a.internalError,
this.callback);super.FIb()}yUi(H){H=Md.a.trimStart(H.trim(),"=");return H.length?H.startsWith("'")&&H.endsWith("'")?H:wd.HelperMethods.Huc(H):""}}Object(I.a)(Nd,"DdaBindingPrompt",nc.a,[]);class ec{constructor(H){this.ea=H}Rn(H,va){if(va){const ub={};ub.Error=H;ub.Version=this.ea.gk;va(ub)}}nYa(H,va){this.Rn(H,va)}dR(H,va){this.Rn(Na.a.nzf(H.Errors[0].MessageId),va)}cE(H){H&&H(this.SQ())}SQ(){const H={Error:0};H.Version=this.ea.gk;return H}}Object(I.a)(ec,"DdaErrorGenerator",null,[]);var gc=a(252);
class Mb{constructor(H,va,ub){this.$=H;this.Q_=va;this.rJ=ub}d4d(H,va){const ub=H.DdaGoToByIdMethod.GoToType,kc=H.DdaGoToByIdMethod.SelectionMode,Oc=H.DdaGoToByIdMethod.Id.toString().trim(),pd=Sd=>{const Wd=this.$.sa.getItemByName(Sd.SheetName);(null===Wd||void 0===Wd?0:Wd.visible)?(ea.f(this.$).To(Sd,null,null,null,3,"DdaNavigator.NavigateTo",void 0,void 0,void 0,void 0,!0),this.Q_.cE(va)):this.Q_.Rn(Na.a.tQh,va)};0===ub?this.YFj(Oc,kc,H.DdaMethod.ControlId,pd,va):1===ub?this.aGj(Oc,kc,pd,va):this.Q_.Rn(Na.a.C2k,
va)}YFj(H,va,ub,kc,Oc){this.rJ.ddaGetBinding(ub,H,pd=>{if(!gc.a(pd)&&pd.Result&&pd.Result.Reference){pd=pd.Result;var Sd={};Sd.SheetName=pd.Reference.SheetName;Sd.FirstRow=pd.Reference.FirstRow;Sd.FirstColumn=pd.Reference.FirstColumn;Sd.LastRow=pd.Reference.LastRow;Sd.LastColumn=pd.Reference.LastColumn;Mb.Vnd(Sd,va);1!==pd.BindingType?kc(Sd):this.rJ.ddaGetBindingData(ub,H,1,0,2,0,0,-1,-1,Wd=>{gc.a(Wd)||!Wd.Result?this.Q_.dR(Wd,Oc):(Wd=Wd.Result,2!==va&&(Sd.FirstRow-=Wd.Headers.length,0>Sd.FirstRow&&
(Sd.FirstRow=0)),kc(Sd))},Oc)}else this.Q_.nYa(Na.a.TTg,Oc)},Oc)}aGj(H,va,ub,kc){var Oc=qb.C(H);Oc?(Oc=qb.w(Oc,this.$),Mb.Vnd(Oc,va),ub(Oc)):this.$.ea.isNamedObjectViewMode&&this.$.Gh.yq(H)?this.$.Gh.dqa(this.$.Gh.getItemByName(H),"dda"):(Oc=pd=>{gc.a(pd)||!pd.Result?this.$.sa.contains(H)?(pd={},pd.SheetName=H,pd.FirstRow=0,pd.FirstColumn=0,pd.LastRow=0,pd.LastColumn=0,ub(pd)):this.Q_.nYa(Na.a.TTg,kc):(pd=pd.Result,Mb.Vnd(pd,va),ub(pd))},this.$.sa.na?this.rJ.parseRangeForGoto(H,this.$.sa.na.name,
Oc,kc):this.rJ.parseRange(H,Oc,kc))}static Vnd(H,va){H.LastRow=2===va?H.FirstRow:H.LastRow;H.LastColumn=2===va?H.FirstColumn:H.LastColumn}}Object(I.a)(Mb,"DdaNavigator",null,[]);var sc=a(212),xd=a(62);const xb=(H,va,ub,kc,Oc,pd)=>{const Sd=H.Za(1);Sd.request=va;return xd.h(H,"ExecuteRichApiRequest",Sd,ub,kc,Oc,pd,0)};var Lb=a(334),Rc=a(94),nd=a(760),$d=a(641),Td;(function(H){H[H.unsupported=0]="unsupported";H[H.surface=1]="surface";H[H.combo=2]="combo";H[H.column=3]="column";H[H.column3D=4]="column3D";
H[H.bar=5]="bar";H[H.bar3D=6]="bar3D";H[H.line=7]="line";H[H.line3D=8]="line3D";H[H.pie=9]="pie";H[H.pie3D=10]="pie3D";H[H.scatter=11]="scatter";H[H.bubble=12]="bubble";H[H.area=13]="area";H[H.area3D=14]="area3D";H[H.doughnut=15]="doughnut";H[H.radar=16]="radar";H[H.stock=17]="stock";H[H.waterfall=18]="waterfall";H[H.funnel=19]="funnel";H[H.treemap=20]="treemap";H[H.sunburst=21]="sunburst";H[H.boxWhisker=22]="boxWhisker";H[H.histogram=23]="histogram";H[H.pareto=24]="pareto";H[H.regionMap=25]="regionMap";
H[H.noVisibleSeries=26]="noVisibleSeries";H[H.complexDataSource=27]="complexDataSource";H[H.pivotChart=28]="pivotChart"})(Td||(Td={}));Object(I.b)("ChartCategory",Td);class He{constructor(H,va){this.source=H;this.eventId=va}}Object(I.a)(He,"MacroRecorderEventData",null,[]);class oc{constructor(H,va,ub){this.response=this.request=this.eventId=this.source=null;H&&(this.source=H.source,this.eventId=H.eventId,this.request=va,this.response=ub)}get isValid(){return!(void 0===this.source||null===this.source)&&
!(void 0===this.eventId||null===this.eventId)&&!0}}Object(I.a)(oc,"MacroRecorderRichApiRequestExecutedPayload",null,[65]);class ld{constructor(H,va,ub){this.parentName=H;this.$=va;this.request=ub}JSi(H){var va;if(void 0===H||null===H||void 0===H.RequestBody||null===H.RequestBody)return null;const ub=JSON.parse(H.RequestBody);if(void 0!==H.ActiveFloatingObjectId&&null!==H.ActiveFloatingObjectId){ub.ActiveFloatingObjectId=H.ActiveFloatingObjectId;const kc=ea.f(this.$).ha.$e.yh;if(null===(va=null===
kc||void 0===kc?void 0:kc.floatingObject)||void 0===va?0:va.Ki)ub.ActiveChartType=Td[kc.floatingObject.Ki.ChartCategory]}void 0!==H.SheetMultiRange&&null!==H.SheetMultiRange&&(ub.SheetName=H.SheetMultiRange.SheetName);return ub}USi(H){if(void 0===H||null===H||void 0===H.Result||null===H.Result)return null;H=H.Result;return void 0===H.ResponseBody||null===H.ResponseBody||H.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(H.ResponseBody.join(""))}vnj(H){return!!H&&!(void 0===H.eventId||null===
H.eventId)&&0<H.eventId.length}nt(H){return()=>{if(this.$.Bga){const va=this.WLh(this.request);if(this.vnj(va)){const ub=this.JSi(this.request),kc=this.USi(H);if(ub&&!Rc.a.isEmpty(ub)&&kc&&!Rc.a.isEmpty(kc))return sa.ULS.sendTraceTag(537163164,0,50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),new oc(va,ub,kc);sa.ULS.sendTraceTag(537163163,0,50,`[RichApiRecorder]: Failed due to bad data: ${`requestInfo: ${ub?"(not null)":"(null)"}; responseInfo: ${kc?"(not null)":
"(null)"}`}`)}}return new oc(null,null,null)}}WLh(H){const va=this.wnj(H.SolutionId),ub=ld.oSi(H);if(ub&&va)return sa.ULS.sendTraceTag(537163162,0,50,`[RichApiRecorder][${this.parentName}]: ${({["recorderEventId"]:ub,["request.SolutionId"]:H.SolutionId})}`),new He(H.SolutionId,ub);H=JSON.stringify({["recorderEventId"]:ub,["isRecorderAwareAddin"]:va,["request.SolutionId"]:H.SolutionId});sa.ULS.sendTraceTag(537163161,0,50,`[RichApiRecorder][${this.parentName}]: ${H}`);return null}wnj(H){if(!H)return!1;
H=H.toLowerCase();return ld.gZi().contains(H)}static gZi(){ld.vNa||(ld.vNa=new nd.a($d.a.lm()),ld.vNa.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),ld.vNa.add("fa000000005"),ld.vNa.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),ld.vNa.add("fa000000014"),ld.vNa.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));return ld.vNa}static oSi(H){let va=null;var ub=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',"mi");if(ub.test(H.RequestBody))va=ub.exec(H.RequestBody)[1];else{H=H.RequestHeaders;
if(!H)return va;ub=Hc.a.hJj.toLowerCase();for(let kc=0;kc<H.length;kc++)if(H[kc].Name.toLowerCase()===ub){va=H[kc].Value;break}}return va}}ld.vNa=null;Object(I.a)(ld,"DdaRichApiRequestRecorder",null,[]);var id=a(262);class fc extends Lb.a{constructor(H,va,ub,kc,Oc,pd,Sd,Wd){super(10,0,va,Wd);this.BEb=ub;this.KAb=kc;this.Vea=Oc;this.DTa=pd;this.request=Sd;this.uje=new ld("10",H,Sd)}get e2c(){return this.DTa}get NP(){return this.BEb}get Eva(){return this.KAb}nea(H){return super.nea(H)||this.cPh(H)}nt(){return this.uje.nt(this.Uj)}Vwb(){const H=
{OperationType:3};H.RichApiRequest=this.request;return H}cPh(H){return(va,ub,kc)=>xb(H,this.request,id.c(va,this.BEb),id.b(ub,this.KAb),kc,this.Vea)}}Object(I.a)(fc,"DdaRichApiRequestBatchOperation",Lb.a,[]);class vc extends sc.a{constructor(H,va,ub,kc){super(576,0,ub,kc);this.uje=new ld("576",H,va)}nt(){return this.uje.nt(this.Uj)}}Object(I.a)(vc,"DdaRichApiRequestOperation",sc.a,[]);class Tc{constructor(H,va){this.gS=(ub,kc)=>{this.Q_.nYa(Na.a.internalError,kc)};this.$=H;this.Q_=va}ddaAddBinding(H,
va,ub,kc,Oc,pd,Sd){this.hU((Wd,ee,je)=>{var Ue=this.$.pa.ta,G=this.iwa();Wd=id.c(Wd,pd);ee=id.b(ee,this.gS);const da=Ue.Za(9);da.controlId=H;da.bindingId=va;da.bindingType=ub;da.currentSheetName=G;da.formula=kc;da.options=Oc;return xd.h(Ue,"DdaAddBinding",da,Wd,ee,je,Sd,0)},Sd,563)}ddaReleaseBinding(H,va,ub,kc){this.hU((Oc,pd,Sd)=>{var Wd=this.$.pa.ta;Oc=id.c(Oc,ub);pd=id.b(pd,this.gS);const ee=Wd.Za(9);ee.controlId=H;ee.bindingId=va;return xd.h(Wd,"DdaReleaseBinding",ee,Oc,pd,Sd,kc,0)},kc,564)}ddaGetBinding(H,
va,ub,kc){this.hU((Oc,pd,Sd)=>{var Wd=this.$.pa.ta;Oc=id.c(Oc,ub);pd=id.b(pd,this.gS);const ee=Wd.Za(1);ee.controlId=H;ee.bindingId=va;return xd.h(Wd,"DdaGetBinding",ee,Oc,pd,Sd,kc,0)},kc,565,16)}ddaGetAllBindings(H,va,ub){this.hU((kc,Oc,pd)=>{var Sd=this.$.pa.ta;kc=id.c(kc,va);Oc=id.b(Oc,this.gS);const Wd=Sd.Za(1);Wd.controlId=H;return xd.h(Sd,"DdaGetAllBindings",Wd,kc,Oc,pd,ub,0)},ub,566,16)}ddaGetBindingData(H,va,ub,kc,Oc,pd,Sd,Wd,ee,je,Ue){this.hU((G,da,$a)=>{var Sb=this.$.pa.ta,Mc=this.iwa();
G=id.c(G,je);da=id.b(da,this.gS);const sd=Sb.Za(1);sd.controlId=H;sd.bindingId=va;sd.coerceType=ub;sd.valueFormat=kc;sd.filterType=Oc;sd.startRow=pd;sd.startCol=Sd;sd.rowCount=Wd;sd.colCount=ee;sd.currentSheetName=Mc;return xd.h(Sb,"DdaGetBindingData",sd,G,da,$a,Ue,0)},Ue,567,16)}ddaSetBindingData(H,va,ub,kc,Oc,pd,Sd){this.hU((Wd,ee,je)=>{var Ue=this.$.pa.ta,G=this.iwa();Wd=id.c(Wd,pd);ee=id.b(ee,this.gS);const da=Ue.Za(9);da.controlId=H;da.bindingId=va;da.startRow=ub;da.startCol=kc;da.currentSheetName=
G;da.bindingData=Oc;return xd.h(Ue,"DdaSetBindingData",da,Wd,ee,je,Sd,0)},Sd,568)}ddaGetSelectedData(H,va,ub,kc,Oc,pd,Sd){this.hU((Wd,ee,je)=>{var Ue=this.$.pa.ta,G=this.iwa();Wd=id.c(Wd,pd);ee=id.b(ee,this.gS);const da=Ue.Za(1);da.controlId=H;da.coerceType=va;da.valueFormat=ub;da.filterType=kc;da.currentSheetName=G;da.formula=Oc;return xd.h(Ue,"DdaGetSelectedData",da,Wd,ee,je,Sd,0)},Sd,569,16)}ddaSetSelectedData(H,va,ub,kc,Oc){this.hU((pd,Sd,Wd)=>{var ee=this.$.pa.ta,je=this.iwa();pd=id.c(pd,kc);
Sd=id.b(Sd,this.gS);const Ue=ee.Za(9);Ue.controlId=H;Ue.currentSheetName=je;Ue.formula=va;Ue.bindingData=ub;return xd.h(ee,"DdaSetSelectedData",Ue,pd,Sd,Wd,Oc,0)},Oc,570)}ddaLoadSettings(H,va,ub){this.hU((kc,Oc,pd)=>{var Sd=this.$.pa.ta;kc=id.c(kc,va);Oc=id.b(Oc,this.gS);const Wd=Sd.Za(1);Wd.controlId=H;return xd.h(Sd,"DdaLoadSettings",Wd,kc,Oc,pd,ub,0)},ub,501,16)}ddaSaveSettings(H,va,ub,kc,Oc){this.hU((pd,Sd,Wd)=>{var ee=this.$.pa.ta;pd=id.c(pd,kc);Sd=id.b(Sd,this.gS);const je=ee.Za(9);je.controlId=
H;je.settings=va;je.overwriteIfStale=ub;return xd.h(ee,"DdaSaveSettings",je,pd,Sd,Wd,Oc,0)},Oc,571)}ddaAddRowsColumns(H,va,ub,kc,Oc,pd){this.hU((Sd,Wd,ee)=>{var je=this.$.pa.ta,Ue=this.iwa();Sd=id.c(Sd,Oc);Wd=id.b(Wd,this.gS);const G=je.Za(9);G.controlId=H;G.bindingId=va;G.isRow=ub;G.currentSheetName=Ue;G.bindingData=kc;return xd.h(je,"DdaAddRowsColumns",G,Sd,Wd,ee,pd,0)},pd,572)}ddaDeleteAllDataValues(H,va,ub,kc){this.hU((Oc,pd,Sd)=>{var Wd=this.$.pa.ta,ee=this.iwa();Oc=id.c(Oc,ub);pd=id.b(pd,this.gS);
const je=Wd.Za(9);je.controlId=H;je.bindingId=va;je.currentSheetName=ee;return xd.h(Wd,"DdaDeleteAllDataValues",je,Oc,pd,Sd,kc,0)},kc,573)}ddaClearBindingFormats(H,va,ub,kc){this.hU((Oc,pd,Sd)=>{var Wd=this.$.pa.ta,ee=this.iwa();Oc=id.c(Oc,ub);pd=id.b(pd,this.gS);const je=Wd.Za(9);je.controlId=H;je.bindingId=va;je.currentSheetName=ee;return xd.h(Wd,"DdaClearBindingFormats",je,Oc,pd,Sd,kc,0)},kc,574)}ddaSetBindingFormats(H,va,ub,kc,Oc,pd){this.hU((Sd,Wd,ee)=>{var je=this.$.pa.ta,Ue=this.iwa();Sd=id.c(Sd,
Oc);Wd=id.b(Wd,this.gS);const G=je.Za(9);G.controlId=H;G.bindingId=va;G.currentSheetName=Ue;G.bindingData=ub;G.isSetFormats=kc;return xd.h(je,"DdaSetBindingFormats",G,Sd,Wd,ee,pd,0)},pd,575)}parseRange(H,va,ub){this.hU((kc,Oc,pd)=>{const Sd=this.$.pa.ta.Jh();return xd.w(this.$.pa.ta,H,-1,id.c(kc,va),id.b(Oc,this.gS),pd,ub,Sd)},ub,162,16)}parseRangeForGoto(H,va,ub,kc){this.hU((Oc,pd,Sd)=>{const Wd=this.$.pa.ta.Jh();return xd.x(this.$.pa.ta,H,va,id.c(Oc,ub),id.b(pd,this.gS),Sd,kc,Wd)},kc,562,16)}executeRichApiRequest(H,
va,ub){H.RequestFlags&=12287;if(za.EwaSettings.isChangeGateEnabled("OfficeVSO:7867662_RichApiUndoThirdPartyFlight")){var kc=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichApiUndoThirdParty",!1);const Oc=0!==(H.RequestFlags&128);kc||"sdxcatalog"===H.MarketplaceType||Oc||(H.RequestFlags&=-17)}za.EwaSettings.Ra(233)?this.pri(this.$.pa.ta.Jh(),va,()=>{this.Q_.nYa(Na.a.internalError,ub)},ub,H):(kc=wa.DdaFacade.RKd(H),!this.$.ih.GF||kc&16?(kc|=64,this.$.userOperationManager.vO(new vc(this.$,
H,(Oc,pd,Sd)=>xb(this.$.pa.ta,H,id.c(Oc,va),id.b(pd,this.gS),Sd,ub),kc))):(this.Q_.nYa(Na.a.h3c,ub),sa.ULS.sendTraceTag(537163160,0,50,"Write operation is not allowed")))}iwa(){return this.$.ea.isNamedObjectViewMode?this.$.na.sheetName:this.$.activeItemName}hU(H,va,ub,kc){kc=void 0===kc?0:kc;!this.$.ih.GF||kc&16?this.$.userOperationManager.vO(new sc.a(ub,0,H,kc|64)):(this.Q_.nYa(Na.a.h3c,va),sa.ULS.sendTraceTag(537163159,0,50,"Write operation is not allowed"))}pri(H,va,ub,kc,Oc){let pd=wa.DdaFacade.RKd(Oc);
if(!this.$.ih.GF||pd&16){var Sd=this.$.qh.vi("UserAction","Rich Api request");this.$.userOperationManager.enqueueOperation(new fc(this.$,H,va,ub,kc,Sd,Oc,pd|64),null)}else this.Q_.nYa(Na.a.h3c,kc),sa.ULS.sendTraceTag(537163158,0,50,"Write operation is not allowed")}}Object(I.a)(Tc,"DdaWebServiceHelper",null,[]);class Bd{constructor(H,va,ub,kc){this.eti=H;this.fileSize=va;this.TOk=kc}}Object(I.a)(Bd,"DocumentFile",null,[]);class Fd{}Fd.generalException="GeneralException";Fd.IDh="ApiNotFound";Fd.D9d=
"OperationCancelled";Fd.invalidArgument="InvalidArgument";Object(I.a)(Fd,"ErrorCodes",null,[]);class le{replaceShortcuts(){return Promise.reject("ReplaceShortcuts method is not overridden")}getShortcuts(){return Promise.reject("GetShortcuts method is not overridden")}checkShortcutsInUse(){return Promise.reject("CheckShortcutsInUse method is not overridden")}}Object(I.a)(le,"WacApiDelegates",null,[]);var dc=a(723);class Uc extends le{constructor(H,va){super();this.B_f=(ub,kc)=>{ub=Uc.CZh(ub,kc);if(!dc.a(this.$,
ub))return!0;ub=this.$.shortcutKeyManager.$Ld(ub);return!!ub&&0<ub.length};this.addinId=H;this.$=va}replaceShortcuts(H){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,H,this.B_f)}getShortcuts(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)}checkShortcutsInUse(H){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(H,this.B_f)}static h3h(H,va){const ub=document.createEvent("KeyboardEvent");if(Ka.a.KI)ub.initKeyboardEvent("keydown",!1,!1,
window.self,"A",0,!!(H&8),!!(H&32),!!(H&4),!!(H&256));else{const kc=[];H&4&&kc.push("Shift");H&8&&kc.push("Control");H&32&&kc.push("Alt");ub.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,kc.join(" "),!1,"en-US")}H=new Sys.UI.DomEvent(ub);H.keyCode=va;return H}static CZh(H,va){if(Ka.a.hm)switch(va){case 189:va=173;break;case 187:va=61;break;case 186:va=59}return Uc.h3h(H,va)}}Object(I.a)(Uc,"ExcelWacApiDelegates",le,[]);class kb{constructor(H){this.dXa={};this.ICj=H}buh(H,va){this.yBc(H)||(this.dXa[H]=
{});if(this.mhj(H))return sa.ULS.sendTraceTag(537163157,344,50,`App ${H} has reach the limit of number of cached files.`),Na.a.xDj;this.dXa[H][va.eti.toString()]=va;return Na.a.success}ZHi(H,va){let ub=null;this.yBc(H)&&(ub=this.dXa[H][va.toString()]);ub||sa.ULS.sendTraceTag(537163156,344,15,`File cache for [agave:${H}, fileHandler:${va}] doesn't exist`);return ub}yBc(H){return H in this.dXa}$fk(H,va){if(this.yBc(H)){const ub=this.dXa[H];delete ub[va.toString()];1>Object.keys(ub).length&&delete this.dXa[H];
return va.toString()in ub?Na.a.internalError:Na.a.success}return Na.a.internalError}mhj(H){return this.yBc(H)?Object.keys(this.dXa[H]).length>=this.ICj:!1}static getInstance(H){return H.ka.Ug(200)||H.ka.ph(200,new kb(kb.JCj))}static QGj(){return++kb.YNh}}kb.lCj=4194304;kb.JCj=1;kb.YNh=0;Object(I.a)(kb,"GetFileApiHelper",null,[]);class rb{constructor(H){this.jt=H}notifyActionHandlerReady(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.jt)}getTypeName(){return"Microsoft.InternalService.AddinInternalService"}invokePropertyGet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);
}invokePropertyGetAsync(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}invokePropertySet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertySetAsync(H,va){this.invokePropertySet(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(H){switch(H){case 1:return this.BHj()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokeMethodAsync(H,va){H=this.invokeMethod(H,
va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}BHj(){this.notifyActionHandlerReady();return null}}Object(I.a)(rb,"AddinInternalService",null,[]);class cc{constructor(H,va){this.Ox=va;this.jt=H}getAppRuntimeState(){let H=this.jt;$b.a.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&this.Ox.lZ&&(H=this.Ox.L$(this.jt));return this.Ox.getAppRuntimeState(H)?2:1}setAppRuntimeState(H){switch(H){case 2:H=!0;break;case 1:H=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(pc.a.invalidArgument,
$b.a.ia(1769));}let va=this.jt;$b.a.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&this.Ox.lZ&&(va=this.Ox.L$(this.jt));this.Ox.setAppRuntimeState(va,H)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertyGetAsync(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}invokePropertySet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);
}invokePropertySetAsync(H,va){this.invokePropertySet(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(H,va){switch(H){case 2:return this.FCi();case 1:return this.hyk(va)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokeMethodAsync(H,va){H=this.invokeMethod(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}FCi(){return this.getAppRuntimeState()}hyk(H){H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,
0,"int");this.setAppRuntimeState(H);return null}}Object(I.a)(cc,"AppRuntimeService",null,[]);var mc=a(1242);class Sa{constructor(H,va,ub,kc){this.tG=H;this.Tca=ub;this.YH=kc.wl.getOsfControl(va)}disable(){try{if(!$b.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.Bgf();if(!this.$Zf())return this.Cgf();this.Tca.G1k(this.tG)}catch(H){return sa.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",H.message||"Unknown"),
this.zgf()}return null}enable(){try{if(!$b.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.Bgf();if(!this.$Zf())return this.Cgf();this.Tca.Sdk(this.tG)}catch(H){return sa.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",H.message||"Unknown"),this.zgf()}return null}_OnAccess(){}getTypeName(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"}invokePropertyGet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);
}invokePropertyGetAsync(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}invokePropertySet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertySetAsync(H,va){this.invokePropertySet(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(H){switch(H){case 1:return this.zQa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokeMethodAsync(H,va){switch(H){case 3:return this.Bbi();
case 2:return this.Qgi()}H=this.invokeMethod(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}Bbi(){return this.disable()}Qgi(){return this.enable()}zQa(){this._OnAccess();return null}Bgf(){return mc.a(pc.a.notImplemented,$b.a.ia(1770))}Cgf(){return mc.a(pc.a.sharedRuntimeNotAvailable,$b.a.ia(1774))}zgf(){return mc.a(pc.a.generalException,$b.a.ia(1765))}$Zf(){const H=this.YH.getSharedRuntimeId();return!!H&&0<H.length}}Object(I.a)(Sa,"BeforeDocumentCloseNotification",null,
[]);class pb{constructor(){this.NVe=this.GPe=this.Ku=!1}get enabled(){return this.Ku}set enabled(H){this.Ku=H}get nativeRuntime(){return this.GPe}set nativeRuntime(H){this.GPe=H}get streamingEnabled(){return this.NVe}set streamingEnabled(H){this.NVe=H}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"}invokePropertyGet(H){switch(H){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);
}invokePropertyGetAsync(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}invokePropertySet(H,va){switch(H){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,0,"boolean");return;case 3:this.nativeRuntime=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);
}invokePropertySetAsync(H,va){this.invokePropertySet(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokeMethodAsync(H,va){H=this.invokeMethod(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}}Object(I.a)(pb,"CustomFunctionEngineStatus",null,[]);class Ac{constructor(H,va,ub){this.Cjh=H;this.Djh=va;this.Enh=ub}get status(){const H=new pb;H.enabled=this.Cjh;
H.streamingEnabled=this.Djh;H.nativeRuntime=!1;return H}register(H){return OfficeExtension.WacRuntime.Utility.createPromise(this.Enh(H))}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionManager"}invokePropertyGet(H){switch(H){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertyGetAsync(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}invokePropertySet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);
}invokePropertySetAsync(H,va){this.invokePropertySet(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokeMethodAsync(H,va){switch(H){case 1:return this.Lek(va)}H=this.invokeMethod(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}Lek(H){const va=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"string");H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,
1,"string");return this.register(va,H)}}Object(I.a)(Ac,"CustomFunctionManager",null,[]);var yd=a(1151);class vb{constructor(H,va,ub,kc){this.VEe="";this.Rcc=0;this.EZ=H;this._id=va;this.jt=ub;this.Ox=kc}get id(){return this._id}_RegisterStateChange(){this.Rcc||this.EZ.execute(H=>{this.VEe=H.S4a(this._id,va=>{this.Ox.ivi(this.jt,this._id,JSON.stringify(va))})});this.Rcc++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.Rcc--;this.Rcc||this.EZ.execute(H=>
{H.nfe(this._id,this.VEe)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(H){switch(H){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertyGetAsync(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}invokePropertySet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);
}invokePropertySetAsync(H,va){this.invokePropertySet(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokeMethodAsync(H,va){switch(H){case 6:return this.Hch();case 7:return this.Nch()}H=this.invokeMethod(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}Hch(){return this._RegisterStateChange()}Nch(){return this._UnregisterStateChange()}}Object(I.a)(vb,"LicenseFeature",
null,[]);class Sc{constructor(H,va){this.EZ=Wc.a.instance.Qi("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.jt=H;this.Ox=va;this.vmh=this.Ox.wl.getOsfControl(this.jt)}getFeatureTier(H,va){return OfficeExtension.WacRuntime.Utility.createPromise(ub=>{const kc=1===va?1:2===va?2:0;this.EZ.execute(Oc=>{Oc.getFeatureTier(H,kc).then(pd=>{ub(this.aNi(pd))},()=>{ub(va)})})})}getLicenseFeature(H){H=new vb(this.EZ,H,this.jt,this.Ox);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}isFeatureEnabled(H,
va){return OfficeExtension.WacRuntime.Utility.createPromise(ub=>{this.EZ.execute(kc=>{kc.isFeatureEnabled(H,va).then(Oc=>{ub(Oc)},()=>{ub(va)})})})}isFreemiumUpsellEnabled(){return OfficeExtension.WacRuntime.Utility.createPromise(H=>{this.EZ.execute(va=>{va=va.isFreemiumUpsellEnabled();H(va)})})}launchUpsellExperience(H){if(this.vmh.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(()=>{this.EZ.execute(va=>{va.launchUpsellExperience(H)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException(pc.a.wkd,
"");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertyGetAsync(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}invokePropertySet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertySetAsync(H,va){this.invokePropertySet(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(H,
va){switch(H){case 6:return this.Kch(va)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokeMethodAsync(H,va){switch(H){case 2:return this.eJi(va);case 5:return this.$Mi(va);case 1:return this.lij(va);case 3:return this.ejj();case 4:return this.Rtj(va)}H=this.invokeMethod(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}eJi(H){const va=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"string");H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,
1,"int");return this.getFeatureTier(va,H)}$Mi(H){H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"string");return this.getLicenseFeature(H)}lij(H){const va=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"string");H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,1,"boolean");return this.isFeatureEnabled(va,H)}ejj(){return this.isFreemiumUpsellEnabled()}Rtj(H){H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"string");return this.launchUpsellExperience(H)}Kch(H){H=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"string");this._TestFireStateChangedEvent(H);return null}aNi(H){switch(H){case 1:return 1;case 2:return 2;default:return 0}}}Object(I.a)(Sc,"License",null,[]);class hd{constructor(){this.fEe=null;this.WTe=this.Ngc=this.qN="";this.jVe=!0;this.options=null}get authChallenge(){return this.fEe}set authChallenge(H){this.fEe=H}get correlationId(){return this.qN}set correlationId(H){this.qN=H}get policy(){return null}set policy(H){}get resource(){return this.Ngc}set resource(H){this.Ngc=
H}get scope(){return this.WTe}set scope(H){this.WTe=H}get silentLogin(){return this.jVe}set silentLogin(H){this.jVe=H}getTypeName(){return"Microsoft.Authentication.TokenParameters"}invokePropertyGet(H){switch(H){case 3:return this.authChallenge;case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertyGetAsync(H){H=this.invokePropertyGet(H);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}invokePropertySet(H,va){switch(H){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,0,"string");return;case 7:this.correlationId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,0,"string");return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,0,"string");
return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertySetAsync(H,va){this.invokePropertySet(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokeMethodAsync(H,
va){H=this.invokeMethod(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}}Object(I.a)(hd,"TokenParameters",null,[312]);var qc=a(197),Lc=a(12);const bd=(H,va,ub)=>kc=>(Oc,pd)=>{Fa.TaskExtensions.Ua(gb.GetServiceTaskFactory.create(va.ka,279,va.xa,1),Sd=>{Sd=Sd.result;let Wd=!1;var ee=ub.wl.getOsfControl(H);let je=null;ee&&(je=ee.getStoreType(),(ee=ee.getManifest())&&ee.getSharedRuntimeForCustomFunctions("Workbook")&&(Wd=!0));Fa.TaskExtensions.Ua(Sd.zSf(H,je,kc,Wd),Ue=>{qc.b(Ue)?
Ue.result?Oc(null):pd(OfficeExtension.WacRuntime.Utility.createRichApiException(pc.a.invalidArgument,Lc.a.instance.ia(1769))):pd(OfficeExtension.WacRuntime.Utility.createRichApiException(pc.a.generalException,Lc.a.instance.ia(1765)))},va.xa,3)},va.xa,3)};class jd{constructor(H){if(!H)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.b2d=H}areShortcutsInUse(H){return OfficeExtension.WacRuntime.Utility.createPromise((va,ub)=>
{this.b2d.checkShortcutsInUse(H).then(kc=>{va(kc)}).catch(kc=>{ub(kc)})})}getShortcuts(){return OfficeExtension.WacRuntime.Utility.createPromise((H,va)=>{this.b2d.getShortcuts().then(ub=>{H(ub)}).catch(ub=>{va(ub)})})}replaceShortcuts(H){return OfficeExtension.WacRuntime.Utility.createPromise((va,ub)=>{this.b2d.replaceShortcuts(H).then(()=>{va(null)}).catch(kc=>{ub(kc)})})}getTypeName(){return"Microsoft.Office.ActionService"}invokePropertyGet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);
}invokePropertyGetAsync(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}invokePropertySet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertySetAsync(H,va){this.invokePropertySet(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokeMethodAsync(H,va){switch(H){case 3:return this.FFh(va);case 1:return this.FUi();
case 2:return this.wmk(va)}H=this.invokeMethod(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}FFh(H){H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"Array<string>");return this.areShortcutsInUse(H)}FUi(){return this.getShortcuts()}wmk(H){H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"any");return this.replaceShortcuts(H)}}Object(I.a)(jd,"ActionService",null,[]);class Yd{constructor(){this.data=null}}Object(I.a)(Yd,"AugLoopHostMessageReceivedEventArgs",
null,[]);var te=a(1243);class oe{constructor(H,va,ub){this.bT=H;this.zW=void 0===va?!1:va;this.tW=(void 0===ub?null:ub)||OfficeExtension.WacRuntime.RichApi.getEventManager()}sendMessage(H){this.zW||te.a.Iwk(H)}_RegisterHostMessageReceivedEvent(){this.zW||(oe.Jzg||(te.a.Cek(H=>{this.tW.fireEvent("",65542,Object.assign(new Yd,{data:H}))}),oe.Jzg=!0),this.tW.register(this.bT,"",65542))}_UnregisterHostMessageReceivedEvent(){this.zW||this.tW.unregister(this.bT,"",65542)}getTypeName(){return"Microsoft.Office.AugLoopEventService"}invokePropertyGet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);
}invokePropertyGetAsync(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}invokePropertySet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertySetAsync(H,va){this.invokePropertySet(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(H,va){switch(H){case 1:return this.twk(va);case 2:return this.Fch();case 3:return this.Lch()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);
}invokeMethodAsync(H,va){H=this.invokeMethod(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}twk(H){H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"string");this.sendMessage(H);return null}Fch(){this._RegisterHostMessageReceivedEvent();return null}Lch(){this._UnregisterHostMessageReceivedEvent();return null}}oe.Jzg=!1;Object(I.a)(oe,"AugLoopEventService",null,[]);var Kd=a(1010),Ee=a(949),rc=a(124),fd=a(599);class Ed{constructor(H,va,ub){this.ped=this.nJe=
null;this.bT=H;this.VQe=va;if(this.Ga=ub)this.nJe=this.Ga.Xa("GetAccessTokenOAuthFirstPartyAllowList")}mPi(){this.ped||(this.ped=fd.a.hv(Object(Kd.a)()));return this.ped}ujj(H,va){if(!this.VQe||""===this.bT||!this.Ga)return!1;const ub=this.VQe.getOsfControl(this.bT);if(!ub)return!1;let kc=!1;this.nJe.split(";").forEach(Oc=>{va===Oc&&(kc=!0)});return 1===P.AFrameworkApplication.ra.$d.Om&&ub.isFirstParty()&&H===Ed.fDh&&kc&&rc.d(ub.getSolutionId())===Ed.gDh}getAccessTokenFirstPartyOAuth(H,va){let ub;
ub=this.ujj(H,va)?kc=>{const Oc=this.mPi();Oc.continueWith(()=>{Oc.result.JD(H,va).then(pd=>{kc(pd);return pd})})}:kc=>{kc(Object.assign(new Ee.a,{IsSuccess:!1,Token:null,ErrorCode:"NotEnabled",ErrorMessage:"OAuthManager is disabled."}))};return OfficeExtension.WacRuntime.Utility.createPromise(ub)}getTypeName(){return"Microsoft.Office.Auth"}invokePropertyGet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertyGetAsync(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}invokePropertySet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);
}invokePropertySetAsync(H,va){this.invokePropertySet(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokeMethodAsync(H,va){switch(H){case 1:return this.yBi(va)}H=this.invokeMethod(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}yBi(H){const va=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"string");H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,
1,"string");return this.getAccessTokenFirstPartyOAuth(va,H)}}Ed.fDh="Maker";Ed.gDh="fa000000043";Object(I.a)(Ed,"Auth",null,[]);var Rd=a(1102),Fe=a(44),Ae=a(66);class We{constructor(){this.wEa=null}oUi(){this.wEa||(this.wEa=fd.a.hv(Object(Rd.a)()));return this.wEa}getSharedFilePickerResponse(H){return OfficeExtension.WacRuntime.Utility.createPromise((va,ub)=>{try{const kc=this.oUi();Ae.Task.WAA.call(null,kc).continueWith(()=>{const Oc=kc.result;if(Oc){let pd={};(()=>{let Sd=Fe.d(H);({hz:pd}=Sd);return Sd})().returnValue?
Oc.Lyc(pd).then(Sd=>{Sd&&0<Sd.length?va(Sd):ub(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker returned null or an empty array."))}).catch(Sd=>{ub(Sd)}):ub(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else ub(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker is resolved as null."))})}catch(kc){ub(kc)}})}getTypeName(){return"Microsoft.Office.SharedFilePicker"}invokePropertyGet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);
}invokePropertyGetAsync(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}invokePropertySet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertySetAsync(H,va){this.invokePropertySet(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokeMethodAsync(H,va){switch(H){case 1:return this.nUi(va)}H=this.invokeMethod(H,
va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}nUi(H){H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"string");return this.getSharedFilePickerResponse(H)}}Object(I.a)(We,"SharedFilePicker",null,[]);var ve=a(181);class Ze{Nff(H){return'[data-unique-id="Ribbon-'+H+'"]'}Cqg(H,va){va=JSON.parse(va);if("callout"===va.type)return va.params.target=this.Nff(va.params.target),H.callout(va.params);va.props.target=this.Nff(va.props.target);return va.props}r1j(H){return JSON.parse(H)}addNotification(H,
va){if(!this.zW)return ve.a.hK().then(ub=>ub.addNotification(this.Cqg(ub,H),this.r1j(va)))}removeNotification(H){if(!this.zW)return ve.a.hK().then(va=>va.removeNotification(H))}updateNotification(H,va){if(!this.zW)return ve.a.hK().then(ub=>ub.updateNotification(H,this.Cqg(ub,va)))}getTypeName(){return"Microsoft.Office.NotificationService"}invokePropertyGet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertyGetAsync(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}invokePropertySet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);
}invokePropertySetAsync(H,va){this.invokePropertySet(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokeMethodAsync(H,va){switch(H){case 1:return this.dvh(va);case 3:return this.nhk(va);case 2:return this.B5k(va)}H=this.invokeMethod(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}dvh(H){const va=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,
0,"string");H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,1,"string");return this.addNotification(va,H)}nhk(H){H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"string");return this.removeNotification(H)}B5k(H){const va=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"string");H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,1,"string");return this.updateNotification(va,H)}}Object(I.a)(Ze,"NotificationService",null,[]);class Oe{constructor(H){this.y8f=
H}execute(H,va){if(this.y8f){const ub=this.y8f.lookupApi(H);if(ub)return ub.Xhl(va)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}getTypeName(){return"Microsoft.Office.DispatchApiService"}invokePropertyGet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertyGetAsync(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}invokePropertySet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);
}invokePropertySetAsync(H,va){this.invokePropertySet(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokeMethodAsync(H,va){switch(H){case 1:return this.cri(va)}H=this.invokeMethod(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}cri(H){const va=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"string");H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,
1,"string");return this.execute(va,H)}}Object(I.a)(Oe,"DispatchApiService",null,[]);class Nf{createInstance(H,va,ub,kc,Oc,pd){ub=void 0===ub?"":ub;kc=void 0===kc?null:kc;Oc=void 0===Oc?null:Oc;pd=void 0===pd?null:pd;switch(H){case "Microsoft.Office.ActionService":return new jd(va);case "Microsoft.Office.SharedFilePicker":return new We;case "Microsoft.Office.Auth":return new Ed(ub,kc,Oc);case "Microsoft.Office.AugLoopEventService":return new oe(ub);case "Microsoft.Office.NotificationService":return new Ze;
case "Microsoft.Office.DispatchApiService":return new Oe(pd)}return null}}Object(I.a)(Nf,"WacApiHost",null,[]);var Zf=a(139);class Rb{constructor(){this.responseData=null}}Object(I.a)(Rb,"UserFeedbackResponseEventArgs",null,[]);class Vb{constructor(){this.isFeedbackSent=!1}}Object(I.a)(Vb,"UserFeedbackUIDismissedEventArgs",null,[]);var Cc=a(242);class rg{constructor(H,va,ub,kc){this.bT=H;this.dgh=va;this.zW=void 0===ub?!1:ub;this.tW=(void 0===kc?null:kc)||OfficeExtension.WacRuntime.RichApi.getEventManager()}onDismiss(H){this.tW.fireEvent("",
65546,Object.assign(new Vb,{isFeedbackSent:H}))}onError(){}asi(H){this.tW.fireEvent("",65550,Object.assign(new Rb,{responseData:JSON.stringify(H)}))}qPi(H){switch(H){case 0:return"Smile";case 1:return"Frown";case 2:return"Idea";case 3:return"Unclassified";default:return"Unclassified"}}rPi(H){switch(H){case 0:return"Modal";case 1:return"SidePane";default:return"Modal"}}pPi(H){const va={};va.isScenarioEnabled=H.isScenarioEnabled;va.scenarioType=H.scenarioType;if(H=H.question){const ub={};ub.questionUiType=
H.questionUIType;ub.questionUiBehavior=H.questionUiBehavior;ub.questionUiBehaviour=H.questionUiBehaviour;ub.questionInstruction=H.questionInstruction;ub.questionOptions=H.questionOptions;va.questionDetails=ub}return va}cUa(H,va,ub){"True"===ub?H[va]=!0:"False"===ub&&(H[va]=!1)}canCollectUserFeedback(){return P.AFrameworkApplication.zC}collectUserFeedback(H,va,ub,kc){if(!this.zW){const Oc={};P.AFrameworkApplication.fa.Ild(Oc);const pd=this.dgh.getContext(Oc);pd.initialFeedbackType=this.qPi(H);pd.uiType=
this.rPi(va);pd.telemetryGroup.featureArea=ub;kc.v2Config.contextDataFiles&&(pd.isShareContextDataEnabled=!0,pd.getContextData=()=>Promise.all(Cc.a.map(kc.v2Config.contextDataFiles,Sd=>window.fetch("data:application/octet-stream;base64,"+Sd.base64Data).then(Wd=>Wd.blob()).then(Wd=>new File([Wd],Sd.fileName,{type:Sd.fileType})))));(H=kc.v2Config.scenarioConfig)&&(pd.scenarioConfig=this.pPi(H));this.cUa(pd,"showEmailAddress",kc.v2Config.isEmailCollectionEnabled);this.cUa(pd,"isFileUploadEnabled",kc.v2Config.isFileUploadEnabled);
this.cUa(pd,"screenshot",kc.v2Config.isScreenshotEnabled);this.cUa(pd,"isScreenRecordingEnabled",kc.v2Config.isScreenRecordingEnabled);this.cUa(pd,"isThankYouPageDisabled",kc.v2Config.isThankYouPageDisabled);this.cUa(pd,"isHostManagedContextDataEnabled",kc.v2Config.isHostManagedContextDataEnabled);this.cUa(pd,"isRetrieveFormDataEnabled",kc.v2Config.isRetrieveFormDataEnabled);pd.hostManagedContextDataExplanationUrl=kc.v2Config.hostManagedContextDataExplanationUrl;ve.a.KGf().then(Sd=>{Sd.initializeFeedbackModal(pd,
Object(Zf.a)(this,this.onDismiss,"onDismiss"),Object(Zf.a)(this,this.onError,"onError"),Object(Zf.a)(this,this.asi,"extractFeedbackDataForHost"));return Sd})}}_RegisterUserFeedbackResponseEvent(){this.zW||this.tW.register(this.bT,"",65550)}_RegisterUserFeedbackUIDismissedEvent(){this.zW||this.tW.register(this.bT,"",65546)}_UnregisterUserFeedbackResponseEvent(){this.zW||this.tW.unregister(this.bT,"",65550)}_UnregisterUserFeedbackUIDismissedEvent(){this.zW||this.tW.unregister(this.bT,"",65546)}getTypeName(){return"Microsoft.Office.UserFeedbackService"}invokePropertyGet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);
}invokePropertyGetAsync(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}invokePropertySet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertySetAsync(H,va){this.invokePropertySet(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(H,va){switch(H){case 27:return this.BPh();case 1:return this.vVh(va);case 28:return this.Ich();case 18:return this.Jch();case 29:return this.Och();
case 19:return this.Pch()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokeMethodAsync(H,va){H=this.invokeMethod(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}BPh(){return this.canCollectUserFeedback()}vVh(H){const va=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"int"),ub=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,1,"int"),kc=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,2,"string");H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,
3,"object");this.collectUserFeedback(va,ub,kc,H);return null}Ich(){this._RegisterUserFeedbackResponseEvent();return null}Jch(){this._RegisterUserFeedbackUIDismissedEvent();return null}Och(){this._UnregisterUserFeedbackResponseEvent();return null}Pch(){this._UnregisterUserFeedbackUIDismissedEvent();return null}}Object(I.a)(rg,"UserFeedbackService",null,[]);class yf{constructor(){this.displayName=this.description=this.color="";this.encryptionType=0;this.isEnabled=this.isDke=this.hasExtractForUser=!1;
this.labelId="";this.order=0;this.tenantId=this.parentName="";this.version=0;this.displayName=this.description=this.color="";this.encryptionType=0;this.isEnabled=this.isDke=this.hasExtractForUser=!1;this.labelId="";this.order=0;this.tenantId=this.parentName="";this.version=0}getTypeName(){return"Microsoft.Office.SensitivityLabelInfo"}invokePropertyGet(H){switch(H){case 15:return this.color;case 13:return this.description;case 12:return this.displayName;case 8:return this.encryptionType;case 10:return this.hasExtractForUser;
case 9:return this.isDke;case 7:return this.isEnabled;case 5:return this.labelId;case 11:return this.order;case 14:return this.parentName;case 6:return this.tenantId;case 4:return this.version}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertyGetAsync(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}invokePropertySet(H,va){switch(H){case 15:this.color=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,
0,"string");return;case 13:this.description=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,0,"string");return;case 12:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,0,"string");return;case 8:this.encryptionType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,0,"int");return;case 10:this.hasExtractForUser=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,0,"boolean");return;case 9:this.isDke=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,
0,"boolean");return;case 7:this.isEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,0,"boolean");return;case 5:this.labelId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,0,"string");return;case 11:this.order=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,0,"int");return;case 14:this.parentName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,0,"string");return;case 6:this.tenantId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,
0,"string");return;case 4:this.version=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertySetAsync(H,va){this.invokePropertySet(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokeMethodAsync(H,va){H=this.invokeMethod(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}}
Object(I.a)(yf,"SensitivityLabelInfo",null,[]);var jg;(function(H){H[H.qBi=0]="generic";H[H.coherencyFailure=1]="coherencyFailure";H[H.jmf=2]="disabledByPolicy";H[H.qil=3]="fileCheckedOut";H[H.ril=4]="fileEncrypted";H[H.sil=5]="fileLocked";H[H.uil=6]="fileNotSupported";H[H.fileTooLarge=7]="fileTooLarge";H[H.ajl=8]="invalidOperationOnZeroByteFile";H[H.Dsj=9]="labelDisabled";H[H.sjl=10]="labelErrorRetryLater";H[H.Esj=11]="labelIdNotFound";H[H.tjl=12]="labelIrmDisabledByTenant";H[H.ujl=13]="labelNotSupported";
H[H.Jjl=14]="mandatoryConflict";H[H.Njl=15]="minorVersionLimitExceeded"})(jg||(jg={}));Object(I.b)("SetPolicyLabelErrorType",jg);var If=a(1244),cf;(function(H){H[H.Nfl=0]="S_APPLYLABEL_OK";H[H.xdl=2147467259]="E_APPLYLABEL_FAIL";H[H.Edl=2147205120]="E_APPLYLABEL_UNSUPPORTED_CROSSTENANT";H[H.wdl=2147205119]="E_APPLYLABEL_DOCUMENT_READONLY";H[H.ydl=2147205118]="E_APPLYLABEL_INSUFFICIENTPERMISSION";H[H.zdl=2147205117]="E_APPLYLABEL_LABELDISABLED";H[H.Gdl=2147205116]="E_APPLYLABEL_UNSUPPORTED_UDP";H[H.Adl=
2147205115]="E_APPLYLABEL_LABELING_DISABLED";H[H.Ddl=2147205114]="E_APPLYLABEL_UNSUPPORTED_CONTENTTYPE";H[H.Fdl=2147205113]="E_APPLYLABEL_UNSUPPORTED_DKE";H[H.Bdl=2147205112]="E_APPLYLABEL_LABELNOTFOUND";H[H.Cdl=2147205105]="E_APPLYLABEL_NEWLABELSENSITIVITYORDER"})(cf||(cf={}));Object(I.b)("TryUpgradeLabelError",cf);class Nb{constructor(){this.context="";this.error=2147467259;this.previousLabel=this.newLabel=null;this.context="";this.error=2147467259;this.previousLabel=this.newLabel=null}getTypeName(){return"Microsoft.Office.SensitivityLabelChangedEventArgs"}invokePropertyGet(H){switch(H){case 20:return this.context;
case 21:return this.error;case 19:return this.newLabel;case 18:return this.previousLabel}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertyGetAsync(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}invokePropertySet(H,va){switch(H){case 20:this.context=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,0,"string");return;case 21:this.error=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,0,
"int");return;case 19:this.newLabel=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,0,"SensitivityLabelInfo");return;case 18:this.previousLabel=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,0,"SensitivityLabelInfo");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertySetAsync(H,va){this.invokePropertySet(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);
}invokeMethodAsync(H,va){H=this.invokeMethod(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}}Object(I.a)(Nb,"SensitivityLabelChangedEventArgs",null,[]);var Bc=a(180),Ob=a(386),zc=a(125);class od{constructor(H,va){this.tW=OfficeExtension.WacRuntime.RichApi.getEventManager();this.bT=H;this.mdc=va}Y5(){var H;return null===(H=P.AFrameworkApplication.fa)||void 0===H?void 0:H.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSensitivityLabelingInOfficeJS",!1)}rVb(){var H;
return null===(H=P.AFrameworkApplication.fa)||void 0===H?void 0:H.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRefactoringErrorCasesInOfficeJS",!1)}eWd(){var H;return null===(H=P.AFrameworkApplication.fa)||void 0===H?void 0:H.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRefactoringErrorEventInOfficeJS",!1)}REd(H,va,ub){const kc=new Nb;kc.context=H;kc.error=va;kc.newLabel=ub;this.tW.fireEvent("",65549,kc)}EM(H,va){H={["Class"]:"SensitivityService",["ControlId"]:this.bT,
["Api"]:H,["Hr"]:va.toString()};Bc.a.sendTelemetryEvent(Object.assign(new Ob.a,{name:"Office.Online.Extensibility.ContextualTabsRichApi.Diagnostics",dataFields:zc.a.rn(H)}))}yYi(H){return H.HasUserDefinedPermissions?2:H.IsEndpointProtectionEnabled?1:0}$ye(H){var va;const ub=new yf;ub.color=H.Color;ub.description=H.Tooltip;ub.displayName=H.ParentName?H.ParentName+"\\"+H.DisplayName:H.DisplayName;ub.encryptionType=this.yYi(H);ub.hasExtractForUser=H.HasExtractForUser;ub.isDke=!1;ub.isEnabled=H.Enabled;
ub.labelId=H.Id;ub.order=H.Order;ub.parentName=H.ParentName;ub.tenantId=null===(va=P.AFrameworkApplication.fa)||void 0===va?void 0:va.Xa("TenantId");ub.version=0;return ub}fJj(H){const va=new If.a;va.Id=H.labelId;va.Enabled=H.isEnabled;va.DisplayName=H.displayName;va.Order=H.order;va.Tooltip=H.description;va.IsEndpointProtectionEnabled=1==H.encryptionType||2==H.encryptionType;va.Color=H.color;va.HasUserDefinedPermissions=2==H.encryptionType;va.ParentName=H.parentName;return va}iCk(H){switch(H){case jg.qBi:return 2147467259;
case jg.jmf:return 2147205115;case jg.Esj:return 2147205112;case jg.Dsj:return 2147205117;default:return 2147467259}}DWf(H){var va;return H.tenantId===(null===(va=P.AFrameworkApplication.fa)||void 0===va?void 0:va.Xa("TenantId"))}getHighestSensitivityLabel(H){return OfficeExtension.WacRuntime.Utility.createPromise((va,ub)=>{var kc,Oc;if(this.Y5())if(!this.rVb()||null!==(kc=P.AFrameworkApplication.fa)&&void 0!==kc&&kc.la("SupportsPolicies"))if(H&&0!=H.length){if(this.rVb())for(const Sd of H)if(!this.DWf(Sd)){this.EM("getHighestSensitivityLabel",
2147647531);ub(2147647531);return}if(kc=null===(Oc=this.mdc)||void 0===Oc?void 0:Oc.instance){Oc=[];for(pd of H)Oc=Oc.concat(pd.labelId);var pd=kc.getHighestSensitivityLabel(Oc);null==pd?(this.EM("getHighestSensitivityLabel",2147205112),ub(2147205112)):va(this.$ye(pd))}else this.EM("getHighestSensitivityLabel",2147942488),ub(2147942488)}else this.EM("getHighestSensitivityLabel",2147942487),ub(2147942487);else this.EM("getHighestSensitivityLabel",2147205115),ub(2147205115);else this.EM("getHighestSensitivityLabel",
2147500033),ub(2147500033)})}getLabel(){return OfficeExtension.WacRuntime.Utility.createPromise((H,va)=>{var ub;if(this.Y5()){var kc=null===(ub=this.mdc)||void 0===ub?void 0:ub.instance;if(kc){var [Oc,pd]=kc.GCi();Oc?H(this.$ye(pd)):(this.EM("getLabel",pd),va(pd))}else this.EM("getLabel",2147942488),va(2147942488)}else this.EM("getLabel",2147500033),va(2147500033)})}tryUpgradeLabel(H,va){return OfficeExtension.WacRuntime.Utility.createPromise((ub,kc)=>{var Oc,pd;if(this.Y5())if(!this.rVb()||null!==
(Oc=P.AFrameworkApplication.fa)&&void 0!==Oc&&Oc.la("SupportsPolicies"))if(H)if(this.rVb()&&!this.DWf(H))this.EM("tryUpgradeLabel",2147205120),this.eWd()&&this.REd(va,2147205120,H),kc(2147205120);else if(Oc=null===(pd=this.mdc)||void 0===pd?void 0:pd.instance)if(va="OFFICEJS_SENSITIVITY_CONTEXT_"+va,pd=Oc.tryUpgradeLabel(this.fJj(H),va),0==pd)ub(pd);else{this.EM("tryUpgradeLabel",pd);if(this.eWd()&&(Object.values(cf).includes(pd)&&this.REd(va.substring(29),pd,H),2147205105===pd)){ub(0);return}kc(pd)}else this.EM("tryUpgradeLabel",
2147942488),kc(2147942488);else this.EM("tryUpgradeLabel",2147942487),kc(2147942487);else this.EM("tryUpgradeLabel",2147205115),this.eWd()&&this.REd(va,2147205115,H),kc(2147205115);else this.EM("tryUpgradeLabel",2147500033),kc(2147500033)})}_RegisterSensitivityLabelChangedEvent(){var H,va;this.Y5()?!this.rVb()||null!==(H=P.AFrameworkApplication.fa)&&void 0!==H&&H.la("SupportsPolicies")?(H=null===(va=this.mdc)||void 0===va?void 0:va.instance)?(H.dGb((ub,kc)=>{var Oc;ub=new Nb;ub.context=(null===(Oc=
kc.context)||void 0===Oc?0:Oc.startsWith("OFFICEJS_SENSITIVITY_CONTEXT_"))?kc.context.substring(29):kc.context;ub.error=kc.f1?0:this.iCk(kc.aNg);ub.newLabel=this.$ye(kc.Jlc);this.tW.fireEvent("",65549,ub)}),this.tW.register(this.bT,"",65549)):this.EM("registerSensitivityLabelChangedEvent",2147942488):this.EM("getHighestSensitivityLabel",2147205115):this.EM("registerSensitivityLabelChangedEvent",2147500033)}_UnregisterSensitivityLabelChangedEvent(){this.Y5()?this.tW.unregister(this.bT,"",65549):this.EM("unregisterSensitivityLabelChangedEvent",
2147500033)}getTypeName(){return"Microsoft.Office.SensitivityService"}invokePropertyGet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertyGetAsync(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}invokePropertySet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertySetAsync(H,va){this.invokePropertySet(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(H){switch(H){case 16:return this.Gch();
case 17:return this.Mch()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokeMethodAsync(H,va){switch(H){case 3:return this.qLi(va);case 1:return this.FMi();case 2:return this.E0k(va)}H=this.invokeMethod(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}qLi(H){H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"Array<Common.App.AppsForOffice.SensitivityLabelInfo>");return this.getHighestSensitivityLabel(H)}FMi(){return this.getLabel()}E0k(H){const va=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"SensitivityLabelInfo");H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,1,"string");return this.tryUpgradeLabel(va,H)}Gch(){this._RegisterSensitivityLabelChangedEvent();return null}Mch(){this._UnregisterSensitivityLabelChangedEvent();return null}}Object(I.a)(od,"SensitivityService",null,[]);class ce{launchSimpleDialog(){return null}getTypeName(){return"Microsoft.Office.ShowSimpleDialog"}invokePropertyGet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);
}invokePropertyGetAsync(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}invokePropertySet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertySetAsync(H,va){this.invokePropertySet(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokeMethodAsync(H,va){switch(H){case 1:return this.Ltj(va)}H=this.invokeMethod(H,
va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}Ltj(H){const va=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"string"),ub=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,1,"string"),kc=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,2,"string"),Oc=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,3,"int"),pd=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,4,"boolean"),Sd=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,
5,"string"),Wd=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,6,"boolean");H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,7,"string");return this.launchSimpleDialog(va,ub,kc,Oc,pd,Sd,Wd,H)}}Object(I.a)(ce,"ShowSimpleDialog",null,[]);var Qb=a(980),Xc=a(1549),md=a(1235),ie=a(1237),me=a(1234),Pe=a(1236);class gf{YNd(H){const va=new md.a("FA000000012","sdxcatalog","sdxcatalog","0.0.0.0"),ub=new Pe.a(Qb.a.sPi(),"Web","en-Us"),kc=new ie.a;kc.Iw=H;Xc.a.instance.pya(va,me.a.taskpane,
"CopilotHelpTaskpane",ub,kc)}launchHelpPaneByArticleId(H){this.YNd({SourceControlId:"SearchHelp",query:"AssetID="+H});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}launchHelpPaneByArticleIdString(H){this.YNd({SourceControlId:"SearchHelp",query:"AssetID="+H});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}launchHelpPaneByQuery(H){this.YNd({SourceControlId:"SearchHelp",query:H});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.CopilotService"}invokePropertyGet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);
}invokePropertyGetAsync(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}invokePropertySet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertySetAsync(H,va){this.invokePropertySet(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokeMethodAsync(H,va){switch(H){case 2:return this.stj(va);case 3:return this.ttj(va);
case 1:return this.utj(va)}H=this.invokeMethod(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}stj(H){H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"int");return this.launchHelpPaneByArticleId(H)}ttj(H){H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"string");return this.launchHelpPaneByArticleIdString(H)}utj(H){H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"string");return this.launchHelpPaneByQuery(H)}}Object(I.a)(gf,
"CopilotService",null,[]);class tf{constructor(H,va){this.hideInternal=H;this.showInternal=va}hide(H){this.checkInvalidArgument(H,"caller");return OfficeExtension.WacRuntime.Utility.createPromise((va,ub)=>{this.hideInternal(H).then(va).catch(ub)})}show(H,va){this.checkInvalidArgument(H,"caller");this.checkInvalidArgument(va,"options");return OfficeExtension.WacRuntime.Utility.createPromise((ub,kc)=>{this.showInternal(H,va).then(ub).catch(kc)})}getTypeName(){return"Microsoft.Office.BusinessBarService"}checkInvalidArgument(H,
va){if(OfficeExtension.WacRuntime.Utility.isNullOrUndefined(H))throw OfficeExtension.WacRuntime.Utility.createInvalidArgumentException(va);}invokePropertyGet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertyGetAsync(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}invokePropertySet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertySetAsync(H,va){this.invokePropertySet(H,
va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokeMethodAsync(H,va){switch(H){case 2:return this.B5i(va);case 1:return this.eMk(va)}H=this.invokeMethod(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}B5i(H){H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"string");return this.hide(H)}eMk(H){const va=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,
0,"string");H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,1,"BusinessBarShowArgs");return this.show(va,H)}}Object(I.a)(tf,"BusinessBarService",null,[]);class Qe{constructor(){this.m_hideCloseButton=!1;this.m_message="";this.m_messageType=0;this.m_title=""}get hideCloseButton(){return this.m_hideCloseButton}set hideCloseButton(H){this.m_hideCloseButton=H}get message(){return this.m_message}set message(H){this.m_message=H}get messageType(){return this.m_messageType}set messageType(H){this.m_messageType=
H}get title(){return this.m_title}set title(H){this.m_title=H}getTypeName(){return"Microsoft.Office.BusinessBarShowArgs"}invokePropertyGet(H){switch(H){case 6:return this.hideCloseButton;case 4:return this.message;case 5:return this.messageType;case 3:return this.title}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertyGetAsync(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}invokePropertySet(H,va){switch(H){case 6:this.hideCloseButton=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,0,"boolean");return;case 4:this.message=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,0,"string");return;case 5:this.messageType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,0,"int");return;case 3:this.title=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertySetAsync(H,va){this.invokePropertySet(H,
va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokeMethodAsync(H,va){H=this.invokeMethod(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}}Object(I.a)(Qe,"BusinessBarShowArgs",null,[]);var Ca;(function(H){H[H.info=0]="info";H[H.error=1]="error";H[H.jJh=2]="blocked";H[H.zrl=3]="severeWarning";H[H.success=4]="success";H[H.warning=5]="warning"})(Ca||(Ca={}));
Object(I.b)("BusinessBarType",Ca);var yb=a(655);class wc{constructor(H,va,ub,kc,Oc){this.Zjd=null;this.Pac=H;this.jt=va;this.Ox=ub;this.fh=kc;this.Hrh=Oc}hostName(){return"ExcelOnline"}appId(){return this.Pac}createInstance(H){switch(H){case "Microsoft.Authentication.AuthenticationService":H=Wc.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory");var va=this.Ox.wl,ub=this.jt;za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",
!1)&&(ub=this.Ox.L$(this.jt));return H.create(ub,va);case "Microsoft.Authentication.TokenParameters":return new hd;case "Microsoft.ExcelServices.CustomFunctionManager":return H=za.EwaSettings.Ra(114),va=za.EwaSettings.Ra(115),new Ac(H,va,bd(this.Pac,this.fh,this.Ox));case "Microsoft.AppRuntime.AppRuntimeService":return new cc(this.jt,this.Ox);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return H=la.f.Ha()?this.Ox:ob.a(this.fh),new Sa(this.Pac,this.jt,H,this.Ox);
case "Microsoft.DynamicRibbon.DynamicRibbon":return H=la.f.Ha()?this.Ox:ob.a(this.fh),va=null,va=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseFindOsfControlSafe",!1)?H.ZNb(this.jt).Nn:H.Er(this.jt).Nn,new yd.DynamicRibbon(this.Pac,this.jt,this.Ox,H,va);case "Microsoft.Office.Licensing.License":return new Sc(this.jt,this.Ox);case "Microsoft.InternalService.AddinInternalService":return new rb(this.jt);case "Microsoft.Office.AugLoopEventService":const kc=la.f.Ha()?this.Ox:ob.a(this.fh);
let Oc=null;Oc=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseFindOsfControlSafe",!1)?kc.ZNb(this.jt).Nn:kc.Er(this.jt).Nn;va=()=>"9202c06a-b7d3-466f-9adb-acad75789dbc"===Oc.PrimaryMarketplace.SolutionId&&za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.AugLoopEventServiceDevBypass",!1)&&("TestHost"===this.fh.ua.DocumentHostInfo.HostTier||"Dogfood"===P.AFrameworkApplication.Nh.AudienceGroup);if(yb.a(Oc)||va())return H=Wd=>(ee,je,Ue)=>{kc.un.RNd({actionType:Wd,
controlId:ee,messageType:Ue,targetId:je,message:""})},H={register:H(1),unregister:H(2),fireEvent:(Wd,ee,je)=>{kc.un.yR(ee,Wd)&&kc.iM(ee,Wd,JSON.stringify(je))}},new oe(this.jt,!1,H);break;case "Microsoft.Office.UserFeedbackService":const pd=la.f.Ha()?this.Ox:ob.a(this.fh);let Sd=null;Sd=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseFindOsfControlSafe",!1)?pd.ZNb(this.jt).Nn:pd.Er(this.jt).Nn;va=()=>"9202c06a-b7d3-466f-9adb-acad75789dbc"===Sd.PrimaryMarketplace.SolutionId&&za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.UserFeedbackServiceDevBypass",
!1)&&("TestHost"===this.fh.ua.DocumentHostInfo.HostTier||"Dogfood"===P.AFrameworkApplication.Nh.AudienceGroup);if(yb.a(Sd)||va())return H=Wd=>(ee,je,Ue)=>{pd.un.RNd({actionType:Wd,controlId:ee,messageType:Ue,targetId:je,message:""})},H={register:H(1),unregister:H(2),fireEvent:(Wd,ee,je)=>{pd.un.yR(ee,Wd)&&pd.iM(ee,Wd,JSON.stringify(je))}},new rg(this.jt,Wc.a.instance.resolve("Common.App.ICustomerFeedbackUiWrapper"),!1,H);break;case "Microsoft.Office.SensitivityLabelInfo":return new yf;case "Microsoft.Office.SensitivityService":va=
la.f.Ha()?this.Ox:ob.a(this.fh);ub=null;ub=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseFindOsfControlSafe",!1)?va.ZNb(this.jt).Nn:va.Er(this.jt).Nn;if(yb.a(ub))return new od(this.jt,Wc.a.instance.Qi("Common.App.Policy.Contracts.IPolicyManager"));break;case "Microsoft.Office.CopilotService":va=la.f.Ha()?this.Ox:ob.a(this.fh);ub=null;ub=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseFindOsfControlSafe",!1)?va.ZNb(this.jt).Nn:va.Er(this.jt).Nn;if("9202c06a-b7d3-466f-9adb-acad75789dbc"===
ub.PrimaryMarketplace.SolutionId)return new gf;break;case "Microsoft.Office.BusinessBarShowArgs":return new Qe;case "Microsoft.Office.BusinessBarService":va=(la.f.Ha()?this.Ox:ob.a(this.fh)).Er(this.jt).Nn;if(yb.a(va)){const Wd={officeScriptsRunningStatus:64,msFormsDataSyncRunningStatus:69},ee=Ta.a.resolve(ba.C,{va:1}).catch(je=>{throw je;});return new tf(je=>No(function*(){if(OfficeExtension.WacRuntime.Utility.isNullOrUndefined(Wd[je]))throw OfficeExtension.WacRuntime.Utility.createInvalidArgumentException("caller");
(yield ee).removeEntry(Wd[je])}),(je,Ue)=>No(function*(){if(OfficeExtension.WacRuntime.Utility.isNullOrUndefined(Wd[je]))throw OfficeExtension.WacRuntime.Utility.createInvalidArgumentException("caller");Ue.businessBarType=Ca[Ue.messageType];(yield ee).Vjc(Wd[je],Ue)}))}break;case "Microsoft.Office.ShowSimpleDialog":va=(la.f.Ha()?this.Ox:ob.a(this.fh)).Er(this.jt).Nn;if(yb.a(va))return new ce;break;default:if(this.Zjd||(this.Zjd=new Nf),va=this.Zjd.createInstance(H,this.Hrh,this.jt,this.Ox.wl,P.AFrameworkApplication.fa))return va}sa.ULS.sendTraceTag(537163155,
0,10,`Typename: ${H} is an invalid parameter for the RichApiHost.CreateInstance method.`);throw OfficeExtension.WacRuntime.Utility.createRichApiException(pc.a.generalException,pc.a.generalException);}lookupApi(){}}Object(I.a)(wc,"RichApiHost",null,[]);var dd=a(436),vd=a(32),Zd=a(144),Re=a(86),ff=a(39),af=a(117),xf=a(326),eg=a(111),Ab=a(47),xc=a(282),eb=a(61),Ub=a(8),Fc=a(75),rd=a(1032),Gd=a(1410);class ue{constructor(){this.wIe=this.SHe=this.Dra=null;this.tBb=0}get displayName(){return this.Dra}set displayName(H){this.Dra=
H}get email(){return this.SHe}set email(H){this.SHe=H}get federationProvider(){return this.wIe}set federationProvider(H){this.wIe=H}get identityType(){return this.tBb}set identityType(H){this.tBb=H}getTypeName(){return"Microsoft.Authentication.OfficeIdentityInfo"}invokePropertyGet(H){switch(H){case 4:return this.displayName;case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertyGetAsync(H){H=
this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}invokePropertySet(H,va){switch(H){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,
0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertySetAsync(H,va){this.invokePropertySet(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokeMethodAsync(H,va){H=this.invokeMethod(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}static B2h(H){const va=new ue;va.displayName=H.displayName;va.email=H.email;
if($b.a.isChangeGateEnabled("OfficeVSO:8577366_FixIdentityType"))switch(H.authority){case "MicrosoftAccount":va.identityType=1;break;default:va.identityType=0}else switch(H.authority){case Gd.a.rpg:va.identityType=1;break;default:va.identityType=0}va.federationProvider="";return va}}Object(I.a)(ue,"OfficeIdentityInfo",null,[]);class Ce{static get Jqf(){return Ce.hhh}static Ejb(H){return H in Ce.Jqf?Ce.Jqf[H].toString():H}}Ce.hhh={["GeneralException"]:pc.a.generalException,["AccessDenied"]:pc.a.wkd,
["ApiNotAvailable"]:pc.a.wlc,["UserNotSignedIn"]:pc.a.$xe,["UserAborted"]:pc.a.$xb,["UnsupportedUserIdentity"]:pc.a.F2k,["InvalidResourceUrl"]:pc.a.Alb,["InvalidGrant"]:pc.a.FDc,["AddinIsAlreadyRequestingToken"]:pc.a.HBh,["ResourceNotAllowed"]:pc.a.Lpk,["ClientError"]:pc.a.Yoc,["ServerError"]:pc.a.serverError};Ce.map=null;Object(I.a)(Ce,"SingleSignOnErrorCodeMap",null,[]);class Se{constructor(H,va){this.rac=H;this.tBb=va}get accessToken(){return this.rac}set accessToken(H){this.rac=H}get tokenIdenityType(){return this.tBb}set tokenIdenityType(H){this.tBb=
H}getTypeName(){return"Microsoft.Authentication.SingleSignOnToken"}invokePropertyGet(H){switch(H){case 2:return this.accessToken;case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertyGetAsync(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}invokePropertySet(H,va){switch(H){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,0,"string");return;case 3:this.tokenIdenityType=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(va,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertySetAsync(H,va){this.invokePropertySet(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokeMethodAsync(H,va){H=this.invokeMethod(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}}Object(I.a)(Se,
"SingleSignOnToken",null,[]);class of{constructor(H,va){this.Mzb=va;this.jt=H}get roamingSettings(){return null}getAccessToken(H){const va=this.Mzb.getOsfControl(this.jt),ub=va.getManifest(),kc=ub.getMarketplaceID();this.UU(H,kc);return OfficeExtension.WacRuntime.Utility.createPromise((Oc,pd)=>{va.isFirstParty()&&this.Mzb._enableFirstPartySSO?this.Jej(ub,H)?Wc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(H,kc).then(Sd=>{Oc(Sd)},Sd=>{pd(Sd)}):pd(pc.a.wkd):pd(pc.a.wlc)}).then(Oc=>
{let pd;switch(Oc.authority){case Gd.a.rpg:pd=1;break;default:pd=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Se(Oc.accessToken,pd))},Oc=>{this.logErrorResponse(H,kc,Oc);return Oc?OfficeExtension.WacRuntime.Utility.createPromise((pd,Sd)=>{Sd(OfficeExtension.WacRuntime.Utility.createRichApiException(Oc,Ce.Ejb(Oc)))}):OfficeExtension.WacRuntime.Utility.createPromise((pd,Sd)=>{Sd(OfficeExtension.WacRuntime.Utility.createRichApiException(pc.a.generalException,Ce.Ejb(pc.a.generalException)))})})}getAuthContext(){return null}getPrimaryIdentityInfo(){const H=
this.Mzb.getOsfControl(this.jt);H.getManifest();const va=H.getManifest().getMarketplaceID();return OfficeExtension.WacRuntime.Utility.createPromise((ub,kc)=>{Wc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(va).then(Oc=>{ub(Oc)},Oc=>{kc(Oc.toString())})}).then(ub=>{ub=ue.B2h(ub);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ub)},ub=>ub?OfficeExtension.WacRuntime.Utility.createPromise((kc,Oc)=>{Oc(OfficeExtension.WacRuntime.Utility.createRichApiException(ub,
Ce.Ejb(ub)))}):OfficeExtension.WacRuntime.Utility.createPromise((kc,Oc)=>{Oc(OfficeExtension.WacRuntime.Utility.createRichApiException(pc.a.generalException,Ce.Ejb(pc.a.generalException)))}))}getTypeName(){return"Microsoft.Authentication.AuthenticationService"}invokePropertyGet(H){switch(H){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokePropertyGetAsync(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}invokePropertySet(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);
}invokePropertySetAsync(H,va){this.invokePropertySet(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);}invokeMethodAsync(H,va){switch(H){case 1:return this.zBi(va);case 3:return this.WCi();case 2:return this.gRi()}H=this.invokeMethod(H,va);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)}zBi(H){H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,hd);return this.getAccessToken(H)}WCi(){return this.getAuthContext()}gRi(){return this.getPrimaryIdentityInfo()}Jej(H,
va){let ub=!1;const kc=H.getWebApplicationAuthorizations();H=null;for(const Oc of kc)if(Oc.getResource().toLowerCase()===va.resource.toLowerCase()){H=Oc;ub=!0;break}if(!ub)return!1;va=va.scope.split(" ,+");for(const Oc of va)if(Oc&&Oc.length){va=!1;for(const pd of H.getScopes())Oc.toLowerCase()===pd.toLowerCase()&&(va=!0);if(!va)return!1}return!0}UU(H,va){H=this.Icg(H.resource);sa.ULS.sendTraceTag(538572831,369,50,"{0}",{["manifestId"]:va,["resource"]:H})}logErrorResponse(H,va,ub){H=this.Icg(H.resource);
sa.ULS.sendTraceTag(538572830,369,10,"{0}",{["manifestId"]:va,["resource"]:H,["error"]:ub})}Icg(H){return H.replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(I.a)(of,"AuthenticationService",null,[]);class jf{create(H,va){return new of(H,va)}}Object(I.a)(jf,"AuthenticationServiceFactory",null,[]);Object(Ta.b)(ba.wb,{yk:"singleton"})(H=>No(function*(){var va;const ub=yield Ta.a.resolve(ba.Lb,H),kc=yield Ta.a.resolve(ba.vb,H),Oc=yield Ta.a.resolve(ba.kd,H),pd=yield Ta.a.resolve(ba.Tb,
H),Sd=yield Ta.a.resolve(ba.Wd,H);yield rd.a(ub.xa,null!==(va=H.va)&&void 0!==va?va:0);yield Ta.a.resolve(ba.id,H);Wc.a.instance.register(jf,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").hi().mi(()=>new jf);return new bf(ub,kc,Sd,Oc,pd)}));class bf{constructor(H,va,ub,kc,Oc){this.ji=this.rangePicker=this.externalLinksManager=null;this.$=H;this.ri=va;this.ji=kc;this.Dk=new ec(H.ea);this.rJ=new Tc(H,this.Dk);this.nbg=ub;this.Jvc=new Map;this.externalLinksManager=Oc}get Q_(){return this.Dk}dispose(){this.$=
this.Jvc=null}Bi(){return!1}Ji(){return!1}executeCommand(H,va,ub){H=va.command;switch(H){case 451041795:this.Dk.Rn(ub[Xa.a.Wk],ub[Xa.a.Vea]);break;case 974713501:this.p1i(ub[Xa.a.Wk],ub[Xa.a.Vea]);break;case 1237877382:this.Dk.cE(ub[Xa.a.Vea]);break;default:return xa.a(H)}return Ae.Task.Va(!0)}ni(H,va,ub){if(H=!!ub)switch(va.command){case 974713501:case 1237877382:case 451041795:break;default:H=!1}return H}p1i(H,va){var ub;const kc=H.DdaMethod;"undefined"===typeof kc.DispatchId?this.Dk.Rn(Na.a.internalError,
va):bf.Zgj(H)||this.$.wj&1?(kc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new Nd(this.$,this,H,va,this.ji)).start(this.ri,H.DdaMethod.ControlId):kc.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.MTi(H,va):kc.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.fDk(H,va):kc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?this.addBinding(H,this.wId(H.DdaMethod.ControlId),0,va):kc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?
this.oDi(H,va):kc.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.syk(H,va):kc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.nDi(H,va):kc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?this.Zfk(H,va):kc.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.iCi(H,va):kc.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?this.R_d(H,va):kc.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(H,va):kc.DispatchId===
OSF.DDA.MethodDispId.dispidAddRowsMethod?(H.DdaAddRowsColumns.IsRow=!0,this.D_e(H,va)):kc.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(H.DdaAddRowsColumns.IsRow=!1,this.D_e(H,va)):kc.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?this.g$h(H,va):kc.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.pTh(H,va):kc.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?(H.DdaSetBindingFormats.IsSetFormats=!0,this.IKg(H,va)):kc.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?
(H.DdaSetBindingFormats.IsSetFormats=!1,this.IKg(H,va)):kc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(H,H.DdaBindingsMethod.ItemName,H.DdaBindingsMethod.FailOnCollision?2:1,va):kc.DispatchId===OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.lJi(va):kc.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.d4d(H,va):kc.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(H,va):kc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?
this.WHi(H,va):kc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.XHi(H,va):kc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.agk(H,va):kc.DispatchId===OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(H.DdaMethod.ControlId,H),this.Dk.cE(va)):kc.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?this.SDj(H,va):kc.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?
this.PDj(H,va):kc.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(H,va):kc.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?this.getAuthContext(H,va):kc.DispatchId===OSF.DDA.MethodDispId.dispidGetNestedAppAuthContextMethod?this.CKd(H,va):kc.DispatchId===OSF.DDA.MethodDispId.dispidExecuteFeature?this.executeFeature(H,va):kc.DispatchId===OSF.DDA.MethodDispId.dispidQueryFeature?this.queryFeature(H,va):this.Dk.Rn(Na.a.I9d,va),za.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&
kc.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(va=H.DdaMethod.ControlId,za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&(va=this.ri.L$(H.DdaMethod.ControlId)),H=this.ri.wX(va),va="",H&&(va=wa.DdaFacade.getSolutionId(H,this.$),va=Telemetry.PrivacyRules.GetPrivacyCompliantId(va,H.OwnerAddinStoreType||H.PrimaryMarketplace.MarketplaceType,null===(ub=H.AssetMarketplace)||void 0===ub?void 0:ub.SolutionId,null,null,H.PrimaryMarketplace.MarketplaceRef)),
sa.ULS.sendTraceTag(537163224,344,50,`DDA method Id: ${kc.DispatchId}, AppID: ${va}`))):this.Dk.Rn(Na.a.lnf,va)}oDi(H,va){H.DdaGetBindingData.CoerceType=bf.kpc(H.DdaGetBindingData.CoerceType);H.DdaGetBindingData.FilterType=bf.Dwf(H.DdaGetBindingData.FilterType);H.DdaGetBindingData.ValueFormat=bf.o5g(H.DdaGetBindingData.ValueFormat);if(this.QHc(H.DdaGetBindingData.CoerceType,va)){if(H.DdaGetBindingData){var ub=H.DdaGetBindingData;0===ub.FilterType&&(ub.FilterType=2);ub.StartCol|=0;ub.StartRow|=0;ub.ColCount=
void 0===ub.ColCount?-1:ub.ColCount;ub.RowCount=void 0===ub.RowCount?-1:ub.RowCount}ub=H.DdaMethod.ControlId;za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&this.ri.lZ&&(ub=this.ri.twa(H.DdaMethod.ControlId));this.rJ.ddaGetBindingData(ub,H.DdaGetBindingData.BindingId,H.DdaGetBindingData.CoerceType,H.DdaGetBindingData.ValueFormat,H.DdaGetBindingData.FilterType,H.DdaGetBindingData.StartRow,H.DdaGetBindingData.StartCol,H.DdaGetBindingData.RowCount,H.DdaGetBindingData.ColCount,
kc=>{if(gc.a(kc)||!kc.Result)this.Dk.dR(kc,va);else{const Oc=this.Dk.SQ();Oc.Data=bf.l8e(kc.Result);va(Oc)}},va)}}syk(H,va){H.DdaSetBindingData.CoerceType=bf.kpc(H.DdaSetBindingData.CoerceType);if(this.QHc(H.DdaSetBindingData.CoerceType,va)){var ub=bf.jrd(H.DdaSetBindingData.CoerceType,H.DdaSetBindingData.Data);if(bf.cEc(ub))this.Dk.Rn(Na.a.H0c,va);else{1===ub.CoerceType&&(ub.CellFormat||(ub.CellFormat=H.DdaSetBindingData.CellFormat),ub.TableOptions||(ub.TableOptions=H.DdaSetBindingData.TableOptions));
H.DdaSetBindingData&&(H.DdaSetBindingData.StartCol|=0,H.DdaSetBindingData.StartRow|=0);var kc=H.DdaMethod.ControlId;za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&this.ri.lZ&&(kc=this.ri.twa(H.DdaMethod.ControlId));this.rJ.ddaSetBindingData(kc,H.DdaSetBindingData.BindingId,H.DdaSetBindingData.StartRow,H.DdaSetBindingData.StartCol,ub,Oc=>{gc.a(Oc)?this.Dk.dR(Oc,va):this.Dk.cE(va)},va)}}}MTi(H,va){H.DdaGetBindingData.CoerceType=bf.kpc(H.DdaGetBindingData.CoerceType);
H.DdaGetBindingData.ValueFormat=bf.o5g(H.DdaGetBindingData.ValueFormat);H.DdaGetBindingData.FilterType=bf.Dwf(H.DdaGetBindingData.FilterType);if(this.QHc(H.DdaGetBindingData.CoerceType,va)){var ub=this.wId(H.DdaMethod.ControlId);ub?this.rJ.ddaGetSelectedData(H.DdaMethod.ControlId,H.DdaGetBindingData.CoerceType,H.DdaGetBindingData.ValueFormat,H.DdaGetBindingData.FilterType,ub,kc=>{if(gc.a(kc))this.Dk.dR(kc,va);else{const Oc=this.Dk.SQ();Oc.Data=bf.l8e(kc.Result);va(Oc)}},va):this.Dk.Rn(Na.a.FIf,va)}}WHi(H,
va){const ub=H[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],kc=H[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],Oc=H.DdaMethod.ControlId,pd=kb.getInstance(this.$);if(0>=kc)sa.ULS.sendTraceTag(537163221,344,15,"Invalid slice size. It should be greater than 0."),this.Dk.Rn(Na.a.$cj,va);else if(kc>kb.lCj)sa.ULS.sendTraceTag(537163220,344,15,"Invalid slice size. It should be not greater than 4MB."),this.Dk.Rn(Na.a.UCf,va);else{var Sd=null;switch(ub){case 1:Sd="Compressed";break;
case 0:Sd="Text";break;case 2:Sd="Pdf";break;default:sa.ULS.sendTraceTag(537163219,344,15,`Requested file type ${ub} is not supported.`);this.Dk.Rn(Na.a.rwf,va);return}if("Text"===Sd)sa.ULS.sendTraceTag(537163218,344,15,`Requested file type ${Sd} is not supported.`),this.Dk.Rn(Na.a.rwf,va);else{za.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?(H=new Sys.StringBuilder,H.append(Db.a(this.$,Sd)),"Pdf"===Sd&&Aa.a.Dr(H,Hc.a.Cvg,"WholeWorkbook"),H=H.toString()):
H=Db.a(this.$,Sd);var Wd=null,ee=new XMLHttpRequest;ee.onreadystatechange=()=>{if(4===ee.readyState)if(200===ee.status){var je=ee.response;if(je){Wd=new Uint8Array(je);je=this.Dk.SQ();var Ue=Wd.length,G=kb.QGj(),da={},$a=0;for(let Sb=0;Sb<Ue;Sb+=kc){const Mc=[],sd=Sb+kc<Ue?Sb+kc:Ue;for(let Od=0,se=Sb;se<sd;Od++,se++)Mc[Od]=Wd[se];da[($a++).toString()]=Mc}da=new Bd(G,Ue,kc,da);da=pd.buh(Oc,da);da!==Na.a.success?this.Dk.Rn(da,va):(je[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=G,je[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=
Ue,sa.ULS.sendTraceTag(537163216,344,50,`GetFileAsync get file successfully for file type ${Sd}, the file size is ${Ue}`),va(je))}else sa.ULS.sendTraceTag(537163217,344,15,`Request is successful, but respone have no data for file type ${Sd}.`),this.Dk.Rn(Na.a.internalError,va)}else 500===ee.status?this.Dk.Rn(Na.a.nzf(parseInt(ee.statusText,10)),va):(sa.ULS.sendTraceTag(537163215,344,15,`Request failed to obtain the file for type ${Sd}.`),this.Dk.Rn(Na.a.tGj,va))};ee.open("GET",H,!0);ee.responseType=
"arraybuffer";ee.setRequestHeader("If-Modified-Since","0");ee.send(null)}}}XHi(H,va){var ub=H[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],kc=H[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];H=H.DdaMethod.ControlId;(ub=kb.getInstance(this.$).ZHi(H,ub))?(ub=ub.TOk,0>kc||kc>=Object.keys(ub).length?this.Dk.Rn(Na.a.g8i,va):(kc=ub[kc.toString()],ub=this.Dk.SQ(),ub[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=kc,ub[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=
kc.length,va(ub))):this.Dk.Rn(Na.a.internalError,va)}agk(H,va){var ub=H[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];H=H.DdaMethod.ControlId;ub=kb.getInstance(this.$).$fk(H,ub);ub===Na.a.success?this.Dk.cE(va):this.Dk.Rn(ub,va)}fDk(H,va){H.DdaSetBindingData.CoerceType=bf.kpc(H.DdaSetBindingData.CoerceType);if(this.QHc(H.DdaSetBindingData.CoerceType,va)){var ub=this.wId(H.DdaMethod.ControlId);if(ub){var kc=bf.jrd(H.DdaSetBindingData.CoerceType,H.DdaSetBindingData.Data),Oc=ea.f(this.$).ha;
1===kc.CoerceType&&(!kc.Data&&Oc.qa.H0&&(kc.Headers||(kc.Headers=[]),kc.Headers.length||kc.Headers.push([]),kc.Headers[0].length||kc.Headers[0].push("")),bf.cEc(kc)||(kc.CellFormat||(kc.CellFormat=H.DdaSetBindingData.CellFormat),kc.TableOptions||(kc.TableOptions=H.DdaSetBindingData.TableOptions)));if(bf.cEc(kc))this.Dk.Rn(Na.a.H0c,va);else{var pd=Oc.qa.Ui.clone(),Sd=Oc.qa.activeCell.clone();this.rJ.ddaSetSelectedData(H.DdaMethod.ControlId,ub,kc,Wd=>{var ee;if(gc.a(Wd))this.Dk.dR(Wd,va);else{Wd=pd.clone();
const je=kc.Headers?kc.Headers[0].length:kc.Data[0].length;1!==kc.CoerceType||kc.Data?1===kc.CoerceType&&(null===(ee=kc.TableOptions)||void 0===ee?0:ee.length)&&0==kc.TableOptions[0]?(Wd.top+=1,Wd.bottom=Wd.top+kc.Data.length-1):Wd.bottom=Wd.top+kc.Data.length-(1===kc.CoerceType?0:1):Wd.bottom=Wd.top+1;Wd.right=Wd.left+je-1;ee=Wd.contains(Sd)?Sd:Wd.topLeft;Oc.updateSelection(Wd,ee,0);this.Dk.cE(va)}},va)}}else this.Dk.Rn(Na.a.P$e,va)}}addBinding(H,va,ub,kc){if(va){var Oc=H.DdaMethod.ControlId;za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",
!1)&&this.ri.lZ&&(Oc=this.ri.twa(H.DdaMethod.ControlId));this.rJ.ddaAddBinding(Oc,H.DdaBindingsMethod.BindingId,H.DdaBindingsMethod.BindingType,va,ub,pd=>{if(gc.a(pd))this.Dk.dR(pd,kc);else{const Sd=this.Dk.SQ();Sd.Bindings=Array(1);Sd.Bindings[0]=this.ri.Fmc(pd.Result);kc(Sd)}},kc)}else this.Dk.Rn(Na.a.zvk,kc)}nDi(H,va){let ub=H.DdaMethod.ControlId;za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&this.ri.lZ&&(ub=this.ri.twa(H.DdaMethod.ControlId));this.rJ.ddaGetBinding(ub,
H.DdaBindingsMethod.BindingId,kc=>{if(gc.a(kc)||!kc.Result)this.Dk.dR(kc,va);else{const Oc=this.Dk.SQ();Oc.Bindings=Array(1);Oc.Bindings[0]=this.ri.Fmc(kc.Result);va(Oc)}},va)}lJi(H){const va=this.Dk.SQ(),ub={};ub[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;va[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=ub;H(va)}Zfk(H,va){let ub=H.DdaMethod.ControlId;za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&
this.ri.lZ&&(ub=this.ri.twa(H.DdaMethod.ControlId));this.rJ.ddaReleaseBinding(ub,H.DdaBindingsMethod.BindingId,kc=>{gc.a(kc)?this.Dk.dR(kc,va):this.Dk.cE(va)},va)}iCi(H,va){let ub=H.DdaMethod.ControlId;za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&this.ri.lZ&&(ub=this.ri.twa(H.DdaMethod.ControlId));this.rJ.ddaGetAllBindings(ub,kc=>{if(gc.a(kc))this.Dk.dR(kc,va);else{const Oc=this.Dk.SQ();if(kc.Result){kc=kc.Result;Oc.Bindings=Array(kc.length);for(let pd=
0;pd<kc.length;pd++)Oc.Bindings[pd]=this.ri.Fmc(kc[pd])}else Oc.Bindings=null;va(Oc)}},va)}R_d(H,va){this.rJ.ddaLoadSettings(H.DdaMethod.ControlId,ub=>{if(gc.a(ub))this.Dk.dR(ub,va);else{const kc=this.Dk.SQ();kc.Properties=ub.Result;va(kc)}},va)}saveSettings(H,va){const ub={Settings:[]};for(let kc=0;kc<H.DdaSettingsMethod.Properties.length;kc++){const Oc={};Oc.Name=H.DdaSettingsMethod.Properties[kc][0];Oc.Value=H.DdaSettingsMethod.Properties[kc][1];ub.Settings[kc]=Oc}this.rJ.ddaSaveSettings(H.DdaMethod.ControlId,
ub,H.DdaSettingsMethod.OverwriteIfStale,kc=>{gc.a(kc)?this.Dk.dR(kc,va):this.Dk.cE(va)},va)}D_e(H,va){const ub=bf.jrd(1,H.DdaAddRowsColumns.Data);bf.cEc(ub)?this.Dk.Rn(Na.a.H0c,va):this.rJ.ddaAddRowsColumns(H.DdaMethod.ControlId,H.DdaAddRowsColumns.BindingId,H.DdaAddRowsColumns.IsRow,ub,kc=>{gc.a(kc)?this.Dk.dR(kc,va):this.Dk.cE(va)},va)}g$h(H,va){this.rJ.ddaDeleteAllDataValues(H.DdaMethod.ControlId,H.DdaBindingsMethod.BindingId,ub=>{gc.a(ub)?this.Dk.dR(ub,va):this.Dk.cE(va)},va)}pTh(H,va){this.rJ.ddaClearBindingFormats(H.DdaMethod.ControlId,
H.DdaClearBindingFormats.BindingId,ub=>{gc.a(ub)?this.Dk.dR(ub,va):this.Dk.cE(va)},va)}IKg(H,va){const ub={},kc=H.DdaSetBindingFormats.IsSetFormats;kc?ub.CellFormat=H.DdaSetBindingFormats.CellFormat:ub.TableOptions=H.DdaSetBindingFormats.TableOptions;this.rJ.ddaSetBindingFormats(H.DdaMethod.ControlId,H.DdaSetBindingFormats.BindingId,ub,kc,Oc=>{gc.a(Oc)?this.Dk.dR(Oc,va):this.Dk.cE(va)},va)}executeRichApiRequest(H,va){var ub;const kc=H.ArrayData,Oc={},pd=ea.f(this.$).ha;if(kc){if("WacPartition"===
kc[0]){this.Sqi(H,va);return}const G=ba.vb.Ha()?this.ri:Object(Da.a)(wa.DdaFacade,ob.a(this.$));var Sd=H.DdaMethod.ControlId;za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&this.ri.lZ&&(Sd=this.ri.L$(H.DdaMethod.ControlId));"SetOsfControlContainerReadyForCustomFunctions"===kc[0]&&(Sd=G.Er(Sd))&&(Sd.wGc=!0,Sd.Jug());Oc.HttpMethod=kc[1];Oc.PathAndQuery=kc[2];Oc.RequestHeaders=bf.CEf(kc[3]);Oc.RequestBody=kc[4];Oc.AppPermission=kc[5];Sd=kc[6];Oc.RequestFlags=
Sd;var Wd=0;if(Gb.i(this.$.na))switch(pd.wk){case 1:Wd=2;break;case 2:Wd=3;break;case 64:Wd=16;break;case 128:Wd=4;break;default:Wd=1}var ee=null;pd.$e.YJ&&(ee=pd.$e.YJ.Hq);Oc.SheetMultiRange=qb.s(pd.qa.selectedRanges,this.$);Oc.ActiveCell=qb.w(pd.qa.activeCell,this.$);Oc.ActiveFloatingObjectId=ee;Oc.SelectionState=Wd;Wd=null;za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)?this.ri.lZ?(ee=this.ri.twa(H.DdaMethod.ControlId),Wd=this.ri.L$(H.DdaMethod.ControlId),
Wd=this.ri.wX(Wd),Oc.InstanceId=ee):(Wd=this.ri.wX(H.DdaMethod.ControlId),Oc.InstanceId=Wd?Wd.InstanceId:""):(Wd=this.ri.wX(H.DdaMethod.ControlId),Oc.InstanceId=Wd?Wd.InstanceId:"");if(Wd&&Wd.PrimaryMarketplace){let da;if(Wd.PrimaryMarketplace.MarketplaceType!==OSF.StoreType.InMemory)da=Wd.PrimaryMarketplace.SolutionId,ee=Wd.PrimaryMarketplace.MarketplaceType;else{if(!Wd.OwnerAddinSolutionId){sa.ULS.sendTraceTag(512325018,344,10,"executeRichApiRequest: No OwnerAddinSolutionId for AppCommand");this.Dk.Rn(Na.a.eTb,
va);return}if(!Wd.OwnerAddinStoreType){sa.ULS.sendTraceTag(512325017,344,10,"executeRichApiRequest: No OwnerAddinStoreType for AppCommand");this.Dk.Rn(Na.a.eTb,va);return}da=Wd.OwnerAddinSolutionId;ee=Wd.OwnerAddinStoreType}const $a=Telemetry.PrivacyRules.GetPrivacyCompliantId(da,ee,null===(ub=Wd.AssetMarketplace)||void 0===ub?void 0:ub.SolutionId,null,null,Wd.PrimaryMarketplace.MarketplaceRef);Oc.CompliantSolutionId=$a;Oc.SolutionId=da;Oc.MarketplaceType=ee;Oc.SolutionVersion=Wd.PrimaryMarketplace.SolutionVersion;
Oc.StoreLocation=Wd.PrimaryMarketplace.MarketplaceRef}else Oc.SolutionId=Oc.MarketplaceType="",Oc.CompliantSolutionId="";Oc.IsEventsEnabled=void 0===G||null===G||G.un.Wlc(Oc.InstanceId);Oc.RequestGuid=Qc.a.create().toString();ub=Oc.RequestBody.length;if(ub>this.$.ua.ExcelRichApiMaxAllowedRequestPayloadSize){this.Dk.Rn(Na.a.bok,va);sa.ULS.sendTraceTag(537163213,0,50,`Request payload size:${ub} exceeded the limit`);return}za.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&
Sd&4096&&(ub=new Hb(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(ub,Eb,kc),Oc.RequestBody=kc[4])}const je=bf.fIf(Oc.RequestHeaders);bf.D$d++;const Ue=vd.a.Tg.Wh;za.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&Oc&&Oc.RequestBody&&sa.ULS.sendTraceTag(537163212,0,50,`Richapi json request body size is ${Oc.RequestBody.length}`);this.rJ.executeRichApiRequest(Oc,G=>{var da;this.TJg(Ue,!0,G.ServerCorrelationId);let $a=null,Sb=null;var Mc=G.ServerCorrelationId;
if(null===(da=null===G||void 0===G?void 0:G.Errors)||void 0===da?0:da[0])$a=G.Errors[0].MessageIdName,Sb=G.Errors[0].Description,Fc.a(this.$).ij.CL(G.Errors[0].MessageId);if(gc.a(G)||!G.Result)this.Mob(Mc,je,"Server error",$a,Sb),this.Dk.dR(G,va);else{let Od=null;if(za.EwaSettings.Ra(233))if((da=G.Result)&&da.length){for(let hf=0;hf<da.length;hf++)if(da[hf].RequestGuid===Oc.RequestGuid){Od=da[hf];break}Od||this.Dk.dR(G,va)}else Od=G.Result;else Od=G.Result;if(!$a&&Od&&Od.ResponseBody&&Od.ResponseBody[0])if(G=
Od.ResponseBody[0],G.startsWith('{"Error":')){1<Od.ResponseBody.length&&(G=G.substring(0,G.indexOf("}")+1),G+="}");try{var sd=Jb.a.Gp(G);sd.Error&&this.Mob(Mc,je,"Pipeline error",sd.Error.Code,sd.Error.Message)}catch(hf){this.Mob(Mc,je,"Json deserialize error",null,"Error info cannot be deserialized.")}}else this.Mob(Mc,je);else this.Mob(Mc,je,"Server error",$a,Sb);const se=(Mc=Od.SheetMultiRange)?Mc.SheetName:null;sd=Od.ActiveFloatingObjectId;const Ye=Od.SelectionState;G=5===Ye&&!!Mc||6===Ye||7===
Ye||17===Ye||8===Ye;if(this.$.ih.GF&&G)this.Dk.Rn(Na.a.h3c,va),sa.ULS.sendTraceTag(537163211,0,50,`${Ye.toString()} is not allowed`);else if(5===Ye&&Mc){if(this.$.sa&&se)if(this.$.sa.yq(se))this.cld(se);else{let hf=null;hf=()=>{this.$.sa.yq(se)&&(sa.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),this.cld(se),this.$.sa.JSc(hf))};this.$.sa.wkc(hf);if(za.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){let ag=null;ag=()=>{this.$.sa.yq(se)&&
(this.cld(se),this.$.sa.Yza(ag))};this.$.sa.tta(ag)}}}else if(6===Ye||7===Ye||17===Ye||8===Ye||9===Ye){if(Mc){const hf=qb.h(Mc.Ranges);if(se&&qb.lb(hf,!0))if(za.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&!this.$.sa.yq(se)){let ag=null;ag=()=>{this.w3g(pd,hf,se,Ye);this.$.sa.Yza(ag)};this.$.sa.tta(ag)}else this.w3g(pd,hf,se,Ye)}if(7===Ye||17===Ye||8===Ye)sd="{"+rc.e(sd)+"}",eg.a(this.$).kvk(sd);9===Ye&&(this.$.ua.ApiCallToSetPageLayout=!0)}Od.PostProcessActions?
(Mc=Jb.a.Gp(Od.PostProcessActions),this.g5j(Mc).then(()=>{this.Aub(Od,va);this.TEd(H.DdaMethod.ControlId,Oc);return Promise.resolve(null)},hf=>{this.Aub(Od,va,hf);return Promise.reject(hf)})):this.Aub(Od,va)}},G=>{this.TJg(Ue,!1,null);this.Mob(null,je,"Web service error");va(G)})}TEd(H,va){const ub=ba.vb.Ha()?this.ri:Object(Da.a)(wa.DdaFacade,ob.a(this.$));(null===ub||void 0===ub?0:ub.tje)&&ub.Er(H)&&bf.HHk(va.RequestHeaders)&&(sa.ULS.sendTraceTag(537163209,0,50,`ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: ${H}; SolutionId: ${va.SolutionId}.`),
ub.tje.mii(H))}Sqi(H,va){var ub=H.DdaMethod.ControlId;za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload",!1)&&this.ri.lZ&&(ub=this.ri.L$(H.DdaMethod.ControlId));const kc=this.ri.wX(ub),Oc=wa.DdaFacade.getSolutionId(kc,this.$);var pd=null;pd=wa.DdaFacade.tIa(kc,this.$);pd=new Uc(pd,this.$);za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload",!1)&&this.ri.lZ&&(ub=this.ri.twa(H.DdaMethod.ControlId));pd=new wc(Oc,ub,this.ri,this.$,pd);const Sd=
{ResponseHeaders:[]};Sd.ResponseBody=Array(1);ub=bf.CEf(H.ArrayData[3]);const Wd=bf.fIf(ub);ub=new Ib(this.$.ua.CreateWorkbookMaxAllowedBase64Size,this.nbg);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(pd,Kb,ub,H.ArrayData).then(ee=>{if(!ee)return this.J0d(!1,"The rich api executor call failed",Wd),sa.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),Sd.ResponseStatusCode=500,this.Aub(Sd,va),null;this.J0d(!0,"The rich api executor call succeeded",Wd);Sd.ResponseStatusCode=
ee[0];Sd.ResponseBody[0]=ee[2];this.Aub(Sd,va);return null},ee=>{Sd.ResponseStatusCode=400;Sd.ResponseBody[0]=ee.toString();this.J0d(!1,"The rich api executor call failed",Wd);sa.ULS.sendTraceTag(537163207,0,10,`A Excel Rich API batch execution was failed, AppId:${Oc}`);this.Aub(Sd,va);return null})}TJg(H,va,ub){bf.D$d--;H=Zd.a(vd.a.Tg,H);sa.ULS.sendTraceTag(36763356,0,50,`Rich Api perf log -- total milliseconds used:${H}, requests pending:${bf.D$d}, request result:${va?"success":"false"}, server correlationid: ${ub}.`)}Aub(H,
va,ub){ub=void 0===ub?null:ub;const kc=Array(3);kc[0]=H.ResponseStatusCode;kc[1]=bf.uVi(H.ResponseHeaders);const Oc=[];var pd=!1;if(ub&&H.ResponseBody){const Sd=Jb.a.Gp(H.ResponseBody.join(""));Sd.Error||(pd={},pd.Error=ub,pd.TraceIds=Sd.TraceIds,pd.ProcessedResults={},pd.ProcessedResults.Results=Sd.Results,Oc[0]=Jb.a.li(pd),pd=!0)}kc[2]=pd?Oc:H.ResponseBody;H=this.Dk.SQ();H.Data=kc;va(H)}d4d(H,va){(new Mb(this.$,this.Dk,this.rJ)).d4d(H,va)}SDj(H,va){sa.ULS.sendTraceTag(537163206,0,50,"MessageParent API called!");
const ub=H[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],kc=H[ha.a.Knd],Oc=H[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];H=this.$.ka.Ug(232).Wgb.TDj(H.DdaMethod.ControlId,ub,kc,Oc);H===Na.a.success?this.Dk.cE(va):(sa.ULS.sendTraceTag(537163205,0,10,"MessageParent API Failed!"),this.Dk.Rn(H,va))}PDj(H,va){sa.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");const ub=H[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],kc=H[ha.a.Knd],Oc=H[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin],
pd=this.$.ka.Ug(232);let Sd=H.DdaMethod.ControlId;za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&(Sd=this.ri.L$(H.DdaMethod.ControlId));pd.Wgb.uwk(Sd,ub,kc,Oc);this.Dk.cE(va)}getAccessToken(H,va){sa.ULS.sendTraceTag(537163203,0,50,"GetAccessToken API called!");let ub=H.DdaMethod.ControlId;za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&(ub=this.ri.L$(H.DdaMethod.ControlId));const kc=(Oc,pd)=>{var Sd;if(Oc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)Oc=
this.Dk.SQ(),Oc[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=pd.accessToken,va(Oc);else{pd=this.ri.wX(ub);const Wd=null!==pd.OwnerAddinStoreType?pd.OwnerAddinStoreType:pd.PrimaryMarketplace.MarketplaceType;sa.ULS.sendTraceTag(537163202,0,10,`${({["errorCode"]:Oc.toString(),["appId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(wa.DdaFacade.getSolutionId(pd,this.$),Wd,null===(Sd=pd.AssetMarketplace)||void 0===Sd?void 0:Sd.SolutionId,null,null,pd.PrimaryMarketplace.MarketplaceRef),
["storeType"]:Wd})}.`);this.Dk.Rn(Oc,va)}};ba.id.Ha()?void Ta.a.resolve(ba.id,{va:1}).then(Oc=>{const pd=this.ri.wl,Sd=Yb.getInstance();Za.a.getInstance(pd,Oc,Sd).getAccessToken(ub,!0,H,kc)}):Fa.TaskExtensions.Ua(gb.GetServiceTaskFactory.create(this.$.ka,137,this.$.xa,1),Oc=>{const pd=this.ri.wl,Sd=Yb.getInstance();Za.a.getInstance(pd,Oc.result,Sd).getAccessToken(ub,!0,H,kc)},this.$.xa)}getAuthContext(H,va){const ub=()=>{var kc=this.ri.wl,Oc=H.DdaMethod.ControlId;za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",
!1)&&(Oc=this.ri.L$(H.DdaMethod.ControlId));kc=kc.getOsfControl(Oc);if(kc.isFirstParty()){kc=kc.getManifest();Oc=kc.getMarketplaceID();var pd=kc.getWebApplicationId(),Sd=kc.getWebApplicationMsaId();Wc.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(Oc).then(Wd=>{const ee=this.Dk.SQ(),je={};je[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=pd;je[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=Sd||pd;je[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=
Wd.upn;je[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Wd.userId;je[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Wd.authority;je[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Wb.a.YCi(Wd.authorityType);je[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Wd.isAnonymous;je[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Wd.tenantId;je[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Wd.supportsAuthToken;
ee[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=je;va(ee)},Wd=>{const ee=this.Dk.SQ(),je={},Ue=new Wb.a;je[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=pd;je[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=Sd||pd;je[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Ue.upn;je[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Ue.userId;je[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Ue.authority;je[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=
Ue.authorityType;je[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Ue.isAnonymous;je[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Ue.tenantId;je[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=Wd;je[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Ue.supportsAuthToken;ee[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=je;ee.Error=1;va(ee)})}};ba.id.Ha()?void Ta.a.resolve(ba.id,{va:1}).then(()=>{ub()}):Fa.TaskExtensions.Ua(gb.GetServiceTaskFactory.create(this.$.ka,
137,this.$.xa,1),()=>{ub()},this.$.xa)}CKd(H,va){let ub=H.DdaMethod.ControlId;za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload2",!1)&&(ub=this.ri.L$(H.DdaMethod.ControlId));H=db.CKd(this.ri.wl,ub);H.errorCode===Na.a.success?(H=Object.assign({},this.Dk.SQ(),H.context),va(H)):this.Dk.Rn(H.errorCode,va)}executeFeature(H,va){32===P.AFrameworkApplication.jh.Gk(H[0],2)?va(this.Dk.SQ()):this.Dk.Rn(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,va)}queryFeature(H,va){H=
[32===P.AFrameworkApplication.jh.Gk(H[0],1),!0];H=Object.assign({},this.Dk.SQ(),H);va(H)}Kgj(H){const va=ea.f(this.$).ha;return 16===va.wk&&!!va.$e.yh&&!!va.$e.yh.floatingObject&&Md.a.equals(va.$e.yh.floatingObject.id,H,!0)}wId(H){const va=ea.f(this.$).ha;return va.qa.Gn?1===va.wk||this.Kgj(H)?va.Vua:null:null}QHc(H,va){return 1!==H&&2!==H&&3!==H?(this.Dk.Rn(Na.a.ddf,va),!1):!0}J0d(H,va,ub){const kc={};kc.a=this.$.ua.UserSessionId;kc.b=H;kc.c=va;kc.d=null;kc.e=ub;eb.b().tl(37,kc)}Mob(H,va,ub,kc,Oc){ub=
void 0===ub?null:ub;kc=void 0===kc?null:kc;Oc=void 0===Oc?null:Oc;const pd={};H&&(pd.ServerCorrelationId=H);void 0!==va&&null!==va&&(pd.Source=va);ub&&(pd.ErrorType=ub);kc&&(pd.MessageId=kc);Oc&&(pd.StatusDescription=Oc);za.EwaSettings.isChangeGateEnabled("OfficeVSO:6144055_EUIIDataInDbxheTag")&&kc&&"ExternalDataRefreshFailed"===kc&&(pd.StatusDescription="");sa.ULS.sendTraceTag(50688452,0,50,Jb.a.li(pd))}g5j(H){let va=new Promise(ub=>{ub(null)});for(let ub=0;ub<H.length;ub++)va=this.f5j(va,H[ub]);
return va}f5j(H,va){const ub=this;return No(function*(){if(!va)return sa.ULS.sendTraceTag(537163201,0,10,"Null PostProcessAction."),H.then(()=>Promise.reject(bf.ejb(Fd.generalException,Lc.a.instance.ia(1765),null)));switch(va.actionType){case 1:case 2:H=H.then(()=>{const pd=ba.vb.Ha()?ub.ri:Object(Da.a)(wa.DdaFacade,ob.a(ub.$));if(pd.Er(va.controlId))switch(pd.un.RNd(va),va.messageType){case 14:case 100:pd.sje.qmc(va);break;case 11:case 12:pd.mrk.xHb(va);break;case 51:case 52:pd.krk.xHb(va);break;
case 2101:case 2102:pd.lrk.xHb(va);break;case 2E3:pd.nrk.qmc(va);break;case 2201:ub.$.Oxa&&pd.tje.CGh(va);break;case 2203:pd.ork.DGh(va);break;case 2700:za.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&pd.rje.qmc(va);break;case 65541:pd.qje.BGh(va)}else sa.ULS.sendTraceTag(537163171,0,10,`OsfControl with instanceId[${va.controlId}] doesn't exist.`);return Promise.resolve(null)});break;case 3:H=H.then(()=>{ub.W_i(va);return Promise.resolve(null)});break;case 15:za.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&
(H=H.then(()=>{ub.e2i(va);return Promise.resolve(null)}));break;case 4:H=H.then(()=>{var pd=ea.f(ub.$).ha.qa.activeCell;pd.top!==va.row+1&&pd.left!==va.column+1&&(pd=qb.w(na.Range.gi(va.row+1,va.column+1),ub.$),ea.f(ub.$).To(pd,null,null,null,3,"DdaMethodHandler.ShowCard"));ya.a(ub.$,243,242,0,Sd=>{Sd.G6b(va.row+1,va.column+1,1,!1,!1)});return Promise.resolve(null)});break;case 7:H=H.then(()=>{(ba.vb.Ha()?ub.ri:Object(Da.a)(wa.DdaFacade,ob.a(ub.$))).un.vpf(va.controlId,va.isEnableEvents);return Promise.resolve(null)});
break;case 5:H=H.then(()=>ub.k7h(va));break;case 6:H=H.then(()=>ub.g_j(va));break;case 8:H=H.then(()=>{za.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&(ba.vb.Ha()?ub.ri:Object(Da.a)(wa.DdaFacade,ob.a(ub.$))).oTh();const pd=new xc.a(Ub.a.jq,5,null);Ab.a(ub.$).Dy(pd);return Promise.resolve(null)});break;case 9:H=H.then(()=>ub.wyk(va));break;case 10:H=H.then(()=>ub.obl(va));break;case 11:H=H.then(()=>ub.nbl());break;case 12:H=H.then(()=>ub.kbl());
break;case 13:H=H.then(()=>ub.lbl(va));break;case 14:H=H.then(()=>ub.mbl(va));break;case 16:H=H.then(()=>Promise.resolve(va));break;case 17:H=H.then(()=>ub.wuk(va,Object(Da.a)(wa.DdaFacade,ob.a(ub.$))));break;case 18:ea.f(ub.$).focus();break;case 19:ub.FLf(va.entryType,!1,va.options);break;case 20:ub.FLf(va.entryType,!0,va.options);break;case 21:const kc=ba.vb.Ha()?ub.ri:ob.a(ub.$);H=H.then(()=>kc.qje.y_i(va));break;case 22:const Oc=ba.vb.Ha()?ub.ri:ob.a(ub.$);H=H.then(()=>Oc.qje.z_i(va));break;case 23:(Ba.a.eUb(ub.$)||
Ba.a.FU())&&ub.ri.gGg.T2i(va.worksheetId,va.anchorCell,va.values,va.options);break;case 24:(Ba.a.eUb(ub.$)||Ba.a.FU())&&ub.ri.gGg.N0i(va.worksheetId);break;default:H=H.then(()=>Promise.reject(bf.ejb(Fd.IDh,Lc.a.instance.ia(1766),null)))}return H})}e2i(H){var va=(ba.vb.Ha()?this.ri:Object(Da.a)(wa.DdaFacade,ob.a(this.$))).Er(H.controlId);if(va&&!(0===H.operationType^!va.Opa)){ea.f(this.$).zSb=!0;switch(H.operationType){case 0:var ub=new xf.a(document.createElement("input"));ub.text=H.range;va.Uaj(ea.f(this.$).Um.E5h(ub,
new dd.a(this.$)));va.Opa.startEdit(!0);break;case 1:va.bBg();this.rangePicker=null;break;case 2:va.Opa.N3g(H.range);break;case 3:va.Opa.N3g(H.startingRange);va=H.expandSelection;ub=H.getNextDataRegionCell;let kc=0;switch(H.keyboardDirectionValue){case 2:kc=38;H=va&&ub?105288353:va?-31900117:ub?542791952:137938150;break;case 3:kc=40;H=va&&ub?-1297307319:va?-1603798598:ub?1713663844:-798660877;break;case 0:kc=37;H=va&&ub?-403586027:va?2039316657:ub?-2012742350:-1470715894;break;case 1:kc=39;H=va&&
ub?784916030:va?589730764:ub?1324884057:-1231471547;break;default:H=1461300262}va=this.Sqc("keydown",kc,va,ub);ea.f(this.$).i4b(va,new Re.a(H,1,0,8,null))}ea.f(this.$).zSb=!1}}Sqc(H,va,ub,kc){const Oc=document.createEvent("KeyboardEvent");if(Ka.a.KI)Oc.initKeyboardEvent(H,!1,!1,window.self,"A",0,kc,!1,ub,!1);else{let pd="";ub&&(pd+="Shift");kc&&(pd+=0<pd.length?" Control":"Control");Oc.initKeyboardEvent(H,!1,!1,window.self,"A",0,pd,!1,"en-US")}H=new Sys.UI.DomEvent(Oc);H.keyCode=va;return H}W_i(H){switch(H.operationType){case 1:void Ta.a.resolve(ba.Rc,
{va:0}).then(va=>{va.kie()});break;case 2:if(H=(ba.vb.Ha()?this.ri:Object(Da.a)(wa.DdaFacade,ob.a(this.$))).Er(H.controlId))H.wGc=!0,H.Jug()}}k7h(H){const va=H.fileBase64;return va&&va.length>this.$.ua.CreateWorkbookMaxAllowedBase64Size?Promise.reject(bf.ejb(Fd.invalidArgument,Lc.a.instance.ia(1769),"Application.CreateWorkbook")):(new Promise((ub,kc)=>{const Oc=new Jc.a;Oc.Bh=4;Oc.Io(P.AFrameworkApplication.fa.la("IsNewStringEnabled")?CommonUiStrings.GeneralAddInMessageDialogTitle:CommonUIStrings.l_GeneralAddInMessageDialogTitle,
P.AFrameworkApplication.fa.la("IsNewStringEnabled")?CommonUiStrings.NewFileAPIConsentMessage:CommonUIStrings.l_NewFileAPIConsentMessage,1,pd=>{2!==pd&&0!==pd||kc(bf.ejb(Fd.D9d,Lc.a.instance.ia(1768),"Application.CreateWorkbook"));pd=new ma("blank","agave",va?"streamBase64":"streamEmpty",va);this.nbg.create(ub,kc,pd).jgb()})})).then(ub=>{this.Jvc.set(H.fakeFileId,ub);return Promise.resolve(null)},ub=>ub?Promise.reject(ub):Promise.reject(bf.ejb(Fd.generalException,Lc.a.instance.ia(1765),"Application.CreateWorkbook")))}g_j(H){return new Promise((va,
ub)=>{if(this.Jvc.has(H.fakeFileId)){const kc=this.Jvc.get(H.fakeFileId);ub=new Jc.a;ub.Bh=4;P.AFrameworkApplication.fa.la("IsNewStringEnabled")?ub.Io(CommonUiStrings.GeneralAddInMessageDialogTitle,CommonUiStrings.OpenWindowConsentMessage,1,Oc=>{1===Oc&&wd.HelperMethods.dm(kc,void 0,void 0,"DdaMethodHandler.fileUrl");va(null)}):ub.Io(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,Oc=>{1===Oc&&wd.HelperMethods.dm(kc,void 0,void 0,"DdaMethodHandler.fileUrl");
va(null)})}else ub(bf.ejb(Fd.generalException,Lc.a.instance.ia(1765),"Document.Open"))})}wyk(H){return new Promise(va=>{(ba.vb.Ha()?this.ri:Object(Da.a)(wa.DdaFacade,ob.a(this.$))).hGg=H.runtimeCalculationMode;const ub=Ta.a.Zg(ba.wd);ub&&ub.d5d(3===H.runtimeCalculationMode);va(null)})}obl(H){Ba.a.kWb(this.$)&&(ba.Tb.Ha()?this.externalLinksManager:this.$.ka.Ug(331)).Bub(0,H.urlStr,!0,!0,null);return Promise.resolve(null)}nbl(){Ba.a.kWb(this.$)&&(ba.Tb.Ha()?this.externalLinksManager:this.$.ka.Ug(331)).Bub(1,
null,!0,!0,null);return Promise.resolve(null)}kbl(){Ba.a.kWb(this.$)&&(ba.Tb.Ha()?this.externalLinksManager:this.$.ka.Ug(331)).guc();return Promise.resolve(null)}lbl(H){Ba.a.kWb(this.$)&&(ba.Tb.Ha()?this.externalLinksManager:this.$.ka.Ug(331)).Bub(5,H.urlStr,!0,!0,null);return Promise.resolve(null)}mbl(H){if(Ba.a.kWb(this.$)){const va=ba.Tb.Ha()?this.externalLinksManager:this.$.ka.Ug(331);for(const ub of va.mma)ub.IsActive&&ub.HostEditUrl&&ub.UrlStr===H.hostEditUrlStr&&wd.HelperMethods.dm(ub.HostEditUrl,
"_blank")}return Promise.resolve(null)}wuk(H,va){const ub=nb.a.zV;H=Jb.a.Gp(H.payload);const kc={};"eventId"in H&&"payload"in H&&(kc.eventId=H.eventId,kc.payload=H.payload);va.iM(2201,ub,Jb.a.li(kc));return Promise.resolve(null)}FLf(H,va,ub){const kc=Ta.a.Zg(ba.C);kc&&(H=this.RDi(H))&&(va?kc.removeEntry(H):kc.Vjc(H,ub))}RDi(H){switch(H){case 0:return 64;case 1:if(za.EwaSettings.isChangeGateEnabled("OfficeVSO:7109926_MsFormsBusinessBarApi"))return 69}}cld(H){H=Object(Da.a)(af.a,this.$.sa.getItemByName(H));
(null===H||void 0===H?0:H.visible)&&H.activate({disableAutoFocusOnGrid:!0,scenario:"dda"})}w3g(H,va,ub,kc){var Oc=H.qa.qy;const pd=Oc<va.length&&va[Oc].contains(H.qa.activeCell);H=pd?H.qa.activeCell:va[0].topLeft;Oc=pd?Oc:0;ea.f(this.$).p0(va,Oc,ub,null,H,null,null,3,"DdaMethodHandler.UpdateSelection",void 0,void 0,void 0,6===kc)}static get B8h(){bf.UCa||(bf.UCa={},bf.UCa[Microsoft.Office.WebExtension.CoercionType.Table]=1,bf.UCa[Microsoft.Office.WebExtension.CoercionType.Text]=2,bf.UCa[Microsoft.Office.WebExtension.CoercionType.Matrix]=
3,bf.UCa[Microsoft.Office.WebExtension.CoercionType.Html]=4,bf.UCa[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5);return bf.UCa}static get E8h(){bf.Zzb||(bf.Zzb={},bf.Zzb[Microsoft.Office.WebExtension.FilterType.All]=1,bf.Zzb[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2);return bf.Zzb}static get F8h(){bf.$zb||(bf.$zb={},bf.$zb[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=2,bf.$zb[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1);return bf.$zb}static CEf(H){if(!H||
!H.length)return null;const va=Array(H.length/2);for(let ub=0;ub<H.length/2;ub++)va[ub]={},va[ub].Name=H[2*ub],va[ub].Value=H[2*ub+1];return va}static uVi(H){if(!H||!H.length)return null;const va=Array(2*H.length);for(let ub=0;ub<H.length;ub++)va[2*ub]=H[ub].Name,va[2*ub+1]=H[ub].Value;return va}static lFd(H){if(!H||!H.length)return null;const va=Array(H.length);for(let ub=0,kc=H.length;ub<kc;ub++){const Oc=H[ub].length;if(Oc){va[ub]=Array(Oc);for(let pd=0;pd<Oc;pd++)va[ub][pd]=null==H[ub][pd]?null:
H[ub][pd].toString()}else return null}return va}static kpc(H){return"string"===typeof H?ff.a.tw(bf.B8h,H,0):H}static Dwf(H){return"string"===typeof H?ff.a.tw(bf.E8h,H,0):H}static o5g(H){return"string"===typeof H?ff.a.tw(bf.F8h,H,0):H}static Zgj(H){switch(H.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1}static jrd(H,va){const ub={};ub.CoerceType=H;1===ub.CoerceType?(ub.Data=bf.lFd(va.Rows),ub.Headers=bf.lFd(va.Headers)):ub.Data=bf.lFd(va);return ub}static l8e(H){return 1===
H.CoerceType?{["Headers"]:H.Headers,["Rows"]:H.Data}:H.Data}static cEc(H){return 1===H.CoerceType?!H.Data&&!H.Headers:!H.Data}static fIf(H){let va="Unknown";if(!H)return va;for(let ub=0;ub<H.length;ub++)if(H[ub].Name.toLowerCase()===Hc.a.prk){va=H[ub].Value;break}return va}static HHk(H){if(!H)return!1;const va=Hc.a.iJj.toLowerCase();for(let ub=0;ub<H.length;ub++)if(H[ub].Name.toLowerCase()===va)return!0;return!1}static ejb(H,va,ub){const kc={};kc.Code=H;kc.Message=va;kc.Location=ub;kc.ActionIndex=
0;return kc}}bf.UCa=null;bf.Zzb=null;bf.$zb=null;bf.D$d=0;Object(I.a)(bf,"DdaMethodHandler",null,[39,2]);var pf=a(208);class Ud{constructor(){this.Z8c=this.$8c=this.Fed=this.Rjd=null}get operations(){this.Fed||(this.Fed=new pf.a,this.Uh());return this.Fed}get u2c(){this.Rjd||(this.Rjd=new pf.a,this.nm());return this.Rjd}get Xvf(){this.Z8c||(this.Z8c=new pf.a);return this.Z8c}get featureGates(){this.$8c||(this.$8c=new pf.a,this.initializeFeatureGates());return this.$8c}nm(){}initializeFeatureGates(){}qj(H){this.u2c.add(H)}Ih(H){this.operations.contains(H)||
this.operations.add(H)}OZe(H){this.Xvf.add(H)}}Object(I.a)(Ud,"MacroRecorderEventBase",null,[]);class Ff extends Ud{constructor(){super()}get eventId(){return 130}Uh(){this.Ih(100)}}Object(I.a)(Ff,"AccessibilityCheckRunEvent",Ud,[]);class Uf extends Ud{constructor(){super()}get eventId(){return 160}Uh(){this.Ih(241)}nm(){this.qj(H=>H.addToPrintArea)}}Object(I.a)(Uf,"AddedToPrintAreaEvent",Ud,[]);class Gf extends Ud{constructor(){super()}get eventId(){return 65}Uh(){this.Ih(516)}}Object(I.a)(Gf,"AutoFilterToggledEvent",
Ud,[]);class lg extends Ud{constructor(){super()}get eventId(){return 118}Uh(){this.Ih(502)}nm(){this.qj(H=>!(H.fkb().FirstColumn===H.fkb().LastColumn&&H.fkb().FirstRow===H.fkb().LastRow))}}Object(I.a)(lg,"AutoSumEvent",Ud,[]);class Pa extends Ud{constructor(){super()}get eventId(){return 223}Uh(){this.Ih(1032)}}Object(I.a)(Pa,"CellImageAltTextAppliedEvent",Ud,[]);class lc extends Ud{constructor(H,va){super();this.Lra=H;this.r9k=va}get eventId(){return this.Lra}Uh(){this.Ih(529);this.Ih(594)}nm(){this.qj(H=>
this.r9k.includes(H.SKd()))}}Object(I.a)(lc,"ChartPropertyAppliedEventBase",Ud,[]);class Gc extends lc{constructor(){super(84,[348,349,350,351,352,353,354,355,356,357,372,373,374,375])}}Object(I.a)(Gc,"ChartAxisChangedEvent",lc,[]);class Cd extends lc{constructor(){super(80,[-104,-103,300,301,302,303,304,305,306,307,308,309,310,311])}}Object(I.a)(Cd,"ChartAxisTitleChangedEvent",lc,[]);class Qd extends lc{constructor(){super(82,[200,201,202,203,204,205,206,207,208,209,210])}}Object(I.a)(Qd,"ChartDataLabelsChangedEvent",
lc,[]);class ge extends lc{constructor(){super(76,[-100])}}Object(I.a)(ge,"ChartDataSelectedEvent",lc,[]);class ye extends lc{constructor(){super(83,[500,501,502])}}Object(I.a)(ye,"ChartDataTableChangedEvent",lc,[]);class $e extends Ud{constructor(){super()}}Object(I.a)($e,"RichApiRequestExecutedEventBase",Ud,[]);class qf extends $e{constructor(){super()}get eventId(){return 117}wK(H){qf.Sha||(qf.Sha=new nd.a($d.a.lm()),qf.Sha.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),qf.Sha.add("fa000000014"));
return!!H&&qf.Sha.contains(H.toLowerCase())}Uh(){this.Ih(507);this.Ih(10);this.Ih(576)}nm(){this.qj(H=>Object(ra.a)(oc,H)&&(H=Object(Da.a)(oc,H),H.isValid&&this.wK(H.source))?(sa.ULS.sendTraceTag(537155427,0,50,`[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: ${H.eventId}`),!0):!1)}}qf.Sha=null;Object(I.a)(qf,"ChartFormatRichApiRequestExecutedEvent",$e,[]);class h extends lc{constructor(){super(85,[328,329,330,331,332,333,334,335])}}Object(I.a)(h,"ChartGridlinesChangedEvent",
lc,[]);class Z extends Ud{constructor(){super()}get eventId(){return 66}Uh(){this.Ih(528)}}Object(I.a)(Z,"ChartInsertedEvent",Ud,[]);class E extends lc{constructor(){super(81,[100,101,102,103,104,105,106])}}Object(I.a)(E,"ChartLegendChangedEvent",lc,[]);class aa extends lc{constructor(){super(75,[-101])}}Object(I.a)(aa,"ChartRowColumnSwitchedEvent",lc,[]);class Ja extends lc{constructor(){super(79,[0,1,2,-102])}}Object(I.a)(Ja,"ChartTitleChangedEvent",lc,[]);class tb extends lc{constructor(){super(78,
[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,-125,-124,-126,-216,-217,-218,-219,-221,-222,-220,-129,-130,-131])}}Object(I.a)(tb,"ChartTypeChangedEvent",lc,[]);class S extends Ud{constructor(){super()}get eventId(){return 131}Uh(){this.Ih(521)}}Object(I.a)(S,"ConnectorFloatingObjectResizedEvent",Ud,[]);class Wa extends Ud{constructor(){super()}get eventId(){return 129}Uh(){this.Ih(109)}}Object(I.a)(Wa,"EntitySelectedEvent",Ud,[]);class zb extends Ud{constructor(){super()}get eventId(){return 49}Uh(){this.Ih(149);
this.Ih(147)}}Object(I.a)(zb,"FindCellEvent",Ud,[]);class hc extends Ud{constructor(){super()}get eventId(){return 96}Uh(){this.Ih(122)}}Object(I.a)(hc,"FloatingObjectAltTextAppliedEvent",Ud,[]);class cd extends Ud{constructor(){super()}get eventId(){return 93}Uh(){this.Ih(522)}}Object(I.a)(cd,"FloatingObjectDeletedEvent",Ud,[]);class ta extends Ud{constructor(){super()}get eventId(){return 94}Uh(){this.Ih(524)}}Object(I.a)(ta,"FloatingObjectMovedAndResizedEvent",Ud,[]);class wb extends Ud{constructor(){super()}get eventId(){return 95}Uh(){this.Ih(523)}}
Object(I.a)(wb,"FloatingObjectRotatedEvent",Ud,[]);class ic extends Ud{constructor(){super()}get eventId(){return 100}Uh(){this.Ih(543)}}Object(I.a)(ic,"GroupDetailsShownOrHiddenEvent",Ud,[]);class Oa extends Ud{constructor(){super()}get eventId(){return 154}Uh(){this.Ih(125)}}Object(I.a)(Oa,"HyperlinksRemovedFromRangeEvent",Ud,[]);class Cb extends $e{constructor(){super()}get eventId(){return 125}wK(H){Cb.Sha||(Cb.Sha=new nd.a($d.a.lm()),Cb.Sha.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),Cb.Sha.add("fa000000005"));
return!!H&&Cb.Sha.contains(H.toLowerCase())}Uh(){this.Ih(507);this.Ih(10);this.Ih(576)}nm(){this.qj(H=>Object(ra.a)(oc,H)?(H=Object(Da.a)(oc,H),H.isValid&&this.wK(H.source)):!1)}}Cb.Sha=null;Object(I.a)(Cb,"IdeasRichApiRequestExecutedEvent",$e,[]);class yc extends Ud{constructor(){super()}get eventId(){return 136}Uh(){this.Ih(115)}}Object(I.a)(yc,"LinkedEntityConvertedEvent",Ud,[]);class Nc extends Ud{constructor(){super()}get eventId(){return 148}Uh(){this.Ih(114)}}Object(I.a)(Nc,"LinkedEntityDisambiguationPaneToggledEvent",
Ud,[]);class Id extends Ud{constructor(){super()}get eventId(){return 127}Uh(){this.Ih(119)}}Object(I.a)(Id,"MovedToEdgeEvent",Ud,[]);class ke extends Ud{constructor(){super()}get eventId(){return 135}Uh(){this.Ih(191)}}Object(I.a)(ke,"NamedSheetViewCreatedEvent",Ud,[]);class Ie extends Ud{constructor(){super()}get eventId(){return 166}Uh(){this.Ih(200)}}Object(I.a)(Ie,"NamedSheetViewDeletedEvent",Ud,[]);class Le extends Ud{constructor(){super()}get eventId(){return 133}Uh(){this.Ih(192)}}Object(I.a)(Le,
"NamedSheetViewExitedEvent",Ud,[]);class wf extends Ud{constructor(){super()}get eventId(){return 162}Uh(){this.Ih(199)}}Object(I.a)(wf,"NamedSheetViewRenamedEvent",Ud,[]);class Kf extends Ud{constructor(){super()}get eventId(){return 167}Uh(){this.Ih(195)}}Object(I.a)(Kf,"NamedSheetViewSwitchedEvent",Ud,[]);class cg extends Ud{constructor(){super()}get eventId(){return 99}Uh(){this.Ih(174)}}Object(I.a)(cg,"OutlineLevelSetEvent",Ud,[]);class Bg extends Ud{constructor(){super()}get eventId(){return 156}Uh(){this.Ih(244)}}
Object(I.a)(Bg,"PageBreakInsertedEvent",Ud,[]);class dh extends Ud{constructor(){super()}get eventId(){return 157}Uh(){this.Ih(245)}}Object(I.a)(dh,"PageBreakRemovedEvent",Ud,[]);class Sf extends Ud{constructor(){super()}get eventId(){return 158}Uh(){this.Ih(246)}}Object(I.a)(Sf,"PageBreaksAllResetEvent",Ud,[]);class eh extends Ud{constructor(){super()}get eventId(){return 112}Uh(){this.Ih(503)}nm(){this.qj(H=>!!H.pasteParameters.ClientEstimationFloatingObjectId&&2===H.pasteParameters.CopyPasteTargetType&&
!H.isFromCurrentSession)}}Object(I.a)(eh,"PasteArtOtherWorkbookEvent",Ud,[]);class Rg extends Ud{constructor(){super()}get eventId(){return 52}Uh(){this.Ih(503)}nm(){this.qj(H=>!!H.pasteParameters.ClientEstimationFloatingObjectId&&2===H.pasteParameters.CopyPasteTargetType&&H.isFromCurrentSession)}}Object(I.a)(Rg,"PasteArtSameWorkbookEvent",Ud,[]);class Dg extends Ud{constructor(){super()}get eventId(){return 110}Uh(){this.Ih(204)}}Object(I.a)(Dg,"PasteHtmlEvent",Ud,[]);class Kg extends Ud{constructor(){super()}get eventId(){return 35}Uh(){this.Ih(506)}}
Object(I.a)(Kg,"PasteRangeEvent",Ud,[]);class Hg extends Ud{constructor(){super()}get eventId(){return 111}Uh(){this.Ih(503)}nm(){this.qj(H=>1===H.pasteParameters.CopyPasteTargetType)}}Object(I.a)(Hg,"PasteShadowWorkbookRangeEvent",Ud,[]);class fh extends Ud{constructor(){super()}get eventId(){return 42}Uh(){this.Ih(180)}}Object(I.a)(fh,"PasteStringEvent",Ud,[]);class Vh extends Ud{constructor(){super()}get eventId(){return 134}Uh(){this.Ih(220)}}Object(I.a)(Vh,"PendingMergeEvent",Ud,[]);class Yf extends Ud{constructor(){super()}get eventId(){return 122}Uh(){this.Ih(510)}}
Object(I.a)(Yf,"PictureInsertedEvent",Ud,[]);class Eg extends Ud{constructor(){super()}get eventId(){return 153}Uh(){this.Ih(161)}}Object(I.a)(Eg,"PivotDrillToggledEvent",Ud,[]);class hg extends Ud{constructor(H,va){super();this.Lra=H;this.opType=va}get eventId(){return this.Lra}Uh(){this.Ih(225)}nm(){this.qj(H=>H.opType===this.opType)}}Object(I.a)(hg,"PivotTableSettingsChangedEventBase",Ud,[]);class qg extends hg{constructor(){super(171,4)}}Object(I.a)(qg,"PivotTableAllItemLabelsRepeatedEvent",hg,
[]);class jh extends hg{constructor(){super(184,17)}}Object(I.a)(jh,"PivotTableAltTextDescriptionChangedEvent",hg,[]);class dg extends hg{constructor(){super(183,16)}}Object(I.a)(dg,"PivotTableAltTextTitleChangedEvent",hg,[]);class Wh extends hg{constructor(){super(173,6)}}Object(I.a)(Wh,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",hg,[]);class Ch extends hg{constructor(){super(172,5)}}Object(I.a)(Ch,"PivotTableBlankLineAfterEachItemToggledEvent",hg,[]);class Fg extends hg{constructor(){super(170,
3)}}Object(I.a)(Fg,"PivotTableColumnGrandTotalShownEvent",hg,[]);class Qa extends Ud{constructor(){super()}get eventId(){return 98}Uh(){this.Ih(132)}}Object(I.a)(Qa,"PivotTableCreatedEvent",Ud,[]);class Ma extends hg{constructor(){super(177,10)}}Object(I.a)(Ma,"PivotTableDisplayErrorStringToggledEvent",hg,[]);class $c extends hg{constructor(){super(178,11)}}Object(I.a)($c,"PivotTableDisplayNullStringToggledEvent",hg,[]);class de extends hg{constructor(){super(179,12)}}Object(I.a)(de,"PivotTableErrorStringChangedEvent",
hg,[]);class Be extends hg{constructor(){super(174,7)}}Object(I.a)(Be,"PivotTableExpandCollapseButtonsShownEvent",hg,[]);class nf extends hg{constructor(){super(187,20)}}Object(I.a)(nf,"PivotTableIndentChangedEvent",hg,[]);class Tf extends hg{constructor(){super(176,9)}}Object(I.a)(Tf,"PivotTableItemsWithNoDataOnColumnsShownEvent",hg,[]);class Xf extends hg{constructor(){super(175,8)}}Object(I.a)(Xf,"PivotTableItemsWithNoDataOnRowsShownEvent",hg,[]);class zg extends hg{constructor(){super(186,19)}}
Object(I.a)(zg,"PivotTableLayoutTypeSetEvent",hg,[]);class $f extends hg{constructor(){super(180,13)}}Object(I.a)($f,"PivotTableNullStringChangedEvent",hg,[]);class Ng extends Ud{constructor(){super()}get eventId(){return 149}Uh(){this.Ih(219)}}Object(I.a)(Ng,"PivotTablePivotLocationChangedEvent",Ud,[]);class pg extends Ud{constructor(){super()}get eventId(){return 102}Uh(){this.Ih(145)}}Object(I.a)(pg,"PivotTablePivotedEvent",Ud,[]);class Ug extends hg{constructor(){super(182,15)}}Object(I.a)(Ug,
"PivotTableRefreshDataOnLoadToggledEvent",hg,[]);class Og extends Ud{constructor(){super()}get eventId(){return 104}Uh(){this.Ih(50)}nm(){this.qj(H=>!!H.pivotTableId&&!!H.pivotTableName)}}Object(I.a)(Og,"PivotTableRefreshedEvent",Ud,[]);class bh extends hg{constructor(){super(168,1)}}Object(I.a)(bh,"PivotTableRenamedEvent",hg,[]);class mh extends hg{constructor(){super(169,2)}}Object(I.a)(mh,"PivotTableRowGrandTotalShownEvent",hg,[]);class Tg extends hg{constructor(){super(181,14)}}Object(I.a)(Tg,
"PivotTableSaveSourceDataWithFileToggledEvent",hg,[]);var Vg=a(733);class nh extends Ud{constructor(){super()}get eventId(){return 155}Uh(){this.Ih(131)}nm(){this.qj(H=>{H=Object(Da.a)(Vg.a,H);return!!H&&!!H.getFieldName()&&!!H.hierarchyName})}}Object(I.a)(nh,"PivotTableSortedEvent",Ud,[]);class wh extends hg{constructor(){super(185,18)}}Object(I.a)(wh,"PivotTableSubTotalsVisibilitySettingSetEvent",hg,[]);class oh extends Ud{constructor(){super()}get eventId(){return 206}Uh(){this.Ih(560)}}Object(I.a)(oh,
"PivotValueFieldSettingAppliedEvent",Ud,[]);class gh extends Ud{constructor(){super()}get eventId(){return 161}Uh(){this.Ih(243)}}Object(I.a)(gh,"PrintAreaClearedEvent",Ud,[]);class lh extends Ud{constructor(){super()}get eventId(){return 159}Uh(){this.Ih(241)}nm(){this.qj(H=>!H.addToPrintArea)}}Object(I.a)(lh,"PrintAreaSetEvent",Ud,[]);class Sh extends Ud{constructor(){super()}get eventId(){return 57}Uh(){this.Ih(517)}}Object(I.a)(Sh,"RangeAutoFilterClearedEvent",Ud,[]);class ih extends Ud{constructor(H,
va){super();this.Lra=H;this.gye=va}get eventId(){return this.Lra}Uh(){this.Ih(11)}nm(){this.qj(H=>16===H.h0().ValidMembers);this.qj(H=>H.h0().Font.ValidMembers===this.gye)}}Object(I.a)(ih,"RangeFontFormattedEventBase",Ud,[]);class di extends ih{constructor(){super(3,4)}}Object(I.a)(di,"RangeBoldedEvent",ih,[]);class Ra extends Ud{constructor(){super()}get eventId(){return 2}Uh(){this.Ih(11)}nm(){this.qj(H=>128===H.h0().ValidMembers)}}Object(I.a)(Ra,"RangeBorderedEvent",Ud,[]);class Tb{}Tb.Wqb="Table";
Tb.NOc="Sheet";Object(I.a)(Tb,"MacroRecorderEventConstants",null,[]);class Dc extends Ud{constructor(){super()}get eventId(){return 113}Uh(){this.Ih(208)}nm(){this.qj(H=>H.getParameters().FilterType===Tb.NOc)}}Object(I.a)(Dc,"RangeCheckedItemsFilteredEvent",Ud,[]);class Yc extends Ud{constructor(){super()}get eventId(){return 109}Uh(){this.Ih(105)}}Object(I.a)(Yc,"RangeConditionalFormattingCreatedEvent",Ud,[]);class Ad extends Ud{constructor(){super()}get eventId(){return 124}Uh(){this.Ih(221)}}Object(I.a)(Ad,
"RangeConditionalFormattingRuleDeletedEvent",Ud,[]);class he extends Ud{constructor(){super()}get eventId(){return 29}Uh(){this.Ih(508)}nm(){this.qj(H=>3===H.dD()||1===H.dD()||4===H.dD())}}Object(I.a)(he,"RangeContentClearedEvent",Ud,[]);class re extends Ud{constructor(){super()}get eventId(){return 40}Uh(){this.Ih(104)}}Object(I.a)(re,"RangeCopiedCutCellsInsertedEvent",Ud,[]);class Me extends Ud{constructor(){super()}get eventId(){return 114}Uh(){this.Ih(209)}nm(){this.qj(H=>H.getParameters().FilterType===
Tb.NOc)}}Object(I.a)(Me,"RangeCustomFilteredEvent",Ud,[]);class Ve extends Ud{constructor(){super()}get eventId(){return 106}Uh(){this.Ih(121)}}Object(I.a)(Ve,"RangeDataValidationChangedEvent",Ud,[]);class Hf extends ih{constructor(){super(4,64)}}Object(I.a)(Hf,"RangeDoubleUnderlinedEvent",ih,[]);class Qf extends Ud{constructor(){super()}get eventId(){return 69}Uh(){this.Ih(190)}}Object(I.a)(Qf,"RangeDuplicatesRemovedEvent",Ud,[]);class ia extends Ud{constructor(){super()}get eventId(){return 1}Uh(){this.Ih(527);
this.Ih(12)}}Object(I.a)(ia,"RangeEditedEvent",Ud,[]);class Xb extends Ud{constructor(){super()}get eventId(){return 164}Uh(){this.Ih(255)}nm(){this.qj(H=>4===H.actionType)}}Object(I.a)(Xb,"RangeExternalLinksBrokeAllLinksEvent",Ud,[]);class Vc extends Ud{constructor(){super()}get eventId(){return 119}Uh(){this.Ih(255)}nm(){this.qj(H=>3===H.actionType)}}Object(I.a)(Vc,"RangeExternalLinksBrokeLinkEvent",Ud,[]);class ud extends Ud{constructor(){super()}get eventId(){return 205}Uh(){this.Ih(256)}initializeFeatureGates(){this.OZe("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")}}
Object(I.a)(ud,"RangeExternalLinksChangeSourceEvent",Ud,[]);class xe extends Ud{constructor(){super()}get eventId(){return 163}Uh(){this.Ih(553)}nm(){this.qj(H=>1===H.actionType)}}Object(I.a)(xe,"RangeExternalLinksRefreshedAllEvent",Ud,[]);class fe extends Ud{constructor(){super()}get eventId(){return 77}Uh(){this.Ih(553)}nm(){this.qj(H=>0===H.actionType)}}Object(I.a)(fe,"RangeExternalLinksRefreshedEvent",Ud,[]);class Te extends Ud{constructor(){super()}get eventId(){return 165}Uh(){this.Ih(224)}}
Object(I.a)(Te,"RangeExternalLinksSetAutoRefreshEvent",Ud,[]);class Bf extends Ud{constructor(){super()}get eventId(){return 5}Uh(){this.Ih(11)}nm(){this.qj(H=>64===H.h0().ValidMembers)}}Object(I.a)(Bf,"RangeFillColoredEvent",Ud,[]);class Cf extends Ud{constructor(){super()}get eventId(){return 59}Uh(){this.Ih(155)}}Object(I.a)(Cf,"RangeFilledEvent",Ud,[]);class Lf extends Ud{constructor(){super()}get eventId(){return 115}Uh(){this.Ih(176)}nm(){this.qj(H=>H.autoFilterOptions.AutoFilterType===Tb.NOc&&
!!H.autoFilterOptions.CriteriaType)}}Object(I.a)(Lf,"RangeFilterAppliedEvent",Ud,[]);class df extends Ud{constructor(){super()}get eventId(){return 58}Uh(){this.Ih(176)}nm(){this.qj(H=>H.autoFilterOptions.AutoFilterType===Tb.NOc&&!H.autoFilterOptions.CriteriaType)}}Object(I.a)(df,"RangeFilterClearedEvent",Ud,[]);class T extends Ud{constructor(){super()}get eventId(){return 41}Uh(){this.Ih(518)}}Object(I.a)(T,"RangeFilterReappliedEvent",Ud,[]);class Ga extends Ud{constructor(){super()}get eventId(){return 86}Uh(){this.Ih(150)}}
Object(I.a)(Ga,"RangeFlashFilledEvent",Ud,[]);class hb extends ih{constructor(){super(6,32)}}Object(I.a)(hb,"RangeFontColoredEvent",ih,[]);class jc extends ih{constructor(){super(7,8)}}Object(I.a)(jc,"RangeFontItalicizedEvent",ih,[]);class Zc extends ih{constructor(){super(8,1)}nm(){za.EwaSettings.isChangeGateEnabled("OfficeVSO:8675567_FontMacroRecorderFixEnabled")?(this.qj(H=>16===H.h0().ValidMembers),this.qj(H=>1===(H.h0().Font.ValidMembers&1))):super.nm()}}Object(I.a)(Zc,"RangeFontNamedEvent",
ih,[]);class kd extends ih{constructor(){super(9,2)}}Object(I.a)(kd,"RangeFontSizedEvent",ih,[]);class qd extends Ud{constructor(){super()}get eventId(){return 74}Uh(){this.Ih(215)}}Object(I.a)(qd,"RangeFormattedAsTableEvent",Ud,[]);class ae extends Ud{constructor(){super()}get eventId(){return 97}Uh(){this.Ih(188)}}Object(I.a)(ae,"RangeGroupedOrUngroupedEvent",Ud,[]);class ne extends Ud{constructor(){super()}get eventId(){return 60}Uh(){this.Ih(11)}nm(){this.qj(H=>2===H.h0().ValidMembers)}}Object(I.a)(ne,
"RangeHorizontallyAlignedEvent",Ud,[]);class Pd extends Ud{constructor(){super()}get eventId(){return 43}Uh(){this.Ih(526)}}Object(I.a)(Pd,"RangeHyperlinkAppliedEvent",Ud,[]);class Vd extends Ud{constructor(){super()}get eventId(){return 63}Uh(){this.Ih(11)}nm(){this.qj(H=>256===H.h0().ValidMembers)}}Object(I.a)(Vd,"RangeIndentChangedEvent",Ud,[]);class Je extends Ud{constructor(){super()}get eventId(){return 53}Uh(){this.Ih(156)}nm(){this.qj(H=>2===H.dD()||5===H.dD()||6===H.dD()||7===H.dD())}}Object(I.a)(Je,
"RangeMergedEvent",Ud,[]);class Ge extends Ud{constructor(){super()}get eventId(){return 107}Uh(){this.Ih(216)}}Object(I.a)(Ge,"RangeNamedCellStyleAppliedEvent",Ud,[]);class sf extends Ud{constructor(){super()}get eventId(){return 12}Uh(){this.Ih(11)}nm(){this.qj(H=>32===H.h0().ValidMembers)}}Object(I.a)(sf,"RangeNumberFormattedEvent",Ud,[]);var Mf=a(1196);class Df extends Ud{constructor(){super()}get eventId(){return 108}Uh(){this.Ih(141)}nm(){this.qj(H=>Object(ra.a)(Mf.a,H))}}Object(I.a)(Df,"RangeSortedEvent",
Ud,[]);class Of extends ih{constructor(){super(10,128)}}Object(I.a)(Of,"RangeStrikedThroughEvent",ih,[]);class ig extends ih{constructor(){super(11,16)}}Object(I.a)(ig,"RangeUnderlinedEvent",ih,[]);class Ag extends Ud{constructor(){super()}get eventId(){return 61}Uh(){this.Ih(11)}nm(){this.qj(H=>1===H.h0().ValidMembers)}}Object(I.a)(Ag,"RangeVerticallyAlignedEvent",Ud,[]);class ng extends Ud{constructor(){super()}get eventId(){return 62}Uh(){this.Ih(11)}nm(){this.qj(H=>8===H.h0().ValidMembers)}}Object(I.a)(ng,
"RangeWrapTextToggledEvent",Ud,[]);class xg extends Ud{constructor(){super()}get eventId(){return 103}Uh(){this.Ih(51)}}Object(I.a)(xg,"RefreshedAllEvent",Ud,[]);class Pf extends Ud{constructor(){super()}get eventId(){return 47}Uh(){this.Ih(148)}}Object(I.a)(Pf,"ReplaceAllEvent",Ud,[]);class ca extends Ud{constructor(){super()}get eventId(){return 226}Uh(){this.Ih(1025)}}Object(I.a)(ca,"SampleTableCreatedEvent",Ud,[]);class cb extends Ud{constructor(){super()}get eventId(){return 91}Uh(){this.Ih(532)}nm(){this.qj(H=>
95!==H.getShapeType()&&96!==H.getShapeType()&&97!==H.getShapeType()&&98!==H.getShapeType()&&100!==H.getShapeType()&&102!==H.getShapeType()&&103!==H.getShapeType())}}Object(I.a)(cb,"ShapeInsertedEvent",Ud,[]);class tc extends Ud{constructor(){super()}get eventId(){return 92}Uh(){this.Ih(531)}}Object(I.a)(tc,"ShapeStyleSetEvent",Ud,[]);var Kc=a(1026);class Xd extends Ud{constructor(H,va){super();this.Lra=H;this.gye=va}get eventId(){return this.Lra}Uh(){this.Ih(581)}nm(){this.qj(H=>Object(ra.a)(Kc.a,
H)&&4===H.getShapeTextFormat().ValidMembers);this.qj(H=>Object(ra.a)(Kc.a,H)&&H.getShapeTextFormat().Font.ValidMembers===this.gye)}}Object(I.a)(Xd,"ShapeTextFontFormattedEventBase",Ud,[]);class qe extends Xd{constructor(){super(193,4)}}Object(I.a)(qe,"ShapeTextBoldedEvent",Xd,[]);var rf=a(1218);class Af extends Ud{constructor(){super()}get eventId(){return 191}Uh(){this.Ih(581)}nm(){this.qj(H=>Object(ra.a)(rf.a,H))}}Object(I.a)(Af,"ShapeTextChangedEvent",Ud,[]);class gg extends Xd{constructor(){super(196,
32)}}Object(I.a)(gg,"ShapeTextFontColorChangedEvent",Xd,[]);class mg extends Xd{constructor(){super(197,1)}}Object(I.a)(mg,"ShapeTextFontNameChangedEvent",Xd,[]);class og extends Xd{constructor(){super(198,2)}}Object(I.a)(og,"ShapeTextFontSizeChangedEvent",Xd,[]);class ph extends Ud{constructor(){super()}get eventId(){return 199}Uh(){this.Ih(581)}nm(){this.qj(H=>Object(ra.a)(Kc.a,H)&&2===H.getShapeTextFormat().ValidMembers)}}Object(I.a)(ph,"ShapeTextHorizontallyAlignedEvent",Ud,[]);class Yg extends Xd{constructor(){super(194,
8)}}Object(I.a)(Yg,"ShapeTextItalicizedEvent",Xd,[]);class Qh extends Xd{constructor(){super(195,16)}}Object(I.a)(Qh,"ShapeTextUnderlinedEvent",Xd,[]);class Lh extends Ud{constructor(){super()}get eventId(){return 200}Uh(){this.Ih(581)}nm(){this.qj(H=>Object(ra.a)(Kc.a,H)&&1===H.getShapeTextFormat().ValidMembers)}}Object(I.a)(Lh,"ShapeTextVerticallyAlignedEvent",Ud,[]);class Xh extends Ud{constructor(){super()}get eventId(){return 13}Uh(){this.Ih(138)}}Object(I.a)(Xh,"SheetAddedEvent",Ud,[]);class xh extends Ud{constructor(){super()}get eventId(){return 142}Uh(){this.Ih(237)}nm(){this.qj(H=>
!!H.insertDeleteMultiRangeParameters);this.qj(H=>!H.insertDeleteMultiRangeParameters.IsTableCommand);this.qj(H=>{H=H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>H.DeltaColumn&&!H.DeltaRow&&(!!H.InsertDeleteRange.FirstRow||H.InsertDeleteRange.LastRow!==Hc.a.KF)||!H.DeltaColumn&&0>H.DeltaRow&&(!!H.InsertDeleteRange.FirstColumn||H.InsertDeleteRange.LastColumn!==Hc.a.nE)})}}Object(I.a)(xh,"SheetCellsDeletedEvent",Ud,[]);class qh extends Ud{constructor(){super()}get eventId(){return 143}Uh(){this.Ih(237)}nm(){this.qj(H=>
!!H.insertDeleteMultiRangeParameters);this.qj(H=>!H.insertDeleteMultiRangeParameters.IsTableCommand);this.qj(H=>{H=H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<H.DeltaColumn&&!H.DeltaRow&&(!!H.InsertDeleteRange.FirstRow||H.InsertDeleteRange.LastRow!==Hc.a.KF)||!H.DeltaColumn&&0<H.DeltaRow&&(!!H.InsertDeleteRange.FirstColumn||H.InsertDeleteRange.LastColumn!==Hc.a.nE)})}}Object(I.a)(qh,"SheetCellsInsertedEvent",Ud,[]);class Zh extends Ud{constructor(){super()}get eventId(){return 139}Uh(){this.Ih(237)}nm(){this.qj(H=>
!!H.insertDeleteMultiRangeParameters);this.qj(H=>!H.insertDeleteMultiRangeParameters.IsTableCommand);this.qj(H=>0>H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.qj(H=>!H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.qj(H=>!H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.qj(H=>H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===Hc.a.KF)}}Object(I.a)(Zh,"SheetColumnDeletedEvent",
Ud,[]);class $h extends Ud{constructor(){super()}get eventId(){return 138}Uh(){this.Ih(237)}nm(){this.qj(H=>!!H.insertDeleteMultiRangeParameters);this.qj(H=>!H.insertDeleteMultiRangeParameters.IsTableCommand);this.qj(H=>0<H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.qj(H=>!H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.qj(H=>!H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.qj(H=>H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===
Hc.a.KF)}}Object(I.a)($h,"SheetColumnInsertedEvent",Ud,[]);class hh extends Ud{constructor(){super()}get eventId(){return 14}Uh(){this.Ih(137)}}Object(I.a)(hh,"SheetDeletedEvent",Ud,[]);class Gh extends Ud{constructor(){super()}get eventId(){return 137}Uh(){this.Ih(185)}}Object(I.a)(Gh,"SheetDirectionChangedEvent",Ud,[]);class Mh extends Ud{constructor(){super()}get eventId(){return 54}Uh(){this.Ih(139)}}Object(I.a)(Mh,"SheetDuplicatedEvent",Ud,[]);class Bi extends Ud{constructor(){super()}get eventId(){return 15}Uh(){this.Ih(207)}}
Object(I.a)(Bi,"SheetNameEditedEvent",Ud,[]);class $i extends Ud{constructor(){super()}get eventId(){return 90}Uh(){this.Ih(151)}}Object(I.a)($i,"SheetPaneFrozenEvent",Ud,[]);class Hi extends Ud{constructor(){super()}get eventId(){return 120}Uh(){this.Ih(226)}}Object(I.a)(Hi,"SheetPrintSettingsSavedEvent",Ud,[]);var zh=a(1104);class rj extends Ud{constructor(){super()}get eventId(){return 215}Uh(){this.Ih(507)}initializeFeatureGates(){this.OZe("Microsoft.Office.Excel.SheetProtectionMacroRecording")}nm(){this.qj(H=>
Object.getType(H)===zh.a)}}Object(I.a)(rj,"SheetProtectionPausedResumedEvent",Ud,[]);class Hj extends Ud{constructor(){super()}get eventId(){return 64}Uh(){this.Ih(557)}}Object(I.a)(Hj,"SheetReorderedEvent",Ud,[]);class Ii extends Ud{constructor(){super()}get eventId(){return 141}Uh(){this.Ih(237)}nm(){this.qj(H=>!!H.insertDeleteMultiRangeParameters);this.qj(H=>!H.insertDeleteMultiRangeParameters.IsTableCommand);this.qj(H=>!H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.qj(H=>0>H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.qj(H=>!H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.qj(H=>H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===Hc.a.nE)}}Object(I.a)(Ii,"SheetRowDeletedEvent",Ud,[]);class Cg extends Ud{constructor(){super()}get eventId(){return 140}Uh(){this.Ih(237)}nm(){this.qj(H=>!!H.insertDeleteMultiRangeParameters);this.qj(H=>!H.insertDeleteMultiRangeParameters.IsTableCommand);
this.qj(H=>!H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.qj(H=>0<H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.qj(H=>!H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.qj(H=>H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===Hc.a.nE)}}Object(I.a)(Cg,"SheetRowInsertedEvent",Ud,[]);class Wf extends Ud{constructor(){super()}get eventId(){return 39}Uh(){this.Ih(135)}}
Object(I.a)(Wf,"SheetRowsColumnsAutoFitEvent",Ud,[]);class sj extends Ud{constructor(){super()}get eventId(){return 36}Uh(){this.Ih(136)}}Object(I.a)(sj,"SheetRowsColumnsResizedEvent",Ud,[]);class ii extends Ud{constructor(){super()}get eventId(){return 68}Uh(){this.Ih(183)}}Object(I.a)(ii,"SheetShowGridlinesToggledEvent",Ud,[]);class aj extends Ud{constructor(){super()}get eventId(){return 67}Uh(){this.Ih(184)}}Object(I.a)(aj,"SheetShowHeadingsToggledEvent",Ud,[]);class rh extends Ud{constructor(){super()}get eventId(){return 89}Uh(){this.Ih(213)}}
Object(I.a)(rh,"SheetSpellCheckedEvent",Ud,[]);class Ji extends Ud{constructor(){super()}get eventId(){return 70}Uh(){this.Ih(515)}}Object(I.a)(Ji,"SheetTabColoredEvent",Ud,[]);class Dh extends Ud{constructor(){super()}get eventId(){return 71}Uh(){this.Ih(157)}}Object(I.a)(Dh,"SheetVisibilityChangedEvent",Ud,[]);class Ld extends Ud{constructor(){super()}get eventId(){return 126}Uh(){this.Ih(239)}}Object(I.a)(Ld,"SheetsVisibilityChangedEvent",Ud,[]);class ze extends Ud{constructor(){super()}get eventId(){return 188}Uh(){this.Ih(203)}}
Object(I.a)(ze,"SlicerInsertedEvent",Ud,[]);class Bj extends Ud{constructor(){super()}get eventId(){return 189}Uh(){this.Ih(173)}nm(){this.qj(H=>!H.clearFilter)}}Object(I.a)(Bj,"SlicerSelectionAppliedEvent",Ud,[]);class Ah extends Ud{constructor(){super()}get eventId(){return 190}Uh(){this.Ih(173)}nm(){this.qj(H=>H.clearFilter)}}Object(I.a)(Ah,"SlicerSelectionClearedEvent",Ud,[]);class Hh extends Ud{constructor(){super()}get eventId(){return 27}Uh(){this.Ih(208)}nm(){this.qj(H=>H.getParameters().FilterType===
Tb.Wqb)}}Object(I.a)(Hh,"TableCheckedItemsFilteredEvent",Ud,[]);class Ki extends Ud{constructor(){super()}get eventId(){return 144}Uh(){this.Ih(237)}nm(){this.qj(H=>!!H.insertDeleteMultiRangeParameters);this.qj(H=>H.insertDeleteMultiRangeParameters.IsTableCommand);this.qj(H=>0>H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.qj(H=>!H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(I.a)(Ki,"TableColumnDeletedEvent",Ud,[]);class Rh extends Ud{constructor(){super()}get eventId(){return 145}Uh(){this.Ih(237)}nm(){this.qj(H=>
!!H.insertDeleteMultiRangeParameters);this.qj(H=>H.insertDeleteMultiRangeParameters.IsTableCommand);this.qj(H=>0<H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.qj(H=>!H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(I.a)(Rh,"TableColumnInsertedEvent",Ud,[]);var Cj=a(1195);class Li extends Ud{constructor(){super()}get eventId(){return 121}Uh(){this.Ih(141)}nm(){this.qj(H=>Object(ra.a)(Cj.a,H))}}Object(I.a)(Li,"TableColumnSortedEvent",Ud,
[]);class Eh extends Ud{constructor(){super()}get eventId(){return 105}Uh(){this.Ih(193)}}Object(I.a)(Eh,"TableConvertedToRangeEvent",Ud,[]);class Ih extends Ud{constructor(){super()}get eventId(){return 16}Uh(){this.Ih(206)}}Object(I.a)(Ih,"TableCreatedEvent",Ud,[]);class qi extends Ud{constructor(){super()}get eventId(){return 30}Uh(){this.Ih(209)}nm(){this.qj(H=>H.getParameters().FilterType===Tb.Wqb)}}Object(I.a)(qi,"TableCustomFilteredEvent",Ud,[]);var Si=a(1531);class dj extends Ud{constructor(){super()}get eventId(){return 25}Uh(){this.Ih(187)}nm(){this.qj(H=>
H.options.OperationType===Si.d.CustomSort)}}Object(I.a)(dj,"TableCustomSortedEvent",Ud,[]);class ri extends Ud{constructor(){super()}get eventId(){return 28}Uh(){this.Ih(176)}nm(){this.qj(H=>H.autoFilterOptions.AutoFilterType===Tb.Wqb);this.qj(H=>0===H.autoFilterOptions.CriteriaType)}}Object(I.a)(ri,"TableFilterClearedEvent",Ud,[]);class Ig extends Ud{constructor(){super()}get eventId(){return 32}Uh(){this.Ih(176)}nm(){this.qj(H=>H.autoFilterOptions.AutoFilterType===Tb.Wqb);this.qj(H=>{const va=new pf.a;
va.add(1);va.add(2);va.add(8);va.add(9);va.add(10);va.add(11);va.add(12);va.add(13);va.add(14);va.add(15);va.add(16);va.add(17);va.add(18);va.add(19);va.add(20);va.add(21);va.add(22);va.add(23);va.add(24);va.add(25);va.add(26);va.add(27);va.add(28);va.add(29);va.add(30);va.add(31);va.add(32);va.add(33);va.add(34);va.add(35);va.add(36);va.add(37);va.add(38);va.add(39);return va.contains(H.autoFilterOptions.CriteriaType)})}}Object(I.a)(Ig,"TableItemFilteredEvent",Ud,[]);class Fh extends Ud{constructor(){super()}get eventId(){return 101}Uh(){this.Ih(217)}}
Object(I.a)(Fh,"TableRenamedEvent",Ud,[]);class si extends Ud{constructor(){super()}get eventId(){return 73}Uh(){this.Ih(211)}}Object(I.a)(si,"TableResizedEvent",Ud,[]);class Yh extends Ud{constructor(){super()}get eventId(){return 44}Uh(){this.Ih(514)}}Object(I.a)(Yh,"TableRowColumnRearrangedEvent",Ud,[]);class ti extends Ud{constructor(){super()}get eventId(){return 146}Uh(){this.Ih(237)}nm(){this.qj(H=>!!H.insertDeleteMultiRangeParameters);this.qj(H=>H.insertDeleteMultiRangeParameters.IsTableCommand);
this.qj(H=>!H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.qj(H=>0>H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(I.a)(ti,"TableRowDeletedEvent",Ud,[]);class ni extends Ud{constructor(){super()}get eventId(){return 147}Uh(){this.Ih(237)}nm(){this.qj(H=>!!H.insertDeleteMultiRangeParameters);this.qj(H=>H.insertDeleteMultiRangeParameters.IsTableCommand);this.qj(H=>!H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.qj(H=>0<H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(I.a)(ni,"TableRowInsertedEvent",Ud,[]);class nj extends Ud{constructor(){super()}get eventId(){return 26}Uh(){this.Ih(177)}nm(){this.qj(H=>H.autoFilterOptions.AutoFilterType===Tb.Wqb)}}Object(I.a)(nj,"TableSortedEvent",Ud,[]);class Ti extends Ud{constructor(){super()}get eventId(){return 87}Uh(){this.Ih(212)}}Object(I.a)(Ti,"TableStyleAppliedEvent",Ud,[]);class ei extends Ud{constructor(){super()}get eventId(){return 88}Uh(){this.Ih(196)}}
Object(I.a)(ei,"TableStyleOptionToggledEvent",Ud,[]);class fi extends Ud{constructor(){super()}get eventId(){return 31}Uh(){this.Ih(210)}nm(){this.qj(H=>H.getParameters().FilterType===Tb.Wqb)}}Object(I.a)(fi,"TableTop10FilteredEvent",Ud,[]);class fg extends Ud{constructor(){super()}get eventId(){return 207}Uh(){this.Ih(238)}}Object(I.a)(fg,"TextToColumnsEvent",Ud,[]);class uh extends Ud{constructor(){super()}get eventId(){return 128}Uh(){this.Ih(559)}}Object(I.a)(uh,"ValuesSortedEvent",Ud,[]);class Jh extends Ud{constructor(){super()}get eventId(){return 55}Uh(){this.Ih(197)}}
Object(I.a)(Jh,"WorkbookCalculationModeSetEvent",Ud,[]);class sh extends Ud{constructor(){super()}get eventId(){return 34}Uh(){this.Ih(181)}nm(){this.qj(H=>!!H.parentCommentId)}}Object(I.a)(sh,"WorkbookCommentRepliedEvent",Ud,[]);class Nh extends Ud{constructor(){super()}get eventId(){return 33}Uh(){this.Ih(181)}nm(){this.qj(H=>!H.parentCommentId)}}Object(I.a)(Nh,"WorkbookCommentedEvent",Ud,[]);class oi extends Ud{constructor(){super()}get eventId(){return 56}Uh(){this.Ih(128)}}Object(I.a)(oi,"WorkbookRecalculatedEvent",
Ud,[]);class gi extends Ud{constructor(){super()}get eventId(){return 46}Uh(){this.Ih(171)}}Object(I.a)(gi,"WorkbookRedoEvent",Ud,[]);class Ui extends Ud{constructor(){super()}get eventId(){return 45}Uh(){this.Ih(170);this.Ih(1033)}}Object(I.a)(Ui,"WorkbookUndoEvent",Ud,[]);class ui extends Ud{constructor(){super()}get eventId(){return 116}Uh(){this.Ih(507);this.Ih(576);this.Ih(10)}nm(){this.qj(H=>{if(Object(ra.a)(oc,H)&&(H=Object(Da.a)(oc,H),void 0!==H.source&&null!==H.source&&void 0!==H.eventId&&
null!==H.eventId))return sa.ULS.sendTraceTag(537155426,0,50,`[RichApiRecorder]: received a valid but unhandled event: source: ${H.source}; eventId: ${H.eventId}.`),!0;sa.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");return!1})}}Object(I.a)(ui,"DefaultRichApiRequestExecutedEvent",Ud,[]);class Mi extends Ud{constructor(){super()}get eventId(){return 216}Uh(){this.Ih(1022)}}Object(I.a)(Mi,"TablelAltTextEditedEvent",Ud,[]);class ej extends Ud{constructor(){super()}get eventId(){return 217}Uh(){this.Ih(263)}}
Object(I.a)(ej,"FloatingObjectZOrderChangedEvent",Ud,[]);var vi=a(1216);class wi extends Ud{constructor(){super()}get eventId(){return 192}Uh(){this.Ih(507)}nm(){this.qj(H=>Object(ra.a)(vi.a,H)?!0:!1)}}Object(I.a)(wi,"VisualPropertySetEvent",Ud,[]);class xi extends lc{constructor(){super(219,[510])}}Object(I.a)(xi,"ChartSeriesDeletedEvent",lc,[]);class Vi extends Ud{get eventId(){return 220}Uh(){this.Ih(1027)}}Object(I.a)(Vi,"ChartDataChangedEvent",Ud,[]);class Ni extends lc{constructor(){super(221,
[512])}}Object(I.a)(Ni,"ChartSeriesDataChangedEvent",lc,[]);class fj extends Ud{constructor(){super()}get eventId(){return 225}Uh(){this.Ih(269)}}Object(I.a)(fj,"FloatingObjectPutFloatingImageInCellEvent",Ud,[]);class tj extends Ud{constructor(){super()}get eventId(){return 224}Uh(){this.Ih(268)}}Object(I.a)(tj,"ImageInCellConvertToFloatingObjectEvent",Ud,[]);class ai{constructor(H){this.mh=null;this.$=H}get macroRecorderEvents(){this.mh||(this.mh=new pf.a,this.mh.add(new ia),this.mh.add(new Ra),
this.mh.add(new di),this.mh.add(new Hf),this.mh.add(new Bf),this.mh.add(new hb),this.mh.add(new jc),this.mh.add(new Zc),this.mh.add(new kd),this.mh.add(new Of),this.mh.add(new ig),this.mh.add(new sf),this.mh.add(new Xh),this.mh.add(new hh),this.mh.add(new Bi),this.mh.add(new Ih),this.mh.add(new Ki),this.mh.add(new Rh),this.mh.add(new ti),this.mh.add(new ni),this.mh.add(new $h),this.mh.add(new Zh),this.mh.add(new Cg),this.mh.add(new Ii),this.mh.add(new dj),this.mh.add(new nj),this.mh.add(new Hh),this.mh.add(new ri),
this.mh.add(new he),this.mh.add(new qi),this.mh.add(new fi),this.mh.add(new Ig),this.mh.add(new Nh),this.mh.add(new sh),this.mh.add(new Kg),this.mh.add(new sj),this.mh.add(new xh),this.mh.add(new qh),this.mh.add(new Wf),this.mh.add(new re),this.mh.add(new T),this.mh.add(new Pd),this.mh.add(new fh),this.mh.add(new Yh),this.mh.add(new gi),this.mh.add(new Ui),this.mh.add(new Pf),this.mh.add(new zb),this.mh.add(new Rg),this.mh.add(new Je),this.mh.add(new Mh),this.mh.add(new Jh),this.mh.add(new oi),this.mh.add(new Sh),
this.mh.add(new df),this.mh.add(new Cf),this.mh.add(new ne),this.mh.add(new Ag),this.mh.add(new ng),this.mh.add(new Vd),this.mh.add(new Hj),this.mh.add(new Gf),this.mh.add(new Z),this.mh.add(new aj),this.mh.add(new ii),this.mh.add(new Qf),this.mh.add(new Dh),this.mh.add(new Ji),this.mh.add(new si),this.mh.add(new qd),this.mh.add(new aa),this.mh.add(new ge),this.mh.add(new fe),this.mh.add(new Pa),this.mh.add(new tb),this.mh.add(new Ja),this.mh.add(new Cd),this.mh.add(new E),this.mh.add(new Qd),this.mh.add(new ye),
this.mh.add(new Gc),this.mh.add(new h),this.mh.add(new Ga),this.mh.add(new Ti),this.mh.add(new ei),this.mh.add(new rh),this.mh.add(new $i),this.mh.add(new cb),this.mh.add(new tc),this.mh.add(new cd),this.mh.add(new ta),this.mh.add(new wb),this.mh.add(new hc),this.mh.add(new ae),this.mh.add(new Qa),this.mh.add(new cg),this.mh.add(new ic),this.mh.add(new Fh),this.mh.add(new pg),this.mh.add(new xg),this.mh.add(new Og),this.mh.add(new Eh),this.mh.add(new Ve),this.mh.add(new Ge),this.mh.add(new Df),this.mh.add(new Yc),
this.mh.add(new Dg),this.mh.add(new Hg),this.mh.add(new eh),this.mh.add(new Dc),this.mh.add(new Me),this.mh.add(new Lf),this.mh.add(new lg),this.mh.add(new Yf),this.mh.add(new Vc),this.mh.add(new Hi),this.mh.add(new Li),this.mh.add(new Ad),this.mh.add(new Ld),this.mh.add(new Id),this.mh.add(new uh),this.mh.add(new Wa),this.mh.add(new Ff),this.mh.add(new S),this.mh.add(new Le),this.mh.add(new Vh),this.mh.add(new ke),this.mh.add(new yc),this.mh.add(new Gh),this.mh.add(new Nc),this.mh.add(new Ng),this.mh.add(new Eg),
this.mh.add(new Oa),this.mh.add(new nh),this.mh.add(new Bg),this.mh.add(new dh),this.mh.add(new Sf),this.mh.add(new lh),this.mh.add(new Uf),this.mh.add(new gh),this.mh.add(new wf),this.mh.add(new xe),this.mh.add(new Xb),this.mh.add(new Te),this.mh.add(new Ie),this.mh.add(new Kf),this.mh.add(new bh),this.mh.add(new mh),this.mh.add(new Fg),this.mh.add(new qg),this.mh.add(new Ch),this.mh.add(new Wh),this.mh.add(new Be),this.mh.add(new Xf),this.mh.add(new Tf),this.mh.add(new Ma),this.mh.add(new $c),this.mh.add(new de),
this.mh.add(new $f),this.mh.add(new Tg),this.mh.add(new Ug),this.mh.add(new dg),this.mh.add(new jh),this.mh.add(new wh),this.mh.add(new zg),this.mh.add(new nf),this.mh.add(new ze),this.mh.add(new Bj),this.mh.add(new Ah),this.mh.add(new Af),this.mh.add(new qe),this.mh.add(new Yg),this.mh.add(new Qh),this.mh.add(new gg),this.mh.add(new mg),this.mh.add(new og),this.mh.add(new ph),this.mh.add(new Lh),this.mh.add(new ud),this.mh.add(new oh),this.mh.add(new fg),this.mh.add(new rj),this.mh.add(new Mi),this.mh.add(new ej),
this.mh.add(new wi),this.mh.add(new xi),this.mh.add(new Ni),this.mh.add(new Vi),this.mh.add(new tj),this.mh.add(new fj),this.mh.add(new ca),za.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&this.Hgk());return this.mh}QFf(H,va){let ub=this.RFf(H,this.macroRecorderEvents,va);ub||(ub=this.RFf(H,ai.dZi(),va),!ub&&this.XXf(H,ai.Akf,va)&&(ub=ai.Akf));return ub}RFf(H,va,ub){const kc=new pf.a;for(const Oc of va)this.XXf(H,Oc,ub)&&kc.add(Oc);return 1===kc.count?kc.ma(0):1<kc.count?
ai.mDi(kc):null}XXf(H,va,ub){const kc=ai.n_j(H,va);return ub?kc&&ai.i$k(H,va):kc}Hgk(){const H=new pf.a;for(const va of this.mh){let ub=!1;for(const kc of va.featureGates)if(!za.EwaSettings.Ra(kc)){H.add(va);ub=!0;break}if(!ub)for(const kc of va.Xvf)if(!za.EwaSettings.getBooleanFeatureGate(kc,!1)){H.add(va);break}}for(const va of H)this.mh.remove(va)}static dZi(){ai.hYb||(ai.hYb=new pf.a,ai.hYb.add(new qf),ai.hYb.add(new Cb));return ai.hYb}static n_j(H,va){return va.operations.contains(H.operation)}static i$k(H,
va){va=va.u2c;if(!va.count)return!0;let ub=!0;for(const kc of va)if(!kc(H.payload)){ub=!1;break}return ub}static mDi(H){let va=H.ma(0);for(const ub of H)ub.u2c.count>va.u2c.count&&(va=ub);return va}}ai.hYb=null;ai.Akf=new ui;Object(I.a)(ai,"MacroRecorderEventList",null,[]);var bi=a(688);class ji{constructor(){this.Yyb=null}get lIh(){this.Yyb||(this.Yyb=new pf.a,this.Yyb.add(12),this.Yyb.add(11));return this.Yyb}Nej(H){return this.lIh.contains(H.operation)}Z0k(H){const va=[],ub=H.payload;for(const kc of ub.batchedOperations)va.push(new bi.a(H.operation,
kc));return va}}Object(I.a)(ji,"MacroRecorderBatchedEventList",null,[]);var Wi=a(127);class Ij{equals(H,va){return H===va}getHashCode(H){return H}mwa(H){return H}}Object(I.a)(Ij,"UserOperationNameComparer",null,[136,137]);class Ef{static jZi(){Ef.Di||(Ef.Di=new nd.a(new Ij),Ef.Di.add(507),Ef.Di.add(10),Ef.Di.add(576),Ef.Di.add(563),Ef.Di.add(564),Ef.Di.add(565),Ef.Di.add(566),Ef.Di.add(567),Ef.Di.add(568),Ef.Di.add(569),Ef.Di.add(570),Ef.Di.add(571),Ef.Di.add(572),Ef.Di.add(573),Ef.Di.add(574),Ef.Di.add(575),
Ef.Di.add(501),Ef.Di.add(520),Ef.Di.add(1),Ef.Di.add(1002),Ef.Di.add(129),Ef.Di.add(198),Ef.Di.add(500),Ef.Di.add(519),Ef.Di.add(538),Ef.Di.add(1E3),Ef.Di.add(1003),Ef.Di.add(144),Ef.Di.add(502),Ef.Di.add(505),Ef.Di.add(179),Ef.Di.add(205),Ef.Di.add(134),Ef.Di.add(230),Ef.Di.add(103),Ef.Di.add(110),Ef.Di.add(112),Ef.Di.add(113),Ef.Di.add(124),Ef.Di.add(133),Ef.Di.add(154),Ef.Di.add(162),Ef.Di.add(168),Ef.Di.add(172),Ef.Di.add(201),Ef.Di.add(222),Ef.Di.add(227),Ef.Di.add(513),Ef.Di.add(534),Ef.Di.add(539),
Ef.Di.add(545),Ef.Di.add(600),Ef.Di.add(547),Ef.Di.add(555),Ef.Di.add(558),Ef.Di.add(562),Ef.Di.add(585),Ef.Di.add(1001),Ef.Di.add(1005),Ef.Di.add(1008),Ef.Di.add(1010),Ef.Di.add(1011),Ef.Di.add(1012),Ef.Di.add(1018),Ef.Di.add(252),Ef.Di.add(253),Ef.Di.add(258),Ef.Di.add(101),Ef.Di.add(102),Ef.Di.add(108),Ef.Di.add(257),Ef.Di.add(119),Ef.Di.add(120),Ef.Di.add(123),Ef.Di.add(126),Ef.Di.add(127),Ef.Di.add(130),Ef.Di.add(140),Ef.Di.add(159),Ef.Di.add(160),Ef.Di.add(165),Ef.Di.add(166),Ef.Di.add(167),
Ef.Di.add(169),Ef.Di.add(189),Ef.Di.add(223),Ef.Di.add(214),Ef.Di.add(228),Ef.Di.add(233),Ef.Di.add(247),Ef.Di.add(504),Ef.Di.add(511),Ef.Di.add(512),Ef.Di.add(525),Ef.Di.add(533),Ef.Di.add(537),Ef.Di.add(542),Ef.Di.add(544),Ef.Di.add(548),Ef.Di.add(550),Ef.Di.add(551),Ef.Di.add(552),Ef.Di.add(554),Ef.Di.add(577),Ef.Di.add(584),Ef.Di.add(586),Ef.Di.add(587),Ef.Di.add(588),Ef.Di.add(592),Ef.Di.add(1009),Ef.Di.add(1016),Ef.Di.add(1017),Ef.Di.add(1024),Ef.Di.add(260),Ef.Di.add(597),Ef.Di.add(264),Ef.Di.add(596),
Ef.Di.add(254),Ef.Di.add(262),Ef.Di.add(1030),Ef.Di.add(1031),Ef.Di.add(606));return Ef.Di}}Ef.Di=null;Object(I.a)(Ef,"MacroRecorderUnrecognizedEventList",null,[]);let Ci=class{constructor(H,va,ub){va=void 0===va?new ai(H):va;ub=void 0===ub?new ji:ub;this.dOb=null;this.QAj=(kc,Oc)=>{this.OPg()&&this.SEd(Oc)};this.P8f=va;this.O8f=ub;this.$=H;this.$.R5&&this.$.Ozh(this.QAj)}init(H){this.$.R5&&(H?this.dOb=H:sa.ULS.sendTraceTag(537155424,0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))}SEd(H){if(this.OPg())try{if(this.O8f.Nej(H)){var va=
this.O8f.Z0k(H);for(const ub of va)this.hxf(ub)}else this.hxf(H)}catch(ub){va=`MacroRecorderEventHandler.FireMacroRecorderEvent: Error: ${Wi.a(H.operation)}, Exception: ${ub.stack}`;sa.ULS.sendTraceTag(537155423,0,10,va);try{this.hvi(H)}catch(kc){}}}hxf(H){var va=this.P8f.QFf(H,!0);va?(this.dOb(va.eventId,Jb.a.li(H.payload)),sa.ULS.sendTraceTag(537155422,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${va.eventId}`)):(va=this.P8f.QFf(H,!1))?sa.ULS.sendTraceTag(537155421,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${va.eventId}, but failed to match filters`):
Ef.jZi().contains(H.operation)||(this.dOb(0,Jb.a.li(H.operation)),H=`MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: ${Wi.a(H.operation)}`,sa.ULS.sendTraceTag(537155420,0,50,H))}hvi(H){this.dOb(222,Jb.a.li(H.operation))}OPg(){return this.$.Oxa&&this.dOb&&this.$.Bga?!0:!1}};Ci=Object(F.__decorate)([Object(Ta.d)(ba.Jd),Object(F.__param)(0,Object(ba.Lb)())],Ci);Object(I.a)(Ci,"MacroRecorderEventHandler",null,[442]);Object(Ta.b)(ba.Wd,{yk:"singleton"})(H=>No(function*(){yield Ta.a.resolve(ba.Vd,
H);return Wc.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory")}));var kf=a(2);class uj{}Object(I.a)(uj,"Selection",null,[]);var Zg=a(1429),oj=a(38);class Xi{}Object(I.a)(Xi,"SmartLookupApplicationInterface",null,[]);class Yi{}Object(I.a)(Yi,"ApplicationProperties",null,[]);class Di{}Object(I.a)(Di,"EnterpriseUserInfo",null,[]);class $g{}Object(I.a)($g,"FeatureGates",null,[]);class vj{constructor(H,va,ub){this.BXk=9E5;this.DXk=3E5;this.C1d=null;this.y7f="";this.z1d=
0;this.BLb=Date.now;this.zya=H;this.Yob=va;(void 0===ub||ub)&&this.AHd()}JUi(){var H=void 0===H?!0:H;const va=this.BLb();if(va<this.z1d+this.BXk)return va>this.z1d+this.DXk&&this.AHd(),this.y7f;H&&this.AHd();return""}AHd(){this.C1d=this.C1d||new Promise(H=>{this.KUi().then(va=>{this.y7f=va;this.z1d=this.BLb();this.C1d=null;H(va)})})}KUi(){return this.Yob&&this.Yob.length?new Promise(H=>{this.zya.JD("SmartLookup",this.Yob).then(va=>{va.IsSuccess?va.Token||(H(""),sa.ULS.sendTraceTag(51446545,1313,15,
"SmartLookupManager - The AAD token is empty")):(sa.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+va.ErrorCode+": "+va.ErrorMessage),H(""));H(va.Token)}).catch(va=>{va=Fe.c(va);sa.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+va);H("")})}):(sa.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))}}Object(I.a)(vj,"SmartLookupAuthenticationManager",
null,[491]);class yj{static FIi(){switch(Object(Da.a)(String,P.AFrameworkApplication.Nh.AudienceGroup)||""){case "Dogfood":if(P.AFrameworkApplication.fa){let H=P.AFrameworkApplication.fa.Xa("UserPrincipalName");H=sb.a.Rr(H);const va=P.AFrameworkApplication.fa.rv("SmartLookupINTEnabledForSKITeam")?P.AFrameworkApplication.fa.aA("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(va,H)?"INT":"EDOG"}return"EDOG";default:return"PROD"}}static bUi(){switch(P.AFrameworkApplication.fa.la("IntentSvcEnableEdogSourceLocationOverride")?
"EDOG":P.AFrameworkApplication.fa.la("IntentSvcEnableProdSourceLocationOverride")?"PROD":P.AFrameworkApplication.fa.la("IntentSvcEnableIntSourceLocationOverride")?"INT":yj.FIi()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}}}Object(I.a)(yj,"Utils",null,[]);var bj=a(81),gj=a(646);
class th{constructor(H){sa.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.h8f=P.AFrameworkApplication.fa.la("IsTellMeUpSellEnterpriseEnabled");this.fAj=P.AFrameworkApplication.fa.Xa("SmartLookupApprovedOriginPattern");this.Yob=P.AFrameworkApplication.fa.Xa("SmartLookupShredderServiceEndpoint");this.LAj=bj.a.sU(P.AFrameworkApplication.fa.Xa("AppCatalogUrl")||"");this.Xob=new $g;this.Xob.EnableAllTabV2=!0;this.Xob.EnableIntentService=!0;this.Xob.EnableInDocumentSearch=P.AFrameworkApplication.fa.la("SmartLookupEnableInDocumentSearch");
this.Xob.EnableLocalSearch=P.AFrameworkApplication.fa.la("SmartLookupEnableLocalSearch");this.Xob.IntentServiceEndpoint=yj.bUi();this.GAj=new vj(H,this.Yob)}get approvedOriginPattern(){return this.fAj}DCi(){return Promise.resolve(this.ECi())}ECi(){const H=new Yi;H.anid="";H.applicationVersion=P.AFrameworkApplication.buildVersion;H.appCorrelationId=Qc.a.create().toString();H.themePlatform=th.nal;H.lcid=P.AFrameworkApplication.lcid;H.launchUtcTime=(new Date).toUTCString();H.featureGates=this.Xob;var va=
gj.a.qU(P.AFrameworkApplication.lcid);va=va?va.name:null;H.market=this.pyc(va);H.uiLanguage=va;H.sessionId=P.AFrameworkApplication.userSessionId;H.themeId=0;H.parentalControl=th.Z0j;const ub=new Di;ub.CountryCode=this.pyc(va);ub.ServiceEndpoint=this.Yob;ub.IsGoLocal=!1;ub.IsEnabled=this.h8f;ub.IsEnterpriseEnabled=this.h8f;ub.TenantRoot=this.LAj;H.enterpriseUserInfo=ub;H.accessToken=this.GAj.JUi();return H}pyc(H){H=H.split("-");return H[H.length-1]}}th.nal="web";th.Z0j="yes";Object(I.a)(th,"SmartLookupManager",
null,[468]);var Th;let Oh=Th=class extends oj.a{constructor(H){super();this.$=H;this.isFirstLaunch=!1}Ji(){return!1}Bi(){return!1}ni(H,va){H=za.EwaSettings.Ra(127);return-983891024===va.command&&H}executeCommand(H,va){H=Fa.TaskExtensions.sq();-983891024===va.command&&this.ltj();return H}ltj(){var H=new th(null);const va={};var ub=ea.f(this.$).kh(null).originalText;ub=Object(kf.a)(new uj,{neighborhood:ub,mentionStart:0,mentionLength:ub?ub.length:0});const kc=Object(kf.a)(new Xi,{selection:ub,entryPoint:0});
H.DCi().then(pd=>{pd.applicationName=Th.appName;pd.isFirstLaunch=this.isFirstLaunch;pd.themeId=5;va[Th.vPk]=JSON.stringify(kc);va[Th.UDh]=JSON.stringify(pd);this.isFirstLaunch=!1});H=new Pe.a("ExcelOnline","Web","en-Us");ub=new md.a("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");const Oc=new ie.a;Oc.ik[Zg.a.vs]=Lc.a.instance.ia(1810);Oc.ik[Zg.a.taskPaneWidth]=350;Oc.ik[Zg.a.sourceLocationOverrideResourceId]="WAC.PROD.URL";Oc.Iw=va;Xc.a.instance.pya(ub,"Taskpane","SmartLookupSDXTaskpane",
H,Oc)}};Oh.UDh="AppProperties";Oh.appName="Excel";Oh.vPk="SmartLookupApplicationInterface";Oh=Th=Object(F.__decorate)([Object(Ta.d)(ba.Vf),Object(F.__param)(0,Object(ba.Lb)()),Object(F.__param)(1,Object(la.a)())],Oh);Object(I.a)(Oh,"SmartLookupCommandHandler",oj.a,[39]);var pi=a(1239),kh=a(424);class cj{constructor(){this.Neh=new pf.a}get xnc(){return this.Neh}tPi(H){sa.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",H);const va=new pf.a;for(const ub of this.xnc)for(const kc of ub.CZb)kc.id===
H&&va.add(kc);return va}DZe(H){this.xnc.add(H)}Agk(H){for(const va of this.xnc)if(va.t2e===H.t2e){this.xnc.remove(va);break}}static xbi(H,va,ub){ub=void 0===ub?null:ub;H=cj.cGi(H);0<H.length&&(cj.eWc(H,!1),ub&&ub(va,H))}static cGi(H){const va=[];if(H&&H.CZb&&0<H.CZb.count)for(const ub of H.CZb)if(ub.controls&&0<ub.controls.count)for(const kc of ub.controls)if(kc.menuItems&&0<kc.menuItems.count)for(const Oc of kc.menuItems)Array.add(va,Oc.id);return va}static eWc(H,va){if(H.length){var ub=[];for(const kc of H)ub.push(appChrome.actions.updateControlEnabledDisabledState(kc,
va));appChrome.api.dispatch(ub)}}}Object(I.a)(cj,"ContextMenuExtensibilityCache",null,[383,384]);var wj=a(1551),Ei=a(1097),Oi=a(1008);class Zi{Jcb(H,va){va=void 0===va?null:va;if(H=Oi.a.QOb(H)){appChrome.addInApi.dispatchActionsToInstallAddIn(H,va);for(const ub of H.tabs)if(ub.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(H,()=>{});break}}}Kfe(H){(H=Oi.a.QOb(H))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(H)}qMg(){}static Gbi(H,va,ub){ub=void 0===ub?null:ub;H=Zi.XSi(H);0<
H.length&&(Zi.eWc(H,!1),ub&&ub(va,H))}static XSi(H){const va=[];if(H&&(H=H.G6,H.NB&&0<H.NB.count))for(const ub of H.NB)if(ub.groups&&0<ub.groups.length)for(const kc of ub.groups)if(kc.controls&&0<kc.controls.length)for(const Oc of kc.controls)Array.add(va,Oc.id);return va}static eWc(H){if(H.length){var va=[];for(const ub of H)va.push(appChrome.actions.updateControlEnabledDisabledState(ub,!0));appChrome.api.dispatch(va)}}}Object(I.a)(Zi,"OneLineRibbonExtensibilityManager",null,[404]);var Ph=a(1145);
class Pi{constructor(){this.iEe=this.x4c=null;this.vRf=(H,va)=>{let ub=null;ub=()=>{H.getIsUpgrading()?window.setTimeout(ub,1E3):H.getUpgradingFailed()?Zi.eWc(va,!0):P.AFrameworkApplication.ra.AB()};window.setTimeout(ub,1E3)}}get Ckd(){return this.x4c||(this.x4c=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set Ckd(H){this.x4c=H}get KHh(){return this.iEe||(this.iEe=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromSolutionIdRuntimeId(H,
va){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromSolutionIdRuntimeId(H,va)}GNd(H,va,ub,kc,Oc,pd,Sd){pd=void 0===pd?null:pd;Sd=void 0===Sd?null:Sd;var Wd;sa.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",H);P.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8642303_FixedTelemetryForAddinCommandsActionEnabled")&&(H={["solutionId"]:null===(Wd=globalThis.Telemetry)||void 0===Wd?void 0:Wd.PrivacyRules.GetPrivacyCompliantId(Oc.ownerAddinInfo.solutionId,Oc.ownerAddinInfo.storeType,
Oc.ownerAddinInfo.assetId,null,null,Oc.ownerAddinInfo.storeId)},Wd=new Ob.a,Wd.name="Office.Extensibility.Host.HandleAddinCommandsAction",Wd.dataFields=zc.a.rn(H),Bc.a.sendTelemetryEvent(Wd));if((va=va.Iva(Oc.ownerAddinInfo.storeType,Oc.ownerAddinInfo.solutionId))&&va.EK&&!va.EK.getIsUpgrading())if(Wd=null,0<va.EK.getNotificationParams().length&&(Wd=this.w8e(va.EK.getNotificationParams()[0]))&&2147758681===Wd.errorCode&&(va.isUpgraded=!0),2!==va.EK.getStatus()&&(1!==va.EK.getStatus()||Wd&&2147758681===
Wd.errorCode))Wd&&this.GQg(va,Wd,Sd);else try{ub.setOwnerAddinEToken(va.EK.getEToken()),Oc.action(ub,kc.Soa),pd&&pd()}catch(ee){sa.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",P.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?ee.stack:ee.message)),Ph.a.Ope(Object(La.a)("InternalError")+" "+Object(La.a)("InternalError_Directive"))}}GQg(H,va,ub){ub=void 0===ub?null:ub;const kc=H.EK;if(1===kc.getNotificationParams().length||
va.iCc){const Oc=va.fua,pd=va.fva;va.fua=()=>{kc.removeFirstNotification();if(0<kc.getNotificationParams().length){const Sd=this.w8e(kc.getNotificationParams()[0]);this.GQg(H,Sd)}2147758681===va.errorCode&&(Zi.Gbi(H.qw,kc,this.vRf),cj.xbi(H.iKb,kc,this.vRf));Oc&&Oc()};va.fva=()=>{pd&&pd();ub&&ub()};Ph.a.Ppe(va)}}w8e(H){const va=new Ei.a;va.f_a=H.infoType;va.id=H.id;va.title=H.title;va.description=H.description;va.buttonText=H.buttonTxt;va.fua=H.buttonCallback;va.iCc=H.highPriority;va.fva=H.dismissCallback;
va.errorCode=H.errorCode;va.xQf=H.iframeNotificationUrl;return va}}Object(I.a)(Pi,"AddinCommandsActionHandler",null,[390]);var L=a(182),qa=a(894),Va=a(7),Fb=a(941),bc=a(890);class Ic{constructor(H,va){this.Ya=H;this.LYh=va}kAi(H){if(void 0!==H&&null!==H&&H===Va.a.hff)H="ContextMenuCell";else return null;const va=this.Ya.Oh();this.wzi(va,H);return va}wzi(H,va){va=this.LYh.tPi(va);for(const ub of va){va=ub.controls;for(const kc of va)this.gzi(H,kc)}}gzi(H,va){var ub=va.Z3[Fb.a.id];const kc=va.Z3[Fb.a.k9a],
Oc=va.Z3[Fb.a.p9a];let pd="Image16by16",Sd=va.Z3[Fb.a.l9a];bc.c(Oc)&&(pd="None");0<va.menuItems.count?(ub=this.Ya.fz(ub,ub,kc,798637440),ub.z5b(pd,Oc,null),this.iAi(ub.menu,va),H.buttons.push(ub)):H.buttons.push(this.Ya.rWa(ub,kc,Sd,Oc,pd,null,!1))}iAi(H,va){const ub=this.Ya.Oh();for(const kc of va.menuItems){va=kc.Fya[Fb.a.id];const Oc=kc.Fya[Fb.a.k9a],pd=kc.Fya[Fb.a.p9a];let Sd="Image16by16";const Wd=kc.Fya[Fb.a.l9a];bc.c(pd)&&(Sd="None");va=this.Ya.rWa(va,Oc,Wd,pd,Sd,null,!1);ub.buttons.push(va)}H.vh.push(ub)}}
Object(I.a)(Ic,"AddInCommandsContextMenuExtensibilityHandler",null,[533]);var td=a(1015);class Hd{constructor(){this.so=null;this.visible=!1}}Object(I.a)(Hd,"AddinStatusCommandValues",null,[]);class pe{static W8j(H){const va=new Hd;va.so=H.lFa;va.visible=va.so?!0:!1;return va}static PXc(H,va,ub,kc,Oc){const pd=document.getElementById(ub);pd?pe.kMk(H,va,pd,kc,Oc):sa.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",ub))}static kMk(H,va,ub,kc,Oc){ub?H.lFa===Object(La.a)("ErrorLoadingAddInsTitle")?
Ph.a.HKk(va,ub,kc,Oc):H.lFa===Object(La.a)("InstallingCustomFunctionsErrorStatusBarMsg")&&Ph.a.rMk(va,ub,Object(La.a)("InstallingCustomFunctionsErrorStatusBarMsg"),Object(La.a)("InstallingCustomFunctionsErrorCalloutMsg")):sa.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}Object(I.a)(pe,"AddinCommandsStatusHandler",null,[]);var Ke=a(254),uf=a(89);class zf extends oj.a{constructor(H,va){super();this.agaveCommandManager=this.statusBarManager=null;this.eo=
!1;this.Wbf=()=>{this.QK&&this.QK.Cbf()};this.BLf=()=>{this.raiseEvent("LAC")};this.Oi=(ub,kc)=>{!ub.Ph&&Ke.b(kc)&&this.statusBarManager&&(this.statusBarManager.$I(this),this.statusBarManager=null)};this.QK=va;this.$=H;this.eo=Ba.a.eo(this.$);this.eo||(this.Yre=H.$h+"OfficeAddinLabel-Medium14");this.$.ka.Lh(29,ub=>{this.statusBarManager=ub;ub.DL(this)});this.$.ea.uq(this.Oi);this.QK.hxh(this.BLf);this.$.ka.Lh(206,ub=>{this.agaveCommandManager=ub;ub.Tyh(this.Wbf)})}Xx(H){this.addHandler("LAC",H)}Jx(H){this.removeHandler("LAC",
H)}hy(H,va){if("QueryAddinLabel"!==H)return!1;H=!1;this.eo?(H=appChrome.selectors.getControlLabel(uf.a.E5d),H=!(!H&&!this.QK.lFa)&&H!==this.QK.lFa):H=va[td.a.LabelText]!==this.QK.lFa;H&&(H=pe.W8j(this.QK),va[td.a.LabelText]=H.so,va[td.a.Visible]=H.visible,window.setTimeout(()=>{this.PXc()},0));return!0}Yq(){return!0}PXc(){if(this.$){if(this.eo){const H=document.querySelector('button[data-unique-id="StatusBar-OfficeAddinLabel"]');H&&(this.Yre=H.getElementsByClassName("ms-Button-label")[0].id)}this.Yre&&
pe.PXc(this.QK,this.$.domElement,this.Yre,Lc.a.instance.ia(333),Lc.a.instance.ia(334))}}dispose(){this.$.ea.pq(this.Oi);this.QK.Yhk(this.BLf);this.agaveCommandManager&&(this.agaveCommandManager.tjk(this.Wbf),this.agaveCommandManager=null);this.statusBarManager&&(this.statusBarManager.$I(this),this.statusBarManager=null);this.QK=this.$=null;super.dispose()}}Object(I.a)(zf,"AddinCommandsStatusBarManager",oj.a,[161,162]);class bg{constructor(){this.Ver=1}}Object(I.a)(bg,"CacheItem",null,[]);class kg{constructor(H){this.MDa=
H}zn(H){const va=this.MDa.getItem(H);if(va){let ub=new bg;try{ub=Sys.Serialization.JavaScriptSerializer.deserialize(va,!0)}catch(kc){return this.MDa.removeItem(H),null}return ub.Data?ub.Data:ub.data}return null}btb(H){this.MDa.removeItem(H)}}Object(I.a)(kg,"AppsDataCacheManager",null,[401]);class ug{constructor(){this.wbg=new Set;new kg(Y.a.instance)}sKg(H,va){H=ha.a.PDf()+H;Y.a.instance.setItem(H,va.toString())}dRi(){var H=ha.a.zHf();sa.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",H);H=
Y.a.instance.getItem(H);return Fe.a(H)}pCk(H){const va=ha.a.zHf();sa.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",va);Y.a.instance.setItem(va,Fe.c(H))}HBk(H){this.wbg=H}Zkj(){return!!Y.a.instance.localStorage}static get instance(){ug.Wa||(ug.Wa=new ug);return ug.Wa}}ug.Wa=null;Object(I.a)(ug,"AddInCommandsCacheManager",null,[361]);class Gg{constructor(H){this.Ga=H}get host(){var H;const va=null===(H=this.Ga)||void 0===H?void 0:H.Xa("Application");return"Word"===va||"Excel"===va||"PowerPoint"===
va?va:""}get Bta(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFREButtonGroupExpEnabled",!1)}get CBh(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutOpenCloseTelemetryEnabled",!1)}get O1e(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinContextMenuShareButtonEnabled",!1)}get k0j(){return this.Ga?this.Ga.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizableFRECategoryIds",
""):""}get l0j(){return this.Ga?this.Ga.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizableFRECategoryNames",""):""}get j0j(){return this.Ga?this.Ga.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizableCategoryAddinIdsMapping",""):""}get I4b(){return!!this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8668457_SeeMoreSeeLessEnabled")}get x9(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchBoxEnabled",!1)}get YSh(){return!!this.Ga&&
this.Ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.CitationEnabled",!1)}get ABh(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFREScrollEnabled",!1)}get EBh(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchWithOmexEnabled",!1)}get DBh(){return this.Ga?this.Ga.getIntFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchRequestSentTimeoutMs",2E4):2E4}get m0j(){return this.Ga?this.Ga.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizableSearchQueryParameters",
""):""}get Ind(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutBannerInPopularEnabled",!1)}get Wda(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFRECarouselEnabled",!1)}get zBh(){return!!this.Ga&&this.Ga.getStringFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFREBannerAddins","")}get C7e(){return!!this.Ga&&"Dev Box"===this.Ga.Xa("StatusBarEnvironmentNameToUse")}get BBh(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFreeLabelExpEnabled",
!1)}get Jnd(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutRedDotExpEnabled",!1)}get Xkc(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutNotificationExpEnabled",!1)}get qwb(){return!!this.Ga&&this.Ga.isChangeGateEnabled("StoreDisabledErrorViewFixEnabled")}get a9b(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TriggerBackstageUIFixEnabeld",!1)}}Object(I.a)(Gg,"AppsFlyoutGeneratorContext",
null,[]);var ah;(function(H){H.LEFT="LEFT";H.cja="MIDDLE";H.RIGHT="RIGHT"})(ah||(ah={}));Object(I.b)("FRECarouselDirection",ah);const Qg=()=>({["APIC"]:Object(La.a)("AddInCategoryTitleAddingPicturesIconsAndCharts"),["APID"]:Object(La.a)("AddInCategoryTitleAddingPicturesIconsAndDiagrams"),["BBM"]:Object(La.a)("AddInCategoryTitleBuildByMicrosoft"),["CAIP"]:Object(La.a)("AddInCategoryTitleDesigningAnInteractivePresentation"),["DA"]:Object(La.a)("AddInCategoryTitleDataSyncAndAnalysis"),["DWT"]:Object(La.a)("AddInCategoryTitleDesigningWithTemplates"),
["ER"]:Object(La.a)("AddInCategoryTitleEducationalPurpose"),["FA"]:Object(La.a)("AddInCategoryTitleFinancialAnalytics"),["IPWAI"]:Object(La.a)("AddInCategoryTitleImprovingProductivityWithAI"),["TD"]:Object(La.a)("AddInCategoryTitleTrendingAddins"),["WN"]:Object(La.a)("AddInCategoryTitleNewAddins"),["WF"]:Object(La.a)("AddInCategoryTitleWritingFluently"),["PAIYO"]:Object(La.a)("AddInCategoryTitlePopularAddinsInYourOrg"),default:Object(La.a)("PopularAddins")}),Uh=()=>({["Word"]:{["IPWAI"]:Object(La.a)("AddInCategoryShortTitleImprovingProductivityWithAI")||
"Add-ins with AI",["WF"]:Object(La.a)("AddInCategoryShortTitleWritingFluently")||"Perfect your writing",["ER"]:Object(La.a)("AddInCategoryShortTitleEducationalResources")||"Education",["APID"]:Object(La.a)("AddInCategoryShortTitleAddingPicturesIconsDiagrams")||"Unlock your creativity"},["Excel"]:{["IPWAI"]:Object(La.a)("AddInCategoryShortTitleImprovingProductivityWithAI")||"Add-ins with AI",["APID"]:Object(La.a)("AddInCategoryShortTitleAddingPicturesIconsDiagrams")||"Unlock your creativity",["FA"]:Object(La.a)("AddInCategoryShortTitleFinancialAnalytics")||
"Manage your finances"},["PowerPoint"]:{["IPWAI"]:Object(La.a)("AddInCategoryShortTitleImprovingProductivityWithAI")||"Add-ins with AI",["APID"]:Object(La.a)("AddInCategoryShortTitleAddingPicturesIconsDiagrams")||"Unlock your creativity",["CAIP"]:Object(La.a)("AddInCategoryShortTitleCreatingAnInteractivePresentation")||"Elevate your presentations",["DWT"]:Object(La.a)("AddInCategoryShortTitleDesigningWithTemplates")||"Templates"},vOg:{["BBM"]:Object(La.a)("AddInCategoryShortTitleBuildByMicrosoft")||
"Built by Microsoft",["TD"]:Object(La.a)("AddInCategoryShortTitleTrending")||"Trending",["WN"]:Object(La.a)("AddInCategoryShortTitleWhatsNew")||"Just released",["PAIYO"]:Object(La.a)("AddInCategoryShortTitlePopularAddinsInYourOrg")||"Popular"}});class vh{constructor(H){this.dhd=H}next(H){this.dhd=(9301*this.dhd+49297)%233280;return Math.floor(this.dhd/233280*H)}}Object(I.a)(vh,"Random",null,[]);class X{constructor(H){this.ON=H;this.l_d=new Set;this.cdb=[];this.sBh=ug.instance;this.context=new Gg(P.AFrameworkApplication.fa)}OBj(H){(this.context.Jnd||
this.context.Xkc)&&this.cdb.includes(H)&&(this.l_d.add(H),H={["solutionId"]:[t(this.ON.EX(H))],["IsUpgraded"]:this.ON.getUpgradedAddinsOfOmex().has(H).toString()},this.i6a(H,"ClickNotificationAddins"))}XBi(H){const va=this.ON.getUpgradedAddinsOfOmex(),ub=this.sBh.wbg,kc=H.filter(Oc=>ub.has(Oc)&&!this.l_d.has(Oc));H=H.filter(Oc=>va.has(Oc)&&!this.l_d.has(Oc));return{pCh:kc,C7k:H}}addNotification(H){if(this.context.Jnd||this.context.Xkc){var {pCh:va,C7k:ub}=this.XBi(H.map(kc=>kc.solutionId));this.cdb=
[];this.context.Jnd&&(b(ub),this.cdb.push(...ub));this.context.Xkc&&(b(ub),this.cdb.push(...ub),f(va),this.cdb.push(...va));0!==this.cdb.length&&(H={["Upgraded"]:ub.map(kc=>t(this.ON.EX(kc))),["AdminInstalled"]:this.context.Xkc?va.map(kc=>t(this.ON.EX(kc))):[]},this.i6a(H,"ShowNotificationAddins"))}}i6a(H,va){Bc.a.sendTelemetryEvent(Object.assign(new Ob.a,{name:`Office.Extensibility.Host.${va}`,dataFields:zc.a.rn(H)}))}}Object(I.a)(X,"AppsInFlyoutNotificationManager",null,[]);var jb=a(1094),Pb=a(1411),
ed=a(130),zd=a(665),be=a(143);class we{constructor(){this.Zcb=null}setErrorMessageForAddin(H,va){this.Zcb||(this.Zcb={});this.Zcb[H]=va}MIi(H){return this.Zcb&&H in this.Zcb?this.Zcb[H]:null}}Object(I.a)(we,"AddinCommandsErrorManager",null,[]);var ef=a(113);class vf{constructor(){this.hA=this.Iza=0;this.Gnd=null;this.HQc=this.N_c=0;this.LCa=this.H9c=this.R4c=null}get Ukc(){this.R4c||(this.R4c=new pf.a);return this.R4c}get zGd(){this.H9c||(this.H9c=new pf.a);return this.H9c}get eWa(){this.LCa||(this.LCa=
new pf.a);return this.LCa}}Object(I.a)(vf,"AddinCommandsListLoaderContext",null,[]);class Jf{constructor(H,va){this.entitlement=H;this.metadata=va}H8b(){var H=this.entitlement;const va={};va.solutionId=H.solutionId;va.version=H.version;va.storeType=H.storeType;va.storeId=H.storeId;va.assetId=H.assetId;va.assetStoreId=H.assetStoreId;va.targetType=H.targetType;va.requireConsent=H.requireConsent||!1;va.isAddinCommands=!0;va.addinCommandsActionType=0;va.targetType=this.targetType;return va}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==
this.entitlement.targetType?this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}Object(I.a)(Jf,"AddinEntitlementEx",null,[]);var yg=a(294),Pg=a(374);class Wg{}Object(I.a)(Wg,"AppsForOfficeEntitlementQueryInfo",null,[]);class ch{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(I.a)(ch,"AddinAbstract",null,
[]);class yh extends Sys.EventArgs{constructor(){super();this.qw=this.Jr=null}}Object(I.a)(yh,"InsertionParamEventArgs",Sys.EventArgs,[]);class A{constructor(H,va,ub,kc){this.aZa=Oc=>{let pd=!1,Sd=null;try{if(0<Oc.data.responseData.length){const Wd=Object(Da.a)(Object,Fe.a(Oc.data.responseData)),ee=Wd?Wd[this.appName]:null;ee&&(Sd=Object(Da.a)(Object,Fe.a(ee.toString())))}pd=!0}catch(Wd){this.ywa(null)}pd&&this.fBb&&this.fBb(Sd)};this.ywa=Oc=>{this.bBb&&this.bBb(Oc?Oc.data:null)};this.Eza=Oc=>{this.rDb&&
this.rDb(Oc?Oc.data:null)};this.g4b=P.AFrameworkApplication.fa.Xa("RoamingServiceHandlerWebServiceBase");this.appName=H;this.fBb=va;this.bBb=ub;this.rDb=void 0===kc?null:kc}zDd(H){this.bri(H,this.aZa,this.ywa)}bri(H,va,ub){const kc=new Sys.StringBuilder(this.g4b);kc.append("RoamingServiceHandler.ashx?action=");kc.append("getAddinTeachingCalloutSettings");kc.append("&");kc.append(this.oLd(H));kc.append("&");kc.append(P.AFrameworkApplication.qo);P.AFrameworkApplication.$i.Ou(kc.toString(),1,null,null,
!0,2,va,ub,null)}svc(H){this.gri(H)}gri(H){var va=new Sys.StringBuilder(this.g4b);va.append("RoamingServiceHandler.ashx?action=");va.append("saveAddinTeachingCalloutSettings");va.append("&");va.append(P.AFrameworkApplication.qo);va=va.toString();H=Fe.c(H);P.AFrameworkApplication.$i.Ou(va,2,H,null,!0,4,null,this.Eza,null)}oLd(H){const va=new Sys.StringBuilder("requestedsettings=");for(let ub=0;ub<H.count;ub++)va.append(H.ma(ub)),ub<H.count-1&&va.append(";");return va.toString()}}Object(I.a)(A,"AddinTeachingUIRoamingRequestHandler",
null,[]);class ja extends Sys.EventArgs{constructor(H){super();this.solutionId=H.solutionId;this.assetId=H.assetId;this.storeType=H.storeType;this.storeId=H.storeId;this.assetStoreId=H.assetStoreId;this.targetType=H.targetType;this.width=H.width;this.height=H.height;this.displayName=H.displayName;this.version=H.version}}Object(I.a)(ja,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);class Ua{constructor(H){this.adb=this.Jr=null;this.gUc=!1;this.LCa=this.Cac=this.opa=this.wl=this.V4c=
this.aub=null;this.LSj=()=>{const va=new yg.ScriptSharpLegacyMap;this.adb&&this.adb.tabs&&!this.adb.tabs[0].isOfficeTab&&va.ga("SDX.FeatureFlags","NonOfficeTab");this.Eob(Ua.wwa(this.Jr),"ClickOnLaunch",va);this.CKc();this.adb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.adb,()=>{const ub=new yh;ub.Jr=this.Jr;this.Og.raiseEvent(ha.a.g3f,ub)}):sa.ULS.sendTraceTag(508625355,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")};this.ULj=()=>{this.Eob(Ua.wwa(this.Jr),
"ClickOnClose");this.CKc()};this.CNj=()=>{this.Eob(Ua.wwa(this.Jr),"ClickOnDismiss");this.CKc()};this.seg=va=>{if(va&&(va=va.detail)&&va.id&&this.ffj(va.id)){const ub=(va.action||"").toLowerCase();if(va.success&&"opened"===ub)this.Eob(Ua.wwa(this.Jr),"CampaignLaunched"),sa.ULS.sendTraceTag(508625354,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.CKc(),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",this.seg,!0);else{let kc;try{kc=JSON.stringify(va),
sa.ULS.sendTraceTag(508625353,220,15,"Campaign launch failure. Event:"+kc)}catch(Oc){kc="id : "+va.id+" telemetryEventName: "+va.telemetryEventName,sa.ULS.sendTraceTag(508625352,220,50,"Error serializing campaign event. "+kc+" Error: "+(Oc?Oc.toString():""))}}}};this.aZa=va=>{va?this.zJk(va)?(sa.ULS.sendTraceTag(508625348,220,50,"should show teaching UI"),this.aub="AddinHasShown"in va&&va.AddinHasShown?va.AddinHasShown.toString():null,this.oef()):(sa.ULS.sendTraceTag(508625347,220,50,"Not Show TeachingUI this time"),
this.opa(this.kFa,null)):(sa.ULS.sendTraceTag(508625349,220,50,"userSettings is null"),this.aub=null,this.oef())};this.ywa=va=>{sa.ULS.sendTraceTag(508625346,220,10,"GET data from Roaming Settings Service with status: {0}, fallback",va?va.httpStatus:-1);this.opa(this.kFa,null)};this.Eza=va=>{sa.ULS.sendTraceTag(508625345,220,10,"failed to POST data to Roaming Settings Service with status: {0}",va?va.httpStatus:-1)};this.Og=H}get appName(){return P.AFrameworkApplication.fa.Xa("WebAppShortName")}get AGb(){this.V4c||
(this.V4c=new A(this.appName,this.aZa,this.ywa,this.Eza));return this.V4c}get kFa(){this.Cac||(this.Cac=new pf.a);return this.Cac}set kFa(H){this.Cac=H}get eWa(){this.LCa||(this.LCa=new pf.a);return this.LCa}set eWa(H){this.LCa=H}huh(H,va){window.addEventListener?(this.Jr=H,this.adb=va,window.addEventListener("LaunchAddinTaskpane",this.LSj,!0),window.addEventListener("DismissCallout",this.CNj,!0),window.addEventListener("CloseCallout",this.ULj,!0),window.addEventListener("FGWebSurfaceEvent",this.seg,
!0)):sa.ULS.sendTraceTag(508625357,220,15,"AddEventListenerForTeachingCallout failed to get Window")}l8a(H,va,ub,kc){this.wl=H;this.kFa=va;this.eWa=ub;this.opa=kc;sa.ULS.sendTraceTag(508625356,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",va?va.count.toString():"null",ub?ub.count.toString():"null");0<this.kFa.count||0<this.eWa.count?(H=new pf.a,H.add(this.appName),this.AGb.zDd(H)):this.opa(new pf.a,null)}ffj(H){H=sb.a.Rr(H);return-1!==
H.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==H.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==H.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==H.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==H.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==H.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}zUc(H){if(this.appName){const va={},ub={};ub.LastTeachingUIShowTime=(new Date).toUTCString();ub.AddinHasShown=H;va[this.appName]=Fe.c(ub);this.AGb.svc(va);sa.ULS.sendTraceTag(508625351,
220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else sa.ULS.sendTraceTag(508625350,220,10,"Fail to save roaming service since AppName is null")}CKc(){if(!this.gUc){const H=window.g_roamingAddinList;H&&(this.zUc(H),this.gUc=!0)}}oef(){const H=this.wai();0===H.targetType?(H.solutionId?this.R8j(H):this.Eob(null,"NoSolutionId"),this.r3g(H),this.opa(this.kFa,null)):this.opa(this.kFa,H);sa.ULS.sendTraceTag(508625344,220,50,"Show teaching callout for: {0}",
H.addinId)}R8j(H){const va=new Wg;va.callbackFunc=ub=>{if(ub.errorCode){this.Eob(H.solutionId,"FailToGetAppDetails");var kc=window.g_roamingAddinList;kc&&this.zUc(kc)}else if(ub.value)for(kc of ub.value)if(ub=kc[1],ub===H.solutionId){const Oc={};Oc.solutionId=ub;Oc.assetId=kc[5];Oc.storeType=kc[12];Oc.storeId=kc[11];Oc.assetStoreId=kc[6];Oc.targetType=kc[3];Oc.width=kc[7];Oc.height=kc[8];Oc.displayName=kc[0];Oc.version=kc[4];sa.ULS.sendTraceTag(508625315,220,50,"Raise a teaching callout event for content addin: {0}.",
H.solutionId);kc=new ja(Oc);this.Og.raiseEvent(ha.a.LQg,kc);break}};va.storeType=OSF.StoreTypeEnum.PrivateCatalog;va.fromInsertDialog=!1;va.refresh=!1;this.wl.queryEntitlementDetails(va)}zJk(H){if("LastTeachingUIShowTime"in H){if(H=+new Date-+new Date(H.LastTeachingUIShowTime.toString()),H<P.AFrameworkApplication.fa.JO("AddinShowTeachingUIIntervalInMS",864E5))return sa.ULS.sendTraceTag(508625314,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",H),!1}else sa.ULS.sendTraceTag(508625313,
220,50,"userSetting has no date key");return!0}wai(){let H=new Pg.a(new ch,0),va=new Pg.a(new ch,0),ub=0,kc=0,Oc=0;var pd=new pf.a;for(var Sd of this.kFa)pd.add(Sd);for(const Wd of this.eWa)pd.add(Wd);for(const Wd of pd)if(!("excatalog"!==Wd.storeType||bc.c(Wd.installTimeInMS)||!Wd.installTimeInMS||Wd.installTimeInMS<=P.AFrameworkApplication.fa.JO("DateTimeInMSForNewAddin",16409952E5))){pd=Ua.DAf(Wd);if(this.aub&&(Sd=this.aub.split(","),0<Sd.length&&Array.contains(Sd,pd))){Oc++;sa.ULS.sendTraceTag(508625312,
220,50,"This addin has shown teaching UI before");continue}pd.startsWith("private_")?(H=Ua.wFf(Wd,H),kc++):(va=Ua.wFf(Wd,va),ub++)}sa.ULS.sendTraceTag(508625311,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",kc,ub,Oc);return 0<va.value?va.key:0<H.value?H.key:Object.assign(new ch,{addinId:null,targetType:-1,solutionId:null})}Eob(H,va,ub){ub=void 0===ub?null:ub;H={["AppTeachingUICalloutAction"]:va,["SDX.Id"]:H,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};if(ub)for(const kc of ub.keys)H[kc]=ub.ma(kc);Bc.a.sendTelemetryEvent(Object.assign(new Ob.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:zc.a.rn(H)}))}r3g(H){H&&(window.g_roamingAddinList=this.aub?this.aub+","+H.addinId:H.addinId)}static wwa(H){return Telemetry.PrivacyRules.GetPrivacyCompliantId(H.solutionId,H.storeType,H.assetId,null,null,H.storeId)}static wFf(H,va){return va.value<H.installTimeInMS?new Pg.a(Object.assign(new ch,{addinId:Ua.DAf(H),
targetType:H.targetType,solutionId:H.solutionId}),H.installTimeInMS):va}static DAf(H){return Telemetry.PrivacyRules.IsPrivateAddin(H.storeType,H.assetId,null,null,H.storeId)?"private_"+H.installTimeInMS:H.solutionId}}Object(I.a)(Ua,"PrivateCatalogTeachingCalloutHandler",null,[]);const ac=()=>{const H=bj.a.Pfa(window.location.href.toLowerCase(),"wdomexsrctype");return!!H&&"4"===H},Ec=()=>bj.a.Pfa(window.location.href.toLowerCase(),"wdtpl"),gd=()=>{const H=bj.a.Pfa(window.location.href.toLowerCase(),
"wdomexsrctype");return!!H&&"1"===H};var ad=a(1031);class Jd extends Sys.EventArgs{constructor(H){super();this.properties=H}}Object(I.a)(Jd,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);class De{constructor(H,va,ub){this.Og=new ef.a;this.context=new vf;this.Sid=null;this.sSj=(kc,Oc,pd,Sd)=>{kc?(kc=new Jf(pd.targetData,Sd),Oc&&this.context.Ukc.add(kc),10===this.context.Iza&&(this.context.zGd.add(kc),0===kc.targetType&&this.context.eWa.add(kc))):(Oc=pd.targetData,sa.ULS.sendTraceTag(542978528,
220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Oc.solutionId,Oc.storeType,Oc.assetId,null,null,Oc.storeId),Oc.storeType));this.X5d()};this.contextActivationMgr=H;this.wBh=va;this.wGb=ub;this.appName=P.AFrameworkApplication.fa.Xa("WebAppShortName")}get Ewb(){this.Sid||(this.Sid=new Ua(this.Og));return this.Sid}fxh(H){this.Og.addHandler(ha.a.M1e,H)}RAh(H){this.Og.addHandler(ha.a.LQg,H)}q0k(H){null!==H&&(this.context.Iza=H[ha.a.w9],this.context.hA=
H[ha.a.v3],this.context.N_c=this.context.HQc=0,H=ha.a.jUa in H?H[ha.a.jUa]:0,-1!==this.context.Iza&&0!==this.context.hA&&(this.context.Gnd=this.wBh.createAddinDataProvider(ad.a(this.context.Iza),this.contextActivationMgr),this.context.Gnd?this.context.Gnd.getEntitlementsAsync(this.contextActivationMgr.Soa,!0,H,va=>{this.WSj(va)}):sa.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.Iza)))}WSj(H){if(H&&0<H.length){this.context.N_c=H.length;const ub=Ec();for(let kc=
0;kc<H.length;kc++){const Oc=H[kc];if(gd()&&Oc&&Oc.storeType&&"omex"===Oc.storeType.toLowerCase()&&Oc.assetId&&ub&&Oc.assetId.toLowerCase()===ub.toLowerCase()){var va={["SDX_AppInstallOrigin"]:"DeeplinkUser",["SDX_Id"]:De.wwa(Oc)};Bc.a.sendTelemetryEvent(Object.assign(new Ob.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:zc.a.rn(va)}))}!Oc||1!==Oc.targetType&&-1!==Oc.targetType?this.X5d():(va={},P.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?
(va.solutionId=Oc.solutionId,va.version=Oc.version):(va.marketplaceId=Oc.solutionId,va.marketplaceVersion=Oc.version),va.storeType=Oc.storeType,va.storeId=Oc.storeId,va.targetData=Oc,this.contextActivationMgr.isAddinCommandsExAsync(va,this.sSj))}}else this.X5d()}X5d(){var H;(H=this.context).HQc=H.HQc+1;this.context.HQc>=this.context.N_c&&(this.wGb.sKg(this.context.Iza,!1),0<this.context.N_c&&10===this.context.Iza&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(H=!1,
ac()&&(H=this.fxj(this.context.zGd)),this.swj(this.context.zGd),H?this.opa(this.nef(this.context.Ukc)):this.Ewb.l8a(this.contextActivationMgr,this.context.Ukc,this.context.eWa,(va,ub)=>{const kc=new pf.a;for(const Oc of va)va=Oc.H8b(),ub&&ub.solutionId===Oc.solutionId&&(va.showCallout=!0,this.Ewb.r3g(ub)),kc.add(va);this.opa(kc)})):this.opa(this.nef(this.context.Ukc)))}nef(H){const va=new pf.a;if(H)for(const ub of H)va.add(ub.H8b());return va}opa(H){H&&H.count||Qb.a.IPa(ha.a.Fnd,"false",this.context.Iza);
H={["ack2"]:H};H[ha.a.w9]=this.context.Iza;H[ha.a.v3]=this.context.hA;this.Og.raiseEvent(ha.a.M1e,new Jd(H),this)}fxj(H){let va=!1;if(H&&1>H.count)return va;const ub=Ec();if(!ub)return va;for(const kc of H)if(kc.storeId&&kc.storeId.toLowerCase()===ub.toLowerCase()||kc.assetId&&kc.assetId.toLowerCase()===ub.toLowerCase())H={["SDX_Id"]:De.yHf(kc),["SDX_TargetType"]:bc.c(kc.targetType)?"":kc.targetType.toString()},Bc.a.sendTelemetryEvent(Object.assign(new Ob.a,{name:"Office.Extensibility.Host.EmailAlertNotification",
dataFields:zc.a.rn(H)})),va=!0;return va}swj(H){if(!(H&&1>H.count))if(this.wGb.Zkj()){var va=this.wGb.dRi();va?(H=this.KCf(H,va),sa.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(H=this.KCf(H,null),sa.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.wGb.pCk(H)}else sa.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}KCf(H,va){const ub={};let kc=!1;const Oc=new Set;for(const pd of H)if(H=De.yHf(pd))!va||H in va||(Oc.add(pd.solutionId),this.mE(pd,
H),sa.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===H.toLowerCase()?kc||(kc=!0,ub[H]=null):ub[H]=null;this.wGb.HBk(Oc);return ub}mE(H,va){var ub=H.installTimeInMS?(new Date(H.installTimeInMS)).toISOString():"";ub={["SDX.Id"]:va,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:bc.c(H.targetType)?"":H.targetType.toString(),["SDX.AdminDeploymentTime"]:ub};Bc.a.sendTelemetryEvent(Object.assign(new Ob.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:zc.a.rn(ub)}));
1===H.targetType&&(H={["SDX.Id"]:va,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},Bc.a.sendTelemetryEvent(Object.assign(new Ob.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:zc.a.rn(H)})))}static wwa(H){return Telemetry.PrivacyRules.GetPrivacyCompliantId(H.solutionId,H.storeType,H.assetId,null,null,H.storeId)}static yHf(H){return Telemetry.PrivacyRules.GetPrivacyCompliantId(H.solutionId,H.storeType,H.assetId,null,null,H.storeId)}}Object(I.a)(De,"AddInCommandsListLoader",
null,[]);class Xe{constructor(H){this.umh=H}get Soa(){return this.umh}insertOsfControl(H){return this.Soa.insertOsfControl(H)}getManifestInvaildErrorString(){return this.Soa.getManifestInvaildErrorString()}isAddinCommandsAsync(H,va){this.Soa.isAddinCommandsAsync(H,va)}isAddinCommandsExAsync(H,va){this.Soa.isAddinCommandsExAsync(H,va)}ownerAddinControlRecreated(H,va){this.Soa.ownerAddinControlRecreated(H,va)}queryEntitlementDetails(H){this.Soa.queryEntitlementDetails(H)}}Object(I.a)(Xe,"ContextActivationMgrWrapper",
null,[382]);class lf{createAddinDataProvider(H,va){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(H,va.Soa)}static get instance(){lf.Wa||(lf.Wa=new lf);return lf.Wa}}lf.Wa=null;Object(I.a)(lf,"OSFAddinDataProviderFactory",null,[380]);class mf{constructor(H,va,ub,kc,Oc,pd){this.hA=H;this.Jr=va;this.Mba=ub;this.displayName=Oc;this.d2f=pd}}Object(I.a)(mf,"PostLaunchAddinCommandsParameters",null,[]);class Rf{constructor(H){this.ecd=null;this.NKe=H}get x1a(){return this.ecd}Jcb(H,va){this.NKe.Jcb(H,
void 0===va?null:va);this.ecd=H}Kfe(H){this.NKe.Kfe(H)}qMg(H){this.ecd=H}}Object(I.a)(Rf,"RibbonExtensibilityManagerWithChangeDetection",null,[404]);var sg=a(1060),wg=a(106);class Mg{static QEf(H){const va=new pf.a;if(Mg.Xdf)for(var ub of Mg.Xdf)va.add(ub);ub=null;switch(H){case "Workbook":ub=Mg.hbl;break;case "Document":ub=Mg.ydi;break;case "Presentation":ub=Mg.z6j}if(ub)for(const kc of ub)va.add(kc);return va}}Mg.Xdf=["PrimaryCommandSurface","ContextMenu"];Mg.hbl=null;Mg.ydi=null;Mg.z6j=null;Object(I.a)(Mg,
"ExtensionPointType",null,[]);class Sg{constructor(H){this.nQe=null;if(bc.c(H))throw sa.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.odh=H}get CZb(){return this.nQe||(this.nQe=new pf.a)}get t2e(){return this.odh}}Object(I.a)(Sg,"ContextMenuExtensibility",null,[385]);class Qi{constructor(H,va,ub){va=void 0===va?null:va;ub=void 0===ub?0:ub;if(bc.c(H))throw sa.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),
Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.nmh=H;this.Eph=va;this.cih=ub}get G6(){return this.nmh}get startedNode(){return this.Eph}get lBi(){return this.cih}}Object(I.a)(Qi,"RibbonExtensibility",null,[432]);class ci{constructor(H){this.dhh=H.entitlement}get entitlement(){return this.dhh}createActionContext(H,va){H={};H.ownerAddinInfo=this.entitlement;H.action=va;return H}}Object(I.a)(ci,"AddInCommandsContextProvider",null,[]);class hj{constructor(H,va,
ub){this.BDe=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=H;this.eventBuilder=va;this.contextMenuBuilder=ub}get addinInfo(){return this.BDe}v1h(H){return new ci(H)}createActionBuilder(H,va){return OfficeExt.DefaultControlActionBinder.createActionBuilder(H,va.entitlement,va.manifest)}startApplyAddin(H){this.BDe=H;const va=this.v1h(H);this.actionBuilder=this.createActionBuilder(va,H)}endApplyAddin(){}cHd(H,va,ub){ub=void 0===
ub?0:ub;return this.ribbonBuilder.NB&&0<this.ribbonBuilder.NB.count?new Qi(this.zAi(H,va),this.addinInfo.startedNode,ub):null}Mzf(){var H=void 0===H?null:H;if(this.contextMenuBuilder.UKc&&0<this.contextMenuBuilder.UKc.count){H||(H=this.addinInfo.entitlement.solutionId);H=new Sg(H);for(const va of this.contextMenuBuilder.UKc)H.CZb.add(va);return H}return null}zAi(H,va){return this.ribbonBuilder.NB&&0<this.ribbonBuilder.NB.count?new Oi.a(this.ribbonBuilder.NB,H,va):null}}Object(I.a)(hj,"AddinCommandsBuilder",
null,[]);class nk{constructor(H,va,ub,kc,Oc,pd,Sd){this.D7a=new wg.a;this.hA=H;this.wl=va;this.qx=ub;this.ribbonManager=kc;this.contextMenuManager=Oc;this.QK=pd;this.zta=Sd;this.mZ=P.AFrameworkApplication.ra.cL}bXb(H,va,ub,kc,Oc,pd,Sd){const Wd=(ee,je,Ue,G)=>{Oc(ee,je,Ue,G);const da=sg.a[this.hA]+je.assetId;let $a;(()=>{let Sb=this.D7a.gj(da);({value:$a}=Sb);return Sb})().returnValue&&($a.stop(),$a=null,this.D7a.remove(da))};if(0!==this.hA&&H){sa.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",
H.count);4===this.hA&&(sa.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",kc)),this.lTh(H,kc),pd());for(const ee of H)if(H=ee,sa.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.qx.QX,Telemetry.PrivacyRules.GetPrivacyCompliantId(H.solutionId,H.ownerAddinStoreType||H.storeType,H.assetId,null,null,H.storeId))),this.w5g(H))if(Sd&&H.requireConsent)Sd(H,je=>{try{if(this.mZ){const G=sg.a[this.hA]+je.solutionId,da=this.mZ.vi("ComponentAttach",
G);this.D7a.ga(G,da)}const Ue=this.QK.Iva(je.storeType,je.solutionId);6!==this.hA&&(Ue&&(this.Hoc(Ue),Ue.EK.purge(!1)),this.wl.insertOsfControl(this.o1b(je,va,ub,Wd)),Ue&&this.wl.ownerAddinControlRecreated(je.solutionId,je.storeType))}catch(Ue){sa.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.qx.QX,Telemetry.PrivacyRules.GetPrivacyCompliantId(je.solutionId,je.ownerAddinStoreType||
je.storeType,je.assetId,null,null,je.storeId),je.version,je.storeType,je.storeId,Ue.message)),Wd(!1,je,null,null)}});else try{if(this.mZ){const Ue=sg.a[this.hA]+H.solutionId,G=this.mZ.vi("ComponentAttach",Ue);this.D7a.ga(Ue,G)}const je=this.QK.Iva(H.storeType,H.solutionId);!P.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8475191_OSFAddinLaunchRefactor")||3!==P.AFrameworkApplication.ra.$d.Om&&1!==P.AFrameworkApplication.ra.$d.Om&&2!==P.AFrameworkApplication.ra.$d.Om||3!==this.hA||"excatalog"===
H.storeType||!je||je.isUpgraded?6!==this.hA&&(je&&(this.Hoc(je),je.EK.purge(!1)),this.wl.insertOsfControl(this.o1b(H,va,ub,Wd)),je&&this.wl.ownerAddinControlRecreated(H.solutionId,H.storeType)):(this.ribbonManager.qMg(je.qw),Wd(!0,H,null,je.displayName))}catch(je){sa.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.qx.QX,Telemetry.PrivacyRules.GetPrivacyCompliantId(H.solutionId,
H.ownerAddinStoreType||H.storeType,H.assetId,null,null,H.storeId),H.version,H.storeType,H.storeId,je.message)),Wd(!1,H,null,null)}else Wd(!1,H,null,null)}}ktj(H,va,ub,kc,Oc,pd){const Sd=(Wd,ee,je,Ue)=>{pd(Wd,ee,je,Ue);const G=sg.a[this.hA]+ee.solutionId;let da;(()=>{let $a=this.D7a.gj(G);({value:da}=$a);return $a})().returnValue&&(da.stop(),da=null,this.D7a.remove(G))};if(6===this.hA&&H)if(sa.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.qx.QX,Telemetry.PrivacyRules.GetPrivacyCompliantId(H.solutionId,
H.ownerAddinStoreType||H.storeType,H.assetId,null,null,H.storeId))),this.w5g(H))try{if(this.mZ){const ee=sg.a[this.hA]+H.solutionId,je=this.mZ.vi("ComponentAttach",ee);this.D7a.ga(ee,je)}const Wd=this.QK.Iva(H.storeType,H.solutionId);Wd||Sd(!1,H,null,null);P.AFrameworkApplication.ra&&P.AFrameworkApplication.ra.$d.delayInstallAddInIsEnabled?this.sAf(H,va,kc,Oc,ub,ee=>{Sd(ee,H,ub,Wd.displayName)}):(this.sAf(H,va,kc,Oc,ub),Sd(!0,H,ub,Wd.displayName))}catch(Wd){sa.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",
this.qx.QX,Telemetry.PrivacyRules.GetPrivacyCompliantId(H.solutionId,H.ownerAddinStoreType||H.storeType,H.assetId,null,null,H.storeId),H.version,H.storeType,H.storeId,Wd.message)),Sd(!1,H,null,null)}else Sd(!1,H,null,null)}PJj(H,va,ub,kc,Oc,pd){if(pd)if(pd._isAddinCommandsManifest(this.qx.QX))try{P.AFrameworkApplication.ra&&P.AFrameworkApplication.ra.$d.delayInstallAddInIsEnabled?this.rAf(H,va,ub,Oc,pd,Sd=>{kc(Sd,H,pd,pd.getDefaultDisplayName())}):(this.rAf(H,va,ub,Oc,pd),kc(!0,H,pd,pd.getDefaultDisplayName()))}catch(Sd){sa.ULS.sendTraceTag(17586257,
220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.qx.QX,Telemetry.PrivacyRules.GetPrivacyCompliantId(H.solutionId,H.ownerAddinStoreType||H.storeType,H.assetId,null,null,H.storeId),H.version,H.storeType,H.storeId,Sd.message)),kc(!1,H,pd,pd.getDefaultDisplayName())}else sa.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",
this.qx.QX,Telemetry.PrivacyRules.GetPrivacyCompliantId(H.solutionId,H.ownerAddinStoreType||H.storeType,H.assetId,null,null,H.storeId),H.version,H.storeType,H.storeId)),kc(!1,H,null,null);else sa.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.qx.QX,Telemetry.PrivacyRules.GetPrivacyCompliantId(H.solutionId,H.ownerAddinStoreType||H.storeType,H.assetId,null,null,H.storeId),H.version,H.storeType,H.storeId)),
kc(!1,H,null,null)}o1b(H,va,ub,kc){const Oc={},pd=document.createElement("div");pd.setAttribute("visible","false");Oc.div=pd;Oc.id=H.solutionId;Oc.solutionId=H.solutionId;Oc.version=H.version;Oc.storeType=H.storeType;Oc.storeId=H.storeId;Oc.assetId=H.assetId;Oc.assetStoreId=H.assetStoreId;Oc.isvirtualOsfControl=!0;Oc.virtualOsfControlActivationCallback=(Sd,Wd)=>{const ee=this.QK.Iva(H.storeType,H.solutionId);ee&&(ee.isUpgraded&&(H.isUpgraded=!0),this.Hoc(ee));this.PJj(H,va,ub,kc,Sd,Wd)};Oc.reason=
3===this.hA?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;return Oc}rAf(H,va,ub,kc,Oc,pd){pd=void 0===pd?null:pd;const Sd={};Sd.solutionId=kc.getSolutionId();Sd.version=kc.getVersion();Sd.storeType=kc.getStoreType();Sd.storeId=kc.getStoreId();Sd.assetId=kc.getAssetId();Sd.assetStoreId=kc.getAssetStoreId();Sd.targetType=kc.getOsfControlType();let Wd=null,ee=null;if(P.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1))Wd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.qx.QX,this.qx.formFactor)).parseExtensions(Sd,Oc,this.zta),ee=Mg.QEf(this.qx.QX);else try{Wd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.qx.QX,this.qx.formFactor)).parseExtensions(Sd,Oc,this.zta),ee=Mg.QEf(this.qx.QX)}catch(Ue){throw sa.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+Ue.message),Ue;}if(ee&&0<ee.count){if(P.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1)){var je=va(H);va=ub(H);ub=!!P.AFrameworkApplication.fa&&P.AFrameworkApplication.fa.la("AddinCommandsMultipleCustomTabsEnabled");je=new hj(je,null,va);for(const Ue of ee)je.commandSurface=Ue,Wd.apply(je,this.zta,ub)}else try{const Ue=va(H),G=ub(H),da=!!P.AFrameworkApplication.fa&&P.AFrameworkApplication.fa.la("AddinCommandsMultipleCustomTabsEnabled");je=new hj(Ue,null,G);for(const $a of ee)je.commandSurface=$a,Wd.apply(je,this.zta,da)}catch(Ue){throw sa.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+
Ue.message),Ue;}if(OSF.OUtil.checkFlight(14))try{const Ue=je.cHd(H.solutionId,Oc.getDefaultDisplayName()),G=je.Mzf();Ue&&this.ribbonManager.Jcb(Ue,pd);G&&this.contextMenuManager.DZe(G);this.QK.l_e(kc,Ue,G,Oc.getDefaultDisplayName());sa.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",Oc.getDefaultDisplayName())}catch(Ue){throw OfficeExt.DevConsole.log(Ue),sa.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+Ue.message),Ue;}else try{const Ue=je.cHd(H.solutionId,
Oc.getDefaultDisplayName()),G=je.Mzf();Ue&&this.ribbonManager.Jcb(Ue);G&&this.contextMenuManager.DZe(G);this.QK.l_e(kc,Ue,G,Oc.getDefaultDisplayName());sa.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",Oc.getDefaultDisplayName())}catch(Ue){throw sa.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+Ue.message),Ue;}}}sAf(H,va,ub,kc,Oc,pd){pd=void 0===pd?null:pd;const Sd={};Sd.solutionId=H.solutionId;Sd.version=H.version;Sd.storeType=H.storeType;Sd.storeId=
H.storeId;Sd.assetId=H.assetId;Sd.assetStoreId=H.assetStoreId;Sd.targetType=H.targetType;const Wd=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.qx.QX,this.qx.formFactor);try{const ee=va.getManifest(),je=Wd.parse(Sd,ee,Oc,this.zta,va.getSharedRuntimeId(),va),Ue=ub(H),G=kc(H),da=new hj(Ue,null,G);da.commandSurface="PrimaryCommandSurface";je.apply(da,this.zta,!0);if(da.ribbonBuilder.NB&&0<da.ribbonBuilder.NB.count){const $a=da.cHd(H.solutionId,va.getManifest().getDefaultDisplayName(),1);P.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",
!1)?this.ribbonManager.Jcb($a,pd):$a&&this.ribbonManager.Jcb($a,pd);this.QK.avh(va,$a,Oc,va.getManifest().getDefaultDisplayName());sa.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",va.getManifest().getDefaultDisplayName())}}catch(ee){sa.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",va.getManifest().getDefaultDisplayName(),ee.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(ee)}}Hoc(H){H.qw&&this.ribbonManager.Kfe(H.qw);
H.iKb&&this.contextMenuManager.Agk(H.iKb);this.QK.jgk(H.EK.getStoreType(),H.EK.getSolutionId())}lTh(H,va){va=ad.a(va);for(const ub of this.QK.ylb){if(ub.EK.getStoreType()!==va)continue;let kc=!0;for(const Oc of H){const pd=Oc;if(pd&&ub.a_f(pd.storeType,pd.solutionId)){kc=!1;break}}kc&&(this.Hoc(ub),ub.EK.purge(!1))}}w5g(H){return!!H&&!!H.solutionId&&!!H.version&&!!H.storeType&&!!H.storeId}}Object(I.a)(nk,"AddInCommandsIntegration",null,[]);class bk{constructor(H,va,ub,kc,Oc,pd,Sd,Wd){Wd=void 0===
Wd?null:Wd;this.Rg=new ef.a;this.T4c=H;this.Mfh=va;this.jr=ub;this.OWe=kc;this.mbb=Oc;this.cdh=pd;this.Dac=Sd;this.emh=Wd}gxh(H){this.Rg.addHandler(ha.a.N1e,H)}kzh(H){this.Rg.addHandler(ha.a.g3f,H)}QAh(H){this.Rg.addHandler(ha.a.MQg,H)}mxh(H){this.Rg.addHandler(ha.a.dqd,H)}Itj(H,va,ub){const kc=ub[ha.a.vGb],Oc=void 0===ub[ha.a.v3]?0:ub[ha.a.v3];if(kc&&0!==Oc)if(0>=kc.count&&4!==Oc)this.Asg(new mf(Oc,null,null,va,null,!0));else{var pd=kc.count,Sd=new Rf(new Zi),Wd=void 0===ub[ha.a.w9]?-1:ub[ha.a.w9],
ee=new nk(Oc,this.jr,this.T4c,Sd,this.Mfh,this.mbb,this.Dac),je=Sb=>this.OWe.LLh(Sb.solutionId,this.Dac,this.T4c,H),Ue=Sb=>this.OWe.WKh(Sb.solutionId),G=(Sb,Mc,sd)=>{pd--;sd=new mf(Oc,Mc,Sd,va,sd,0>=pd);if(Sb&&Mc)this.Asg(sd);else{if(3===Oc||Mc&&Mc.isUpgraded)Sb="",Mc&&(Sb=Telemetry.PrivacyRules.GetPrivacyCompliantId(Mc.solutionId,Mc.ownerAddinStoreType||Mc.storeType,Mc.assetId,null,null,Mc.storeId)),Mc={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:Sb},
Bc.a.sendTelemetryEvent(Object.assign(new Ob.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:zc.a.rn(Mc)}));this.zsg(sd)}pd||P.AFrameworkApplication.ra.AB()},da=(Sb,Mc,sd,Od)=>{G(Sb,Mc,Od)},$a=()=>{this.k5d();0>=kc.count&&4===Oc&&this.mbb.lme()};6===Oc?(Wd=ub[ha.a.jXa],ub=ub[ha.a.kXa],ee.ktj(kc.ma(0),Wd,ub,je,Ue,(Sb,Mc,sd,Od)=>{G(Sb,Mc,Od)})):ee.bXb(kc,je,Ue,Wd,da,$a,this.emh)}else Bc.a.sendTelemetryEvent(Object.assign(new Ob.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:zc.a.rn({["SDX_AppInstallOrigin"]:"User",
["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",["SDX_Id"]:""})})),sa.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.T4c.QX)),this.zsg(new mf(Oc,null,null,va,null,!0))}zsg(H){this.k5d(H);this.RRg(!1,H)}Asg(H){const va=H.Jr;let ub=null;null!==va&&(ub=va.storeType,ub=ub.toLowerCase());if(H&&"omex"===ub&&(3===H.hA||va.isUpgraded)){var kc={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(va.solutionId,
va.ownerAddinStoreType||va.storeType,va.assetId,null,null,va.storeId)};Bc.a.sendTelemetryEvent(Object.assign(new Ob.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:zc.a.rn(kc)}))}this.k5d(H);kc=gd()&&"omex"===ub&&!!H.Mba&&!!va.solutionId&&2===H.hA&&va.solutionId.toLowerCase()===Ec().toLowerCase();var Oc="excatalog"===ub&&3===H.hA;if("omex"===ub&&H.Mba&&(3===H.hA&&"hardcodedpreinstall"!==ub||va.isUpgraded)||kc||Oc)kc=new yh,kc.Jr=va,kc.qw=H.Mba.x1a,this.Rg.raiseEvent(ha.a.dqd,kc);kc=ac();
Oc=Ec();kc&&va&&"excatalog"===va.storeType&&H.Mba&&5===H.hA&&Oc&&(va.storeId&&va.storeId.toLowerCase()===Oc.toLowerCase()||va.assetId&&va.assetId.toLowerCase()===Oc.toLowerCase())&&(kc=new yh,kc.Jr=va,kc.qw=H.Mba.x1a,this.Rg.raiseEvent(ha.a.dqd,kc),sa.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event."));va&&(ug.instance.sKg(ad.b(ub),!0),"uploadfiledevcatalog"===ub&&(kc=this.cdh.createAddinDataProvider(ub,this.jr))&&kc.localCacheAddinCommands(this.jr.Soa,va.solutionId,
va.version,va.storeId),Qb.a.IPa(ha.a.Fnd,"true",ad.b(ub)));this.RRg(!0,H)}RRg(H,va){H?va.Mba&&5===va.hA&&va.Mba.x1a&&void 0!==va.Jr.showCallout&&null!==va.Jr.showCallout&&va.Jr.showCallout?((new Ua(this.Rg)).huh(va.Jr,Oi.a.QOb(va.Mba.x1a)),H=new yh,H.qw=va.Mba.x1a,H.Jr=va.Jr,this.Rg.raiseEvent(ha.a.MQg,H)):3!==va.hA?va.d2f&&this.mbb.lme():va.Mba&&va.Mba.x1a&&"hardcodedpreinstall"!==va.Jr.storeType&&Ph.a.JKk(va.displayName,va.Mba.x1a,va.Jr.isAutoLaunched):3===va.hA?va.Jr&&"uploadfiledevcatalog"===
va.Jr.storeType.toLowerCase()?(va=this.Dac.MIi(va.Jr.solutionId),Ph.a.Ope(va?va:Object(La.a)("InternalError")+" "+Object(La.a)("InternalError_Directive"))):this.mbb.BLg():va.d2f&&this.mbb.lme()}k5d(H){var va=(H=void 0===H?null:H)?H.Jr:null;const ub=new yh;if(ub.Jr=va){var kc=this.mbb.Iva(va.storeType,va.solutionId,6===H.hA?1:0);if(kc&&kc.qw){ub.qw=kc.qw;var Oc=Ec();Oc=gd()&&!!va.solutionId&&!!Oc&&va.solutionId.toLowerCase()===Oc.toLowerCase()&&2===H.hA;if(3===H.hA&&"hardcodedpreinstall"!==va.storeType||
Oc)H="",kc.qw.G6&&kc.qw.G6.NB&&(kc=kc.qw.G6.NB.ma(0))&&(H=kc.id),va={["SDX_CommandPlacement"]:H,["SDX_PinningAction"]:"Pinning",["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(va.solutionId,va.ownerAddinStoreType||va.storeType,va.assetId,null,null,va.storeId)},Bc.a.sendTelemetryEvent(Object.assign(new Ob.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:zc.a.rn(va)}))}}this.Rg.raiseEvent(ha.a.N1e,ub)}}Object(I.a)(bk,"LaunchAddinCommandsHandler",null,
[389]);class Bh{}Bh.k9a="Alt";Bh.l9a="Command";Bh.id="Id";Bh.p9a="Image16by16";Bh.kac="LabelText";Bh.s9a="Title";Bh.GROUP="Group";Bh.nBe="Groups";Bh.Byb="Controls";Bh.button="Button";Bh.uma="FlyoutAnchor";Bh.LARGE="Large";Bh.SMALL="Small";Object(I.a)(Bh,"AddinDataNodeConstants",null,[]);var Xk=a(285);a(657);var Fk=a(482),Yk=a(133);class Tj{constructor(H,va){this.uSa=this.fGe=null;if(bc.c(H)||bc.c(va))throw sa.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),
Error.create("ControlDefinition id or type should not be null or undefined");this.Tfh=va;this._id=H;this.Z3[Bh.id]=this._id}get id(){return this._id||""}get Z3(){return this.fGe||(this.fGe={})}get controlType(){return this.Tfh||""}get menuItems(){return this.uSa||(this.uSa=new pf.a)}}Object(I.a)(Tj,"ControlDefinition",null,[387]);class Dj{constructor(H){this.WOe=null;if(bc.c(H))throw sa.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");
this._id=H;this.Fya[Bh.id]=this._id}get Fya(){return this.WOe||(this.WOe={})}get id(){return this._id||""}}Object(I.a)(Dj,"MenuItemDefinition",null,[409]);class Gk{constructor(H){this.NCa=null;if(bc.c(H))throw sa.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=H}get id(){return this._id}get controls(){return this.NCa||(this.NCa=new pf.a)}}Object(I.a)(Gk,"OfficeMenuDefinition",
null,[386]);var Vf=a(28);class ok{constructor(H,va,ub){this.cT=this.d$a=null;this.Zdd=H;this.U9a=va;this.u9a=ub;this.Elh=new pf.a}get yLc(){return this.Zdd}get JJb(){return this.U9a}get Bkd(){return this.u9a}addButton(H){sa.ULS.sendTraceTag(17085952,220,50,"ContextMenu button actiontype: {0}.",H.actionType);this.cT=new Tj(this.PFa(H.id),Bh.button);this.cT.Z3[Bh.kac]=H.label;this.cT.Z3[Bh.k9a]=H.label;this.cT.Z3[Bh.p9a]=H.icon["16"];this.LHb(this.cT.Z3[Bh.id],H.action);this.VTa(this.cT.Z3);this.d$a.controls.add(this.cT);
this.cT=null}startBuildMenu(H){if(bc.c(this.d$a))this.d$a=new Gk(H.id);else{const va=this.PFa(H.id);this.cT=new Tj(va,Bh.uma);this.teb(this.cT.Z3,H);this.cT.Z3[Bh.p9a]=H.icon["16"];this.cT.Z3[Bh.l9a]=Vf.a.alwaysEnabled}}addMenuItem(H){sa.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",H.actionType);const va=new Dj(this.PFa(H.id));this.teb(va.Fya,H);H.icon&&(va.Fya[Bh.p9a]=H.icon["16"]);this.LHb(va.Fya[Bh.id],H.action);this.VTa(va.Fya);this.cT.menuItems.add(va)}endBuildMenu(){bc.c(this.cT)?
(this.UKc.add(this.d$a),this.d$a=null):(this.d$a.controls.add(this.cT),this.cT=null)}get UKc(){return this.Elh}LHb(H,va){this.Bkd.bindAction(H,va)}VTa(H){this.JJb.VTa(H)}PFa(H){return this.yLc.GYa(H)}teb(H,va){H[Bh.kac]=va.label;H[Bh.k9a]=va.label}}Object(I.a)(ok,"ContextMenuExtensibilityCreator",null,[399,393]);class Hk{constructor(H){this.MCb=H}get WYb(){return this.MCb}GYa(H){return this.WYb+H}}Object(I.a)(Hk,"DefaultContextMenuNamingProvider",null,[400]);var ck=a(1428);class Ik{bindAction(H,va){OfficeExt.DefaultControlActionBinder.bindAction(H,
va)}}Object(I.a)(Ik,"DefaultUIControlActionBinder",null,[398]);class Jj{constructor(H){this.aRa=H}get command(){return this.aRa}VTa(H){H[Bh.l9a]=this.command}}Object(I.a)(Jj,"DefaultUIControlCommandBinder",null,[397]);var Zk=a(33);class pk{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(I.a)(pk,"AddInControl",null,[]);class ij{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=
null}}Object(I.a)(ij,"AddInGroup",null,[]);class Uj{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(I.a)(Uj,"AddInMenuItem",null,[]);class dk{constructor(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(I.a)(dk,"AddInTab",null,[]);class zj{constructor(H,va,ub,kc,Oc,pd){this.Aac=new pf.a;this.Wzb=this.xra=this.e$a=null;this.Zdd=H;
this.u9a=va;this.U9a=ub;this.tG=kc;this.Dac=Oc;this.kIe=pd}get yLc(){return this.Zdd}get NB(){return this.Aac}get Bkd(){return this.u9a}get JJb(){return this.U9a}startBuildTab(H){const va=H.isOfficeTab?H.id:this.yLc.vJf(H.id),ub=H.isOfficeTab?null:H.label;this.e$a=Object.assign(new dk,{id:va,title:ub,isOfficeTab:H.isOfficeTab,visible:H.visible,groups:[],tabType:H.tabType,insertBefore:H.insertBefore,insertAfter:H.insertAfter,autoFocus:H.autoFocus})}startBuildGroup(H){const va=this.PFa(H.id);this.xra=
Object.assign(new ij,{id:va,mlrId:H.mlrId,title:H.label,controls:[],groupType:0})}addNativeGroup(H){this.xra=Object.assign(new ij,{id:H.id,mlrId:H.mlrId,title:H.label,controls:[],groupType:1});this.e$a.groups.push(this.xra)}addButton(H){const va=this.PFa(H.id);va&&(this.LHb(va,H.action),sa.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",H.actionType),H=Object.assign(new pk,{id:va,title:H.label,iconLocation:this.RJd(H),enabled:H.enabled,controlType:0,attributes:this.teb()}),
this.kIe.pZe(new Zk.a(va,this.JJb.command.toString())),this.xra.controls.push(H))}addNativeControl(H){H.id&&(sa.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",H.actionType),H=Object.assign(new pk,{id:H.id,title:"",iconLocation:"",enabled:H.enabled,controlType:2,attributes:this.teb()}),this.xra.controls.push(H))}startBuildMenu(H){const va=this.PFa(H.id);va&&(this.Wzb=Object.assign(new pk,{id:va,title:H.label,iconLocation:this.RJd(H),controlType:1,attributes:{},
menuItems:[]}))}addMenuItem(H){const va=this.PFa(H.id);va&&(this.LHb(va,H.action),sa.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",H.actionType),H=Object.assign(new Uj,{id:va,title:H.label,iconLocation:this.RJd(H),enabled:H.enabled,attributes:this.teb()}),this.kIe.pZe(new Zk.a(va,this.JJb.command.toString())),this.Wzb.menuItems.push(H))}endBuildMenu(){bc.c(this.Wzb.id)||this.xra.controls.push(this.Wzb);this.Wzb=null}endBuildGroup(){bc.c(this.xra.id)||this.e$a.groups.push(this.xra);
this.xra=null}endBuildTab(){bc.c(this.e$a.id)||this.Aac.add(this.e$a);this.e$a=null}teb(){const H={};this.VTa(H);return H}RJd(H){return H.icon["80"]?H.icon["80"]:H.icon["32"]}VTa(H){this.JJb.VTa(H)}PFa(H){return this.yLc.GYa(H)}LHb(H,va){this.Bkd.bindAction(H,va)}}Object(I.a)(zj,"OneLineRibbonExtensibilityCreator",null,[392,393]);class Jk{constructor(H,va){this.MCb=H;this.u9a=new Ik;this.U9a=new Jj(va)}WKh(H){H=new Hk(H);return new ok(H,this.U9a,this.u9a)}LLh(H,va,ub,kc){ub=new ck.a(this.MCb,H,ub,
!0);return new zj(ub,this.u9a,this.U9a,H,va,kc)}}Object(I.a)(Jk,"UIExtensibilityFactory",null,[358]);var $k=a(1095);class Ri{get b8g(){return P.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8500191_EnableHomeEntrywithFlyout")&&P.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")}constructor(H){this.hUa=this.lUa=this.Jr=this.qw=null;this.zAg=0;this.JSj=()=>{if(this.Jr&&this.hUa){const va=new Re.a(Vf.a.Pda,0,0,2,null);this.addinUICommandHandler.executeCommand(0,
va,{["SourceControlId"]:this.hUa},null);sa.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};this.KKk=(va,ub)=>{va=null;if(ub)if(va=ub,this.Jr=va.Jr,(this.qw=va.qw)&&this.qw.G6&&this.qw.G6.NB&&(this.lUa=this.qw.G6.NB.ma(0)),this.lUa&&this.lUa.id)if(P.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CDTeachingCalloutEnhancementEnabled",!1)&&this.vMg(),this.lUa.isOfficeTab)if(P.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CDTeachingCalloutEnhancementEnabled",
!1)||this.vMg(),this.hUa)if(Md.a.contains(this.lUa.id,Va.a.lS,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Oi.a.QOb(this.qw),()=>{this.BSg(this.qLd(this.hUa))});else{if(ub=this.$.Ma)ub.vnd(this.Qng),sa.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else sa.ULS.sendTraceTag(537170694,220,10,"Failed to get button id for addin"),ub={["AppTeachingUICalloutAction"]:"NoEnabledButtonFound",["SDX.Id"]:Ri.GetPrivacyCompliantId(this.Jr),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"},Bc.a.sendTelemetryEvent(Object(kf.a)(new Ob.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:zc.a.rn(ub)})),this.bha();else this.DSg(this.qLd(this.lUa.id),0);else sa.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),ub={["AppTeachingUICalloutAction"]:"NoTabFound",["SDX.Id"]:Ri.GetPrivacyCompliantId(this.Jr),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},
Bc.a.sendTelemetryEvent(Object(kf.a)(new Ob.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:zc.a.rn(ub)})),this.bha();else this.bha()};this.Qng=()=>{if(Md.a.contains(this.lUa.id,appChrome.selectors.getSelectedTabId(),!0)){var va=this.$.Ma;va&&va.BCg(this.Qng);this.BSg(this.qLd(this.hUa))}};this.MSj=()=>{var va={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:Ri.n9a(this.XL),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Bc.a.sendTelemetryEvent(Object(kf.a)(new Ob.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:zc.a.rn(va)}));this.bha();const ub={};ub[Xa.a.Wk]=this.XL;va={};va.solutionId=this.XL.solutionId;va.assetId=this.XL.assetId;va.assetStoreId=this.XL.assetStoreId;va.height=0!=this.XL.height?this.XL.height:600;va.storeId=this.XL.storeId;va.storeType=this.XL.storeType;va.targetType=this.XL.targetType;va.width=0!=this.XL.width?this.XL.width:600;va.displayName=this.XL.displayName;va.version=this.XL.version;va.isAddinCommands=!1;ub[ha.a.Ata]=
va;const kc=new Re.a(-741808261,0,0,2,null);Fa.TaskExtensions.Ua(gb.GetServiceTaskFactory.Bj(this.$.ka,374,375,1),Oc=>{Oc=Oc.result;null!=Oc&&Oc.insertAgave(ub,kc)},this.$.xa,3)};this.VLj=()=>{const va={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:Ri.n9a(this.XL),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Bc.a.sendTelemetryEvent(Object(kf.a)(new Ob.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:zc.a.rn(va)}));this.bha()};
this.DNj=()=>{const va={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:Ri.n9a(this.XL),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Bc.a.sendTelemetryEvent(Object(kf.a)(new Ob.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:zc.a.rn(va)}));this.bha()};this.Eza=va=>{sa.ULS.sendTraceTag(522981591,306,10,`failed to POST data to Roaming Settings Service with status: ${va?va.httpStatus:-1}`)};this.$=H.$;this.addinUICommandHandler=
H;this.appName=P.AFrameworkApplication.fa.Xa("WebAppShortName")||"Excel";this.IBh=P.AFrameworkApplication.fa.vj("AddinMaxDOMElementDetectionTimesForTeachingUI",10)}static GetPrivacyCompliantId(H){return Telemetry.PrivacyRules.GetPrivacyCompliantId(H.solutionId,H.storeType,H.assetId,null,null,H.storeId)}static n9a(H){return Telemetry.PrivacyRules.GetPrivacyCompliantId(H.solutionId,H.storeType,H.assetId,null,null,H.storeId)}Bfk(H){this.XL=H;window.addEventListener&&(window.addEventListener("LaunchContentAddin",
this.MSj,!0),window.addEventListener("DismissCallout",this.DNj,!0),window.addEventListener("CloseCallout",this.VLj,!0))}vMg(){var H=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();const va=this.Jr.solutionId;va in H?this.hUa=H[va]:(H=Ri.GetPrivacyCompliantId(this.Jr),sa.ULS.sendTraceTag(537170695,220,15,`Failed to get button id from controlIdMap for add-in: ${H}`),this.hUa=this.WBi(this.qw))}qLd(H){return"[id="+H+"]"}DSg(H,va){va>this.IBh?(window.clearTimeout(this.zAg),
this.CSg("[data-unique-id='pivotOverflowButton']"),sa.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+H)?this.CSg(H):this.zAg=window.setTimeout(()=>{this.DSg(H,va+1)},1E3)}BSg(H){var va=document.querySelector("button[data-unique-id='RightPaddle']");if(va)H={["AppTeachingUICalloutAction"]:"RightPaddlePresent",["SDX.Id"]:Ri.GetPrivacyCompliantId(this.Jr),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},
Bc.a.sendTelemetryEvent(Object(kf.a)(new Ob.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:zc.a.rn(H)}));else if(va=document.querySelector("button"+H),!va||"none"===window.getComputedStyle(va).display)if(va=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!va){va={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Ri.GetPrivacyCompliantId(this.Jr),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Bc.a.sendTelemetryEvent(Object(kf.a)(new Ob.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:zc.a.rn(va)}));sa.ULS.sendTraceTag(537170691,220,15,"ShowTeachingCallout failed to get an anchorElement");this.bha();return}this.HZg(va,"ShowTeachingUIForAddinButton")}CSg(H){H=document.querySelector("button"+H);if(!H&&(H=document.querySelector("button[data-unique-id='pivotOverflowButton']"),!H)){H={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Ri.GetPrivacyCompliantId(this.Jr),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};Bc.a.sendTelemetryEvent(Object(kf.a)(new Ob.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:zc.a.rn(H)}));sa.ULS.sendTraceTag(537170690,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.bha();return}this.HZg(H,"ShowTeachingUIForAddinTab")}HZg(H,va){H.setAttribute("lpp-id","latestAddin");const ub=Wc.a.instance.Qi("Common.ISystemInitiatedFeedback");ub&&H?(ub.execute(kc=>{kc.logActivity(va,null)}),H={["AppTeachingUICalloutAction"]:"Show",
["SDX.Id"]:Ri.GetPrivacyCompliantId(this.Jr),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Bc.a.sendTelemetryEvent(Object(kf.a)(new Ob.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:zc.a.rn(H)})),sa.ULS.sendTraceTag(537170688,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):(sa.ULS.sendTraceTag(537170689,220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),H={["AppTeachingUICalloutAction"]:"NoSifFutureObject",
["SDX.Id"]:Ri.GetPrivacyCompliantId(this.Jr),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Bc.a.sendTelemetryEvent(Object(kf.a)(new Ob.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:zc.a.rn(H)})),this.bha())}WBi(H){if(H&&(H=H.G6,(null===H||void 0===H?0:H.NB)&&0<H.NB.count))for(const va of H.NB)if(va.groups&&0<va.groups.length)for(const ub of va.groups)if(ub.controls&&0<ub.controls.length)for(const kc of ub.controls){if(kc.attributes&&
0===kc.controlType&&kc.enabled)return kc.id;if(kc.menuItems)for(const Oc of kc.menuItems)if(Oc.attributes&&Oc.enabled)return kc.id}}ASg(){var H="button[data-unique-id = 'Ribbon-InsertAppsForOffice']";za.EwaSettings.isChangeGateEnabled("OfficeVSO:8058447_FixCDTeachingCalloutAnchorAfterFlyoutEnabled")&&(H=this.b8g?"button[data-unique-id = 'Ribbon-InsertAddInFlyout']":H);if((H=document.querySelector(H))&&"none"!==window.getComputedStyle(H).display)sa.ULS.sendTraceTag(527286666,220,15,"Callout show on OfficeAddin Button");
else{H=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']");if(null==H){H={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Ri.n9a(this.XL),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};Bc.a.sendTelemetryEvent(Object(kf.a)(new Ob.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:zc.a.rn(H)}));sa.ULS.sendTraceTag(527286668,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");
this.bha();return}sa.ULS.sendTraceTag(527286667,220,15,"Callout show on Overflow button")}const va=Wc.a.instance.Qi("Common.ISystemInitiatedFeedback");null==va||null==H?(H={["AppTeachingUICalloutAction"]:"NoSifFutureObject",["SDX.Id"]:Ri.n9a(this.XL),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Bc.a.sendTelemetryEvent(Object(kf.a)(new Ob.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:zc.a.rn(H)})),sa.ULS.sendTraceTag(527286665,220,
15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"),this.bha()):(va.execute(ub=>{ub.logActivity("ShowTeachingUIForContentAddin",null)}),H={["AppTeachingUICalloutAction"]:"Show",["SDX.Id"]:Ri.n9a(this.XL),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},Bc.a.sendTelemetryEvent(Object(kf.a)(new Ob.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:zc.a.rn(H)})),sa.ULS.sendTraceTag(527286664,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity"))}zUc(H){const va=
{},ub={};ub.LastTeachingUIShowTime=(new Date).toUTCString();ub.AddinHasShown=H;va[this.appName]=Fe.c(ub);this.AGb=new A(this.appName,null,null,this.Eza),this.AGb.svc(va),sa.ULS.sendTraceTag(522981592,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}bha(){if(!this.gUc){const H=window.g_roamingAddinList;H&&(this.zUc(H),this.gUc=!0)}}}Object(I.a)(Ri,"AddinTeachingCalloutHandler",null,[]);var Oj=a(1366),al=a(304),jj=a(48),Vj=a(236),ki=a(244);
class Wj extends Vj.a{constructor(H,va,ub,kc){super();this.x8="calc(100% - 46px)";this.xja="15px";this.y8="0";this.rAb="WACDialogPanel";this.tN=695;this.sAb=462;this.qL="80%";this.czb=350;this.DCa="100%";this.L2=null;this.Bh=5;this.Lk="AddinInstallDialog";this.Tdh=H;this.N8=va;this.arh=ub;this.kmh=kc}WF(){super.WF();this.zo.style.width=this.DCa;this.zo.style.height=this.x8;this.zo.style.marginTop=this.xja;this.zo.style.padding=this.y8;document.getElementById(this.Jo("WACDialogButtonPanel")).style.display=
"none";this.sua.setAttribute("tabindex","0");$addHandler(this.sua,"keyup",Object(Zf.a)(this,this.onKeyUp,"onKeyUp"));const H=document.createElement("iframe");H.setAttribute("id","InstallAddinDialog");H.setAttribute("src","about:blank");H.setAttribute("width","100%");H.setAttribute("height","100%");H.setAttribute("marginHeight","0");H.setAttribute("marginWidth","0");H.setAttribute("frameBorder","0");H.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups");
const va=String.format("https://inclient.store.office.com/gyro/clientstore/flyoutdetails/{0}?client={1}&ui={2}&rs={2}",this.Tdh,this.N8,this.arh);H.setAttribute("src",va);this.L2=H;$addHandler(H,"load",Object(Zf.a)(this,this.onLoad,"onLoad"));$addHandler(window,"message",Object(Zf.a)(this,this.onMessage,"onMessage"));this.zo.appendChild(H);this.zo.appendChild(this.s2h())}s2h(){const H=document.createElement("div");H.setAttribute("tabindex","0");$addHandler(H,"focus",Object(Zf.a)(this,this.fTj,"onLoopPivotFocus"));
return H}onKeyUp(H){13!==H.keyCode&&32!==H.keyCode||this.hide()}fTj(){this.sua.focus()}onLoad(){this.L2.focus()}onMessage(H){H=H.rawEvent;if(H.source===this.L2.contentWindow&&(H=(H=H.data)?H.split("|"):null)&&0<H.length&&("REFRESH_REQUIRED"===H[0]||"PRELOAD_MANIFEST"===H[0])){Y.a.instance.setItem("refreshRequired","true");const va={};va.solutionId=H[1];va.version=Wj.kHj(H[3]);va.storeType=H[4];va.storeId=H[5];va.assetId=H[6];va.targetType=Wj.D1j(H[2]);va.assetStoreId=H[7];va.width=parseInt(H[8]);
va.height=parseInt(H[9]);this.kmh(va)}}Nza(){this.zo.style.width=this.DCa;this.zo.style.height=this.x8;this.zo.style.marginTop=this.xja;this.zo.style.padding=this.y8;this.tN>ki.a.iba?(this.Xg.style.width=String.format("{0}px",ki.a.iba),this.Xg.style.overflowX="scroll",P.AFrameworkApplication.isRtl?this.Xg.style.right="0":this.Xg.style.left="0"):(this.Xg.style.width=String.format("{0}px",this.tN),this.Xg.style.overflowX="hidden");this.Xg.offsetHeight>ki.a.k1||this.sAb+50>ki.a.k1?(this.Xg.style.height=
String.format("{0}px",ki.a.k1),this.Xg.style.overflowY="scroll",this.Xg.style.top="0",P.AFrameworkApplication.isRtl?this.Xg.style.right="0":this.Xg.style.left="0",this.zo.style.minHeight=String.format("{0}px",this.czb)):(this.Xg.style.overflowY="hidden",this.Xg.style.top="10%",this.Xg.style.height=this.qL);this.ila()}ila(){if(this.Xg){var H=this.Xg.style.zIndex;this.Xg.style.zIndex="-9999";if(this.tN>ki.a.iba)P.AFrameworkApplication.isRtl?this.Xg.style.marginRight="0":this.Xg.style.marginLeft="0";
else{const va=String.format("{0}px",Math.floor(-this.Xg.offsetWidth/2));P.AFrameworkApplication.isRtl?this.Xg.style.marginRight=va:this.Xg.style.marginLeft=va;P.AFrameworkApplication.isRtl?this.Xg.style.right="50%":this.Xg.style.left="50%"}this.Xg.style.zIndex=String(H)}else sa.ULS.sendTraceTag(509871430,306,10,"_divMessageBox is null in CenterDialog()")}GS(){super.GS();const H=document.getElementById(this.Jo(this.rAb));H.style.width=String.format("{0}px",this.tN);H.style.height=this.qL}get Vla(){return this.zo}dispose(){super.dispose();
$removeHandler(window,"message",Object(Zf.a)(this,this.onMessage,"onMessage"))}static D1j(H){switch(H){case "1":return 0;case "2":return 1;default:return 0}}static kHj(H){const va=H.split(".");for(let ub=0;ub<4-va.length;ub++)H+=".0";return H}}Object(I.a)(Wj,"AddinInstallDialog",Vj.a,[]);class Kk{constructor(){this.addInDetails=this.title=null}}Object(I.a)(Kk,"AddInCategoryData",null,[]);class Lj{constructor(){this.links=this.description=this.displayName=this.uniqueId=this.solutionId=null}}Object(I.a)(Lj,
"AddInDetailData",null,[]);class qk{constructor(){this.href=this.text=null}}Object(I.a)(qk,"AddInLinkData",null,[]);var Pj=a(1029),pj;(function(H){H[H.Pfl=0]="S_OK";H[H.Pdl=-2147471590]="E_REQUEST_TIME_OUT";H[H.Qdl=-2147208619]="E_USER_NOT_SIGNED_IN";H[H.Hdl=-2147471591]="E_CATALOG_ACCESS_DENIED";H[H.Jdl=-2147471589]="E_CATALOG_REQUEST_FAILED";H[H.Mdl=-2147208640]="E_OEM_NO_NETWORK_CONNECTION";H[H.Odl=-2147208617]="E_PROVIDER_NOT_REGISTERED";H[H.Ldl=-2147208637]="E_OEM_CACHE_SHUTDOWN";H[H.Ndl=-2147209421]=
"E_OEM_REMOVED_FAILED";H[H.Idl=-1]="E_CATALOG_NO_APPS";H[H.Rdl=-2]="E_USER_NO_MAILBOX";H[H.Kdl=-1E3]="E_GENERIC_ERROR";H[H.Ofl=10]="S_HIDE_PROVIDER"})(pj||(pj={}));Object(I.b)("InvokeResultCode",pj);class ek{constructor(H,va){this.Ga=va;this.yw=H}get gNk(){return this.Ga?this.Ga.isChangeGateEnabled("OfficeVSO:8511220_showPopularOnFailForGuests"):!1}hSg(H){return this.gNk?H.failure?-2147208619===H.failure.invokeResultCode:!1:!1}jFf(H,va){return`invokeFailure/${3===H.errorCode&&H.failure?pj[H.failure.invokeResultCode]:
""}/${3===va.errorCode&&va.failure?pj[va.failure.invokeResultCode]:""}`}S4f(H,va,ub,kc){H={["Source"]:this.yw,["MRUListNumber"]:H.toString(),["MyAddinsErrorCode"]:Pj.a[va.errorCode],["MyAddInsResult"]:va.Dw.length.toString(),["MyAddinsInvokeResultCode"]:va.failure?va.failure.invokeResultCode:"N/A",["AdminManagedErrorCode"]:Pj.a[ub.errorCode],["AdminManagedResult"]:ub.Dw.length.toString(),["AdminManageInvokeResultCode"]:ub.failure?ub.failure.invokeResultCode:"N/A",["PopularAddinsErrorCode"]:kc?Pj.a[kc.errorCode]:
"N/A",["PopularAddinsResult"]:kc?kc.Dw.length.toString():"N/A",["PopularAddinsInvokeResultCode"]:kc&&kc.failure?kc.failure.invokeResultCode:"N/A"};this.aIk&&(H.MyAddinsQueryStart=this.Qzc(va.failure),H.AdminManagedQueryStart=this.Qzc(ub.failure),H.PopularQueryStart=this.Qzc(kc.failure));Bc.a.sendTelemetryEvent(Object.assign(new Ob.a,{name:"Office.Extensibility.Host.AddinEntryPointDisplayMetrics",dataFields:zc.a.rn(H)}))}R4f(H,va,ub,kc,Oc){ub={["MyAddinsResult"]:this.grd(ub),["AdminManagedResult"]:this.grd(kc),
["PopularResult"]:this.grd(Oc)};H={["Source"]:this.yw,["Abnormals"]:va.join("|"),["NumAddinsInMRU"]:H.toString(),["DiagnosticDetails"]:JSON.stringify(ub)};Bc.a.sendTelemetryEvent(Object.assign(new Ob.a,{name:"Office.Extensibility.Host.AddinEntryPointAceMetrics",dataFields:zc.a.rn(H)}))}grd(H){return{["Count"]:H.Dw.length.toString(),["QueryStart"]:this.Qzc(H.failure),["ErrorCode"]:Pj.a[H.errorCode],["InvokeResultCode"]:H.failure?H.failure.invokeResultCode:"N/A"}}get kXg(){return!!this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8393563_FlyoutTelemetryOptimizationEnabled")}get N4f(){return!!this.Ga&&
this.Ga.isChangeGateEnabled("OfficeVSO:8581842_LogAceMetricsEnabled")}Qzc(H){let va="N/A";H&&H.queryStart&&window.performance.timeOrigin&&(va=(new Date(window.performance.timeOrigin+H.queryStart)).toISOString());return va}get aIk(){return this.Ga?this.Ga.isChangeGateEnabled("OfficeVSO:8546535_LogQueryStartEnabled"):!1}}Object(I.a)(ek,"AddinEntryPointCommon",null,[]);class bl{constructor(H,va,ub){this.gja=0;this.GJe=!1;this.uEb=[];this.EQa=void 0;this.Ga=H;this.fja=va;this.wfd=ub;sa.ULS.sendTraceTag(508396508,
220,50,"AddInCategoryManager Initialized")}R2a(H,va){H&&va&&this.nIk(va)&&this.Wrg()}nIk(H){0===H.FL&&(this.gja|=1);1===H.FL&&(this.gja|=2);2===H.FL&&(this.gja|=4);return!!this.gja}Wrg(){const H=[];let va=null;const ub={},kc=this.Gmj,Oc=this.kFj,pd=this.fja.FX(0),Sd=this.fja.FX(1),Wd=this.fja.FX(2);(2===pd.errorCode||this.qwb&&2===Wd.errorCode)&&!Oc.length?(va=this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8668453_StoreDisabledErrorViewWithDocumentLink")?{ariaDescription:Object(La.a)("AddinPickerDisableError"),
iconName:"StoreDisabled",label:Object(La.a)("AddinPickerDisableError"),title:Object(La.a)("AddInBackstageErrorViewTitle"),linkText:Object(La.a)("AddinPickerDisableErrorDocumentText"),linkUrl:String.format("https://learn.microsoft.com/{0}/microsoft-365/admin/manage/manage-addins-in-the-admin-center?view=o365-worldwide#manage-add-in-downloads-by-turning-onoff-the-office-store-across-all-apps-except-outlook",P.AFrameworkApplication.uiCulture),onLinkClicked:()=>{sa.ULS.sendTraceTag(507875924,220,15,"User has clicked link on add-in backstage error view")}}:
{ariaDescription:Object(La.a)("AddinPickerDisableError"),iconName:"StoreDisabled",label:Object(La.a)("AddinPickerDisableError"),title:Object(La.a)("AddInBackstageErrorViewTitle")},H.push("storeDisabled")):3!==pd.errorCode||this.w3.hSg(pd)||3!==Sd.errorCode?4!==pd.errorCode||Oc.length?!this.cZf&&(!this.uaa||0!==Wd.errorCode&&5!==Wd.errorCode)||Wd.Dw.length||(sa.ULS.sendTraceTag(508396506,220,50,"get popular add-ins for backstage error: empty category, Flag: {0} Popular error code: {1}",this.gja,Wd.errorCode),
H.push("emptyCategory")):(va={ariaDescription:Object(La.a)("AddinPickerServiceDisconnectedError"),iconName:"StoreDisabled",label:Object(La.a)("AddinPickerServiceDisconnectedError"),title:Object(La.a)("AddInBackstageErrorViewTitle")},H.push("serviceDisabled")):(va={ariaDescription:Object(La.a)("AddinPickerGeneralError"),iconName:"Common",label:Object(La.a)("AddinPickerGeneralError"),title:Object(La.a)("AddInBackstageErrorViewTitle")},H.push(this.w3.jFf(pd,Sd)));this.a9b&&this.w3.S4f(Oc.length,pd,Sd,
Wd);const ee=!va;!ee||kc||Oc.length?(ee?(ub.mruAddIns=Oc,kc&&(ub.categories=this.M3j)):ub.errorViewProps=va,appChrome.api.dispatch(appChrome.actions.setFileMenuAddInsData(ub,ee)),kc&&ee&&!this.GJe&&(this.GJe=!0,sa.ULS.sendTraceTag(508396504,220,50,"Set Popular Add-ins List to Backstage Success. Flag: {0}",this.gja))):H.push("emptyPage");this.a9b&&(this.w3.kXg&&sa.ULS.sendTraceTag(508047441,220,15,`${H.join("|")}`),this.w3.N4f&&this.w3.R4f(Oc.length,H,pd,Sd,Wd))}get cZf(){return!!(this.gja&4)}get a9b(){return!!this.Ga&&
this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TriggerBackstageUIFixEnabeld",!1)}get Gmj(){const H=this.fja.FX(2);return(this.cZf||this.uaa||this.a9b)&&(0===H.errorCode||5===H.errorCode)&&!!H.Dw.length}get M3j(){var H=this.TGi();0<H.length&&(this.wfd=H);if(bc.c(this.wfd))return[];var va=JSON.parse(this.wfd);H=[];for(var ub of va)va=Object.assign(new Kk,{title:ub.title,addInDetails:[]}),this.JKh(va,ub.solutionIds),0<va.addInDetails.length&&Array.add(H,va);0<this.uEb.length&&(ub=this.fja.FX(2),
sa.ULS.sendTraceTag(508396503,220,15,"{0} SolutionIds not found in mapping: {1}, collection length: {2}",this.uEb.length,this.uEb,ub.Dw.length),this.uEb=[]);return H}get kFj(){var H=[],va=this.fja.FX(0);Array.addRange(H,va.Dw);va=this.fja.FX(1);Array.addRange(H,va.Dw);H.sort((ub,kc)=>{ub=rc.d(ub.displayName);kc=rc.d(kc.displayName);return sb.a.localeCompare(ub,kc)});va=[];for(const ub of H)H=Object.assign(new Lj,{description:ub.description,displayName:ub.displayName,solutionId:ub.solutionId,uniqueId:this.ROb(ub)}),
Array.add(va,H);return va}JKh(H,va){const ub=this.lFj;let kc=0;for(const Oc of va){if(4===kc)break;if(ub.contains(Oc))continue;va=this.fja.EX(Oc);if(!va){this.uEb.push(Oc);continue}const pd=Object.assign(new Lj,{description:va.description,displayName:va.displayName,solutionId:va.solutionId,uniqueId:this.ROb(va)});pd.links=[Object.assign(new qk,{text:Object(La.a)("AddinOneLink"),href:"https://appsource.microsoft.com/en-us/product/office/"+va.solutionId})];Array.add(H.addInDetails,pd);++kc}}get lFj(){const H=
[];var va=this.fja.FX(0);Array.addRange(H,va.Dw);va=this.fja.FX(1);Array.addRange(H,va.Dw);va=new nd.a($d.a.lm());for(const ub of H)va.add(ub.solutionId);return va}ROb(H){return this.uaa?String.format("{0}#{1}",H.solutionId,H.storeId):H.solutionId}get uaa(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",!1)}TGi(){return this.Ga?this.Ga.getStringFeatureGate("Microsoft.Office.SharedOnline.BackstageCustomizablePopularAddins",""):""}get qwb(){return!!this.Ga&&
this.Ga.isChangeGateEnabled("OfficeVSO:8362324_StoreDisabledErrorViewFixEnabled")}get w3(){this.EQa||(this.EQa=new ek("Backstage",this.Ga));return this.EQa}}Object(I.a)(bl,"AddInCategoryManager",null,[]);var Mj=a(1030),fk=a(663);class Lk{constructor(H,va,ub){this.amountToShowWhenCollapsed=H;this.expandButton=va;this.collapseButton=ub}}Object(I.a)(Lk,"GallerySectionCollapse",null,[]);class Xj{constructor(){this.Collapse=this.InsertionPoint=this.GalleryButtons=this.Title=this.SectionId=null}}Object(I.a)(Xj,
"GallerySectionProps",null,[]);var Nj=a(1187);class Mk{constructor(){this.text=this.href=null}}Object(I.a)(Mk,"LinkProps",null,[]);class rk{constructor(){this.icon=this.text=this.href=null}}Object(I.a)(rk,"LinkWithLabelProps",null,[]);var cl=a(1096),dl=a(1232);const sl="wa102927044 wa102957661 wa102957665 wa103147117 wa103296784 wa103304320 wa103651566 wa103863850 wa103982217 wa103982219 wa103982221 wa103985973 wa103996219 wa104003812 wa104006972 wa104017332 wa104032712 wa104036095 wa104038832 wa104041485 wa104051163 wa104092360 wa104096858 wa104099688 wa104100404 wa104104476 wa104114212 wa104150553 wa104151288 wa104152457 wa104152459 wa104152461 wa104152463 wa104152465 wa104152467 wa104152469 wa104152471 wa104152876 wa104152878 wa104152880 wa104152882 wa104152884 wa104157773 wa104160363 wa104181413 wa104184267 wa104187975 wa104190317 wa104191381 wa104192851 wa104195705 wa104198124 wa104199815 wa104212571 wa104225427 wa104311014 wa104356783 wa104363180 wa104363616 wa104367607 wa104368114 wa104371266 wa104374243 wa104374368 wa104376997 wa104379036 wa104379039 wa104379040 wa104379121 wa104379169 wa104379190 wa104379193 wa104379231 wa104379279 wa104379471 wa104379481 wa104379498 wa104379502 wa104379518 wa104379533 wa104379534 wa104379558 wa104379572 wa104379601 wa104379629 wa104379638 wa104379640 wa104379673 wa104379710 wa104379714 wa104379716 wa104379751 wa104379790 wa104379804 wa104379806 wa104379830 wa104379842 wa104379850 wa104379852 wa104379857 wa104379861 wa104379873 wa104379912 wa104379941 wa104379942 wa104379951 wa104379952 wa104379955 wa104379999 wa104380006 wa104380081 wa104380084 wa104380090 wa104380099 wa104380100 wa104380101 wa104380110 wa104380123 wa104380126 wa104380142 wa104380186 wa104380211 wa104380256 wa104380257 wa104380263 wa104380274 wa104380281 wa104380330 wa104380379 wa104380386 wa104380392 wa104380393 wa104380415 wa104380479 wa104380548 wa104380590 wa104380711 wa104380801 wa104380839 wa104380848 wa104380862 wa104380871 wa104380961 wa104380977 wa104380991 wa104380992 wa104381030 wa104381039 wa104381071 wa104381080 wa104381100 wa104381177 wa104381207 wa104381208 wa104381227 wa104381270 wa104381350 wa104381500 wa104381504 wa104381514 wa104381516 wa104381558 wa104381567 wa104381587 wa104381641 wa104381695 wa104381701 wa104381705 wa104381761 wa104381821 wa104381856 wa104381859 wa104381885 wa104381893 wa104381955 wa104382017 wa104382019 wa104382048 wa104382054 wa200000004 wa200000025 wa200000075 wa200000113 wa200000125 wa200000142 wa200000176 wa200000190 wa200000193 wa200000209 wa200000310 wa200000387 wa200000388 wa200000541 wa200000775 wa200000934 wa200001032 wa200001086 wa200001383 wa200001387 wa200001565 wa200001627 wa200001657 wa200001672 wa200001685 wa200001709 wa200001788 wa200001789 wa200001816 wa200001847 wa200001937 wa200001947 wa200001997 wa200002110 wa200002197 wa200002205 wa200002346 wa200002378 wa200002381 wa200002407 wa200002427 wa200002445 wa200002494 wa200002503 wa200002575 wa200002577 wa200002628 wa200002631 wa200002648 wa200002698 wa200002736 wa200002772 wa200002797 wa200002808 wa200002929 wa200002934 wa200003035 wa200003082 wa200003087 wa200003098 wa200003121 wa200003225 wa200003269 wa200003324 wa200003369 wa200003386 wa200003402 wa200003476 wa200003520 wa200003595 wa200003599 wa200003637 wa200003648 wa200003666 wa200003670 wa200003692 wa200003693 wa200003696 wa200003731 wa200003732 wa200003812 wa200003821 wa200003903 wa200003987 wa200003990 wa200004040 wa200004043 wa200004078 wa200004096 wa200004133 wa200004136 wa200004285 wa200004415 wa200004426 wa200004465 wa200004466 wa200004483 wa200004571 wa200004577 wa200004580 wa200004597 wa200004600 wa200004602 wa200004618 wa200004622 wa200004651 wa200004684 wa200004687 wa200004702 wa200004703 wa200004707 wa200004713 wa200004749 wa200004755 wa200004798 wa200004835 wa200004858 wa200004866 wa200004867 wa200004884 wa200004894 wa200004899 wa200004923 wa200004931 wa200004946 wa200004977 wa200004983 wa200004993 wa200005010 wa200005018 wa200005040 wa200005075 wa200005095 wa200005105 wa200005148 wa200005172 wa200005178 wa200005186 wa200005194 wa200005222 wa200005223 wa200005228 wa200005233 wa200005264 wa200005299 wa200005332 wa200005334 wa200005400 wa200005409 wa200005410 wa200005416 wa200005426 wa200005429 wa200005433 wa200005478 wa200005481 wa200005496 wa200005503 wa200005505 wa200005506 wa200005577 wa200005582 wa200005611 wa200005647 wa200005653 wa200005694 wa200005695 wa200005702 wa200005705 wa200005777 wa200005783 wa200005794 wa200005810 wa200005813 wa200005862 wa200005866 wa200005920 wa200005962 wa200006007 wa200006008 wa200006010 wa200006068 wa200006083 wa200006111 wa200006113 wa200006141 wa200006150 wa200006170 wa200006179 wa200006191 wa200006220 wa200006229 wa200006242".split(" "),
el="wa104281577 wa104295828 wa104323558 wa104356783 wa104363477 wa104363616 wa104379193 wa104379231 wa104379264 wa104379474 wa104379481 wa104379673 wa104379714 wa104379772 wa104379790 wa104379804 wa104379806 wa104379830 wa104379852 wa104379951 wa104379987 wa104379997 wa104380121 wa104380181 wa104380256 wa104380274 wa104380278 wa104380375 wa104380510 wa104380781 wa104380844 wa104380848 wa104380862 wa104380871 wa104380907 wa104381025 wa104381029 wa104381139 wa104381331 wa104381335 wa104381350 wa104381526 wa104381558 wa104381814 wa104382059 wa104382064 wa200000113 wa200000125 wa200000410 wa200000724 wa200000729 wa200000745 wa200001086 wa200001661 wa200001937 wa200001943 wa200002185 wa200002197 wa200002274 wa200002329 wa200002388 wa200002433 wa200003233 wa200003251 wa200003520 wa200003574 wa200003599 wa200003602 wa200003619 wa200003666 wa200003732 wa200003821 wa200003903 wa200003912 wa200003915 wa200004040 wa200004465 wa200004497 wa200004551 wa200004578 wa200004648 wa200004675 wa200004677 wa200004764 wa200004771 wa200004784 wa200004798 wa200004858 wa200004984 wa200005030 wa200005040 wa200005159 wa200005220 wa200005264 wa200005359 wa200005373 wa200005496 wa200005503 wa200005542 wa200005559 wa200005566 wa200005628 wa200005638 wa200005653 wa200005694 wa200005793 wa200005801 wa200005812 wa200005921 wa200005928 wa200006046 wa200006179".split(" "),
Yj="wa103296784 wa103863850 wa104051163 wa104099688 wa104374368 wa104376108 wa104379279 wa104379345 wa104379572 wa104379601 wa104379640 wa104379673 wa104379714 wa104379752 wa104379764 wa104379772 wa104379790 wa104379806 wa104379821 wa104379852 wa104379860 wa104379861 wa104379874 wa104379931 wa104379944 wa104379951 wa104379984 wa104379987 wa104379988 wa104379997 wa104380006 wa104380094 wa104380099 wa104380121 wa104380140 wa104380256 wa104380274 wa104380278 wa104380284 wa104380302 wa104380375 wa104380500 wa104380677 wa104380778 wa104380788 wa104380802 wa104380829 wa104380844 wa104380848 wa104380862 wa104380914 wa104380941 wa104380973 wa104380974 wa104380976 wa104380992 wa104380997 wa104381005 wa104381029 wa104381062 wa104381232 wa104381269 wa104381302 wa104381321 wa104381328 wa104381335 wa104381350 wa104381408 wa104381439 wa104381471 wa104381519 wa104381603 wa104381612 wa104381648 wa104381658 wa104381684 wa104381739 wa104381769 wa104381774 wa104381821 wa104381860 wa104381904 wa104381905 wa104381923 wa104381926 wa104381963 wa104381967 wa104382059 wa104382081 wa104382089 wa200000011 wa200000030 wa200000031 wa200000040 wa200000048 wa200000086 wa200000113 wa200000125 wa200000137 wa200000149 wa200000156 wa200000171 wa200000194 wa200000204 wa200000310 wa200000398 wa200000410 wa200000540 wa200000680 wa200000729 wa200000741 wa200000776 wa200001000 wa200001042 wa200001066 wa200001086 wa200001169 wa200001177 wa200001298 wa200001361 wa200001482 wa200001491 wa200001524 wa200001547 wa200001629 wa200001806 wa200001937 wa200001943 wa200001998 wa200002029 wa200002125 wa200002172 wa200002197 wa200002237 wa200002291 wa200002296 wa200002420 wa200002424 wa200002442 wa200002476 wa200002477 wa200002492 wa200002500 wa200002573 wa200002609 wa200002643 wa200002654 wa200002694 wa200002730 wa200002864 wa200002866 wa200002910 wa200002912 wa200003026 wa200003128 wa200003143 wa200003144 wa200003275 wa200003334 wa200003416 wa200003418 wa200003500 wa200003520 wa200003523 wa200003543 wa200003553 wa200003554 wa200003574 wa200003578 wa200003590 wa200003599 wa200003623 wa200003626 wa200003634 wa200003648 wa200003654 wa200003666 wa200003702 wa200003732 wa200003773 wa200003812 wa200003817 wa200003821 wa200003829 wa200003846 wa200003871 wa200003901 wa200003902 wa200003903 wa200003912 wa200003915 wa200003947 wa200003951 wa200003962 wa200003975 wa200003988 wa200003994 wa200004002 wa200004010 wa200004011 wa200004014 wa200004040 wa200004044 wa200004046 wa200004097 wa200004098 wa200004104 wa200004111 wa200004131 wa200004178 wa200004195 wa200004216 wa200004316 wa200004382 wa200004420 wa200004424 wa200004427 wa200004448 wa200004466 wa200004471 wa200004475 wa200004510 wa200004535 wa200004537 wa200004547 wa200004567 wa200004591 wa200004606 wa200004623 wa200004635 wa200004685 wa200004696 wa200004702 wa200004713 wa200004753 wa200004786 wa200004819 wa200004845 wa200004858 wa200004865 wa200004872 wa200004923 wa200004942 wa200004996 wa200005040 wa200005041 wa200005063 wa200005082 wa200005097 wa200005114 wa200005154 wa200005177 wa200005191 wa200005208 wa200005248 wa200005260 wa200005264 wa200005279 wa200005283 wa200005298 wa200005302 wa200005321 wa200005323 wa200005327 wa200005328 wa200005332 wa200005339 wa200005347 wa200005351 wa200005357 wa200005373 wa200005377 wa200005414 wa200005444 wa200005451 wa200005458 wa200005496 wa200005503 wa200005567 wa200005644 wa200005653 wa200005694 wa200005736 wa200005779 wa200005804 wa200005826 wa200005849 wa200005869 wa200005874 wa200005896 wa200005903 wa200005957 wa200005973 wa200006057 wa200006060 wa200006081 wa200006093 wa200006108 wa200006135 wa200006164 wa200006167 wa200006179 wa200006209 wa200006213 wa200006240".split(" ");
var gk=a(284),tl=a(237);class sk{constructor(H,va,ub){this.WDh="appsource";this.primaryKey="f45d712d6617b7e2b2f1fb0fc9757fa1eb384d7f03f6740a1a474b3ccf95b5d8";this.Vuk="99b3e3778ca726c8bd5b4b1b6aa137358f0902d731079ca80e28f79a25d3870a";this.Ga=H;this.mW=va;this.Ukh=void 0===ub?"en":ub;this.ap=new Gg(this.Ga);this.bRe=this.gMh();this.KC={};this.fih=this.ap.DBh}bJg(H,va,ub,kc,Oc){kc=void 0===kc?15:kc;Oc=void 0===Oc?!1:Oc;var pd=new gk.QueryStringBuilder("search"),Sd={"api-version":"2023-01-01-preview",
gallery:"AppSourceApps",productTypes:"Office365",Market:"ALL",select:"UniqueProductId,DisplayName,LongSummary,SmallIconUri,Popularity"};Sd.applicableProducts=this.mW;Sd.supportedProducts=this.mW+"_Online";Sd.Language=this.Ukh;Sd.searchQuery=H;Sd.top=kc.toString();this.T4e("AppSource",Sd);for(const ee in Sd)pd.Kp(ee,Sd[ee]);pd="https://catalogapi.azure.com/"+pd.toString();Sd={};Sd["X-API-Key"]=Oc?this.Vuk:this.primaryKey;Sd["X-ms-app"]=this.WDh;const Wd=window.performance.now();this.executeRequest(pd,
1,Sd,ee=>{let je="Query Succeeded",Ue=!0,G=0;const da=[],$a=[];ee=ee.data.responseData;try{var Sb=JSON.parse(ee);G=Sb.totalCount;const Mc=Sb.results;for(Sb=0;Sb<Mc.length;Sb++){const sd=Mc[Sb],Od={};Od.solutionId=sd.uniqueProductId.toLowerCase();Od.displayName=sd.displayName;Od.description=sd.longSummary;Od.iconUrl=sd.smallIconUri;Od.assetId=Od.solutionId;Od.storeId="en-US";Od.storeType="omex";Od.assetStoreId="omex";da.push(Od);this.KC[Od.solutionId]=Od;$a.push(sd.popularity)}}catch(Mc){je="Exception thrown from Json parse for responseData: "+
ee+". Exception: "+Mc,Ue=!1}this.RJc(0<H.length,ub,"AppSource",Ue,je,window.performance.now()-Wd,G,da,$a);va(Ue,da)},ee=>{const je=[];this.RJc(0<H.length,ub,"AppSource",!1,`Query Failed, httpStatus: ${ee.data.httpStatus}, responseData: ${ee.data.responseData}`,window.performance.now()-Wd,0,je);Oc||ee.data.httpStatus!==tl.a.Nve?va(!1,je):this.bJg(H,va,ub,kc,!0)})}Iuk(H){var va=void 0===va?15:va;return new Promise((ub,kc)=>{this.bJg(H,(Oc,pd)=>{Oc?ub(pd):kc()},Date.now(),va)})}cJg(H,va,ub,kc,Oc){kc=
void 0===kc?"":kc;Oc=void 0===Oc?15:Oc;const pd=new gk.QueryStringBuilder("api/addins/search"),Sd={apiversion:"1.0"};0<H.length&&(Sd.qu=H);0<kc.length&&(Sd.assetids=kc);Sd.client="WAC_"+this.mW;Sd.cv=P.AFrameworkApplication.buildVersion;Sd.top=Oc.toString();this.T4e("OMEX",Sd);for(const ee in Sd)pd.Kp(ee,Sd[ee]);kc="https://api.addins.omex.office.net/"+pd.toString();const Wd=window.performance.now();this.executeRequest(kc,1,null,ee=>{let je="Query Succeeded",Ue=!0,G=0;const da=[];ee=ee.data.responseData;
try{var $a=JSON.parse(ee);G=$a.TotalCount;const Sb=$a.Values;for($a=0;$a<Sb.length;$a++){const Mc=Sb[$a],sd={};sd.solutionId=Mc.Id.toLowerCase();sd.displayName=Mc.Title;sd.description=Mc.ShortDescription;sd.iconUrl=Mc.IconUrl;sd.assetId=sd.solutionId;sd.storeId="en-US";sd.storeType="omex";sd.assetStoreId="omex";sd.version=Mc.Version;sd.targetType=Mc.Shape-1;sd.height=Mc.Height;sd.width=Mc.Width;da.push(sd);this.KC[sd.solutionId]=sd}}catch(Sb){je="Exception thrown from Json parse for responseData: "+
ee+". Exception: "+Sb,Ue=!1}this.RJc(0<H.length,ub,"OMEX",Ue,je,window.performance.now()-Wd,G,da);va(Ue,da)},ee=>{const je=[];this.RJc(0<H.length,ub,"OMEX",!1,`Query Failed, httpStatus: ${ee.data.httpStatus}, responseData: ${ee.data.responseData}`,window.performance.now()-Wd,0,je);va(!1,je)})}Kuk(H){var va=void 0===va?"":va;var ub=void 0===ub?15:ub;return new Promise((kc,Oc)=>{this.cJg(H,(pd,Sd)=>{pd?kc(Sd):Oc()},Date.now(),va,ub)})}EX(H){return this.KC[H.toLowerCase()]?this.KC[H.toLowerCase()]:null}executeRequest(H,
va,ub,kc,Oc){return P.AFrameworkApplication.$i.Ou(H,va,null,void 0===ub?null:ub,!1,2,kc,Oc,null,null,!1,null,this.fih)}RJc(H,va,ub,kc,Oc,pd,Sd,Wd,ee){H={["hasSearchValue"]:null===H||void 0===H?void 0:H.toString(),["searchStartTime"]:null===va||void 0===va?void 0:va.toString(),["apiSource"]:ub,["responseSuccess"]:null===kc||void 0===kc?void 0:kc.toString(),["responseInfo"]:Oc,["timeElapsed"]:null===pd||void 0===pd?void 0:pd.toString(),["totalCount"]:null===Sd||void 0===Sd?void 0:Sd.toString(),["solutionIds"]:Wd.map(je=>
this.nZh(je)),["popularity"]:ee?ee:[]};Bc.a.sendTelemetryEvent(Object.assign(new Ob.a,{name:"Office.Extensibility.Host.SearchApiMetrics",dataFields:zc.a.rn(H)}))}nZh(H){return Telemetry.PrivacyRules.GetPrivacyCompliantId(H.solutionId,H.storeType,H.assetId,null,null,H.storeId)}gMh(){let H=this.ap.m0j;if(1>=H.length)return{};sa.ULS.sendTraceTag(507785891,220,50,"BuildSearchQueryParametersOverrides: overrideString: {0}.",H);const va={};let ub=!0,kc="";H=H.trim();try{const Oc=H.split("$");for(let pd=
0;pd<Oc.length&&ub;pd++){const Sd=Oc[pd].split(":");if(2!==Sd.length){kc="Invalid override string format: "+Oc[pd];ub=!1;break}const Wd=Sd[0].trim(),ee=[],je=Sd[1].split("|");for(let Ue=0;Ue<je.length&&ub;Ue++){const G=je[Ue],da=G.split("\\");if(2<da.length){kc="Invalid override string format: "+G;ub=!1;break}const $a=da[0].trim(),Sb=2===da.length?da[1].trim():null;Array.add(ee,new Pg.a($a,Sb))}va[Wd]=ee}}catch(Oc){kc="Failed in parsing the overrideString: "+H+". Exception: "+Oc.toString(),ub=!1}if(ub)return va;
sa.ULS.sendTraceTag(507785890,220,10,"Build override failed: {0}.",kc);return{}}T4e(H,va){if(this.bRe[H]){H=this.bRe[H];for(let ub=0;ub<H.length;ub++){const kc=H[ub].key,Oc=H[ub].value;Oc?va[kc]=Oc:delete va[kc]}}}}Object(I.a)(sk,"AddinSearchApiManager",null,[]);var tk=a(399);class uk{constructor(){this.hp=H=>{var va;if(null===H||null===H.La)return!1;H=H.La.target;for(this.$Ed=void 0;null!=H&&H.getAttribute;){void 0===this.$Ed&&0<(null===(va=H.id)||void 0===va?void 0:va.length)&&(this.$Ed=H.id);if(null!=
H.getAttribute("data-contextmenu-id"))break;H=H.parentNode}return!1}}get currentTarget(){return this.$Ed}Puj(){tk.a.instance.ya(window.document.body,this.hp,null)}dispose(){tk.a.instance.Na(window.document.body,this.hp)}}Object(I.a)(uk,"AppFlyoutGeneratorContextMenuListener",null,[]);const Nk={["WF"]:"wa200001011 wa104382081 wa200000368 wa104380122 wa200000199 wa104381727 wa200005983 wa200001361 wa200000011 wa200005106 wa200005817 wa200004216".split(" "),["IPWAI"]:"wa200005502 wa200001011 wa200000368 wa200005107 wa200005287 wa104381714 wa200005444 wa200005826 wa200006000 wa200005313 wa200001361 wa200006001 wa200005312".split(" "),
["ER"]:"wa200004257 wa104381909 wa104380917 wa200002334 wa200001482 wa200002534 wa200002891 wa104380848".split(" "),["APID"]:"wa200000113 wa104380121 wa104051163 wa104379279 wa104380118 wa104178141 wa200002281 wa104379370 wa104379997 wa104381063 wa104381411".split(" ")},ul={["IPWAI"]:"wa200005502 wa200005271 wa200004935 wa200001584 wa200005281 wa200005107 wa200005333".split(" "),["DA"]:"wa200003784 wa200000169 wa200000018 wa104381841 wa104380711 wa104381807 wa200002503".split(" "),["APIC"]:"wa102957665 wa200004179 wa104051163 wa104380194 wa200004688 wa200004687 wa104221182 wa200003220 wa104379169 wa103147117".split(" ")},
fl={["IPWAI"]:["wa200003964","wa200005107","wa200005669","wa200006067"],["APIC"]:"wa104221182 wa104178141 wa104381909 wa200000113 wa104381155 wa104380907 wa104380121 wa104379997 wa104381063 wa104379370 wa104380902 wa104381411 wa200003220 wa200003891 wa104380848 wa104381637 wa200001766".split(" "),["CAIP"]:"wa104379261 wa200001661 wa200002908 wa200000094 wa104218073 wa104381682 wa104382064 wa200004643 wa200004709 wa200003676 wa200001313 wa200003706 wa104381448 wa104380667".split(" ")};class vk{constructor(H,
va,ub){this.ap=H;this.hja=va;this.YQa={};this.Qed={};if(H.Bta||H.Wda){this.YQa=ub;this.WEh();this.JEh();H=this.ap.l0j;try{const kc=H.split("|");H={};for(va=0;va<kc.length;va+=2)H[kc[va]]=kc[va+1];this.Qed=H}catch(kc){}}}WEh(){const H={};var va=this.ap.j0j;if(!(1>=va.length)){sa.ULS.sendTraceTag(507589127,220,50,"BuildCategoryAddinDetailOverrides: overrideString: {0}.",va);var ub=!0,kc="";va=va.trim();try{const Oc=va.split("$");for(let pd=0;pd<Oc.length&&ub;pd++){const Sd=Oc[pd].split(":");if(2<Sd.length){kc=
"Invalid override string format: "+Oc[pd];ub=!1;break}const Wd=Sd[0].trim(),ee=[];if(2===Sd.length){const je=Sd[1].split("|");for(let Ue=0;Ue<je.length&&ub;Ue++){const G=je[Ue],da=G.split("\\");if(2>da.length||5<da.length){kc="Invalid override string format: "+G;ub=!1;break}const $a=da[0].trim(),Sb={};for(let Mc=1;Mc<da.length&&ub;Mc++)if(0<da[Mc].trim().length)switch(Mc){case 1:Sb.priority=parseInt(da[Mc].trim());break;case 2:Sb.AUP=parseInt(da[Mc].trim());break;case 3:Sb.diffAUP=parseInt(da[Mc].trim());
break;case 4:const sd=da[Mc].trim();if(8!==sd.length){kc="Invalid override string format: "+sd;ub=!1;break}Sb.releaseDate=(new Date(parseInt(sd.substring(0,4)),parseInt(sd.substring(4,6))-1,parseInt(sd.substring(6)))).getTime();break;default:kc="Invalid override string format: "+G,ub=!1}if(!ub)break;Array.add(ee,{solutionId:$a,addinInfo:Sb})}}this.YQa[Wd]&&(H[Wd]=ee)}}catch(Oc){kc="Failed in parsing the overrideString: "+va+". Exception: "+Oc.toString(),ub=!1}if(ub){for(const Oc in H){if(!this.YQa[Oc])continue;
const pd=H[Oc];va=this.YQa[Oc].filter(Sd=>!pd.some(Wd=>Wd.solutionId.toLowerCase()===Sd.solutionId.toLowerCase()));Array.addRange(pd,va)}this.YQa=H}else sa.ULS.sendTraceTag(507589126,220,10,"Override Failed: {0}.",kc)}}JEh(){for(const H in this.YQa){const va=this.YQa[H];for(let ub=0;ub<va.length;ub++){const kc=va[ub];kc.addinInfo||(kc.addinInfo={});if(!kc.addinInfo.priority||isNaN(kc.addinInfo.priority))kc.addinInfo.priority=0;if(!kc.addinInfo.AUP||isNaN(kc.addinInfo.AUP))kc.addinInfo.AUP=0;if(!kc.addinInfo.diffAUP||
isNaN(kc.addinInfo.diffAUP))kc.addinInfo.diffAUP=0;if(!kc.addinInfo.releaseDate||isNaN(kc.addinInfo.releaseDate))kc.addinInfo.releaseDate=0}}}Igk(H,va,ub){return ub&&0<ub.length&&"PAIYO"!==H?ub.filter(kc=>!va.some(Oc=>Oc.toLowerCase()===kc.solutionId.toLowerCase())):ub}Hyc(){const H=this.ap.host,va=this.ap.k0j;return va?va.split("|"):"Word"===H?["WF","IPWAI","APID"]:"Excel"===H?["IPWAI","APIC","DA"]:"PowerPoint"===H?["IPWAI","APIC","CAIP"]:[]}Iyc(H,va){var ub,kc,Oc,pd=this.ap.host;if("Word"===pd)pd=
(null===(ub=Nk[H])||void 0===ub?void 0:ub.map(Sd=>this.hja.EX(Sd)))||[];else if("Excel"===pd)pd=(null===(kc=ul[H])||void 0===kc?void 0:kc.map(Sd=>this.hja.EX(Sd)))||[];else if("PowerPoint"===pd)pd=(null===(Oc=fl[H])||void 0===Oc?void 0:Oc.map(Sd=>this.hja.EX(Sd)))||[];else return[];return va?this.Igk(H,va,pd):pd}CEi(H){if(this.Qed[H])return this.Qed[H];switch(H){case "APIC":return"Insert Graphics";case "APID":return"Insert Graphics";case "BBM":return"Microsoft";case "CAIP":return"Interactive tools";
case "DA":return"Data analytics";case "DWT":return"Templates";case "ER":return"Education";case "FA":return"Finance";case "IPWAI":return"AI";case "PAIYO":return"Org";case "TD":return"Trending";case "WF":return"Writing Fluently";case "WN":return"New"}return"Popular"}RHd(H){var va;const ub=this.ap.host;return(null===(va=Uh()[ub])||void 0===va?void 0:va[H])||Uh().vOg[H]||Qg()[H]||Qg().default}}Object(I.a)(vk,"AppFlyoutCategories",null,[]);var li;(function(H){H.LEFT="LEFT";H.cja="MIDDLE";H.RIGHT="RIGHT"})(li||
(li={}));Object(I.b)("FRECarouselDirection",li);class Ok{constructor(H,va){this.categories=H;this.K3b=va;this.FQa=0}CXj(H){var va,ub;let kc=!1;try{if(null===H||void 0===H?0:H.includes("FRECarouselSwitchIcon_")){let Oc=this.FQa;const pd=H.split("_");if(3===pd.length){const Sd=pd[1],Wd=parseInt(pd[2],10);if(Sd===li.cja)return;Sd===li.LEFT?(Oc--,0>Oc&&(Oc=Wd-1)):(Oc++,Oc>=Wd&&(Oc=0));this.FQa=Oc;kc=!0}}if(kc){Bc.a.sendTelemetryEvent(m(Ob.a,{name:"Office.Extensibility.Host.AddInFlyoutSwitchFREBanner",
dataFields:zc.a.i2b({["controlId"]:H,["currentIndex"]:null===(va=this.FQa)||void 0===va?void 0:va.toString()})}));try{this.JDb="banner",null===(ub=this.K3b)||void 0===ub?void 0:ub.call(this)}finally{this.JDb=void 0}}else sa.ULS.sendTraceTag(507527308,220,10,`Bad fre banner switch. SourceControlId=${H}`)}catch(Oc){sa.ULS.sendTraceTag(507527307,220,10,`Bad fre banner switch. SourceControlId=${H}; error=${null===Oc||void 0===Oc?void 0:Oc.toString()}`)}}DXj(){var H;this.xsa=this.categories.Hyc()[this.FQa];
try{this.JDb="content",null===(H=this.K3b)||void 0===H?void 0:H.call(this)}finally{this.JDb=void 0}Bc.a.sendTelemetryEvent(m(Ob.a,{name:"Office.Extensibility.Host.AddInFlyoutSwitchFREContent",dataFields:zc.a.i2b({["category"]:this.xsa})}))}yTh(H){H.MenuSectionList.some(va=>va.ControlList.some(ub=>"AddInFlyoutFREBanner"===ub.Id))||e("AddInFlyoutFREBanner",!1,-1)}Klk(H){var va;const ub=this.categories.Hyc(),kc=ub[this.FQa];H.MenuSectionList.unshift(u(kc,ub.length,this.FQa));e("AddInFlyoutFREBanner",
!0,1);H={["currentIndex"]:null===(va=this.FQa)||void 0===va?void 0:va.toString(),["category"]:kc};Bc.a.sendTelemetryEvent(Object.assign(new Ob.a,{name:"Office.Extensibility.Host.ShowFREBanner",dataFields:zc.a.rn(H)}))}cQi(H,va){if(!this.xsa)return H;const ub=this.categories.Iyc(this.xsa,va).map(kc=>kc.solutionId);return H.filter(kc=>!ub.includes(kc.solutionId))}BEi(H){return this.xsa?this.categories.Iyc(this.xsa,H):[]}RHd(){return this.xsa?this.categories.RHd(this.xsa):""}n6j(){this.JDb||(this.xsa=
void 0)}k5j(){"content"===this.JDb&&setTimeout(()=>{const H=document.querySelector('[id^="FRECategoryAddin"]');if(H){H.scrollIntoView({behavior:"smooth",block:"center"});const va=H.parentElement.parentElement.parentElement.parentElement;va.classList.remove("addin-flyout-highlighted");va.classList.add("addin-flyout-highlight");setTimeout(()=>{va.classList.add("addin-flyout-highlighted")},1E3)}},10)}get fyi(){var H;return null===(H=this.xsa)||void 0===H?void 0:H.toString()}}Object(I.a)(Ok,"FRECarousel",
null,[]);class wk{constructor(H,va,ub,kc,Oc,pd,Sd,Wd,ee,je){Wd=void 0===Wd?{}:Wd;var Ue,G;this.K3b=je;this.Q9c={};this.odc={};this.kJe=0;this.Lyb={};this.EQa=void 0;this.eGe=this.Myb=null;this.Bbb="All";this.pcd=[];this.zbb="";this.chc=null;this.cUe=100;this.fhc=!1;this.ZDb=[];this.R2a=(da,$a)=>{this.uaa?this.Iek($a):(this.Hek($a),!this.ap.a9b&&this.yDe&&this.yDe.R2a(da,$a))};this.hja=va;this.psa=null;this.Zkh=kc;this.Aoh=Oc;this.yDe=void 0===Sd?null:Sd;this.Ga=(void 0===pd?null:pd)||P.AFrameworkApplication.fa;
this.ap=new Gg(this.Ga);this.ijh=ee;this.N9a=new vk(this.ap,va,Wd);this.hja.Tza(this.R2a);(null===appChrome||void 0===appChrome?0:appChrome.addInApi)&&appChrome.addInApi.loadOfficeAddInIcons();this.ap.CBh&&d((da,$a)=>{Bc.a.sendTelemetryEvent(m(Ob.a,{name:"Office.Extensibility.Host.AddInFlyoutOpenCloseChanged",dataFields:zc.a.i2b({["PerformanceNow"]:performance.now(),["DateNow"]:new Date,["IsOpened"]:da,["OpenDuration"]:$a})}))}).catch(da=>{sa.ULS.sendTraceTag(507799683,220,15,"Failed to listen flyout open close event: "+
((null===da||void 0===da?void 0:da.toString())||void 0))});if(this.ap.x9||this.ap.YSh)this.Myb=new sk(this.Ga,this.Ga.Xa("Application")),this.cUe=null!==(G=null===(Ue=this.Ga)||void 0===Ue?void 0:Ue.getIntFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchDebouncing",100))&&void 0!==G?G:100;this.ap.O1e&&(this.eGe=new uk,this.eGe.Puj());this.ap.Wda&&(this.Kja=new Ok(this.N9a,je));this.ap.x9&&this.nAk();this.ap.ABh&&W()}get jZh(){return this.odc}Hek(H){if(H.Dw)for(let va=0;va<H.Dw.length;va++)appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+
H.Dw[va].solutionId,H.Dw[va].iconUrl);else 0===H.errorCode&&sa.ULS.sendTraceTag(509687429,220,10,"addinDetails is null which will lead to no icons registered")}get uaa(){return!!this.Ga&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",!1)}pKd(H){const va=this.ap.I4b,ub=va?"more"===H?"AddinFlyoutMoreButton":"AddinFlyoutLessButton":"AddinFlyoutMoreButton",kc=va?"more"===H?Object(La.a)("AddinsFlyoutSeeAllButtonText"):Object(La.a)("AddinsFlyoutSeeLessButtonText"):
Object(La.a)("AddinsFlyoutSeeAllButtonText");H=va?"more"===H?Object(La.a)("AddinsPickerGalleryButtonMoreArialText"):Object(La.a)("AddinsPickerGalleryButtonLessArialText"):Object(La.a)("AddinsPickerGalleryButtonMoreArialText");return Object.assign(new Nj.a,{Id:ub,ExternalId:ub,Icon:"AllApps_16",Command:this.Aoh,LabelText:kc,FullIconStyle:{root:{maxWidth:"16px",maxHeight:"16px",minWidth:"16px",minHeight:"16px",border:"1px solid var(--border-color, #c8c8c8)",borderRadius:"6px",padding:"15px 15px 15px 15px",
overflow:"hidden"}},Role:"menuitem",Alt:H})}vNi(H,va){var ub=void 0===ub?P.AFrameworkApplication.isRtl:ub;ub={["root"]:{["width"]:"32px",["height"]:"32px",["border-radius"]:"6px",["overflow"]:"hidden",["padding"]:"7px",["border"]:"1px solid var(--border-color, #c8c8c8)",["direction"]:ub?"ltr":void 0}};return Object.assign(new Nj.a,{Id:va,ExternalId:va,Icon:"AddinFlyoutControl"+H.solutionId,Command:this.Zkh,LabelText:H.displayName,Role:"menuitem",FullIconStyle:ub,Alt:H.description})}wNi(H,va){H=this.PFf("MRUAddinsGalleryControl",
H,va);return Object.assign(new kh.a,{Id:"MRUAddinsSection",ControlsId:"MRUAddinsSection.Controls",ControlList:[H],Title:Object(La.a)("MyAddinSection")})}PFf(H,va,ub,kc){kc=void 0===kc?this.ap.I4b:kc;const Oc=m(Xj,{SectionId:H+"Section",GalleryButtons:va.map(pd=>this.vNi(pd,this.CKi(pd)))});kc&&3<va.length?Oc.Collapse=new Lk(2,this.pKd("more"),this.pKd("less")):ub&&Oc.GalleryButtons.push(this.pKd("more"));return m(fk.a,{Id:H,ExternalId:H,GalleryStyle:{["galleryStack"]:{["root"]:{margin:"0px",marginLeft:"12px",
width:"100%",maxWidth:"unset"},["inner"]:{margin:"-4px",marginLeft:"0px",maxWidth:"333px",minWidth:"333px"}},["galleryButtonInExpanded"]:{["root"]:{width:100,height:100,backgroundColor:"transparent"},["flexContainer"]:{flexDirection:"column"},["label"]:{marginTop:"4px",maxWidth:"86px",fontSize:"12px",textOverflow:"ellipsis"}}},Width:3,Type:4,GallerySections:[Oc],GalleryContextMenu:this.ap&&this.ap.O1e?{["primaryMenuId"]:"AddInFlyoutMRUContextMenu"}:null})}HNi(){const H=m(kh.a,{Id:"FooterSection",
ControlsId:"FooterSection.Controls",ControlList:[m(Xk.a,{ExternalId:"InsertMoreAddInsFromFooter",AriaDescription:Object(La.a)("AddinsPickerFooterButtonMoreArialText")})]});appChrome.api.dispatch(appChrome.actions.setControlLabel("InsertMoreAddInsFromFooter",Object(La.a)("AddinPickerButtonMore")));return H}get fzf(){var H;return null===(H=this.Kja)||void 0===H?void 0:H.fyi}get nJg(){return this.Bbb}yEi(){this.Bbb="All";r(`${"AddinFREButton"}${this.Bbb}`);var H=["All",...this.N9a.Hyc()];H=m(Xj,{SectionId:"AddinFlyoutButtonGroupSection",
GalleryButtons:H.map(va=>{const ub=this.N9a.CEi(va);return Object.assign(new Nj.a,{Id:"AddinFREButton"+va,ExternalId:"AddinFREButton"+va,Command:Vf.a.d8b.toString(),LabelText:ub,FullIconStyle:{["root"]:{position:"absolute",["border-radius"]:"10px",width:"100%",height:"100%"}},Role:"tab",Alt:ub})})});H=m(fk.a,{Id:"AddinFlyoutButtonGroup",ExternalId:"AddinFlyoutButtonGroup",GalleryStyle:{["galleryStack"]:{["root"]:{margin:"0px",width:"100%",maxWidth:"unset"},["inner"]:{zil:2,maxWidth:"333px",minWidth:"333px",
flexFlow:"nowrap",paddingLeft:15}},["galleryButtonInExpanded"]:{["root"]:{backgroundColor:"transparent",width:"unset",height:"unset",borderRadius:"10px",borderColor:"var(--border-color)",borderWidth:"1px !important",padding:"4px 8px"},["flexContainer"]:{},["label"]:{fontSize:"12px",textOverflow:"ellipsis"}}},Type:4,GallerySections:[H],DismissHostingSurfaceOnExecute:!1});return m(kh.a,{ControlList:[H]})}ITk(H){var va;if(this.Bbb!==H){var ub=appChrome.selectors.getFlyoutAnchorMenuItems("InsertAddInFlyout");
"All"===this.Bbb&&(this.pcd=Object.entries(ub).filter(Wd=>{var [ee,je]=Wd;return"MultiActionButtonModel"===je&&ee.startsWith("AddInsListItem")}).map(Wd=>{[Wd]=Wd;return Wd}));this.Bbb=H;r(`${"AddinFREButton"}${H}`);var kc=-1!==Object.keys(ub).indexOf("SearchAddinInFlyout")||this.ap.x9?appChrome.api.menuSection(["SearchAddinInFlyout"],""):void 0,Oc=appChrome.api.menuSection(["InsertMoreAddInsFromFooter"],""),pd="All"===H?this.pcd:null!==(va=this.N9a.Iyc(H).map(Wd=>`AddInsListItem${Wd.solutionId.toLowerCase()}`))&&
void 0!==va?va:[],Sd=new Set(pd);va=this.pcd.filter(Wd=>Sd.has(Wd));va=[appChrome.api.menuSection(["AddinFlyoutButtonGroup",...va],"")];this.ap.Wda&&(pd=Object.keys(ub).filter(Wd=>0<=Wd.indexOf("FRECarousel")||0<=Wd.indexOf("FREBanner")),0<(null===pd||void 0===pd?void 0:pd.length)&&va.unshift(appChrome.api.menuSection(pd,"")));"MRUAddinsGalleryControl"in ub&&va.unshift(appChrome.api.menuSection(["MRUAddinsGalleryControl"],Object(La.a)("MyAddinSection")));ub=appChrome.actions.updateMenu("InsertAddInFlyout",
va,void 0,void 0,void 0,void 0,void 0,Oc,!0,kc);appChrome.api.dispatch(ub);Bc.a.sendTelemetryEvent(m(Ob.a,{name:"Office.Extensibility.Host.AddInFlyoutSwitchCategory",dataFields:zc.a.i2b({["Category"]:H})}))}}t0i(H){this.Kja.CXj(H)}u0i(){this.Kja.DXj()}KNi(H){var va,ub,kc;const Oc=[],pd=[],Sd=this.hja.FX(0);Array.addRange(pd,Sd.Dw);const Wd=this.hja.FX(1);Array.addRange(pd,Wd.Dw);H||pd.sort((Od,se)=>{Od=rc.d(Od.displayName);se=rc.d(se.displayName);return sb.a.localeCompare(Od,se)});null===(va=this.ijh)||
void 0===va?void 0:va.addNotification(pd);let ee=pd.length,je=!1;!this.ap.I4b&&3<ee&&(ee=2,je=!0);let Ue=[];va=null;this.ap.qwb||this.uaa||!this.psa?(va=this.hja.FX(2),0!==va.errorCode&&5!==va.errorCode||va.Dw.forEach(Od=>{-1!==Od.addinInfo.priority&&Ue.push(Od)})):Ue=this.psa;sa.ULS.sendTraceTag(509687428,220,15,"The MRU list number is {0}, myAddins: {1}|{2}, adminManaged: {3}|{4}, popularAddins: {5}|{6}",ee,Pj.a[Sd.errorCode],Sd.Dw.length,Pj.a[Wd.errorCode],Wd.Dw.length,this.ap.qwb?Pj.a[va.errorCode]:
"undefined",Ue.length);P.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8365528_FlyoutAddinEntryPointDisplayMetrics")&&this.w3.S4f(ee,Sd,Wd,va);var G=[];const da=[];H&&(Array.addRange(G,this.Nti(this.zbb,pd)),Array.addRange(da,this.W4e(this.ZDb,pd)));const $a=Object.assign(new kh.a,{Id:"HeaderSection",ControlsId:"HeaderSection.Controls",ControlList:[]}),Sb=Object.assign(new Fk.a,{Id:"Ribbon.AddinPicker",MenuSectionList:[],MenuHeaderSection:this.ap.x9?$a:void 0,MenuFooterSection:this.HNi(),
UpdateDynamically:!0,IsFlexLayout:!0});if((2===Sd.errorCode||this.ap.qwb&&2===va.errorCode)&&!pd.length){Oc.push("storeDisabled");sa.ULS.sendTraceTag(509687427,220,10,"dataProvider storeDisabled error hit");var Mc=this.kxc({iconName:"StoreDisabled",DCc:Object(La.a)("AddinPickerDisableError")});Array.add(Sb.MenuSectionList,Mc)}else if(3!==Sd.errorCode||this.w3.hSg(Sd)||3!==Wd.errorCode)if(4!==Sd.errorCode||pd.length){const Od=0>=G.length&&0>=da.length;if(this.ap.x9){const se=H?String.format(Od?null!==
(ub=Object(La.a)("AddInSearchNoResultsAriaText"))&&void 0!==ub?ub:"":null!==(kc=Object(La.a)("AddInSearchResultsAriaText"))&&void 0!==kc?kc:"",this.zbb):null;Array.add($a.ControlList,this.QAi(se))}if(H)Od&&(Mc=this.kxc({iconName:"NoSearchResults",DCc:Object(La.a)("AddInSearchNoResultsHint")}),Array.add(Sb.MenuSectionList,Mc)),0<G.length&&this.y3h(Sb,G),0<da.length&&this.I3h(Sb,da),Mc={},Mc.MRUAddins=G.map(se=>t(se)),Mc.MoreAddins=da.map(se=>t(se)),Mc.HasResults=!Od,Bc.a.sendTelemetryEvent(Object.assign(new Ob.a,
{name:"Office.Extensibility.Host.SearchingAddinsFromFlyout",dataFields:zc.a.rn(Mc)}));else{0<ee?(Sb.MenuSectionList.push(this.wNi(pd.slice(0,ee),je)),P.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&(G={["solutionIds"]:Wd.Dw.map(hf=>t(hf))},Bc.a.sendTelemetryEvent(Object.assign(new Ob.a,{name:"Office.Extensibility.Host.ShowAdminAddinFromFlyout",dataFields:zc.a.rn(G)})))):this.ap.Wda&&this.Kja.Klk(Sb);let se=this.uaa?this.SWi(Ue,pd):
this.W4e(Ue,pd);se&&0!==se.length||(Oc.push("emptyPopularAddins"),sa.ULS.sendTraceTag(507523101,220,15,"The popular addins list is empty"));se=se.slice(0,30);if(this.ap.Bta){G=this.N9a.Hyc();for(var sd of G)G=this.N9a.Iyc(sd,pd.map(hf=>hf.solutionId)),se=se.concat(G.filter(hf=>!se.some(ag=>ag.solutionId===hf.solutionId)));Bc.a.sendTelemetryEvent(m(Ob.a,{name:"Office.Extensibility.Host.AddInFlyoutSwitchCategory",dataFields:zc.a.i2b({["Category"]:"All"})}))}const Ye=this.ap.Ind?null===(Mc=v(this.ap.zBh,
this.ap.host))||void 0===Mc?void 0:Mc[0]:void 0;Ye&&(se=se.filter(hf=>{var ag;return Ye!==(null===(ag=hf.solutionId)||void 0===ag?void 0:ag.toLowerCase())}));Mc=[];this.ap.Wda&&(this.Kja.n6j(),se=this.Kja.cQi(se,pd.map(hf=>hf.solutionId)),Mc=this.Kja.BEi(pd.map(hf=>hf.solutionId)));sd=this.HQi(se);this.ap.Bta&&(Sb.MenuSectionList.push(this.yEi()),sd.Title="");G=this.hja.EX(Ye);this.ap.Ind&&!this.ap.Bta&&G?C(G,Sb,sd,Sd.Dw,Wd.Dw,this.ap.x9,this.ap.host):Sb.MenuSectionList.push(sd);0<Mc.length&&(Mc=
m(kh.a,{Id:"CategoryAddInListSection",ControlsId:"CategoryAddInListSection.Controls",ControlList:Mc.map(hf=>this.yxc("FRECategoryAddin"+hf.solutionId.toLowerCase(),hf)),Title:this.Kja.RHd()}),Sb.MenuSectionList.push(Mc),this.Kja.k5j())}}else Oc.push("serviceDisabled"),sa.ULS.sendTraceTag(508598107,220,10,"dataProvider serviceDisabled error hit"),Mc=this.kxc({iconName:"StoreDisabled",DCc:Object(La.a)("AddinPickerServiceDisconnectedError")}),Array.add(Sb.MenuSectionList,Mc);else Oc.push(this.w3.jFf(Sd,
Wd)),sa.ULS.sendTraceTag(509687426,220,10,"dataProvider invokeFailure error hit"),Mc=this.kxc({iconName:"Common",DCc:Object(La.a)("AddinPickerGeneralError")}),Array.add(Sb.MenuSectionList,Mc);this.ap.Wda&&this.Kja.yTh(Sb);this.ap.Ind&&z(Sb);this.ESh();0===Sb.MenuSectionList.length&&(Sb.IsFlexLayout=!1,Oc.push("emptyMenuSection"),sa.ULS.sendTraceTag(508340124,220,15,"The menu section list length is 0"));this.w3.kXg&&sa.ULS.sendTraceTag(508047442,220,15,`${Oc.join("|")}`);this.w3.N4f&&this.w3.R4f(pd.length,
Oc,Sd,Wd,va);return Sb}ESh(){window.setTimeout(()=>{var H=document.querySelector('#Ribbon-InsertAddInFlyoutDropdown > .ms-FocusZone > div[class^="root"] > div[class^="container"]');H&&(H=H.scrollTop,0<H&&(H={["scrollTopValue"]:H.toString()},Bc.a.sendTelemetryEvent(Object.assign(new Ob.a,{name:"Office.Extensibility.Host.ScrollableListView",dataFields:zc.a.rn(H)}))))},6E4)}HQi(H){const va=m(kh.a,{Id:"PopularAddinListSection",ControlsId:"PopularAddinListSection.Controls",ControlList:this.ap.Bta?H.map(ub=>
this.yxc("AddInsListItem"+ub.solutionId.toLowerCase(),ub)):H.map((ub,kc)=>this.yxc("PopularAddInsListItem"+kc,ub)),Title:Object(La.a)("PopularAddins")});P.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&(H={["solutionIds"]:H.map(ub=>t(ub))},Bc.a.sendTelemetryEvent(Object.assign(new Ob.a,{name:"Office.Extensibility.Host.ShowPopularAddinFromFlyout",dataFields:zc.a.rn(H)})));return va}yxc(H,va){const ub={default:"AddinFlyoutControl"+va.solutionId},
kc=this.ROb(va),Oc=[],pd=[],Sd=va.solutionId.toLowerCase(),Wd=Object.assign(new Mk,{text:Object(La.a)("AddinOneLink"),href:"https://appsource.microsoft.com/en-us/product/office/"+Sd});if(this.ap.BBh){const ee=Object.assign(new rk,{text:Object(La.a)("AddInFreeLabel")});switch(this.ap.host){case "Word":Yj.includes(Sd)&&Array.add(Oc,ee);break;case "PowerPoint":el.includes(Sd)&&Array.add(Oc,ee);break;case "Excel":sl.includes(Sd)&&Array.add(Oc,ee)}Array.add(Oc,Wd)}else Array.add(pd,Wd);return Object.assign(new cl.a,
{Id:H,ExternalId:H,CommandId:H,CommandIdMapped:Vf.a.nob.toString(),iconSet:ub,SecondaryLabel:null,Details:Oc,Label:va.displayName,ActionText:H.includes("PAIYO_CategoryAddinListItem")?Object(La.a)("AddinListOpen"):Object(La.a)("AddinListAdd"),Description:va.description,Links:pd,ActionId:H+"Add",ActionIdMapped:Vf.a.o_a.toString(),ActionCommandValueId:kc,CommandValueId:kc})}ROb(H){return this.uaa?String.format("{0}#{1}",H.solutionId,H.storeId):H.solutionId}sIa(H){if(!H)return null;var va=H.split("#");
if(1!==va.length&&2!==va.length)return sa.ULS.sendTraceTag(508912466,220,10,"GetAddinDetailByUniqueId: uniqueId's format is wrong"),null;H=va[0].trim();va=2===va.length?va[1].trim():P.AFrameworkApplication.uiCulture;return this.hja.EX(H,va)}ITi(H){return H?this.Myb.EX(H):null}Oaf(H){return H&&H.hasOwnProperty("solutionId")&&H.hasOwnProperty("version")&&H.hasOwnProperty("storeType")&&H.hasOwnProperty("storeId")&&H.hasOwnProperty("assetId")&&H.hasOwnProperty("assetStoreId")&&H.hasOwnProperty("targetType")&&
H.hasOwnProperty("displayName")&&H.hasOwnProperty("width")&&H.hasOwnProperty("height")?!0:!1}Evi(H){return new Promise((va,ub)=>{if(this.Oaf(H))return va(H);const kc=(new Date).getTime();this.Myb.cJg("",(Oc,pd)=>Oc?1!==pd.length||pd[0].solutionId.toLowerCase()!==H.solutionId.toLowerCase()?ub(Error("The search add-in and result add-in don't match.")):this.Oaf(pd[0])?va(pd[0]):ub(Error("The result add-in details are still not ready for install.")):ub(Error("Failed to query add-in details for install.")),
kc,H.solutionId)})}CKi(H){if(!(H.solutionId in this.Q9c)){const va="AddinGalleryButton"+this.kJe.toString();this.Q9c[H.solutionId]=va;H=this.ROb(H);this.odc[va]=H;this.odc[va+"Add"]=H;this.kJe++;return va}return this.Q9c[H.solutionId]}KMd(H){return H?this.odc[H]:null}kxc(H){var {iconName:va,DCc:ub,Grl:kc=!1,msl:Oc=Object(La.a)("AddinPickerTryAgain"),lsl:pd="ReloadAddInPicker",hil:Sd="ReloadAddInPicker"}=H;H=Object.assign(new kh.a,{Id:"ErrorSection",ControlsId:"ErrorSection.Controls",ControlList:[]});
let Wd=null;Wd=ub===Object(La.a)("AddinPickerDisableError")&&this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8668453_StoreDisabledErrorViewWithDocumentLink")?Object.assign(new Mj.a,{Id:"ErrorView",ExternalId:"ReloadAddInPickerStoreDisabled",IconName:va,Label:ub,RetryButtonTitle:kc?Object(La.a)("AddinPickerTryAgain"):"",OnRetryCommandId:"ReloadAddInPicker",AriaDescription:"StoreDisabled"===va?ub:Object(La.a)("AddinPickerTryAgainAriaLabel"),LinkText:Object(La.a)("AddinPickerDisableErrorDocumentText"),
LinkUrl:String.format("https://learn.microsoft.com/{0}/microsoft-365/admin/manage/manage-addins-in-the-admin-center?view=o365-worldwide#manage-add-in-downloads-by-turning-onoff-the-office-store-across-all-apps-except-outlook",P.AFrameworkApplication.uiCulture),OnLinkClicked:()=>{sa.ULS.sendTraceTag(507875925,220,15,"User has clicked link on add-in picker error view")}}):Object.assign(new Mj.a,{Id:"ErrorView",ExternalId:Sd,IconName:va,Label:ub,RetryButtonTitle:kc?Oc:"",OnRetryCommandId:pd,AriaDescription:"StoreDisabled"===
va?ub:Object(La.a)("AddinPickerTryAgainAriaLabel")});Array.add(H.ControlList,Wd);return H}W4e(H,va){var ub=new pf.a;for(let kc=0;kc<H.length;kc++)ub.add(H[kc]);if(this.ap.qwb||!this.psa)30<ub.count&&(ub=k(ub,(new Date).getDate())),this.psa=ub.toArray();for(H=0;H<this.psa.length;H++)for(ub=0;ub<va.length;ub++)if(this.psa[H].solutionId.toLowerCase()===va[ub].solutionId.toLowerCase()){Array.remove(this.psa,this.psa[H--]);break}return this.psa}IQi(H){var va=30,ub=(new Date).getDate();va>H.length&&(va=
H.length);var kc=new vh(ub);for(ub=new Set;ub.size<va;){const Oc=kc.next(H.length);ub.add(Oc)}for(va=0;va<H.length;va++)kc=H[va].addinInfo,ub.has(va)?kc.AUP*=20:kc.AUP=1===kc.priority?4*kc.AUP:2===kc.priority?2*kc.AUP:1*kc.AUP;H.sort((Oc,pd)=>Oc.addinInfo.AUP<pd.addinInfo.AUP?1:-1);return H}SWi(H,va){H=H.filter(ub=>!va.some(kc=>kc.solutionId.toLowerCase()===ub.solutionId.toLowerCase()));return this.IQi(H).slice(0,30)}Iek(H){if(0===H.errorCode||2===H.FL&&5===H.errorCode)H.Dw?this.uzg(H.Dw):sa.ULS.sendTraceTag(509687429,
220,10,`fail to register icons for addin collection: ${jb.a[H.FL]}`)}uzg(H){return Promise.all(H.map(va=>{var ub,kc;if(va&&va.solutionId&&va.iconUrl)return appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+va.solutionId,va.iconUrl);sa.ULS.sendTraceTag(508352214,220,10,"failed to register icon for addin: solutionId: {1}, iconUrl: {2}",null!==(ub=null===va||void 0===va?void 0:va.solutionId)&&void 0!==ub?ub:"null",null!==(kc=null===va||void 0===va?void 0:va.iconUrl)&&void 0!==kc?kc:"null");return Promise.resolve()}))}QAi(H){return Object.assign(new dl.a,
{ExternalId:"SearchAddinInFlyout",Label:Object(La.a)("AddInSearchBoxPlaceholder"),ShowIcon:!0,Underlined:!0,Value:this.zbb,ResultAriaLiveText:H,OnChangeCommandId:"SearchAddinInFlyout"})}y3h(H,va){const ub=Object.assign(new kh.a,{Id:"MRUAddinsSearchResutlsSection",ControlsId:"MRUAddinsSearchResutlsSection.Controls",ControlList:[]});Array.add(H.MenuSectionList,ub);H=this.PFf("MRUAddinsSearchResutlsGalleryControl",va,!1,!1);Array.add(ub.ControlList,H)}I3h(H,va){const ub=Object.assign(new kh.a,{Id:"PopularAddinsListSearchResutlsSection",
ControlsId:"PopularAddinsSearchResutlsSection.Controls",ControlList:[],Title:Object(La.a)("AddInSearchResultsDivider")});for(let kc=0;kc<va.length;kc++)ub.ControlList.push(this.yxc("PopularAddinsSearchResultsItem"+kc,va[kc]));Array.add(H.MenuSectionList,ub)}Nti(H,va){const ub=H.toLocaleLowerCase();H=va.filter(kc=>{this.Lyb[kc.solutionId]||(this.Lyb[kc.solutionId]=kc.displayName.toLocaleLowerCase());return this.Lyb[kc.solutionId].includes(ub)});H.sort((kc,Oc)=>this.Lyb[kc.solutionId].indexOf(ub)-this.Lyb[Oc.solutionId].indexOf(ub));
return H}xuk(H){const va=this;return No(function*(){va.ZDb=va.ap.EBh?yield va.Myb.Kuk(H):yield va.Myb.Iuk(H);yield va.uzg(va.ZDb)})}yuk(H){this.zbb=H;appChrome.api.dispatch(appChrome.actions.updateSearchBoxValue("SearchAddinInFlyout",H));this.chc&&window.clearTimeout(this.chc);this.chc=window.setTimeout(()=>{var va;this.chc=null;H?this.xuk(H).catch(()=>{this.ZDb=[];sa.ULS.sendTraceTag(507577680,220,10,"Failed to call search addins API")}).finally(()=>{var ub;this.zbb===H&&(this.Fbg=!0,null===(ub=
this.K3b)||void 0===ub?void 0:ub.call(this))}):(this.Fbg=!1,null===(va=this.K3b)||void 0===va?void 0:va.call(this))},this.cUe)}set Fbg(H){this.ap.x9||(this.fhc=!1);this.fhc=H}get E7h(){let H=!1;this.fhc&&(this.fhc=!1,H=this.ap.x9);H||(this.zbb="",this.ZDb=[]);return H}nAk(){let H;d(va=>{const ub=document.getElementById("Ribbon-InsertAddInFlyoutDropdown")||document.getElementById("InsertAddInFlyoutMenuId");ub&&va&&(H=()=>{var kc;null===(kc=document.getElementById("SearchAddinInFlyout"))||void 0===
kc?void 0:kc.focus();ub.removeEventListener("focus",H);H=void 0},ub.addEventListener("focus",H))})}k4j(H){if(H)try{H.MenuItems=this.KNi(this.E7h)}catch(va){sa.ULS.sendTraceTag(509687425,220,10,`GetReactGalleryMenu hit exception ${va.message}; stack: ${va.stack}`)}else sa.ULS.sendTraceTag(509687424,220,10,"PopulateMenu menuProps is null")}dispose(){}get w3(){this.EQa||(this.EQa=new ek("Flyout",this.Ga));return this.EQa}}Object(I.a)(wk,"AppsFlyoutGenerator",null,[2]);var yi=a(93),xk;(function(H){H.ycl=
"APIC";H.zcl="APID";H.Pcl="BBM";H.Ycl="CAIP";H.ndl="DA";H.qdl="DWT";H.Sdl="ER";H.ael="FA";H.xel="IPWAI";H.rfl="PAIYO";H.ogl="TD";H.zgl="WF";H.xgl="WN"})(xk||(xk={}));Object(I.b)("AddinCategoryType",xk);const vl={["TD"]:[{solutionId:"wa200004805",addinInfo:{diffAUP:55500}},{solutionId:"wa200006007",addinInfo:{AUP:235,diffAUP:40900,releaseDate:16947072E5}},{solutionId:"wa200006009",addinInfo:{AUP:99,diffAUP:36700,releaseDate:169488E7}},{solutionId:"wa200005502",addinInfo:{AUP:7758,diffAUP:1900}},{solutionId:"wa102957665",
addinInfo:{AUP:42189,diffAUP:1E5}},{solutionId:"wa104379220",addinInfo:{AUP:3017,diffAUP:1E5}},{solutionId:"wa200004935",addinInfo:{AUP:1948,diffAUP:1E5}}],["WN"]:[{solutionId:"wa200006017",addinInfo:{releaseDate:16951392E5}},{solutionId:"wa200006008",addinInfo:{releaseDate:169488E7}},{solutionId:"wa200005960",addinInfo:{releaseDate:16938432E5}},{solutionId:"wa200005817",addinInfo:{releaseDate:16886592E5}},{solutionId:"wa200005702",addinInfo:{releaseDate:16891776E5}},{solutionId:"wa200005782",addinInfo:{AUP:52,
releaseDate:1690128E6}},{solutionId:"wa200005777",addinInfo:{AUP:19,releaseDate:16893504E5}},{solutionId:"wa200006007",addinInfo:{AUP:235,diffAUP:40900,releaseDate:16947072E5}},{solutionId:"wa200006009",addinInfo:{AUP:99,diffAUP:36700,releaseDate:169488E7}},{solutionId:"wa200005669",addinInfo:{AUP:248,releaseDate:16874496E5}}]},wl={["PAIYO"]:[],["BBM"]:[{solutionId:"wa102957661",addinInfo:{AUP:14891}},{solutionId:"wa104104476",addinInfo:{AUP:14404}},{solutionId:"wa104381701",addinInfo:{AUP:9652}},
{solutionId:"wa104379629",addinInfo:{AUP:4E3}},{solutionId:"wa104381504",addinInfo:{AUP:1820}},{solutionId:"wa200003696",addinInfo:{AUP:1707}},{solutionId:"wa104380330",addinInfo:{AUP:793}},{solutionId:"wa104099688",addinInfo:{AUP:404}},{solutionId:"wa200005702",addinInfo:{AUP:68}}]},gl={["IPWAI"]:[{solutionId:"wa200005271",addinInfo:{AUP:12195}},{solutionId:"wa200004935",addinInfo:{AUP:1948,diffAUP:1E5}},{solutionId:"wa200001584",addinInfo:{AUP:2278}},{solutionId:"wa200005107",addinInfo:{AUP:451}},
{solutionId:"wa200005281",addinInfo:{AUP:595}},{solutionId:"wa200005333",addinInfo:{AUP:101}},{solutionId:"wa200005502",addinInfo:{AUP:7758,diffAUP:1900}},{solutionId:"wa200006007",addinInfo:{AUP:235,diffAUP:40900,releaseDate:16947072E5}},{solutionId:"wa200006009",addinInfo:{AUP:99,diffAUP:36700,releaseDate:169488E7}},{solutionId:"wa200005669",addinInfo:{AUP:248,releaseDate:16874496E5}}],["APIC"]:[{solutionId:"wa102957665",addinInfo:{AUP:42189,diffAUP:1E5}},{solutionId:"wa104381973",addinInfo:{AUP:55837}},
{solutionId:"wa104051163",addinInfo:{AUP:1643}},{solutionId:"wa104221182",addinInfo:{AUP:2980}},{solutionId:"wa104104476",addinInfo:{AUP:13287}},{solutionId:"wa200004688",addinInfo:{AUP:1260}},{solutionId:"wa104379169",addinInfo:{AUP:69}},{solutionId:"wa103147117",addinInfo:{AUP:89}},{solutionId:"wa200004179",addinInfo:{AUP:1072}},{solutionId:"wa104380194",addinInfo:{AUP:1245}},{solutionId:"wa200003220",addinInfo:{AUP:192}},{solutionId:"wa200004687",addinInfo:{AUP:226}}],["DA"]:[{solutionId:"wa200002503",
addinInfo:{AUP:461}},{solutionId:"wa200000018",addinInfo:{AUP:2210}},{solutionId:"wa200000169",addinInfo:{AUP:1962}},{solutionId:"wa104381841",addinInfo:{AUP:1010}},{solutionId:"wa200003784",addinInfo:{AUP:875}},{solutionId:"wa104381807",addinInfo:{AUP:308}},{solutionId:"wa104380711",addinInfo:{AUP:357}},{solutionId:"wa200000025",addinInfo:{AUP:1058,diffAUP:4600}},{solutionId:"wa200005782",addinInfo:{AUP:52,releaseDate:1690128E6}},{solutionId:"wa200005777",addinInfo:{AUP:19,releaseDate:16893504E5}}],
["FA"]:[{solutionId:"wa104379220",addinInfo:{AUP:3017,diffAUP:1E5}},{solutionId:"wa104381859",addinInfo:{AUP:380}},{solutionId:"wa104381717",addinInfo:{AUP:217}},{solutionId:"wa200003692",addinInfo:{AUP:295}},{solutionId:"wa104381695",addinInfo:{AUP:299}},{solutionId:"wa104380978",addinInfo:{AUP:347}}]};class yk{constructor(H,va,ub,kc,Oc,pd,Sd,Wd){Sd=void 0===Sd?null:Sd;this.wA=Wd;this.disposed=!1;this.Qjc=this.Ykc=null;this.uGb=0;this.insertTab="Insert";this.homeTab="Home";this.mWf=this.Qpe=!1;this.xwi=
1E3;this.Cwi="AddinFlyoutFeedbackSurvey";this.Dwi=15E3;this.tpe=!0;this.W6e=!1;this.ANh=P.AFrameworkApplication.fa.la("IsNewStringEnabled")?`[{"title":"${CommonUiStrings.AddInCategoryTitleAddingPicturesIconsAndCharts}","solutionIds":["wa102957665","wa104381973","wa104051163","wa104104476","wa104379279","wa200000113","wa104380662","wa200004688","wa104379169","wa103147117","wa200004179","wa104380194","wa200003220","wa200004687"]},{"title":"${CommonUiStrings.AddInCategoryTitleImprovingProductivityWithAI}","solutionIds":["wa200005271","wa200004935","wa200001584","wa200005281","wa200005333"]},{"title":"${CommonUiStrings.AddInCategoryTitleDataSyncAndAnalysis}","solutionIds":["wa104100404","wa104379220","wa104380662","wa104380050","wa104381859","wa200002503","wa104381717","wa200003692","wa200000018","wa200000169","wa200001306","wa104381841","wa104379190","wa104381695","wa104380711","wa104380978","wa200003784"]}]`:
`[{"title":"${CommonUIStrings.l_AddInCategoryTitleAddingPicturesIconsAndCharts}","solutionIds":["wa102957665","wa104381973","wa104051163","wa104104476","wa104379279","wa200000113","wa104380662","wa200004688","wa104379169","wa103147117","wa200004179","wa104380194","wa200003220","wa200004687"]},{"title":"${CommonUIStrings.l_AddInCategoryTitleImprovingProductivityWithAI}","solutionIds":["wa200005271","wa200004935","wa200001584","wa200005281","wa200005333"]},{"title":"${CommonUIStrings.l_AddInCategoryTitleDataSyncAndAnalysis}","solutionIds":["wa104100404","wa104379220","wa104380662","wa104380050","wa104381859","wa200002503","wa104381717","wa200003692","wa200000018","wa200000169","wa200001306","wa104381841","wa104379190","wa104381695","wa104380711","wa104380978","wa200003784"]}]`;
this.p_i=(ee,je,Ue,G)=>{if(ee){if(ee=this.sIa(ee,G))ee={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(ee.solutionId,ee.storeType,ee.assetId,ee.storeId)},ee.href=je,ee.UILocation=Ue,ee.ControlId=G,Bc.a.sendTelemetryEvent(Object.assign(new Ob.a,{name:"Office.Extensibility.Host.AddInListLinkClickedFromFlyout",dataFields:zc.a.rn(ee)}))}else sa.ULS.sendTraceTag(509089754,220,10,"Unique id is null.")};this.Jlk=()=>{this.Qjc?this.Qjc.Wrg():sa.ULS.sendTraceTag(507896192,220,10,"_addInCategoryManager is null")};
this.a1i=(ee,je,Ue)=>{(ee=this.sIa(ee,Ue))?this.UD.Evi(ee).then(G=>{const da={};da.solutionId=G.solutionId;da.version=G.version;da.storeType=G.storeType;da.storeId=G.storeId;da.assetId=G.assetId;da.assetStoreId=G.assetStoreId;da.targetType=G.targetType;da.displayName=G.displayName;da.width=G.width;da.height=G.height;this.yMf(je,Ue,da)}).catch(G=>{sa.ULS.sendTraceTag(507631067,220,10,G.message)}):sa.ULS.sendTraceTag(507631068,220,10,"No search add-in details.")};this.Y2i=ee=>{const je=ee.substring(14);
"All"===je||Object.values(xk).some(Ue=>Ue===je)?this.UD.ITk(je):sa.ULS.sendTraceTag(507564195,220,10,`Bad category switch. SourceControlId=${ee}.`)};this.$2i=()=>{this.UD?this.UD.u0i():sa.ULS.sendTraceTag(507523100,220,10,`Bad fre content switch. appsFlyoutGenerator is valid: ${!!this.UD}`)};this.Z2i=ee=>{(ee=ee.SourceControlId)&&this.UD?this.UD.t0i(ee):sa.ULS.sendTraceTag(507560522,220,10,`Bad fre banner switch. SourceControlId=${ee}; appsFlyoutGenerator is valid: ${!!this.UD}`)};this.$0i=(ee,je,
Ue)=>{if(this.x9&&(null===Ue||void 0===Ue?0:Ue.startsWith("PopularAddinsSearchResultsItem")))this.a1i(ee,je,Ue);else{if(this.UD.uaa){ee=this.sIa(ee,Ue);if(!ee){sa.ULS.sendTraceTag(508872144,220,10,"Fail to get a valid AddinDetail with provided unique id.");return}ee=ee.H8b()}else ee=this.eFf(ee,Ue);ee?this.yMf(je,Ue,ee):sa.ULS.sendTraceTag(509362325,220,10,"Get add-in entitlement fails.")}};this.yMf=(ee,je,Ue)=>{const G={[ha.a.Ata]:Ue,[Xa.a.Wk]:this.ri.CGa(Ue)},da=new Re.a(-741808261,0,this.$.Rh,
ee,"");this.$.Ma.dh(da,G);this.ri.k3a("installAddinFromFlyout",OSF.AgaveHostAction.ClickTrust,Ue);ee={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Ue.solutionId,Ue.storeType,Ue.assetId,Ue.storeId),["UILocation"]:ee,["ControlId"]:je,["FRECategory"]:this.Bta?this.UD.nJg:void 0,["FRECarouselCategory"]:this.Wda?this.UD.fzf:void 0};Bc.a.sendTelemetryEvent(Object.assign(new Ob.a,{name:"Office.Extensibility.Host.InstallPopularAddinFromFlyoutListView",dataFields:zc.a.rn(ee)}))};this.XNd=(ee,
je,Ue)=>{Ue=void 0===Ue?null:Ue;if(ee)if(ee=this.sIa(ee,Ue)){var G=this.ri.wl;G=G?G.getAppUILocale()||"en-US":"en-US";this.Ykc=new Wj(ee.solutionId,"wac_excel",G,da=>{this.ri.k3a("installAddinFromFlyout",OSF.AgaveHostAction.ClickTrust,da);const $a=new Re.a(-741808261,0,this.$.Rh,je,null);this.$.Ma.dh($a,{[ha.a.Ata]:da,[Xa.a.Wk]:this.ri.CGa(da)});this.Ykc&&this.Ykc.hide();za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PopularAddinInstalledTelemetryEnabled",!0)&&(da={["SolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(da.solutionId,
da.storeType,da.assetId,null,null,da.storeId),["UILocation"]:je,["ControlId"]:Ue,["FRECategory"]:this.Bta?this.UD.nJg:void 0,["FRECarouselCategory"]:this.Wda?this.UD.fzf:void 0},Bc.a.sendTelemetryEvent(Object(kf.a)(new Ob.a,{name:"Office.Extensibility.Host.InstallPopularAddinFromFlyout",dataFields:zc.a.rn(da)})))});this.Ykc.initializeAndShow("",null,null)}else sa.ULS.sendTraceTag(508872143,220,10,"Can not find a valid addinDetail with provided unique id.");else sa.ULS.sendTraceTag(509362328,220,10,
"Unique id is null.")};this.h1i=(ee,je,Ue)=>{var G;if(ee){if(this.UD.uaa){ee=this.sIa(ee);if(!ee){sa.ULS.sendTraceTag(508872141,220,10,"Can not find a valid addinDetail with provided unique id");return}ee=ee.H8b()}else if(ee=this.eFf(ee),!ee){sa.ULS.sendTraceTag(509089755,220,10,"Get add-in entitlement fails.");return}var da={[ha.a.Ata]:ee,[Xa.a.Wk]:this.ri.CGa(ee)},$a=new Re.a(-741808261,0,this.$.Rh,je,"");this.$.Ma.dh($a,da);null===(G=this.MQf)||void 0===G?void 0:G.OBj(ee.solutionId);za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MRUAddinInstalledTelemetryEnabled",
!0)&&(je={["SolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(ee.solutionId,ee.storeType,ee.assetId,null,null,ee.storeId),["UILocation"]:je,["ControlId"]:Ue},Bc.a.sendTelemetryEvent(Object(kf.a)(new Ob.a,{name:"Office.Extensibility.Host.InstallMRUAddinFromFlyout",dataFields:zc.a.rn(je)})))}else sa.ULS.sendTraceTag(509362326,220,10,"UniqueId is null.")};this.sIa=(ee,je)=>this.x9&&(null===je||void 0===je?0:je.startsWith("PopularAddinsSearchResultsItem"))?this.UD.ITi(ee):this.UD.uaa?this.UD.sIa(ee):
this.ON.EX(ee);this.xKj=(ee,je)=>{if(je)if(je)if(ee=je.Jr){if(gd()||ac()){const G=this.$.ea.workbookContext.WebExtensions;if(G){let da=!1;for(var Ue of G)if(Ue.PrimaryMarketplace.SolutionId.toLowerCase()===ee.solutionId.toLowerCase()){da=!0;break}if(!da){sa.ULS.sendTraceTag(512258444,220,15,"Not find add-in persisted in the template file.");return}}else{sa.ULS.sendTraceTag(512258443,220,15,"Has no add-in persisted in the file.");return}}je=je.qw;Ue=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();
if(ee.solutionId in Ue)je=Ue[ee.solutionId];else if(je=this.dGi(je),void 0===je||null===je){sa.ULS.sendTraceTag(528098434,220,15,"addinCommandControlId is NullOrUndefined");return}Ue=new Re.a(Vf.a.Pda,0,0,2,null);this.executeCommand(0,Ue,{["SourceControlId"]:je},null);ee.isAutoLaunched=!0}else sa.ULS.sendTraceTag(528098435,220,15,"insertionParam is null");else sa.ULS.sendTraceTag(528098436,220,15,"agaveParams is null");else sa.ULS.sendTraceTag(528098437,220,15,"No args for OnAutoLaunchAddin event")};
this.aXj=(ee,je)=>{null==je?Bc.a.sendTelemetryEvent(Object(kf.a)(new Ob.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:zc.a.rn({["AppTeachingUICalloutAction"]:"InvalidEventArgs",["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"})})):za.EwaSettings.isChangeGateEnabled("OfficeVSO:8180233_AddNullCheck")&&isNullOrUndefined(this.$)||(this.Ewb=new Ri(this),this.Ewb.Bfk(je),ee=this.$.Ma,za.EwaSettings.isChangeGateEnabled("OfficeVSO:8058447_FixCDTeachingCalloutAnchorAfterFlyoutEnabled")&&
this.yGb?this.vAa?(je=appChrome.selectors.getSelectedTabId())&&rc.a(je,this.homeTab)?this.Ewb.ASg():null!==ee&&(ee.vnd(this.X8d),sa.ULS.sendTraceTag(508564945,220,50,"Register home tab switched event")):sa.ULS.sendTraceTag(508564944,802,50,"selector is not ready"):null!==ee&&(ee.vnd(this.X8d),sa.ULS.sendTraceTag(527286663,220,50,"Register tab switched event")))};this.X8d=(ee,je)=>{ee=this.insertTab;za.EwaSettings.isChangeGateEnabled("OfficeVSO:8058447_FixCDTeachingCalloutAnchorAfterFlyoutEnabled")&&
this.yGb&&(ee=this.homeTab);je.tabName===ee&&(je=this.$.Ma,null!=je&&(je.BCg(this.X8d),sa.ULS.sendTraceTag(527286662,220,50,"Remove insertTabSwitched handler")),this.Ewb.ASg())};this.KSj=(ee,je)=>{ee=null;je&&(ee=je);(null===ee||void 0===ee?0:ee.qw)&&this.HCk(ee.qw);this.$.jm();ee&&ee.Jr&&this.JHh(ee.Jr)};this.L2k=(ee,je)=>{je.FL===jb.a.xFj&&(this.uGb|=1);je.FL===jb.a.qCh&&(this.uGb|=2);!P.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableExcelAddinFlyoutButton",
!1)&&this.oPg()&&appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("InsertAddInFlyout",!1))};this.$=H;sa.ULS.shipAssertTag(537170659,0,!(void 0===va||null===va),`AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: ${jj.a.Jea()}`);this.ri=va;this.gff=ub;this.Tkc=kc;this.Fka=Oc;this.xGb=pd;this.qx=new $k.a;this.zta=new we;this.TDd=Sd;Pb.a.aSb=Pb.a.Quf;this.Oyd=new pf.a;this.$gb=new pf.a;this.yGb&&(this.Qpe=P.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowFlyoutSurveyOnExcelEnabled",
!1),this.ON=this.ri.ON,null!==this.ON?(this.Qjc=this.BLc?new bl(P.AFrameworkApplication.fa,this.ON,this.ANh):null,this.MQf=new X(this.ON),this.UD=new wk(P.AFrameworkApplication.jh,this.ON,Vf.a.cXb.toString(),Vf.a.pob.toString(),this.I4b?"-1777747317":"1296389134",P.AFrameworkApplication.fa,this.Qjc,this.yBh?this.xEi():{},this.MQf,()=>{var ee;return null===(ee=this.wA)||void 0===ee?void 0:ee.call(this,"InsertAddInFlyout")}),this.ON.Tza(this.L2k)):sa.ULS.sendTraceTag(509362330,220,10,"addinDetailsProvider is null"))}get yGb(){return P.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8500191_EnableHomeEntrywithFlyout")&&
P.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")}get BLc(){return P.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewBackstageEnabled",!1)}get yBh(){return P.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutContentExpEnabled",!1)}get Tci(){return P.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DistinguishUserSegmentForContentExpEnabled",!1)}get x9(){return P.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchBoxEnabled",
!1)}get Wda(){return P.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFRECarouselEnabled",!1)}get Bta(){return P.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFREButtonGroupExpEnabled",!1)}get I4b(){return P.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8668457_SeeMoreSeeLessEnabled")}get isBusinessUser(){return!!P.AFrameworkApplication.Nh.IsBusinessUser}get isEduUser(){return!!P.AFrameworkApplication.Nh.IsEduUser}get isAnonymousUser(){return P.AFrameworkApplication.fa.la("IsAnonymousUser")}OMh(){return`IsBusinessUser: ${this.isBusinessUser}, IsEduUser: ${this.isEduUser}, IsAnonymousUser: ${this.isAnonymousUser}`}xEi(){const H=
this.Tci&&this.isBusinessUser?wl:vl;for(const va in gl)H[va]=gl[va];return H}dispose(){void 0!==this.xGb&&null!==this.xGb&&(this.xGb.dispose(),this.xGb=null);this.ri=this.$=null;this.disposed=!0}xHk(H,va){switch(H){case Vf.a.Pda:H=this.hHk(va);break;default:H=!1}return H}Bi(H,va){return"Dev Box"===P.AFrameworkApplication.fa.Xa("StatusBarEnvironmentNameToUse")?!1:619219938===va?(za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TempTelemetryOfInsertAddInFlyout",!1)&&Object(Yk.a)("getRibbonSubComponentStatus")&&
(H=appChrome.api.getRibbonSubComponentStatus("insertAddInFlyout"),sa.ULS.sendTraceTag(507909329,220,50,`insertAddInFlyout status=${H}`)),!this.oPg()):!1}executeCommand(H,va,ub){H=Fa.TaskExtensions.sq();var kc=va.command;va=pd=>{let Sd=null;if(!pd)return Sd;(Sd=pd.CommandValueId)||(Sd=this.UD.KMd(pd.SourceControlId));Sd||sa.ULS.sendTraceTag(508560270,220,10,"UniqueId is null.");return Sd};switch(kc){case 843847158:break;case Vf.a.cXb:this.etb();var Oc=ub.UILocation;this.BLc?(ub=va(ub),this.XNd(ub,
Oc)):(ub=ub.SourceControlId)?this.XNd(this.UD.KMd(ub),Oc):sa.ULS.sendTraceTag(509362329,220,10,"Control id is null.");break;case Vf.a.nob:this.etb();va=this.BLc?va(ub):ub.CommandValueId;Oc=ub.UILocation;kc=ub.SourceControlId;"LinkClickedPayload"===ub.Type?this.p_i(va,ub.Href,Oc,kc):this.XNd(va,Oc,kc);break;case Vf.a.Eke:this.x9&&this.UD.yuk(null!==(Oc=ub.SearchBoxNewValue)&&void 0!==Oc?Oc:"");break;case Vf.a.d8b:this.Bta&&(this.etb(),this.Y2i(ub.SourceControlId));break;case Vf.a.EZc:this.Wda&&this.Z2i(ub);
break;case Vf.a.DZc:this.Wda&&this.$2i();break;case Vf.a.hNb:this.W6e||(this.ON.Tza(this.Jlk),this.W6e=!0);break;case Vf.a.o_a:this.etb();this.$0i(ub.CommandValueId,ub.UILocation,ub.SourceControlId);break;case Vf.a.pob:this.etb();Oc=ub.UILocation;kc=ub.SqmControlId;const pd=ub.SourceControlId;if(this.BLc)ub=va(ub);else{if(!pd){sa.ULS.sendTraceTag(508440995,220,10,"ControlId is null.");break}ub=this.UD.uaa?this.UD.KMd(pd):this.UD.jZh[pd]}this.h1i(ub,Oc,null!==kc&&void 0!==kc?kc:pd);break;case -2025863019:Ph.a.Ope(ub[ha.a.Hnd].toString(),
()=>{ea.f(this.$).focus()});break;case -1777565636:Oj.a.showUILessDialog(ub[ha.a.zGb].toString());this.ri.dLk(ub[ha.a.zGb].toString());break;case 1592314317:Oj.a.hideUILessDialog(ub[ha.a.zGb].toString());this.ri.s5i(ub[ha.a.zGb].toString());break;case Vf.a.Pda:H=this.GNd(ub);break;case Vf.a.mob:this.bXb(ub);break;case Vf.a.YF:this.O8j(ub);break;case Vf.a.Mpa:this.Mpa(ub);break;case Vf.a.D6b:this.xGb.PXc();break;case Vf.a.refreshAddinCommands:this.ldk();break;case 1949669462:this.Fka.BLg(!0);break;
case -1014260128:H=this.executeDynamicAddInCommandsAPI(ub);break;default:H=xa.a(kc)}return H}ni(H,va,ub){H=!1;switch(va.command){case Vf.a.nob:case Vf.a.o_a:case Vf.a.cXb:case Vf.a.pob:case Vf.a.Eke:case Vf.a.d8b:case Vf.a.EZc:case Vf.a.hNb:H=!!ub;break;case 843847158:case -2025863019:case -1777565636:case 1592314317:case Vf.a.YF:case Vf.a.Mpa:case Vf.a.D6b:case Vf.a.refreshAddinCommands:case 1949669462:case Vf.a.mob:case -1014260128:H=!0;break;case Vf.a.Pda:H=!P.AFrameworkApplication.protectedFile}return H}oPg(){return!za.EwaSettings.isChangeGateEnabled("OfficeVSO:8162137_NullCheckForFlyoutControlEnabled")||
void 0!==this.$&&null!==this.$?P.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableExcelAddinFlyoutButton",!1)?this.$.C3&&!za.EwaSettings.Ra(174):0!==this.uGb&&this.$.C3&&!za.EwaSettings.Ra(174):(sa.ULS.sendTraceTag(508380621,220,15,"ewaControl is null"),!1)}Ji(H,va,ub){switch(va){case "PopulateAddInGallery":return za.EwaSettings.isChangeGateEnabled("OfficeVSO:7653071_PopulateAddInGalleryTelemetryEnabled")&&Bc.a.sendTelemetryEvent(Object(kf.a)(new Ob.a,{name:"Office.Extensibility.Host.PopulateAddinGallery",
dataFields:zc.a.rn({})})),za.EwaSettings.isChangeGateEnabled("OfficeVSO:8464891_ShowUserSegmentInformationEnabled")&&(H={["UserSegment"]:this.OMh()},va=new Ob.a,va.name="Office.Extensibility.Host.UserSegmentInformation",va.dataFields=zc.a.rn(H),Bc.a.sendTelemetryEvent(va)),this.UD.k4j(ub),this.Qpe&&(this.etb(),this.$sj()),!0;default:return!1}}$sj(){Y.a.instance.getItem("AddinFlyoutOnExcelSurveyShowed")&&(this.tpe=!1);this.tpe&&(window.setTimeout(()=>{const H=this.ZDf();H&&"hidden"!==H.visibility&&
(this.mWf=!0)},this.xwi),this.DAg=window.setTimeout(()=>{this.CWg=Wc.a.instance.Qi("Common.ISystemInitiatedFeedback");Y.a.instance.setItem("removeFlyoutTaskTimeoutId",this.DAg.toString());this.mWf&&this.CWg&&this.CWg.execute(H=>{const va=this.ZDf();va&&"hidden"===va.visibility&&(H.$vb(this.Cwi,null),this.tpe=!1,Y.a.instance.setItem("AddinFlyoutOnExcelSurveyShowed","1"))})},this.Dwi))}ZDf(){let H=null;try{const va=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");va&&(H=ed.a.vF(va.parentNode.parentNode.parentNode))}catch(va){sa.ULS.sendTraceTag(508911886,
220,10,"AddinFlyout get parent and parent get exception "+(va?va.toString():""))}return H}etb(){this.Qpe&&(window.clearTimeout(this.DAg),Y.a.instance.removeItem("removeFlyoutTaskTimeoutId"))}dGi(H){if(!H)return sa.ULS.sendTraceTag(528098432,220,10,"Failed to get button id for addin"),null;if((H=H.G6)&&H.NB&&0<H.NB.count)for(const va of H.NB){if(va.groups&&1===va.groups.length){H=va.groups[0];if(H.controls&&1===H.controls.length){const ub=H.controls[0];if(ub.attributes&&!ub.controlType&&ub.enabled)return ub.id}H.controls&&
sa.ULS.sendTraceTag(528098403,220,15,"It has multiple buttons")}va.groups&&sa.ULS.sendTraceTag(528098402,220,15,"It has multiple groups")}return null}get kM(){return P.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&P.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8335739_FlyoutInitializerFixEnabled")}O8j(H){if(H&&ha.a.w9 in H)if(this.ri){var va=H[ha.a.w9];this.kM?ha.a.Zkc in H&&(H=H[ha.a.Zkc],this.ri.Usb(va,H),1===H&&this.YF(va,!0)):this.YF(va,
!0)}else sa.ULS.sendTraceTag(509686150,220,10,"QueryAddinDetails: abort because ddaFacadeService is null..");else sa.ULS.sendTraceTag(509686151,220,10,"queryAddinDetailsWithActionData: invalid actionData.")}YF(H,va){va=void 0===va?!1:va;this.ri?(sa.ULS.sendTraceTag(509686149,220,50,"QueryAddinDetails: providerType: {0}, refreshRequired: {1}",H,va),this.ri.YF(H,va)):sa.ULS.sendTraceTag(508564227,220,50,"QueryAddinDetails: abort because ddaFacadeService is null.")}ldk(){if(this.Fka.zJc()){this.Fka.Cbf();
var H=this.FHd();if(H&&0<H.count)for(const va of H)H={[ha.a.w9]:va,[ha.a.v3]:4,[ha.a.jUa]:(new Date).getTime()},this.Mpa(H)}else P.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&(sa.ULS.sendTraceTag(509686148,220,50,"refreshAllAddinCommands: LoadingCompleteForAllProviders() returns {0}",this.Fka.zJc()),this.YF(10,!0),this.YF(0,!0))}Mpa(H){sa.ULS.sendTraceTag(537170657,220,50,`Launch AddinCommands entitlements list, LaunchOperationType ${H[ha.a.v3]}, DataProvider ${H[ha.a.w9]}.`);
this.Fka.ryk();window.setTimeout(()=>{if(void 0===this.ri||null===this.ri)sa.ULS.sendTraceTag(537170656,220,10,`AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: ${jj.a.Jea()}`);else{const va=new De(new Xe(this.ri.wl),lf.instance,ug.instance);va.fxh((ub,kc)=>{P.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&this.YF(H[ha.a.w9]);this.bXb(kc.properties)});va.RAh(this.aXj);va.q0k(H)}},0)}bXb(H){if(!this.disposed){sa.ULS.sendTraceTag(537170655,
220,50,`LaunchOperationType ${H[ha.a.v3]}.`);try{if(za.EwaSettings.Ra(174)){const kc=H[ha.a.vGb];if(kc&&0<kc.count){const Oc=kc.count;for(let pd=Oc-1;0<=pd;pd--){const Sd=kc.ma(pd);OSF.OsfControl.isFirstPartyStoreString(Sd.storeType)||kc.remove(kc.ma(pd))}if(kc.count<Oc){const pd=Object(yi.d)(Ta.a.resolve(ba.C,{va:0}));Fa.TaskExtensions.Ua(pd,()=>{pd.result.xm(36,null)},this.$.xa,3)}if(!kc.count)return}}if(void 0===this.ri||null===this.ri)sa.ULS.sendTraceTag(537170654,220,10,`LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: ${jj.a.Jea()}`);
else{var va=null;va=P.AFrameworkApplication.fa.la("HostInstallAddInsIsEnabled")?new bk(this.qx,this.gff,new Xe(this.ri.wl),new Jk(this.$.$h,Vf.a.Pda),this.Fka,lf.instance,this.zta,(kc,Oc)=>{const pd={};pd.InstanceId=zd.a.create().toString();pd.PrimaryMarketplace={};pd.PrimaryMarketplace.SolutionId=kc.solutionId;pd.PrimaryMarketplace.SolutionVersion=kc.version;pd.PrimaryMarketplace.MarketplaceType=kc.storeType;pd.PrimaryMarketplace.MarketplaceRef=kc.storeId;pd.WebExtensionType=1;this.ri.PNk(pd,()=>
{Oc(kc)})}):new bk(this.qx,this.gff,new Xe(this.ri.wl),new Jk(this.$.$h,Vf.a.Pda),this.Fka,lf.instance,this.zta);va.mxh(this.xKj);va.gxh(this.KSj);var ub=new Ri(this);va.kzh(ub.JSj);va.QAh(ub.KKk);this.$.ka.Ug(53).ns&&be.a.get_instance().Fm(5,null).continueWith(()=>{this.disposed||va.Itj(this.TDd,this.$.domElement,H)})}}catch(kc){sa.ULS.sendTraceTag(537170653,220,10,`LaunchAddinCommands error message : ${kc.message}.`)}}}GNd(H){const va=Fa.TaskExtensions.sq();H=H[this.qx.Hua];const ub=this.Tkc.Ckd(H),
kc=new Oj.a(this.$,this.ri,ub.ownerAddinInfo,va);return this.ALf(va,H,ub,kc)}ALf(H,va,ub,kc){this.Tkc.GNd(va,this.Fka,kc,new Xe(this.ri.wl),ub,()=>{H=kc.nYh()},()=>{ea.f(this.$).focus()});return H}JHh(H){const va=Fa.TaskExtensions.sq();var ub=this.ri.R4(H.solutionId);if(ub){var kc=this.ri.wX(ub);if(wd.HelperMethods.BF(kc)&&0!==kc.SharedRuntime.State)return}kc=this.Tkc.KHh;const Oc=H.solutionId in kc?kc[H.solutionId]:null;if(Oc){const pd=this.Tkc.Ckd(Oc),Sd=new Oj.a(this.$,this.ri,pd.ownerAddinInfo,
va),Wd=Telemetry.PrivacyRules.GetPrivacyCompliantId(H.solutionId,null!==pd.ownerAddinInfo?pd.ownerAddinInfo.storeType:H.storeType,H.assetId,null,null,H.storeId);kc=ee=>{if(ee){const je={};for(const Ue of ee)je[Ue[0]]=Ue[1];(ee=ha.a.L1e in je?je[ha.a.L1e]:null)&&"true"===ee.toLowerCase()&&(sa.ULS.sendTraceTag(537170652,220,50,`Auto-Show AddinCommands TaskPane, StoreType ${H.storeType}, StoreId ${H.storeId}, SolutionId ${Wd}.`),this.ALf(va,Oc,pd,Sd))}};sa.ULS.sendTraceTag(537170651,220,50,`Check Auto-Show AddinCommands TaskPane, StoreType ${H.storeType}, StoreId ${H.storeId}, SolutionId ${Wd}.`);
if(ub)kc(this.ri.wX(ub).OsfPropertyBag);else if(ub=this.$.ea.workbookContext.WebExtensions)for(const ee of ub)if((1===ee.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===H.targetType&&ee.PrimaryMarketplace.MarketplaceType.toLowerCase()===H.storeType.toLowerCase()&&ee.PrimaryMarketplace.MarketplaceRef.toLowerCase()===H.storeId.toLowerCase()&&ee.PrimaryMarketplace.SolutionId.toLowerCase()===H.solutionId.toLowerCase()){kc(ee.OsfPropertyBag);break}}}bte(H,va,ub){H&&(void 0===
ub||!ub||va||this.Oyd.contains(H)||this.Oyd.add(H),(ub=this.$gb.contains(H))&&va&&this.$gb.remove(H),ub||va||this.$gb.add(H))}HCk(H){if((H=H.G6)&&H.NB)for(const va of H.NB)if(va.groups)for(const ub of va.groups)if(ub.controls)for(const kc of ub.controls)if(this.bte(kc.id,kc.enabled,!0),1===kc.controlType&&kc.menuItems)for(const Oc of kc.menuItems)this.bte(Oc.id,Oc.enabled,!0)}FHd(){const H=new pf.a;za.EwaSettings.Ra(52)&&(this.$.ea.sn.get(27)&&(H.add(0),H.add(16)),this.$.ea.sn.get(33)&&H.add(1),H.add(8));
return H}executeDynamicAddInCommandsAPI(H){let va=!0;if(void 0===H||null===H||void 0===H[ha.a.IMb]||null===H[ha.a.IMb])return Ae.Task.Va(!1);switch(H[ha.a.IMb]){case 1:va=this.E3k(H);break;case 2:va=this.LCk(H);break;case 4:this.$gb.clear();this.$gb.addRange(this.Oyd);break;case 3:va=this.installContextualTab(H);break;default:va=!1}return Ae.Task.Va(va)}hHk(H){return H&&this.qx.Hua in H?(H=H[this.qx.Hua])?this.$gb.contains(H):!1:!1}E3k(H){var va=null;let ub=null,kc=null,Oc=!0;void 0!==H[ha.a.efa]&&
null!==H[ha.a.efa]&&void 0!==H[this.qx.Hua]&&null!==H[this.qx.Hua]&&void 0!==H[ha.a.dfa]&&null!==H[ha.a.dfa]&&(va=H[ha.a.efa],ub=H[ha.a.Rtc],kc=H[this.qx.Hua],Oc=H[ha.a.dfa]);if(!va||!kc)return sa.ULS.sendTraceTag(537170649,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),!1;H=(new ck.a(this.$.$h,va,this.qx,!0)).GYa(kc);va={DynamicAddinCommandsApiName:"UpdateControlEnableState"};va.AssetId=ub;va.MaskedTabId=H;va.IsToEnable=Oc;sa.ULS.sendTraceTag(537170648,220,50,Jb.a.li(va));
this.bte(H,Oc);al.a.IA.AB();return!0}LCk(H){var va,ub,kc=null,Oc=null;let pd=null;var Sd=null;let Wd=!0;void 0!==H[ha.a.DAd]&&null!==H[ha.a.DAd]&&void 0!==H[ha.a.efa]&&null!==H[ha.a.efa]&&void 0!==H[this.qx.Hua]&&null!==H[this.qx.Hua]&&void 0!==H[ha.a.dfa]&&null!==H[ha.a.dfa]&&(kc=H[ha.a.DAd],Oc=H[ha.a.efa],pd=H[ha.a.Rtc],Sd=H[this.qx.Hua],Wd=H[ha.a.dfa]);if(!kc||!Oc||!Sd)return sa.ULS.sendTraceTag(537170647,220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),!1;H=(new ck.a(this.$.$h,
Oc,this.qx,!0)).vJf(Sd);Sd={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};Sd.StoreType=kc;Sd.AssetId=pd;Sd.MaskedTabId=H;Sd.IsToShow=Wd;sa.ULS.sendTraceTag(537170646,220,15,Jb.a.li(Sd));kc=this.Fka.Iva(kc,Oc,1);Oc=!1;if(null===(ub=null===(va=null===kc||void 0===kc?void 0:kc.qw)||void 0===va?void 0:va.G6)||void 0===ub?0:ub.NB)for(const ee of kc.qw.G6.NB)if(ee.id===H){Oc=!0;break}if(!Oc)return sa.ULS.sendTraceTag(537170645,220,15,"SetRibbonTabVisible failed to get contextual tabs"),!1;va=[];Wd?
appChrome.selectors.getSelectedTabId()!==H&&va.push(appChrome.actions.activateRibbonTab(H)):(appChrome.selectors.getSelectedTabId()===H&&va.push(appChrome.actions.setCurrentTab(Va.a.lS)),va.push(appChrome.actions.deactivateRibbonTab(H)));appChrome.api.dispatch(va);return!0}eFf(H,va){if(this.ON){if(H=this.sIa(H,va))return va={},va.solutionId=H.solutionId,va.version=H.version,va.storeType=H.storeType,va.storeId=H.storeId,va.assetId=H.assetId,va.assetStoreId=H.assetStoreId,va.targetType=H.targetType,
va.displayName=H.displayName,va.width=H.width,va.height=H.height,va;sa.ULS.sendTraceTag(509362324,0,10,"Get addinDetail fail.");return null}sa.ULS.sendTraceTag(509362323,0,10,"No addinDetailManager instance.");return null}installContextualTab(H){let va=null,ub=null,kc=null;var Oc=null;if(void 0!==H[ha.a.efa]&&null!==H[ha.a.efa]&&void 0!==H[ha.a.dfa]&&null!==H[ha.a.dfa]){const pd=H[ha.a.dfa];va=H[ha.a.efa];void 0!==pd[ha.a.jXa]&&null!==pd[ha.a.jXa]&&void 0!==pd[ha.a.kXa]&&null!==pd[ha.a.kXa]&&(ub=
pd[ha.a.jXa],kc=pd[ha.a.kXa],Oc=pd[ha.a.EAd])}if(!(va&&kc&&ub&&Oc))return sa.ULS.sendTraceTag(537170644,220,15,"InstallContextualTab failed to invalid parameters"),!1;H=this.Fka.Iva(Oc.PrimaryMarketplace.MarketplaceType,Oc.PrimaryMarketplace.SolutionId,1);if(null===H||void 0===H?0:H.qw)return sa.ULS.sendTraceTag(537170643,220,15,"InstallContextualTab was called multiple times"),!1;H={};H.solutionId=Oc.PrimaryMarketplace.SolutionId;H.version=Oc.PrimaryMarketplace.SolutionVersion;H.storeType=Oc.PrimaryMarketplace.MarketplaceType;
H.storeId=Oc.PrimaryMarketplace.MarketplaceRef;Oc.AssetMarketplace?(H.assetId=Oc.AssetMarketplace.SolutionId,H.assetStoreId=Oc.AssetMarketplace.MarketplaceRef):(H.assetId=null,H.assetStoreId=null);H.targetType=Oc.WebExtensionOsfControlType;H.width=Oc.TaskpaneWidth;H.height=0;H.isAddinCommands=!0;Oc=new pf.a;Oc.add(H);H={};H[ha.a.vGb]=Oc;H[ha.a.v3]=6;H[ha.a.jXa]=ub;H[ha.a.kXa]=kc;this.bXb(H);return!0}get vAa(){return!!window.appChrome&&!!appChrome.selectors}}Object(I.a)(yk,"AddinUICommandHandler",
null,[490,39,2]);var xl=a(50);class Pk{constructor(H,va,ub,kc){this.woe=void 0===H?null:H;this.Jkd=void 0===va?null:va;this.Dyd=void 0===ub?null:ub;this.KNb=void 0===kc?0:kc}LOa(){return this.woe()}activate(){return this.Jkd()}deactivate(){this.Dyd()}dispose(){this.Dyd=this.Jkd=this.woe=null}}Object(I.a)(Pk,"FeatureActivator",null,[492,2]);var yl=a(51),hl=a(41);class zk extends qa.a{constructor(H){super(H);this.handler=null;this.zsh=()=>{sa.ULS.sendTraceTag(38410434,0,50,`AddinUICommandHandlerFactory.ActivateFeature, isEditMode [${this.$.isEditMode}] ShowCommandUI [${!!(this.$.wj&
16384)}]`);const va=new L.a;this.$.ka.Lh(53,je=>{sa.ULS.sendTraceTag(38410435,0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");va.setResult(je)});const ub=va.task,kc=new cj,Oc=wj.a.getInstance(),pd=new zf(this.$,Oc),Sd=gb.GetServiceTaskFactory.create(this.$.ka,203,this.xa,this.hh),Wd=this.Xdk(kc),ee=Object(yi.d)(Ta.a.resolve(ba.be,{va:this.hh}));return Fa.TaskExtensions.Ua(Fa.TaskExtensions.Ln([ub,Sd,Wd,ee],this.xa),()=>{sa.ULS.sendTraceTag(38942482,0,50,
"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");ba.vb.Ha()?void Ta.a.resolve(ba.vb,{va:this.hh}).then(je=>{let Ue;if(P.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchBoxEnabled",!1)||P.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutFRECarouselEnabled",!1)){const G=ub.result;Ue=da=>{var $a,Sb;return null===(Sb=null===($a=null===G||void 0===G?void 0:G.ns)||void 0===$a?
void 0:$a.wA)||void 0===Sb?void 0:Sb.call($a,da)}}else Ue=()=>{};this.handler=new yk(this.$,je,kc,new Pi,Oc,pd,Wc.a.instance.mo("Common.IExternalUICommandDefinitionMapping"),Ue);sa.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");this.cr([this.handler]);this.$.ka.ph(198,this.handler)}):Fa.TaskExtensions.Ua(gb.GetServiceTaskFactory.create(this.$.ka,106,this.xa,this.hh),je=>{je=je.result;let Ue;if(P.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutSearchBoxEnabled",
!1)){const G=ub.result;Ue=da=>{var $a,Sb;return null===(Sb=null===($a=null===G||void 0===G?void 0:G.ns)||void 0===$a?void 0:$a.wA)||void 0===Sb?void 0:Sb.call($a,da)}}else Ue=()=>{};this.handler=new yk(this.$,je,kc,new Pi,Oc,pd,Wc.a.instance.mo("Common.IExternalUICommandDefinitionMapping"),Ue);sa.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");this.cr([this.handler]);this.$.ka.ph(198,this.handler)},this.xa,3)},this.xa,3)};this.I8h=()=>{void 0!==
this.handler&&null!==this.handler?(this.$.Ma.ctb(this.handler),this.$.ka.Ula(198),this.handler=null):sa.ULS.sendTraceTag(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");this.$.ka.Ula(204);hl.a(yl.a,19,this.$.ka,198)}}Qs(){sa.ULS.sendTraceTag(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");const H=za.EwaSettings.Bn("AddinUICommandHandler"),va=H?128:2;xl.a(this.$).add(Object(kf.a)(new Pk,{woe:()=>{const ub=
(H?this.$.ea.An:this.$.ea.$O)&&this.$.ea.Ph&&!!(this.$.wj&16384)&&this.$.isEditMode;this.$.ea.Ph&&sa.ULS.sendTraceTag(38410433,0,50,`AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [${ub}] IsSessionFullyLoaded [${this.$.ea.$O}] IsSessionActive [${this.$.ea.Ph}] ShowCommandUI [${!!(this.$.wj&16384)}] IsEditMode [${this.$.isEditMode}] IsAppVisuallyReady [${this.$.ea.An}]`);return ub},Jkd:this.zsh,Dyd:this.I8h,KNb:va}))}Xdk(H){const va=Object(yi.d)(Ta.a.resolve(ba["if"],
{va:this.hh}));return Fa.TaskExtensions.Ua(va,()=>{sa.ULS.sendTraceTag(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");this.$.ka.ph(204,new Ic(va.result,H))},this.xa,3)}static Aa(H){qa.a.sx(199,new zk(H))}}Object(I.a)(zk,"AddinUICommandHandlerFactory",qa.a,[]);var Ej=a(9),Fj=a(420),il=a(1354),jl=a(1355),Qk=a(901);class hk extends Fj.a{constructor(H){super();this.$=H;this.Bl()}create(){let H;if(za.EwaSettings.Ra(355)){const va=
ba.vb.Ha()?Object(yi.d)(Ta.a.resolve(ba.vb,{va:this.hh})):gb.GetServiceTaskFactory.create(this.$.ka,106,this.$.xa,this.hh),ub=Object(yi.d)(Ta.a.resolve(ba.qd,{va:this.hh}));Fa.TaskExtensions.Ua(Ae.Task.XP(va,ub),()=>{this.Yj(Object(Qk.a)(this.$.ka,278,()=>new il.CustomFunctionsInstaller(this.$,va.result,ub.result)))},this.$.xa,3)}else H=Object(Qk.a)(this.$.ka,278,()=>new jl.CustomFunctionsLegacyInstaller(this.$)),this.Yj(H)}static Aa(H){H.ka.ph(279,new hk(H))}}Object(I.a)(hk,"CustomFunctionsInstallerFactory",
Fj.a,[]);var zl=a(59),ik=a(1383),jk=a(1382);class mi extends Fj.a{constructor(H){super();this.Qxg=this.ddaFacade=null;this.$=H;H.ka.ph(106,this);this.Bl()}get ri(){return this.ddaFacade||(this.ddaFacade=new wa.DdaFacade(this.$,this.Qxg,this.ek,null))}create(){sa.ULS.sendTraceTag(537170507,0,50,"DdaFacadeServiceFactory:Create.");P.AFrameworkApplication.disableWholeAppsForOfficeFeature?sa.ULS.sendTraceTag(537170506,0,50,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [${P.AFrameworkApplication.disableWholeAppsForOfficeFeature}]`):
za.EwaSettings.Ra(359)?Wc.a.instance.Qi("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(H=>{const va=Wc.a.instance.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper");Promise.all([H.isFeatureEnabled("mso_officeStore",!0),va.fR("WACSideloadAddins")]).then(ub=>{var [kc,Oc]=ub;wa.DdaFacade.lKb=kc;wa.DdaFacade.Gxe=Oc;this.Ghf();return null},ub=>{sa.ULS.sendTraceTag(508073758,0,10,`Unsable to fetch office store or add-in sideload enabled flag from OCPS: ${ub}.`);
return null})}):this.Ghf()}Ghf(){const H=Object(yi.d)(Ta.a.resolve(ba.j,{va:this.hh})),va=zl.a.Q_d(65,()=>!(void 0===window.OSF||null===window.OSF),this.$.ua.MaxRetriesForLoadingScript,this.$.xa,this.hh,106),ub=rd.a(this.xa,this.hh),kc=Object(yi.d)(Ta.a.resolve(ba.sc,{va:this.hh}));Fa.TaskExtensions.Ua(Fa.TaskExtensions.Ln([H,va,ub,kc],this.$.xa),()=>{"undefined"===typeof OfficeExt||"undefined"===typeof OSF?sa.ULS.sendTraceTag(537170505,0,15,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: ${jj.a.Jea()}`):
this.w9i();sa.ULS.sendTraceTag(537170504,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");this.Qxg=H.result;this.ek=kc.result;this.Yj(this.ri);sa.ULS.sendTraceTag(537170503,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.xa,3)}w9i(){za.EwaSettings.Ra(63)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new jk.a);this.$.Tj.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new jk.a,new ik.a(P.AFrameworkApplication.fa.appSettings.WebServiceBase),za.EwaSettings.Ra(70),
!0);OfficeExt.MosRequestHandler.init&&OfficeExt.MosRequestHandler.init(new jk.a);OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new jk.a)}dispose(){bb.a.Ng(this.ddaFacade);this.$=this.ddaFacade=null;super.dispose()}static Aa(H){new mi(H)}}Object(I.a)(mi,"DdaFacadeServiceFactory",Fj.a,[]);class Zj extends qa.a{constructor(H){super(H)}Qs(){ya.a(this.$,374,375,this.hh,H=>{const va=[];ba.h.Ha()||va.push(new Ea(this.$,H));ba.Vf.Ha()||va.push(new Oh(this.$,
H));this.cr(va)})}static Aa(H){qa.a.sx(76,new Zj(H))}}Object(I.a)(Zj,"AgaveCommandHandlerFactory",qa.a,[]);var kl=a(1430),Kj=a(134);class Aj{constructor(){this.ri=null;this.usb=(H,va,ub,kc,Oc)=>{if(2===ub){H=Oc?Oc:{};va=H.callback;ub=H.refresh?H.refresh:!1;if(!va)return 16;P.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType")&&null!=H.storeType?this.ri.rvg(va,ub,H.storeType):this.ri.Bce(va,ub)}return 32};this.LRc=(H,va,ub,kc,Oc)=>{if(2===ub){H=Oc?Oc:{};
va=H.Observer;if(!va)return sa.ULS.sendTraceTag(509686147,220,10,"registerAddinDetailObserver: invalid actionData: {0}",JSON.stringify(H)),16;if(!this.ri||!this.ri.ON)return sa.ULS.sendTraceTag(509671006,220,10,"registerAddinDetailObserver: ddaFacadeService or its addinDetailsProvider is null, abort the operation, actionData: {0}",JSON.stringify(H)),16;this.ri.ON.Tza(va)}return 32};this.bfk=(H,va,ub,kc,Oc)=>{2===ub&&(H=Oc?Oc.callback:null)&&this.ri.Wxh(H);return 32};this.Obj=(H,va,ub,kc,Oc)=>{2===
ub&&this.ri.k3a(null,OSF.AgaveHostAction.InsertAgave,Oc);return 32}}initialize(H){Aj.initialized||(this.ri=H,this.ko(),Aj.initialized=!0)}ko(){P.AFrameworkApplication.jh.Vk(Vf.a.usb,Kj.a.frame,this.usb,96);P.AFrameworkApplication.jh.Vk(Vf.a.LRc,Kj.a.frame,this.LRc,96);P.AFrameworkApplication.jh.Hh(Vf.a.Mdk,Kj.a.frame,this.bfk);P.AFrameworkApplication.jh.Vk(Vf.a.rSf,Kj.a.frame,this.Obj,96)}static get instance(){Aj.Wa||(Aj.Wa=new Aj);return Aj.Wa}}Aj.Wa=null;Aj.initialized=!1;Object(I.a)(Aj,"AgaveCommandActor",
null,[]);var kj=a(1497),kk=a(360),Rk=a(361);a(1146);var ll=a(1384),Sk=a(388);class Tk{constructor(){this.ste=this.YZc=null;this.rte=!1;this.pte=null;this.oZ=0;this.XZc=null}}Object(I.a)(Tk,"FirstPartyAddinTaskpaneOverrides",null,[]);class lk{constructor(){this.addressWithSheet=this.address=this.sheetName=this.sheetId=null;this.columnIndex=this.columnCount=this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=null}}Object(I.a)(lk,"IdeasSelectionContext",null,[]);class Ak extends lk{constructor(){super();
this.hasTableHeaders=this.isPivotTable=this.isTable=!1;this.tableName=null;this.userSelectedPivotTable=!1}}Object(I.a)(Ak,"IdeasTableSelectionContext",lk,[]);class Bk{constructor(H,va){this.selection=H;this.tables=va}}Object(I.a)(Bk,"IdeasXLIMTableBoundaries",null,[]);var ml=a(1100),Uk=a(1535),Fi=a(1240),nl=a(150),mk=a(419),Ck=a(189),Qj=a(151);class ol extends Vj.a{constructor(){super();this.x8="calc(100% - 46px)";this.xja="15px";this.y8="0";this.rAb="WACDialogPanel";this.tN=695;this.sAb=462;this.qL=
"80%";this.czb=350;this.DCa="100%";this.Bh=5;this.Lk="AppsForOfficeInsertionDialog";this.E8c=!!P.AFrameworkApplication.fa&&P.AFrameworkApplication.fa.la("OfficeAddinEnableInsertDialogAccessibilityFix")}WF(){var H;super.WF();this.zo.style.width=this.DCa;this.zo.style.height=this.x8;this.zo.style.marginTop=this.xja;this.zo.style.padding=this.y8;if(null===(H=P.AFrameworkApplication.fa)||void 0===H?0:H.isChangeGateEnabled("AddInDialogBugFix"))this.C2.classList.add("AddInDialog"),this.zo.classList.add("AddInDialog")}Nza(){this.zo.style.width=
this.DCa;this.zo.style.height=this.x8;this.zo.style.marginTop=this.xja;this.zo.style.padding=this.y8;this.tN>ki.a.iba?(this.Xg.style.width=String.format("{0}px",ki.a.iba),this.Xg.style.overflowX="scroll",P.AFrameworkApplication.isRtl?this.Xg.style.right="0":this.Xg.style.left="0"):(this.Xg.style.width=String.format("{0}px",this.tN),this.Xg.style.overflowX="hidden");this.Xg.offsetHeight>ki.a.k1||this.sAb+50>ki.a.k1?(this.Xg.style.height=String.format("{0}px",ki.a.k1),this.Xg.style.overflowY="scroll",
this.Xg.style.top="0",P.AFrameworkApplication.isRtl?this.Xg.style.right="0":this.Xg.style.left="0",this.E8c||(this.Xg.style.marginTop="-48px"),this.zo.style.minHeight=String.format("{0}px",this.czb)):(this.Xg.style.overflowY="hidden",this.Xg.style.top="10%",this.Xg.style.height=this.qL);this.ila()}ila(){if(this.Xg){var H=this.Xg.style.zIndex;this.Xg.style.zIndex="-9999";if(this.tN>ki.a.iba)P.AFrameworkApplication.isRtl?this.Xg.style.marginRight="0":this.Xg.style.marginLeft="0";else{const va=String.format("{0}px",
Math.floor(-this.Xg.offsetWidth/2));P.AFrameworkApplication.isRtl?this.Xg.style.marginRight=va:this.Xg.style.marginLeft=va;P.AFrameworkApplication.isRtl?this.Xg.style.right="50%":this.Xg.style.left="50%"}this.Xg.style.zIndex=String(H)}else sa.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")}GS(){super.GS();const H=document.getElementById(this.Jo(this.rAb));H.style.width=String.format("{0}px",this.tN);H.style.height=this.qL}get Vla(){return this.zo}}Object(I.a)(ol,"AppsForOfficeInsertionDialog",
Vj.a,[372]);class Vk extends Vj.a{constructor(H,va,ub){H=void 0===H?!0:H;va=void 0===va?!0:va;ub=void 0===ub?null:ub;super();this.x8="calc(100% - 46px)";this.xja="15px";this.y8="0";this.rAb="WACDialogPanel";this.tN=695;this.sAb=462;this.qL="80%";this.czb=350;this.DCa="100%";this.fHe=this.YGe=this.Ura=null;this.rHe="auto";this.sHe="5px";this.tHe="auto";this.qHe="40px";this.pcc="100px";this.tAb="200px";this.Bh=5;this.Lk="SDXDialog";this.lec=H;this.FRb=va;this.mcc=ub}WF(){super.WF();this.zo.style.width=
this.DCa;this.zo.style.height=this.x8;this.zo.style.marginTop=this.xja;this.zo.style.padding=this.y8}Nza(){this.zo.style.width=this.DCa;this.zo.style.height=this.lec?this.x8:"100%";this.zo.style.marginTop=this.lec?this.xja:"0px";this.zo.style.padding=this.y8;if(this.lec){this.pcc&&this.tAb&&(this.tN=parseInt(this.tAb.substring(0,this.tAb.length-2)),this.qL=this.pcc);this.tN>ki.a.iba?(this.Xg.style.width=String.format("{0}px",ki.a.iba),this.Xg.style.overflowX="scroll",P.AFrameworkApplication.isRtl?
this.Xg.style.right="0":this.Xg.style.left="0"):(this.Xg.style.width=String.format("{0}px",this.tN),this.Xg.style.overflowX="hidden");if(this.Xg.offsetHeight>ki.a.k1||this.sAb+50>ki.a.k1)this.Xg.style.height=String.format("{0}px",ki.a.k1),this.Xg.style.overflowY="scroll",this.Xg.style.top="0",P.AFrameworkApplication.isRtl?this.Xg.style.right="0":this.Xg.style.left="0",this.zo.style.minHeight=String.format("{0}px",this.czb);else{this.Xg.style.overflowY="hidden";const H="%"===this.qL.substring(this.qL.length-
1,this.qL.length),va=H?parseInt(this.qL.substring(0,this.qL.length-1)):parseInt(this.qL.substring(0,this.qL.length-2));this.Xg.style.top=H?(100-va)/2+"%":100*(ki.a.k1-va)/ki.a.k1/2+"%";this.Xg.style.height=this.qL}this.ila()}else this.Xg.style.left=this.rHe,this.Xg.style.right=this.sHe,this.Xg.style.top=this.tHe,this.Xg.style.bottom=this.qHe,this.Xg.style.width=this.tAb,this.Xg.style.height=this.pcc,this.Xg.style.overflowX="hidden",this.Xg.style.overflowY="hidden"}ila(){if(this.Xg){var H=this.Xg.style.zIndex;
this.Xg.style.zIndex="-9999";if(this.tN>ki.a.iba)P.AFrameworkApplication.isRtl?this.Xg.style.marginRight="0":this.Xg.style.marginLeft="0";else{const va=String.format("{0}px",Math.floor(-this.Xg.offsetWidth/2));P.AFrameworkApplication.isRtl?this.Xg.style.marginRight=va:this.Xg.style.marginLeft=va;P.AFrameworkApplication.isRtl?this.Xg.style.right="50%":this.Xg.style.left="50%"}this.Xg.style.zIndex=String(H)}else sa.ULS.sendTraceTag(524892188,306,10,"_divMessageBox is null in CenterDialog()")}GS(){super.GS();
const H=document.getElementById(this.Jo(this.rAb));H.style.width=String.format("{0}px",this.tN);H.style.height=this.qL}get Ega(){return this.lec}get Vla(){return this.zo}get instanceId(){return this.Ura}set instanceId(H){this.Ura=H}get Dsc(){return this.YGe}set Dsc(H){this.YGe=H}get Ksc(){return this.fHe}set Ksc(H){this.fHe=H}vzk(H,va,ub,kc){this.rHe=H;this.sHe=va;this.tHe=ub;this.qHe=kc}xzk(H,va){this.pcc=H;this.tAb=va}}Object(I.a)(Vk,"SDXDialog",Vj.a,[]);var lj=a(1098),pl=a(103),Wk=a(266),Gj;(function(H){H[H.Valid=
2]="Valid";H[H.Invalid=4]="Invalid";H[H.All=6]="All"})(Gj||(Gj={}));Object(I.b)("MetadataState",Gj);var qj=a(387),ql=a(903),Rj=a(1101);class vg extends oj.a{constructor(H,va,ub,kc,Oc,pd,Sd){super();this.GOa={};this.Cke={};this.cFd={};this.ZMa=this.sdxDialog=this.nna=null;this.fQg=this.Uee=!1;this.SPk=new Map([["InsertAddInsFromBackstage","Backstage"],["InsertAppsForOffice","Ribbon"],["LaunchAddinDialogFromTellMe","TellMe"],["TeachingCallout","TeachingCallout"],["AddinFlyoutMoreButton","AddinFlyoutSeeAll"],
["InsertMoreAddInsFromFooter","InsertMoreAddInsFromFooter"],["InsertMoreAddInsFromBackstageFooter","InsertMoreAddInsFromBackstageFooter"],["LaunchMyAddInsFromBackstage","BackstageSeeAll"]]);this.lMc=()=>{this.ZMa=null};this.Uwk=Wd=>{const ee=this;return No(function*(){yield ee.Bo.submitCustomMessage(Object.assign(new ml.a,{message:new Uk.a({authToken:Wd})}))})};this.g1i=(Wd,ee,je,Ue,G)=>{if(2!==je)return 32;this.fJc(G);return 32};this.dXb=(Wd,ee,je,Ue,G)=>{2===je&&(this.Fhf(),Wd=G.CommandValueId,
ee=[],ee.push(G.SourceControlId),ee.push(Wd),ee.push(null),this.ri.q3f(this.nna.Vla,ee));return 32};this.fJc=Wd=>{var ee=Wd[lj.a.GNb];Wd=Wd[lj.a.Roa];var je=Wd.ik[Zg.a.Glf];const Ue=Wd.ik[Zg.a.Llf],G=Wd.ik[Zg.a.dialogTitle],da=Wd.ik[Zg.a.dialogHeight],$a=Wd.ik[Zg.a.dialogWidth],Sb=Wd.ik[Zg.a.dialogLeft],Mc=Wd.ik[Zg.a.Klf],sd=Wd.ik[Zg.a.dialogTop],Od=Wd.ik[Zg.a.Alf];var se=Wd.ik.InstanceToken;se=null!=se?se:(new zd.a(Qc.a.create(),1)).toString();this.sdxDialog=new Vk(je,Ue);null!=Sb&&null!=Mc&&null!=
sd&&null!=Od&&this.sdxDialog.vzk(Sb,Mc,sd,Od);null!=da&&null!=$a&&this.sdxDialog.xzk(da,$a);this.sdxDialog.instanceId=se;this.sdxDialog.Dsc=Wd.ik[Zg.a.Dsc];this.sdxDialog.Ksc=Wd.ik[Zg.a.Ksc];this.sdxDialog.initializeAndShow(G,null,null);je={};je.div=this.sdxDialog.Vla;je.id=se;je.solutionId=ee.getId();je.version=ee.LQa;je.storeType=ee.getStoreType();je.storeId=ee.getStoreId();je.assetId=null;je.assetStoreId=null;je.settings=null!=Wd.Iw?Wd.Iw:{};je.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;
je.osfControlType=OSF.OsfControlType.ContainerLevel;je.sourceLocationOverrideResourceId=Wd.ik[Zg.a.sourceLocationOverrideResourceId];je.featureGates=P.AFrameworkApplication.fa.RDf(ee.getId());je.onExtensionLaunchCallback=Wd.ik[Zg.a.onExtensionLaunchCallback];ee={};ee.InstanceId=je.id;ee.WebExtensionType=2;ee.PrimaryMarketplace={};ee.PrimaryMarketplace.SolutionId=je.solutionId;ee.PrimaryMarketplace.MarketplaceType=je.storeType;ee.PrimaryMarketplace.MarketplaceRef=je.storeId;ee.PrimaryMarketplace.SolutionVersion=
je.version;ee.SrcLocationOverrideResourceId=je.sourceLocationOverrideResourceId;ee.WebExtensionOsfControlType=6;ee.OnExtensionLaunchCallback=je.onExtensionLaunchCallback;this.GOa[je.solutionId]=je.settings;const {JQc:Ye,fOb:hf}=this.WKc([],je.solutionId);ee.OsfPropertyBag=Ye;ee.HostPropertyBag=hf;this.ri.vWa(ee);this.ri.wl.insertOsfControl(je)};this.R2i=(Wd,ee,je,Ue,G)=>{if(2!==je)return 32;const da=G[lj.a.GNb];var $a=G[lj.a.$Va];const Sb=G[lj.a.Roa];if(null!=Sb.ik[Zg.a.actionName])return this.ZLf(Wd,
ee,je,Ue,G);Wd=new kj.a;Wd.qcj=Sb.ik.InstanceToken;Wd.vs=Sb.ik[Zg.a.vs];Wd.VV=Sb.ik[Zg.a.VV];Zg.a.taskPaneWidth in Sb.ik&&(Wd.taskPaneWidth=Sb.ik[Zg.a.taskPaneWidth]);Wd.sourceLocationOverrideResourceId=Sb.ik[Zg.a.sourceLocationOverrideResourceId];Wd.onTaskPaneClose=Sb.ik[Zg.a.onTaskPaneClose];Wd.onExtensionLaunchCallback=Sb.ik[Zg.a.onExtensionLaunchCallback];Wd.showLoadingSpinner=Sb.ik[Zg.a.showLoadingSpinner];Wd.tH=Sb.Iw;Wd.$Va=$a;$a=new Re.a(-859308420,0,2,0,"");ee=da.getStoreType()===OSF.StoreType.Sdx;
je=new Fi.a;je.V$=Sb.ik.HeaderCssClass||uc.a.tNb;je.Uwb=Sb.ik.TitleCssClass;this.J7($a,da.getId(),Wd,ee,je);return 32};this.t2i=(Wd,ee,je,Ue,G)=>{if(2!==je)return 32;Wd=G[lj.a.GNb].getId();G=G[lj.a.Roa].ik[Zg.a.sourceLocationOverrideResourceId];return Wd?(this.ri.wl.refreshOsfControl(Wd,G),32):8};this.b5j=Wd=>{Wd=Wd.Result;if(Wd=null===Wd?null:Wd.SolutionId)this.ri.GZe(Wd),eg.a(this.$).fOa(3,Wd)};this.ysg=(Wd,ee)=>{var je;const Ue=(Wd=Wd.Result)?Wd.AgaveData:null;if(Ue){var G=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ue.PrimaryMarketplace.SolutionId,
Ue.PrimaryMarketplace.MarketplaceType,null===(je=null===Ue||void 0===Ue?void 0:Ue.AssetMarketplace)||void 0===je?void 0:je.SolutionId,null,null,Ue.PrimaryMarketplace.MarketplaceRef);sa.ULS.shipAssertTag(537170434,0,Ue.TaskpaneWidth===vg.Ekf,`Taskpane width is ${Ue.TaskpaneWidth}, assetId is ${G}.`);if(je=this.cFd[Ue.PrimaryMarketplace.SolutionId])je.YZc&&(Ue.TaskpaneTitle=je.YZc),je.ste&&(Ue.TaskpaneTitleTag=je.ste),je.rte&&(Ue.ShowResizeChatButton=je.rte),je.XZc&&(Ue.TaskpaneIconId=je.XZc),je.pte&&
(Ue.TaskpaneButtonTooltip=je.pte),0<je.oZ&&(Ue.TaskpaneWidth=je.oZ);ee&&(Ue.FocusOnIframeWhenLoaded=ee.focusOnIframeWhenLoaded,ee.width&&(Ue.TaskpaneWidth=ee.width),Ue.TaskpaneIconCssClass=ee.Dx,Ue.TaskpaneHeaderCssClass=ee.V$,Ue.TaskpaneTitleCssClass=ee.Uwb,Ue.IsFirstPartyOptOutAppContextOptmization=ee.isFirstPartyOptOutAppContextOptmization,Ue.ShowLoadingSpinner=ee.showLoadingSpinner);if(this.GOa[Ue.PrimaryMarketplace.SolutionId]){const {JQc:da,fOb:$a}=this.WKc(Ue.OsfPropertyBag,Ue.PrimaryMarketplace.SolutionId);
Ue.OsfPropertyBag=da;Ue.HostPropertyBag=$a}yb.a(Ue)||(Ue.WebExtensionOsfControlType=1);Ue.OnExtensionLaunchCallback=this.Cke[Ue.PrimaryMarketplace.SolutionId];Ue&&(this.ri.GZe(Wd.SolutionId),this.ri.vWa(Ue))}else sa.ULS.sendTraceTag(593285650,220,50,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};this.ZLf=(Wd,ee,je,Ue,G)=>{if(2!==je)return 32;if(Rc.a.qm(G))return 8;Wd=G[lj.a.mef];if(Wd!==me.a.action&&Wd!==me.a.taskpane)return 8;ee=G[lj.a.Roa];return ee?(Wd=
(Wd=this.SPi(G))?this.ri.R4(Wd):null)?(G=this.ri.W_h(G[lj.a.$Va],ee.ik[Zg.a.Akd]),za.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&(je=this.ri.wX(Wd),je.TaskpaneTitle!==ee.ik[Zg.a.vs]&&(je.TaskpaneTitle=ee.ik[Zg.a.vs],je.TaskpaneIconCssClass=ee.ik.IconCssClass,je.TaskpaneIconUrl=ee.ik.TaskPaneIconUrl,je.TaskpaneIconId=ee.ik.TaskPaneIconId,je.OnExtensionLaunchCallback=ee.ik[Zg.a.onExtensionLaunchCallback],za.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")?
(ee=this.ri.wl,ee.changeIframeTitle(Wd,je.TaskpaneTitle),je=ee.getOsfControl(Wd),ee.raiseOsfControlStatusChange(je)):(ee=this.ri.wl.getOsfControl(Wd),this.ri.wl.raiseOsfControlStatusChange(ee)))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Wd,G,this.S4b),32):8:8};this.S4b=(Wd,ee)=>{this.ri.evi(Wd,ee)};this.PRc=()=>{void Ta.a.resolve(ba.gg,{va:1}).then(Wd=>{Wd.Zfa()})};this.$=H;this.viewBlockContainerHelpers=ub;this.ri=va;this.Wp=Oc;this.yCh=pd;this.QIj=Sd;this.Wp.Hh(Vf.a.hRg,
Kj.a.frame,this.R2i);this.Wp.Hh(Vf.a.sFg,Kj.a.frame,this.t2i);this.Wp.Hh(Vf.a.Suf,Kj.a.frame,this.ZLf);this.Wp.Hh(Vf.a.fJc,Kj.a.frame,this.g1i);this.Wp.Hh(Vf.a.dXb,Kj.a.frame,this.dXb);this.fQg=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Augloop.ShowChatPaneAfterSendToken",!1);this.$.ea.k0e(this.lMc)}Tyh(H){this.addHandler(vg.z9d,H)}tjk(H){this.removeHandler(vg.z9d,H)}dispose(){bb.a.Ng(this.nna);this.nna=null;!za.EwaSettings.fl()&&this.Uee&&(this.$.ea.dv(this.PRc),this.Uee=!1);super.dispose()}isd(){this.nna&&
this.nna.hide()}YQk(H,va){var ub;if(H){this.raiseEvent(vg.z9d);const kc=H.split("|");this.Wxj(H,va,kc);this.Fhf();this.ri.q3f(this.nna.Vla,kc);window[vg.FBh]=null!==(ub=this.SPk.get(H))&&void 0!==ub?ub:"Unknown"}}Fhf(){const H=va=>{0===va&&(this.ri.k3a("",OSF.AgaveHostAction.RefreshAddinCommands,{}),Bc.a.sendTelemetryEvent(Object.assign(new Ob.a,{name:"Office.Extensibility.Host.RefreshAddinsAfterClosingDialog"})))};this.nna=new ol;this.nna.initializeAndShow("",za.EwaSettings.isChangeGateEnabled("OfficeVSO:8619119_RefreshAddinsAfterClosingDialog")?
H:null,null)}TNd(H,va){var ub=Fa.TaskExtensions.sq();if(-515602470===va.command||-167264441===va.command||-336193495===va.command||-1444574190===va.command)ub=this.R0i(H,va);418618014===va.command&&(ub=new kj.a,ub.vs=Lc.a.instance.ia(1823),ub=this.J7(va,vg.a5i,ub,!0));if((va.tabName===this.$.$h+Va.a.aGg||va.tabName===Va.a.b7)&&2===va.lk||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback Tutorials".split(" "),H[Xa.a.Ai])||H[Xa.a.Ai]===Va.a.CI)return this.sMf(H,va);if(7===va.lk&&H.SourceControlId===
this.$.$h+Va.a.vJa)return H.MenuItemId=Va.a.Hde,this.sMf(H,va);1221897806===va.command&&(ub=this.PQg(va,"Format"));if(1930653487===va.command||1172793074===va.command)ub=this.PQg(va,"Data");-1753056834===va.command&&(ub=this.iMk(va));if(932597253===va.command){sa.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested");pl.c(932597253,!0);ub=new kj.a;ub.vs=Lc.a.instance.ia(2163);ub.sourceLocationOverrideResourceId=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",
!1)?vg.n5j:vg.p5j;ub.focusOnIframeWhenLoaded=!0;ub.taskPaneWidth=vg.sQf;var kc={};kc.LaunchSource=Object(Da.a)(String,H.SourceControlId);kc.LaunchMode="Default";ub.tH=kc;ub=this.J7(va,vg.o5j,ub,!0)}301511274===va.command&&(ub=this.xMk(va));if(515196233===va.command){ub=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8093484_EnableCoauthCheckOnOptimize");if(kc=Ta.a.Zg(ba.ke))kc.s0(),ub&&kc.lbj();kc=new kj.a;kc.vs=Lc.a.instance.ia(2237);const Oc={};Oc.SourceUILocation=kk.a[va.lk];Oc.TaskPaneVisualRefreshEnabled=
za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskPaneVisualRefreshEnabled",!1);ub&&(Oc.SessionID=this.$.ea.sessionId,Oc.EnableCoauthCheckOnOptimize=ub);kc.tH=Oc;ub=new Fi.a;ub.V$=uc.a.tNb;ub=this.J7(va,vg.q_j,kc,!0,ub,void 0,kc.vs)}1723441034===va.command&&(ub=new kj.a,ub.vs=Lc.a.instance.ia(2249),ub.focusOnIframeWhenLoaded=!0,ub.taskPaneWidth=vg.y8j,kc=new Fi.a,kc.V$=uc.a.Drf,ub=this.J7(va,Wk.e,ub,!0,kc));P.AFrameworkApplication.Baa(Wk.a)&&H.LoadDataFromPictureTaskpane&&(ub=
{},kc=new kj.a,kc.vs=Lc.a.instance.ia(2276),ub.SessionID=H.SessionID,kc.tH=ub,kc.focusOnIframeWhenLoaded=!0,ub=this.J7(va,H.DataFromPictureAssetId,kc,!0));762629271===va.command&&(this.r5i(),ub=Fa.TaskExtensions.sq());-1997160483!==va.command&&1485761473!==va.command||!Ba.a.FU()||(ub=this.V_i(H,va),Ba.a.cTd()&&this.yCh.addListener());return ub}insertAgave(H,va){var ub=Fa.TaskExtensions.sq();const kc=this.$;var Oc=H[ha.a.Ata];const pd=H[Xa.a.Wk];let Sd=null;Fi.a.key in H&&(Sd=H[Fi.a.key]);this.nna&&
this.nna.hide();if(!pd||!Oc)return sa.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),ub;this.$.Tna&&Va.a.Fia in H&&(pd.EnabledInViewMode=H[Va.a.Fia]);H=this.xFi(va.command);if(!pd.EnabledInViewMode&&!kc.cy(null,!1,H))return ub;let Wd=void 0===pd.IsToBePersisted||null===pd.IsToBePersisted||pd.IsToBePersisted?0:16;if(1===pd.TargetType)ub=this.kcj(pd,Oc,va,Sd,Wd);else{Oc=ea.f(kc);ub=this.viewBlockContainerHelpers.X8a(Oc);const ee=kc.ea.isNamedObjectViewMode?kc.na.sheetName:
kc.na.name;let je,Ue,G,da;ub?(Oc=ub.Lj,je=Oc.jj.top,Ue=Oc.jj.left,G=ub.VS.x,da=ub.VS.y):(je=Ue=1,ub=this.viewBlockContainerHelpers.rJa(Oc),G=ub.x,da=ub.y);const $a=this.$.pa.ta.Jh();Wd|=64;ub=mk.a(this.$.userOperationManager,(Sb,Mc,sd)=>{var Od=kc.pa.ta,se=je,Ye=Ue,hf=G,ag=da;Sb=id.c(Sb,this.b5j);const Jg=Od.Za(9,$a);Jg.sharedInfo=pd;Jg.sheetName=ee;Jg.positionRow=se;Jg.positionCol=Ye;Jg.positionOffsetX=hf;Jg.positionOffsetY=ag;return xd.h(Od,"InsertWebExtension",Jg,Sb,Mc,sd,null,0)},Sb=>new sc.a(534,
0,Sb,Wd),va)}return ub}gYh(){var H=Wc.a.instance.Qi("Common.App.ICustomerFeedbackUiWrapper"),va={};P.AFrameworkApplication.fa.Ild(va);H=H.instance.getContext(va);va={};"telemetryGroup"in H&&(va=H.telemetryGroup);va.processSessionId=H.sessionId;va.officeBuild=H.build;H.telemetryGroup=va;H.feedbackType=-1;H.userVoiceEnabled=!1;"disableIncludeScreenshot"in H||(H.disableIncludeScreenshot=!1);"screenshot"in H||(H.screenshot=!1);H.disableScreenshotPreview=!1;H.includeScreenshotSelectedDefault=!0;return H}Xsg(H){if(!this.ZMa){var va=
this.aKd();va=this.p8e(va);const ub=new Fi.a;ub.Dx=uc.a.yNb;ub.V$=uc.a.Orf;ub.Uwb=uc.a.ACd;this.ZMa=this.NUc(va,null,!1,null,ub);Qj.b(this.$).lj(nl.a.J5j,{["Location"]:H?kk.a[H.lk]:0,["InputMethod"]:H?Rk.a[H.method]:0},void 0,!0)}}CLg(H){const va=this.$.ea.sn.get(17);Wc.a.instance.Qi("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(ub=>{ub.isFeatureEnabled("mso_sendASmile",va).then(kc=>{H.FeedbackEnabled=va&&kc;return null})})}$jj(){return this.ri.Npj(this.ri.pIa(vg.YZa,this.aKd()))}onPaneClosed(H){var va;
switch(H){case vg.iqc:null===(va=this.Bo)||void 0===va?void 0:va.unregister("Copilot")}}PQg(H,va){const ub=ea.f(this.$),kc=new kj.a;var Oc={};Oc.ActiveTab=va;Oc.IsRTL=this.$.isChromeRtl;Oc.DatapaneFlighting=!0;Oc.MergeIvyBiDataSources=!0;Oc.ComboChartUIInXLO=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSComboChartUIInXLO",!1);Oc.ThemeColorsFlighting=!0;Oc.FormatTaskPaneUXImprovePhase2=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneUXImprovePhase2",
!1);Oc.ChartTPNewFontAndColorTheme=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTPNewFontAndColorTheme",!1);Oc.UOMirrorTaskPaneRefactor=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirrorTaskPaneRefactor",!1);Oc.DataPaneAddNewField=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataPaneAddNewField",!1);Oc.LineFormatTaskPane=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSLineFormatTaskPane",!1);Oc.ChartTaskPaneNewTheme=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneNewTheme",
!1);Oc.SnowballChartImprovement=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSSnowballChartImprovement",!1);this.CLg(Oc);Oc.startTimeMs=Date.now();Oc.UserSessionId=this.$.ua.UserSessionId;(va=ub.ha.$e.Gq)&&(Oc.SubSelection=va);sa.ULS.sendTraceTag(592524688,0,50,`Chart task pane launched. UserSessionId: ${Oc.UserSessionId}, UILocation: ${void 0===H.lk||null===H.lk?"Null":kk.a[H.lk]}, SubSelection: ${va||"ChartRoot"}`);kc.tH=Oc;kc.vs=Lc.a.instance.ia(984);Oc=new Fi.a;Oc.V$=uc.a.tNb;
return this.J7(H,vg.WRh,kc,!0,Oc)}iMk(H){const va=new kj.a;va.tH={};va.vs=Lc.a.instance.ia(1809);va.VV=vg.T3f;const ub=new Fi.a;ub.V$=uc.a.tNb;return this.J7(H,vg.T3f,va,!0,ub,void 0,va.vs)}xMk(H){const va=new kj.a;va.tH={};va.vs=Lc.a.instance.ia(2187);const ub=new Fi.a;ub.V$=uc.a.Hli;ub.Uwb=uc.a.Rrf;const kc=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavPaneWebReadOnly",!1);return this.J7(H,vg.lGj,va,!0,ub,kc)}sMf(H,va){const ub=vg.d5i;var kc=H[Xa.a.Ai].toString();const Oc={},pd=
new kj.a;pd.vs=Lc.a.instance.ia(9);switch(kc){case "A0":Oc.query=(H[Xa.a.Wk]||"").split("|").slice(2,Sk.a.Gca).join("|");break;case "A1":Oc.query=H.CommandValueId;break;case "Help":Oc.query="";pd.VV="HelpTaskPane";break;case Va.a.Hde:pd.vs=Lc.a.instance.ia(1775);pd.sourceLocationOverrideResourceId=vg.eNd;Oc.feedback=this.gYh();break;case "HelpArticle":Oc.query=H[Xa.a.Wk];break;case "Tutorials":Oc.query=H.CommandValueId;break;case "ContactSupport":Oc.query=kc;pd.sourceLocationOverrideResourceId=vg.oYh;
pd.vs=Lc.a.instance.ia(2389);pd.VV="ContactSupportTaskPane";break;case "ShowTraining":case "WhatsNew":Oc.query=kc;break;default:return Ae.Task.Va(!0)}pd.tH=Oc;kc=new Fi.a;kc.V$=uc.a.tNb;H=H[Va.a.Fia]||!1;return this.J7(va,ub,pd,za.EwaSettings.isChangeGateEnabled("OfficeVSO:8469439_UseSdxActivationFlow"),kc,H)}p8e(H){const va={};va.SolutionId=vg.YZa;va.Version="0.0.0.0";va.StoreType=OSF.StoreType.Sdx;va.StoreId=OSF.StoreType.Sdx;va.AssetId=null;va.AssetStoreId=null;va.Height=0;va.Width=0;va.TargetType=
OSF.OsfControlTarget.TaskPane;va.IsToBePersisted=!1;va.SourceLocationOverrideResourceId=H;va.SharedRuntimeId=H;return va}R0i(H,va){const ub=new kj.a,kc=new Fi.a,Oc={};this.ZMa&&this.CLg(Oc);Oc.LaunchSource="";Oc.StartTimeMs=Date.now();Oc.CorrelationId=Qc.a.create().toString();ub.tH=Oc;ub.focusOnIframeWhenLoaded=!0;ub.taskPaneWidth=vg.sQf;kc.V$=uc.a.Orf;kc.Uwb=uc.a.ACd;switch(va.command){case -1444574190:let pd,Sd,Wd;Oc.LaunchMode="RecommendedPivotTables";Oc.SelectionContext="";Oc.LaunchSource="PivotTableHandRaise"===
Object(Da.a)(String,H.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";if(this.$&&za.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&H.SourceSelection){const ee=H.SourceSelection.split(",")[0],je=za.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?-1:0;if((()=>{let Ue=qb.ib(ee,this.$.sa);({sheetName:pd,Swg:Sd,range:Wd}=Ue);return Ue})().returnValue&&!ea.f(this.$).Yg.aY(Wd))H=this.$.sa.getItemByName(pd),Oc.SelectionContext=JSON.stringify(Object(kf.a)(new lk,
{address:Sd,addressWithSheet:pd+"!"+Wd.xF(!1),sheetId:Gb.d(H),sheetName:pd,isSheetEmpty:!1,columnCount:Wd.width,rowCount:Wd.height,columnIndex:Wd.left+je,rowIndex:Wd.top+je,selectionType:"Continuous"}));else if((H=this.$.Gh.getItemByName(Object(Da.a)(String,H.SourceSelection)))&&Gb.m(H)){Wd=Ck.a(H,!0);const Ue=this.$.sa.getItemByName(H.sheetName);Oc.SelectionContext=JSON.stringify(Object(kf.a)(new Ak,{tableName:H.name,hasTableHeaders:Ck.d(H),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:Wd.xF(!1),
addressWithSheet:Ue.name+"!"+Wd.xF(!1),sheetId:Gb.d(Ue),sheetName:Ue.name,isSheetEmpty:!1,columnCount:Wd.width,rowCount:Wd.height,columnIndex:Wd.left+je,rowIndex:Wd.top+je,selectionType:"Continuous"}))}}ub.vs=Lc.a.instance.ia(1821);ub.VV=vg.j3j;ub.Dx=uc.a.Itf;kc.Dx=uc.a.Itf;break;case -336193495:Oc.LaunchMode="RecommendedCharts";ub.vs=Lc.a.instance.ia(1820);ub.VV=vg.gck;ub.Dx=uc.a.Jtf;kc.Dx=uc.a.Jtf;break;case -167264441:Oc.LaunchMode="ExcelIntelligence";Oc.TableName=H.tableName;ub.vs=Lc.a.instance.ia(2287);
ub.VV=vg.$2e;ub.Dx=uc.a.yNb;kc.Dx=uc.a.yNb;break;default:Oc.LaunchMode="Default",ub.vs=Lc.a.instance.ia(1822),ub.VV=vg.$2e,ub.Dx=uc.a.yNb,kc.Dx=uc.a.yNb}ub.sourceLocationOverrideResourceId=this.aKd();return this.ZMa?this.ZMa.RA(()=>this.Mvk(Oc,ub)):this.gaj(va,ub,kc,Oc)}r5i(){const H=this.ri.R4(vg.iqc);if(H){const va=this.FUk(H);Ba.a.ut()?void Ta.a.resolve(ba.We,{va:0}).then(ub=>ub.hideTaskPane(va)):void ve.a.Go().then(ub=>{ub.hideTaskPane(va,2);return null})}}FUk(H){return vg.GUk+H.replace(/[{}]/g,
"")}uPi(){const H=Ta.a.Zg(ba.ge),va=Yk.c()&&appChrome.api.isCachedControlVisible(Va.a.nNa);return void 0!==H?H.EVb:va}OMi(){const H=new kj.a;H.vs=appChrome.getCopilotString();let va=!1;za.EwaSettings.isChangeGateEnabled("OfficeVSO:8583475_CheckAccountTypeForPreviewTag")&&(va="msa"===P.AFrameworkApplication.fa.Xa("HostAuthType").toLowerCase());(va?za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.1D9AC0F2_NoPreviewTitleConsumer",!1):za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.1D9AC0F2_NoPreviewTitle",
!1))||(H.$Wg=appChrome.getPreviewTaskPaneHeaderTagString());za.EwaSettings.isChangeGateEnabled("OfficeVSO:7904707_SDXTaskPaneHeaderIconSupport")&&(H.VV=vg.p_h);H.focusOnIframeWhenLoaded=!0;H.taskPaneWidth=vg.Ekf;return H}PMi(){const H={};H.AudienceGroup=P.AFrameworkApplication.Nh.AudienceGroup;H.StartTimeMs=Date.now();za.EwaSettings.isChangeGateEnabled("OfficeVSO:8337949_sendAnnotationsToCopilotOnOpen")&&za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FA000000124.TabularRangeSupportForCopilot",
!1)&&(H.TableBoundaries=this.RVi());H.HandoffMessageId=this.$.ua.HandoffMessageId;const va=za.EwaSettings.getBooleanFeatureGate(ql.a.a4,!1);H.CopilotSaveAutomation=va&&this.uPi();return H}V_i(H,va){const ub=this.OMi();var kc=this.PMi();za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.60DF7594-6F61-4C0E-983C-712E11F4F99A",!1)&&H.MenuItemId&&(kc.CopilotStartQuery=JSON.stringify(H.MenuItemId));H=Rj.a.zFf(this.$,!0,"Copilot",{});const Oc={};Oc.devProperties=H.Iw;Oc.optionalProperties=H.ik;
kc.LaunchOfficeScriptsSDXOptionalProperties=JSON.stringify(Oc);ub.tH=kc;const pd=new Fi.a;pd.V$=uc.a.Drf;const Sd=ee=>{ee.register(ee.e5().B7("Copilot").A7(()=>{sa.ULS.sendTraceTag(508347875,0,15,"Copilot AugLoop host received close message")}).activateAnnotation({annotationType:"FakeCopilotAnnotation",bB:!1,iij:!0}).build())},Wd=()=>this.fQg?Object(yi.d)(Object(ll.a)(this.QIj).then(this.Uwk.bind(this)).catch(ee=>{sa.ULS.sendTraceTag(507562076,0,10,`[Copilot Chat] Failed to get and send token. ${ee}`)}).then(()=>
Object(yi.a)(this.J7(va,vg.iqc,ub,!0,pd)))):this.J7(va,vg.iqc,ub,!0,pd);if(this.Bo)return Sd(this.Bo),Wd();kc=Ta.a.resolve(ba.p,{va:1});return Object(yi.d)(kc.then(ee=>{this.Bo=ee;Sd(this.Bo);sa.ULS.sendTraceTag(508347904,0,15,"Copilot proxy created IAugmentationLoopManager manager");return Object(yi.a)(Wd())}))}gaj(H,va,ub,kc){this.ZMa=this.NUc(this.p8e(va.sourceLocationOverrideResourceId),va,!1,H,ub,!1);kc.NoActionMsgOnFirstInstance=!0;this.GOa[vg.YZa]=kc;return this.ZMa}Mvk(H,va){const ub=this.ri.R4(this.ri.pIa(vg.YZa,
va.sourceLocationOverrideResourceId));if(ub){this.GOa[vg.YZa]=H;const {JQc:kc,fOb:Oc}=this.WKc(this.ri.wX(ub).OsfPropertyBag,vg.YZa);this.ri.wX(ub).OsfPropertyBag=kc;this.ri.wX(ub).HostPropertyBag=Oc}this.pya(vg.YZa,me.a.taskpane,"LaunchIdeasAction",H,"1.0.0.0",va);return Ae.Task.Va(!0)}aKd(){if(za.EwaSettings.isChangeGateEnabled("OfficeVSO:8728618_IdeasSovereignSupport"))switch(P.AFrameworkApplication.fa.Xa("SovereignEnvironmentName")){case "USGov":return"Insights.Https.GCC.Bundle";case "Pathfinder":return"Insights.Https.DOD.Bundle";
case "Trailblazer":return"Insights.Https.GCCH.Bundle"}const H=P.AFrameworkApplication.Nh.AudienceGroup;if(za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPEApi",!1)){switch(H){case "Automation":case "Dogfood":case "Microsoft":return"Ideas.PPEApi.PPE"}return"Ideas.PPEApi"}switch(H){case "Automation":case "Dogfood":case "Microsoft":return"Insights.Https.PPE.Bundle"}return"Insights.Https.Bundle"}J7(H,va,ub,kc,Oc,pd,Sd){ub=void 0===ub?null:ub;kc=void 0===kc?!1:kc;Oc=void 0===
Oc?null:Oc;pd=void 0===pd?!1:pd;Sd=void 0===Sd?null:Sd;Fa.TaskExtensions.sq();ub||(ub=new kj.a);const Wd={};Wd.SolutionId=va;Wd.Version="0.0.0.0";Wd.StoreType=kc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;Wd.StoreId=kc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;Wd.AssetId=null;Wd.AssetStoreId=null;Wd.Height=0;Wd.Width=0;Wd.TargetType=OSF.OsfControlTarget.TaskPane;Wd.IsToBePersisted=!1;Wd.SourceLocationOverrideResourceId=ub.sourceLocationOverrideResourceId;if(ub.vs||Sd)this.cFd[va]=Object(kf.a)(new Tk,
{YZc:ub.vs,ste:ub.$Wg,rte:ub.showResizeChatButton,pte:Sd,XZc:ub.VV});ub.tH||(ub.tH={});ub.tH.ShowFeedback=this.$.isFeedbackEnabled;this.GOa[va]=ub.tH;this.Cke[va]=ub.onExtensionLaunchCallback;va={};va[Xa.a.Wk]=Wd;Sd={};Sd.solutionId=Wd.SolutionId;Sd.version=Wd.Version;Sd.storeType=Wd.StoreType;Sd.storeId=Wd.StoreId;Sd.assetId=Wd.AssetId;Sd.assetStoreId=Wd.AssetStoreId;Sd.height=Wd.Height;Sd.targetType=Wd.TargetType;Sd.width=Wd.Width;Sd.isAddinCommands=!kc;va[ha.a.Ata]=Sd;Oc||(Oc=new Fi.a);Oc.focusOnIframeWhenLoaded=
ub.focusOnIframeWhenLoaded;Oc.width=ub.taskPaneWidth;Oc.showLoadingSpinner=ub.showLoadingSpinner;va[Fi.a.key]=Oc;va[Va.a.Fia]=pd;return this.insertAgave(va,H)}kcj(H,va,ub,kc,Oc){const pd=(je,Ue)=>{var G=je.SolutionId;const da=OSF.OsfControl.isFirstPartyStoreString(je.StoreType);da&&je.SourceLocationOverrideResourceId&&(G=this.ri.pIa(G,je.SourceLocationOverrideResourceId));var $a=this.ri.Waf(G,null,je.SharedRuntimeId);if(da){if($a&&(G=this.ri.R4(G))){const {JQc:Sb,fOb:Mc}=this.WKc(this.ri.wX(G).OsfPropertyBag,
je.SolutionId);if(G=this.ri.wl.getOsfControl(G))G.setSettings(Sb),G.setHostSettings(Mc)}je.SharedRuntimeId&&$a||this.ri.wl.refreshOsfControl(je.SolutionId,je.SourceLocationOverrideResourceId)}if(!$a){const Sb=this.$.pa.ta.Jh();let Mc=519;$a=(sd,Od,se)=>{var Ye=this.$.pa.ta;sd=id.c(sd,this.ysg);const hf=Ye.Za(9,Sb);hf.sharedInfo=je;return xd.h(Ye,"InsertAgaveTaskpane",hf,sd,Od,se,kc,0)};void 0===je.IsToBePersisted||null===je.IsToBePersisted||je.IsToBePersisted||(Mc=538,$a=(sd,Od,se)=>{var Ye=Telemetry.PrivacyRules.GetPrivacyCompliantId(je.SolutionId,
je.StoreType,je.AssetId,null,null,je.StoreId);sa.ULS.sendTraceTag(537170442,220,50,`Web Method ShowAgaveTaskpane is called, StoreType ${je.StoreType}, StoreId ${je.StoreId}, SolutionId ${Ye}.`);Ye=this.$.pa.ta;sd=id.c(sd,this.ysg);const hf=Ye.Za(9,void 0===Sb?null:Sb);hf.sharedInfo=je;return xd.h(Ye,"ShowAgaveTaskpane",hf,sd,Od,se,kc,0)});Oc|=64;return mk.a(this.$.userOperationManager,$a,sd=>new sc.a(Mc,0,sd,Oc),Ue)}return Fa.TaskExtensions.N$()},Sd=je=>{var Ue=Telemetry.PrivacyRules.GetPrivacyCompliantId(je.solutionId,
je.storeType,je.assetId,null,null,je.storeId);sa.ULS.sendTraceTag(537170440,220,50,`Insert addincommands for ${Ue} from ${je.storeType}.`);Ue={};const G=new pf.a;G.add(je);Ue[ha.a.vGb]=G;Ue[ha.a.v3]=3;je=new Re.a(Vf.a.mob,0,this.$.Rh,0,null);return this.$.Ma.dh(je,Ue)};if(!za.EwaSettings.Ra(52)||H.StoreId===OSF.StoreType.FirstParty)return pd(H,ub,kc);if(va.isAddinCommands)return Sd(va);const Wd=new L.a,ee={};ee.solutionId=H.SolutionId;ee.version=H.Version;ee.storeType=H.StoreType;ee.storeId=H.StoreId;
ee.targetData=H;this.ri.wl.isAddinCommandsAsync(ee,(je,Ue,G)=>{Wd.setResult(Ue);je||(je=G.targetData,Ue=Telemetry.PrivacyRules.GetPrivacyCompliantId(je.SolutionId,je.StoreType,je.AssetId,null,null,je.StoreId),sa.ULS.sendTraceTag(537170438,220,10,`Judging AddinCommands failed for ${Ue} from ${je.StoreType} during addin inserting`))});return Fa.TaskExtensions.ts(Wd.task,je=>je.result?Sd(va):pd(H,ub,kc),this.$.xa)}WKc(H,va){if(!this.GOa[va])return{Cql:H,fOb:null};const ub={},kc={};if(H)for(var Oc of H){const [Sd,
Wd]=Oc;ub[Sd]=Wd}H=this.GOa[va];for(var pd of Object.keys(H))Oc=H[pd],pd===vg.Hsi?ub[pd]=kc[pd]=Sys.Serialization.JavaScriptSerializer.serialize(Oc):(!za.EwaSettings.isChangeGateEnabled("OfficeVSO:8380805_LogsToInvestigateMergeFirstPartySettingsCrash_2")||null!==Oc&&void 0!==Oc||sa.ULS.sendTraceTag(508072652,220,15,"AgaveCommandHandler.mergeFirstPartySettings: value is null or undefined. firstPartySolutionId: "+va+". key: "+pd+". value is null: "+(null===Oc)),ub[pd]=kc[pd]=Sys.Serialization.JavaScriptSerializer.serialize(Oc.toString()));
va=Object.keys(ub).map(Sd=>[Sd,ub[Sd].toString()]);pd=Object.keys(kc).map(Sd=>[Sd,kc[Sd].toString()]);return{JQc:va,fOb:pd}}Wxj(H,va,ub){const kc=this.$.ua.UserSessionId,Oc=this.$.ua.UICultureTag,pd=this.$.ua.UICultureTagLcid,Sd=this.$.ua.WacHostId;let Wd="",ee="";5<=ub.length&&(Wd=ub[3],ee=ub[4]);this.Xxj(Wd,ee,H,va,Oc,pd,kc,Sd)}Xxj(H,va,ub,kc,Oc,pd,Sd,Wd){const ee={};ee.a=Sd;ee.b=ub;ee.c=kc;ee.d=H;ee.e=va;ee.f=Oc;ee.g=pd;ee.h=Wd;eb.b().tl(36,ee)}NUc(H,va,ub,kc,Oc,pd){va=void 0===va?null:va;ub=void 0===
ub?!1:ub;kc=void 0===kc?null:kc;Oc=void 0===Oc?null:Oc;pd=void 0===pd?!0:pd;var Sd=H.SolutionId,Wd=Ae.Task.Va(!1);H&&Sd&&H.SharedRuntimeId&&(kc=kc||new Re.a(-859308420,0,2,0,""),Sd={},Sd.solutionId=H.SolutionId,Sd.version=H.Version,Sd.storeType=H.StoreType,Sd.storeId=H.StoreId,Sd.assetId=H.AssetId,Sd.assetStoreId=H.AssetStoreId,Sd.height=H.Height,Sd.targetType=H.TargetType,Sd.width=0,Sd.isAddinCommands=!1,Sd.sharedRuntimeId=H.SharedRuntimeId,H.Preload=pd,Oc=Oc?Oc:new Fi.a,Oc.width=0,va&&(pd=va,Oc.focusOnIframeWhenLoaded=
pd.focusOnIframeWhenLoaded,Wd=new Tk,pd.vs&&(Wd.YZc=pd.vs),0<pd.taskPaneWidth&&(Wd.oZ=pd.taskPaneWidth),pd.VV&&(Wd.XZc=pd.VV),za.EwaSettings.isChangeGateEnabled("OfficeVSO:7644290_MsFormsCorrelationId")&&pd.tH&&(this.GOa[H.SolutionId]=va.tH),this.cFd[H.SolutionId]=Wd,this.Cke[H.SolutionId]=va.onExtensionLaunchCallback),va={},va[Xa.a.Wk]=H,va[ha.a.Ata]=Sd,va[Fi.a.key]=Oc,va[Va.a.Fia]=ub,Wd=this.insertAgave(va,kc));return Wd}pya(H,va,ub,kc,Oc,pd){pd=void 0===pd?null:pd;if(H&&ub){H=new md.a(H,OSF.StoreType.Sdx,
OSF.StoreType.Sdx,Oc);Oc=new Pe.a("ExcelOnline","Web",this.$.ua.UICultureTag);const Sd=new ie.a;Sd.ik[Zg.a.Akd]=kc;pd&&(kc=pd,kc.sourceLocationOverrideResourceId&&(Sd.ik[Zg.a.sourceLocationOverrideResourceId]=kc.sourceLocationOverrideResourceId),kc.vs&&(Sd.ik[Zg.a.vs]=kc.vs),kc.Dx&&(Sd.ik.IconCssClass=kc.Dx),kc.mte&&(Sd.ik.TaskPaneIconUrl=kc.mte),kc.VV&&(Sd.ik.TaskPaneIconId=kc.VV),kc.onExtensionLaunchCallback&&(Sd.ik[Zg.a.onExtensionLaunchCallback]=kc.onExtensionLaunchCallback));ub&&(Sd.ik[Zg.a.actionName]=
ub);Xc.a.instance.pya(H,va,ub,Oc,Sd)}}SPi(H){if(!Rc.a.qm(H)){var va=H[lj.a.GNb];if(va&&(va=va.getId(),H=H[lj.a.Roa],va&&H))return this.pIa(va,H.ik[Zg.a.sourceLocationOverrideResourceId])}return null}pIa(H,va){va=void 0===va?null:va;return H&&va?`${H}.${va}`:H}xFi(H){switch(H){case 1172793074:case 1221897806:case 1930653487:return 2;case -515602470:return 1;case 1723441034:return 1023;case -859308420:return 1023;case 515196233:return 1023;case 301511274:return 1023;default:return 1}}OZg(){this.$.ea.Ul?
this.PRc():za.EwaSettings.fl()?this.$.ea.Jq(this.PRc):(this.$.ea.Uq(this.PRc),this.Uee=!0)}RVi(){var H=Ta.a.Zg(ba.gg);if(!H)return this.OZg(),"";H=H.Zfa();if(!H)return this.OZg(),"";var va=this.$.sa.getItemByName(this.$.ea.isNamedObjectViewMode?this.$.na.sheetName:this.$.na.name);va=Gb.d(va);var ub=ea.f(this.$).ha.qa.selectedRanges;const kc=[];for(const pd of ub){ub=new qj.a(pd,va);var Oc=H.iJa(ub,Gj.Valid);ub=[];if(Oc)for(const Sd of Oc)(Oc=Sd.table.analyzedRange)&&(Oc=Oc.range.toString())&&ub.push(Oc);
ub=new Bk(pd.toString(),ub);kc.push(ub)}return JSON.stringify(kc)}}vg.z9d="IDS";vg.d5i="FA000000012";vg.YZa="FA000000005";vg.a5i="HelloWorld";vg.WRh="FA000000014";vg.eNd="Help.GiveFeedback.Url";vg.oYh="Help.ContactSupport.Url";vg.Hsi="feedback";vg.T3f="FA000000066";vg.p5j="PowerBi.Url";vg.n5j="PowerBi.DevUrl";vg.o5j="FA000000054";vg.lGj="FA000000064";vg.q_j="FA000000075";vg.$2e="AnalyzeDataTaskPane";vg.gck="RecommendedChartsTaskPane";vg.j3j="PivotTableTaskPane";vg.sQf=320;vg.y8j=320;vg.p_h="CopilotSDXTaskpane";
vg.iqc="FA000000124";vg.Ekf=350;vg.GUk="AgaveTaskPane-";vg.FBh="g_InstallOrigin";Object(I.a)(vg,"AgaveCommandManager",oj.a,[486,487]);class Sj extends Fj.a{constructor(H){super();this.$=H;this.Bl()}create(){const H=this.$.ka,va=ba.vb.Ha()?Object(yi.d)(Ta.a.resolve(ba.vb,{va:this.hh})):gb.GetServiceTaskFactory.create(H,106,this.xa,this.hh),ub=gb.GetServiceTaskFactory.create(H,104,this.xa,this.hh),kc=Object(yi.d)(Ta.a.resolve(ba.i));Fa.TaskExtensions.Ua(Fa.TaskExtensions.Ln([ub,va,kc],this.xa),()=>
{let Oc=null;Oc=Wc.a.instance.Qi("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance;Aj.instance.initialize(va.result);const pd=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PreloadRaceCondition6395242",!0)?Object(Qk.a)(this.$.ka,374,()=>new vg(this.$,va.result,ub.result,Oc,P.AFrameworkApplication.jh,kc.result,Wc.a.instance.Qi("Common.App.OAuth.IOAuthManager"))):new vg(this.$,va.result,ub.result,Oc,P.AFrameworkApplication.jh,kc.result,Wc.a.instance.Qi("Common.App.OAuth.IOAuthManager"));
H.ph(206,pd);this.Yj(H.Ug(374)||H.ph(374,pd))},this.xa,3);Wc.a.instance.register(kl.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").hi().mi(()=>new kl.a(this.$.VJ))}static Aa(H){H.ka.ph(375,new Sj(H))}}Object(I.a)(Sj,"AgaveCommandManagerFactory",Fj.a,[]);class Dk extends qa.a{constructor(H){super(H)}Qs(){const H=ba.vb.Ha()?Object(yi.d)(Ta.a.resolve(ba.vb,{va:this.hh})):gb.GetServiceTaskFactory.create(this.$.ka,106,this.xa,this.hh),va=Object(yi.d)(Ta.a.resolve(ba.Vd,{va:this.hh})),
ub=rd.a(this.xa,this.hh),kc=Object(yi.d)(Ta.a.resolve(ba.kd,{va:this.hh})),Oc=ba.Tb.Ha()?Object(yi.d)(Ta.a.resolve(ba.Tb,{va:this.hh})):Ae.Task.Va(null);Fa.TaskExtensions.Ua(Fa.TaskExtensions.Ln([H,va,ub,kc,Oc],this.xa),()=>{const Sd=H.result,Wd=Wc.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");this.cr([new bf(this.$,Sd,Wd,kc.result,Oc.result)])},this.xa,3);const pd=Wc.a.instance;ba.id.Ha()?void Ta.a.resolve(ba.id,{va:this.hh}).then(()=>{Wc.a.instance.register(jf,
"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").hi().mi(()=>new jf)}):Fa.TaskExtensions.Ua(gb.GetServiceTaskFactory.create(this.$.ka,137,this.$.xa,this.hh),()=>{pd.register(jf,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").hi().mi(()=>new jf)},this.$.xa)}static Aa(H){qa.a.sx(82,new Dk(H))}}Object(I.a)(Dk,"DdaCommandHandlerFactory",qa.a,[]);za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveRequireFromSlices",!1)||a(1091);
(()=>{Ej.a.Qg(H=>{za.EwaSettings.Ra(52)&&zk.Aa(H)})})();(()=>{Ej.a.Qg(H=>{za.EwaSettings.Ra(114)&&hk.Aa(H)})})();(()=>{Ej.a.Qg(H=>{ba.vb.Ha()||mi.Aa(H)})})();(()=>{Ej.a.Qg(H=>{ba.h.Ha()&&ba.Vf.Ha()||Zj.Aa(H);Sj.Aa(H)})})();(()=>{Ej.a.Qg(H=>{Dk.Aa(H)})})();String(N);String(M);String(Q);String(wa);String(R);String(O);String(U);String(K);String(pi);window.___1708742503352_closurehack=N;window.___1708742503352_closurehack=M;window.___1708742503352_closurehack=Q;window.___1708742503352_closurehack=wa;
window.___1708742503352_closurehack=R;window.___1708742503352_closurehack=O;window.___1708742503352_closurehack=U;window.___1708742503352_closurehack=K;window.___1708742503352_closurehack=pi},922:function(y,x,a){a.r(x);a.d(x,"DdaFacade",function(){return Qe});var c=a(0),b=a(2),f=a(14),r=a(1549),d=a(113);class k{constructor(Ca,yb,wc){this._id=Ca;this.fdh=yb;this.lfh=wc;this.fTf=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get GBh(){return this.fdh}get OVh(){return this.lfh}execute(Ca,
yb,wc){wc=wc||{};wc.commandMode=this.fTf;yb.invokeAppCommand(this.GBh,this.OVh,wc,()=>{Ca.BTj(this.id)})}}Object(c.a)(k,"AddinNativeActionBase",null,[422]);class t extends k{constructor(Ca,yb){super(1,Ca,yb);this.fTf=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(c.a)(t,"AddinTakeSnapshotAction",k,[]);class m{a0h(Ca){return new k(3,Ca,this.UBi().getNativeActionName(3))}UBi(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}Object(c.a)(m,"AddinNativeActionManager",null,[408]);var e=
a(236);class w{invokeAppCommand(Ca,yb,wc,dd){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(Ca,yb,wc,dd)}static getInstance(){w.Wa||(w.Wa=new w);return w.Wa}}w.Wa=null;Object(c.a)(w,"OSFAddinCommandsRuntimeManager",null,[407]);var l=a(6),u=a(244),n=a(34);class v extends e.a{constructor(Ca,yb,wc){super();this.rka=null;this.pjd="WACDialogTitleText";this.y8="0";this.xja="15px";this.Ffh="0px";this.x8="calc(100% - 30px)";this.Efh="100%";this.MSe=0;this.Rg=new d.a;this.hdh=new m;this.Bh=5;this.Lk=
this.rRa=wc;this.i8c=Ca;this.ZGe=yb;this.E8c=!!l.AFrameworkApplication.fa&&l.AFrameworkApplication.fa.la("OfficeAddinEnableInsertDialogAccessibilityFix")}Hzh(Ca){this.Rg.addHandler("OnDialogClosedEventKey",Ca)}ABk(){this.wSa=null}WF(){super.WF();this.zo.style.width="100%";this.zo.style.height=this.FRb?this.x8:this.Efh;this.zo.style.marginTop=this.FRb?this.xja:this.Ffh;this.zo.style.padding=this.y8}GS(){super.GS();this.Xg.style.width=String.format("{0}px",this.i8c*window.innerWidth/100);this.Xg.style.height=
String.format("{0}px",this.ZGe*window.innerHeight/100);this.Xg.style.minWidth="0px";this.E8c&&l.AFrameworkApplication.isRtl&&100===this.i8c&&(this.Xg.style.right="0px",this.Xg.style.marginRight="0px");this.rka=document.getElementById(this.Jo(this.pjd));this.rka.style.position="absolute";this.rka.style.whiteSpace="nowrap";this.rka.style.textOverflow="ellipsis";l.AFrameworkApplication.isRtl?(this.rka.style.right="14px",this.rka.style.left="44px"):(this.rka.style.right="44px",this.rka.style.left="14px")}VK(Ca){super.VK(Ca);
this.rka&&this.rka.setAttribute("title",Ca)}get Vla(){return this.zo}sie(){this.Xg.style.width=String.format("{0}px",this.i8c*window.innerWidth/100);this.Xg.style.height=String.format("{0}px",this.ZGe*window.innerHeight/100);this.Xg.style.overflowY="hidden";this.Xg.style.overflowX="hidden";this.Xg.style.marginTop="";this.Xg.style.top="";n.a.Q5&&l.AFrameworkApplication.isRtl?(this.Xg.style.right="",this.Xg.style.marginRight=""):(this.Xg.style.left="",this.Xg.style.marginLeft="")}hide(){this.hdh.a0h(this.rRa).execute(this,
w.getInstance(),{});this.MSe=window.setTimeout(()=>{this.Rg.raiseEvent("OnDialogClosedEventKey",this.rRa);u.a.prototype.hide.call(this)},500)}BTj(Ca){3===Ca&&(window.clearTimeout(this.MSe),this.Rg.raiseEvent("OnDialogClosedEventKey",this.rRa),super.hide())}}Object(c.a)(v,"AppsForOfficeDialog",e.a,[395,396]);class B{constructor(){this.dialog=this.Lk=null}}Object(c.a)(B,"DialogInfo",null,[]);class z{}z.url="url";z.height="height";z.width="width";z.Tzd="displayInIframe";z.hCc="hideTitle";Object(c.a)(z,
"DialogSettings",null,[]);class C{constructor(){this.height=this.width=0;this.Lk=this.controlId=this.pageUrl=null;this.hCc=this.Tzd=!1}}Object(c.a)(C,"DisplayDialogParams",null,[]);class D extends Sys.EventArgs{constructor(Ca,yb,wc,dd,vd){wc=void 0===wc?null:wc;dd=void 0===dd?"":dd;vd=void 0===vd?"":vd;super();this.controlId=Ca;this.messageType=yb;this.messageContent=wc;this.messageOrigin=dd;this.targetOrigin=vd}}Object(c.a)(D,"OnMessageDialogEventArgs",Sys.EventArgs,[]);class J extends Sys.EventArgs{constructor(Ca,
yb,wc,dd,vd){wc=void 0===wc?null:wc;dd=void 0===dd?"":dd;vd=void 0===vd?"":vd;super();this.controlId=Ca;this.messageType=yb;this.messageContent=wc;this.messageOrigin=dd;this.targetOrigin=vd}}Object(c.a)(J,"OnMessageParentEventArgs",Sys.EventArgs,[]);var W=a(44),N=a(31),M=a(188),Q=a(106),R=a(23);class O{constructor(Ca){this.Rg=new d.a;this.xNj=(yb,wc)=>{if(yb=this.GYa(wc))this.jr.purgeDialogControl(wc),O.jja.remove(yb),this.Rg.raiseEvent("OnMessageParentEventKey",new J(yb,OSF.DialogMessageType.DialogClosed,
null,null,"*"))};this.jr=Ca}Rzh(Ca){this.Rg.addHandler("OnMessageParentEventKey",Ca)}Qzh(Ca){this.Rg.addHandler("OnMessageDialogEventKey",Ca)}showDialog(Ca,yb,wc,dd){if(O.jja.Vg(yb))f.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),wc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{const eg=W.b(Ca),Ab=eg[z.url];if(this.jr.getOsfControl(yb).checkAppDomains(Ab)){var vd=new C;vd.width=eg[z.width];vd.height=eg[z.height];vd.pageUrl=
Ab;vd.Tzd=eg[z.Tzd];vd.hCc=eg[z.hCc];vd.controlId=yb;vd.Lk=M.a.create().toString();var Zd=new B;Zd.Lk=vd.Lk;var Re=this.jr.getOsfControl(vd.controlId).getManifest().getDefaultDisplayName(),ff=this.jr.getOsfControl(vd.controlId).getStoreType().toLowerCase();Ca=null;Ca=(4===l.AFrameworkApplication.ra.$d.Om&&"hardcodedpreinstall"===ff||"sdxcatalog"===ff)&&vd.hCc?this.createAndShowAppsForOfficeDialog(vd.width,vd.height,vd.Lk,!0,Re):this.createAndShowAppsForOfficeDialog(vd.width,vd.height,vd.Lk,!1,Re);
var af=this.jr.getOsfControl(vd.controlId),xf=af.getManifest();yb={};yb.id=vd.Lk;yb.solutionId=af.getSolutionId();yb.version=af.getVersion();yb.storeType=ff;yb.storeId=af.getStoreId();yb.assetId=af.getAssetId();yb.assetStoreId=af.getAssetStoreId();yb.ownerAddinSolutionId=af.getOwnerAddinSolutionId();yb.ownerAddinStoreType=af.getOwnerAddinStoreType();yb.appDomains=xf.getAppDomains();yb.dialogUrl=Ab;yb.osfControlType=1;yb.agaveName=Re;yb.div=Ca.Vla;f.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",
Telemetry.PrivacyRules.GetPrivacyCompliantId(yb.solutionId,yb.ownerAddinStoreType||yb.storeType,yb.assetId,null,null,yb.storeId),N.a.jF(vd.pageUrl));this.jr.insertDialogControl(yb);Ca.Hzh(this.xNj);Zd.dialog=Ca;O.jja.ga(vd.controlId,Zd);dd&&dd(yb);wc(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else f.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),wc(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(eg){f.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",
eg.message),wc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}TDj(Ca,yb,wc,dd){l.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",!1)||""===dd&&(dd=wc);try{const vd=this.GYa(Ca);vd&&this.Rg.raiseEvent("OnMessageParentEventKey",new J(vd,OSF.DialogMessageType.DialogMessageReceived,yb,wc,dd))}catch(vd){return f.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",vd.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}NVa(Ca,
yb){if(O.jja.Vg(Ca))try{const wc=O.jja.ma(Ca);wc.dialog&&wc.dialog.hide();this.jr.purgeDialogControl(wc.Lk);O.jja.remove(Ca);yb(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(wc){f.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",wc.message),yb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else f.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),yb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}uwk(Ca,
yb,wc,dd){l.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",!1)||""===dd&&(dd=wc);if(O.jja.Vg(Ca)&&(Ca=O.jja.ma(Ca),Ca.dialog))try{this.Rg.raiseEvent("OnMessageDialogEventKey",new D(Ca.Lk,OSF.DialogMessageType.DialogParentMessageReceived,yb,wc,dd))}catch(vd){f.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",vd.message)}}GYa(Ca){let yb=null;for(const wc of O.jja)if(wc.value.Lk===Ca){yb=wc.key;
break}return yb}createAndShowAppsForOfficeDialog(Ca,yb,wc,dd,vd){Ca=new v(Ca,yb,wc);vd=dd?"":String.format(Object(R.a)("ShowDialogApiInlineDialogTitle"),vd);dd&&(Ca.FRb=!1,Ca.hC=!1);Ca.initializeAndShow(vd,null,null);Ca.ABk();return Ca}static TYi(){return O.jja}static getInstance(Ca){O.Wa||(O.Wa=new O(Ca));return O.Wa}}O.Wa=null;O.jja=new Q.a;Object(c.a)(O,"AppsForOfficeDialogManager",null,[360]);var U=a(1490),K=a(842),F=a(641),I=a(208),P=a(427),Y=a(1094);class ea{constructor(){this.releaseDate=this.diffAUP=
this.AUP=this.priority=0}}Object(c.a)(ea,"AddinDetailInfo",null,[]);class Ba{constructor(Ca,yb){this.failure=null;this.T9=Ca;this.errorCode=void 0===yb?0:yb}}Object(c.a)(Ba,"AddinQueryResult",null,[]);class Fa extends Ba{constructor(Ca,yb){super(Ca,void 0===yb?0:yb);this.solutionIds=null}}Object(c.a)(Fa,"AddinCollection",Ba,[]);var za;(function(Ca){Ca[Ca.stop=-1]="stop";Ca[Ca.skip=0]="skip";Ca[Ca.query=1]="query"})(za||(za={}));Object(c.b)("QueryStrategy",za);var xa=a(1029);class fa extends Sys.EventArgs{constructor(Ca,
yb,wc,dd){dd=void 0===dd?null:dd;super();this.FL=Ca;this.errorCode=yb;this.Dw=wc;this.failure=dd}}Object(c.a)(fa,"AddinDetailsRefreshedEventArgs",Sys.EventArgs,[]);class V{constructor(Ca){this.errorCode=Ca;this.Dw=[];this.failure=null}}Object(c.a)(V,"GetAddinDetailsResult",null,[]);var ba=a(908),la=a(1012);class Ta{}Object(c.a)(Ta,"GetEntitlementDetailsParameters",null,[]);var Ea=a(124),sa=a(227),Ya=a(171);class bb{constructor(Ca){this.OEe=432E5;Ca&&(this.OEe=36E5*Ca.getIntFeatureGate("Microsoft.Office.SharedOnline.FlyoutCacheExpiration",
12))}rVi(Ca){const yb=new Date;let wc=new Date(-1);try{const dd=bb.r_g(`${Ca}_ExpirationTime`);dd&&(wc=new Date(parseInt(dd,10)))}catch(dd){f.ULS.sendTraceTag(508063829,220,50,`Failed to parse expiration time for add-in ${Ca}: ${dd}`)}if(yb.getTime()<wc.getTime()&&(Ca=bb.r_g(`${Ca}_StoreDisabled`)))return"true"===Ca}zDk(Ca,yb){void 0!==yb&&null!==yb&&(bb.N_g(yb.toString(),`${Ca}_StoreDisabled`),bb.N_g(((new Date).getTime()+this.OEe).toString(),`${Ca}_ExpirationTime`))}static r_g(Ca){let yb=null;try{const wc=
bb.y8b;if(void 0!==wc&&wc){const dd=ba.a.jjb("Flyout")+"_"+Ca;yb=wc.getItem(dd)}else f.ULS.sendTraceTag(508063828,220,50,"tryGetCache: Storage.Local null")}catch(wc){f.ULS.sendTraceTag(508063827,220,10,"tryGetCache: Failed to get data Cache {0} for suffix {1}.","Flyout",Ca)}return yb}static N_g(Ca,yb){try{const wc=bb.y8b;if(void 0!==wc&&wc){const dd=ba.a.jjb("Flyout")+"_"+yb;wc.setItem(dd,Ca)}else f.ULS.sendTraceTag(508063826,220,50,"trySetCache: Storage.Local null")}catch(wc){f.ULS.sendTraceTag(508063825,
220,10,"trySetCache: Failed to set AddinCommands Cache {0} for suffix {1}.","Flyout",yb)}}static get y8b(){if(!bb.U$)return null;let Ca=null;try{Ca=localStorage}catch(yb){bb.U$=!1,Ca=null,f.ULS.sendTraceTag(508063824,220,50,`Failed to use localStorage: error name: ${yb.name}; message: ${yb.message}; stack: ${yb.stack}`)}return Ca}}bb.U$=!0;Object(c.a)(bb,"StoreDisabledCache",null,[]);class ra{constructor(Ca,yb,wc){wc=void 0===wc?null:wc;var dd;this.Rg=new d.a;this.KC=new K.a(F.a.lm());this.QE=new P.a;
this.y2=0;this.FW=new P.a;this.xfd=null;this.Gqb=(vd,Zd,Re)=>{if(Re)if(this.D0d(vd,Re,window.performance.now()-Zd),0===Re.errorCode){let ff;if(Re.value){let af=0;ff=Array(Re.value.length);Re.value.forEach(xf=>{ff[af++]=xf})}else ff=[];this.PF(new Ba(vd),ff)}else-1===Re.errorCode||10===Re.errorCode?this.PF(new Ba(vd),[]):(vd=this.vrd(vd,Zd,Re),this.PF(vd));else vd=ra.wrd(vd,Zd),this.PF(vd)};this.R2a=(vd,Zd)=>{if(0!==Zd.errorCode)this.QE.ga(Zd.FL,Object.assign(new Fa(Zd.FL,Zd.errorCode),{failure:Zd.failure})),
this.rEj&&this.Bba(Zd.FL,1);else{vd=Object.assign(new Fa(Zd.FL),{solutionIds:new I.a});var Re=Zd.Dw;for(const ff of Re)Re=ff.solutionId,this.KC.Vg(Re)?this.KC.ga(Re,this.d3d(this.KC.ma(Re),Zd.FL,ff)):this.KC.add(Re,ff),vd.solutionIds.add(Re);this.QE.ga(Zd.FL,vd);this.Bba(vd.T9,1)}};this.Msa=new sa.a;this.Msa.add(OSF.StoreTypeEnum.MarketPlace,0);this.Msa.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Ga=Ca;this.jr=yb;this.yJ=wc;this.bad=ra.SJd(Ca,"https://store-images.s-microsoft.com");this.WFb(this.R2a);
this.LVe=null!==(dd=wc.StoreDisabledCache)&&void 0!==dd?dd:new bb(Ca)}get rEj(){return!!this.Ga&&this.Ga.isChangeGateEnabled("MissRegisterCollectionTypeFixEnabled")}get kM(){return!!this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8335739_FlyoutInitializerFixEnabled")}get F0d(){return!!this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8366459_LogQueryCompletedV2Enabled")}get Tqe(){return!!this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8350408_SingleStoreDisabledQueryEnabled")}get gSk(){return!!this.Ga&&
this.Ga.isChangeGateEnabled("OfficeVSO:8352847_StoreDisabledCacheEnabled")}get isAnonymousUser(){return!!this.Ga&&this.Ga.la("IsAnonymousUser")}get DFd(){return!!this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8335746_FlyoutUserNoMailboxFixEnabled")}get Dib(){return!!this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8335748_FlyoutUserNotSignedInFixEnabled")}get zfa(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get wl(){return this.jr.value}FX(Ca){if(this.kM&&
!this.nxa(Ca))return new V(0);if(!this.x_a(Ca))return Ca=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:Y.a[Ca]}),Object.assign(new V(1),{failure:Ca});if(this.QE.ma(Ca).failure)return Object.assign(new V(this.QE.ma(Ca).errorCode),{failure:this.QE.ma(Ca).failure});f.ULS.shipAssertTag(509870082,220,!!this.QE.ma(Ca).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",Ca);const yb=new V(0);for(const wc of this.QE.ma(Ca).solutionIds)this.KC.Vg(wc)&&
Array.add(yb.Dw,this.KC.ma(wc));return yb}getUpgradedAddinsOfOmex(){return this.wl.getUpgradedAddinsOfOmex()}EX(Ca){return this.KC.Vg(Ca)?this.KC.ma(Ca):null}Tza(Ca){if(Ca){this.WFb(Ca);for(const yb of this.QE.keys){if(this.kM&&!this.nxa(yb))continue;if(!this.x_a(yb)||this.QE.ma(yb).failure)continue;f.ULS.shipAssertTag(509870081,220,!!this.QE.ma(yb).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",yb);const wc=[],dd=this.QE.ma(yb);for(const vd of dd.solutionIds)Array.add(wc,
this.KC.ma(vd));Ca(null,new fa(yb,dd.errorCode,wc,dd.failure))}}}get name(){return"AddinDetailsManager1"}Usb(Ca,yb){if(this.kM&&ra.h1a(Ca)){var wc=vd=>{this.PF(ra.cVa(vd,4,"The connected service is disabled."));this.Bba(vd,-1)},dd=vd=>{this.PF(ra.cVa(vd,0,"The user doesn't have any addin installed."),[]);this.Bba(vd,0)};0===Ca?(this.MSb(0,yb,wc,dd),this.MSb(2,yb,wc,()=>{this.x4a(this.Gqb)})):10===Ca&&this.Bba(1,1)}}YF(Ca,yb){ra.h1a(Ca)?this.zce(Ca,this.Gqb,void 0===yb?!1:yb):f.ULS.sendTraceTag(509870080,
220,50,"QueryAddinDetails: skipping providerType: {0}.",la.a[Ca])}WFb(Ca){this.Rg.addHandler(ba.a.Wkc,Ca)}MSb(Ca,yb,wc,dd){this.nxa(Ca)||(3===yb&&wc?wc(Ca):2===yb&&dd?dd(Ca):this.Bba(Ca,1))}nxa(Ca){return this.FW.Vg(Ca)}Bba(Ca,yb){if(this.kM){var wc=this.nxa(Ca);if(!wc||-1!==this.FW.ma(Ca)&&this.FW.ma(Ca)!==yb)f.ULS.sendTraceTag(508610435,220,50,"RegisterCollectionType: collectionType: {0}, strategy: {1} -> {2}.",Y.a[Ca],wc?za[this.FW.ma(Ca)]:"undefined",za[yb]),this.FW.ga(Ca,yb)}}vrd(Ca,yb,wc){const dd=
{};dd.collectionType=Y.a[Ca];dd.invokeResultCode=wc.errorCode;dd["queryResult.Value"]=wc.value?String.format("Length: {0}",wc.value.length):"null";dd.queryStart=yb;dd.queryDuration=window.performance.now()-yb;return Object.assign(new Ba(Ca,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",dd)})}uIk(){return this.x_a(2)?this.Ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?3===this.QE.ma(2).errorCode:!1:!0}Hvb(Ca){return this.kM&&this.FW.Vg(Ca)?1===
this.FW.ma(Ca):!0}zce(Ca,yb,wc){wc=void 0===wc?!1:wc;f.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",Ca);if(Ca!==OSF.StoreTypeEnum.MarketPlace&&Ca!==OSF.StoreTypeEnum.PrivateCatalog)f.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",Ca);else{var dd=this.Msa.ma(Ca);(!this.Tqe||this.Dib&&this.isAnonymousUser)&&Ca===OSF.StoreTypeEnum.MarketPlace&&this.Hvb(2)&&this.x4a(yb);this.Hvb(dd)&&(this.Dib&&this.isAnonymousUser?(Ca=ra.hrd(dd),this.PF(Ca)):this.Ace(Ca,
yb,wc))}}Ace(Ca,yb,wc){this.zvg(Ca,(dd,vd)=>{if(dd===OSF.StoreTypeEnum.MarketPlace&&vd)vd=ra.QFa(0),this.PF(vd),this.Tqe&&this.PF(ra.QFa(2));else if(dd===OSF.StoreTypeEnum.PrivateCatalog&&vd)vd=ra.QFa(1),this.PF(vd);else{this.Tqe&&dd===OSF.StoreTypeEnum.MarketPlace&&this.Hvb(2)&&yb(2,window.performance.now(),this.FFg());var Zd=window.performance.now();this.wl.getEntitlementDetails(Object.assign(new Ta,{storeType:dd,refresh:wc}),Re=>{yb(this.Msa.ma(dd),Zd,Re)})}})}x4a(Ca){this.uIk()&&this.zvg(0,(yb,
wc)=>{wc?(yb=ra.QFa(2),this.PF(yb)):(yb=window.performance.now(),Ca(2,yb,this.FFg()))})}PF(Ca,yb){yb=void 0===yb?null:yb;0!==Ca.errorCode?(f.ULS.shipAssertTag(509116673,220,!yb,"The parameter addinDetails must be null for any failed queries"),f.ULS.shipAssertTag(509116672,220,!!Ca.failure,"The result.Failure must not be available for any failed queries"),this.epe(Ca)?f.ULS.sendTraceTag(510253056,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}",
"",Y.a[Ca.T9],xa.a[Ca.errorCode],Ca.failure?Ca.failure.toString():"null",JSON.stringify(Ca.failure)):f.ULS.sendTraceTag(508610434,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","(downgraded error)",Y.a[Ca.T9],xa.a[Ca.errorCode],Ca.failure?Ca.failure.toString():"null",JSON.stringify(Ca.failure))):(f.ULS.shipAssertTag(509116643,220,!!yb,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is null.",
Y.a[Ca.T9]),f.ULS.sendTraceTag(509116642,220,50,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails",Y.a[Ca.T9],yb?yb.length:-1));Ca=new fa(Ca.T9,Ca.errorCode,yb,Ca.failure);this.Rg.raiseEvent(ba.a.Wkc,Ca)}epe(Ca){return 3===Ca.errorCode&&(this.Dib&&-2147208619===ra.ZPb(Ca)||this.DFd&&-2===ra.ZPb(Ca))||4===Ca.errorCode?!1:2!==Ca.errorCode}x_a(Ca){return this.QE.Vg(Ca)?!!this.KC:!1}get Xlc(){return this.yJ?!this.yJ.AreThirdPartyAddInsAllowed||this.yJ.AppsForOfficeThirdPartyIsDisabled:
!this.Ga.la("AreThirdPartyAddInsAllowed")||this.Ga.la("AppsForOfficeThirdPartyIsDisabled")}get $Fc(){return this.yJ?!this.yJ.AppsForOfficeAllowExternalMarketplace:!this.Ga.la("AppsForOfficeAllowExternalMarketplace")}get Prb(){return this.yJ?this.yJ.PopularAddinDetailsJsonString:this.Ga.Xa("PopularAddinDetailsJsonString")}queryStoreDisabled(Ca,yb){if(this.Xlc)yb(Ca,!0);else if(Ca===OSF.StoreTypeEnum.MarketPlace&&this.$Fc)yb(Ca,!0);else{const wc=ra.A_c(Ca);if(wc){const dd=window.performance.now();this.wl.queryStoreDisabled(wc,
vd=>{f.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",Ca,vd,dd,window.performance.now()-dd);yb(Ca,vd)})}else yb(Ca,!1)}}zvg(Ca,yb){if(this.gSk)if(this.Xlc)yb(Ca,!0);else if(Ca===OSF.StoreTypeEnum.MarketPlace&&this.$Fc)yb(Ca,!0);else{const wc=ra.A_c(Ca),dd=this.LVe.rVi(Ca);if(void 0===dd)if(wc){const vd=window.performance.now();this.wl.queryStoreDisabled(wc,Zd=>{this.LVe.zDk(Ca,Zd);f.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",
Ca,Zd,vd,window.performance.now()-vd);yb(Ca,void 0!==Zd?Zd:!0)})}else yb(Ca,!1);else yb(Ca,dd)}else this.queryStoreDisabled(Ca,yb)}d3d(Ca,yb,wc){return Ca?wc?2===yb?ra.vYb(wc,Ca):ra.vYb(Ca,wc):Ca:wc}FFg(){if(!this.xfd){const Ca=JSON.parse(this.Prb);this.jFd(Ca);this.xfd=Ca}return ra.hnc(0,this.xfd)}jFd(Ca){ra.Lod(Ca);this.Plc(Ca);this.kFd(Ca)}Plc(Ca){const yb=this.srd();for(var wc=0;wc<Ca.length&&0<yb.count;wc++){const dd=Ca[wc];if(yb.Vg(dd.solutionId)){let vd=String.format("Found an override, solutionId: {0}",
dd.solutionId);const Zd=yb.ma(dd.solutionId);Zd&&(isNaN(Zd.addinInfo.priority)||(vd=String.format("{0}; AddinInfo.Priority: update {1} to {2}",vd,dd.addinInfo.priority,Zd.addinInfo.priority),dd.addinInfo.priority=Zd.addinInfo.priority),isNaN(Zd.addinInfo.AUP)||(vd=String.format("{0}; AddinInfo.AUP: update {1} to {2}",vd,dd.addinInfo.AUP,Zd.addinInfo.AUP),dd.addinInfo.AUP=Zd.addinInfo.AUP),Zd.displayName&&(vd=String.format("{0}; DisplayName: update {1} to {2}",vd,dd.displayName,Zd.displayName),dd.displayName=
Zd.displayName),Zd.iconUrl&&(vd=String.format("{0}; IconUrl: update {1} to {2}",vd,dd.iconUrl,Zd.iconUrl),dd.iconUrl=Zd.iconUrl),Zd.description&&(vd=String.format("{0}; Description: update {1} to {2}",vd,dd.description,Zd.description),dd.description=Zd.description));yb.remove(dd.solutionId);this.zfa&&f.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",vd)}}for(const dd of yb.keys)wc=yb.ma(dd),wc.displayName&&wc.iconUrl&&wc.addinInfo&&(Ca.push(wc),this.zfa&&f.ULS.sendTraceTag(509379107,
220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(wc)))}srd(){const Ca=new K.a(F.a.lm());let yb=this.Ga.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!yb)return Ca;yb=yb.trim();if(12>=yb.length)return 0<yb.length&&f.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",yb),Ca;this.zfa&&f.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",
yb);try{const wc=[],dd=yb.split("|");for(let vd=dd.length-1;0<=vd;vd--){const Zd=dd[vd],Re=Zd.split("\\");if(2>Re.length){wc.push(Zd);continue}const ff=ra.q$d(Re);ff?Ca.Vg(ff.solutionId)||Ca.add(ff.solutionId,ff):wc.push(Zd)}this.zfa&&0<wc.length&&f.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",wc.join("|"));this.zfa&&0<Ca.count&&f.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",Ca.count,JSON.stringify(Ya.toArray(Ca.values)));
return Ca}catch(wc){f.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",yb,wc.toString())}return Ca}kFd(Ca){for(let yb=0;yb<Ca.length;yb++)Ea.c(Ca[yb].iconUrl.toLowerCase(),"http",0)||(Ca[yb].iconUrl=String.format("{0}/image/apps.{1}",this.bad,Ca[yb].iconUrl))}static h1a(Ca){return 0===Ca||10===Ca}static wrd(Ca,yb){const wc={};wc.collectionType=Y.a[Ca];wc.queryResult="null";wc.queryStart=yb;wc.queryDuration=window.performance.now()-
yb;return Object.assign(new Ba(Ca,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",wc)})}static cVa(Ca,yb,wc){const dd={};dd.collectionType=Y.a[Ca];Ca=new Ba(Ca,yb);0!==yb&&(Ca.failure=Error.create(wc,dd));return Ca}static QFa(Ca){return ra.cVa(Ca,2,"The store is disabled.")}static hrd(Ca){const yb={};yb.collectionType=Y.a[Ca];yb.invokeResultCode=-2147208619;yb.queryDuration=0;return Object.assign(new Ba(Ca,3),{failure:Error.create("Anonymous users do not have installed add-ins.",
yb)})}static ZPb(Ca){return Ca.failure?Ca.failure.invokeResultCode:-1E3}E0d(Ca,yb,wc){const dd={};dd.AddinCollectionType=Y.a[Ca];dd.ErrorCode=yb.errorCode;dd.AddinCount=yb.value?yb.value.length:0;Ca=window.performance.now();yb=Date.now()-l.AFrameworkApplication.LQ;f.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; window: {1} ms; framework: {2} ms; fields: {3}",wc,Ca,yb,JSON.stringify(dd))}D0d(Ca,yb,wc){this.F0d?(wc={["AddinCollectionType"]:Y.a[Ca],
["ErrorCode"]:yb.errorCode,["QueryDuration"]:wc,["FlyoutDataReadySinceBoot"]:Date.now()-l.AFrameworkApplication.LQ},this.eUd(Ca)&&f.ULS.sendTraceTag(508069333,220,50,"{0}",JSON.stringify(wc)),wc.AddinCount=yb.value?yb.value.length:0,f.ULS.sendTraceTag(512231322,220,50,"logQueryCompletedResult: {0}",JSON.stringify(wc))):this.E0d(Ca,yb,wc)}eUd(Ca){0===Ca?this.y2|=1:1===Ca&&(this.y2|=2);Ca=this.y2&131;if(Ca=1===Ca||2===Ca)this.y2=255;return Ca}static hnc(Ca,yb){const wc={};wc.errorCode=Ca;wc.value=yb;
return wc}static A_c(Ca){return Ca===OSF.StoreTypeEnum.MarketPlace?"omex":Ca===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static vYb(Ca,yb){yb.solutionId=yb.solutionId||Ca.solutionId;yb.version=yb.version||Ca.version;yb.storeType=yb.storeType||Ca.storeType;yb.storeId=yb.storeId||Ca.storeId;yb.assetId=yb.assetId||Ca.assetId;yb.assetStoreId=yb.assetStoreId||Ca.assetStoreId;yb.displayName=yb.displayName||Ca.displayName;yb.provider=yb.provider||Ca.provider;yb.description=yb.description||Ca.description;
yb.iconUrl=yb.iconUrl||Ca.iconUrl;yb.webApplicationId=yb.webApplicationId||Ca.webApplicationId;yb.highResolutionIconUrl=yb.highResolutionIconUrl||Ca.highResolutionIconUrl;yb.licenseUrl=yb.licenseUrl||Ca.licenseUrl;yb.privacyUrl=yb.privacyUrl||Ca.privacyUrl;yb.addinInfo=yb.addinInfo||Ca.addinInfo;isNaN(yb.targetType)&&(yb.targetType=Ca.targetType);isNaN(yb.height)&&(yb.height=Ca.height);isNaN(yb.width)&&(yb.width=Ca.width);return yb}static Lod(Ca){for(const yb of Ca)isNaN(yb.targetType)&&(yb.targetType=
1),yb.assetId=yb.assetId||yb.solutionId,yb.storeId=yb.storeId||"en-US",yb.storeType=yb.storeType||"omex",yb.assetStoreId=yb.assetStoreId||"omex",isNaN(yb.width)&&(yb.width=0),isNaN(yb.height)&&(yb.height=0)}static q$d(Ca){const yb={};let wc=0;wc<Ca.length&&0<Ca[wc].trim().length&&Ca[wc].trim().toLowerCase().startsWith("wa")&&(yb.solutionId=Ca[wc].trim(),yb.addinInfo=Object.assign(new ea,{priority:Number.NaN,AUP:Number.NaN}),++wc<Ca.length&&0<Ca[wc].trim().length&&(yb.addinInfo.priority=parseInt(Ca[wc].trim())),
++wc<Ca.length&&0<Ca[wc].trim().length&&(yb.addinInfo.AUP=parseInt(Ca[wc].trim())),++wc<Ca.length&&0<Ca[wc].trim().length&&(yb.displayName=Ca[wc].trim()),++wc<Ca.length&&0<Ca[wc].trim().length&&(yb.iconUrl=Ca[wc].trim()),++wc<Ca.length&&0<Ca[wc].trim().length&&(yb.description=Ca[wc].trim()));return yb.solutionId?yb:null}static SJd(Ca,yb){Ca=Ca.Xa("AddinImageStoreServiceUrl");if(!Ca)return yb;Ca=Ca.toLowerCase();return Ca.startsWith("http://")||Ca.startsWith("https://")?Ca:yb}}Object(c.a)(ra,"AddinDetailsManager1",
null,[378,379]);class Da{constructor(Ca,yb){this.description=this.provider=this.displayName=this.assetStoreId=this.assetId=this.storeId=this.storeType=this.version=this.solutionId=this.addinInfo=null;this.width=this.height=this.targetType=0;this.privacyUrl=this.licenseUrl=this.highResolutionIconUrl=this.webApplicationId=this.iconUrl=null;this.solutionId=Ca.solutionId;this.version=Ca.version;this.storeType=Ca.storeType;this.storeId=Ca.storeId;this.assetId=Ca.assetId;this.assetStoreId=Ca.assetStoreId;
this.displayName=Ca.displayName;this.provider=Ca.provider;this.description=Ca.description;this.targetType=Ca.targetType;this.height=Ca.height;this.width=Ca.width;this.iconUrl=Ca.iconUrl;this.webApplicationId=Ca.webApplicationId;this.highResolutionIconUrl=Ca.highResolutionIconUrl;this.licenseUrl=Ca.licenseUrl;this.privacyUrl=Ca.privacyUrl;this.addinInfo=void 0===yb?null:yb}H8b(){const Ca={};Ca.solutionId=this.solutionId;Ca.version=this.version;Ca.storeType=this.storeType;Ca.storeId=this.storeId;Ca.assetId=
this.assetId;Ca.assetStoreId=this.assetStoreId;Ca.targetType=this.targetType;Ca.displayName=this.displayName;Ca.width=this.width;Ca.height=this.height;return Ca}}Object(c.a)(Da,"AddinDetail",null,[]);class oa{constructor(Ca,yb,wc,dd,vd){this.Rhc=null;this.Ga=Ca;this.jr=yb;this.NSa=wc;this.mnh=dd;this.Tzb=vd}YF(Ca,yb){this.wl.queryAppDetails(this.mnh,this.Tzb,this.solutionIds,Ca,(wc,dd)=>{let vd=null;if(dd){vd=Array(dd.length);for(let Zd=0;Zd<dd.length;Zd++)vd[Zd]=new Da(dd[Zd],this.aAj(dd[Zd].solutionId))}yb(wc,
vd||[])})}get mjj(){return!!this.wl.queryAppDetails}aAj(Ca){return this.NSa.ma(Ca)}get solutionIds(){if(!this.Rhc){this.Rhc=new I.a;for(const Ca of this.NSa.keys)this.Rhc.add(Ea.d(Ca))}return this.Rhc.toArray()}get wl(){return this.jr.value}}Object(c.a)(oa,"AddinDetailsLoader",null,[]);class Ha{constructor(Ca,yb){this.failure=null;this.T9=Ca;this.errorCode=void 0===yb?0:yb}}Object(c.a)(Ha,"AddinQueryResult",null,[]);class ka extends Ha{constructor(Ca,yb){super(Ca,void 0===yb?0:yb);this.pse=this.solutionIds=
null}}Object(c.a)(ka,"AddinCollection",Ha,[]);var wa=a(888);class Za extends wa.a{constructor(){super(F.a.lm())}}Object(c.a)(Za,"AddinDetailTable",wa.a,[]);var ab;(function(Ca){Ca[Ca.stop=-1]="stop";Ca[Ca.skip=0]="skip";Ca[Ca.query=1]="query"})(ab||(ab={}));Object(c.b)("QueryStrategy",ab);class db{constructor(Ca,yb,wc){wc=void 0===wc?null:wc;this.Rg=new d.a;this.KC=new K.a(F.a.lm());this.QE=new P.a;this.y2=0;this.FW=new P.a;this.NSa=this.g6c=null;this.Gqb=(dd,vd,Zd)=>{Zd?(this.D0d(dd,Zd,window.performance.now()-
vd),0===Zd.errorCode?(vd=Zd.value?db.LDh(Zd.value):[],this.PF(new Ha(dd),vd)):-1===Zd.errorCode||10===Zd.errorCode?this.PF(new Ha(dd),[]):(dd=this.vrd(dd,vd,Zd),this.PF(dd))):(dd=db.wrd(dd,vd),this.PF(dd))};this.R2a=(dd,vd)=>{if(0!==vd.errorCode&&5!==vd.errorCode)this.u1g(vd.FL,Object.assign(new ka(vd.FL,vd.errorCode),{failure:vd.failure}));else{dd=Object.assign(new ka(vd.FL,vd.errorCode),{solutionIds:new I.a,pse:new I.a});var Zd=vd.Dw;for(const ff of Zd){Zd=ff.solutionId;const af=ff.storeId;if(this.KC.Vg(Zd)){var Re=
this.KC.ma(Zd);Re.Vg(af)?Re.ga(af,this.d3d(Re.ma(af),vd.FL,ff)):Re.add(af,ff)}else Re=new Za,Re.add(af,ff),this.KC.add(Zd,Re);dd.solutionIds.add(Zd);dd.pse.add(af)}this.u1g(vd.FL,dd)}};this.Msa=new sa.a;this.Msa.add(OSF.StoreTypeEnum.MarketPlace,0);this.Msa.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Ga=Ca;this.jr=yb;this.yJ=wc;this.bad=db.SJd(Ca,"https://store-images.s-microsoft.com");this.yfd=null;this.WFb(this.R2a)}get inc(){this.g6c||(this.g6c=this.vBf());return this.g6c}vBf(){const Ca=JSON.parse(this.Prb);
this.jFd(Ca);return Ca.map(yb=>new Da(yb,yb.addinInfo))}get kM(){return!!this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8335739_FlyoutInitializerFixEnabled")}get F0d(){return!!this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8366459_LogQueryCompletedV2Enabled")}get isAnonymousUser(){return!!this.Ga&&this.Ga.la("IsAnonymousUser")}get DFd(){return!!this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8335746_FlyoutUserNoMailboxFixEnabled")}get Dib(){return!!this.Ga&&this.Ga.isChangeGateEnabled("OfficeVSO:8335748_FlyoutUserNotSignedInFixEnabled")}get zfa(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",
!1)}get wl(){return this.jr.value}get lae(){this.yfd||(this.yfd=new oa(this.Ga,this.jr,this.P3j,0,this.wl.getAppUILocale()));return this.yfd}FX(Ca){if(this.kM&&!this.nxa(Ca))return new V(0);if(!this.x_a(Ca))return Ca=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:Y.a[Ca]}),Object.assign(new V(1),{failure:Ca});const yb=this.QE.ma(Ca);if(yb.failure)return Object.assign(new V(yb.errorCode),{failure:yb.failure});f.ULS.shipAssertTag(509870082,220,!!yb.solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",
Ca);const wc=new V(yb.errorCode);for(let dd=0;dd<yb.solutionIds.count;dd++){const vd=yb.solutionIds.ma(dd),Zd=yb.pse.ma(dd);if(this.KC.Vg(vd)){const Re=this.KC.ma(vd);Re.Vg(Zd)?Array.add(wc.Dw,Re.ma(Zd)):f.ULS.sendTraceTag(508610437,220,15,"The addin with solutionId '{0}' in '{1}' must contain storeId '{2}' when the collection is ready.",vd,Ca,Zd)}else f.ULS.sendTraceTag(508610436,220,15,"The addin with solutionId '{0}' in '{1}' must exist when the collection is ready.",vd,Ca)}return wc}getUpgradedAddinsOfOmex(){return this.wl.getUpgradedAddinsOfOmex()}EX(Ca,
yb){yb=void 0===yb?null:yb;if(Ca=this.RBi(Ca))if(yb||(yb=this.uiCulture),Ca.Vg(yb))return Ca.ma(yb);return null}RBi(Ca){return this.KC.Vg(Ca)?this.KC.ma(Ca):null}Tza(Ca){if(Ca){this.WFb(Ca);for(const yb of this.QE.keys){if(this.kM&&!this.nxa(yb))continue;if(!this.x_a(yb)||this.QE.ma(yb).failure)continue;f.ULS.shipAssertTag(509870081,220,!!this.QE.ma(yb).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",yb);const wc=[],dd=this.QE.ma(yb);for(const vd of dd.solutionIds)Array.add(wc,
this.KC.ma(vd));Ca(null,new fa(yb,dd.errorCode,wc,dd.failure))}}}get name(){return"AddinDetailsManager2"}Usb(Ca,yb){if(this.kM&&db.h1a(Ca)){var wc=vd=>{this.PF(db.cVa(vd,4,"The connected service is disabled."));this.Bba(vd,-1)},dd=vd=>{this.PF(db.cVa(vd,0,"The user doesn't have any addin installed."),[]);this.Bba(vd,0)};0===Ca?(this.MSb(0,yb,wc,dd),this.MSb(2,yb,wc,()=>{this.x4a(this.Gqb,this.inc)})):10===Ca&&this.Bba(1,1)}}YF(Ca,yb){db.h1a(Ca)?this.zce(Ca,this.Gqb,void 0===yb?!1:yb):f.ULS.sendTraceTag(509870080,
220,50,"QueryAddinDetails: skipping providerType: {0}.",la.a[Ca])}WFb(Ca){this.Rg.addHandler(ba.a.Wkc,Ca)}MSb(Ca,yb,wc,dd){this.nxa(Ca)||(3===yb&&wc?wc(Ca):2===yb&&dd?dd(Ca):this.Bba(Ca,1))}nxa(Ca){return this.FW.Vg(Ca)}Bba(Ca,yb){if(this.kM){var wc=this.nxa(Ca);if(!wc||-1!==this.FW.ma(Ca)&&this.FW.ma(Ca)!==yb)f.ULS.sendTraceTag(508610435,220,50,"RegisterCollectionType: collectionType: {0}, strategy: {1} -> {2}.",Y.a[Ca],wc?ab[this.FW.ma(Ca)]:"undefined",ab[yb]),this.FW.ga(Ca,yb)}}vrd(Ca,yb,wc){const dd=
{};dd.collectionType=Y.a[Ca];dd.invokeResultCode=wc.errorCode;dd["queryResult.Value"]=wc.value?String.format("Length: {0}",wc.value.length):"null";dd.queryStart=yb;dd.queryDuration=window.performance.now()-yb;return Object.assign(new Ha(Ca,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",dd)})}vIk(Ca){if(Ca!==OSF.StoreTypeEnum.MarketPlace)return!1;if(this.Hvb(2)){if(!this.x_a(2))return!0;if(this.Ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins"))return 3===
this.QE.ma(2).errorCode}return!1}Hvb(Ca){return this.kM&&this.FW.Vg(Ca)?1===this.FW.ma(Ca):!0}zce(Ca,yb,wc){wc=void 0===wc?!1:wc;f.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",Ca);if(Ca!==OSF.StoreTypeEnum.MarketPlace&&Ca!==OSF.StoreTypeEnum.PrivateCatalog)f.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",Ca);else{var dd=this.Msa.ma(Ca);this.vIk(Ca)&&this.x4a(yb,this.x5j);this.Hvb(dd)&&(this.Dib&&this.isAnonymousUser?(Ca=db.hrd(dd),this.PF(Ca)):this.Ace(Ca,
yb,wc))}}get x5j(){return this.QE.Vg(2)?null:this.inc}Ace(Ca,yb,wc){this.queryStoreDisabled(Ca,(dd,vd)=>{if(dd===OSF.StoreTypeEnum.MarketPlace&&vd)vd=db.QFa(0),this.PF(vd);else if(dd===OSF.StoreTypeEnum.PrivateCatalog&&vd)vd=db.QFa(1),this.PF(vd);else{var Zd=window.performance.now();this.wl.getEntitlementDetails(Object.assign(new Ta,{storeType:dd,refresh:wc}),Re=>{yb(this.Msa.ma(dd),Zd,Re)})}})}x4a(Ca,yb){Ca=void 0===Ca?null:Ca;yb=void 0===yb?null:yb;null===Ca&&(Ca=this.Gqb);this.queryStoreDisabled(0,
(wc,dd)=>{dd?(wc=db.QFa(2),this.PF(wc)):null!=yb?this.PF(new Ha(2,5),yb):this.a9j(Ca)})}PF(Ca,yb){yb=void 0===yb?null:yb;0!==Ca.errorCode&&5!==Ca.errorCode?(f.ULS.shipAssertTag(509116673,220,!yb,"The parameter addinDetails must be null for any failed queries"),f.ULS.shipAssertTag(509116672,220,!!Ca.failure,"The result.Failure must not be available for any failed queries"),this.epe(Ca)?f.ULS.sendTraceTag(510253056,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}",
"",Y.a[Ca.T9],xa.a[Ca.errorCode],Ca.failure?Ca.failure.toString():"null",JSON.stringify(Ca.failure)):f.ULS.sendTraceTag(508610434,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","(downgraded error)",Y.a[Ca.T9],xa.a[Ca.errorCode],Ca.failure?Ca.failure.toString():"null",JSON.stringify(Ca.failure))):(f.ULS.shipAssertTag(509116643,220,!!yb,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is null.",
Y.a[Ca.T9]),f.ULS.sendTraceTag(509116642,220,50,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails, errorCode: {2}",Y.a[Ca.T9],yb?yb.length:-1,xa.a[Ca.errorCode]));Ca=new fa(Ca.T9,Ca.errorCode,yb,Ca.failure);this.Rg.raiseEvent(ba.a.Wkc,Ca)}epe(Ca){return 3===Ca.errorCode&&(this.Dib&&-2147208619===db.ZPb(Ca)||this.DFd&&-2===db.ZPb(Ca))||4===Ca.errorCode?!1:2!==Ca.errorCode}u1g(Ca,yb){this.QE.ga(Ca,yb);this.Bba(Ca,1)}x_a(Ca){return this.QE.Vg(Ca)?!!this.KC:!1}get uiCulture(){return this.yJ&&
this.yJ.UICulture?this.yJ.UICulture:l.AFrameworkApplication.uiCulture}get Xlc(){return this.yJ?!this.yJ.AreThirdPartyAddInsAllowed||this.yJ.AppsForOfficeThirdPartyIsDisabled:!this.Ga.la("AreThirdPartyAddInsAllowed")||this.Ga.la("AppsForOfficeThirdPartyIsDisabled")}get $Fc(){return this.yJ?!this.yJ.AppsForOfficeAllowExternalMarketplace:!this.Ga.la("AppsForOfficeAllowExternalMarketplace")}get P3j(){if(!this.NSa){this.NSa=new K.a(F.a.lm());const Ca=JSON.parse(this.Prb);for(const yb of Ca)this.NSa.add(yb.solutionId,
yb.addinInfo)}return this.NSa}get Prb(){return this.yJ?this.yJ.PopularAddinDetailsJsonString:this.Ga.Xa("PopularAddinDetailsJsonString")}queryStoreDisabled(Ca,yb){if(this.Xlc)yb(Ca,!0);else if(Ca===OSF.StoreTypeEnum.MarketPlace&&this.$Fc)yb(Ca,!0);else{const wc=db.A_c(Ca);if(wc){const dd=window.performance.now();this.wl.queryStoreDisabled(wc,vd=>{f.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",Ca,vd,dd,window.performance.now()-
dd);yb(Ca,vd)})}else yb(Ca,!1)}}d3d(Ca,yb,wc){return Ca?wc?2===yb?db.vYb(wc,Ca):db.vYb(Ca,wc):Ca:wc}a9j(Ca){const yb=(dd,vd,Zd)=>{Ca(2,Zd,db.hnc(dd,vd))},wc=window.performance.now();this.lae&&this.lae.mjj?this.lae.YF(!1,(dd,vd)=>{this.Plc(vd);Ca(2,wc,db.hnc(dd,vd))}):yb(0,this.vBf(),wc)}jFd(Ca){db.Lod(Ca);this.Plc(Ca);this.kFd(Ca)}Plc(Ca){const yb=this.srd();for(var wc=0;wc<Ca.length&&0<yb.count;wc++){const dd=Ca[wc];if(yb.Vg(dd.solutionId)){let vd=String.format("Found an override, solutionId: {0}",
dd.solutionId);const Zd=yb.ma(dd.solutionId);Zd&&(isNaN(Zd.addinInfo.priority)||(vd=String.format("{0}; AddinInfo.Priority: update {1} to {2}",vd,dd.addinInfo.priority,Zd.addinInfo.priority),dd.addinInfo.priority=Zd.addinInfo.priority),isNaN(Zd.addinInfo.AUP)||(vd=String.format("{0}; AddinInfo.AUP: update {1} to {2}",vd,dd.addinInfo.AUP,Zd.addinInfo.AUP),dd.addinInfo.AUP=Zd.addinInfo.AUP),Zd.displayName&&(vd=String.format("{0}; DisplayName: update {1} to {2}",vd,dd.displayName,Zd.displayName),dd.displayName=
Zd.displayName),Zd.iconUrl&&(vd=String.format("{0}; IconUrl: update {1} to {2}",vd,dd.iconUrl,Zd.iconUrl),dd.iconUrl=Zd.iconUrl),Zd.description&&(vd=String.format("{0}; Description: update {1} to {2}",vd,dd.description,Zd.description),dd.description=Zd.description));yb.remove(dd.solutionId);this.zfa&&f.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",vd)}}for(const dd of yb.keys)wc=yb.ma(dd),wc.displayName&&wc.iconUrl&&wc.addinInfo&&(Ca.push(wc),this.zfa&&f.ULS.sendTraceTag(509379107,
220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(wc)))}srd(){const Ca=new K.a(F.a.lm());let yb=this.Ga.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!yb)return Ca;yb=yb.trim();if(12>=yb.length)return 0<yb.length&&f.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",yb),Ca;this.zfa&&f.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",
yb);try{const wc=[],dd=yb.split("|");for(let vd=dd.length-1;0<=vd;vd--){const Zd=dd[vd],Re=Zd.split("\\");if(2>Re.length){wc.push(Zd);continue}const ff=db.q$d(Re);ff?Ca.Vg(ff.solutionId)||Ca.add(ff.solutionId,ff):wc.push(Zd)}this.zfa&&0<wc.length&&f.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",wc.join("|"));this.zfa&&0<Ca.count&&f.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",Ca.count,JSON.stringify(Ya.toArray(Ca.values)));
return Ca}catch(wc){f.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",yb,wc.toString())}return Ca}kFd(Ca){for(let yb=0;yb<Ca.length;yb++)Ea.c(Ca[yb].iconUrl.toLowerCase(),"http",0)||(Ca[yb].iconUrl=String.format("{0}/image/apps.{1}",this.bad,Ca[yb].iconUrl))}static h1a(Ca){return 0===Ca||10===Ca}static wrd(Ca,yb){const wc={};wc.collectionType=Y.a[Ca];wc.queryResult="null";wc.queryStart=yb;wc.queryDuration=window.performance.now()-
yb;return Object.assign(new Ha(Ca,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",wc)})}static cVa(Ca,yb,wc){const dd={};dd.collectionType=Y.a[Ca];Ca=new Ha(Ca,yb);0!==yb&&(Ca.failure=Error.create(wc,dd));return Ca}static QFa(Ca){return db.cVa(Ca,2,"The store is disabled.")}static hrd(Ca){const yb={};yb.collectionType=Y.a[Ca];yb.invokeResultCode=-2147208619;yb.queryDuration=0;return Object.assign(new Ha(Ca,3),{failure:Error.create("Anonymous users do not have installed add-ins.",
yb)})}static ZPb(Ca){return Ca.failure?Ca.failure.invokeResultCode:-1E3}E0d(Ca,yb,wc){const dd={};dd.AddinCollectionType=Y.a[Ca];dd.ErrorCode=yb.errorCode;dd.AddinCount=yb.value?yb.value.length:0;Ca=window.performance.now();yb=Date.now()-l.AFrameworkApplication.LQ;f.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; window: {1} ms; framework: {2} ms; fields: {3}",wc,Ca,yb,JSON.stringify(dd))}D0d(Ca,yb,wc){this.F0d?(wc={["AddinCollectionType"]:Y.a[Ca],
["ErrorCode"]:yb.errorCode,["QueryDuration"]:wc,["FlyoutDataReadySinceBoot"]:Date.now()-l.AFrameworkApplication.LQ},this.eUd(Ca)&&f.ULS.sendTraceTag(508069333,220,50,"{0}",JSON.stringify(wc)),wc.AddinCount=yb.value?yb.value.length:0,f.ULS.sendTraceTag(512231322,220,50,"logQueryCompletedResult: {0}",JSON.stringify(wc))):this.E0d(Ca,yb,wc)}eUd(Ca){0===Ca?this.y2|=1:1===Ca&&(this.y2|=2);Ca=this.y2&131;if(Ca=1===Ca||2===Ca)this.y2=255;return Ca}static hnc(Ca,yb){const wc={};wc.errorCode=Ca;wc.value=yb;
return wc}static A_c(Ca){return Ca===OSF.StoreTypeEnum.MarketPlace?"omex":Ca===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static vYb(Ca,yb){yb.solutionId=yb.solutionId||Ca.solutionId;yb.version=yb.version||Ca.version;yb.storeType=yb.storeType||Ca.storeType;yb.storeId=yb.storeId||Ca.storeId;yb.assetId=yb.assetId||Ca.assetId;yb.assetStoreId=yb.assetStoreId||Ca.assetStoreId;yb.displayName=yb.displayName||Ca.displayName;yb.provider=yb.provider||Ca.provider;yb.description=yb.description||Ca.description;
yb.iconUrl=yb.iconUrl||Ca.iconUrl;yb.webApplicationId=yb.webApplicationId||Ca.webApplicationId;yb.highResolutionIconUrl=yb.highResolutionIconUrl||Ca.highResolutionIconUrl;yb.licenseUrl=yb.licenseUrl||Ca.licenseUrl;yb.privacyUrl=yb.privacyUrl||Ca.privacyUrl;yb.addinInfo=yb.addinInfo||Ca.addinInfo;isNaN(yb.targetType)&&(yb.targetType=Ca.targetType);isNaN(yb.height)&&(yb.height=Ca.height);isNaN(yb.width)&&(yb.width=Ca.width);return yb}static LDh(Ca){const yb=Array(Ca.length);for(let wc=0;wc<yb.length;wc++)yb[wc]=
new Da(Ca[wc],Ca[wc].addinInfo);return yb}static Lod(Ca){for(const yb of Ca)isNaN(yb.targetType)&&(yb.targetType=1),yb.assetId=yb.assetId||yb.solutionId,yb.storeId=yb.storeId||"en-US",yb.storeType=yb.storeType||"omex",yb.assetStoreId=yb.assetStoreId||"omex",isNaN(yb.width)&&(yb.width=0),isNaN(yb.height)&&(yb.height=0)}static q$d(Ca){const yb={};let wc=0;wc<Ca.length&&0<Ca[wc].trim().length&&Ca[wc].trim().toLowerCase().startsWith("wa")&&(yb.solutionId=Ca[wc].trim(),yb.addinInfo=Object.assign(new ea,
{priority:Number.NaN,AUP:Number.NaN}),++wc<Ca.length&&0<Ca[wc].trim().length&&(yb.addinInfo.priority=parseInt(Ca[wc].trim())),++wc<Ca.length&&0<Ca[wc].trim().length&&(yb.addinInfo.AUP=parseInt(Ca[wc].trim())),++wc<Ca.length&&0<Ca[wc].trim().length&&(yb.displayName=Ca[wc].trim()),++wc<Ca.length&&0<Ca[wc].trim().length&&(yb.iconUrl=Ca[wc].trim()),++wc<Ca.length&&0<Ca[wc].trim().length&&(yb.description=Ca[wc].trim()));return yb.solutionId?yb:null}static SJd(Ca,yb){Ca=Ca.Xa("AddinImageStoreServiceUrl");
if(!Ca)return yb;Ca=Ca.toLowerCase();return Ca.startsWith("http://")||Ca.startsWith("https://")?Ca:yb}}Object(c.a)(db,"AddinDetailsManager2",null,[377]);class mb{constructor(Ca,yb){this.Qrb="popular";this.P1e="addinDetails";this.p9e="cache-lastUpdate";this.I8e="builtin-lastUpdate";this.Vrg=144E5;this.Ga=this.YS=null;this.QJj=(wc,dd)=>{2===dd.FL&&0===dd.errorCode&&(this.Rrd=dd.Dw,this.ync=this.now,f.ULS.sendTraceTag(508352221,220,50,"AddinDetailsCacheManager.onAddinDetailsUpdated: cached popular addins were refreshed."))};
this.YS=yb;this.Ga=Ca;this.YS.Tza(this.QJj);this.Vrg=this.Ga.getIntFeatureGate("Microsoft.Office.SharedOnline.PopularCacheExpirationTime",144E5)}get Fmj(){return this.ync?this.now.getTime()-this.ync.getTime()>=this.Vrg:!0}FX(Ca){var yb=this.YS.FX(Ca);2===Ca&&this.Emj(yb.errorCode)&&(Ca=this.Rrd,null!=Ca?(this.Fmj&&this.YS.x4a(null,null),yb=this.toDateString(this.now),yb=this.toDateString(this.Ard)===yb?this.frd(5,this.YS.inc):this.frd(0,Ca)):(mb.U$&&(yb=this.frd(5,this.YS.inc)),this.Ard=this.now,
this.YS.x4a(null,null)));return yb}frd(Ca,yb){var wc=void 0===wc?null:wc;return Object.assign(new V(Ca),{Dw:yb,failure:wc})}toDateString(Ca){return Ca.toISOString().substring(2,16)}get Ard(){const Ca=mb.r8a(this.Qrb,this.I8e);return null!==Ca?new Date(Ca):new Date(0)}set Ard(Ca){mb.IPa(this.Qrb,Ca.toISOString(),this.I8e)}get ync(){const Ca=mb.r8a(this.Qrb,this.p9e);return null!==Ca?new Date(Ca):new Date(0)}set ync(Ca){mb.IPa(this.Qrb,Ca.toISOString(),this.p9e)}get Rrd(){const Ca=mb.r8a(this.Qrb,this.P1e);
let yb=null;Ca&&(yb=JSON.parse(Ca));return yb}set Rrd(Ca){Ca=JSON.stringify(Ca);mb.IPa(this.Qrb,Ca,this.P1e)}get now(){return new Date}Emj(Ca){return 2!==Ca&&4!==Ca}EX(Ca,yb){return this.YS.EX(Ca,void 0===yb?null:yb)}getUpgradedAddinsOfOmex(){return this.YS.getUpgradedAddinsOfOmex()}Tza(Ca){this.YS.Tza(Ca)}get name(){return"AddinDetailsCacheManager"}Usb(Ca,yb){this.YS.Usb(Ca,yb)}YF(Ca,yb){this.YS.YF(Ca,void 0===yb?!1:yb)}static r8a(Ca,yb){let wc=null;try{const dd=mb.y8b;if(void 0!==dd&&dd){const vd=
ba.a.jjb(Ca)+"_"+yb;wc=dd.getItem(vd)}else f.ULS.sendTraceTag(508352219,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(dd){f.ULS.sendTraceTag(508352218,220,10,"Failed to get AddinCommands Cache {0} for suffix {1}.",Ca,yb)}return wc}static IPa(Ca,yb,wc){try{const dd=mb.y8b;if(void 0!==dd&&dd){const vd=ba.a.jjb(Ca)+"_"+wc;dd.setItem(vd,yb)}else f.ULS.sendTraceTag(508352217,220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(dd){f.ULS.sendTraceTag(508352216,
220,10,"Failed to set AddinCommands Cache {0} for suffix {1}.",Ca,wc)}}static get y8b(){if(!mb.U$)return null;let Ca=null;try{Ca=localStorage}catch(yb){mb.U$=!1,Ca=null,f.ULS.sendTraceTag(508352215,220,10,`Failed to use localStorage: error name: ${yb.name}; message: ${yb.message}; stack: ${yb.stack}`)}return Ca}}mb.U$=!0;Object(c.a)(mb,"AddinDetailsCacheManager",null,[378]);class Ia{static createInstance(Ca,yb,wc){wc=void 0===wc?null:wc;Ca=Ia.xBh(Ca)?new mb(Ca,new db(Ca,yb,wc)):new ra(Ca,yb,wc);f.ULS.sendTraceTag(508352212,
220,50,`AddinDetailsManagerFactory.CreateInstance: Creating an instance of ${Ca.name}`);return Ca}static xBh(Ca){return(Ca||l.AFrameworkApplication.fa).getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",!1)}}Object(c.a)(Ia,"AddinDetailsManagerFactory",null,[]);var pa=a(1031),lb=a(599),ha=a(1428),ua=a(1534),fb=a(1145),Ka=a(42),La=a(181),ib=a(1430),Yb=a(135),Wc=a(125),Qc=a(180),Wb=a(96),Jc=a(386),ma=a(760),Hc=a(158),Kb=a(353),pc=a(139),$b=a(592),Ib=a(182),Zb=a(38),
Eb=a(1095),ob=a(1366),Na=a(1099),nb=a(80);class Hb{constructor(){this.command=0;this.properties=null}}Object(c.a)(Hb,"DdaRequestInfo",null,[]);var na=a(926),Gb=a(69);class Xa extends nb.a{constructor(Ca,yb){super();this.requests=[];this.disposed=this.goc=!1;this.yl=()=>{if(!this.disposed){this.grid.sh.Zw(this.yl);this.goc=!1;const wc=this.requests;this.requests=[];for(const dd of wc)this.ddaFacade.xU(dd.command,dd.properties)}};this.ddaFacade=Ca;this.grid=yb}W9h(Ca,yb){this.disposed||(this.goc||(this.grid.sh.Wx(this.yl),
this.goc=!0),this.requests.push(Object(b.a)(new Hb,{command:Ca,properties:yb})))}dispose(){if(!this.disposed){this.disposed=!0;this.goc&&this.grid.sh.Zw(this.yl);var Ca=this.requests;this.requests=null;for(const yb of Ca)(Ca=yb.properties?yb.properties[Gb.a.Vea]:null)&&this.ddaFacade.Rn(na.a.eTb,Ca);this.ddaFacade=this.grid=null;super.dispose()}}static RVh(Ca,yb){var wc=!1;974713501===Ca&&(yb=(Ca=yb?yb[Gb.a.Wk]:null)?Ca.DdaMethod:null)&&yb.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&
(wc=Ca.ArrayData,wc=!!wc&&64===(wc[6]&64));return wc}}Object(c.a)(Xa,"DdaCellEditDelayRequestHandler",nb.a,[]);var Jb=a(966);class qb extends Jb.a{constructor(Ca,yb,wc,dd,vd,Zd,Re){super(Ca,yb,wc);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=dd;this.messageContent=vd;this.messageOrigin=Zd;this.targetOrigin=Re}}Object(c.a)(qb,"DialogMessageReceivedEventArgs",Jb.a,[]);class Db extends Jb.a{constructor(Ca,yb,wc,dd,vd,Zd,Re){super(Ca,yb,wc);this.messageType=
0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=dd;this.messageContent=vd;this.messageOrigin=Zd;this.targetOrigin=Re}}Object(c.a)(Db,"DialogParentMessageReceivedEventArgs",Jb.a,[]);var gb=a(1),ya=a(24);class Aa{constructor(Ca){this.wl=this.Rod=null;this.qTj=(yb,wc)=>{this.handlers.Vg(wc.controlId)&&(yb=new qb(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,wc.controlId,null,wc.messageType,wc.messageContent,wc.messageOrigin,wc.targetOrigin),this.handlers.ma(wc.controlId)(yb),
wc.messageType===OSF.DialogMessageType.DialogClosed&&this.handlers.remove(wc.controlId))};this.pTj=(yb,wc)=>{this.YKc.Vg(wc.controlId)&&(yb=new Db(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,wc.controlId,null,wc.messageType,wc.messageContent,wc.messageOrigin,wc.targetOrigin),this.YKc.ma(wc.controlId)(yb))};this.handlers=new Q.a;this.YKc=new Q.a;this.Np=Ca;this.Wgb.Rzh(this.qTj);this.Wgb.Qzh(this.pTj)}get Wgb(){this.Rod||(this.Rod=O.getInstance(this.contextActivationMgr));return this.Rod}get contextActivationMgr(){!this.wl&&
this.Np&&(this.wl=this.Np.wl);return this.wl}addHandler(Ca,yb,wc,dd){f.ULS.sendTraceTag(537170502,0,50,"DialogMessageReceivedEventManager.AddHandler called!");const vd=Zd=>{Zd===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(this.handlers.ga(Ca,yb),this.Np.cE(wc)):(f.ULS.sendTraceTag(537170501,0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),this.Np.Rn(Zd,wc))};this.handlers.Vg(Ca)?vd(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(Ca,dd,vd)}Tuh(Ca,yb,wc){f.ULS.sendTraceTag(537170500,
0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!");this.YKc.ga(Ca,yb);this.Np.cE(wc)}removeHandler(Ca,yb){this.handlers.Vg(Ca)?(f.ULS.sendTraceTag(537170499,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.Wgb.NVa(Ca,wc=>{this.handlers.remove(Ca);wc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?this.Np.cE(yb):(f.ULS.sendTraceTag(537170498,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),this.Np.Rn(wc,yb))})):this.Np.Rn(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
yb)}lhk(Ca,yb){f.ULS.sendTraceTag(537170497,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!");this.YKc.remove(Ca);this.Np.cE(yb)}showDialog(Ca,yb,wc){try{gb.EwaSettings.isChangeGateEnabled("OfficeVSO:6254758_ExitCellEditModeDialogAPI")&&ya.f(this.Np.$).isEditing&&ya.f(this.Np.$).Cz(!0),this.Wgb.showDialog(yb,Ca,wc,dd=>{this.Np.mvh(this.PMh(dd))})}catch(dd){f.ULS.sendTraceTag(537170496,0,10,`DialogMessageReceivedEventManager: show dialog failed. Exception message: ${dd.message}`),wc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}PMh(Ca){const yb=
{};yb.InstanceId=Ca.id;yb.WebExtensionType=Ca.osfControlType===OSF.OsfControlTarget.InContent?0:1;yb.PrimaryMarketplace={};yb.PrimaryMarketplace.SolutionId=Ca.solutionId;yb.PrimaryMarketplace.SolutionVersion=Ca.version;yb.PrimaryMarketplace.MarketplaceRef=Ca.storeId;yb.PrimaryMarketplace.MarketplaceType=Ca.storeType;yb.OwnerAddinSolutionId=Ca.ownerAddinSolutionId;yb.OwnerAddinStoreType=Ca.ownerAddinStoreType;return yb}static Aa(Ca){if(!Ca.$.ka.Ug(232)){const yb=new Aa(Ca);Ca.$.ka.ph(232,yb)}}}Object(c.a)(Aa,
"DialogMessageReceivedEventManager",null,[346]);class sb{constructor(Ca,yb){this.aK=null;this.Lra=Ca;this.fqh=yb}Bkc(Ca){Ca&&(this.aK||(this.aK=[]),this.aK.push(Ca))}NSc(Ca){this.aK&&Array.remove(this.aK,Ca)}get eventId(){return this.Lra}get targetId(){return this.fqh}get Z3i(){return 0<this.aK.length}iCj(Ca){return this.eventId!==Ca.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.targetId===Ca.ddaBinding.Name:
!0}Lnc(Ca){this.aK&&Array.forEach(this.aK,yb=>{yb(Ca)})}BNa(){this.aK=[]}}Object(c.a)(sb,"DdaEventRegistration",null,[]);class nc{constructor(Ca){this.qO=null;this.UJa=!1;this.tj=()=>{this.qO.forEach(yb=>{yb.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&yb.Lnc(new Jb.a(yb.eventId,"",null))})};this.Np=Ca}invokeDdaMethod(Ca,yb){const wc={};wc[Gb.a.Wk]=Ca;wc[Gb.a.Vea]=yb;this.Np.xU(974713501,wc)}registerDdaEventAsync(Ca,yb,wc,dd,vd){nc.dUb(Ca)?(nc.mTd(Ca)&&this.yPd(),this.qO||(this.qO=
[]),yb=this.XNb(Ca,wc),yb||(yb=new sb(Ca,wc),this.qO.push(yb)),yb.Bkc(dd),this.Np.cE(vd)):this.Np.Rn(-1,vd)}unregisterDdaEventAsync(Ca,yb,wc,dd,vd){nc.dUb(Ca)?((Ca=this.XNb(Ca,wc))&&Ca.NSc(dd),this.Np.cE(vd)):this.Np.Rn(-1,vd)}yPd(){this.UJa||(ya.f(this.Np.$).ha.u9(this.tj),this.UJa=!0)}XNb(Ca,yb){if(!this.qO)return null;for(let wc=0;wc<this.qO.length;wc++){const dd=this.qO[wc];if(dd.eventId===Ca&&dd.targetId===yb)return dd}return null}static dUb(Ca){return Ca===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static mTd(Ca){return Ca===
OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}}Object(c.a)(nc,"EmbeddingPage",null,[323]);var Bb=a(229);class uc extends Jb.a{constructor(Ca,yb,wc,dd,vd,Zd,Re,ff){super(Ca,yb,wc);this.columnCount=this.rowCount=this.startColumn=this.startRow=0;this.startColumn=Zd-dd.Reference.FirstColumn;this.columnCount=ff;Ca=Math.max(vd,dd.Reference.FirstRow);vd=Math.min(vd+Re-1,dd.Reference.LastRow);Ca>vd?this.startRow=this.rowCount=void 0:(this.startRow=Ca-dd.Reference.FirstRow,this.rowCount=vd-Ca+1)}getStartRow(){return this.startRow}getStartColumn(){return this.startColumn}getRowCount(){return this.rowCount}getColumnCount(){return this.columnCount}}
Object(c.a)(uc,"DdaBindingSelectionEventArgs",Jb.a,[]);var Pc=a(214),wd=a(26),Md=a(45),Nd=a(480),ec=a(40),gc=a(655),Mb=a(320),sc=a(59),xd=a(86),xb=a(16),Lb=a(13),Rc=a(111),nd=a(93),$d=a(97),Td=a(5),He=a(355),oc=a(212),ld=a(419);a(1091);class id extends Bb.a{constructor(Ca,yb,wc,dd,vd){vd=void 0===vd?!1:vd;super();this.Hub=0;this.qO=null;this.UJa=!1;this.uQc=null;this.s4=0;this.Mrc=this.g$a=this.BGe=this.eEe=null;this.kec=this.eMe=!1;this.Ged=this.Opa=this.hze=null;this.tj=()=>{this.enabled&&(this.Kwk(),
this.uQc=Md.d(ya.f(this.$).ha.qa.selectedRanges))};this.OLf=Zd=>{Zd.controlId===this.uj.InstanceId&&Array.forEach(this.qO,Re=>{Re.iCj(Zd)&&Re.Lnc(Zd)})};this.wdg=Zd=>{Zd=Object(Hc.a)(318,Zd);if(gb.EwaSettings.isChangeGateEnabled("OfficeVSO:8220021_ExcludingMisMatchingPaneAndData")&&null!=(null===Zd||void 0===Zd?void 0:Zd.Gm)&&(null===Zd||void 0===Zd?void 0:Zd.Gm.InstanceId)!==this.uj.InstanceId)f.ULS.sendTraceTag(508302915,220,15,"InstanceIds mismatching for webExtensionPane and webExtensionData.");
else if(Zd&&!Zd.L5())if(!this.uj||OSF.OsfControl.isFirstPartyStoreString(this.uj.PrimaryMarketplace.MarketplaceType)||this.$.C3){Zd.Gm=this.uj;Zd.Ys=this.Np;this.hze=Zd;this.sWc(Zd.EGb);const Re=gb.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&Lb.HelperMethods.BF(this.uj)&&this.uj.Preload&&!this.uj.TaskpaneVisible;Re?Zd.C7d():gb.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?(Zd.C7d(),(this.uj.SharedRuntime&&1===this.uj.SharedRuntime.LifeTime||
this.uj.SharedRuntimeId)&&!this.uj.TaskpaneVisible&&Zd.DE(!1)):((this.uj.SharedRuntime&&1===this.uj.SharedRuntime.LifeTime||this.uj.SharedRuntimeId)&&!this.uj.TaskpaneVisible&&Zd.DE(!1),Zd.C7d());this.Hlb||Re||Zd.hS();this.$.ka.Ug(77).tBg(this.wdg);this.Ska=Object(Hc.a)(344,Zd)}else f.ULS.sendTraceTag(537170464,0,50,"Taskpane web add-in disabled by doc IRM")};this.onFloatingObjectControlAdded=(Zd,Re)=>{3===Re.control.floatingObject.type&&Re.control.floatingObject.Nn.InstanceId===this.Dca.WebExtensionId&&
(this.Ska=Object(Hc.a)(344,Re.control),this.sWc(Re.control.Gj.firstChild),Rc.a(this.$).ESc(this.onFloatingObjectControlAdded))};this.fh=Ca.$;this.webExtensionView=dd;this.Np=Ca;this.uj=wc;this.uj.InstanceId=wc.SrcLocationOverrideResourceId?Ca.pIa(wc.InstanceId,wc.SrcLocationOverrideResourceId):wc.InstanceId;this.yn=yb;this.Dca={};this.Dca.WebExtensionId=wc.InstanceId;this.Xpg="osfControl_"+wc.InstanceId;this.Czd="disabled_"+wc.InstanceId;this.Dca.BindingData=wc.BindingData;this.Hlb=this.Np.Hlb(wc.InstanceId);
this.WDc=this.Np.WDc(wc.InstanceId);this.UQe=wc.WebExtensionOsfControlType;this.Btg=vd}get controlId(){return this.uj.InstanceId}get sXf(){return this.kec}Uaj(Ca){this.Opa||(this.Opa=Ca)}bBg(){this.Opa&&(this.Opa.dispose(),this.Opa=null)}get controlType(){return this.uj.WebExtensionType}get ownerAddinSolutionId(){return this.uj.OwnerAddinSolutionId}get $(){return this.fh}get enabled(){return!this.s4}get visible(){return this.uj.TaskpaneVisible}get TF(){return this.Ged}get lX(){return this.uj.SrcLocationOverrideResourceId?
this.Np.pIa(this.uj.PrimaryMarketplace.SolutionId,this.uj.SrcLocationOverrideResourceId):this.uj.PrimaryMarketplace.SolutionId}get sourceLocationOverrideResourceId(){return this.uj.SrcLocationOverrideResourceId}get Nn(){return this.uj}get Ska(){return this.eEe}set Ska(Ca){this.eEe=Ca}get osfControlType(){return this.UQe}get UGa(){return this.BGe}set UGa(Ca){this.BGe=Ca}get Lrc(){return this.g$a}set Lrc(Ca){this.g$a=Ca}get focusOnIframeWhenLoaded(){return this.uj.FocusOnIframeWhenLoaded}get wGc(){return this.eMe}set wGc(Ca){this.eMe=
Ca}NQd(){if(!OSF.OsfControl.isFirstPartyStoreString(this.uj.PrimaryMarketplace.MarketplaceType)&&gb.EwaSettings.Ra(174)){const yb=Object(nd.d)($d.a.resolve(Td.C,{va:0}));ec.TaskExtensions.Ua(yb,()=>{yb.result.xm(36,null)},this.xa,3);return this}if(1===this.uj.WebExtensionType)ec.TaskExtensions.Ua(Nd.a(this.$),yb=>{yb.result.Nqc(this.$.ka,77,5,this.wdg,1)},this.xa,3);else{var Ca=this.Kwf();const yb=Rc.a(this.$);Ca||(Ca={Type:3},Ca.Id=this.Dca.WebExtensionId,Ca.WebExtensionData=this.uj,Ca.ContentHtml=
"<div/>",Ca.Version=0,Ca.AbsoluteLeft=0,Ca.AbsoluteTop=0,Ca.AbsoluteRight=0,Ca.AbsoluteBottom=0,Ca.Width=0,Ca.Height=0,Ca.ZOrder=0,Ca.OriginDeltaX=0,Ca.OriginDeltaY=0,Ca=new Pc.a(Ca),yb.zqc(Ca,null),Ca=yb.ky(Ca.an()));Ca?(this.sWc(Ca.Gj.firstChild),this.Ska=Object(Hc.a)(344,Ca)):yb.rkc(this.onFloatingObjectControlAdded)}return this}nRf(Ca){this.sWc(Ca);return this}CMc(){this.Btg||this.Np.wl.purgeOsfControl(this.controlId,!1);if(gb.EwaSettings.isChangeGateEnabled("OfficeVSO:8490416_SkipCloseAgaveCallInViewMode")&&
this.$.isEditMode||!gb.EwaSettings.isChangeGateEnabled("OfficeVSO:8490416_SkipCloseAgaveCallInViewMode")){const yb=this.$.pa.ta.Jh();ld.a(this.$.userOperationManager,(wc,dd,vd)=>He.e(this.$.pa.ta,this.uj.InstanceId,wc,dd,vd,yb),wc=>new oc.a(606,0,wc,64),null)}this.y0g(!0);const Ca=this.Kwf();Ca&&Rc.a(this.$).deleteFloatingObject(Ca);this.Np.un.Rgk(this.controlId);this.Np.un.vpf(this.controlId,!0);this.Ged=null}O7d(Ca){this.Dca=Ca}invokeDdaMethod(Ca,yb){if(gb.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||
this.enabled){var wc={};wc[Gb.a.Wk]=Ca;wc[Gb.a.Vea]=yb;this.Np.xU(974713501,wc)}else this.Np.Rn(na.a.eTb,yb)}Zdk(Ca,yb,wc,dd){if(gb.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled)if(!id.Gdi(Ca)||void 0!==yb&&null!==yb&&void 0!==this.tib(yb)&&null!==this.tib(yb))if(f.ULS.sendTraceTag(36444195,0,50,`eventId: ${Ca}, targetId: ${yb}`),id.gVf(Ca)&&this.i6i(),id.mTd(Ca)&&this.yPd(),id.eVf(Ca))this.kec=!0,this.Np.$.ka.Ug(232).addHandler(this.controlId,wc,dd,yb);else if(id.fVf(Ca))this.kec=
!0,this.Np.$.ka.Ug(232).Tuh(this.controlId,wc,dd);else{id.dVf(Ca)&&this.QLf(-1777565636,dd);this.qO||(this.qO=[]);var vd=this.XNb(Ca,yb);vd||(vd=new sb(Ca,yb),this.qO.push(vd));vd.BNa();vd.Bkc(wc);this.Np.cE(dd);Ca===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.g$a&&(this.Mrc=wc)}else this.Np.Rn(3002,dd);else this.Np.Rn(-1,dd)}J1k(Ca,yb,wc,dd){id.eVf(Ca)?(this.Np.$.ka.Ug(232).removeHandler(this.controlId,dd),gb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InlineDialogReset",!1)&&
(this.kec=!1)):id.fVf(Ca)?this.Np.$.ka.Ug(232).lhk(this.controlId,dd):(id.dVf(Ca)&&this.QLf(1592314317,dd),yb=this.XNb(Ca,yb),this.enabled?(yb&&(yb.NSc(wc),yb.Z3i||Array.remove(this.qO,yb),this.qO.length?id.gVf(Ca)&&this.z0g(!1):this.y0g(!1)),this.Np.cE(dd)):this.Np.Rn(-1,dd))}Aa(Ca){xb.DOMElementExtensions.getElementById(Ca,this.Xpg)||Ca.appendChild(xb.DOMElementExtensions.Km(this.TF))}showHide(Ca){xb.DOMElementExtensions.setVisible(this.TF,Ca)}resize(Ca,yb){xb.DOMElementExtensions.SH(this.TF,Ca);
xb.DOMElementExtensions.cW(this.TF,yb)}Wlf(Ca){if(!this.s4&&!xb.DOMElementExtensions.getElementById(this.TF,this.Czd)&&this.TF){const yb=document.createElement("div");yb.id=this.Czd;yb.className="ewa-wx-disabled-div";yb.style.backgroundImage="url("+sc.a.current.uu(102)+")";yb.style.opacity=Ca?"1":"0";yb.style.backgroundRepeat="no-repeat";yb.style.backgroundPosition="center";this.TF.insertBefore(yb,this.TF.firstChild)}this.s4++}Mgi(){0<this.s4&&this.s4--;this.s4||(xb.DOMElementExtensions.Km(xb.DOMElementExtensions.getElementById(this.TF,
this.Czd)),this.UJa&&!Md.W(this.uQc,ya.f(this.$).ha.qa.selectedRanges)&&this.tj(null,null))}tib(Ca){if(!this.Dca||!this.Dca.BindingData)return null;for(let yb=0;yb<this.Dca.BindingData.length;yb++)if(this.Dca.BindingData[yb].Name===Ca)return this.Dca.BindingData[yb];return null}getDefaultIconUrl(){const Ca=this.WGf();return Ca?Ca.getDefaultIconUrl():null}getDefaultDisplayName(){if(this.uj.TaskpaneTitle)return this.uj.TaskpaneTitle;const Ca=this.WGf();return Ca?Ca.getDefaultDisplayName():null}Jug(){if(this.g$a&&
this.Mrc){const Ca=new Jb.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,null,this.g$a);this.Mrc(Ca);this.Mrc=this.g$a=null}}DE(Ca){this.hze&&this.hze.DE(Ca)}Xyk(){this.$.ea.isNamedObjectViewMode&&this.Vmj()&&(Td.Fg.Ha()?this.webExtensionView.eLg(this.TF):Na.a(this.$).eLg(this.TF),this.showHide(!1));if(this.Np.Fal){if(!this.Btg){const Ca={};Ca.div=this.TF;Ca.id=this.uj.InstanceId;Ca.solutionId=this.uj.PrimaryMarketplace.SolutionId;Ca.version=this.uj.PrimaryMarketplace.SolutionVersion;
Ca.storeId=this.uj.PrimaryMarketplace.MarketplaceRef;Ca.storeType=this.uj.PrimaryMarketplace.MarketplaceType;Ca.ownerAddinSolutionId=this.uj.OwnerAddinSolutionId;Ca.ownerAddinStoreType=this.uj.OwnerAddinStoreType;this.uj.AssetMarketplace?(Ca.assetId=this.uj.AssetMarketplace.SolutionId,Ca.assetStoreId=this.uj.AssetMarketplace.MarketplaceRef):(Ca.assetId=null,Ca.assetStoreId=null);Ca.settings=this.uj.OsfPropertyBag;Ca.hostSettings=this.uj.HostPropertyBag;gb.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?
Ca.reason=this.Hlb?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.WDc?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.ControlActivation:Ca.reason=this.Hlb?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:Microsoft.Office.WebExtension.InitializationReason.Inserted;Ca.osfControlType=0===this.uj.WebExtensionType?OSF.OsfControlTarget.InContent:OSF.OsfControlTarget.TaskPane;Ca.isForUILessAction=4===
this.uj.WebExtensionOsfControlType;Ca.sourceLocationOverrideResourceId=this.uj.SrcLocationOverrideResourceId;Ca.focusOnIframeWhenLoaded=this.uj.FocusOnIframeWhenLoaded;gc.a(this.uj)&&(Ca.featureGates=l.AFrameworkApplication.fa.RDf(Ca.solutionId));Ca.hostInfoFlags=0;this.UGa&&(Ca.hostInfoFlags|=2);Lb.HelperMethods.BF(this.uj)&&(Ca.hostInfoFlags|=1);this.$.C3||(f.ULS.sendTraceTag(537170466,0,50,"Content web add-in disabled by doc IRM"),Ca.hostInfoFlags|=4);gb.EwaSettings.Ra(553)&&(Ca.hostInfoFlags|=
8);Ca.sharedRuntimeId=this.uj.SharedRuntime?this.uj.SharedRuntime.Resid:this.uj.SharedRuntimeId;!Lb.HelperMethods.BF(this.uj)||this.uj.Preload||gc.a(this.uj)||this.Np.wl.getOsfControl(a(922).DdaFacade.getSolutionId(this.uj,this.$))||(gb.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?this.$.isEditMode&&this.Np.Jog(this.uj):this.Np.Jog(this.uj));Ca.onExtensionLaunchCallback=this.uj.OnExtensionLaunchCallback;Ca.initialDisplayMode=this.uj.TaskpaneVisible?2:1;gb.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")&&
(Ca.titleOverride=this.Nn.TaskpaneTitle);this.Np.wl.insertOsfControl(Ca)}this.s4=0}else this.Wlf(!0)}y0g(Ca){this.z0g(Ca);this.q1k()}i6i(){this.Hub||this.yn.Bkc(this.OLf);this.Hub++}z0g(Ca){0<this.Hub&&(Ca?this.Hub=0:this.Hub--,this.Hub||this.yn.NSc(this.OLf))}yPd(){if(!this.UJa){const Ca=ya.f(this.$).ha;this.uQc=Md.d(ya.f(this.$).ha.qa.selectedRanges);Ca.u9(this.tj);this.UJa=!0}}q1k(){this.UJa&&(ya.f(this.$).ha.Fba(this.tj),this.UJa=!1)}Avk(Ca){var yb=new wd.Range(Ca.Reference.FirstRow+1,Ca.Reference.FirstColumn+
1,Ca.Reference.LastRow+1,Ca.Reference.LastColumn+1,!1,!1);1===Ca.BindingType&&(Ca.HasHeaders&&--yb.top,Ca.HasTotals&&(yb.bottom+=1));var wc=ya.f(this.$).ha.qa.selectedRanges;Ca=yb.zlb(this.uQc);wc=yb.zlb(wc);return(yb=yb.pk(ya.f(this.$).ha.qa.activeRange))&&(Mb.a(Ca)&&!Mb.a(wc)||!Mb.a(Ca)&&!Mb.a(wc)&&!Md.W(Ca,wc))?yb:null}Kwk(){Array.forEach(this.qO,Ca=>{if(Ca.eventId!==OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Ca.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||this.Np.un.Wlc(this.controlId))if(Ca.eventId===
OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)Ca.Lnc(new Jb.a(Ca.eventId,this.controlId,null));else if(Ca.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){const yb=this.tib(Ca.targetId);if((null===yb||void 0===yb?0:yb.IsValidRef)&&(this.$.ea.isNamedObjectViewMode?this.$.Gh.na.sheetName:this.$.sa.na.name)===yb.Reference.SheetName){const wc=this.Avk(yb);wc&&Ca.Lnc(new uc(Ca.eventId,this.controlId,this.Np.Fmc(yb),yb,wc.top-1,wc.left-1,wc.height,wc.width))}}})}XNb(Ca,yb){if(!this.qO)return null;
for(let wc=0;wc<this.qO.length;wc++){const dd=this.qO[wc];if(dd.eventId===Ca&&dd.targetId===yb)return dd}return null}Kwf(){const Ca=Rc.a(this.$).S4;for(let yb=Ca.length-1;0<=yb;--yb){const wc=Ca[yb];if(3===wc.floatingObject.type&&wc.floatingObject.Nn.InstanceId===this.Dca.WebExtensionId)return wc}return null}Vmj(){for(let Ca=0;Ca<this.$.Gh.count;Ca++)if(this.$.Gh.getItem(Ca).imageId===this.Dca.WebExtensionId)return!0;return!1}sWc(Ca){this.Ged=Ca;this.TF.id=this.Xpg;this.TF.className="ewa-wx-container-div";
this.TF.dir=this.$.isChromeRtl?"rtl":"ltr";this.Xyk()}WGf(){if(!this.enabled)return null;const Ca=gc.a(this.Nn)?"":this.Nn.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.Nn.PrimaryMarketplace.SolutionId,Ca)}QLf(Ca,yb){try{if(f.ULS.sendTraceTag(537170462,0,50,"HandleDialogNotificationShownInAddinEvent called!"),4!==this.UQe)this.Np.Rn(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,yb);else{const wc={};wc[ba.a.zGb]=this.controlId;const dd=new xd.a(Ca,
0,this.$.isEditMode?2:1,0,null);this.$.Ma.dh(dd,wc);this.Np.cE(yb)}}catch(wc){f.ULS.sendTraceTag(537170461,0,10,`HandleDialogNotificationShownInAddinEvent called. Error message: ${wc.message}.`),this.Np.Rn(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,yb)}}static Gdi(Ca){return Ca===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Ca===OSF.DDA.EventDispId.dispidBindingDataChangedEvent}static gVf(Ca){return Ca===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||Ca===OSF.DDA.EventDispId.dispidSettingsChangedEvent||
Ca===OSF.DDA.EventDispId.dispidRichApiMessageEvent}static mTd(Ca){return Ca===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Ca===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static eVf(Ca){return Ca===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent}static fVf(Ca){return Ca===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static dVf(Ca){return Ca===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent}}Object(c.a)(id,"OsfControl",Bb.a,[345]);class fc{constructor(){this.bdb=
{}}add(Ca){this.bdb[Ca]=!0}remove(Ca){delete this.bdb[Ca]}clear(){for(const Ca of Object.keys(this.bdb))delete this.bdb[Ca]}mNf(){return 0<Object.keys(this.bdb).length}TBi(){return Object.keys(this.bdb)}}Object(c.a)(fc,"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,[]);var vc=a(65);class Tc{constructor(Ca,yb,wc){this.Izg=this.Hzg=0;this.f6b=this.isb=null;this.oLj=()=>{var dd=ya.f(this.$).ha.$e.YJ;if(this.LSd(dd)&&(dd=this.pPb(dd))){var vd={};vd.chartId=dd;vd.worksheetId=this.jwa();
vd=vc.a.li(vd);this.Lva(51,dd,vd);this.Lva(51,this.jwa(),vd)}};this.pLj=()=>{if(this.isb){var dd={};dd.chartId=this.isb;dd.worksheetId=this.f6b;dd=vc.a.li(dd);this.Lva(52,this.isb,dd);this.Lva(52,this.f6b,dd)}dd=ya.f(this.$).ha.$e.YJ;this.LSd(dd)?(this.isb=this.pPb(dd),this.f6b=this.jwa()):this.f6b=this.isb=null};this.$=Ca;this.un=yb;this.yn=wc}xHb(Ca){51===Ca.messageType?this.Hzg=this.MUa(Ca.actionType,this.Hzg,this.oLj):52===Ca.messageType&&(this.Izg=this.MUa(Ca.actionType,this.Izg,this.pLj))}MUa(Ca,
yb,wc){if(1===Ca)yb||ya.f(this.$).ha.$e.Amd(wc),yb++,this.eDk();else if(2===Ca){if(1>yb)return yb;1===yb&&ya.f(this.$).ha.$e.$fe(wc);yb--}return yb}Lva(Ca,yb,wc){yb&&this.un.yR(Ca,yb)&&this.yn.iM(Ca,yb,wc)}pPb(Ca){return Ca&&Ca.floatingObject?(Ca=Ca.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&1===Ca.length?Ca[0]:null:null}jwa(){const Ca=this.$.sa.na;return Ca&&0===Ca.iG?Ca.sheetId:null}eDk(){const Ca=ya.f(this.$).ha.$e.YJ;this.LSd(Ca)&&(this.isb=this.pPb(Ca),this.f6b=
this.jwa())}LSd(Ca){return!!Ca&&!!Ca.floatingObject&&0===Ca.floatingObject.type}}Object(c.a)(Tc,"RichApiEventChartActivatedDeactivatedHandler",null,[]);var Bd=a(927),Fd=a(199),le=a(719),dc=a(117),Uc=a(66);class kb extends nb.a{constructor(Ca,yb,wc){super();this.s4=this.ANa=0;this.tj=(dd,vd)=>{if(this.enabled&&!(this.BXf()||null!==vd&&void 0!==vd&&vd.h0f)&&(dd=Object(Hc.a)(dc.a,this.$.sa.na))&&0===dd.iG){const Zd=dd.sheetId,Re=this.OCf();let ff=null,af=null;this.un.Y_f()&&(ff=this.grid.Yg.sl(this.grid.ha.qa.activeCell),
af=Zd in this.yIc?this.yIc[Zd]:null);this.k5e(Zd,Re)&&ec.TaskExtensions.Ua(Uc.Task.Va(!0),()=>{this.w3i(Zd,Re);this.f3i(Zd,Re,ff,af)},this.xa);this.cnf(Zd,Re,ff)}};this.$=Ca;this.un=yb;this.yn=wc;this.grid=ya.f(Ca);this.C1a={};this.yIc={}}get enabled(){return!this.s4&&0<this.ANa}qmc(Ca){1===Ca.actionType?(this.ANa||this.grid.ha.u9(this.tj),this.ANa++):2!==Ca.actionType||1>this.ANa||(1===this.ANa&&this.grid.ha.Fba(this.tj),this.ANa--)}cWc(Ca){Ca?this.s4++:(0<this.s4&&this.s4--,this.s4||this.tj(null,
new le.a(!1)))}OCf(){return this.grid.ha.qa.selectedRanges}k5e(Ca,yb){return gb.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?(!!Ca&&Fd.e(this.C1a)||Ca in this.C1a)&&!Md.W(this.C1a[Ca],yb):Ca in this.C1a&&!Md.W(this.C1a[Ca],yb)}cnf(Ca,yb,wc){this.C1a[Ca]=Md.d(yb);this.yIc[Ca]=wc}BXf(){return this.grid.isEditing||this.grid.Pp}exf(Ca,yb){this.un.yR(14,Ca)&&this.yn.iM(14,Ca,yb);this.un.yR(14,Bd.a.zV)&&this.yn.iM(14,Bd.a.zV,yb)}w3i(Ca,yb){const wc=
{};wc.worksheetId=Ca;wc.address=this.tLd(yb);yb=vc.a.li(wc);this.exf(Ca,yb)}f3i(Ca,yb,wc,dd){if(this.un.Y_f()){var vd="";let Zd="";dd&&(vd=dd.Hq);wc&&(Zd=wc.Hq);dd?wc?(yb=wc.usedRange.zlb(yb),vd!==Zd&&this.xwc(vd,"",Ca),this.xwc(Zd,this.tLd(yb),Ca)):this.xwc(vd,"",Ca):wc&&(vd=wc.usedRange.zlb(yb),this.xwc(Zd,this.tLd(vd),Ca))}}xwc(Ca,yb,wc){if(this.un.yR(100,Ca)){const dd={};dd.address=yb;dd.worksheetId=wc;this.yn.iM(100,Ca,vc.a.li(dd))}}tLd(Ca){return Md.j(Ca,",",this.$,!1)}dispose(){0<this.ANa&&
this.grid.ha.Fba(this.tj);this.yIc=this.C1a=null;this.ANa=0;this.yn=this.un=this.$=this.grid=null}}Object(c.a)(kb,"RichApiEventSelectionChangedHandler",nb.a,[]);var rb=a(387);class cc extends kb{constructor(Ca,yb,wc){super(Ca,yb,wc);this.p2f=this.q2f=null}OCf(){return rb.a.Xqc(this.grid.ha.rangePicker.NY)}k5e(Ca,yb){return this.q2f!==Ca||!Md.W(this.p2f,yb)}cnf(Ca,yb){this.q2f=Ca;this.p2f=Md.d(yb)}BXf(){return!this.grid.isEditing&&!this.grid.Pp}exf(Ca,yb){this.un.yR(2700,Bd.a.zV)&&this.yn.iM(2700,
Bd.a.zV,yb)}}Object(c.a)(cc,"RichApiEventPickedRangesChangedHandler",kb,[]);class mc{constructor(Ca,yb,wc){this.Y4a=this.X4a=0;this.qVa=this.gua=null;this.dhg=()=>{var dd=ya.f(this.$).ha.$e.YJ;if(0<this.Y4a&&this.gua&&this.qVa){var vd={};vd.shapeId=this.gua;vd.worksheetId=this.qVa;vd=vc.a.li(vd);this.fireEvent(2102,this.gua,vd)}this.Noj(dd)?(this.gua=this.P_k(dd),this.qVa=this.jwa(),this.gua&&this.qVa)?0<this.X4a&&(dd={},dd.shapeId=this.gua,dd.worksheetId=this.qVa,dd=vc.a.li(dd),this.fireEvent(2101,
this.gua,dd)):f.ULS.sendTraceTag(537170458,344,10,`Something goes wrong, we got invalid shape id: '${this.gua}', or worksheet id: '${this.qVa}' from a Floating object or gridview.`):this.qVa=this.gua=null};this.$=Ca;this.un=yb;this.yn=wc}xHb(Ca){const yb=ya.f(this.$).ha;1===Ca.actionType?(this.X4a||this.Y4a||yb.$e.Amd(this.dhg),2101===Ca.messageType?this.X4a++:2102===Ca.messageType&&this.Y4a++):2===Ca.actionType&&(2101===Ca.messageType?this.X4a=0<this.X4a?this.X4a-1:0:2102===Ca.messageType&&(this.Y4a=
0<this.Y4a?this.Y4a-1:0),this.X4a||this.Y4a||yb.$e.$fe(this.dhg))}Noj(Ca){return!!Ca&&!!Ca.floatingObject&&(0===Ca.floatingObject.type||7===Ca.floatingObject.type||1===Ca.floatingObject.type||3===Ca.floatingObject.type||5===Ca.floatingObject.type)}P_k(Ca){if(!Ca||!Ca.floatingObject)return null;Ca=Ca.floatingObject.id;var yb=Ca.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));yb=yb&&1===yb.length?yb[0]:null;return yb?yb:(f.ULS.sendTraceTag(537170457,344,10,`Expect get the guid like shape id from the floating object id: '${Ca}', but we failed.`),
null)}jwa(){const Ca=this.$.sa.na;return Ca&&0===Ca.iG?Ca.sheetId:null}fireEvent(Ca,yb,wc){yb&&this.un.yR(Ca,yb)&&this.yn.iM(Ca,yb,wc)}}Object(c.a)(mc,"RichApiEventShapeActivatedDeactivatedHandler",null,[]);class Sa{constructor(Ca,yb,wc){this.Mzg=this.Lzg=this.Nzg=this.Kzg=0;this.lZj=(dd,vd)=>{dd=Object(Hc.a)(dc.a,vd.na);this.Cnb(dd)&&(vd={},vd.worksheetId=dd.sheetId,vd=vc.a.li(vd),this.Lva(11,dd.sheetId,vd))};this.oZj=(dd,vd)=>{dd=Object(Hc.a)(dc.a,vd.mB);this.Cnb(dd)&&(vd={},vd.worksheetId=dd.sheetId,
vd=vc.a.li(vd),this.Lva(12,dd.sheetId,vd))};this.mZj=(dd,vd)=>{dd=Object(Hc.a)(dc.a,vd.na);this.Cnb(dd)&&(vd={},vd.worksheetId=dd.sheetId,dd=vc.a.li(vd),this.Lva(11,null,dd,!0))};this.nZj=(dd,vd)=>{dd=Object(Hc.a)(dc.a,vd.mB);this.Cnb(dd)&&(vd={},vd.worksheetId=dd.sheetId,dd=vc.a.li(vd),this.Lva(12,null,dd,!0))};this.$=Ca;this.un=yb;this.yn=wc}xHb(Ca){11===Ca.messageType?Ca.targetId===Bd.a.zV?this.FGh(Ca.actionType):this.EGh(Ca.actionType):12===Ca.messageType&&(Ca.targetId===Bd.a.zV?this.GGh(Ca.actionType):
this.HGh(Ca.actionType))}EGh(Ca){this.Kzg=this.MUa(Ca,this.Kzg,this.lZj)}HGh(Ca){this.Nzg=this.MUa(Ca,this.Nzg,this.oZj)}FGh(Ca){this.Lzg=this.MUa(Ca,this.Lzg,this.mZj)}GGh(Ca){this.Mzg=this.MUa(Ca,this.Mzg,this.nZj)}MUa(Ca,yb,wc){1===Ca?yb=this.LUa(yb,wc):2===Ca&&(yb=this.ZWa(yb,wc));return yb}LUa(Ca,yb){Ca||this.$.sa.Qm(yb);Ca++;return Ca}ZWa(Ca,yb){if(1>Ca)return Ca;1===Ca&&this.$.sa.hn(yb);Ca--;return Ca}Cnb(Ca){return!!Ca&&0===Ca.iG}Lva(Ca,yb,wc,dd){yb=(void 0===dd?0:dd)?Bd.a.zV:yb;this.un.yR(Ca,
yb)&&this.yn.iM(Ca,yb,wc)}}Object(c.a)(Sa,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var pb=a(302),Ac=a(17),yd=a(286);class vb extends Sys.EventArgs{constructor(Ca,yb,wc,dd){super();this.sheet=Ca;this.SQh=yb;this.offsetX=wc;this.offsetY=dd}}Object(c.a)(vb,"ClickInActiveCellEventArgs",Sys.EventArgs,[]);class Sc{constructor(Ca,yb,wc){this.Zoc=null;this.EXd=!1;this.onPointerDown=dd=>{if(3===dd.oh){const {ofb:vd}=this.da.Pxc(dd.clientPoint);this.EXd=!!vd&&this.da.ha.qa.onf(vd)}else this.EXd=
!1;this.Zoc=dd.clientPoint;return!1};this.fj=dd=>{if(this.da.inRangePicker||this.da.Pp||this.EXd||dd.shiftKey||dd.ctrlKey||dd.La.button!==Sys.UI.MouseButton.leftButton||!this.Zoc||!dd.clientPoint||dd.clientPoint.x!==this.Zoc.x||dd.clientPoint.y!==this.Zoc.y)return!1;let vd;var Zd=(()=>{let ff=this.da.Pxc(dd.clientPoint);({ofb:vd}=ff);return ff})().returnValue;const Re=Object(Hc.a)(dc.a,this.$.sa.na);if(Zd&&Re&&0===Re.iG){if(!this.da.ha.qa.E$.contains(vd))return!1;Zd=new vb(Re,vd,Lb.HelperMethods.NPc(Zd.x),
Lb.HelperMethods.NPc(Zd.y));this.pZj(Zd)}return!1};this.$=Ca;this.da=ya.f(Ca);this.un=yb;this.yn=wc;this.Dfk()}dispose(){this.d2k()}Dfk(){for(const Ca of this.da.yu){const yb=Ca.domElement;pb.a.instance.ya(Ac.a.Zi,yb,this.onPointerDown);yd.a.instance.ya(Ac.a.click,yb,this.fj)}}d2k(){for(const Ca of this.da.yu){const yb=Ca.domElement;pb.a.instance.Na(Ac.a.Zi,yb,this.onPointerDown);yd.a.instance.Na(Ac.a.click,yb,this.fj)}}pZj(Ca){var yb=Ca.sheet;if(this.Cnb(yb)){var wc={};wc.worksheetId=yb.sheetId;
wc.address=Ca.SQh.toString();wc.offsetX=Ca.offsetX;wc.offsetY=Ca.offsetY;Ca=yb.sheetId;this.un.yR(21,Ca)&&(yb=vc.a.li(wc),this.yn.iM(21,Ca,yb));Ca=Bd.a.zV;this.un.yR(21,Ca)&&(wc=vc.a.li(wc),this.yn.iM(21,Ca,wc))}}Cnb(Ca){return!!Ca&&0===Ca.iG}}Object(c.a)(Sc,"RichApiEventSingleClickedHandler",null,[]);class hd{constructor(Ca,yb,wc){this.A2b=0;this.Vrb=this.fsb=null;this.cpg=()=>{const dd=ya.f(this.$).ha.$e.YJ;if(dd)if(this.V0f(dd)){const vd=this.jwa();this.UEd(vd);this.fsb=dd.floatingObject.id;this.Vrb=
vd}else this.fsb&&(this.UEd(this.Vrb),this.Vrb=this.fsb=null);else this.fsb&&(this.UEd(this.Vrb),this.Vrb=this.fsb=null)};this.$=Ca;this.un=yb;this.yn=wc}qmc(Ca){2E3===Ca.messageType&&(1===Ca.actionType?(this.A2b||ya.f(this.$).ha.$e.Amd(this.cpg),this.A2b++,this.ezk()):2===Ca.actionType&&this.A2b&&(1===this.A2b&&ya.f(this.$).ha.$e.$fe(this.cpg),this.A2b--))}UEd(Ca){var yb;const wc={};wc.worksheetId=Ca;wc.revisionLoad=!1;if(gb.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")){const dd=
ya.f(this.$).ha.$e.YJ;(null===(yb=null===dd||void 0===dd?void 0:dd.floatingObject)||void 0===yb?0:yb.Ki)?wc.selectedVisualId=dd.floatingObject.Ki.VisualID:wc.selectedVisualId=null}yb=vc.a.li(wc);Ca&&this.un.yR(2E3,Ca)&&this.yn.iM(2E3,Ca,yb)}jwa(){const Ca=this.$.sa.na;return Ca&&0===Ca.iG?Ca.sheetId:null}ezk(){const Ca=ya.f(this.$).ha.$e.YJ;this.V0f(Ca)&&(this.fsb=Ca.floatingObject.id,this.Vrb=this.jwa())}V0f(Ca){return!!Ca&&Ca.nYd()}}Object(c.a)(hd,"RichApiEventVisualSelectionChangedHandler",null,
[]);class qc{constructor(Ca,yb,wc){this.B2b=0;this.d7g=!0;this.Lwc=0;this.rWd=!0;this.ebf=()=>{const dd=document.hasFocus();if(this.d7g!==dd){if(dd){const vd=vc.a.li({});this.yn.iM(2203,Bd.a.zV,vd)}this.d7g=dd}};this.fbf=dd=>{(0<dd.timeRemaining()||dd.didTimeout)&&this.ebf();window.requestIdleCallback(this.fbf)};this.$=Ca;this.un=yb;this.yn=wc;window.requestIdleCallback||(this.rWd=!1)}DGh(Ca){1===Ca.actionType?(this.B2b||this.SGh(),this.B2b++):2!==Ca.actionType||1>this.B2b||(1===this.B2b&&this.mai(),
this.B2b--)}SGh(){if(this.un.yR(2203,Bd.a.zV))if(this.rWd){const Ca={};Ca.timeout=this.$.ua.CheckFocusTimeout;this.Lwc=window.requestIdleCallback(this.fbf,Ca)}else this.Lwc=window.setInterval(this.ebf,this.$.ua.CheckFocusTimeInterval)}mai(){this.rWd?window.cancelIdleCallback(this.Lwc):window.clearInterval(this.Lwc)}}Object(c.a)(qc,"RichApiEventWorkbookActivatedHandler",null,[]);var Lc;(function(Ca){Ca[Ca.none=0]="none";Ca[Ca.registerEvent=1]="registerEvent";Ca[Ca.unregisterEvent=2]="unregisterEvent";
Ca[Ca.customFunction=3]="customFunction";Ca[Ca.showCard=4]="showCard";Ca[Ca.createWorkbook=5]="createWorkbook";Ca[Ca.openWorkbook=6]="openWorkbook";Ca[Ca.enableEvents=7]="enableEvents";Ca[Ca.closeWorkbook=8]="closeWorkbook";Ca[Ca.setCalculationMode=9]="setCalculationMode";Ca[Ca.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";Ca[Ca.workbookLinksRequestRefreshAll=11]="workbookLinksRequestRefreshAll";Ca[Ca.workbookLinksEnableContent=12]="workbookLinksEnableContent";Ca[Ca.workbookLinksFindNextLink=
13]="workbookLinksFindNextLink";Ca[Ca.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";Ca[Ca.rangePicker=15]="rangePicker";Ca[Ca.enableRichApiRecording=16]="enableRichApiRecording";Ca[Ca.recordAction=17]="recordAction";Ca[Ca.focus=18]="focus";Ca[Ca.businessBarShow=19]="businessBarShow";Ca[Ca.businessBarHide=20]="businessBarHide";Ca[Ca.augmentationLoopActivateAnnotation=21]="augmentationLoopActivateAnnotation";Ca[Ca.augmentationLoopSubmitSignal=22]="augmentationLoopSubmitSignal";Ca[Ca.showRangeValuesPreview=
23]="showRangeValuesPreview";Ca[Ca.hideRangeValuesPreview=24]="hideRangeValuesPreview"})(Lc||(Lc={}));Object(c.b)("PostProcessActionType",Lc);var bd=a(283);class jd{constructor(Ca,yb,wc,dd){this.Ypg=null;this.SEd=(vd,Zd)=>{const Re=Bd.a.zV,ff={};ff.eventId=vd;ff.payload=Zd;this.un.yR(2201,Re)&&this.yn.iM(2201,Re,vc.a.li(ff))};this.$=Ca;this.un=yb;this.yn=wc;this.ddaFacade=dd;this.paj()}CGh(Ca){1===Ca.actionType?(this.$.Bga=!0,(Td.vb.Ha()?this.ddaFacade:Object(Hc.a)(a(922).DdaFacade,bd.a(this.$))).TEd(!0)):
2===Ca.actionType&&(this.$.Bga=!1);this.Ypg=Ca.controlId;f.ULS.sendTraceTag(537170456,0,50,`AttachOrDetachMacroRecorderEventHandler: actionType: ${Lc[Ca.actionType]}; controlId: ${this.Ypg}; this.ewaControl.IsMacroRecorderListening: ${this.$.Bga}.`)}mii(Ca){(Td.vb.Ha()?this.ddaFacade:Object(Hc.a)(a(922).DdaFacade,bd.a(this.$))).gxf(Ca,this.$.Bga)}paj(){this.$.R5&&ec.TaskExtensions.Ua(Object(nd.d)($d.a.resolve(Td.Jd,{va:1})),Ca=>{(Ca=Ca.result)&&Ca.init(this.SEd)},this.$.xa,3)}}Object(c.a)(jd,"RichApiMacroRecorderEventHandler",
null,[]);class Yd{}Object(c.a)(Yd,"StyleCacheItem",null,[]);class te{constructor(Ca,yb,wc){this.$=Ca;this.da=yb;this.ek=wc}Uta(Ca){this.range=Ca;this.spc=Array(Ca.width);this.hZc=Array.from({length:Ca.height},()=>Array(Ca.width))}Myk(Ca,yb,wc,dd){this.YZf(Ca,yb)&&(this.hZc[Ca-this.range.top][yb-this.range.left]||(this.hZc[Ca-this.range.top][yb-this.range.left]={backgroundColor:wc.backgroundColor}),wc.backgroundColor=dd)}Oyk(Ca,yb,wc){if(this.YZf(Ca,yb)){Ca=wd.Range.gi(Ca,yb);var dd=this.da.kh(Ca);
dd&&(this.spc[yb-this.range.left]||(this.spc[yb-this.range.left]=dd.width),yb=this.ek.jqe(this.da,[Ca],wc,!1),"Success"!==yb.kind&&f.ULS.sendTraceTag(508303323,0,10,`InstantaneousGridContentRestorer.setColumnWidth: failed to set column width - ${yb.reason}.`))}}restore(){this.range&&(this.spc.forEach((Ca,yb)=>{Ca=this.ek.jqe(this.da,[wd.Range.gi(this.range.top,this.range.left+yb)],Ca,!1);"Success"!==Ca.kind&&f.ULS.sendTraceTag(508303322,0,10,`InstantaneousGridContentRestorer.restore: failed to set column width - ${Ca.reason}`)}),
this.hZc.forEach((Ca,yb)=>{Ca.forEach((wc,dd)=>{dd=wd.Range.gi(this.range.top+yb,this.range.left+dd);if(dd=this.da.kh(dd))dd.cell.backgroundColor=wc.backgroundColor})}),this.spc=this.hZc=this.range=void 0)}YZf(Ca,yb){if(!this.range)return f.ULS.sendTraceTag(508303321,0,15,"InstantaneousGridContentRestorer.isRowColInRange: range not yet created - begin has not been called"),!1;(Ca=this.range.contains(wd.Range.gi(Ca,yb)))||f.ULS.sendTraceTag(508303320,0,10,"InstantaneousGridContentRestorer.isRowColInRange: row/column not in range");
return Ca}}Object(c.a)(te,"InstantaneousGridContentRestorer",null,[]);var oe=a(213),Kd=a(153);class Ee{constructor(Ca,yb,wc,dd){this.ORi=vd=>{const Zd=vd.Ti.block;if(this.uC.pk(Zd.jj)){this.osg([Zd.jj]);const Re=ya.f(this.$).fW(Zd.jj),ff=()=>this.hsg([Zd.jj]);setTimeout(()=>{Re.skeletonMode?setTimeout(()=>{Re.skeletonMode?f.ULS.sendTraceTag(508303319,0,10,"RichApiRangeValuesPreview.getRangeCallback: skeleton mode not dismissed within alloted time."):ff()},Ee.O$g):ff()},Ee.Xah)}};this.o3a=(vd,Zd)=>
{0===Zd.By&&576!==Zd.Wl.operation.operationName&&this.Ukb(!0)};this.o8d=vd=>{this.VXc&&(this.gvi(vd),this.YY())};this.$=Ca;this.un=yb;this.yn=wc;this.da=ya.f(this.$);this.wDc=new te(this.$,this.da,dd)}T2i(Ca,yb,wc,dd){this.jZf(Ca)?(yb=this.MOh(yb,wc))?this.n1?f.ULS.sendTraceTag(509227293,0,15,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: preview already showing, exit"):(this.worksheetId=Ca,this.uC=yb,this.values=wc,this.N7(dd)):f.ULS.sendTraceTag(509384200,0,10,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: failed to calculate range"):
f.ULS.sendTraceTag(509384201,0,50,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: not showing the preview, desired worksheet not supported for this operation")}N0i(Ca){this.jZf(Ca)?this.Ukb(!1):f.ULS.sendTraceTag(509359639,0,50,"RichApiRangeValuesPreview.handleHideRangeValuesPreviewPostProcessAction: not hiding the preview, desired worksheet not supported for this operation")}N7(Ca){this.osg(this.nBf());Ca&&(f.ULS.sendTraceTag(509227290,0,50,`RichApiRangeValuesPreview.showPreview: options: ${JSON.stringify(Ca)}`),
Ca.autoexpandTable&&this.ROh(),Ca.autofitColumns&&this.dOh());this.VXc=this.da.QM.N7(this.uC,this.ORi).then(yb=>{f.ULS.sendTraceTag(509384199,0,50,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: preview shown");this.n1=yb;this.wDc.Uta(this.uC);this.hsg(this.nBf());this.$.userOperationManager.px(this.o3a);yb.XTc.then(()=>this.o8d(!0),()=>this.o8d(!0));return Promise.resolve()},yb=>{f.ULS.sendTraceTag(509384198,0,10,`RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: failed to show preview, rejectionString = ${yb}`);
this.YY();return Promise.resolve()})}Ukb(Ca){this.VXc&&(f.ULS.sendTraceTag(509359638,0,50,"RichApiRangeValuesPreview.hidePreview: showPromise exists, will hide preview"),this.VXc.then(()=>{const yb=this.n1;this.o8d(Ca);yb&&yb.oga("RichApiRangeValuesPreview")},()=>{f.ULS.sendTraceTag(509383618,0,10,"RichApiRangeValuesPreview.hidePreview: unexpected rejection of this.showPromise")}))}MOh(Ca,yb){Ca=Md.ib(Ca,this.$.sa);if(Ca.returnValue)return new wd.Range(Ca.range.top,Ca.range.left,Ca.range.top+yb.length-
1,Ca.range.left+yb[0].length-1,!0,!0)}jZf(Ca){const yb=this.$.sa.na;return yb&&Ca===yb.sheetId}osg(Ca){this.SFd(Ca,(yb,wc,dd,vd)=>{vd.cell.OY=this.values[yb][wc];return!0})}hsg(Ca){this.ZAa&&this.SFd(Ca,(yb,wc,dd,vd)=>{this.wDc.Myk(dd.top,dd.left,vd,this.pJi(dd.top));return!0});if(this.Vdb){const yb=this.uC.zlb(Ca);0<yb.length&&this.Vdb&&this.Vdb.forEach((wc,dd)=>{this.wDc.Oyk(yb[0].top,this.uC.left+dd,wc)})}}SFd(Ca,yb){for(let dd=0;dd<this.values.length;++dd)for(let vd=0;vd<this.values[dd].length;++vd){const Zd=
wd.Range.gi(this.uC.top+dd,this.uC.left+vd);if(!Ca||Ca.some(Re=>Re.contains(Zd))){var wc=this.da.fD(Zd);if((!wc||Zd.equals(wc.topLeft))&&(wc=this.da.kh(Zd))&&!yb(dd,vd,Zd,wc))return}}}nBf(){return this.da.za.Zz().filter(Ca=>Ca.na===this.$.na).map(Ca=>Ca.jj)}gvi(Ca){this.un.yR(3400,this.worksheetId)&&(Ca=vc.a.li({type:"RangeValuesPreviewDismissed",source:"Local",ljl:Ca}),this.yn.iM(3400,this.worksheetId,Ca))}YY(){this.$.userOperationManager.Hv(this.o3a);this.iqk();this.ZAa=this.worksheetId=this.VXc=
this.values=this.uC=this.n1=void 0}ROh(){if(this.uC){var Ca=this.WVi(this.uC);if(Ca){f.ULS.sendTraceTag(509227289,0,50,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: table directly above or to the left of the range - faking autoexpand table");var yb=(Zd,Re)=>{var ff;return null===(ff=this.da.kh(wd.Range.gi(Zd,Re)))||void 0===ff?void 0:ff.backgroundColor},wc=Ca.usedRange.top;if(Ca.attributes&16){var dd=yb(Ca.usedRange.top,Ca.usedRange.left);++wc}var vd=yb(wc,Ca.usedRange.left);yb=yb(wc+
1,Ca.usedRange.left);this.ZAa={YYg:Ca.usedRange.top,YOd:dd,VXk:vd,DJh:yb}}else f.ULS.sendTraceTag(508303318,0,50,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: table autoexpand requested but no table found")}else f.ULS.sendTraceTag(509227291,0,10,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: this should never be called with no preview range set")}dOh(){this.Vdb=Array(this.uC.width);let Ca=!1;this.SFd(void 0,(yb,wc,dd,vd)=>{var Zd;if(this.da.fD(dd))return Ca=!0,!1;yb=vd.cell;
yb=yb.$ef(yb.OY);yb>vd.width&&(this.Vdb[wc]=Object(Kd.a)(null!==(Zd=this.Vdb[wc])&&void 0!==Zd?Zd:0,yb));return!0});Ca&&(this.Vdb=void 0)}iqk(){this.wDc.restore();Md.A(this.uC,(Ca,yb)=>{Ca=wd.Range.gi(Ca,yb);if(Ca=this.da.kh(Ca))Ca.cell.OY=void 0})}pJi(Ca){return this.ZAa.YOd&&Ca===this.ZAa.YYg?this.ZAa.YOd:0===(Ca-this.ZAa.YYg-(this.ZAa.YOd?1:0))%2?this.ZAa.VXk:this.ZAa.DJh}WVi(Ca){const yb=oe.b(this.da.$,Ca,!0);if(!(1<yb.length)){var wc=vd=>{var Zd;const Re=null!==(Zd=this.da.Yg.VVi(vd))&&void 0!==
Zd?Zd:this.da.Yg.XVi(vd);if(Re)return Re},dd=wc(Ca);if(dd&&0===yb.length)return dd;if(0!==yb.length&&(Ca=Md.eb(Ca,yb[0].usedRange),1===Ca.length))return wc(Ca[0])}}}Ee.Xah=20;Ee.O$g=100;Object(c.a)(Ee,"RichApiRangeValuesPreview",null,[]);class rc{}Object(c.a)(rc,"SessionRecreationInfo",null,[]);class fd{constructor(Ca,yb,wc){this.$=Ca;this.un=yb;this.runtimeCalculationMode=wc}oGj(){return gb.EwaSettings.Ra(234)?this.un.l4i()||0!==this.runtimeCalculationMode:!1}bMh(){var Ca={};Ca.eventRegistrationInfos=
this.un.UIi();Ca.runtimeCalculationMode=this.runtimeCalculationMode;Ca=Object(b.a)(new rc,{runtimeState:Ca});const yb={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",RequestHeaders:null};yb.RequestBody=JSON.stringify(Ca);yb.RequestFlags=1;return yb}}Object(c.a)(fd,"RichApiRuntimeStateHandler",null,[]);class Ed{constructor(Ca,yb,wc,dd,vd,Zd,Re,ff,af){this.dequeueUtcTime=this.processUtcTime=this.enqueueUtcTime=null;this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=
this.ServerCorrelationId=null;this.IsDocumentHidden=!1;this.enqueueUtcTime=Ca;this.processUtcTime=yb;this.dequeueUtcTime=wc;this.inQueueDurationInMS=dd;this.executionDurationInMS=vd;this.operationCount=Zd;this.ServerCorrelationId=Re;this.UserOperationName=ff;this.IsDocumentHidden=af}}Object(c.a)(Ed,"UserOperationQueueItemsStatisticsData",null,[]);var Rd=a(1239),Fe=a(77),Ae=a(254),We=a(503),ve=a(62),Ze=a(79),Oe=a(25),Nf=a(122),Zf=a(58),Rb=a(54),Vb=a(197),Cc=a(129),rg=a(50),yf=a(32),jg=a(35),If=a(252),
cf=a(27),Nb=a(12),Bc=a(262),Ob=a(923),zc=a(61),od=a(983);const ce=Ca=>{Qc.a.sendOtelEvent(Object.assign(new od.a,{otelEvent:Ca}))},Qb=Ca=>{Qc.a.sendOtelCustomerContent(Object.assign(new od.a,{otelEvent:Ca}))};var Xc=a(1097),md=a(28),ie=a(904);class me{constructor(Ca,yb,wc){this.RRc=0;this.BYe=new Set;this.EZf=!1;this.$=Ca;this.un=yb;this.yn=wc}BGh(Ca){1===Ca.actionType?this.un.yR(65541,Bd.a.zV)?this.RRc++:f.ULS.sendTraceTag(509649754,0,10,"AugmentationLoop AnnotationAdded event is not registered"):
2===Ca.actionType&&0<this.RRc&&this.RRc--}cKj(Ca,yb){if(0===this.RRc)f.ULS.sendTraceTag(509649753,0,50,"No event listeners. Event not fired.");else if(yb){Ca=yb.annotation;var wc=[];wc.push({content:JSON.stringify(yb.annotation),annotationType:ie.a.getTypeNameFor(Ca),id:Ca.id});this.yn.iM(65541,Bd.a.zV,JSON.stringify({annotationProperties:wc}))}else f.ULS.sendTraceTag(509649752,0,10,"Event args are null")}y_i(Ca){const yb=this;return No(function*(){if(!yb.un.yR(65541,Bd.a.zV))f.ULS.sendTraceTag(509649751,
0,10,"Event is not registered");else if(!yb.BYe.has(Ca.annotationType)){var wc=yield $d.a.resolve(Td.p,{va:1});yb.EZf||(wc.register(wc.e5().B7("RichApi").A7(()=>{}).build()),yb.EZf=!0);wc.xpa("RichApi",{annotationType:Ca.annotationType,bB:!1,pY:yb.cKj.bind(yb)});yb.BYe.add(Ca.annotationType)}})}z_i(Ca){return No(function*(){(yield $d.a.resolve(Td.p,{va:1})).twb(JSON.parse(Ca.content));f.ULS.sendTraceTag(509649750,0,100,`Submit operation for type: ${Ca.signalType}`)})}}Object(c.a)(me,"RichApiAugmentationLoopHandler",
null,[]);var Pe=a(1032),gf=a(1383),tf=a(1382);Object($d.b)(Td.vb,{yk:"singleton"})(Ca=>No(function*(){f.ULS.sendTraceTag(507581071,0,50,"DdaFacade created");if(l.AFrameworkApplication.disableWholeAppsForOfficeFeature)return f.ULS.sendTraceTag(507581070,0,50,`Not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [${l.AFrameworkApplication.disableWholeAppsForOfficeFeature}]`),null;const yb=yield $d.a.resolve(Td.Lb,Ca),wc=yield $d.a.resolve(Td.j,Ca),dd=yield $d.a.resolve(Td.sc,Ca),vd=yield $d.a.resolve(Td.Fg,
Ca);yield Object(nd.a)(sc.a.Q_d(65,()=>!(void 0===window.OSF||null===window.OSF),yb.ua.MaxRetriesForLoadingScript,yb.xa,Ca.va));yield Object(nd.a)(Pe.a(yb.xa,Ca.va));if(gb.EwaSettings.Ra(359)){const Zd=yield(yield Object(nd.e)(lb.a.wYg(Ka.a.instance.Qi("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")))).isFeatureEnabled("mso_officeStore",!0),Re=yield Ka.a.instance.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").fR("WACSideloadAddins");Qe.lKb=Zd;Qe.Gxe=Re}"undefined"!==
typeof OfficeExt&&"undefined"!==typeof OSF&&(gb.EwaSettings.Ra(63)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new tf.a),yb.Tj.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new tf.a,new gf.a(l.AFrameworkApplication.fa.appSettings.WebServiceBase),gb.EwaSettings.Ra(70),!0),OfficeExt.MosRequestHandler.init&&OfficeExt.MosRequestHandler.init(new tf.a),OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new tf.a));return new Qe(yb,
wc,dd,vd)}));class Qe extends Zb.a{constructor(Ca,yb,wc,dd){super();this.yn=this.jr=this.ea=null;this.pl=[];this.pXa=null;this.disposed=this.initialized=this.O$b=this.qjf=!1;this.dCa=null;this.SOc=[];this.kjf=[];this.O3a=[];this.Ggb=null;this.P$d=new ma.a(F.a.lm());this.Skc=new K.a(F.a.lm());this.O0b=[];this.qrg=[];this.MLb=350;this.WKa=this.u8=null;this.ekd=!1;this.yTe=this.xTe=this.nTe=this.wTe=this.vTe=this.tTe=this.pTe=this.uTe=this.qTe=this.sTe=this.oTe=this.rTe=null;this.ddh=3E3;this.U4c=!1;
this.YS=this.bCb=null;this.Vhd=!1;this.ded=new K.a(F.a.lm());this.ted=new K.a(F.a.lm());this.ol=()=>{this.ZRd?this.lZ||(this.dCa=this.ea.Cq.WebExtensions):this.dCa=this.ea.Cq.WebExtensions;var vd=ff=>gb.EwaSettings.Ra(114)?!ff.UGa:!0,Zd=ff=>gb.EwaSettings.isChangeGateEnabled("OfficeVSO:7116850_fixDialogApiOsfControlDeletedBySheetLocking")?!ff.sXf:!0;const Re=ff=>gb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopilotSilentReload",!1)?"FA000000124"!==ff.Nn.PrimaryMarketplace.SolutionId:
!0;for(let ff=this.pl.length-1;0<=ff;--ff){const af=this.pl[ff];!this.Zui(af.controlId)&&vd(af)&&Zd(af)&&Re(af)&&(af.CMc(),this.pl.splice(ff,1))}if(this.dCa)for(let ff=0,af=this.dCa.length;ff<af;ff++)vd=this.dCa[ff],(Zd=this.Er(vd.WebExtensionId))&&Zd.O7d(vd)};this.INc=vd=>{this.raiseEvent("csc",vd.getID())};this.k3a=(vd,Zd,Re)=>{if(Zd===OSF.AgaveHostAction.KeyboardShortcuts){var ff=Object(Hc.a)(Object,Re);Zd={};Zd.keyCode=ff.keyCode;Zd.type="keydown";Zd.ctrlKey=ff.ctrlKey;Zd.shiftKey=ff.shiftKey;
Zd.altKey=ff.altKey;Zd.metaKey=ff.metaKey;ff=this.Er(vd);vd=ff.Ska;Zd.srcElement=Object(Kb.a)(318,vd)?vd.EGb:ya.f(this.$).Pi;vd=new Sys.UI.DomEvent(Zd);ff=Qe.tIa(ff.Nn,this.$);Zd={};Zd.focusedAddinId=ff;ff=new xd.a(1461300262,1,this.$.Rh,6,null);ya.f(this.$).i4b(vd,ff,Zd)}else if(Zd===OSF.AgaveHostAction.Select)this.CLf(!0);else if(Zd===OSF.AgaveHostAction.UnSelect)this.CLf(!1);else if(Zd===OSF.AgaveHostAction.CancelDialog)this.xU(-684355545,null);else if(Zd===OSF.AgaveHostAction.InsertAgave)vd={},
Re&&(this.bCb=Re,vd[ba.a.Ata]=Re,vd[Gb.a.Wk]=this.CGa(Re),this.xU(-741808261,vd));else if(Zd===OSF.AgaveHostAction.ClickTrust)this.Xnd&&Re&&(this.bCb=Re);else if(Zd===OSF.AgaveHostAction.OsfControlLoad)this.Xnd&&this.bCb&&Re&&this.CFh(this.bCb,Re)&&Re.storeType&&(this.bCb=null,this.YF(pa.b(Re.storeType)));else if(Zd===OSF.AgaveHostAction.InsertDevManifest)vd={},Re&&(vd[ba.a.Ata]=Re,vd[Gb.a.Wk]=this.CGa(Re),this.xU(-741808261,vd));else if(Zd===OSF.AgaveHostAction.InsertDevManifestError)vd=Object(Hc.a)(Object,
Re),vd={[ba.a.Hnd]:this.jr.getDevManifestInvalidUrlErrorString(vd.manifestUrl)},this.xU(-2025863019,vd);else if(Zd===OSF.AgaveHostAction.NotifyHostError)vd={[ba.a.Hnd]:this.jr.getManifestInvaildErrorString()},this.xU(-2025863019,vd);else if(Zd===OSF.AgaveHostAction.RefreshAddinCommands)gb.EwaSettings.Ra(52)&&this.xU(md.a.refreshAddinCommands,null);else if(Zd===OSF.AgaveHostAction.CtrlF6Exit||Zd===OSF.AgaveHostAction.CtrlF6ExitShift){if(ff=$d.a.Zg(Td.Kb)){(vd=this.Er(vd).Ska)&&vd.YYc();n.a.hm&&document.activeElement.blur();
var af={keyCode:117,type:"keydown",ctrlKey:!0};af.shiftKey=Zd===OSF.AgaveHostAction.CtrlF6ExitShift;af.srcElement=Object(Kb.a)(318,vd)?vd.EGb:ya.f(this.$).Pi;vd=new Sys.UI.DomEvent(af);ff.iza(vd)}}else if(Zd===OSF.AgaveHostAction.PageIsReady){if((vd=this.Er(vd).Ska)&&vd.mdb===OSF.OsfControlTarget.TaskPane&&(vd=null,(vd=Oe.a.ut()?$d.a.Zg(Td.We):this.$.ka.Ug(183))&&this.pl))for(ff of this.pl)Qe.R_a(ff.lX)&&vd.zp(!0,!1)}else if(Zd===OSF.AgaveHostAction.TabExit){Zd=this.Er(vd);const Ab=Zd.Ska;Ab?Ab.mdb===
OSF.OsfControlTarget.InContent?Ab.V1f():Ab.mdb===OSF.OsfControlTarget.TaskPane&&(n.a.hm&&document.activeElement.blur(),Oe.a.ut()?void $d.a.resolve(Td.We,{va:3}).then(xc=>{const eb=Object(Kb.a)(318,Ab)?Ab:null;eb?eb.isResizable?xc.focusResizeHandle():xc.focusTabbedTaskPaneArea():xc.focusTabbedTaskPaneArea()}):La.a.Go().then(xc=>{const eb=Object(Kb.a)(318,Ab)?Ab:null;eb?eb.isResizable?xc.focusResizeHandle():xc.focusTabbedTaskPaneArea():xc.focusTabbedTaskPaneArea();return null})):Zd&&4===Zd.osfControlType&&
this.jr.notifyAgave(vd,OSF.AgaveHostAction.TabIn)}else if(Zd===OSF.AgaveHostAction.TabExitShift)(Zd=this.Er(vd),ff=Zd.Ska)?ff.mdb===OSF.OsfControlTarget.InContent?ff.W1f():ff.mdb===OSF.OsfControlTarget.TaskPane&&(vd=Object(Kb.a)(318,ff)?ff:null)&&(n.a.hm&&document.activeElement.blur(),vd.eAk()):Zd&&4===Zd.osfControlType&&this.jr.notifyAgave(vd,OSF.AgaveHostAction.TabIn);else if(Zd===OSF.AgaveHostAction.EscExit||Zd===OSF.AgaveHostAction.ExitNoFocusable||Zd===OSF.AgaveHostAction.ExitNoFocusableShift)if(ff=
this.Er(vd).Ska)ff.YYc();else{if(Zd===OSF.AgaveHostAction.EscExit){Zd=null;for(af of O.TYi())if(af.value.Lk===vd){af.value.dialog.hide();Zd=af.key;break}Zd&&(vd=this.Er(Zd))&&4!==vd.osfControlType&&this.wl.notifyAgave(Zd,OSF.AgaveHostAction.TabIn)}}else if(Zd===OSF.AgaveHostAction.InstallCustomFunctions)if(gb.EwaSettings.Ra(114)){rg.a(this.$).zyf(()=>!1);var xf=this.$.ka;ec.TaskExtensions.Ua(Ze.GetServiceTaskFactory.Bj(xf,278,279,1),Ab=>{Ab=Ab.result;xf.Ug(278)||xf.ph(278,Ab);const xc=Re.osfControl.getStoreType();
Ab.ySf(Re.osfControl.getSolutionId(),xc,Qe.PGi(Re.osfControl),Re).nAa()},this.xa,3)}else f.ULS.sendTraceTag(537170577,0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");else if(Zd===OSF.AgaveHostAction.UninstallCustomFunctions)if(gb.EwaSettings.Ra(114)){rg.a(this.$).zyf(()=>!1);var eg=this.$.ka;ec.TaskExtensions.Ua(Ze.GetServiceTaskFactory.Bj(eg,278,279,1),Ab=>{Ab=Ab.result;eg.Ug(278)||eg.ph(278,Ab);Ab.B0g(Re.solutionId,Re.storeType).nAa()},this.xa,
3)}else f.ULS.sendTraceTag(537170574,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");else Zd===OSF.AgaveHostAction.SendTelemetryEvent?ce(Re):Zd===OSF.AgaveHostAction.SendCustomerContent?Qb(Re):Zd===OSF.AgaveHostAction.LaunchExtensionComponent?r.a.instance.ntj(Re):Zd===OSF.AgaveHostAction.RefreshRibbonGallery?void $d.a.resolve(Td.ge,{va:0}).then(Ab=>{Ab.gOd(Re)}):Zd===OSF.AgaveHostAction.RemoveAppCommandsAddin?this.shk(Re.solutionId):Zd===OSF.AgaveHostAction.GetOriginalControlId&&
(vd=new ha.a(this.$.$h,Re.ownerAddinSolutionId,new Eb.a,!0),Re.originalControlId=vd?vd.Kjf(Re.controlId):Re.controlId)};this.YJg=(vd,Zd)=>{const Re=Array(2);Re[0]=Zd;Re[1]=null;this.yn.kvi(vd,JSON.stringify(Re))};this.dpg=()=>{this.$.na&&Fe.n(this.$.na)&&(Td.Fg.Ha()?this.webExtensionView.RSb():Na.a(this.$).RSb())};this.xj=()=>{this.e4f()};this.onBlockCacheItemChanged=(vd,Zd)=>{vd=Zd.Ti;(vd=(vd=vd.block.state&1?vd.block.Fj:null)?vd.CustomFunctionsObjects:null)&&this.Cwd(vd)};this.c1=(vd,Zd)=>{var Re,
ff;1===Zd.By&&(vd=Zd.Wl)&&(Zd=new Ed(Cc.toTimestamp(vd.enqueueUtcTime),Cc.toTimestamp(vd.processUtcTime),Cc.toTimestamp(vd.dequeueUtcTime),Cc.getElapsedMilliseconds(vd.enqueueUtcTime,vd.processUtcTime),Cc.getElapsedMilliseconds(vd.processUtcTime,vd.dequeueUtcTime),vd.operationCount,(null===(ff=null===(Re=vd.operation)||void 0===Re?void 0:Re.Uj)||void 0===ff?0:ff.ServerCorrelationId)?vd.operation.Uj.ServerCorrelationId:null,vd.operation?Enum.toString(We.a,vd.operation.operationName):null,Ob.a.tM(Cc.getElapsedMilliseconds(vd.enqueueUtcTime,
yf.a.Tg.Wh))),Re=Sys.Serialization.JavaScriptSerializer.serialize(Zd),f.ULS.sendTraceTag(50872916,0,50,Re))};this.lMc=()=>{this.eAg()};this.Oi=(vd,Zd)=>{!this.ea.Ph&&Ae.a(Zd)?this.eAg():(Zd.rM&&(f.ULS.sendTraceTag(537170516,0,50,"Silent Reload require reset osf controls."),this.VEg()),this.wV(),gb.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&(this.O$b=!1))};this.Dt=()=>{gb.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&
(f.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),this.VEg());this.wV();gb.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(this.O$b=!1)};this.Bsg=vd=>{vd=vd.Result;if(vd=null===vd||void 0===vd?void 0:vd.AgaveData){var Zd=vd.PrimaryMarketplace.SolutionId;Zd=vd.SrcLocationOverrideResourceId?this.pIa(vd.PrimaryMarketplace.SolutionId,vd.SrcLocationOverrideResourceId):Zd;if(Zd=this.MEd(Zd))this.ded.ga(vd.InstanceId,Zd.controlId),
this.ted.ga(Zd.controlId,vd.InstanceId)}else f.ULS.sendTraceTag(507637772,0,10,"Silent Reload::postServerReloadSuccess: failed to return valid response.")};this.Qfg=vd=>{vd.CMc();this.raiseEvent("cd",vd.controlId)};this.fh=Ca;this.webExtensionView=dd;this.$nd=yb;this.initialize(wc);Aa.Aa(this);this.hGg=0;(Ca=(Ca=!(n.a.Gx||n.a.D0))&&!n.a.hm)&&OfficeExt.ShortcutKeyDispatchManager.init();this.wjh={}}get Idb(){return this.u8||(this.u8=new ib.a(this.$.VJ))}rmd(Ca){this.addHandler("cd",Ca)}Fik(Ca){this.removeHandler("cd",
Ca)}Yxh(Ca){this.addHandler("csc",Ca)}Hik(Ca){this.removeHandler("csc",Ca)}Vxh(Ca){this.addHandler("ca",Ca)}Eik(Ca){this.removeHandler("ca",Ca)}Wxh(Ca){this.addHandler("ci",Ca)}Xxh(Ca){this.addHandler("ekros",Ca)}Gik(Ca){this.removeHandler("ekros",Ca)}s$d(Ca,yb){try{return JSON.parse(Ca)[yb].toLowerCase()}catch(wc){return""}}CGk(Ca){const yb=this.s$d(Ca,"AudienceGroup"),wc=this.s$d(Ca,"SessionOrigin");try{const dd=parseInt(this.s$d(Ca,"Ring"),10);if("automation"!==yb&&"bluechicken"!==wc&&-2<=dd)return!0}catch(dd){if("automation"!==
yb&&"bluechicken"!==wc)return!0}return!1}get wl(){if(!this.jr){const Ca={},yb=!(this.$.wj&1),wc=sc.a.current.jS,dd=this.$.workbookContext,vd=l.AFrameworkApplication.l8?l.AFrameworkApplication.fa.Xa("StaticContentHostNonOverriden"):Yb.a.TV,Zd=vd+Yb.a.ypc;Ca.pageBaseUrl=wc.LayoutsContentUrlPrefix;Ca.appName=OSF.AppName.ExcelWebApp;Ca.appVersion="16";Ca.appSettings=this.uLi();Ca.singleSignOnSettings=U.a.OUi();Ca.clientMode=yb?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;Ca.appUILocale=this.$.ua.UICultureTag;
Ca.dataLocale=this.$.ua.DataCultureTag;Ca.docUrl=dd.ClientUrl;Ca.hostControl=this;Ca.formFactor=OSF.FormFactor.Default;Ca.lcid=this.$.fL.toString();Ca.localizedScriptsUrl=vd+Yb.a.Zdf;Ca.localizedImagesUrl=Zd;Ca.localizedStylesUrl=vd+Yb.a.Wdf;Ca.localizedResourcesUrl=Zd;Ca.osfOmexBaseUrl=wc.OsfOmexBaseUrl;Ca.firstPartyManifestCDNUrl=wc.FirstPartyAddInManifestCDN;Ca.sdxAssetsToPrefetchMapping=l.AFrameworkApplication.fa.Xa("SdxAssetsToPrefetchMapping");Ca.sdxCdnUrl=wc.SdxCdnUrl;Ca.sdx1CdnUrl=wc.Sdx1CdnUrl;
Ca.forceUseSdx1Cdn=wc.ForceUseSdx1Cdn;Ca.sdxDmsUrl=wc.SdxDmsUrl;Ca.sovereignFederationDMSToken=wc.SovereignFederationDMSToken;Ca.sovereignFederationDMSTokenSuffix=wc.SovereignFederationDMSTokenSuffix;Ca.devCatalogUrl=wc.DevCatalogUrl;Ca.controlStatusChanged=this.INc;Ca.notifyHost=this.k3a;Ca.allowExternalMarketplace=this.$.ea.sn.get(27)&&Qe.lKb;Ca.enableAddinCommands=gb.EwaSettings.Ra(52);Ca.enableBlackForestRedirect=gb.EwaSettings.Ra(87);Ca.enableMyOrg=this.$.ea.sn.get(33);Ca.enableMyApps=this.$.ea.sn.get(34);
Ca.enableDevCatalog=gb.EwaSettings.Ra(43);Ca.enablePrivateCatalog=this.yHk();Ca.showSignOutFromPrivateCatalogMessage=this.$.ea.sn.get(36);Ca.enableUploadFileDevCatalog=gb.EwaSettings.Ra(52)&&!gb.EwaSettings.Ra(254)&&Qe.Gxe;Ca.userNameHashCode=N.a.jF(l.AFrameworkApplication.userName);Ca.envCode=this.$.ua.OfficeAddinTelemetryDataSourceCode.toString();Ca.enableSingleSignOnForAddin=l.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;Ca.enableDisplayBlockedMinorError=gb.EwaSettings.Ra(171);
Ca.hideAppsExtensionUrl=l.AFrameworkApplication.hideAppsExtensionUrl;Ca.enableAnonymousUseLegacyCatalogService=gb.EwaSettings.Ra(162);Ca.enableInsertDialogAccessibilityFix=gb.EwaSettings.Ra(169);Ca.disableAppsForOfficeThirdParty=gb.EwaSettings.Ra(174);Ca.enableFirstPartySSO=gb.EwaSettings.Ra(186);Ca.wacSessionId=this.$.ua.UserSessionId;Ca.disableLogging=!this.$.ua.AriaLoggingIsEnabled;Ca.enableFirstPartySDXErrorMessages=gb.EwaSettings.Ra(198);Ca.isHostDocumentDomain=gb.EwaSettings.Ra(209);Ca.loggableUserId=
l.AFrameworkApplication.fa.Xa("LoggableUserId");Ca.sessionStartInfoJson=l.AFrameworkApplication.fa.Xa("SessionStartInfoJson");Ca.wopiHostOriginFromPostMessage=l.AFrameworkApplication.wopiHostOriginFromPostMessage;Ca.wopiHostOriginFromWacPropBag=l.AFrameworkApplication.fa.Xa("PostMessageOrigin");Ca.wacIsEmbedded=l.AFrameworkApplication.fa.la("IsEmbedded");Ca.accessibilityAllowFocusAddinTaskpane=l.AFrameworkApplication.fa.la("AccessibilityAllowFocusAddinTaskpane");Ca.enableRemoveAppCommandsAddin=l.AFrameworkApplication.fa.la("RemoveAppCommandsAddinIsEnabled");
Ca.isHostFrameTrustCheckEnabledForAddIns=l.AFrameworkApplication.fa.la("HostFrameTrustCheckIsEnabledForAddIns");Ca.isHostFrameTrusted=l.AFrameworkApplication.isHostFrameTrusted;Ca.agaveAddinUploadEnabled=gb.EwaSettings.Ra(45);Ca.hostAllowedOfficeStore=l.AFrameworkApplication.fa.la("HostAllowedOfficeStore");Ca.hostAllowedSdxEmbedding=l.AFrameworkApplication.fa.la("HostAllowedSdxEmbedding");Ca.hostInstallAddIns=l.AFrameworkApplication.fa.Xa("HostInstallAddIns");Ca.hostInstallAddInsIsEnabled=l.AFrameworkApplication.fa.la("HostInstallAddInsIsEnabled");
Ca.approvedAddIns=l.AFrameworkApplication.fa.Xa("ApprovedAddIns");Ca.addinEnforceHttpsIsEnabled=this.CGk(Ca.sessionStartInfoJson);Ca.hostFeatureGateFlag=0;Ca.isUpnCheckEnabled=l.AFrameworkApplication.fa.la("IsUpnCheckEnabled");Ca.wacUpn=l.AFrameworkApplication.fa.Xa("UserPrincipalName");Ca.isReactRibbonEnabled=Oe.a.isReactRibbonEnabled();Ca.enableSetFocusOnTaskpaneOnUserAction=gb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);Ca.isSafariWithIndexedDBDisabled=
gb.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&n.a.Una;Ca.isIndexedDBDisabled=gb.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&n.a.Una||gb.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&n.a.hm;Ca.enableCustomShortcuts=!0;Ca.changeGetModifierKeyStringOutputOrder=gb.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");Ca.officeJsUrl=l.AFrameworkApplication.fJ("OfficeJs/excel.js",5);
Ca.enableOfficeJsUrlParam=gb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableOfficeJsUrlParam",!1);this.jr=new OSF.ContextActivationManager(Ca);this.jr.setIframeAttributeBag({["frameborder"]:0,["marginheight"]:0,["marginwidth"]:0});this.jr.setWSA(l.AFrameworkApplication.Gt);this.jr&&"undefined"!==typeof this.jr.hostCheckReadyHandler&&l.AFrameworkApplication.Yyh(Object(pc.a)(this.jr,this.jr.hostCheckReadyHandler,"hostCheckReadyHandler"));try{const Re=Ka.a.instance.resolve("Common.App.OAuth.IOAuthManager");
this.jr.setOAuthManager(Re)}catch(Re){}}return this.jr}get Fal(){return this.ekd}get un(){return this.rTe}get kAa(){return this.oTe}get sje(){return this.sTe}get rje(){return this.qTe}get mrk(){return this.uTe}get krk(){return this.pTe}get lrk(){return this.tTe}get nrk(){return this.vTe}get ork(){return this.wTe}get tje(){return this.xTe}get gGg(){return this.yTe}get C5(){return this.wjh}get $(){return this.fh}get qje(){return this.nTe}Fmc(Ca){const yb={};yb.Name=Ca.Name;yb.BindingType=Ca.BindingType;
yb.HasHeaders=Ca.HasHeaders;Ca.IsValidRef&&(yb.ColCount=Ca.Reference.LastColumn-Ca.Reference.FirstColumn+1,yb.RowCount=Ca.Reference.LastRow-Ca.Reference.FirstRow+1);return yb}get yGb(){return l.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&l.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8500191_EnableHomeEntrywithFlyout")}q3f(Ca,yb){const wc=this.cLh(yb);let dd=null;if(l.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:7073634_TellMeLaunchAddinDialogSetTabIdEnabled")&&
gb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1)&&null!==yb&&"LaunchAddinDialogFromTellMe"===yb[0])null!==wc.assetId&&"undefined"!==typeof wc.assetId&&(dd="{98143890-AC66-440E-A448-ED8771A02D52}");else if(this.yGb){var vd=this.$.ea.sn.get(27);!vd||null===yb||"InsertMoreAddInsFromFooter"!==yb[0]&&"InsertMoreAddInsFromBackstageFooter"!==yb[0]?!vd||null===yb||"AddinFlyoutMoreButton"!==yb[0]&&"LaunchMyAddInsFromBackstage"!==yb[0]||(dd="0"):dd="{98143890-AC66-440E-A448-ED8771A02D52}"}gb.EwaSettings.isChangeGateEnabled("OfficeVSO:8253544_LogTelemetryForStoreDialog")&&
(yb={["controlId"]:null!==yb?yb[0]:"AllSources"},vd=new Jc.a,vd.name="Office.Extensibility.Host.ShowStoreDialog",vd.dataFields=Wc.a.rn(yb),Qc.a.sendTelemetryEvent(vd));this.jr.launchInsertDialog(Ca,dd,wc)}get lZ(){return this.Vhd}get ZRd(){return gb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddinSDXSilentReload",!1)}get okj(){return gb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InlineDialogReset",!1)}twa(Ca){return this.ted.Vg(Ca)?this.ted.ma(Ca):Ca}L$(Ca){return this.ded.Vg(Ca)?
this.ded.ma(Ca):Ca}get ON(){return this.iUa}get iUa(){this.Xnd&&!this.YS&&(this.kfk&&this.lii(this.ddh),this.YS=Ia.createInstance(l.AFrameworkApplication.fa,new $b.a(()=>this.jr),{["AppsForOfficeAllowExternalMarketplace"]:this.allowExternalMarketplace,["AppsForOfficeThirdPartyIsDisabled"]:this.wVk,["AreThirdPartyAddInsAllowed"]:this.$.C3,["PopularAddinDetailsJsonString"]:this.C7e&&this.O3j?Qe.N3j:Qe.Prb,["UICulture"]:l.AFrameworkApplication.uiCulture}));return this.YS}get wVk(){return gb.EwaSettings.Ra(174)}get allowExternalMarketplace(){return this.$.ea.sn.get(27)}get Xnd(){return l.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")}static get Prb(){return'[{"displayName":"Mini Calendar and Date Picker","solutionId":"wa102957665","version":"1.3.0.0","targetType":0,"width":240,"height":220,"description":"Add a mini monthly calendar to your spreadsheet and use it to insert dates or the current time.","iconUrl":"31013.352a833c-760b-49ee-b384-f9718a71d650.3966871d-bbca-4abd-996d-777127e5f717.aac00a7f-336d-4d49-9fbb-f41bc3db4515.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.vertex42.com/privacy.html","addinInfo":{"priority":1,"AUP":45662}},{"displayName":"Bubbles","solutionId":"wa103147117","version":"1.1.0.0","targetType":0,"width":500,"height":500,"description":"Visualize your data in a fun and interactive way using bubbles to quickly identify patterns.","iconUrl":"6406.490601bf-78b6-49e5-be4f-e671fe712516.9fc1cb98-b071-4854-918e-40a0d2c7a467.49ae5470-5b06-4fa6-8762-6977e397810a.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://roljs.azurewebsites.net/bubbles-privacy-statement","addinInfo":{"priority":1,"AUP":84}},{"displayName":"Geographic Heat Map","solutionId":"wa103304320","version":"1.1.0.0","targetType":0,"width":480,"height":350,"description":"This app will help you visualize data across geographic locations. It\'s simply formatting on a map.","iconUrl":"33870.9aae8635-7790-49e5-9809-7704d4347793.cf84e746-9ce3-4a9a-83c5-4efc8117bc45.2cdca20b-36a0-45d8-bc0e-859ce6e806da.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"","addinInfo":{"priority":-1,"AUP":0}},{"displayName":"QR4Office","solutionId":"wa104051163","version":"1.2.0.3","targetType":1,"width":0,"height":0,"description":"A first-of-its-kind QR-generator that integrates seamlessly into your Office documents.","iconUrl":"53638.20ce8aca-39c5-4b97-b87a-47d0f3e21e0d.0b60ea0f-7e02-4465-baeb-bb55c723d670.9147ef8e-cf16-47cf-af10-ef553e88804d.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://q.michaelzlat.com/","addinInfo":{"priority":1,"AUP":1759}},{"displayName":"Solver","solutionId":"wa104100404","version":"3.0.0.1","targetType":1,"width":0,"height":0,"description":"Solve optimization models in Excel Online and Excel on iPad, upward compatible from Solver in Excel.","iconUrl":"37315.adb6ef87-ef0f-4f99-b639-c08a45950b58.cb56fe0c-c385-43b5-8c1b-88701ddbb898.c5239aae-28c3-4dec-8338-e6c0ceef5b82.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683093/Asset_5ef7a7a3-cb57-4c16-8fe4-6032d115bc04/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":3,"AUP":6458}},{"displayName":"People Graph","solutionId":"wa104104476","version":"1.4.0.0","targetType":0,"width":580,"height":400,"description":"Transform cold data into a cool picture.","iconUrl":"49387.7b82fde0-3b87-471f-a121-86215bd4c0d4.5c5551ff-1f1c-4fdd-83a0-9a311307f989.b07f3a4e-26ca-4174-83e2-a8953ecb5eb6.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949674809/Asset_488b8377-7de8-40ce-82ca-0a2fd48220dd/PEOPLEGRAPHAPPFOROFFICELICENSE.docx","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":1,"AUP":13200}},{"displayName":"E2D3","solutionId":"wa104379169","version":"2.0.1.0","targetType":0,"width":800,"height":680,"description":"Create dynamic and interactive graphs on Excel","iconUrl":"1677.6b2891ac-505f-41cc-80f6-db53a4274b85.62a2ad24-69c3-41ae-9419-bd700be3f626.67a1d711-d2ca-4e12-94b8-49464dc829ec.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://e2d3.org/privacy","addinInfo":{"priority":1,"AUP":73}},{"displayName":"XLMiner Analysis ToolPak","solutionId":"wa104379190","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Statistical analysis in Excel Online, with functions matching the Analysis ToolPak in desktop Excel.","iconUrl":"2225.9cbf413e-e33f-4be9-90ef-2fdb353c52a1.6e475dbb-9ae3-4b89-ae41-004faa21a088.e9552e6b-53ec-4728-ba49-ba04757c6dd0.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-analysis-toolpak-app","addinInfo":{"priority":3,"AUP":10751}},{"displayName":"Stock Connector","solutionId":"wa104379220","version":"8.0.0.0","targetType":1,"width":0,"height":0,"description":"Link stocks, currency, & crypto prices to cells in Excel spreadsheets and update them in real time.","iconUrl":"35421.d104d786-d979-48bb-9827-1b28ac5178cf.c0696ae0-87b8-4c16-ab8c-171be18ca0a9.8dcfdc9c-2863-4fa9-905d-84ff8534af7a.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://michael-saunders.com/stocksapp/pages/privacy.html","addinInfo":{"priority":1,"AUP":3216}},{"displayName":"Symbols and Characters - Fast Symbol Lookup","solutionId":"wa104379279","version":"2.1.0.0","targetType":1,"width":0,"height":0,"description":"Symbols and characters | Fast symbol and emoticon search with convenient auto-lookup","iconUrl":"53409.631e9a68-2435-4716-b1b8-dc48b99d3f85.d2f9c29f-cf48-4dcc-8202-fcbc5e4d1482.0216011c-2369-4ee7-8351-ac51d77015c2.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tec-it.com/en/legalconditions/Default.aspx","addinInfo":{"priority":1,"AUP":872}},{"displayName":"Microsoft Dynamics Office Add-in","solutionId":"wa104379629","version":"1.3.0.0","targetType":1,"width":0,"height":0,"description":"The Microsoft Dynamics Office Add-in enables data connections to Microsoft Dynamics systems.","iconUrl":"2287.eac0bf67-c34b-4302-aaa9-a07c1e560721.16c405d8-e48b-42e1-ac8f-7c402b8ae0d1.5ce79e5f-d108-48a7-b34b-75c71b620973.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949677398/Asset_e3871df6-665b-4927-a7fe-cd9e228611cc/LCSTermsofUseFinalFebruary2016.pdf","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=271135","addinInfo":{"priority":3,"AUP":3973}},{"displayName":"officeatwork | Template Chooser for Office - M365","solutionId":"wa104380050","version":"3.4.0.0","targetType":1,"width":0,"height":0,"description":"Access your centrally shared templates in Office, Teams, SharePoint Online, and other Apps.","iconUrl":"21517.40f3490e-24f2-4502-9a44-28e543d36a75.cc0236b1-594c-49ad-9462-3f787be3cd4f.f383d0e6-2de8-4367-9108-e62781456dad","licenseUrl":"https://links.officeatwork.com/officeatwork-licenseterms","privacyUrl":"https://links.officeatwork.com/officeatwork-privacypolicy","addinInfo":{"priority":1,"AUP":822}},{"displayName":"Lucidchart Diagrams for Excel","solutionId":"wa104380194","version":"1.1.2.0","targetType":1,"width":0,"height":0,"description":"The easiest way to draw and insert flowcharts, mockups, UML, mind maps and more in Office documents.","iconUrl":"21470.3fa72610-07ba-489f-b48f-1fcb5ca4253a.fc3d89ad-c9dc-445c-9baa-074b7b8f0cfb.9bc93e17-dd72-4215-b8b0-0cf81a3d9925.png","licenseUrl":"https://www.lucidchart.com/pages/tos","privacyUrl":"https://www.lucidchart.com/pages/privacy","addinInfo":{"priority":3,"AUP":1968}},{"displayName":"Adobe Acrobat for Microsoft Word, Excel, and PowerPoint","solutionId":"wa104380526","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Do more with enterprise PDF tools, built right into your favorite Microsoft 365 apps.","iconUrl":"832.4553b45a-c9b7-42b8-9c57-e33b57f5df4d.80d83ec3-4ec7-4f7d-b45f-36b1f0c05e78.3d5b10f9-0a9c-4ac1-84fc-b7439dfb4f35.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":1,"AUP":3473}},{"displayName":"Facebook Ads Manager for Excel","solutionId":"wa104380711","version":"1.0.0.2","targetType":1,"width":0,"height":0,"description":"The fastest way to view performance data for all of your Facebook ad accounts.","iconUrl":"47990.d08ffb67-b1f0-4ef6-ac6f-4b5379c5d285.a5cb5ec2-3726-4cf0-ae84-5d8ee7ee3439.3af0d784-7a14-4e39-897b-24e4e633fb76.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.facebook.com/about/privacy","addinInfo":{"priority":3,"AUP":346}},{"displayName":"Script Lab, a Microsoft Garage project","solutionId":"wa104380862","version":"1.5.0.0","targetType":1,"width":0,"height":0,"description":"Create, run, and share your Office Add-in code snippets from within Excel, Word, or PowerPoint.","iconUrl":"52703.9fd54003-f1a2-4196-a8a8-ea11bec509a8.9b4da1d4-cb1c-46e6-9463-8a258eb273e6.b5c7baa9-2a17-4db7-b0dd-ca9dea75bd27.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":2,"AUP":1332}},{"displayName":"Excel-to-Word Document Automation","solutionId":"wa104380955","version":"3.16.2.1","targetType":1,"width":0,"height":0,"description":"Update Word and PowerPoint documents from Excel data, calculations, text, tables, and charts.","iconUrl":"44742.554108a6-3275-4065-9a18-887d38776dca.31f4b432-c6cb-49c5-9fba-56c194301365.e534a91d-b3f5-445e-bdbd-1559dbb4b396.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://analysisplace.com/Privacy","addinInfo":{"priority":3,"AUP":533}},{"displayName":"Journal Entry Batch Creator for Financial Edge NXT","solutionId":"wa104380978","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Create new journal entry batches in Financial Edge NXT via Excel (for existing customers)","iconUrl":"10843.146167ad-49b2-41d3-aff7-76ed38a0ea33.da610372-55d7-45b3-9134-1aa080eaa154.adce15a7-2cb2-4d79-90f8-6888df00287e.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.blackbaud.com/privacy-shield","addinInfo":{"priority":3,"AUP":348}},{"displayName":"Mobile Data Collection - Scan-IT to Office","solutionId":"wa104381026","version":"1.2.0.0","targetType":1,"width":0,"height":0,"description":"Real-time mobile data collection and barcode scanning for Excel and Word ","iconUrl":"7989.6963e6f3-4ebf-4a63-82b7-734a5a002866.814dcb0f-f024-477c-9b9b-9407aef3d56a.a4027334-e000-4b89-bd22-18d0d906a688.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tec-it.com/en/website/legalconditions/Default.aspx#Privacy","addinInfo":{"priority":3,"AUP":1167}},{"displayName":"Functions Translator, a Microsoft Garage project","solutionId":"wa104381504","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Translate the Excel functions and formulas between different languages","iconUrl":"6460.beedf6f4-7724-4c03-8e90-d6cc7d58e77c.a85b2258-a967-4d48-898f-a8db56e4d9c6.1b6557bd-4e89-4bad-a3d7-0ad2f0f0ee55.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://go.microsoft.com/fwlink/p/?LinkId=123161","addinInfo":{"priority":2,"AUP":1755}},{"displayName":"Cryptosheets","solutionId":"wa104381695","version":"1.0.10.0","targetType":1,"width":0,"height":0,"description":"The easiest way to pull live, real-time, and historical cryptocurrency data directly into a sheet.","iconUrl":"44479.63cc4a83-c6d9-41b8-ab03-721c5071695c.9ab58e20-a9a3-4915-8ece-423d1fbe8e5f.af1fbf7c-11e4-4278-a726-d902df022e8c.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://cryptosheets.com/privacy","addinInfo":{"priority":3,"AUP":374}},{"displayName":"Microsoft Power Automate for Excel","solutionId":"wa104381701","version":"1.0.0.4","targetType":1,"width":0,"height":0,"description":"Automate repetitive tasks by integrating your favorite apps and services with Power Automate.","iconUrl":"24472.5327e164-9595-41b5-94b6-dc524c42d5f6.318749ea-0f55-45b9-aee5-b89aae584a0c.73475625-266a-4866-b041-d9536d4673bb.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":-1,"AUP":9563}},{"displayName":"Tiller Money Feeds","solutionId":"wa104381717","version":"1.0.3.0","targetType":1,"width":0,"height":0,"description":"Manage your money, your way with the most powerful automated personal finance service for Excel.","iconUrl":"57987.b83fa962-bb4f-4dd1-89e2-6b40f8b0a724.95198c12-4345-4728-b4c6-d3e76bb58555.affa1083-0e0c-4cf9-b006-636291dae421.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tillerhq.com/privacy","addinInfo":{"priority":1,"AUP":311}},{"displayName":"FYI for Office","solutionId":"wa104381841","version":"1.0.2.2","targetType":1,"width":0,"height":0,"description":"Standardise your output and enforce filing across your practice with FYI.","iconUrl":"55705.a91d847f-3878-41c0-90a2-1a25491d561e.6ece2a38-0dd7-4c23-abd0-2d418443543e.4218a512-bae0-420b-b293-2194a885c9aa.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474848155/Product_42949682443/Asset_5cb37a96-0b6a-4b64-bbf2-fa24ee29cec5/eula.pdf","privacyUrl":"https://www.fyidocs.com/privacy","addinInfo":{"priority":2,"AUP":1247}},{"displayName":"VitalTax | Making Tax Digital (MTD) for VAT","solutionId":"wa104381859","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Submit your VAT return directly from Excel and digitally link your data to HMRC","iconUrl":"10434.1d05b34e-479a-4769-bf99-07b416b11cbc.482ef49e-8635-4bfe-bb8d-e5ce4a2a4e61.be642c2c-717a-424c-96d8-8cea91a28e75.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474848420/Product_42949682533/Asset_28a3de04-adcc-4a88-8d42-b3493d67599a/ENDUSERLICENSEAGREEMENT.docx","privacyUrl":"https://vitaltax.uk/privacy-policy","addinInfo":{"priority":1,"AUP":444}},{"displayName":"Microsoft Visio Data Visualizer","solutionId":"wa104381973","version":"1.0.0.4","targetType":0,"width":732,"height":448,"description":"Quickly and easily visualize your data into polished Visio diagrams within Excel.","iconUrl":"28591.0bb30ee2-d030-40d4-ba7e-3cb028cacb85.45958ca1-0858-42f7-9002-36ecaceadb38.84405685-1ffe-4d1d-9782-069079dc8d28.png","licenseUrl":"https://visio.officeapps.live.com/va/resources/licenseterms.html","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":1,"AUP":54042}},{"displayName":"XL-Connector 365","solutionId":"wa104382023","version":"2.0.0.1","targetType":1,"width":0,"height":0,"description":"Salesforce connector for Microsoft Office Online and Microsoft Office for Mac","iconUrl":"22105.87e56e91-0218-41b6-baf7-cd6d66ed7064.2132bae0-8ca0-4c27-ba4c-949cf6364791.f1ed243e-17f7-41ff-b99a-341d95cc8088.gif","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.xappex.com/docs/xl-connector-365-docs/xl-connector-365-privacy-policy","addinInfo":{"priority":3,"AUP":699}},{"displayName":"Analytic Solver","solutionId":"wa200000018","version":"23.1.0.0","targetType":1,"width":0,"height":0,"description":"Analyze risk, find the best way to allocate resources using Monte Carlo Simulation and Optimization","iconUrl":"13898.dda126ef-5dd2-44ef-b6bc-a6cb0309f3a1.5b43104b-37e9-4650-8c16-71e032e6cb7d.e1dd0809-9020-4553-ba59-1479f07f4705.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683093/Asset_5ef7a7a3-cb57-4c16-8fe4-6032d115bc04/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":2,"AUP":1898}},{"displayName":"Analytic Solver Data Mining","solutionId":"wa200000019","version":"23.1.0.0","targetType":1,"width":0,"height":0,"description":"Forecast the future, train and deploy predictive models using Data/Text Mining and Machine Learning","iconUrl":"34090.1ece6668-5136-4cbf-8b60-e7747688efc8.cfabfded-2a53-4b39-9eda-001adba2da25.c6775c6d-8ebd-4525-90d6-1304a00887d8.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683094/Asset_8b514640-453a-4c63-9e63-d0c3f2b29f37/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":-1,"AUP":851}},{"displayName":"SAP Analytics Cloud for Office","solutionId":"wa200000169","version":"1.15.0.0","targetType":1,"width":0,"height":0,"description":"Use Microsoft Excel\u00e2\u20ac\u2122s strengths to get deeper insights into your SAP Analytics Cloud data.","iconUrl":"22967.ffbd93af-2e67-49da-bff8-62f9e5029e69.9930b4d4-9fd9-4eac-8578-8c77ca3d7e15.3a9c2449-9616-45b4-83e5-2f8360c19338.png","licenseUrl":"https://hcs.cloud.sap/office/eula.html","privacyUrl":"https://www.sap.com/about/legal/privacy.html","addinInfo":{"priority":3,"AUP":2986}},{"displayName":"iServer365 Import Tool","solutionId":"wa200000421","version":"2.1.4.7","targetType":1,"width":0,"height":0,"description":"Import data from Excel Workbooks to your iServer365 Repository","iconUrl":"31253.df1e5367-d9bc-46a7-8259-9b24225f294e.24914354-af15-4aa0-8ead-1c9d3e44a16d.8c184953-6f7c-4728-add7-e9aa9aa1c7a1.png","licenseUrl":"https://www.orbussoftware.com/orbus-store-app-terms","privacyUrl":"https://www.orbussoftware.com/privacy-policy","addinInfo":{"priority":3,"AUP":359}},{"displayName":"Jira Cloud for Excel","solutionId":"wa200000556","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Export Jira data to Excel - Combine the power of Jira with the flexibility of Excel","iconUrl":"56884.e2ba98e8-580f-430a-a0f6-2d54d53d7762.fb12baec-4bec-40e4-8dfc-21c060e87964.7ef37c2b-d095-4918-89f1-25637b11e385.png","licenseUrl":"https://www.microsoft.com/en-us/store/standard-application-license-terms","privacyUrl":"https://www.atlassian.com/legal/privacy-policy","addinInfo":{"priority":3,"AUP":144554}},{"displayName":"Refinitiv Add-in","solutionId":"wa200000565","version":"1.0.0.58","targetType":1,"width":0,"height":0,"description":"Build your models in Excel using Refinitiv\u00e2\u20ac\u2122s unique content and analytics","iconUrl":"22646.a3a6e343-b9d7-46ab-aad8-c0fc34c7b498.395fe483-7a9c-4c7f-ae27-4082290d2ccf.2a4f9940-98cd-460a-a422-d954187c3909.png","licenseUrl":"https://download.microsoft.com/download/F/D/8/FD8BA8F2-72AF-45D9-B39E-230B26CBD39D/StandardContractMarch2019.pdf","privacyUrl":"https://www.refinitiv.com/en/policies/privacy-statement","addinInfo":{"priority":-1,"AUP":516}},{"displayName":"AI-aided Formula Editor","solutionId":"wa200001584","version":"2.6.0.0","targetType":1,"width":0,"height":0,"description":"GPT-4-powered AI features like formula generation and explanation built-in a modern Formula Editor.","iconUrl":"65260.49589048-b9b0-4c4d-9166-9853dbc8d0d0.00f729b3-2b4d-4d96-a381-52c6e940cf4e.1e8d39fe-6248-4e13-b4cc-1e61e02c196d.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.10studio.tech/privacy","addinInfo":{"priority":1,"AUP":1938}},{"displayName":"Jasperactive for Office","solutionId":"wa200002334","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Web-based learning for Microsoft Word, Microsoft Excel and for Microsoft PowerPoint.","iconUrl":"24398.0a1bdc08-ac9f-4231-8e69-4eb02a692937.a4408ec1-bba8-4f97-961d-09257a62e38a.0013100a-0ba3-4b30-b729-14bf64da59dc.png","licenseUrl":"https://jasperactive.com/end-user-license-agreement","privacyUrl":"https://jasperactive.com/privacy-policy","addinInfo":{"priority":3,"AUP":1073}},{"displayName":"XLSTAT Cloud","solutionId":"wa200002503","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Statistics and data analysis add-in.","iconUrl":"49744.000d2e73-975d-42e3-8f0f-ca360dc2cc60.8a9d0e1f-183b-4ab0-b765-b64f7b230131.6ebabbd6-be54-4fd5-8e89-3e07680d70ba.png","licenseUrl":"https://xlstat365.s3.us-east-2.amazonaws.com/legal/CLUF.pdf","privacyUrl":"https://xlstat365.s3.us-east-2.amazonaws.com/legal/PRIVACY_POLICY.pdf","addinInfo":{"priority":1,"AUP":487}},{"displayName":"PitchBook for Excel","solutionId":"wa200002663","version":"1.6.0.0","targetType":1,"width":0,"height":0,"description":"Strengthen your analysis and build better financial models using PitchBook\u00e2\u20ac\u2122s data.","iconUrl":"50447.f729f52c-6484-4a27-9fd9-9a62d0ad734b.8b8a588c-46ce-4201-bddc-3d6086c7d7f2.3d88619d-29d6-49b5-a2ba-33bb2a724d32.png","licenseUrl":"https://pitchbook.com/terms-of-use","privacyUrl":"https://pitchbook.com/privacy-policy","addinInfo":{"priority":-1,"AUP":996}},{"displayName":"FRED Data","solutionId":"wa200003692","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"Download data from the Federal Reserve Bank of St. Louis Economic Data (FRED).","iconUrl":"51797.9b2b8182-033d-4060-9ca5-866292d44261.be4b3e57-cbb1-436a-98af-42040dca76d3.1d354664-b22f-4494-a818-f28e5304fc35.png","licenseUrl":"https://fred.stlouisfed.org/fred-addin/legal.html","privacyUrl":"https://research.stlouisfed.org/privacy.html","addinInfo":{"priority":1,"AUP":324}},{"displayName":"Advanced formula environment, a Microsoft Garage project","solutionId":"wa200003696","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Create, edit, and reuse formulas.","iconUrl":"42604.70ef3bb6-fd4c-4868-b560-ed816d7473dd.f2947730-eef9-434b-a86d-fa6e3bafe076.525d558d-aea8-4a78-89dd-576bcceda686.png","licenseUrl":"https://support.office.com/client/61994a3b-2c87-41c4-a88d-a6455efa362d?omkt=en-US","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":3,"AUP":1616}},{"displayName":"Spreadsheet Sync","solutionId":"wa200003784","version":"1.2.0.1","targetType":1,"width":0,"height":0,"description":"It syncs your QBO Adv data directly with Excel, enabling businesses to build customized reports ","iconUrl":"19754.85145a97-15c6-4376-9196-8515ee6dfda2.17b17ce3-53d9-4050-b1a9-cd8f6d333853.43963bbc-6904-4da7-8514-7b2e0bb7b291.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.intuit.com/privacy","addinInfo":{"priority":3,"AUP":798}},{"displayName":"ArcGIS for Excel","solutionId":"wa200004179","version":"2022.3.6.0","targetType":1,"width":0,"height":0,"description":"Discover new patterns and bring Excel data to life with maps using ArcGIS.","iconUrl":"14874.7ac80e32-4af3-4961-b3a6-2e871982b721.910edbf9-9d95-4224-a14c-7935fbbf3263.64da2c2e-9f1d-4b19-9264-dfe092cbe3eb.png","licenseUrl":"https://www.esri.com/en-us/legal/terms/master-agreement-product","privacyUrl":"https://www.esri.com/en-us/privacy/privacy-statements/privacy-statement","addinInfo":{"priority":3,"AUP":1340}},{"displayName":"Cegid Expert Connector for Excel","solutionId":"wa200004571","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Application apportant des fonctions personnalis\u00c3\u00a9es pour exporter des donn\u00c3\u00a9es de Cegid Expert.","iconUrl":"10618.583afe98-a839-46f6-a732-dbbf9ac8ac05.b4296dcd-6aea-4fb5-9e1d-d2a88879c875.ee35bc13-726a-4c70-8c82-dd0e375097d6.png","licenseUrl":"https://www.cegid.com/fr/cgv","privacyUrl":"https://www.cegid.com/fr/privacy-policy","addinInfo":{"priority":-1,"AUP":955}},{"displayName":"QR Code Tracker","solutionId":"wa200004687","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"QR Code Tracker lets you easily generate/scan QR codes in a sheet.","iconUrl":"35614.d62fd4d2-7872-42e1-a0c2-405317558142.c8500959-825f-4100-b3e6-c21597165a0b.f5cfa5f9-1345-4020-805c-d8345f029ae2.png","licenseUrl":"https://www.formiraex.com/QR_Code_Tracker/license.html","privacyUrl":"https://www.formiraex.com/QR_Code_Tracker/privacy-policy.html","addinInfo":{"priority":3,"AUP":340}},{"displayName":"Zebra BI Charts for Office","solutionId":"wa200004688","version":"1.0.4.0","targetType":0,"width":1000,"height":500,"description":"The most powerful charting visual in Excel & PowerPoint with a complete set of advanced charts! ","iconUrl":"9365.95df6186-f63a-4f9b-8cd5-414e80da57c8.ef9390f9-280b-4847-b1c6-c6fa272d852c.33527d56-43f3-4e84-bfe0-2bb6d2c2594d.png","licenseUrl":"https://zebrabi.com/legal/?doc=eula","privacyUrl":"https://zebrabi.com/legal/?doc=privacy-policy-visuals","addinInfo":{"priority":1,"AUP":1297}},{"displayName":"Flow | Your instant translator for the enterprise","solutionId":"wa200004858","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Access on-brand translations with Flow all across the internet","iconUrl":"21223.73dc3f42-d93e-46d2-ac41-21e4e22f1e9d.9e6a4242-8ef5-4d96-8f3e-e8dd4eebf01b.ea39d408-2aa7-45a1-bab6-3adbaca33d44.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.lengoo.com/privacy-policy","addinInfo":{"priority":-1,"AUP":58}},{"displayName":"Formula Bot | AI Formula Generation and Data Automation","solutionId":"wa200004935","version":"6.0.0.0","targetType":1,"width":0,"height":0,"description":"Revolutionize your analytics workflow, from formula generation to data automation.","iconUrl":"55472.02bef729-7dee-4518-80a6-f1201acff812.93152da9-df92-4449-86fb-7b5555756176.fa00d9a4-0225-4c45-a649-c70f05461582.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://formulabot.com/privacy-policy","addinInfo":{"priority":1,"AUP":4975}},{"displayName":"Ghostwriter","solutionId":"wa200005107","version":"1.0.0.5","targetType":1,"width":0,"height":0,"description":"Introducing Ghostwriter OpenAI GPT-3 for Microsoft Office \u00e2\u20ac\u201c the revolutionary writing assistant ","iconUrl":"8283.9a73910f-bc07-461c-a5aa-da58e2ce898e.24d0d825-2d57-4a56-9377-9087d459417f.b690bd3b-df98-4bef-bfc3-14135f3786f8.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://creativedatastudios.com/privacypolicy.html","addinInfo":{"priority":-1,"AUP":402}},{"displayName":"Sage Reporting 365","solutionId":"wa200005246","iconUrl":"40546.f88bb9d8-63aa-45c5-9857-bba65a51e0dd.6bd00930-2608-40f8-b6b9-6b9b7660abf7.8c645fcb-d1e3-4b8d-82a5-cea0150a26a3.png","targetType":1,"width":0,"height":0,"description":"Sage Reporting 365 is a Business Intelligence software providing access to your management data","version":"1.0.0.3","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://blog.infineo.online/privacy","addinInfo":{"priority":3,"AUP":41}},{"displayName":"ChatGPT for Excel","solutionId":"wa200005271","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Unlock the power of Excel with ChatGPT intelligence.","iconUrl":"55257.86bed75f-2814-457c-b505-403f890ae109.bd03c17e-334d-4b64-b573-33cf7a68a966.65bd7d1b-46c0-4876-a3a5-d2b84c95918d.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://chatgptforexcel.com/privacy-policy","addinInfo":{"priority":1,"AUP":9879}},{"displayName":"Numerous.ai","solutionId":"wa200005281","iconUrl":"19340.b57a7be8-416b-490a-9c58-b5567322666d.bc5fbf37-4907-473d-826c-150e0ae698aa.35f4cdd6-af50-49e7-8607-efcddc63f117.png","targetType":1,"width":0,"height":0,"description":"Use AI to generate formulas, categorize items, format cells, and perform repetitive tasks.","version":"1.0.0.0","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://numerous.ai/privacy.html","addinInfo":{"priority":1,"AUP":555}},{"displayName":"FormulAI","solutionId":"wa200005333","version":"1.0.0.2","targetType":1,"width":0,"height":0,"description":"FormulAI is a powerful Microsoft Excel formula assistant using AI.","iconUrl":"18944.a414168a-5468-4d7d-905c-6a9ff954a4a8.ad819f3c-11ba-4124-975b-22d1d3b278cc.d82fb89a-dcbe-49d9-9013-de1b3221d003.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.formulai.xyz/privacy-policy","addinInfo":{"priority":1,"AUP":123}},{"displayName":"ChatGPT for Excel Word","solutionId":"wa200005502","version":"1.0.0.9","targetType":1,"width":0,"height":0,"description":"Use GPT AI in Excel and Word to edit, translate, explain, ask, classify, extract, summarize.","iconUrl":"57573.f9f47c4a-38c2-4ed8-b7cc-a8815cd3dcd0.c5bed181-b36c-4c88-b989-056784b5402d.c22af8d2-689f-4982-b9e1-80b025140566.png","licenseUrl":"https://static.talarian.io/gpt-in-excel/GPT_in_Excel_TOS.pdf","privacyUrl":"https://talarian.io/privacy-policy","addinInfo":{"priority":1,"AUP":25712}},{"displayName":"Supermetrics","solutionId":"WA104381807","version":"1.0.0.5","targetType":1,"width":0,"height":0,"description":"Automated Marketing Reporting directly in Excel","iconUrl":"33799.bb8cdc30-0a91-4002-884a-b62395c980a4.fb613201-2a43-4b0f-b068-5360656b0104.5abf29b1-cf19-4ab8-a383-2fd3c3322a82.png","licenseUrl":"https://supermetrics.com/terms-of-service","privacyUrl":"https://supermetrics.com/privacy-policy","addinInfo":{"priority":3,"AUP":359}},{"displayName":"Business Assist - Forecast","solutionId":"WA200005702","version":"1.0.0.4","targetType":1,"width":0,"height":0,"description":"Reduce your organization\u00e2\u20ac\u2122s helpdesk cost by using Business Assist Forecast.","iconUrl":"14472.f9e7cd0c-b0a1-46c9-8121-703e461934bb.9bb6db57-0f7e-4365-83e3-c71dfb411640.49c33548-12d6-4184-a39c-04b1918d113e.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":3,"AUP":78}},{"displayName":"Autopilot","solutionId":"WA200005669","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Bring OpenAI technologies into your apps with Autopilot that has integrated ChatGPT.","iconUrl":"12203.36723807-bf6b-458b-85d4-c6c068296f33.807070a8-ca50-4721-a811-d6bb38b70be3.3aaef1c4-2963-4d9e-aab0-905e58073e52.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://ghostwriter-ai.com/privacypolicy.html","addinInfo":{"priority":3,"AUP":586}},{"displayName":"Compare and Merge for Excel","solutionId":"WA200005782","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Compare Excel data within minutes. Find and resolve differences. Save hours of manual data review.","iconUrl":"30074.934ac94e-6eb5-42e9-bd61-d950303e2383.64b35664-874b-4eea-a5c5-22b9b1dfa6fd.d9552652-5a80-4f6b-b7dc-254b48fbb5ff.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.strivetech.com/apps/excelcompareandmergeprivacy","addinInfo":{"priority":3,"AUP":135}},{"displayName":"Array Assistant","solutionId":"WA200005565","version":"1.0.1.0","targetType":1,"width":0,"height":0,"description":"Your AI Excel Assistant, Helping You Work Smarter and Faster! Try your first two weeks for Free!","iconUrl":"19248.dfd99dce-ae19-48c0-89aa-3654a01080ce.5d15e809-f4e4-42e1-813f-8235aab23209.6bb22ab5-ef1d-4810-8ad3-b0ac5496fc4e.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://arrayassistant.ai/legal","addinInfo":{"priority":3,"AUP":100}},{"displayName":"Webex","solutionId":"WA200000068","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Bring Webex messaging and collaboration to your Microsoft files.","iconUrl":"39598.b4ad1d22-0361-475d-8552-534f8374babf.520bf26d-4b81-43fa-ac63-415826cb02fb.11a6abf0-7171-48ff-8c69-26b9e338033f.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474848812/Product_42949683051/Asset_46d15f2a-cf03-461d-bd9f-9633d61422c9/universalcloudagreement.pdf","privacyUrl":"https://www.cisco.com/c/en/us/about/legal/privacy-full.html","addinInfo":{"priority":3,"AUP":192}},{"displayName":"draw.io Diagrams","solutionId":"WA200000113","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Easily embed draw.io diagrams from cloud storage","iconUrl":"14142.2ec57164-ba5b-42ee-8253-ade72ca74c8d.e8efbcc8-e27f-4682-9321-eb111eb3bc68.950e1c22-0dd9-4079-807b-145ecdb6df9c.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474849055/Product_42949683254/Asset_f99133a0-53c0-4c21-905f-757b27070c6a/drawioEULATermsofServicedrawio.pdf","privacyUrl":"https://desk.draw.io/support/solutions/articles/16000096192-privacy-policy-for-draw-io-add-in-for-microsoft-office","addinInfo":{"priority":1,"AUP":797}},{"displayName":"Personalised QR Code Generator","solutionId":"WA200003220","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Quickly generate personalised, branded QR codes.","iconUrl":"1053.89a21dfa-3fde-4c6f-89e4-3eae439d83e7.67539e4a-131a-406f-a541-73c85a95eb0f.7a449688-1bb3-4511-9f43-2cc1a09edc9b.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://littleappy.co/office/qr-code-generator/privacy","addinInfo":{"priority":3,"AUP":156}},{"displayName":"Microsoft PowerApps Office Add-in","solutionId":"WA104380330","version":"1.3.0.1","targetType":1,"width":0,"height":0,"description":"The Microsoft PowerApps Office Add-in enables data connections to Microsoft PowerApps systems","iconUrl":"60124.e1dfe8b1-6892-4a07-bb52-91fc1006be11.a6787a94-2200-4943-9d6a-f9efb8369662.47ff6184-6b13-4120-955b-1c285e83cbc7.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949679879/Asset_661a2a7f-2764-43c5-aef4-25bc316a1b08/DynamicsAppforOfficeSLTEnglish.pdf","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=271135","addinInfo":{"priority":2,"AUP":1249}},{"displayName":"Wikipedia","solutionId":"WA104099688","version":"1.7.0.0","targetType":1,"width":0,"height":0,"description":"Find and quote related information from Wikipedia.","iconUrl":"7450.110c9a11-7db2-4228-b768-f1ad828e16be.9bd16ea2-22ff-455c-9f92-70de827e079a.aeef7210-898b-4a79-82b5-b648805129b9.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":3,"AUP":332}},{"displayName":"Bing Maps","solutionId":"WA102957661","version":"1.6.0.0","targetType":0,"width":600,"height":600,"description":"The Bing Maps add-in makes it easy to plot locations and visualize your data through Bing Maps in Excel","iconUrl":"45.d6c30518-91f7-4e79-b846-0813b56a1b2d.75cc16b5-7155-4a84-8094-a4ae7e997116.688fcadb-9dca-414b-91d4-2075b00c2772.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":3,"AUP":13556}},{"displayName":"ChartExpo\u00e2\u201e\u00a2 for Excel","solutionId":"WA104380662","version":"1.0.0.7","targetType":0,"width":655,"height":390,"description":"Select a chart, select your data, and create Insightful charts without hardwork!","iconUrl":"47793.590471af-7e3e-4855-8e7f-1438a654488b.5e466c13-5861-4e47-bf0e-d6a735f06208.7800aa4f-c6b6-43bb-8099-c14624743abc.png","licenseUrl":"https://www.chartexpo.com/Home/EULA","privacyUrl":"https://www.chartexpo.com/Home/OfficeAppPrivacy","addinInfo":{"priority":-1,"AUP":697}},{"displayName":"CSV Import+Export","solutionId":"WA200000025","version":"1.0.0","targetType":1,"width":0,"height":0,"description":"Import and export CSV files on Excel.","iconUrl":"58575.082549a1-a61c-4d6a-b397-1281a6b2818d.f4f41bd6-d825-4219-af6e-da610c4a7324.1b9d835d-23bf-45b0-818d-783bef621094.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.emeditor.com/about/privacy-policy","addinInfo":{"priority":3,"AUP":858}},{"displayName":"Money in Excel","solutionId":"WA200001306","version":"2.3.0.1","targetType":1,"width":0,"height":0,"description":"Seamlessly connect your financial accounts to Excel to view and manage your finances in one place.","iconUrl":"9427.a6eaa8f8-8441-4e98-b51b-7cdc68b3ad70.1e0bd518-ace3-4c76-a4e1-5bec9f355e89.eb2dcf06-11b7-4c0c-873b-df18bf95b4fa.png","licenseUrl":"https://officepreview.microsoft.com/en-us/office-store-standard-application-license-terms-HA102821243.asp","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":-1,"AUP":0}},{"displayName":"Isograd Learning Platform","solutionId":"WA200006017","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Isograd Learning Platform is an online courseware solution for Microsoft 2019 and Microsoft 365.","iconUrl":"6539.d4a08e78-43e8-4bd4-823f-8b9bb98f71c8.358fe9da-edf0-4bd2-8f23-eabe1b2de609.79a5fd12-e871-4f4b-ad2d-e3265cff3b2c.png","licenseUrl":"https://learning.isograd.com/eula","privacyUrl":"https://learning.isograd.com/privacypolicy","addinInfo":{"priority":3,"AUP":10}},{"displayName":"Bracket Builder","solutionId":"WA200006008","version":"1.2.0.0","targetType":1,"width":0,"height":0,"description":"Build double elimination tournament brackets compatible with Little League","iconUrl":"50028.22f4f90a-426f-475a-beba-d0189799b8bd.7f3ed4ca-2f1a-436c-9839-dd7764195b7f.db54fea0-fdaf-44f7-a816-41361b822660.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://addin.red.traynrex.com/help/Privacy.html","addinInfo":{"priority":3,"AUP":3}},{"displayName":"Excel Send to Trello","solutionId":"WA200005960","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"This Excel add-in makes it easy to bulk create cards in Trello from a table.","iconUrl":"8664.52ca8fd6-95d6-47e7-b679-b9f888571bc7.5efe9dcf-a87f-4171-ac66-cb9c30b5226e.5d8ecce4-7fc8-49dd-87fd-07095c48deac.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://kryl.com/?page=/privacy","addinInfo":{"priority":3,"AUP":3}},{"displayName":"XperienceED","solutionId":"WA200005817","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Web-based, hands-on learning for Microsoft 365 Apps and Microsoft 2019.","iconUrl":"6120.0e948c8b-c5cf-4b7a-b18f-3d59a7105ce2.fcdc57d0-ecf7-430c-94c1-9742dc8a097c.af83a49b-bd1c-43a3-bf7d-9c061ec545c8.png","licenseUrl":"https://ccilearning.com/wp-content/uploads/2023/03/XperienceED-EULA-August-14-2022_clear.docx","privacyUrl":"https://jasperactive.com/privacy-policy","addinInfo":{"priority":3,"AUP":7}},{"displayName":"Green Street Add-In","solutionId":"WA200005876","version":"1.0.4.24","targetType":1,"width":0,"height":0,"description":"Enhance your investment analyses with Green Street\'s industry leading commercial real estate data ","iconUrl":"49943.bc2d4344-5f24-4610-b662-91c4934d717d.590cce90-117c-42db-baa3-83d5d7daa95f.c83b6cf7-1070-4e11-896f-53331b434c3e.png","licenseUrl":"https://www.greenstreet.com/termsofuse","privacyUrl":"https://files.greenstreet.com/public_files/GlobalPrivacyPolicy.pdf","addinInfo":{"priority":-1,"AUP":0}},{"displayName":"R2 Copilot for Excel","solutionId":"WA200006007","version":"1.0.4.0","targetType":1,"width":0,"height":0,"description":"R2 Copilot is a privacy-centric, GPT-powered AI assistant for your everyday business communications.","iconUrl":"56225.35fd77ec-1e64-4d91-b540-7e993a97b899.736533f6-6174-46c6-9736-9d0074bc04cb.93461044-7ae6-496e-abfb-17b484279f77.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://r2copilot.ai/policy","addinInfo":{"priority":2,"AUP":252}},{"displayName":"Spreadsheet AI","solutionId":"WA200006009","version":"1.0.1.6","targetType":1,"width":0,"height":0,"description":"AI chat copilot in Excel who understands your workbook and assists with countless spreadsheet tasks.","iconUrl":"14669.7db070f8-5e86-4224-b93c-0f0447636b16.132765a9-fdd4-41f1-9c90-aa6f0d6b82dc.45c767b9-81c9-4813-a7d1-462156cc844b.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.10studio.tech/docs/privacy","addinInfo":{"priority":2,"AUP":76}},{"displayName":"Widata","solutionId":"WA200005777","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"WiData is a platform seamlessly integrated into Excel to assist you in accessing all financial data","iconUrl":"42486.cf83fc97-7cc4-4fc9-a442-27252297bd9d.a3b30b83-17e9-41ef-88f3-72c47dfaee63.4eb440c2-941b-4d85-bc6f-a0c115f258ab.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.widata.vn/en/ch%C3%ADnh-s%C3%A1ch-b%E1%BA%A3o-m%E1%BA%ADt","addinInfo":{"priority":3,"AUP":25}},{"displayName":"McGraw Hill","solutionId":"WA200002270","version":"3.0.0.0","targetType":1,"width":0,"height":0,"description":"McGraw Hill tool application aimed to assist students to learn and leverage Microsoft Excel.","iconUrl":"10994.a2611ae6-e1fb-468e-9a75-4292ffd45f92.3e087ea2-0e00-40c2-9e26-d5c264f97fae.ffc523c3-0e09-439c-9422-af52e0770aff.png","licenseUrl":"https://www.mheducation.com/terms-use.html?external_browser=2","privacyUrl":"https://www.mheducation.com/privacy.html?external_browser=2","addinInfo":{"priority":-1,"AUP":176861}},{"displayName":"Web Video Player","solutionId":"WA104221182","version":"3.3.0.0","targetType":0,"width":730,"height":411,"description":"Add YouTube videos to your PowerPoint presentations or Excel spreadsheets.","iconUrl":"21223.8fa8e2cf-70f0-4b35-ab45-a587c415721d.71d26e67-e3a5-4499-af2a-87e1ada53aca.91b974c8-435a-45c4-bbc7-167fa1d34ffb.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.michael-saunders.com/videoplayer/pages/privacy.html","addinInfo":{"priority":1,"AUP":294}},{"displayName":"AP Essentials Online Reports","solutionId":"WA200004805","version":"1.2.0.0","targetType":1,"width":0,"height":0,"description":"Easily generate Excel reports of your AP Essentials documents.","iconUrl":"46463.4f2ef016-20cb-4469-89c8-91b3ed852e94.bc9b4ced-e86a-461d-bf3e-ea85bc5923db.3fc71624-1087-40f3-bdbf-d437b17759cb.png","licenseUrl":"https://www.kofax.com/legal/terms-of-service","privacyUrl":"https://www.kofax.com/Legal/Privacy","addinInfo":{"priority":-1,"AUP":225}},{"displayName":"Velixo","solutionId":"WA200002311","version":"1.2023.8.64","targetType":1,"width":0,"height":0,"description":"Excel-based reporting for your ERP. Build your own reports in less than 5 minutes!","iconUrl":"56800.9a67df19-bebd-46e1-932f-c05f1da5d162.aded0159-fc94-4c0e-922c-a61decdb9403.0ad5536a-3258-403d-8f0a-adb854889d11.png","licenseUrl":"https://www.velixo.com/eula","privacyUrl":"https://www.velixo.com/privacy-policy","addinInfo":{"priority":2,"AUP":880}},{"displayName":"Mail Merge","solutionId":"WA200006466","version":"1.0.0.2","targetType":1,"width":0,"height":0,"description":"Send personalized emails with Excel, create email drafts or schedule emails for sending later.","iconUrl":"6987.7e407018-9102-4508-a2e9-e769a41b7735.b8d24346-5fb6-49bf-b22b-7baa15ddcad8.847e5579-8358-4333-a405-47191f54a8c1.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://digitalinspiration.com/privacy","addinInfo":{"priority":2,"AUP":18}}]'}static get N3j(){return'[{"displayName":"Stock Connector","solutionId":"wa104379220","version":"8.0.0.0","targetType":1,"width":0,"height":0,"description":"Link stocks, currency, & crypto prices to cells in Excel spreadsheets and update them in real time.","iconUrl":"35421.d104d786-d979-48bb-9827-1b28ac5178cf.c0696ae0-87b8-4c16-ab8c-171be18ca0a9.8dcfdc9c-2863-4fa9-905d-84ff8534af7a.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://michael-saunders.com/stocksapp/pages/privacy.html","addinInfo":{"priority":1,"AUP":1710}},{"displayName":"ChatGPT for Excel","solutionId":"wa200005271","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Unlock the power of Excel with ChatGPT intelligence.","iconUrl":"55257.86bed75f-2814-457c-b505-403f890ae109.bd03c17e-334d-4b64-b573-33cf7a68a966.65bd7d1b-46c0-4876-a3a5-d2b84c95918d.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://chatgptforexcel.com/privacy-policy","addinInfo":{"priority":1,"AUP":1541}}]'}get O3j(){return l.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PopularAddinDetailsForTestEnabled",
!1)}get C7e(){return"Dev Box"===l.AFrameworkApplication.fa.Xa("StatusBarEnvironmentNameToUse")}get kfk(){return l.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RegisterPopulateCommandRefactorEnabled",!1)}lii(Ca){window.setTimeout(()=>{this.hri()},Ca)}hri(){this.U4c?f.ULS.sendTraceTag(508826715,220,50,"The 1st attempt succeeded."):(f.ULS.sendTraceTag(508826716,220,15,"the 1st attempt was timeout, trigger another try."),this.YF(0,!0))}static h1a(Ca){return 0===Ca||10===
Ca}Usb(Ca,yb){this.iUa&&this.iUa.Usb(Ca,yb)}YF(Ca,yb){this.iUa&&(!this.U4c&&Qe.h1a(Ca)&&(this.U4c=!0),this.iUa.YF(Ca,yb))}LRc(Ca){this.iUa&&this.iUa.Tza(Ca)}CFh(Ca,yb){return F.a.lm().equals(Ca.solutionId,yb.solutionId)&&F.a.lm().equals(Ca.storeType,yb.storeType)}Bce(Ca,yb){if(l.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType"))this.rvg(Ca,yb,OSF.StoreTypeEnum.MarketPlace);else{const wc={};wc.callbackFunc=Ca;wc.storeType=OSF.StoreTypeEnum.MarketPlace;
wc.fromInsertDialog=!1;wc.refresh=yb;this.jr.queryEntitlementDetails(wc)}}rvg(Ca,yb,wc){const dd={};dd.callbackFunc=Ca;dd.storeType=wc;dd.fromInsertDialog=!1;dd.refresh=yb;this.jr.queryEntitlementDetails(dd)}invokeDdaMethod(Ca,yb){const wc=this.Er(Ca.DdaMethod.ControlId);if(wc){if(this.ZRd&&this.lZ){const dd=this.twa(Ca.DdaMethod.ControlId);Ca.DdaMethod.ControlId=dd}wc.invokeDdaMethod(Ca,yb)}else this.Rn(na.a.internalError,yb)}registerDdaEventAsync(Ca,yb,wc,dd,vd){(yb=this.Er(yb))?Qe.dUb(Ca)?yb.Zdk(Ca,
wc,dd,vd):this.Rn(na.a.I9d,vd):this.Rn(na.a.internalError,vd)}unregisterDdaEventAsync(Ca,yb,wc,dd,vd){(yb=this.Er(yb))?Qe.dUb(Ca)?yb.J1k(Ca,wc,dd,vd):this.Rn(na.a.I9d,vd):this.Rn(na.a.internalError,vd)}dispose(){if(!this.disposed){this.$.Pr(this.xj);this.ea.bik(this.lMc);this.ea.pq(this.Oi);this.ea.wP(this.Dt);this.ea.pA(this.ol);this.$nd.detach(this);this.$.userOperationManager.Hv(this.c1);const Ca=ya.f(this.$);null===Ca||void 0===Ca?void 0:Ca.za.Fy(this.onBlockCacheItemChanged);this.SOc=this.pl=
this.yn=this.$nd=this.fh=null;this.pXa&&(this.pXa.dispose(),this.pXa=null);Wb.a.Ng(this.sje);Wb.a.Ng(this.rje);this.Ggb&&(this.Ggb.dispose(),this.Ggb=null);super.dispose();this.disposed=!0;f.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed")}}AId(Ca){return(Ca=this.Er(Ca))?Ca.getDefaultIconUrl():null}cWc(Ca){if(this.qjf!==Ca){this.qjf=Ca;for(let yb=0,wc=this.pl.length;yb<wc;yb++){const dd=this.pl[yb];Ca?dd.Wlf(!1):dd.Mgi()}this.sje.cWc(Ca);this.rje.cWc(Ca)}}pHi(Ca){return(Ca=this.Er(Ca))?Ca.getDefaultDisplayName():
null}Rn(Ca,yb,wc){const dd={};dd[Gb.a.Wk]=Ca;dd[Gb.a.Vea]=yb;this.xU(451041795,dd,void 0===wc?!0:wc)}cE(Ca){const yb={};yb[Gb.a.Vea]=Ca;this.xU(1237877382,yb)}xU(Ca,yb,wc){wc=void 0===wc?!0:wc;const dd=new xd.a(Ca,0,this.$.Rh,0,null),vd=yb?yb[Gb.a.Vea]:null;this.Ggb&&ya.f(this.$).isEditing&&Xa.RVh(Ca,yb)?this.Ggb.W9h(Ca,yb):(Ca=this.$.Ma.dh(dd,yb),wc&&ec.TaskExtensions.Ua(Ca,Zd=>{Vb.a(Zd)?this.Rn(na.a.internalError,vd,!1):Zd.result||(ya.f(this.$).isEditing?this.Rn(na.a.eTb,vd,!1):this.Rn(na.a.internalError,
vd,!1))},this.xa,8))}uYh(Ca){return!!this.Kva(yb=>Qe.getSolutionId(yb.Nn,this.$)===Qe.getSolutionId(Ca,this.$)&&yb.Nn.PrimaryMarketplace.MarketplaceType===Ca.PrimaryMarketplace.MarketplaceType&&yb.Nn.PrimaryMarketplace.MarketplaceRef===Ca.PrimaryMarketplace.MarketplaceRef&&yb.Nn.PrimaryMarketplace.SolutionVersion===Ca.PrimaryMarketplace.SolutionVersion)}Er(Ca){return this.Kva(yb=>yb.controlId.startsWith(Ca))}ZNb(Ca){let yb=Ca;this.lZ&&(yb=this.L$(Ca));return this.Er(yb)}Nui(Ca){return this.Kva(yb=>
yb.UGa===Ca)}Mwf(Ca){return this.Kva(yb=>yb.lX===Ca&&!!yb.UGa)}Zwf(Ca,yb,wc,dd){return this.Kva(vd=>vd.lX===Ca&&vd.Nn.PrimaryMarketplace.MarketplaceRef.toLowerCase()===yb.toLowerCase()&&vd.Nn.PrimaryMarketplace.MarketplaceType.toLowerCase()===wc.toLowerCase()&&!!vd.Nn.SharedRuntime&&!!vd.Nn.SharedRuntime.Resid&&!!dd&&!!dd.Resid&&vd.Nn.SharedRuntime.Resid.toLowerCase()===dd.Resid.toLowerCase())}nGh(Ca,yb){if(Ca=this.Er(Ca))Ca.Aa(yb),Ca.showHide(!0)}PLk(Ca){(Ca=this.Er(Ca))&&Ca.showHide(!1)}vWa(Ca){var yb;
if(1!==Ca.WebExtensionType||this.$.wj&8388608&&Ca.TaskpaneVisible||this.$.wj&8388608&&!Ca.TaskpaneVisible&&Lb.HelperMethods.BF(Ca)){let wc=null;Lb.HelperMethods.BF(Ca)&&(wc=Qe.tIa(Ca,this.$),Ca.TaskpaneWidth||(Ca.TaskpaneWidth=this.MLb));const dd=(new id(this,this.yn,Ca,this.webExtensionView)).NQd();f.ULS.sendTraceTag(51263011,0,50,`DdaFacade::CreateOsfControl: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ca.PrimaryMarketplace.SolutionId,Ca.OwnerAddinStoreType||Ca.PrimaryMarketplace.MarketplaceType,
null===(yb=Ca.AssetMarketplace)||void 0===yb?void 0:yb.SolutionId,null,null,Ca.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${Ca.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${Lb.HelperMethods.BF(Ca)}`);wc&&(dd.UGa=wc);this.pl.push(dd);this.WKa=null;this.Hlb(Ca.InstanceId)||(Ca=String.format("{0}|{1}|{2}|{3}|{4}",Ca.PrimaryMarketplace.SolutionId,Ca.PrimaryMarketplace.SolutionVersion,Ca.PrimaryMarketplace.MarketplaceRef,Ca.PrimaryMarketplace.MarketplaceType,Ca.WebExtensionType),this.raiseEvent("ci",
Ca))}}PNk(Ca,yb){Ca.TaskpaneWidth=this.MLb;Ca.TaskpaneVisible=!0;const wc={};wc.SolutionId=Ca.PrimaryMarketplace.SolutionId;wc.TargetType=Ca.WebExtensionType;wc.Version=Ca.PrimaryMarketplace.SolutionVersion;wc.StoreType=Ca.PrimaryMarketplace.MarketplaceType;wc.StoreId=Ca.PrimaryMarketplace.MarketplaceRef;Ca.AssetMarketplace?(wc.AssetId=Ca.AssetMarketplace.SolutionId,wc.AssetStoreId=Ca.AssetMarketplace.MarketplaceRef):(wc.AssetId=null,wc.AssetStoreId=null);wc.Width=Ca.TaskpaneWidth;const dd=new id(this,
this.yn,Ca,this.webExtensionView,!0);dd.NQd();this.pl.push(dd);const vd=()=>{this.h5a(dd.controlId);this.wl.purgeOsfControl(dd.controlId,!1);yb()};let Zd=null;Zd=Zf.a.instance.jO(()=>{dd.TF&&(Wb.a.Ng(Zd),Zd=null,this.wl.insertBlankControlWithErrorUX(this.o1b(dd,wc),vd))},100,Rb.a.D8h)}Cwd(Ca){if(Ca&&Ca.length){var yb=[];Ca.forEach(wc=>{if(wc.ContainsCustomFunctions){const dd=Qe.tIa(wc,this.$);this.P$d.contains(dd)||(this.P$d.add(dd),this.qrg.push(wc));this.uYh(wc)||yb.push(wc)}});yb.length&&this.qgf(yb)}}zif(Ca,
yb){this.Er(Ca.InstanceId)||(yb=yb(),Ca=(new id(this,this.yn,Ca,this.webExtensionView)).nRf(yb),this.pl.push(Ca),this.WKa=null)}dLk(Ca){Qe.Bgb.Vg(Ca)&&Qe.Bgb.ma(Ca).initializeAndShowWithTitle()}s5i(Ca){Qe.Bgb.Vg(Ca)&&Qe.Bgb.ma(Ca).hide()}JPi(Ca){var yb=null;let wc=null;const dd=Qe.VMd(Ca,!0);if(!dd)return f.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),Uc.Task.Va(null);const vd=this.jr.getOsfControl(Qe.getSolutionId(dd,this.$));vd&&(yb=
vd.getManifest())&&(wc=yb.getSharedRuntimeForCustomFunctions("Workbook"));if(yb=wc&&1===wc.LifeTime?this.Zwf(dd.PrimaryMarketplace.SolutionId,dd.PrimaryMarketplace.MarketplaceRef,dd.PrimaryMarketplace.MarketplaceType,wc):this.Nui(Ca))return Uc.Task.Va(yb.controlId);const Zd=new Ib.a;Lb.HelperMethods.SHc(wc)&&(dd.SharedRuntime=wc);Ca=vd?vd.getNotificationParams():[];if(!Ca.length)return this.Xgf(dd);this.IQg(Ca,()=>{ec.TaskExtensions.Ua(Zd.task,()=>{this.Xgf(dd)},this.xa,3)},()=>{});return Zd.task}QBi(Ca){Ca=
Qe.VMd(Ca,!1);if(!Ca)return f.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),null;let yb=null;var wc=this.jr.getOsfControl(Qe.getSolutionId(Ca,this.$));wc&&(wc=wc.getManifest())&&(yb=wc.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));return Lb.HelperMethods.SHc(yb)&&(Ca=this.Zwf(Ca.PrimaryMarketplace.SolutionId,Ca.PrimaryMarketplace.MarketplaceRef,Ca.PrimaryMarketplace.MarketplaceType,yb))?Ca.controlId:null}$_h(Ca,yb){var wc=Qe.VMd(Ca,!1);if(wc){var dd=
null,vd=this.jr.getOsfControl(Qe.getSolutionId(wc,this.$));vd&&(vd=vd.getManifest())&&(dd=vd.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));if(Lb.HelperMethods.SHc(dd)){wc.SharedRuntime=dd;var Zd=wc.PrimaryMarketplace.SolutionId;vd=wc.PrimaryMarketplace.SolutionVersion;var Re=OSF.OsfManifestManager.getCachedManifest(Zd,vd);if(Re)if(this.Skc.Vg(Ca))dd=this.Skc.ma(Ca),ec.TaskExtensions.Ua(dd,xf=>{(xf=xf.result)&&OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(xf,yb,this.yn.S4b)},
this.xa,3);else{var ff={};ff.solutionId=Zd;ff.version=vd;ff.storeType=wc.PrimaryMarketplace.MarketplaceType;ff.storeId=wc.PrimaryMarketplace.MarketplaceRef;wc.AssetMarketplace?(ff.assetId=wc.AssetMarketplace.SolutionId,ff.assetStoreId=wc.AssetMarketplace.MarketplaceRef):(ff.assetId=null,ff.assetStoreId=null);ff.targetType=OSF.OsfControlTarget.TaskPane;var af=new Ib.a;wc=ec.TaskExtensions.sq();wc=new ob.a(this.$,this,ff,wc);dd=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(Zd,dd.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(Re,
dd,vd);wc.createUILessSandbox(ff,Re,(xf,eg)=>{xf&&!eg?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(xf,yb,this.yn.S4b),af.setResult(xf)):af.setResult(null);this.Skc.remove(Ca)});this.Skc.ga(Ca,af.task)}}}else f.ULS.sendTraceTag(537170568,0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")}Taf(Ca){(Ca=this.Mwf(Ca))&&(Ca.Nn.SharedRuntime||this.K2b(Ca.controlId))}K2b(Ca){(Ca=this.Mwf(Ca))&&this.h5a(Ca.controlId)}cdi(Ca,yb){if(!this.pl||!Ca||!yb)return!1;
if(Ca.toLowerCase()===yb.toLowerCase())return!0;let wc=null,dd=null;for(let vd=0,Zd=this.pl.length;vd<Zd;vd++){const Re=this.pl[vd];if(Re.ownerAddinSolutionId&&(Re.controlId===Ca&&(wc=Re.ownerAddinSolutionId.toLowerCase()),Re.controlId===yb&&(dd=Re.ownerAddinSolutionId.toLowerCase()),wc&&dd))break}return wc&&wc===dd?!0:!1}mvh(Ca){this.Er(Ca.InstanceId)||(Ca=new id(this,this.yn,Ca,this.webExtensionView),this.pl.push(Ca),this.WKa=null)}RAg(Ca){if(this.pl&&0<=Ca&&Ca<this.pl.length){const yb=this.pl[Ca],
wc=yb.TF;this.pl.splice(Ca,1);this.Qfg(yb);xb.DOMElementExtensions.Km(wc)}}h5a(Ca){if(this.pl)for(let yb=0,wc=this.pl.length;yb<wc;yb++)if(this.pl[yb].controlId===Ca){this.RAg(yb);break}}shk(Ca){if(this.pl){Ca=Ca.toLowerCase();for(let yb=0,wc=this.pl.length;yb<wc;yb++)if(Ca===this.pl[yb].ownerAddinSolutionId.toLowerCase()){this.RAg(yb);break}}}RGh(Ca){Ca.zv&&(this.Er(Ca.floatingObject.Nn.InstanceId)||(this.WDc(Ca.floatingObject.Nn.InstanceId)||this.SOc.push(Ca.floatingObject.Nn.InstanceId),this.vWa(Ca.floatingObject.Nn)),
this.ea.isNamedObjectViewMode&&this.nGh(Ca.floatingObject.Nn.InstanceId,Ca.Gj))}MEd(Ca){return null==this.pl?null:this.pl.find(yb=>1===yb.controlType&&cf.a.equals(yb.lX,Ca,!0))}R4(Ca){if(gb.EwaSettings.isChangeGateEnabled("OfficeVSO:7645729_ConsolidateFindOsfControlFromSolutionId"))return Ca=this.MEd(Ca),null===Ca||void 0===Ca?void 0:Ca.controlId;if(this.pl)for(let yb=0,wc=this.pl.length;yb<wc;yb++)if(1===this.pl[yb].controlType&&cf.a.equals(this.pl[yb].lX,Ca,!0))return this.pl[yb].controlId;return null}Npj(Ca){return(Ca=
this.MEd(Ca))?Ca.visible:!1}nui(Ca){const yb=[];if(this.pl)for(let wc=0,dd=this.pl.length;wc<dd;wc++)cf.a.equals(this.pl[wc].lX,Ca,!0)&&yb.push(this.pl[wc].controlId);return yb}Uui(Ca,yb){if(!yb||!Ca)return null;if(this.pl)for(let wc=0,dd=this.pl.length;wc<dd;wc++)if(1===this.pl[wc].controlType&&cf.a.equals(this.pl[wc].lX,Ca,!0)&&this.pl[wc].Nn.SharedRuntime&&cf.a.equals(this.pl[wc].Nn.SharedRuntime.Resid,yb.Resid,!0))return this.pl[wc].controlId;return null}pIa(Ca,yb){yb=void 0===yb?null:yb;return Ca?
yb?`${Ca}.${yb}`:Ca:""}Waf(Ca,yb,wc){if(this.WKa===Ca)return!0;this.WKa=Ca;let dd=null,vd=!1;if(!dd&&this.pl)for(let Zd=0,Re=this.pl.length;Zd<Re;Zd++)if(1===this.pl[Zd].controlType&&cf.a.equals(this.pl[Zd].lX,Ca,!0)){let ff=!1,af=!1;yb?(ff=!0,af=!!this.pl[Zd].Nn.SharedRuntime&&cf.a.equals(this.pl[Zd].Nn.SharedRuntime.Resid,yb.Resid,!0)):wc&&(ff=!0,af=cf.a.equals(this.pl[Zd].Nn.SharedRuntimeId,wc,!0));if(!ff||af){af&&this.pl[Zd].DE(!0);dd=this.pl[Zd].controlId;vd=!0;this.WKa=null;break}}dd&&this.raiseEvent("ca",
dd);return vd}setAppRuntimeState(Ca,yb){var wc;if(Ca){const dd=this.Er(Ca);if(dd&&Lb.HelperMethods.BF(dd.Nn))dd.DE(yb),yb&&(this.raiseEvent("ca",Ca),(null===(wc=dd.TF)||void 0===wc?0:wc.firstChild)&&(Ca=dd.TF.firstChild.title)&&0<Ca.length&&this.Idb.ywk(Ca));else throw f.ULS.sendTraceTag(537170565,0,50,"SetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(Nb.a.instance.ia(2250));}else throw f.ULS.sendTraceTag(537170564,0,15,"SetAppRuntimeState: Invalid controlId."),Error.invalidOperation(Nb.a.instance.ia(2251));
}getAppRuntimeState(Ca){if(Ca)if((Ca=this.Er(Ca))&&Lb.HelperMethods.BF(Ca.Nn))Ca=Ca.Nn.TaskpaneVisible;else throw f.ULS.sendTraceTag(537170563,0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(Nb.a.instance.ia(2250));else throw f.ULS.sendTraceTag(537170562,0,15,"GetAppRuntimeState: Invalid controlId."),Error.invalidOperation(Nb.a.instance.ia(2251));return Ca}tib(Ca,yb){return(Ca=this.Er(Ca))?Ca.tib(yb):null}Hlb(Ca){return this.Yaf(this.SOc,Ca)}WDc(Ca){return this.Yaf(this.kjf,
Ca)}GZe(Ca){this.kjf.push(Ca)}wX(Ca){return(Ca=this.Er(Ca))?Ca.Nn:null}g5d(Ca){this.raiseEvent("ekros",Ca,this)}Jog(Ca){if(Ca){var yb=this.Er(Ca.InstanceId);yb&&(Ca.SharedRuntime||Ca.SharedRuntimeId||(this.h5a(yb.controlId),this.wl.purgeOsfControl(yb.controlId,!1)),yb={},yb.SolutionId=Ca.PrimaryMarketplace.SolutionId,yb.TargetType=Ca.WebExtensionType,yb.Version=Ca.PrimaryMarketplace.SolutionVersion,yb.StoreType=Ca.PrimaryMarketplace.MarketplaceType,yb.StoreId=Ca.PrimaryMarketplace.MarketplaceRef,
Ca.AssetMarketplace?(yb.AssetId=Ca.AssetMarketplace.SolutionId,yb.AssetStoreId=Ca.AssetMarketplace.MarketplaceRef):(yb.AssetId=null,yb.AssetStoreId=null),yb.Width=Ca.TaskpaneWidth,yb.SharedRuntimeId=Ca.SharedRuntimeId,this.IZg(yb))}}tva(){this.yn.tva()}iM(Ca,yb,wc){this.yn.iM(Ca,yb,wc)}gxf(Ca,yb){yb=Qe.q5h(yb);Ca=this.wX(Ca);this.yn.wwc(Ca.InstanceId,2202,Bd.a.zV,yb)}TEd(Ca){for(let yb=0,wc=this.pl.length;yb<wc;yb++)this.gxf(this.pl[yb].controlId,Ca)}fvi(Ca,yb){yb=Qe.D0h(yb);this.yn.wwc(Ca,65539,
"",yb)}ivi(Ca,yb,wc){this.yn.wwc(Ca,1,yb,wc)}evi(Ca,yb){this.yn.jvi(Ca,yb)}W_h(Ca,yb){return[[2,1E3,"",JSON.stringify([Ca,yb]),0,!1]]}YTf(){return!!this.kAa&&this.kAa.mNf()}oTh(){this.kAa&&this.kAa.clear()}dxf(){if(this.kAa&&this.kAa.mNf()){var Ca=this.kAa.TBi();for(const yb of Ca){Ca=this.nui(yb);for(const wc of Ca)this.yn.wwc(wc,65540,"","{}")}}}Sdk(Ca){this.kAa.add(Ca)}G1k(Ca){this.kAa.remove(Ca)}Kva(Ca){if(!this.pl)return null;for(const yb of this.pl)if(Ca(yb))return yb;return null}Xgf(Ca){const yb=
new Ib.a,wc=Qe.tIa(Ca,this.$);if(Lb.HelperMethods.BF(Ca))f.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),this.nrg(Ca,dd=>{dd?(Ca.InstanceId=dd.InstanceId,Ca.WebExtensionOsfControlType=3,Ca.TaskpaneVisible=!1,this.vWa(Ca),yb.setResult(Ca.InstanceId)):(f.ULS.sendTraceTag(537170530,0,10,`InsertAgaveTaskPane for customfunction: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ca.PrimaryMarketplace.SolutionId,Ca.PrimaryMarketplace.MarketplaceType,null,null,null,Ca.PrimaryMarketplace.MarketplaceRef)} failed`),
yb.setException(Error.create("Null insert data")))});else{Qe.Bgb.ga(Ca.InstanceId,new ua.a);const dd=Qe.Bgb.ma(Ca.InstanceId).Vla;this.D1h(Ca,dd,wc);this.nrg(Ca,null);yb.setResult(Ca.InstanceId)}return yb.task}D1h(Ca,yb,wc){this.Er(Ca.InstanceId)||(Ca=new id(this,this.yn,Ca,this.webExtensionView),Ca.UGa=wc,Ca.nRf(yb),this.pl.push(Ca),this.WKa=null)}nrg(Ca,yb){const wc=Qe.tIa(Ca,this.$);if(!this.P$d.contains(wc))this.O0b.push(Ca),1<=this.O0b.length&&this.org(Ca,yb);else if(yb)for(const dd of this.qrg)if(Qe.tIa(dd,
this.$)===wc){yb(dd,0);break}}org(Ca,yb){let wc=null;const dd={};dd.SolutionId=Qe.getSolutionId(Ca,this.$);dd.TargetType=Ca.WebExtensionType;dd.Version=Ca.PrimaryMarketplace.SolutionVersion;dd.StoreType=Ca.PrimaryMarketplace.MarketplaceType;dd.StoreId=Ca.PrimaryMarketplace.MarketplaceRef;Ca.AssetMarketplace?(dd.AssetId=Ca.AssetMarketplace.SolutionId,dd.AssetStoreId=Ca.AssetMarketplace.MarketplaceRef):(dd.AssetId=null,dd.AssetStoreId=null);dd.Width=Ca.TaskpaneWidth;dd.ContainsCustomFunctions=!0;Lb.HelperMethods.BF(Ca)&&
(dd.SharedRuntimeId=Ca.SharedRuntime.Resid);const vd=this.$.pa.ta;Ca=this.$.pa.ta.Jh();const Zd=vd.Za(9,Ca);Zd.sharedInfo=dd;const Re=af=>{af=Nf.a.Qj(af.data);f.ULS.sendTraceTag(537170528,0,10,`DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: ${jg.a.Kh(af)}`)},ff=af=>{af&&!If.a(af)||f.ULS.sendTraceTag(537170527,0,10,`InsertAgaveTaskPane for addin ${Telemetry.PrivacyRules.GetPrivacyCompliantId(dd.SolutionId,dd.StoreType,dd.AssetId,null,
null,dd.StoreId)} finish with errors: ${jg.a.Kh(af.Errors)}`);this.O0b.shift();0<this.O0b.length&&this.org(this.O0b[0],yb)};if(yb){const af=xf=>{const eg=xf.Result;(wc=eg?eg.AgaveData:null)||yb(null,xf.Errors?xf.Errors[0].ErrorCause:5001);yb(wc,0)};Ca=(xf,eg,Ab)=>ve.h(vd,"InsertAgaveTaskpane",Zd,Bc.c(xf,ff,af),Bc.b(eg,Re),Ab,null,0)}else Ca=(af,xf,eg)=>ve.h(vd,"InsertAgaveTaskpane",Zd,Bc.c(af,ff),Bc.b(xf,Re),eg,null,0);ld.a(this.$.userOperationManager,Ca,af=>new oc.a(519,0,af,64),null)}yHk(){return this.$.Tj.get(35)}yhk(Ca){Ca=
this.Er(Ca);(null===Ca||void 0===Ca?0:Ca.Opa)&&Ca.bBg()}e5d(Ca){var yb=this.Kva(wc=>Qe.R_a(wc.lX));yb&&(yb=this.wl.getOsfControl(yb.controlId))&&yb.notifyAgave(OSF.AgaveHostAction.SendMessage,Ca)}sUf(){return!!this.Kva(Ca=>1===Ca.controlType&&Qe.R_a(Ca.lX))}rUf(){const Ca=this.Kva(yb=>Qe.R_a(yb.lX));return Ca?Ca.TF?xb.DOMElementExtensions.isVisible(Ca.TF):!1:!1}MLg(){const Ca=this.Kva(yb=>Qe.R_a(yb.lX));Ca&&(Ca.DE(!0),this.raiseEvent("ca",Ca.controlId))}initialize(Ca){var {DdaEventDispatch:yb}=a(1499);
const wc=void 0===this.$||null===this.$||gb.EwaSettings.Ra(234);void 0!==this.$&&null!==this.$||f.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");wc&&f.ULS.sendTraceTag(537170524,0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.initialized);this.initialized||(Td.Fg.Ha()||Rd.WebExtensionView.yHb(this.$),this.ea=this.$.ea,this.yn=new yb(this.$,this),this.$.nr(this.xj),this.ea.k0e(this.lMc),this.ea.uq(this.Oi),this.ea.NN(this.Dt),this.ea.Xy(this.ol),
this.$.userOperationManager.px(this.c1),yb=ya.f(this.$),null===yb||void 0===yb?void 0:yb.za.Vy(this.onBlockCacheItemChanged),this.e4f(),this.ZSj(),this.y$i(),Td.Fg.Ha(),Td.vb.Ha()||this.$.ka.ph(35,this),this.$nd.Aa(this),wc&&f.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.rTe=new Bd.a,wc&&f.ULS.sendTraceTag(537170521,0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.uTe=new Sa(this.$,this.un,this.yn),new Sc(this.$,this.un,this.yn),this.sTe=
new kb(this.$,this.un,this.yn),this.qTe=new cc(this.$,this.un,this.yn),this.pTe=new Tc(this.$,this.un,this.yn),this.tTe=new mc(this.$,this.un,this.yn),this.vTe=new hd(this.$,this.un,this.yn),this.wTe=new qc(this.$,this.un,this.yn),this.$.R5&&(this.xTe=new jd(this.$,this.un,this.yn,this)),this.yTe=new Ee(this.$,this.un,this.yn,Ca),this.Ggb=new Xa(this,ya.f(this.$)),gb.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&(this.oTe=new fc),this.nTe=new me(this.$,
this.un,this.yn),this.initialized=!0,f.ULS.sendTraceTag(537170520,0,50,"DdaFacade is initialized"))}Zui(Ca){if(!this.dCa)return null;for(let yb=0,wc=this.dCa.length;yb<wc;yb++)if(Ca.startsWith(this.dCa[yb].WebExtensionId))return this.dCa[yb];return null}e4f(){var Ca,yb=this.ea;if(yb.Ph&&!this.O$b){if(yb.workbookContext){if(this.ekd=this.$.ea.sn.get(22),null===(Ca=yb.workbookContext.WebExtensions)||void 0===Ca?0:Ca.length){Ca=yb.workbookContext.WebExtensions;yb=!1;if(l.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TelemetryForAddinsWithinFileEnabled",
!1)&&0<Ca.length){var wc=[];for(var dd=Ca.length-1;0<=dd;dd--)wc.push(Telemetry.PrivacyRules.GetPrivacyCompliantId(Ca[dd].PrimaryMarketplace.SolutionId,Ca[dd].PrimaryMarketplace.MarketplaceType,null,null,null,Ca[dd].PrimaryMarketplace.MarketplaceRef));wc={["solutionIds"]:wc};dd=new Jc.a;dd.name="Office.Extensibility.Host.AddinsWithinFile";dd.dataFields=Wc.a.rn(wc);Qc.a.sendTelemetryEvent(dd)}for(wc=Ca.length-1;0<=wc;wc--){if(!this.ea.isNamedObjectViewMode){this.SOc.push(Ca[wc].InstanceId);if(1!==
Ca[wc].WebExtensionType){Ca.splice(wc,1);continue}if(Lb.HelperMethods.BF(Ca[wc])&&0!==Ca[wc].SharedRuntime.State)1===Ca[wc].SharedRuntime.State?Ca[wc].TaskpaneVisible=!1:2===Ca[wc].SharedRuntime.State?Ca[wc].TaskpaneVisible=!0:f.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");else if(!Ca[wc].ContainsCustomFunctions&&!Ca[wc].TaskpaneVisible&&!gc.a(Ca[wc])){Ca.splice(wc,1);continue}}dd=OSF.OsfControl.isFirstPartyStoreString(Ca[wc].PrimaryMarketplace.MarketplaceType);if(gb.EwaSettings.Ra(174)&&
!dd&&(Ca.splice(wc,1),!yb)){yb=!0;const vd=Object(nd.d)($d.a.resolve(Td.C,{va:3}));ec.TaskExtensions.Ua(vd,()=>{vd.result.xm(36,null)},this.xa,3)}gb.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&Ca[wc].PrimaryMarketplace&&Qe.R_a(Ca[wc].PrimaryMarketplace.SolutionId)&&(f.ULS.sendTraceTag(537170518,0,50,"chart task pane info stored in workbook context webextensions"),Ca.splice(wc,1))}this.qgf(Ca)}}else this.ekd=!1;this.O$b=!0}}CLf(Ca){const yb=ya.f(this.$),
wc=yb.ha.$e.yh;if(wc&&Ca){Ca=!1;if(this.pl)for(const dd of this.pl)if(Qe.R_a(dd.lX)||Qe.akj(dd.lX)||Qe.Jlj(dd.lX)){Ca=!0;break}Ca||yb.ha.$e.XQ(wc)}}ZSj(){this.wl&&this.ea.isNamedObjectViewMode&&this.$.na&&Fe.n(this.$.na)&&(Td.Fg.Ha()?this.webExtensionView.WX?this.webExtensionView.RSb():this.webExtensionView.Mz(this.dpg):Na.a(this.$).WX?Na.a(this.$).RSb():Na.a(this.$).Mz(this.dpg))}qgf(Ca){let yb=null;yb=wc=>{const dd=wc.WebExtensionData,vd=wc.IsTaskPane,Zd=wc.RecordHandler,Re=()=>{this.O3a.shift();
0<this.O3a.length&&yb(this.O3a[0])};if(this.R4(dd.PrimaryMarketplace.SolutionId))Re();else{vd&&(dd.WebExtensionOsfControlType=1);var ff=gc.a(dd);if(!vd||dd.TaskpaneVisible||ff||dd.SharedRuntime&&0!==dd.SharedRuntime.State||dd.ContainsCustomFunctions){var af=new id(this,this.yn,dd,this.webExtensionView,!vd);f.ULS.sendTraceTag(537170517,0,50,`DdaFacade::CreateAllOsfControls: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(dd.PrimaryMarketplace.SolutionId,dd.PrimaryMarketplace.MarketplaceType,
null,null,null,dd.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${dd.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${Lb.HelperMethods.BF(dd)}`);af.NQd();Lb.HelperMethods.BF(dd)&&(af.UGa=Qe.tIa(dd,this.$),dd.TaskpaneWidth=this.MLb);ff&&(dd.WebExtensionToolTip="");!gb.EwaSettings.isChangeGateEnabled("OfficeVSO:7610902_EnforceDefaultTaskpaneWidth")&&vd&&dd.TaskpaneVisible&&!ff&&(dd.TaskpaneWidth=this.MLb);this.pl.push(af);var xf=this.WKa=null;xf=Zf.a.instance.jO(()=>{af.TF&&(Wb.a.Ng(xf),xf=
null,Zd&&Zd(wc,af),Re())},100,Rb.a.C8h)}else Re()}};for(let wc=0;wc<Ca.length;wc++){if(gb.EwaSettings.isChangeGateEnabled("OfficeVSO:7610902_EnforceDefaultTaskpaneWidth")){const dd=Ca[wc].WebExtensionType===OSF.OsfControlTarget.TaskPane,vd=gc.a(Ca[wc]);dd&&!vd&&(Ca[wc].TaskpaneWidth=this.MLb)}if(!this.Er(Ca[wc].InstanceId))if(1!==Ca[wc].WebExtensionType)this.vWa(Ca[wc]);else if(!gb.EwaSettings.Ra(52))this.kFb(Ca[wc],yb);else if(this.$.wj&8388608||Ca[wc].TaskpaneVisible){const dd={};dd.solutionId=
Ca[wc].PrimaryMarketplace.SolutionId;dd.version=Ca[wc].PrimaryMarketplace.SolutionVersion;dd.storeType=Ca[wc].PrimaryMarketplace.MarketplaceType;dd.storeId=Ca[wc].PrimaryMarketplace.MarketplaceRef;dd.targetData=Ca[wc];this.wl.isAddinCommandsAsync(dd,(vd,Zd,Re)=>{if(vd){var ff=Re.targetData;if(Zd)if(dd.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())vd=dd.storeType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog.toLowerCase(),Zd=dd.storeType.toLowerCase()===OSF.StoreType.PrivateCatalog.toLowerCase(),
(vd||Zd)&&Lb.HelperMethods.BF(ff)&&this.kFb(ff,yb);else if(gb.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))this.D1i(Re,yb);else{let af=!1;this.Bce(xf=>{if(!xf.errorCode){if(xf.value)for(const eg of xf.value){if(af)break;af=Ea.e(eg[1])===Ea.e(ff.PrimaryMarketplace.SolutionId)}af?Lb.HelperMethods.BF(ff)&&this.kFb(ff,yb):(xf={},xf.SolutionId=Re.solutionId,xf.Version=Re.version,xf.StoreType=ff.PrimaryMarketplace.MarketplaceType,xf.StoreId=Re.storeId,
xf.AssetId=null,xf.AssetStoreId=null,xf.Width=ff.TaskpaneWidth,xf.TargetType=ff.WebExtensionType,ff.TaskpaneVisible=!0,this.rYe(xf,ff,yb))}},!0)}else this.kFb(ff,yb)}else vd=Re.targetData,f.ULS.sendTraceTag(542185164,220,15,`Judging AddinCommands failed for ${Telemetry.PrivacyRules.GetPrivacyCompliantId(vd.PrimaryMarketplace.SolutionId,vd.PrimaryMarketplace.MarketplaceType,null,null,null,vd.PrimaryMarketplace.MarketplaceRef)} from ${vd.PrimaryMarketplace.MarketplaceType} during document loading`)})}}}D1i(Ca,
yb){let wc=!1;this.Bce(dd=>{const vd=Ca.targetData;if(!dd.errorCode){if(dd.value)for(const Zd of dd.value){if(wc)break;wc=Ea.e(Zd[1])===Ea.e(vd.PrimaryMarketplace.SolutionId)}wc?Lb.HelperMethods.BF(vd)&&this.kFb(vd,yb):(dd={},dd.SolutionId=Ca.solutionId,dd.Version=Ca.version,dd.StoreType=vd.PrimaryMarketplace.MarketplaceType,dd.StoreId=Ca.storeId,dd.AssetId=null,dd.AssetStoreId=null,dd.TargetType=vd.WebExtensionType,dd.Width=vd.TaskpaneWidth,vd.TaskpaneVisible=!0,this.rYe(dd,vd,yb))}},!0)}kFb(Ca,
yb){const wc={};wc.WebExtensionData=Ca;wc.IsTaskPane=!0;this.O3a.push(wc);1===this.O3a.length&&yb(wc)}rYe(Ca,yb,wc){const dd={};dd.ActivationInfo=Ca;dd.WebExtensionData=yb;dd.IsTaskPane=!1;dd.RecordHandler=(vd,Zd)=>{const Re=vd.ActivationInfo;this.wl.insertBlankControlWithErrorUX(this.o1b(Zd,Re),()=>{this.h5a(Zd.controlId);this.wl.purgeOsfControl(Zd.controlId,!1);this.IZg(Re)})};this.O3a.push(dd);1===this.O3a.length&&wc(dd)}IZg(Ca){var yb={};yb.solutionId=Ca.SolutionId;yb.version=Ca.Version;yb.storeType=
Ca.StoreType;yb.storeId=Ca.StoreId;yb.assetId=Ca.AssetId;yb.assetStoreId=Ca.AssetStoreId;yb.targetType=Ca.TargetType;yb.sharedRuntimeId=Ca.SharedRuntimeId;Ca=new I.a;Ca.add(yb);yb={};yb[ba.a.vGb]=Ca;yb[ba.a.v3]=3;Ca=new xd.a(md.a.mob,0,this.$.Rh,0,null);this.$.Ma.dh(Ca,yb)}o1b(Ca,yb){const wc={};wc.div=Ca.TF;wc.id=Ca.controlId;wc.solutionId=yb.SolutionId;wc.version=yb.Version;wc.storeId=yb.StoreId;wc.storeType=yb.StoreType;wc.osfControlType=OSF.OsfControlTarget.TaskPane;return wc}eAg(){this.pl.forEach(this.Qfg);
this.pl.length=0;this.O$b=!1}uCi(Ca){const yb=Ca.PrimaryMarketplace.MarketplaceType,wc=Qe.getSolutionId(Ca,this.$);return yb===OSF.StoreType.InMemory&&wc.toLowerCase().startsWith("wa")?{solutionId:wc,kVg:OSF.StoreType.OMEX}:{solutionId:Ca.PrimaryMarketplace.SolutionId,kVg:yb}}wwa(Ca){var yb;const wc=this.uCi(Ca);return Telemetry.PrivacyRules.GetPrivacyCompliantId(wc.solutionId,wc.kVg,null===(yb=Ca.AssetMarketplace)||void 0===yb?void 0:yb.SolutionId,null,null,Ca.PrimaryMarketplace.MarketplaceRef)}vKk(Ca){var yb,
wc;const dd=Ca.Nn,vd={AssetId:null===(yb=dd.AssetMarketplace)||void 0===yb?void 0:yb.SolutionId,AssetStoreId:null===(wc=dd.AssetMarketplace)||void 0===wc?void 0:wc.MarketplaceRef,EnabledInViewMode:!0,Height:0,IsToBePersisted:!1,SolutionId:dd.PrimaryMarketplace.SolutionId,SourceLocationOverrideResourceId:dd.SrcLocationOverrideResourceId,StoreId:dd.PrimaryMarketplace.MarketplaceRef,StoreType:dd.PrimaryMarketplace.MarketplaceType,TargetType:dd.WebExtensionType,Version:dd.PrimaryMarketplace.SolutionVersion,
Width:dd.TaskpaneWidth},Zd={width:dd.TaskpaneWidth,Dx:dd.TaskpaneIconCssClass,showLoadingSpinner:dd.ShowLoadingSpinner,focusOnIframeWhenLoaded:dd.FocusOnIframeWhenLoaded};let Re=vd.IsToBePersisted?0:16;const ff=this.$.pa.ta.Jh();Re|=64;this.Vhd=!0;ld.a(this.$.userOperationManager,(af,xf,eg)=>{var Ab=this.wwa(dd);f.ULS.sendTraceTag(507637774,0,50,`Silent Reload::showAgaveTaskpaneReload:Web Method ShowAgaveTaskpane is called, StoreType ${vd.StoreType}, StoreId ${vd.StoreId}, SolutionId ${Ab}.`);Ab=
this.$.pa.ta;af=Bc.c(af,this.Bsg);const xc=Ab.Za(9,void 0===ff?null:ff);xc.sharedInfo=vd;return ve.h(Ab,"ShowAgaveTaskpane",xc,af,xf,eg,Zd,0)},af=>new oc.a(538,0,af,Re),null)}Pbj(Ca){const yb=Ca.Nn,wc={AssetId:yb.PrimaryMarketplace.SolutionId,AssetStoreId:yb.PrimaryMarketplace.MarketplaceRef,OwnerAddinSolutionId:yb.OwnerAddinSolutionId,OwnerAddinStoreType:yb.OwnerAddinStoreType,Preload:yb.Preload,SharedRuntimeId:yb.SharedRuntimeId,SolutionId:yb.PrimaryMarketplace.SolutionId,StoreId:yb.PrimaryMarketplace.MarketplaceRef,
StoreType:yb.PrimaryMarketplace.MarketplaceType,TargetType:yb.WebExtensionType,Version:yb.PrimaryMarketplace.SolutionVersion,Width:yb.TaskpaneWidth},dd=this.$.pa.ta,vd=dd.Za(9);vd.sharedInfo=wc;this.Vhd=!0;ld.a(this.$.userOperationManager,(Zd,Re,ff)=>{const af=this.wwa(yb);f.ULS.sendTraceTag(507637771,0,50,`Silent Reload::insertAgaveSandboxReload:Web Method InsertAgaveTaskpane is called, StoreType ${wc.StoreType}, StoreId ${wc.StoreId}, SolutionId ${af}.`);return ve.h(dd,"InsertAgaveTaskpane",vd,
Bc.c(Zd,this.Bsg),Bc.b(Re,Re),ff,null,0)},Zd=>new oc.a(500,0,Zd,64),null)}VEg(){const Ca=[];var yb=this.pl.length;for(var wc=0;wc<yb;wc++){var dd=this.pl[wc];if(this.ZRd){if(dd.sXf&&this.okj){Ca.push(dd);continue}const vd=gc.a(dd.Nn),Zd=3===dd.osfControlType,Re=0===dd.osfControlType||4===dd.osfControlType;vd||Zd?dd.Nn.PrimaryMarketplace?"FA000000112"===dd.Nn.PrimaryMarketplace.SolutionId?Ca.push(dd):vd?this.vKk(dd):this.Pbj(dd):(f.ULS.sendTraceTag(507642883,0,10,"Silent Reload::ResetOsfControlAfterServerReload: PrimaryMarketplace is null."),
Ca.push(dd)):Re&&Ca.push(dd)}else 0!==dd.osfControlType&&3!==dd.osfControlType&&4!==dd.osfControlType||Ca.push(dd)}yb=!1;for(wc=0;wc<Ca.length;wc++)dd=Ca[wc],this.h5a(dd.controlId),!yb&&dd&&dd.Nn&&(yb=Lb.HelperMethods.BF(dd.Nn));yb&&this.xU(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:4});gb.EwaSettings.Ra(355)&&ec.TaskExtensions.Ua(Ze.GetServiceTaskFactory.Bj(this.$.ka,278,279,3),vd=>{vd&&(vd=vd.result)&&(this.$.ka.Ug(278)||this.$.ka.ph(278,vd),vd.ASf().nAa())},this.xa,3)}wV(){var Ca=new fd(this.$,
this.un,this.hGg);void 0===this.$||null===this.$?f.ULS.sendTraceTag(537170514,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):gb.EwaSettings.Ra(234)&&f.ULS.sendTraceTag(537170513,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+(void 0===this.un||null===this.un));if(Ca.oGj()){const yb=()=>{},wc=vd=>{vd=Nf.a.Qj(vd.data);f.ULS.sendTraceTag(537170511,0,10,`ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: ${jg.a.Kh(vd)}.`)},
dd=Ca.bMh();Ca=Qe.RKd(dd);Ca|=64;this.$.userOperationManager.vO(new oc.a(507,0,(vd,Zd,Re)=>ve.h(this.$.pa.ta,"ExecuteRichApiRequest",this.dMh(dd),Bc.c(vd,yb),Bc.b(Zd,wc),Re,null,0),Ca))}}dMh(Ca){const yb=this.$.pa.ta.Za(1);yb.request=Ca;return yb}Yaf(Ca,yb){if(Ca)for(let wc=0;wc<Ca.length;wc++)if(cf.a.equals(Ca[wc],yb,!0))return!0;return!1}cLh(Ca){const yb={};yb.navigationMode=OSF.OsfNavigationMode.DefaultMode;yb.assetId=null;yb.category=null;if(!Ca||3>Ca.length)return yb;if(Ca[0]){const wc=parseInt(Ca[0],
10);isNaN(parseInt(wc,10))||(yb.navigationMode=wc)}Ca[1]&&(yb.assetId=Ca[1]);Ca[2]&&(yb.category=Ca[2]);return yb}y$i(){var Ca=this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(Ca&&"*"!==Ca.trim()){this.pXa=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new nc(this),Ca,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.Tj.get(2));try{this.pXa.init()}catch(yb){try{this.pXa.dispose()}catch(wc){}this.pXa=null;f.ULS.sendTraceTag(537170510,0,10,"EmbeddingEnpoint failed to initialize. Error message: "+
yb.message)}Ca={};Ca.a=this.$.ua.UserSessionId;zc.b().tl(39,Ca)}}IQg(Ca,yb,wc){const dd=Qe.nKh(Ca[0]),vd=dd.fua,Zd=dd.fva;dd.fua=()=>{vd&&vd();const Re=dd.f_a!==OSF.InfoType.Error?yb:null;Ca.shift();Ca.length?this.IQg(Ca,Re,wc):Re&&Re()};dd.fva=()=>{Zd&&Zd();wc&&dd.f_a!==OSF.InfoType.Error&&wc()};fb.a.Ppe(dd)}uLi(){const Ca={};Ca.AddinRibbonControlsOverriddenByApi=gb.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();Ca.AddinActionDefinitionHybridMode=
gb.EwaSettings.Ra(556).toString();Ca.UseActionIdForUILessCommand=gb.EwaSettings.Ra(559).toString();Ca.AllowStorageAccessByUserActivationOnIFrame=gb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString();Ca.RequirementSetRibbonApiOnePointTwo=gb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();Ca.flightingTreatmentVariables=l.AFrameworkApplication.fa.Fwc;Ca.ShortcutInfoArrayInUserPreferenceData=
gb.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();Ca.DisabledChangeGates=l.AFrameworkApplication.fa.Xa("DisabledChangeGates");Ca.DmsSdxListWorkbook=l.AFrameworkApplication.Tmf;Ca.AddinDevicePermissionAllowList=l.AFrameworkApplication.fa.Xa("AddinDevicePermissionAllowList");return Ca}static get lKb(){return Qe.gGe}static set lKb(Ca){Qe.gGe=Ca}static getSolutionId(Ca){let yb=Ca.PrimaryMarketplace.SolutionId;gb.EwaSettings.Ra(261)&&Ca.OwnerAddinSolutionId&&
(yb=Ca.OwnerAddinSolutionId);return yb}static RKd(Ca){return Ca.RequestFlags&1&&256!==(Ca.RequestFlags&256)?0:16}static tIa(Ca,yb){yb=Qe.getSolutionId(Ca,yb);return Qe.RCf(yb,Ca.PrimaryMarketplace.SolutionVersion,Ca.PrimaryMarketplace.MarketplaceType,Ca.PrimaryMarketplace.MarketplaceRef)}static q5h(Ca){return JSON.stringify({["recording"]:Ca})}static D0h(Ca){const yb={};yb.visibility=Ca?"Visible":"Hidden";return JSON.stringify(yb)}static PGi(Ca){const yb=Ca.getSolutionId(),wc=Ca.getVersion(),dd=Ca.getStoreType();
Ca=Ca.getStoreId();return Qe.RCf(yb,wc,dd,Ca)}static RCf(Ca,yb,wc,dd){return String.format("{0}|{1}|{2}|{3}|{4}|||","2",Ca,yb,Qe.sVi(wc).toString(),dd)}static VMd(Ca,yb){var wc=Ca.split("|");if(7>wc.length)return f.ULS.sendTraceTag(537170509,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if("2"!==wc[0])return f.ULS.sendTraceTag(537170508,0,10,`DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='${wc[0]}'.`),null;let dd=wc[1];const vd=
wc[2],Zd=Qe.tVi(wc[3]),Re=wc[4];wc=wc[5];dd&&dd.length||(dd=wc);wc={};wc.InstanceId=String.format("{{{0}}}",M.a.create().toString());wc.WebExtensionOsfControlType=4;wc.WebExtensionType=1;wc.PrimaryMarketplace={};wc.PrimaryMarketplace.SolutionId=dd;wc.PrimaryMarketplace.SolutionVersion=vd;wc.PrimaryMarketplace.MarketplaceRef=Re;wc.PrimaryMarketplace.MarketplaceType=Zd;wc.ContainsCustomFunctions=yb?!0:!1;yb&&(wc.OsfPropertyBag=[["customFunctionAddinId",Ca]]);return wc}static tVi(Ca){Ca=parseInt(Ca,
10);return Ca===OSF.StoreTypeEnum.MarketPlace?OSF.StoreType.OMEX:Ca===OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:Ca===OSF.StoreTypeEnum.SPApp?OSF.StoreType.SPApp:Ca===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:Ca===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:Ca===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:Ca===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:Ca===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:Ca===OSF.StoreTypeEnum.FirstParty?
OSF.StoreType.FirstParty:Ca===OSF.StoreTypeEnum.UploadFileDevCatalog?OSF.StoreType.UploadFileDevCatalog:Ca===OSF.StoreTypeEnum.WopiCatalog?OSF.StoreType.WopiCatalog:null}static sVi(Ca){return Ca===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:Ca===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:Ca===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:Ca===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:Ca===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:Ca===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:
Ca===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:Ca===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:Ca===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:Ca===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:Ca===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1}CGa(Ca){const yb={};yb.Version=Ca.version;yb.AssetId=Ca.assetId;yb.AssetStoreId=Ca.assetStoreId;yb.StoreType=Ca.storeType;yb.Height=Ca.height;yb.SolutionId=
Ca.solutionId;yb.StoreId=Ca.storeId;yb.TargetType=Ca.targetType;yb.Width=1===yb.TargetType?0:Ca.width;yb.SharedRuntimeId=Ca.sharedRuntimeId;return yb}static dUb(Ca){return Ca===OSF.DDA.EventDispId.dispidSettingsChangedEvent||Ca===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||Ca===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Ca===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||Ca===OSF.DDA.EventDispId.dispidRichApiMessageEvent||Ca===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||
Ca===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||Ca===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static nKh(Ca){return Object(b.a)(new Xc.a,{f_a:Ca.infoType,id:Ca.id,title:Ca.title,description:Ca.description,buttonText:Ca.buttonTxt,fua:Ca.buttonCallback,iCc:Ca.highPriority,fva:Ca.dismissCallback,errorCode:Ca.errorCode,xQf:Ca.iframeNotificationUrl})}static R_a(Ca){let yb="FA000000014"===Ca;yb||(yb="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===Ca);return yb}static akj(Ca){return"FA000000005"===
Ca}static Jlj(Ca){return"FA000000064"===Ca}}Qe.Bgb=new Q.a;Qe.gGe=!0;Qe.Gxe=!0;Object(c.a)(Qe,"DdaFacade",Zb.a,[319,320,321,322,323,2])},926:function(y,x,a){a.d(x,"a",function(){return b});y=a(0);var c=a(39);class b{static get RDj(){return b.cPe||(b.cPe={["-2002156328"]:b.ddf,["-1954750170"]:b.FIf,["317650254"]:b.iVh,["-1005263101"]:b.Ucj,["1353664579"]:b.Hvk,["159671765"]:b.Vcj,["1446690022"]:b.UCf,["1150069548"]:b.H0c,["-1409306331"]:b.P$e,["338507772"]:b.Pjf,["-457159301"]:b.q0j,["-1037701970"]:b.c8h,
["-1893322318"]:b.Zcj,["965579896"]:b.e8h,["93287890"]:b.d8h,["358088857"]:b.lzk,["-1223650923"]:b.Pjf,["2007306190"]:b.VQh,["1549955423"]:b.m7e,["-1275974171"]:b.Ycj,["382101082"]:b.k_j,["-898776235"]:b.BFj,["335464256"]:b.tFj,["1677378049"]:b.Xcj,["-261992848"]:b.x1k,["-980820954"]:b.m7e,["-931375837"]:b.j_j,["929186550"]:b.sfi,["-982144310"]:b.w8j,["-785741187"]:b.Scj,["2125217573"]:b.adj,["299124955"]:b.Tcj,["1669853884"]:b.Brk,["-1515932330"]:b.kVh,["314621024"]:b.pxi,["-300049690"]:b.ZQh,["14766835"]:b.SEk,
["-1251992761"]:b.lnf,["-2087635043"]:b.invalidOrTimedOutSession,["2100961153"]:b.invalidOrTimedOutSession,["-1218744139"]:b.invalidSheetName,["-1468309555"]:5006,["-315732528"]:b.invalidOrTimedOutSession,["611268539"]:b.invalidOrTimedOutSession,["1531005923"]:5006,["1593924569"]:5006,["299476328"]:b.RTa,["49173765"]:b.RTa,["-907155566"]:b.RTa,["-1201603824"]:b.RTa,["1541165282"]:b.RTa,["-1347753427"]:b.RTa,["134912532"]:b.RTa,["1780971550"]:b.responsePayloadSizeLimitExceeded})}static nzf(f){return c.a.tw(b.RDj,
f.toString(),b.internalError)}}b.success=0;b.ddf=1E3;b.FIf=1001;b.iVh=1002;b.Ucj=1003;b.Hvk=1004;b.Vcj=1005;b.UCf=1008;b.rwf=1009;b.invalidSheetName=1014;b.H0c=2E3;b.P$e=2001;b.Pjf=2002;b.q0j=2003;b.c8h=2004;b.Zcj=2005;b.e8h=2007;b.d8h=2008;b.lzk=2009;b.VQh=2014;b.zvk=3E3;b.m7e=3002;b.Ycj=3004;b.k_j=3005;b.BFj=3006;b.tFj=3007;b.Xcj=3008;b.x1k=3009;b.j_j=3010;b.SEk=4002;b.I9d=5E3;b.internalError=5001;b.lnf=5002;b.eTb=5004;b.C2k=5007;b.g8i=5008;b.jEg=5011;b.invalidOrTimedOutSession=5012;b.h3c=5016;
b.RTa=5102;b.bok=5103;b.responsePayloadSizeLimitExceeded=5104;b.tQh=7001;b.TTg=7002;b.sfi=8E3;b.w8j=8001;b.Scj=8010;b.adj=8011;b.Tcj=8012;b.Brk=8020;b.kVh=8021;b.pxi=8022;b.ZQh=8023;b.xDj=11E3;b.tGj=11001;b.$cj=11002;b.cPe=null;Object(y.a)(b,"DdaErrorIds",null,[])},927:function(y,x,a){a.d(x,"a",function(){return f});y=a(0);var c=a(14),b=a(94);class f{constructor(){this.Xee=0;this.f7={};this.sGa={}}TPi(r,d){return this.f7[f.mrd(r,d)]}vpf(r,d){d||void 0!==this.sGa[r]&&null!==this.sGa[r]?d&&void 0!==
this.sGa[r]&&null!==this.sGa[r]&&delete this.sGa[r]:this.sGa[r]=1}Wlc(r){return void 0===this.sGa[r]||null===this.sGa[r]}RNd(r){const d=f.mrd(r.messageType,r.targetId);1===r.actionType?this.n2i(r.controlId,r.messageType,d):2===r.actionType&&this.p3i(r.controlId,r.messageType,d)}Rgk(r){if(r){var d=Object.keys(this.f7);if(!(void 0===d||null===d||0>=d.length))for(const k of d)d=this.f7[k],d[r]&&(delete d[r],Object.keys(d).length||delete this.f7[k])}}yR(r,d){r=f.mrd(r,d);r=this.f7[r];return!!r&&0<Object.keys(r).length}l4i(){return!b.a.isEmpty(this.f7)}Y_f(){return 0<
this.Xee}UIi(){const r=[],d=this.f7;for(const m in d){var k=m,t=d[m];for(const e in t){t=e;const w={};w.eventType=parseInt(k.split("#")[0],10);w.targetId=k.split("#")[1];w.addinId=t;r.push(w)}}return r}n2i(r,d,k){if(this.f7[k])k=this.f7[k],k[r]=k[r]?k[r]+1:1;else{const t={};t[r]=1;this.f7[k]=t}100===d&&this.Xee++}p3i(r,d,k){if(this.f7[k]){const t=this.f7[k];if(r){const m=t[r];1===m?(delete t[r],Object.keys(t).length||delete this.f7[k]):t[r]=m-1;100===d&&this.Xee--}else c.ULS.sendTraceTag(537170459,
0,50,`The OsfControl[${r}] doesn't register event with key[${k}].`)}else c.ULS.sendTraceTag(537170460,0,50,`The event with key[${k}] that will be unregistered doesn't exist.`)}static mrd(r,d){return String.format("{0}#{1}",r,d)}}f.zV="Workbook";Object(y.a)(f,"RichApiEventRegistration",null,[])},928:function(y,x,a){a.d(x,"a",function(){return c});y=a(0);class c{}c.generalException="GeneralException";c.invalidArgument="InvalidArgument";c.notImplemented="NotImplemented";c.wkd="AccessDenied";c.notSupported=
"NotSupported";c.wlc="ApiNotAvailable";c.Qbg="NotAllowed";c.D9d="OperationCancelled";c.$xe="UserNotSignedIn";c.$xb="UserAborted";c.F2k="UnsupportedUserIdentity";c.Alb="InvalidResourceUrl";c.FDc="InvalidGrant";c.HBh="AddinIsAlreadyRequestingToken";c.Lpk="ResourceNotAllowed";c.Yoc="ClientError";c.serverError="ServerError";c.kZh="ControlIdNotFound";c.Lqk="RibbonApiNotAvailable";c.hostRestartNeeded="HostRestartNeeded";c.invalidRibbonDefinition="InvalidRibbonDefinition";c.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";
Object(y.a)(c,"ErrorCodes",null,[])},966:function(y,x,a){a.d(x,"a",function(){return c});y=a(0);class c{constructor(b,f,r,d){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=b;this.controlId=f;this.ddaBinding=r;this.ArrayData=void 0===d?null:d}getDispid(){return this.dispid}getDdaBinding(){return this.ddaBinding}}Object(y.a)(c,"DdaEventArgs",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.agave.js.map/59ad32093b15e6019675259c76351d79/EwaTS.agave.js.map