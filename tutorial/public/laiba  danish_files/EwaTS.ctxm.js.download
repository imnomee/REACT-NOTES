'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1019:function(y,x,a){function c(Ba,Fa,za,xa,fa,V){V=void 0===V?null:V;n.b(Ba).lj(I.a.hKj,r(),void 0,!0);const ba=Ya=>{if(v.a.NOa(Ya)){const bb=v.a.vIa(Ya);ea?v.a.PK(B.a.filterByColorOrIcon,bb.MessageIdName,z.a.gea,!0,v.a.$xa(bb.MessageId)):u.ULS.sendTraceTag(508372234,0,10,"ContextMenuFilterHelper::applyFilterByColorOrIcon failed with AutoFilterException -{0}",bb.MessageIdName)}C.a(Ya)||(u.ULS.sendTraceTag(508372233,
0,50,"ContextMenuFilterHelper::applyFilterByColorOrIcon service call succeeded"),n.b(Ba).lj(I.a.HPj,r(),void 0,!0),null!==za&&b(Ba,za),Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowFilteredResultsInStatusBar",!1)&&(null===V||void 0===V?void 0:V.UAa(Ya.Result,"Table"===Fa.AutoFilterType,Fa.Id)))},la=k(Ba,Fa),Ta=new J.a(266,0,(Ya,bb,ra)=>K.a(Ba.pa.ta,la,Fa,D.c(Ya,ba),bb,ra,null,null),6),Ea=()=>{Ba.userOperationManager.enqueueOperation(Ta,null)},sa=Ba.ea.th.allowViewCollab&&Y.EwaSettings.isChangeGateEnabled("OfficeVSO:8581585_NsvEntryExitOptimizationInRealTimeView");
fa||sa?xa.PMa(Ea,19,"ContextMenuFilterHelper::applyFilterByColorOrIcon"):f(Ea)}function b(Ba,Fa){R.a.CKa(Ba)&&Q.TaskExtensions.Ua(M.GetServiceTaskFactory.Bj(Ba.ka,430,431,1),za=>{za.result.EPa(Fa);u.ULS.sendTraceTag(508372231,306,50,"AutoFilterContextMenu:TriggerPivotTableHandRaise Trigger hand raise from filter context menu.")},Ba.xa,3)}function f(Ba){void W.a.resolve(N.Qd,{va:3}).then(Fa=>{Fa.W6a().continueWith(za=>{za.result&&Ba()})})}function r(){return{["Location"]:"contextMenu"}}function d(Ba){let Fa=
0;var za=Ba.ha.qa.activeCell;Ba=W.a.Zg(N.hg);var xa=Ba.Zv;const fa=Ba.fPb(za);xa?(Ba="Table",Fa=xa.objectId):fa?(Ba="Table",Fa=fa.id):Ba="Sheet";za=za.left;xa={};xa.AutoFilterType=Ba;xa.Column=za;xa.Id=Fa;xa.ItemListOptions=null;return xa}function k(Ba,Fa){const za={};Ba.Mq(za);za.FirstRow=0;za.FirstColumn=Fa.Column;Ba=Ba.ea.isNamedObjectViewMode;Fa.NamedObjectView=Ba;Fa.SheetName=Ba?za.NamedObjectName:za.SheetName;Ba={};Ba.Location=za;Ba.FieldId=Fa.Id.toString();Ba.DataSourceIndex=-1;Ba.FilterType=
Fa.AutoFilterType;Ba.AnchorType=0;Ba.ChartId=null;Ba.AnchorValue1=-1;Ba.AnchorValue2=-1;Ba.Property=Fa.RichProperty;return Ba}function t(Ba,Fa){const za=Fa.kh(Fa.ha.qa.activeCell);Fa={FilterColor:0,FilterIcon:-1,FilterIconSet:-1};switch(Ba){case 486423932:za.EZa&&(Ba=U.a.tu(za.backgroundColor),Fa.FilterColor=Ba.$V(!0));Fa.FilterType=Enum.toString(P.b,P.b.FilterOnCellColor);break;case -652157481:0!==za.GJb&&(Fa.FilterColor=U.a.Bqd(za.GJb));Fa.FilterType=Enum.toString(P.b,P.b.FilterOnFontColor);break;
case -1656122924:za.Hkb&&(Fa.FilterIcon=za.cell.EWb,Fa.FilterIconSet=za.FWb);Fa.FilterType=Enum.toString(P.b,P.b.FilterOnIcon);break;default:u.ULS.debugAssertTag(508372232,0,!1,"ContextMenuFilterHelper.createFilterColorOrIconOptionsForGridContextMenu: ribbon command didn't match any of the case statements")}return Fa}function m(Ba){const Fa={};Fa.FilterType=Enum.toString(P.b,Ba.type);Fa.FilterColor=Ba.color;Fa.FilterIcon=Ba.icon.Icon;Fa.FilterIconSet=Ba.icon.IconSet;return Fa}function e(Ba,Fa,za){const xa=
{};xa.FirstRow=w(Ba,Fa);xa.FirstColumn=za;return-1!==xa.FirstRow?F.F(xa):null}function w(Ba,Fa){Ba=Ba.ha.qa.activeCell;var za=W.a.Zg(N.hg);const xa=za.Zv;za=za.fPb(Ba);if(xa)return xa.usedRange.top;if(null!=za)return za.top;Fa=Fa.sa.getItemByName(Fa.na.sheetName);return(Fa=F.G(Fa.WK))&&Fa.contains(Ba)?Fa.top:-1}function l(Ba,Fa){if(!Y.EwaSettings.isChangeGateEnabled("OfficeVSO:8606009_InvalidParameterNotAllowedFilters"))return!0;const za=O.f(Ba).ha.qa.activeCell,xa=Fa.Yg.sl(za);if(xa)return xa.hasAutoFilter;
Ba=F.w(za,Ba);return Fa.Yg.WVd(Ba)}a.d(x,"a",function(){return c});a.d(x,"k",function(){return b});a.d(x,"j",function(){return f});a.d(x,"g",function(){return r});a.d(x,"e",function(){return d});a.d(x,"b",function(){return k});a.d(x,"d",function(){return t});a.d(x,"c",function(){return m});a.d(x,"h",function(){return e});a.d(x,"f",function(){return w});a.d(x,"i",function(){return l});var u=a(14),n=a(151),v=a(935),B=a(948),z=a(140),C=a(252),D=a(262),J=a(212),W=a(97),N=a(5),M=a(79),Q=a(40),R=a(25),
O=a(24),U=a(196),K=a(1073),F=a(45),I=a(150),P=a(1531),Y=a(1);const ea=v.a.qTb()},1073:function(y,x,a){a.d(x,"c",function(){return b});a.d(x,"b",function(){return f});a.d(x,"d",function(){return r});a.d(x,"a",function(){return d});var c=a(62);const b=(k,t,m,e,w,l,u,n)=>{t=c.M(k,t,m,n);return c.h(k,"GetPivotValueFieldSettingsInitial",t,e,w,l,u,4)},f=(k,t,m,e,w,l,u,n,v)=>{t=c.M(k,t,m,v);t.pivotValueFieldSettingsApplyData=e;return c.h(k,"ApplyPivotValueFieldSettings",t,w,l,u,n,0)},r=(k,t,m,e,w,l,u,n,
v)=>{t=c.M(k,t,m,v);t.selectedBaseField=e;return c.h(k,"GetPivotValueFieldSettingsShowValueAsBaseItems",t,w,l,u,n,4)},d=(k,t,m,e,w,l,u,n)=>{n=k.Za(41,n);n.parameters=t;n.autoFilterOptions=m;return c.h(k,"ApplyColorOrIconFilter",n,e,w,l,u,64)}},1149:function(y,x,a){a.r(x);a.d(x,"GridContextMenu",function(){return ab});y=a(179);x=a(0);var c=a(14),b=a(380),f=a(108),r=a(60),d=a(242),k=a(636),t=a(6),m=a(158),e=a(353),w=a(909),l=a(10),u=a(68),n=a(19),v=a(71),B=a(7),z=a(654),C=a(1208),D=a(988),J=a(12),W=
a(1),N=a(938);class M{constructor(db,mb,Ia,pa,lb,ha,ua,fb){this.$=mb;this.Ya=Ia;this.Du=pa;this.selectedRanges=lb;this.grid=ha;this.DD=fb;this.mna=ua;this.rFa=d.a.all(lb,Ka=>Ka.isRow);this.qFa=d.a.all(lb,Ka=>Ka.fk);this.H2a=d.a.all(lb,Ka=>!Ka.isRow&&!Ka.fk);mb=ha.Yg.oMd(lb);this.Uqc=!!mb;this.mDg=!!mb&&mb.hasActiveFilter;this.menuSection=Ia.Oh();db.vh.push(this.menuSection);this.z5=this.rFa||this.qFa?this.menuSection:Ia.Oh();this.Tla=this.rFa||this.qFa?this.menuSection:Ia.Oh()}NGd(){this.Szi();this.pzi();
const db=this.DD.cnb(this.selectedRanges,this.grid);this.menuSection.buttons.push(this.Ya.Sg(db?149:148))}Xzi(db){var mb=0,Ia=0,pa=null;let lb=null;const ha=N.i(this.selectedRanges),ua=1<ha?J.a.instance.ia(430):J.a.instance.ia(2539),fb=1<ha?J.a.instance.ia(2526):J.a.instance.ia(2540),Ka=this.DD.Pw(this.Du,-1113896058,this.selectedRanges,this.grid),La=this.DD.Pw(this.Du,942362098,this.selectedRanges,this.grid),ib=W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)&&this.DD.Pw(this.Du,75170472,this.selectedRanges,this.grid);this.Uqc?this.mna.Pw(942362098)?(mb=La?161:169,pa=ha+" "+J.a.instance.ia(1969)+" "+ua):this.mDg&&(mb=this.DD.Pw(this.Du,-1113896058,this.selectedRanges,this.grid)?177:181,Ia=ib?363:364,pa=ha+" "+ua,lb=ha+" "+fb):this.mna.Pw(-1113896058)&&(this.rFa?(mb=Ka?49:116,Ia=ib?365:366,pa=J.a.instance.ia(514)+" "+ha+" "+ua,lb=J.a.instance.ia(514)+" "+ha+" "+fb):(mb=Ka?177:181,Ia=ib?363:364,pa=ha+" "+ua,lb=ha+" "+fb));0!==mb&&(mb=this.Ya.Sg(mb),
W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?(pa&&(mb.label=pa),db?(pa=this.Ya.Oh(),pa.buttons.push(mb),0!==Ia&&(Ia=this.Ya.Sg(Ia),lb&&(Ia.label=lb),pa.buttons.push(Ia)),db.menu.vh.push(pa)):(this.z5.buttons.push(mb),0!==Ia&&(db=this.Ya.Sg(Ia),lb&&(db.label=lb),this.z5.buttons.push(db)))):this.z5.buttons.push(mb))}Tzi(db){var mb=0,Ia=0;let pa=null,lb=null;var ha=N.g(this.selectedRanges);const ua=1<ha?J.a.instance.ia(2543):J.a.instance.ia(2545),
fb=1<ha?J.a.instance.ia(2544):J.a.instance.ia(2546),Ka=this.DD.Pw(this.Du,622604322,this.selectedRanges,this.grid);var La=this.DD.Pw(this.Du,1415868706,this.selectedRanges,this.grid);const ib=this.DD.Pw(this.Du,-612877076,this.selectedRanges,this.grid);this.Uqc?this.mna.Pw(622604322)&&(this.grid.rtl?(mb=Ka?191:192,pa=ha+" "+J.a.instance.ia(1969)+" "+fb):(mb=Ka?162:170,pa=ha+" "+J.a.instance.ia(1969)+" "+ua)):this.mna.Pw(1415868706)&&(this.qFa?W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)?this.grid.rtl?(mb=La?288:289,Ia=ib?369:370,pa=J.a.instance.ia(514)+" "+ha+" "+fb,lb=J.a.instance.ia(514)+" "+ha+" "+ua):(mb=La?336:337,Ia=ib?367:368,pa=J.a.instance.ia(514)+" "+ha+" "+ua,lb=J.a.instance.ia(514)+" "+ha+" "+fb):(mb=W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StringChangesForInsertOperation",!1)?this.grid.rtl?288:336:50,ha=W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StringChangesForInsertOperation",!1)?this.grid.rtl?289:337:117,mb=La?mb:ha):W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)?this.grid.rtl?(mb=La?290:291,Ia=ib?371:372,pa=ha+" "+fb,lb=ha+" "+ua):(mb=La?334:335,Ia=ib?373:374,pa=ha+" "+ua,lb=ha+" "+fb):(mb=W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StringChangesForInsertOperation",!1)?this.grid.rtl?290:334:178,ha=W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StringChangesForInsertOperation",!1)?this.grid.rtl?291:335:182,mb=La?mb:ha));0!==mb&&(mb=this.Ya.Sg(mb),W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)?(La=this.Ya.Oh(),pa&&(mb.label=pa),db?(La.buttons.push(mb),0!==Ia&&(Ia=this.Ya.Sg(Ia),lb&&(Ia.label=lb),La.buttons.push(Ia)),db.menu.vh.push(La)):(this.z5.buttons.push(mb),0!==Ia&&(db=this.Ya.Sg(Ia),lb&&(db.label=lb),this.z5.buttons.push(db)))):this.z5.buttons.push(mb))}Rzi(db){const mb=this.Ya.Oh();if(this.mna.Pw(1035996630))if(this.DD.Pw(this.Du,1035996630,this.selectedRanges,this.grid)){var Ia=this.Ya.Sg(this.grid.rtl?187:165);const pa=this.Ya.Sg(166);W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)?(mb.buttons.push(Ia),mb.buttons.push(pa),db.menu.vh.push(mb)):(this.z5.buttons.push(Ia),this.z5.buttons.push(pa))}else Ia=this.Ya.Sg(this.grid.rtl?188:173),db&&W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?(mb.buttons.push(Ia),mb.buttons.push(this.Ya.Sg(174)),db.menu.vh.push(mb)):(this.z5.buttons.push(Ia),this.z5.buttons.push(this.Ya.Sg(174)))}Szi(){const {GridContextMenu:db}=a(1149);let mb=null;this.H2a&&(mb=this.Ya.fz("ContextMenu.InsertCells",
null,J.a.instance.ia(345),1896159024),W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)||mb.menu.vh.push(this.z5));const Ia=this.Ya.Oh();db.Uzi(W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)&&this.H2a?Ia:this.z5,this.Ya,this.$);W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)&&this.H2a&&Ia.buttons.length&&mb.menu.vh.push(Ia);this.Xzi(mb);this.Tzi(mb);
this.Rzi(mb);(W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)&&mb&&0<mb.menu.vh.length||mb&&0<this.z5.buttons.length)&&this.menuSection.buttons.push(mb)}szi(db){var mb=0;let Ia=null;const pa=N.i(this.selectedRanges),lb=1<pa?J.a.instance.ia(429):J.a.instance.ia(2541);this.Uqc?this.mna.Pw(1405456548)?(mb=this.DD.Pw(this.Du,1405456548,this.selectedRanges,this.grid)?163:171,Ia=pa+" "+J.a.instance.ia(1969)+" "+lb):this.mDg&&(mb=this.DD.Pw(this.Du,1554436520,
this.selectedRanges,this.grid)?179:183,Ia=pa+" "+lb):this.mna.Pw(1554436520)&&(this.rFa?(mb=this.DD.Pw(this.Du,1554436520,this.selectedRanges,this.grid)?51:118,Ia=J.a.instance.ia(409)+" "+pa+" "+lb):(mb=this.DD.Pw(this.Du,1554436520,this.selectedRanges,this.grid)?179:183,Ia=pa+" "+lb));0!==mb&&(mb=this.Ya.Sg(mb),W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?(Ia&&(mb.label=Ia),db?db.buttons.push(mb):this.Tla.buttons.push(mb)):this.Tla.buttons.push(mb))}qzi(db){var mb=
0;let Ia=null;const pa=N.g(this.selectedRanges),lb=1<pa?J.a.instance.ia(426):J.a.instance.ia(2542);this.Uqc?this.mna.Pw(284490184)&&(mb=this.DD.Pw(this.Du,284490184,this.selectedRanges,this.grid)?164:172,Ia=pa+" "+J.a.instance.ia(1969)+" "+lb):this.mna.Pw(674605324)&&(this.qFa?(mb=this.DD.Pw(this.Du,674605324,this.selectedRanges,this.grid)?52:119,Ia=J.a.instance.ia(409)+" "+pa+" "+lb):(mb=this.DD.Pw(this.Du,674605324,this.selectedRanges,this.grid)?180:184,Ia=pa+" "+lb));0!==mb&&(mb=this.Ya.Sg(mb),
W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?(Ia&&(mb.label=Ia),db?db.buttons.push(mb):this.Tla.buttons.push(mb)):this.Tla.buttons.push(mb))}ozi(db){const mb=this.Ya.Oh();if(this.mna.Pw(1035996630))if(this.DD.Pw(this.Du,1035996630,this.selectedRanges,this.grid)){var Ia=this.Ya.Sg(this.grid.rtl?189:167),pa=this.Ya.Sg(168);W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?(pa.label="Shift cells up",
mb.buttons.push(Ia),mb.buttons.push(pa),db.menu.vh.push(mb)):(this.Tla.buttons.push(Ia),this.Tla.buttons.push(pa))}else Ia=this.Ya.Sg(this.grid.rtl?190:175),pa=this.Ya.Sg(176),db&&W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?(mb.buttons.push(Ia),mb.buttons.push(pa),db.menu.vh.push(mb)):(this.Tla.buttons.push(Ia),this.Tla.buttons.push(pa))}pzi(){let db=null,mb=null;this.H2a&&(db=this.Ya.fz("ContextMenu.DeleteCells",null,J.a.instance.ia(409),-1554384558),
W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)||db.menu.vh.push(this.Tla),mb=this.Ya.Oh());this.szi(mb);this.qzi(mb);db&&mb&&0<mb.buttons.length&&db.menu.vh.push(mb);this.ozi(db);(W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)&&db&&0<db.menu.vh.length||db&&0<this.Tla.buttons.length)&&this.menuSection.buttons.push(db)}}Object(x.a)(M,"CellsContextMenuGenerator",null,[]);class Q{constructor(db){this.ranges=
null;this.ranges=db}}Object(x.a)(Q,"MacroRecorderRangeHyperlinkRemovedPayload",null,[65]);var R=a(611),O=a(26),U=a(95),K=a(69),F=a(90),I=a(45),P=a(212),Y=a(62),ea=a(714),Ba=a(25),Fa=a(161),za=a(40),xa=a(647),fa=a(209),V=a(24),ba=a(423),la=a(213),Ta=a(27),Ea=a(1207),sa=a(93),Ya=a(97),bb=a(5),ra=a(355);class Da{constructor(db,mb){this.activeCell=this.selection=null;this.selection=db;this.activeCell=mb}getSelection(){return this.selection}getActiveCell(){return this.activeCell}}Object(x.a)(Da,"MacroRecorderToggleInCellControlCheckboxPayload",
null,[65]);var oa=a(643),Ha=a(1019),ka=a(548),wa=a(890),Za;let ab=Za=class extends w.a{constructor(db,mb,Ia,pa,lb,ha){super(db,"PopulateGridContextMenu",1247109494,-2064931494,Za.YZi,!0,!1,Za.L5a,ha,mb,!0,Ia,pa);this.GHc=this.expandCollapse=this.refresh=this.N4=this.Twa=this.TAa=!1;this.Phf=!0;this.m4d=!1;this.NXd=W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnhideRowColumnUXImprovementsSlice1",!1);this.Nxe=W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GridContextMenuMemoization",
!1);this.jeg=()=>{appChrome.api.dispatch([appChrome.actions.setButtonSecondaryText("ContextMenu.InsertHyperlink_Enabled",this.Ya.Mzc.uU(156)),appChrome.actions.setButtonSecondaryText("ContextMenu.InsertHyperlink_Disabled",this.Ya.Mzc.uU(156)),appChrome.actions.setButtonSecondaryText("ContextMenu.FormatCells_Enabled",this.Ya.Mzc.uU(406)),appChrome.actions.setButtonSecondaryText("ContextMenu.FormatCells_Disabled",this.Ya.Mzc.uU(406))])};this.grid=V.f(db);this.zoom=pa;this.PKc=!0;this.wEc=W.EwaSettings.isChangeGateEnabled("OfficeVSO:8620886_FilterByValueFGtoCG");
this.NTb=W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateReferenceFloatingInCellImages",!1);this.GZf=W.EwaSettings.isChangeGateEnabled("OfficeVSO:8055712_RelocatePictureInCellMenu");this.bWb=W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TransitionFloatingInCellImages",!1);this.dXd=W.EwaSettings.isChangeGateEnabled("OfficeVSO:8258028_FSingleTableCheck");this.kgj=W.EwaSettings.isChangeGateEnabled("OfficeVSO:8683004_FilterByColorCG2");if(this.wEc&&!bb.Xc.Ha())if(W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",
!1))mb=Ya.a.resolve(bb.Qd,{va:3}),Ia=Ya.a.resolve(bb.sc,{va:3}),pa=Ya.a.resolve(bb.wd,{va:3}),ha=Ya.a.resolve(bb.Zf,{va:3}),void Promise.all([mb,Ia,pa,ha]).then(ua=>{var [fb,Ka,La,ib]=ua;this.tZa=new Ea.GridContextMenuFilter(db,fb,Ka,La,ib,lb)});else{const ua=Object(sa.d)(Ya.a.resolve(bb.Qd,{va:3})),fb=Object(sa.d)(Ya.a.resolve(bb.sc,{va:3})),Ka=Object(sa.d)(Ya.a.resolve(bb.Zf,{va:3})),La=Object(sa.d)(Ya.a.resolve(bb.wd,{va:3}));za.TaskExtensions.Ua(za.TaskExtensions.Ln([ua,fb,La,Ka],this.xa),()=>
{this.tZa=new Ea.GridContextMenuFilter(db,ua.result,fb.result,La.result,Ka.result,lb)},this.xa,3)}}get vD(){return"PopulateGridContextMenu"}get DH(){return B.a.mxg}dispose(){super.dispose();this.$.shortcutKeyManager.wBg(this.jeg);this.grid=null}Bi(db,mb){db=!this.uWd(db,mb);if(!db)switch(mb){case -1977666927:db=this.jHk();break;case 1549396389:db=!this.ufj();break;case -81713080:db=!this.tfj()}return db}uWd(db,mb){const Ia=this.grid.ha.qa.selectedRanges;return(new Fa.a(this.$.sa)).Pw(db,mb,Ia,this.grid)}executeCommand(db,
mb,Ia){var pa=mb.command;db=null;switch(pa){case -1396319072:if(Ia=this.grid.kh(null))b.a.instance.jsd(!0),f.EventHandlerManager.instance.WFd(),Za.FZj(Ia);break;case -397772485:if(!W.EwaSettings.GU())break;this.toggleInCellControlCheckbox(mb);break;case -81713080:if(!W.EwaSettings.GU())break;Ia=this.grid.kh(null);pa=V.f(this.$).ha.$e.yh;if(null!==pa){pa.showE1ODialog();break}Ia&&Ia.inCellControlOptions&&1===Ia.inCellControlOptions.Type&&this.toggleInCellControlCheckbox(mb);break;case -1253126584:this.removeHyperlinksFromRange(this.grid.ha.qa.selectedRanges,
mb);break;case 324156914:db=this.grid.startEdit(!1,1);break;case 1441131127:this.showGridContextMenu(Ia);break;case -1977666927:bb.Xc.Ha()?db=Object(sa.d)(Ya.a.resolve(bb.Xc).then(lb=>lb.Wmf())):null!=this.tZa?db=this.tZa.Wmf():this.n0d();break;case 1549396389:bb.Xc.Ha()?db=Object(sa.d)(Ya.a.resolve(bb.Xc).then(lb=>lb.dnf())):null!=this.tZa?db=this.tZa.dnf():this.n0d();break;case 1803952894:case 486423932:case -652157481:case -1656122924:bb.Xc.Ha()?db=Object(sa.d)(Ya.a.resolve(bb.Xc).then(lb=>lb.$mf(mb))):
null!=this.tZa?db=this.tZa.$mf(mb):this.n0d();break;default:db=fa.a(pa)}return db||za.TaskExtensions.N$()}ni(db,mb,Ia){db=!1;switch(mb.command){case -1396319072:case -1253126584:case 324156914:case -1977666927:case 1549396389:case 1803952894:case 486423932:case -652157481:case -1656122924:db=!0;break;case -397772485:case -81713080:db=W.EwaSettings.GU();break;case 1441131127:db=!!Ia}return db}n0d(){c.ULS.sendTraceTag(509645913,0,10,"GridContextMenu:ExecuteCommand() - GridContextMenuFilter is null")}y_(db){db=
void 0===db?!1:db;var mb;let Ia=!1,pa=!1,lb=0;W.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(lb=r.a.rj());const ha=this.Ya.Vv(this.menuId);var ua=this.grid.ha.qa;const fb=ua.Gn,Ka=fb&&ua.Ui.fk,La=fb&&ua.Ui.isRow;ua=ua.selectedRanges;const ib=d.a.all(ua,Hc=>Hc.fk),Yb=d.a.all(ua,Hc=>Hc.isRow),Wc=I.U(ua),Qc=I.V(ua),Wb=this.dXd&&V.f(this.$).ha.qa.FI();let Jc=!1,ma=!1;if(this.NXd){const Hc=this.grid.mj;for(const Kb of ua)if(Jc=Kb.isRow&&Hc.Ymb(Kb),ma=Kb.fk&&
Hc.Ulb(Kb),Jc||ma)break}this.aZf(Ka,La)?(Ia=!0,this.DAi(ha)):this.$.isEditMode?ba.a(this.$)?this.EAi(ha,ib,Ka,La):(this.tzi(ha,!(La||Ka||!this.GHc)),this.GZf&&this.eAf(ha),this.grid.ha.qa.WRd()&&this.HAi(ha),this.Vzi(ha,ua,db),this.Vzf(ha,ib,Yb,Wc,Qc,Jc,ma),this.nAf(ha,ib,fb,Ka,La,Wb),!W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)&&W.EwaSettings.isChangeGateEnabled("OfficeVSO:8501332_ShareExcelNamedSheetView")&&(db=this.$.sa.na,(null===(mb=null===
db||void 0===db?void 0:db.Kj)||void 0===mb?0:mb.Ow)&&this.rAi(ha)),this.YAi(ha),W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?(this.cAf(ha,fb,Ka,La,ua,Wb),this.RGd(ha,Ka,La)):(this.RGd(ha,Ka,La),this.cAf(ha,fb,Ka,La,ua,Wb)),this.xzi(ha),this.vzi(ha,ua),this.bAi(ha),this.GZf||this.eAf(ha),this.SAi(ha,Yb,ib,fb,ua,Wb)):(pa=!0,ba.a(this.$)?this.gAf(ha,ib):(this.nBi(ha,ib,fb,Ka,La,ua,Wb),this.$.th.allowViewCollab&&this.Vzf(ha,ib,Yb,Wc,Qc,Jc,ma)));ha&&
0<ha.vh.length&&this.m4d&&this.$.shortcutKeyManager.o0e(this.jeg);W.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(mb=r.a.rj()-lb,c.ULS.sendTraceTag(537167046,0,50,`GridContextMenu::CreateMenuModel, ExecutionTimeTotal: ${mb}, isPivotMenu: ${Ia}, isViewMenu: ${pa}, firstTimeEntry: ${this.Phf}`));this.Phf=!1;return ha}KYa(db,mb){const Ia=[];if(ba.a(this.$))return Ia;var pa=this.grid.ha.qa,lb=pa.activeRange.isSingle,ha=V.f(this.$),ua=la.c(ha);const fb=(ha=
pa.Gn)&&pa.Ui.fk,Ka=ha&&pa.Ui.isRow;if(3===db){ua=mb=lb=!1;db=W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInEditMode",!1)&&this.$.isMobileMode&&this.$.isEditMode;this.$.isMobileMode&&(mb=pa.selectedRanges,lb=I.U(mb),mb=I.V(mb));if(ha){const La=V.d(this.grid);La&&La.range.contains(pa.Ui)&&this.P5(La)&&(ua=!0)}this.$.isEditMode?this.aZf(fb,Ka)?Ia.push(...[D.a.Y$d,D.a.Z$d]):fb||Ka?(Ia.push(D.a.clipboard),Ka?db?Ia.push(D.a.zEj):Ia.push(D.a.Drk):fb&&(db?Ia.push(D.a.yEj):Ia.push(D.a.FVh))):
(Ia.push(...[D.a.edit,D.a.clipboard]),db?Ia.push(D.a.xEj):ua?Ia.push(D.a.hyperlink):Ia.push(D.a.color),ha&&!db&&Ia.push(D.a.yHh)):(Ia.push(D.a.copy),ua&&Ia.push(D.a.openHyperlink),!Ka||this.$.isMobileMode&&mb?!fb||this.$.isMobileMode&&lb||Ia.push(D.a.M$k):Ia.push(D.a.N$k));db||Ia.push(D.a.OZi)}else 2===db&&(W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ProactiveColumnControls",!1)&&mb&&fb?(Ia.push(D.a.ldf),Ia.push(D.a.nLf)):W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9FloatieEnabled",
!1)&&W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?(pa=d.a.all(this.grid.ha.qa.selectedRanges,La=>La.fk),ha=d.a.all(this.grid.ha.qa.selectedRanges,La=>La.isRow),lb||ua||ha||pa?ua||!pa&&!ha?ua&&!lb?Ia.push(D.a.kRh):Ia.push(D.a.Lsd):Ia.push(D.a.zrk):Ia.push(D.a.jRh)):Ia.push(D.a.Lsd));return Ia}aZf(db,mb){return(this.TAa||this.Twa||this.N4||this.refresh||this.expandCollapse)&&!(db||mb)}showGridContextMenu(db){var mb;this.expandCollapse=this.refresh=
this.N4=this.Twa=this.TAa=!1;var Ia=this.$,pa=null;Ya.a.Zg(bb.qb)?pa=null===(mb=Ya.a.Zg(bb.qb))||void 0===mb?void 0:mb.CQb():void Ya.a.resolve(bb.qb,{va:0});var lb=this.grid.ha.qa;const ha=lb.Gn;mb=ha&&lb.Ui.fk;lb=ha&&lb.Ui.isRow;if(pa&&!mb&&!lb){mb=xa.a(Ia);if(null===mb||void 0===mb?0:mb.Soe)this.TAa=mb=U.g(Ia.Bk),this.Twa=!mb;mb=Ia.th;this.N4=pa.supportsBIExplore&&(W.EwaSettings.G5()||!!z.b(Ia))&&mb.aea(32768);mb.allowInteractivity&&(Ia=this.grid.kh(null),(null===Ia||void 0===Ia?0:Ia.cell)&&(Ia.cell.bsd||
Ia.cell.iQg)&&(this.expandCollapse=!0),mb.allowManualDataRefresh&&(this.refresh=!0))}Ia=null;pa=1;mb=Object(m.a)(k.a,db.eventArgs);db=Object(m.a)(C.a,db.creationParams);lb=this.bGi();db?(Ia=db.clientPoint,pa=db.inputMethod):mb&&1!==mb.oh?(Ia=new Sys.UI.Point(mb.clientPoint.x,mb.clientPoint.y),pa=mb.oh):lb&&(Ia=new Sys.UI.Point(lb.x+(this.$.isChromeRtl?0:lb.width),lb.y+lb.height));K.a.eh=pa;this.GHc=3===pa;db=u.Eb;this.Ft(Ia,!mb||mb.La.target.className!==db,pa,mb&&mb.La.button===Sys.UI.MouseButton.leftButton?
!0:!1)}removeHyperlinksFromRange(db,mb){if(!W.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.cy(db,!0)){var Ia=I.s(db,this.$),pa=this.$.pa.ta.Jh();this.$.userOperationManager.enqueueOperation(new P.a(125,0,(lb,ha,ua)=>{this.$.AD();return Y.b(this.$.pa.ta,Ia,"","",!0,!1,127,lb,ha,ua,null,pa)},void 0,()=>new Q(Ia)),mb);this.grid.Um.MT(!1)}}toggleInCellControlCheckbox(db){const mb=this.$.pa.ta.Jh(),Ia={};this.$.Mq(Ia);Ia.FirstRow=this.grid.ha.qa.activeCell.top;
Ia.FirstColumn=this.grid.ha.qa.activeCell.left;this.$.userOperationManager.enqueueOperation(new P.a(607,0,(pa,lb,ha)=>ra.H(this.$.pa.ta,I.s(this.grid.ha.qa.selectedRanges,this.$),Ia,pa,lb,ha,null,mb),64,()=>new Da(I.s(V.f(this.$).ha.qa.selectedRanges,this.$),Ia)),db)}bGi(){var db=this.grid.kh(null);if((null===db||void 0===db?0:db.cell.Fp)&&this.aYf(db))return this.grid.getCellBounds(db.cell);db=this.grid.ha.qa.activeCell;return(db=this.pwc(new O.Range(db.top,db.left,l.a.gl,db.left,!1,!1),2,!0)||this.pwc(new O.Range(1,
db.left,db.top,db.left,!1,!1),2,!1)||this.pwc(new O.Range(db.top,db.right,db.top,l.a.Qk,!1,!1),1,!0)||this.pwc(new O.Range(db.top,1,db.top,db.right,!1,!1),1,!1)||null)&&db.Fp?this.grid.getCellBounds(db):Sys.UI.DomElement.getBounds(this.grid.hga.Pi)}aYf(db){var mb=this.grid.rtl,Ia=this.$.isChromeRtl;db=db.cell;var pa=V.f(this.$).oU(db);return pa?(pa=pa.topLeft,mb=pa.x+=mb===Ia?db.offsetWidth:0,Ia=pa.y+=db.offsetHeight,this.grid.view.visibleArea.contains(new v.a(mb,Ia,0,0))):!1}pwc(db,mb,Ia){db=this.grid.ot("GridContextMenu.FindFirstCellInViewportArea",
db,mb,Ia);try{for(db.$$rst();db.$$mn();){const pa=db.$$cu();if(pa&&this.aYf(pa))return pa.cell}}finally{db&&db.dispose()}return null}DAi(db){const mb=this.Ya,Ia=mb.Oh();this.refresh&&Ia.buttons.push(mb.Sg(100));this.N4&&Ia.buttons.push(mb.Sg(99));this.TAa?Ia.buttons.push(mb.Sg(59)):this.Twa&&Ia.buttons.push(mb.Sg(58));if(this.expandCollapse){let pa;pa=mb.fz("ContextMenu.PivotExpandCollapse",null,J.a.instance.ia(1167),589118293);const lb=mb.Oh();lb.buttons.push(mb.Sg(243));lb.buttons.push(mb.Sg(244));
lb.buttons.push(mb.Sg(245));lb.buttons.push(mb.Sg(246));pa.menu.vh.push(lb);pa&&0<lb.buttons.length&&Ia.buttons.push(pa)}db.vh.push(Ia)}nAf(db,mb,Ia,pa,lb,ha){mb&&W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?(ha=this.Ya.Oh(),Ia=this.Ya.Sg(375),pa=V.f(this.$),Ia.label=pa.$.na.hasAutoFilter?J.a.instance.ia(2533):J.a.instance.ia(2538),ha.buttons.push(Ia),this.qxc(ha,mb),db.vh.push(ha)):!Ia||pa||lb||(Ia=this.Ya.Oh(),this.wEc&&!this.$.yM&&this.VGd(Ia),
this.qxc(Ia,mb),this.bBi(Ia,ha),db.vh.push(Ia))}qxc(db,mb){var Ia,pa;const lb=this.Ya.fz("ContextMenu.sort",null,J.a.instance.ia(227),-864298118);if(this.$.th.allowSorting&&(!this.$.isMobileMode||(new Fa.a(this.$.sa)).Hj(2048))){var ha=this.Ya.Oh(),ua=this.Ya.Oh(),fb=this.Ya.Oh(),Ka=this.Ya.Oh(),La=this.Ya.Sg(223),ib=this.Ya.Sg(224);if(W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)){const Yb=null===(pa=null===(Ia=V.f(this.$).kh(null))||void 0===
Ia?void 0:Ia.cell)||void 0===pa?void 0:pa.text;La.label=Yb.toLowerCase()===Yb.toUpperCase()?J.a.instance.ia(2529):J.a.instance.ia(2527);ib.label=Yb.toLowerCase()===Yb.toUpperCase()?J.a.instance.ia(2530):J.a.instance.ia(2528);ua.buttons.push(La);ua.buttons.push(ib);if(mb){lb.menu.vh.push(ua);db.buttons.push(lb);return}}else ha.buttons.push(La),ha.buttons.push(ib);mb=this.Ya.Sg(292);Ia=this.Ya.Sg(293);pa=this.Ya.Sg(294);W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)?(fb.buttons.push(mb),fb.buttons.push(Ia),fb.buttons.push(pa)):(ha.buttons.push(mb),ha.buttons.push(Ia),ha.buttons.push(pa));mb=this.Ya.Sg(225);this.$.isMobileMode||(W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?Ka.buttons.push(mb):ha.buttons.push(mb));W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?(lb.menu.vh.push(ua),lb.menu.vh.push(fb),lb.menu.vh.push(Ka)):lb.menu.vh.push(ha);db.buttons.push(lb)}}VGd(db){var mb,
Ia,pa,lb,ha,ua;const fb=this.Ya.fz("ContextMenu.filter",null,J.a.instance.ia(1970),2045563128),Ka=this.Ya.Oh();if(W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)){var La=this.Ya.Sg(375),ib=V.f(this.$);La.label=ib.$.na.hasAutoFilter?J.a.instance.ia(2533):J.a.instance.ia(2538);Ka.buttons.push(La)}else La=this.iLi(),ib=this.Ya.Sg(234),ib.label=La,Ka.buttons.push(ib),Ka.buttons.push(this.Ya.Sg(235));La=this.Ya.Oh();ib=this.Ya.Sg(233);ib.label=W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)?J.a.instance.ia(2522)+" "+(Object(wa.b)(null===(Ia=null===(mb=V.f(this.$).kh(null))||void 0===mb?void 0:mb.cell)||void 0===Ia?void 0:Ia.text)?"Null":null===(lb=null===(pa=V.f(this.$).kh(null))||void 0===pa?void 0:pa.cell)||void 0===lb?void 0:lb.text):J.a.instance.ia(222)+" "+(null===(ua=null===(ha=V.f(this.$).kh(null))||void 0===ha?void 0:ha.cell)||void 0===ua?void 0:ua.text);La.buttons.push(ib);if(W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)||this.kgj)La.buttons.push(this.Ya.Sg(313)),La.buttons.push(this.Ya.Sg(314)),La.buttons.push(this.Ya.Sg(315));fb.menu.vh.push(Ka);fb.menu.vh.push(La);db.buttons.push(fb)}bBi(db,mb){if(mb||!this.dXd&&V.f(this.$).ha.qa.FI()){mb=this.Ya.Oh();mb.buttons.push(this.Ya.Sg(232));mb.buttons.push(this.Ya.Sg(285));mb.buttons.push(this.Ya.Sg(286));const Ia=this.Ya.fz("ContextMenu.table",null,J.a.instance.ia(1969),-697806646);Ia.menu.vh.push(mb);db.buttons.push(Ia)}}Yzf(db,mb,Ia,pa,lb,ha){if(mb){var ua=I.Q(lb),
fb=V.d(this.grid);if(fb&&!Ia&&!pa){Ia=new Fa.a(this.$.sa);if(fb.range.contains(ua)&&this.P5(fb)){ua=!fb.yga&&!Ia.Dn;W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.HyperlinkImprovementSlice1",!1)?this.Nzi(db,fb.T$,ua):(ua&&this.$.isEditMode&&db.buttons.push(this.Ya.Sg(45)),fb.T$&&db.buttons.push(this.Ya.Sg(53)),ua&&this.$.isEditMode&&db.buttons.push(this.Ya.Sg(47)));!W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)&&W.EwaSettings.isChangeGateEnabled("OfficeVSO:8575759_CopyLinkContextMenu")&&
(W.EwaSettings.isChangeGateEnabled("OfficeVSO:8218038_moveCanShareExcelSectionToHelper")&&ka.a(this.$)||this.CIb())&&this.SGd(db,mb,lb,ha);return}!fb.yga&&this.$.isEditMode&&(fb=Ia.Hj(128),db.buttons.push(this.Ya.Sg(fb?46:121)),this.m4d=!0)}}this.qak(lb)&&db.buttons.push(this.Ya.Sg(48));if(W.EwaSettings.isChangeGateEnabled("OfficeVSO:8218038_moveCanShareExcelSectionToHelper")&&ka.a(this.$)||this.CIb())W.EwaSettings.isChangeGateEnabled("OfficeVSO:8575759_CopyLinkContextMenu")?W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)||this.SGd(db,mb,lb,ha):mb&&(mb=I.Q(lb),this.pak(mb,ha)?db.buttons.push(this.Ya.Sg(276)):mb.fk||mb.isRow||db.buttons.push(this.Ya.Sg(275)))}Nzi(db,mb,Ia){const pa=this.Ya.Oh();Ia&&this.$.isEditMode&&pa.buttons.push(this.Ya.Sg(45));mb&&pa.buttons.push(this.Ya.Sg(53));Ia&&this.$.isEditMode&&pa.buttons.push(this.Ya.Sg(47));pa.buttons.push(this.Ya.Sg(330));pa.buttons.push(this.Ya.Sg(331));mb=W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?J.a.instance.ia(2537):
J.a.instance.ia(404);mb=this.Ya.fz("ContextMenu.Hyperlink",void 0,mb,798637440);mb.menu.vh.push(pa);db.buttons.push(mb)}SGd(db,mb,Ia,pa){const lb=this.Ya.Oh();mb&&(mb=I.Q(Ia),mb.fk||mb.isRow||lb.buttons.push(this.Ya.Sg(310)),(pa||W.EwaSettings.isChangeGateEnabled("OfficeVSO:8627979_CopyLinkToTableFix")&&1===la.b(this.$,mb).length)&&lb.buttons.push(this.Ya.Sg(311)));lb.buttons.push(this.Ya.Sg(309));pa=this.Ya.Iqc("ContextMenu.CopyLink",void 0,J.a.instance.ia(2354),709515373,1,null,Ba.a.isFluentIconsEnabled()&&
W.EwaSettings.isChangeGateEnabled("OfficeVSO:8728203_CollabCornerIconFix")?"LinkToSection_20":"ShareSectionEntry_20");pa.menu.vh.push(lb);db.buttons.push(pa)}qak(db){for(const mb of db){db=this.grid.getRangeInformation(mb);for(let Ia=0;Ia<db.length;Ia++)if(Object(e.a)(R.HyperlinkRange,db[Ia])){const pa=this.grid.kh(db[Ia]);if(pa&&this.P5(pa)&&!pa.yga)return!0}}return!1}pak(db,mb){return(mb||!this.dXd&&V.f(this.$).ha.qa.FI())&&(mb=V.f(this.$).Yg.sl(db))&&mb.usedRange.equals(db)?!0:!1}rAi(db){const mb=
this.Ya.Oh();ka.a(this.$,!0)&&mb.buttons.push(this.Ya.Sg(317));db.vh.push(mb)}CIb(db){var mb=this.$.sa.na;return mb&&mb.Kj&&(mb=mb.Kj.Ow||mb.Kj.BM,!this.$.yM&&W.EwaSettings.isChangeGateEnabled("OfficeVSO:8096934_ShareExcelSection")&&ka.b(this.$)&&!this.$.ea.isNamedObjectViewMode&&!this.$.isMobileMode&&(W.EwaSettings.isChangeGateEnabled("OfficeVSO:8501332_ShareExcelNamedSheetView")&&db||!mb))?!0:!1}RGd(db,mb,Ia){var pa,lb;if(1===V.f(this.$).ha.wk&&!mb&&!Ia){mb=this.Ya.fz("ContextMenu.CommentCells",
null,J.a.instance.ia(2521),-488619629);Ia=this.Ya.fz("ContextMenu.NoteCells",null,J.a.instance.ia(2176),-1672124962);var ha=ba.a(this.$),ua=this.Ya,fb=ua.Oh(),Ka=ua.Oh(),La=ua.Oh(),ib=bb.Ob.Ha()?Ya.a.Zg(bb.Ob):this.$.ka.Ug(65);(null===(pa=null===ib||void 0===ib?void 0:ib.Bt)||void 0===pa?0:pa.lK)&&!ha&&(fb.buttons.push(ua.Sg(227)),La.buttons.push(ua.Sg(227)));ib&&ib.isCommentOperationEnabled(3)&&(fb.buttons.push(ua.Sg(221)),Ka.buttons.push(ua.Sg(221)));(null===(lb=null===ib||void 0===ib?void 0:ib.Bt)||
void 0===lb?0:lb.IOd)&&!ha&&(fb.buttons.push(ua.Sg(228)),La.buttons.push(ua.Sg(228)));(null===ib||void 0===ib?0:ib.hasCommentAtActiveCell)?ib.sI.isResolved||(fb.buttons.push(ua.Sg(159)),Ka.buttons.push(ua.Sg(159))):ib&&ib.hasCommentAtActiveCell||(ib&&ib.Bt&&ib.Bt.lK?ha||(fb.buttons.push(ua.Sg(229)),fb.buttons.push(ua.Sg(230)),La.buttons.push(ua.Sg(229)),La.buttons.push(ua.Sg(230))):(fb.buttons.push(ua.Sg(160)),ha||fb.buttons.push(ua.Sg(226))));W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)&&(Ka.buttons.length||La.buttons.length)?(pa=ua.Oh(),Ka.buttons.length&&(mb.menu.vh.push(Ka),pa.buttons.push(mb)),La.buttons.length&&(Ia.menu.vh.push(La),pa.buttons.push(Ia)),db.vh.push(pa)):db.vh.push(fb)}}YAi(db){if(W.EwaSettings.Ra(127)){const mb=this.Ya,Ia=mb.Oh();Ia.buttons.push(mb.Sg(250));db.vh.push(Ia)}}Vzi(db,mb,Ia){if(!Ia){Ia=this.$.Ma.gR();var pa=new Fa.a(this.$.sa),lb=new ea.a(Ia,mb,this.grid);(new M(db,this.$,this.Ya,Ia,mb,this.grid,lb,pa)).NGd()}}HAi(db){const mb=this.Ya.Oh();mb.buttons.push(this.Ya.Sg(100));
db.vh.push(mb)}Vzf(db,mb,Ia,pa,lb,ha,ua){const fb=(new Fa.a(this.$.sa)).Hj(8),Ka=this.Ya,La=Ka.Oh(),ib=this.grid.ha.qa.selectedRanges;var Yb=N.i(ib),Wc=N.g(ib);Yb=1<Yb?J.a.instance.ia(429):J.a.instance.ia(2541);var Qc=1<Wc?J.a.instance.ia(426):J.a.instance.ia(2542);Wc=J.a.instance.ia(519)+" "+Yb;Yb=J.a.instance.ia(520)+" "+Yb;const Wb=J.a.instance.ia(519)+" "+Qc;Qc=J.a.instance.ia(520)+" "+Qc;mb&&La.buttons.push(Ka.Sg(fb?152:153));Ia&&La.buttons.push(Ka.Sg(fb?150:151));mb&&(pa||(mb=Ka.Sg(fb?109:155),
mb.label=W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?Wb+" "+N.f(ib):J.a.instance.ia(438),La.buttons.push(mb)),!this.NXd||ua)&&(ua=Ka.Sg(fb?111:157),ua.label=W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?Qc+" "+N.f(ib):J.a.instance.ia(440),La.buttons.push(ua));Ia&&(lb||(Ia=Ka.Sg(fb?108:154),Ia.label=W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)?Wc+" "+N.j(ib):J.a.instance.ia(432),La.buttons.push(Ia)),!this.NXd||ha)&&(ha=Ka.Sg(fb?110:156),ha.label=W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?Yb+" "+N.j(ib):J.a.instance.ia(439),La.buttons.push(ha));db.vh.push(La)}tzi(db,mb){var Ia=this.Ya;const pa=Ia.Oh();db.vh.push(pa);mb&&pa.buttons.push(Ia.Sg(102));pa.buttons.push(Ia.Sg(42));pa.buttons.push(Ia.Sg(43));oa.a.rmj?(pa.buttons.push(Ia.Sg(44)),db=Ia.fz("ContextMenu.pasteSpecial",null,
J.a.instance.ia(2462),237279923),mb=Ia.Oh(),mb.buttons.push(Ia.Sg(354)),mb.buttons.push(Ia.Sg(355)),mb.buttons.push(Ia.Sg(356)),mb.buttons.push(Ia.Sg(357)),mb.buttons.push(Ia.Sg(358)),mb.buttons.push(Ia.Sg(359)),db.menu.vh.push(mb),db&&0<mb.buttons.length&&pa.buttons.push(db)):(Ia=this.AAi(Ia),db.vh.push(Ia))}AAi(db){const mb=db.Oh();mb.title=J.a.instance.ia(1147);mb.GSg=!1;mb.FSg=!1;mb.pYg=!1;let Ia;const pa=Ba.a.pYd(this.$);Ia=pa?7:6;db=db.$L("PasteOptionsGallery",Ia,7===Ia?"Size24by24With7Options":
"Size24by24",mb.title);mb.buttons.push(db);db.QC("ContextMenu.Paste",237279923,"QueryAdvancedPasteContextMenuGalleryIcon",1148,void 0,"Paste_24",1,n.a.Qmi,null,null,this.$.shortcutKeyManager.uk(176));db.QC("ContextMenu.PasteValues",-185374993,"QueryAdvancedPasteContextMenuGalleryIcon",1149,void 0,"PasteValues_24",1,n.a.Ymi,null,null,this.$.shortcutKeyManager.uk(178));db.QC("ContextMenu.PasteFormulas",1766348718,"QueryAdvancedPasteContextMenuGalleryIcon",1150,void 0,"PasteFormulas_24",1,n.a.Tmi);db.QC("ContextMenu.PasteTranspose",
-958589048,"QueryAdvancedPasteContextMenuGalleryIcon",1151,void 0,"PasteTranspose_24",1,n.a.Xmi);db.QC("ContextMenu.PasteFormatting",1804571062,"QueryAdvancedPasteContextMenuGalleryIcon",1152,void 0,"PasteFormatting_24",1,n.a.Smi);pa&&db.QC("ContextMenu.PasteLink",42074747,"QueryAdvancedPasteContextMenuGalleryIcon",1153,void 0,"PasteLink_24",1,n.a.Vmi);db.QC("ContextMenu.PasteWithColumnWidths",264209770,"QueryAdvancedPasteContextMenuGalleryIcon",2299,void 0,"PasteWithColumnWidths_24",1);return mb}nBi(db,
mb,Ia,pa,lb,ha,ua){var fb;const Ka=this.Ya;var La=Ka.Oh();La.buttons.push(Ka.Sg(43));db.vh.push(La);this.wEc&&!this.$.yM&&Ha.i(this.$,this.grid)&&(La=this.Ya.Oh(),this.VGd(La),db.vh.push(La));W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInReadOnlyEditMode",!1)&&this.$.ea.th.isMobileMode&&this.$.ea.th.isReadOnlyEditMode&&!this.$.ua.IsMeetingLiveSession||(La=this.Ya.Oh(),this.qxc(La,mb),db.vh.push(La),c.ULS.sendTraceTag(537167045,0,50,"GridContextMenu::GenerateViewMenuSection, Remove the sort options from right contextual menu in mobile, readonlyeditmode and non-meeting scenario"));
mb=bb.Ob.Ha()?Ya.a.Zg(bb.Ob):this.$.ka.Ug(65);if(null===(fb=null===mb||void 0===mb?void 0:mb.Bt)||void 0===fb?0:fb.lK)fb=this.Ya.Oh(),fb.buttons.push(Ka.Sg(229)),db.vh.push(fb);fb=this.Ya.Oh();this.Yzf(fb,Ia,pa,lb,ha,ua);0<fb.buttons.length&&db.vh.push(fb);t.AFrameworkApplication.isMobileMode&&!F.a(this.$.ua,29)&&(Ia=Ka.Oh(),Ia.buttons.push(Ka.Sg(272)),db.vh.push(Ia))}cAf(db,mb,Ia,pa,lb,ha){const ua=this.Ya.Oh();Ba.a.mUb()?this.Gzi(ua):this.uAi(ua);this.Yzf(ua,mb,Ia,pa,lb,ha);0<ua.buttons.length&&
db.vh.push(ua)}uAi(db){db.buttons.push(this.Ya.Sg(135))}Gzi(db){var mb,Ia;300;if(W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)){const pa=null===(Ia=null===(mb=V.f(this.$).kh(null))||void 0===mb?void 0:mb.cell)||void 0===Ia?void 0:Ia.text;mb=pa.toLowerCase()===pa.toUpperCase()?this.Ya.Sg(361):this.Ya.Sg(362);db.buttons.push(mb)}else db.buttons.push(this.Ya.Sg(300));this.m4d=!0}SAi(db,mb,Ia,pa,lb,ha){var ua;if(W.EwaSettings.Ra(418)&&pa){var fb=this.Ya.Oh();
!W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)||mb||Ia||(this.SGd(fb,pa,lb,ha),W.EwaSettings.isChangeGateEnabled("OfficeVSO:8501332_ShareExcelNamedSheetView")&&(mb=this.$.sa.na,(null===(ua=null===mb||void 0===mb?void 0:mb.Kj)||void 0===ua?0:ua.Ow)&&ka.a(this.$,!0)&&fb.buttons.push(this.Ya.Sg(317))));fb.buttons.push(this.Ya.Sg(262));db.vh.push(fb)}}eAf(db){if(this.bWb&&this.NTb){var mb=!1;if(this.grid.Yg.yTb(this.$.na.activeCell)){var Ia=this.grid.ha.qa.selectedRanges;
if(Ia&&Ia.length){var pa=this.Ya,lb=pa.Oh(),ha=pa.Oh();for(var ua=0;ua<Ia.length&&!mb;ua++)!mb&&this.grid.Yg.yTb(Ia[ua])&&(mb=!0);mb&&(ha.buttons.push(pa.Sg(304)),ha.buttons.push(pa.Sg(217)));0<ha.buttons.length&&(ua=pa.fz("ContexMenu.PictureInCellFlyOut_EnabledContents",null,J.a.instance.ia(2303),798637440),ua.menu.vh.push(ha),lb.buttons.push(ua));mb&&!this.grid.Yg.ESd(Ia[0])&&lb.buttons.push(pa.Sg(302));0<lb.buttons.length&&db.vh.push(lb)}}}}bAi(db){var mb=this.grid.ha.qa.selectedRanges;if(mb&&
mb.length){var Ia=!1;for(var pa=0;pa<mb.length;pa++)if(this.grid.Yg.MKa(mb[pa])){Ia=!0;break}if(Ia){Ia=!1;for(pa=0;pa<mb.length;pa++){var lb=this.grid.Yg.xQi(mb[pa]);if(null!=lb&&null!=lb[0]){for(var ha=0;ha<lb.length;ha++)if(this.grid.Yg.MKa(lb[ha])){Ia=!0;break}if(Ia)break}}ha=this.Ya;pa=ha.Oh();lb=ha.Oh();var ua=1===mb.length&&(mb[0].isSingle||this.grid.Yg.knb(mb[0])),fb=!1,Ka=!1,La=!1,ib=!1;for(let Yb=0;Yb<mb.length&&!(fb&&La&&Ka&&ib);Yb++)!fb&&this.grid.Yg.Rlj(mb[Yb])&&(fb=!0),!La&&this.grid.Yg.PXf(mb[Yb],
!1)&&(La=!0),!Ka&&this.grid.Yg.PGc(mb[Yb])&&(Ka=!0),!ib&&this.grid.Yg.yTb(mb[Yb])&&(ib=!0);this.bWb&&this.NTb||(ua&&!this.grid.Yg.mTb(mb[0])&&(ib?pa.buttons.push(ha.Sg(217)):pa.buttons.push(ha.Sg(216))),ib&&!this.grid.Yg.ESd(mb[0])&&pa.buttons.push(ha.Sg(302)));ib=fb;ib=!(new Fa.a(this.$.sa)).Dn&&ib;La&&!Ia&&(W.EwaSettings.Ra(123)&&U.m(this.$.Bk)&&(lb.buttons.push(ha.Sg(220)),Ka&&lb.buttons.push(ha.Sg(ib?218:269)),ua&&(this.grid.Yg.PGc(mb[0])||this.grid.Yg.mTb(mb[0]))&&lb.buttons.push(ha.Sg(ib?219:
270))),lb.buttons.push(ha.Sg(ib?215:268)));0<lb.buttons.length&&(mb=ha.fz(fb?"ContexMenu.LinkedEntitiesFlyOut_EnabledContents":"ContexMenu.LinkedEntitiesFlyOut_DisabledContents",null,J.a.instance.ia(1783),798637440),mb.menu.vh.push(lb),pa.buttons.push(mb));0<pa.buttons.length&&db.vh.push(pa)}}}vzi(db,mb){this.grid.Yg.IVf(mb)&&(mb=this.Ya.Oh(),this.grid.ha.qa.aya()?(mb.buttons.push(this.Ya.Sg(241)),mb.buttons.push(this.Ya.Sg(239))):mb.buttons.push(this.Ya.Sg(240)),db.vh.push(mb))}P5(db){return db.cell.hasHyperlink}gAf(db,
mb){this.FAi(db);const Ia=this.Ya.Oh();this.qxc(Ia,mb);db.vh.push(Ia);this.wEc&&Ha.i(this.$,this.grid)&&(mb=this.Ya.Oh(),this.VGd(mb),db.vh.push(mb))}EAi(db,mb,Ia,pa){this.gAf(db,mb);this.RGd(db,Ia,pa)}FAi(db){if(this.grid.ha.qa.Gn&&!this.grid.Pg.Uo){var mb=this.Ya,Ia=mb.Oh();this.zoomManager.ype()?Ia.buttons.push(mb.Sg(265)):Ia.buttons.push(mb.Sg(264));db.vh.push(Ia)}}static FZj(db){db.invoke(Za.O6i,null)}static Uzi(db,mb,Ia){(Ia=Ia.ka.Ug(254))?(Ia.FUb()&&Ia.F2f()&&Ia.enb()&&db.buttons.push(mb.Sg(212)),
Ia.FUb()&&Ia.HIc()&&Ia.enb()&&db.buttons.push(mb.Sg(213))):c.ULS.sendTraceTag(537167044,0,50,"GridContextMenu::GenerateInsertCopiedCutCellsConextMenu, CopyPasteInfrastructure is not ready.")}jHk(){var db=Ya.a.Zg(bb.hg);db=W.EwaSettings.isChangeGateEnabled("OfficeVSO:8140911_FiltersJsCrash")?null===db||void 0===db?void 0:db.Zv:db.Zv;const mb=this.grid.ha.qa.activeCell;return null!=db&&!db.hasActiveFilter||la.d(this.$,mb)||!this.vfj(mb)}vfj(db){const mb=db.left;var Ia=this.pMd();if(null!=Ia&&null!=
Ia.fwc&&Ia.fwc.includes(mb-1))return!0;Ia=this.WLd();return null!=Ia&&I.G(Ia).contains(db)&&null!=Ia.FilteredColumns&&Ia.FilteredColumns.includes(mb-1)?!0:!1}ufj(){var db=Ya.a.Zg(bb.hg);db=W.EwaSettings.isChangeGateEnabled("OfficeVSO:8140911_FiltersJsCrash")?null===db||void 0===db?void 0:db.Zv:db.Zv;if(null!=db)return db.hasAutoFilter&&db.hasActiveFilter;db=this.pMd();if(null!=db)return null!=db.fwc&&0<db.fwc.length;db=this.WLd();return null!=db&&I.G(db).contains(this.grid.ha.qa.activeCell)&&null!=
db.FilteredColumns&&0<db.FilteredColumns.length}tfj(){if(!W.EwaSettings.GU())return!1;const db=this.grid.kh(null);return null!==V.f(this.$).ha.$e.yh||db&&db.inCellControlOptions&&1===db.inCellControlOptions.Type?!0:!1}pMd(){const db=Ya.a.Zg(bb.hg);if(!db)return c.ULS.sendTraceTag(508680020,0,50,"GridContextMenu:getTableFilterRangeFromActiveCell - tableManager is null"),null;const mb=db.my(this.grid.ha.qa.activeCell);return mb?db.fPb(mb):null}WLd(){const db=this.$.sa.getItemByName(this.$.na.sheetName);
return db?db.WK:null}iLi(){var db=this.grid.ha.qa.activeCell,mb=0,Ia=!1,pa=Ya.a.Zg(bb.hg),lb=this.pMd();pa=W.EwaSettings.isChangeGateEnabled("OfficeVSO:8140911_FiltersJsCrash")?null===pa||void 0===pa?void 0:pa.Zv:pa.Zv;null!=pa?(mb=pa.usedRange.top,Ia=!0):null!=lb?(mb=lb.top,Ia=!0):(lb=this.WLd(),null!=lb&&I.G(lb).contains(db)&&(mb=lb.FirstRow+1,Ia=!0));return Ia?(db=db.left,mb=O.Range.gi(mb,db),mb=this.grid.kh(mb),Ia="",null!=mb&&(Ia=mb.text),this.OKh(Ia,db)):J.a.instance.ia(220)}OKh(db,mb){return null==
db||Ta.a.qm(db.trim())?String.format(J.a.instance.$g(157),O.Range.OT(mb)):db.length>Za.xBe?String.format(J.a.instance.$g(155),db.substring(0,Za.xBe)):String.format(J.a.instance.$g(156),db)}};ab.L5a="GridContextMenuRootName";ab.YZi=B.a.hff;ab.O6i=192;ab.xBe=26;ab=Za=Object(y.__decorate)([Object(Ya.d)(bb.Yc),Object(y.__param)(0,Object(bb.Lb)()),Object(y.__param)(1,Object(bb["if"])()),Object(y.__param)(2,Object(bb.cb)()),Object(y.__param)(3,Object(bb.Lg)()),Object(y.__param)(4,Object(bb.gc)())],ab);
Object(x.a)(ab,"GridContextMenu",w.a,[])},1207:function(y,x,a){a.r(x);a.d(x,"GridContextMenuFilter",function(){return Ba});y=a(179);x=a(0);var c=a(14),b=a(31),f=a(1197),r=a(26),d=a(1020),k=a(150),t=a(45),m=a(419),e=a(212),w=a(355),l=a(62),u=a(189),n=a(356),v=a(86),B=a(35),z=a(252),C=a(1),D=a(27),J=a(262),W=a(24),N=a(151),M=a(935),Q=a(948),R=a(140),O=a(44),U=a(66),K=a(10),F=a(5),I=a(97),P=a(1019),Y=a(938),ea;(function(Fa){Fa[Fa.none=0]="none";Fa[Fa.once=1]="once";Fa[Fa.twice=2]="twice"})(ea||(ea={}));
Object(x.b)("ToggleState",ea);let Ba=class{constructor(Fa,za,xa,fa,V,ba){ba=void 0===ba?null:ba;this.ZX=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NsvEntryOptimizationApplyForEveryone",!1);this.Yda=this.Wwb=this.Ywb=0;this.vv=null;this.$=Fa;this.da=W.f(this.$);this.oC=za;this.ek=xa;this.GD=V;this.instantaneousSupportInformationManager=fa;this.vK=M.a.qTb();this.vv=ba}Wmf(){var Fa=P.e(this.da);Fa={["CommandValueId"]:O.c(Fa)};const za=new v.a(-2058042992,2,this.$.Rh,19,null);c.ULS.sendTraceTag(527500302,
0,50,"GridContextMenuFilter::DoClearFilter GridContextMenu ClearFilter command executed");return this.$.Ma.dh(za,Fa)}dnf(){const Fa=new v.a(644342024,2,this.$.Rh,19,null);c.ULS.sendTraceTag(527500301,0,50,"GridContextMenuFilter::DoReapplyFilter GridContextMenu ReapplyFilter command executed");return this.$.Ma.dh(Fa)}$mf(Fa){const za=this.da.ha.qa.activeCell;var xa=I.a.Zg(F.hg);const fa=xa.Zv;xa=xa.fPb(za);return fa||xa?this.hdi(fa,xa,za,Fa.command):this.gdi(za,Fa.command)}hdi(Fa,za,xa,fa){if(this.bSh(Fa,
za,xa))return c.ULS.sendTraceTag(527500300,0,50,"GridContextMenuFilter::doFilterForTable Header/Total error dialog raised for FilterByValue in Table"),U.Task.Va(!1);if(null!=Fa&&Fa.hasAutoFilter||null!=za&&za.eNh.every(V=>0!=V.length))return this.Ywb=ea.none,this.applyFilter(fa);this.Ywb=ea.once;return this.vtc(ea.once,fa)}gdi(Fa,za){var xa=t.w(this.da.ha.qa.Ui,this.$);xa=this.da.$.sa.getItemByName(xa.SheetName);const fa=t.G(xa.WK);if(this.aSh(fa,Fa))return c.ULS.sendTraceTag(527500299,0,50,"GridContextMenuFilter::DoFilterByValue Header/EmptyRange error dialog raised for FilterByValue in Sheet"),
U.Task.Va(!1);if(xa.hasAutoFilter){if(fa&&fa.contains(this.da.ha.qa.activeCell))return this.Ywb=ea.none,this.applyFilter(za);this.Ywb=ea.twice;return this.vtc(ea.twice,za)}this.Ywb=ea.once;return this.vtc(ea.once,za)}vtc(Fa,za){const xa=t.w(this.da.ha.qa.Ui,this.$);if(!xa)return U.Task.Va(!1);this.Wwb||(this.Wwb=Date.now());const fa=new v.a(368460465,2,this.$.Rh,19,null),V=this.$.pa.ta.Jh(),ba=()=>new f.a(xa),la=Ta=>{z.a(Ta)?c.ULS.sendTraceTag(527500297,0,50,"GridContextMenuFilter::doToggleAndFilter service call failed with errors : {}"):
(c.ULS.sendTraceTag(527500298,0,50,"GridContextMenuFilter::ToggleFilter service call succeeded"),Fa===ea.twice?this.vtc(ea.once,za):this.applyFilter(za))};return m.a(this.$.userOperationManager,(Ta,Ea,sa)=>w.G(this.$.pa.ta,xa,J.c(Ta,la),Ea,sa,null,V),Ta=>new e.a(516,0,Ta,64,ba),fa)}bSh(Fa,za,xa){return null!=Fa&&u.d(Fa)&&xa.top===Fa.usedRange.top||null!=za&&za.Swa&&xa.top===za.top?(this.$Qc(this.$,223),!0):null!=Fa&&u.g(Fa)&&xa.top===Fa.usedRange.bottom?(this.$Qc(this.$,224),!0):!1}aSh(Fa,za){if(Fa&&
Fa.contains(za)&&za.top===Fa.top||!Fa&&this.TQh(za.top,za.left))return this.$Qc(this.$,225),!0;if(Fa&&Fa.contains(za))return!1;Fa=new r.Range(1<za.top?za.top-1:za.top,1<za.left?za.left-1:za.left,za.top<K.a.gl?za.top+1:za.top,za.left<K.a.Qk?za.left+1:za.left,!1,!1);return this.da.Yg.FKa(Fa)?(this.$Qc(this.$,226),!0):!1}$Qc(Fa,za){za=B.a.Yi(1,1,751,za,0,158204905,"ContextMenuFilterUnsupported");new n.a(Fa,za)}applyFilter(Fa){switch(Fa){case 1803952894:return this.MEh();case 486423932:case -652157481:case -1656122924:return this.Mlc(Fa);
default:return U.Task.Va(!1)}}MEh(){this.Yda=Date.now();const Fa=this.gYi();if(!Fa)return c.ULS.sendTraceTag(527500296,0,50,"GridContextMenuFilter::ApplyFilterByValue . CellValue returned is null"),U.Task.Va(!1);const za=P.e(this.da),xa=P.b(this.$,za),fa={};fa.FirstRow=P.f(this.da,this.$);fa.FirstColumn=za.Column;const V=Ea=>{var sa,Ya={["ToggleFilterOperationCount"]:this.Ywb,["ApplyFilterTime"]:this.Yda?Date.now()-this.Yda:-1,["ToggleAndApplyFilterTime"]:this.Wwb?Date.now()-this.Wwb:-1,["FilterByValueType"]:za.AutoFilterType};
c.ULS.sendTraceTag(527500295,0,50,`GridContextMenuFilter::ApplyFilterByValue Perf Telemetry : ${JSON.stringify(Ya)}`);this.Wwb&&(this.Wwb=0);M.a.NOa(Ea)&&(Ya=M.a.vIa(Ea),this.vK?M.a.PK(Q.a.filterByCellValue,Ya.MessageIdName,R.a.gea,!0,M.a.$xa(Ya.MessageId)):c.ULS.sendTraceTag(527500294,0,10,`GridContextMenuFilter::ApplyFilterByValue failed with FilterException -${Ya.MessageIdName}`));z.a(Ea)?(Ea=B.a.Kh(Ea.Errors),c.ULS.sendTraceTag(527500292,0,50,`GridContextMenuFilter::ApplyFilterByValue service call failed with errors : ${Ea}`)):
(c.ULS.sendTraceTag(527500293,0,50,"GridContextMenuFilter::ApplyFilterByValue service call succeeded"),N.b(this.$).lj(k.a.k7d,P.g(),void 0,!0),-1!==fa.FirstRow&&(Ya=t.F(fa),P.k(this.$,Ya)),C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowFilteredResultsInStatusBar",!1)&&(null===(sa=this.vv)||void 0===sa?void 0:sa.UAa(Ea.Result,"Table"===za.AutoFilterType,za.Id)))};var ba=fa&&-1!==fa.FirstRow?r.Range.gi(fa.FirstRow,fa.FirstColumn):null;ba=6|(Object(Y.p)(this.$,ba)?128:0);const la=new e.a(208,
0,(Ea,sa,Ya)=>l.a(this.$.pa.ta,xa,Fa,J.c(Ea,V),sa,Ya,null,null),ba,()=>new d.a(Fa,xa)),Ta=()=>{this.$.userOperationManager.enqueueOperation(la,null)};ba=this.$.ea.th.allowViewCollab&&C.EwaSettings.isChangeGateEnabled("OfficeVSO:8581585_NsvEntryExitOptimizationInRealTimeView");this.ZX||ba?this.GD.PMa(Ta,19,"GridContextMenuFilter::ApplyFilterByValue"):this.oC?this.oC.W6a().continueWith(Ea=>{Ea.result&&Ta()}):Ta();return U.Task.Va(!0)}Mlc(Fa){const za=P.e(this.da);za.ColorOrIconOptions=P.d(Fa,this.da);
Fa=P.h(this.da,this.$,za.Column);P.a(this.$,za,Fa,this.GD,this.ZX,this.vv);return U.Task.Va(!0)}TQh(Fa,za){Fa=r.Range.gi(Fa,za);return this.da.za.Wta(Fa,this.$.na.name)&&(Fa=this.da.za.Gma(Fa))&&Fa.autoFilterMenu?!0:!1}gYi(){var Fa=null;const za=this.da.kh(this.da.ha.qa.activeCell);if(!za)return null;const xa=za.cell.FYc,{category:fa}=this.instantaneousSupportInformationManager.Rqa(xa,!1);if(1===za.Xn.type)if(3===fa){if(!za.cell.numFmt)return c.ULS.sendTraceTag(527500290,0,15,`GridContextMenuFilter::GetValueForFilter() for category : ${fa}. NumFmt is null. `),
null;Fa=(za.cell.numFmt.Start+za.cell.numFmt.End).trim()}else if(!fa&&(D.a.Sfb(za.Xn.value,"E")||D.a.Sfb(za.originalText,"E"))){Fa=this.ek.eGd(za.Xn.value,xa,1,Number.POSITIVE_INFINITY,za.cell.d4);if(!Fa.success)return c.ULS.sendTraceTag(527500289,0,50,`GridContextMenuFilter::GetValueForFilter() for category : ${fa}. Failed to acquire formatted value`),null;Fa=Fa.lM}Fa||(Fa=za.originalText);return b.a.JVa(Fa)?["[Blanks]"]:["i"+Fa.trim()]}};Ba=Object(y.__decorate)([Object(I.d)(F.Xc),Object(y.__param)(0,
Object(F.Lb)()),Object(y.__param)(1,Object(F.Qd)()),Object(y.__param)(2,Object(F.sc)()),Object(y.__param)(3,Object(F.wd)()),Object(y.__param)(4,Object(F.Zf)()),Object(y.__param)(5,Object(F.gc)())],Ba);Object(x.a)(Ba,"GridContextMenuFilter",null,[])},198:function(y,x,a){function c(S,Wa,zb,hc,cd){S=void 0===S?null:S;Wa=void 0===Wa?P.NotSelected:Wa;zb=void 0===zb?null:zb;hc=void 0===hc?!1:hc;cd=void 0===cd?null:cd;return{displayText:S?nb.a.zm(S):S,state:Wa,key:zb,parent:null,children:cd,indentationLevel:0,
expanded:hc}}function b(S,Wa,zb,hc,cd){const ta={};ta.Location=S;ta.IsPivotFilter=!0;ta.FieldId=Wa;ta.DataSourceIndex=zb;ta.AnchorType=hc.AnchorType;ta.ChartId=hc.ChartId;ta.AnchorValue1=hc.AnchorValue1;ta.AnchorValue2=hc.AnchorValue2;ta.HierarchyLevel=cd;return ta}a.r(x);var f={};a.r(f);a.d(f,"AutoFilterContextMenu",function(){return Xa});var r={};a.r(r);a.d(r,"AutoFilterFieldListContextMenu",function(){return wd});var d={};a.r(d);a.d(d,"FloatingObjectContextMenu",function(){return xb});var k={};
a.r(k);a.d(k,"ChartContextMenu",function(){return ld});var t={};a.r(t);a.d(t,"ReactContextMenuController",function(){return Tc});var m={};a.r(m);a.d(m,"ContextMenuManager",function(){return mc});var e={};a.r(e);a.d(e,"FieldListContextMenu",function(){return Ac});var w={};a.r(w);a.d(w,"FieldListPivotContextMenu",function(){return te});var l={};a.r(l);a.d(l,"FieldWellContextMenu",function(){return ie});var u={};a.r(u);a.d(u,"PivotFilterContextMenu",function(){return tf});var n={};a.r(n);a.d(n,"PivotPageFilterContextMenu",
function(){return wc});var v={};a.r(v);a.d(v,"PivotTableContextMenu",function(){return Fc});var B={};a.r(B);a.d(B,"PulloutFieldListContextMenu",function(){return Ce});var z={};a.r(z);a.d(z,"RichTextContextMenu",function(){return of});var C={};a.r(C);a.d(C,"SheetOpsContextMenu",function(){return Gf});var D={};a.r(D);a.d(D,"SlicerContextMenu",function(){return Pa});var J={};a.r(J);a.d(J,"TimeSlicerContextMenu",function(){return Gc});var W={};a.r(W);a.d(W,"TimeSlicerLevelMenu",function(){return ge});
var N=a(179),M=a(0),Q=a(2),R=a(14),O=a(188),U=a(42),K=a(6),F=a(182),I=a(259),P;(function(S){S[S.NotSelected=0]="NotSelected";S[S.Selected=1]="Selected";S[S.PartiallySelected=2]="PartiallySelected"})(P||(P={}));var Y=a(909),ea=a(7),Ba=a(479),Fa=a(484),za=a(651),xa=a(69),fa=a(65),V=a(1020),ba=a(150),la=a(45),Ta=a(212),Ea=a(62),sa=a(79),Ya=a(932),bb=a(161),ra=a(40),Da=a(122),oa=a(225),Ha=a(86),ka=a(74),wa=a(39),Za=a(35),ab=a(252),db=a(1),mb=a(209),Ia=a(12),pa=a(73),lb=a(262),ha=a(24),ua=a(151),fb=a(935),
Ka=a(948),La=a(141),ib=a(140);class Yb{constructor(){this.Sections=this.Id=null}}Object(M.a)(Yb,"AutoFilterMenu",null,[]);class Wc{constructor(){this.Disabled=!1;this.RibbonCommand=this.Identifier=this.Type=0;this.SubMenu=this.Label=this.CommandData=null;this.IsChecked=!1;this.TooltipText=this.Id=this.IconName=null}}Object(M.a)(Wc,"MenuItem",null,[]);class Qc{constructor(){this.Title=this.MenuItems=this.Id=null;this.DisplayType=0}}Object(M.a)(Qc,"MenuSection",null,[]);var Wb=a(1531),Jc=a(66),ma=a(93),
Hc=a(149),Kb=a(255),pc=a(10),$b=a(97),Ib=a(5),Zb=a(1019),Eb=a(897),ob=a(1198),Na=a(437),nb=a(98),Hb=a(938),na;const Gb=ea.a.KYh;let Xa=na=class extends Y.a{constructor(S,Wa,zb,hc,cd,ta,wb){ta=void 0===ta?null:ta;super(S,"PopulateAutoFilterContextMenu",1675506831,1651433993,Gb,!0,!1,"AutoFilterContextMenuRoot",wb,Wa,!1,zb,hc);this.Nlc=this.tZ=this.IWa=null;this.oib=this.rXb=!1;this.Nxd=this.xrb=this.rjf=this.Q3a=this.Ezc=this.jma=this.jwb=this.hV=null;this.ZX=db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NsvEntryOptimizationApplyForEveryone",
!1);this.Olc=this.SNb=this.pib=this.qM=this.vv=null;this.Mw=db.EwaSettings.Bn("AutoFilterContextMenu");this.jqj=db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutoFilterAsyncUiMeasurement",!1);this.v0f=db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutoFilterItemsAsyncUiMeasurement",!1);this.Yda=0;this.SI=()=>{this.sqa();this.$.ea.dv(this.SI)};this.Pq=()=>{this.sqa();this.$.ea.qB(this.Pq)};this.nqb=ic=>{this.oib||ua.b(this.$).lj(ba.a.Hhg,Zb.g(),void 0,!0);var Oa={};this.$.Mq(Oa);
var Cb=this.$.ea.isNamedObjectViewMode;const yc=fa.a.Gp(this.Nlc);yc.SheetName=Cb?Oa.NamedObjectName:Oa.SheetName;yc.NamedObjectView=Cb;Oa=!!ic.searchText;Cb=586;this.oib&&(Oa&&(yc.ItemListOptions=this.L0h(ic.searchText),Cb=597),ua.b(this.$).lj(ba.a.Hhg,{["UserOperation"]:Cb.toString()},void 0,!0));const Nc=this.i_b(Oa),Id=this.ZMc(),ke=this.$.pa.ta.Jh();this.rjf=ke.RequestId;this.oib&&this.Ezc&&!this.Ezc.dequeueUtcTime&&(this.$.userOperationManager.cva(this.Ezc),this.kQh());ic=new Ta.a(Cb,0,(Ie,
Le,wf)=>this.Nxd=Ea.o(this.$.pa.ta,yc,lb.c(Ie,Nc),this.oib?lb.b(Le,Id):Le,wf,null,ke),80);this.Ezc=this.$.userOperationManager.enqueueOperation(ic,null);this.xrb=this.Nxd;this.Q3a=this.rjf};this.onMenuItemClick=(ic,Oa,Cb)=>{ua.b(this.$).lj(ba.a.eVj,Zb.g(),void 0,!0);Oa={["CommandValueId"]:Oa,["MenuItemId"]:Oa,["InputMethod"]:Cb,["TopCellAddress"]:this.tZ};const yc=new Ha.a(ic,Cb,this.$.isEditMode?2:1,19,null);this.$.Ma.dh(yc,Oa);R.ULS.sendTraceTag(537167131,0,50,`AutoFilterContextMenu::OnMenuItemClick ${ic}, ${Cb}`)};
this.focusShiftOnMenuDismiss=()=>{ha.f(this.$).focus()};this.jMc=ic=>{this.Yda=Date.now();if(ic.checkedItems&&ic.checkedItems.length){ua.b(this.$).lj(ba.a.Gdg,Zb.g(),void 0,!0);var Oa=fa.a.Gp(this.Nlc),Cb=Zb.b(this.$,Oa),yc={Rmc:0,Omc:0,Pya:0,range:0,LZc:!1},Nc=!1;db.EwaSettings.isChangeGateEnabled("OfficeVSO:8634169_fix6bgr7taghighcount")&&(Nc=Object(ob.b)(this.tZ,ha.f(this.$)));db.EwaSettings.isChangeGateEnabled("OfficeVSO:8494257_FilterAndSortTelemetry")&&(yc=Object(ob.a)(ha.f(this.$),this.tZ,
Oa.AutoFilterType));var Id=Kf=>{var cg=this.Yda?Date.now()-this.Yda:-1;R.ULS.sendTraceTag(508372235,0,50,`GridContextMenuFilter::ApplyFilterByValue Perf Telemetry : ${JSON.stringify({["ToggleFilterOperationCount"]:0,["ApplyFilterTime"]:cg,["ToggleAndApplyFilterTime"]:0,["FilterByValueType"]:Oa.AutoFilterType})}`);var Bg=void 0;db.EwaSettings.isChangeGateEnabled("OfficeVSO:8494257_FilterAndSortTelemetry")&&(Bg={["blocksWithTableInViewport"]:yc.Rmc,["blockWithTableNotInViewport"]:yc.Omc,["nonEmptyCellsCount"]:yc.Pya,
["isFilterAppliedBefore"]:Nc,["filterDataType"]:this.pib,["range"]:yc.range,["ApplyFilterTime"]:cg,["FilterByValueType"]:Oa.AutoFilterType},db.EwaSettings.isChangeGateEnabled("OfficeVSO:8665655_AdditionalFilterAndSortTelemetry")&&(Bg=Object.assign({},Bg,{["tableExistsInClient"]:yc.LZc,["filterItemCount"]:this.SNb})),Bg=JSON.stringify(Bg),R.ULS.sendTraceTag(507901277,0,20,`AutoFilterContextMenuFilter::ApplyFilterByValue Data Telemetry : ${Bg}`));fb.a.NOa(Kf)&&(cg=fb.a.vIa(Kf),this.vK?fb.a.PK(Ka.a.applyItemFilter,
cg.MessageIdName,ib.a.gea,!0,fb.a.$xa(cg.MessageId)):R.ULS.sendTraceTag(537167129,0,10,`AutoFilterContextMenu::OnApplyFilterByValue failed with AutoFilterException -${cg.MessageIdName}`));ab.a(Kf)||(R.ULS.sendTraceTag(537167128,0,50,"AutoFilterContextMenu::OnApplyFilterByValue service call succeeded"),ua.b(this.$).lj(ba.a.k7d,Zb.g(),void 0,!0),this.jwb.onApplyFilterByValueFinish({isSuccess:!0}),Zb.k(this.$,this.tZ),db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowFilteredResultsInStatusBar",
!1)&&this.vv.UAa(Kf.Result,"Table"===Oa.AutoFilterType,Oa.Id));this.xTb&&(cg=!!Kf&&!!Kf.RequestTelemetryData,ha.f(this.$).nk.V0(this.Olc,Kf.StateId,cg?Kf.RequestTelemetryData.EcsOperationDuration:0,cg?Kf.RequestTelemetryData.EcsRequestDuration:0,cg?Kf.RequestTelemetryData.WfeRequestDuration:0),Kf=new Na.a,Kf.Flc(Bg),ha.f(this.$).nk.Zue(this.Olc,Kf))},ke=null;db.EwaSettings.isChangeGateEnabled("OfficeVSO:8494257_FilterAndSortTelemetry")&&(ke=new Ha.a("Table"===Oa.AutoFilterType?-586911747:-485891668,
null,this.$.isEditMode?2:1,19,null));this.xTb&&(this.Olc=O.a.create().toString(),ha.f(this.$).nk.KP(21,this.Olc,Ba.a(ke.command)));var Ie=6|(Object(Hb.p)(this.$,this.tZ)?128:0),Le=new Ta.a(208,0,(Kf,cg,Bg)=>Ea.a(this.$.pa.ta,Cb,ic.checkedItems,lb.c(Kf,Id),cg,Bg,null,null),Ie,()=>new V.a(ic.checkedItems,Cb));Ie=()=>{db.EwaSettings.isChangeGateEnabled("OfficeVSO:8494257_FilterAndSortTelemetry")?this.$.userOperationManager.enqueueOperation(Le,ke):this.$.userOperationManager.enqueueOperation(Le,null)};
var wf=this.$.ea.th.allowViewCollab&&db.EwaSettings.isChangeGateEnabled("OfficeVSO:8581585_NsvEntryExitOptimizationInRealTimeView");this.ZX||wf?this.GD.PMa(Ie,19,"AutoFilterContextMenu::onApplyFilterByValue"):Zb.j(Ie)}else R.ULS.sendTraceTag(537167130,0,15,"AutoFilterContextMenu::OnApplyFilterByValue Received Zero checked items to apply filter on")};this.X4e=ic=>{const Oa=la.p(this.tZ,this.$),Cb=la.w(this.tZ,this.$),yc={};yc.SortOptions={OperationType:Wb.d.CustomSort,ActiveCell:Oa,SelectedRange:Cb,
SortConditions:[{SortConditionType:ic.type,RowColOffset:Oa.FirstColumn-Cb.FirstColumn,SortColor:ic.color,SortIconSet:ic.icon.IconSet,SortIcon:ic.icon.Icon,IsAscending:!0}],SortTopToBottom:!0,GuessHeader:!0,IsCaseSensitive:!1,HasHeader:!1};yc.SelectedRange=Cb;yc.OriginalActiveCell=Oa;yc.ShouldRestoreSelection=!1;yc.ShouldPromptNamedSheetViewTeachingDialog=!0;R.ULS.sendTraceTag(537167119,0,50,`AutoFilterContextMenu.ApplySortByColorOrIcon: Aplying Sort, type: ${ic.type}`);this.$.ei(-1089513346,xa.a.eh,
19,{["CustomSortCommandData"]:yc})};this.Mlc=ic=>{if(ic.color||ic.icon){var Oa=fa.a.Gp(this.Nlc);Oa.ColorOrIconOptions=Zb.c(ic);Zb.a(this.$,Oa,this.tZ,this.GD,this.ZX,this.vv)}else R.ULS.sendTraceTag(512258703,0,15,"AutoFilterContextMenu::applyFilterByColorOrIcon Received Zero params to apply filter on")};this.DHd=()=>this.GD.DHd();this.onApplyForEveryoneClick=ic=>{R.ULS.sendTraceTag(508343893,0,50,`AutoFilterContextMenu::onApplyForEveryoneClick: Apply for everyone value updated to ${ic}`);this.GD.xXk()};
this.vK=fb.a.qTb();this.zoom=hc;this.vv=ta;this.qM=cd;this.xTb=db.EwaSettings.isChangeGateEnabled("OfficeVSO:8653981_captureApplyFilterAndSortIndag5e")}get vD(){return"PopulateAutoFilterContextMenu"}get DH(){return ea.a.axg}executeCommand(S,Wa,zb){S=Wa.command;switch(S){case 1701016594:return Y.a.Wuf(zb),Jc.Task.Va(!0);case 966232027:const hc=new F.a,cd=Object(ma.d)($b.a.resolve(Ib.Zf,{va:3})),ta=Ib.db.Ha()?Object(ma.d)($b.a.resolve(Ib.db,{va:0})):sa.GetServiceTaskFactory.Bj(this.$.ka,8,9,0);ra.TaskExtensions.Ua(I.a.XP(ta,
cd),()=>{var wb;this.GD=null!==(wb=this.GD)&&void 0!==wb?wb:cd.result;this.P2i(zb,ta.result);hc.setResult(!0)},this.xa,3).continueWith(()=>{hc.setResult(!1)},5,this.xa,Kb.a.instance);return hc.task;default:return mb.a(S)}}P2i(S,Wa){const zb=S.domEvent;if(ka.e(zb.rawEvent)&&(ka.g(zb),zb.target)){var hc=new bb.a(this.$.sa);if(hc.Hj(4096)||hc.Hj(2048)){var cd=fa.a.Gp(S[xa.a.Wk]);this.VPg(cd)&&(this.rXb?this.gTc(zb,cd,Wa):(this.hV=()=>{this.VPg(cd)&&(this.cbj(),this.gTc(zb,cd,Wa),this.oib=db.EwaSettings.isChangeGateEnabled("OfficeVSO:7213347_AFMenu_FilterByValueSearch"),
this.rXb=!0)},this.sqa()))}}}ni(S,Wa,zb){switch(Wa.command){case 1701016594:case 966232027:return!!zb;default:return!1}}WPc(S){S.MenuSectionList.push(...this.IWa)}cbj(){db.EwaSettings.isChangeGateEnabled("OfficeVSO:7271429_FocusShiftOnMenuDismiss_ViewportRegressionFix")?this.jwb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController({getFilterByValueItemsRequest:this.nqb,applyFilterByValueRequest:this.jMc,onMenuItemClick:this.onMenuItemClick,focusShiftOnMenuDismiss:this.focusShiftOnMenuDismiss,
autoFilterMenuWidth:na.Zpd,applySortByColorOrIconRequest:this.X4e,applyFilterByColorOrIconRequest:this.Mlc,onApplyForEveryoneClick:this.onApplyForEveryoneClick}):this.jwb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController({getFilterByValueItemsRequest:this.nqb,applyFilterByValueRequest:this.jMc,onMenuItemClick:this.onMenuItemClick,autoFilterMenuWidth:na.Zpd,applySortByColorOrIconRequest:this.X4e,applyFilterByColorOrIconRequest:this.Mlc,onApplyForEveryoneClick:this.onApplyForEveryoneClick});
this.jma=U.a.instance.mo("Common.IExternalUICommandDefinitionMapping")||new za.a(this.$.$h,this.$)}gTc(S,Wa,zb){var hc=S.target;ua.b(this.$).lj(ba.a.gTc,Zb.g(),void 0,!0);if(Wa){zb=this.bDi(Wa,zb);var cd=Sys.UI.DomElement.getBounds(hc);hc=cd.x+cd.width;cd=cd.y;if(ha.f(this.$).wM){Wa.Cell||R.ULS.sendTraceTag(509220166,0,10,"AutoFilterContextMenu.renderReactAutoFilterMenu:\u00a0autoFilterData.Cell is undefined.");hc=-1===Wa.Cell.FirstRow;Wa=Y.a.Qxc(this.$,Wa.Cell,hc);if(!Y.a.vEc(Wa,hc))return;Wa=Y.a.myc(this.$,
Wa,!0,hc);if(!Wa){R.ULS.sendTraceTag(509220165,0,10,`AutoFilterContextMenu.renderReactAutoFilterMenu:\u00a0failed to get the context menu coordinates. isHeaderCommandData=${hc}`);return}hc=Wa.x;cd=Wa.y}else if(!Wa.IsHeaderSnapped){if(!Y.a.YSd(this.$,Wa.Cell))return;Wa=Y.a.nId(this.$,Wa.Cell,!0);hc=Wa.x;cd=Wa.y}Wa=ha.f(this.$).rtl?new Sys.UI.Point(hc-this.zoomManager.nFa(na.Zpd),cd):new Sys.UI.Point(hc,cd);Wa=this.zoomManager.Rfa(Wa);zb={targetPoint:{left:Wa.x,top:Wa.y},autoFilterMenu:zb,applyForEveryoneState:this.DHd()};
this.jqj&&void this.sYk(S);this.jwb.showSortFilterMenu(zb,this.v0f?ta=>{this.qM.ix(ta,"context_menu_auto_filter_apply_sync",null,["context-menu-auto-filter-items"])}:void 0);this.$.ei(-544117314,-1,0,null)}else R.ULS.shipAssertTag(537167135,0,!!Wa,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.")}sYk(S){const Wa=this;return No(function*(){Wa.v0f?Wa.qM.ix(S.rawEvent,"context_menu_auto_filter_sync",null,["context-menu-auto-filter","context-menu-auto-filter-items"]):(yield $b.a.resolve(Ib.yd)).ix(S.rawEvent,
"context_menu_auto_filter_sync",null,["context-menu-auto-filter"])})}VPg(S){return(null===S||void 0===S?0:S.Cell.SheetName)?!db.EwaSettings.isChangeGateEnabled("OfficeVSO:8756256_FilterButtonInNovMode")&&ha.f(this.$).Gga?S.Cell.SheetName===this.$.na.name:S.Cell.SheetName===this.$.na.sheetName:!0}bDi(S,Wa){return(S=this.cDi(S,Wa))?this.vug(S):null}vug(S){const Wa=[];for(const zb of S.Sections){if(Object(Hc.e)(this.$)&&db.EwaSettings.isChangeGateEnabled("OfficeVSO:6122433_NSVTitleEnabled")&&zb.Title===
Ia.a.instance.ia(1951))continue;const hc=this.x7j(zb);Wa.push(hc)}return Object(Q.a)(new Yb,{Id:S.Id,Sections:Wa})}x7j(S){const Wa=[];for(const zb of S.MenuItems)if(2===zb.Identifier)this.Nlc=zb.CommandData;else switch(zb.Type){case 3:case 2:Wa.push(this.v7j(zb,2===zb.Type));break;case 1:Wa.push(this.w7j(zb))}return Object(Q.a)(new Qc,{MenuItems:Wa,DisplayType:S.DisplayType,Id:this.lAi(S)})}w7j(S){const {label:Wa,VZa:zb}=this.hAf(S),hc=this.vug(S.SubMenu),cd=this.Tzf(S);let ta="MissingIcon_20";zb&&
(ta=this.jma.Gyc(zb));const wb=Wa||S.Label;return Object(Q.a)(new Wc,{Disabled:S.Disabled,Type:S.Type,Identifier:S.Identifier,Id:cd,CommandData:S.CommandData,Label:wb,SubMenu:hc,IsChecked:S.IsChecked,IconName:"MissingIcon_20"===ta?null:ta})}v7j(S,Wa){const {label:zb,VZa:hc,vo:cd}=this.oxc(S,Wa&&S.IsChecked);Wa=this.YGd(S,zb);let ta="MissingIcon_20";hc&&(ta=this.jma.Gyc(hc));switch(S.RibbonCommand){case 1948650742:if(db.EwaSettings.isChangeGateEnabled("OfficeVSO:8421225_NamedSheetViewUpdateDisableCommandsBasedOnRealTimeView")){var wb=
this.$.sa.na;wb=!this.$.ea.Xaa||0!==wb.iG||wb.Kj.BM||Hc.e(this.$)||this.$.ea.th.allowViewCollab;S.Disabled=wb}break;case 1385699053:case 1933713114:case -87741481:wb=this.$.sa.na,wb=!this.$.ea.Xaa||!wb.Kj.IP.count||Hc.e(this.$),S.Disabled=wb}return Object(Q.a)(new Wc,{Disabled:S.Disabled,Type:S.Type,Identifier:S.Identifier,Id:Wa,RibbonCommand:cd,CommandData:S.CommandData,Label:zb||S.Label,SubMenu:null,IsChecked:S.IsChecked,IconName:"MissingIcon_20"===ta?null:ta})}cDi(S,Wa){var zb;this.tZ=zb=la.F(S.Cell);
Wa=Wa||(Ib.db.Ha()?$b.a.Zg(Ib.db):Fa.a(this.$));const hc=ha.f(this.$).wM,cd=-1===S.Cell.FirstRow;if(!hc&&S.IsHeaderSnapped||hc&&cd)zb=Wa.rib.lLi(zb);else{Wa=ha.f(this.$).za.Gma(zb);if(!Wa)return this.vK?fb.a.PK(Ka.a.cxg,La.a.$Zi,ib.a.QUa,!0,!1):(S=ha.f(this.$).view.visibleArea,R.ULS.sendTraceTag(537167134,0,10,`AutoFilterContextMenu.GetAutoFilterMenuProps: gridModelCellProxy that is supposed to hold model is null. Range requested ${zb}, visible range: ${S}`)),null;zb=Wa.autoFilterMenu}if(!zb)return this.vK?
fb.a.PK(Ka.a.cxg,La.a.ADj,ib.a.QUa,!0,!1):R.ULS.sendTraceTag(537167133,0,10,"AutoFilterContextMenu.GetMenuPropsFromCachedBlock: a cell that's supposed to have an autofilter menu returned a null menu."),null;this.nMb=S.Cell.FirstRow+"_"+S.Cell.FirstColumn;return zb}sqa(){if(this.Mw?this.$.ea.An:this.$.ea.Ul)if(db.EwaSettings.isChangeGateEnabled("OfficeVSO:8428325_ExtractChunkLoading"))Object(Eb.a)("sortFilter",{va:1}).then(()=>{this.hV()},S=>{this.vK&&(pa.a.Jn(S,"AutoFilterContextMenu.SortFilterScriptLoad"),
fb.a.PK(Ka.a.sqa,La.a.sYc,ib.a.QUa,!1,!1))});else{const S=Wa=>{this.vK?Wa.Vt().loadScript("sortFilter").then(()=>{this.hV()},zb=>{pa.a.Jn(zb,"AutoFilterContextMenu.SortFilterScriptLoad");fb.a.PK(Ka.a.sqa,La.a.sYc,ib.a.QUa,!1,!1)}):db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",!1)?void Wa.Vt().loadScript("sortFilter").then(()=>this.hV()):ra.TaskExtensions.Ua(ma.d(Wa.Vt().loadScript("sortFilter")),()=>{this.hV()},this.$.xa,3)};if(db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",
!1))void $b.a.resolve(Ib.Fb,{va:1}).then(Wa=>S(Wa));else{const Wa=ma.d($b.a.resolve(Ib.Fb,{va:1}));ra.TaskExtensions.Ua(Wa,()=>S(Wa.result),this.$.xa,3)}}else this.Mw?this.$.ea.Bw(this.Pq):db.EwaSettings.fl()?this.$.ea.Jq(this.sqa):this.$.ea.Uq(this.SI)}L0h(S){const Wa={};Wa.SearchText=S;Wa.Page=1;Wa.DateNodeType=-1;return Wa}kQh(){this.Q3a&&(R.ULS.sendTraceTag(537167132,0,15,`AutoFilterContextMenu.CancelGetAutoFilterItemListWebRequest Cancelling pending getAutoFilterItemList request with ID=${this.Q3a}`),
Ea.i(this.$.pa.ta,this.Q3a,null,null,null),this.Q3a=null);this.xrb&&(K.AFrameworkApplication.$i.HD(this.xrb.TC),this.xrb=null)}i_b(S){return Wa=>{this.xrb=this.Q3a=null;if(fb.a.NOa(Wa)){var zb=fb.a.vIa(Wa);this.vK?fb.a.PK(S?Ka.a.searchAutoFilterItemList:Ka.a.getAutoFilterItemList,zb.MessageIdName,ib.a.QUa,!0,!0):R.ULS.sendTraceTag(537167127,0,10,`AutoFilterContextMenu::OnGetFilterByValueItemsSuccessCallback failed with AutoFilterException -${zb.MessageIdName}`)}if(!ab.a(Wa)){R.ULS.sendTraceTag(537167126,
0,50,"AutoFilterContextMenu::OnGetFilterByValueItems service call succeeded");zb=Wa.Result;Wa=new wa.a(!0);var hc=zb.AutoFilterItems?!0:!1;const cd=zb.AutoFilterDateNodes?!0:!1;this.pib="";db.EwaSettings.isChangeGateEnabled("OfficeVSO:8494257_FilterAndSortTelemetry")&&hc&&0<zb.AutoFilterItems.length&&(this.pib="text");db.EwaSettings.isChangeGateEnabled("OfficeVSO:8494257_FilterAndSortTelemetry")&&cd&&0<zb.AutoFilterDateNodes.length&&(this.pib="text"===this.pib?this.pib+"|date":"date");this.SNb=0;
db.EwaSettings.isChangeGateEnabled("OfficeVSO:8665655_AdditionalFilterAndSortTelemetry")&&(hc&&(this.SNb=zb.AutoFilterItems.length),cd&&(this.SNb+=zb.AutoFilterDateNodes.length));hc&&Wa.add("AutoFilterItemsCount",zb.AutoFilterItems.length);cd&&Wa.add("AutoFilterDateItemsCount",zb.AutoFilterDateNodes.length);Wa.add("Location","contextMenu");hc=this.oib?{filterByValueItems:this.nKb(zb),hasMoreRecords:zb.ItemListMaxExceeded,searchText:zb.SearchText}:{filterByValueItems:this.nKb(zb),hasMoreRecords:zb.ItemListMaxExceeded};
this.jwb.onGetFilterByValueItemsFinish(hc);S||(R.ULS.shipAssertTag(529063959,0,null!==zb.FontColors&&null!==zb.CellColors&&null!==zb.Icons&&null!==zb.SelectedSortFontColors&&null!==zb.SelectedSortCellColors&&null!==zb.SelectedSortIcons,"AutoFilterContextMenu.onGetFilterByValueItemsSuccessCallback: SortByColor items should not be null"),hc={fontColors:zb.FontColors,cellColors:zb.CellColors,icons:zb.Icons,getColorName:this.getColorName,selectedSortFontColor:0<zb.SelectedSortFontColors.length?zb.SelectedSortFontColors[0]:
null,selectedSortCellColor:0<zb.SelectedSortCellColors.length?zb.SelectedSortCellColors[0]:null,selectedSortIcon:0<zb.SelectedSortIcons.length?zb.SelectedSortIcons[0]:null,selectedFilterCellColor:-1!==zb.SelectedFilterCellColor?zb.SelectedFilterCellColor:null,selectedFilterFontColor:-1!==zb.SelectedFilterFontColor?zb.SelectedFilterFontColor:null,selectedFilterIcon:null!==zb.SelectedFilterIcon?zb.SelectedFilterIcon:null},db.EwaSettings.isChangeGateEnabled("OfficeVSO:7573807_IsColorOrIconPresent")&&
(zb=1<zb.FontColors.length||1<zb.CellColors.length||1<zb.Icons.length)&&Wa.add("AutoFilterColorOrIconPresent",zb),ua.b(this.$).lj(ba.a.i_b,Wa.eB,void 0,!0),this.jwb.onGetColorsAndIconsFinish(hc))}}}ZMc(){return S=>{this.xrb=this.Q3a=null;S=Da.a.Qj(S.data);S=Za.a.Kh(S);R.ULS.sendTraceTag(537167125,0,10,`AutoFilterContextMenu.OnGetFilterByValueItemsFailureCallback Errors: [${S}].`)}}nKb(S){const Wa=this.pZh(S),zb=this.wZh(S.AutoFilterItems),hc=[],cd=[];let ta=0,wb=0;S.HasBlanks&&(S=c(Ia.a.instance.ia(782),
S.IsBlanksSelected?P.Selected:P.NotSelected,ea.a.Xpd),hc[ta++]=S);for(const ic of Wa)hc[ta++]=ic;if(db.EwaSettings.isChangeGateEnabled("OfficeVSO:6892133_ErrorsOnTop_FilterMenu_Fix"))for(const ic of zb)-1!==Array.indexOf(pc.a.Fuc,ic.displayText)?cd[wb++]=ic:hc[ta++]=ic;else for(const ic of zb)hc[ta++]=ic;return Array.prototype.concat(cd,hc)}pZh(S){const Wa=[];if(!S.AutoFilterDateNodes||!S.AutoFilterDateNodes.length)return Wa;const zb=[this.Ojb(S.YearKeys,S.YearValues),this.Ojb(S.MonthKeys,S.MonthValues),
this.Ojb(S.DayKeys,S.DayValues),this.Ojb(S.HourKeys,S.HourValues),this.Ojb(S.MinuteKeys,S.MinuteValues),this.Ojb(S.SecondKeys,S.SecondValues)];let hc=!1,cd=!1,ta=0;var wb=null;const ic=Array(6);var Oa=null;for(const Cb of S.AutoFilterDateNodes){ic[0]&&(Oa.Year!==Cb.Year?(hc=!0,ta=0,wb=null):Oa.Month!==Cb.Month?(cd=!0,ta=1,wb=ic[0]):Oa.Day!==Cb.Day?(ta=2,wb=ic[1]):S.ShowTime&&(Oa.Hour!==Cb.Hour?(ta=3,wb=ic[2]):Oa.Minute!==Cb.Minute?(ta=4,wb=ic[3]):(ta=5,wb=ic[4])));for(;6>ta;){let yc;switch(ta){case 0:yc=
Cb.Year;Oa=zb[0].getItem(yc.toString());break;case 1:yc=Cb.Month;Oa=zb[1].getItem(yc.toString());break;case 2:yc=Cb.Day;Oa=zb[2].getItem(yc.toString());break;case 3:yc=Cb.Hour;Oa=zb[3].getItem(yc.toString());break;case 4:yc=Cb.Minute;Oa=zb[4].getItem(yc.toString());break;case 5:yc=Cb.Second;Oa=zb[5].getItem(yc.toString());break;default:throw Error.invalidOperation("Unknown AutoFilterDateNodeType.");}Oa=c(Oa,-1!==Cb.NodeType&&ta>=Cb.NodeType?P.Selected:P.NotSelected,wb?wb.key+";"+yc:ea.a.$pd+yc,!1,
[]);wb=wb?wb.children:Wa;wb=wb[wb.length]=Oa;ic[ta]=Oa;switch(ta){case 5:ta=6;break;case 2:ta=S.ShowTime?ta+1:6;break;default:ta++}}Oa=Cb}hc||(ic[0].expanded=!0,cd||(ic[1].expanded=!0));return Wa}wZh(S){const Wa=[];if(!S)return Wa;let zb=0;for(const hc of S)Wa[zb++]=c(hc.DisplayString,hc.Selected?P.Selected:P.NotSelected,ea.a.aqd+hc.DisplayString);return Wa}Ojb(S,Wa){const zb=new wa.a(!0);if(!S||!Wa)return zb;const hc=S.length<Wa.length?S.length:Wa.length;for(let cd=0;cd<hc;cd++)zb.add(S[cd].toString(),
Wa[cd]);return zb}getColorName(S){return Ya.a.YIa(oa.a.mM(S))}};Xa.Zpd=268;Xa=na=Object(N.__decorate)([Object($b.d)(Ib.r),Object(N.__param)(0,Object(Ib.Lb)()),Object(N.__param)(1,Object(Ib["if"])()),Object(N.__param)(2,Object(Ib.cb)()),Object(N.__param)(3,Object(Ib.Lg)()),Object(N.__param)(4,Object(Ib.yd)()),Object(N.__param)(5,Object(Ib.gc)())],Xa);Object(M.a)(Xa,"AutoFilterContextMenu",Y.a,[]);var Jb=a(907),qb=a(158),Db=a(87),gb=a(19);class ya{}ya.wwf=26;ya.vEd=[228,229,0,98,0,94,93];Object(M.a)(ya,
"Constants",null,[]);class Aa{constructor(S,Wa,zb,hc){this.Hlh=S;this.Yfh=Wa;this.cgh=zb;this.Wph=hc}get jlj(){return 3===this.drc}get xpj(){return 4===this.drc&&!!this.subMenu}get subMenu(){return this.Wph}get i$f(){return this.Hlh}get drc(){return this.Yfh}get Zxd(){return this.cgh}}Object(M.a)(Aa,"FiltersMenuData",null,[]);class sb extends Aa{constructor(S,Wa){super(S,2,0,null);this.H6e=Wa}}Object(M.a)(sb,"AutoFilterFiltersMenuData",Aa,[]);class nc{}nc.cVk=[new Aa(99,2,0,null),new Aa(100,2,1,null),
new Aa(0,3,0,null),new Aa(170,2,2,null),new Aa(172,2,4,null),new Aa(0,3,0,null),new Aa(174,2,6,null),new Aa(175,2,7,null),new Aa(0,3,0,null),new Aa(107,0,0,null)];nc.tIj=[new Aa(99,2,0,null),new Aa(100,2,1,null),new Aa(0,3,0,null),new Aa(101,2,8,null),new Aa(102,2,10,null),new Aa(103,2,12,null),new Aa(0,3,0,null),new Aa(104,1,0,null),new sb(105,1),new sb(106,2),new Aa(0,3,0,null),new Aa(107,0,0,null)];nc.t8h=[new Aa(99,2,0,null),new Aa(0,3,0,null),new Aa(111,2,10,null),new Aa(112,2,8,null),new Aa(103,
2,12,null),new Aa(0,3,0,null),new sb(109,8),new sb(108,9),new sb(110,10),new Aa(0,3,0,null),new sb(114,11),new sb(113,12),new sb(115,13),new Aa(0,3,0,null),new sb(116,14),new sb(117,15),new sb(118,16),new Aa(0,3,0,null),new sb(119,17),new sb(120,18),new sb(121,19),new Aa(0,3,0,null),new sb(122,20),new sb(123,21),new sb(124,22),new Aa(0,3,0,null),new sb(125,23),new Aa(126,2,12,[new sb(127,24),new sb(128,25),new sb(129,26),new sb(130,27),new Aa(0,3,0,null),new sb(131,28),new sb(132,29),new sb(133,30),
new sb(134,31),new sb(135,32),new sb(136,33),new sb(137,34),new sb(138,35),new sb(139,36),new sb(140,37),new sb(141,38),new sb(142,39)]),new Aa(0,3,0,null),new Aa(107,0,0,null)];Object(M.a)(nc,"Constants",null,[]);var Bb=a(642),uc=a(27),Pc;let wd=Pc=class extends Y.a{constructor(S,Wa,zb,hc,cd){super(S,"PopulateAutoFilterFieldListContextMenu",474690375,216058793,Pc.Tsi,!0,!1,Pc.L5a,cd,Wa,!1,zb,hc);this.ru=null}get vD(){return"PopulateAutoFilterFieldListContextMenu"}get DH(){return ea.a.bxg}executeCommand(S,
Wa,zb){S=Wa.command;switch(S){case -699941697:this.applyAutoFilterFieldList(Wa,zb);break;case 216058793:break;case -1494291901:break;default:return mb.a(S)}return Jc.Task.Va(!0)}fId(S,Wa){return!S||S.length<=Wa?(R.ULS.sendTraceTag(537167117,0,10,"AutoFilterFieldListContextMenu:GetCommandId - incomplete id list"),-1):parseInt(S[Wa],10)}Wbe(S,Wa,zb,hc,cd,ta){const wb=this.fId(cd,ta);0>wb&&R.ULS.sendTraceTag(537167116,0,10,"AutoFilterFieldListContextMenu:ProcessCommand - command id not found");switch(ya.vEd[wb]){case 98:S=
new Ha.a(-2058042992,Wa.method,Wa.mode,Wa.lk,Wa.tabName);this.ru.KQ.DNb(this.$,hc,0,S);break;case 228:S=new Ha.a(504133448,Wa.method,Wa.mode,Wa.lk,Wa.tabName);this.ru.KQ.DNb(this.$,hc,0,S);break;case 229:S=new Ha.a(-798968736,Wa.method,Wa.mode,Wa.lk,Wa.tabName);this.ru.KQ.DNb(this.$,hc,0,S);break;case 233:S=new Ha.a(-1677817820,Wa.method,Wa.mode,Wa.lk,Wa.tabName);this.ru.KQ.DNb(this.$,hc,0,S);break;case 94:this.Nug(S,Wa,hc,zb,cd,ta+1);break;case 93:this.ru.KQ.qtj(this.$,hc)}}Nug(S,Wa,zb,hc,cd,ta){const wb=
this.fId(cd,ta);0>wb&&R.ULS.sendTraceTag(537167115,0,10,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand - command id not found");if(!hc||wb>=hc.length)R.ULS.sendTraceTag(537167114,0,15,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand() - no menuData.");else switch(hc=hc[wb],hc.drc){case 1:this.ru.KQ.Otj(this.$,zb);break;case 2:(cd=Object(qb.a)(sb,hc))?(S=new Ha.a(-2058042992,Wa.method,Wa.mode,Wa.lk,Wa.tabName),this.ru.KQ.DNb(this.$,zb,cd.H6e,S)):this.ru.KQ.h3f(this.$,S,zb,hc.Zxd);break;
case 0:this.ru.KQ.h3f(this.$,S,zb,hc.Zxd);break;case 4:this.Nug(S,Wa,zb,hc.subMenu,cd,ta+1)}}applyAutoFilterFieldList(S,Wa){var zb=Wa[Jb.a.FE];if(zb)if(zb=zb.split(Db.a.xMb),3>zb.length)R.ULS.sendTraceTag(537167112,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - unexpected SourceIdControl string.");else{var hc=this.fId(zb,1),cd=this.getFieldName(hc),ta=this.d$f(hc).returnValue;ta?this.Wbe(Wa,S,ta,cd,zb,2):R.ULS.sendTraceTag(537167111,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - menu data not found for index "+
hc.toString()+Db.a.xMb)}else R.ULS.sendTraceTag(537167113,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - SourceIdControl string is null.")}ni(S,Wa){if(S=this.$.isEditMode)switch(Wa.command){case 216058793:break;case -699941697:break;case -1494291901:S=!0;break;default:S=!1}return S}Yba(S,Wa,zb){this.$.isEditMode&&((this.ru=Object(qb.a)(565,zb))||R.ULS.sendTraceTag(537167110,0,10,"AutoFilterFieldListContextMenu:ShowDropDown() - filterInfoManager not found."),super.Yba(S,Wa,null,
null,!0))}Bwd(){if(!this.ru||!this.ru.xx||1!==this.ru.xx.length)return R.ULS.sendTraceTag(537167109,0,15,"AutoFilterFieldListContextMenu:CreateContextMenuItemList() - incorrect fields list."),null;const S=this.ru.xx[0];return[Ia.a.instance.ia(249)].concat(S.FieldInfoDataList.map(Wa=>Wa.Name)).sort((Wa,zb)=>uc.a.compare(Wa,zb,!0))}fieldIndex(S){if(!this.ru||!this.ru.xx||1!==this.ru.xx.length||!this.ru.xx[0].FieldInfoDataList)return-1;for(let Wa=0;Wa<this.ru.xx[0].FieldInfoDataList.length;++Wa)if(this.ru.xx[0].FieldInfoDataList[Wa].Name===
S)return Wa;return-1}getFieldName(S){return 0>S||!this.ru||!this.ru.xx||1!==this.ru.xx.length||!this.ru.xx[0].FieldInfoDataList||this.ru.xx[0].FieldInfoDataList.length<S?null:this.ru.xx[0].FieldInfoDataList[S].Name}y_(){var S=this.Bwd();if(!S||!S.length)return null;const Wa=this.Ya,zb=Wa.Oh();for(let ta=0;ta<S.length;++ta){const wb=S[ta],ic=0<ta?this.fieldIndex(wb):-1,Oa=Pc.MTg+ic.toString()+Db.a.xMb;let Cb=null;const yc=this.ru.KQ.Q3i(0<ta?wb:null),Nc=this.Mwd(Wa,yc,Pc.MTg+ic.toString(),wb);for(let Id=
0;Id<ya.vEd.length;++Id){var hc=ya.vEd[Id],cd=Oa+Id.toString();Cb||(Cb=Wa.Oh());switch(hc){case 228:Cb.buttons.push(Wa.Sh(223,cd,-699941697,this.ru.KQ.fpj(0<ta?wb:null)?gb.a.gvc:gb.a.BXa,8,228,!1,null));break;case 229:Cb.buttons.push(Wa.Sh(224,cd,-699941697,this.ru.KQ.gpj(0<ta?wb:null)?gb.a.hvc:gb.a.CXa,8,229,!1,null));break;case 233:Cb.buttons.push(Wa.Sh(225,cd,-699941697,gb.a.dvc,1,233,!1,null));break;case 98:hc=this.XLh(wb);cd=Wa.rWa(cd+(yc?".enabled":".disabled"),hc,-699941697,null,"None",null,
!yc,void 0,!0);cd.P1("Image16by16",8,gb.a.Xhb);Cb.buttons.push(cd);break;case 94:let ke,Ie;const Le=(()=>{let wf=this.d$f(ic);({Fwf:ke,isChecked:Ie}=wf);return wf})().returnValue;if(!Le)return null;hc=this.Mwd(Wa,Ie&&yc,cd,ke);cd=this.oAf(hc.menu,Wa,cd+Db.a.xMb,Le,Ie&&yc);hc.menu.vh.push(cd);Cb.buttons.push(hc);break;case 0:Cb&&(Nc.menu.vh.push(Cb),Cb=null);break;default:cd=Wa.rWa(cd,Ia.a.instance.ia(hc),-699941697,null,"None",null,!1,void 0,!0),this.TKg(cd,yc&&93===hc&&this.ru.KQ.filter(),Ia.a.instance.ia(hc)),
Cb.buttons.push(cd)}}Nc.menu.vh.push(Cb);zb.buttons.push(Nc)}S=Wa.Vv(this.menuId);S.vh.push(zb);return S}oAf(S,Wa,zb,hc,cd){let ta=null;for(let yc=0;yc<hc.length;++yc){var wb=hc[yc],ic=zb+yc.toString(),Oa=!1;switch(wb.drc){case 1:Oa=cd&&this.ru.KQ.xn.IsTop10;break;case 2:Oa=Object(qb.a)(sb,wb);Oa=cd&&this.ru.KQ.wgj(Oa?Oa.H6e:0,wb.Zxd);break;case 0:Oa=cd&&this.ru.KQ.xn.IsCustomSupportedAndNotPresent}ta||(ta=Wa.Oh());if(wb.jlj)ta&&(S.vh.push(ta),ta=null);else if(wb.xpj){var Cb=Ia.a.instance.ia(wb.i$f);
Cb=this.Mwd(Wa,Oa,ic,Cb);Cb.menu.vh.push(this.oAf(Cb.menu,Wa,ic+Db.a.xMb,wb.subMenu,Oa));ta.buttons.push(Cb)}else wb=Ia.a.instance.ia(wb.i$f),ic=Wa.rWa(ic,wb,-699941697,null,"None",null,!1,void 0,!0),this.TKg(ic,Oa,wb),ta.buttons.push(ic)}return ta}TKg(S,Wa,zb){Wa?S.P1("Image16by16",8,gb.a.PHa):S.P1("None",0,null);S.L1(zb);S.label=zb}Mwd(S,Wa,zb,hc){return Wa?S.Iqc(zb,this.menuId,hc,798637440,8,gb.a.PHa):S.fz(zb,this.menuId,hc,798637440)}qm(S){return!S||!S.length}d$f(S){var Wa=0>S?Bb.MajorityDataType.Text:
this.ru.xx[0].FieldInfoDataList[S].MajorityDataTypeForField;var zb=null;S=this.ru.KQ.P3i(Wa);switch(Wa){case Bb.MajorityDataType.Text:zb=95;Wa=nc.cVk;break;case Bb.MajorityDataType.Number:zb=94;Wa=nc.tIj;break;case Bb.MajorityDataType.Date:zb=96;Wa=nc.t8h;break;default:return R.ULS.sendTraceTag(537167108,0,10,"AutoFilterFieldListContextMenu:MenuDataForDataType() - unknown data type."),{returnValue:null,Fwf:zb,isChecked:S}}zb=Ia.a.instance.ia(zb);return{returnValue:Wa,Fwf:zb,isChecked:S}}XLh(S){return!S||
this.qm(S.trim())?Ia.a.instance.ia(97):S.length>ya.wwf?String.format(Ia.a.instance.$g(155),S.substring(0,ya.wwf)):String.format(Ia.a.instance.$g(156),S)}};wd.Tsi=ea.a.JYh;wd.L5a="AutoFilterFieldListContextMenuRoot";wd.MTg="ApplyAutoFilterFieldList.";wd=Pc=Object(N.__decorate)([Object($b.d)(Ib.s),Object(N.__param)(0,Object(Ib.Lb)()),Object(N.__param)(1,Object(Ib["if"])()),Object(N.__param)(2,Object(Ib.cb)()),Object(N.__param)(3,Object(Ib.Lg)())],wd);Object(M.a)(wd,"AutoFilterFieldListContextMenu",
Y.a,[]);var Md=a(636),Nd=a(988),ec=a(13),gc=a(136),Mb=a(423),sc=a(25),xd=a(156);let xb=class extends Y.a{constructor(S,Wa,zb,hc,cd,ta,wb,ic,Oa,Cb,yc){Oa=void 0===Oa?ea.a.SYh:Oa;super(S,void 0===ta?"PopulateFloatingObjectContextMenu":ta,void 0===wb?-2017893763:wb,void 0===ic?1350204367:ic,Oa,void 0===Cb?!0:Cb,void 0===yc?!1:yc,Oa,cd,Wa,!0,zb,hc);this.floatingObject=null;this.oh=0;this.PKc=!0;this.zoom=hc}get vD(){return"PopulateFloatingObjectContextMenu"}get DH(){return ea.a.kxg}executeCommand(S,Wa,
zb){S=Object(qb.a)(Md.a,zb.eventArgs);switch(Wa.command){case -1372040782:zb=ha.f(this.$).ha.$e.yh;R.ULS.shipAssertTag(537167048,0,!!zb);zb&&(db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackAsyncFloatingObjectContextMenu",!1)&&xd.b(this.$).ix(S.La.rawEvent,"context_menu_floating_object",null,["context-menu"]),this.floatingObject=zb.floatingObject,this.oh=Wa.method,Wa=this.FYa(S),this.Ft(Wa,!0,S.oh));break;case 848910589:S&&(Wa=[Nd.a.qOg],S=new Sys.UI.Point(S.La.clientX,S.La.clientY),
this.showFloatie(Wa,new Sys.UI.Bounds(S.x,S.y,0,0),2))}return Jc.Task.Va(!0)}ni(S,Wa,zb){switch(Wa.command){case -1372040782:return!!zb&&this.R_f(S);case 848910589:return S=ha.f(this.$).ha.$e.yh,!!zb&&!!S&&S.isEditing;default:return!1}}R_f(S){switch(S){case 8:case 2:case 64:case 4:case 256:return!0;default:return!1}}Gjc(S,Wa,zb){Mb.a(this.$)?ha.f(this.$).Pg.Uo||(this.zoomManager.ype()?zb.buttons.push(S.Sg(265)):zb.buttons.push(S.Sg(264))):(this.$.isEditMode&&3===this.oh&&!this.nOb()&&zb.buttons.push(S.Sg(101)),
5!==this.floatingObject.type||gc.a.xR(this.floatingObject.nh)||this.floatingObject.nh.IsGroup||(this.mHc()?zb.buttons.push(S.Sg(186)):zb.buttons.push(S.Sg(147))),db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TransitionFloatingInCellImages",!1)&&1===this.floatingObject.type&&(db.EwaSettings.isChangeGateEnabled("OfficeVSO:8478103_DisablePlaceInCellCtxMenuOnProtectedSheet")?this.mHc()||zb.buttons.push(S.Sg(303)):zb.buttons.push(S.Sg(303))),this.nOb()||this.mHc()||zb.buttons.push(S.Sg(146)),
db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)||(this.OGd(zb),this.dHd(zb)),db.EwaSettings.Ra(155)&&0===this.floatingObject.type&&zb.buttons.push(S.Sg(287)),db.EwaSettings.Ra(155)&&0===this.floatingObject.type&&zb.buttons.push(S.Sg(249)),5===this.floatingObject.type&&ha.f(this.$).ha.$e.yh.Kga()&&this.$.Oxa&&this.$.C3&&zb.buttons.push(S.Sg(273)))}KYa(S){const Wa=[];if(Mb.a(this.$))return Wa;if(3===S){var zb=!!this.$.Tj.get(5)&&this.floatingObject.Ise();
S=db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInEditMode",!1)&&this.$.isMobileMode&&this.$.isEditMode;const hc=ha.f(this.$).ha.$e.yh,cd=hc&&0===hc.floatingObject.type;if(!this.nOb())this.$.isEditMode?(zb&&Wa.push(Nd.a.Uvi),S||5===ha.f(this.$).ha.$e.YJ.floatingObject.type&&Wa.push(Nd.a.hFk)):zb&&Wa.push(Nd.a.copy);else if(sc.a.vR()&&cd){zb=hc.JQb(3);for(const ta of zb)Wa.push(ta)}sc.a.vR()&&cd?Wa.push(Nd.a.KRh):S||Wa.push(Nd.a.Vvi)}else 2===S&&ha.f(this.$).ha.$e.yh&&this.hOi(ha.f(this.$).ha.$e.yh,
Wa);return Wa}y_(){var S=this.Ya;const Wa=S.Vv(this.menuId),zb=Mb.a(this.$);let hc=null,cd=null;!this.$.isEditMode||db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInEditMode",!1)&&this.$.isMobileMode||(hc=S.Oh(),this.Gjc(S,Wa,hc));this.$.Tj.get(5)&&this.floatingObject.Ise()&&!this.nOb()&&!zb&&(cd=S.Oh(),this.Sth(S,cd));db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?(cd&&Wa.vh.push(cd),hc&&(Wa.vh.push(hc),S=S.Oh(),this.OGd(S),
this.dHd(S),Wa.vh.push(S))):(hc&&Wa.vh.push(hc),cd&&Wa.vh.push(cd));return Wa}FYa(S){var Wa=ha.f(this.$).ha.$e.yh;S=S&&1!==S.oh&&S.clientPoint?S.clientPoint:Sys.UI.DomElement.getLocation(Wa.domElement);const zb=this.$.domElement,hc=ha.f(this.$).rtl;(Wa=ec.HelperMethods.cH(Wa.fm.domElement,zb,hc))?(S.y=Math.max(S.y,Wa.y),S.x=Math.max(S.x,Wa.x)):R.ULS.sendTraceTag(537167047,5,15,`FloatingObjectContextMenu.GetContextMenuClientPoint sheetContentDivLocation is null if the offset parent is null. IsShuttingdown : ${K.AFrameworkApplication.Il}`);
return S}mHc(){const S=ha.f(this.$).ha.$e.yh;return!!S&&S.isEditing}Sth(S,Wa){if(this.$.isEditMode){Wa.buttons.push(S.Sg(42));Wa.buttons.push(S.Sg(43));const zb=this.$.ka.Ug(254,!0);(zb&&2===zb.gLa()||this.mHc())&&Wa.buttons.push(S.Sg(44))}else Wa.buttons.push(S.Sg(43))}nOb(){return db.EwaSettings.Ra(407)&&!!ha.f(this.$).ha.$e.Gq}hOi(S,Wa){if(5===S.floatingObject.type)S.isEditing?Wa.push(Nd.a.qOg):Wa.push(Nd.a.eFk);else if(sc.a.vR()&&gc.a.Wna(S.floatingObject)){S=S.JQb(2);for(const zb of S)Wa.push(zb)}else Wa.push(Y.a.Jxf)}OGd(S){const Wa=
this.Ya.Oh();Wa.buttons.push(this.Ya.Sg(282));Wa.buttons.push(this.Ya.Sg(281));const zb=this.Ya.fz("BringToFront","BringToFrontMenuId",Ia.a.instance.ia(822),-1777747317);zb.menu.vh.push(Wa);S.buttons.push(zb)}dHd(S){const Wa=this.Ya.Oh();Wa.buttons.push(this.Ya.Sg(284));Wa.buttons.push(this.Ya.Sg(283));const zb=this.Ya.fz("SendToBack","SendToBackMenuId",Ia.a.instance.ia(823),-1777747317);zb.menu.vh.push(Wa);S.buttons.push(zb)}};xb=Object(N.__decorate)([Object($b.d)(Ib.nc),Object(N.__param)(0,Object(Ib.Lb)()),
Object(N.__param)(1,Object(Ib["if"])()),Object(N.__param)(2,Object(Ib.cb)()),Object(N.__param)(3,Object(Ib.Lg)())],xb);Object(M.a)(xb,"FloatingObjectContextMenu",Y.a,[]);var Lb=a(654),Rc=a(95),nd=a(647),$d=a(595),Td;(function(S){S[S.dataLabelsNoneColumn=0]="dataLabelsNoneColumn";S[S.dataLabelsNoneLine=1]="dataLabelsNoneLine";S[S.dataLabelsNonePie=2]="dataLabelsNonePie";S[S.dataLabelsShowColumn=3]="dataLabelsShowColumn";S[S.dataLabelsCenterColumn=4]="dataLabelsCenterColumn";S[S.dataLabelsCenterLine=
5]="dataLabelsCenterLine";S[S.dataLabelsCenterPie=6]="dataLabelsCenterPie";S[S.dataLabelsInsideEndColumn=7]="dataLabelsInsideEndColumn";S[S.dataLabelsInsideEndPie=8]="dataLabelsInsideEndPie";S[S.dataLabelsInsideBaseColumn=9]="dataLabelsInsideBaseColumn";S[S.dataLabelsOutsideEndColumn=10]="dataLabelsOutsideEndColumn";S[S.dataLabelsOutsideEndPie=11]="dataLabelsOutsideEndPie";S[S.dataLabelsLeftLine=12]="dataLabelsLeftLine";S[S.dataLabelsRightLine=13]="dataLabelsRightLine";S[S.dataLabelsAboveLine=14]=
"dataLabelsAboveLine";S[S.dataLabelsBelowLine=15]="dataLabelsBelowLine";S[S.dataLabelsBestFitPie=16]="dataLabelsBestFitPie";S[S.axesHorizontalNone=17]="axesHorizontalNone";S[S.axesHorizontalShowLtr=18]="axesHorizontalShowLtr";S[S.axesHoriztonalNoLabels=19]="axesHoriztonalNoLabels";S[S.axesHorizontalShowRtl=20]="axesHorizontalShowRtl";S[S.axesHorizontalDefault=21]="axesHorizontalDefault";S[S.axesHorizontalThousands=22]="axesHorizontalThousands";S[S.axesHorizontalMillions=23]="axesHorizontalMillions";
S[S.axesHorizontalBillions=24]="axesHorizontalBillions";S[S.axesHorizontalLogScale=25]="axesHorizontalLogScale";S[S.axesVerticalNone=26]="axesVerticalNone";S[S.axesVerticalDefault=27]="axesVerticalDefault";S[S.axesVerticalThousands=28]="axesVerticalThousands";S[S.axesVerticalMillions=29]="axesVerticalMillions";S[S.axesVerticalBillions=30]="axesVerticalBillions";S[S.axesVerticalLogScale=31]="axesVerticalLogScale";S[S.axesVerticalNoLabels=32]="axesVerticalNoLabels";S[S.axesVerticalShowRtl=33]="axesVerticalShowRtl";
S[S.gridlinesHorizontalNone=34]="gridlinesHorizontalNone";S[S.gridlinesHorizontalMajor=35]="gridlinesHorizontalMajor";S[S.gridlinesHorizontalMinor=36]="gridlinesHorizontalMinor";S[S.gridlinesHorizontalMajorMinor=37]="gridlinesHorizontalMajorMinor";S[S.gridlinesVerticalNone=38]="gridlinesVerticalNone";S[S.gridlinesVerticalMajor=39]="gridlinesVerticalMajor";S[S.gridlinesVerticalMinor=40]="gridlinesVerticalMinor";S[S.gridlinesVerticalMajorMinor=41]="gridlinesVerticalMajorMinor";S[S.contextMenuCut=42]=
"contextMenuCut";S[S.contextMenuCopy=43]="contextMenuCopy";S[S.contextMenuPaste=44]="contextMenuPaste";S[S.contextMenuHyperlink=45]="contextMenuHyperlink";S[S.contextMenuHyperlinks=46]="contextMenuHyperlinks";S[S.contextMenuRemoveHyperlink=47]="contextMenuRemoveHyperlink";S[S.contextMenuRemoveHyperlinks=48]="contextMenuRemoveHyperlinks";S[S.contextMenuInsertRows=49]="contextMenuInsertRows";S[S.contextMenuInsertColumns=50]="contextMenuInsertColumns";S[S.contextMenuDeleteRows=51]="contextMenuDeleteRows";
S[S.contextMenuDeleteColumns=52]="contextMenuDeleteColumns";S[S.contextMenuOpenHyperlink=53]="contextMenuOpenHyperlink";S[S.contextMenuInsertSheet=54]="contextMenuInsertSheet";S[S.contextMenuRenameSheet=55]="contextMenuRenameSheet";S[S.contextMenuDeleteSheet=56]="contextMenuDeleteSheet";S[S.contextMenuPasteDisabled=57]="contextMenuPasteDisabled";S[S.contextMenuPivotFieldListHide=58]="contextMenuPivotFieldListHide";S[S.contextMenuPivotFieldListShow=59]="contextMenuPivotFieldListShow";S[S.contextMenuFieldWellMoveUp=
60]="contextMenuFieldWellMoveUp";S[S.contextMenuFieldWellMoveDown=61]="contextMenuFieldWellMoveDown";S[S.contextMenuFieldWellMoveToBeginning=62]="contextMenuFieldWellMoveToBeginning";S[S.contextMenuFieldWellMoveToEnd=63]="contextMenuFieldWellMoveToEnd";S[S.contextMenuFieldWellMoveUpDisabled=64]="contextMenuFieldWellMoveUpDisabled";S[S.contextMenuFieldWellMoveDownDisabled=65]="contextMenuFieldWellMoveDownDisabled";S[S.contextMenuFieldWellMoveToBeginningDisabled=66]="contextMenuFieldWellMoveToBeginningDisabled";
S[S.contextMenuFieldWellMoveToEndDisabled=67]="contextMenuFieldWellMoveToEndDisabled";S[S.contextMenuFieldWellMoveToReportFilter=68]="contextMenuFieldWellMoveToReportFilter";S[S.contextMenuFieldWellMoveToRowLabels=69]="contextMenuFieldWellMoveToRowLabels";S[S.contextMenuFieldWellMoveToColumnLabels=70]="contextMenuFieldWellMoveToColumnLabels";S[S.contextMenuFieldWellMoveToValues=71]="contextMenuFieldWellMoveToValues";S[S.contextMenuFieldWellMoveToReportFilterDisabled=72]="contextMenuFieldWellMoveToReportFilterDisabled";
S[S.contextMenuFieldWellMoveToRowLabelsDisabled=73]="contextMenuFieldWellMoveToRowLabelsDisabled";S[S.contextMenuFieldWellMoveToColumnLabelsDisabled=74]="contextMenuFieldWellMoveToColumnLabelsDisabled";S[S.contextMenuFieldWellMoveToValuesDisabled=75]="contextMenuFieldWellMoveToValuesDisabled";S[S.contextMenuFieldWellRemoveField=76]="contextMenuFieldWellRemoveField";S[S.contextMenuFieldWellValueFieldSettings=77]="contextMenuFieldWellValueFieldSettings";S[S.contextMenuFieldListAddAsSlicer=78]="contextMenuFieldListAddAsSlicer";
S[S.contextMenuFieldListMoveToReportFilter=79]="contextMenuFieldListMoveToReportFilter";S[S.contextMenuFieldListMoveToRowLabels=80]="contextMenuFieldListMoveToRowLabels";S[S.contextMenuFieldListMoveToColumnsLabels=81]="contextMenuFieldListMoveToColumnsLabels";S[S.contextMenuFieldListMoveToValues=82]="contextMenuFieldListMoveToValues";S[S.contextMenuFieldListMoveToReportFilterDisabled=83]="contextMenuFieldListMoveToReportFilterDisabled";S[S.contextMenuFieldListMoveToRowLabelsDisabled=84]="contextMenuFieldListMoveToRowLabelsDisabled";
S[S.contextMenuFieldListMoveToColumnsLabelsDisabled=85]="contextMenuFieldListMoveToColumnsLabelsDisabled";S[S.contextMenuFieldListMoveToValuesDisabled=86]="contextMenuFieldListMoveToValuesDisabled";S[S.timeSlicerLevelYear=87]="timeSlicerLevelYear";S[S.timeSlicerLevelQuarter=88]="timeSlicerLevelQuarter";S[S.timeSlicerLevelMonth=89]="timeSlicerLevelMonth";S[S.timeSlicerLevelDay=90]="timeSlicerLevelDay";S[S.contextMenuFieldListMoveToRowChartLabels=91]="contextMenuFieldListMoveToRowChartLabels";S[S.contextMenuFieldListMoveToColumnsChartLabels=
92]="contextMenuFieldListMoveToColumnsChartLabels";S[S.contextMenuFieldListMoveToRowChartLabelsDisabled=93]="contextMenuFieldListMoveToRowChartLabelsDisabled";S[S.contextMenuFieldListMoveToColumnsChartLabelsDisabled=94]="contextMenuFieldListMoveToColumnsChartLabelsDisabled";S[S.contextMenuFieldWellMoveToRowChartLabels=95]="contextMenuFieldWellMoveToRowChartLabels";S[S.contextMenuFieldWellMoveToColumnChartLabels=96]="contextMenuFieldWellMoveToColumnChartLabels";S[S.contextMenuFieldWellMoveToRowChartLabelsDisabled=
97]="contextMenuFieldWellMoveToRowChartLabelsDisabled";S[S.contextMenuFieldWellMoveToColumnChartLabelsDisabled=98]="contextMenuFieldWellMoveToColumnChartLabelsDisabled";S[S.contextMenuBIExploreShowCallout=99]="contextMenuBIExploreShowCallout";S[S.contextMenuRefresh=100]="contextMenuRefresh";S[S.contextMenuDeleteChart=101]="contextMenuDeleteChart";S[S.contextMenuEditCell=102]="contextMenuEditCell";S[S.insertForm=103]="insertForm";S[S.editForm=104]="editForm";S[S.deleteForm=105]="deleteForm";S[S.shareForm=
106]="shareForm";S[S.viewForm=107]="viewForm";S[S.contextMenuHideRows=108]="contextMenuHideRows";S[S.contextMenuHideColumns=109]="contextMenuHideColumns";S[S.contextMenuUnhideRows=110]="contextMenuUnhideRows";S[S.contextMenuUnhideColumns=111]="contextMenuUnhideColumns";S[S.contextMenuHideSheet=112]="contextMenuHideSheet";S[S.contextMenuUnhideSheet=113]="contextMenuUnhideSheet";S[S.contextMenuHideSheetDisabled=114]="contextMenuHideSheetDisabled";S[S.contextMenuUnhideSheetDisabled=115]="contextMenuUnhideSheetDisabled";
S[S.contextMenuInsertRowsDisabled=116]="contextMenuInsertRowsDisabled";S[S.contextMenuInsertColumnsDisabled=117]="contextMenuInsertColumnsDisabled";S[S.contextMenuDeleteRowsDisabled=118]="contextMenuDeleteRowsDisabled";S[S.contextMenuDeleteColumnsDisabled=119]="contextMenuDeleteColumnsDisabled";S[S.contextMenuHyperlinkDisabled=120]="contextMenuHyperlinkDisabled";S[S.contextMenuHyperlinksDisabled=121]="contextMenuHyperlinksDisabled";S[S.contextMenuRemoveHyperlinkDisabled=122]="contextMenuRemoveHyperlinkDisabled";
S[S.contextMenuRemoveHyperlinksDisabled=123]="contextMenuRemoveHyperlinksDisabled";S[S.contextMenuOpenHyperlinkDisabled=124]="contextMenuOpenHyperlinkDisabled";S[S.contextMenuReorderSheet=125]="contextMenuReorderSheet";S[S.contextMenuReorderSheetDisabled=126]="contextMenuReorderSheetDisabled";S[S.contextMenuDeleteSheetDisabled=127]="contextMenuDeleteSheetDisabled";S[S.chartOutlineWeight1pt=128]="chartOutlineWeight1pt";S[S.chartOutlineWeight2pt=129]="chartOutlineWeight2pt";S[S.chartOutlineWeight3pt=
130]="chartOutlineWeight3pt";S[S.chartOutlineWeight4pt=131]="chartOutlineWeight4pt";S[S.chartOutlineDashesSolid=132]="chartOutlineDashesSolid";S[S.chartOutlineDashesSquareDot=133]="chartOutlineDashesSquareDot";S[S.chartOutlineDashesDash=134]="chartOutlineDashesDash";S[S.contextMenuNumberFormating=135]="contextMenuNumberFormating";S[S.pivotTableValueFieldContextMenuNumberFormating=136]="pivotTableValueFieldContextMenuNumberFormating";S[S.accountingFormat=137]="accountingFormat";S[S.dataLabelsAboveBoxWhisker=
138]="dataLabelsAboveBoxWhisker";S[S.dataLabelsBelowBoxWhisker=139]="dataLabelsBelowBoxWhisker";S[S.dataLabelsLeftBoxWhisker=140]="dataLabelsLeftBoxWhisker";S[S.dataLabelsNoneBoxWhisker=141]="dataLabelsNoneBoxWhisker";S[S.dataLabelsRightBoxWhisker=142]="dataLabelsRightBoxWhisker";S[S.dataLabelsShowFunnel=143]="dataLabelsShowFunnel";S[S.dataLabelsShowTreemap=144]="dataLabelsShowTreemap";S[S.dataLabelsShowSunburst=145]="dataLabelsShowSunburst";S[S.contextMenuEditAltText=146]="contextMenuEditAltText";
S[S.contextMenuEditText=147]="contextMenuEditText";S[S.contextMenuClearContent=148]="contextMenuClearContent";S[S.contextMenuClearContentDisabled=149]="contextMenuClearContentDisabled";S[S.contextMenuRowHeight=150]="contextMenuRowHeight";S[S.contextMenuRowHeightDisabled=151]="contextMenuRowHeightDisabled";S[S.contextMenuColumnWidth=152]="contextMenuColumnWidth";S[S.contextMenuColumnWidthDisabled=153]="contextMenuColumnWidthDisabled";S[S.contextMenuHideRowsDisabled=154]="contextMenuHideRowsDisabled";
S[S.contextMenuHideColumnsDisabled=155]="contextMenuHideColumnsDisabled";S[S.contextMenuUnhideRowsDisabled=156]="contextMenuUnhideRowsDisabled";S[S.contextMenuUnhideColumnsDisabled=157]="contextMenuUnhideColumnsDisabled";S[S.contextMenuDuplicateSheet=158]="contextMenuDuplicateSheet";S[S.contextMenuInsertReply=159]="contextMenuInsertReply";S[S.contextMenuInsertThreadedComment=160]="contextMenuInsertThreadedComment";S[S.contextMenuInsertRowsTable=161]="contextMenuInsertRowsTable";S[S.contextMenuInsertColumnsTable=
162]="contextMenuInsertColumnsTable";S[S.contextMenuDeleteRowsTable=163]="contextMenuDeleteRowsTable";S[S.contextMenuDeleteColumnsTable=164]="contextMenuDeleteColumnsTable";S[S.contextMenuInsertCellsShiftRight=165]="contextMenuInsertCellsShiftRight";S[S.contextMenuInsertCellsShiftDown=166]="contextMenuInsertCellsShiftDown";S[S.contextMenuDeleteCellsShiftLeft=167]="contextMenuDeleteCellsShiftLeft";S[S.contextMenuDeleteCellsShiftUp=168]="contextMenuDeleteCellsShiftUp";S[S.contextMenuInsertRowsTableDisabled=
169]="contextMenuInsertRowsTableDisabled";S[S.contextMenuInsertColumnsTableDisabled=170]="contextMenuInsertColumnsTableDisabled";S[S.contextMenuDeleteRowsTableDisabled=171]="contextMenuDeleteRowsTableDisabled";S[S.contextMenuDeleteColumnsTableDisabled=172]="contextMenuDeleteColumnsTableDisabled";S[S.contextMenuInsertCellsShiftRightDisabled=173]="contextMenuInsertCellsShiftRightDisabled";S[S.contextMenuInsertCellsShiftDownDisabled=174]="contextMenuInsertCellsShiftDownDisabled";S[S.contextMenuDeleteCellsShiftLeftDisabled=
175]="contextMenuDeleteCellsShiftLeftDisabled";S[S.contextMenuDeleteCellsShiftUpDisabled=176]="contextMenuDeleteCellsShiftUpDisabled";S[S.contextMenuInsertRowsSheet=177]="contextMenuInsertRowsSheet";S[S.contextMenuInsertColumnsSheet=178]="contextMenuInsertColumnsSheet";S[S.contextMenuDeleteRowsSheet=179]="contextMenuDeleteRowsSheet";S[S.contextMenuDeleteColumnsSheet=180]="contextMenuDeleteColumnsSheet";S[S.contextMenuInsertRowsSheetDisabled=181]="contextMenuInsertRowsSheetDisabled";S[S.contextMenuInsertColumnsSheetDisabled=
182]="contextMenuInsertColumnsSheetDisabled";S[S.contextMenuDeleteRowsSheetDisabled=183]="contextMenuDeleteRowsSheetDisabled";S[S.contextMenuDeleteColumnsSheetDisabled=184]="contextMenuDeleteColumnsSheetDisabled";S[S.contextMenuOpenImmersiveReader=185]="contextMenuOpenImmersiveReader";S[S.contextMenuExitEditText=186]="contextMenuExitEditText";S[S.contextMenuInsertCellsShiftLeft=187]="contextMenuInsertCellsShiftLeft";S[S.contextMenuInsertCellsShiftLeftDisabled=188]="contextMenuInsertCellsShiftLeftDisabled";
S[S.contextMenuDeleteCellsShiftRight=189]="contextMenuDeleteCellsShiftRight";S[S.contextMenuDeleteCellsShiftRightDisabled=190]="contextMenuDeleteCellsShiftRightDisabled";S[S.contextMenuInsertColumnsTableToTheRight=191]="contextMenuInsertColumnsTableToTheRight";S[S.contextMenuInsertColumnsTableToTheRightDisabled=192]="contextMenuInsertColumnsTableToTheRightDisabled";S[S.shapeOutlineWeightQuarterPt=193]="shapeOutlineWeightQuarterPt";S[S.shapeOutlineWeightHalfPt=194]="shapeOutlineWeightHalfPt";S[S.shapeOutlineWeightThreeQuartersPt=
195]="shapeOutlineWeightThreeQuartersPt";S[S.shapeOutlineWeight1pt=196]="shapeOutlineWeight1pt";S[S.shapeOutlineWeight1AndHalfPt=197]="shapeOutlineWeight1AndHalfPt";S[S.shapeOutlineWeight2pt=198]="shapeOutlineWeight2pt";S[S.shapeOutlineWeight2AndQuarterPt=199]="shapeOutlineWeight2AndQuarterPt";S[S.shapeOutlineWeight3pt=200]="shapeOutlineWeight3pt";S[S.shapeOutlineWeight4pt=201]="shapeOutlineWeight4pt";S[S.shapeOutlineWeight4AndHalfpt=202]="shapeOutlineWeight4AndHalfpt";S[S.shapeOutlineWeight6pt=203]=
"shapeOutlineWeight6pt";S[S.shapeOutlineDashesSolid=204]="shapeOutlineDashesSolid";S[S.shapeOutlineDashesRoundedDot=205]="shapeOutlineDashesRoundedDot";S[S.shapeOutlineDashesSquareDot=206]="shapeOutlineDashesSquareDot";S[S.shapeOutlineDashesDash=207]="shapeOutlineDashesDash";S[S.shapeOutlineDashesDashDot=208]="shapeOutlineDashesDashDot";S[S.shapeOutlineDashesLongDash=209]="shapeOutlineDashesLongDash";S[S.shapeOutlineDashesLongDashDot=210]="shapeOutlineDashesLongDashDot";S[S.shapeOutlineDashesLongDashDotDot=
211]="shapeOutlineDashesLongDashDotDot";S[S.contextMenuInsertCopiedCells=212]="contextMenuInsertCopiedCells";S[S.contextMenuInsertCutCells=213]="contextMenuInsertCutCells";S[S.convertToLinkedEntity=214]="convertToLinkedEntity";S[S.contextMenuConvertLinkedEntityToText=215]="contextMenuConvertLinkedEntityToText";S[S.contextMenuShowCard=216]="contextMenuShowCard";S[S.contextMenuShowImageDetails=217]="contextMenuShowImageDetails";S[S.contextMenuRefreshLinkedEntities=218]="contextMenuRefreshLinkedEntities";
S[S.contextMenuLinkedEntityChangeObject=219]="contextMenuLinkedEntityChangeObject";S[S.contextMenuShowLinkedEntityRefreshPane=220]="contextMenuShowLinkedEntityRefreshPane";S[S.contextMenuDeleteThreadedComment=221]="contextMenuDeleteThreadedComment";S[S.nameBox=222]="nameBox";S[S.contextMenuSortAscending=223]="contextMenuSortAscending";S[S.contextMenuSortDescending=224]="contextMenuSortDescending";S[S.contextMenuSortCustom=225]="contextMenuSortCustom";S[S.contextMenuNewNote=226]="contextMenuNewNote";
S[S.contextMenuEditNote=227]="contextMenuEditNote";S[S.contextMenuDeleteNote=228]="contextMenuDeleteNote";S[S.contextMenuShowOrHideNote=229]="contextMenuShowOrHideNote";S[S.contextMenuConvertNote=230]="contextMenuConvertNote";S[S.namedSheetView=231]="namedSheetView";S[S.contextMenuConvertToRange=232]="contextMenuConvertToRange";S[S.contextMenuFilterByCellValue=233]="contextMenuFilterByCellValue";S[S.contextMenuFilterClear=234]="contextMenuFilterClear";S[S.contextMenuFilterReapply=235]="contextMenuFilterReapply";
S[S.contextMenuIdeasAskAndAnalyze=236]="contextMenuIdeasAskAndAnalyze";S[S.contextMenuIdeasAskMyData=237]="contextMenuIdeasAskMyData";S[S.contextMenuIdeasAnalyzeData=238]="contextMenuIdeasAnalyzeData";S[S.contextMenuIgnoreError=239]="contextMenuIgnoreError";S[S.contextMenuIgnoreErrors=240]="contextMenuIgnoreErrors";S[S.contextMenuShowError=241]="contextMenuShowError";S[S.contextMenuPivotExpandCollapse=242]="contextMenuPivotExpandCollapse";S[S.contextMenuPivotExpand=243]="contextMenuPivotExpand";S[S.contextMenuPivotCollapse=
244]="contextMenuPivotCollapse";S[S.contextMenuPivotExpandEntireField=245]="contextMenuPivotExpandEntireField";S[S.contextMenuPivotCollapseEntireField=246]="contextMenuPivotCollapseEntireField";S[S.contextMenuPivotShowDetails=247]="contextMenuPivotShowDetails";S[S.contextMenuPasteAdvancedOptionsGallery=248]="contextMenuPasteAdvancedOptionsGallery";S[S.chartTaskPane=249]="chartTaskPane";S[S.contextMenuSmartLookup=250]="contextMenuSmartLookup";S[S.contextMenuSlicerRefresh=251]="contextMenuSlicerRefresh";
S[S.contextMenuSlicerClearFilter=252]="contextMenuSlicerClearFilter";S[S.contextMenuSlicerMultiSelect=253]="contextMenuSlicerMultiSelect";S[S.contextMenuSlicerDelete=254]="contextMenuSlicerDelete";S[S.contextMenuSlicerSortAscending=255]="contextMenuSlicerSortAscending";S[S.contextMenuSlicerSortDescending=256]="contextMenuSlicerSortDescending";S[S.contextMenuPivotSettingsPaneHide=257]="contextMenuPivotSettingsPaneHide";S[S.contextMenuPivotSettingsPaneShow=258]="contextMenuPivotSettingsPaneShow";S[S.contextMenuPivotNoSubtotal=
259]="contextMenuPivotNoSubtotal";S[S.contextMenuPivotSubtotalOnTop=260]="contextMenuPivotSubtotalOnTop";S[S.contextMenuPivotSubtotalOnBottom=261]="contextMenuPivotSubtotalOnBottom";S[S.gridContextMenuShowChanges=262]="gridContextMenuShowChanges";S[S.sheetOpsContextMenuShowChanges=263]="sheetOpsContextMenuShowChanges";S[S.zoomFitToScreen=264]="zoomFitToScreen";S[S.zoomFitToScreenUndo=265]="zoomFitToScreenUndo";S[S.contextMenuSlicerSettingsPaneHide=266]="contextMenuSlicerSettingsPaneHide";S[S.contextMenuSlicerSettingsPaneShow=
267]="contextMenuSlicerSettingsPaneShow";S[S.contextMenuConvertLinkedEntityToTextDisabled=268]="contextMenuConvertLinkedEntityToTextDisabled";S[S.contextMenuRefreshLinkedEntitiesDisabled=269]="contextMenuRefreshLinkedEntitiesDisabled";S[S.contextMenuLinkedEntityChangeObjectDisabled=270]="contextMenuLinkedEntityChangeObjectDisabled";S[S.contextMenuShowLinkedEntityRefreshPaneDisabled=271]="contextMenuShowLinkedEntityRefreshPaneDisabled";S[S.contextMenuShowOpenInAppDialogOnMobile=272]="contextMenuShowOpenInAppDialogOnMobile";
S[S.contextMenuViewScript=273]="contextMenuViewScript";S[S.contextMenuShareChart=274]="contextMenuShareChart";S[S.contextMenuShareRange=275]="contextMenuShareRange";S[S.contextMenuShareTable=276]="contextMenuShareTable";S[S.contextMenuManageProtection=277]="contextMenuManageProtection";S[S.contextMenuPauseProtection=278]="contextMenuPauseProtection";S[S.contextMenuResumeProtection=279]="contextMenuResumeProtection";S[S.functionMenu=280]="functionMenu";S[S.contextMenuBringForward=281]="contextMenuBringForward";
S[S.contextMenuBringToFront=282]="contextMenuBringToFront";S[S.contextMenuSendBackWard=283]="contextMenuSendBackWard";S[S.contextMenuSendToBack=284]="contextMenuSendToBack";S[S.contextMenuToggleTotalRow=285]="contextMenuToggleTotalRow";S[S.contextMenuTableAltText=286]="contextMenuTableAltText";S[S.chartTaskPaneData=287]="chartTaskPaneData";S[S.contextMenuInsertColumnsToTheRight=288]="contextMenuInsertColumnsToTheRight";S[S.contextMenuInsertColumnsToTheRightDisabled=289]="contextMenuInsertColumnsToTheRightDisabled";
S[S.contextMenuInsertColumnsSheetToTheRight=290]="contextMenuInsertColumnsSheetToTheRight";S[S.contextMenuInsertColumnsSheetToTheRightDisabled=291]="contextMenuInsertColumnsSheetToTheRightDisabled";S[S.contextMenuPutSelectedCellColorOnTop=292]="contextMenuPutSelectedCellColorOnTop";S[S.contextMenuPutSelectedFontColorOnTop=293]="contextMenuPutSelectedFontColorOnTop";S[S.contextMenuPutSelectedFormattingIconOnTop=294]="contextMenuPutSelectedFormattingIconOnTop";S[S.contextMenuShareSheet=299]="contextMenuShareSheet";
S[S.contextMenuFormatCells=300]="contextMenuFormatCells";S[S.contextMenuPivotTableDelete=301]="contextMenuPivotTableDelete";S[S.contextMenuEditCellImageAltText=302]="contextMenuEditCellImageAltText";S[S.contextMenuPlaceInCell=303]="contextMenuPlaceInCell";S[S.contextMenuPlaceOverCell=304]="contextMenuPlaceOverCell";S[S.contextMenuCreateReference=305]="contextMenuCreateReference";S[S.contextMenuPivotTableManualUngroup=306]="contextMenuPivotTableManualUngroup";S[S.contextMenuPivotTableManualGroup=307]=
"contextMenuPivotTableManualGroup";S[S.contextMenuDeleteChartElement=308]="contextMenuDeleteChartElement";S[S.gridContextMenuShareSheet=309]="gridContextMenuShareSheet";S[S.gridContextMenuShareRange=310]="gridContextMenuShareRange";S[S.gridContextMenuShareTable=311]="gridContextMenuShareTable";S[S.contextMenuCopyLinkToSheet=312]="contextMenuCopyLinkToSheet";S[S.contextMenuFilterByCellColor=313]="contextMenuFilterByCellColor";S[S.contextMenuFilterByCellFontColor=314]="contextMenuFilterByCellFontColor";
S[S.contextMenuFilterByCellIcon=315]="contextMenuFilterByCellIcon";S[S.contextMenuNamedSheetView=316]="contextMenuNamedSheetView";S[S.contextMenuShareNamedSheetView=317]="contextMenuShareNamedSheetView";S[S.contextMenuShareNamedSheetViewDisabled=318]="contextMenuShareNamedSheetViewDisabled";S[S.contextMenuExitNamedSheetView=319]="contextMenuExitNamedSheetView";S[S.contextMenuSaveNamedSheetView=320]="contextMenuSaveNamedSheetView";S[S.contextMenuAddDataLabels=321]="contextMenuAddDataLabels";S[S.contextMenuAddTrendline=
322]="contextMenuAddTrendline";S[S.contextMenuAddTrendlineTitle=323]="contextMenuAddTrendlineTitle";S[S.contextMenuAddAxisTitle=324]="contextMenuAddAxisTitle";S[S.contextMenuAddMajorGridlines=325]="contextMenuAddMajorGridlines";S[S.contextMenuAddMinorGridlines=326]="contextMenuAddMinorGridlines";S[S.contextMenuCopyHyperlink=330]="contextMenuCopyHyperlink";S[S.contextMenuShowLinkPreview=331]="contextMenuShowLinkPreview";S[S.contextMenuFieldListAddAsTimeline=332]="contextMenuFieldListAddAsTimeline";
S[S.contextMenuFieldListAddAsTimelineDisabled=333]="contextMenuFieldListAddAsTimelineDisabled";S[S.contextMenuInsertColumnsSheetToTheLeft=334]="contextMenuInsertColumnsSheetToTheLeft";S[S.contextMenuInsertColumnsSheetToTheLeftDisabled=335]="contextMenuInsertColumnsSheetToTheLeftDisabled";S[S.contextMenuInsertColumnsToTheLeft=336]="contextMenuInsertColumnsToTheLeft";S[S.contextMenuInsertColumnsToTheLeftDisabled=337]="contextMenuInsertColumnsToTheLeftDisabled";S[S.contextMenuFullSheetCopy=338]="contextMenuFullSheetCopy";
S[S.contextMenuFullSheetCopyDisabled=339]="contextMenuFullSheetCopyDisabled";S[S.contextMenuFullSheetPaste=340]="contextMenuFullSheetPaste";S[S.contextMenuFullSheetPasteDisabled=341]="contextMenuFullSheetPasteDisabled";S[S.contextMenuEditTextChartTitle=342]="contextMenuEditTextChartTitle";S[S.contextMenuEditTextAxisTitleHorizontal=343]="contextMenuEditTextAxisTitleHorizontal";S[S.contextMenuEditTextAxisTitleVertical=344]="contextMenuEditTextAxisTitleVertical";S[S.contextMenuTimeSlicerClearFilter=
345]="contextMenuTimeSlicerClearFilter";S[S.contextMenuAddErrorBarX=350]="contextMenuAddErrorBarX";S[S.contextMenuAddErrorBarY=351]="contextMenuAddErrorBarY";S[S.contextMenuAddErrorBarHz=352]="contextMenuAddErrorBarHz";S[S.contextMenuAddErrorBarVt=353]="contextMenuAddErrorBarVt";S[S.contextMenuPasteValues=354]="contextMenuPasteValues";S[S.contextMenuPasteFormulas=355]="contextMenuPasteFormulas";S[S.contextMenuPasteFormatting=356]="contextMenuPasteFormatting";S[S.contextMenuPasteLink=357]="contextMenuPasteLink";
S[S.contextMenuPasteWithColumnWidths=358]="contextMenuPasteWithColumnWidths";S[S.contextMenuPasteTranspose=359]="contextMenuPasteTranspose";S[S.contextMenuAppendSheet=360]="contextMenuAppendSheet";S[S.contextMenuOpenFormatCellsNumberFormatTaskPane=361]="contextMenuOpenFormatCellsNumberFormatTaskPane";S[S.contextMenuOpenFormatCellsFontTaskPane=362]="contextMenuOpenFormatCellsFontTaskPane";S[S.contextMenuInsertRowsAfterSheet=363]="contextMenuInsertRowsAfterSheet";S[S.contextMenuInsertRowsAfterSheetDisabled=
364]="contextMenuInsertRowsAfterSheetDisabled";S[S.contextMenuInsertRowsAfter=365]="contextMenuInsertRowsAfter";S[S.contextMenuInsertRowsAfterDisabled=366]="contextMenuInsertRowsAfterDisabled";S[S.contextMenuInsertColumnsAfterToTheRight=367]="contextMenuInsertColumnsAfterToTheRight";S[S.contextMenuInsertColumnsAfterToTheRightDisabled=368]="contextMenuInsertColumnsAfterToTheRightDisabled";S[S.contextMenuInsertColumnsAfterToTheLeft=369]="contextMenuInsertColumnsAfterToTheLeft";S[S.contextMenuInsertColumnsAfterToTheLeftDisabled=
370]="contextMenuInsertColumnsAfterToTheLeftDisabled";S[S.contextMenuInsertColumnsAfterSheetToTheLeft=371]="contextMenuInsertColumnsAfterSheetToTheLeft";S[S.contextMenuInsertColumnsAfterSheetToTheLeftDisabled=372]="contextMenuInsertColumnsAfterSheetToTheLeftDisabled";S[S.contextMenuInsertColumnsAfterSheetToTheRight=373]="contextMenuInsertColumnsAfterSheetToTheRight";S[S.contextMenuInsertColumnsAfterSheetToTheRightDisabled=374]="contextMenuInsertColumnsAfterSheetToTheRightDisabled";S[S.contextMenuAutoToggleFilter=
375]="contextMenuAutoToggleFilter"})(Td||(Td={}));Object(M.b)("RibbonButtonType",Td);var He;const oc=ea.a.NYh;let ld=He=class extends xb{constructor(S,Wa,zb,hc,cd){super(S,Wa,zb,hc,cd,"PopulateChartContextMenu",-498523270,1640762262,oc);this.isPivotChart=this.refresh=this.N4=this.Twa=this.TAa=!1}get vD(){return"PopulateChartContextMenu"}get DH(){return ea.a.dxg}executeCommand(S,Wa,zb){const hc=this.$;this.oh=Wa.method;Wa=zb[He.qoc];if(!(S&68)){if(!Wa){if(8===S)Wa=$d.a(hc).Ki;else{var cd=ha.f(hc).ha.$e.yh;
if(null===cd||void 0===cd?0:cd.floatingObject)Wa=cd.floatingObject.Ki}if(!Wa)return Jc.Task.Va(!0)}this.isPivotChart=!!(Wa.Attributes&4)}if(this.isPivotChart||hc.isEditMode)if(this.refresh=this.N4=this.Twa=this.TAa=!1,cd=ha.f(this.$).ha.$e.yh,R.ULS.shipAssertTag(537167107,0,!!cd),cd){this.floatingObject=cd.floatingObject;cd=nd.a(hc);if(null===cd||void 0===cd?0:cd.Soe)this.TAa=cd=Rc.g(hc.Bk),this.Twa=!cd;cd=hc.th;this.N4=(db.EwaSettings.G5()||!!Lb.b(hc))&&!!Wa&&!!(Wa.Attributes&512)&&!(S&8)&&cd.aea(32768);
cd.allowManualDataRefresh&&cd.allowInteractivity&&(this.refresh=!0);sc.a.vR()?(S=Object(qb.a)(Md.a,zb.eventArgs),zb=this.FYa(S),this.Ft(zb,!0,S.oh)):(S=this.FYa(Object(qb.a)(Md.a,zb.eventArgs)),this.Ft(S,!0))}return Jc.Task.Va(!0)}ni(S,Wa,zb){return-149612405===Wa.command&&!!zb&&this.R_f(S)}Gjc(S,Wa,zb){if(sc.a.Xmb())if(this.nOb())this.Hzi(S,Wa),this.Zyi(S,Wa);else{const hc=S.Oh();this.Rth(S,hc);db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)&&Wa.vh.push(hc);
db.EwaSettings.Ra(155)&&!this.isPivotChart&&zb.buttons.push(S.Sg(287));db.EwaSettings.Ra(155)&&zb.buttons.push(S.Sg(249));db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)&&zb.buttons.push(S.Sg(146));Wa.vh.push(zb);this.isPivotChart&&this.vvh(S,Wa);db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)||Wa.vh.push(hc);zb=S.Oh();db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)||zb.buttons.push(S.Sg(146));this.OGd(zb);this.dHd(zb);Wa.vh.push(zb)}else this.isPivotChart&&(this.refresh&&zb.buttons.push(S.Sg(100)),this.N4&&zb.buttons.push(S.Sg(99)),this.TAa?zb.buttons.push(S.Sg(59)):this.Twa&&zb.buttons.push(S.Sg(58))),super.Gjc(S,Wa,zb)}static get qoc(){return"chartMetaData"}y_(S){S=void 0===S?!1:S;if(sc.a.Xmb()){S=this.Ya;const Wa=S.Vv(this.menuId);if(this.$.isEditMode){const zb=S.Oh();this.Gjc(S,Wa,zb)}return Wa}return super.y_(S)}Rth(S,Wa){this.$.isEditMode&&(Wa.buttons.push(S.Sg(42)),
Wa.buttons.push(S.Sg(43)))}vvh(S,Wa){const zb=S.Oh();this.refresh&&zb.buttons.push(S.Sg(100));this.N4&&zb.buttons.push(S.Sg(99));this.TAa?zb.buttons.push(S.Sg(59)):this.Twa&&zb.buttons.push(S.Sg(58));Wa.vh.push(zb)}uzi(S){const Wa=this.Ya.Oh();Wa.buttons.push(this.Ya.Sg(352));Wa.buttons.push(this.Ya.Sg(353));const zb=this.Ya.fz("ErrorBars","ErrorBarsMenuId",Ia.a.instance.ia(2367),-1777747317);zb.menu.vh.push(Wa);S.buttons.push(zb)}Hzi(S,Wa){const zb=S.Oh();zb.buttons.push(S.Sg(249));ha.f(this.$).ha.$e.yh.oVc()&&
zb.buttons.push(S.Sg(308));Wa.vh.push(zb)}Zyi(S,Wa){var zb=ha.f(this.$).ha.$e.yh;const hc=S.Oh();if(zb){zb=zb.getContextMenuButtonList();let cd=null;if(zb){for(const ta of zb)if(Td["contextMenu"+ta])if("AddErrorBarX"===ta)cd=ta;else{if(cd)if("AddErrorBarY"===ta){this.uzi(hc);cd=null;continue}else hc.buttons.push(S.Sg(Td["contextMenu"+cd])),cd=null;hc.buttons.push(S.Sg(Td["contextMenu"+ta]))}"AddErrorBarX"===cd&&hc.buttons.push(S.Sg(Td["contextMenu"+cd]))}Wa.vh.push(hc)}}};ld=He=Object(N.__decorate)([Object($b.d)(Ib.Q),
Object(N.__param)(0,Object(Ib.Lb)()),Object(N.__param)(1,Object(Ib["if"])()),Object(N.__param)(2,Object(Ib.cb)()),Object(N.__param)(3,Object(Ib.Lg)())],ld);Object(M.a)(ld,"ChartContextMenu",xb,[]);var id=a(1533),fc=a(108),vc=a(152);let Tc=class{constructor(S,Wa){this.Vfb=Wa;this.$=S}dispose(){}Yla(){this.Vfb.Zla()}hUb(){return this.Vfb.hUb}xI(){this.Vfb.xI()}$pe(S,Wa,zb){Hb.m(this.$,Hb.b);this.Vfb.showContextMenu(Object(Q.a)(new id.a,{x:Wa.x,y:Wa.y}),zb,S);fc.EventHandlerManager.instance.WFd()}K6b(S,
Wa,zb){Hb.m(this.$,Hb.b);this.Vfb.showFloatie(Object(Q.a)(new id.a,{x:Wa.x,y:Wa.y}),S,zb);vc.c(()=>{fc.EventHandlerManager.instance.WFd()},this.$.xa)}Zpe(S,Wa,zb,hc){Hb.m(this.$,Hb.b);this.Vfb.Zpe(Object(Q.a)(new id.a,{x:Wa.x,y:Wa.y}),S,zb,hc)}};Tc=Object(N.__decorate)([Object($b.d)(Ib.cb),Object(N.__param)(0,Object(Ib.Lb)()),Object(N.__param)(1,Object(Ib.Ue)())],Tc);Object(M.a)(Tc,"ReactContextMenuController",null,[731,2]);var Bd=a(193);class Fd{constructor(){this.aU=this.Ah=null}}Object(M.a)(Fd,
"RibbonCommandParams",null,[]);class le{constructor(){this.menuModel=null;this.ejf=0}}Object(M.a)(le,"HeaderSnappedAutoFilterMenuCacheEntry",null,[]);class dc{constructor(){this.SBc={}}iEi(S){return(S=this.SBc[S.toString()])?S.menuModel:null}JNh(S,Wa){this.SBc[Wa.toString()]=Object(Q.a)(new le,{menuModel:S,ejf:ec.HelperMethods.uh()})}Otc(S){this.SBc[S.toString()]=null}FWi(S){return(S=this.SBc[S.toString()])?S.ejf:-1}}Object(M.a)(dc,"FilterMenuCache",null,[]);class Uc{constructor(S){this.$=S;this.kpb=
new dc}dispose(){this.$=null}lLi(S){if(!ha.f(this.$).wM){const Wa=ha.f(this.$).za.Wta(S,this.$.activeItemName);if(Wa&&Wa.blockPresentInViewportTimeStamp>this.kpb.FWi(S.left))return Wa.WA(S).autoFilterMenu}return this.kpb.iEi(S.left)}pig(S,Wa,zb){this.kpb&&(S=ha.f(this.$).wM?S.I6e[Wa].Menu:S.menuModel[Wa],this.kpb.JNh(S,zb))}qig(S){this.kpb&&this.kpb.Otc(S)}}Object(M.a)(Uc,"FilterMenuManager",null,[747,2]);var kb=a(185),rb=a(160),cc=a(47);Object($b.b)(Ib.db,{yk:"singleton"})(S=>No(function*(){const Wa=
yield $b.a.resolve(Ib.Lb,{va:S.va});var zb=Wa.th;if(zb.allowSelection||zb.allowEdits||zb.allowFiltering||zb.allowSorting||zb.allowPivotSpecificOperations){zb=yield $b.a.resolve(Ib.cb,{va:S.va});db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotPageFilterContextMenuForNativePivotTables",!1);let hc;hc=db.EwaSettings.ZSd()?db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotPageFilterContextMenuForNativePivotTables",!1)?yield Promise.all([$b.a.resolve(Ib.r,S),$b.a.resolve(Ib.Q,
S),$b.a.resolve(Ib.Yb,S),$b.a.resolve(Ib.Zb,S),$b.a.resolve(Ib.cc,S),$b.a.resolve(Ib.nc,S),$b.a.resolve(Ib.Yc,S),$b.a.resolve(Ib.xe,S),$b.a.resolve(Ib.ye,S),$b.a.resolve(Ib.Ff,S),$b.a.resolve(Ib.qg,S),$b.a.resolve(Ib.pg,S),$b.a.resolve(Ib.Te,S),$b.a.resolve(Ib.s,S),$b.a.resolve(Ib.ze,S),$b.a.resolve(Ib.Rf,S),$b.a.resolve(Ib.jf,S)]):yield Promise.all([$b.a.resolve(Ib.r,S),$b.a.resolve(Ib.Q,S),$b.a.resolve(Ib.Yb,S),$b.a.resolve(Ib.Zb,S),$b.a.resolve(Ib.cc,S),$b.a.resolve(Ib.nc,S),$b.a.resolve(Ib.Yc,
S),$b.a.resolve(Ib.xe,S),$b.a.resolve(Ib.Ff,S),$b.a.resolve(Ib.qg,S),$b.a.resolve(Ib.pg,S),$b.a.resolve(Ib.Te,S),$b.a.resolve(Ib.s,S),$b.a.resolve(Ib.ze,S),$b.a.resolve(Ib.Rf,S),$b.a.resolve(Ib.jf,S)]):yield Object(ma.e)(sa.GetServiceTaskFactory.create(Wa.ka,10,Wa.xa,S.va));return new mc(Wa,hc,zb)}R.ULS.sendTraceTag(507601880,0,15,"No client permissions to allow creating ConetxtMenuManager. Returning null.");return null}));class mc{constructor(S,Wa,zb){this.s7b={};this.sj=!1;this.hp=(hc,cd)=>{this.showContextMenu(void 0===
cd?null:cd)};this.Dfg=(hc,cd)=>{cd.EDj===mc.PZi&&ha.f(this.$).focus()};this.bS=(hc,cd)=>{hc=this.$.Ma.Ama(cd.Ah.command);(null===hc||void 0===hc?0:hc.dismissesContextualUI)&&this.Zla()};this.kA=()=>{$b.a.remove(Ib.cb);db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",!1)?void $b.a.resolve(Ib.cb,{va:3}).then(hc=>{for(const cd of this.s7b)cd.zee(hc)}):ra.TaskExtensions.Ua(Object(ma.d)($b.a.resolve(Ib.cb,{va:3})),hc=>{hc=hc.result;for(const cd of this.s7b)cd.zee(hc)},
this.$.xa)};this.$=S;this.WJ=zb;this.DIe=new Uc(this.$);Ib.db.Ha()||S.ka.ph(8,this);for(zb=0;zb<Wa.length;zb++)this.s7b[mc.aZh[zb]]=Wa[zb];this.ha=ha.f(S).ha;this.ha.bGb(this.hp);this.$.Ma.fGb(this.Dfg);Bd.a.instance.oDk();db.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ma.Ocb(this.bS);db.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.JJ(this.kA)}get rib(){return this.DIe}lyc(S){return wa.a.gj(this.s7b,
S)}dispose(){this.sj?R.ULS.sendTraceTag(537167062,1,50,"ContextMenuManager.Dispose: Dispose has been called more than once"):(this.sj=!0,this.$&&(Ib.db.Ha()||this.$.Pr(mc.xj),Ib.db.Ha()?$b.a.remove(Ib.db):this.$.ka.Ula(8),this.ha&&this.ha.$2b(this.hp),this.$.Ma.c3b(this.Dfg),this.$.Ma&&this.$.Ma.n5a(this.bS),db.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.GH(this.kA)),this.$=this.ha=null,this.rib.dispose(),this.s7b=this.DIe=null)}showContextMenu(S,
Wa,zb){Wa=void 0===Wa?null:Wa;zb=void 0===zb?null:zb;this.eJk(S)&&(db.EwaSettings.isChangeGateEnabled("OfficeVSO:8690935_CMServiceInitMarkerEnabled")&&S&&performance.mark(Hb.d,{startTime:S.La.rawEvent.timeStamp}),Hb.m(this.$,Hb.n),Wa=this.u1h(S,Wa,zb),db.EwaSettings.isChangeGateEnabled("OfficeVSO:8643787_onlyTrackGridContextMenu")&&S&&S.nca&&(zb=[],S.nca.showFloatie&&zb.push("floatie"),1441131127===Wa.Ah.command&&(zb.push("context-menu"),void 0===S.nca.eventName&&(S.nca.eventName="grid_context_menu")),
db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackAsyncPivotTableContextMenu",!1)&&671488277===Wa.Ah.command&&(zb.push("context-menu"),S.nca.eventName="context_menu_pivot_table"),0<zb.length&&xd.b(this.$).ix(S.nca.event,S.nca.eventName,null,zb)),this.$.Ma.dh(Wa.Ah,Wa.aU))}Zla(){this.WJ?this.WJ.Yla():R.ULS.sendTraceTag(537167061,1,10,"ContextMenuManager.DismissContextualUI: Context menu controller is null.")}eJk(S){return cc.a(this.$).Ex()?(R.ULS.sendTraceTag(537167060,1,50,"ContextMenuManager.OnContextMenu: Ignoring ContextMenu event because it is not allowed in partial interactivity mode"),
cc.a(this.$).sP(rb.a.grid,kb.a.showContextMenu),!1):!this.$.Ma.qri&&(!S||S.Qh!==ha.f(this.$).domElement&&!uc.a.equals(S.Qh.tagName,"INPUT",!0))}u1h(S,Wa,zb){Wa=void 0===Wa?null:Wa;zb={["eventArgs"]:S,["creationParams"]:void 0===zb?null:zb};S=S?S.oh:-1;const hc=this.ha.$e.yh;let cd=1441131127;hc?(Wa=hc.floatingObject,R.ULS.shipAssertTag(537167059,0,!!Wa,"floatingObj shouldn't be null."),sc.a.Xmb()?(cd=mc.PJi(Wa),-149612405===cd&&(zb[ld.qoc]=Wa?Wa.Ki:null)):mc.QVb(Wa)?cd=Wa.Q7.IsTimeline?205863562:
1312363469:mc.isPivotChart(Wa)?(zb[ld.qoc]=Wa?Wa.Ki:null,cd=-149612405):cd=-1372040782):mc.ZYf(Wa)?(zb[ld.qoc]=Wa,cd=-149612405):!Hb.l(this.$)&&Hb.k(ha.f(this.$))&&(cd=671488277);Wa=new Ha.a(cd,S,this.$.Rh,30,null);return Object(Q.a)(new Fd,{Ah:Wa,aU:zb})}static Aa(S){S.nr(mc.xj)}static isPivotChart(S){return!!S&&0===S.type&&mc.ZYf(S.Ki)}static y0(S){return!!S&&0===S.type&&mc.Ffj(S.Ki)}static QVb(S){return!!S&&2===S.type}static ZYf(S){return!!S&&!!(S.Attributes&4)}static Ffj(S){return!!S&&!!S.Attributes}static PJi(S){return mc.QVb(S)?
S.Q7.IsTimeline?205863562:1312363469:mc.y0(S)?-149612405:-1372040782}}mc.aZh="autoFilter chart fieldList fieldListPivotFilter fieldWell floatingObject grid pivotFilter sheetOps timeSlicerLevel timeSlicer tableFieldList autoFilterRichFieldList slicer richText".split(" ");mc.PZi="GridContextMenu";mc.xj=S=>{if(S=Object(qb.a)(10,S))R.ULS.sendTraceTag(507588688,0,15,"ContextMenuManager.Attach: EwaControl is not null."),Ib.db.Ha()?void $b.a.resolve(Ib.db,{va:0}):sa.GetServiceTaskFactory.create(S.ka,9,S.xa,
0)};Object(M.a)(mc,"ContextMenuManager",null,[730,2]);var Sa=a(16);const pb=ea.a.QYh;let Ac=class extends Y.a{constructor(S,Wa,zb,hc,cd){super(S,"PopulateFieldListContextMenu",-1045020714,-170383950,pb,!0,!1,pb,cd,Wa,!1,zb,hc);this.eW=this.uv=null;this.Kse=this.isOlap=this.S5=this.y0=!1}get vD(){return"PopulateFieldListContextMenu"}get DH(){return ea.a.ode}executeCommand(S,Wa,zb){S=Wa.command;switch(S){case 330754562:Wa=zb.domElement;this.isOlap=zb.isOlap;this.eW=zb.versionkey;this.uv=zb.fieldItem;
this.y0=zb.isChart;this.S5=zb.isPpm;this.Kse="supportsImplicitMeasures"in zb?zb.supportsImplicitMeasures:!1;ha.f(this.$).Cz(!0);Wa=Sa.DOMElementExtensions.getBounds(Wa);Wa=new Sys.UI.Point(Wa.x+Wa.width,Wa.y+Wa.height/2);"isKeyboardInput"in zb&&zb.isKeyboardInput?this.Ft(Wa,!1,1):this.Ft(Wa,!1);break;case 926905850:this.Kse&&this.uv&&5===this.uv.TypeTag&&!this.uv.IsCollapsible&&R.ULS.sendTraceTag(537167057,0,50,"Add implicit measurement from field list.");nd.a(this.$).dU(this.uv,8,-1,this.eW,Wa);
break;case -67292059:nd.a(this.$).dU(this.uv,1,-1,this.eW,Wa);break;case 745182485:nd.a(this.$).dU(this.uv,2,-1,this.eW,Wa);break;case 359279088:nd.a(this.$).dU(this.uv,4,-1,this.eW,Wa);break;case 547535945:nd.a(this.$).hxg(this.uv,0);break;case -2108836646:nd.a(this.$).hxg(this.uv,1);break;default:return mb.a(S)}return Jc.Task.Va(!0)}ni(S,Wa,zb){S=!1;switch(Wa.command){case 330754562:S=!!zb;break;case 926905850:case -67292059:case 745182485:case 359279088:case 547535945:case -2108836646:S=!0}return S}y_(){const S=
this.Ya.Vv(this.menuId);this.z4j(S);this.y0||this.isOlap||this.y4j(S);return S}z4j(S){const Wa=this.Ya,zb=Wa.Oh();let hc=!1;db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&(hc=this.isOlap&&!this.S5&&this.Kse&&5===this.uv.TypeTag&&!this.uv.IsCollapsible);3!==this.uv.TypeTag&&37!==this.uv.TypeTag||this.uv.IsSet?17===this.uv.TypeTag||this.S5?(zb.buttons.push(Wa.Sg(79)),zb.buttons.push(Wa.Sg(this.y0?91:80)),zb.buttons.push(Wa.Sg(this.y0?92:81)),zb.buttons.push(Wa.Sg(82))):
13===this.uv.TypeTag||this.uv.IsSet?(zb.buttons.push(Wa.Sg(83)),zb.buttons.push(Wa.Sg(this.y0?91:80)),zb.buttons.push(Wa.Sg(this.y0?92:81)),zb.buttons.push(Wa.Sg(86))):(zb.buttons.push(Wa.Sg(79)),zb.buttons.push(Wa.Sg(this.y0?91:80)),zb.buttons.push(Wa.Sg(this.y0?92:81)),zb.buttons.push(Wa.Sg(hc?82:86))):(zb.buttons.push(Wa.Sg(83)),zb.buttons.push(Wa.Sg(this.y0?93:84)),zb.buttons.push(Wa.Sg(this.y0?94:85)),zb.buttons.push(Wa.Sg(82)));S.vh.push(zb)}y4j(S){const Wa=this.Ya.Oh();Wa.buttons.push(this.Ya.Sg(78));
db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TimelineSlicers",!1)&&Wa.buttons.push(this.Ya.Sg(this.uv.AllowTimelines?332:333));S.vh.push(Wa)}};Ac=Object(N.__decorate)([Object($b.d)(Ib.Yb),Object(N.__param)(0,Object(Ib.Lb)()),Object(N.__param)(1,Object(Ib["if"])()),Object(N.__param)(2,Object(Ib.cb)()),Object(N.__param)(3,Object(Ib.Lg)())],Ac);Object(M.a)(Ac,"FieldListContextMenu",Y.a,[]);var yd=a(353),vb=a(77);class Sc{constructor(S){this.$=S;this.mY={}}get(S,Wa,zb){const hc=this.s_g(S,
"PivotFilterContextMenuCache.Get");return hc&&this.mY[hc]?this.mY[hc][Sc.sKd(Wa,this.$,S,zb)]:null}set(S,Wa,zb,hc){const cd=this.s_g(S,"PivotFilterContextMenuCache.Set");cd&&(this.mY[cd]||(this.mY[cd]={}),this.mY[cd][Sc.sKd(Wa,this.$,S,hc)]=zb)}Otc(S){S in this.mY&&this.mY[S]&&(this.mY[S]=null)}s_g(S,Wa){return vb.f(this.$.na)?this.$.activeItemName:(S=this.F_k(S,Wa))?S.Ci:null}F_k(S,Wa){S=la.F(S);S=ha.f(this.$).za.TIa(S,this.$.activeItemName);R.ULS.shipAssertTag(537167008,0,!!S,`PivotFilterContextMenuBase.TryGetBlockModelProxyFromCell: Can't query the menuCache as block wasn't found in the BlockManager (returned null). Called from: ${Wa}`);
return S}static sKd(S,Wa,zb,hc){return 0===hc?Wa.na.index+"_"+S.id+"_"+zb.FirstRow.toString()+"_"+zb.FirstColumn.toString():Wa.na.index+"_"+S.id}}Object(M.a)(Sc,"PivotFilterContextMenuCache",null,[]);class hd{constructor(){this.cell=null;this.dataSourceIndex=0;this.dr=this.pivotName=null}}Object(M.a)(hd,"ShowPivotFilterData",null,[]);var qc=a(1204),Lc=a(59);const bd=ea.a.iff;class jd extends Y.a{constructor(S,Wa,zb,hc,cd,ta,wb,ic,Oa,Cb){Cb=void 0===Cb?bd:Cb;super(S,Wa,zb,hc,Cb,!0,!1,"PivotFilterMenuRootName",
cd,ta,!1,wb,ic);this.ZLc=this.B5d=this.pivotData=this.bFb=this.lastEvent=this.orc=null;this.A9=this.noc=this.AZb=0;this.pivotFilterCache=this.IWa=null;this.CQj=(yc,Nc)=>{if(Nc)if(ab.a(yc))this.v2d(Nc,!1);else if(yc=yc.Result){this.nMb=Sc.sKd(Nc,this.$,this.pivotData.cell,this.A9);var Id=this.e$f(yc.MenuModel.Sections);this.IWa=Id;jd.mY.set(this.pivotData.cell,Nc,Id,this.A9);Ib.we.Ha()?this.pivotFilterCache.hVg(yc):qc.a(this.$).hVg(yc);this.v2d(Nc,!0)}};this.BQj=(yc,Nc)=>{this.v2d(Nc,!1)};this.onBlockCacheItemChanged=
(yc,Nc)=>{jd.mY.Otc(Nc.Ti.hash)};this.Ww=(yc,Nc)=>{jd.mY.Otc(Nc.Ti.hash)};this.sNa=null;this.Kaf=this.noc=this.C5d=this.AZb=-1;this.f3e=this.A9=0;this.pivotFilterCache=Oa;jd.mY||(jd.mY=new Sc(this.$),ha.f(this.$).za.Vy(this.onBlockCacheItemChanged),ha.f(this.$).za.wT(this.Ww),ha.f(this.$).za.Cka(this.onBlockCacheItemChanged))}ADd(S,Wa){const zb=S.rawEvent,hc=S.cell,cd=S.requiresConfirmation,ta=wb=>{if(wb){wb=zb?new Sys.UI.DomEvent(zb):null;this.pivotData=new hd;this.pivotData.pivotName=S.pivotName;
this.pivotData.dataSourceIndex=S.dataSourceIndex;this.pivotData.cell=hc;this.pivotData.dr=S.optionalPivotMenuAnchorParameter;if(this.pivotData.dr&&0<this.pivotData.dr.AnchorType){this.ZLc=S.objectId;this.AZb=S.objectVersion;const ic=this.pivotData.dr.AnchorType;if(4===ic||5===ic||6===ic||11===ic||9===ic||10===ic||8===ic)this.bFb=S.location}else this.B5d=this.ZLc=null,this.C5d=this.AZb=-1;ha.f(this.$).Cz(!0);this.$.Mq(hc);this.Yba(wb,wb?wb.target:S.domElement,this.pivotData,Wa,this.nKa())}};void $b.a.resolve(Ib.qb,
{va:1}).then(wb=>{wb.UL(cd,ta)});return!0}Yba(S,Wa,zb,hc){db.EwaSettings.isChangeGateEnabled("OfficeVSO:8652188_ContextMenuPerfLogging")&&null!=S&&xd.b(this.$).ix(S.rawEvent,"showDropDown",null,["dropdown-menu"]);if(Object(yd.a)(hd,zb)){this.pivotData=zb;this.orc=Wa;this.lastEvent=S;this.noc=this.pivotData.dr?this.pivotData.dr.AnchorValue1:-1;this.A9=this.pivotData.dr?this.pivotData.dr.AnchorType:0;S=!1;zb=null;zb=jd.mY.get(this.pivotData.cell,Wa,this.A9);S=!!zb;var cd=!0;switch(this.A9){case 4:case 5:case 6:this.sNa=
new Sys.UI.Point(this.bFb.x,this.bFb.y);cd=!1;break;case 7:var ta=Sys.UI.DomElement.getBounds(Wa);cd=ta.x+(0<=ta.x?0:ta.width);ta=ta.y+(0<=ta.y?0:ta.height);this.sNa=new Sys.UI.Point(0<=cd?cd:0,0<=ta?ta:0);cd=!1;break;case 8:case 10:case 9:case 11:this.sNa=new Sys.UI.Point(this.bFb.x,this.bFb.y);break;default:this.sNa=null}S&&this.ZLc===this.B5d&&this.AZb===this.C5d&&this.noc===this.Kaf&&this.A9===this.f3e?(R.ULS.sendTraceTag(537167042,0,50,"PivotFilterContextMenuBase.ShowDropDown: rendering pivot filter context menu from menu cache"),
this.IWa=zb,this.sNa?this.Ft(this.sNa,this.nKa()):db.EwaSettings.Q0a()?(hc=Y.a.Qxc(this.$,this.pivotData.cell),Y.a.vEc(hc)&&this.Ft(Y.a.myc(this.$,hc,!1),this.nKa())):Y.a.YSd(this.$,this.pivotData.cell)&&this.Ft(Y.a.nId(this.$,this.pivotData.cell,!1),this.nKa())):1!==jd.iJi(Wa)&&(cd&&(Wa.parentNode.menuFetchStates=1,this.czk(Wa),this.BKg(!0)),this.$.userOperationManager.enqueueOperation(new Ta.a(126,0,(wb,ic,Oa)=>{const Cb=this.$;return Ea.q(Cb.pa.ta,this.pivotData.cell,this.pivotData.dataSourceIndex,
this.pivotData.pivotName,Cb.domElement.id,Cb.isChromeRtl,Cb.workbookContext.NovMode,lb.c(wb,this.CQj),lb.b(ic,this.BQj),Oa,Wa,this.pivotData.dr)},16),hc))}}WPc(S){S.MenuSectionList.push(...this.IWa)}v2d(S,Wa){S.parentNode.menuFetchStates=2;this.BKg(!1);if(Wa){if(this.orc!==S||this.BDj())this.Ft(this.sNa,this.nKa());else if(this.sNa)super.Yba(this.lastEvent,S,null,null,this.nKa());else if(db.EwaSettings.Q0a()){S=Y.a.Qxc(this.$,this.pivotData.cell);if(!Y.a.vEc(S))return;this.Ft(Y.a.myc(this.$,S,!1),
this.nKa())}else{if(!Y.a.YSd(this.$,this.pivotData.cell))return;this.Ft(Y.a.nId(this.$,this.pivotData.cell,!1),this.nKa())}this.B5d=this.ZLc;this.C5d=this.AZb;this.f3e=this.A9;this.Kaf=this.noc}}nKa(){return 8!==this.A9&&9!==this.A9&&10!==this.A9&&11!==this.A9}BDj(){switch(this.pivotData.dr?this.pivotData.dr.AnchorType:0){case 1:case 2:case 3:case 4:case 5:case 6:case 7:return!0;default:return!1}}BKg(S){const Wa=this.orc;if(Wa){if(db.EwaSettings.isChangeGateEnabled("OfficeVSO:5041973_FixDropdownImageDisappearing")){var zb=
Sa.DOMElementExtensions.Gfa(Wa,"ewaprevsrc","");zb=!!zb&&"null"!==zb}else zb=!!Sa.DOMElementExtensions.Gfa(Wa,"ewaprevsrc","");S&&zb||!S&&!zb||(S?(Wa.setAttribute("ewaprevsrc",Wa.src),Wa.src=Lc.a.current.uu(98)):(S=Sa.DOMElementExtensions.Gfa(Wa,"ewaprevsrc",""),Wa.src=S,Wa.setAttribute("ewaprevsrc",null)))}}czk(S){this.orc=S}static iJi(S){const Wa=S.parentNode.menuFetchStates;void 0===Wa&&(S.parentNode.menuFetchStates=0);return Wa}}jd.mY=null;Object(M.a)(jd,"PivotFilterContextMenuBase",Y.a,[]);const Yd=
"FieldList"+ea.a.iff;let te=class extends jd{constructor(S,Wa,zb,hc,cd,ta){super(S,"PopulateFieldListPivotMenu",-1793121409,1378457149,ta,Wa,zb,hc,cd,Yd)}get vD(){return"PopulateFieldListPivotMenu"}get DH(){return ea.a.ixg}executeCommand(S,Wa,zb){return this.ADd(zb,Wa)?Jc.Task.Va(!0):mb.a(Wa.command)}ni(S,Wa,zb){return-1065117584===Wa.command&&!!zb}};te=Object(N.__decorate)([Object($b.d)(Ib.Zb),Object(N.__param)(0,Object(Ib.Lb)()),Object(N.__param)(1,Object(Ib["if"])()),Object(N.__param)(2,Object(Ib.cb)()),
Object(N.__param)(3,Object(Ib.Lg)()),Object(N.__param)(4,Object(Ib.we)())],te);Object(M.a)(te,"FieldListPivotContextMenu",jd,[]);var oe=a(242),Kd=a(31),Ee=a(96),rc=a(208),fd=a(963);class Ed{}Object(M.a)(Ed,"PivotValueFieldSettingsApplyData",null,[]);class Rd{}Rd.n5g="valueFieldSettingTabs";Rd.$7h="dataFieldCustomLabel";Rd.Mjf="dataFieldSourceLabel";Rd.Kqe="showValueAsSelect";Rd.Iqe="showValueAsBaseFieldSelect";Rd.Jqe="showValueAsBaseItemSelect";Rd.rye="valueFieldsSettingsFieldName";Object(M.a)(Rd,
"CssElementIds",null,[]);var Fe=a(146),Ae=a(1073);class We{constructor(S,Wa,zb){this.baseItemIndex=this.baseFieldIndex=this.dataFormat=0;this.dataFormat=S;this.baseFieldIndex=Wa;this.baseItemIndex=zb}}Object(M.a)(We,"MacroRecorderPivotFieldShowValueAsParameters",null,[]);class ve{constructor(S,Wa,zb,hc,cd){this.externalSourceIndex=0;this.pivotFieldTitle=this.activeCell=null;this.summarizeBy=0;this.showAsValueParameters=null;this.externalSourceIndex=S;this.activeCell=Wa;this.pivotFieldTitle=zb;this.summarizeBy=
hc;this.showAsValueParameters=cd}getActiveCell(){return this.activeCell}}Object(M.a)(ve,"MacroRecorderPivotValueFieldSettingAppliedPayload",null,[65]);var Ze=a(263);class Oe{}Object(M.a)(Oe,"PivotValueFieldShowValueAsApplyData",null,[]);var Nf=a(933);const Zf=`<div id='showValueAsControlBody'><label for='${Rd.Kqe}' class='${Fe.e} valueFielsSettingsControlTitle'>{0}</label><div><select size=1 id='${Rd.Kqe}' class='${Fe.c}'></select></div><div class='showValueAsControlSelectRegion'><label for='${Rd.Iqe}'>{1}</label><div><select size=6 id='${Rd.Iqe}' class='${Fe.c}'></select></div></div><div class='showValueAsControlSelectRegionSeparator'></div><div class='showValueAsControlSelectRegion'><label for='${Rd.Jqe}'>{2}</label><div><select size=6 id='${Rd.Jqe}' class='${Fe.c}'></select></div></div></div>`;
class Rb extends Ze.a{constructor(S,Wa,zb,hc,cd,ta,wb,ic,Oa){super(S);this.ji=this.EGe=this.pEe=this.oEe=this.Amc=this.Qrc=this.DM=null;this.Mfg=()=>{var Cb=parseInt(this.Rla.Kl.value,10);this.UPh(Cb)?(this.i_.Qr.disabled=!0,this.j_.Qr.disabled=!0,this.j_.clear(),Rb.WTf(Cb)?(this.i_.Qr.disabled=!1,this.p9b(!1)):Rb.XTf(Cb)?(this.i_.Qr.disabled=!1,this.j_.Qr.disabled=!1,this.p9b(!0),this.b4f()):this.p9b(!1)):(Cb=Za.a.Yi(1,0,0,1131,0,7896227,"FormatRequiresBaseFieldsOrBaseItems"),cc.a(this.$).CD([Cb]),
this.Rla.AFg())};this.BKj=()=>{0>this.i_.selectedIndex||this.j_.Qr.disabled||(this.p9b(!0),this.b4f())};this.xRj=Cb=>{this.DM.A7a();this.j_.Qr.style.overflowY="scroll";if(Cb&&!ab.a(Cb)){Cb=Cb.Result;this.j_.clear();for(const yc of Cb.BaseItems)this.j_.Rda(yc.DisplayString,yc.Id.toString(),yc.Id===Cb.SelectedBaseItem);this.p9b(!1)}};this.get_visible=this.VQb;this.set_visible=this.$5b;this.$=Wa;this.cell=zb;this.dr=hc;this.externalSourceIndex=cd;this.Ah=ta;this.tGa=wb;this.Glj=ic;this.ji=Oa;this.SSb()}VQb(){return this.isVisible}$5b(S){return this.isVisible=
S}get title(){return Ia.a.instance.ia(1119)}get uQb(){const S=this.Rla.Kl?parseInt(this.Rla.Kl.value,10):-1,Wa=this.i_.Kl?parseInt(this.i_.Kl.value,10):-1,zb=this.j_.Kl?parseInt(this.j_.Kl.value,10):-1;return Object(Q.a)(new Oe,{SelectedDataFormat:0<=S?S:-1,SelectedBaseField:Wa,SelectedBaseItem:zb})}get i_(){return this.oEe}get j_(){return this.pEe}get Rla(){return this.EGe}setFocus(){Sa.DOMElementExtensions.setFocus(this.Rla.Qr)}render(S){S.appendChild(this.domElement)}dispose(){Ee.a.Ni([this.Rla,
this.i_,this.j_,this.Qrc,this.Amc]);super.dispose()}fCk(S){Ee.a.Ni([this.Qrc,this.Amc]);this.Rla.clear();for(const Wa of S.DataFormatTypes)this.Rla.Rda(Rb.YGi(Wa),Wa.toString(),Wa===S.SelectedDataFormat);this.Qrc=this.Xk.Ek(this.Rla.domElement);this.Qrc.Aa("change",this.Mfg);this.i_.clear();for(const Wa of S.BaseFieldList)this.i_.Rda(Wa.DisplayString,Wa.Id.toString(),Wa.Id===S.SelectedBaseField);this.Amc=this.Xk.Ek(this.i_.domElement);this.Amc.Aa("change",this.BKj);this.DM=this.tGa.YKb(this.j_.Qr.parentNode,
1E3,null,"",736);this.DM.A7a();this.Mfg(null)}y5(S){this.Rla.y5(S);this.i_.y5(S);this.j_.y5(S)}SSb(){this.ji.hr(this.domElement,String.format(Zf,Ia.a.instance.ia(1120),Ia.a.instance.ia(1121),Ia.a.instance.ia(1122)));this.EGe=new Nf.a(Sa.DOMElementExtensions.getElementById(this.domElement,Rd.Kqe),!1);this.oEe=new Nf.a(Sa.DOMElementExtensions.getElementById(this.domElement,Rd.Iqe),!1);this.pEe=new Nf.a(Sa.DOMElementExtensions.getElementById(this.domElement,Rd.Jqe),!1)}UPh(S){return this.Glj||!Rb.WTf(S)&&
!Rb.XTf(S)?!0:!!this.i_.count}getValueFieldSettingsShowValueAsBaseItemsInfo(){this.$.userOperationManager.enqueueOperation(new Ta.a(108,0,(S,Wa,zb)=>Ae.d(this.$.pa.ta,this.cell,this.externalSourceIndex,parseInt(this.i_.Kl.value,10),lb.c.call(null,S,this.xRj),Wa,zb,null,this.dr),16),this.Ah)}b4f(){this.j_.clear();this.i_.Kl&&(this.DM.v7a(),this.j_.Qr.style.overflowY="hidden",this.getValueFieldSettingsShowValueAsBaseItemsInfo())}p9b(S){const Wa=document.getElementById("WACDialogActionButton");Wa&&(Wa.disabled=
S)}static YGi(S){switch(S){case 0:return Ia.a.instance.ia(1123);case 1:return Ia.a.instance.ia(1124);case 2:return Ia.a.instance.ia(1125);case 3:return Ia.a.instance.ia(1126);case 4:return Ia.a.instance.ia(1127);case 5:return Ia.a.instance.ia(1128);case 6:return Ia.a.instance.ia(1129);case 7:return Ia.a.instance.ia(1130);case 8:return Ia.a.instance.ia(1132);case 9:return Ia.a.instance.ia(1133);case 10:return Ia.a.instance.ia(1134);case 11:return Ia.a.instance.ia(1135);case 12:return Ia.a.instance.ia(1136);
case 13:return Ia.a.instance.ia(1137);case 14:return Ia.a.instance.ia(1138);default:return""}}static WTf(S){return 11===S||12===S||14===S||13===S||4===S}static XTf(S){return 1===S||3===S||2===S}}Object(M.a)(Rb,"ShowValueAsControl",Ze.a,[761,2]);class Vb{}Object(M.a)(Vb,"PivotValueFieldSummarizeValueByApplyData",null,[]);const Cc="<div id='summarizeValuesByControlBody'>"+`<label class='${Fe.e} valueFielsSettingsControlTitle' for='${"pivotDataFieldSelect"}'>{0}</label>`+`<div id='${"pivotDataFieldSelectDescription"}' class='${Fe.e} summarizeValuesByControlDescription'>{1}</div>`+
`<div><select class='${Fe.c}' size=6 id='${"pivotDataFieldSelect"}' style='width: 100%' ${ea.a.zT}='${"pivotDataFieldSelectDescription"}'></select></div>`+"</div>";class rg extends Ze.a{constructor(S,Wa){super(S);this.ji=this.FRe=null;this.get_visible=this.VQb;this.set_visible=this.$5b;this.ji=Wa;this.SSb()}get uQb(){const S=this.Ss.Kl?parseInt(this.Ss.Kl.value,10):-1;return Object(Q.a)(new Vb,{Aggregation:0<=S?S:-1})}VQb(){return this.isVisible}$5b(S){return this.isVisible=S}get title(){return Ia.a.instance.ia(1118)}get enabled(){return!this.Ss.Qr.disabled}set enabled(S){this.Ss.Qr.disabled=
!S}get Ss(){return this.FRe}setFocus(){Sa.DOMElementExtensions.setFocus(this.Ss.Qr)}render(S){S.appendChild(this.domElement)}dispose(){Ee.a.Ng(this.Ss);super.dispose()}focus(){Sa.DOMElementExtensions.setFocus(this.Ss.Qr)}eCk(S){this.Ss.IYc();for(const Wa of S.AggregationTypes){const zb=Wa===S.SelectedAggregation;this.Ss.Bjc(rg.fCi(Wa),Wa.toString(),zb,"")}this.Ss.nuc();this.Ss.Qr.disabled=S.AggregationsDisabled}fqk(){this.Ss.zFg()}SSb(){this.ji.hr(this.domElement,String.format(Cc,Ia.a.instance.ia(1103),
Ia.a.instance.ia(1104)));this.FRe=new Nf.a(Sa.DOMElementExtensions.getElementById(this.domElement,rg.Brg),!1)}static fCi(S){switch(S){case 0:return Ia.a.instance.ia(1106);case 1:return Ia.a.instance.ia(1107);case 2:return Ia.a.instance.ia(1108);case 3:return Ia.a.instance.ia(1109);case 12:return Ia.a.instance.ia(2426);case 4:return Ia.a.instance.ia(1110);case 5:return Ia.a.instance.ia(1111);case 6:return Ia.a.instance.ia(1112);case 7:return Ia.a.instance.ia(1113);case 8:return Ia.a.instance.ia(1114);
case 9:return Ia.a.instance.ia(1115);case 10:return Ia.a.instance.ia(1116);case 11:return Ia.a.instance.ia(1117);default:return""}}}rg.Brg="pivotDataFieldSelect";Object(M.a)(rg,"SummarizeValuesByControl",Ze.a,[761,2]);var yf=a(243),jg=a(542);class If{LTk(S,Wa){S.set_visible(!1);Wa.set_visible(!0)}}Object(M.a)(If,"DefaultTabSwitchBehaviour",null,[777]);class cf{}cf.tUk="TabsContainer";cf.dUk="TabTitlesContainer";cf.bUk="TabTitle";cf.cUk="TabTitleText";cf.ete="TabTitleActive";Object(M.a)(cf,"MultitabControlStyles",
null,[]);var Nb=a(52),Bc=a(100),Ob=a(475),zc=a(67);class od{constructor(S,Wa,zb){this.Nqb=hc=>{hc.keyCode!==Bc.a.fu&&hc.keyCode!==Bc.a.aCa||this.P6c(hc)};this.Bs=S;this.Ux=Wa;this.P6c=zb;this.Tra=document.createElement("a");zc.a.dWc(this.Tra,this.Ux);Sys.UI.DomElement.addCssClass(this.Tra,cf.cUk);Sys.UI.DomElement.addCssClass(this.Bs,cf.bUk);this.Bs.appendChild(this.Tra);this.Tra.tabIndex=0;this.Q0c();Nb.a.addHandler(this.Bs,"click",this.P6c);Nb.a.addHandler(this.Bs,"keyup",this.Nqb)}get Pi(){return this.Bs}get title(){return this.Ux}get isActive(){return Sys.UI.DomElement.containsCssClass(this.Bs,
cf.ete)}set isActive(S){this.setActive(S)}dispose(){Nb.a.removeHandler(this.Bs,"keyup",this.Nqb);Nb.a.removeHandler(this.Bs,"click",this.P6c);this.Bs=this.Tra=null}setActive(S){S?Sys.UI.DomElement.addCssClass(this.Bs,cf.ete):Sys.UI.DomElement.removeCssClass(this.Bs,cf.ete);this.Tra&&this.Tra.setAttribute(Ob.a.Qka,S)}Q0c(){this.Bs.setAttribute(Ob.a.Oj,Ob.a.Yy);this.Tra.setAttribute(Ob.a.RC,this.Ux);this.Tra.setAttribute(Ob.a.Oj,Ob.a.mHb)}}Object(M.a)(od,"TabTitleControl",null,[2]);var ce=a(60);class Qb{constructor(S,
Wa,zb){zb=void 0===zb?null:zb;this.DEb=this.LEb=null;this.Jca=-1;this.Bs=S;this.Psa=(void 0===Wa?null:Wa)||new rc.a;this.bqh=zb||new If;this.rTa=new rc.a;S=0;for(const hc of this.Psa)this.dYd(this.Jca)||(this.Jca=S),Wa=S++,this.rTa.add(new od(document.createElement("li"),hc.title,this.c2h(Wa)))}get JZc(){return this.Psa.count}get activeTab(){return this.Jca}set activeTab(S){this.yWg(S)}get Pi(){return this.Bs}get visible(){return ce.a.isVisible(this.Bs)}set visible(S){this.Bs.style.visibility=S?"visible":
"hidden"}Mlk(){this.LEb=document.createElement("ul");this.LEb.className=cf.dUk;this.DEb=document.createElement("div");this.DEb.className=cf.tUk;for(let S=0;S<this.JZc;++S){const Wa=this.Psa.ma(S),zb=this.rTa.ma(S);Wa.set_visible(!1);zb.isActive=!1;const hc=document.createElement("div");Wa.render(hc);this.DEb.appendChild(hc);this.LEb.appendChild(zb.Pi)}this.Pi.appendChild(this.LEb);this.Pi.appendChild(this.DEb);this.dYd(this.Jca)&&(this.rTa.ma(this.Jca).isActive=!0,this.Psa.ma(this.Jca).set_visible(!0))}dispose(){for(let S=
0;S<this.JZc;++S)this.Psa.ma(S).dispose(),this.rTa.ma(S).dispose();this.rTa=this.Psa=this.Bs=this.DEb=this.LEb=null}setFocus(){this.Psa.ma(this.Jca).setFocus()}dYd(S){return 0<=S&&S<this.JZc}yWg(S){this.Jca!==S&&this.dYd(S)&&(this.bqh.LTk(this.Psa.ma(this.Jca),this.Psa.ma(S)),this.rTa.ma(this.Jca).isActive=!1,this.rTa.ma(S).isActive=!0,this.Jca=S,this.setFocus())}c2h(S){return()=>{this.yWg(S)}}}Object(M.a)(Qb,"MultitabControl",null,[760,2]);class Xc extends fd.a{constructor(S,Wa,zb,hc,cd,ta,wb,ic,
Oa,Cb){super(cd,Ia.a.instance.$g(61),!0,2,!0);this.EQg=!0;this.ji=this.Bid=this.nyd=this.wLb=this.WDa=this.a7a=this.wXe=null;this.lKj=yc=>{oe.a.any(yc.Errors,Nc=>-103190598===Nc.MessageId)&&this.H7a.fqk()};this.wRj=yc=>{yc&&!ab.a(yc)&&(yc=yc.Result,this.ji.wLg(this.nyd,Ia.a.instance.ia(1101)+Kd.a.Xq(yc.ValueFieldSourceName)),this.isOlap&&!this.S5?(this.H7a.enabled=!1,this.WDa.activeTab=this.WDa.JZc-1):(this.H7a.enabled=!0,this.WDa.activeTab=0),this.H7a.eCk(yc.PivotValueFieldSettingsSummarizeValueByInfo),
this.a7a.fCk(yc.PivotValueFieldShowValueAsInitialInfo),this.us())};this.cell=S;this.dr=Wa;this.externalSourceIndex=zb;this.m5g=hc;this.Ah=ta;this.tGa=wb;this.isOlap=ic;this.S5=Oa;this.ji=Cb}get ki(){return"ValueFieldSettingsDialog"}get fQa(){return this.wXe}get H7a(){return this.Bid}get oJ(){return 560}dispose(){this.nyd=this.wLb=this.a7a=this.Bid=null;Ee.a.Ng(this.WDa);this.WDa=null;super.dispose()}initialize(){let S="<div id='"+Rd.Mjf+"' class='"+Fe.e+"'></div><div id='"+Rd.$7h+"' class='"+Fe.e+
"'><label for='"+Rd.rye+"'>{0}</label><input type='text' id='"+Rd.rye+"' value='{1}' class='"+Fe.c+" UIFont' /></div><div id='"+Rd.n5g+"'></div>";S=String.format(S,Ia.a.instance.ia(1102),Kd.a.Xq(this.m5g));this.ji.hr(this.dj,S);this.Vo||(this.ZTa(),this.DI());this.wXe=[-103190598];this.fYi();super.initialize()}close(S){1===S&&(this.EQg=!1);super.close(S)}Ylf(S){this.isDisabled=S;this.domElement.disabled=S;const Wa=["input","option","select"];for(let zb=0,hc=Wa.length;zb<hc;++zb){const cd=this.domElement.getElementsByTagName(Wa[zb]);
for(let ta=0;ta<cd.length;++ta)cd[ta].disabled=S}}DI(){this.wLb=document.getElementById(Rd.rye);this.nyd=Sa.DOMElementExtensions.getElementById(this.dj,Rd.Mjf);const S=Sa.DOMElementExtensions.getElementById(this.dj,Rd.n5g);this.Bid=new rg(document.createElement("div"),this.ji);this.a7a=new Rb(document.createElement("div"),this.$,this.cell,this.dr,this.externalSourceIndex,this.Ah,this.tGa,!this.isOlap,this.ji);this.WDa=new Qb(S,new rc.a([this.H7a,this.a7a]));this.WDa.Mlk()}zae(){const S=new Xc(this.cell,
this.dr,this.externalSourceIndex,this.m5g,this.$,this.Ah,this.tGa,this.isOlap,this.S5,this.ji);S.initialize();S.us()}q2c(){const S=new jg.a;if(!this.EQg)return S.isValid=!0,S;this.wLb.value.length?S.isValid=!0:(this.Ylf(!0),S.error=Za.a.Yi(1,0,751,766,0,1783218700,"PivotTableValueFieldNoBlank"),this.isDisabled=!0,this.Vo||(this.oI.disabled=!0),S.isValid=!1);return S}XLf(){this.isDisabled=!1;this.Vo||(this.oI.disabled=!1);this.Ylf(!1)}Lfg(S){const Wa=new Ha.a(2105621672,0,this.$.Rh,30,null);this.$.Ma.dh(Wa);
this.XY(5,S.oh,"Number Format");return!0}CE(){this.wPa=String.format(Ia.a.instance.$g(61),null);super.CE()}setFocus(){if(this.Vo){const S=Sa.DOMElementExtensions.getElementById(this.dj,rg.Brg);yf.a.P_g(S)}else this.WDa.setFocus()}nt(){const S=this.a7a.uQb,Wa=new We(S.SelectedDataFormat,S.SelectedBaseField,S.SelectedBaseItem);return()=>new ve(this.externalSourceIndex,this.cell,this.wLb.value,this.H7a.uQb.Aggregation,Wa)}UN(){const S=Object(Q.a)(new Ed,{PivotValueFieldSummarizeValueByApplyData:this.H7a.uQb,
PivotValueFieldShowValueAsApplyData:this.a7a.uQb,PivotValueFieldTitle:this.wLb.value});return(Wa,zb,hc)=>Ae.b(this.$.pa.ta,this.cell,this.externalSourceIndex,S,lb.c(Wa,this.lKj),zb,hc,null,this.dr)}y5(S){this.$.ka.Lh(40,()=>{this.a7a.y5(S)})}fYi(){this.$.userOperationManager.enqueueOperation(new Ta.a(123,0,(S,Wa,zb)=>Ae.c(this.$.pa.ta,this.cell,this.externalSourceIndex,lb.c.call(null,S,this.wRj),Wa,zb,null,this.dr),16),this.Ah)}}Object(M.a)(Xc,"ValueFieldSettingsDialog",fd.a,[]);const md=ea.a.RYh;
let ie=class extends Y.a{constructor(S,Wa,zb,hc,cd){super(S,"PopulateFieldWellContextMenu",1374696078,495005930,md,!0,!1,md,cd,Wa,!1,zb,hc);this.dr=this.uv=this.cell=null;this.Mze=this.externalSourceIndex=-1;this.q7a=0;this.vYc=-1;this.eW=null;this.lib=this.S5=this.isOlap=!1}get vD(){return"PopulateFieldWellContextMenu"}get DH(){return ea.a.pde}executeCommand(S,Wa,zb,hc){S=Wa.command;switch(S){case -1453503574:hc=zb.domElement;this.uv=zb.fieldItem;this.Mze=zb.zoneCount;this.q7a=zb.sourceAxis;this.vYc=
zb.sourceAxisPos;this.dr=zb.optionalPivotMenuAnchorParameter;this.eW=zb.versionkey;this.isOlap=zb.isOlap;this.S5=zb.isPpm;this.lib="fieldItemsupportsImplicitMeasures"in zb?zb.fieldItemsupportsImplicitMeasures:!1;this.cell=zb.cell;this.externalSourceIndex=zb.externalSourceIndex;ha.f(this.$).Cz(!0);hc=Sa.DOMElementExtensions.getBounds(hc);S=new Sys.UI.Point(hc.x,hc.y+hc.height);this.$.isChromeRtl&&(S.x+=hc.width);"isKeyboardInput"in zb&&zb.isKeyboardInput?this.Ft(S,!1,1):this.Ft(S,!1);break;case 495005930:break;
case -1170196828:nd.a(this.$).dU(this.uv,this.q7a,this.vYc-1,this.eW,Wa);break;case -889576107:nd.a(this.$).dU(this.uv,this.q7a,this.vYc+2,this.eW,Wa);break;case 2033235475:nd.a(this.$).dU(this.uv,this.q7a,this.Mze,this.eW,Wa);break;case 389774337:nd.a(this.$).dU(this.uv,this.q7a,0,this.eW,Wa);break;case -96230454:nd.a(this.$).dU(this.uv,4,-1,this.eW,Wa);break;case 74086617:nd.a(this.$).dU(this.uv,1,-1,this.eW,Wa);break;case 1529312473:nd.a(this.$).dU(this.uv,2,-1,this.eW,Wa);break;case 563292088:this.lib&&
R.ULS.sendTraceTag(537167056,0,50,"Move a field into values area as implicit measurement.");nd.a(this.$).dU(this.uv,8,-1,this.eW,Wa);break;case -1092351914:nd.a(this.$).dU(this.uv,0,-1,this.eW,Wa);break;case -2141589616:const cd=Object(ma.d)($b.a.resolve(Ib.Cf,{va:hc.Ufa()})),ta=Object(ma.d)($b.a.resolve(Ib.kd,{va:hc.Ufa()}));return ra.TaskExtensions.Ua(ra.TaskExtensions.Ln([cd,ta],this.$.xa),()=>{(new Xc(this.cell,this.dr,this.externalSourceIndex,this.uv.Name,this.$,Wa,cd.result,this.isOlap,this.S5,
ta.result)).initialize()},this.xa);default:return mb.a(S)}return Jc.Task.Va(!0)}ni(S,Wa,zb){S=!1;switch(Wa.command){case -1453503574:S=!!zb;break;case 495005930:case -1170196828:case -889576107:case 2033235475:case 389774337:case -96230454:case 74086617:case 1529312473:case 563292088:case -1092351914:case -2141589616:S=!0}return S}y_(){const S=this.Ya.Vv(this.menuId);this.H4j(S,this.vYc,this.Mze);this.I4j(S,this.q7a);this.J4j(S);8===this.q7a&&this.F4j(S);return S}H4j(S,Wa,zb){const hc=this.Ya,cd=
hc.Oh();Wa||Wa!==zb-1?!Wa&&Wa<zb-1?(cd.buttons.push(hc.Sg(64)),cd.buttons.push(hc.Sg(61)),cd.buttons.push(hc.Sg(66)),cd.buttons.push(hc.Sg(63))):0<Wa&&Wa<zb-1?(cd.buttons.push(hc.Sg(60)),cd.buttons.push(hc.Sg(61)),cd.buttons.push(hc.Sg(62)),cd.buttons.push(hc.Sg(63))):0<Wa&&Wa===zb-1&&(cd.buttons.push(hc.Sg(60)),cd.buttons.push(hc.Sg(65)),cd.buttons.push(hc.Sg(62)),cd.buttons.push(hc.Sg(67))):(cd.buttons.push(hc.Sg(64)),cd.buttons.push(hc.Sg(65)),cd.buttons.push(hc.Sg(66)),cd.buttons.push(hc.Sg(67)));
S.vh.push(cd)}I4j(S,Wa){const zb=this.Ya,hc=zb.Oh(),cd=1!==Wa&&(!this.isOlap||this.S5||8!==Wa||this.lib),ta=2!==Wa&&(!this.isOlap||this.S5||8!==Wa||this.lib),wb=8!==Wa&&-2!==this.uv.PivotTableIndex&&(!this.isOlap||this.S5||this.lib);hc.buttons.push(zb.Sg(4===Wa||this.uv.IsSet||-2===this.uv.PivotTableIndex||this.isOlap&&!this.S5&&8===Wa&&!this.lib?72:68));8===this.dr.AnchorType||10===this.dr.AnchorType?(hc.buttons.push(zb.Sg(cd?95:97)),hc.buttons.push(zb.Sg(ta?96:98))):(hc.buttons.push(zb.Sg(cd?69:
73)),hc.buttons.push(zb.Sg(ta?70:74)));hc.buttons.push(zb.Sg(wb?71:75));S.vh.push(hc)}J4j(S){const Wa=this.Ya.Oh();Wa.buttons.push(this.Ya.Sg(76));S.vh.push(Wa)}F4j(S){const Wa=this.Ya.Oh();Wa.buttons.push(this.Ya.Sg(77));S.vh.push(Wa)}};ie=Object(N.__decorate)([Object($b.d)(Ib.cc),Object(N.__param)(0,Object(Ib.Lb)()),Object(N.__param)(1,Object(Ib["if"])()),Object(N.__param)(2,Object(Ib.cb)()),Object(N.__param)(3,Object(Ib.Lg)())],ie);Object(M.a)(ie,"FieldWellContextMenu",Y.a,[]);var me=a(1207),Pe=
a(1149),gf;let tf=gf=class extends jd{constructor(S,Wa,zb,hc,cd,ta){super(S,"PopulatePivotContextMenu",2123758504,912277356,ta,Wa,zb,hc,cd)}get vD(){return"PopulatePivotContextMenu"}get DH(){return ea.a.pxg}executeCommand(S,Wa,zb){let hc=!1;const cd=Wa.command;switch(cd){case 37023044:hc=this.ADd(zb,Wa);db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackAsyncPivotFilterContextMenu",!1)&&xd.b(this.$).ix(zb.rawEvent,"context_menu_pivot_filter",null,["context-menu"]);break;case 541421805:case -569786022:hc=
this.lOd(S,Wa)}return hc?Jc.Task.Va(!0):mb.a(cd)}ni(S,Wa,zb){S=!1;switch(Wa.command){case 37023044:S=!!zb;break;case 541421805:case -569786022:S=!0}return S}lOd(S,Wa){var zb=8===S,hc=this.$,cd=$d.a(hc),ta=ha.f(hc).ha.$e.yh;let wb=S=null;zb&&cd?(S=cd.chartId,wb=cd.Ki):!zb&&ta&&(S=ta.floatingObject.id,wb=ta.floatingObject.Ki);return gf.f5e(wb,260)?(zb={},hc.Mq(zb),zb.FirstColumn=zb.FirstRow=-1,hc={["rawEvent"]:null,["pivotName"]:null,["cell"]:zb,["requiresConfirmation"]:gf.f5e(wb,64),["dataSourceIndex"]:wb.ExternalSourceIndex},
ta?(cd=ta.floatingObject,hc.domElement=ta.domElement,hc.objectId=cd.id,hc.objectVersion=cd.version):cd&&(hc.domElement=cd.bA,hc.objectId=cd.chartId,hc.objectVersion=cd.Maf),ta={AnchorType:7},ta.ChartId=S,ta.AnchorValue1=-1,ta.AnchorValue2=-1,hc.optionalPivotMenuAnchorParameter=ta,this.ADd(hc,Wa)):!1}static f5e(S,Wa){return(S.Attributes&Wa)===Wa}};tf=gf=Object(N.__decorate)([Object($b.d)(Ib.xe),Object(N.__param)(0,Object(Ib.Lb)()),Object(N.__param)(1,Object(Ib["if"])()),Object(N.__param)(2,Object(Ib.cb)()),
Object(N.__param)(3,Object(Ib.Lg)()),Object(N.__param)(4,Object(Ib.we)())],tf);Object(M.a)(tf,"PivotFilterContextMenu",jd,[]);class Qe{}Qe.applyItemFilter="ApplyItemFilter";Qe.qBc="HandleShowPivotPageFilterMenu";Qe.clearFilter="ClearFilter";Qe.qde="ReactFilterMenuOpen";Qe.sqa="SortFilterScriptLoad";Qe.FYg="ToggleFilter";Qe.getPivotFilterData="GetPivotFilterData";Qe.searchPivotFilter="SearchPivotFilter";Qe.nqb="OnGetFilterByValueItems";Object(M.a)(Qe,"PivotFilterMenuOperations",null,[]);var Ca;const yb=
ea.a.VYh;let wc=Ca=class extends Y.a{constructor(S,Wa,zb,hc,cd){super(S,"PopulatePivotPageFilterContextMenu",null,null,yb,!0,!1,"PivotPageFilterContextMenuRoot",cd,Wa,!1,zb,hc);this.tZ=this.IWa=null;this.rXb=!1;this.N7h=this.W3a=this.ujf=this.OMa=this.fAc=this.RNb=this.hV=null;this.Xma=0;this.Mw=db.EwaSettings.Bn("PivotPageFilterContextMenu");this.Yda=0;this.cell=this.dr=null;this.dataSourceIndex=0;this.lh=this.fieldId=null;this.SI=()=>{this.ewc();this.$.ea.dv(this.SI)};this.Pq=()=>{this.ewc();this.$.ea.qB(this.Pq)};
this.nqb=ta=>{var wb=!!ta.searchText,ic=this.$.pa.ta.Jh();wb?(wb=168,ta=this.xrd(null,ta.searchText)):(wb=167,ta=this.QLh(Ca.Npb));this.ujf=ic.RequestId;this.fAc&&!this.fAc.dequeueUtcTime&&(this.$.userOperationManager.cva(this.fAc),this.rQh());ic=new Ta.a(wb,0,ta,80);this.fAc=this.$.userOperationManager.enqueueOperation(ic,null);this.W3a=this.N7h;this.OMa=this.ujf};this.onMenuItemClick=(ta,wb,ic)=>{ua.b(this.$).lj(ba.a.dVj,Zb.g(),void 0,!0);wb={["CommandValueId"]:wb,["MenuItemId"]:wb,["InputMethod"]:ic,
["TopCellAddress"]:this.tZ};const Oa=new Ha.a(ta,ic,this.$.isEditMode?2:1,19,null);this.$.Ma.dh(Oa,wb);R.ULS.sendTraceTag(507779162,0,50,`PivotPageFilterContextMenu::OnMenuItemClick ${ta}, ${ic}`)};this.focusShiftOnMenuDismiss=()=>{ha.f(this.$).focus()};this.jMc=ta=>{this.Yda=Date.now();if(ta.checkedItems&&ta.checkedItems.length){ua.b(this.$).lj(ba.a.Gdg,Zb.g(),void 0,!0);1===ta.checkedItems.length&&"[AllSearchResultsAndAddCurrentSelection]"===ta.checkedItems[0]&&(ta.checkedItems[0]="[AllSearchResults]",
ta.checkedItems.push("[AddCurrentSelection]"));var wb=b(this.cell,this.fieldId,this.dataSourceIndex,this.dr,this.Xma),ic=Cb=>{var yc={["ToggleFilterOperationCount"]:0,["ApplyFilterTime"]:this.Yda?Date.now()-this.Yda:-1,["ToggleAndApplyFilterTime"]:0};R.ULS.sendTraceTag(507601546,0,50,`PivotPageFilterContextMenu::ApplyFilterByValue Perf Telemetry : ${JSON.stringify(yc)}`);fb.a.NOa(Cb)&&(yc=fb.a.vIa(Cb),this.vK?fb.a.PK(Qe.applyItemFilter,yc.MessageIdName,ib.a.a3j,!0,fb.a.$xa(yc.MessageId)):R.ULS.sendTraceTag(507601545,
0,10,`PivotPageFilterContextMenu::OnApplyFilterByValue failed with Exception -${yc.MessageIdName}`));ab.a(Cb)||(R.ULS.sendTraceTag(507601544,0,50,"PivotPageFilterContextMenu::OnApplyFilterByValue service call succeeded"),ua.b(this.$).lj(ba.a.k7d,Zb.g(),void 0,!0),this.RNb.onApplyFilterByValueFinish({isSuccess:!0}),Zb.k(this.$,this.tZ))},Oa=new Ta.a(208,0,(Cb,yc,Nc)=>Ea.a(this.$.pa.ta,wb,ta.checkedItems,lb.c(Cb,ic),yc,Nc,null,null),134,()=>new V.a(ta.checkedItems,wb));(()=>{this.$.userOperationManager.enqueueOperation(Oa,
null)})()}else R.ULS.sendTraceTag(507779161,0,15,"PivotPageFilterContextMenu::OnApplyFilterByValue Received Zero checked items to apply filter on")};this.zoom=hc;this.vK=fb.a.qTb()}get vD(){return"PopulatePivotPageFilterContextMenu"}get DH(){return ea.a.Xak}executeCommand(S,Wa,zb){S=Wa.command;switch(S){case 1701016594:return Y.a.Wuf(zb),Jc.Task.Va(!0);case -32628781:const hc=new F.a,cd=Ib.db.Ha()?Object(ma.d)($b.a.resolve(Ib.db,{va:0})):sa.GetServiceTaskFactory.Bj(this.$.ka,8,9,0);ra.TaskExtensions.Ua(I.a.XP(cd),
()=>{this.qBc(Wa,zb,cd.result);hc.setResult(!0)},this.xa,3).continueWith(()=>{hc.setResult(!1)},5,this.xa,Kb.a.instance);return hc.task;default:return mb.a(S)}}qBc(S,Wa){S=fa.a.Gp(Wa[xa.a.Wk]);this.cell=S.cell;this.dataSourceIndex=S.dataSourceIndex;this.fieldId=S.fieldId;this.dr=S.optionalPivotAnchorParameter;S=0;let zb=null,hc=-1,cd=-1;this.dr&&(S=this.dr.AnchorType,zb=this.dr.ChartId,hc=this.dr.AnchorValue1,cd=this.dr.AnchorValue2);const ta={};ta.AnchorType=S;ta.ChartId=zb;ta.AnchorValue1=hc;ta.AnchorValue2=
cd;this.dr=ta;const wb=Wa.domEvent;ka.g(wb);wb.target?(Wa=new bb.a(this.$.sa),this.$.Mq(this.cell),this.tZ=la.F(this.cell),Wa.Hj(8192)?this.rXb?this.YCg(wb.target):(this.hV=()=>{this.YQd();this.YCg(wb.target);this.rXb=!0},this.ewc()):this.vK?fb.a.PK(Qe.qBc,La.a.x8j,ib.a.SMa,!1,!0):R.ULS.sendTraceTag(507605397,0,10,"PivotPageFilterContextMenu.handleShowPivotPageFilterMenu:protected sheet, cannot be modified")):this.vK?fb.a.PK(Qe.qBc,La.a.Pdi,ib.a.SMa,!1,!0):R.ULS.sendTraceTag(507605398,0,10,"PivotPageFilterContextMenu.handleShowPivotPageFilterMenu:domEvent.target is undefined.")}ni(S,
Wa,zb){switch(Wa.command){case 1701016594:case -32628781:return!!zb;default:return!1}}WPc(S){S.MenuSectionList.push(...this.IWa)}YQd(){this.RNb=sortFilter.PivotPageFilterControllerFactoryGlobal.createPivotPageFilterController({getFilterByValueItemsRequest:this.nqb,applyFilterByValueRequest:this.jMc,onMenuItemClick:this.onMenuItemClick,focusShiftOnMenuDismiss:this.focusShiftOnMenuDismiss,filterMenuWidth:Ca.xwf})}ewc(){if(this.$.ea.An)if(db.EwaSettings.isChangeGateEnabled("OfficeVSO:8428325_ExtractChunkLoading"))Object(Eb.a)("sortFilter",
{va:1}).then(()=>{this.hV()},S=>{this.vK&&(pa.a.Jn(S,"PivotPageFilterContextMenu.filterScriptLoad"),fb.a.PK(Qe.sqa,La.a.sYc,ib.a.SMa,!1,!1))});else{const S=Wa=>{this.vK?Wa.Vt().loadScript("sortFilter").then(()=>{this.hV()},zb=>{pa.a.Jn(zb,"PivotPageFilterContextMenu.filterScriptLoad");fb.a.PK(Qe.sqa,La.a.sYc,ib.a.SMa,!1,!1)}):db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",!1)?void Wa.Vt().loadScript("sortFilter").then(()=>this.hV()):ra.TaskExtensions.Ua(ma.d(Wa.Vt().loadScript("sortFilter")),
()=>{this.hV()},this.$.xa,3)};if(db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",!1))void $b.a.resolve(Ib.Fb,{va:1}).then(Wa=>S(Wa));else{const Wa=ma.d($b.a.resolve(Ib.Fb,{va:1}));ra.TaskExtensions.Ua(Wa,()=>S(Wa.result),this.$.xa,3)}}else this.Mw?this.$.ea.Bw(this.Pq):this.$.ea.Jq(this.ewc)}YCg(S){Sys.UI.DomElement.getBounds(S);var Wa;this.cell||(this.vK?fb.a.PK(Qe.qde,La.a.fRh,ib.a.SMa,!0,!1):R.ULS.sendTraceTag(507779165,0,10,"PivotPageFilterContextMenu.renderReactMenu:Cell is undefined."));
S=Y.a.Qxc(this.$,this.cell);Y.a.vEc(S)||(this.vK?fb.a.PK(Qe.qde,La.a.MYh,ib.a.SMa,!0,!1):R.ULS.sendTraceTag(507601547,0,10,"PivotPageFilterContextMenu.renderReactMenu:context menu cell not in view."));(Wa=Y.a.myc(this.$,S,!0))?(S=Wa.x,Wa=Wa.y,S=ha.f(this.$).rtl?new Sys.UI.Point(S-this.zoomManager.nFa(Ca.xwf),Wa):new Sys.UI.Point(S,Wa),S=this.zoomManager.Rfa(S),this.RNb.showPivotPageFilterMenu({targetPoint:{left:S.x,top:S.y}})):this.vK?fb.a.PK(Qe.qde,La.a.qsi,ib.a.SMa,!0,!1):R.ULS.sendTraceTag(507779164,
0,10,"PivotPageFilterContextMenu.renderReactMenu:\u00a0failed to get the context menu coordinates.")}rQh(){this.OMa&&(R.ULS.sendTraceTag(507779163,0,15,`PivotPageFilterContextMenu.cancelSearchFilterItemListWebRequest Cancelling pending web request with ID=${this.OMa}`),Ea.i(this.$.pa.ta,this.OMa,null,null,null),this.OMa=null);this.W3a&&(K.AFrameworkApplication.$i.HD(this.W3a.TC),this.W3a=null)}i_b(){return S=>{this.W3a=this.OMa=null;if(fb.a.NOa(S)){var Wa=fb.a.vIa(S);this.vK?fb.a.PK(Qe.getPivotFilterData,
Wa.MessageIdName,ib.a.HDf,!0,!0):R.ULS.sendTraceTag(507601543,0,10,`PivotPageFilterContextMenu::OnGetFilterByValueItemsSuccessCallback failed with Exception -${Wa.MessageIdName}`)}ab.a(S)||(R.ULS.sendTraceTag(507779160,0,50,"PivotPageFilterContextMenu::OnGetFilterByValueItems service call succeeded"),S=S.Result,Wa=new wa.a(!0),S.PivotFilterItemsList&&S.PivotFilterItemsList.PivotFilterItems&&Wa.add("FilterItemsCount",S.PivotFilterItemsList.PivotFilterItems.length),Wa.add("Location","contextMenu"),
S={filterByValueItems:this.nKb(S.PivotFilterItemsList),hasMoreRecords:S.PivotFilterItemsList.ItemListMaxExceeded,searchText:null},this.RNb.onGetFilterByValueItemsFinish(S))}}ZMc(){return S=>{this.W3a=this.OMa=null;S=Da.a.Qj(S.data);S=Za.a.Kh(S);this.vK?fb.a.PK(Qe.nqb,La.a.wJi,ib.a.HDf,!1,!0):R.ULS.sendTraceTag(507779159,0,10,`PivotPageFilterContextMenu.OnGetFilterByValueItemsFailureCallback Errors: [${S}].`)}}nKb(S){var Wa=S.PivotFilterItems,zb=[];if(Wa){var hc=0;for(var cd of Wa){Wa=hc++;var ta=
cd.DisplayString;let wb=P.NotSelected;switch(cd.State){case 0:wb=P.Selected;break;case 1:wb=P.NotSelected;break;case 2:wb=P.PartiallySelected}zb[Wa]=c(ta,wb,hc.toString())}}hc=zb;zb=[];cd=[];ta=Wa=0;S.HasBlanks&&(S=c(Ia.a.instance.ia(782),S.IsBlanksSelected?P.Selected:P.NotSelected,ea.a.Xpd),zb[Wa++]=S);for(const wb of hc)-1!==Array.indexOf(pc.a.Fuc,wb.displayText)?cd[ta++]=wb:zb[Wa++]=wb;return Array.prototype.concat(cd,zb)}QLh(S){return(Wa,zb,hc)=>{const cd=Ea.M(this.$.pa.ta,this.cell,this.dataSourceIndex,
this.dr);cd.fieldId=this.fieldId;cd.parentId=S;cd.needConnect=!1;return Ea.h(this.$.pa.ta,"GetPivotFilterData",cd,lb.c(Wa,this.i_b()),lb.b(zb,this.ZMc()),hc,null,4)}}xrd(S,Wa){return(zb,hc,cd)=>{const ta=Ea.M(this.$.pa.ta,this.cell,this.dataSourceIndex,this.dr);ta.fieldId=this.fieldId;ta.parentId=Ca.Npb;ta.searchText=Wa;ta.hierarchyLevel=this.Xma;return Ea.h(this.$.pa.ta,"SearchPivotFilter",ta,lb.c(zb,this.F8d(Wa)),lb.b(hc,this.ZMc()),cd,S,0)}}F8d(S){return Wa=>{this.W3a=this.OMa=null;if(fb.a.NOa(Wa)){var zb=
fb.a.vIa(Wa);this.vK?fb.a.PK(Qe.searchPivotFilter,zb.MessageIdName,ib.a.SMa,!0,!0):R.ULS.sendTraceTag(507601542,0,10,`PivotPageFilterContextMenu::OnSearchInFilterSuccessCallback failed with Exception -${zb.MessageIdName}`)}ab.a(Wa)||(R.ULS.sendTraceTag(507779158,0,50,"PivotPageFilterContextMenu::onSearchInFilterSuccess service call succeeded"),Wa=Wa.Result,zb=new wa.a(!0),Wa&&Wa.PivotFilterItems&&zb.add("FilterItemsCount",Wa.PivotFilterItems.length),zb.add("Location","contextMenu"),Wa={filterByValueItems:this.nKb(Wa),
hasMoreRecords:Wa.ItemListMaxExceeded,searchText:S},this.RNb.onGetFilterByValueItemsFinish(Wa))}}};wc.Npb=-1;wc.xwf=268;wc=Ca=Object(N.__decorate)([Object($b.d)(Ib.ye),Object(N.__param)(0,Object(Ib.Lb)()),Object(N.__param)(1,Object(Ib["if"])()),Object(N.__param)(2,Object(Ib.cb)()),Object(N.__param)(3,Object(Ib.Lg)())],wc);Object(M.a)(wc,"PivotPageFilterContextMenu",Y.a,[]);var dd=a(1381),vd=a(1209),Zd=a(253),Re=a(419),ff=a(355),af=a(32);const xf=ea.a.WYh,eg=xf+".RemoveField",Ab=xf+".Subtotal",xc=
xf+".ClearFilter",eb=xf+".LayoutSameColumn",Ub=xf+".LayoutNextColumn";let Fc=class extends Y.a{constructor(S,Wa,zb,hc,cd){super(S,"PopulatePivotTableContextMenu",-1475408662,1114549926,xf,!0,!1,"PivotTableContextMenuRootName",cd,Wa,!0,zb,hc);this.nze=this.activeCell=this.Dh=null;this.N4=this.refresh=this.expandCollapse=this.UTd=this.GHc=!1;this.asb=this.lh=this.Ufb=this.UH=this.Pk=null;this.ZUd=!1;this.OQj=ta=>{ta&&!Za.a.Jk(ta.Errors)&&this.Dh&&(this.Dh.tx=ta.Result,this.v5b());this.showPivotTableContextMenu()};
this.NQj=()=>{};this.AUj=()=>{this.Ftb()};this.zUj=()=>{this.Ftb()};this.qKj=()=>{this.Ftb()};this.pKj=()=>{this.Ftb()};this.NM=()=>{this.kwe();this.ZUd=!1};this.pC=()=>{if(this.ZUd){R.ULS.sendTraceTag(537167E3,0,50,"PivotTableContextMenu.OnAfterAllBlocksUpdated: Context menu was closed after changes were made by other users");const ta=this.Dh;this.grid.Yg.Lw(this.grid.ha.qa.activeCell)!==ta&&(this.Ftb(),this.E5i())}};this.Rdi=new DOMParser;this.cHk=!0;this.grid=ha.f(S);this.PKc=!0}get vD(){return"PopulatePivotTableContextMenu"}get DH(){return ea.a.qxg}executeCommand(S,
Wa,zb){Wa=Wa.command;S=null;this.grid=ha.f(this.$);this.activeCell=la.p(this.grid.ha.qa.activeCell,this.$);if(this.$.isEditMode&&(this.Dh=this.grid.Yg.Lw(this.grid.ha.qa.activeCell),!this.Dh))return R.ULS.sendTraceTag(537167007,0,10,"No PivotTable range found."),ra.TaskExtensions.N$();this.nze=this.$.pa.ta;this.Ufb=Object(qb.a)(Md.a,zb.eventArgs);switch(Wa){case 671488277:this.lJk()?this.uQi():(this.Ftb(),this.showPivotTableContextMenu());break;case 1801458190:this.performPivotTableOperation(1801458190,
1);break;case -2016405815:this.performPivotTableOperation(-2016405815,6);break;case 671485366:this.performPivotTableOperation(671485366,7);break;case 772221736:this.performPivotTableOperation(772221736,8);break;case 1600778266:this.performPivotTableOperation(1600778266,2);break;case -556893687:this.performPivotTableOperation(-556893687,3);break;case -1966978671:this.performPivotTableOperation(-1966978671,4);break;case 1885005049:db.EwaSettings.isChangeGateEnabled("OfficeVSO:8346637_PivotTableDeleteInContextMenu")&&
this.performPivotTableOperation(1885005049,19);break;case -1683649734:db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualGroupingInPivotTables",!1)&&this.performPivotTableOperation(-1683649734,20);break;case 660506187:db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualGroupingInPivotTables",!1)&&this.performPivotTableOperation(660506187,21);break;case -1951357930:this.performPivotTableOperation(-1951357930,5);break;case -1390365353:this.performPivotTableOperation(-1390365353,
9);break;case -1457478532:this.performPivotTableOperation(-1457478532,10);break;case -771066011:this.UH.PivotValueFieldSummarizeValueByApplyData.Aggregation=2;this.applyValueFieldSettingsToPivotTable(-771066011,!0);break;case 1746132849:this.UH.PivotValueFieldSummarizeValueByApplyData.Aggregation=1;this.applyValueFieldSettingsToPivotTable(1746132849,!0);break;case 1475494885:this.UH.PivotValueFieldSummarizeValueByApplyData.Aggregation=6;this.applyValueFieldSettingsToPivotTable(1475494885);break;case 376946683:this.UH.PivotValueFieldSummarizeValueByApplyData.Aggregation=
11;this.applyValueFieldSettingsToPivotTable(376946683,!0);break;case 835007294:this.UH.PivotValueFieldSummarizeValueByApplyData.Aggregation=3;this.applyValueFieldSettingsToPivotTable(835007294,!0);break;case -413510754:db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableNewAggregations",!1)&&(this.UH.PivotValueFieldSummarizeValueByApplyData.Aggregation=12,this.applyValueFieldSettingsToPivotTable(-413510754,!0));break;case 929115636:this.UH.PivotValueFieldSummarizeValueByApplyData.Aggregation=
4;this.applyValueFieldSettingsToPivotTable(929115636,!0);break;case 1935475057:this.UH.PivotValueFieldSummarizeValueByApplyData.Aggregation=5;this.applyValueFieldSettingsToPivotTable(1935475057,!0);break;case 588680636:this.UH.PivotValueFieldSummarizeValueByApplyData.Aggregation=7;this.applyValueFieldSettingsToPivotTable(588680636);break;case -910892852:this.UH.PivotValueFieldSummarizeValueByApplyData.Aggregation=8;this.applyValueFieldSettingsToPivotTable(-910892852);break;case -1255320719:this.UH.PivotValueFieldSummarizeValueByApplyData.Aggregation=
0;this.applyValueFieldSettingsToPivotTable(-1255320719,!0);break;case 1668427539:this.UH.PivotValueFieldSummarizeValueByApplyData.Aggregation=9;this.applyValueFieldSettingsToPivotTable(1668427539);break;case -1751371357:this.UH.PivotValueFieldSummarizeValueByApplyData.Aggregation=10;this.applyValueFieldSettingsToPivotTable(-1751371357);break;case -841863025:this.F6a(0,0);this.applyValueFieldSettingsToPivotTable(-841863025);break;case -178796371:this.F6a(7,0);this.applyValueFieldSettingsToPivotTable(-178796371);
break;case 786592977:this.F6a(6,0);this.applyValueFieldSettingsToPivotTable(786592977);break;case 767774849:this.F6a(5,0);this.applyValueFieldSettingsToPivotTable(767774849);break;case 282586693:this.F6a(9,0);this.applyValueFieldSettingsToPivotTable(282586693);break;case -1067664355:this.F6a(10,0);this.applyValueFieldSettingsToPivotTable(-1067664355);break;case -2031744961:zb=Number.parseInvariant(zb.MenuItemId.split(".")[2]);this.F6a(11,zb);this.applyValueFieldSettingsToPivotTable(-2031744961);break;
case -1007663920:this.applyPivotSort(1);break;case 234234584:this.applyPivotSort(2);break;case 1194992911:this.$.ei(-1556797033,xa.a.eh,8,null);break;case 1514686611:db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DisableManualFilterButtonOnRightClickContextMenuForPT",!1)||this.Atj();break;case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:zb=Number.parseInvariant(zb.MenuItemId);this.RTh(zb);break;case 1778578888:zb=Number.parseInvariant(zb.MenuItemId);this.IEh(zb);
break;case 2059542618:this.performPivotTableOperation(2059542618,11);break;case 713270357:this.performPivotTableOperation(713270357,12);break;case -1842411134:this.performPivotTableOperation(-1842411134,13);break;case 2054968064:this.performPivotTableOperation(2054968064,14);break;case 74278997:this.performPivotTableOperation(74278997,15);break;case 8572743:this.performPivotTableOperation(8572743,16);break;case 833996216:this.performPivotTableOperation(833996216,17);break;case 139202061:this.performPivotTableOperation(139202061,
18);break;default:S=mb.a(Wa)}return S||ra.TaskExtensions.N$()}ni(S,Wa){S=!1;switch(Wa.command){case 671488277:S=Hb.k(this.grid);break;case 1801458190:case -2016405815:case 671485366:case 772221736:S=!0;break;case 1600778266:S=!0;break;case -556893687:S=!0;break;case -1966978671:S=!0;break;case 1885005049:S=db.EwaSettings.isChangeGateEnabled("OfficeVSO:8346637_PivotTableDeleteInContextMenu");break;case -1683649734:S=db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualGroupingInPivotTables",
!1);break;case 660506187:S=db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualGroupingInPivotTables",!1);break;case -1951357930:S=!0;break;case -1390365353:case -1457478532:S=!0;break;case -249874296:case -771066011:case 1746132849:case 1475494885:case 376946683:case 835007294:case 929115636:case -413510754:case 1935475057:case 588680636:case -910892852:case -1255320719:case 1668427539:case -1751371357:S=!0;break;case -1128612833:case -841863025:case -178796371:case 767774849:case 786592977:case 282586693:case -1067664355:case -2031744961:S=
!0;break;case -1007663920:case 234234584:case 1194992911:S=!0;break;case 1514686611:case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:case 1778578888:S=!0;break;case 2059542618:case 713270357:case -1842411134:case 2054968064:case 74278997:case 8572743:case 833996216:case 139202061:S=!0}return S}lJk(){if(!this.$.isEditMode||this.Dh.YEc)return!1;const S=this.Qoe(!1);return db.EwaSettings.isChangeGateEnabled("OfficeVSO:6214209_EnableFullRightClickMenuForExtNativePT")?!this.Dh.isOlap||
S:!this.Dh.rGc()||S}Bi(S,Wa){let zb=!1;switch(Wa){case -249874296:case -1128612833:case 1801458190:case -1951357930:case -1390365353:case -1457478532:case 1600778266:case -556893687:case -1966978671:case 1514686611:case 1778578888:case 2059542618:case 713270357:case -1842411134:case 2054968064:case 74278997:case 8572743:case 833996216:case 139202061:zb=this.EP();break;case 1885005049:zb=!db.EwaSettings.isChangeGateEnabled("OfficeVSO:8346637_PivotTableDeleteInContextMenu")||this.EP();break;case -1683649734:zb=
!db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualGroupingInPivotTables",!1)||this.EP();break;case 660506187:zb=!db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualGroupingInPivotTables",!1)||this.EP();break;case -1007663920:case 234234584:zb=this.uHk()||this.EP();break;case 1194992911:zb=this.vHk()||this.EP();break;case 1217404289:zb=!vd.b(this.lh.LabelOrDateFilterType)||this.EP();break;case -743135194:zb=!vd.e(this.lh.ValueFilterType)&&!vd.d(this.lh.ValueFilterType)||
this.EP();break;case 771421327:zb=0===this.lh.LabelOrDateFilterType&&0===this.lh.ValueFilterType&&!this.lh.HasManualFilter||this.EP();break;case 1015867427:zb=!vd.a(this.lh.LabelOrDateFilterType)||this.EP();break;case 1105960559:zb=!vd.c(this.lh.LabelOrDateFilterType)||this.EP()}return zb||super.Bi(S,Wa)}Ftb(){this.asb=this.lh=this.Pk=null}xse(){this.grid.r9(this.pC);this.$.Ma.fGb(this.NM)}kwe(){this.grid.u1(this.pC);this.$.Ma.c3b(this.NM)}v5b(){if(this.Dh&&this.Dh.tx){this.Pk=this.Dh.tx;this.lh=
this.Dh.qyc();if(this.mQg()){const S=this.Dh.AV[4===this.Pk.CellType?this.Dh.pyd-1:this.Pk.CurrentFieldIndex-1];S&&(this.asb=-2===S.Index?this.Dh.Qjf:S.Caption)}this.R9i();this.lh&&8===this.Pk.CellArea&&(this.UH.PivotValueFieldSummarizeValueByApplyData.Aggregation=this.lh.DataFieldAggregationType,this.UH.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=this.lh.DataFieldFormatType,this.UH.PivotValueFieldShowValueAsApplyData.SelectedBaseField=this.lh.BaseFieldIndex,this.UH.PivotValueFieldTitle=
this.lh.Caption)}}Qoe(S){return this.Dh?this.Dh.isOlap&&!this.Dh.ynb(!S):!1}BHk(){const S=db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1);return 1!==this.lh.MeasureType&&(!this.Dh.DZf||S&&2===this.lh.MeasureType)}y_(){const S=this.Ya.Vv(this.menuId),Wa=this.Ya.Oh(),zb=ha.f(this.$).kh(null);if(this.Dh)this.Pk&&this.Dh.tx&&this.Pk!==this.Dh.tx&&R.ULS.shipAssertTag(537167006,0,!1,"CurrentCellInfo is out of sync with cell info from PivotTable Range"),this.lh&&
this.lh!==this.Dh.qyc()&&R.ULS.shipAssertTag(537167005,0,!1,"CurrentField is out of sync with field from PivotTable Range");else return S;this.izi(S);if(this.$.isEditMode){this.refresh&&this.IAi(S);if(db.EwaSettings.isChangeGateEnabled("OfficeVSO:8346637_PivotTableDeleteInContextMenu")){var hc=this.Ya.Oh();this.rzi(hc);S.vh.push(hc)}db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualGroupingInPivotTables",!1)&&(hc=this.Ya.Oh(),this.fAi(hc),S.vh.push(hc));db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualGroupingInPivotTables",
!1)&&(hc=this.Ya.Oh(),this.eAi(hc),S.vh.push(hc));this.Pk&&this.lh&&(hc=this.Ya.Oh(),this.ZAi(hc),this.Azi(hc),S.vh.push(hc));this.N4&&Wa.buttons.push(this.Ya.Sg(99));this.Pk&&this.lh&&this.aAi(S);if(this.expandCollapse){hc=this.Ya.fz("ContextMenu.PivotExpandCollapse",null,Ia.a.instance.ia(1167),589118293);const cd=this.Ya.Oh();cd.buttons.push(this.Ya.Sg(243));cd.buttons.push(this.Ya.Sg(244));cd.buttons.push(this.Ya.Sg(245));cd.buttons.push(this.Ya.Sg(246));hc.menu.vh.push(cd);hc&&0<cd.buttons.length&&
Wa.buttons.push(hc)}this.Pk&&(hc=this.Ya.Oh(),this.nAi(hc),this.JAi(hc),0<hc.buttons.length&&S.vh.push(hc));this.Pk&&this.lh&&8===this.Pk.CellArea&&8!==this.Pk.CellType&&(hc=this.Ya.Oh(),this.BHk()&&this.aBi(hc),3!==this.Pk.CellType&&this.UAi(hc),S.vh.push(hc));!this.Dh.rGc()&&""!==(null===zb||void 0===zb?void 0:zb.text)&&this.Pk&&0===this.Pk.CellType&&this.TAi(S);this.Cmj()?Wa.buttons.push(this.Ya.Sg(257)):Wa.buttons.push(this.Ya.Sg(258));this.UTd?Wa.buttons.push(this.Ya.Sg(59)):Wa.buttons.push(this.Ya.Sg(58))}S.vh.push(Wa);
return S}R6a(){return this.lh&&this.lh.Caption?20<this.lh.Caption.length:!1}JYa(S){return this.lh&&this.lh.Caption?S?this.lh.Caption.substring(0,20)+"...":this.lh.Caption:""}UIa(S){return db.EwaSettings.isChangeGateEnabled("OfficeVSO:5548525_FixLoggingColumnNameInButtonId")?uc.a.hashCode(S).toString():S}ZAi(S){if(this.Pk&&this.lh&&4!==this.Pk.CellArea){var Wa=this.awa(this.eR("PivotTableContextMenu.Sort",this.UIa(this.lh.Caption)),-1777747317,0,0!==this.lh.SortInfo,Ia.a.instance.ia(227)),zb=this.Ya.Oh();
zb.buttons.push(this.Vj("PivotTableContextMenu.SortAscending",-1007663920,0,1===this.lh.SortInfo,Ia.a.instance.ia(228)));zb.buttons.push(this.Vj("PivotTableContextMenu.SortDescending",234234584,0,2===this.lh.SortInfo,Ia.a.instance.ia(229)));1!==this.Pk.CellArea&&2!==this.Pk.CellArea||zb.buttons.push(this.Vj("PivotTableContextMenu.SortByValue",1194992911,0,3===this.lh.SortInfo||4===this.lh.SortInfo,Ia.a.instance.ia(153)));Wa.menu.vh.push(zb);Wa&&0<zb.buttons.length&&S.buttons.push(Wa)}}Azi(S){if(this.Pk&&
this.lh&&(1===this.Pk.CellArea||2===this.Pk.CellArea)){var Wa=this.kJk();const cd=this.awa(this.eR("PivotTableContextMenu.Filter",this.UIa(this.lh.Caption)),-1777747317,0,Wa,Ia.a.instance.ia(651)),ta=this.Ya.Oh();var zb="";const wb=this.R6a();var hc=String.format(Ia.a.instance.$g(156),this.JYa(wb));wb&&(zb=String.format(Ia.a.instance.$g(156),this.lh.Caption));Wa=this.UIa(this.lh.Caption)+"."+(Wa?"enabled":"disabled");zb=this.Vj(this.eR(xc,Wa),771421327,0,!1,hc,"0",zb,8,gb.a.Xhb);Wa=this.UIa(this.lh.Caption)+
"."+this.lh.LabelOrDateFilterType.toString();this.lh.IsDateField?(hc=this.awa(this.eR("PivotTableContextMenu.DateFilter",Wa),-1777747317,0,0!==this.lh.LabelOrDateFilterType,Ia.a.instance.ia(96)),this.lzi(hc.menu)):(hc=this.awa(this.eR("PivotTableContextMenu.LabelFilter",Wa),-1777747317,0,0!==this.lh.LabelOrDateFilterType,Ia.a.instance.ia(649)),this.$zi(hc.menu));Wa=this.UIa(this.lh.Caption)+"."+this.lh.ValueFilterType.toString();Wa=this.awa(this.eR("PivotTableContextMenu.ValueFilter",Wa),-1777747317,
0,0!==this.lh.ValueFilterType,Ia.a.instance.ia(650));this.mBi(Wa.menu);ta.buttons.push(zb);ta.buttons.push(hc);ta.buttons.push(Wa);cd.menu.vh.push(ta);db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DisableManualFilterButtonOnRightClickContextMenuForPT",!1)||(zb=this.Ya.Oh(),zb.buttons.push(this.Vj("PivotTableContextMenu.ManualFilter",1514686611,0,this.lh.HasManualFilter,Ia.a.instance.ia(93))),cd.menu.vh.push(zb));cd&&0<ta.buttons.length&&S.buttons.push(cd)}}lzi(S){S.vh.push(this.Wyc(!0,
!1));S.vh.push(this.dHi());S.vh.push(this.cHi());S.vh.push(this.qJi());S.vh.push(this.tJi());S.vh.push(this.rJi());S.vh.push(this.sJi());S.vh.push(this.uJi());S.vh.push(this.vJi());S.vh.push(this.NGi())}$yi(S){S.vh.push(this.Wyc(!0,!0));S.vh.push(this.DRi());S.vh.push(this.bOi())}$zi(S){S.vh.push(this.Wyc(!0,!1));S.vh.push(this.wDf(!0));S.vh.push(this.gDi());S.vh.push(this.WFi());S.vh.push(this.yCf(!0));S.vh.push(this.lBf(!0))}mBi(S){S.vh.push(this.Wyc(!1,!1));S.vh.push(this.wDf(!1));S.vh.push(this.yCf(!1));
S.vh.push(this.lBf(!1));S.vh.push(this.PWi())}PWi(){const S=this.Ya.Oh();S.buttons.push(this.Vj("PivotTableContextMenu.Top10",-1611233597,0,vd.d(this.lh.ValueFilterType),Ia.a.instance.ia(104)));return S}WFi(){const S=this.Ya.Oh();this.lh&&(S.buttons.push(this.Vj("PivotTableContextMenu.Contains",786260386,0,10===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(652),"10")),S.buttons.push(this.Vj("PivotTableContextMenu.DoesNotContain",786260386,0,11===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(653),
"11")));return S}gDi(){const S=this.Ya.Oh();this.lh&&(S.buttons.push(this.Vj("PivotTableContextMenu.BeginsWith",786260386,0,6===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(654),"6")),S.buttons.push(this.Vj("PivotTableContextMenu.DoesNotBeginWith",786260386,0,7===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(655),"7")),S.buttons.push(this.Vj("PivotTableContextMenu.EndsWith",786260386,0,8===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(656),"8")),S.buttons.push(this.Vj("PivotTableContextMenu.DoesNotEndWith",
786260386,0,9===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(657),"9")));return S}wDf(S){const Wa=this.Ya.Oh();if(this.lh){const zb=S?dd.c:dd.f;Wa.buttons.push(this.Vj(this.eR("PivotTableContextMenu.Equals",zb),786260386,0,S?4===this.lh.LabelOrDateFilterType:18===this.lh.ValueFilterType,Ia.a.instance.ia(99),S?"4":"18"));Wa.buttons.push(this.Vj(this.eR("PivotTableContextMenu.DoesNotEqual",zb),786260386,0,S?5===this.lh.LabelOrDateFilterType:19===this.lh.ValueFilterType,Ia.a.instance.ia(100),S?"5":
"19"))}return Wa}yCf(S){const Wa=this.Ya.Oh();if(this.lh){const zb=S?dd.c:dd.f;Wa.buttons.push(this.Vj(this.eR("PivotTableContextMenu.GreaterThan",zb),786260386,0,S?12===this.lh.LabelOrDateFilterType:20===this.lh.ValueFilterType,Ia.a.instance.ia(101),S?"12":"20"));Wa.buttons.push(this.Vj(this.eR("PivotTableContextMenu.GreaterThanOrEqualTo",zb),786260386,0,S?13===this.lh.LabelOrDateFilterType:21===this.lh.ValueFilterType,Ia.a.instance.ia(658),S?"13":"21"));Wa.buttons.push(this.Vj(this.eR("PivotTableContextMenu.LessThan",
zb),786260386,0,S?14===this.lh.LabelOrDateFilterType:22===this.lh.ValueFilterType,Ia.a.instance.ia(102),S?"14":"22"));Wa.buttons.push(this.Vj(this.eR("PivotTableContextMenu.LessThanOrEqualTo",zb),786260386,0,S?15===this.lh.LabelOrDateFilterType:23===this.lh.ValueFilterType,Ia.a.instance.ia(659),S?"15":"23"))}return Wa}lBf(S){const Wa=this.Ya.Oh();if(this.lh){const zb=S?dd.c:dd.f;Wa.buttons.push(this.Vj(this.eR("PivotTableContextMenu.Between",zb),786260386,0,S?16===this.lh.LabelOrDateFilterType:24===
this.lh.ValueFilterType,Ia.a.instance.ia(103),S?"16":"24"));Wa.buttons.push(this.Vj(this.eR("PivotTableContextMenu.NotBetween",zb),786260386,0,S?17===this.lh.LabelOrDateFilterType:25===this.lh.ValueFilterType,Ia.a.instance.ia(660),S?"17":"25"))}return Wa}Wyc(S,Wa){const zb=this.Ya.Oh();if(this.lh){var hc=Ia.a.instance.ia(97);const ta=S?this.lh.LabelOrDateFilterType.toString():this.lh.ValueFilterType.toString();var cd=["PivotTableContextMenu.ClearFilter",this.UIa(this.lh.Caption),ta];S=S?this.lh.IsDateField?
Wa?1015867427:1105960559:1217404289:-743135194;cd.push(S.toString());cd=cd.join(".");hc=this.Vj(cd,S,0,!1,hc,ta,hc,8,gb.a.Xhb);zb.buttons.push(hc)}return zb}dHi(){const S=this.Ya.Oh();this.lh&&S.buttons.push(this.Vj(this.eR("PivotTableContextMenu.Equals",dd.d),786260386,0,26===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(99),"26"));return S}cHi(){const S=this.Ya.Oh();this.lh&&(S.buttons.push(this.Vj("PivotTableContextMenu.Before",786260386,0,27===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(111),
"27")),S.buttons.push(this.Vj("PivotTableContextMenu.After",786260386,0,28===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(112),"28")),S.buttons.push(this.Vj("PivotTableContextMenu.Between",786260386,0,29===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(103),"29")));return S}qJi(){const S=this.Ya.Oh();this.lh&&(S.buttons.push(this.Vj("PivotTableContextMenu.Tomorrow",1778578888,0,30===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(109),"30")),S.buttons.push(this.Vj("PivotTableContextMenu.Today",1778578888,
0,31===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(108),"31")),S.buttons.push(this.Vj("PivotTableContextMenu.Yesterday",1778578888,0,32===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(110),"32")));return S}tJi(){const S=this.Ya.Oh();this.lh&&(S.buttons.push(this.Vj("PivotTableContextMenu.NextWeek",1778578888,0,33===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(114),"33")),S.buttons.push(this.Vj("PivotTableContextMenu.ThisWeek",1778578888,0,34===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(113),
"34")),S.buttons.push(this.Vj("PivotTableContextMenu.LastWeek",1778578888,0,35===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(115),"35")));return S}rJi(){const S=this.Ya.Oh();this.lh&&(S.buttons.push(this.Vj("PivotTableContextMenu.NextMonth",1778578888,0,36===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(116),"36")),S.buttons.push(this.Vj("PivotTableContextMenu.ThisMonth",1778578888,0,37===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(117),"37")),S.buttons.push(this.Vj("PivotTableContextMenu.LastMonth",
1778578888,0,38===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(118),"38")));return S}sJi(){const S=this.Ya.Oh();this.lh&&(S.buttons.push(this.Vj("PivotTableContextMenu.NextQuarter",1778578888,0,39===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(119),"39")),S.buttons.push(this.Vj("PivotTableContextMenu.ThisQuarter",1778578888,0,40===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(120),"40")),S.buttons.push(this.Vj("PivotTableContextMenu.LastQuarter",1778578888,0,41===this.lh.LabelOrDateFilterType,
Ia.a.instance.ia(121),"41")));return S}uJi(){const S=this.Ya.Oh();this.lh&&(S.buttons.push(this.Vj("PivotTableContextMenu.NextYear",1778578888,0,42===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(122),"42")),S.buttons.push(this.Vj("PivotTableContextMenu.ThisYear",1778578888,0,43===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(123),"43")),S.buttons.push(this.Vj("PivotTableContextMenu.LastYear",1778578888,0,44===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(124),"44")));return S}vJi(){const S=this.Ya.Oh();
if(this.lh){S.buttons.push(this.Vj("PivotTableContextMenu.YearToDate",1778578888,0,45===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(125),"45"));const Wa=this.awa("PivotTableContextMenu.AllDatesInThePeriod",1778578888,0,vd.a(this.lh.LabelOrDateFilterType),Ia.a.instance.ia(126));this.$yi(Wa.menu);S.buttons.push(Wa)}return S}NGi(){const S=this.Ya.Oh();this.lh&&S.buttons.push(this.Vj("PivotTableContextMenu.CustomFilter",786260386,0,this.fJk(this.lh.LabelOrDateFilterType),Ia.a.instance.ia(107),"26"));
return S}DRi(){const S=this.Ya.Oh();this.lh&&(S.buttons.push(this.Vj("PivotTableContextMenu.Quarter1",1778578888,0,46===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(127),"46")),S.buttons.push(this.Vj("PivotTableContextMenu.Quarter2",1778578888,0,47===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(128),"47")),S.buttons.push(this.Vj("PivotTableContextMenu.Quarter3",1778578888,0,48===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(129),"48")),S.buttons.push(this.Vj("PivotTableContextMenu.Quarter4",
1778578888,0,49===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(130),"49")));return S}bOi(){const S=this.Ya.Oh();this.lh&&(S.buttons.push(this.Vj("PivotTableContextMenu.January",1778578888,0,50===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(131),"50")),S.buttons.push(this.Vj("PivotTableContextMenu.February",1778578888,0,51===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(132),"51")),S.buttons.push(this.Vj("PivotTableContextMenu.March",1778578888,0,52===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(133),
"52")),S.buttons.push(this.Vj("PivotTableContextMenu.April",1778578888,0,53===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(134),"53")),S.buttons.push(this.Vj("PivotTableContextMenu.May",1778578888,0,54===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(135),"54")),S.buttons.push(this.Vj("PivotTableContextMenu.June",1778578888,0,55===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(136),"55")),S.buttons.push(this.Vj("PivotTableContextMenu.July",1778578888,0,56===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(137),
"56")),S.buttons.push(this.Vj("PivotTableContextMenu.August",1778578888,0,57===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(138),"57")),S.buttons.push(this.Vj("PivotTableContextMenu.September",1778578888,0,58===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(139),"58")),S.buttons.push(this.Vj("PivotTableContextMenu.October",1778578888,0,59===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(140),"59")),S.buttons.push(this.Vj("PivotTableContextMenu.November",1778578888,0,60===this.lh.LabelOrDateFilterType,
Ia.a.instance.ia(141),"60")),S.buttons.push(this.Vj("PivotTableContextMenu.December",1778578888,0,61===this.lh.LabelOrDateFilterType,Ia.a.instance.ia(142),"61")));return S}aAi(S){const Wa=this.Ya.Oh();if(this.mQg()){var zb=this.Dh.AV[4===this.Pk.CellType?this.Dh.pyd-1:this.Pk.CurrentFieldIndex-1];if(zb&&this.asb){var hc=this.Ya.fz("ContextMenu.PivotTableLayout",null,Ia.a.instance.ia(647),-1777747317);var cd=this.Ya.Oh();const ta=String.format(Ia.a.instance.$g(169),this.asb),wb=String.format(Ia.a.instance.$g(170),
this.asb);cd.buttons.push(this.Vj(Ub,-1457478532,0,!zb.IsCompactLayout,ta));cd.buttons.push(this.Vj(eb,-1390365353,0,zb.IsCompactLayout,wb));hc.menu.vh.push(cd);hc&&Wa.buttons.push(hc)}}if(1===this.Pk.CellArea||2===this.Pk.CellArea)this.lh.Caption&&(zb="",cd=this.R6a(),hc=String.format(Ia.a.instance.$g(159),this.JYa(cd)),cd&&(zb=String.format(Ia.a.instance.$g(159),this.lh.Caption)),1===this.Pk.CellArea?(zb=this.awa("ContextMenu.PivotTableSubtotal",1801458190,0,this.lh.ShowSubtotal,hc),hc=this.Ya.Oh(),
hc.buttons.push(this.Ya.Sg(259)),hc.buttons.push(this.Vj("ContextMenu.PivotTableSubtotalOnTop",671485366,639,this.lh.ShowSubtotal&&this.lh.ShowSubtotalAtTop)),hc.buttons.push(this.Vj("ContextMenu.PivotTableSubtotalOnBottom",772221736,640,this.lh.ShowSubtotal&&!this.lh.ShowSubtotalAtTop)),zb.menu.vh.push(hc),zb&&0<hc.buttons.length&&Wa.buttons.push(zb)):(cd=cd?this.eR(Ab,this.UIa(hc)):Ab,Wa.buttons.push(this.Vj(cd,1801458190,0,this.lh.ShowSubtotal,hc,null,zb)))),Wa.buttons.push(this.Vj("ContextMenu.RepeatItemLabels",
-556893687,642,this.lh.RepeatItemLabels));1===this.Pk.CellArea&&Wa.buttons.push(this.Vj("ContextMenu.PivotBlankLineAfterEachItem",1600778266,641,this.lh.ShowBlankLineAfterEachItem));S.vh.push(Wa)}TAi(S){const Wa=this.Ya.Oh();Wa.buttons.push(this.Ya.Sg(247));S.vh.push(Wa)}nAi(S){if(this.$.isEditMode&&this.grid){var Wa=this.grid.ha.qa.activeRange;if(Wa.top===Wa.bottom&&Wa.left===Wa.right&&0!==this.Pk.MoveItemsMenuState){Wa=this.awa("PivotTableContextMenu.Move",-1777747317,0,!1,Ia.a.instance.ia(73));
var zb=this.Ya.Oh();this.qIa(zb,"PivotTableContextMenu.MoveToBeginning",2059542618,String.format(Ia.a.instance.$g(162),this.Pk.MoveItemName),0===(this.Pk.MoveItemsMenuState&1));this.qIa(zb,"PivotTableContextMenu.MoveUp",713270357,String.format(Ia.a.instance.$g(163),this.Pk.MoveItemName),0===(this.Pk.MoveItemsMenuState&2));this.qIa(zb,"PivotTableContextMenu.MoveDown",-1842411134,String.format(Ia.a.instance.$g(160),this.Pk.MoveItemName),0===(this.Pk.MoveItemsMenuState&4));this.qIa(zb,"PivotTableContextMenu.MoveToEnd",
2054968064,String.format(Ia.a.instance.$g(161),this.Pk.MoveItemName),0===(this.Pk.MoveItemsMenuState&8));Wa.menu.vh.push(zb);zb=this.Ya.Oh();this.qIa(zb,"PivotTableContextMenu.MoveDataItemTop",74278997,String.format(Ia.a.instance.$g(167),this.JYa(this.R6a())),0===(this.Pk.MoveItemsMenuState&16));this.qIa(zb,"PivotTableContextMenu.MoveDataItemUp",8572743,String.format(Ia.a.instance.$g(164),this.JYa(this.R6a())),0===(this.Pk.MoveItemsMenuState&32));this.qIa(zb,"PivotTableContextMenu.MoveDataItemDown",
833996216,String.format(Ia.a.instance.$g(165),this.JYa(this.R6a())),0===(this.Pk.MoveItemsMenuState&64));this.qIa(zb,"PivotTableContextMenu.MoveDataItemBottom",139202061,String.format(Ia.a.instance.$g(166),this.JYa(this.R6a())),0===(this.Pk.MoveItemsMenuState&128));Wa.menu.vh.push(zb);S.buttons.push(Wa)}}}rzi(S){const Wa=this.Ya.Sg(301);S.buttons.push(Wa)}fAi(S){const Wa=this.Ya.Sg(306);S.buttons.push(Wa)}eAi(S){const Wa=this.Ya.Sg(307);S.buttons.push(Wa)}JAi(S){var Wa="";let zb="";var hc=!1;3===
this.Pk.CellType?Wa=Ia.a.instance.ia(644):8===this.Pk.CellType?this.Dh&&(Wa=String.format(Ia.a.instance.$g(168),this.Dh.Qjf)):this.lh&&((hc=this.R6a())&&(zb=String.format(Ia.a.instance.$g(168),this.lh.Caption)),Wa=String.format(Ia.a.instance.$g(168),this.JYa(hc)));Wa&&(hc=hc?this.eR(eg,this.UIa(Wa)):eg,Wa=this.Vj(hc,-1951357930,0,!1,Wa,null,zb,8,gb.a.fvc),S.buttons.push(Wa))}izi(S){const Wa=this.Ya.Oh();Wa.buttons.push(this.Ya.Sg(43));if(this.lh&&this.Pk&&this.$.isEditMode&&(0===this.Pk.CellType||
4===this.Pk.CellType)){var zb=sc.a.mUb()?this.Ya.Sg(300):this.Ya.Sg(136);Wa.buttons.push(zb)}db.EwaSettings.isChangeGateEnabled("OfficeVSO:7094993_ShowImageDetailsInPivotTableContextMenu")&&this.grid&&this.grid.ha&&(zb=this.grid.ha.qa.selectedRanges)&&1===zb.length&&(zb[0].isSingle||this.grid.Yg.knb(zb[0]))&&this.grid.Yg.MKa(zb[0])&&!this.grid.Yg.mTb(zb[0])&&(this.grid.Yg.yTb(zb[0])?Wa.buttons.push(this.Ya.Sg(217)):Wa.buttons.push(this.Ya.Sg(216)));S.vh.push(Wa)}IAi(S){const Wa=this.Ya.Oh();Wa.buttons.push(this.Ya.Sg(100));
S.vh.push(Wa)}aBi(S){const Wa=2===this.lh.MeasureType&&!this.lh.IsNumeric,zb=this.Ya.fz("ContextMenu.SummarizeValuesBy",null,Ia.a.instance.ia(645),-249874296),hc=this.Ya.Oh();hc.buttons.push(this.Vj("ContextMenu.SummarizeValuesBySum",-1255320719,1106,0===this.lh.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Wa));hc.buttons.push(this.Vj("ContextMenu.SummarizeValuesByCount",1746132849,1107,1===this.lh.DataFieldAggregationType));hc.buttons.push(this.Vj("ContextMenu.SummarizeValuesByAverage",
-771066011,1108,2===this.lh.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Wa));hc.buttons.push(this.Vj("ContextMenu.SummarizeValuesByMax",835007294,1109,3===this.lh.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Wa));hc.buttons.push(this.Vj("ContextMenu.SummarizeValuesByMin",929115636,1110,4===this.lh.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Wa));db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableNewAggregations",!1)&&hc.buttons.push(this.Vj("ContextMenu.SummarizeValuesByMedian",
-413510754,2426,12===this.lh.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,this.Qoe(!0)||Wa));hc.buttons.push(this.Vj("ContextMenu.SummarizeValuesByProduct",1935475057,1111,5===this.lh.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,this.Qoe(!0)||Wa));2!==this.lh.MeasureType&&(hc.buttons.push(this.Vj("ContextMenu.SummarizeValuesByCountNumbers",1475494885,1112,6===this.lh.DataFieldAggregationType)),hc.buttons.push(this.Vj("ContextMenu.SummarizeValuesByStdDeviation",588680636,
1113,7===this.lh.DataFieldAggregationType)),hc.buttons.push(this.Vj("ContextMenu.SummarizeValuesByStdDeviationPercent",-910892852,1114,8===this.lh.DataFieldAggregationType)),hc.buttons.push(this.Vj("ContextMenu.SummarizeValuesByVariant",1668427539,1115,9===this.lh.DataFieldAggregationType)),hc.buttons.push(this.Vj("ContextMenu.SummarizeValuesByVariantPercent",-1751371357,1116,10===this.lh.DataFieldAggregationType)));this.Dh&&this.Dh.rGc()?hc.buttons.push(this.Vj("ContextMenu.SummarizeValuesByDistinctCountPPM",
376946683,1117,11===this.lh.DataFieldAggregationType)):db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableNewAggregations",!1)&&hc.buttons.push(this.Vj("ContextMenu.SummarizeValuesByDistinctCountPPM",376946683,1117,11===this.lh.DataFieldAggregationType));zb.menu.vh.push(hc);S.buttons.push(zb)}UAi(S){const Wa=this.Ya.fz("ContextMenu.ShowValuesAs",null,Ia.a.instance.ia(646),-1128612833),zb=this.Ya.Oh();zb.buttons.push(this.Vj("ContextMenu.ShowValuesAsNoCalculation",-841863025,1123,
0===this.lh.DataFieldFormatType));zb.buttons.push(this.Vj("ContextMenu.ShowValuesAsPercentOfGrandTotal",-178796371,1130,7===this.lh.DataFieldFormatType));zb.buttons.push(this.Vj("ContextMenu.ShowValuesAsPercentOfColumnTotal",786592977,1129,6===this.lh.DataFieldFormatType));zb.buttons.push(this.Vj("ContextMenu.ShowValuesAsPercentOfRowTotal",767774849,1128,5===this.lh.DataFieldFormatType));zb.buttons.push(this.Vj("ContextMenu.ShowValuesAsPercentOfParentRowTotal",282586693,1133,9===this.lh.DataFieldFormatType));
zb.buttons.push(this.Vj("ContextMenu.ShowValuesAsParentColumnTotal",-1067664355,1134,10===this.lh.DataFieldFormatType));if(this.Dh&&this.Dh.AV&&0<this.Dh.AV.length||this.Dh.sla&&0<this.Dh.sla.length){const hc=this.awa("ContextMenu.ShowValuesAsPercentOfParentTotal",-1128612833,1135,11===this.lh.DataFieldFormatType),cd=this.Ya.Oh(),ta=this.$Ai();for(let wb=0;wb<ta.length;wb++){const ic=ta[wb];cd.buttons.push(this.Vj("ContextMenu.ShowValuesAsPercentOfParentTotal."+ic.Caption,-2031744961,1135,11===this.lh.DataFieldFormatType&&
this.lh.BaseFieldIndex===ic.Index,ic.Caption,"ContextMenu.ShowValuesAsPercentOfParentTotal."+ic.Index))}hc.menu.vh.push(cd);zb.buttons.push(hc)}Wa.menu.vh.push(zb);S.buttons.push(Wa)}showPivotTableContextMenu(){var S;this.UTd=!0;this.expandCollapse=this.N4=this.refresh=!1;var Wa=this.$,zb=ha.f(Wa),hc=null;$b.a.Zg(Ib.qb)?hc=null===(S=$b.a.Zg(Ib.qb))||void 0===S?void 0:S.CQb():void $b.a.resolve(Ib.qb,{va:0});if(hc){S=nd.a(Wa);if(null===S||void 0===S?0:S.Soe)this.UTd=Rc.g(Wa.Bk);S=Wa.th;this.N4=hc.supportsBIExplore&&
(db.EwaSettings.G5()||!!Lb.b(Wa))&&S.aea(32768);S.allowInteractivity&&(Wa=zb.kh(null),(null===Wa||void 0===Wa?0:Wa.cell)&&(Wa.cell.bsd||Wa.cell.iQg)&&(this.expandCollapse=!0),S.allowManualDataRefresh&&(this.refresh=!0))}Wa=null;hc=1;this.Ufb&&1!==this.Ufb.oh?(Wa=new Sys.UI.Point(this.Ufb.clientPoint.x,this.Ufb.clientPoint.y),hc=this.Ufb.oh):(zb=Hb.h(zb,this.$))&&(Wa=new Sys.UI.Point(zb.x+(this.$.isChromeRtl?0:zb.width),zb.y+zb.height));xa.a.eh=hc;this.GHc=3===hc;this.Ft(Wa,!0,hc);this.ZUd=!0;this.xse()}E5i(){const S=
new Ha.a(1114549926,0,this.$.Rh,19,null);this.$.Ma.dh(S)}uQi(){if(this.Dh&&this.Dh.tx){var S=this.Dh.tx.CurrentCol;if(this.Dh.tx.CurrentRow===this.activeCell.FirstRow&&S===this.activeCell.FirstColumn){this.v5b();this.showPivotTableContextMenu();return}}S=new Ta.a(228,0,(Wa,zb,hc)=>ff.p(this.$.pa.ta,this.activeCell,lb.c(Wa,this.OQj),lb.b(zb,this.NQj),hc,null),16);this.$.userOperationManager.enqueueOperation(S,null)}Cmj(){const S=$b.a.Zg(Ib.Ae);return S?S.$Q:!1}eR(S,Wa){return S+"."+Wa}performPivotTableOperation(S,
Wa){const zb=af.a.Tg.Wh;if(this.Dh&&(this.lh||!this.Pk||3===this.Pk.CellType||db.EwaSettings.isChangeGateEnabled("OfficeVSO:8346637_PivotTableDeleteInContextMenu")&&1885005049===S)){var hc=this.Dh.isOlap&&(!db.EwaSettings.isChangeGateEnabled("OfficeVSO:8346637_PivotTableDeleteInContextMenu")||1885005049!==S),cd=ta=>{ta&&this.$.enqueueOperation(S,(wb,ic,Oa)=>{var Cb=this.nze,yc=this.activeCell,Nc=this.lh?this.lh.Caption:null,Id=this.asb;wb=lb.c(wb,this.AUj);ic=lb.b(ic,this.zUj);var ke=this.$.pa.ta.Jh();
ke=Cb.Za(41,void 0===ke?null:ke);ke.activeCell=yc;ke.operationType=Wa;ke.fieldCaption=Nc;ke.prevFieldCaption=Id;return Ea.h(Cb,"ExecutePivotTableOperation",ke,wb,ic,Oa,null,0)},zb,0,4,229)};void $b.a.resolve(Ib.qb,{va:0}).then(ta=>{ta.UL(hc,cd)})}else this.lp()}applyValueFieldSettingsToPivotTable(S,Wa){Wa=void 0===Wa?!1:Wa;const zb=af.a.Tg.Wh;if(this.Dh&&this.lh){Wa&&2===this.lh.MeasureType&&R.ULS.sendTraceTag(537167002,0,50,"change aggregation type for an implicit measure from right click context menu.");
var hc=this.Dh.isOlap,cd=ta=>{ta&&this.$.enqueueOperation(S,(wb,ic,Oa)=>{var Cb=this.nze,yc=this.activeCell,Nc=this.UH;wb=lb.c(wb,this.qKj);ic=lb.b(ic,this.pKj);var Id=this.$.pa.ta.Jh();Id=Cb.Za(41,void 0===Id?null:Id);Id.activeCell=yc;Id.pivotValueFieldSettingsApplyData=Nc;return Ea.h(Cb,"ApplyValueFieldSettingsToPivotTable",Id,wb,ic,Oa,null,0)},zb,0,4,231)};void $b.a.resolve(Ib.qb,{va:0}).then(ta=>{ta.UL(hc,cd)})}else this.lp()}Vj(S,Wa,zb,hc,cd,ta,wb,ic,Oa,Cb){cd=void 0===cd?null:cd;ta=void 0===
ta?null:ta;wb=void 0===wb?null:wb;ic=void 0===ic?8:ic;Oa=void 0===Oa?null:Oa;Cb=void 0===Cb?!1:Cb;hc&&(S+=".Checked");Cb&&(S+=".Disabled");this.Ya.wSd(S)&&this.Ya.kfe(S);zb=cd||Ia.a.instance.ia(zb);S=this.Ya.rWa(S,zb,Wa,null,"None",ta,Cb,null);S.ime(null);wb&&S.L1(wb);hc?S.P1("Image16by16",3,gb.a.hma):Oa?S.P1("Image16by16",ic,Oa):S.Loc();return S}awa(S,Wa,zb,hc,cd){zb=(void 0===cd?null:cd)||Ia.a.instance.ia(zb);this.Ya.wSd(S)?this.Ya.kfe(S):this.Ya.kfe(S+".Checked");hc&&(S+=".Checked");this.cHk&&
(zb=this.Rdi.parseFromString(zb,"text/html").body.innerText);S=this.Ya.Iqc(S,null,zb,Wa,3,gb.a.hma);S.GQf=hc;!hc&&db.EwaSettings.isChangeGateEnabled("OfficeVSO:4877664_HidePivotTableContextMenuFlyoutCheckmark")&&S.Loc();return S}R9i(){this.UH=Object(Q.a)(new Ed,{PivotValueFieldSummarizeValueByApplyData:Object(Q.a)(new Vb,{Aggregation:-1}),PivotValueFieldShowValueAsApplyData:Object(Q.a)(new Oe,{SelectedDataFormat:-1,SelectedBaseField:-1,SelectedBaseItem:-1}),PivotValueFieldTitle:null})}F6a(S,Wa){this.UH.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=
S;this.UH.PivotValueFieldShowValueAsApplyData.SelectedBaseField=Wa;this.UH.PivotValueFieldShowValueAsApplyData.SelectedBaseItem=-1}$Ai(){const S=[];if(this.Dh&&this.Dh.sla&&0<this.Dh.sla.length)for(const Wa of this.Dh.sla)Wa&&S.push(Wa);if(this.Dh&&this.Dh.AV&&0<this.Dh.AV.length)for(const Wa of this.Dh.AV)Wa&&S.push(Wa);S.sort((Wa,zb)=>Wa.Index-zb.Index);return S}mQg(){if(!this.Pk||!this.Dh||!this.Dh.AV)return!1;const S=1===this.Pk.CellArea||4===this.Pk.CellType&&this.Pk.IsRowAxis,Wa=4===this.Pk.CellType?
0<this.Dh.pyd:0<this.Pk.CurrentFieldIndex;return 1<this.Dh.AV.length&&S&&Wa}KYa(S){const Wa=[];3===S?this.$.isEditMode?db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInEditMode",!1)&&this.$.isMobileMode?Wa.push(...[Nd.a.Y$d,Nd.a.Z$d]):Wa.push(...[Nd.a.Y$d,Nd.a.Z$d,Nd.a.b3j]):Wa.push(...[Nd.a.copy]):2===S&&Wa.push(Nd.a.Lsd);return Wa}lp(){const S=Za.a.Yi(1,0,0,648,0,104573951,"PivotTableContextMenuOperationFailure");cc.a(this.$).lp(S)}kJk(){return this.lh?0!==this.lh.LabelOrDateFilterType||
0!==this.lh.ValueFilterType||this.lh.HasManualFilter:!1}fJk(S){return 62<=S&&65>=S}Atj(){if(this.activeCell&&this.lh&&this.Dh){var S={};S.cell=this.activeCell;S.dataSourceIndex=this.Dh.externalSourceIndex;S.fieldId=this.lh.Index.toString();S.isOlap=this.Dh.isOlap;S.confirmationRequired=this.Dh.confirmationRequiredForDataOps;var Wa={};Wa.showPivotFilterDialogCommandData=S;this.$.ei(492140419,xa.a.eh,19,Wa)}}RTh(S){this.activeCell&&this.lh&&this.Dh&&this.$.userOperationManager.enqueueOperation(new Ta.a(153,
0,(Wa,zb,hc)=>Ea.B(this.$.pa.ta,this.activeCell,this.Dh.externalSourceIndex,this.lh.Index.toString(),S,Wa,zb,hc,null,null)),null)}IEh(S){!(30>S||61<S)&&this.activeCell&&this.lh&&this.Dh&&this.$.userOperationManager.enqueueOperation(new Ta.a(152,0,(Wa,zb,hc)=>Ea.e(this.$.pa.ta,this.activeCell,this.Dh.externalSourceIndex,this.lh.Index.toString(),S,Wa,zb,hc,null,null)),null)}applyPivotSort(S){if(this.Dh&&this.lh&&this.activeCell&&this.Pk){var Wa=1===this.Pk.CellArea||2===this.Pk.CellArea;8===this.Pk.CellArea?
Re.a(this.$.userOperationManager,(zb,hc,cd)=>ff.b(this.$.pa.ta,this.activeCell,S,this.lh.Caption,zb,hc,cd,null),zb=>new Ta.a(1015,0,zb,void 0,null),null):Wa&&(Wa=1===this.Pk.CellArea?1:2,db.EwaSettings.Ra(600)?Zd.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Dh.externalSourceIndex,this.lh.Index.toString(),this.lh.Caption,this.Dh.isOlap?"":this.lh.Caption,Wa,1===S):Zd.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Dh.externalSourceIndex,
this.lh.Index.toString(),1===S))}}EP(){return!this.Dh||!this.Dh.isActionable}uHk(){return(this.Pk||this.Dh)&&4!==this.Pk.CellType&&(0!==this.Pk.CellType||8!==this.Pk.CellArea||this.Dh.sla&&this.Dh.sla.length||this.Dh.AV&&this.Dh.AV.length)?!1:!0}vHk(){return this.Pk&&this.Dh&&(1===this.Pk.CellArea||2===this.Pk.CellArea)&&this.Dh.m$b&&this.Dh.m$b.length?!1:!0}qIa(S,Wa,zb,hc,cd){S.buttons.push(this.Vj(Wa,zb,0,!1,hc,null,null,8,null,cd))}};Fc=Object(N.__decorate)([Object($b.d)(Ib.ze),Object(N.__param)(0,
Object(Ib.Lb)()),Object(N.__param)(1,Object(Ib["if"])()),Object(N.__param)(2,Object(Ib.cb)()),Object(N.__param)(3,Object(Ib.Lg)())],Fc);Object(M.a)(Fc,"PivotTableContextMenu",Y.a,[]);var rd=a(356),Gd=a(321);const ue=ea.a.YYh;let Ce=class extends Y.a{constructor(S,Wa,zb,hc,cd){super(S,"PopulateTableFieldListContextMenu",-751848458,-1085236154,ue,!0,!1,"TableFieldListContextMenuRoot",cd,Wa,!1,zb,hc);this.urc=null;this.p5d=0;this.rgc=null;this.grid=ha.f(S)}get vD(){return"PopulateTableFieldListContextMenu"}get DH(){return ea.a.sxg}get RY(){this.rgc||
(this.rgc=this.$.ka.Ug(261));return this.rgc}executeCommand(S,Wa,zb){S=Wa.command;switch(S){case 639960842:this.applyTableFieldList(zb);this.RY.Etb();break;case -1085236154:R.ULS.sendTraceTag(537166999,0,50,`TableFieldListContextMenu:TableFieldListContextMenuClose, ColWithEntities, ${this.p5d}`);this.RY.Etb();break;case 1833782813:this.RY.showCallout();break;default:return mb.a(S)}return Jc.Task.Va(!0)}applyTableFieldList(S){let Wa=S.MenuItemId.toString();db.EwaSettings.isChangeGateEnabled("OfficeVSO:5239502_UpdatePulloutFieldNameContainingSplChars")&&
(Wa=Wa.replace("'","''"),Wa=Wa.replace("[","'["),Wa=Wa.replace("]","']"));var zb=Object(qb.a)(String,S.SourceControlId);const hc={};hc.PulloutField=Wa;hc.PulloutCardPath=S.SourceCardKeyPath;hc.PulloutCardSourceRow=S.SourceCardRow;hc.PulloutCardSourceColumn=S.SourceCardColumn;hc.PulloutExtractType=db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeGate.JsonStringReturnExtractType_2",!1)?S.ExtractType:null;if(this.RY.L0){R.ULS.sendTraceTag(38887748,0,50,"Table Pullout operation started");
hc.ParameterType=2;S=S.ColumnIndex;if(void 0===S||null===S){if(void 0===zb||null===zb){R.ULS.shipAssertTag(537166998,0,!1,"TableFieldListContextMenu: ApplyTableFieldList, must specifiy ColumnIndex or SourceControlId");return}S=0<=this.RY.ivg?this.RY.ivg:parseInt(zb.substring(20+Wa.length+1,zb.length),10);if(isNaN(S)){R.ULS.shipAssertTag(537166997,0,!1,`TableFieldListContextMenu:ApplyTableFieldListMalformatHTMLAttribute, Attribute, ${zb}`);return}}hc.PulloutRichColumnSourceIndex=S;if(this.rgc.SBh){this.OCh(Wa,
hc);return}}else R.ULS.sendTraceTag(38887749,0,50,"Grid Pullout operation started"),hc.ParameterType=4,zb=this.RY.selectedRange.right,void 0!==hc.PulloutCardSourceColumn&&null!==hc.PulloutCardSourceColumn&&(zb=hc.PulloutCardSourceColumn+1),hc.PulloutRichColumnSourceIndex=zb;this.ELg(Wa,hc)}ELg(S,Wa,zb){zb=void 0===zb?0:zb;R.ULS.sendTraceTag(537166996,0,50,`TableFieldListContextMenu:ApplyTableFieldList, ColWithEntities, ${this.p5d}, SelectedColumnIndex, ${Wa.PulloutRichColumnSourceIndex}`);S=Object(Q.a)(new Gd.a,
{Text:S});this.grid.setCell(S,this.RY.VLa,0,127,Wa,zb);this.grid.focus();this.urc=null;this.RY.Etb();this.RY.Vok()}ni(S,Wa,zb){if(S=this.$.isEditMode&&db.EwaSettings.Ra(128)&&!!this.RY)switch(Wa.command){case -1085236154:break;case 639960842:S=!!zb;break;case 1833782813:S=this.RY.iKa&&this.RY.cJc;break;default:S=!1}return S}Yba(S,Wa,zb){this.$.isEditMode&&(this.urc=this.jAi(Object(qb.a)(566,zb)),super.Yba(S,Wa,null,null,!1))}y_(){return this.urc}Bwd(S){if(!this.RY||!S||!S.xx)return R.ULS.shipAssertTag(537166994,
0,!!this.RY,"TableFieldListContextMenu:CreateContextMenuItemList PulloutManager null"),R.ULS.shipAssertTag(537166993,0,!!S,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager null"),S&&R.ULS.shipAssertTag(537166992,0,!!S.xx,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager.FieldInfoListContextList null"),null;const Wa=[];for(const zb of S.xx){S=[zb.ColumnName,zb.ColumnIndex.toString()];const hc=zb.FieldInfoDataList.map(cd=>cd.Name).sort(uc.b);Wa.push([...S,...hc])}return Wa}jAi(S){var Wa=
this.Bwd(S);if(!Wa||!Wa.length)return this.urc=null;const zb=this.Ya;S=zb.Oh();const hc=1<Wa.length;this.p5d=Wa.length;for(var cd of Wa){hc||(S.title=cd[0]);Wa=zb.Oh();for(let ta=2,wb=cd.length;ta<wb;++ta)(hc?Wa.buttons:S.buttons).push(zb.rWa("ApplyTableFieldList."+cd[ta]+"."+cd[1],cd[ta],639960842,null,"None",cd[ta],!1,void 0,!0));if(hc){const ta=zb.fz("ApplyTableFieldList."+cd[0],this.menuId,cd[0],798637440);ta.menu.vh.push(Wa);S.buttons.push(ta)}}cd=zb.Vv(this.menuId);cd.vh.push(S);return cd}OCh(S,
Wa){const zb=Za.a.Yi(12,1,0,900,0,2007340793,"RichValuePulloutIntoNonEmptyRange"),hc=new rd.a(this.$,zb);hc.Uda(()=>{2===hc.returnValue&&this.ELg(S,Wa,8)})}};Ce=Object(N.__decorate)([Object($b.d)(Ib.Te),Object(N.__param)(0,Object(Ib.Lb)()),Object(N.__param)(1,Object(Ib["if"])()),Object(N.__param)(2,Object(Ib.cb)()),Object(N.__param)(3,Object(Ib.Lg)())],Ce);Object(M.a)(Ce,"PulloutFieldListContextMenu",Y.a,[]);const Se=ea.a.yxg;let of=class extends Y.a{constructor(S,Wa,zb,hc,cd){super(S,"PopulateRichTextContextMenu",
679816325,1151222423,Se,!0,!1,Se,cd,Wa,!0,zb,hc);this.grid=ha.f(S)}get vD(){return"PopulateRichTextContextMenu"}get DH(){return ea.a.yxg}ni(S,Wa,zb){return-1687037502===Wa.command&&!!zb&&this.grid.isEditing}executeCommand(S,Wa,zb){this.showRichTextFloatie(zb);return Jc.Task.Va(!0)}KYa(){return[Nd.a.iRh]}showRichTextFloatie(S){var Wa=Object(qb.a)(Md.a,S.eventArgs);Wa&&(S=this.KYa(Wa.oh),Wa=new Sys.UI.Point(Wa.La.clientX,Wa.La.clientY),this.showFloatie(S,new Sys.UI.Bounds(Wa.x,Wa.y,0,0),2))}};of=Object(N.__decorate)([Object($b.d)(Ib.jf),
Object(N.__param)(0,Object(Ib.Lb)()),Object(N.__param)(1,Object(Ib["if"])()),Object(N.__param)(2,Object(Ib.cb)()),Object(N.__param)(3,Object(Ib.Lg)())],of);Object(M.a)(of,"RichTextContextMenu",Y.a,[]);var jf=a(117),bf=a(266),pf=a(643),Ud=a(548),Ff=a(765);const Uf=ea.a.XYh;let Gf=class extends Y.a{constructor(S,Wa,zb,hc,cd,ta){super(S,"PopulateSheetOpsContextMenu",274207288,-1497523576,Uf,!0,!1,"SheetTabContextMenuRootName",ta,Wa,!1,zb,hc);this.mpf=this.npf=this.kuc=this.vHc=this.AUb=!1;this.copyPasteInfrastructure=
cd}get vD(){return"PopulateSheetOpsContextMenu"}get DH(){return ea.a.zxg}executeCommand(S,Wa,zb){if(Mb.a(this.$))return Jc.Task.Va(!0);this.$.isEditMode&&(this.mpf=zb.EnableContextMenuOnSheetTabBar,S=zb[ea.a.loe],S=S.x&&S.y?new Sys.UI.Point(S.x+(this.$.isChromeRtl?10:-10),S.y):Sa.DOMElementExtensions.getLocation(zb[ea.a.moe]),this.Ft(S,!1));return Jc.Task.Va(!0)}ni(S,Wa,zb){return-1075099431===Wa.command&&!!zb}y_(){const S=this.Ya.Vv(this.menuId);if(!db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInEditMode",
!1)||!this.$.isMobileMode)if(this.mpf)this.hAi(S);else{var Wa=this.$.isEditMode;this.F3g();this.Wzi(S,Wa);if(db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)){var zb=this.Ya.Oh();this.Ozf(zb);S.vh.push(zb);zb=this.Ya.Oh();this.jAf(zb,Wa);this.pAf(zb);S.vh.push(zb);Wa=this.Ya.Oh();this.$zf(Wa);this.Nzf(Wa);this.lAf(Wa);this.bAf(Wa);S.vh.push(Wa)}else Wa=this.Ya.Oh(),this.Wzf(Wa),S.vh.push(Wa),Wa=this.Ya.Oh(),this.lAf(Wa),S.vh.push(Wa),Wa=this.Ya.Oh(),
this.bAf(Wa),S.vh.push(Wa)}return S}bAf(S){var Wa;if(db.EwaSettings.isChangeGateEnabled("OfficeVSO:8501332_ShareExcelNamedSheetView")||db.EwaSettings.isChangeGateEnabled("OfficeVSO:8728468_NSVContextMenuOptimization")){const zb=this.$.sa.na;(null===(Wa=null===zb||void 0===zb?void 0:zb.Kj)||void 0===Wa?0:Wa.Ow)&&this.qAi(S)}}hAi(S){const Wa=this.Ya,zb=Wa.Oh();zb.buttons.push(Wa.Sg(360));this.kuc=this.copyPasteInfrastructure.enb()&&this.copyPasteInfrastructure.mUd();this.cFa(zb.buttons,!this.kuc,341,
340);this.F3g();this.cFa(zb.buttons,!this.AUb,115,113);S.vh.push(zb)}cFa(S,Wa,zb,hc){S.push(this.Ya.Sg(Wa?zb:hc))}jAf(S,Wa){S.buttons.push(this.Ya.Sg(55));Wa&&this.cFa(S.buttons,this.vHc,126,125)}Ozf(S){this.kuc=this.copyPasteInfrastructure.enb()&&this.copyPasteInfrastructure.mUd();this.npf=db.EwaSettings.isChangeGateEnabled("OfficeVSO:8580433_CopySheetForWorksheetOnly")&&this.$.sa.na&&vb.o(this.$.sa.na);pf.a.nmb&&(db.EwaSettings.isChangeGateEnabled("OfficeVSO:8580433_CopySheetForWorksheetOnly")?
this.cFa(S.buttons,!this.npf,339,338):S.buttons.push(this.Ya.Sg(338)),this.cFa(S.buttons,!this.kuc,341,340));pf.a.nmb||S.buttons.push(this.Ya.Sg(158))}Wzi(S,Wa){const zb=this.Ya,hc=zb.Oh();hc.buttons.push(zb.Sg(54));this.cFa(hc.buttons,this.vHc,127,56);db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)&&this.Wzf(hc);db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)||(this.jAf(hc,Wa),this.Ozf(hc),this.Nzf(hc),
this.$zf(hc),this.pAf(hc));S.vh.push(hc)}Nzf(S){if(db.EwaSettings.isChangeGateEnabled("OfficeVSO:8218038_moveCanShareExcelSectionToHelper")&&Ud.a(this.$)||this.CIb())db.EwaSettings.isChangeGateEnabled("OfficeVSO:8575759_CopyLinkContextMenu")?S.buttons.push(this.Ya.Sg(312)):S.buttons.push(this.Ya.Sg(299))}$zf(S){if(this.$.ea.g6b&&K.AFrameworkApplication.Baa(bf.e)){const Wa=Object(qb.a)(jf.a,this.$.na);Wa&&vb.o(Wa)&&this.$.isEditMode&&(S.buttons.push(this.Ya.Sg(277)),Wa.isLockPausedInSession?S.buttons.push(this.Ya.Sg(279)):
Wa.Dn&&S.buttons.push(this.Ya.Sg(278)))}}pAf(S){const Wa=this.Ya.fz("ContextMenu.TabColor",null,Ia.a.instance.ia(518),1841703919);var zb=sc.a.sK()?-605730035:null;zb=this.Ya.BKb(467002767,1549407384,541,-221093529,zb,this.DH);Wa.menu.vh.push(zb);S.buttons.push(Wa)}Wzf(S){this.cFa(S.buttons,this.vHc,114,112);this.cFa(S.buttons,!this.AUb,115,113)}lAf(S){db.EwaSettings.Ra(418)&&!vb.e(this.$.sa.na)&&S.buttons.push(this.Ya.Sg(263))}F3g(){const {lwd:S,jgf:Wa}=this.$.kwd();this.vHc=1===S;this.AUb=0<Wa}qAi(S){db.EwaSettings.isChangeGateEnabled("OfficeVSO:8728468_NSVContextMenuOptimization")&&
S.buttons.push(this.Ya.Sg(319));(db.EwaSettings.isChangeGateEnabled("OfficeVSO:8218038_moveCanShareExcelSectionToHelper")&&Ud.a(this.$,!0)||this.CIb(!0))&&db.EwaSettings.isChangeGateEnabled("OfficeVSO:8501332_ShareExcelNamedSheetView")&&S.buttons.push(this.Ya.Sg(317))}CIb(S){var Wa;const zb=this.$.sa.na;return this.$.yM||!db.EwaSettings.isChangeGateEnabled("OfficeVSO:8096934_ShareExcelSection")||!Ud.b(this.$)||this.$.ea.isNamedObjectViewMode||this.$.isMobileMode||!(db.EwaSettings.isChangeGateEnabled("OfficeVSO:8501332_ShareExcelNamedSheetView")&&
S||null===(Wa=null===zb||void 0===zb?void 0:zb.Kj)||void 0===Wa)&&Wa.Ow?!1:!0}};Gf=Object(N.__decorate)([Object($b.d)(Ib.Ff),Object(N.__param)(0,Object(Ib.Lb)()),Object(N.__param)(1,Object(Ib["if"])()),Object(N.__param)(2,Object(Ib.cb)()),Object(N.__param)(3,Object(Ib.Lg)()),Object(N.__param)(4,Object(Ff.e)())],Gf);Object(M.a)(Gf,"SheetOpsContextMenu",Y.a,[]);var lg=a(597);let Pa=class extends Y.a{constructor(S,Wa,zb,hc,cd){super(S,"PopulateSlicerContextMenu",-1920954846,723126814,"SlicerContextMenu",
!0,!1,"SlicerContextMenuRootName",cd,Wa,!0,zb,hc);this.zoom=hc}get vD(){return"PopulateSlicerContextMenu"}get DH(){return ea.a.Axg}Bi(S,Wa){var zb=!0;switch(Wa){case -231711729:zb=!1;break;case -1909381757:zb=this.Bwa();zb=!!zb&&zb.XTd;break;case 1312363469:zb=!0}return!zb||super.Bi(S,Wa)}executeCommand(S,Wa,zb){if(!this.$.isEditMode)return ra.TaskExtensions.N$();S=Wa.command;Wa=this.Bwa();let hc=null;switch(S){case 2108047455:Wa&&Wa.ncf();break;case -231711729:R.ULS.shipAssertTag(537166990,0,!1,
"Shouldn't be hitting Slicer Refresh - NYI");break;case -1909381757:Wa&&Wa.tJb();break;case 1312363469:this.showSlicerContextMenu(zb);break;default:hc=mb.a(S)}return hc||ra.TaskExtensions.N$()}ni(S,Wa,zb){S=!1;switch(Wa.command){case -231711729:case 2108047455:case -1909381757:S=!0;break;case 1312363469:S=!!zb}return S}y_(){const S=this.Ya.Vv(this.menuId);var Wa=this.Ya.Oh();Wa.buttons.push(this.Ya.Sg(252));Wa.buttons.push(this.Ya.Sg(253));Wa.buttons.push(this.Ya.Sg(254));S.vh.push(Wa);Wa=this.Ya.Oh();
this.cpj()?Wa.buttons.push(this.Ya.Sg(266)):Wa.buttons.push(this.Ya.Sg(267));S.vh.push(Wa);return S}cpj(){const S=$b.a.Zg(Ib.Uf);return S?S.$Q:!1}showSlicerContextMenu(S){var Wa=Object(qb.a)(Md.a,S.eventArgs);S=this.FYa(Object(qb.a)(Md.a,S.eventArgs));Wa=Wa.oh;xa.a.eh=Wa;this.Ft(S,!1,Wa)}nAf(S){const Wa=this.Ya.Oh(),zb=this.Ya.Oh();zb.buttons.push(this.Ya.Sg(255));zb.buttons.push(this.Ya.Sg(256));const hc=this.Ya.Iqc("ContextMenu.SlicerSort",null,Ia.a.instance.ia(2179),-814639094,0,gb.a.zsf);hc.menu.vh.push(zb);
Wa.buttons.push(hc);S.vh.push(Wa)}zpe(S){return S.Qh.className===gb.a.wNb||1===S.oh}FYa(S){var Wa=ha.f(this.$).ha.$e.yh;let zb=S&&1!==S.oh&&S.clientPoint?S.clientPoint:Sys.UI.DomElement.getLocation(Wa.domElement);if(this.zpe(S)){var hc=this.Bwa();hc&&(S.Qh.className===gb.a.wNb&&(zb=ec.HelperMethods.rPb(S.La)),1===S.oh&&(zb=this.zoomManager.Rfa(Sa.DOMElementExtensions.getLocation(hc.frame))))}else if(S=this.Bwa())S=this.yJd(S.frame),(hc=ec.HelperMethods.cH(this.$.ll,this.$.domElement,ha.f(this.$).rtl,
!1))?(S.x=this.zoomManager.Pn(S.x-hc.x)+hc.x,S.y=this.zoomManager.Pn(S.y-hc.y)+hc.y):R.ULS.sendTraceTag(537166989,0,15,"Cannot get constant pane size."),zb.y+=S.y,zb.x+=S.x;S=this.$.domElement;hc=ha.f(this.$).rtl;Wa=ec.HelperMethods.cH(Wa.fm.domElement,S,hc);zb.y=Math.max(zb.y,Wa.y);zb.x=Math.max(zb.x,Wa.x);return zb}Bwa(){const S=ha.f(this.$).ha.$e.yh;R.ULS.shipAssertTag(537166988,0,!!S);return lg.a(this.$).LO(S.floatingObject.id)}yJd(S){let Wa=new Sys.UI.Point(S.offsetParent.offsetLeft,S.offsetParent.offsetTop);
var zb=ha.f(this.$);if(!zb)return Wa;const hc=ha.f(this.$).rtl;Wa=ec.HelperMethods.cH(S,this.$.Gw.ownerDocument.body,hc);zb.dwd(Wa);Wa.x=hc?this.$.Gw.clientWidth-Wa.x-S.clientWidth:Wa.x;S=zb.view.Xka;zb=hc?-zb.dZ.Coa(S.x):S.x;Wa.x-=zb;Wa.y-=S.y;return Wa}};Pa=Object(N.__decorate)([Object($b.d)(Ib.Rf),Object(N.__param)(0,Object(Ib.Lb)()),Object(N.__param)(1,Object(Ib["if"])()),Object(N.__param)(2,Object(Ib.cb)()),Object(N.__param)(3,Object(Ib.Lg)())],Pa);Object(M.a)(Pa,"SlicerContextMenu",Y.a,[]);
var lc;let Gc=lc=class extends Y.a{constructor(S,Wa,zb,hc,cd){super(S,"PopulateTimeSlicerContextMenu",1851761031,429416385,lc.Xte,!0,!1,lc.L5a,cd,Wa,!0,zb,hc);this.zoom=hc}get vD(){return"PopulateTimeSlicerContextMenu"}get DH(){return ea.a.Dxg}Bi(S,Wa){var zb=!0;switch(Wa){case -741340954:zb=this.Bwa();zb=!!zb&&zb.XTd;break;case 205863562:zb=!0}return!zb||super.Bi(S,Wa)}executeCommand(S,Wa,zb){if(!this.$.isEditMode)return ra.TaskExtensions.N$();S=Wa.command;Wa=this.Bwa();let hc=null;switch(S){case -741340954:Wa&&
Wa.tJb();break;case 205863562:this.showTimeSlicerContextMenu(zb);break;default:hc=mb.a(S)}return hc||ra.TaskExtensions.N$()}ni(S,Wa,zb){S=!1;switch(Wa.command){case -741340954:S=!0;break;case 205863562:S=!!zb}return S}y_(){const S=this.Ya.Vv(this.menuId);var Wa=this.Ya.Oh();Wa.buttons.push(this.Ya.Sg(345));Wa.buttons.push(this.Ya.Sg(254));S.vh.push(Wa);Wa=this.Ya.Oh();S.vh.push(Wa);return S}showTimeSlicerContextMenu(S){var Wa=Object(qb.a)(Md.a,S.eventArgs);S=this.FYa(Object(qb.a)(Md.a,S.eventArgs));
Wa=Wa.oh;xa.a.eh=Wa;this.Ft(S,!1,Wa)}zpe(S){return S.Qh.className===gb.a.wNb||1===S.oh}FYa(S){var Wa=ha.f(this.$).ha.$e.yh;let zb=S&&1!==S.oh&&S.clientPoint?S.clientPoint:Sys.UI.DomElement.getLocation(Wa.domElement);if(this.zpe(S)){var hc=this.Bwa();hc&&(S.Qh.className===gb.a.wNb&&(zb=ec.HelperMethods.rPb(S.La)),1===S.oh&&(zb=this.zoomManager.Rfa(Sa.DOMElementExtensions.getLocation(hc.frame))))}else if(S=this.Bwa())S=this.yJd(S.frame),(hc=ec.HelperMethods.cH(this.$.ll,this.$.domElement,ha.f(this.$).rtl,
!1))?(S.x=this.zoomManager.Pn(S.x-hc.x)+hc.x,S.y=this.zoomManager.Pn(S.y-hc.y)+hc.y):R.ULS.sendTraceTag(507807046,0,15,"Cannot get constant pane size."),zb.y+=S.y,zb.x+=S.x;S=this.$.domElement;hc=ha.f(this.$).rtl;Wa=ec.HelperMethods.cH(Wa.fm.domElement,S,hc);zb.y=Math.max(zb.y,Wa.y);zb.x=Math.max(zb.x,Wa.x);return zb}Bwa(){const S=ha.f(this.$).ha.$e.yh;R.ULS.shipAssertTag(507807045,0,!!S);return lg.a(this.$).pJa(S.floatingObject.id)}yJd(S){let Wa=new Sys.UI.Point(S.offsetParent.offsetLeft,S.offsetParent.offsetTop);
var zb=ha.f(this.$);if(!zb)return Wa;const hc=ha.f(this.$).rtl;Wa=ec.HelperMethods.cH(S,this.$.Gw.ownerDocument.body,hc);zb.dwd(Wa);Wa.x=hc?this.$.Gw.clientWidth-Wa.x-S.clientWidth:Wa.x;S=zb.view.Xka;zb=hc?-zb.dZ.Coa(S.x):S.x;Wa.x-=zb;Wa.y-=S.y;return Wa}};Gc.Xte=ea.a.$Yh;Gc.L5a="TimeSlicerContextMenuRootName";Gc=lc=Object(N.__decorate)([Object($b.d)(Ib.pg),Object(N.__param)(0,Object(Ib.Lb)()),Object(N.__param)(1,Object(Ib["if"])()),Object(N.__param)(2,Object(Ib.cb)()),Object(N.__param)(3,Object(Ib.Lg)())],
Gc);Object(M.a)(Gc,"TimeSlicerContextMenu",Y.a,[]);class Cd{constructor(S,Wa,zb){this.type=S;this.UYh=Wa;this.vo=zb}}Object(M.a)(Cd,"TimeSlicerRibbonButtonParameter",null,[]);var Qd;let ge=Qd=class extends Y.a{constructor(S,Wa,zb,hc,cd){super(S,"PopulateTimeSlicerLevelMenu",-227942804,1634477200,Qd.Xte,!0,!1,Qd.L5a,cd,Wa,!1,zb,hc);this.HWa=0;this.xof=this.SYa=this.XFa=null;this.zoom=hc}get vD(){return"PopulateTimeSlicerLevelMenu"}get DH(){return ea.a.Exg}executeCommand(S,Wa,zb){S=Wa.command;switch(S){case 2000085697:S=
zb.DOMElement;this.XFa=zb.ChangeLevelCallback;this.SYa=zb.GetLevelLabelCallback;this.HWa=zb.CurrentLevel;const hc=zb.DomEvent;ka.g(hc);const cd=zb.location;zb=zb.levelLabelText;this.xof=Sa.DOMElementExtensions.uM(document.activeElement,"iframe")&&zb?zb.parentNode:null;zb=Sys.UI.DomElement.getBounds(zb);zb.x=cd.x;zb.y=cd.y;this.Yba(hc,S,zb,Wa,!0);break;case -649826274:this.XFa(0);break;case 149600865:this.XFa(1);break;case -2012435159:this.XFa(2);break;case -1979934975:this.XFa(3);break;case 1634477200:Sa.DOMElementExtensions.setFocus(this.xof);
break;default:return mb.a(S)}return Jc.Task.Va(!0)}ni(S,Wa,zb){S=!1;switch(Wa.command){case 2000085697:S=!!zb;break;case -649826274:case 149600865:case -2012435159:case -1979934975:case 1634477200:S=!0}return S}Yba(S,Wa,zb){S=Sys.UI.DomElement.getBounds(Wa);zb.x=this.zoomManager.Pn(zb.x);zb.y=this.zoomManager.Pn(zb.y);S.x=this.zoomManager.Pn(S.x);S.y=this.zoomManager.Pn(S.y);S=new Sys.UI.Point(S.x+zb.x,S.y+zb.y);this.showContextMenu(new Sys.UI.Bounds(S.x,S.y-zb.height,zb.width,zb.height))}y_(){const S=
this.Ya,Wa=S.Vv(this.menuId),zb=S.Oh();for(let cd=0;3>=cd;cd++){const ta=this.SYa(cd);var hc=Qd.VDi(cd);hc=S.j0h(hc.UYh,hc.vo,this.HWa===cd,Qd.rbf);hc.label=ta;hc.L1(ta);this.HWa===cd?hc.P1("Image16by16",8,Qd.rbf):hc.Loc();zb.buttons.push(hc)}Wa.vh.push(zb);return Wa}static VDi(S){let Wa=null;switch(S){case 0:Wa=new Cd(87,"ContextMenu.TimeSlicerLevelYear",-649826274);break;case 1:Wa=new Cd(88,"ContextMenu.TimeSlicerLevelQuater",149600865);break;case 2:Wa=new Cd(89,"ContextMenu.TimeSlicerLevelMonth",
-2012435159);break;case 3:Wa=new Cd(90,"ContextMenu.TimeSlicerLevelDay",-1979934975)}return Wa}};ge.Xte=ea.a.ZYh;ge.L5a="TimeSlicerLevelMenuRootName";ge.rbf=gb.a.PHa;ge=Qd=Object(N.__decorate)([Object($b.d)(Ib.qg),Object(N.__param)(0,Object(Ib.Lb)()),Object(N.__param)(1,Object(Ib["if"])()),Object(N.__param)(2,Object(Ib.cb)()),Object(N.__param)(3,Object(Ib.Lg)())],ge);Object(M.a)(ge,"TimeSlicerLevelMenu",Y.a,[]);var ye=a(894),$e=a(176),qf=a(391),h=a(4),Z=a(61);class E extends ye.a{constructor(S){super(S)}Qs(){const S=
this.$,Wa=Kb.a.ogb(Z.b(),this.xa,"Task","IRootUser"),zb=$e.a(S);let hc=null;hc=(Nc,Id)=>{zb.iCg(hc);Wa.setResult(Id.cqc)};zb.e1e(hc);zb.SGf();const cd=Object(ma.d)($b.a.resolve(Ib["if"],{va:this.hh})),ta=Object(ma.d)($b.a.resolve(Ib.cb,{va:this.hh})),wb=sa.GetServiceTaskFactory.Bj(this.$.ka,254,255,this.hh),ic=Object(ma.d)($b.a.resolve(Ib.Lg)),Oa=Object(ma.d)($b.a.resolve(Ib.gc,{va:this.hh})),Cb=db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutoFilterItemsAsyncUiMeasurement",!1)?Object(ma.d)($b.a.resolve(Ib.yd,
{va:this.hh})):Jc.Task.Va(null),yc=Ib.we.Ha()?Object(ma.d)($b.a.resolve(Ib.we,{va:this.hh})):Jc.Task.Va(null);ra.TaskExtensions.Ua(ra.TaskExtensions.Ln([Wa.task,cd,ta,ic,Oa,wb,Cb,yc],this.xa),()=>{const Nc=cd.result,Id=Wa.task.result,ke=ta.result,Ie=wb.result,Le=ic.result,wf=Oa.result,Kf=Cb.result,cg=yc.result;db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotPageFilterContextMenuForNativePivotTables",!1)?this.cr([new Xa(S,Nc,ke,Le,Kf,wf,Id),new wc(S,Nc,ke,Le,Id),new ld(S,Nc,ke,Le,
Id),new Ac(S,Nc,ke,Le,Id),new te(S,Nc,ke,Le,cg,Id),new ie(S,Nc,ke,Le,Id),new xb(S,Nc,ke,Le,Id),new Pe.GridContextMenu(S,Nc,ke,Le,wf,Id),new tf(S,Nc,ke,Le,cg,Id),new Gf(S,Nc,ke,Le,Ie,Id),new ge(S,Nc,ke,Le,Id),new Gc(S,Nc,ke,Le,Id),new Ce(S,Nc,ke,Le,Id),new wd(S,Nc,ke,Le,Id),new Fc(S,Nc,ke,Le,Id),new Pa(S,Nc,ke,Le,Id),new of(S,Nc,ke,Le,Id)]):this.cr([new Xa(S,Nc,ke,Le,Kf,wf,Id),new ld(S,Nc,ke,Le,Id),new Ac(S,Nc,ke,Le,Id),new te(S,Nc,ke,Le,cg,Id),new ie(S,Nc,ke,Le,Id),new xb(S,Nc,ke,Le,Id),new Pe.GridContextMenu(S,
Nc,ke,Le,wf,Id),new tf(S,Nc,ke,Le,cg,Id),new Gf(S,Nc,ke,Le,Ie,Id),new ge(S,Nc,ke,Le,Id),new Gc(S,Nc,ke,Le,Id),new Ce(S,Nc,ke,Le,Id),new wd(S,Nc,ke,Le,Id),new Fc(S,Nc,ke,Le,Id),new Pa(S,Nc,ke,Le,Id),new of(S,Nc,ke,Le,Id)])},S.xa,3)}static initData(){const S=qf.a.Nda;S(1851761031,h.a.di|24576,0,0);S(429416385,h.a.di|131072,0,0);S(-741340954,128,128,0);S(2000085697,20479,0,0);S(-227942804,h.a.di|24576,0,0);S(1634477200,h.a.di|131072,0,0);S(-649826274,4095,0,0);S(149600865,4095,0,0);S(-2012435159,4095,
0,0);S(-1979934975,4095,0,0);S(1247109494,h.a.di|24576,0,0);S(-2064931494,h.a.di|131072,0,0);S(-1396319072,h.a.Ea,128,0);db.EwaSettings.GU()&&(S(-397772485,h.a.Ea,0,0),S(-81713080,h.a.Ea,0,0));S(-1253126584,h.a.Ea,0,0);S(274207288,h.a.di|24576,0,0);S(-1497523576,h.a.di|131072,0,0);S(-498523270,h.a.di|24576,64,0);S(1640762262,h.a.di|131072,64,0);S(-2017893763,h.a.di|24576,0,0);S(1350204367,h.a.di|131072,0,0);S(-889576107,h.a.PA,128,0);S(-1170196828,h.a.PA,128,0);S(389774337,h.a.PA,128,0);S(1529312473,
h.a.PA,128,0);S(2033235475,h.a.PA,128,0);S(-96230454,h.a.PA,128,0);S(74086617,h.a.PA,128,0);S(563292088,h.a.PA,128,0);S(-1092351914,h.a.PA,128,0);S(-2141589616,h.a.PA|16384,128,0);S(745182485,h.a.PA,0,0);S(359279088,h.a.PA,128,0);S(-67292059,h.a.PA,128,0);S(926905850,h.a.PA,128,0);S(547535945,h.a.PA,128,0);S(-2108836646,h.a.PA,128,0);S(1374696078,h.a.di|24576,0,0);S(495005930,h.a.di|212992,0,0);S(-1045020714,h.a.di|24576,0,0);S(-170383950,h.a.di|212992,0,0);S(324156914,h.a.Ea,0,0);S(-1085236154,h.a.WD,
0,0);S(-751848458,h.a.Zr|16384,0,0);S(216058793,h.a.WD,0,0);S(474690375,h.a.Zr|16384,0,0);S(-1920954846,h.a.di|24576,0,0);S(723126814,h.a.di|131072,0,0);S(2108047455,128,128,0);S(-231711729,128,128,0);S(-1909381757,128,128,0);S(-814639094,128,128,0);S(1701016594,h.a.di|3072,128,0);S(-1475408662,h.a.di|24576,0,0);S(1114549926,h.a.di|131072,32,0)}static Aa(S){ye.a.sx(10,new E(S))}}Object(M.a)(E,"ContextMenuCommandHandlerFactory",ye.a,[]);var aa=a(420);class Ja extends aa.a{constructor(S){super();this.$=
S;this.Bl()}create(){const S=this.$;var Wa=S.th;if(Wa.allowSelection||Wa.allowEdits||Wa.allowFiltering||Wa.allowSorting||Wa.allowPivotSpecificOperations){let zb;db.EwaSettings.ZSd()?(Wa=db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotPageFilterContextMenuForNativePivotTables",!1)?[$b.a.resolve(Ib.r,{va:this.hh}),$b.a.resolve(Ib.Q,{va:this.hh}),$b.a.resolve(Ib.Yb,{va:this.hh}),$b.a.resolve(Ib.Zb,{va:this.hh}),$b.a.resolve(Ib.cc,{va:this.hh}),$b.a.resolve(Ib.nc,{va:this.hh}),$b.a.resolve(Ib.Yc,
{va:this.hh}),$b.a.resolve(Ib.xe,{va:this.hh}),$b.a.resolve(Ib.ye,{va:this.hh}),$b.a.resolve(Ib.Ff,{va:this.hh}),$b.a.resolve(Ib.qg,{va:this.hh}),$b.a.resolve(Ib.pg,{va:this.hh}),$b.a.resolve(Ib.Te,{va:this.hh}),$b.a.resolve(Ib.s,{va:this.hh}),$b.a.resolve(Ib.ze,{va:this.hh}),$b.a.resolve(Ib.Rf,{va:this.hh}),$b.a.resolve(Ib.jf,{va:this.hh})]:[$b.a.resolve(Ib.r,{va:this.hh}),$b.a.resolve(Ib.Q,{va:this.hh}),$b.a.resolve(Ib.Yb,{va:this.hh}),$b.a.resolve(Ib.Zb,{va:this.hh}),$b.a.resolve(Ib.cc,{va:this.hh}),
$b.a.resolve(Ib.nc,{va:this.hh}),$b.a.resolve(Ib.Yc,{va:this.hh}),$b.a.resolve(Ib.xe,{va:this.hh}),$b.a.resolve(Ib.Ff,{va:this.hh}),$b.a.resolve(Ib.qg,{va:this.hh}),$b.a.resolve(Ib.pg,{va:this.hh}),$b.a.resolve(Ib.Te,{va:this.hh}),$b.a.resolve(Ib.s,{va:this.hh}),$b.a.resolve(Ib.ze,{va:this.hh}),$b.a.resolve(Ib.Rf,{va:this.hh}),$b.a.resolve(Ib.jf,{va:this.hh})],zb=Object(ma.d)(Promise.all(Wa))):zb=sa.GetServiceTaskFactory.create(S.ka,10,S.xa,this.hh);const hc=Object(ma.d)($b.a.resolve(Ib.cb,{va:this.hh}));
ra.TaskExtensions.Ua(ra.TaskExtensions.Ln([zb,hc],this.xa),()=>{this.Yj(Fa.a(S)||new mc(S,zb.result,hc.result))},this.$.xa,3)}else R.ULS.sendTraceTag(537167058,0,15,"ContextMenuManagerFactory.Create: no client permissions to allow creating ConetxtMenuManager. Returning null."),S.ka.Ula(8),this.Yj(null)}static Aa(S){S.ka.ph(9,new Ja(S))}}Object(M.a)(Ja,"ContextMenuManagerFactory",aa.a,[]);var tb=a(9);String(t);window.___1708742448260_closurehack=t;a(586).a.gw(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}div#valueFieldSettingTabs .TabTitlesContainer{border-bottom:solid 1px #c3cbd0}div#valueFieldSettingTabs .TabTitle{text-align:center;cursor:default}div#valueFieldSettingTabs .TabTitleText{display:inline-block}div#valueFieldSettingTabs .TabTitleActive{color:#217346;font-weight:bold}div#valueFieldSettingTabs .TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}div#dataFieldCustomLabel,div#dataFieldSourceLabel{font-weight:600;padding-left:10px}div#summarizeValuesByControlBody{background-color:#fff;padding:10px}.valueFielsSettingsControlTitle{font-weight:bold;border-bottom:1px solid #a2a6ab}div#summarizeValuesByControlBody>.summarizeValuesByControlDescription{font-weight:600}div#summarizeValuesByControlBody>select{width:100%}div#showValueAsControlBody{background-color:#fff;padding:10px}select#showValueAsSelect{width:100%;margin-bottom:5px}select#showValueAsBaseFieldSelect{width:100%}select#showValueAsBaseItemSelect{width:100%;overflow:hidden}div#showValueAsControlBody>.showValueAsControlSelectRegion{width:48%;display:inline-block;position:relative}div#showValueAsControlBody>.showValueAsControlSelectRegionSeparator{width:4%;display:inline-block}.showValueAsControlSelectRegion>div{width:100%}input#valueFieldsSettingsFieldName{width:273px}div#valueFieldSettingTabs{width:380px}");
(()=>{E.initData();tb.a.Qg(S=>{db.EwaSettings.jgj()||E.Aa(S);Ib.db.Ha()||(Ja.Aa(S),mc.Aa(S))})})();String(f);String(r);String(k);String(t);String(m);String(e);String(w);String(l);String(d);String(me);String(Pe);String(u);String(n);String(v);String(B);String(z);String(C);String(D);String(J);String(W);window.___1708742503424_closurehack=f;window.___1708742503424_closurehack=r;window.___1708742503424_closurehack=k;window.___1708742503424_closurehack=t;window.___1708742503424_closurehack=m;window.___1708742503424_closurehack=
e;window.___1708742503424_closurehack=w;window.___1708742503424_closurehack=l;window.___1708742503424_closurehack=d;window.___1708742503424_closurehack=me;window.___1708742503424_closurehack=Pe;window.___1708742503424_closurehack=u;window.___1708742503424_closurehack=n;window.___1708742503424_closurehack=v;window.___1708742503424_closurehack=B;window.___1708742503424_closurehack=z;window.___1708742503424_closurehack=C;window.___1708742503424_closurehack=D;window.___1708742503424_closurehack=J;window.___1708742503424_closurehack=
W},909:function(y,x,a){a.d(x,"a",function(){return Fa});y=a(0);var c=a(2),b=a(14),f=a(482),r=a(96),d=a(424),k=a(285),t=a(680),m=a(657),e=a(94),w=a(242),l=a(42),u=a(888),n=a(6);class v{static b$f(za,xa){var fa;if((null===(fa=n.AFrameworkApplication.fa)||void 0===fa?0:fa.isChangeGateEnabled("OfficeVSO:8619896_lightMemoizeVersion"))&&void 0===xa)return v.wDj(za);const V=new u.a(xa);return ba=>{let la;try{let Ta=V.gj(ba,null);({value:la}=Ta);if(Ta.returnValue)return la}catch(Ta){b.ULS.sendTraceTag(539890393,
344,10,"FuncExtensions memoize crash, dictionary length: {0}, error message: {1}",V.count,Ta.message)}la=za(ba);V.add(ba,la);return la}}static wDj(za){const xa=new Map;return fa=>{if(xa.has(fa))return xa.get(fa);const V=za(fa);xa.set(fa,V);return V}}}Object(y.a)(v,"FuncExtensions",null,[]);var B=a(353),z=a(1532);x=a(641);var C=a(80),D=a(19),J=a(7),W=a(938),N=a(69),M=a(45),Q=a(63),R=a(161),O=a(137),U=a(1),K=a(13),F=a(27),I=a(12),P=a(24),Y=a(988),ea=a(5),Ba=a(97);class Fa extends C.a{constructor(za,
xa,fa,V,ba,la,Ta,Ea,sa,Ya,bb,ra,Da){super();this.PKc=!1;this.D6c=this.B9c=this.WJ=null;this.bUd=!1;this.jUc=this.nMb=null;this.Nxe=!1;this.xI=()=>{this.WJ?this.WJ.xI():b.ULS.sendTraceTag(537167068,0,10,"ContextMenuBase.DismissFloatie: the context menu controller is null when attempintg to dismiss floatie on KeyDown.");this.U0g()};this.fh=za;this.zoom=Da;this.h$f=ba;this.Agd=Ya;this.esg=la;this.populateOnlyOnce=Ta;this.R3i=bb;this.zee(ra)}get zoomManager(){return this.zoom.zoomManager}get XJ(){return this.jUc}get $(){return this.fh}get Ya(){return this.Agd}get menuId(){return this.$.$h+
this.h$f}get HOb(){this.B9c||(this.B9c=O.a(this.$));return this.B9c}get PIb(){this.D6c||(this.D6c=P.f(this.$).sh);return this.D6c}Bi(za,xa){za=!0;switch(xa){case 1651433993:case 1675506831:case 966232027:za=this.Hj(4096)||this.Hj(2048);break;case 2045563128:za=this.Hj(4096);break;case 912277356:case 2123758504:case -32628781:case -1793121409:case 1378457149:za=this.Hj(8192)}return!za}Ji(za,xa,fa){fa.IsShadowMenuOpen||W.m(this.$,W.e);za=!1;xa===this.vD&&(fa.IsShadowMenuOpen||W.m(this.$,W.a),xa=Object(c.a)(new f.a,
{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]}),this.WPc(xa,fa.IsShadowMenuOpen),fa.MenuItems=xa,fa.IsShadowMenuOpen||W.m(this.$,W.c),za=!0);za&&this.PKc&&K.HelperMethods.cnc&&!fa.IsShadowMenuOpen&&W.o(this.$);return za}WPc(za,xa){(xa=this.y_(xa))?(this.VPf(xa),za.MenuSectionList.push(...xa.ML().MenuSectionList),this.Bvh(za)):b.ULS.sendTraceTag(537167105,0,10,"ContextMenuBase.PopulateContextMenuProps: CreateRibbonMenu() returned null instead of RibbonMenu instance")}y_(){b.ULS.sendTraceTag(537167104,
0,10,"ContextMenuBase.CreateRibbonMenu: This method should not be called if the menu is not ready for React!");return null}Yba(za,xa,fa,V,ba){za=Sys.UI.DomElement.getBounds(xa);xa=new Sys.UI.Point(za.x,za.y+za.height);this.$.isChromeRtl&&(xa.x+=za.width);this.Ft(xa,ba)}Ft(za,xa,fa,V){fa=void 0===fa?0:fa;V=void 0===V?!1:V;xa&&(za=this.zoomManager.Rfa(za));xa=!0;if(this.R3i)if(3===fa)(V=this.KYa(3))&&0<V.length?(xa=!1,this.showFloatie(V,new Sys.UI.Bounds(za.x,za.y,0,0),fa)):b.ULS.sendTraceTag(537167075,
0,10,`ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the touch floatie groups. Context menu ID: ${this.menuId}`);else if(2===fa){const ba=U.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ProactiveColumnControls",!1);ba&&V&&(xa=!1);this.$.isEditMode&&((V=this.KYa(2,V))&&0<V.length?ba&&V[0]===Y.a.ldf&&V[1]===Y.a.nLf?this.showFloatie(V,new Sys.UI.Bounds(za.x,za.y,0,0),fa):V[0]!==Fa.Jxf?(xa=!1,this.aqe(V,new Sys.UI.Bounds(za.x,za.y,0,0),fa)):
b.ULS.sendTraceTag(537167074,0,50,`ContextMenuBase.ShowAt: The context menu does not support floatie. Context menu ID: ${this.menuId}`):b.ULS.sendTraceTag(537167073,0,10,`ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the mouse floatie groups. Context menu ID: ${this.menuId}`))}xa&&this.showContextMenu(new Sys.UI.Bounds(za.x,za.y,0,0),fa)}KYa(){return null}nLd(za,xa){let fa="";3===za?fa="touch":2===za&&(fa="mouse");return{["IsEditMode"]:this.$.isEditMode,
["IsSLR"]:!!Q.a.Al&&Q.a.Al.MU,["IsReactMLR"]:!!Q.a.Al&&Q.a.Al.U5,["IsNov"]:this.$.ea.isNamedObjectViewMode,["InputType"]:fa,["FloatieGroups"]:JSON.stringify(void 0===xa?null:xa)}}showContextMenu(za,xa){xa=void 0===xa?0:xa;const fa=this.nLd(xa);b.ULS.sendTraceTag(595359709,0,50,`ContextMenuBase.ShowContextMenu: rendering a context menu with given arguments: ${JSON.stringify(fa)}`);this.WJ?this.DH!==J.a.ode&&this.DH!==J.a.pde||0===xa?this.WJ.$pe(this.DH,za,N.a.eh):this.WJ.$pe(this.DH,za,xa):b.ULS.sendTraceTag(537167072,
0,10,"ContextMenuBase.ShowContextMenu: the context menu controller is null when attempintg to show context menu.")}showFloatie(za,xa,fa){const V=this.nLd(fa,za);b.ULS.sendTraceTag(595359710,0,50,`ContextMenuBase.ShowFloatie: rendering a floatie with given arguments: ${JSON.stringify(V)}`);this.WJ?(this.szg(),this.WJ.K6b(za,xa,fa)):(za=JSON.stringify(za),b.ULS.sendTraceTag(537167071,0,10,`ContextMenuBase.ShowFloatie: the context menu controller is null when attempting to show the floatie with floatieGroups ${za}.`))}aqe(za,
xa,fa){var V=this.nLd(fa,za);V=JSON.stringify(V);b.ULS.sendTraceTag(537167070,0,50,`ContextMenuBase.ShowContextMenuWithFloatie: rendering a floatie with given arguments: ${V}`);this.WJ?(this.szg(),this.WJ.Zpe(za,xa,fa,this.DH)):b.ULS.sendTraceTag(587335491,0,10,"ContextMenuBase.ShowContextMenuWithFloatie: the context menu controller is null when attempintg to show floatie with ContextMenu.")}zee(za){this.WJ=za}dispose(){this.$&&this.$.Ma.ctb(this);this.fh=null;this.U0g();this.jUc&&(r.a.Ng(this.jUc),
this.jUc=null);super.dispose()}xzi(za){var xa=this.$.ka.Ug(204);xa&&(xa=xa.kAi(this.h$f))&&za.vh.push(xa)}Hj(za){return(new R.a(this.$.sa)).Hj(za)}VPf(za){for(const xa of za.vh)if(Object(B.a)(418,xa)){za=xa;za.title&&(za.title=this.Nxe?Fa.Hyd(za.title):Fa.zm(za.title));for(const fa of za.buttons)Object(B.a)(236,fa)?(za=fa,this.Nxe?(za.label=Fa.Hyd(za.label),za.L1(Fa.Hyd(za.alt))):(za.label=Fa.zm(za.label),za.L1(Fa.zm(za.alt)))):Object(B.a)(419,fa)&&this.VPf(fa.menu)}}e$f(za,xa){xa=void 0===xa?!1:
xa;const fa=[];for(const V of za)fa.push(this.z_(V,xa));return fa}z_(za){const xa=[];for(const fa of za.MenuItems)switch(fa.Type){case 3:xa.push(this.V0h(fa));break;case 2:xa.push(this.G6h(fa));break;case 1:xa.push(this.q2h(fa))}return Object(c.a)(new d.a,{ControlList:xa,Title:za.Title,DisplayMode:"Menu16",MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0})}YGd(za,xa){xa=[this.nMb,za.RibbonCommand.toString(),xa?this.BEf(xa):this.BEf(za.Label),za.Disabled?za.Disabled.toString():
"False"];let fa=za.CommandData;fa=F.a.hashCode(fa).toString();xa.push(fa,za.Identifier.toString());xa=xa.join("_");za.IsChecked&&(xa+="_Checked");return xa}lAi(za){const xa=[this.nMb,F.a.hashCode(za.Title).toString()];for(const fa of za.MenuItems)xa.push(fa.RibbonCommand.toString());return xa.join("_")}Tzf(za){var xa=za.Label;xa=F.a.hashCode(xa).toString();xa=[this.nMb,xa];U.EwaSettings.isChangeGateEnabled("OfficeVSO:5139850_FixPivotFilterMenuDuplicatingIdenticalFields")&&za.Id&&xa.push(F.a.hashCode(za.Id).toString());
xa=xa.join("_");za.IsChecked&&(xa+="_Checked");return xa}V0h(za){const {label:xa,VZa:fa,vo:V}=this.oxc(za,!1),ba=this.YGd(za,xa);return Object(c.a)(new k.a,{Command:za.Disabled?(-251203935).toString():V.toString(),ExternalId:ba,Id:ba,Image16by16Class:fa,LabelText:xa||za.Label,MenuItemId:za.CommandData,CommandValueId:za.CommandData})}G6h(za){const {label:xa,VZa:fa,vo:V}=this.oxc(za,za.IsChecked),ba=this.YGd(za,xa);return Object(c.a)(new t.a,{Command:za.Disabled?(-251203935).toString():V.toString(),
ExternalId:ba,Id:ba,Image16by16Class:fa,LabelText:xa||za.Label,MenuItemId:za.CommandData,CommandValueId:za.CommandData,IsChecked:za.IsChecked})}q2h(za){const {label:xa,VZa:fa}=this.hAf(za),V=Object(c.a)(new f.a,{MenuSectionList:[],UpdateDynamically:!0});V.MenuSectionList.push(...this.e$f(za.SubMenu.Sections,!0));const ba=this.Tzf(za);za=xa||za.Label;return Object(c.a)(new m.a,{ExternalId:ba,Id:ba,LabelText:za,PopulateOnlyOnce:!1,Menu:V,Image16by16Class:fa,ImageIsVisible:!!fa})}hAf(za){const {label:xa,
VZa:fa,vo:V}=this.oxc(za,!0);return{label:xa,VZa:fa,vo:V}}oxc(za,xa){let fa;switch(za.Identifier){case 26:fa=912804500;xa=D.a.Dtf;za=I.a.instance.ia(1951);break;case 3:fa=-1902148570;xa=xa?D.a.hma:null;za=I.a.instance.ia(1911);break;case 4:fa=-1902148570;xa=xa?D.a.hma:null;za=I.a.instance.ia(1912);break;case 5:fa=-1902148570;xa=xa?D.a.hma:null;za=null;break;case 1:fa=-1677817820;xa=D.a.dvc;za=I.a.instance.ia(233);break;case 2:fa=-1649376918;xa=za.IsChecked?D.a.PHa:null;za=I.a.instance.ia(2122);break;
case 23:fa=1701016594;xa=za.IsChecked?D.a.PHa:null;za=I.a.instance.ia(2122);break;case 6:fa=-87741481;xa=null;za=I.a.instance.ia(2123);break;case 7:fa=1948650742;xa=D.a.tsf;za=I.a.instance.ia(1949);break;case 8:fa=1933713114;xa=D.a.ssf;za=I.a.instance.ia(1950);break;case 14:fa=504133448;xa=D.a.BXa;za=I.a.instance.ia(144);break;case 30:fa=504133448;xa=D.a.BXa;za=I.a.instance.Ba(744);break;case 32:fa=504133448;xa=D.a.BXa;za=I.a.instance.ia(148);break;case 34:fa=504133448;xa=D.a.BXa;za=I.a.instance.ia(150);
break;case 27:fa=1701016594;xa=xa?D.a.gvc:D.a.BXa;za=I.a.instance.ia(144);break;case 15:fa=-798968736;xa=D.a.CXa;za=I.a.instance.ia(146);break;case 31:fa=-798968736;xa=D.a.CXa;za=I.a.instance.Ba(745);break;case 33:fa=-798968736;xa=D.a.CXa;za=I.a.instance.ia(149);break;case 35:fa=-798968736;xa=D.a.CXa;za=I.a.instance.ia(151);break;case 28:fa=1701016594;xa=xa?D.a.hvc:D.a.CXa;za=I.a.instance.ia(146);break;case 21:fa=-2058042992;xa=D.a.Xhb;za=null;break;case 29:fa=1701016594;xa=D.a.Xhb;za=null;break;
case 9:fa=1701016594;za=xa=null;break;case 11:fa=-1494291901;za=xa=null;break;case 25:fa=-1045020714;xa=za.IsChecked?D.a.PHa:null;za=null;break;case 13:fa=1701016594;xa=za.IsChecked?D.a.PHa:null;za=I.a.instance.ia(153);break;case 16:fa=1701016594;xa=D.a.Vuc;za=I.a.instance.ia(1082);break;case 17:fa=1701016594;xa=D.a.Whb;za=null;break;case 18:fa=1701016594;xa=D.a.Vhb;za=null;break;case 19:fa=1701016594;xa=D.a.Wuc;za=I.a.instance.ia(1087);break;case 20:fa=1701016594;xa=D.a.ECd;za=I.a.instance.ia(1088);
break;case 24:fa=1675506831;za=xa=null;break;case 22:fa=za.RibbonCommand;xa=za.IsChecked?D.a.hma:null;za=null;break;case 36:fa=1461300262;xa=null;za=I.a.instance.ia(152);break;case 38:fa=za.RibbonCommand;xa=D.a.XCd;za=I.a.instance.ia(1822);break;case 37:fa=1461300262;xa=null;za=I.a.instance.ia(155);break;default:b.ULS.shipAssertTag(537167069,0,!1,`Unable to map menu item: ${JSON.stringify(za)}`),fa=1461300262,za=xa=null}return{label:za,VZa:xa,vo:fa}}BEf(za){return F.a.hashCode(za+K.HelperMethods.Txk).toString()}Bvh(za){if(!this.$.ea.e_){var xa=
ea.Ie.Ha()?Ba.a.Zg(ea.Ie):this.$.ka.Ug(25);if(xa&&!e.a.isEmpty(xa.aja)&&(xa=xa.wYi(),!w.a.qm(xa))){var fa=[];l.a.instance.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder").$4h(xa,fa);za.MenuSectionList.push(...fa)}}}szg(){this.bUd||(this.HOb&&this.HOb.ykc(this.xI),this.PIb&&this.PIb.ykc(this.xI),this.bUd=!!this.HOb||!!this.PIb)}U0g(){this.HOb&&this.HOb.KSc(this.xI);this.PIb&&this.PIb.KSc(this.xI);this.bUd=!1}static Qxc(za,xa,fa){xa=M.F(xa);za=P.f(za);return fa?za.uib(xa.left):za.za.Gma(xa)}static YSd(za,
xa){xa=M.F(xa);za=P.f(za).za.Gma(xa);return!(null===za||void 0===za||!za.Fp)}static vEc(za,xa){return xa?!!za:!(null===za||void 0===za||!za.Fp)}static nId(za,xa,fa){xa=M.F(xa);var V=P.f(za).za.Gma(xa);xa=P.f(za).getCellBounds(V);const ba=V.bqd;V=V.Ypd;let la=xa.x+ba.x;xa=xa.y+ba.y;fa&&U.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")&&(P.f(za).rtl||(la+=V),xa-=V);return new Sys.UI.Point(la,xa)}static myc(za,xa,fa,V){if(xa){var ba=P.f(za);V=V?ba.JJd(xa):ba.getCellBounds(xa);
ba=xa.bqd;xa=xa.Ypd;var la=V.x+ba.x;V=V.y+ba.y;fa&&U.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")&&(P.f(za).rtl||(la+=xa),V-=xa);return new Sys.UI.Point(la,V)}b.ULS.sendTraceTag(509220164,0,15,`ContextMenuBase.getContextMenuCoordinates:\u00a0cellProxy is undefined, isHeaderCommandData=${V}`)}static Wuf(za){try{Object(z.a)(za.CommandValueId)}catch(xa){}}static zm(za){const xa=Fa.ihb.parseFromString(za,"text/html");return xa?xa.body.innerText:(b.ULS.sendTraceTag(537167066,
0,15,"Not able to decode htmlFormattedText"),za)}}Fa.ihb=new DOMParser;Fa.Jxf="Unsupported";Fa.Hyd=U.EwaSettings.isChangeGateEnabled("OfficeVSO:8619896_lightMemoizeVersion")?v.b$f(Fa.zm):v.b$f(Fa.zm,new x.a(!1));Object(y.a)(Fa,"ContextMenuBase",C.a,[39,420,2])},938:function(y,x,a){function c(M,Q){if(!e.EwaSettings.MYf())return!1;M=m.f(M);return M&&Q&&-1!==Q.top?(M=M.EYa())?M.contains(Q):!1:!1}a.d(x,"d",function(){return"ContextMenuEventStartMark"});a.d(x,"n",function(){return"ContextMenuPerf.A"});
a.d(x,"b",function(){return"ContextMenuPerf.B"});a.d(x,"e",function(){return"ContextMenuPerf.C1"});a.d(x,"a",function(){return"ContextMenuPerf.C2"});a.d(x,"c",function(){return"ContextMenuPerf.D"});a.d(x,"h",function(){return w});a.d(x,"g",function(){return u});a.d(x,"j",function(){return n});a.d(x,"i",function(){return v});a.d(x,"f",function(){return B});a.d(x,"k",function(){return C});a.d(x,"l",function(){return D});a.d(x,"m",function(){return J});a.d(x,"o",function(){return W});a.d(x,"p",function(){return c});
var b=a(14),f=a(483),r=a(10),d=a(71),k=a(26),t=a(13),m=a(24),e=a(1);const w=(M,Q)=>{var R=M.kh(null);if((null===R||void 0===R?0:R.cell.Fp)&&l(R,M,Q))return M.getCellBounds(R.cell);R=M.ha.qa.activeCell;return(Q=z(new k.Range(R.top,R.left,r.a.gl,R.left,!1,!1),2,!0,M,Q)||z(new k.Range(1,R.left,R.top,R.left,!1,!1),2,!1,M,Q)||z(new k.Range(R.top,R.right,R.top,r.a.Qk,!1,!1),1,!0,M,Q)||z(new k.Range(R.top,1,R.top,R.right,!1,!1),1,!1,M,Q)||null)&&Q.Fp?M.getCellBounds(Q):Sys.UI.DomElement.getBounds(M.hga.Pi)},
l=(M,Q,R)=>{var O=Q.rtl,U=R.isChromeRtl;M=M.cell;return(R=m.f(R).oU(M))?(R=R.topLeft,O=R.x+=O===U?M.offsetWidth:0,U=R.y+=M.offsetHeight,Q.view.visibleArea.contains(new d.a(O,U,0,0))):!1},u=M=>{let Q=0;for(const R of M)M=R.right-R.left+1,Q+=0<M?M:-1*M;return Q},n=M=>{const Q=null===M||void 0===M?void 0:M.length;M.sort();if(1<v(M)){if(M[Q-1].top-M[0].top+1===Q)return k.Range.uT(M[0].top.toString(),!1)+" - "+k.Range.uT(M[Q-1].top.toString(),!1)}else return k.Range.uT(M[0].top.toString(),!1);return""},
v=M=>{let Q=0;for(const R of M)Q+=R.bottom-R.top+1;return Q},B=M=>{const Q=null===M||void 0===M?void 0:M.length;M.sort();if(1<u(M)){if(M[Q-1].right-M[0].left+1===Q)return k.Range.uT(k.Range.OT(M[0].left),!1)+" - "+k.Range.uT(k.Range.OT(M[Q-1].right),!1)}else return k.Range.uT(k.Range.OT(M[0].left),!1);return""},z=(M,Q,R,O,U)=>{M=O.ot("ContextMenuHelper.FindFirstCellInViewportArea",M,Q,R);try{for(M.$$rst();M.$$mn();){const K=M.$$cu();if(K&&l(K,O,U))return K.cell}}finally{M&&M.dispose()}return null},
C=M=>M.Yg.aY(M.ha.qa.activeCell),D=M=>{M=m.f(M).ha.qa;return M.Gn&&(M.Ui.isRow||M.Ui.fk)},J=(M,Q)=>{t.HelperMethods.drd&&window.performance.mark(Q)},W=()=>{if(f.a.aVa){const M=e.EwaSettings.isChangeGateEnabled("OfficeVSO:8690935_CMServiceInitMarkerEnabled")?N("CMServiceInit","ContextMenuEventStartMark","ContextMenuPerf.A"):-1,Q=N("OnContextMenuHandling","ContextMenuPerf.A","ContextMenuPerf.B"),R=N("PrepInfraWork","ContextMenuPerf.B","ContextMenuPerf.C1"),O=N("EWAPopulation","ContextMenuPerf.C2","ContextMenuPerf.D");
b.ULS.sendTraceTag(537167064,0,50,`ContextMenuHelper.ReportPerformanceIfSupported: ContextMenuServiceInit: [${M}], OnContextMenuHandling=[${Q}], PrepInfraWork=[${R}], EWAPopulation =[${O}]`)}},N=(M,Q,R)=>{window.performance.measure(M,Q,R);Q=window.performance.getEntriesByName(M);Q.length||b.ULS.sendTraceTag(537167063,0,10,`ContextMenuHelper.MeasureTime: measure name [${M}] returned no measures.`);return Q[Q.length-1]?Q[Q.length-1].duration:-1}},988:function(y,x,a){a.d(x,"a",function(){return c});
y=a(0);class c{}c.edit="Edit";c.clipboard="Clipboard";c.copy="Copy";c.color="Color";c.xEj="MobileModeColor";c.yHh="AutoFill";c.Drk="RowOperations";c.FVh="ColumnOperations";c.zEj="MobileModeRowOperations";c.yEj="MobileModeColumnOperations";c.N$k="ViewModeRowOperations";c.M$k="ViewModeColumnOperations";c.hyperlink="Hyperlink";c.openHyperlink="OpenHyperlink";c.hFk="ShapeStyle";c.Uvi="FloatingObjectClipboard";c.Y$d="PivotTableCopyDelete";c.Z$d="PivotTableFieldListActions";c.Lsd="CellFloatie";c.jRh="CellRangeFloatie";
c.kRh="CellTableFloatie";c.zrk="RowColumnFloatie";c.eFk="ShapeFloatie";c.contextMenu="ContextMenu";c.OZi="GridContextMenu";c.b3j="PivotTableContextMenu";c.Vvi="FloatingObjectContextMenu";c.KRh="ChartContextMenu";c.iRh="CellRTEFloatie";c.qOg="ShapeRTEFloatie";c.ldf="ColumnFloatie";c.nLf="GridContextMenuColumnFloatie";Object(y.a)(c,"FloatieGroupIdentifiers",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.ctxm.js.map/1c48e21b8c2a02009c9bbdffa33f5544/EwaTS.ctxm.js.map