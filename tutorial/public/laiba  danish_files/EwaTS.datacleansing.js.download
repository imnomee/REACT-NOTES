'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[18],{434:function(y,x,a){function c(fc){var {level:vc,methodName:Tc,message:Bd,Wrl:Fd="Table",rhl:le=0,dataFields:dc={},wu:Uc="OnDemand",fields:kb={}}=fc,rb;fc=Object.assign({},dc);fc.Method=Tc;fc.Message=Bd;null!==(rb=fc.SuggestionType)&&void 0!==rb?rb:fc.SuggestionType=Fd;fc.MetadataType=Uc;fc.Fields=kb;rb=db.a.li(fc);switch(vc){case 50:J.ULS.sendTraceTag(509752733,le,50,rb);break;case 15:J.ULS.sendTraceTag(509752732,
le,15,rb);break;case 10:J.ULS.sendTraceTag(509752731,le,10,rb)}}function b(fc){return`Microsoft.Office.Excel.SmartView.${fc}`}function f(fc){return`XLS-SmartView-${fc}-Treatment;XLS-SmartView-${fc}-Control`}a.r(x);var r={};a.r(r);a.d(r,"DataCleansingCommandHandler",function(){return D});var d={};a.r(d);a.d(d,"DataCleansingPaneManager",function(){return Y});var k={};a.r(k);a.d(k,"ExcelIntelligenceCalloutManager",function(){return V});var t={};a.r(t);a.d(t,"IntelligentMetadataOverlayManager",function(){return pc});
var m={};a.r(m);a.d(m,"ProactiveSuggestionCard",function(){return nb});var e={};a.r(e);a.d(e,"RecognizedTableGridHighlighter",function(){return na});var w={};a.r(w);a.d(w,"LAUNCH_SOURCE_BY_FLAGS",function(){return ya});a.d(w,"TableSuggestionManager",function(){return sb});var l=a(179),u=a(0),n=a(1),v=a(209),B=a(66),z=a(97),C=a(5);let D=class{constructor(fc,vc){this.$=fc;this.G0j=vc}Bi(){return!1}executeCommand(fc,vc){fc=!0;switch(vc.command){case -1190551534:void this.G0j.q4h();break;default:fc=!1}return fc?
B.Task.Va(!0):v.a(vc.command)}ni(fc,vc){return-1190551534===vc.command&&n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPane",!1)&&!(n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInEditMode",!1)&&this.$.isMobileMode)}Ji(){return!1}};D=Object(l.__decorate)([Object(z.d)(C.lb),Object(l.__param)(0,Object(C.Lb)()),Object(l.__param)(1,Object(C.nb)())],D);Object(u.a)(D,"DataCleansingCommandHandler",null,[39]);var J=a(14),W=a(1406),N=a(181),M=a(12),Q=a(2);
class R{constructor(fc){this.type="DataCleansingStatefulTaskPaneProps";this.annotations=[];this.hostAppCallbacks=fc}}Object(u.a)(R,"TaskpaneProps",null,[751]);var O=a(986),U=a(25),K=a(38);class F extends K.a{byh(fc){this.addHandler(F.$Ae,fc)}ayh(fc){this.addHandler(F.ZAe,fc)}constructor(fc,vc,Tc){super();this.Xi=fc;this.taskPaneManager=Tc;this.aVb=!1;this.jJ=Object(Q.a)(new W.a,{width:330,title:M.a.instance.ia(1303),enableResize:!0,minResizeWidth:250,maxResizeWidth:400,onOpen:Bd=>{Bd.addEventListener("keydown",
this.onKeyDown);this.aVb=!0;J.ULS.sendTraceTag(510247821,0,20,"DataCleansingTaskpane.onOpen");this.raiseEvent(F.$Ae,{})},onClose:Bd=>{Bd.removeEventListener("keydown",this.onKeyDown);this.aVb=!1;Object(O.d)(this.Xi);J.ULS.sendTraceTag(510247820,0,20,"DataCleansingTaskpane.onClose");this.raiseEvent(F.ZAe,{})},onHide:()=>{this.aVb=!1;J.ULS.sendTraceTag(510247819,0,20,"DataCleansingTaskpane.onHide")},onShow:()=>{this.aVb=!0;J.ULS.sendTraceTag(510247818,0,20,"DataCleansingTaskpane.onShow")}});this.onKeyDown=
Bd=>{const Fd=this.Xi.ea;switch(this.Xi.shortcutKeyManager.dD(new Sys.UI.DomEvent(Bd))){case -1502853784:switch(Bd.stopPropagation(),Fd.LPa){case 1:J.ULS.sendTraceTag(508966177,0,50,"DataCleansingTaskpane.onKeyDown: Undo command triggered");void Object(O.e)(this.Xi,1);break;default:J.ULS.sendTraceTag(508966176,0,50,`DataCleansingTaskpane.onKeyDown: Undo command skipped, state is ${Fd.LPa}`)}}};this.jJ.contentProps=new R(vc)}vWc(fc){Object.assign(this.jJ.contentProps,fc);void this.render()}render(){const fc=
this;return No(function*(){if(fc.aVb)if(U.a.ut())fc.taskPaneManager.updateTaskPane("DataCleansingStatefulTaskPane",fc.jJ),fc.taskPaneManager.setSelectedTaskPane("DataCleansingStatefulTaskPane");else{const vc=yield N.a.Go();vc.updateTaskPane("DataCleansingStatefulTaskPane",fc.jJ);vc.setSelectedTaskPane("DataCleansingStatefulTaskPane")}})}show(){const fc=this;return No(function*(){U.a.ut()?fc.taskPaneManager.hS("DataCleansingStatefulTaskPane",fc.jJ):(yield N.a.Go()).showTaskPane("DataCleansingStatefulTaskPane",
fc.jJ)})}hide(){const fc=this;return No(function*(){U.a.ut()?fc.taskPaneManager.hideTaskPane("DataCleansingStatefulTaskPane"):(yield N.a.Go()).hideTaskPane("DataCleansingStatefulTaskPane",fc.jJ.location)})}}F.$Ae="dctoek";F.ZAe="dctcek";Object(u.a)(F,"DataCleansingTaskpane",K.a,[]);var I=a(925),P=a(1190);let Y=class{constructor(fc,vc,Tc){this.$=fc;this.Ttj=vc;this.Vtj=Tc;this.vig=(Bd,Fd)=>{var le;null===(le=this.VGa)||void 0===le?void 0:le.vWc(Fd)};this.Li=(Bd,Fd)=>{({Hl:Bd}=Fd);!Bd&&this.VGa&&(void this.VGa.hide(),
J.ULS.sendTraceTag(507860748,0,50,"DataCleansingPaneManager.onWorkbookClosing"))};this.$.Lp(this.Li)}q4h(){const fc=this;return No(function*(){yield fc.showTaskPane();J.ULS.sendTraceTag(509383055,0,20,'DataCleansingPaneManager.showTaskPane: Show task pane"\n        }');n.EwaSettings.isChangeGateEnabled("OfficeVSO:8749328_SendCrucialOtelEvents")&&Object(I.b)(Object(P.b)())})}dispose(){var fc;null===(fc=this.Xua)||void 0===fc?void 0:fc.ACg(this.vig)}showTaskPane(){const fc=this;return No(function*(){const [vc]=
yield Promise.all([fc.gWi(),fc.R8d()]);yield vc.show()})}R8d(){const fc=this;return No(function*(){yield fc.XCc();n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingDiscoverabilityRefactor",!1)?fc.Xua.R8d():fc.Xua.bmf()})}XCc(){const fc=this;return No(function*(){fc.Xua||(fc.Xua=yield fc.Ttj(0))})}kNj(){const fc=this;return No(function*(){yield fc.XCc();fc.Xua.HUk()})}jNj(){const fc=this;return No(function*(){yield fc.XCc();fc.Xua.DUk()})}gWi(){const fc=this;return No(function*(){if(!fc.VGa){yield fc.XCc();
const vc=U.a.ut()?yield fc.Vtj(0):null;fc.VGa=new F(fc.$,fc.Xua.JDh,vc);fc.VGa.vWc(fc.Xua.state);fc.Xua.Mkc(fc.vig);fc.VGa.byh(()=>fc.kNj());fc.VGa.ayh(()=>fc.jNj())}return fc.VGa})}};Y=Object(l.__decorate)([Object(z.d)(C.nb),Object(l.__param)(0,Object(C.Lb)()),Object(l.__param)(1,Object(C.mb)({k6:!0})),Object(l.__param)(2,Object(C.We)({k6:!0}))],Y);Object(u.a)(Y,"DataCleansingPaneManager",null,[]);var ea=a(42),Ba=a(1018),Fa=a(279);class za extends Ba.a{constructor(fc){super(fc,za.featureName)}get Hk(){return Fa.a.Eqi}show(fc,
vc,Tc,Bd){this.Uvb(void 0===fc?null:fc,Fd=>{appChrome.renderExcelIntelligenceSuggestionCard(this.domElement,Fd.y,Fd.x,Fd.y+Fd.height,Fd.x+Fd.width,vc,Tc,Bd,this.avb)})}}Object(u.a)(za,"ExcelIntelligenceUIControl",Ba.a,[740]);var xa=a(24),fa=a(765);let V=class{constructor(fc,vc,Tc){this.GXa=this.IZc=this.agaveCommandManager=null;this.Fqi=n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelIntelligenceUsesLPP",!1);this.S9e=0;this.zCj=n.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MaxExcelIntelligenceCalloutShownCount",
5);this.H$f=n.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MininumTableRowsForExcelIntelligenceCallout",4);this.tj=()=>{this.tLk()};this.p0i=(Bd,Fd)=>{J.ULS.sendTraceTag(509633888,306,50,"handleExcelIntelligenceActivationCallback callback invoked");if(!Fd)return J.ULS.sendTraceTag(509633887,306,10,"handleExcelIntelligenceActivationCallback surveyParams is null"),null;if(!Fd.contextInfo||!Fd.contextInfo.length||1<Fd.contextInfo.length)return J.ULS.sendTraceTag(509633886,306,10,"handleExcelIntelligenceActivationCallback no valid contextInfo in surveyParams"),
null;this.GXa.show(Fd.contextInfo[0].context,()=>this.Cdg(),()=>this.onIgnore(),()=>this.aba());return null};this.$=fc;this.da=Object(xa.f)(fc);this.agaveCommandManager=vc;this.GXa=null!==Tc&&void 0!==Tc?Tc:new za(this.$);this.da.ha.Cw(this.tj);this.Fqi&&(this.IZc=this.iek())}iek(){const fc=ea.a.instance.Qi("Common.ISystemInitiatedFeedback");fc?fc.execute(vc=>{vc.r2b("ExcelIntelligenceHandRaiseSurface",this.p0i)}):J.ULS.sendTraceTag(509618381,306,10,"registerExcelIntelligenceLPPCallback failed, ISystemInitiatedFeedback is null");
return fc}dispose(){this.da.ha.$w(this.tj)}tLk(){const fc=this.da.ha.qa.activeCell;this.GXa.hide();this.hJk(fc)&&(null!=this.IZc?this.IZc.execute(vc=>{vc.logActivity("ExcelIntelligenceHandRaiseActivity",null,fc)}):(this.S9e++,this.GXa.show(fc,()=>this.Cdg(),()=>this.onIgnore(),()=>this.aba())))}hJk(fc){var vc;return(null===(vc=this.agaveCommandManager)||void 0===vc?0:vc.$jj())?!1:!this.IZc&&this.S9e>=this.zCj?(J.ULS.sendTraceTag(509618380,306,50,"ExcelIntelligence callout not shown as limit has been reached"),
!1):null!=this.da.Yg.qMd(fc,this.H$f)}Cdg(){J.ULS.sendTraceTag(509659226,1,50,"ExcelIntelligenceSuggestionCard Applied");const fc={SourceControlId:"AnalyzeDataExcelIntelligenceHandRaise",tableName:this.da.Yg.qMd(this.da.ha.qa.activeCell,this.H$f).name};this.$.ei(-167264441,0,0,fc).continueWith(()=>{this.GXa.hide()})}onIgnore(){this.GXa.hide();J.ULS.sendTraceTag(509659225,1,50,"ExcelIntelligenceSuggestionCard Ignored")}aba(){this.GXa.hide();J.ULS.sendTraceTag(509659224,1,50,"ExcelIntelligenceSuggestionCard Cancelled")}};
V=Object(l.__decorate)([Object(z.d)(C.Pb),Object(l.__param)(0,Object(C.Lb)()),Object(l.__param)(1,Object(fa.a)())],V);Object(u.a)(V,"ExcelIntelligenceCalloutManager",null,[720,2]);var ba=a(26),la=a(150),Ta=a(45),Ea=a(387),sa=a(151),Ya;(function(fc){fc[fc.success=0]="success";fc[fc.featureDisabled=1]="featureDisabled";fc[fc.rangeNotInGrid=2]="rangeNotInGrid";fc[fc.emptyRange=3]="emptyRange";fc[fc.rangeTooLarge=4]="rangeTooLarge";fc[fc.successWithMergedCells=5]="successWithMergedCells"})(Ya||(Ya={}));
Object(u.b)("ResultCode",Ya);var bb=a(27),ra=a(208),Da=a(77),oa=a(280),Ha=a(86),ka=a(69),wa=a(7),Za=a(197),ab=a(162),db=a(65),mb=a(93),Ia;(function(fc){fc.FormatAsTable="FormatAsTable";fc.ExplicitClose="ExplicitClose";fc.ESC="Dismiss";fc.CommandExecution="CommandExecution";fc.Undo="Undo";fc.SelectionEnd="SelectionEnd";fc.EditedOutOfRange="EditedOutOfRange";fc.InvalidInterpretation="InvalidInterpretation";fc.RevertTable="RevertTable";fc.MenuItem="MenuItem";fc.Error="Error"})(Ia||(Ia={}));Object(u.b)("IgnoreSource",
Ia);var pa;(function(fc){fc.Implicit="Implicit";fc.Explicit="Explicit";fc.Positive="Positive";fc.Invalid="Invalid"})(pa||(pa={}));Object(u.b)("IgnoreSourceType",pa);const lb={[Ia.FormatAsTable]:{["Table"]:pa.Positive,["RevertTable"]:pa.Positive},[Ia.ExplicitClose]:{["Table"]:pa.Explicit,["RevertTable"]:pa.Explicit},[Ia.ESC]:{["Table"]:pa.Explicit,["RevertTable"]:pa.Implicit},[Ia.CommandExecution]:{["Table"]:pa.Implicit,["RevertTable"]:pa.Positive},[Ia.Undo]:{["Table"]:pa.Implicit,["RevertTable"]:pa.Explicit},
[Ia.SelectionEnd]:{["Table"]:pa.Implicit,["RevertTable"]:pa.Implicit},[Ia.EditedOutOfRange]:{["Table"]:pa.Implicit,["RevertTable"]:pa.Implicit},[Ia.InvalidInterpretation]:{["Table"]:pa.Invalid,["RevertTable"]:pa.Invalid},[Ia.RevertTable]:{["Table"]:pa.Explicit,["RevertTable"]:pa.Explicit},[Ia.MenuItem]:{["Table"]:pa.Positive,["RevertTable"]:pa.Positive},[Ia.Error]:{["Table"]:pa.Invalid,["RevertTable"]:pa.Invalid}};class ha{constructor(fc,vc,Tc,Bd,Fd,le){Fd=void 0===Fd?"OnDemand":Fd;this.fpb=n.EwaSettings.isChangeGateEnabled("OfficeVSO:8616831_svRemoveStaleFlights")?
10:3;this.LZj=()=>{this.fna("MenuItem");const dc={};dc[wa.a.zO]="SmartViewTableSuggestion";this.$.ei(802602464,ka.a.eh,8,dc);c({level:50,methodName:"openGiveFeedback",message:"Give feedback menu open success",dataFields:this.nj(),wu:this.wu})};this.openLearnMore=()=>{this.fna("MenuItem");const dc=new Ha.a(-859308420,ka.a.eh,this.$.Rh,9,null);this.$.Ma.dh(dc,{[ka.a.Wk]:"HelpID=22118",["InputMethod"]:ka.a.eh,["ShouldCanvasTakeFocus"]:!0,[ka.a.Ai]:wa.a.CI,[wa.a.Fia]:!0});sa.b(this.$).lj(la.a.yPk,this.nj(!0),
{},!0);sa.b(this.$).lj(la.a.zPk,this.nj(!0),{},!0)};this.Off=dc=>{dc=void 0===dc?!0:dc;const Uc=this;return No(function*(){var kb=Ta.w(Uc.OTa.tableLocation,Uc.$),rb=Ta.G(kb);Uc.Z0a(rb)||Uc.grid.ha.DP([rb],0,rb.topLeft,0);c({level:50,methodName:"convertToTable",message:"Create table initiated",dataFields:Uc.nj(),wu:Uc.wu});rb={};rb.TableRange=kb;rb.HasHeader=!0;dc||(rb.StyleIndex=n.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.SmartView.FormatTableStyle",-1));kb=Uc.$.ei(71074531,ka.a.eh,9,
rb);return mb.e(kb).then(cc=>{cc?(c({level:50,methodName:"convertToTable",message:"Create table complete",dataFields:Uc.nj(),wu:Uc.wu}),"RevertTable"!==Uc.$J&&(sa.b(Uc.$).lj(la.a.CTg,Uc.nj(!0),{},!0),sa.b(Uc.$).lj(la.a.DTg,Uc.nj(!0),{},!0)),Uc.J6d(()=>{ab.a(Uc.$).ns.activateRibbonTab(wa.a.a2b)})):c({level:10,methodName:"convertToTable",message:"Create table failed",dataFields:Uc.nj(),wu:Uc.wu});return cc})})};this.onDismiss=dc=>{(dc=dc?new Sys.UI.DomEvent(dc):null)&&"keydown"===dc.type&&27===dc.keyCode&&
this.fna("Dismiss");c({level:50,methodName:"onDismiss",message:"OnDismiss called for Table Invitation",dataFields:this.nj(),wu:this.wu})};this.LJc=()=>{ea.a.instance.Qi("Common.ISystemInitiatedFeedback").execute(dc=>{dc.logActivity("Office_Excel_SmartView_FormatAsTableOnPasteFloodgate",null)})};this.bS=(dc,Uc)=>{ha.nnf(Uc)&&this.fna("CommandExecution")};this.wog=()=>{this.fna("Undo")};this.Am=()=>{const dc=n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.DismissOnEditingOutOfRangeCell",
!1)?this.grid.isEditing:!0;this.isVisible&&this.OTa&&!this.Z0a(this.OTa.tableLocation)&&dc&&this.fna("SelectionEnd")};this.o_j=()=>{this.fna("MenuItem");this.q7.OYg();c({level:50,methodName:"optOutTableSuggestions",message:"User opted out of all suggestions",dataFields:this.nj(),wu:this.wu})};this.$=fc;this.fna=Tc;this.proactiveSuggestionCard=vc;this.grid=xa.f(this.$);this.isVisible=!1;ea.a.instance.Qi("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(dc=>{void dc.isFeatureEnabled("mso_sendASmile",
!1).then(Uc=>{this.zxa=Uc;return null})});this.q7=Bd;this.wu=Fd;this.nBa=le;this.$J="Table";this.g4="Default"}nj(fc){const vc={["LaunchSource"]:this.g4,["SuggestionType"]:this.$J};(void 0===fc?0:fc)||(vc.Class="TableSuggestionCardUtil");return vc}ySg(fc,vc){this.g4=vc;this.OTa=fc;this.$J="Table";(this.isVisible=this.proactiveSuggestionCard.show(fc.tableLocation,M.a.instance.Ba(710),M.a.instance.Ba(711),M.a.instance.Ba(712),M.a.instance.Ba(713),()=>{void this.Off().then(()=>{this.LJc();this.fna("FormatAsTable")})},
()=>{this.onClose()},this.uzc(),()=>{this.nMa(!0)},()=>{this.nMa(!1)},"TableDesignIdeas",n.EwaSettings.isChangeGateEnabled("OfficeVSO:6472403_FallbackCardLocation")?13:void 0,n.EwaSettings.isChangeGateEnabled("OfficeVSO:6472403_FallbackCardLocation")?[10,11,8]:void 0,5,this.onDismiss,void 0,!0))?(this.$J="Table",sa.b(this.$).lj(la.a.FTg,this.nj(!0),{},!0),sa.b(this.$).lj(la.a.GTg,this.nj(!0),{},!0),c({level:50,methodName:"showTableSuggestionCard",message:"Proactive suggestion card displayed",dataFields:this.nj(),
wu:this.wu}),this.HFb()):c({level:15,methodName:"showTableSuggestionCard",message:"Proactive suggestion card failed to show",dataFields:this.nj(),wu:this.wu})}P6e(fc,vc){this.OTa=fc;this.g4=vc;this.$J="RevertTable";this.Ckj()?void this.Off(!1).then(Tc=>{Tc&&this.J6d(()=>{this.SNk(fc,vc)})}):c({level:50,methodName:"automaticallyConvertToTable",message:"Range is not in visible area",dataFields:this.nj(),wu:this.wu})}SNk(fc,vc){this.g4=vc;this.OTa=fc;this.$J="RevertTable";(this.isVisible=this.proactiveSuggestionCard.show(fc.tableLocation,
M.a.instance.Ba(750),M.a.instance.Ba(751),M.a.instance.Ba(752),M.a.instance.Ba(753),()=>{this.onClose("FormatAsTable");sa.b(this.$).lj(la.a.CTg,this.nj(!0),{},!0);sa.b(this.$).lj(la.a.DTg,this.nj(!0),{},!0)},()=>{this.RFg("RevertTable");c({level:50,methodName:"showUndoFormattingCard",message:"User explicitly selects to revert the conversion",dataFields:this.nj()})},this.uzc(),()=>{this.nMa(!0)},()=>{this.nMa(!1)},"TableDesignIdeas",n.EwaSettings.isChangeGateEnabled("OfficeVSO:6472403_FallbackCardLocation")?
13:void 0,n.EwaSettings.isChangeGateEnabled("OfficeVSO:6472403_FallbackCardLocation")?[10,11,8]:void 0,5,this.onDismiss,void 0,!0))?(sa.b(this.$).lj(la.a.FTg,this.nj(!0),{},!0),sa.b(this.$).lj(la.a.GTg,this.nj(!0),{},!0),c({level:50,methodName:"showUndoFormattingCard",message:"Undo automatic table conversion card displayed",dataFields:this.nj()}),this.HFb()):(c({level:15,methodName:"showUndoFormattingCard",message:"Undo automatic table conversion card failed to show",dataFields:this.nj()}),this.RFg("Error"))}get visible(){return this.isVisible}set visible(fc){this.isVisible=
fc}hide(fc){this.visible&&(this.proactiveSuggestionCard.hide(),this.isVisible=!1,n.EwaSettings.isChangeGateEnabled("OfficeVSO:7748494_SVUpdateDismissCounts")?this.T3k(fc):"MenuItem"!==fc&&("FormatAsTable"===fc?this.q7.Gtb(this.$J):this.q7.qlb(this.$J)));this.jSc()}T3k(fc){const vc=this.DLi(fc,this.$J);"FormatAsTable"===fc&&this.q7.Gtb(this.$J);"Explicit"===vc&&this.q7.qlb(this.$J);n.EwaSettings.isChangeGateEnabled("OfficeVSO:8616831_svRemoveStaleFlights")&&("FormatAsTable"===fc?this.nBa.Yok():"Explicit"===
vc?this.nBa.b8i():"Implicit"===vc&&this.nBa.a8i())}DLi(fc,vc){if(fc=lb[fc])if(vc=fc[vc])return vc;c({level:15,methodName:"getIgnoreSourceType",message:"No ignore source type set for ignore source + suggestion type (configuration error)",dataFields:this.nj()});return"Invalid"}uzc(){const fc=[{key:"learnMessage",text:M.a.instance.Ba(716),onClick:this.openLearnMore},{key:"giveFeedback",text:M.a.instance.Ba(756),onClick:this.LZj}];fc.push({key:"optOut",text:M.a.instance.Ba(764),onClick:this.o_j});return fc}Jfa(fc){const vc=
this;return No(function*(){return vc.q7.Jfa(fc)})}kFf(){const fc=this;return No(function*(){if(!(yield fc.q7.Moj()))if(n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.ForceEnabled",!1))fc.q7.OYg();else return c({level:50,methodName:"getIsCardEnabled",message:"Roaming service setting is disabled",dataFields:fc.nj()}),!1;oa.a.UU("XLS-SmartView-EnableSessionCap-Treatment;XLS-SmartView-EnableSessionCap-Control");if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:8616831_svRemoveStaleFlights")&&
fc.nBa.Joj())return c({level:50,methodName:"getIsCardEnabled",message:"Exceeded maximum dismiss count for the session",dataFields:fc.nj()}),!1;const vc=yield fc.Jfa("Table"),Tc={Yea:vc};c({level:50,methodName:"getIsCardEnabled",message:"Dismiss count.",dataFields:fc.nj(),fields:Tc});return vc>=fc.fpb?(c({level:50,methodName:"getIsCardEnabled",message:"Exceeded maximum dismiss count.",dataFields:fc.nj(),fields:Tc}),!1):!0})}static dkj(fc){var vc=fc.properties;fc=vc.SourceControlId&&vc.SourceControlId.includes("Sensitivity");
vc=vc.ShouldCanvasTakeFocus;return fc&&!vc}static bkj(fc){return[1941920197,1928326585,1833782813,-1059615499,-1027730316,-1104934572,-28797232,71074531,1237877382,974713501].includes(fc)}static nnf(fc){return!(ha.bkj(fc.Ah.command)||ha.dkj(fc))}static kAd(fc,vc){const Tc={["Class"]:"TableSuggestionCardUtil"};return xa.f(fc).Yg.yaa(vc)?(c({level:50,methodName:"doesRangeContainTable",message:"Last paste was a table.",dataFields:Tc}),!0):xa.f(fc).Yg.aY(vc)?(c({level:50,methodName:"doesRangeContainTable",
message:"Last paste was a pivot table.",dataFields:Tc}),!0):!1}J6d(fc){if(this.MWf())fc();else{const vc=()=>{this.MWf()&&(fc(),this.grid.SBg(vc))};this.grid.M0e(vc)}}RFg(fc){c({level:50,methodName:"revertTable",message:"Revert table initiated",dataFields:this.nj(),fields:{source:fc}});this.fna(fc);this.$.ei(-1502853784,ka.a.eh,9,null).continueWith(vc=>{Za.b(vc)&&vc.result?(c({level:50,methodName:"revertTable",message:"Undo successful",dataFields:this.nj()}),"RevertTable"===fc&&sa.b(this.$).lj(la.a.APk,
this.nj(!0),{},!0),this.LJc()):c({level:10,methodName:"revertTable",message:"Undo failed",dataFields:this.nj()})})}onClose(fc){fc=void 0===fc?"ExplicitClose":fc;this.fna(fc);this.LJc();"FormatAsTable"===fc&&c({level:50,methodName:"showUndoFormattingCard",message:"User explicitly selects to keep the conversion",dataFields:this.nj()})}dispose(){this.proactiveSuggestionCard&&this.proactiveSuggestionCard.dispose()}nMa(fc){fc?this.cMg(this.OTa.tableLocation,this.YOb()):this.cMg(this.grid.ha.qa.activeRange,
this.YOb())}MWf(){return this.grid.za.Aaa(4,this.$.na)}Z0a(fc){return fc.yi(this.grid.ha.qa.activeRange)}YOb(){return Da.d(this.$.na)}cMg(fc,vc){fc=Ea.a.d8a(vc,[fc]);this.grid.rh.d5a();this.grid.rh.BP(fc,[0],!0)}Ckj(){var fc=this.OTa.tableLocation;const vc=this.grid.Pg.ro(fc);fc=this.grid.ml(fc,vc);return this.grid.Zk(vc).vr.yi(fc)?!0:!1}HFb(){this.$.Ma.Ocb(this.bS);this.$.ea.E1e(this.wog);this.grid.ha.VW(this.Am)}jSc(){this.$.Ma.n5a(this.bS);this.$.ea.DCg(this.wog);this.grid.ha.UY(this.Am)}}Object(u.a)(ha,
"TableSuggestionCardUtil",null,[]);class ua{constructor(fc,vc,Tc,Bd,Fd){this.fpb=n.EwaSettings.isChangeGateEnabled("OfficeVSO:8616831_svRemoveStaleFlights")?10:3;this.WJa=le=>{this.lSb.add(this.xcb);this.bL.hide(le);"ExplicitClose"===le&&sa.b(this.$).lj(la.a.ETg,this.nj(!0),{},!0);c({level:50,methodName:"ignoreActiveRange",message:"Ignore Current Range",dataFields:this.nj(),wu:"Existing",fields:{["ignoreSource"]:le}})};this.Am=()=>{n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.DismissOnEditingOutOfRangeCell",
!1)?this.bL.visible&&null!==this.xcb&&!this.Z0a(this.xcb)&&this.grid.isEditing&&this.WJa("EditedOutOfRange"):this.bL.visible&&null!==this.xcb&&!this.Z0a(this.xcb)&&this.WJa("SelectionEnd")};this.bS=(le,dc)=>{ha.nnf(dc)&&this.WJa("CommandExecution")};this.$=fc;this.xcb=null;this.MH=vc;this.lSb=new ra.a;this.g4="Default";this.grid=xa.f(this.$);this.proactiveSuggestionCard=Tc;this.q7=Bd;this.nBa=Fd;this.bL=new ha(this.$,this.proactiveSuggestionCard,this.WJa,this.q7,"Existing",this.nBa);this.fUk=.75}nj(fc){const vc=
{["LaunchSource"]:this.g4,["SuggestionType"]:"Table"};(void 0===fc?0:fc)||(vc.Class="IntelligentMetadataTableManager");return vc}xZk(fc,vc){const Tc=this;return No(function*(){var Bd;Tc.g4=vc;if(U.a.Kna()||U.a.nnb()){if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:7748494_SVUpdateDismissCounts")){if(!(yield Tc.bL.kFf())){c({level:50,methodName:"triggerHandRaise",message:"Card is not enabled",dataFields:Tc.nj()});return}}else{var Fd=yield Tc.bL.Jfa("Table"),le={Yea:Fd};c({level:50,methodName:"triggerIntelligentMetadataTableHandRaise",
message:"Dismiss count.",dataFields:Tc.nj(),wu:"Existing",fields:le});if(Fd>=Tc.fpb){c({level:50,methodName:"triggerIntelligentMetadataTableHandRaise",message:"Exceeded maximum dismiss count.",dataFields:Tc.nj(),wu:"Existing",fields:le});return}}for(const dc of Tc.lSb)if(dc.sheetId===fc.sheetId&&dc.range.yi(fc.range))return;Fd=Tc.nSi(fc);if(1===Fd.length&&(Fd=null===(Bd=Fd[0])||void 0===Bd?void 0:Bd.table,Bd=Tc.MJi(Fd)))if(Fd.UNf)c({level:50,methodName:"triggerIntelligentMetadataTableHandRaise",message:"The pasted field contains merged cells",
dataFields:Tc.nj(),wu:"Existing"});else{if(Tc.lMi(vc)){le=Tc.AXi(vc,Bd.tableLocation);if(!le)return;Bd.tableLocation=le}Tc.xcb=new Ea.a(Bd.tableLocation,Fd.analyzedRange.sheetId);n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.EnableAutomaticFormatting",!1)&&1===Bd.confidence?(Tc.bL.P6e(Bd,vc),c({level:50,methodName:"triggerIntelligentMetadataTableHandRaise",message:"Automatically formatting table",dataFields:Tc.nj()})):Tc.bL.ySg(Bd,vc)}}else c({level:50,methodName:"triggerIntelligentMetadataTableHandRaise",
message:"Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions is disabled",dataFields:Tc.nj(),wu:"Existing"})})}nSi(fc){const vc=this.MH.Zfa().iJa(fc,6);fc=this.MH.Zfa().iJa(fc,6,1);0<vc.length&&0===fc.length&&c({level:50,methodName:"getRecognizedTableRecords",message:"Suppressed card, table records were invalid",dataFields:this.nj(),wu:"Existing"});return fc}AXi(fc,vc){const Tc=vc.clone();switch(fc){case "InsertColumn":Tc.eqa(4,Tc.right+1);break;case "InsertRow":Tc.eqa(2,Tc.bottom+
1);break;case "DeleteColumn":fc=vc.right-1;if(1>fc||fc<vc.left)return null;Tc.eqa(4,fc);break;case "DeleteRow":fc=vc.bottom-1;if(1>fc||fc<vc.top)return null;Tc.eqa(2,fc)}return Tc}lMi(fc){return["InsertColumn","InsertRow","DeleteColumn","DeleteRow"].includes(fc)}MJi(fc){for(const vc of fc.interpretations)if(vc.confidence>=this.fUk&&2===vc.orientation&&1===vc.headerRowCount&&!fc.tableName)return vc;return null}Z0a(fc){return fc.range.contains(this.grid.ha.qa.activeRange)}dispose(){this.bL&&this.bL.dispose()}}
Object(u.a)(ua,"IntelligentMetadataTableManager",null,[2]);var fb=a(62),Ka=a(262),La=a(212),ib=a(252),Yb=a(205),Wc=a(355),Qc=a(122),Wb=a(35);class Jc{constructor(){this.version=6;this.revert=this.table=0;this.enabled=!0}}Object(u.a)(Jc,"SmartViewTableHandRaiseSetting",null,[]);class ma{constructor(fc){this.Die=new Jc;this.LKc=new Jc;this.qlb=vc=>{this.$J=vc;if(this.smartViewTableHandRaiseSetting){let Tc=this.gDf(vc);Tc++;this.e2g(vc,Tc);c({level:50,methodName:"incrementDismissCount",message:"Incremented smartViewTableHandRaiseSetting dismiss count.",
dataFields:this.nj(),fields:{oac:this.smartViewTableHandRaiseSetting}});this.wxe()}else c({level:50,methodName:"incrementDismissCount",message:"Can't increment smartViewTableHandRaiseSetting dismiss count.",dataFields:this.nj()})};this.Gtb=vc=>{this.$J=vc;this.smartViewTableHandRaiseSetting?(this.e2g(vc,0),c({level:50,methodName:"resetDismissCount",message:"Reset smartViewTableHandRaiseSetting dismiss count.",dataFields:this.nj(),fields:{oac:this.smartViewTableHandRaiseSetting}}),this.wxe()):c({level:50,
methodName:"resetDismissCount",message:"Can't reset smartViewTableHandRaiseSetting dismiss count.",dataFields:this.nj()})};this.xqk=()=>{c({level:50,methodName:"retrieveSmartViewTableHandRaiseSettingFromRoamingService",message:"Reading latest roaming setting.",dataFields:this.nj()});return new Promise(vc=>{Wc.C(this.$.pa.ta,2,Tc=>{c({level:50,methodName:"retrieveSmartViewTableHandRaiseSettingFromRoamingService",message:"OnReadRoamingStringSuccess called.",dataFields:this.nj()});if(Wb.a.Jk(Tc.Errors))Tc=
{errors:Wb.a.Kh(Tc.Errors)},c({level:10,methodName:"retrieveSmartViewTableHandRaiseSettingFromRoamingService",message:"onReadRoamingSuccessCallback encountered an error.",dataFields:this.nj(),fields:Tc}),vc(null);else if(Tc.Result){if(Tc=this.X$h(Tc.Result)){const Bd={oac:Tc};c({level:50,methodName:"retrieveSmartViewTableHandRaiseSettingFromRoamingService",message:"Successfully retrieved smartViewTableHandRaiseSetting.",dataFields:this.nj(),fields:Bd});6>Tc.version?(c({level:50,methodName:"retrieveSmartViewTableHandRaiseSettingFromRoamingService",
message:"Version mismatch. Resetting smartViewTableHandRaiseSetting",dataFields:this.nj()}),vc(this.Die)):vc(Tc)}}else c({level:50,methodName:"retrieveSmartViewTableHandRaiseSettingFromRoamingService",message:"onReadRoamingSuccessCallback received null result. Returning default value.",dataFields:this.nj()}),vc(this.Die)},Tc=>{Tc={ewaErrors:Qc.a.Qj(Tc.data)};c({level:10,methodName:"retrieveSmartViewTableHandRaiseSettingFromRoamingService",message:"Roaming operation failed.",dataFields:this.nj(),fields:Tc});
vc(null)},null,null)})};this.wxe=()=>{const vc=this.ixk(this.smartViewTableHandRaiseSetting);if(vc){var Tc={serializedSetting:vc};c({level:50,methodName:"updateSmartViewTableHandRaiseSettingFromRoamingService",message:"Updating roaming setting.",dataFields:this.nj(),fields:Tc});this.tZj(vc)}else c({level:15,methodName:"updateSmartViewTableHandRaiseSettingFromRoamingService",message:"Empty serialized roaming setting.",dataFields:this.nj()})};this.tZj=vc=>{Wc.J(this.$.pa.ta,2,vc,Tc=>{c({level:50,methodName:"onWriteRoamingString",
message:"WriteRoamingString called.",dataFields:this.nj()});Wb.a.Jk(Tc.Errors)?(Tc={errors:Wb.a.Kh(Tc.Errors)},c({level:10,methodName:"onWriteRoamingString",message:"WriteRoamingString encountered an error.",dataFields:this.nj(),fields:Tc})):Tc.Result&&(Tc.Result||c({level:10,methodName:"onWriteRoamingString",message:"Failed to write to the roaming service.",dataFields:this.nj()}))},Tc=>{Tc={ewaErrors:Qc.a.Qj(Tc.data)};c({level:10,methodName:"updateSmartViewTableHandRaiseSettingFromRoamingService",
message:"Roaming operation failed.",dataFields:this.nj(),fields:Tc})},null,null)};this.X$h=vc=>{if(!vc)return c({level:15,methodName:"deserializeToSmartViewTableHandRaiseSetting",message:"Received an empty roamingXml.",dataFields:this.nj()}),null;let Tc;try{Tc=JSON.parse(vc)}catch(Bd){return vc={errorMessage:Bd.message},c({level:10,methodName:"deserializeToSmartViewTableHandRaiseSetting",message:"Error while deserializing SmartViewTableHandRaiseSetting.",dataFields:this.nj(),fields:vc}),null}return Tc};
this.ixk=vc=>{if(!vc)return c({level:50,methodName:"serializeFromSmartViewTableHandRaiseSetting",message:"Empty roaming setting.",dataFields:this.nj()}),null;vc=db.a.li(vc);return 100<vc.length?(c({level:10,methodName:"serializeFromSmartViewTableHandRaiseSetting",message:"Exceeded the MaxSize for smartViewTableHandRaiseSettingMaxSize.",dataFields:this.nj()}),null):vc};this.$=fc;this.smartViewTableHandRaiseSetting=null;this.LKc={version:6,table:Number.POSITIVE_INFINITY,revert:Number.POSITIVE_INFINITY,
enabled:!1};this.$J="Table"}nj(fc){const vc={["LaunchSource"]:"Default",["SuggestionType"]:this.$J};(void 0===fc?0:fc)||(vc.Class="SmartViewTableHandRaiseRoamingHandler");return vc}Moj(){const fc=this;return No(function*(){if(yield fc.wJf()){if(fc.smartViewTableHandRaiseSetting)return fc.smartViewTableHandRaiseSetting.enabled;c({level:15,methodName:"isSettingEnabled",message:"Received null setting. Returning false.",dataFields:fc.nj()})}return fc.LKc.enabled})}OYg(){var fc;(null===(fc=this.smartViewTableHandRaiseSetting)||
void 0===fc?0:fc.enabled)?this.smartViewTableHandRaiseSetting=this.LKc:this.smartViewTableHandRaiseSetting=this.Die;this.wxe()}Jfa(fc){const vc=this;return No(function*(){vc.$J=fc;if(yield vc.wJf()){if(vc.smartViewTableHandRaiseSetting)return c({level:50,methodName:"getDismissCount",message:"Returning existing smartViewTableHandRaiseSetting",dataFields:vc.nj(),fields:{oac:vc.smartViewTableHandRaiseSetting}}),vc.gDf(fc);c({level:15,methodName:"getDismissCount",message:"smartViewTableHandRaiseSetting is null",
dataFields:vc.nj()})}c({level:50,methodName:"getDismissCount",message:"Received null setting. Returning infinity",dataFields:vc.nj()});return Number.POSITIVE_INFINITY})}wJf(){const fc=this;return No(function*(){if(!fc.smartViewTableHandRaiseSetting){const vc=yield fc.xqk();if(!vc)return c({level:15,methodName:"getTableHandRaiseSetting",message:"Received null setting",dataFields:fc.nj()}),fc.smartViewTableHandRaiseSetting=fc.LKc,!1;fc.smartViewTableHandRaiseSetting=vc;c({level:50,methodName:"getTableHandRaiseSetting",
message:"Received setting from roaming service.",dataFields:fc.nj(),fields:{oac:fc.smartViewTableHandRaiseSetting}})}return!0})}gDf(fc){return{["Table"]:this.smartViewTableHandRaiseSetting.table,["RevertTable"]:this.smartViewTableHandRaiseSetting.revert}[fc]}e2g(fc,vc){switch(fc){case "Table":this.smartViewTableHandRaiseSetting.table=vc;break;case "RevertTable":this.smartViewTableHandRaiseSetting.revert=vc;break;default:this.smartViewTableHandRaiseSetting.revert=vc,this.smartViewTableHandRaiseSetting.table=
vc}}}Object(u.a)(ma,"SmartViewTableHandRaiseRoamingHandler",null,[]);class Hc{constructor(){this.sOa=this.Kle=0;this.L2d=this.K2d=-1;this.K2d=n.EwaSettings.isChangeGateEnabled("OfficeVSO:8616831_svRemoveStaleFlights")?3:5;this.L2d=n.EwaSettings.isChangeGateEnabled("OfficeVSO:8616831_svRemoveStaleFlights")?1:3}b8i(){this.Kle++;this.sOa++}a8i(){this.sOa++}Yok(){this.Kle=this.sOa=0}Joj(){return-1!==this.K2d&&this.sOa>=this.K2d||-1!==this.L2d&&this.Kle>=this.L2d?!0:!1}}Object(u.a)(Hc,"TableSuggestionSessionHandler",
null,[]);var Kb=a(161);let pc=class{constructor(fc,vc,Tc){this.Hqa=this.Z2a=null;this.a5g=!1;this.fpb=n.EwaSettings.isChangeGateEnabled("OfficeVSO:8616831_svRemoveStaleFlights")?10:3;this.W2i=(Bd,Fd)=>{c({level:50,methodName:"handleSmartViewActivationCallback",message:"handleSmartViewActivationCallback invoked.",dataFields:this.nj()});if(!Fd)return c({level:10,methodName:"handleSmartViewActivationCallback",message:"surveyParams is null.",dataFields:this.nj()}),null;if(!Fd.contextInfo||0===Fd.contextInfo.length){var le=
{["contextInfo"]:Fd.contextInfo};c({level:10,methodName:"handleSmartViewActivationCallback",message:"no valid contextInfo in surveyParams.",dataFields:this.nj(),fields:le});return null}Bd=Fd.contextInfo[Fd.contextInfo.length-1];if(!Bd.context.sheetRange)return le={["contextInfo"]:Fd.contextInfo},c({level:10,methodName:"handleSmartViewActivationCallback",message:"no valid sheetRange in surveyParams.",dataFields:this.nj(),fields:le}),null;Fd=Bd.context.sheetRange;Bd=null!==(le=Bd.context.hasSurroundingCells)&&
void 0!==le?le:!1;this.MGf(Fd,Bd);return null};this.WJa=Bd=>{this.eQd=this.Y2a.analyzedRange;this.lSb.add(this.eQd);this.bL.hide(Bd);this.kAk();"ExplicitClose"===Bd&&(sa.b(this.$).lj(la.a.xPk,this.nj(!0),{},!0),sa.b(this.$).lj(la.a.ETg,this.nj(!0),{},!0));c({level:50,methodName:"ignoreActiveRange",message:"Ignore Current Range",dataFields:this.nj(),fields:{["ignoreSource"]:Bd}})};this.LJc=()=>{ea.a.instance.Qi("Common.ISystemInitiatedFeedback").execute(Bd=>{Bd.logActivity("Office_Excel_SmartView_FormatAsTableOnPasteFloodgate",
null)})};this.kAk=()=>{const Bd=this.grid.ha.qa.activeRange;this.grid.ha.updateSelection(Bd,Bd,0,0)};this.$=fc;this.MH=vc;this.lSb=new ra.a;this.eQd=this.G4c=this.Y2a=null;this.$J="Table";this.g4="Default";this.proactiveSuggestionCard=Tc;this.grid=xa.f(this.$);this.q7=new ma(this.$);this.nBa=new Hc;this.bL=new ha(this.$,this.proactiveSuggestionCard,this.WJa,this.q7,"OnDemand",this.nBa);if(U.a.Kna()||n.EwaSettings.isChangeGateEnabled("OfficeVSO:7800675_SVCleanupPostConsolidation")&&U.a.nnb())this.DSf=
new ua(this.$,this.MH,this.proactiveSuggestionCard,this.q7,this.nBa);this.a5g=["en-US","en-GB","en-CA","en-AU","en_IN"].includes(this.$.qca);(fc=ea.a.instance.Qi("Common.ISystemInitiatedFeedback"))&&fc.execute(Bd=>{Bd.r2b("SmartViewSuggestion",this.W2i)});this.$.qh&&(this.Z2a=this.$.qh.Vl("WebServiceCall","onDemandStopWatch"),this.Hqa=this.$.qh.Vl("WebServiceCall","getTableInfoStopwatch"))}nj(fc){const vc={["LaunchSource"]:this.g4,["SuggestionType"]:this.$J};(void 0===fc?0:fc)||(vc.Class="IntelligentMetadataOverlayManager");
return vc}get Zkd(){return this.G4c}D5k(fc,vc){vc=void 0===vc?!1:vc;this.Y2a=null;fc.tableName||(this.Y2a=fc);fc={["Duration"]:-1};this.Z2a&&(this.Z2a.stop(),fc.Duration=this.Z2a.ii);c({level:50,methodName:"updateOnDemandRecognizedTable",message:"OnDemand request succeeded",dataFields:this.nj(),fields:fc});void this.C5k(vc)}EPa(fc,vc){const Tc=this;return No(function*(){if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:7800833_SVAddUniversalChecks")||!ha.kAd(Tc.$,fc.range)){Tc.g4=vc;Tc.$J="Table";var Bd=
fc;if(!n.EwaSettings.isChangeGateEnabled("OfficeVSO:7800675_SVCleanupPostConsolidation")){Bd||c({level:10,methodName:"triggerHandRaise",message:"sheetRange is null or undefined",dataFields:Tc.nj()});if(!Tc.a5g){c({level:50,methodName:"triggerHandRaise",message:"Invalid language for TriggerHandRaise.",dataFields:Tc.nj()});return}if(Tc.$.ua.IsMeetingLiveSession){c({level:50,methodName:"triggerHandRaise",message:"User is in Teams live.",dataFields:Tc.nj()});return}if(Yb.a.Fxa()||Yb.a.vKa()){c({level:50,
methodName:"triggerHandRaise",message:"User is in Excel hosted in Teams.",dataFields:Tc.nj()});return}if((new Kb.a(Tc.$.sa)).activeSheet.Dn)return}if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:7748494_SVUpdateDismissCounts")){if(!(yield Tc.bL.kFf())){c({level:50,methodName:"triggerHandRaise",message:"Card is not enabled",dataFields:Tc.nj()});return}}else{var Fd=yield Tc.bL.Jfa("Table");const le={Yea:Fd};c({level:50,methodName:"triggerHandRaise",message:"Dismiss count.",dataFields:Tc.nj(),fields:le});
if(Fd>=Tc.fpb){c({level:50,methodName:"triggerHandRaise",message:"Exceeded maximum dismiss count.",dataFields:Tc.nj(),fields:le});return}}for(const le of Tc.lSb)if(le.sheetId===Bd.sheetId&&le.range.yi(Bd.range)){c({level:50,methodName:"triggerHandRaise",message:"Range was already ignored.",dataFields:Tc.nj()});return}Fd=!1;if(!Tc.Fpj(Bd)){c({level:50,methodName:"triggerHandRaise",message:"Surrounding Cells contain values, update boundary required",dataFields:Tc.nj()});Bd=yield Tc.PRd(Bd);if(!Bd){c({level:50,
methodName:"triggerHandRaise",message:"Expanded Range is null or undefined",dataFields:Tc.nj()});return}Fd=!0}if(!n.EwaSettings.isChangeGateEnabled("OfficeVSO:7800833_SVAddUniversalChecks")){if(Tc.wYh(Bd)){c({level:50,methodName:"triggerHandRaise",message:"Header contains links or formulas.",dataFields:Tc.nj()});return}if(Tc.FKa(Bd.range)){c({level:50,methodName:"triggerHandRaise",message:"Specified range is empty",dataFields:Tc.nj()});return}}n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.DisableLPP",
!1)?(c({level:50,methodName:"triggerHandRaise",message:"LPP Disabled, requesting OnDemandMetadata",dataFields:Tc.nj()}),Tc.MGf(Bd,Fd)):Tc.mzj(Bd,Fd)}})}wZk(fc,vc){const Tc=this;return No(function*(){Tc.DSf&&void Tc.DSf.xZk(fc,vc)})}mzj(fc,vc){vc=void 0===vc?!1:vc;const Tc=ea.a.instance.Qi("Common.ISystemInitiatedFeedback");Tc&&(c({level:50,methodName:"logSmartViewEventToLpp",message:"logged event to LPP",dataFields:this.nj()}),Tc.execute(Bd=>{Bd.logActivity("SmartViewProactiveSuggestionActivity",
null,{["sheetRange"]:fc,["hasSurroundingCells"]:vc})}))}MGf(fc,vc){vc=void 0===vc?!1:vc;n.EwaSettings.isChangeGateEnabled("OfficeVSO:7800675_SVCleanupPostConsolidation")?this.getMetadata(fc,vc):this.bL.J6d(()=>{this.getMetadata(fc,vc)})}dispose(){this.bL&&this.bL.dispose()}C5k(fc){fc=void 0===fc?!1:fc;const vc=this;return No(function*(){if(null!=vc.Y2a){var Tc=vc.Y2a.analyzedRange,Bd=vc.eQd===Tc;if(vc.Y2a.UNf)c({level:50,methodName:"updateOnDemandActionButton",message:"The pasted field contains merged cells",
dataFields:vc.nj()});else if(!Bd&&Tc.sheetId===vc.$.sa.na.sheetId){Bd=(Tc=n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.HigherConfidence",!1))?1:.5;let le=null;for(var Fd of vc.Y2a.interpretations)Fd.confidence>=Bd&&2===Fd.orientation&&(Bd=Fd.confidence,le=Fd);if(!le)vc.WJa("InvalidInterpretation"),c({level:50,methodName:"updateOnDemandActionButton",message:"The recognition contained no interpretations",dataFields:vc.nj()});else if(1!==le.headerRowCount||le.headerColumnCount)vc.WJa("InvalidInterpretation"),
c({level:50,methodName:"updateOnDemandActionButton",message:"The recognition cannot be converted to a table",dataFields:vc.nj()});else if(vc.G4c!==le||!vc.bL.visible){vc.G4c=le;c({level:50,methodName:"updateOnDemandActionButton",message:"Table Suggestion Confidence",dataFields:vc.nj(),fields:{confidence:Bd,useHigherConfidence:Tc}});if(n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.EnableAutomaticFormatting",!1)&&1===Bd&&vc.Z0a(vc.Zkd.tableLocation)&&!fc&&"CutAndPaste"===vc.g4){Fd=
yield vc.bL.Jfa("RevertTable");if(Fd<vc.fpb){vc.$J="RevertTable";vc.bL.P6e(vc.Zkd,vc.g4);c({level:50,methodName:"updateOnDemandActionButton",message:"Automatically formatting table",dataFields:vc.nj()});return}c({level:50,methodName:"updateOnDemandActionButton",message:"Exceeded maximum dismiss count.",dataFields:vc.nj(),fields:{dismiss:Fd}})}vc.bL.ySg(vc.Zkd,vc.g4)}}}})}wYh(fc){fc=new ba.Range(fc.range.top,fc.range.left,fc.range.top,fc.range.right,!0,!1);for(fc=xa.f(this.$).ot("IntelligenceMetadataOverlay.containsFormulasInHeader",
fc,1);fc.$$mn();)if(fc.$$cu().iC)return!0;return!1}getMetadata(fc,vc){vc=void 0===vc?!1:vc;this.Z2a.stop();this.Z2a.start();fc=this.MH.PNi(fc,Tc=>{this.D5k(Tc,vc)});c({level:50,methodName:"getMetadata",message:"OnDemand metadata requested",dataFields:this.nj()});fc&&5!==fc&&(c({level:50,methodName:"getMetadata",message:"getMetadataForRange unsuccessful",dataFields:this.nj(),fields:{["resultCode"]:Ya[fc]}}),this.Z2a.stop())}Fpj(fc){fc=new ba.Range(1<fc.range.top-1?fc.range.top-1:1,1<fc.range.left-
1?fc.range.left-1:1,fc.range.bottom+1,fc.range.right+1,!0,!1);const vc=1===fc.top,Tc=1===fc.left,Bd=xa.f(this.$).ot("IntelligenceMetadataOverlay",fc,1);for(;Bd.$$mn();){const Fd=Bd.$$cu();if((Fd.range.top===fc.top&&!vc||Fd.range.left===fc.left&&!Tc||Fd.range.bottom===fc.bottom||Fd.range.right===fc.right)&&Fd.Xn.value)return!1}return!0}Z0a(fc){return fc.yi(this.grid.ha.qa.activeRange)}FKa(fc){for(fc=xa.f(this.$).ot("IntelligentMetadataOverlayManager.isRangeEmpty",fc,1);fc.$$mn();){const vc=fc.$$cu();
if(vc&&(0!==vc.Xn.type||!bb.a.qz(vc.Xn.value)))return!1}return!0}PRd(fc){const vc=this;return No(function*(){vc.Hqa||(vc.Hqa=vc.$.qh.Vl("WebServiceCall","getTableInfoStopwatch"));vc.Hqa.stop();vc.Hqa.start();const Tc=Ta.w(fc.range.topLeft,vc.$),Bd=vc.$.pa.ta.Jh(),Fd={Duration:-1};return new Promise(le=>{const dc=new La.a(260,0,(Uc,kb,rb)=>fb.t(vc.$.pa.ta,Tc,Object(Ka.c)(Uc,cc=>{vc.Hqa.stop();if(!cc||ib.a(cc))c({level:50,methodName:"invokeGetTableInfoAction",message:"Result returned with errors",dataFields:vc.nj()}),
le(null);else{cc=Ta.G(cc.Result.TableRange);Fd.Duration=vc.Hqa.ii;var mc=n.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.SmartView.ExpandedRangeLimit",800);vc.Hqa.ii>mc&&-1!==mc?(c({level:50,methodName:"invokeGetTableInfoAction",message:"GetTableInfo timed out",dataFields:vc.nj(),fields:Fd}),le(null)):(c({level:50,methodName:"invokeGetTableInfoAction",message:"GetTableRange Succeeded",dataFields:vc.nj(),fields:Fd}),le(new Ea.a(cc,fc.sheetId)))}}),Object(Ka.b)(kb,()=>{vc.Hqa.stop();Fd.Duration=
vc.Hqa.ii;c({level:50,methodName:"invokeGetTableInfoAction",message:"GetTableRange Failed",dataFields:vc.nj(),fields:Fd});le(null)}),rb,null,Bd),88);dc.COa(()=>!0);vc.$.userOperationManager.enqueueOperation(dc,null)})})}};pc=Object(l.__decorate)([Object(z.d)(C.xd),Object(l.__param)(0,Object(C.Lb)()),Object(l.__param)(1,Object(C.gg)()),Object(l.__param)(2,Object(C.Oe)())],pc);Object(u.a)(pc,"IntelligentMetadataOverlayManager",null,[718,2]);var $b=a(34),Ib=a(17),Zb=a(263),Eb=a(55),ob=a(32),Na=a(58);
let nb=class extends Zb.a{constructor(fc,vc){super(document.createElement("div"));this.$=fc;this.zoom=vc;this.isMac=$b.a.isMac;this.onKeyDown=Tc=>{Tc=Tc.La;switch(Tc.keyCode){case 27:if(this.du.onDismiss)this.du.onDismiss(Tc);this.hide();return!0;default:return!1}};this.onKeyUp=Tc=>{Tc=Tc.La;switch(Tc.keyCode){case 121:return Tc.altKey&&Tc.shiftKey?(this.focus(),!0):!1;default:return!1}};this.tSd=(Tc,Bd)=>Tc.x==Bd.x&&Tc.y==Bd.y&&Tc.width==Bd.width&&Tc.height==Bd.height;this.HBf=(Tc,Bd)=>{const Fd=
Tc.topLeft.y,le=Tc.bottomRight.y,dc=Tc.topLeft.x;Tc=Tc.bottomRight.x;switch(Bd){case 0:return new Eb.a(dc+320,Fd-166);case 1:return new Eb.a(dc-(320-(Tc-dc))/2,Fd-166);case 2:return new Eb.a(Tc-320,Fd-166);case 3:return new Eb.a(dc,Fd);case 4:return new Eb.a(dc+320,le+166);case 5:return new Eb.a(dc-(320-(Tc-dc))/2,le+166);case 6:return new Eb.a(Tc-320,le+166);case 7:return new Eb.a(dc,le);case 8:return new Eb.a(dc-320,Fd+166);case 9:return new Eb.a(dc-320,Fd-(166-(le-Fd))/2);case 10:return new Eb.a(dc-
320,le-166);case 11:return new Eb.a(Tc+320,Fd+166);case 12:return new Eb.a(Tc+320,Fd-(166-(le-Fd))/2);case 13:return new Eb.a(Tc+320,le-166);default:throw Error(`Unhandled direction: ${Bd}`);}};this.Awe=()=>{if(this.isVisible){if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:6837335_PTPSNotOverlapRibbon")){const Tc=this.GBf();if(!Tc&&!this.nrc||Tc&&this.nrc&&this.tSd(Tc.bounds,this.nrc.bounds)&&Tc.direction===this.nrc.direction)return}this.Y$k=ob.a.Tg.qk.m;this.hide();this.L1g=Na.a.instance.create(()=>
{this.r3k()},this.i6g,"ProactiveSuggestionCard.UpdateCardPosition",void 0,!0)}else this.grid.view.Kx(this.Awe)};this.r3k=()=>{ob.a.Tg.qk.m-this.Y$k>=this.i6g&&this.bTc()};this.grid=xa.f(fc);this.Hbe=null;this.moc=this.K4=!1;this.i6g=250;this.SVc=!1}get zoomManager(){return this.zoom.zoomManager}show(fc,vc,Tc,Bd,Fd,le,dc,Uc,kb,rb,cc,mc,Sa,pb,Ac,yd,vb,Sc,hd){this.rootBounds=Sys.UI.DomElement.getBounds(this.grid.hga.Pi);this.SVc=vb;this.jhj=!!mc;this.PXa=Sa;this.du={range:fc,container:this.domElement,
title:vc,description:Tc,primaryButtonText:Bd,secondaryButtonText:Fd,NUj:le,tWj:dc,menuItems:Uc,w_b:kb,rha:rb,icon:cc,direction:mc,gapSpace:pb,onDismiss:Ac,Q4h:qc=>{qc&&(this.Hbe=qc)},setInitialFocus:yd,ariaLabel:this.isMac?vc+" "+M.a.instance.ia(1835):vc+" "+M.a.instance.ia(1834),vZi:Sc,ARj:hd};fc=this.bTc();this.K4||(this.$.frame.PH.ya(Ib.a.Rj,this.$.domElement,this.onKeyUp),this.$.frame.PH.yD(Ib.a.zi,this.$.domElement,this.onKeyDown,!0),this.K4=!0);n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",
!1)?void z.a.hj(C.l).then(qc=>{const Lc=this.isMac?M.a.instance.ia(1835):M.a.instance.ia(1834);qc.setEnabled(!0);qc.readText(Lc)}):this.$.ka.Lh(211,qc=>{const Lc=this.isMac?M.a.instance.ia(1835):M.a.instance.ia(1834);qc.setEnabled(!0);qc.readText(Lc)});return fc}hide(){J.ULS.sendTraceTag(527218006,1,50,"ProactiveSuggestionUIControl.Hide: calling AppChrome API to unmount card UI.");n.EwaSettings.isChangeGateEnabled("OfficeVSO:6423587_PTPSCardRaceConditionFix")&&this.L1g&&this.L1g.cancel();appChrome.unmountReactComponent(this.domElement);
this.isVisible=!1;this.grid.view.Kx(this.Awe);this.K4&&(this.$.frame.PH.Na(Ib.a.Rj,this.$.domElement,this.onKeyUp),this.$.frame.PH.KD(Ib.a.zi,this.$.domElement,this.onKeyDown,!0),this.K4=!1)}focus(){this.Hbe&&this.Hbe.focus()}dispose(){super.dispose()}eDf(fc){var vc,Tc,Bd=this.grid.Pg.ro(fc);fc=this.grid.ml(fc,Bd);Bd=this.grid.Zk(Bd).vr;const Fd=this.HBf(fc,null!==(vc=this.du.direction)&&void 0!==vc?vc:13);if(Bd.Fua(Fd))return null!==(Tc=this.du.direction)&&void 0!==Tc?Tc:13;if(void 0===this.du.direction)return 11;
if(this.PXa&&0<this.PXa.length)for(vc=0;vc<this.PXa.length;vc++){if(Tc=this.HBf(fc,this.PXa[vc]),Bd.Fua(Tc))return this.PXa[vc]}else return this.du.direction}getCellBounds(fc){if(fc=this.grid.kh(fc))if(fc.cell.Fp)if(this.grid.pwa(fc.cell.zF.Ci)){if(!n.EwaSettings.isChangeGateEnabled("OfficeVSO:6837335_PTPSNotOverlapRibbon"))return{bounds:this.grid.getCellBounds(fc.cell,!0),direction:void 0};var vc=fc.range,Tc=this.grid.Pg.ro(vc),Bd=this.grid.ml(vc,Tc);if(this.grid.Zk(Tc).vr.yi(Bd))if(vc=this.eDf(vc),
void 0===vc)J.ULS.sendTraceTag(512361876,1,15,"ProactiveSuggestionUIControl.GetCellBounds failed to show UI, direction is undefined");else return{bounds:this.grid.getCellBounds(fc.cell,!0),direction:vc};else J.ULS.sendTraceTag(512266887,0,15,"ProactiveSuggestionUIControl.GetCellBounds: Range not in visible area")}else J.ULS.sendTraceTag(525341026,1,15,"ProactiveSuggestionUIControl.GetCellBounds failed to show UI, gridViewBlock not found");else J.ULS.sendTraceTag(527218009,1,15,"ProactiveSuggestionUIControl.GetCellBounds: failed to show UI, formattedActiveCell is not in view.");
else J.ULS.sendTraceTag(527218010,1,15,"ProactiveSuggestionUIControl.GetCellBounds: failed to show UI, formattedActiveCell is null.")}getRangeBounds(fc){var vc=this.grid.Pg.ro(fc),Tc=this.grid.ml(fc,vc);const Bd=this.grid.Zk(vc);vc=Bd.vr;if(!vc.yi(Tc))return J.ULS.sendTraceTag(508936469,0,50,"ProactiveSuggestionUIControl.getRangeBounds: Range not in visible area"),{bounds:this.rootBounds,direction:this.du.direction};Tc=vc.pk(Tc);var Fd=Tc.topLeft.y;const le=Tc.bottomRight.y,dc=Tc.topLeft.x,Uc=Tc.bottomRight.x;
Tc=this.du.direction;if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:6837335_PTPSNotOverlapRibbon")){if(Tc=this.eDf(fc),void 0===Tc)return J.ULS.sendTraceTag(508936468,0,50,"ProactiveSuggestionUIControl.getRangeBounds: Directional hint is undefined"),{bounds:this.rootBounds,direction:this.du.direction}}else fc=new Eb.a(Uc,le-134),this.moc=!vc.Fua(fc);fc=Sys.UI.DomElement.getLocation(Bd.domElement);Fd=new Sys.UI.Point(dc+fc.x-vc.topLeft.x,Fd+fc.y-vc.topLeft.y);vc=new Sys.UI.Point(Uc+fc.x-vc.topLeft.x,
le+fc.y-vc.topLeft.y);Fd=this.zoomManager.Rfa(Fd);vc=this.zoomManager.Rfa(vc);return{bounds:new Sys.UI.Bounds(Fd.x,Fd.y,vc.x-Fd.x,vc.y-Fd.y),direction:Tc}}GBf(){const fc=this.getRangeBounds(this.du.range);return this.SVc&&!this.tSd(fc.bounds,this.rootBounds)?fc:this.SVc?void 0:this.getCellBounds(this.du.range)}bTc(){if(!this.du)return!1;if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:6837335_PTPSNotOverlapRibbon")){var fc=this.GBf();if(!fc)return J.ULS.sendTraceTag(512361875,1,15,"ProactiveSuggestionUIControl.renderCard: cardLayoutInfo is undefined"),
!1;var vc=fc.bounds;fc=fc.direction;if(void 0===vc)return J.ULS.sendTraceTag(512361874,1,15,"ProactiveSuggestionUIControl.renderCard: bounds is undefined"),!1}else this.SVc?(vc=this.getRangeBounds(this.du.range).bounds,n.EwaSettings.isChangeGateEnabled("OfficeVSO:6472403_FallbackCardLocation")?this.du.direction=this.moc&&null!=this.PXa?this.PXa[0]:this.du.direction:this.du.direction=this.jhj?this.du.direction:this.moc?11:13,this.moc=!1):(vc=this.getCellBounds(this.du.range),vc=null!=vc?vc[0]:void 0);
if(this.tSd(vc,this.rootBounds))return J.ULS.sendTraceTag(525341025,1,15,"ProactiveSuggestionUIControl.RenderCard failed to show UI, targetBounds set to root"),!1;J.ULS.shipAssertTag(527218008,1,!!vc,"ProactiveSuggestionUIControl.RenderCard: target cell bounds should not be null.");J.ULS.sendTraceTag(527218007,1,50,"ProactiveSuggestionUIControl.RenderCard: calling AppChrome API to render card UI.");appChrome.renderProactiveSuggestionCard(vc.y,vc.x,vc.y+vc.height,vc.x+vc.width,this.du.container,this.du.title,
this.du.description,this.du.primaryButtonText,this.du.secondaryButtonText,this.du.NUj,this.du.tWj,this.du.menuItems,this.du.w_b,this.du.rha,this.du.icon,n.EwaSettings.isChangeGateEnabled("OfficeVSO:6837335_PTPSNotOverlapRibbon")?fc:this.du.direction,this.du.gapSpace,this.du.onDismiss,this.du.Q4h,this.du.setInitialFocus,this.du.ariaLabel,this.du.vZi,this.du.ARj);this.isVisible=!0;n.EwaSettings.isChangeGateEnabled("OfficeVSO:6837335_PTPSNotOverlapRibbon")&&(this.nrc={bounds:vc,direction:fc});this.grid.view.Wy(this.Awe);
return!0}};nb=Object(l.__decorate)([Object(z.d)(C.Oe),Object(l.__param)(0,Object(C.Lb)()),Object(l.__param)(1,Object(C.Lg)())],nb);Object(u.a)(nb,"ProactiveSuggestionCard",Zb.a,[717]);var Hb=a(1203);let na=class{constructor(fc,vc){this.$=fc;this.MH=vc;this.MH.Zfa();fc.sa.Qm(()=>this.Owe());this.MH.Hcb("Valid",()=>{this.Owe()});this.MH.Hcb("Invalid",()=>{this.Owe()})}Owe(){const fc=[],vc=[],Tc=[],Bd=this.$.sa.na;if(Bd){var Fd=this.MH.Zfa().iJa(new Ea.a(Object(Ta.g)(),Bd.sheetId),2);for(const dc of Fd){if(dc.table.analyzedRange.sheetId!==
Bd.sheetId)continue;var le=!this.Agj(dc.table.interpretations);Fd=this.lDi(dc.table);if(!Fd)continue;const Uc=Fd.tableLocation.clone();Uc.left+=Fd.headerColumnCount;Uc.top+=Fd.headerRowCount;if(le){let kb=le=!0;for(let rb=0;rb<Fd.fields.count;rb++){const cc=Uc.clone();2===Fd.orientation?(cc.left+=rb,cc.right=cc.left):(cc.top+=rb,cc.bottom=cc.top);1===Fd.fields.ma(rb).classification?(this.q_e(fc,cc,kb),kb=!1):(this.q_e(vc,cc,le),le=!1)}}else fc.push(Uc);Fd=this.jLi(Fd);null!=Fd&&0<Fd.length&&Tc.push(...Fd)}this.pfe();
0<fc.length&&this.highlightRanges(fc,[32]);0<vc.length&&this.highlightRanges(vc,[33]);0<Tc.length&&this.highlightRanges(Tc,[31])}else J.ULS.sendTraceTag(520147412,0,50,"GridHighlighter.updateGridHighlights: Active sheet null")}pfe(){const fc=[33,32,31];Object(xa.f)(this.$).rh.zq(fc);Object(xa.f)(this.$).rh.Tub(new Ea.a(null,Da.d(this.$.na)),fc)}q_e(fc,vc,Tc){!fc.length||Tc?fc.push(vc.clone()):(Tc=fc[fc.length-1],Tc.right+1===vc.left?Tc.right=vc.right:Tc.bottom+1===vc.top?Tc.bottom=vc.bottom:fc.push(vc.clone()))}lDi(fc){var vc=
fc.interpretations;return 0===(null===vc||void 0===vc?void 0:vc.count)?null:1===vc.count?vc.ma(0):2===vc.count?vc.ma(0).confidence===vc.ma(1).confidence?(fc=2===vc.ma(0).orientation?vc.ma(0):vc.ma(1),vc=1===vc.ma(0).orientation?vc.ma(0):vc.ma(1),new Hb.a(fc.tableLocation,fc.confidence,fc.headerRowCount,vc.headerColumnCount,fc.orientation,fc.fields)):fc.interpretations.ma(0).confidence>fc.interpretations.ma(1).confidence?fc.interpretations.ma(0):fc.interpretations.ma(1):null}highlightRanges(fc,vc){fc=
Ea.a.d8a(Da.d(this.$.na),fc);Object(xa.f)(this.$).rh.BP(fc,vc,!0)}jLi(fc){const vc=[];var Tc=fc.tableLocation.clone();if(0<fc.headerColumnCount){const Bd=fc.tableLocation.clone();Bd.right=Tc.left+fc.headerColumnCount-1;vc.push(Bd)}0<fc.headerRowCount&&(Tc=fc.tableLocation.clone(),Tc.bottom=Tc.top+fc.headerRowCount-1,vc.push(Tc));return vc}Agj(fc){return!fc||2>fc.count?!1:fc.ma(0).confidence===fc.ma(1).confidence}};na=Object(l.__decorate)([Object(z.d)(C.Ye),Object(l.__param)(0,Object(C.Lb)()),Object(l.__param)(1,
Object(C.gg)())],na);Object(u.a)(na,"RecognizedTableGridHighlighter",null,[]);var Gb;(function(fc){fc.Default="Default";fc.Paste="Paste";fc.ColumnAutoFit="ColumnAutoFit";fc.BorderActions="BorderActions";fc.Filter="Filter";fc.CutAndPaste="CutAndPaste";fc.PasteCoOccurrence="PasteCoOccurrence";fc.InsertColumn="InsertColumn";fc.DeleteColumn="DeleteColumn";fc.InsertRow="InsertRow";fc.DeleteRow="DeleteRow"})(Gb||(Gb={}));Object(u.b)("LaunchSource",Gb);const Xa={[Gb.Paste]:{isEnabled:n.EwaSettings.getBooleanFeatureGate(b("OnPasteEnabled"),
!1)&&!n.EwaSettings.getBooleanFeatureGate(b("PasteCoOccurrence"),!1),vQg:n.EwaSettings.getBooleanFeatureGate(b("PasteCoOccurrence"),!1),Rpa:f("OnPasteEnabled"),wu:"OnDemand"},[Gb.CutAndPaste]:{isEnabled:n.EwaSettings.getBooleanFeatureGate(b("OnPasteEnabled"),!1),Rpa:f("CutAndPaste"),wu:"OnDemand"},[Gb.PasteCoOccurrence]:{isEnabled:n.EwaSettings.getBooleanFeatureGate(b("OnPasteEnabled"),!1)&&n.EwaSettings.getBooleanFeatureGate(b("PasteCoOccurrence"),!1),vQg:!n.EwaSettings.getBooleanFeatureGate(b("OnPasteEnabled"),
!1),Rpa:f("PasteCoOccurrence"),wu:"OnDemand"},[Gb.ColumnAutoFit]:{isEnabled:U.a.Kna(),Rpa:"XLS-IntelligentMetadataTableProactiveSuggestions-Treatment;XLS-IntelligentMetadataTableProactiveSuggestions-Control",wu:"Existing"},[Gb.BorderActions]:{isEnabled:U.a.Kna(),Rpa:"XLS-IntelligentMetadataTableProactiveSuggestions-Treatment;XLS-IntelligentMetadataTableProactiveSuggestions-Control",wu:"Existing"},[Gb.Filter]:{isEnabled:U.a.Kna(),Rpa:"XLS-IntelligentMetadataTableProactiveSuggestions-Treatment;XLS-IntelligentMetadataTableProactiveSuggestions-Control",
wu:"Existing"},[Gb.InsertColumn]:{isEnabled:n.EwaSettings.getBooleanFeatureGate(b("InsertRowColProactiveSuggestions"),!1),Rpa:f("InsertRowColProactiveSuggestions"),wu:"Existing"},[Gb.DeleteColumn]:{isEnabled:n.EwaSettings.getBooleanFeatureGate(b("DeleteRowColProactiveSuggestions"),!1),Rpa:f("DeleteRowColProactiveSuggestions"),wu:"Existing"},[Gb.InsertRow]:{isEnabled:n.EwaSettings.getBooleanFeatureGate(b("InsertRowColProactiveSuggestions"),!1),Rpa:f("InsertRowColProactiveSuggestions"),wu:"Existing"},
[Gb.DeleteRow]:{isEnabled:n.EwaSettings.getBooleanFeatureGate(b("DeleteRowColProactiveSuggestions"),!1),Rpa:f("DeleteRowColProactiveSuggestions"),wu:"Existing"}};var Jb=a(40);class qb{constructor(fc){this.$=fc;this.grid=xa.f(this.$)}NTj(fc){this.grid.za.rMa(fc)}}Object(u.a)(qb,"GridHelper",null,[]);class Db{constructor(fc){this.dataFields={Class:"TableSuggestionController"};this.$=fc;this.VZi=new qb(fc)}NUa(fc,vc){if(fc)if(this.eMi())if(this.mMi())this.qH("User in teams",vc);else if(this.jMi())this.qH("Sheet is protected",
vc);else{var Tc=this.KQb(fc);this.VZi.NTj(()=>{if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:7800833_SVAddUniversalChecks")){if(this.kAd(fc)){this.qH("Range already contains table",vc);return}if(this.Kdi(fc)){this.qH("Range already contains pivot table",vc);return}if(this.XFi(fc)){this.qH("Header contains links or formulas",vc);return}if(this.hMi(Tc.range)){this.qH("Specified range is empty",vc);return}}this.ZLi(Bd=>this.RZk(Bd,Tc,vc))})}else this.qH("Language not supported",vc);else this.qH("Range not provided",
vc)}ZLi(fc){Jb.TaskExtensions.Ua(Object(mb.d)(z.a.resolve(C.xd,{va:1})),fc,this.$.xa,3)}RZk(fc,vc,Tc){var Bd;fc=null===fc||void 0===fc?void 0:fc.result;const Fd=Object.assign({},this.dataFields,{LaunchSource:Tc}),le=null===(Bd=Xa[Tc])||void 0===Bd?void 0:Bd.wu;fc?(c({level:50,methodName:"triggerTableSuggestionCard",message:"IntelligentMetadata is triggered",dataFields:Fd,fields:{metadataType:le}}),"Existing"===le?void fc.wZk(vc,Tc):"OnDemand"===le?void fc.EPa(vc,Tc):c({level:50,methodName:"triggerTableSuggestionCard",
message:"Invalid MetadataType is configured for the LaunchSource",dataFields:Fd})):c({level:15,methodName:"triggerTableSuggestionCard",message:"IntelligentMetadataOverlayManager couldn't be retrieved",dataFields:Fd})}KQb(fc){var vc;const Tc=null===(vc=this.$.sa.na)||void 0===vc?void 0:vc.sheetId;return new Ea.a(fc,Tc)}qH(fc,vc){c({level:50,methodName:"logTableSuggestionDisabled",message:"Table suggestion disabled",dataFields:Object.assign({},this.dataFields,{LaunchSource:vc}),fields:{reason:fc}})}eMi(){return["en-US",
"en-GB","en-CA","en-AU","en_IN"].includes(this.$.qca)}mMi(){return this.$.ua.IsMeetingLiveSession||Yb.a.Fxa()}jMi(){return(new Kb.a(this.$.sa)).activeSheet.Dn}hMi(fc){for(fc=xa.f(this.$).ot("TableSuggestionController.isRangeEmpty",fc,1);fc.$$mn();){const vc=fc.$$cu();if(vc&&(0!==vc.Xn.type||!bb.a.qz(vc.Xn.value)))return!1}return!0}XFi(fc){fc=new ba.Range(fc.top,fc.left,fc.top,fc.right,!0,!1);for(fc=xa.f(this.$).ot("TableSuggestionController.containsFormulasInHeader",fc,1);fc.$$mn();)if(fc.$$cu().iC)return!0;
return!1}kAd(fc){return xa.f(this.$).Yg.yaa(fc)}Kdi(fc){return xa.f(this.$).Yg.aY(fc)}}Object(u.a)(Db,"TableSuggestionController",null,[]);var gb;const ya={[5]:"InsertRow",[9]:"InsertColumn",[6]:"DeleteRow",[10]:"DeleteColumn"},Aa=[1868184698,-1985798686,753331043,2137617149,237279923,1804571062,1766348718,42074747,-875588320,-958589048,-185374993,264209770,-111689794,-1502853784,-1096627081,1441131127,-1027730316,-847286761,719923386];let sb=gb=class{constructor(fc,vc){this.lKa=!1;this.dataFields=
{Class:"TableSuggestionManager"};this.$=fc;C.jg.Ha()?(this.NH=new Db(fc),c({level:50,methodName:"constructor",message:"Initialized successfully",dataFields:this.dataFields})):this.NH=vc;n.EwaSettings.isChangeGateEnabled("OfficeVSO:7931124_sv_enable_commercial")&&ea.a.instance.Qi("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Tc=>{void Tc.isFeatureEnabled(gb.v7b,!1).then(Bd=>this.lKa=Bd)})}dispose(){}a0c(fc,vc){const Tc=this.PYa("BorderActions");this.U1a("BorderActions",Tc);
Tc&&(["OutsideBorders","AllBorders","ThickOutsideBorders"].includes(vc)?this.NH.NUa(fc,"BorderActions"):this.NH.qH(`Border action not supported - ${vc}`,"BorderActions"))}PZg(fc){var vc,Tc,Bd;const Fd=this.PYa("ColumnAutoFit");this.U1a("ColumnAutoFit",Fd);Fd&&(null!==fc&&void 0!==fc&&fc.Xfj?null!==(vc=null===fc||void 0===fc?void 0:fc.cqd)&&void 0!==vc&&vc.SheetName?null!==(Bd=null===(Tc=null===fc||void 0===fc?void 0:fc.cqd)||void 0===Tc?void 0:Tc.Ranges)&&void 0!==Bd&&Bd.length?(fc=Ta.E(fc.cqd.Ranges[0]),
this.NH.NUa(fc,"ColumnAutoFit")):this.NH.qH("No range available on userContext","ColumnAutoFit"):this.NH.qH("SheetName was not provided","ColumnAutoFit"):this.NH.qH("isColumnAutoFit is falsy","ColumnAutoFit"))}RZg(fc){const vc=this.PYa("Filter");this.U1a("Filter",vc);vc&&(this.$.sa.na.WK?this.NH.qH("Filter was toggled off","Filter"):null!==fc&&void 0!==fc&&fc.selection?(fc=Ta.G(fc.selection),this.NH.NUa(fc,"Filter")):this.NH.qH("No selection provided","Filter"))}b0c(fc,vc){if(U.a.Kna()&&(fc=ya[fc])){var Tc=
this.PYa(fc);this.U1a(fc,Tc);Tc&&(1!==vc.InsertDeleteRangeItems.length?this.NH.qH("Not exactly one operation",fc):(vc=vc.InsertDeleteRangeItems[0],1<vc.DeltaColumn||1<vc.DeltaRow?this.NH.qH("Too many rows/cols added/deleted",fc):(vc=Ta.E(vc.AdjustedSelectedRange),this.NH.NUa(vc,fc))))}}QZg(fc,vc){var Tc,Bd;const Fd=this.PYa("CutAndPaste");this.U1a("CutAndPaste",Fd);Fd&&((null===fc||void 0===fc?0:fc.pasteRecoveryUIDisplayed)?this.NH.qH("Paste recovery UI was displayed","CutAndPaste"):1!==(null===vc||
void 0===vc?void 0:vc.length)?this.NH.qH("Not exactly one range impacted","CutAndPaste"):[237279923,-875588320,-185374993,-958589048].includes(null===(Bd=null===(Tc=fc.commandParameters)||void 0===Tc?void 0:Tc.ribbonCommandInfo)||void 0===Bd?void 0:Bd.command)?(fc=Ta.Q(vc),this.NH.NUa(fc,"CutAndPaste")):this.NH.qH("Unsupported paste command","CutAndPaste"))}SZg(fc){const vc=this.PYa("PasteCoOccurrence");this.U1a("PasteCoOccurrence",vc);vc&&this.NH.NUa(fc,"PasteCoOccurrence")}TZg(fc,vc,Tc){const Bd=
this.PYa("Paste");this.U1a("Paste",Bd);Bd&&(Tc?(c({level:50,methodName:"triggerTableSuggestionOnRecoveryUiDismiss",message:"RecoveryUI is being dismissed.",dataFields:Object.assign({},this.dataFields,{LaunchSource:"Paste"})}),Aa.includes(null===fc||void 0===fc?void 0:fc.command)?this.NH.qH("Last command is not supported","Paste"):vc?this.NH.qH("User clicked outside of document","Paste"):this.NH.NUa(Tc,"Paste")):this.NH.qH("No pastedRange provided","Paste"))}PYa(fc){var vc;let Tc=!(null===(vc=Xa[fc])||
void 0===vc||!vc.isEnabled);n.EwaSettings.isChangeGateEnabled("OfficeVSO:7931124_sv_enable_commercial")&&(vc=n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.CommercialProEnabled",!1)&&this.lKa,"PasteCoOccurrence"===fc&&(vc=!1),Tc||(Tc=vc));return Tc}U1a(fc,vc){this.czj(fc);vc&&c({level:50,methodName:"logEntryOccurredForLaunchSource",message:"Entered funnel",dataFields:Object.assign({},this.dataFields,{LaunchSource:fc})})}czj(fc){var vc,Tc;const Bd=null===(vc=Xa[fc])||void 0===
vc?void 0:vc.Rpa;fc=null===(Tc=Xa[fc])||void 0===Tc?void 0:Tc.vQg;Bd&&!fc&&oa.a.UU(Bd)}};sb.v7b="SmartViewTableCommercial";sb=gb=Object(l.__decorate)([Object(z.d)(C.jg),Object(l.__param)(0,Object(C.Lb)())],sb);Object(u.a)(sb,"TableSuggestionManager",null,[402,2]);var nc=a(586),Bb=a(9),uc=a(420);class Pc extends uc.a{constructor(fc){super();this.$=fc;this.Bl();this.dataFields={Class:"TableSuggestionManagerFactory"}}create(){var fc=this.$.ka.Ug(534);fc||(fc=new Db(this.$),fc=new sb(this.$,fc),this.$.ka.ph(534,
fc));this.Yj(fc);c({level:50,methodName:"Create",message:"Initialized successfully",dataFields:this.dataFields})}static Aa(fc){fc.ka.ph(535,new Pc(fc))}}Object(u.a)(Pc,"TableSuggestionManagerFactory",uc.a,[]);var wd=a(6),Md=a(264);class Nd{constructor(){this.Yea=0;this.localStorage=new Md.a;this.Yea=this.OHi()}Jfa(){return this.Yea}Gtb(){this.Yea=0;this.JHg()}qlb(){this.Yea++;this.JHg()}OHi(){try{if(!this.localStorage.jl())return 0;const fc=this.localStorage.getItem("PivotTableHandRaiseDismissCount");
return fc?Number.parseLocale(fc):0}catch(fc){return J.ULS.sendTraceTag(522311635,306,10,"PivotTableHandRaiseLocalStorageLoaderSaver:getDismissCountFromCache failure"),0}}JHg(){try{this.localStorage.jl()&&this.localStorage.setItem("PivotTableHandRaiseDismissCount",this.Yea.toString())}catch(fc){J.ULS.sendTraceTag(522311634,306,10,"PivotTableHandRaiseLocalStorageLoaderSaver:saveDismissCountToCache failure")}}}Object(u.a)(Nd,"PivotTableHandRaiseLocalStorageLoaderSaver",null,[]);class ec{constructor(fc){this.version=
1;this.sOa=0;this.$=fc}Jfa(){const fc=this;return No(function*(){fc.lGg||(fc.lGg=fc.PHi());return(yield fc.lGg)+fc.sOa})}Gtb(){this.sOa=0;this.SHg(0)}qlb(){const fc=this;No(function*(){fc.sOa++;fc.SHg(yield fc.Jfa())})}PHi(){return new Promise(fc=>{Wc.C(this.$.pa.ta,3,vc=>{Wb.a.Jk(vc.Errors)?(J.ULS.sendTraceTag(520370311,0,10,`readRoamingString encountered an error. Errors: ${Wb.a.Kh(vc.Errors)}`),fc(Number.POSITIVE_INFINITY)):vc.Result?(vc=JSON.parse(vc.Result),!vc||null==vc.version||null==vc.Yea||
vc.version<this.version?fc(0):fc(vc.Yea)):(J.ULS.sendTraceTag(520370310,0,50,"readRoamingString - Received null"),fc(0))},(vc,Tc,Bd)=>{vc=Qc.a.Qj(vc.data);J.ULS.sendTraceTag(520370309,0,10,`OnRoamingOperationFailure: Encountered errors for ${Bd}. Errors: ${Wb.a.Kh(vc)}.`);fc(Number.POSITIVE_INFINITY)},null,null)})}SHg(fc){fc!==Number.POSITIVE_INFINITY&&(fc=JSON.stringify({version:this.version,Yea:fc}),Wc.J(this.$.pa.ta,3,fc,vc=>{Wb.a.Jk(vc.Errors)?J.ULS.sendTraceTag(520370308,0,10,`writeRoamingString encountered an error. Errors: ${Wb.a.Kh(vc.Errors)}`):
vc.Result||J.ULS.sendTraceTag(520370307,0,10,"writeRoamingString failed to write to roaming service.")},(vc,Tc,Bd)=>{vc=Qc.a.Qj(vc.data);J.ULS.sendTraceTag(520370306,0,10,`OnRoamingOperationFailure: Encountered errors for ${Bd}. Errors: ${Wb.a.Kh(vc)}.`)},null,null))}}Object(u.a)(ec,"PivotTableHandRaiseRoamingHandler",null,[391]);var gc=a(79),Mb=a(1017),sc=a(893);class xd extends Mb.a{constructor(){super();this.userCommands=null;this.H_=Object.assign(new sc.a,{T_:xd.getTypeName(),B_:xd.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelProactiveSuggestion_ProactiveSuggestionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}
Object(u.a)(xd,"ProactiveSuggestionSignal",Mb.a,[]);class xb extends xd{constructor(){super();this.interpretations=null;this.H_=Object.assign(new sc.a,{T_:xb.getTypeName(),B_:xb.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelProactiveSuggestion_PivotTableProactiveSuggestionSignal"}static getBaseTypes(){return["AugLoop_ExcelProactiveSuggestion_ProactiveSuggestionSignal","AugLoop_Signals_Signal"]}}Object(u.a)(xb,"PivotTableProactiveSuggestionSignal",xd,[]);class Lb{constructor(){this.confidence=
0;this.orientation=this.location=null;this.headerColumnCount=this.headerRowCount=0;this.headerNames=this.sectionLines=this.aggregationLines=this.dataBlockIntervals=this.fields=null}}Object(u.a)(Lb,"ExcelRecognizedTableInterpretationNew",null,[]);class Rc{constructor(){this.headerReferences=this.aggregations=this.classification=null}}Object(u.a)(Rc,"ExcelRecognizedTableFieldNew",null,[]);class nd{constructor(){this.left=this.top=0}}Object(u.a)(nd,"ExcelRecognizedTableCellReferenceNew",null,[]);var $d=
a(1202);class Td{constructor(){this.type=null;this.timestamp=0}}Object(u.a)(Td,"UserCommand",null,[]);var He=a(920);class oc extends He.a{constructor(){super();this.suggestPivotTable=!1;this.H_=Object.assign(new sc.a,{T_:oc.getTypeName(),B_:oc.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelProactiveSuggestion_ProactiveSuggestionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(u.a)(oc,"ProactiveSuggestionAnnotation",He.a,[]);class ld{constructor(fc,vc,Tc,Bd){this.QCj=
n.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.MaxPivotTableHandRaiseCount",1);this.E9f=n.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.MaxPivotTableHandRaiseDismissCount",20);this.x_d=!1;this.LPc=this.KPc=null;this.K1i=(Fd,le)=>{Fd=this.J1i(le);a:{switch(Fd){case "InvalidContextInfo":case "SurveyParamsNull":le="Error";break a;case "Success":le="Success";break a}le=void 0}J.ULS.sendTraceTag(521441668,306,50,`PivotTableHandRaiseManager.handlePivotTableActivationCallback Results: ${JSON.stringify({result:Fd,
status:le})}`);return null};this.tj=(Fd,le)=>{le&&le.h0f||(xa.f(this.$).ha.$w(this.tj),J.ULS.sendTraceTag(526984154,306,50,"PivotTableProactiveSuggestion: selection changed, hide hand raise card"),this.Nzd())};this.$=fc;this.MH=vc;this.Bo=Bd;this.FOe=this.J7c=0;this.proactiveSuggestionCard=Tc;ea.a.instance.Qi("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Fd=>{const le=this;return No(function*(){const dc=wd.AFrameworkApplication.Nh.AudienceGroup,Uc="Automation"===dc||"Dogfood"===
dc||"Microsoft"===dc;Fd.S4a("ExcelIdeasPivotTableHandRaise",kb=>{le.x_d=kb.isEnabled&&(Uc||1===kb.tierName)});(yield Fd.isFeatureEnabled("ExcelIdeasPivotTableHandRaise",!1))&&(Uc||1===(yield Fd.getFeatureTier("ExcelIdeasPivotTableHandRaise",0)))&&(le.x_d=!0)})});(fc=ea.a.instance.Qi("Common.ISystemInitiatedFeedback"))&&fc.execute(Fd=>{Fd.r2b("PivotTableHandRaiseSurface",this.K1i)});if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:7062246_RemovePivotTableHandRaiseRoamingFlight")||n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseRoaming",
!1))this.LPc=new ec(this.$);n.EwaSettings.isChangeGateEnabled("OfficeVSO:6002302_PTPSOptOut")&&(this.KPc=new Nd);this.activateAnnotation()}activateAnnotation(){this.Bo.register(this.Bo.e5().B7("PivotTableProactiveSuggestions").activateAnnotation({annotationType:oc.getTypeName(),bB:!1,pY:()=>{J.ULS.sendTraceTag(509449989,306,50,"PivotTableHandRaiseManager: Received annotation");return this.oxj()}}).A7((fc,vc)=>{J.ULS.sendTraceTag(509449990,306,50,JSON.stringify({closeReason:fc,errorCode:vc}))}).build())}get f7f(){return this.FOe}EPa(fc){const vc=
this;return No(function*(){var Tc=Date.now();const Bd=yield vc.uZk(fc);a:{switch(Bd){case "Success":case "SuccessWithLppDisabled":var Fd="Success";break a;case "DismissCountAboveLimit":case "IncorrectLicense":case "NotInEditMode":case "NoTableMetadata":case "RangeTooLarge":case "TriggerCountAboveMax":Fd="Aborted";break a;case "ActiveRangeNull":case "SystemInitiatedFeedbackNull":Fd="Error";break a}Fd=void 0}Tc={result:Bd,status:Fd,duration:Date.now()-Tc};J.ULS.sendTraceTag(521441669,306,50,`PivotTableHandRaiseManager.triggerHandRaise Results: ${JSON.stringify(Tc)}`)})}uZk(fc){const vc=
this;return No(function*(){n.EwaSettings.isChangeGateEnabled("OfficeVSO:6176249_UserActionLogs")&&sa.b(vc.$).lj(la.a.h3j,{},void 0,!0);if(!vc.x_d)return J.ULS.sendTraceTag(537154654,306,50,"PivotTableHandRaiseManager:TriggerHandRaise License is not enabled."),"IncorrectLicense";if(!fc)return J.ULS.sendTraceTag(537154653,306,10,"PivotTableHandRaiseManager:TriggerHandRaise activeRangeForHandRaise is null."),"ActiveRangeNull";if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:6212469_PTPSReadOnly")&&!vc.$.ea.isEditMode)return J.ULS.sendTraceTag(523100545,
306,50,"PivotTableHandRaiseManager:TriggerHandRaise not in edit mode."),"NotInEditMode";if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:7062246_RemovePivotTableHandRaiseRoamingFlight")||n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseRoaming",!1)){if((yield vc.LPc.Jfa())>=vc.E9f)return J.ULS.sendTraceTag(520370312,306,50,"PivotTableHandRaiseManager:TriggerHandRaise dismiss count above limit"),"DismissCountAboveLimit"}else if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:6002302_PTPSOptOut")&&
vc.KPc.Jfa()>=vc.E9f)return J.ULS.sendTraceTag(522311633,306,50,"PivotTableHandRaiseManager:TriggerHandRaise dismiss count above limit"),"DismissCountAboveLimit";if(n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseTestOnly",!1))return vc.J7c<vc.QCj?(vc.cSg(new Ea.a(fc,Da.d(vc.$.sa.na))),"SuccessWithLppDisabled"):"TriggerCountAboveMax";const Tc=vc.xSi(fc);if(!Tc)return"NoTableMetadata";if(176E4<Tc.analyzedRange.range.cz)return J.ULS.sendTraceTag(523776329,306,50,"PivotTableHandRaiseManager.triggerHandRaise range is too large to generate suggestions"),
"RangeTooLarge";vc.Dwk(Tc);return"Success"})}dispose(){this.proactiveSuggestionCard&&this.proactiveSuggestionCard.dispose()}xSi(fc){var vc;J.ULS.sendTraceTag(537154651,306,50,"PivotTableHandRaiseManager:GetRelevantRecognizedTable get table metadata info.");(fc=null===(vc=this.MH.Zfa().iJa(new Ea.a(fc,Da.d(this.$.sa.na)),6)[0])||void 0===vc?void 0:vc.table)&&J.ULS.sendTraceTag(520147406,306,50,`PivotTableHandRaiseManager.getRelevantRecognizedTable Found metadata with ID: ${fc.id}`);return fc}Dwk(fc){this.sheetRange=
fc.analyzedRange;const vc=new xb;vc.interpretations=Array.from(fc.interpretations,Tc=>{const Bd=new Lb;Bd.confidence=Tc.confidence;Bd.fields=Array.from(Tc.fields,Fd=>{const le=new Rc;le.aggregations=Array.from(Fd.aggregations,dc=>{switch(dc){case 2:return"average";case 1:return"count";case 5:return"distinctCount";case 4:return"max";case 3:return"min";case 6:return"stdDev";case 0:return"sum";case 7:return"variance"}});switch(Fd.classification){case 1:le.classification="dimension";break;case 2:le.classification=
"measure"}le.headerReferences=Array.from(Fd.headerReferences,dc=>{const Uc=new nd;Uc.left=dc.left;Uc.top=dc.top;return Uc});return le});Bd.headerColumnCount=Tc.headerColumnCount;Bd.headerRowCount=Tc.headerRowCount;switch(Tc.orientation){case 1:Bd.orientation="rowMajor";break;case 2:Bd.orientation="columnMajor"}Bd.location=new $d.a;Bd.location.bottom=Tc.tableLocation.bottom;Bd.location.left=Tc.tableLocation.left;Bd.location.right=Tc.tableLocation.right;Bd.location.top=Tc.tableLocation.top;return Bd});
fc=new Td;fc.type="SortAscending";fc.timestamp=Date.now();vc.userCommands=[fc];J.ULS.sendTraceTag(509450059,306,50,"PivotTableHandRaiseManager.sendPivotTableProactiveSuggestionSignal: Submit operation signal");this.Bo.twb(vc)}oxj(){const fc=this;return No(function*(){const vc=ea.a.instance.Qi("Common.ISystemInitiatedFeedback");return vc?(fc.FOe=fc.f7f+1,J.ULS.sendTraceTag(537154648,306,50,`PivotTableHandRaiseManager:TriggerHandRaise PivotTableHandRaiseActivity LPP activity log count: ${fc.f7f}`),
(yield new Promise(Tc=>{vc.execute(Tc)})).logActivity("PivotTableHandRaiseActivity",null,fc.sheetRange),"Success"):"SystemInitiatedFeedbackNull"})}J1i(fc){J.ULS.sendTraceTag(537154647,306,50,"PivotTableHandRaiseManager:HandlePivotTableActivationCallback HandlePivotTableActivationCallback invoked.");return fc?!fc.contextInfo||!fc.contextInfo.length||1<fc.contextInfo.length?(J.ULS.sendTraceTag(537154645,306,10,"PivotTableHandRaiseManager:HandlePivotTableActivationCallback no valid contextInfo in surveyParams."),
"InvalidContextInfo"):this.cSg(fc.contextInfo[0].context):(J.ULS.sendTraceTag(537154646,306,10,"PivotTableHandRaiseManager:HandlePivotTableActivationCallback surveyParams is null."),"SurveyParamsNull")}cSg(fc){void this.I5j();n.EwaSettings.isChangeGateEnabled("OfficeVSO:6176249_UserActionLogs")&&sa.b(this.$).lj(la.a.g3j,{},void 0,!0);J.ULS.sendTraceTag(526984158,306,50,"PivotTableProactiveSuggestion: show pivot table hand raise.");this.proactiveSuggestionCard.show(fc.range,M.a.instance.ia(1833),M.a.instance.Ba(692),
M.a.instance.ia(1831),M.a.instance.ia(1832),()=>{var vc,Tc;n.EwaSettings.isChangeGateEnabled("OfficeVSO:6176249_UserActionLogs")&&sa.b(this.$).lj(la.a.f3j,{},void 0,!0);J.ULS.sendTraceTag(526984157,306,50,"PivotTableProactiveSuggestion:OpenPane Pivot table hand raise OOUI clicked.");n.EwaSettings.isChangeGateEnabled("OfficeVSO:6423587_PTPSCardRaceConditionFix")&&this.proactiveSuggestionCard.hide();const Bd={SourceControlId:"PivotTableHandRaise",$fl:null!==(Tc=null===(vc=xa.f(this.$).Yg.sl(fc.range))||
void 0===vc?void 0:vc.name)&&void 0!==Tc?Tc:Object(Ta.y)(fc.range,this.$.sa.VLd(fc.sheetId).name,!0)};this.$.ei(-1444574190,0,0,Bd).continueWith(()=>{n.EwaSettings.isChangeGateEnabled("OfficeVSO:7062246_RemovePivotTableHandRaiseRoamingFlight")||n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseRoaming",!1)?this.LPc.Gtb():n.EwaSettings.isChangeGateEnabled("OfficeVSO:6002302_PTPSOptOut")&&this.KPc.Gtb();n.EwaSettings.isChangeGateEnabled("OfficeVSO:6423587_PTPSCardRaceConditionFix")||
this.proactiveSuggestionCard.hide()})},()=>{n.EwaSettings.isChangeGateEnabled("OfficeVSO:6176249_UserActionLogs")&&sa.b(this.$).lj(la.a.e3j,{},void 0,!0);J.ULS.sendTraceTag(526984156,306,50,"PivotTableProactiveSuggestion: Not Now clicked.");this.Nzd()},void 0,void 0,void 0,void 0,n.EwaSettings.isChangeGateEnabled("OfficeVSO:6837335_PTPSNotOverlapRibbon")?11:void 0,n.EwaSettings.isChangeGateEnabled("OfficeVSO:6837335_PTPSNotOverlapRibbon")?[13,8,10,6,4,2,0]:void 0,void 0,vc=>{vc=vc?new Sys.UI.DomEvent(vc):
null;"keydown"===(null===vc||void 0===vc?void 0:vc.type)&&27===vc.keyCode&&(n.EwaSettings.isChangeGateEnabled("OfficeVSO:6176249_UserActionLogs")&&sa.b(this.$).lj(la.a.d3j,{},void 0,!0),this.Nzd())},!1,!0);xa.f(this.$).ha.Cw(this.tj);this.J7c+=1;return"Success"}I5j(){const fc=this;return No(function*(){(yield gc.GetServiceTaskFactory.GPi(fc.$.ka)).Xsg()})}Nzd(){if(n.EwaSettings.isChangeGateEnabled("OfficeVSO:7071239_SwitchSheetWhenCardOpen")||!n.EwaSettings.isChangeGateEnabled("OfficeVSO:6002302_PTPSOptOut")||
this.proactiveSuggestionCard.isVisible)this.proactiveSuggestionCard.hide(),n.EwaSettings.isChangeGateEnabled("OfficeVSO:7062246_RemovePivotTableHandRaiseRoamingFlight")||n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseRoaming",!1)?this.LPc.qlb():n.EwaSettings.isChangeGateEnabled("OfficeVSO:6002302_PTPSOptOut")&&this.KPc.qlb()}}Object(u.a)(ld,"PivotTableHandRaiseManager",null,[272,2]);class id extends uc.a{constructor(fc){super();this.$=fc;this.Bl()}create(){const fc=
Object(mb.d)(z.a.resolve(C.gg,{va:1})),vc=Object(mb.d)(z.a.resolve(C.Oe,{va:1})),Tc=Object(mb.d)(z.a.resolve(C.p,{va:1}));Jb.TaskExtensions.Ua(B.Task.XP(...[fc,vc,Tc]),()=>{if(!this.$.ka.Ug(430)){var Bd=fc.result;const Fd=vc.result,le=null===Tc||void 0===Tc?void 0:Tc.result;Bd&&Fd?(Bd=new ld(this.$,Bd,Fd,le),this.Yj(Bd),this.$.ka.ph(430,Bd)):(null==Bd&&J.ULS.sendTraceTag(537154644,306,10,"PivotTableHandRaiseManagerFactory.Create: TableIntelligenceManager instance null."),null==Fd&&J.ULS.sendTraceTag(525620053,
306,10,"PivotTableHandRaiseManagerFactory.Create: ProactiveSuggestionCard instance null."),this.Yj(null))}},this.$.xa)}static Aa(fc){fc.ka.ph(431,new id(fc))}dispose(){this.$=null;super.dispose()}}Object(u.a)(id,"PivotTableHandRaiseManagerFactory",uc.a,[]);nc.a.gw('.DataCleansingPane{background:#edebe9;height:100%;overflow:hidden;display:flex;flex-direction:column}.DataCleansingPaneHeader{position:relative;overflow:hidden;padding:16px 16px 16px 16px}.DataCleansingPaneBody{flex:auto;position:relative}.DataCleansingPaneTitle{position:relative !important;max-width:230px;display:inline-block;text-overflow:ellipsis;overflow:hidden;height:22px;font-weight:normal;background:#edebe9;font-size:16px;color:#252423;font-family:"Segoe UI Semibold","Segoe UI Web",Arial,Verdana,sans-serif}.DataCleansingCloseButton{display:inline-block;padding:0 5px;font-size:16px}');
(()=>{Bb.a.Qg(fc=>{C.jg.Ha()||Pc.Aa(fc)})})();(()=>{Bb.a.Qg(fc=>{id.Aa(fc)})})();String(r);String(d);String(k);String(t);String(m);String(e);String(w);window.___1708742503431_closurehack=r;window.___1708742503431_closurehack=d;window.___1708742503431_closurehack=k;window.___1708742503431_closurehack=t;window.___1708742503431_closurehack=m;window.___1708742503431_closurehack=e;window.___1708742503431_closurehack=w}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.datacleansing.js.map/6c9749d66c9ff9309d1b4ebb095e1bbc/EwaTS.datacleansing.js.map