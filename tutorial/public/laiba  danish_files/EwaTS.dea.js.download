'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[27],{1048:function(y,x,a){a.d(x,"a",function(){return e});y=a(0);var c=a(14);x=a(913);var b=a(592),f=a(6),r=a(17),d=a(123);class k{constructor(w,l,u,n=null){this.origin=w;this.data=l;this.source=u;this.La=n}}Object(y.a)(k,"MessageEventArgs",null,[]);class t{constructor(w,l){this.Gda=null;this.f1b=u=>this.OZ?this.OZ(new k(u.origin,u.data,u.source,u.La)):!1;this.ZEb=w;this.$j=l;this.OZ=null}get Y7(){return this.ZEb.value}get bN(){return this.$j.value}LUa(w,
l){this.OZ=w;this.Gda=this.f1b;this.Y7.addHandler(r.a.message,this.Gda,l)}ZWa(){this.OZ=null;this.Y7.removeHandler(r.a.message,this.Gda)}gKa(w,l){const u=new d.a(0,1,1,()=>{w(l)},7);this.bN.Ol(u)}hTb(w,l){const u=new d.a(0,1,1,()=>{w(l)},7);this.bN.Ol(u)}static get instance(){return t.bwa()}static bwa(){return new t(new b.a(()=>f.AFrameworkApplication.Y7),new b.a(()=>f.AFrameworkApplication.pp))}}Object(y.a)(t,"MessageEventHandler",null,[453]);var m=a(936);class e extends x.a{constructor(w,l,u=null){super(w,
l,u||t.instance,e.PSb)}static PSb(){m.a.sendTraceTag=e.$4b;m.a.debugAssertTag=e.FLb}static $4b(w,l,u,...n){c.ULS.sendTraceTag.apply(null,[w,204,e.ZKb(l),u].concat(n))}static FLb(){}static ZKb(w){switch(w){case 0:return 200;case 1:return 100;case 2:return 50;case 4:return 15;case 3:return 10;default:return 100}}}e.C1b="wdPreviousSession";e.mLb="wdUserSession";Object(y.a)(e,"CommonCrossDocumentMessenger",x.a,[])},1121:function(y,x,a){a.d(x,"a",function(){return b});var c=a(42);const b=()=>c.a.instance.resolve("Common.IOfficeTrialExperience")},
1122:function(y,x,a){a.d(x,"a",function(){return b});var c=a(42);const b=()=>c.a.instance.resolve("Common.IMacOfficeOffer")},1278:function(y,x,a){a.r(x);a.d(x,"MSOJS",function(){return c});var c={};c.Dyb=function(){function b(){return m()&&(z()||3<=(n()?C("version/"):0))}function f(){return 0<=window.navigator.userAgent.indexOf("Windows")}function r(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function d(ha){ha=(new RegExp(ha+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);
var ua=-1;null!=ha&&2<=ha.length&&(ua=parseFloat(ha[1]),isNaN(ua)&&(ua=-1));return ua}function k(){Za||(Za=!0,ab=d("Windows Phone"));return 8<=ab}function t(){return"function"==typeof navigator.msLaunchUri&&!r()&&!B()&&!e()}function m(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function e(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function w(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function l(){return w()?
8==window.document.documentMode:!1}function u(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function n(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function v(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function B(){var ha=window.navigator.userAgent.toLowerCase();return 0<=ha.indexOf("android")&&0<=ha.indexOf("chrome")}function z(){return 3<=(u()?C("firefox/"):0)}function C(ha){var ua=window.navigator.userAgent.toLowerCase(),fb=ua.indexOf(ha);
return 0<=fb?parseInt(ua.substring(fb+ha.length,ua.length)):0}function D(ha,ua,fb,Ka,La){if(Ka&&null!=ua)ua();else if(t())navigator.msLaunchUri(ha,ua,fb);else if(!(v()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&m())||e())W(ha,ua,fb);else if(v()&&La)a:{try{window.open(ha,"_self")}catch(ib){null!=fb&&fb();break a}null!=ua&&ua()}else J(ha,ua,fb)}function J(ha,ua,fb){var Ka=document.getElementById("OICLinkTag");null==Ka&&
(Ka=document.createElement("a"),Ka.id="OICLinkTag",Ka.style.visibility="hidden",Ka.href="",0==(Ha.Options&mb.SupportsTopTargetNavigation)||Ha.NoBrowserModalDialogs?Ka.target="_blank":Ka.target="_top",document.body.appendChild(Ka),null!=Ka.addEventListener&&Ka.addEventListener("click",function(La){null!=La.stopPropagation&&La.stopPropagation()},!1));try{Ka.href=ha,Ka.dispatchEvent(new MouseEvent("click"))}catch(La){null!=fb&&fb();return}null!=ua&&ua()}function W(ha,ua,fb){var Ka=document.getElementById("OICFrame");
null==Ka&&(Ka=document.createElement("iframe"),Ka.className="ObjectInDialog",Ka.style.visibility="hidden",Ka.src="about:blank",document.body.appendChild(Ka),Ka.id="OICFrame");try{Ka.contentWindow.location.href=ha}catch(La){null!=fb&&fb();return}null!=ua&&ua()}function N(ha){return 0!=(ha.Options&mb.SkipProtocolHandler)||l()}function M(ha){return ha===db.ReadOnly||ha===db.ReadWrite}function Q(ha,ua,fb,Ka){var La;try{var ib=new ActiveXObject("SharePoint.OpenDocuments.4");return(La=ib.ViewDocument3(window.self,
ha,ua,Ka))?(V(pa.O14ActiveX),Ia.None):Ia.Failed}catch(Yb){}if(mb.O14Only===(fb&mb.O14Only))return Ha.DescriptiveUnattemptedEnums?Ia.O14AttemptFailure:Ia.Unattempted;try{return ib=new ActiveXObject("SharePoint.OpenDocuments.3"),(La=ib.ViewDocument3(window.self,ha,ua,Ka))?(V(pa.O12ActiveX),Ia.None):Ia.Failed}catch(Yb){}if(mb.O12UpOnly===(fb&mb.O12UpOnly))return Ha.DescriptiveUnattemptedEnums?Ia.O12UpOnlyFail:Ia.Unattempted;try{return ib=new ActiveXObject("SharePoint.OpenDocuments.2"),(La=M(ua)?ib.ViewDocument2(window.self,
ha,Ka):ib.EditDocument2(window.self,ha,Ka))?(V(pa.O11ActiveX),Ia.None):Ia.Failed}catch(Yb){}return Ha.DescriptiveUnattemptedEnums?Ia.ActiveXUnattempted:Ia.Unattempted}function R(ha,ua,fb,Ka,La){ha==lb.Visio&&fb==db.ReadWrite&&(fb=db.WriteOnly);Ka=Ka||r()&&!k();if(!Ka){Ka="";if(ha==lb.PowerPoint){ha=Ka;Ka=Ha.DocumentExtension;fb=M(fb);var ib=new Set([".pot",".potm",".potx"]),Yb=new Set([".pps",".ppsm",".ppsx"]);fb=fb&&ib.has(Ka)?"nft|ofc|":fb&&Yb.has(Ka)?"ofv|ofs|t|":!fb&&Yb.has(Ka)?"ofe|ofs|t|":fb?
"ofv|ofc|":"ofe|";fb=ha+fb}else fb=M(fb)?Ka+"ofv|ofc|":Ka+"ofe|";ha=Ha.SessionOrigin?"or|"+Ha.SessionOrigin+"|":"";ha+=Ha.ClickTime?"ct|"+Ha.ClickTime+"|":"";ha+=Ha.CorrelationId?"cid|"+Ha.CorrelationId+"|":"";Ka=fb+U(ha);La+=U(Ka+"u|")}La+=U(ua);ua=window.location.href;fb=ua.toLowerCase().indexOf("&wdlor=");-1!=fb?(fb+=7,ha=ua.indexOf("&",fb),ua=-1==ha?ua.substr(fb):ua.substring(fb,ha)):ua=void 0;if(null!=ua&&"undefined"!=typeof ua){fb="";try{fb=decodeURIComponent(ua)}catch(Wc){}0<fb.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(fb)&&
(La=La+"|f|"+fb)}return La}function O(ha,ua,fb,Ka,La,ib){var Yb=za(ha);if(null==Yb)return ba(Ha.DescriptiveUnattemptedEnums?Ia.ProtocolHandlerIsNull:Ia.Unattempted,Ha.Application),!1;ha=R(ha,ua,fb,Ka,Yb);D(ha,K,F,La,ib);return!0}function U(ha){if(m()&&v()){var ua="";try{ua=decodeURI(ha)}catch(fb){}if(ua==ha)return encodeURI(ha)}return ha}function K(){V(pa.ProtocolHandler)}function F(){Ha.Options|=mb.SkipProtocolHandler;fa(Ha,bb,ra)}function I(){null!=Da&&Da(pa.RoamingProtocolHandler)}function P(){null!=
oa&&oa(Ia.ControlNeeded)}function Y(){var ha=document.getElementById("npSharePointPlugin");if(null==ha){ha="application/x-sharepoint";m()&&3<=(n()?C("version/"):0)&&ea("application/x-sharepoint-webkit",!0)&&(ha="application/x-sharepoint-webkit");if(!ea(ha,!0))if(m()&&ea("application/officelive",!0))ha="application/officelive";else return null;var ua=document.createElement("object");ua.id="npSharePointPlugin";ua.type=ha;ua.style.width="0px";ua.style.height="0px";ua.style.setProperty("visibility","hidden",
"");document.body.appendChild(ua);ha=document.getElementById("npSharePointPlugin")}return ha}function ea(ha,ua){var fb=window.navigator.mimeTypes;if(null==fb)return!1;ha=fb[ha];return!ha||ua&&!ha.enabledPlugin?!1:!0}function Ba(ha){try{if(null!=new ActiveXObject(ha))return!0}catch(ua){}return!1}function Fa(ha){switch(ha){case lb.OneNote:return"OneNote.Notebook";default:return""}}function za(ha){if(ha!=lb.OneNote&&r()&&!k())return"office:";switch(ha){case lb.Excel:return"ms-excel:";case lb.OneNote:return"onenote:";
case lb.PowerPoint:return"ms-powerpoint:";case lb.Visio:return"ms-visio:";case lb.Word:return"ms-word:";case lb.Project:return"ms-project:";case lb.Publisher:return"ms-publisher:";case lb.Infopath:return"ms-infopath:";case lb.Access:return"ms-access:";default:return""}}function xa(ha){switch(ha){case lb.Excel:return"root\\office15\\excel.exe";case lb.PowerPoint:return"root\\office15\\powerpnt.exe";case lb.Visio:return"root\\office15\\visio.exe";case lb.Word:return"root\\office15\\winword.exe";case lb.Project:return"root\\office15\\winproj.exe";
case lb.Publisher:return"root\\office15\\mspub.exe";case lb.Infopath:return"root\\office15\\infopath.exe";case lb.Access:return"root\\office15\\msaccess.exe";default:return null}}function fa(ha,ua,fb){Ha=ha;bb=ua;ra=fb;if(ha.DocumentUrl){var Ka=fb=ua=ha.DocumentUrl;try{Ka=decodeURIComponent(ha.DocumentUrl)}catch(Wb){}try{fb=encodeURI(ha.DocumentUrl)}catch(Wb){}ua=ua+""+ha.CorrelationIdForWinClient;Ka+=ha.CorrelationIdForWinClient;fb+=ha.CorrelationIdForWinClient;ha.Mode===db.ReadWrite&&mb.CheckoutRequired===
(ha.Options&mb.CheckoutRequired)&&(ha.Mode=db.ForceCheckout);mb.HostIsEditOnly===(ha.Options&mb.HostIsEditOnly)&&(ha.Mode=db.WriteOnly);if(N(ha)?0:m()&&(ha.Application==lb.OneNote||ea("application/x-sharepoint-protocolhandler",!1)||ea("application/x-sharepoint-webkit-protocolhandler",!1))||t()||B()||!(b()||z()||"ActiveXObject"in window&&!r()||v())||15<=la())O(ha.Application,ha.EncodeUrl?fb:ua,ha.Mode,ha.Application==lb.OneNote,ha.SilentExternalHandler,ha.NavigateUsingWindowOpen);else{var La;if(La=
l())a:{var ib=ha.EncodeUrl?ua:Ka,Yb=ha.Mode,Wc=Fa(ha.Application);try{La=(new ActiveXObject("SharePoint.OpenDocuments.5")).ViewDocument3(window.self,ib,Yb,Wc);break a}catch(Wb){}La=!1}if(La)V(pa.O15ActiveX);else{if(b()||z()){var Qc=ha.EncodeUrl?ua:Ka;Ka=ha.Mode;La=Fa(ha.Application);ib=Y();if(null==ib)Qc=Ha.DescriptiveUnattemptedEnums?Ia.PluginIsNull:Ia.Unattempted;else{Yb=!1;try{Yb=ib.ViewDocument3(window.self,Qc,Ka,La)}catch(Wb){}if(!Yb)try{Yb=M(Ka)?ib.ViewDocument2(window.self,Qc,La):ib.EditDocument2(window.self,
Qc,La)}catch(Wb){}Yb?(V(pa.NpapiPlugin),Qc=Ia.None):Qc=Ia.Failed}}else{try{Qc=new ActiveXObject("IDBHO.IDBHOCtrl"),null!=Qc&&Qc.SaveSSOCreds()}catch(Wb){}Qc=Q(ha.EncodeUrl?ua:Ka,ha.Mode,ha.Options,Fa(ha.Application))}if(Qc!=Ia.None){if(Ka=ha.CouldUseRoamingApps)ka||(ka=!0,wa=d("Windows NT")),Ka=6.1<=wa&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(w()||z()||v());if(Ka&&ha.Application!=lb.OneNote){if(!c.Dyb.Qcl()){ba(Ia.ControlNeeded,Ha.Application);return}if(ha.RoamingAppsLauncher){"undefined"==
typeof ha.RoamingAppsLauncher||null==ha.RoamingAppsLauncher?ba(Ha.DescriptiveUnattemptedEnums?Ia.RoamingLauncherIsNull:Ia.Unattempted,Ha.Application):"undefined"==typeof ha.RoamingBitsUrl||null==ha.RoamingBitsUrl?c.Dyb.Kel(ha.DocumentUrl,ha.RoamingAppsLauncher,ha.Application,ha.ApplicationParameters,bb,ra):c.Dyb.H$g(ha.DocumentUrl,ha.RoamingAppsLauncher,ha.RoamingApplicationExe,ha.ApplicationParameters,ha.RoamingPlatform,ha.RoamingBitsUrl,bb,ra);return}if(!ha.ContinueIfLauncherIsNull){ba(Ia.LauncherNeeded,
Ha.Application);return}}mb.NoProtocolHandlerFallback==(ha.Options&mb.NoProtocolHandlerFallback)||N(ha)||w()||m()&&!(Ha.DescriptiveUnattemptedEnums?Qc>=Ia.O14Unattempted&&Qc<=Ia.DocumentUrlIsNull:Qc==Ia.Unattempted)?ba(Qc,Ha.Application):O(ha.Application,ha.EncodeUrl?fb:ua,ha.Mode,ha.Application==lb.OneNote,ha.SilentExternalHandler,ha.NavigateUsingWindowOpen)}}}}else ba(Ha.DescriptiveUnattemptedEnums?Ia.DocumentUrlIsNull:Ia.Unattempted,Ha.Application)}function V(ha){null!=bb&&bb(ha)}function ba(ha,
ua){"undefined"==typeof ua&&(ua=null);null!=ra&&ra(ha,ua)}function la(){var ha=0;if(b()||z()||v()){var ua=Y();try{null!=ua&&(ha=ua.GetOfficeVersion())}catch(fb){}}else Ba("SharePoint.OpenDocuments.5")?ha=15:Ba("SharePoint.OpenDocuments.4")?ha=14:Ba("SharePoint.OpenDocuments.3")?ha=12:Ba("SharePoint.OpenDocuments.2")&&(ha=11);return ha}function Ta(){return m()&&(ea("application/x-sharepoint",!0)||ea("application/x-sharepoint-webkit",!0))}var Ea="",sa="",Ya="",bb,ra,Da,oa,Ha,ka,wa,Za,ab,db={ReadWrite:0,
ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},mb={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},Ia={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},pa={Unknown:0,
NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},lb={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:db,OpenDocumentOptions:mb,OpenDocumentFailureType:Ia,OpenDocumentControl:pa,OfficeApplication:lb,EditDocumentInClient:fa,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=
lb.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.DocumentExtension=this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:la,IsO14MacPluginInstalled:Ta,
OfferOfficeInDialog:function(){return f()&&11>=la()},OfferOfficeNoIntrusive:function(){return f()&&15>la()},OfferMacOffice:function(){return m()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!Ta()},InstallRoamingControl:function(){u()?window.InstallTrigger.install({Office:{URL:sa}}):W(Ya,null,null)},CanUseRoamingControl:function(){if(t())return!0;if(v())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];
if(u()){var ha=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(ha);var ua=document.createEvent("Events");ua.initEvent("RoamingOfficeInstalled",!0,!1);ha.dispatchEvent(ua);return!!ha.getAttribute("installed")}if(w())try{return(new ActiveXObject("RoamingOfficeActiveX.RoamingOffice")).HrExists()}catch(fb){}return!1},InitUrls:function(ha,ua,fb){Ea=ha;sa=fb;Ya=ua},LaunchRoamingApps:function(ha,ua,fb,Ka,La,ib){c.Dyb.H$g(ha,ua,xa(fb),Ka,"x86",Ea,La,ib)},LaunchRoamingApps2:function(ha,
ua,fb,Ka,La,ib,Yb,Wc){var Qc="";null!=Ka&&(Qc+=" "+Ka);null!=ha&&(Qc+=' "'+ha+'"');if(t()||v())Da=Yb,oa=Wc,Yb='office: "'+(ib+'" "')+(fb+'" "ROAMING"'),Yb+=' "'+ua+'"',Yb+=' "'+La+'"',Yb+=" "+Qc,D(Yb,I,P,!1,!1);else if(u())ha=document.createElement("RoamingExtensionElement"),ha.setAttribute("cabUrl",ib),ha.setAttribute("app",fb),ha.setAttribute("licensingEntitlements",ua),ha.setAttribute("platform",La),ha.setAttribute("args",Qc),document.documentElement.appendChild(ha),ua=document.createEvent("Events"),
ua.initEvent("RoamingOfficeLaunch",!0,!1),ha.dispatchEvent(ua),null!=Yb&&Yb(pa.RoamingFFExtension);else if(w()){if(ha=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=ha)try{ha.HrConfigureSingle(ib,fb,ua,La,Qc),null!=Yb&&Yb(pa.RoamingActiveX)}catch(Wb){}}else null!=Wc&&Wc(Ia.Failed)},ShouldShowDialog:function(){return!r()},NavigateToUrlUsingClickingOnATag:J,OpenDocumentWithProtocolHandler:O,OpenDocumentWithProtocolHandlerNoCallBack:function(ha,ua,fb,Ka){var La=za(ha);if(null==La)return ba(Ha.DescriptiveUnattemptedEnums?
Ia.ProtocolHandlerNoCallbackIsNull:Ia.Unattempted,Ha.Application),!1;ha=R(ha,ua,fb,Ka,La);D(ha,null,null,!1,!1);return!0}}}();c.ClientUtils=c.Dyb},1279:function(y,x,a){a.d(x,"a",function(){return k});y=a(0);var c=a(1121),b=a(1545),f=a(6),r=a(85),d=a(23);class k{constructor(t,m,e,w,l,u){this.Z8=t;this.a9=m;this.Q$c=e;this.oN=w;this.kcc=l;this.E9a=u}get tRg(){return!this.a9&&!this.Q$c}get Ncg(){return 2===this.E9a?Object(d.a)("OICErrorC2ROneNoteOffer"):Object(d.a)("OICErrorC2ROffer")}get id(){return"OICErrorDialogWithTrial"}get Kqf(){return Object(d.a)("OICErrorMessageNoOffice")}get fQf(){return Object(d.a)("OICErrorIHaveOfficeButton")}get NJa(){return Object(d.a)("OICErrorHelpLink")}get JOf(){return"OICFailure"}get icon(){return 3}get actionButtonText(){return 2===
this.E9a?Object(d.a)("OICErrorC2RInstallOneNoteButton"):Object(d.a)("OICErrorC2RInstallButton")}get dialogTitle(){return Object(d.a)("DefaultDialogTitle")}Uak(t){this.edg(t)}juj(t){this.edg(t)}edg(t){let m=10;1===t?(Object(c.a)().Ftj(this.E9a),m=3):2===t&&((!this.Q$c||this.Q$c(this.oN))&&this.a9&&b.a.instance.f4h(this.a9,this.Z8,this.oN),m=5);(0===t||1===t)&&this.Z8&&this.Z8(this.oN);f.AFrameworkApplication.tTc(r.a.Mpg,this.kcc,m);this.dispose()}dispose(){this.oN=this.a9=this.Z8=null}}Object(y.a)(k,
"AOICErrorDialogWithTrial",null,[2])},1454:function(y,x,a){a.r(x);a.d(x,"ReactOICErrorDialogWithTrial",function(){return r});y=a(0);var c=a(139);x=a(1279);var b=a(644),f=a(236);class r extends x.a{constructor(d,k,t,m,e,w){super(d,k,t,m,e,w);k={["errorMessage"]:this.Kqf,["offerString"]:this.Ncg};d=new f.a(!1,!1,!0);this.tRg?(d.Bh=1,k.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.NJa,["onExecute"]:()=>{b.a.showHelp(this.JOf)}}):(d.Bh=4,d.Yh(2,this.fQf));d.Yh(1,this.actionButtonText);
d.Lk=this.id;k={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:k};d.initializeAndShow(this.dialogTitle,Object(c.a)(this,this.Uak,"reactOICErrorDialogWithTrialHandler"),k)}}Object(y.a)(r,"ReactOICErrorDialogWithTrial",x.a,[])},1455:function(y,x,a){a.r(x);a.d(x,"OICErrorDialogWithTrial",function(){return f});y=a(0);var c=a(139);x=a(1279);var b=a(187);class f extends x.a{constructor(r,d,k,t,m,e){super(r,d,k,t,m,e);r=document.createElement("span");r.innerText=this.Kqf;r.appendChild(document.createElement("br"));
r.appendChild(document.createElement("br"));d=document.createElement("span");d.innerText=this.Ncg;r.appendChild(d);d=new b.a;this.tRg?(d.Bh=1,d.$Ze(this.NJa,this.JOf)):(d.Bh=4,d.Yh(2,this.fQf));d.Yh(1,this.actionButtonText);d.Lk=this.id;d.Io(this.dialogTitle,null,this.icon,Object(c.a)(this,this.juj,"legacyOICErrorDialogWithTrialHandler"),r)}}Object(y.a)(f,"OICErrorDialogWithTrial",x.a,[])},1545:function(y,x,a){a.d(x,"a",function(){return C});y=a(0);var c=a(139),b=a(1122),f=a(14),r=a(6),d=a(85),k=
a(644),t=a(23);class m{constructor(D,J,W,N){this.jdd=null;this.kcc=N;this.Z8=D;this.a9=J;this.oN=W;this.VUe=this.L8f.Erl;D=Object(t.a)("OICErrorMacOfficeOffer").split("{0}");this.vlh=D[0];this.ulh=D[1]}get L8f(){return this.jdd||(this.jdd=Object(b.a)())}get id(){return"OICErrorDialog"}get errorMessage(){return Object(t.a)("OICErrorMessage")}get NJa(){return Object(t.a)("OICErrorHelpLink")}get JPg(){return this.VUe}get N8f(){return this.vlh}get M8f(){return this.ulh}get K8f(){return Object(t.a)("OICErrorMacOFficeLink")}get icon(){return this.VUe?
3:2}get lNb(){return Object(t.a)("OICErrorFileDownloadOffer")}get Tpc(){return!!this.a9}get mNb(){return Object(t.a)("OICErrorNoOfficeDownloadButton")}get dialogTitle(){return Object(t.a)("DefaultDialogTitle")}sde(D){this.GZb(D)}v_d(D){this.GZb(D)}GZb(D){let J=10;this.a9&&1===D&&(this.a9(this.oN),J=1);this.Z8&&this.Z8(this.oN);this.wC(J)}Q2a(){k.a.showHelp("OICFailure");this.wC(2)}P5d(){this.L8f.Djl();this.wC(4)}wC(D){f.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",
this.kcc,D);r.AFrameworkApplication.tTc(d.a.Kpg,this.kcc,D)}dispose(){this.oN=this.Z8=this.a9=null}}Object(y.a)(m,"AOICErrorDialog",null,[2]);var e=a(52),w=a(187);class l extends m{constructor(D,J,W,N){super(D,J,W,N);this.QDa=this.zA=null;D=document.createElement("span");D.id="errorMessageText";D.innerText=this.errorMessage;D.appendChild(document.createElement("br"));D.appendChild(document.createElement("br"));this.zA=document.createElement("a");this.zA.href="#";this.zA.innerText=this.NJa;D.appendChild(this.zA);
e.a.addHandler(this.zA,"click",Object(c.a)(this,this.Q2a,"oicErrorHelpLinkHandler"));J=new w.a;J.Lk=this.id;this.JPg?(W=document.createElement("span"),N=document.createElement("span"),W.innerText=this.N8f,N.innerText=this.M8f,this.QDa=document.createElement("a"),this.QDa.href="#",this.QDa.innerText=this.K8f,D.appendChild(document.createElement("br")),D.appendChild(W),D.appendChild(this.QDa),D.appendChild(N),e.a.addHandler(this.QDa,"click",Object(c.a)(this,this.P5d,"oicErrorMacOfferLinkHandler"))):
this.Tpc&&(D.appendChild(document.createElement("br")),D.appendChild(document.createElement("br")),W=document.createElement("span"),W.innerText=this.lNb,D.appendChild(W));this.Tpc?(J.Bh=1,J.Yh(1,this.mNb)):J.Bh=0;J.Io(this.dialogTitle,null,this.icon,Object(c.a)(this,this.v_d,"legacyOICErrorDialogHandler"),D);J.nia("errorMessageText")}dispose(){this.zA&&(e.a.removeHandler(this.zA,"click",Object(c.a)(this,this.Q2a,"oicErrorHelpLinkHandler")),this.zA=null);this.QDa&&(e.a.removeHandler(this.QDa,"click",
Object(c.a)(this,this.P5d,"oicErrorMacOfferLinkHandler")),this.QDa=null);super.dispose()}}Object(y.a)(l,"OICErrorDialog",m,[]);class u{constructor(D,J,W){this.Z8=J;this.a9=D;this.oN=W}get id(){return"OICErrorDialogWithDownload"}get Lqf(){return Object(t.a)("OICErrorNoOfficeDetected")}get NJa(){return Object(t.a)("OICErrorHelpLink")}get lNb(){return Object(t.a)("OICErrorFileDownloadOffer")}get mNb(){return Object(t.a)("OICErrorNoOfficeDownloadButton")}get icon(){return 2}get dialogTitle(){return Object(t.a)("DefaultDialogTitle")}sde(D){this.GZb(D)}v_d(D){this.GZb(D)}GZb(D){let J=
10;1===D&&(this.a9(this.oN),J=1);this.Z8&&this.Z8(this.oN);this.wC(J)}Q2a(){k.a.showHelp("OICFailure");this.wC(2)}wC(D){r.AFrameworkApplication.tTc(d.a.Lpg,3,D)}dispose(){this.oN=this.a9=this.Z8=null}}Object(y.a)(u,"AOICErrorDialogWithDownload",null,[2]);class n extends u{constructor(D,J,W){super(D,J,W);this.zA=null;D=document.createElement("span");D.id="errorMessageText";D.innerText=this.Lqf;D.appendChild(document.createElement("br"));D.appendChild(document.createElement("br"));this.zA=document.createElement("a");
this.zA.href="#";this.zA.innerText=this.NJa;D.appendChild(this.zA);e.a.addHandler(this.zA,"click",Object(c.a)(this,this.Q2a,"oicErrorHelpLinkHandler"));D.appendChild(document.createElement("br"));D.appendChild(document.createElement("br"));J=document.createElement("span");J.innerText=this.lNb;D.appendChild(J);J=new w.a;J.Lk=this.id;J.Bh=1;J.Yh(1,this.mNb);J.Io(this.dialogTitle,null,this.icon,Object(c.a)(this,this.v_d,"legacyOICErrorDialogHandler"),D);J.nia("errorMessageText")}dispose(){this.zA&&(e.a.removeHandler(this.zA,
"click",Object(c.a)(this,this.Q2a,"oicErrorHelpLinkHandler")),this.zA=null);super.dispose()}}Object(y.a)(n,"OICErrorDialogWithDownload",u,[]);var v=a(236);class B extends m{constructor(D,J,W,N){super(D,J,W,N);J={["errorMessage"]:this.errorMessage};J.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.NJa,["onExecute"]:M=>{this.Q2a(M)}};this.JPg?(J.macOfficePreLinkText=this.N8f,J.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.K8f,["onExecute"]:M=>{this.P5d(M)}},
J.macOfficePostText=this.M8f):this.Tpc&&(J.errorFileDownloadOffer=this.lNb);D=new v.a(!1,!1,!0);this.Tpc?(D.Bh=1,D.Yh(1,this.mNb)):D.Bh=0;D.Lk=this.id;J={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:J};D.initializeAndShow(this.dialogTitle,Object(c.a)(this,this.sde,"reactOICErrorDialogHandler"),J)}}Object(y.a)(B,"ReactOICErrorDialog",m,[]);class z extends u{constructor(D,J,W){super(D,J,W);J={["errorMessage"]:this.Lqf,["errorFileDownloadOffer"]:this.lNb};J.helpLink={["type"]:"AppLinkProps",
["id"]:"helpLink",["text"]:this.NJa,["onExecute"]:N=>{this.Q2a(N)}};D=new v.a(!1,!1,!0);D.Bh=1;D.Yh(1,this.mNb);D.Lk=this.id;J={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:J};D.initializeAndShow(this.dialogTitle,Object(c.a)(this,this.sde,"reactOICErrorDialogHandler"),J)}}Object(y.a)(z,"ReactOICErrorDialogWithDownload",u,[]);class C{constructor(){this.MBb=!!r.AFrameworkApplication.ra&&r.AFrameworkApplication.ra.$d.zM}e4h(D,J,W){this.MBb?new B(D,J,null,W):new l(D,J,null,W)}f4h(D,J,W){this.MBb?
new z(D,J,W):new n(D,J,W)}g4h(D,J,W,N,M){const {ReactOICErrorDialogWithTrial:Q}=a(1454),{OICErrorDialogWithTrial:R}=a(1455);this.MBb?new Q(D,J,W,null,N,M):new R(D,J,W,null,N,M)}static get instance(){return C.Wa||(C.Wa=new C)}}C.Wa=null;Object(y.a)(C,"OICErrorDialogFactoryImpl",null,[869])},608:function(y,x,a){a.r(x);var c={};a.r(c);a.d(c,"DownloadAForkedCopyActivity",function(){return P});var b={};a.r(b);a.d(b,"DownloadACopyPreDatalossActivity",function(){return Y});var f={};a.r(f);a.d(f,"OpenInExcelClientActivity",
function(){return Fa});var r={};a.r(r);a.d(r,"OpenInExcelOperation",function(){return gc});var d=a(179),k=a(0),t=a(14),m=a(96),e=a(158),w=a(268),l=a(736),u=a(40),n=a(238),v=a(122),B=a(39),z=a(60),C=a(263),D=a(47),J=a(8),W=a(36),N=a(75),M=a(672);class Q extends C.a{constructor(rb,cc){super(rb);this.P7k=["id","sessionId","workbookType","workbookFileType","dataloss"];this.command=0;this.h_b=()=>{const mc=this.PIi();if(mc){this.$.rP(!0);if(-2028960985!==this.command&&1461300262!==this.command){const Sa=
N.a(this.$).ij.activityState;Sa[W.a.Bcb]=J.a.download;Sa[M.a.pjc]=this.command}D.a(this.$).CD(mc.Errors)}};this.iframe=rb;this.$=cc;this.Wi.Aa("load",this.h_b)}get b7i(){return"loading"!=this.iframe.contentDocument.readyState&&"uninitialized"!=this.iframe.contentDocument.readyState}hXa(rb,cc){const mc={};(rb=this.dsi(rb,mc))&&z.a.i1b("dlfr",rb,mc);this.command=cc}dsi(rb,cc){var mc=rb.split("?");if(2!==mc.length)return rb=null,t.ULS.sendTraceTag(537154816,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (missing '?')"),
rb;mc=mc[1].split("&");for(const pb of mc){var Sa=pb.split("=",2);if(2!==Sa.length){rb=null;t.ULS.sendTraceTag(537154787,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (key value pair has no '=' sign)");break}mc=Sa[0];this.P7k.includes(mc)&&(Sa=decodeURIComponent(Sa[1]),cc[mc]=Sa,rb=n.a.U2b(rb,mc))}return rb}reset(){this.iframe&&(this.iframe.src="about:blank");this.command=1461300262}PIi(){try{return this.iframe.contentWindow.ewaResult}catch(rb){if(!this.$.ea.th.isDivSyndicated){const cc=
window.document.referrer.match(RegExp("://(.[^/]+)/"));t.ULS.sendTraceTag(537154785,0,50,`FileLoader.OnFrameLoad: parent domain: ${1<cc.length?cc[1]:""}, current domain: ${escape(window.location.host)}, iframe domain: ${escape(this.iframe.contentWindow.location.host)}. ewaControl IsCrossDomain: ${this.$.Wlb}`);throw rb;}return null}}static d6e(rb){let cc=document.createElement("iframe");cc.id="ewaFileLoader";cc.style.cssText="height:0;width:0;display:none";cc.src="about:blank";cc.setAttribute("name",
"dlfr");cc=rb.domElement.appendChild(cc);return new Q(cc,rb)}}Object(k.a)(Q,"FileLoader",C.a,[]);var R=a(170),O=a(66);class U{constructor(rb,cc){this.Oi=()=>{B.a.Em(N.a(this.$).ij.activityState,R.a.O5d)||this.ZHa.reset()};this.$=cc;this.hKc=rb;this.ea=cc.ea;this.ea.uq(this.Oi);this.ZHa=Q.d6e(this.$)}$di(){const rb=this.QMh(this.$),cc=this.$.userOperationManager.operationCount;0<cc&&t.ULS.sendTraceTag(537154822,0,15,`flushing queue in downloadcopy. Queue is ${cc}`);this.$.userOperationManager.b0("DownloadACopyOperation.DownloadForkedFile");
this.hKc&&t.ULS.sendTraceTag(537154821,0,50,"DownloadACopyOperation - Dataloss scenario");this.ZHa.hXa(rb,-21742208);u.TaskExtensions.Ua(O.Task.delay(1),()=>{this.wQf()},this.ZHa.xa,3)}dispose(){this.ea&&this.ea.pq(this.Oi);this.$=this.ea=null}wQf(rb=null){rb||(rb=this.$.qh.vi("LoadResource","DownloadACopyOperation"));!this.ZHa.b7i&&rb.ii<U.t9f?window.setTimeout(()=>{this.wQf(rb)},U.bei):(rb.ii>=U.t9f&&t.ULS.sendTraceTag(537154820,0,15,"Download did not complete after 10 seconds."),N.a(this.$).ij.NT())}QMh(rb){const cc=
new Sys.StringBuilder,mc=rb.workbookContext,Sa=rb.ua;cc.append(rb.zAa);cc.append(Sa.FileHandlerRelativeUri);cc.append("?id=");cc.append(encodeURIComponent(n.a.U2b(mc.WorkbookUri,"sc")));rb.ea.Ph&&(cc.append("&sessionId="),cc.append(encodeURIComponent(rb.ea.sessionId)));cc.append("&workbookType=FullForkedWorkbook");cc.append("&dataloss=");cc.append(this.hKc?"true":"false");v.a.ZGb(cc,Sa);return cc.toString()}}U.t9f=1E5;U.bei=100;Object(k.a)(U,"DownloadACopyOperation",null,[2]);class K extends w.a{constructor(rb,
cc,mc){super(rb,cc);this.WXb=null;this.r8d=Sa=>{this.unsubscribe(pb=>{Sa.remove_disposing(pb)});this.Wn(J.a.jq);this.Tw()};this.hKc=mc}execute(rb){const cc=Object(e.a)(10,rb.sk);if(!cc.iaa)return t.ULS.sendTraceTag(508610328,0,50,"DownloadAForkedCopyActivity.Execute: blocking Download action as the workbook is protected"),this.QRd(rb),this.Wn(J.a.idle),1;this.WXb||(this.WXb=new U(this.hKc,cc));this.WXb.$di();t.ULS.shipAssertTag(508610327,0,3!==N.a(cc).Dp.aE,"The current activity should not be closed.");
return 1}QRd(rb){const cc=Object(e.a)(10,rb.sk),mc=new l.a(cc);this.subscribe(rb,this.r8d,Sa=>{mc.add_disposing(Sa)});t.ULS.sendTraceTag(50954707,0,50,"DownloadAForkedCopyActivity.ProtectedFileDataLeakErrorDialog: showing alert dialog to user");mc.initialize();mc.us()}dispose(){m.a.Ng(this.WXb);this.WXb=null;super.dispose()}}Object(k.a)(K,"DownloadAForkedCopyActivityAbstract",w.a,[]);var F=a(5),I=a(97);let P=class extends K{constructor(){super(J.a.unmergeableDownloadCopy,J.a.QBa,!1)}};P=Object(d.__decorate)([Object(I.d)(F.Bb),
Object(d.__param)(0,Object(F.ab)())],P);Object(k.a)(P,"DownloadAForkedCopyActivity",K,[]);let Y=class extends K{constructor(){super(J.a.khb,J.a.jq,!0)}};Y=Object(d.__decorate)([Object(I.d)(F.Cb),Object(d.__param)(0,Object(F.ab)())],Y);Object(k.a)(Y,"DownloadACopyPreDatalossActivity",K,[]);var ea=a(126),Ba=a(443);let Fa=class extends ea.a{constructor(rb,cc=J.a.openInExcelClient,mc=J.a.idle){super(cc,mc)}execute(rb){const cc=Object(e.a)(10,rb.sk);void I.a.resolve(F.je,{va:0}).then(mc=>{cc.downloadCopyOnOpenInClient?
(rb.activityState[Ba.a.WYe]=!0,mc.fUg()):mc.dZh()});return 1}};Fa=Object(d.__decorate)([Object(I.d)(F.ie),Object(d.__param)(0,Object(F.ab)())],Fa);Object(k.a)(Fa,"OpenInExcelClientActivity",ea.a,[]);var za=a(42),xa=a(6),fa=a(81),V=a(592),ba=a(38);a(1122);var la=a(1121),Ta=a(139),Ea=a(1545),sa=a(236),Ya=a(168),bb=a(286),ra=a(17),Da=a(100),oa=a(154),Ha=a(475);const ka=rb=>{for(let cc=0;cc<rb.children.length;cc++){const mc=rb.children[cc];mc.style.position="relative";mc.style.top=(mc.parentNode.offsetHeight-
mc.offsetHeight)/2+"px"}},wa=rb=>rb.La.keyCode===Da.a.fu||rb.La.keyCode===Da.a.aCa?(rb.Qh.click(),!0):!1,Za=(rb,cc,mc,Sa,pb,Ac,yd)=>{const vb=document.createElement("a");vb.className="ProtocolLaunchingDialogButtonAnchor";vb.className+=" OICDialog";vb.id=rb;vb.setAttribute(Ha.a.Oj,Ha.a.fF);vb.style.padding="0";vb.style.margin="0";Sa&&ab(pb,cc,mc,Sa,vb);rb=document.createElement("span");rb.className="ProtocolLaunchingDialogButtonLabel";rb.innerText=pb;vb.appendChild(rb);vb.tabIndex=0;Ac&&bb.a.instance.ya(ra.a.click,
vb,Ac);yd&&oa.a.instance.ya(ra.a.Rj,vb,yd);return vb},ab=(rb,cc,mc,Sa,pb)=>{var Ac=document.createElement("img");Ac.alt=rb;Ac.className=Ya.d(mc,Sa);Ac.src=cc;Ac.setAttribute(Ha.a.Oj,Ha.a.Yy);rb=document.createElement("span");rb.className="ProtocolLaunchingDialogImg32Container";rb.appendChild(Ac);Ac=document.createElement("span");Ac.className="ProtocolLaunchingDialogIconContainer";Ac.appendChild(rb);pb.appendChild(Ac)};var db=a(23);class mb{static get Po(){return sa.a.UA(mb.$v,Object(db.a)("OICLaunchDialogTitle"))}}
mb.$v="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(k.a)(mb,"OICLaunchDialogHtml",null,[]);var Ia=a(28);class pa extends sa.a{constructor(rb){super();this.K9a=this.TQa=null;this.qAb=!1;this.emg=()=>{this.hide();this.vw.Otb();return!0};this.fmg=()=>{t.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();xa.AFrameworkApplication.jh.Gk(Ia.a.I5a,2);return!0};this.vJj=()=>{this.vw.Otb()};this.vw=rb;this.Po=mb.Po;this.Bh=5;this.Lk="OICLaunchDialog";this.showDialog("",this.vJj);this.pMg();this.nia("ProtocolLaunchingDialogTitle");
4!==xa.AFrameworkApplication.ra.$d.editMode&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=Object(db.a)("OICLaunchDialogTitleForView"));this.KV(this.TQa);t.ULS.sendTraceTag(22140865,211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}gNc(){this.TQa=Za("BtnRichClient",this.vw.oMb,this.vw.rSb,this.vw.oQd,Object(db.a)("OICLaunchRichClient"),this.fmg,wa);document.getElementById("OICLaunchRichClient").appendChild(this.TQa);ka(this.TQa);
this.K9a=Za("BtnReturn",this.vw.oMb,this.vw.rSb,this.vw.HQf,Object(db.a)("OICReturnToOnlineClient"),this.emg,wa);document.getElementById("OICReturnToApp").appendChild(this.K9a);ka(this.K9a)}dispose(){this.qAb||(this.TQa&&(bb.a.instance.Na(ra.a.click,this.TQa,this.fmg),oa.a.instance.Na(ra.a.Rj,this.TQa,wa)),this.K9a&&(bb.a.instance.Na(ra.a.click,this.K9a,this.emg),oa.a.instance.Na(ra.a.Rj,this.K9a,wa)),super.dispose(),this.qAb=!0)}}Object(k.a)(pa,"OICLaunchDialog",sa.a,[]);class lb{static get Po(){return sa.a.UA(lb.$v,
Object(db.a)("OICDialogTitle"))}}lb.$v="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(k.a)(lb,"ProtocolLaunchingDialogV2Html",null,[]);a(644);var ha=a(123),ua=a(34);class fb extends sa.a{constructor(rb){super();this.J9a=this.sra=null;this.qAb=!1;this.ECa=null;this.wgg=cc=>this.p6d(cc,0);this.Xhg=cc=>this.p6d(cc,2);this.dmg=cc=>this.p6d(cc,1);this.rgg=()=>{this.hide();4===xa.AFrameworkApplication.ra.$d.editMode?(t.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.vw.Otb()):(t.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.vw.PNd());
return!0};this.aNc=()=>{t.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");this.vw.pMf();return!0};this.bOc=()=>{t.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";xa.AFrameworkApplication.jh.Gk(Ia.a.I5a,2);return!0};this.LQc=()=>{this.vw.Otb()};this.vw=rb;this.Po=lb.Po;this.Bh=5;this.Lk="ProtocolLaunchingDialog";this.P7c="OICRetryDialog";xa.AFrameworkApplication.pp.HZa&&xa.AFrameworkApplication.pp.W3b();xa.AFrameworkApplication.pp.Ol(new ha.a(2,
1,5E3,()=>{this.MTk()},101));this.showDialog("",this.LQc);this.pMg();this.nia("Issues");this.gyf();t.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}gNc(){const rb=document.getElementById("Issues");if(rb){ab("",this.vw.oMb,this.vw.rSb,this.vw.oQd,rb);var cc=document.createElement("span");cc.className="WACDialogSectionTitle";cc.innerText=5===this.vw.v9d?Object(db.a)("OICBrowserDialogTitle"):Object(db.a)("OICDialogSectionTitle");
rb.appendChild(cc);ka(rb);rb.style.display="none"}xa.AFrameworkApplication.ra.$d.dNd?(cc=Object(db.a)("OICDialogSectionGiveFeedback"),this.J9a=Za("GiveFeedback",this.vw.oMb,this.vw.rSb,"",cc,this.aNc,this.Xhg),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.J9a),ka(this.J9a)):document.getElementById("ButtonGiveFeedback").style.display="none";0===xa.AFrameworkApplication.ra.$d.editMode||xa.AFrameworkApplication.Abi?document.getElementById("ButtonEdit").style.display=
"none":(cc=2===xa.AFrameworkApplication.ra.$d.Om?4===xa.AFrameworkApplication.ra.$d.editMode?Object(db.a)("OICResumeEditing"):Object(db.a)("OICReturnToOnlineClient"):4===xa.AFrameworkApplication.ra.$d.editMode?Object(db.a)("OICResumeEditing"):Object(db.a)("OICContinueInBrowser"),this.sra=Za("Edit",this.vw.oMb,this.vw.rSb,"",cc,this.rgg,this.wgg),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.sra),ka(this.sra));0===xa.AFrameworkApplication.ra.$d.editMode&&!xa.AFrameworkApplication.qGc&&
rb&&(rb.style.display="none")}jyf(){return this.ECa?(this.KV(this.ECa),!0):!1}gyf(){return this.sra?(this.KV(this.sra),!0):!1}p6d(rb,cc){let mc=!1;if(rb.La.keyCode===Da.a.fu||rb.La.keyCode===Da.a.aCa)rb.Qh.click(),mc=!0;else if(rb.La.keyCode===Sys.UI.Key.down||rb.La.keyCode===Sys.UI.Key.up)switch(cc){case 1:mc=this.gyf();break;case 0:mc=this.jyf()}return mc}MTk(){var rb=document.getElementById("ProtocolLaunchingDialogTitle");if(rb){rb.innerText=Object(db.a)("OICDialog2ndTitle");if(rb=document.getElementById("Issues"))rb.style.display=
"block";(rb=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!rb.children.length&&(this.ECa=Za("RetryOIC","","","",Object(db.a)("OICDialogRetry"),this.bOc,this.dmg),rb.appendChild(this.ECa),ka(this.ECa),this.sra||this.jyf())}}dispose(){this.qAb||(this.sra&&(bb.a.instance.Na(ra.a.click,this.sra,this.rgg),oa.a.instance.Na(ra.a.Rj,this.sra,this.wgg)),this.J9a&&(bb.a.instance.Na(ra.a.click,this.J9a,this.aNc),oa.a.instance.Na(ra.a.Rj,this.J9a,this.Xhg)),this.ECa&&(bb.a.instance.Na(ra.a.click,
this.ECa,this.bOc),oa.a.instance.Na(ra.a.Rj,this.ECa,this.dmg)),super.dispose(),this.qAb=!0)}}Object(k.a)(fb,"ProtocolLaunchingDialog",sa.a,[]);var Ka=a(187),La=a(605);class ib extends Ka.a{constructor(rb){super();this.aNc=cc=>{t.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");this.Ogg(cc)};this.bOc=()=>{t.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");xa.AFrameworkApplication.jh.Gk(Ia.a.I5a,2)};this.LQc=cc=>{ib.tNf?3===cc?this.IFg():2===cc||0===cc?this.kff():1===cc&&this.IUh():
2===cc?this.IFg():(1===cc||0===cc)&&this.kff()};this.vw=rb;this.Lk="ProtocolLaunchingDialog";xa.AFrameworkApplication.pp.HZa&&xa.AFrameworkApplication.pp.W3b();xa.AFrameworkApplication.ra.$d.dNd&&this.PZe(Object(db.a)("OICStandardDialogSectionGiveFeedback"),this.aNc);ib.tNf?(this.Bh=12,this.Yh(1,Object(db.a)("CloseFile")),this.Yh(2,Object(db.a)("OICDialogContinueHere")),this.Yh(3,Object(db.a)("OICDialogLaunchAgain"))):(this.Bh=4,this.Yh(1,Object(db.a)("OICDialogContinueHere")),this.Yh(2,Object(db.a)("OICDialogLaunchAgain")));
xa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.areErrorEnhancementsForSimplifiedLanguageInErrorDescriptionsEnabled",!1)?(this.maxWidth=390,rb=5===this.vw.v9d?Object(db.a)("OICBrowserDialogTitle"):Object(db.a)("OICStandardDialogEnhancedSectionTitle"),this.qpb(Object(db.a)("OICDialog3rdTitle"),rb,null,null,this.LQc,null)):(rb=5===this.vw.v9d?Object(db.a)("OICBrowserDialogTitle"):Object(db.a)("OICStandardDialogSectionTitle"),this.qpb(Object(db.a)("OICDialog2ndTitle"),
rb,null,null,this.LQc,null))}IUh(){t.ULS.sendTraceTag(577783557,211,50,"Closing the document");xa.AFrameworkApplication.jh.Xj(Ia.a.close,2,La.a)}IFg(){t.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(this.bOc,0)}kff(){4===xa.AFrameworkApplication.ra.$d.editMode||xa.AFrameworkApplication.fa.la("WordConsumptionViewToEditRedirectIsEnabled")&&1===xa.AFrameworkApplication.ra.mode?(t.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.vw.Otb()):(t.ULS.sendTraceTag(593602689,
211,50,"Switch to edit doc in browser"),this.vw.PNd())}static get tNf(){return xa.AFrameworkApplication.fa.la("OICDialogThreeActions")&&32===xa.AFrameworkApplication.jh.Gk(Ia.a.close,1)}}Object(k.a)(ib,"StandardProtocolLaunchingDialog",Ka.a,[]);var Yb=a(1048);class Wc{}Object(k.a)(Wc,"EditDocumentInClientParams",null,[]);class Qc{static RAd(rb,cc,mc,Sa,pb,Ac,yd=!1,vb=!1,Sc="",hd=!1,qc=!1,Lc=!1,bd="",jd="",Yd="",te=""){const oe=new Wc;oe.DocumentUrl=rb;oe.DocumentExtension=te;oe.Mode=cc;oe.Options=
mc;oe.Application=Sa;oe.SilentExternalHandler=yd;oe.EncodeUrl=vb;oe.CorrelationIdForWinClient=Sc;oe.NavigateUsingWindowOpen=hd;oe.DescriptiveUnattemptedEnums=qc;oe.NoBrowserModalDialogs=Lc;oe.SessionOrigin=bd;oe.CorrelationId=jd;oe.ClickTime=Yd;MSOJS.ClientUtils.EditDocumentInClient(oe,pb,Ac)}}Object(k.a)(Qc,"ClientUtils",null,[]);var Wb=a(107),Jc=a(103),ma=a(537),Hc=a(188),Kb=a(937),pc=a(478),$b=a(159),Ib=a(134),Zb=a(72);class Eb{constructor(rb){this.qsa=this.DHe=this.S9a=null;this.ZAb=!1;this.o8c=
this.jdd=this.oQe=null;this.xbc=this.qN=this.thc="";this.application=this.xL=0;this.zTk=this.Ose=!1;this.Dqk=(cc,mc,Sa)=>mc.contextId!==Ib.a.frame?2:1===Sa?32:this.I5a();this.cdg=()=>{this.gud()};this.ddg=()=>{this.Otb()};this.ojg=()=>{this.j3f()};this.Q6i=()=>this.Vlf(!0);this.V7k=rb&&xa.AFrameworkApplication.fa.la("OICLaunchDialogIsEnabled");xa.AFrameworkApplication.jh.CX(Ia.a.I5a)||xa.AFrameworkApplication.jh.Hh(Ia.a.I5a,Ib.a.frame,this.Dqk);this.XSg=!!xa.AFrameworkApplication.fa&&xa.AFrameworkApplication.fa.la("SilentExternalHandler")}get v9d(){return this.xL}CWc(rb,
cc="",mc=""){this.qN=mc||Hc.a.create().toString();this.thc=cc||ma.a.yGf();this.xbc=rb}get options(){let rb=0;xa.AFrameworkApplication.pok&&(rb|=1);xa.AFrameworkApplication.openInClientEditOnly&&(rb|=4);this.wTk()&&(rb|=64);return rb}wTk(){return!(2===this.application&&xa.AFrameworkApplication.fa.la("IsEmbeddedScenario"))}get oMb(){return xa.AFrameworkApplication.kE}get rSb(){return xa.AFrameworkApplication.hna}get HQf(){return""}get oQd(){return""}get oWg(){return xa.AFrameworkApplication.fa.la("OneNoteMobileViewerIsEnabled")}get j_c(){return this.oQe||
(this.oQe=Object(la.a)())}gud(){this.Ose||this.Tqi()}Otb(){this.zTk||this.lri()}Txg(rb){this.V7k&&ua.a.Un?new pa(this):this.Apc(rb)}Apc(rb){const cc=({DPa:rb}=this.dtj(rb)).returnValue;t.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===cc,rb);return cc}Uta(rb,cc,mc,Sa,pb,Ac){this.S9a=rb;this.o8c="";this.DHe=cc;this.qsa=Ac;this.application=mc;this.xL=Sa;xa.AFrameworkApplication.downloadCopyOnOpenInClient?this.j3f():xa.AFrameworkApplication.limitedEdit&&!xa.AFrameworkApplication.hostAuthenticatesUsersDuringOpenInClient?
Ka.a.jSg():this.qIh(pb)}get uJj(){return!!xa.AFrameworkApplication.fa&&xa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}I5a(){this.uJj&&this.zwj();return this.Apc(this.ZAb)}RJg(){const rb=new Kb.a($b.a.x9d);rb.Values["ui-language"]=xa.AFrameworkApplication.lcid.toString();rb.Values[Yb.a.mLb]=xa.AFrameworkApplication.userSessionId;return this.qsa.value.send(rb)?32:8}zwj(){Wb.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",
["OpenInClientFailed"],!1,!1,!1,!1,Object.assign({},{jna:!1}))}Mwk(rb){const cc=new Kb.a($b.a.eal);cc.Values["ui-language"]=xa.AFrameworkApplication.lcid.toString();cc.Values[Yb.a.mLb]=xa.AFrameworkApplication.userSessionId;cc.Values[pc.a.dal]=rb;this.qsa.value.send(cc)}dtj(rb){this.ZAb=rb;this.Mwk(5===this.xL?Eb.openInBrowserAction:Eb.UZj);return 5===this.xL?this.btj():this.htj()}btj(){this.r3f();return{returnValue:32,DPa:"HostEditUrl,"}}htj(){let rb;var cc=rb="";xa.AFrameworkApplication.K_e&&(cc=
"|f|"+xa.AFrameworkApplication.userSessionId);const mc=xa.AFrameworkApplication.fa.la("IsAssignmentMode")&&xa.AFrameworkApplication.fa.la("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||xa.AFrameworkApplication.isUnifiedHostMode||ua.a.PKa,Sa=xa.AFrameworkApplication.fa.la("UnattemptedEnumIsEnabled"),pb=xa.AFrameworkApplication.fa.la("NoBrowserModalDialogs");var Ac=xa.AFrameworkApplication.jh.lR(3588168074);Ac&&this.CWc(Ac.epochClickTime,Ac.sessionOrigin,Ac.correlationId);this.Z5f();if(xa.AFrameworkApplication.Osg){rb+=
"NewOrder,";Ac=8;this.qsa&&this.qsa.value&&this.qsa.value.isEnabled()&&xa.AFrameworkApplication.Oxe&&(rb+="Post,",Ac=this.RJg());if(32===Ac)return{returnValue:Ac,DPa:rb};t.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return xa.AFrameworkApplication.Qt.Sqb?(t.ULS.shipAssertTag(5566816,211,!!xa.AFrameworkApplication.Qt.Sqb),rb+="HostUrl,",{returnValue:xa.AFrameworkApplication.ra.ZYb(xa.AFrameworkApplication.Qt.Sqb),DPa:rb}):this.S9a?(t.ULS.sendTraceTag(18715405,
211,15,"Try to open doc in rich client, SessionId {0}",xa.AFrameworkApplication.userSessionId),rb+="DocUrl,",Qc.RAd(this.S9a,this.xL,this.options,this.application,Object(Ta.a)(this,this.vgg,"onEditInClientSuccess"),Object(Ta.a)(this,this.ugg,"onEditInClientFailure"),this.XSg,xa.AFrameworkApplication.fa.la("OICEncodeUrlIsEnabled"),cc,mc,Sa,pb,this.thc,this.qN,this.xbc,this.o8c),{returnValue:32,DPa:rb}):{returnValue:8,DPa:rb}}rb+="OldOrder,";if(!this.S9a&&xa.AFrameworkApplication.Qt.Sqb)return this.qsa&&
this.qsa.value&&this.qsa.value.isEnabled()&&xa.AFrameworkApplication.Oxe?(rb+="Post,",cc=this.RJg()):(t.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),cc=8),32!==cc?(t.ULS.shipAssertTag(22595484,211,!!xa.AFrameworkApplication.Qt.Sqb),rb+="HostUrl,",{returnValue:xa.AFrameworkApplication.ra.ZYb(xa.AFrameworkApplication.Qt.Sqb),DPa:rb}):{returnValue:cc,DPa:rb};t.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",xa.AFrameworkApplication.userSessionId);
rb+="DocUrl,";Qc.RAd(this.S9a,this.xL,this.options,this.application,Object(Ta.a)(this,this.vgg,"onEditInClientSuccess"),Object(Ta.a)(this,this.ugg,"onEditInClientFailure"),this.XSg,xa.AFrameworkApplication.fa.la("OICEncodeUrlIsEnabled"),cc,mc,Sa,pb,this.thc,this.qN,this.xbc,this.o8c);return{returnValue:32,DPa:rb}}sDg(rb){xa.AFrameworkApplication.Gt.setDw(8981,rb)}vgg(rb){this.sDg(rb);t.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===rb&&MSOJS.ClientUtils.ShouldShowDialog()?(this.oWg||
this.r3f(),this.Z5f()):this.Ose||this.gud()}ugg(rb,cc=0){t.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",rb,cc);if(5===rb)alert(Object(db.a)("OICErrorPopupBlockerForSafari"));else{const mc=!!this.DHe&&!this.ZAb;let Sa=0;1===rb&&(Sa=2);6<=rb&&13>=rb&&(Sa=1,1===cc&&(this.Ose=!0));this.j_c.pql?(t.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",Sa),Ea.a.instance.g4h(this.ZAb?this.cdg:this.ddg,mc?this.ojg:null,
this.Vlf(!1)?this.Q6i:null,Sa,cc)):(t.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",Sa),Ea.a.instance.e4h(this.ZAb?this.cdg:this.ddg,mc?this.ojg:null,Sa))}}Z5f(){try{const rb=[Object.assign(new Zb.a,{name:"CorrelationId",string:this.qN}),Object.assign(new Zb.a,{name:"SessionOrigin",string:this.thc}),Object.assign(new Zb.a,{name:"ClickTime",string:this.xbc}),Object.assign(new Zb.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];Jc.a("OpenInClientCompleted",
!0,0,rb)}catch(rb){t.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+rb.toString())}}r3f(){xa.AFrameworkApplication.ra&&xa.AFrameworkApplication.ra.$d.zM&&xa.AFrameworkApplication.fa.la("StandardProtocolDialogIsEnabled")?(t.ULS.sendTraceTag(507532034,211,50,"Launch StandardProtocolLaunchingDialog while opening web document in desktop"),new ib(this)):new fb(this)}Vlf(rb){const cc=(ua.a.zXf||ua.a.YO)&&!!xa.AFrameworkApplication.Ssc;cc&&rb&&(z.a.dm(xa.AFrameworkApplication.Ssc,"_blank",
void 0,"OpenInClient"),this.gud());return cc}}Eb.UZj="OpenInDesktop";Eb.openInBrowserAction="OpenInBrowser";Object(k.a)(Eb,"AOpenInClientOperation",null,[]);var ob=a(7),Na=a(231),nb=a(69),Hb=a(63),na=a(366),Gb=a(58),Xa=a(54),Jb=a(215),qb=a(86),Db=a(35),gb=a(13),ya=a(24),Aa=a(547),sb=a(282),nc=a(287),Bb=a(177),uc=a(671),Pc=a(93),wd=a(10),Md=a(25),Nd=a(1),ec;if(Nd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveWindowBinaryExpsDea",!1)){const {MSOJS:rb}=a(1278);window.MSOJS=rb}let gc=
ec=class extends Eb{constructor(rb,cc,mc,Sa){super(!0);this.Og=new ba.a;this.qAd=this.yyf=!1;this.Bpc=this.Pu=this.Icf=null;this.Oi=()=>{B.a.Em(N.a(this.$).ij.activityState,R.a.O5d)||this.ZHa.reset()};this.$Nj=pb=>{this.sDg(pb)};this.ZNj=()=>{this.sLk()};this.$=rb;this.ea=rb.ea;this.PU=Sa;this.businessBar=cc;this.ea.uq(this.Oi);this.ZHa=Q.d6e(this.$);this.AXh();this.Ksa=za.a.instance.Qi("Common.ISystemInitiatedFeedback")}get HQf(){return"EditInExcelWebApp_32x32x32"}get xa(){this.Pu=this.Pu||new Jb.a;
return this.Pu.token}get oQd(){return"excel32"}get oWg(){return this.ea.th.inWebPart}$Wh(){this.Txg(this.yyf)}dZh(){const rb=this.$;u.TaskExtensions.Ua(Object(Pc.d)(this.PU(0)),cc=>{this.Uta(rb.workbookContext.ClientUrl,xa.AFrameworkApplication.afa,1,rb.isEditMode?2:0,!0,new V.a(()=>cc.result))},this.xa,3)}PNd(){0!==Hb.a.Al.editMode&&(this.$.ih.GF=!1)}pMf(){const rb={};rb[ob.a.LNb]=!1;rb[ob.a.zO]="OpenInExcel";this.$.ei(802602464,nb.a.eh,8,rb)}Evd(){if(this.ea.Ph){var rb=this.$;rb.isEditMode&&u.TaskExtensions.Ua(Object(Pc.d)(this.PU(0)),
cc=>{this.Uta(rb.workbookContext.ClientUrl,xa.AFrameworkApplication.afa,1,2,!1,new V.a(()=>cc.result))},this.xa,3)}}lff(){this.ea.Ph&&u.TaskExtensions.Ua(Object(Pc.d)(this.PU(0)),rb=>{this.Uta(this.$.workbookContext.ClientUrl,xa.AFrameworkApplication.afa,1,this.$.isEditMode?2:0,!1,new V.a(()=>rb.result))},this.xa,3)}CWc(rb){super.CWc(rb)}openInExcelClient(){this.ea.Ph&&(this.$.isEditMode||u.TaskExtensions.Ua(Object(Pc.d)(this.PU(0)),rb=>{this.Uta(this.$.workbookContext.ClientUrl,xa.AFrameworkApplication.afa,
1,0,!1,new V.a(()=>rb.result))},this.xa,3))}openInBrowser(){this.ea.Ph&&u.TaskExtensions.Ua(Object(Pc.d)(this.PU(0)),rb=>{this.Uta(this.$.workbookContext.ClientUrl,xa.AFrameworkApplication.afa,1,5,!1,new V.a(()=>rb.result))},this.xa,3)}hXa(rb){const cc=this.zrd(rb);this.ZHa.hXa(cc,rb);this.cxj()}cxj(){xa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1)&&null!=this.Ksa&&this.Ksa.execute(rb=>rb.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity",
"CollabCornerFloodgateSurveysIsEnabled"))}Apg(rb,cc=0){if(this.ea.Ph){var mc=this.$;N.a(mc).H_a?this.Bpg(rb,mc):0<cc?this.hRk(rb,mc,cc):this.JQg(mc)}}Uta(rb,cc,mc,Sa,pb,Ac){this.$.ih.GF=!this.$.th.inWebPart;this.yyf=pb;this.Bpc=null;this.qAd=!1;this.vIh(rb,cc,Sa,pb,Ac)}Apc(rb){const cc=this.$.th;t.ULS.sendTraceTag(537154775,0,50,`OpenInExcelOperation.CompleteClientLaunch: IsEmbedded:${cc.inEmbedView}, InWebPart:${cc.inWebPart}, DivSyndicated:${cc.isDivSyndicated}, Mode:${this.$.isEditMode?Na.a.edit:
Na.a.view}`);return ec.hYf()?(this.dpc(),Qc.RAd(this.S9a,this.xL,this.options,1,this.$Nj,this.ZNj,!1,xa.AFrameworkApplication.fa.la("OICEncodeUrlIsEnabled")),32):super.Apc(rb)}Tqi(){this.EEg();const rb=this.$;if(!this.ea.th.inWebPart&&this.ea.Ph&&!rb.isEditMode){const cc=new qb.a(2145659238,nb.a.eh,this.$.Rh,0,null);this.Icf=Gb.a.instance.create(()=>{rb.Ma.dh(cc)},0,Xa.a.WZj)}}dispose(){this.ea&&this.ea.pq(this.Oi);m.a.Ni([this.Og,this.Icf,this.Pu]);this.$=this.ea=null}lri(){this.EEg()}j3f(){Gb.a.instance.create(()=>
{this.$.Ma.dh(new qb.a(-2028960985,nb.a.eh,0,30,null))},0,Xa.a.XZj,!0,!0)}qIh(rb){const cc=this.$,mc=N.a(this.$).ij.activityState;mc[Aa.a.VYe]=!0;cc.isEditMode&&this.ea.Ph?(this.dpc(),D.a(cc).Dy(new sb.a(J.a.bD,5,()=>{cc.rP(!1);mc[nc.a.Aw]=J.a.fpc;mc[Aa.a.Rsh]=rb;mc[R.a.eFd]=!0;cc.isEditMode&&(mc[R.a.p3]=1,mc[R.a.o9]=!0,mc[Bb.a.yjc]=!0,mc[Bb.a.rld]=!0);mc[Aa.a.YYe]=1455037301}))):this.Txg(rb)}fUg(){const rb=xa.AFrameworkApplication.afa;if(this.$.downloadCopyOnOpenInClient){if(8===this.$.frame.ZYb(rb,
!0)){const cc=this.$.ea.th;t.ULS.sendTraceTag(537154773,0,50,`Url:[${rb}] IsEmbedded:[${cc.inEmbedView}] InWebPart:[${cc.inWebPart}] DivSyndicated:[${cc.isDivSyndicated}], Mode:[${this.$.isEditMode?Na.a.edit:Na.a.view}]`)}}else this.ZHa.hXa(rb,-2028960985);this.qAd=!0;this.dpc()}Gtj(){this.j_c.cJj&&this.j_c.Ftj(1)}Htj(){this.j_c.cJj&&gb.HelperMethods.dm(fa.a.BJd(33),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryOffice")}Ptj(){gb.HelperMethods.dm(fa.a.BJd(31),"_blank",void 0,"OpenExcelOperation.XLSBackstageUnknownTryMacOffice")}Qtj(){gb.HelperMethods.dm(fa.a.BJd(34),
"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryMacOffice")}zrd(rb){const cc=new Sys.StringBuilder,mc=this.$.workbookContext,Sa=this.$.ua;cc.append(this.$.zAa);cc.append(Sa.FileHandlerRelativeUri);cc.append("?id=");cc.append(encodeURIComponent(n.a.U2b(mc.WorkbookUri,"sc")));this.$.ea.Ph&&(cc.append("&sessionId="),cc.append(encodeURIComponent(this.$.ea.sessionId)));switch(rb){case -974518828:cc.append("&workbookType=PublishedItemsSnapshot");break;case -1804063550:cc.append("&workbookType=FullWorkbook");
break;case 1700376090:n.a.Dr(cc,"workbookType","FullWorkbook");n.a.Dr(cc,"workbookFileType","Csv");n.a.Dr(cc,wd.a.nvg,this.$.sa.na.name);n.a.Dr(cc,"downloadAsCsvEnabled","1");break;case -1059172980:cc.append("&workbookType=FullWorkbook&workbookFileType=Odf");break;default:cc.clear()}v.a.ZGb(cc,Sa,-1059172980!==rb);return cc.toString()}AXh(){const rb=this.$.ua;MSOJS.ClientUtils.InitUrls(rb.RoamingAppsX86RootUrl,rb.RoamingAppsControlInstallerUrl,rb.RoamingAppsFirefoxExtensionUrl)}EEg(){const rb=this.$;
this.ea.Ph||na.a.vce(rb,N.a(rb).ij);this.dpc();this.Bpc&&this.Bpc(this,this.qAd);rb.frame.PH.ou(this.$.frame.Bma());rb.frame.X7.ou(this.$.frame.Bma());rb.ih.GF=!1;ya.f(rb).focus()}vIh(rb,cc,mc,Sa,pb){const Ac=this.$;xa.AFrameworkApplication.ra&&!ec.hYf()&&(Ac.frame.PH.xv(Ac.frame.Bma()),Ac.frame.X7.xv(Ac.frame.Bma()));super.Uta(rb,cc,1,mc,Sa,pb)}dpc(){const rb=this.$;N.a(rb).Dp.activityName===J.a.openInExcelClient&&N.a(rb).ij.NT()}sLk(){const rb=Db.a.Yi(1,0,681,682,0,1341525452,"OpenInExcelActiveXError");
D.a(this.$).CD([rb])}hRk(rb,cc,mc){let Sa=null;const pb=window.setTimeout(()=>{N.a(cc).BSc(Sa);this.JQg(cc)},mc);Sa=()=>{N.a(cc).H_a&&(N.a(cc).BSc(Sa),window.clearTimeout(pb),this.Bpg(rb,cc))};N.a(cc).smd(Sa)}JQg(rb){const cc=Db.a.Yi(1,1,0,696,0,-1753121099,"ProcessingUserChangesFileDownloadIgnored");D.a(rb).CD([cc])}Bpg(rb,cc){D.a(cc).Dy(new sb.a(J.a.bD,5,()=>{cc.rP(!1);const mc=N.a(cc).ij,Sa=mc.activityState;Sa[nc.a.Aw]=J.a.nAd;Sa[uc.a.wFb]=cc.ea.th.hasUnsupportedFeaturesForEdit;Sa[M.a.pjc]=rb;
mc.Sy(Db.a.ufa(this.businessBar.gBd,[1437034227]))}))}static hYf(){return!Md.a.iw()&&1<Hb.a.getRegisteredEwaInstances().length}};gc=ec=Object(d.__decorate)([Object(I.d)(F.je),Object(d.__param)(0,Object(F.Lb)()),Object(d.__param)(1,Object(F.C)()),Object(d.__param)(2,Object(F.ab)()),Object(d.__param)(3,Object(F.id)({k6:!0}))],gc);Object(k.a)(gc,"OpenInExcelOperation",Eb,[762,2]);var Mb=a(9),sc=a(420),xd=a(31);class xb extends w.a{constructor(rb,cc,mc){super(rb,cc);this.v$d=this.executionContext=null;
this.O1j=(Sa,pb)=>{this.J0b(Sa,pb)};this.iU=mc}initialize(rb){super.initialize(rb)}execute(rb){this.executionContext=rb;rb=Object(e.a)(10,this.executionContext.sk);this.RKb(rb);return 1}US(rb){super.US(rb)}RKb(){this.subscribe(this.executionContext,this.O1j,rb=>{this.v$d.add_disposing(rb)})}J0b(rb){this.unsubscribe(cc=>{rb.remove_disposing(cc)});this.executionContext.activityState[W.a.Kda]=0}}Object(k.a)(xb,"PasswordProtectedFileActivity",w.a,[]);var Lb=a(421),Rc=a(422),nd=a(12);class $d extends Lb.a{constructor(rb){super(rb);
this.WCa=0;this.Wak=(cc,mc)=>{this.Gsb(cc,mc)};this.xye=(cc,mc)=>{this.V8a(cc,mc)}}get ki(){return"PasswordDialog"}get WLb(){return this.WCa}get dialogTitle(){return nd.a.instance.ia(1982)}Gsb(rb){this.WCa=rb}Kea(){const rb={};rb[Lb.a.description]=nd.a.instance.ia(1983);rb[Lb.a.placeholderText]=nd.a.instance.ia(1979);rb[Lb.a.Nqg]=nd.a.instance.ia(2001);rb[Lb.a.Lqg]=nd.a.instance.ia(2002);rb[Lb.a.Mqg]=nd.a.instance.ia(1980);rb[Lb.a.CQd]=nd.a.instance.ia(1986);rb[Lb.a.r6e]=nd.a.instance.ia(1666);rb[Lb.a.p$k]=
nd.a.instance.Ba(25);rb[Lb.a.y5g]=this.xye;return rb}AGa(){const rb={};rb[Rc.a.fy]=this.ki;rb[Lb.a.keb]=this.Kea();return rb}Im(){this.Bh=1;this.initializeAndShow(this.dialogTitle,this.Wak,this.AGa())}}Object(k.a)($d,"PasswordProtectedFilePasswordInputDialog",Lb.a,[]);var Td=a(62),He=a(252);class oc extends $d{constructor(rb){super(rb);this.bje=5;this.fMe=!1;this.passwordToModify=null;this.Oqg=()=>{this.$.isEditMode&&this.yGc&&this.$.Pr(this.Oqg)};this.Im();this.$.nr(this.Oqg)}get yGc(){return this.fMe}get dialogTitle(){return nd.a.instance.ia(1984)}Gsb(rb,
cc){super.Gsb(rb,cc);t.ULS.sendTraceTag(537154755,0,50,`PasswordProtectedFileModifyActivity.PasswordProtectedFileModifyPasswordInputDialogDisposing: user response: ${rb}`)}V8a(rb,cc){this.passwordToModify=rb;const mc={};mc.FileModifyPassword=xd.a.kl(rb);Td.N(this.$.pa.ta,mc,this.OYj(cc),this.NYj(cc),null,null)}Kea(){const rb=super.Kea();rb[Lb.a.CQd]=nd.a.instance.ia(1987);rb[Lb.a.description]=nd.a.instance.Ba(24);return rb}Im(){t.ULS.sendTraceTag(557446529,0,50,"PasswordProtectedFileModifyPasswordInputDialog.InitializeAndShowDialog: Initializing dialog.");
super.Im()}OYj(rb){return cc=>{Db.a.Qn(cc.Errors,[-2019873242])&&this.ctc(this.FKb());if(!cc||He.a(cc))if(0<this.bje)this.Zwg(rb);else{t.ULS.sendTraceTag(537154754,0,10,`VerifyPasswordToModifyOperation.GenerateOnVerifyPasswordToModifyRequestSuccess: Unexpected error: ${Db.a.Kh(cc.Errors)}`);this.$.ea.Yw(cc.Errors);this.hide();return}this.fMe=cc.Result;this.yGc&&t.ULS.sendTraceTag(555758470,0,50,"PasswordProtectedFileModifyPasswordInputDialog.OnVerifyPasswordToModifyRequestSuccess: User entered the correct password.");
rb(this.yGc?0:1)}}NYj(rb){return()=>{0<this.bje?this.Zwg(rb):(t.ULS.sendTraceTag(537154753,0,10,"PasswordProtectedFileModifyInputDialog.OnVerifyPasswordToModifyRequestFailure: VerifyPasswordToModify request failed."),rb(3))}}Zwg(rb){--this.bje;this.V8a(this.passwordToModify,rb)}FKb(){return Db.a.Yi(1,0,1665,1666,1,-2019873242,"TooManyWrongPasswordAttemptFileModifyError")}}Object(k.a)(oc,"PasswordProtectedFileModifyPasswordInputDialog",$d,[]);class ld extends xb{constructor(rb,cc,mc){super(rb,cc,mc)}RKb(rb){this.v$d=
new oc(rb);super.RKb(rb)}J0b(rb,cc){const mc=rb.WLb,Sa=rb.yGc,pb=rb.passwordToModify;super.J0b(rb,cc);this.executionContext.HLa([2001366804]);switch(mc){case 1:Sa?(cc=Object(e.a)(10,this.executionContext.sk),this.executionContext.activityState[W.a.lZe]=xd.a.kl(pb),this.executionContext.activityState[W.a.Acb]=!0,rb.passwordToModify="",this.Wn(cc.isEditMode?J.a.cq:this.ZT)):t.ULS.sendTraceTag(537154757,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFilePasswordInputDialogDisposing: Unexpected State , Dialog disposed but password not verified.");
this.Tw();break;case 0:this.executionContext.activityState[W.a.Jz]=!1;this.Wn(this.iU);this.Tw();break;default:t.ULS.sendTraceTag(537154756,0,50,`PasswordToModifyFileModifyActivity.OnPasswordInputCommitted: unhandled user response '${mc}'`)}}}Object(k.a)(ld,"PasswordProtectedFileModifyActivity",xb,[]);class id extends sc.a{constructor(rb,cc,mc,Sa){super();this.activityName=rb;this.ZT=cc;this.iU=mc;this.$=Sa;this.Bl()}create(){this.Yj(new ld(this.activityName,this.ZT,this.iU))}static Aa(rb){rb.ka.ph(434,
new id(J.a.I0b,J.a.lxb,J.a.zJb,rb))}}Object(k.a)(id,"PasswordProtectedFileModifyActivityFactory",sc.a,[]);class fc extends $d{constructor(rb,cc){super(rb);this.password=null;this.c1f=cc;this.Im()}V8a(rb,cc){this.password=rb;cc(0)}Kea(){const rb=super.Kea();this.c1f&&(rb[Lb.a.Wii]=1);return rb}Im(){t.ULS.sendTraceTag(537154722,0,50,`PasswordProtectedFileOpenPasswordInputDialog.InitializeAndShowDialog: Initializing dialog. isWrongPassword=${this.c1f}`);super.Im();D.a(this.$).n2e()}}Object(k.a)(fc,"PasswordProtectedFileOpenPasswordInputDialog",
$d,[]);class vc extends xb{constructor(rb,cc,mc){super(rb,cc,mc)}RKb(rb){const cc=Db.a.Qn(this.executionContext.errors,[1217361942]);this.v$d=new fc(rb,cc);rb.ZDc||rb.Mlf();super.RKb(rb)}J0b(rb,cc){const mc=rb.password;rb.password="";const Sa=rb.WLb;super.J0b(rb,cc);this.executionContext.activityState[W.a.vld]=xd.a.kl(mc);this.executionContext.activityState[W.a.Acb]=!0;this.executionContext.HLa([110414285,1217361942]);t.ULS.sendTraceTag(537154752,0,50,`PasswordProtectedFileOpenActivity.PasswordProtectedFileOpenPasswordInputDialogDisposing: user response: ${Sa}`);
switch(Sa){case 1:this.Wn(this.ZT);this.Tw();break;case 0:this.Wn(this.iU),this.Tw()}}}Object(k.a)(vc,"PasswordProtectedFileOpenActivity",xb,[]);class Tc extends sc.a{constructor(rb,cc,mc,Sa){super();this.activityName=rb;this.ZT=cc;this.iU=mc;this.$=Sa;this.Bl()}create(){this.Yj(new vc(this.activityName,this.ZT,this.iU))}static Aa(rb){rb.ka.ph(386,new Tc(J.a.nPc,J.a.cq,J.a.jq,rb))}}Object(k.a)(Tc,"PasswordProtectedFileOpenActivityFactory",sc.a,[]);var Bd=a(428),Fd=a(265),le=a(98);class dc extends Fd.a{constructor(rb,
cc){super(rb,cc);this.WCa=0;this.Mv()}get ki(){return"SharedWorkbookDialog"}get WLb(){return this.WCa}aN(rb,cc){this.WCa=rb;super.aN(rb,cc)}Mv(){super.Mv();this.Bh=9;const rb=this.XMi();this.Yh(1,nd.a.instance.ia(1664));this.Yh(2,nd.a.instance.ia(994));this.Io(nd.a.instance.ia(702),le.a.zm(rb),this.icon,this.X1)}XMi(){return String.format(nd.a.instance.ia(703))}}Object(k.a)(dc,"LegacySharedWorkbookDialog",Fd.a,[]);class Uc extends w.a{constructor(rb,cc,mc){super(rb,cc);this.executionContext=null;
this.nuj=Sa=>{const pb=this.EB.ij,Ac=Object(e.a)(10,pb.sk),yd=Sa.WLb;this.unsubscribe(vb=>{Sa.remove_disposing(vb)});for(let vb=0,Sc=pb.errors.length;vb<Sc;vb++)-573864504===pb.errors[vb].MessageId&&pb.uoa(pb.errors[vb]);switch(yd){case 1:Ac.ea.p0c=!0;t.ULS.sendTraceTag(537155485,0,50,"LegacySharedWorkbookActivity.LegacySharedDialogDisposing: User has selected to turn off the Legacy Shared Workbook setting ");this.Wn(Ac.isEditMode?J.a.gxb:this.s9h);this.Tw();break;case 2:this.Wn(J.a.openInExcelClient);
this.Tw();break;case 0:pb.activityState[W.a.Jz]=!1,this.Wn(this.iU),this.Tw()}};this.s9h=cc;this.iU=mc}initialize(rb){super.initialize(rb)}execute(rb){this.executionContext=rb;this.DKb();return 1}US(rb){super.US(rb)}DKb(){const rb=Object(e.a)(10,this.executionContext.sk),cc=Db.a.veb([-573864504]);cc[0].HelpDescription=nd.a.instance.ia(705);cc[0].HelpTopicId=Bd.a.ouj;const mc=new dc(rb,cc[0]);this.subscribe(this.executionContext,this.nuj,Sa=>{mc.add_disposing(Sa)})}}Object(k.a)(Uc,"LegacySharedWorkbookActivity",
w.a,[]);class kb extends sc.a{constructor(rb,cc,mc,Sa){super();this.activityName=rb;this.ZT=cc;this.iU=mc;this.$=Sa;this.Bl()}create(){this.Yj(new Uc(this.activityName,this.ZT,this.iU))}static Aa(rb){rb.ka.ph(460,new kb(J.a.iXb,J.a.lxb,rb.hWb?J.a.jq:J.a.zJb,rb))}}Object(k.a)(kb,"LegacySharedWorkbookActivityFactory",sc.a,[]);if(!Nd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveWindowBinaryExpsDea",!1)){const {MSOJS:rb}=a(1278);window.MSOJS=rb}Mb.a.Qg(Tc.Aa);Mb.a.Qg(id.Aa);Mb.a.Qg(kb.Aa);
String(c);String(b);String(f);String(r);window.___1708742503434_closurehack=c;window.___1708742503434_closurehack=b;window.___1708742503434_closurehack=f;window.___1708742503434_closurehack=r},913:function(y,x,a){a.d(x,"a",function(){return l});y=a(0);var c=a(6),b=a(81),f=a(34),r=a(31),d=a(188);class k{constructor(u,n){this.message=u;this.KHa=n}}Object(y.a)(k,"CrossDocumentEventArgs",null,[]);var t=a(937),m=a(478),e=a(289),w=a(936);class l{constructor(u,n,v,B){this._name="";this.FB={};this.ida=null;
this.ackMessageHandler=z=>{z=z.CorrelationId;""!==z&&z in this.FB&&(w.a.sendTraceTag(42783044,2,"Received Ack for Message {0} CorrelationId: {1}",this.FB[z],z),this.FB[z]="ACK_RECEIVED")};this.zYb=z=>{const C=this.kQb(z);if(!C)return!1;if(this.Cr[C.MessageId])return this.rQ.gKa(this.Cr[C.MessageId],C),!0;if(this.ft[C.MessageId]){const D=this.ft[C.MessageId];z=new k(C,z);this.rQ.hTb(D,z);return!0}return!1};this.wQ=[];this.kQ=[];this.lQ=[];this.uQ=[];this.EEa=u;this.CEa=n;this.Cr={};this.ft={};this.rQ=
v;l._id++;B&&B();this.Ku=this.enable()}get targetOrigin(){return this.CEa}get lPa(){return this.EEa}enable(){if(!e.a())return w.a.sendTraceTag(5018251,2,"Not supported for current browser."),!1;this.aTb();w.a.sendTraceTag(5018252,2,"Enabled.");return!0}isEnabled(){return this.Ku}aTb(){w.a.debugAssertTag(5018253,!!this.rQ,null);this.ida=this.zYb;this.rQ.LUa(this.ida,null)}disable(){this.Ku=!1;this.wQ=[];this.kQ=[];this.lQ=[];this.uQ=[];this.EEa=null;this.CEa="";this.rQ.ZWa(this.ida);this.Cr={};this.ft=
{}}dispose(){this.disable()}Dga(u){return!!this.wQ&&Array.contains(this.wQ,u)||this.xKa(u)}xKa(u){return!!this.kQ&&Array.contains(this.kQ,u)}Tq(u){w.a.debugAssertTag(5018259,!!this.wQ,null);Array.add(this.wQ,u);w.a.sendTraceTag(5018260,2,"Allow receiving : {0}",u)}UTa(u){w.a.debugAssertTag(5018261,!!this.kQ,null);Array.add(this.kQ,u);w.a.sendTraceTag(5018262,2,"Allow free receiving: {0}",u)}SUb(u){return!!this.lQ&&Array.contains(this.lQ,u)}OW(u){w.a.debugAssertTag(5018263,!!this.lQ,null);Array.add(this.lQ,
u);w.a.sendTraceTag(5018264,2,"Allow free sending: {0}",u)}bVb(u){u=b.a.getOrigin(u);return!!u&&!!this.uQ&&Array.contains(this.uQ,u)}PW(u){w.a.debugAssertTag(5018265,!!this.uQ,null);if(u===l.HL)return w.a.debugAssertTag(5018266,!1,null),!1;let n=b.a.getOrigin(u);if(!n)return w.a.sendTraceTag(5018267,4,"Get origin fail:{0}",u),!1;c.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.NormalizePostMessageOrigin")&&(n=r.a.Rr(n));Array.add(this.uQ,n);w.a.sendTraceTag(5018268,
2,"Add origin:{0}",n);return!0}send(u,n=null){let v=this.targetOrigin;if(n){n=b.a.getOrigin(n);if(!n)return!1;v=n}return this.hia(u,this.lPa,v)}sendMessage(u,n,v=""){v=v&&""!==v?v:d.a.create().toString();return this.send(this.Aha(u,n,v,c.AFrameworkApplication.userSessionId))}postMessage(u){const n=d.a.create().toString();if(!c.AFrameworkApplication.fa.la("RetryablePostMessagingIsEnabled")||!u.kqa)return this.send(this.Aha(u.messageId,u.values,n,u.userSessionId));this.Cr[u.l9]||(this.Tq(u.l9),this.Ip(u.l9,
this.ackMessageHandler));this.FB[n]="";return this.YMa(u,n,1)}YMa(u,n,v){if(""!==n&&n in this.FB&&"ACK_RECEIVED"===this.FB[n])return delete this.FB[n],!0;if(v>u.iP)return w.a.sendTraceTag(40716250,4,'No retries remaining. {{"MessageId":{0}, "CorrelationId":{1}}}',u.l9,n),delete this.FB[n],!1;w.a.sendTraceTag(40716251,1<v?4:2,'Sending postmessage. Attempts remaining {0}. {{"MessageId":{1}, "CorrelationId":{2}}}',u.iP-v,u.messageId,n);v++;window.setTimeout(()=>{this.YMa(u,n,v)},u.zkd);u.values[m.a.xkd]=
!0;return this.send(this.Aha(u.messageId,u.values,n,u.userSessionId))}Aha(u,n,v,B){u=new t.a(u);u.CorrelationId=v;n&&(u.Values=n);u.Values.wdUserSession=B;return u}hia(u,n,v){w.a.debugAssertTag(5018269,!!u,null);if(!this.Ku)return!1;w.a.debugAssertTag(5018270,!!n,null);w.a.debugAssertTag(5018271,!!v,null);if(!n||!v)return w.a.debugAssertTag(5018272,!1,null),!1;if(v===l.HL&&!this.SUb(u.MessageId))return w.a.sendTraceTag(5018273,1,"Got unregistered message {0}",{["id"]:u.MessageId}),!1;u.SendTime=(new Date).getTime();
let B="";try{B=Sys.Serialization.JavaScriptSerializer.serialize(u)}catch(z){return w.a.sendTraceTag(5018274,4,"JSON Ser failed {0}",{["Exception"]:z.message}),!1}n=l.sendMessage(n,B,v);w.a.sendTraceTag(5018275,2,"Send {0}. {1}",n?"succeeded":"failed",{["id"]:u.MessageId,["origin"]:v});return n}Ip(u,n){w.a.debugAssertTag(5018304,!!n,null);w.a.debugAssertTag(5018305,!!this.Cr&&!!this.ft,null);if(!this.Ku)return!1;if(!this.Dga(u))return w.a.sendTraceTag(5018306,2,"Not allow receiving {0}",{["id"]:u}),
!1;this.Cr[u]!==n&&(w.a.debugAssertTag(5018307,!this.Cr[u]&&!this.ft[u],null),this.Cr[u]=n,delete this.ft[u]);return!0}registerEventCallback(u,n){w.a.debugAssertTag(40420062,!!n,null);w.a.debugAssertTag(40420063,!!this.ft&&!!this.Cr,null);if(!this.Ku)return!1;if(!this.Dga(u))return w.a.sendTraceTag(40420064,2,"Not allow receiving {0}",{["id"]:u}),!1;this.ft[u]!==n&&(w.a.debugAssertTag(40420065,!this.Cr[u]&&!this.ft[u],null),this.ft[u]=n,delete this.Cr[u]);return!0}wZ(u){this.Ku&&(this.Cr[u]&&delete this.Cr[u],
this.ft[u]&&delete this.ft[u])}kQb(u){const n=new Date;this.EXb(u);if(!u.origin||!u.source||void 0===u.data||null===u.data)return w.a.sendTraceTag(5018308,4,"eventArgs missing required properties."),null;const v=this.xWb(u.data);if(!v)return null;if(!this.bVb(u.origin)){if(!this.xKa(v.MessageId))return w.a.sendTraceTag(5018309,1,"{0}",{["id"]:v.MessageId}),null;if(!f.a.Q5&&u.source!==this.lPa)return w.a.sendTraceTag(5018310,4,"Received message came from a source other than the parent window."),null}w.a.debugAssertTag(5018311,
!!v.Values,null);v.Values.m_Source=u.source;v.Values.m_Origin=u.origin;v.Values.m_ReceivedTime=n.getTime();return v}xWb(u){if(!u)return null;let n=null;try{n=Sys.Serialization.JavaScriptSerializer.deserialize(u,!0)}catch(z){return 2>l.VCa&&(w.a.sendTraceTag(5018312,2,"Deser failed"),l.VCa++),null}if(!n)return w.a.debugAssertTag(5018313,!1,null),null;for(u=0;u<l.C_.length;u++)if(!n[l.C_[u]])return"MessageId"!==l.C_[u]&&w.a.sendTraceTag(41502555,2,"Cannot find required message field: {0}",l.C_[u]),
null;if(n.Values)try{n.Values}catch(z){return w.a.sendTraceTag(5018314,4,"Not a valid dictionary: {0}",z.message),null}else w.a.sendTraceTag(41502556,2,"No values in message");u=n.MessageId;if(!this.Dga(u))return w.a.sendTraceTag(5018315,1,"Ignore recvd {0}",{["id"]:u}),null;const v=n.SendTime,B=(new Date).getTime()-v;if(0>v)return w.a.sendTraceTag(520435660,2,"{0}",{["t"]:v,["id"]:u}),null;6E4<B&&w.a.sendTraceTag(520435659,2,"{0}",{["t"]:v,["delta"]:B,["id"]:u});-300>B&&w.a.sendTraceTag(520435658,
2,"{0}",{["t"]:v,["delta"]:B,["id"]:u});u=new t.a;u.MessageId=n.MessageId;u.SendTime=n.SendTime;u.CorrelationId=n.CorrelationId;n.Values&&(u.Values=n.Values);w.a.sendTraceTag(40640779,1,"Received message with MessageId:{0}, SendTime:{1}, CorrelationId:{2}",u.MessageId,u.SendTime,u.CorrelationId);return u}EXb(u){w.a.sendTraceTag(5018318,1,String.format("Received: {0}",{["origin"]:u.origin,["data"]:u.data,["source"]:u.source}))}static sendMessage(u,n,v){if(!e.a())return w.a.debugAssertTag(5018319,!1,
null),!1;try{return u.postMessage(n,v),!0}catch(B){w.a.sendTraceTag(5018320,4,"{0}",{["exception"]:B.message})}return!1}}l.C_=["MessageId","SendTime"];l.HL="*";l._id=0;l.VCa=0;Object(y.a)(l,"CrossDocumentMessenger",null,[2,474])},936:function(y,x,a){a.d(x,"a",function(){return c});y=a(0);class c{static a5b(){}static GLb(){}}c.sendTraceTag=c.a5b;c.debugAssertTag=c.GLb;Object(y.a)(c,"BULS",null,[])},937:function(y,x,a){a.d(x,"a",function(){return c});y=a(0);class c{constructor(b){this.MessageId=b;this.SendTime=
0;this.CorrelationId="";this.Values={}}}Object(y.a)(c,"CrossDocumentMessage",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.dea.js.map/487d08371bbc656f78e2776860088e2b/EwaTS.dea.js.map