'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[11],{1005:function(y,x,a){a.r(x);a.d(x,"ChartCommandHandler",function(){return bb});y=a(179);x=a(0);var c=a(14),b=a(31),f=a(19),r=a(162),d=a(391),k=a(69),t=a(965),m=a(45),e=a(419),w=a(212),l=a(161),u=a(59),n=a(4),v=a(199),B=a(39),z=a(35),C=a(1),D=a(209),J=a(27),W=a(12),N=a(262),M=a(111),Q=a(24);class R{constructor(ra,Da,oa,Ha){this.chartId=ra;this.operation=Da;this.JRh=oa;this.t8a=Ha}}Object(x.a)(R,"ApplyChartPropertyContext",
null,[]);var O=a(993),U=a(595),K=a(962),F=a(992),I=a(422);class P extends K.a{constructor(ra,Da,oa,Ha){super(ra);this.qDc=null;this.Eak=(ka,wa)=>{1===ka?(this.qDc=wa[P.uak],ka=this.qDc!==this.ksb,c.ULS.sendTraceTag(557937567,0,50,`EditChartDataDialog.ReactChartEditDataDialogHandler: EditChartDataDialog OK button pressed with valid input. DataRangeEdited: ${ka}`),ka&&this.commit()):c.ULS.sendTraceTag(557937566,0,50,"EditChartDataDialog.ReactChartEditDataDialogHandler: EditChartDataDialog Cancel button pressed")};
this.Yo=()=>{};this.chartId=Ha;this.ksb=(this.QV=oa)||!Da?"":Da;W.a.instance.ia(891);this.SBd=ra.ih.eh;this.initializeAndShow(W.a.instance.ia(890),this.Eak,this.iR());c.ULS.sendTraceTag(557937568,0,50,"EditChartDataDialog.EditChartDataDialog: React Dialog Opened.")}get ki(){return"ChartEditDataDialog"}get oJ(){return 529}iR(){const ra={[I.a.fy]:this.ki,[P.W9i]:this.ksb,[P.$Nk]:this.QV};this.QV&&(ra[P.Bal]=1);return ra}nt(){const ra=this.chartId,Da=this.qDc;return()=>new t.a(ra,-100,Da)}UN(){const ra=
this.$.pa.ta,Da=this.chartId,oa=this.qDc,Ha=ra.Jh();return(ka,wa,Za)=>F.a(ra,Da,-100,oa,this.bfb(ka,this.Yo),wa,Za,null,Ha)}}P.W9i="initialRange";P.$Nk="showWarning";P.Bal="dialogIcon";P.uak="range";Object(x.a)(P,"EditChartDataDialog",K.a,[]);var Y=a(361),ea=a(360),Ba;(function(ra){ra[ra.editDataViaFoils=-99]="editDataViaFoils";ra[ra.editData=-100]="editData";ra[ra.switchRowCol=-101]="switchRowCol";ra[ra.chartTitleEdit=-102]="chartTitleEdit";ra[ra.horizontalAxisTitleEdit=-103]="horizontalAxisTitleEdit";
ra[ra.verticalAxisTitleEdit=-104]="verticalAxisTitleEdit";ra[ra.changeChartTypeColumnClustered=-105]="changeChartTypeColumnClustered";ra[ra.changeChartTypeColumnStacked=-106]="changeChartTypeColumnStacked";ra[ra.changeChartTypeColumnStacked100=-107]="changeChartTypeColumnStacked100";ra[ra.changeChartTypeLine=-108]="changeChartTypeLine";ra[ra.changeChartTypeLineStacked=-109]="changeChartTypeLineStacked";ra[ra.changeChartTypeLineStacked100=-110]="changeChartTypeLineStacked100";ra[ra.changeChartTypeLineMarkers=
-111]="changeChartTypeLineMarkers";ra[ra.changeChartTypeLineMarkersStacked=-112]="changeChartTypeLineMarkersStacked";ra[ra.changeChartTypeLineMarkersStacked100=-113]="changeChartTypeLineMarkersStacked100";ra[ra.changeChartTypePie=-114]="changeChartTypePie";ra[ra.changeChartTypePieExploded=-115]="changeChartTypePieExploded";ra[ra.changeChartTypeBarClustered=-116]="changeChartTypeBarClustered";ra[ra.changeChartTypeBarStacked=-117]="changeChartTypeBarStacked";ra[ra.changeChartTypeBarStacked100=-118]=
"changeChartTypeBarStacked100";ra[ra.changeChartTypeArea=-119]="changeChartTypeArea";ra[ra.changeChartTypeAreaStacked=-120]="changeChartTypeAreaStacked";ra[ra.changeChartTypeAreaStacked100=-121]="changeChartTypeAreaStacked100";ra[ra.changeChartTypeXYScatter=-122]="changeChartTypeXYScatter";ra[ra.changeChartTypeXYScatterSmooth=-123]="changeChartTypeXYScatterSmooth";ra[ra.changeChartTypeXYScatterLines=-124]="changeChartTypeXYScatterLines";ra[ra.changeChartTypeXYScatterSmoothNoMarkers=-125]="changeChartTypeXYScatterSmoothNoMarkers";
ra[ra.changeChartTypeXYScatterLinesNoMarkers=-126]="changeChartTypeXYScatterLinesNoMarkers";ra[ra.changeChartTypeDoughnut=-127]="changeChartTypeDoughnut";ra[ra.changeChartTypeDoughnutExploded=-128]="changeChartTypeDoughnutExploded";ra[ra.changeChartTypeRadar=-129]="changeChartTypeRadar";ra[ra.changeChartTypeRadarMarkers=-130]="changeChartTypeRadarMarkers";ra[ra.changeChartTypeRadarFilled=-131]="changeChartTypeRadarFilled";ra[ra.chartTitleBoldEdit=-132]="chartTitleBoldEdit";ra[ra.chartTitleItalicsEdit=
-133]="chartTitleItalicsEdit";ra[ra.chartTitleUnderlineEdit=-134]="chartTitleUnderlineEdit";ra[ra.chartTitleFontTypeEdit=-135]="chartTitleFontTypeEdit";ra[ra.chartTitleColorEdit=-136]="chartTitleColorEdit";ra[ra.chartPrimaryHorizontalAxisTitleBoldEdit=-137]="chartPrimaryHorizontalAxisTitleBoldEdit";ra[ra.chartPrimaryHorizontalAxisTitleItalicsEdit=-138]="chartPrimaryHorizontalAxisTitleItalicsEdit";ra[ra.chartPrimaryHorizontalAxisTitleUnderlineEdit=-139]="chartPrimaryHorizontalAxisTitleUnderlineEdit";
ra[ra.chartPrimaryHorizontalAxisTitleFontTypeEdit=-140]="chartPrimaryHorizontalAxisTitleFontTypeEdit";ra[ra.chartPrimaryHorizontalAxisTitleColorEdit=-141]="chartPrimaryHorizontalAxisTitleColorEdit";ra[ra.chartPrimaryVerticalAxisTitleBoldEdit=-142]="chartPrimaryVerticalAxisTitleBoldEdit";ra[ra.chartPrimaryVerticalAxisTitleItalicsEdit=-143]="chartPrimaryVerticalAxisTitleItalicsEdit";ra[ra.chartPrimaryVerticalAxisTitleUnderlineEdit=-144]="chartPrimaryVerticalAxisTitleUnderlineEdit";ra[ra.chartPrimaryVerticalAxisTitleFontTypeEdit=
-145]="chartPrimaryVerticalAxisTitleFontTypeEdit";ra[ra.chartPrimaryVerticalAxisTitleColorEdit=-146]="chartPrimaryVerticalAxisTitleColorEdit";ra[ra.chartLegendBoldEdit=-147]="chartLegendBoldEdit";ra[ra.chartLegendItalicsEdit=-148]="chartLegendItalicsEdit";ra[ra.chartLegendUnderlineEdit=-149]="chartLegendUnderlineEdit";ra[ra.chartLegendFontTypeEdit=-150]="chartLegendFontTypeEdit";ra[ra.chartLegendColorEdit=-151]="chartLegendColorEdit";ra[ra.chartPrimaryHorizontalAxisLabelBoldEdit=-152]="chartPrimaryHorizontalAxisLabelBoldEdit";
ra[ra.chartPrimaryHorizontalAxisLabelItalicsEdit=-153]="chartPrimaryHorizontalAxisLabelItalicsEdit";ra[ra.chartPrimaryHorizontalAxisLabelUnderlineEdit=-154]="chartPrimaryHorizontalAxisLabelUnderlineEdit";ra[ra.chartPrimaryHorizontalAxisLabelFontTypeEdit=-155]="chartPrimaryHorizontalAxisLabelFontTypeEdit";ra[ra.chartPrimaryHorizontalAxisLabelColorEdit=-156]="chartPrimaryHorizontalAxisLabelColorEdit";ra[ra.chartPrimaryVerticalAxisLabelBoldEdit=-157]="chartPrimaryVerticalAxisLabelBoldEdit";ra[ra.chartPrimaryVerticalAxisLabelItalicsEdit=
-158]="chartPrimaryVerticalAxisLabelItalicsEdit";ra[ra.chartPrimaryVerticalAxisLabelUnderlineEdit=-159]="chartPrimaryVerticalAxisLabelUnderlineEdit";ra[ra.chartPrimaryVerticalAxisLabelFontTypeEdit=-160]="chartPrimaryVerticalAxisLabelFontTypeEdit";ra[ra.chartPrimaryVerticalAxisLabelColorEdit=-161]="chartPrimaryVerticalAxisLabelColorEdit";ra[ra.chartSeriesDataLabelsBoldEdit=-162]="chartSeriesDataLabelsBoldEdit";ra[ra.chartSeriesDataLabelsItalicsEdit=-163]="chartSeriesDataLabelsItalicsEdit";ra[ra.chartSeriesDataLabelsUnderlineEdit=
-164]="chartSeriesDataLabelsUnderlineEdit";ra[ra.chartSeriesDataLabelsFontTypeEdit=-165]="chartSeriesDataLabelsFontTypeEdit";ra[ra.chartSeriesDataLabelsColorEdit=-166]="chartSeriesDataLabelsColorEdit";ra[ra.chartPrimaryHorizontalAxisMaxEdit=-167]="chartPrimaryHorizontalAxisMaxEdit";ra[ra.chartPrimaryVerticalAxisMaxEdit=-168]="chartPrimaryVerticalAxisMaxEdit";ra[ra.chartPrimaryHorizontalAxisMinEdit=-169]="chartPrimaryHorizontalAxisMinEdit";ra[ra.chartPrimaryVerticalAxisMinEdit=-170]="chartPrimaryVerticalAxisMinEdit";
ra[ra.chartPrimaryHorizontalAxisColorEdit=-171]="chartPrimaryHorizontalAxisColorEdit";ra[ra.chartPrimaryVerticalAxisColorEdit=-172]="chartPrimaryVerticalAxisColorEdit";ra[ra.chartPrimaryHorizontalAxisWidthEdit=-173]="chartPrimaryHorizontalAxisWidthEdit";ra[ra.chartPrimaryVerticalAxisWidthEdit=-174]="chartPrimaryVerticalAxisWidthEdit";ra[ra.chartPrimaryHorizontalAxisStyleEdit=-175]="chartPrimaryHorizontalAxisStyleEdit";ra[ra.chartPrimaryVerticalAxisStyleEdit=-176]="chartPrimaryVerticalAxisStyleEdit";
ra[ra.chartPrimaryHorizontalAxisMajorTickMarkEdit=-177]="chartPrimaryHorizontalAxisMajorTickMarkEdit";ra[ra.chartPrimaryHorizontalAxisMinorTickMarkEdit=-178]="chartPrimaryHorizontalAxisMinorTickMarkEdit";ra[ra.chartPrimaryVerticalAxisMajorTickMarkEdit=-179]="chartPrimaryVerticalAxisMajorTickMarkEdit";ra[ra.chartPrimaryVerticalAxisMinorTickMarkEdit=-180]="chartPrimaryVerticalAxisMinorTickMarkEdit";ra[ra.chartPrimaryHorizontalAxisMajorGridlinesColorEdit=-181]="chartPrimaryHorizontalAxisMajorGridlinesColorEdit";
ra[ra.chartPrimaryHorizontalAxisMinorGridlinesColorEdit=-182]="chartPrimaryHorizontalAxisMinorGridlinesColorEdit";ra[ra.chartPrimaryVerticalAxisMajorGridlinesColorEdit=-183]="chartPrimaryVerticalAxisMajorGridlinesColorEdit";ra[ra.chartPrimaryVerticalAxisMinorGridlinesColorEdit=-184]="chartPrimaryVerticalAxisMinorGridlinesColorEdit";ra[ra.chartPrimaryHorizontalAxisMajorGridlinesWidthEdit=-185]="chartPrimaryHorizontalAxisMajorGridlinesWidthEdit";ra[ra.chartPrimaryHorizontalAxisMinorGridlinesWidthEdit=
-186]="chartPrimaryHorizontalAxisMinorGridlinesWidthEdit";ra[ra.chartPrimaryVerticalAxisMajorGridlinesWidthEdit=-187]="chartPrimaryVerticalAxisMajorGridlinesWidthEdit";ra[ra.chartPrimaryVerticalAxisMinorGridlinesWidthEdit=-188]="chartPrimaryVerticalAxisMinorGridlinesWidthEdit";ra[ra.chartPrimaryHorizontalAxisMajorGridlinesStyleEdit=-189]="chartPrimaryHorizontalAxisMajorGridlinesStyleEdit";ra[ra.chartPrimaryHorizontalAxisMinorGridlinesStyleEdit=-190]="chartPrimaryHorizontalAxisMinorGridlinesStyleEdit";
ra[ra.chartPrimaryVerticalAxisMajorGridlinesStyleEdit=-191]="chartPrimaryVerticalAxisMajorGridlinesStyleEdit";ra[ra.chartPrimaryVerticalAxisMinorGridlinesStyleEdit=-192]="chartPrimaryVerticalAxisMinorGridlinesStyleEdit";ra[ra.chartSeriesColorEdit=-193]="chartSeriesColorEdit";ra[ra.chartSeriesLineWidthEdit=-194]="chartSeriesLineWidthEdit";ra[ra.chartSeriesLineStyleEdit=-195]="chartSeriesLineStyleEdit";ra[ra.chartSeriesLineMarkerSizeEdit=-196]="chartSeriesLineMarkerSizeEdit";ra[ra.chartSeriesChangeChartTypeEdit=
-197]="chartSeriesChangeChartTypeEdit";ra[ra.chartSeriesTrendlineAdd=-198]="chartSeriesTrendlineAdd";ra[ra.chartSeriesTrendlineDelete=-199]="chartSeriesTrendlineDelete";ra[ra.chartPlotAreaColorOpactiyEdit=-200]="chartPlotAreaColorOpactiyEdit";ra[ra.changeChartTypeWaterfall=-216]="changeChartTypeWaterfall";ra[ra.changeChartTypeFunnel=-217]="changeChartTypeFunnel";ra[ra.changeChartTypeTreemap=-218]="changeChartTypeTreemap";ra[ra.changeChartTypeSunburst=-219]="changeChartTypeSunburst";ra[ra.changeChartTypeBoxWhisker=
-220]="changeChartTypeBoxWhisker";ra[ra.changeChartTypeHistogram=-221]="changeChartTypeHistogram";ra[ra.changeChartTypePareto=-222]="changeChartTypePareto";ra[ra.chartTitleNone=0]="chartTitleNone";ra[ra.chartTitleCenteredOverlay=1]="chartTitleCenteredOverlay";ra[ra.chartTitleAboveChart=2]="chartTitleAboveChart";ra[ra.legendNone=100]="legendNone";ra[ra.legendRight=101]="legendRight";ra[ra.legendTop=102]="legendTop";ra[ra.legendLeft=103]="legendLeft";ra[ra.legendBottom=104]="legendBottom";ra[ra.legendRightOverlay=
105]="legendRightOverlay";ra[ra.legendLeftOverlay=106]="legendLeftOverlay";ra[ra.dataLabelNone=200]="dataLabelNone";ra[ra.dataLabelShow=201]="dataLabelShow";ra[ra.dataLabelCenter=202]="dataLabelCenter";ra[ra.dataLabelInsideEnd=203]="dataLabelInsideEnd";ra[ra.dataLabelInsideBase=204]="dataLabelInsideBase";ra[ra.dataLabelOutsideEnd=205]="dataLabelOutsideEnd";ra[ra.dataLabelLeft=206]="dataLabelLeft";ra[ra.dataLabelRight=207]="dataLabelRight";ra[ra.dataLabelTop=208]="dataLabelTop";ra[ra.dataLabelBottom=
209]="dataLabelBottom";ra[ra.dataLabelBestFit=210]="dataLabelBestFit";ra[ra.primaryCategoryAxisTitleNone=300]="primaryCategoryAxisTitleNone";ra[ra.primaryCategoryAxisTitleAdjacentToAxis=301]="primaryCategoryAxisTitleAdjacentToAxis";ra[ra.primaryCategoryAxisTitleBelowAxis=302]="primaryCategoryAxisTitleBelowAxis";ra[ra.primaryCategoryAxisTitleRotated=303]="primaryCategoryAxisTitleRotated";ra[ra.primaryCategoryAxisTitleVertical=304]="primaryCategoryAxisTitleVertical";ra[ra.primaryCategoryAxisTitleHorizontal=
305]="primaryCategoryAxisTitleHorizontal";ra[ra.primaryValueAxisTitleNone=306]="primaryValueAxisTitleNone";ra[ra.primaryValueAxisTitleAdjacentToAxis=307]="primaryValueAxisTitleAdjacentToAxis";ra[ra.primaryValueAxisTitleBelowAxis=308]="primaryValueAxisTitleBelowAxis";ra[ra.primaryValueAxisTitleRotated=309]="primaryValueAxisTitleRotated";ra[ra.primaryValueAxisTitleVertical=310]="primaryValueAxisTitleVertical";ra[ra.primaryValueAxisTitleHorizontal=311]="primaryValueAxisTitleHorizontal";ra[ra.primaryValueGridlinesNone=
328]="primaryValueGridlinesNone";ra[ra.primaryValueGridlinesMinor=329]="primaryValueGridlinesMinor";ra[ra.primaryValueGridlinesMajor=330]="primaryValueGridlinesMajor";ra[ra.primaryValueGridlinesMinorMajor=331]="primaryValueGridlinesMinorMajor";ra[ra.primaryCategoryGridlinesNone=332]="primaryCategoryGridlinesNone";ra[ra.primaryCategoryGridlinesMinor=333]="primaryCategoryGridlinesMinor";ra[ra.primaryCategoryGridlinesMajor=334]="primaryCategoryGridlinesMajor";ra[ra.primaryCategoryGridlinesMinorMajor=
335]="primaryCategoryGridlinesMinorMajor";ra[ra.primaryCategoryAxisNone=348]="primaryCategoryAxisNone";ra[ra.primaryCategoryAxisShowLTR=349]="primaryCategoryAxisShowLTR";ra[ra.primaryCategoryAxisWithoutLabels=350]="primaryCategoryAxisWithoutLabels";ra[ra.primaryCategoryAxisShowRTL=351]="primaryCategoryAxisShowRTL";ra[ra.primaryValueAxisNone=352]="primaryValueAxisNone";ra[ra.primaryValueAxisShow=353]="primaryValueAxisShow";ra[ra.primaryValueAxisThousands=354]="primaryValueAxisThousands";ra[ra.primaryValueAxisMillions=
355]="primaryValueAxisMillions";ra[ra.primaryValueAxisBillions=356]="primaryValueAxisBillions";ra[ra.primaryValueAxisLogScale=357]="primaryValueAxisLogScale";ra[ra.primaryCategoryAxisThousands=372]="primaryCategoryAxisThousands";ra[ra.primaryCategoryAxisMillions=373]="primaryCategoryAxisMillions";ra[ra.primaryCategoryAxisBillions=374]="primaryCategoryAxisBillions";ra[ra.primaryCategoryAxisLogScale=375]="primaryCategoryAxisLogScale";ra[ra.dataTableNone=500]="dataTableNone";ra[ra.dataTableShow=501]=
"dataTableShow";ra[ra.dataTableWithLegendKeys=502]="dataTableWithLegendKeys";ra[ra.seriesDelete=510]="seriesDelete";ra[ra.dataChange=511]="dataChange";ra[ra.seriesDataChange=512]="seriesDataChange"})(Ba||(Ba={}));Object(x.b)("ChartOperationType",Ba);var Fa=a(62),za=a(252);class xa extends K.a{constructor(ra,Da,oa,Ha,ka,wa,Za){super(ra);this.Y$=null;this.Gak=(ab,db)=>{if(1===ab){if(this.Y$=db[xa.LWk],ab=this.Y$!==this.b8a.PreviousTitle)c.ULS.sendTraceTag(559518685,5,50,`EditTitleDialog.ReactEditTitleDialogHandler. ID:${this.floatingObjectId}, Operation:${Enum.toString(Ba,
this.operation)}, EntryMethod:${Enum.toString(Y.a,this.SBd)}, EntryLocation:${Enum.toString(ea.a,this.entryLocation)}, TitleEdited:${ab}`),this.commit()}else c.ULS.sendTraceTag(559518684,0,50,`EditTitleDialog.ReactEditTitleDialogHandler Cancel button pressed. ID:${this.floatingObjectId}, Operation:${Enum.toString(Ba,this.operation)}, EntryMethod:${Enum.toString(Y.a,this.SBd)}, EntryLocation:${Enum.toString(ea.a,this.entryLocation)}, TitleEdited:${!1}`)};this.rdj=ab=>{const db=a(1005).ChartCommandHandler.HWi(this.operation,
this.chartType),mb=this.$.pa.ta.Jh();this.r_a(this.oJ,(Ia,pa,lb)=>Fa.u(this.$.pa.ta,this.floatingObjectId,db,this.cfb(Ia,this.bba(ab)),this.R3(pa),lb,null,mb),16,!0)};this.Yo=()=>{};this.floatingObjectId=Da;this.operation=oa;this.chartType=Ha;this.YRf=wa;this.dialogTitle=W.a.instance.ia(887);this.b8a={};this.b8a.PreviousTitle=this.YRf?ka:"";this.b8a.HasPreviousTitle=this.YRf?!0:!1;this.b8a.PreviousTitleIsFormula=!1;this.SBd=ra.ih.eh;this.entryLocation=Za;this.initializeAndShow(this.dialogTitle,this.Gak,
this.AGa())}get ki(){return"ChartEditTitleDialog"}get oJ(){return 529}UN(){const ra=this.pGf(this.Y$),Da=this.AYa(ra),oa=this.floatingObjectId,Ha=this.$.pa.ta,ka=this.$.pa.ta.Jh();return(wa,Za,ab)=>F.a(Ha,oa,Da,ra,this.bfb(wa,this.Yo),Za,ab,null,ka)}nt(){const ra=this.floatingObjectId;let Da=this.Y$;const oa=this.AYa(Da);Da=this.pGf(Da);return()=>new t.a(ra,oa,Da)}AGa(){const ra={};ra[xa.sR]=this.ki;ra.invokeGetTitle=this.rdj;return ra}bba(ra){return Da=>{za.a(Da)?(c.ULS.sendTraceTag(537155040,0,
10,"  result contains non-status messages"),this.hide()):(this.b8a=Da.Result,ra(this.b8a.PreviousTitle))}}qYg(ra){return!ra&&this.b8a.HasPreviousTitle}pGf(ra){return this.qYg(ra)?"":ra}AYa(ra){const {ChartCommandHandler:Da}=a(1005);let oa=this.operation;if(this.qYg(ra))switch(this.operation){case -102:oa=0;break;case -103:oa=Da.AYa(-1324968385,this.chartType);break;case -104:oa=Da.AYa(1769742759,this.chartType);break;default:c.ULS.sendTraceTag(537155037,6,50,`EditTitleDialog.GetChartOperationType: Unexpected operation ${this.operation}.`)}return oa}}
xa.sR="id";xa.LWk="title";Object(x.a)(xa,"EditTitleDialog",K.a,[]);class fa{constructor(ra,Da){this.multiRange=null;this.type=0;this.multiRange=ra;this.type=Da}ZBf(){return this.type}}Object(x.a)(fa,"MacroRecorderChartInsertedPayload",null,[65]);var V=a(66),ba=a(97),la=a(5),Ta=a(25),Ea=a(136),sa=a(479);K=a(765);var Ya;let bb=Ya=class{constructor(ra,Da,oa,Ha,ka){this.Ddg=(wa,Za)=>{z.a.Jk(wa.Errors)||2===wa.Result&&new xa(this.$,Za.chartId,Za.operation,Za.JRh,"",!1,Za.t8a)};this.kSj=wa=>{if(!this.sj){var Za;
!wa||z.a.Jk(wa.Errors)||J.a.qm(Za=wa.Result)?wa&&z.a.Jk(wa.Errors)&&c.ULS.sendTraceTag(537155091,0,50,`ChartCommandHandler.OnInsertChartSuccess: Operation succeeded with errors. FreezePanes support: ${Q.f(this.$).OV}, Errors: ${z.a.Kh(wa.Errors)}`):(c.ULS.sendTraceTag(537155092,0,50,`ChartCommandHandler.OnInsertChartSuccess: Operation succeeded. FreezePanes support: ${Q.f(this.$).OV}`),r.a(this.$).z4a(4),M.a(this.$).fOa(0,Za),Ya.c6j(this.$,wa))}};this.jSj=()=>{this.sj||c.ULS.sendTraceTag(537155090,
0,50,`ChartCommandHandler.OnInsertChartFailed: Operation failed. FreezePanes support: ${Q.f(this.$).OV}`)};this.$=ra;this.viewBlockContainerHelpers=Da;this.Ya=oa;this.lB=Ha;this.Jl=ka;this.sj=!1}get yh(){return Q.f(this.$).ha.$e.yh}executeCommand(ra,Da,oa){switch(ra){case 1:oa=this.H0i(Da,oa);break;case 2:case 4:case 64:case 8:oa=this.N_i(Da,oa,ra);break;default:oa=D.a(Da.command)}if((Ta.a.vR()||Ta.a.Xmb())&&2===ra&&(19===Da.lk||9===Da.lk)){const Ha=Q.f(this.$).ha.$e.Gq?Q.f(this.$).ha.$e.Gq:"Null",
ka=sa.a(Da.command);Da=19===Da.lk?"ContextMenu":"Floatie";if(!this.yh)return c.ULS.sendTraceTag(507386061,6,50,"ChartCommandHandler.ExecuteCommand: Invalid Floating Object Control. ElementId:{0}, Command:{1}, EntryPoint:{2}",Ha,ka,Da),oa;const wa=this.yh.floatingObject;ra=!!(this.XHd(ra).Attributes&4);c.ULS.sendTraceTag(508371731,6,50,"ChartCommandHandler.ExecuteCommand:ID:{0}, ElementID:{1}, RibbonCommand:{2}, isSVGChart:{3}, isPivotChart:{4}, entryPoint:{5}",wa.fi,Ha,ka,!!Ea.a.Wna(wa),ra,Da)}return oa}ni(ra,
Da,oa,Ha){if(oa=!!oa&&!!Ha&&1===Ha.ZN)switch(Da=Da.command,ra){case 1:oa=699602235===Da||1644530823===Da;break;case 2:case 4:case 64:case 8:break;default:oa=!1}return oa}Ji(ra,Da,oa){var Ha=this.XHd(ra);if(!Ha)return!1;let ka;ra=null;switch(Da){case "PopulateAxesFlyout":ra=this.Ya.Vv("Axes.AxesGroups");Da=this.Ya.Oh();Da.iz="Menu16";ra.vh.push(Da);16!==Ha.ChartCategory&&(Ha=this.Ya.fz("Axes.Axes.Horizontal",null,W.a.instance.ia(968),-1777747317),Ha.populateOnlyOnce=!1,Ha.vD="PopulateAxesHorizontalMenu",
Ha.menuOpenCommand=-1495055390,Ha.menuCloseCommand=1929313450,Ha.BWb=W.a.instance.ia(1611),Ha.P1("Image16by16",4,f.a.QCd),Da.buttons.push(Ha));Ha=this.Ya.fz("Axes.Axes.Vertical",null,W.a.instance.ia(969),-1777747317);Ha.populateOnlyOnce=!1;Ha.vD="PopulateAxesVerticalMenu";Ha.menuOpenCommand=774399778;Ha.menuCloseCommand=-1188713306;Ha.BWb=W.a.instance.ia(1612);Ha.P1("Image16by16",4,f.a.SCd);Da.buttons.push(Ha);break;case "PopulateGridlinesFlyout":ra=this.Ya.Vv("Axes.AxesGroups");Da=this.Ya.Oh();Da.iz=
"Menu16";ra.vh.push(Da);var wa=this.Ya.fz("Axes.Gridlines.Horizontal",null,W.a.instance.ia(981),-1777747317);wa.populateOnlyOnce=!1;wa.vD="PopulateGridlinesHorizontalMenu";wa.menuOpenCommand=685576228;wa.menuCloseCommand=-59166688;wa.BWb=W.a.instance.ia(1622);wa.P1("Image16by16",4,f.a.jtf);Da.buttons.push(wa);16!==Ha.ChartCategory&&(Ha=this.Ya.fz("Axes.Gridlines.Vertical",null,W.a.instance.ia(982),-1777747317),Ha.populateOnlyOnce=!1,Ha.vD="PopulateGridlinesVerticalMenu",Ha.menuOpenCommand=-1048456E3,
Ha.menuCloseCommand=600630160,Ha.BWb=W.a.instance.ia(1623),Ha.P1("Image16by16",4,f.a.otf),Da.buttons.push(Ha));break;case "PopulateChartElements":ka=String.format('<Menu Id="{0}"><MenuSection Id="{0}Section"><Controls>',"ChartElementsList");Da=O.ChartElementManager.Uxc(this.$);if(!Da)return!0;for(let Za=0,ab=Da.length;Za<ab;Za++)13!==Da[Za].ChartContextType&&(wa=O.ChartElementManager.lJf(Da[Za]),Ha=b.a.Yl(O.ChartElementManager.JFf(Da[Za])),ka+=`<Button Id=${wa} MenuItemId=${wa} Command=${-1868205502} LabelText=${Ha} />`);
ka+="</Controls></MenuSection></Menu>";break;case "PopulateChartFillMenu":Ta.a.vR()&&Ea.a.Wna(this.yh.floatingObject)?(ra=this.Ya.Vv(),Da=C.EwaSettings.isChangeGateEnabled("OfficeVSO:8392615_EnableChartMoreColorPicker")?1532790410:null,Ha=Ta.a.sK()?1188510340:null,Da=this.Ya.BKb(1597684571,87208751,540,Da,Ha,oa.MenuId),ra.vh.push(Da)):ka="<Menu>"+this.lB.mCf(-981141954)+"</Menu>";break;case "PopulateChartOutlineMenu":Ta.a.vR()&&Ea.a.Wna(this.yh.floatingObject)?(ra=this.Ya.Vv(),Da=C.EwaSettings.isChangeGateEnabled("OfficeVSO:8392615_EnableChartMoreColorPicker")?
-822056969:null,Ha=Ta.a.sK()?-984702347:null,Da=this.Ya.BKb(409031041,-1744769642,539,Da,Ha,oa.MenuId),ra.vh.push(Da)):ka="<Menu>"+this.lB.mCf(409031041)+"<MenuSection><Controls>"+String.format('<FlyoutAnchor\r\n\t\t\t\t\t\t\tId="{0}"\r\n\t\t\t\t\t\t\tCommand="{1}"\r\n\t\t\t\t\t\t\tCommandMenuClose="{2}"\r\n\t\t\t\t\t\t\tLabelText="{3}"\r\n\t\t\t\t\t\t\tImage16by16="{4}"\r\n\t\t\t\t\t\t\tImage16by16Class="{5}"\r\n\t\t\t\t\t\t\tAlt="{3}"\r\n\t\t\t\t\t\t\tTemplateAlias="o1"\r\n\t\t\t\t\t\t\tPopulateDynamically="true"\r\n\t\t\t\t\t\t\tPopulateOnlyOnce="false"\r\n\t\t\t\t\t\t\tPopulateQueryCommand="{6}"\r\n\t\t\t\t\t\t\tKeytip="{7}"/>',
"OutlineWeight",-671455029,1461300262,W.a.instance.ia(1434),u.a.$m(4),f.a.bvc,"PopulateChartOutlineWeightMenu","")+String.format('<FlyoutAnchor\r\n\t\t\t\t\t\t\tId="{0}"\r\n\t\t\t\t\t\t\tCommand="{1}"\r\n\t\t\t\t\t\t\tCommandMenuClose="{2}"\r\n\t\t\t\t\t\t\tLabelText="{3}"\r\n\t\t\t\t\t\t\tImage16by16="{4}"\r\n\t\t\t\t\t\t\tImage16by16Class="{5}"\r\n\t\t\t\t\t\t\tAlt="{3}"\r\n\t\t\t\t\t\t\tTemplateAlias="o1"\r\n\t\t\t\t\t\t\tPopulateDynamically="true"\r\n\t\t\t\t\t\t\tPopulateOnlyOnce="false"\r\n\t\t\t\t\t\t\tPopulateQueryCommand="{6}"\r\n\t\t\t\t\t\t\tKeytip="{7}"/>',
"OutlineDashes",-1525887957,1461300262,W.a.instance.ia(1446),u.a.$m(4),f.a.Zuc,"PopulateChartOutlineDashMenu","")+"</Controls></MenuSection></Menu>";break;default:Ha=Ya.lNh(Da,Ha,this.Ya);if(!Ha||!Ha.length)return!1;ra=this.Ya.Vv();wa=this.Ya.Oh();"PopulateChartOutlineDashMenu"!==Da&&"PopulateChartOutlineWeightMenu"!==Da&&(wa.iz="Menu32");wa.buttons.push(...Ha);ra.vh.push(wa)}ka?oa.PopulationXML=ka:oa.MenuItems=ra.ML();return!0}Bi(ra,Da){if(ra&10){var oa=this.$;switch(Da){case -1985798686:case -911352779:if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:8435566_TurnOffObserverChartCutCopy")&&
Ea.a.isObserverChart(this.yh.floatingObject))return!0;break;case -219946702:case 1970784898:case -287251124:case -1925065947:case 1764140053:case -1077965542:case -1293291468:case -1832800737:case 1597684571:if(Ea.a.Wna(this.yh.floatingObject))return this.yh.OAa(Da);break;case 409031041:if(Ta.a.vR()&&Ea.a.Wna(this.yh.floatingObject))return this.yh.OAa(Da);break;case 862825906:case -803000997:case 1532790410:case -822056969:if(Ta.a.vR()&&C.EwaSettings.isChangeGateEnabled("OfficeVSO:8392615_EnableChartMoreColorPicker")&&
Ea.a.Wna(this.yh.floatingObject))return this.yh.OAa(Da);break;case 1849330294:case -873142594:case 1855740761:case 2117491830:case 2107851680:case -1986737526:case 119706583:case -1741941813:if(Ta.a.Xmb()&&Ea.a.Wna(this.yh.floatingObject))return this.yh.OAa(Da);break;case 1188510340:case -1828502776:case -984702347:if(Ta.a.vR()&&Ta.a.sK()&&Ea.a.Wna(this.yh.floatingObject))return this.yh.OAa(Da);break;case 87208751:case -1744769642:if(Ta.a.vR()&&C.EwaSettings.isChangeGateEnabled("OfficeVSO:8412512_EnableChartClearOutlineFillColor")&&
Ea.a.Wna(this.yh.floatingObject))return this.yh.OAa(Da)}if(!C.EwaSettings.Ra(16)&&-219946702===Da)return!0;const Ha=this.XHd(ra);if(!Ha)return Da.toString()in Ya.hie;if(1221897806===Da||1930653487===Da||1172793074===Da&&C.EwaSettings.Ra(155)){if(ra&8)return!0;switch(Ha.ChartCategory){case 4:case 6:case 8:case 14:case 10:case 25:case 1:case 17:case 28:return!0}}if(ra=B.a.gj(Ya.hzd,Da.toString())){const ka=Ha.Attributes;if(ra.includes(Ha.ChartCategory)||ka&16&&ra.includes(26)||!(ka&2)&&ra.includes(27)||
ka&4&&ra.includes(28))return!0}ra=oa.th;if(2054778433===Da)return Ha.Attributes&4?!(ra.allowPivotSpecificOperations&&ra.allowInteractivity):!0;if(C.EwaSettings.Ra(16)){if(!O.ChartElementManager.Uxc(this.$))return Da.toString()in Ya.gie;if(ra=B.a.gj(Ya.Zkf,Da.toString())){oa=O.ChartElementManager.Vpa(oa);if(!oa)return!0;oa=oa.ChartContextType;if(ra.includes(oa)||11===oa&&(oa=B.a.gj(Ya.$kf,Da.toString()))&&oa.includes(Ha.ChartCategory))return!0}}}return this.sHc(Da)||699602235===Da&&M.a(this.$).m6b}dispose(){this.$=
null;this.sj=!0}XHd(ra){let Da=null;8===ra?(ra=U.a(this.$))&&!ra.b4i&&(Da=ra.Ki):2===ra&&(ra=this.yh)&&(Da=ra.floatingObject.Ki);return Da}sHc(ra){let Da=!1;switch(ra){case 878838759:case 1058162689:case -672614340:case 1755642342:case -845652330:case 1930653487:case 1221897806:Da=!(new l.a(this.$.sa)).Hj(1)}return Da}N_i(ra,Da,oa){var Ha,ka=ra.command,wa=8===oa;const Za=this.yh;if(1701016594===ka||817296323===ka||-1075099431===ka||!Za&&!wa||!wa&&(null===(Ha=Za.extension)||void 0===Ha?0:Ha.dyb)&&
1872288872!==ka)return V.Task.Va(!0);let ab=Ha=null;var db=U.a(this.$);wa&&db?(Ha=db.chartId,ab=db.Ki):!wa&&Za&&(Ha=Za.floatingObject.id,ab=Za.floatingObject.Ki);Q.f(this.$);db=null;wa=!0;switch(ka){case -1268000318:case -1315025180:case 705259519:case 1337914559:case 1104037533:case 669779310:case 1411819830:case -1115893616:case -119153793:case 1693000238:case -1324968385:case -482182953:case 1769742759:case -996710402:case 490661775:case -1162087593:case 80515665:case 2147076534:case -306129902:case -1253752845:case 1711257557:case 680253336:case -1772953364:case -215161981:case 895828731:case 683614408:case -1612014670:case 1259259728:case -220179662:case 1534680966:case -238895611:case -892714755:case 2006508979:case 252405382:case 670842692:case -572426128:case -806496391:case -1700998151:case 2104548628:case 1717508862:case -1391465588:case 342631857:case 1867444565:case 374300079:case -1996266048:case 493396546:case 1599247052:case 342855531:case -472675112:case -1774499423:case -1809877936:case -204160914:case -87783054:case 1650379138:ab&&
Ha?(ka=Ya.AYa(ka,ab.ChartCategory),db=this.applyChartProperty(ka,Ha,ab,ra)):wa=!1;break;case 419803868:case -2011789595:case -1513952223:wa=this.Eaf(ka,Ha,ab,ra.lk);break;case 1356474004:Ha?db=this.applyChartProperty(-101,Ha,ab,ra):wa=!1;break;case 1172793074:C.EwaSettings.Ra(155)&&8!==oa||(ab&&Ha?new P(this.$,ab.DataRangeForDisplay,!(ab.Attributes&10),Ha):wa=!1);break;case 484692258:case 699602235:C.EwaSettings.isChangeGateEnabled("OfficeVSO:8695615_EnableComboChartTelemetry")&&699602235===ka&&Da[k.a.Ai]&&
c.ULS.sendTraceTag(507557773,6,50,"ChartCommandHandler.InsertChart, menuItem:{1}",Da[k.a.Ai]);db=this.applyChartProperty(Ya.SEi(Da[k.a.Ai]),Ha,ab,ra);break;case 2054778433:void ba.a.resolve(la.qb,{va:1}).then(mb=>{mb.FRc(ab.DataConnectionName,ab.ExternalSourceIndex,ra)});break;case -219946702:case 1970784898:case -287251124:case -1925065947:case 1764140053:case -1077965542:case -1293291468:case -1832800737:case 1597684571:case 1650812936:if(Za){Za.dh(ra,Da);break}case -803000997:case 409031041:Ta.a.vR()&&
(C.EwaSettings.isChangeGateEnabled("OfficeVSO:8392615_EnableChartMoreColorPicker")&&-803000997===ka&&(Da.Color="#000000"),Za&&Za.dh(ra,Da));break;case -822056969:case 1532790410:case 862825906:Ta.a.vR()&&C.EwaSettings.isChangeGateEnabled("OfficeVSO:8392615_EnableChartMoreColorPicker")&&(oa=Da=null,862825906===ka?(Da="#000000",oa=-1832800737):-822056969===ka?(Da="#FFFFFF",oa=409031041):(Da="#FFFFFF",oa=1597684571),C.EwaSettings.isChangeGateEnabled("OfficeVSO:8495239_persistChartColorPicker")&&Za&&
(Da=Za.EQb(oa)),null!==Da&&null!==oa&&this.Jl.oob(oa,ra,Da));break;case 1849330294:case -873142594:case 1855740761:case 2117491830:case 2107851680:case -1986737526:case 119706583:case -1741941813:Ta.a.Xmb()&&Za&&Za.dh(ra,Da);break;case 87208751:case -1744769642:Ta.a.vR()&&C.EwaSettings.isChangeGateEnabled("OfficeVSO:8412512_EnableChartClearOutlineFillColor")&&(Da.clearFillOutlineCmdVal="-2",Za&&Za.dh(ra,Da));break;case 1188510340:case -1828502776:case -984702347:db=Ta.a.vR()&&Ta.a.sK()?this.Jl.launchEyedropper(ka,
ra):V.Task.Va(!1);break;default:C.EwaSettings.Ra(16)?db=this.M_i(ra,Ha,Da,ab):wa=!1}return db||V.Task.Va(wa)}M_i(ra,Da,oa,Ha){switch(ra.command){case -1868205502:return O.ChartElementManager.selectChartElement(this.$,oa[k.a.Wk]),V.Task.Va(!0);case -1156957021:return oa=O.ChartElementManager.ZSi(this.$),V.Task.Va(1461300262!==oa&&this.Eaf(oa,Da,Ha,ra.lk));default:return this.O_i(ra,Da,oa)}}O_i(ra,Da,oa){var Ha=O.ChartElementManager.Vpa(this.$);if(!Ha)return V.Task.Va(!1);const ka=Ha.ChartContextType;
let wa,Za=0;O.ChartElementManager.Eoj(ka)?(wa=Array(2),wa[0]=O.ChartElementManager.seriesIndex(Ha).toString(),Za=1):wa=Array(1);Ha=O.ChartElementManager.oJd(Ha);switch(ra.command){case -981141954:wa[Za]=oa.Color;oa=16;break;case 409031041:wa[Za]=oa.Color;oa=17;break;case -1736601456:wa[Za]=oa[k.a.Wk];oa=9;break;case -619033944:wa[Za]=oa[k.a.Wk];oa=8;break;case -287251124:wa[Za]=(Ha.Bold=!Ha.Bold).toString();Ha.ValidMembers^=4;oa=0;break;case 1970784898:wa[Za]=oa.Color;oa=4;break;case -1293291468:Ha.FontName=
wa[Za]=oa[k.a.Wk];oa=3;break;case -1077965542:Ha.FontSize=parseFloat(wa[Za]=oa[k.a.Wk]);oa=5;break;case -1925065947:wa[Za]=(Ha.Italic=!Ha.Italic).toString();Ha.ValidMembers^=8;oa=1;break;case 1764140053:wa[Za]=(Ha.Underline=!Ha.Underline)?"1":"0";Ha.ValidMembers^=16;oa=2;break;default:return V.Task.Va(!1)}return this.applyChartPropertyDual(ka,oa,Da,wa,ra)}H0i(ra,Da){const oa=ra.command;switch(oa){case 699602235:ra=this.insertChart(Ya.ZBf(Da[k.a.Ai]),ra);break;case 1644530823:ra=this.insertChart(51,
ra);break;default:ra=D.a(oa)}return ra}insertChart(ra,Da){if(!this.$.cy(null,!1))return V.Task.Va(!0);var oa=Q.f(this.$);const Ha=m.s(oa.ha.qa.selectedRanges,this.$),ka=this.$.pa.ta.Jh();var wa=this.viewBlockContainerHelpers.X8a(oa);let Za,ab,db,mb;wa?(oa=wa.Lj,Za=oa.jj.top,ab=oa.jj.left,db=wa.VS.x,mb=wa.VS.y):(Za=ab=1,wa=this.viewBlockContainerHelpers.rJa(oa),db=wa.x,mb=wa.y);const Ia=()=>new fa(Ha,ra);return e.a(this.$.userOperationManager,(pa,lb,ha)=>F.e(this.$.pa.ta,Ha,ra,Za,ab,db,mb,N.c(pa,this.kSj),
N.b(lb,this.jSj),ha,null,ka),pa=>new w.a(528,0,pa,64,Ia),Da)}Eaf(ra,Da,oa,Ha){if(!Da||!oa)return!1;ra=Ya.AYa(ra,oa.ChartCategory);new xa(this.$,Da,ra,oa.ChartCategory,oa.ChartTitle,!0,Ha);return!0}applyChartProperty(ra,Da,oa,Ha){if(!Da)return D.a(Ha.command);const ka=this.$.pa.ta.Jh(),wa=()=>new t.a(Da,ra,""),Za=new R(Da,ra,oa.ChartCategory,Ha.lk);return e.a(this.$.userOperationManager,(ab,db,mb)=>F.a(this.$.pa.ta,Da,ra,"",N.c(ab,this.Ddg),db,mb,Za,ka),ab=>new w.a(529,0,ab,68,wa),Ha)}applyChartPropertyDual(ra,
Da,oa,Ha,ka){if(!oa)return D.a(ka.command);const wa=this.$.pa.ta.Jh();return e.a(this.$.userOperationManager,(Za,ab,db)=>F.b(this.$.pa.ta,oa,ra,Da,Ha,N.c(Za,this.Ddg),ab,db,wa),Za=>new w.a(530,0,Za,68),ka)}static initData(){Ya.lrd();Ya.MKh();Ya.ZKh();Ya.vKh();Ya.$Kh();Ya.aLh();Ya.bLh();Ya.LKh();Ya.$Lh();Ya.ZLh()}static ZBf(ra){return Ya.Laf[ra]}static AYa(ra,Da){return!Ya.Lej(ra)||5!==Da&&6!==Da?Ya.ikf[ra.toString()]:Ya.X6e[ra.toString()]}static SEi(ra){return Ya.taf[ra]}static HWi(ra,Da){Da=5===
Da||6===Da;switch(ra){case -102:case 1:case 2:ra=1;break;case -103:ra=2;break;case -104:ra=3;break;case 307:case 308:case 311:case 309:case 310:ra=Da?2:3;break;case 301:case 302:case 305:case 303:case 304:ra=Da?3:2;break;default:ra=1}return ra}static lNh(ra,Da,oa){const Ha=Da.ChartCategory;let ka=[];Da=Da.Attributes;switch(ra){case "PopulateDataLabelsMenu":switch(Ha){case 3:case 5:case 18:case 23:case 24:ka=[0,4,7,9];Da&32||(ka=ka.concat(10));break;case 7:case 11:ka=[1,5,12,13,14,15];break;case 9:case 10:ka=
[2,6,8,11,16];break;case 12:ka=[0,4,12,13,14,15];break;case 13:case 16:case 6:case 4:case 14:ka=[0,3];break;case 20:ka=[0,144];break;case 21:ka=[2,145];break;case 19:ka=[0,143];break;case 25:ka=[0,3];break;case 22:ka=[141,139,142,140,138];break;case 15:ka=[2,3];break;case 17:ka=[0];break;case 8:ka=[1,3]}break;case "PopulateAxesHorizontalMenu":switch(Ha){case 3:case 4:case 7:case 8:case 13:case 17:case 14:ka=[17,18,19,20];break;case 11:case 12:case 5:case 6:ka=Da&1?[17,21,25]:[17,21,22,23,24,25];break;
case 18:case 23:case 24:case 22:ka=[17,18,19]}break;case "PopulateAxesVerticalMenu":switch(Ha){case 3:case 4:case 7:case 8:case 11:case 12:case 16:case 13:case 17:case 14:ka=Da&1?[26,27,31]:[26,27,28,29,30,31];break;case 18:case 23:case 24:case 22:ka=[26,27,28,29,30];break;case 5:case 6:ka=[26,27,32,33]}break;case "PopulateGridlinesHorizontalMenu":ka=[34,35,36,37];break;case "PopulateGridlinesVerticalMenu":ka=[38,39,40,41];break;case "PopulatePivotContextMenu":break;case "PopulateChartOutlineWeightMenu":ka=
[128,129,130,131];break;case "PopulateChartOutlineDashMenu":ka=[132,133,134];break;default:return null}ra=Array(ka.length);for(let wa=0,Za=ra.length;wa<Za;wa++)ra[wa]=oa.Sg(ka[wa]);return ra}static lrd(){const ra=d.a.Nda;ra(1929313450,n.a.WB,0,0);ra(-1495055390,n.a.Oz,0,0);ra(-963696720,n.a.WB,0,0);ra(1031074088,n.a.Oz,0,0);ra(-1188713306,n.a.WB,0,0);ra(774399778,n.a.Oz,0,0);ra(-416895062,n.a.WB,0,0);ra(-72507346,n.a.Oz,0,0);ra(-1749121940,n.a.WB,0,0);ra(468560048,n.a.Oz,0,0);ra(1436480230,n.a.WB,
0,0);ra(689093526,n.a.Oz,0,0);ra(484692258,n.a.Ri,0,4);ra(-1478278396,n.a.WB,0,0);ra(-508421920,n.a.Oz,0,0);ra(71265892,n.a.WB,0,0);ra(-740159776,n.a.Oz,0,0);ra(-562781919,n.a.WB,0,0);ra(-1070738481,n.a.Oz,0,0);ra(-239339751,n.a.WB,0,0);ra(-249448185,n.a.Oz,0,0);ra(417064315,n.a.WB,0,0);ra(468398977,n.a.Oz,0,0);ra(-1053233165,n.a.WB,0,0);ra(-1256174279,n.a.Oz,0,0);ra(1731418977,n.a.WB,0,0);ra(1322442299,n.a.Oz,0,0);ra(705259519,n.a.Ri,0,0);ra(-1315025180,n.a.Ri,0,0);ra(-1268000318,n.a.Ri,0,0);ra(-204160914,
n.a.Ri,0,0);ra(-87783054,n.a.Ri,0,0);ra(1650379138,n.a.Ri,0,0);ra(-1996266048,n.a.Ri,0,0);ra(1599247052,n.a.Ri,0,0);ra(493396546,n.a.Ri,0,0);ra(-472675112,n.a.Ri,0,0);ra(374300079,n.a.Ri,0,0);ra(342855531,n.a.Ri,0,0);ra(-1774499423,n.a.Ri,0,0);ra(-1809877936,n.a.Ri,0,0);ra(-1391465588,n.a.Ri,0,0);ra(342631857,n.a.Ri,0,0);ra(1867444565,n.a.Ri,0,0);ra(419803868,n.a.Ri,0,0);ra(1172793074,n.a.Ri,0,0);ra(-2011789595,n.a.Ri,0,0);ra(-1513952223,n.a.Ri,0,0);ra(609898710,n.a.WB,0,0);ra(2107545606,n.a.Oz,0,
0);ra(-1156957021,n.a.Ri,0,0);ra(-981141954,n.a.Ri,0,0);ra(853483460,n.a.Oz,0,0);ra(-286073132,n.a.WB,0,0);ra(-238895611,n.a.Ri,0,0);ra(683614408,n.a.Ri,0,0);ra(-892714755,n.a.Ri,0,0);ra(1534680966,n.a.Ri,0,0);ra(895828731,n.a.Ri,0,0);ra(1259259728,n.a.Ri,0,0);ra(-482182953,n.a.Ri,0,0);ra(-1324968385,n.a.Ri,0,0);ra(-220179662,n.a.Ri,0,0);ra(-1612014670,n.a.Ri,0,0);ra(-306129902,n.a.Ri,0,0);ra(2147076534,n.a.Ri,0,0);ra(-1253752845,n.a.Ri,0,0);ra(80515665,n.a.Ri,0,0);ra(-1115893616,n.a.Ri,0,0);ra(1411819830,
n.a.Ri,0,0);ra(1693000238,n.a.Ri,0,0);ra(1337914559,n.a.Ri,0,0);ra(1104037533,n.a.Ri,0,0);ra(-119153793,n.a.Ri,0,0);ra(669779310,n.a.Ri,0,0);ra(409031041,n.a.Ri,0,0);ra(1188510340,n.a.Ri,0,0);ra(-1828502776,n.a.Ri,0,0);ra(-984702347,n.a.Ri,0,0);ra(-1736601456,n.a.Ri,0,0);ra(-1525887957,n.a.Oz,0,0);ra(-1211266709,n.a.Oz,0,0);ra(-1030447919,n.a.WB,0,0);ra(-619033944,n.a.Ri,0,0);ra(-671455029,n.a.Oz,0,0);ra(1356474004,n.a.Ri,0,0);ra(-1192695931,n.a.WB,0,0);ra(-561794525,n.a.Oz,0,0);ra(-806496391,n.a.Ri,
0,0);ra(252405382,n.a.Ri,0,0);ra(-1700998151,n.a.Ri,0,0);ra(-572426128,n.a.Ri,0,0);ra(2006508979,n.a.Ri,0,0);ra(1717508862,n.a.Ri,0,0);ra(670842692,n.a.Ri,0,0);ra(-1162087593,n.a.Ri,0,0);ra(1769742759,n.a.Ri,0,0);ra(-996710402,n.a.Ri,0,0);ra(490661775,n.a.Ri,0,0);ra(2104548628,n.a.Ri,0,0);ra(-1772953364,n.a.Ri,0,0);ra(680253336,n.a.Ri,0,0);ra(-215161981,n.a.Ri,0,0);ra(1711257557,n.a.Ri,0,0);ra(1279388860,n.a.r_,0,0);ra(-1639945714,n.a.WB,0,0);ra(1240254154,n.a.Oz,0,0);ra(443471155,n.a.WB,0,0);ra(1601208909,
n.a.Oz,0,0);ra(-59166688,n.a.WB,0,0);ra(685576228,n.a.Oz,0,0);ra(-1746717186,n.a.WB,0,0);ra(1249042882,n.a.Oz,0,0);ra(600630160,n.a.WB,0,0);ra(-1048456E3,n.a.Oz,0,0);ra(845857104,n.a.WB,0,0);ra(2055047988,n.a.Oz,0,0);ra(-1868205502,n.a.Ri,0,0)}static MKh(){Ya.Laf={["ColumnClustered"]:51,["ColumnStacked"]:52,["ColumnStacked100"]:53,["Line"]:4,["LineStacked"]:63,["LineStacked100"]:64,["LineMarkers"]:65,["LineMarkersStacked"]:66,["LineMarkersStacked100"]:67,["Pie"]:5,["PieExploded"]:69,["BarClustered"]:57,
["BarStacked"]:58,["BarStacked100"]:59,["Area"]:1,["AreaStacked"]:76,["AreaStacked100"]:77,["XYScatter"]:-4169,["XYScatterSmooth"]:72,["XYScatterLines"]:74,["XYScatterSmoothNoMarkers"]:73,["XYScatterLinesNoMarkers"]:75,["Doughnut"]:-4120,["DoughnutExploded"]:80,["Radar"]:-4151,["RadarMarkers"]:81,["RadarFilled"]:82,["Waterfall"]:119,["Funnel"]:123,["Treemap"]:117,["Sunburst"]:120,["BoxWhisker"]:121,["Histogram"]:118,["Pareto"]:122,["RegionMap"]:140,["Combo"]:-4152,["ComboColumnClusteredLine"]:113,
["ComboColumnClusteredLineSecondaryAxis"]:114,["ComboAreaStackedColumnClustered"]:115}}static ZKh(){Ya.ikf={["1356474004"]:-101,["419803868"]:-102,["-2011789595"]:-103,["-1513952223"]:-104,["-1324968385"]:300,["-482182953"]:301,["1769742759"]:306,["-996710402"]:309,["490661775"]:310,["-1162087593"]:311,["-1268000318"]:0,["-1315025180"]:1,["705259519"]:2,["1337914559"]:100,["1104037533"]:101,["669779310"]:102,["1411819830"]:103,["-1115893616"]:104,["-119153793"]:105,["1693000238"]:106,["374300079"]:200,
["-1809877936"]:201,["-1996266048"]:202,["493396546"]:203,["1599247052"]:204,["342855531"]:205,["-472675112"]:206,["-1774499423"]:207,["-204160914"]:208,["-87783054"]:209,["1650379138"]:210,["-1391465588"]:500,["342631857"]:501,["1867444565"]:502,["895828731"]:348,["683614408"]:349,["-1612014670"]:350,["1259259728"]:351,["-220179662"]:372,["1534680966"]:373,["-238895611"]:374,["-892714755"]:375,["2006508979"]:352,["252405382"]:353,["670842692"]:354,["-572426128"]:355,["-806496391"]:356,["-1700998151"]:357,
["80515665"]:328,["2147076534"]:329,["-306129902"]:330,["-1253752845"]:331,["1711257557"]:332,["680253336"]:333,["-1772953364"]:334,["-215161981"]:335}}static LKh(){Ya.taf={["ColumnClustered"]:-105,["ColumnStacked"]:-106,["ColumnStacked100"]:-107,["Line"]:-108,["LineStacked"]:-109,["LineStacked100"]:-110,["LineMarkers"]:-111,["LineMarkersStacked"]:-112,["LineMarkersStacked100"]:-113,["Pie"]:-114,["PieExploded"]:-115,["BarClustered"]:-116,["BarStacked"]:-117,["BarStacked100"]:-118,["Area"]:-119,["AreaStacked"]:-120,
["AreaStacked100"]:-121,["XYScatter"]:-122,["XYScatterSmooth"]:-123,["XYScatterLines"]:-124,["XYScatterSmoothNoMarkers"]:-125,["XYScatterLinesNoMarkers"]:-126,["Doughnut"]:-127,["DoughnutExploded"]:-128,["Radar"]:-129,["RadarMarkers"]:-130,["RadarFilled"]:-131,["Waterfall"]:-216,["Funnel"]:-217,["Treemap"]:-218,["Sunburst"]:-219,["BoxWhisker"]:-220,["Histogram"]:-221,["Pareto"]:-222}}static vKh(){Ya.X6e={["-1324968385"]:306,["-482182953"]:307,["1769742759"]:300,["-996710402"]:303,["490661775"]:304,
["-1162087593"]:305,["895828731"]:352,["683614408"]:353,["-220179662"]:354,["1534680966"]:355,["-238895611"]:356,["-892714755"]:357,["2006508979"]:348,["252405382"]:349,["2104548628"]:350,["1717508862"]:351,["1711257557"]:328,["680253336"]:329,["-1772953364"]:330,["-215161981"]:331,["80515665"]:332,["2147076534"]:333,["-306129902"]:334,["-1253752845"]:335}}static $Kh(){const ra=[0,1,2],Da=[];C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSComboChartUIInXLO",!1)&&Da.push(ra.pop());
const oa=[9,15,10],Ha=[11,12],ka=[12,17],wa=[5,6],Za=[16],ab=[19,20,21,25],db=[18,19,20,21,22,23,24,25],mb=[18,19,20,21,23,24,25],Ia=[22],pa=[0,2,3,4,7,8,9,13,15,16,17,14,10],lb=[25],ha=[26],ua=[28];let fb=ka;C.EwaSettings.isChangeGateEnabled("OfficeVSO:5099858_EnableAllChangeChartTypes")||(fb=ka.concat(db));const Ka=[17],La=[13,16,15,6,4,8,14],ib=[5,3],Yb=[9,10],Wc=[11,7,12];Ya.hzd={["-845652330"]:ra.concat(fb),["1058162689"]:ra.concat(fb),["878838759"]:ra.concat(ka,ua),["-672614340"]:ra.concat(ha),
["1755642342"]:ra.concat(Da,oa,ab,ha),["-561794525"]:ra.concat(ha),["468560048"]:ra.concat(Da,oa,Za,ab,ha),["-72507346"]:ra.concat(Da,oa,Za,ab,ha),["689093526"]:ra.concat(Da,oa,Za,ab,ha),["2055047988"]:ra.concat(ha),["1240254154"]:ra.concat(Da,ha),["1601208909"]:ra.concat(Da,oa,Za,Ha,db,ha),["1031074088"]:ra.concat(Da,oa,ab,ha),["-1495055390"]:ra.concat(Da,oa,ab,Za,ha),["774399778"]:ra.concat(Da,oa,ab,ha),["1249042882"]:ra.concat(Da,oa,ab,ha),["685576228"]:ra.concat(Da,oa,ab,ha),["-1048456000"]:ra.concat(Da,
oa,ab,Za,ha),["1356474004"]:ra.concat(Da,ka,[27],ua,db),["419803868"]:ra.concat(ha),["-2011789595"]:ra.concat(Da,oa,Za,ab,ha),["-1513952223"]:ra.concat(Da,oa,Za,ab,ha),["1172793074"]:ra.concat(ka,ua),["1930653487"]:ra.concat(ka,ua),["699602235"]:ra.concat(ka,lb),["-96249359"]:ra.concat(Da,db),["484692258"]:ra.concat(ka,lb),["-1268000318"]:ra.concat(ha),["-1315025180"]:ra.concat(ha),["705259519"]:ra.concat(ha),["-1324968385"]:ra.concat(Da,oa,ab,Za,ha),["-1612014670"]:ra.concat(Da,oa,ab,Za,ha),["1769742759"]:ra.concat(Da,
oa,ab,Za,ha),["-996710402"]:ra.concat(Da,oa,ab,Za,ha),["490661775"]:ra.concat(Da,oa,db,Za,ha),["-1162087593"]:ra.concat(Da,oa,db,Za,ha),["1337914559"]:ra.concat(ha),["1104037533"]:ra.concat(ha),["669779310"]:ra.concat(ha),["1411819830"]:ra.concat(ha),["-1115893616"]:ra.concat(ha),["-119153793"]:ra.concat(ha),["1693000238"]:ra.concat(ha),["374300079"]:ra.concat(Da,ha),["-1809877936"]:ra.concat(Da,Ka,ib,Yb,Wc,[18,23,24],ha),["-1996266048"]:ra.concat(Da,Ka,La,ab,Ia,ha),["493396546"]:ra.concat(Da,Ka,
La,ab,Ia,Wc,ha),["1599247052"]:ra.concat(Da,Ka,La,ab,Ia,Yb,Wc,ha),["342855531"]:ra.concat(Da,Ka,La,ab,Ia,Wc,ha),["-472675112"]:ra.concat(Da,Ka,La,ib,mb,Yb,ha),["-1774499423"]:ra.concat(Da,Ka,La,ib,mb,Yb,ha),["-204160914"]:ra.concat(Da,Ka,La,ib,mb,Yb,ha),["-87783054"]:ra.concat(Da,Ka,La,ib,mb,Yb,ha),["1650379138"]:ra.concat(Da,Ka,La,ib,db,Wc,ha),["-1391465588"]:ra.concat(Da,oa,Za,Ha,db,ha),["342631857"]:ra.concat(Da,oa,Za,Ha,db,ha),["1867444565"]:ra.concat(Da,oa,Za,Ha,db,ha),["895828731"]:ra.concat(Da,
oa,Za,ab,ha),["683614408"]:ra.concat(Da,oa,Za,ab,ha),["-1612014670"]:ra.concat(Da,oa,Za,ab,Ha,wa,ha),["1259259728"]:ra.concat(Da,oa,Za,db,Ha,wa,ha),["-220179662"]:pa.concat(db,ha),["1534680966"]:pa.concat(db,ha),["-238895611"]:pa.concat(db,ha),["-892714755"]:pa.concat(db,ha),["2006508979"]:ra.concat(Da,oa,ab,ha),["252405382"]:ra.concat(Da,oa,ab,ha),["670842692"]:ra.concat(Da,oa,ab,wa,ha),["-572426128"]:ra.concat(Da,oa,ab,wa,ha),["-806496391"]:ra.concat(Da,oa,ab,wa,ha),["-1700998151"]:ra.concat(Da,
oa,db,wa,ha),["1717508862"]:pa.concat(Ha,db,ha),["2104548628"]:pa.concat(Ha,db,ha),["80515665"]:ra.concat(Da,oa,ab,ha),["2147076534"]:ra.concat(Da,oa,ab,ha),["-306129902"]:ra.concat(Da,oa,ab,ha),["-1253752845"]:ra.concat(Da,oa,ab,ha),["1711257557"]:ra.concat(Da,oa,ab,Za,ha),["680253336"]:ra.concat(Da,oa,ab,Za,ha),["-1772953364"]:ra.concat(Da,oa,ab,Za,ha),["-215161981"]:ra.concat(Da,oa,ab,Za,ha)};Ya.Z3j(Ya.hzd,ra.concat(Da,Ka,db,ha))}static pae(ra,Da){v.c(ra,{["-981141954"]:Da,["-286073132"]:Da,["853483460"]:Da})}static qae(ra,
Da){v.c(ra,{["409031041"]:Da,["-1736601456"]:Da,["-1525887957"]:Da,["-1030447919"]:Da,["-1211266709"]:Da,["-619033944"]:Da,["-671455029"]:Da})}static bsg(ra,Da){v.c(ra,{["609898710"]:Da,["2107545606"]:Da,["-1868205502"]:Da})}static csg(ra,Da){v.c(ra,{["-287251124"]:Da,["1970784898"]:Da,["1636441681"]:Da,["-1293291468"]:Da,["-1077965542"]:Da,["-1925065947"]:Da,["1764140053"]:Da})}static Z3j(ra,Da){Ya.pae(ra,Da);Ya.qae(ra,Da);Ya.bsg(ra,Da);Ya.csg(ra,Da);v.c(ra,{["-1156957021"]:Da,["1279388860"]:Da,
["459047735"]:Da})}static aLh(){const ra=[0,1,2],Da=[3,4],oa=[7,8,9,10],Ha=[13],ka=[14],wa=[11],Za=[5,6],ab=Ya.Zkf={["-1156957021"]:oa.concat(wa,Ha,Da,Za,ka)};Ya.pae(ab,ra.concat(Da,oa,Za,Ha));Ya.qae(ab,ra.concat(Da,Ha));Ya.bsg(ab,null);Ya.csg(ab,oa.concat(wa,Ha,ka))}static bLh(){const ra=[11,12],Da=Ya.$kf={};Ya.pae(Da,[7,8].concat([9,15,16,10],ra));Ya.qae(Da,ra)}static $Lh(){Ya.hie=v.a({},"878838759 1356474004 1172793074 1058162689 484692258 -845652330 699602235 -672614340 -561794525 -1268000318 -1315025180 705259519 419803868 468560048 -72507346 -1324968385 -482182953 -2011789595 689093526 1769742759 -996710402 490661775 -1162087593 -1513952223 2055047988 1337914559 1104037533 669779310 1411819830 -1115893616 -119153793 1693000238 1601208909 -1391465588 342631857 1867444565 1240254154 374300079 -1996266048 493396546 1599247052 342855531 -472675112 -1774499423 -1809877936 -204160914 -87783054 1650379138 1755642342 1031074088 -1495055390 895828731 683614408 -1612014670 1259259728 -220179662 1534680966 -238895611 -892714755 774399778 2006508979 252405382 670842692 -572426128 -806496391 -1700998151 2104548628 1717508862 1249042882 685576228 80515665 2147076534 -306129902 -1253752845 -1048456000 1711257557 680253336 -1772953364 -215161981 1930653487".split(" "));
Ya.B8e(Ya.hie)}static ZLh(){Ya.gie={};Ya.B8e(Ya.gie)}static B8e(ra){v.a(ra,"-981141954 853483460 -287251124 1970784898 1636441681 -1293291468 -1077965542 -1925065947 2107545606 -1156957021 1764140053 409031041 -1736601456 -1525887957 -1211266709 -619033944 -671455029 -1868205502".split(" "))}static c6j(ra,Da){const oa=C.EwaSettings.isChangeGateEnabled("OfficeVSO:8434150_MigrateValidationTelemetryManager")?ba.a.Zg(la.yg):ra.ka.Ug(277);oa&&oa.Kld(ra,0,Da.Result,Da,"InsertChart")}static Lej(ra){let Da=
!1;switch(ra){case -238895611:case 683614408:case -892714755:case 1534680966:case 895828731:case 1259259728:case -220179662:case -482182953:case -1324968385:case -1612014670:case -306129902:case 2147076534:case -1253752845:case 80515665:case -806496391:case 252405382:case -1700998151:case -572426128:case 2006508979:case 1717508862:case 670842692:case -1162087593:case 1769742759:case -996710402:case 490661775:case 2104548628:case -1772953364:case 680253336:case -215161981:case 1711257557:Da=!0}return Da}};
bb.Laf=null;bb.ikf=null;bb.X6e=null;bb.taf=null;bb.hzd=null;bb.Zkf=null;bb.$kf=null;bb.hie=null;bb.gie=null;bb=Ya=Object(y.__decorate)([Object(ba.d)(la.P),Object(y.__param)(0,Object(la.Lb)()),Object(y.__param)(1,Object(K.n)()),Object(y.__param)(2,Object(la["if"])()),Object(y.__param)(3,Object(la.Be)()),Object(y.__param)(4,Object(la.Kd)())],bb);Object(x.a)(bb,"ChartCommandHandler",null,[39,2])},1009:function(y,x,a){a.d(x,"a",function(){return N});y=a(0);var c=a(14),b=a(96),f=a(105),r=a(71),d=a(1077),
k=a(914),t=a(69),m=a(150),e=a(905),w=a(1023),l=a(1024),u=a(964);class n{constructor(M,Q){this.position=M;this.es=Q}}Object(y.a)(n,"PositionAndExtent",null,[]);var v=a(1075),B=a(1),z=a(13),C=a(136),D=a(426),J=a(151),W=a(115);class N extends f.a{constructor(M,Q,R,O,U,K,F){K=void 0===K?null:K;super(M,void 0===F?null:F);this.X1a=null;this.$ob=!1;this.PGa=0;this.K9d=null;this.DTe=this.translateY=this.translateX=this.qAa=this.pAa=0;this.uya=this.rec=this.mgd=this.Tlc=!1;this.zIndex=0;this.Rm=this.N9=this.Bia=
this.Yt=this.Nk=this.nh=null;this.L9d=0;this.YH=null;this.EO=this.DO=!1;this.dG=this.JWa=null;this.b$=0;this.P6d=I=>{16===I.keyCode?!this.$ob&&this.n7&&(this.$ob=!0,this.cU.Aa("keyup",this.Q6d),this.update()):this.da.VYd(I)};this.Q6d=I=>{this.$ob&&this.n7&&16===I.keyCode&&(this.$ob=!1,this.cU.detach("keyup"),this.update())};this.cU=this.Xk.sWa();this.da=Q;this.control=R;this.icb=K;this.ys=O;this.Xac=U;this.aOa();J.a(this.control.$,I=>{this.X1a=I.A_(m.a.$vi,!1)})}lnd(M){this.addHandler(N.Q3b,M)}qCg(M){this.removeHandler(N.Q3b,
M)}zAh(M){this.addHandler("Resized",M)}Kkk(M){this.removeHandler("Resized",M)}yAh(M){this.addHandler(N.P3b,M)}Jkk(M){this.removeHandler(N.P3b,M)}xAh(M){this.addHandler("ResizeCancelled",M)}Ikk(M){this.removeHandler("ResizeCancelled",M)}get n7(){return this.mgd}get aHc(){return this.rec}get viewBlockContainerHelpers(){return this.icb}get ZW(){return this.Xac}get rotation(){return this.DTe}set rotation(M){const Q=this.nh?this.nh.FlipX!==this.nh.FlipY:!1;this.L9d=M;this.DTe=u.i(M,Q);this.Tlc=C.a.vaa(M,
Q)}get control(){return this.YH}set control(M){this.YH=M}get PS(){return this.rotation+this.b$}get p0b(){return this.control.BB?this.control.BB.offsetTop:0}get o0b(){return this.control.BB?this.control.BB.offsetLeft:0}dispose(){b.a.Ng(this.cU);this.i$();this.da=null;super.dispose()}yna(M){return M.mw!==Sys.UI.MouseButton.middleButton}aza(M){M.ove?this.KIb():this.mfa()}bza(M){this.control.$&&W.a().Ik(M);this.mfa()}cza(M){M=this.control.$?W.a().Ik(M):M;this.resize(M.clientPoint,!1);return!0}b3a(M){M=
this.control.$?W.a().Ik(M):M;if(!this.JMc(M))return!1;this.JWa=this.OSi(M.Qh);if(!this.JWa)return!1;this.y7a(M.clientPoint,N.PSi(this.JWa));return!0}update(){this.N9&&this.resize(this.N9,!1)}Dla(M){this.nh||(this.rotation=(this.nh=this.control.floatingObject.nh)?this.nh.Rotation:0);this.Wnd();this.control.Dla(M,8,this);this.m7(null)}i$(){this.control.i$(this)}y7a(M,Q){this.n7||(this.Rm=this.control.fm,this.Nk=this.ml(),this.Wme(M,Q),this.Bia=this.Ny(M,this.Rm.rtl),this.raiseEvent(N.Q3b),this.resize(M,
!0))}KIb(){this.rec=!0;this.control.clientVersion--;this.resize(this.K9d,!0);this.mfa()}m7(M){this.x5a(this.control,M)}upgrade(M){this.b$=0;if(null===M||void 0===M?0:M.nh)this.rotation=(this.nh=M.nh)?this.nh.Rotation:0,this.Wnd(),this.m7(M)}Yqc(M,Q){M=this.zLd(Q);Q=this.da.rtl;M=3===t.a.eh?this.ZW.M6h(this.control.Uv.style.borderTopColor,Q,M,!!this.rotation):this.ZW.x5h(Q,M,!!this.rotation);M.style.zIndex=String(this.zIndex);return M}zLd(M){return M}mPd(){}x5a(M){if(M.UM&&this.control.$da()&&M.isVisible){var Q=
u.c(this.PS);u.l(Sys.UI.DomElement.getBounds(M.Uv.parentNode),M.UM,Q,M.fm.rtl);B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FOResizeHandlesFix",!1)&&u.o(M.UM,this.rotation,!1)}}nXh(M){const Q=this.control;if(Q.UM&&this.control.$da()&&Q.isVisible){var R=u.e(this.L9d);u.o(Q.UM,M,!0,R)}}aOa(){this.Rm=this.control.fm;this.Nk=this.ml();this.b$=0;this.ys&&this.ys.clear()}Via(M){this.b$=M;this.m7(null)}pne(M,Q){this.viewBlockContainerHelpers.HLg(this.Rm,this.control.domElement,M,Q)}ml(){return this.viewBlockContainerHelpers.Lfa(this.Rm,
this.control.domElement)}Ny(M,Q){return this.viewBlockContainerHelpers.Ny(this.Rm,M,Q)}resize(M,Q){this.N9=M;const R=this.Rm.ow,O=this.control.fm.ow;this.dG=this.Ny(M,this.Rm.rtl);const U=e.a.MP(this.dG,this.Bia);this.dG=this.Ny(M,!1);this.da.rtl&&(M=D.a.KO(this.Rm.paneType,this.Rm.view.Xm),this.dG.x-=2*M.x);this.Snd(U);this.Lie(Q,U.x-(O.x-R.x),U.y-(O.y-R.y),-this.Rm.ow.x,-this.Rm.ow.y,!0)}Snd(M){if(this.PS){var Q=u.c(this.PS);Q=u.k(new Sys.UI.Point(M.x,M.y),[Q[0],-Q[1],-Q[2],Q[3]],this.Rm.rtl);M.x=
Q.x;M.y=Q.y}}JMc(M){if(!this.yna(M))return!1;this.control.extension&&this.control.extension.bP&&this.control.extension.bP.O3b();return!0}Lie(M,Q,R,O,U,K){const {FloatingObjectControlExtension:F}=a(945),I=u.d(this.PGa),P=u.h(this.PGa);var Y=!!this.nh&&C.a.xR(this.nh);Q=N.cFg(this.Nk.topLeft.x,this.Nk.width,Y?0:N.minWidth,Q,I);R=N.cFg(this.Nk.topLeft.y,this.Nk.height,Y?0:N.minHeight,R,P);Y=N.bFg(this.Nk.topLeft.x,this.Nk.width,Q,I);const ea=N.bFg(this.Nk.topLeft.y,this.Nk.height,R,P);if((this.$ob||
this.uya)&&d.a(this.PGa)){const Ba=N.ratio(this.Nk.width,this.Nk.height);N.ratio(Q.es,R.es)<Ba?N.Bxf(Ba,Y,Q,R.es,I,!0):N.Bxf(Ba,ea,R,Q.es,P,!1)}N.P7e(this.Nk.topLeft.x,N.minWidth,O,Q);N.P7e(this.Nk.topLeft.y,N.minHeight,U,R);this.PS&&(O=u.c(this.PS),U=new r.a(Q.position,R.position,Q.es,R.es),O=u.b(this.Nk,U,this.PGa,O,this.DO,this.EO,this.Rm.rtl),Q.position=O.x,R.position=O.y);O=new r.a(Q.position,R.position,0,0);K&&(this.Rm=F.Tnd(O,this.Nk,this.Rm,this.control,!0));this.pne(new r.a(O.x,O.y,Q.es,
R.es),M);this.Yt=this.ml();this.DO=Y;this.EO=ea;this.control.floatingObject&&this.control.$da()?(this.m7(null),this.opk(Q.es,R.es,this.DO,this.EO)):this.control.floatingObject&&this.control.y0a()&&(this.m7(null),this.rpk(Q.es,R.es,this.DO,this.EO));this.raiseEvent("Resized",new l.a(Q.es,R.es,this.DO,this.EO));this.X1a&&this.X1a(()=>({["floatingObjectType"]:C.a.dH(this.control.floatingObject),["Location"]:"canvas"}))}mfa(){this.Qpf();if(this.aHc)this.Mpf();else{const {sob:M,$tb:Q,bxb:R,oeb:O,flipX:U,
flipY:K}=this.Opf();this.raiseEvent(N.P3b,new w.a(M,R,Q,O,U,K,this.Rm));this.nh&&this.nh.IsShapeGC2ModelRendered&&this.control.extension.updateTransformResizeEnded(U,K)}this.Npf()}Wnd(){this.control.floatingObject&&(this.zIndex=this.control.G0a?k.a.S$b:k.a.wQa+2*this.control.floatingObject.kL+1,this.uya=this.control.floatingObject.uya)}Wme(M,Q){this.mgd=!0;this.rec=!1;this.PGa=Q;this.K9d=M;this.$ob=this.EO=this.DO=!1;this.cU.Aa("keydown",this.P6d);M=this.control.floatingObject.type;this.control.lia(!1,
0!==M&&3!==M);this.control.clientVersion++;this.control&&this.control.extension&&(M=this.control.extension,c.ULS.sendTraceTag(537162309,5,50,`ImageResizableBehavior:StartResize: Image-Updated=${0<M.NNa||0<M.OLa||0<M.lAa?"false":"true"} ResizeOperationsSinceLastLoad=${M.NNa} MoveOperationsSinceLastLoad=${M.OLa} RotateOperationsSinceLastLoad=${M.lAa} ResizeType=${Q}`))}OSi(M){for(;M&&M!==this.control.domElement;){const Q=f.a.HHd(M,774);if(Q)return Q;M=M.parentNode}c.ULS.shipAssertTag(537162308,5,!1,
"ImageResizableBehavior.GetResizePointHandle: Can't find the resize point");return null}eZa(M,Q,R){return(R?-1:1)*Q/(M||1)}hIg(){u.m(this.control.BB,0,0,this.ys)}Qpf(){this.cU.sO();this.mgd=!1}Opf(){(this.control.$da()||this.control.y0a())&&this.ys.add(new v.a(this.pAa,this.qAa,this.translateX,this.translateY,this.PS));let M=this.Nk,Q=this.Yt;this.nh&&C.a.vaa(this.PS,this.nh.FlipX!==this.nh.FlipY)&&(M=this.Nk.kOb(),Q=this.Yt.kOb());return{sob:Q.topLeft.x-M.topLeft.x,$tb:Q.bottomRight.x-M.bottomRight.x,
bxb:Q.topLeft.y-M.topLeft.y,oeb:Q.bottomRight.y-M.bottomRight.y,flipX:this.Tlc?this.EO:this.DO,flipY:this.Tlc?this.DO:this.EO}}Mpf(){this.rec=!1;this.raiseEvent("ResizeCancelled")}Npf(){this.N9=this.dG=this.Bia=this.Nk=null;this.EO=this.DO=!1;this.K9d=null;this.control&&this.control.extension&&(this.control.lia(!0),this.control.extension.NNa++)}fIg(M,Q,R,O){const U=this.Rm.rtl,K=new Sys.UI.Point(this.Nk.x+this.o0b-(U?this.Nk.width:0),this.Nk.y+this.p0b);var F=u.c(this.PS);F=u.f(this.Nk,this.PS,F,
this.PGa,this.Rm.rtl);this.pAa=this.eZa(this.Nk.width,M,R);this.qAa=this.eZa(this.Nk.height,Q,O);M=u.g(F,K,this.PS,this.pAa,this.qAa);this.translateX=F.x-M.x;this.translateY=F.y-M.y;this.Yt=this.ml();this.translateX=U?this.translateX-(this.Nk.bottomRight.x-this.Yt.bottomRight.x):this.translateX+(this.Nk.topLeft.x-this.Yt.topLeft.x);this.translateY+=this.Nk.topLeft.y-this.Yt.topLeft.y}rpk(M,Q,R,O){if(B.EwaSettings.isChangeGateEnabled("OfficeVSO:4260575_ThickBorderResizingOrigin")){this.fIg(M,Q,!1,
!1);if(R)switch(this.PGa){case 7:case 6:case 5:this.translateX=this.Rm.rtl?this.translateX-M:this.translateX+M;break;case 1:case 2:case 3:this.translateX=this.Rm.rtl?this.translateX+M:this.translateX-M}if(O)switch(this.PGa){case 7:case 0:case 1:this.translateY+=Q;break;case 5:case 4:case 3:this.translateY-=Q}this.ys.add(new v.a(this.pAa,this.qAa,this.translateX,this.translateY,0))}else this.ys.add(new v.a(this.pAa,this.qAa,0,0,0));this.hIg();this.ys.removeAt(this.ys.count-1)}opk(M,Q,R,O){this.control.Gj&&
(this.fIg(M,Q,R,O),this.nh&&this.nh.IsShapeGC2ModelRendered?this.Tlc?this.control.extension.updateTransformDuringOperation(Q,M,O,R,null):this.control.extension.updateTransformDuringOperation(M,Q,R,O,null):(this.ys.add(new v.a(this.pAa,this.qAa,this.translateX,this.translateY,this.PS)),this.hIg(),this.ys.removeAt(this.ys.count-1)))}static PSi(M){return M?M.ONa:0}static pqf(M,Q){return(0>M?-1:1)*Math.max(Math.abs(M),Q)}static ratio(M,Q){return Q?M/Q:1}static cFg(M,Q,R,O,U){const K=new n(M,Q);switch(U){case 1:Q-=
O;K.es=N.pqf(Q,R);K.position=M+O-(K.es-Q);break;case 3:K.es=N.pqf(Q+O,R)}return K}static bFg(M,Q,R,O){const U=0>R.es;if(U)switch(R.es*=-1,O){case 3:R.position=M-R.es;break;case 1:R.position=M+Q}return U}static Bxf(M,Q,R,O,U,K){const F=R.es;R.es=K?z.HelperMethods.eJ(O*M):z.HelperMethods.eJ(O/(M||1));if(!Q&&1===U||Q&&3===U)R.position-=R.es-F}static P7e(M,Q,R,O){O.position<R&&(O.es+=O.position-R,O.position=R,O.es<Q&&(O.position=M,O.es=Q))}}N.minWidth=5;N.minHeight=5;N.Q3b="ResizeStarted";N.P3b="ResizeFinished";
Object(y.a)(N,"ImageResizableBehavior",f.a,[798,123])},1022:function(y,x,a){a.d(x,"c",function(){return b});a.d(x,"d",function(){return f});a.d(x,"e",function(){return r});a.d(x,"b",function(){return d});a.d(x,"a",function(){return k});a.d(x,"f",function(){return t});var c=a(62);const b=(m,e,w,l,u,n)=>{const v=m.Za(1);v.imageId=e;return c.h(m,"GetEffectsExtents",v,w,l,u,n,4)},f=(m,e,w,l,u,n,v,B,z,C,D,J,W)=>{const N=m.Za(9);N.floatingObjectType=e;N.id=w;N.absoluteLeft=l;N.absoluteTop=u;N.absoluteRight=
n;N.absoluteBottom=v;N.toggleFlipX=B;N.toggleFlipY=z;return c.h(m,"MoveAndResizeFloatingObject",N,C,D,J,W,0)},r=(m,e,w,l,u,n,v,B,z,C,D,J,W,N,M,Q,R)=>{const O=m.Za(9);O.floatingObjectType=e;O.id=w;O.absoluteLeft=l;O.absoluteTop=u;O.absoluteRight=n;O.absoluteBottom=v;O.toggleFlipX=B;O.toggleFlipY=z;O.connectToFloatingObjectType=C;O.connectToId=D;O.connectionSite=J;O.endpointType=W;return c.h(m,"ResizeConnectorFloatingObject",O,N,M,Q,R,0)},d=(m,e,w,l,u,n,v)=>{const B=m.Za(9);B.floatingObjectType=e;B.id=
w;return c.h(m,"DeleteFloatingObject",B,l,u,n,v,0)},k=(m,e,w,l,u,n,v)=>{const B=m.Za(9);B.id=e;B.zOrderChangeType=w;return c.h(m,"ChangeFloatingObjectZOrder",B,l,u,n,v,0)},t=(m,e,w,l,u,n,v)=>{const B=m.Za(9);B.id=e;B.rotationAngle=w;return c.h(m,"RotateOartElement",B,l,u,n,v,0)}},1023:function(y,x,a){a.d(x,"a",function(){return c});y=a(0);class c extends Sys.EventArgs{constructor(b,f,r,d,k,t,m,e){e=void 0===e?!1:e;super();this.Mcd=b;this.ujd=f;this.Cgd=r;this.a6c=d;this.qjd=k;this.rjd=t;this.Hfh=
m;this.Kjh=e}get sob(){return this.Mcd}get bxb(){return this.ujd}get $tb(){return this.Cgd}get oeb(){return this.a6c}get tue(){return this.qjd}get uue(){return this.rjd}get fm(){return this.Hfh}get Kej(){return this.Kjh}}Object(y.a)(c,"MoveAndResizeCompleteEventArgs",Sys.EventArgs,[])},1025:function(y,x,a){a.d(x,"a",function(){return c});y=a(0);class c{constructor(){this.excelHealth=this.actionHandler=this.logger=this.parent=this.id=null}}Object(y.a)(c,"ExcelHostConfig",null,[])},1043:function(y,
x,a){a.r(x);a.d(x,"ChartFloatingObjectControl",function(){return Hb});y=a(0);var c=a(14),b=a(1220),f=a(361),r=a(934),d=a(960),k=a(96),t=a(182),m=a(208),e=a(353),w=a(158);x=a(914);var l;(function(na){na.QueryBreadcrumbDocName="QueryBreadcrumbDocName";na.QuerySessionId="QuerySessionId";na.QueryBuildVersion="QueryBuildVersion";na.QueryFormatPainter="QueryFormatPainter";na.QueryFontSize="QueryFontSize";na.QueryZoomValue="QueryZoomValue";na.QueryFontName="QueryFontName";na.QueryBold="QueryBold";na.QueryFormulaView=
"QueryFormulaView";na.QueryItalics="QueryItalics";na.QueryUnderline="QueryUnderline";na.QueryDoubleUnderline="QueryDoubleUnderline";na.QueryChartGalleryIcon="QueryChartGalleryIcon";na.QueryEditingView="QueryEditingView";na.QueryReadingView="QueryReadingView";na.QuerySelectedChartElement="QuerySelectedChartElement";na.QueryShowChanges="QueryShowChanges";na.QueryShowComments="QueryShowComments";na.QueryAlignmentWrap="QueryAlignmentWrap";na.QueryMergeCellsMenu="QueryMergeCellsMenu";na.QueryShowGridlines=
"QueryShowGridlines";na.QueryShowHeadings="QueryShowHeadings";na.QueryShowFormulaBar="QueryShowFormulaBar";na.QueryChangeSheetDirection="QueryChangeSheetDirection";na.QuerySimplifiedRibbonIsEnabled="QuerySimplifiedRibbonIsEnabled";na.QueryAlignment="QueryAlignment";na.QueryAlignmentLeft="QueryAlignmentLeft";na.QueryAlignmentCenter="QueryAlignmentCenter";na.QueryAlignmentRight="QueryAlignmentRight";na.QueryAlignmentTop="QueryAlignmentTop";na.QueryFreezePanes="QueryFreezePanes";na.QueryUnFreezePanes=
"QueryUnFreezePanes";na.QueryFreezeRows="QueryFreezeRows";na.QueryFreezeColumns="QueryFreezeColumns";na.QueryFreezePanesTopRow="QueryFreezePanesTopRow";na.QueryFreezePanesFirstColumn="QueryFreezePanesFirstColumn";na.QueryAlignmentMiddle="QueryAlignmentMiddle";na.QueryAlignmentBottom="QueryAlignmentBottom";na.QueryCopyAndEditButton="QueryCopyAndEditButton";na.QueryNumberFormat="QueryNumberFormat";na.QueryAverageButton="QueryAverageButton";na.QueryCountButton="QueryCountButton";na.QueryNumericalCountButton=
"QueryNumericalCountButton";na.QueryMinimumButton="QueryMinimumButton";na.QueryMaximumButton="QueryMaximumButton";na.QuerySumButton="QuerySumButton";na.QueryStrikethrough="QueryStrikethrough";na.QueryToggleAutoFilter="QueryToggleAutoFilter";na.QueryIncreaseIndent="QueryIncreaseIndent";na.QueryDecreaseIndent="QueryDecreaseIndent";na.QueryShapeOutlineWeight="QueryShapeOutlineWeight";na.QueryShapeOutlineDashes="QueryShapeOutlineDashes";na.QueryShapeStyle="QueryShapeStyle";na.QueryConditionalFormattingGalleryIcon=
"QueryConditionalFormattingGalleryIcon";na.QueryDeleteCellsShiftLeft="QueryDeleteCellsShiftLeft";na.QueryInsertCellsShiftRight="QueryInsertCellsShiftRight";na.QueryInsertColumnsTable="QueryInsertColumnsTable";na.QueryInsertCopiedCutCells="QueryInsertCopiedCutCells";na.QuerySetReadOnlyRecommended="QuerySetReadOnlyRecommended";na.QueryLinkedEntityGalleryButtons="QueryLinkedEntityGalleryButtons";na.QueryLinkedEntityMenuGalleryButtons="QueryLinkedEntityMenuGalleryButtons";na.QueryBorderColor="QueryBorderColor";
na.QueryBorderStyle="QueryBorderStyle";na.QueryActiveNamedSheetViewName="QueryActiveNamedSheetViewName";na.QueryCalcMode="QueryCalcMode";na.QueryCalcModeMLR="QueryCalcModeMLR";na.QueryAdvancedPasteContextMenuGalleryIcon="QueryAdvancedPasteContextMenuGalleryIcon";na.QueryTableStyleOption="QueryTableStyleOption";na.QuerySensitivity="QuerySensitivity";na.QueryBorderGalleryIcon="QueryBorderGalleryIcon";na.QueryCellStyles="QueryCellStyles";na.QueryTableStyle="QueryTableStyle";na.QueryEditInExcel="QueryEditInExcel";
na.QueryTableName="QueryTableName";na.QueryPivotTableRowHeaders="QueryPivotTableRowHeaders";na.QueryPivotTableColumnHeaders="QueryPivotTableColumnHeaders";na.QueryPivotTableBandedRows="QueryPivotTableBandedRows";na.QueryPivotTableBandedColumns="QueryPivotTableBandedColumns";na.QueryAutomateGalleryButtons="QueryAutomateGalleryButtons";na.QueryFieldListStatus="QueryFieldListStatus";na.QueryPivotTableDrillInState="QueryPivotTableDrillInState";na.QueryPivotTableSettingsStatus="QueryPivotTableSettingsStatus";
na.QueryModeSwitcherViewMode="QueryModeSwitcherViewMode";na.QueryModeSwitcherEditMode="QueryModeSwitcherEditMode";na.QueryLinkedEntityGalleryIcon="QueryLinkedEntityGalleryIcon";na.QueryClearGallerySelection="QueryClearGallerySelection";na.QuerySlicerSettingsStatus="QuerySlicerSettingsStatus";na.QueryLinkedEntityMenuGalleryButtonsRedesign="QueryLinkedEntityMenuGalleryButtonsRedesign";na.QueryToggleCatchUpFlyout="QueryToggleCatchUpFlyout";na.QueryInkDrawWithTouch="QueryInkDrawWithTouch";na.QueryInkTool=
"QueryInkTool";na.QueryInkThickness="QueryInkThickness";na.QueryInkRecentColors="QueryInkRecentColors";na.QueryInkSnapToText="QueryInkSnapToText";na.QueryPivotTableStyles="QueryPivotTableStyles";na.QuerySlicerStyles="QuerySlicerStyles";na.QueryTableFormatStyles="QueryTableFormatStyles";na.QueryRecentFillColor="QueryRecentFillColor";na.QueryRecentFontColor="QueryRecentFontColor";na.QueryRecentBorderColor="QueryRecentBorderColor";na.QueryRecentShapesFillColor="QueryRecentShapesFillColor";na.QueryRecentShapesOutlineColor=
"QueryRecentShapesOutlineColor";na.QueryRecentChartOutlineColor="QueryRecentChartOutlineColor";na.QueryNewEditNote="QueryNewEditNote";na.QueryShowAllNotes="QueryShowAllNotes";na.QueryPhonetics="QueryPhonetics";na.QueryPauseResumeProtection="QueryPauseResumeProtection";na.QueryPresentModeOverlayState="QueryPresentModeOverlayState";na.QueryOrientation="QueryOrientation";na.QueryRotateTextUp45="QueryRotateTextUp45";na.QueryRotateTextDown45="QueryRotateTextDown45";na.QueryRotateTextUp90="QueryRotateTextUp90";
na.QueryRotateTextDown90="QueryRotateTextDown90";na.QueryVerticalText="QueryVerticalText";na.QueryAddInFlyout="QueryAddInFlyout";na.QueryUndoRedo="QueryUndoRedo";na.QueryUndo="QueryUndo";na.QueryRedo="QueryRedo";na.QueryInsertCells="QueryInsertCells";na.QueryDeleteCells="QueryDeleteCells";na.QueryFontPickerFont="QueryFontPickerFont";na.QueryInsertColumns="QueryInsertColumns";na.QueryFullScreen="QueryFullScreen";na.QueryZoomComboBoxValue="QueryZoomComboBoxValue";na.QueryPivotTableAutoRefresh="QueryPivotTableAutoRefresh";
na.QueryCopilot="QueryCopilot"})(l||(l={}));Object(y.b)("RibbonQueryCommand",l);var u=a(68),n=a(991),v=a(283),B=a(77),z=a(69),C=a(965),D=a(1216),J=a(419),W=a(212),N=a(62),M=a(25),Q=a(40),R=a(122),O=a(2),U=a(181),K=a(302),F=a(17),I=a(286),P=a(13),Y=a(12),ea=a(1061);class Ba{constructor(na,Gb){this.chartBannerLink=this.q_=this.nI=null;this.WRc=this.VRc=this.URc=this.Hhc=this.P9a=!1;this.$Uj=new m.a;this.AKj=new m.a;this.TZb=()=>{this.eQg()&&(this.xqe(),c.ULS.sendTraceTag(577525538,5,50,`ChartBanner.OnChartElementPointerDown. ID:${this.Hw.floatingObject.fi}, FreezePanes:${this.Hw.da.Pg.Uo}, chart banner is shown.`));
return!1};this.N6d=Xa=>{this.c0i();for(const Jb of this.AKj)Jb(this,Xa);c.ULS.sendTraceTag(577525537,5,50,`ChartBanner.OnDismissChartBanner. ID:${this.Hw.floatingObject.fi}, FreezePanes:${this.Hw.da.Pg.Uo}, chart banner is dismissed.`);return!0};this.y6d=()=>{P.HelperMethods.dm(Ba.Jaf,"_blank");c.ULS.sendTraceTag(577288206,5,50,`ChartBanner.OnChartBannerInvokeLink. ID:${this.Hw.floatingObject.fi}, FreezePanes:${this.Hw.da.Pg.Uo}, chart banner link is invoked.`);return!0};if(!na)throw c.ULS.sendTraceTag(537162458,
5,10,"ChartBanner.ChartBanner: chartFloatingObjectControl is null."),Error.invalidOperation("chartFloatingObjectControl is null.");this.Hw=na;this.ha=Gb}dispose(){this.Aoe()&&(this.ysc(),this.dwe(),this.W0g())}eQg(){return this.Hw.Aga()&&this.Hw.floatingObject&&this.Hw.floatingObject.Ki&&this.Hw.floatingObject.Ki.ChartPlayerData?!!this.Hw.floatingObject.Ki.ChartPlayerData.ImageData&&!this.P9a&&this.Hw.GVb:!1}Aoe(){if(this.Hw.Aga()){if(!this.Hw.floatingObject||!this.Hw.floatingObject.Ki||!this.Hw.floatingObject.Ki.ChartPlayerData)return!1;
if(this.Hw.floatingObject.Ki.ChartPlayerData.ImageData&&!this.P9a)return!0}return!1}j5h(){if(!this.nI){this.nI=document.createElement("div");this.nI.style.position="absolute";this.nI.style.top="0px";this.nI.style.width="100%";this.nI.style.visibility="hidden";this.nI.className=Ba.atd;this.Hw.Gj.style.overflow="hidden";this.Hw.Gj.appendChild(this.nI);this.chartBannerLink=this.q_=null;var na=Date.now();U.a.wKd().then(Gb=>{Gb.initializeMessageBarInStore();const Xa=Object(O.a)(new ea.a,{message:Y.a.instance.ia(985),
isMultiline:!0,messageBarType:5,closeable:!0,dismissButtonAriaLabel:Y.a.instance.ia(986),onDismiss:()=>{},linkProps:{["type"]:"AppLinkProps",["text"]:Y.a.instance.ia(987),["handler"]:{["href"]:Ba.Jaf,["target"]:"_blank"}}});Gb.createNewMessageBar(this.nI,Xa);window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.$af();var Jb=this.nI.querySelector('[aria-label="'+Y.a.instance.ia(986)+'"]');Jb&&(this.q_=Jb,this.uek());if(Jb=this.nI.getElementsByTagName("a")[0])this.chartBannerLink=Jb,this.vek();
Jb=Date.now()-na;c.ULS.sendTraceTag(577525568,5,50,`ChartBanner.CreateReactChartBanner: ID:${this.Hw.floatingObject.fi}: chart banner is rendered in ${Jb}ms`)},0)});return null},Gb=>{c.ULS.sendTraceTag(577525539,5,15,`ChartBanner.CreateReactChartBanner: ID:${this.Hw.floatingObject.fi}: Failed to GetMessageBarAPIAsync: ${Gb}`);return null})}}xqe(){this.nI?(this.Hw.Gj.getElementsByClassName(Ba.atd).length||this.Hw.Gj.appendChild(this.nI),this.$af()):this.j5h();this.Hhc=!0;this.ysc();for(const na of this.$Uj)na(this,
new Sys.EventArgs)}$af(){this.nI&&(this.nI.style.visibility="hidden",this.nI.style.display="block",0<this.Hw.Gj.offsetHeight&&.75>this.nI.offsetHeight/this.Hw.Gj.offsetHeight?this.nI.style.visibility="visible":this.Hw.Gj.removeChild(this.nI))}CSk(na){switch(na){case null:this.xqe();this.ha.$e.RL=Ba.ffb;break;case Ba.ffb:this.ha.$e.RL=Ba.efb;this.q_.style.border="1px solid";this.q_.style.borderColor=this.Hw.borderColor;break;case Ba.efb:this.N6d(null);this.ha.$e.RL=null;break;case Ba.chartBannerLink:this.y6d(null)}}ESk(na){switch(na){case Ba.ffb:return this.ha.$e.RL=
null,!1;case Ba.efb:this.q_.style.border="0px";this.ha.$e.RL=Ba.ffb;break;case Ba.chartBannerLink:this.chartBannerLink.style.border="0px",this.ha.$e.RL=Ba.ffb}return!0}DSk(na){switch(na){case Ba.efb:this.ha.$e.RL=Ba.chartBannerLink;this.q_.style.border="0px";this.chartBannerLink.style.border="1px solid";this.chartBannerLink.style.borderColor=this.Hw.borderColor;break;case Ba.chartBannerLink:this.ha.$e.RL=Ba.efb,this.chartBannerLink.style.border="0px",this.q_.style.border="1px solid"}return!0}wGh(){this.URc||
window.setTimeout(()=>{K.a.instance.ya(F.a.Zi,this.Hw.domElement,this.TZb);this.URc=!0},0)}ysc(){this.URc&&(K.a.instance.Na(F.a.Zi,this.Hw.domElement,this.TZb),this.URc=!1)}uek(){this.VRc||(this.q_&&I.a.instance.ya(F.a.click,this.q_,this.N6d),this.VRc=!0)}dwe(){this.VRc&&(this.q_&&I.a.instance.Na(F.a.click,this.q_,this.N6d),this.VRc=!1)}vek(){this.WRc||(this.chartBannerLink&&I.a.instance.ya(F.a.click,this.chartBannerLink,this.y6d),this.WRc=!0)}W0g(){this.WRc&&(this.chartBannerLink&&I.a.instance.Na(F.a.click,
this.chartBannerLink,this.y6d),this.WRc=!1)}c0i(){this.dwe();this.W0g();0<this.Hw.Gj.getElementsByClassName(Ba.atd).length&&this.Hw.Gj.removeChild(this.nI);this.P9a=!0;this.chartBannerLink=this.q_=this.nI=null;this.ha.$e.RL=null}select(na){na?this.wGh():(this.ysc(),this.ha.$e.RL=null,this.q_&&(this.q_.style.border="0px"),this.chartBannerLink&&(this.chartBannerLink.style.border="0px"))}getSelectionDescription(na){let Gb=null;na===Ba.ffb?Gb=Y.a.instance.ia(985):na===Ba.efb?Gb=Y.a.instance.ia(986):na===
Ba.chartBannerLink&&(Gb=Y.a.instance.ia(987));return Gb}get Iaf(){return this.P9a}set Iaf(na){this.P9a!==na&&(this.P9a=na)}get Upe(){return this.Hhc}set Upe(na){this.Hhc!==na&&(this.Hhc=na)}}Ba.atd="chart-banner";Ba.ffb="chart-banner-root";Ba.efb="chart-banner-closeButton";Ba.chartBannerLink="chart-banner-link";Ba.Jaf="https://support.microsoft.com/office/2063733d-f4ec-4869-8f02-1534ced82d78";Object(y.a)(Ba,"ChartBanner",null,[]);var Fa=a(26),za=a(45);class xa{constructor(na,Gb,Xa,Jb,qb){this.category=
na;this.data=Gb;this.title=Xa;this.bubble=Jb;this.id=qb}}Object(y.a)(xa,"Series",null,[]);var fa=a(387);class V{constructor(){this.o7f=[];this.p7f=[];this.q7f=[];this.B8f=[]}get series(){return this.B8f}get PCh(){return this.o7f}get RCh(){return this.p7f}get VCh(){return this.q7f}I_e(na,Gb,Xa,Jb,qb){this.series.push(new xa(na,Gb,Xa,Jb,qb))}merge(){let na=[],Gb=[],Xa=[];for(const Jb of this.B8f)na=na.concat(Jb.category),Gb=Gb.concat(Jb.title),Xa=Xa.concat(Jb.data),Xa=Xa.concat(Jb.bubble);this.o7f=
this.g3d(na);this.q7f=this.g3d(Gb);this.p7f=this.g3d(Xa)}g3d(na){na.sort((Jb,qb)=>Jb.range.left<qb.range.left?-1:Jb.range.left==qb.range.left?Jb.range.top<qb.range.top?-1:1:1);const Gb=[];for(const Jb of na){var Xa=!1;for(na=0;na<Gb.length;na++)if(this.gej(Jb,Gb[na])){Xa=new fa.a(za.J([Jb.range,Gb[na].range]),Jb.sheetId);Gb[na]=Xa;Xa=!0;break}Xa||this.contains(Jb,Gb)||Gb.push(Jb)}return Gb}contains(na,Gb){for(const Xa of Gb)if(na.range.right<=Xa.range.right&&na.range.left>=Xa.range.left&&na.range.top<=
Xa.range.top&&na.range.bottom>=Xa.range.bottom)return!0;return!1}gej(na,Gb){if(na.sheetId===Gb.sheetId)if(na.range.top===Gb.range.top&&na.range.bottom===Gb.range.bottom){if(na.range.right+1===Gb.range.left||Gb.range.right+1===na.range.left)return!0}else if(na.range.right===Gb.range.right&&na.range.left===Gb.range.left&&(na.range.bottom+1===Gb.range.top||Gb.range.bottom+1===na.range.top))return!0;return!1}}Object(y.a)(V,"Chart",null,[]);var ba=a(24);class la{constructor(na){this.onPointerDown=Gb=>
{ua.v1c(Gb.oh);return!0};this.lw=ba.f(na)}update(na,Gb,Xa){this.hide();this.Dq=[null,null,null];this.Dq[0]={c0:0,sA:na,PO:[36],Yk:null};this.Dq[1]={c0:1,sA:Gb,PO:[34],Yk:null};this.Dq[2]={c0:2,sA:Xa,PO:[35],Yk:null};this.show()}dispose(){this.hide();this.Dq=null}show(){this.Dq&&this.Dq.forEach(na=>{var Gb;0<(null===(Gb=na.sA)||void 0===Gb?void 0:Gb.length)&&(this.lw.rh.BP(na.sA,na.PO,!0),na.Yk=this.lw.rh.rU(na.PO[0],this.lw.Pg.ro(na.sA[0].range.topLeft)).Yk,K.a.instance.ya(F.a.Zi,na.Yk,this.onPointerDown))})}hide(){this.Dq&&
this.Dq.forEach(na=>{var Gb;0<(null===(Gb=na.sA)||void 0===Gb?void 0:Gb.length)&&(K.a.instance.Na(F.a.Zi,na.Yk,this.onPointerDown),this.lw.rh.zq(na.PO),this.lw.rh.Vs(null,na.PO))})}}Object(y.a)(la,"ChartFoilsStaticBehavior",null,[]);var Ta=a(7),Ea=a(57),sa=a(34),Ya=a(193);class bb extends C.a{constructor(na,Gb,Xa,Jb){super(na,512,null);this.region=this.seriesIndex=-1;this.sheetRange=null;this.seriesIndex=Gb;this.region=Xa;this.sheetRange=Jb}}Object(y.a)(bb,"MacroRecorderChartSeriesDataChangedPayload",
C.a,[]);var ra=a(35),Da=a(1),oa=a(27),Ha=a(262),ka=a(47),wa;(function(na){na[na.title=0]="title";na[na.category=1]="category";na[na.data=2]="data";na[na.bubblesize=3]="bubblesize";na[na.none=4]="none"})(wa||(wa={}));Object(y.b)("FoilRegion",wa);class Za{}Object(y.a)(Za,"FoilInfo",null,[]);var ab;(function(na){na[na.none=0]="none";na[na.resize=1]="resize";na[na.move=2]="move"})(ab||(ab={}));Object(y.b)("Action",ab);var db;(function(na){na[na.topLeft=0]="topLeft";na[na.topRight=1]="topRight";na[na.bottomRight=
2]="bottomRight";na[na.bottomLeft=3]="bottomLeft";na[na.length=4]="length"})(db||(db={}));Object(y.b)("Corner",db);var mb;(function(na){na[na.none=0]="none";na[na.top=1]="top";na[na.bottom=2]="bottom";na[na.left=3]="left";na[na.right=4]="right";na[na.ambiguous=5]="ambiguous"})(mb||(mb={}));Object(y.b)("Direction",mb);class Ia{constructor(){this.y=this.x=0}}Object(y.a)(Ia,"Coord",null,[]);class pa extends Za{}Object(y.a)(pa,"FoilInfoInteractive",Za,[]);class lb{}Object(y.a)(lb,"HandleSizeConfig",null,
[]);class ha{constructor(na,Gb,Xa){this.G1d=!1;this.$Xb=ha.ZXb.Vqe;this.W7f=ha.ZXb.N5d;this.I1d=ha.ZXb.Uqe;this.V7f=ha.ZXb.M5d;this.onPointerDown=Jb=>{var qb,Db,gb,ya;ua.v1c(Jb.oh);this.Qnd(ua.oh);if(this.VU!=ab.none)return!0;if(2===Jb.oh&&Jb.mw!=Sys.UI.MouseButton.leftButton)return!1;if(ka.a(this.lw.$).CUd||ka.a(this.lw.$).Ex())return this.Toc(),!0;Jb=this.zoomManager.Ik(Jb);this.CLa=this.fLd(Jb);if(!this.CLa)return!0;this.$ga=this.CLa.clone();var Aa=this.aIf(Jb?Jb.Qh:null);Aa?(this.VU=ab.resize,
this.JF=Aa.region,this.g2a=Aa.corner,this.T1d=Aa.U_i,Aa=this.$Hf(this.g2a),this.rme(Aa),this.lw.Um.Mx(Aa)):(this.JF=this.AAf(this.CLa),this.VU=ab.move,this.rme(ha.Q1d),this.lw.Um.Mx(ha.Q1d));if(4===this.JF)return!0;this.E7f=!0;3===Jb.oh&&this.uYe(Jb);this.Bya=null===(qb=this.wBa)||void 0===qb?void 0:qb.clone();this.qoa=null===(Db=this.lua)||void 0===Db?void 0:Db.clone();this.R0=null===(gb=this.Yua)||void 0===gb?void 0:gb.clone();this.TXb=null===(ya=this.dnc)||void 0===ya?void 0:ya.clone();return!0};
this.io=()=>{try{if(this.VU===ab.none)return!1;this.u3k();this.Toc()}catch(Jb){c.ULS.sendTraceTag(524895697,0,10,`ChartFoils onPointerUp error: Error: ${Jb.message}`)}return!0};this.ur=Jb=>{Jb=this.zoomManager.Ik(Jb);if(this.VU==ab.none)return this.uYe(Jb),!1;this.$ga=this.fLd(Jb);return this.VU===ab.move?(this.$ga&&this.bFj(),!0):this.VU===ab.resize?(this.D7f=Jb.clientPoint,this.$ga&&this.npk(),!0):!1};this.cPj=(Jb,qb)=>{0<this.ALa&&this.ALa--;c.ULS.sendTraceTag(524150548,6,50,`ChartFoils change request success: Errors: ${Jb&&
Jb.Errors&&0<Jb.Errors.length?ra.a.Kh(Jb.Errors):"none"}, Region: ${qb&&qb.region}, Action: ${qb&&qb.action}, Level: ${qb&&qb.level}`)};this.bPj=(Jb,qb)=>{0<this.ALa&&this.ALa--;c.ULS.sendTraceTag(524150547,6,50,`ChartFoils change request failure: Errors: ${Jb&&Jb.Errors&&0<Jb.Errors.length?ra.a.Kh(Jb.Errors):"none"}, Region: ${qb&&qb.region}, Action: ${qb&&qb.action}, Level: ${qb&&qb.level}`)};this.lw=ba.f(na);this.c2d=Xa;this.wLa=Gb;this.ALa=0;this.i8f=sa.a.Gx||sa.a.D0;this.Qnd(ua.oh)}get zoomManager(){return this.c2d.zoomManager}update(na,
Gb,Xa,Jb,qb,Db,gb){gb=void 0===gb?null:gb;this.E7f||0<this.ALa||(this.hide(),this.$0g(),this.VXb=na,this.eYb=Gb,this.YXb=Xa,this.Toc(),this.Dq=[null,null,null,null],this.Dq[0]={c0:0,sA:Jb,PO:[39],Yk:null,S$:null},this.Dq[1]={c0:1,sA:qb,PO:[37],Yk:null,S$:null},this.Dq[2]={c0:2,sA:Db,PO:[38],Yk:null,S$:null},this.ksi()&&this.W_()&&gb&&0<gb.length&&(this.Dq[3]={c0:3,sA:gb,PO:[40],Yk:null,S$:null}),this.Qnd(ua.oh),this.show(),this.b2e(ua.oh),this.Vek())}W_(){return null!=this.eYb&&0<this.eYb.length}ksi(){var na=
this.VXb;return 36==na||37==na}getSheetName(na){if((na=this.Dq[na])&&na.sA&&0<na.sA.length){na=na.sA[0].sheetId;for(const Gb of this.lw.$.sa.items)if(na===(null===Gb||void 0===Gb?void 0:Gb.sheetId))return Gb.name}return null}Ijb(na){return this.Dq[na]&&this.Dq[na].sA&&0<this.Dq[na].sA.length?this.Dq[na].sA[0].range:null}get wBa(){return this.Ijb(0)}get lua(){return this.Ijb(1)}get Yua(){return this.Ijb(2)}get dnc(){return this.Ijb(3)}Toc(){this.rme(ha.Q1d);this.lw.Um.Mx(Ta.a.Q$);this.JF=4;this.g2a=
db.length;this.D7f=this.$ga=this.CLa=this.T1d=null;this.VU=ab.none;this.E7f=!1;this.TXb=this.R0=this.qoa=this.Bya=null}dispose(){this.$0g();this.yFg();this.hide();this.Toc();this.eYb=this.VXb=this.wLa=this.Dq=this.lw=null;this.ALa=0;this.vKc=null}show(){this.Dq&&this.Dq.forEach(na=>{var Gb;na&&0<(null===(Gb=na.sA)||void 0===Gb?void 0:Gb.length)&&(this.lw.rh.BP(na.sA,na.PO,!0),na.Yk=this.lw.rh.rU(na.PO[0],this.lw.Pg.ro(na.sA[0].range.topLeft)).Yk);na&&na.Yk&&this.Rvh(na)})}hide(){this.Dq&&this.Dq.forEach(na=>
{var Gb;na&&0<(null===(Gb=na.sA)||void 0===Gb?void 0:Gb.length)&&(this.lw.rh.zq(na.PO),this.lw.rh.Vs(null,na.PO))})}Vek(){if(!this.i8f&&this.Dq&&(this.Dq.forEach(na=>{na&&na.Yk&&K.a.instance.ya(F.a.Zi,na.Yk,this.onPointerDown)}),this.lw))for(const na of this.lw.yu)K.a.instance.ya(F.a.$u,na.domElement,this.ur),K.a.instance.ya(F.a.jo,na.domElement,this.io),Ya.a.instance.ya(F.a.kn,na.domElement,this.ur),Ya.a.instance.ya(F.a.Ok,na.domElement,this.io)}$0g(){if(!this.i8f&&this.Dq&&(this.Dq.forEach(na=>
{na&&na.Yk&&K.a.instance.Na(F.a.Zi,na.Yk,this.onPointerDown)}),this.lw))for(const na of this.lw.yu)K.a.instance.Na(F.a.$u,na.domElement,this.ur),K.a.instance.Na(F.a.jo,na.domElement,this.io),Ya.a.instance.Na(F.a.kn,na.domElement,this.ur),Ya.a.instance.Na(F.a.Ok,na.domElement,this.io)}uYe(na){this.yFg();let Gb=!1,Xa;const Jb=this.aIf(na?na.Qh:null);Xa=Jb?Jb.region:this.AAf(this.fLd(na));if(Jb){Gb=!0;const qb=this.Dq[Xa].S$[Jb.corner];qb.style.zIndex=ha.tAj;qb.style.width=this.I1d;qb.style.height=this.I1d;
4!=Xa&&3===na.oh&&(qb.style.outlineWidth=ha.q8f);this.wme(qb,Jb.corner,this.V7f)}4!=Xa&&(Gb=!0,na=this.Dq[Xa].Yk,na.style.outlineWidth=ha.q8f,na.style.zIndex=ha.CAj);this.G1d=Gb}bFj(){let na=!1;2===this.JF?na=this.YEj():1===this.JF?na=this.XEj():0===this.JF?na=this.eFj():3===this.JF&&(na=this.VEj());na&&(this.hide(),this.show())}npk(){let na=!1;2===this.JF?na=this.jpk():1===this.JF?na=this.ipk():0===this.JF?na=this.tpk():3===this.JF&&(na=this.hpk());na&&(this.hide(),this.show())}NSi(na){switch(na){case 0:return Ea.a.Otf;
case 1:return Ea.a.Ntf;case 2:return Ea.a.Ptf;case 3:return Ea.a.Mtf;default:throw Error.argumentOutOfRange;}}wme(na,Gb,Xa){if(this.lw.rtl)switch(Gb){case db.topLeft:na.style.top=Xa;na.style.right=Xa;break;case db.topRight:na.style.top=Xa;na.style.left=Xa;break;case db.bottomRight:na.style.bottom=Xa;na.style.left=Xa;break;case db.bottomLeft:na.style.bottom=Xa,na.style.right=Xa}else switch(Gb){case db.topLeft:na.style.top=Xa;na.style.left=Xa;break;case db.topRight:na.style.top=Xa;na.style.right=Xa;
break;case db.bottomRight:na.style.bottom=Xa;na.style.right=Xa;break;case db.bottomLeft:na.style.bottom=Xa,na.style.left=Xa}}$Hf(na){return this.lw.rtl?na===db.topLeft||na===db.bottomRight?ha.l8f:ha.m8f:na===db.topLeft||na===db.bottomRight?ha.m8f:ha.l8f}Rvh(na){this.Dq[na.c0].S$=[null,null,null,null];if(na.Yk.children&&na.Yk.children.length==db.length)for(var Gb=db.topLeft;Gb<db.length;++Gb)this.Dq[na.c0].S$[Gb]=na.Yk.children[Gb];else{var Xa=this.NSi(na.c0);Xa&&(Gb=Jb=>{const qb=document.createElement("div");
qb.className=Xa;this.wme(qb,Jb,"0px");qb.style.cursor=this.$Hf(Jb);this.Dq[na.c0].S$[Jb]=qb;na.Yk.appendChild(qb)},Gb(db.topLeft),Gb(db.topRight),Gb(db.bottomRight),Gb(db.bottomLeft))}}aIf(na){if(na){var Gb=Xa=>{var Jb,qb=null===(Jb=this.Dq[Xa])||void 0===Jb?void 0:Jb.S$;if(qb)for(Jb=db.topLeft;Jb<db.length;++Jb)if(na===qb[Jb])return qb=new Ia,Jb===db.topLeft?(qb.y=this.Dq[Xa].sA[0].range.top-1,qb.x=this.Dq[Xa].sA[0].range.left-1):Jb===db.topRight?(qb.y=this.Dq[Xa].sA[0].range.top-1,qb.x=this.Dq[Xa].sA[0].range.right):
Jb===db.bottomLeft?(qb.y=this.Dq[Xa].sA[0].range.bottom,qb.x=this.Dq[Xa].sA[0].range.left-1):Jb===db.bottomRight&&(qb.y=this.Dq[Xa].sA[0].range.bottom,qb.x=this.Dq[Xa].sA[0].range.right),{region:Xa,corner:Jb,U_i:qb}};for(const Xa of[0,1,2,3]){const Jb=Gb(Xa);if(Jb)return Jb}}}rme(na){this.Dq&&this.Dq.forEach(Gb=>{Gb&&Gb.Yk&&(Gb.Yk.style.cursor=na)})}b2e(na){this.Dq.forEach(Gb=>{if(Gb&&Gb.S$)for(let Xa=db.topLeft;Xa<db.length;++Xa){const Jb=Gb.S$[Xa];Jb&&(Jb.style.width=this.$Xb,Jb.style.height=this.$Xb,
this.wme(Jb,Xa,this.W7f),2===na?(Jb.style.borderRadius=null,Jb.style.outlineColor=ha.n8f,Jb.style.outlineWidth=ha.rAj,Jb.style.backgroundColor=ha.U7f[Gb.c0]):(Jb.style.borderRadius="50%",Jb.style.outlineColor=ha.U7f[Gb.c0],Jb.style.outlineWidth=ha.r8f,Jb.style.backgroundColor=ha.n8f))}})}Qnd(na){na=2===na?ha.ZXb:ha.sAj;this.$Xb=na.Vqe;this.W7f=na.N5d;this.I1d=na.Uqe;this.V7f=na.M5d}yFg(){this.G1d&&(this.G1d=!1,this.Dq.forEach(na=>{na&&na.Yk&&(na.Yk.style.outlineWidth=ha.r8f,na.Yk.style.zIndex=ha.DAj[na.c0]);
if(na&&na.S$)for(const Gb of na.S$)Gb&&(Gb.style.width=this.$Xb,Gb.style.height=this.$Xb,Gb.style.zIndex=ha.uAj[na.c0])}),this.b2e(ua.oh))}AAf(na){var Gb,Xa,Jb,qb;let Db=4;if(!na)return Db;if(null===(Gb=this.Yua)||void 0===Gb?0:Gb.yi(na))Db=2;else if(null===(Xa=this.lua)||void 0===Xa?0:Xa.yi(na))Db=1;else if(null===(Jb=this.wBa)||void 0===Jb?0:Jb.yi(na))Db=0;else if(null===(qb=this.dnc)||void 0===qb?0:qb.yi(na))Db=3;return Db}fLd(na){return this.lw.ha.Ey(na.clientPoint,na.Qh,0)}iBe(na,Gb){if(!na||
!Gb)return mb.none;if(na.right<Gb.left){if(na.top===Gb.top&&na.bottom===Gb.bottom)return mb.left}else if(na.left>Gb.right){if(na.top===Gb.top&&na.bottom===Gb.bottom)return mb.right}else if(na.bottom<Gb.top){if(na.left===Gb.left&&na.right===Gb.right)return mb.top}else if(na.top>Gb.bottom&&na.left===Gb.left&&na.right===Gb.right)return mb.bottom;return mb.ambiguous}j6b(na,Gb,Xa){na.left+=Gb;na.right+=Gb;na.top+=Xa;na.bottom+=Xa}J5b(na,Gb){na=this.Ijb(na);if(!na||!Gb||na.equals(Gb))return!1;na.top=Gb.top;
na.bottom=Gb.bottom;na.left=Gb.left;na.right=Gb.right;return!0}Xba(na,Gb,Xa){Xa=this.J5b(2,Xa);Xa=this.J5b(1,Gb)||Xa;return Xa=this.J5b(0,na)||Xa}Jfb(na,Gb,Xa){if(!Xa)return[na,null];const Jb=na.clone();let qb=Xa.clone();Gb=this.iBe(Xa,Gb);Gb===mb.right?(qb.top=na.top,qb.bottom=na.bottom,na=na.right-qb.left+1,0<na&&(this.VU===ab.move?this.j6b(Jb,-na,0):this.VU===ab.resize&&(Jb.right+=-na))):Gb===mb.left?(qb.top=na.top,qb.bottom=na.bottom,na=na.left-qb.right-1,0>na&&(this.VU===ab.move?this.j6b(Jb,
-na,0):this.VU===ab.resize&&(Jb.left+=-na))):Gb===mb.top?(qb.left=na.left,qb.right=na.right,na=na.top-qb.bottom-1,0>na&&(this.VU===ab.move?this.j6b(Jb,0,-na):this.VU===ab.resize&&(Jb.top+=-na))):Gb===mb.bottom?(qb.left=na.left,qb.right=na.right,na=na.bottom-qb.top+1,0<na&&(this.VU===ab.move?this.j6b(Jb,0,-na):this.VU===ab.resize&&(Jb.bottom+=-na))):qb=null;return[Jb,qb]}Und(na,Gb,Xa,Jb){Gb=this.iBe(Jb,Gb);Gb===mb.right?(Xa.top=na.top,Xa.bottom=na.bottom):Gb===mb.left?(Xa.top=na.top,Xa.bottom=na.bottom):
Gb===mb.top?(Xa.left=na.left,Xa.right=na.right):Gb===mb.bottom&&(Xa.left=na.left,Xa.right=na.right)}h2e(na){let Gb=null;[na,Gb]=this.Jfb(na,this.R0,this.qoa);let Xa=null;[na,Xa]=this.Jfb(na,this.R0,this.Bya);this.Und(na,this.R0,Gb,this.qoa);return[Xa,Gb,na]}g2e(na){let Gb=null;[na,Gb]=this.Jfb(na,this.qoa,this.R0);let Xa=null;[Gb,Xa]=this.Jfb(Gb,this.R0,this.Bya);this.Und(Gb,this.R0,na,this.qoa);return[Xa,na,Gb]}i2e(na){let Gb=null;[na,Gb]=this.Jfb(na,this.Bya,this.R0);let Xa=null;[Gb,Xa]=this.Jfb(Gb,
this.R0,this.qoa);this.Und(Gb,this.R0,na,this.Bya);return[na,Xa,Gb]}X_c(na,Gb,Xa){if(!Xa)return null;const Jb=na.right-Gb.right;na=na.bottom-Gb.bottom;Xa=Xa.clone();this.j6b(Xa,Math.max(-Xa.left+1,Jb),Math.max(-Xa.top+1,na));return 0>=Xa.top||0>=Xa.left?null:Xa}YEj(){const na=this.X_c(this.$ga,this.CLa,this.R0);if(!na)return!1;if(this.W_())return this.Xba(this.wBa,this.lua,na);const [Gb,Xa,Jb]=this.h2e(na);return this.Xba(Gb,Xa,Jb)}XEj(){const na=this.X_c(this.$ga,this.CLa,this.qoa);if(!na)return!1;
if(this.W_())return this.Xba(this.wBa,na,this.Yua);const [Gb,Xa,Jb]=this.g2e(na);return this.Xba(Gb,Xa,Jb)}eFj(){const na=this.X_c(this.$ga,this.CLa,this.Bya);if(!na)return!1;if(this.W_())return this.Xba(na,this.lua,this.Yua);const [Gb,Xa,Jb]=this.i2e(na);return this.Xba(Gb,Xa,Jb)}VEj(){if(!this.W_())return!1;const na=this.X_c(this.$ga,this.CLa,this.TXb);return na?this.J5b(3,na):!1}MSi(){const na=this.T1d.x,Gb=this.T1d.y;let Xa=this.$ga.right,Jb=this.$ga.bottom;const qb=this.lw.Pxc(this.D7f).returnValue;
var Db=this.lw.kh(this.$ga);qb&&Db&&(Db=this.lw.getCellBounds(Db.cell,!1))&&(Xa>na?(Xa--,qb.x>Db.width/2&&Xa++):qb.x<Db.width/2&&Xa--,Jb>Gb?(Jb--,qb.y>Db.height/2&&Jb++):qb.y<Db.height/2&&Jb--);return{deltaX:Xa-na,deltaY:Jb-Gb}}z1(na){if(!na)return null;const {deltaX:Gb,deltaY:Xa}=this.MSi(),Jb=na.clone();switch(this.g2a){case db.topLeft:Jb.left=Math.max(1,Jb.left+Gb);Jb.left=Math.min(Jb.left,Jb.right);Jb.top=Math.max(1,Jb.top+Xa);Jb.top=Math.min(Jb.top,Jb.bottom);break;case db.topRight:Jb.right=
Math.max(1,Jb.right+Gb);Jb.right=Math.max(Jb.left,Jb.right);Jb.top=Math.max(1,Jb.top+Xa);Jb.top=Math.min(Jb.top,Jb.bottom);break;case db.bottomLeft:Jb.left=Math.max(1,Jb.left+Gb);Jb.left=Math.min(Jb.left,Jb.right);Jb.bottom=Math.max(1,Jb.bottom+Xa);Jb.bottom=Math.max(Jb.top,Jb.bottom);break;case db.bottomRight:Jb.right=Math.max(1,Jb.right+Gb);Jb.right=Math.max(Jb.left,Jb.right);Jb.bottom=Math.max(1,Jb.bottom+Xa);Jb.bottom=Math.max(Jb.top,Jb.bottom);break;default:return null}0===this.JF?this.W_()?
1<Jb.height&&Jb.height>=Jb.width?this.g2a==db.topLeft||this.g2a==db.bottomLeft?(Jb.left=na.right,Jb.right=na.right):(Jb.left=na.left,Jb.right=na.left):1<Jb.width&&Jb.width>Jb.height&&(this.g2a==db.topLeft||this.g2a==db.topRight?(Jb.top=na.bottom,Jb.bottom=na.bottom):(Jb.top=na.top,Jb.bottom=na.top)):this.YXb?(Jb.top=na.top,Jb.bottom=na.bottom):(Jb.left=na.left,Jb.right=na.right):2!==this.JF&&3!==this.JF||!this.W_()||(this.YXb?(Jb.left=na.left,Jb.right=na.right):(Jb.top=na.top,Jb.bottom=na.bottom));
return Jb.nD?Jb:null}jpk(){const na=this.z1(this.R0);if(!na)return!1;if(this.W_())return this.Xba(this.wBa,this.lua,na);const [Gb,Xa,Jb]=this.h2e(na);return this.Xba(Gb,Xa,Jb)}hpk(){if(!this.W_())return!1;const na=this.z1(this.TXb);return na?this.J5b(3,na):!1}ipk(){const na=this.z1(this.qoa);if(!na)return!1;if(this.W_())return this.Xba(this.wBa,na,this.Yua);const [Gb,Xa,Jb]=this.g2e(na);return this.Xba(Gb,Xa,Jb)}tpk(){const na=this.z1(this.Bya);if(!na)return!1;if(this.W_())return this.Xba(na,this.lua,
this.Yua);const [Gb,Xa,Jb]=this.i2e(na);return this.Xba(Gb,Xa,Jb)}u3k(){let na=!1;this.wBa&&this.Bya&&!this.wBa.equals(this.Bya)&&(na=!0);!na&&this.lua&&this.qoa&&!this.lua.equals(this.qoa)&&(na=!0);!na&&this.Yua&&this.R0&&!this.Yua.equals(this.R0)&&(na=!0);!na&&this.dnc&&this.TXb&&!this.dnc.equals(this.TXb)&&(na=!0);na&&this.Itk()}Qyc(na){if(!na)return null;const Gb={};Gb[ha.u8g]=[{[ha.x8g]:na.top},{[ha.v8g]:na.right},{[ha.r8g]:na.bottom},{[ha.t8g]:na.left}];return Gb}YKh(){const na={};let Gb=4,
Xa=null,Jb=null,qb=null;if(this.W_()){na[ha.w8g]=this.eYb;var Db=(gb,ya)=>{const Aa=this.Ijb(gb);na[ya]=this.Qyc(Aa);Gb=gb;Xa=this.getSheetName(gb);Jb=Aa.topLeft.clone();Jb.top--;Jb.left--;qb=Aa.bottomRight.clone();qb.bottom--;qb.right--};0===this.JF?Db(this.JF,ha.zAe):1===this.JF?Db(this.JF,ha.xAe):2===this.JF?Db(this.JF,ha.yAe):3===this.JF&&Db(this.JF,ha.s8g)}else{if(Db=this.Qyc(this.wBa))na[ha.zAe]=Db,Xa||(Xa=this.getSheetName(0));if(Db=this.Qyc(this.lua))na[ha.xAe]=Db,Xa||(Xa=this.getSheetName(1));
if(Db=this.Qyc(this.Yua))na[ha.yAe]=Db,Xa||(Xa=this.getSheetName(2))}return[JSON.stringify(na),Gb,Xa,Jb,qb]}xLh(na,Gb,Xa,Jb){if(this.W_()){var qb=this.eYb.split("_");if(1<qb.length&&(qb=qb[qb.length-1],oa.a.aL(qb,"Series")&&(qb=parseInt(qb.substring(6),10),!isNaN(qb)&&0<=qb)))return new bb(this.wLa,qb,na,{sheet:Gb,range:{topLeft:{row:Xa.top,column:Xa.left},bottomRight:{row:Jb.bottom,column:Jb.right}}})}return null}Itk(){const [na,Gb,Xa,Jb,qb]=this.YKh();if(na){var Db={region:this.JF,action:this.VU,
level:this.W_()?1:0},gb=this.lw.$.pa.ta.Jh(),ya=null;Da.EwaSettings.isChangeGateEnabled("OfficeVSO:7179826_ChartSeriesDataChangedMacroRecording")&&this.lw.$.Oxa&&(ya=()=>this.xLh(Gb,Xa,Jb,qb));this.lw.$.userOperationManager.enqueueOperation(new W.a(529,0,(Aa,sb,nc)=>{const Bb=this.lw.$.pa.ta.Za(9,gb);Bb.imageId=this.wLa;Bb.operationType=-99;Bb.propertyValue=na;return N.h(this.lw.$.pa.ta,"ApplyChartProperty",Bb,Ha.c(Aa,this.cPj),Ha.b(sb,this.bPj),nc,Db,0)},64,ya),null);this.vKc&&(clearTimeout(this.vKc),
this.vKc=null);this.ALa++;this.vKc=setTimeout(()=>{this.ALa=0},3E3)}}}ha.Q1d="move";ha.m8f="nwse-resize";ha.l8f="nesw-resize";ha.r8f="2px";ha.q8f="3px";ha.rAj="1px";ha.n8f="rgba(255, 255, 255, 1)";ha.ZXb={Vqe:"4px",N5d:"-3px",Uqe:"8px",M5d:"-5px"};ha.sAj={Vqe:"14px",N5d:"-8px",Uqe:"24px",M5d:"-13px"};ha.U7f=["rgba(188, 47, 52)","rgba(124, 83, 172)","rgba(0, 108, 190)","rgba(252, 88, 190)"];ha.DAj=["6","5","4","3"];ha.uAj=["10","9","8","7"];ha.CAj="7";ha.tAj="11";ha.w8g="se";ha.xAe="ca";ha.yAe="da";
ha.zAe="ti";ha.s8g="bl";ha.u8g="ra";ha.x8g="t";ha.v8g="r";ha.r8g="b";ha.t8g="l";Object(y.a)(ha,"ChartFoilsInteractiveBehavior",null,[]);class ua{static v1c(na){na&&(ua.cYb="string"===typeof na?oa.a.contains(na,"Touch",!0)?3:2:3===na?3:2)}static get oh(){return ua.cYb}constructor(na,Gb){this.yya=this.Aya=null;null==ua.cYb&&(ua.v1c(z.a.eh),null==ua.cYb&&(ua.cYb=2));this.K7f=na;this.c2d=Gb;this.reset()}update(na,Gb,Xa,Jb){if(Gb&&na&&Xa){if(this.wLa!==na||this.S7f!==Xa||this.F7f!==Jb)this.reset(),this.wLa!==
na&&this.Yzd(),this.p1j(Xa)?(this.wLa=na,this.r4k(Jb),this.S7f=Xa,this.F7f=Jb):(this.reset(),this.Yzd())}else this.reset(),this.Yzd()}reset(){this.F7f=this.S7f=this.xya=null;this.E1d=!1;this.VXb=-1;this.YXb=this.M7f=!1}Yzd(){this.wLa=null;this.Aya&&(this.Aya.dispose(),this.Aya=null);this.yya&&(this.yya.dispose(),this.yya=null)}r4k(na){if(this.xya){var Gb=null;if(!this.E1d&&na){var Xa=[];var Jb=[];var qb=[];var Db=[];for(const gb of this.xya.series)if(gb.id===na){Xa=gb.category;Jb=gb.data;qb=gb.title;
Db=gb.bubble;Gb=gb.id;break}}else this.xya.merge(),Xa=this.xya.PCh,Jb=this.xya.RCh,qb=this.xya.VCh;(na=this.M7f||null!=Gb)?(this.Aya&&(this.Aya.dispose(),this.Aya=null),null==this.yya&&(this.yya=new ha(this.K7f,this.wLa,this.c2d)),this.yya.update(this.VXb,Gb,this.YXb,qb,Xa,Jb,Db)):(this.yya&&(this.yya.dispose(),this.yya=null),null==this.Aya&&(this.Aya=new la(this.K7f)),this.Aya.update(qb,Xa,Jb));c.ULS.sendTraceTag(524150550,6,50,`ChartFoils update: type: ${na?1:0}`)}}p1j(na){if(!na||0>=na.length)return!1;
try{var Gb=JSON.parse(na);this.xya=new V;this.M7f=Gb[ua.D8g];var Xa=Gb[ua.C8g];this.YXb=Gb[ua.K8g];this.VXb=Gb[ua.A8g];if(Xa===ua.E8g){this.E1d=!0;var Jb=Gb[ua.CAe],qb=new Fa.Range(Jb[ua.FAe]+1,Jb[ua.BAe]+1,Jb[ua.AAe]+1,Jb[ua.DAe]+1,!0,!0),Db=Gb[ua.EAe],gb=[];gb.push(new fa.a(qb.clone(),Db));this.xya.I_e([],gb,[],[],"")}else if(Xa===ua.H8g){this.E1d=!1;gb=Gb[ua.G8g];const ya=Gb[ua.F8g];for(qb=0;qb<ya.length;qb++){Db=[];na=[];Gb=[];Xa=[];const Aa=ya[qb],sb=Aa[ua.J8g]||"";for(const nc in Aa){const Bb=
Aa[nc],uc=Bb[ua.CAe]||[],Pc=gb[Bb[ua.EAe]];for(Jb=0;Jb<uc.length;Jb++){const wd=uc[Jb],Md=new Fa.Range(wd[ua.FAe]+1,wd[ua.BAe]+1,wd[ua.AAe]+1,wd[ua.DAe]+1,!0,!0);switch(nc){case ua.B8g:na.push(new fa.a(Md.clone(),Pc));break;case ua.y8g:Xa.push(new fa.a(Md.clone(),Pc));break;case ua.z8g:Db.push(new fa.a(Md.clone(),Pc));break;case ua.I8g:Gb.push(new fa.a(Md.clone(),Pc))}}}this.xya.I_e(Db,na,Gb,Xa,sb)}}return!0}catch(ya){return c.ULS.sendTraceTag(524150549,6,10,`ChartFoils parsing: error: ${ya.message}`),
!1}}}ua.cYb=null;ua.C8g="dt";ua.E8g="pt";ua.H8g="st";ua.K8g="vt";ua.D8g="dn";ua.FAe="t";ua.DAe="r";ua.AAe="b";ua.BAe="l";ua.z8g="ca";ua.B8g="da";ua.I8g="ti";ua.y8g="bl";ua.F8g="se";ua.G8g="sh";ua.EAe="si";ua.CAe="ra";ua.J8g="uo";ua.A8g="ct";Object(y.a)(ua,"ChartFoils",null,[]);var fb=a(1078),Ka=a(906),La=a(58),ib=a(54),Yb=a(197),Wc=a(196),Qc=a(86),Wb=a(16),Jc=a(39),ma=a(136),Hc=a(111),Kb=a(442),pc=a(1217),$b=a(1219);wa=a(1025);class Ib extends wa.a{constructor(){super();this.onTextSelectionChanged=
this.onEditStatusChanged=null}}Object(y.a)(Ib,"ExcelChartHostConfig",wa.a,[]);class Zb extends C.a{constructor(na,Gb){super(na,510,null);this.seriesIndex=-1;this.seriesIndex=Gb}}Object(y.a)(Zb,"MacroRecorderChartSeriesDeletedPayload",C.a,[]);var Eb=a(97),ob=a(5),Na=a(648),nb;(function(na){na[na.Selection=0]="Selection";na[na.SnowballChart=1]="SnowballChart"})(nb||(nb={}));Object(y.b)("ChartTaskPaneMessageType",nb);class Hb extends x.a{constructor(na,Gb,Xa,Jb,qb,Db){super(na,Gb,u.lb,Xa,void 0===qb?
"":qb,void 0===Db?!0:Db);this.jv=this.SL=null;this.Gzf=this.n2f=this.m2f=this.M2f=this.S2f=this.Y2f=-1;this.BDa=this.lWd=this.RNf=!1;this.EZd=-1;this.L$f=this.HC=null;this.BKc=new Jc.a(!1);this.$N=this.eoa=this.GTc=null;this.wJa=this.iNd=!1;this.Rt=null;this.fNd=this.hNd=this.IFc=!1;this.oyd=null;this.GBj="ManualPlacement";this.gNd=!1;this.xHc=this.Kwa=this.inputType=null;this.rNf=!1;this.onEditStatusChanged=()=>{Hc.a(this.$).Geg()};this.onTextSelectionChanged=()=>{Hc.a(this.$).Geg()};this.m7d=gb=>
{gb&&!ra.a.Jk(gb.Errors)&&(gb=gb.Result)&&this.floatingObject.Ki&&(this.floatingObject.Ki.ChartTitle=gb.PreviousTitle?gb.PreviousTitle:"")};this.l7d=()=>{c.ULS.sendTraceTag(537162434,6,10,`ChartFloatingObjectControl.OnGetChartTitleWebMethodFailed: The attempt to get chart title data has failed or been aborted. ID: ${this.floatingObject.fi}`)};if(0!==Gb.type)throw c.ULS.sendTraceTag(537162457,5,10,"ChartFloatingObjectControl.ChartFloatingObjectControl: Not a FloatingObjectType.Chart."),Error.invalidOperation("Creating ChartFloatingObjectControl for non FloatingObjectType.Chart");
this.Rvd=this.$.qh.Vl("DOMUpdate","ChartConvertToSvgStopwatch");this.owe=this.$.qh.Vl("Task","ChartUnsupportedFontsStopwatch");this.Aga()&&(this.$N=new Ba(this,this.ha));this.oyd=new ua(this.$,Jb)}get GVb(){return this.BDa}dispose(){this.Ikb()?(this.wJa=this.Aga()&&!!this.$N&&this.$N.Upe,this.$N&&this.$N.Aoe()&&(this.$N.ysc(),this.$N.dwe())):c.ULS.sendTraceTag(571758413,5,50,`ChartFloatingObjectControl.Dispose. ID:${this.floatingObject.fi}, GotSelected: ${this.iNd}, GotInteracted: ${this.wJa}`);ma.a.Y5f(this.floatingObject.fi,
!0,!this.Ikb(),this.iNd,this.wJa);this.Neb();super.dispose()}y0a(){return!0}isElementMovementInProgress(){return this.SL.isElementMovementInProgress()}restoreElementPosition(){return this.SL.restoreElementPosition()}dN(na,Gb){Gb=void 0===Gb?!1:Gb;Hb.Wff(this.floatingObject,na);super.dN(na,Gb);this.a2g()}Sqa(){c.ULS.sendTraceTag(537162456,5,50,`ChartFloatingObjectControl.UpdateFloatingObject Updating ID: ${this.floatingObject.fi}.`);this.XAg();this.oQg&&this.tgf();this.WHe=!this.floatingObject.Ona&&
this.Gfj();this.AHa&&c.ULS.sendTraceTag(537162455,5,50,`ChartFloatingObjectControl.UpdateFloatingObjectContent: Empty scene graph. Id: ${this.floatingObject.fi}, ChartMetaData: ${this.floatingObject.Ki?"valid":"null"}`);if(this.Kr||this.AHa)this.Kr=!1,this.floatingObject.Itb(),this.clientVersion=this.floatingObject.version,c.ULS.sendTraceTag(537162454,5,50,`ChartFloatingObjectControl.UpdateFloatingObject: Workbook cache Placeholder detected. Returning. ID: ${this.floatingObject.fi}, Type: ${this.floatingObject.type}`);
this.Gj&&(this.x6a(this.floatingObject.kL),Da.EwaSettings.isChangeGateEnabled("OfficeVSO:4398210_MoveAndResizeCompleteSvgChartFlickerfix")&&!this.floatingObject.Ona||Wb.DOMElementExtensions.Oub(this.Gj,new Sys.UI.Bounds(0,0,this.floatingObject.width,this.floatingObject.height),!1));this.hXd()&&this.BDa&&this.xHc&&(this.rNf?this.isChartDataUnhealthy()||(this.xHc=!1,this.kcg(nb.SnowballChart)):(this.ctj(),this.rNf=!0));this.D9j()}D9j(){if(this.iua()&&!this.lWd){this.lWd=!0;var na=this.$.qh.Vl("Task",
"ChartRenderDelayStopwatch");na.start();Q.TaskExtensions.Ua(Hc.a(this.$).cvj(),()=>{this.lWd=!1;na.stop();this.iua()&&(this.M2f=na.ii,this.render())},this.$.ka.xa,8)}}eRf(){Hc.a(this.$).H3i()?(chartPlayer.ChartPlayerFactoryGlobal.enableFeatures(this.WEi()),this.SL=chartPlayer.ChartPlayerFactoryGlobal.getChartPlayerWrapper(this.Gj,this),this.jv||(this.jv=chartPlayer.ChartPlayerFactoryGlobal.getUOMirrorWrapper())):c.ULS.sendTraceTag(537162453,6,10,"ChartFloatingObjectControl.InitChartPlayerWrapper: The attempt to create a ChartPlayerWrapper failed")}resetVisualTrackerForChart(){const na=
this.$.pa.ta,Gb=this.floatingObject.fi;c.ULS.sendTraceTag(537162435,5,50,`ChartFloatingObjectControl.resetVisualTrackerForChart. ID:${Gb}`);J.a(this.$.userOperationManager,(Xa,Jb,qb)=>fb.c(na,Gb,Xa,Jb,qb,null),Xa=>new W.a(605,0,Xa,void 0),null)}w3j(){this.eRf();let na=!1;if(this.SL){this.Jij()&&(this.owe.start(),this.bii(),this.owe.stop(),this.m2f=this.owe.ii);this.Rvd.start();let Gb=null;this.Aga()&&this.floatingObject.Ki.ChartPlayerData.InteractivityJSON&&(Gb='{ "data" : '+this.floatingObject.Ki.ChartPlayerData.InteractivityJSON+
" }");na=this.SL.renderChart('{ "data" : '+this.floatingObject.Ki.ChartPlayerData.SceneGraphJSON+" }",Gb);this.jv&&(this.HC=this.floatingObject.Ki.VisualID,this.L$f=this.floatingObject.Ki.ChartPlayerData.VisualTrackerJSON,2===this.jv.updateModel(this.L$f)&&this.resetVisualTrackerForChart());Gb&&(this.SL.setInteractivityEnabled(!0),this.SL.select(this.BDa?this.ha.$e.Gq:null,null));this.Rvd.stop();this.Y2f=this.Rvd.ii;this.S2f=this.floatingObject.Ki.ChartPlayerData.SceneGraphJSON.length}na?(this.EZd=
this.floatingObject.version,this.z6(null)):(this.a2h(),this.Loa(null))}iua(){return this.sj?!1:!this.Kr&&!this.AHa&&!this.floatingObject.Ona&&(!!this.Xp||!this.Y7b())}render(){this.Bgk();this.SCa=this.v6h();if(this.Ikb()&&this.floatingObject.Ki.ChartPlayerData.SceneGraphJSON)c.ULS.shipAssertTag(537162452,6,!1,`ChartFloatingObjectControl.Render: ChartPlayerData cannot contain both ImageData and ScenegraphJson at the same time. ID: ${this.floatingObject.fi}`);else if(this.Ikb()){this.eRf();let na=!1;
this.SL&&(na=this.SL.renderImage(this.floatingObject.Ki.ChartPlayerData.ImageData),Wb.DOMElementExtensions.Oub(this.Gj,new Sys.UI.Bounds(0,0,this.floatingObject.width,this.floatingObject.height),!1));na?(this.EZd=this.floatingObject.version,this.z6(null)):this.Loa(null);this.Aga()&&this.vBc()&&this.$N.xqe()}else this.w3j(),this.x6a(this.floatingObject.kL),this.s$a=this.floatingObject.jz,this.jz&&-1!==this.jz.EffectsHeight?(this.Gj.style.overflow="visible",Wb.DOMElementExtensions.Oub(this.Gj,new Sys.UI.Bounds(-this.jz.XEffectsDelta,
-this.jz.YEffectsDelta,this.jz.EffectsWidth,this.jz.EffectsHeight),!1)):Wb.DOMElementExtensions.Oub(this.Gj,new Sys.UI.Bounds(0,0,this.floatingObject.width,this.floatingObject.height),!1),this.h5j()}v6h(){let na;na=document.createElement("div");na.className=this.PT;na.style.borderColor=this.borderColor;Da.EwaSettings.isChangeGateEnabled("OfficeVSO:8484463_FixChartPlayerRTLBug")?na.style.direction="ltr":Da.EwaSettings.isChangeGateEnabled("OfficeVSO:4017297_ForceChartPlayerLtr")&&(na.dir="ltr");this.domElement.appendChild(na);
na.style.visibility="hidden";return na}Bgk(){this.Gj&&(Wb.DOMElementExtensions.isVisible(this.Gj)?(this.RM=this.Gj,this.rqb=this.b1,this.b1=null):this.xUc(),this.Rt=null)}h5j(){var na;ma.a.Jhk(this.Gj);var Gb=this.Gj.firstChild;Gb.style.width="100%";Gb.style.height="100%";Gb.setAttribute("draggable","false");Na.b()&&this.tooltip&&(Gb=null===(na=this.tooltip)||void 0===na?void 0:na.HO(this.fm.paneType))&&this.Gj.appendChild(Gb);na=oa.a.qz(this.floatingObject.altTextDescription)?Y.a.instance.ia(1455):
String.format(Y.a.instance.$g(182),this.floatingObject.altTextDescription);this.Gj.title=na;this.qdk()}a2h(){var na=this.Gj.firstChild;na&&Wb.DOMElementExtensions.Km(na);na=document.createElement("img");let Gb,Xa;oa.a.qz(this.floatingObject.altTextDescription)?(Gb=Y.a.instance.ia(1455),Xa=Y.a.instance.ia(1456)):(Gb=String.format(Y.a.instance.$g(182),this.floatingObject.altTextDescription),Xa=String.format(Y.a.instance.$g(183),this.floatingObject.altTextDescription));na.title=Gb;na.alt=Xa;na.className=
Hb.QRh;na.style.width="100%";na.style.height="100%";na.style.border="0px";na.style.display="block";this.Gj.appendChild(na);c.ULS.sendTraceTag(537162451,6,10,`ChartFloatingObjectControl.CreateErrorMessage: The attempt to render the chart failed. Version: ${this.floatingObject.version}, ID: ${this.floatingObject.fi}`)}nYd(){return!0}mFc(na,Gb){return!Gb.Ona&&Gb.version>this.EZd?!0:super.mFc(na,Gb)}rHd(){let na=super.rHd();na||(na={});na.SvgConversionDuration=this.Y2f;na.SceneGraphSize=this.S2f;na.LastRenderDelay=
this.M2f;na.LastFontDetectTime=this.m2f;na.LastGC2LoadDelay=this.n2f;na.GC2ModelLoadTime=this.Gzf;const Gb=!!this.Gj;na.HasElement=Gb;!this.RNf&&Gb&&(na.ElementCount=this.Gj.getElementsByTagName("*").length,this.RNf=!0);this.floatingObject&&this.floatingObject.Ki&&this.floatingObject.Ki.ChartPlayerData&&(na.HasImageData=this.Ikb());return na}kcg(na){const Gb=ob.vb.Ha()?Eb.a.Zg(ob.vb):v.a(this.$);if(Gb){var Xa={};if(na===nb.Selection){if(na=this.ha.$e,Hb.B2f!==na.activeFloatingObjectControlId||Hb.C2f!==
na.Gq)Xa.EventId="select",Xa.SubSelection=na.Gq,Xa.selectionStartTimeMs=Date.now(),c.ULS.sendTraceTag(537162450,6,50,`ChartFloatingObjectControl.NotifyTaskPane: Sending messsage to ChartTaskPane FloatingObjectID: ${this.floatingObject.fi}, SubSelection:${Xa.SubSelection}`),Gb.e5d(Xa),Hb.B2f=na.activeFloatingObjectControlId,Hb.C2f=na.Gq,this.wJa=!0}else this.hXd()&&na===nb.SnowballChart&&(Xa.EventId="snowballChart",Xa.isSnowballChartFixed=!this.xHc,Gb.e5d(Xa),c.ULS.sendTraceTag(507389259,6,50,`ChartFloatingObjectControl.NotifyTaskPane: Sending messsage to ChartTaskPane FloatingObjectID: ${this.floatingObject.fi}, isSnowballChartFixed:${Xa.isSnowballChartFixed}`))}}ctj(){const na=
ob.vb.Ha()?Eb.a.Zg(ob.vb):v.a(this.$);if(!na||!na.sUf()){var Gb=new Qc.a(1930653487,0,2,30,null);this.$.Ma.dh(Gb)}na.rUf()||na.MLg();Gb={EventId:"snowballChart",isSnowballChartDetected:!0};c.ULS.sendTraceTag(507389258,6,50,`ChartFloatingObjectControl.launchChartDataPaneOnSnowBallChartDetection: Sending messsage to ChartTaskPane FloatingObjectID: ${this.floatingObject.fi}, isSnowballChartDetected:${Gb.isSnowballChartDetected}}`);na.e5d(Gb)}S2i(na,Gb,Xa,Jb){Jb=new Qc.a(37023044,Jb,this.$.Rh,0,null);
Jb.$Tb=!0;this.$.Ma.dh(Jb,{["rawEvent"]:null,["pivotName"]:null,["cell"]:na,["requiresConfirmation"]:64==(this.floatingObject.Ki.Attributes&64),["dataSourceIndex"]:this.floatingObject.Ki.ExternalSourceIndex,["domElement"]:this.Gj,["objectId"]:Gb.ChartId,["objectVersion"]:this.floatingObject.version,["location"]:Xa,["optionalPivotMenuAnchorParameter"]:Gb});c.ULS.sendTraceTag(509366740,5,50,`ChartFloatingObjectControl.HandleShowPivotContextMenu. ID:${this.floatingObject.fi}`)}MMf(na,Gb){if(!oa.a.contains(na,
"ValueFieldButton",!0)&&this.jv){var Xa=this.jv.getIntProp(this.HC,na+"_PivotHierarchy"),Jb=this.jv.getStringProp(this.HC,na+"_Caption");if(null===Xa||void 0===Xa||null===Jb||void 0===Jb)c.ULS.sendTraceTag(528815107,5,10,`ChartFloatingObjectControl.HandlePivotButtonCommand: Unable to get button props. ID:${this.floatingObject.fi}, button ID: ${na}`);else{var qb={};qb.ChartId=this.ha.$e.activeFloatingObjectControlId;qb.AnchorValue1=Xa;qb.AnchorValue2=-1;if(oa.a.contains(na,"ReportFilterFieldButton",
!0))qb.AnchorType=4,na=0!=(this.floatingObject.Ki.Attributes&128),ba.f(this.$).showPivotFilter(this.$.domElement,{},this.floatingObject.Ki.ExternalSourceIndex,Jb,na,!0,null,qb);else{if(oa.a.contains(na,"AxisFieldButton",!0))qb.AnchorType=5;else if(oa.a.contains(na,"LegendFieldButton",!0))qb.AnchorType=6;else{c.ULS.sendTraceTag(528815106,5,10,`ChartFloatingObjectControl.HandlePivotButtonCommand: Unexpected Button ID. ID:${this.floatingObject.fi}, button ID: ${na}`);return}Jb=JSON.parse(this.SL.getSelectionBounds());
if(null!=Jb)var Db=new Sys.UI.Point(Jb.x+(this.$.isChromeRtl?Jb.width:0),Jb.y+Jb.height);else c.ULS.sendTraceTag(528815105,5,10,`ChartFloatingObjectControl.HandlePivotButtonCommand: Error getting button location. ID:${this.floatingObject.fi}, button ID: ${na}`),na=Sys.UI.DomElement.getBounds(this.Gj),Db=new Sys.UI.Point(na.x,na.y);var gb={};this.$.Mq(gb);var ya=sb=>{sb&&this.S2i(gb,qb,Db,Gb?3:2)},Aa=64==(this.floatingObject.Ki.Attributes&64);void Eb.a.resolve(ob.qb,{va:1}).then(sb=>{sb.UL(Aa,ya)})}}}}onSelectionChange(na,
Gb){ua.v1c(Gb);if(this.Aga()){this.inputType=Gb;var Xa=this.ha.$e.Gq?this.ha.$e.Gq:"Null",Jb=na||"Null";"Null"!=Xa&&Xa!=Jb&&(c.ULS.sendTraceTag(528773846,5,50,`ChartFloatingObjectControl.OnSelectionChange. ID:${this.floatingObject.fi}, FreezePanes:${ba.f(this.$).Pg.Uo}, elementId:${Xa}, gotRibbonEdited:${this.hNd}, gotFloatieEdited:${this.fNd}`),this.fNd=this.hNd=!1);if(this.BDa||na){if(!this.BDa){var qb=Hc.a(this.$),Db=this.floatingObject.an();qb&&Db&&((qb=qb.ky(Db))?this.ha.$e.J1(qb):c.ULS.sendTraceTag(509751577,
5,50,"ChartFloatingObjectControl.OnSelectionChange : Selected Floating Object Control is null, cannot select new chart"))}qb=Gb||"None";Db=!1;null!==this.floatingObject.Ki&&(Db=0!==(this.floatingObject.Ki.Attributes&4));var gb=!1,ya=Da.EwaSettings.isChangeGateEnabled("OfficeVSO:6412352_isUOPropPathValid");ya&&this.jv&&(gb=this.jv.isUOPropPathValid(this.HC,Xa,this.GBj));c.ULS.sendTraceTag(588330568,5,50,`ChartFloatingObjectControl.OnSelectionChange. ID:${this.floatingObject.fi}, FreezePanes:${ba.f(this.$).Pg.Uo}, CurrentSubSelection:${Xa}, NextSubSelection:${Jb}, SelectionType:${qb}, ManuallyPlaceable:${ya?
gb:"None"}, gotManualPlaced:${this.gNd}, IsPivot:${Db}`);this.gNd=!1;this.ha.$e.Gq=na;this.kcg(nb.Selection);Xa=null!=na;this.Pmj()&&(Xa=null!=na&&null!=Gb);Xa&&oa.a.contains(na,"FieldButton",!0)&&(this.KTd()&&oa.a.contains(Gb,"Keyboard",!0)||this.MMf(na,oa.a.contains(qb,"Touch",!0)));(Gb=Hc.a(this.$))?Gb.VOj():c.ULS.sendTraceTag(509751576,5,50,"ChartFloatingObjectControl.OnSelectionChange : FloatingObjectManager is null, cannot refresh Ribbon UI");this.extension&&(Gb=this.extension,Gb.dC&&(Gb.dC.Htc=
null==na));this.inputType&&(this.inputType=null);oa.a.contains(qb,"Touch",!0)?this.Bzd(!0):oa.a.contains(qb,"Mouse",!0)&&this.Bzd(!1)}}}a2g(){this.oyd&&this.oyd.update(this.floatingObject.id,this.BDa,this.floatingObject.Ki.ChartDataRanges,this.ha.$e.Gq)}GWi(na){let Gb=0;if((()=>{let Xa=this.XBf(na,Gb);({aO:Gb}=Xa);return Xa})().returnValue)switch(Gb){case 2:return 419803868;case 9:return-2011789595;case 10:return-1513952223}return 1461300262}cNf(na,Gb){var Xa=!1;const Jb=this.GWi(na);1461300262!==
Jb&&(Xa=new Qc.a(Jb,Gb,2,30,null),this.$.Ma.dh(Xa),Xa=!0);c.ULS.sendTraceTag(537162449,5,50,`ChartFloatingObjectControl.HandleTitleEditRibbonCommand. ID:${this.floatingObject.fi}, CurrentSubSelection:${na||"Null"}, EntryPoint:${Enum.toString(f.a,Gb)}, EditTitleCommandHandled:${Xa}`);this.wJa=!0;return Xa}onDoubleClick(na){if(this.Aga()&&Da.EwaSettings.Ra(155)){var Gb;(Gb=ob.vb.Ha()?Eb.a.Zg(ob.vb):v.a(this.$))&&Gb.sUf()?this.cNf(na,2)?Gb="OpenTitleDialog":Gb.rUf()?Gb="NoOp":(Gb.MLg(),Gb="FocusOnTaskpane"):
(Gb=new Qc.a(1221897806,0,2,30,null),this.$.Ma.dh(Gb),Gb="OpenTaskPane");c.ULS.sendTraceTag(578069908,5,50,`ChartFloatingObjectControl.OnDoubleClick. ID:${this.floatingObject.fi}, CurrentSubSelection:${na||"Null"}, ActionTaken:${Gb}`);this.wJa=!0}}onManualPlacement(na,Gb,Xa,Jb){if(Gb||Xa){this.BKc.Vg(this.floatingObject.fi)?c.ULS.sendTraceTag(528295050,5,15,`ChartFloatingObjectControl.OnManualPlacement : making another request before processing the older one, InputType:${Jb}, Element:${na}`):this.BKc.add(this.floatingObject.fi,
!0);var qb=null,Db=this.jv.getDoubleProp(this.HC,na+"_Left")+Gb,gb=this.jv.getDoubleProp(this.HC,na+"_Top")+Xa;qb=this.gvf(na+"_ManualPlacement",'"'+Gb+";"+Xa+'"',Hb.sCk,()=>new D.a(this.floatingObject.fi,na+"_ManualPlacement",Db+";"+gb));qb.continueWith(()=>{let ya=!1;Yb.b(qb)&&(ya=this.gNd=!0);c.ULS.sendTraceTag(537162448,5,50,`ChartFloatingObjectControl.OnManualPlacement. ID:${this.floatingObject.fi}, DraggedElement: ${na}, isSuccessful: ${ya}
        )}, inputType: ${Jb}`)})}}ZEk(){if(null==this.Rt){const na=new Ib;na.id=this.floatingObject.id;na.parent=this.Gj;na.actionHandler=pc.a.Ghb(this.$);na.logger=new $b.a;na.onEditStatusChanged=this.onEditStatusChanged;na.onTextSelectionChanged=this.onTextSelectionChanged;this.Rt=GC2Host.excelChartHostFactoryGlobal.createHost(na)}}onEmbeddedContentLoad(na){if(this.lXf()&&na){var Gb=this.$.qh.Vl("Task","ChartGC2LoadStopwatch"),Xa=this.$.qh.Vl("Task","ChartGC2TextModelStopwatch");Gb.start();Xa.start();
Q.TaskExtensions.Ua(Kb.a.tya(this.floatingObject.type),Jb=>{Gb.stop();this.iua()&&null!=this.Gj&&(null!=this.Rt&&(this.Rt=null),this.n2f=Gb.ii,this.ZEk(),this.Rt.updateModel(na));Xa.stop();this.Gzf=Xa.ii;c.ULS.sendTraceTag(527976224,5,50,`ChartFloatingObjectControl.OnEmbeddedContentLoad. ID:${this.floatingObject.fi}, IsSuccessful: ${Yb.b(Jb)}`)},this.$.ka.xa,8)}else c.ULS.sendTraceTag(527976225,0,50,"ChartFloatingObjectControl.onEmbeddedContentLoad: Embedded content is null or empty.")}select(na,
Gb){super.select(na,Gb);if(this.Aga()){!this.BDa&&na&&(this.iNd=!0);(this.BDa=na)||this.Bzd(!1);var Xa=Da.EwaSettings.isChangeGateEnabled("OfficeVSO:5891773_SelectionInputType")?this.inputType:null;Hb.gub(this.SL,Jb=>{Jb.select(na?this.ha.$e.Gq:null,Xa)});this.inputType=null;this.$N.Aoe()&&this.$N.select(na);this.a2g();this.hXd()&&na&&this.isChartDataUnhealthy()&&(this.xHc=!0)}}lZc(na){if(this.vBc()&&this.$N.DSk(this.ha.$e.RL))c.ULS.sendTraceTag(537162447,5,50,`ChartFloatingObjectControl.SubSelectNextSibling. ID:${this.floatingObject.fi}, FreezePanes:${ba.f(this.$).Pg.Uo}, chart banner CurrentSubSelection is ${this.ha.$e.RL}.`);
else{var Gb=this.ha.$e.Gq?this.ha.$e.Gq:"Chart";c.ULS.sendTraceTag(588330567,5,50,`ChartFloatingObjectControl.SubSelectNextSibling. ID:${this.floatingObject.fi}, FreezePanes:${ba.f(this.$).Pg.Uo}, CurrentSubSelection:${Gb}`);Hb.gub(this.SL,Xa=>{Xa.navigateNextSibling(na)})}}kZc(na,Gb){this.cNf(Gb,1)||(this.jZc(na),this.KTd()&&Gb&&na&&oa.a.contains(Gb,"FieldButton",!0)&&this.MMf(Gb,!1));c.ULS.sendTraceTag(573137555,5,50,`ChartFloatingObjectControl.SubSelectFirstChildOrCommitEdit. ID:${this.floatingObject.fi}, FreezePanes:${ba.f(this.$).Pg.Uo}, CurrentSubSelection:${Gb||
"Chart"}`)}jZc(na){na&&this.$N.eQg()?(this.$N.CSk(this.ha.$e.RL),c.ULS.sendTraceTag(537162446,5,50,`ChartFloatingObjectControl.SubSelectFirstChild. ID:${this.floatingObject.fi}, FreezePanes:${ba.f(this.$).Pg.Uo}, chart banner CurrentSubSelection is ${this.ha.$e.RL}.`)):(na=this.ha.$e.Gq?this.ha.$e.Gq:"Chart",c.ULS.sendTraceTag(537162445,5,50,`ChartFloatingObjectControl.SubSelectFirstChild. ID:${this.floatingObject.fi}, FreezePanes:${ba.f(this.$).Pg.Uo}, CurrentSubSelection:${na}`),Hb.gub(this.SL,
Gb=>{Gb.selectFirstChild()}))}mZc(){if(this.vBc()){var na=this.$N.ESk(this.ha.$e.RL);c.ULS.sendTraceTag(537162444,5,50,`ChartFloatingObjectControl.SubSelectParent. ID:${this.floatingObject.fi}: chart banner CurrentSubSelection is ${this.ha.$e.RL}.`);na||Hb.gub(this.SL,Gb=>{Gb.selectParent()})}else na=this.ha.$e.Gq?this.ha.$e.Gq:"Chart",c.ULS.sendTraceTag(588330565,5,50,`ChartFloatingObjectControl.SubSelectParent. ID:${this.floatingObject.fi}, FreezePanes:${ba.f(this.$).Pg.Uo}, CurrentSubSelection:${na}`),
Hb.gub(this.SL,Gb=>{Gb.selectParent()})}moveElementByKey(na){const Gb=this.ha.$e.Gq?this.ha.$e.Gq:"Chart";let Xa="";switch(na){case -798660877:Xa="ArrowDown";break;case -1470715894:Xa=this.da.rtl?"ArrowRight":"ArrowLeft";break;case -1231471547:Xa=this.da.rtl?"ArrowLeft":"ArrowRight";break;case 137938150:Xa="ArrowUp";break;default:c.ULS.sendTraceTag(537162443,5,50,`ChartFloatingObjectControl.MoveElementByKey: invalid command ${na} passed in.`)}Hb.gub(this.SL,Jb=>{Jb.moveElementByKey(Xa)});c.ULS.sendTraceTag(537162442,
5,50,`ChartFloatingObjectControl.MoveElementByKey. ID:${this.floatingObject.fi}, FreezePanes:${ba.f(this.$).Pg.Uo}, CurrentSubSelection:${Gb}, MoveDirection:${Xa}, isRTL:${this.da.rtl}`)}dh(na,Gb){if(this.jv){var Xa=na.command,Jb=this.kXi(na.lk),qb=null,Db=this.ha.$e.Gq?this.ha.$e.Gq:"Null";if((()=>{let ya=this.w1j(Xa,Gb,qb);({Iud:qb}=ya);return ya})().returnValue)if(na=this.jv.handleUORibbonCommand(this.HC,this.ha.$e.Gq,this.aKf(Xa),qb)){var gb=this.gvf(na.propPath,na.propVal,na.propCommand);gb.continueWith(ya=>
{c.ULS.sendTraceTag(544089631,5,50,`ChartFloatingObjectControl.HandleRibbonCommand. ID:${this.floatingObject.fi}, RibbonCommand: ${Enum.toString(n.a,Xa)}, isSuccessful: ${Yb.b(ya)}, CurrentSubSelection: ${Db}, UILocation: ${Jb}`);Yb.b(gb)&&(Jb===Hb.YFg&&(this.hNd=!0),Jb===Hb.Ixf&&(this.fNd=!0))});this.wJa=!0}else c.ULS.sendTraceTag(544089632,5,10,`ChartFloatingObjectControl.HandleRibbonCommand: Error while executing uoMirrorWrapper.HandleUORibbonCommand. ID:${this.floatingObject.fi}, RibbonCommand: ${Enum.toString(n.a,
Xa)}, CommandVal: ${qb} , UILocation: ${Jb}`);else c.ULS.sendTraceTag(544089633,5,10,`ChartFloatingObjectControl.HandleRibbonCommand: Error while executing ParseRibbonCmdPropertiesDictionary. ID:${this.floatingObject.fi}, RibbonCommand: ${Enum.toString(n.a,Xa)}, CommandVal: ${qb}, UILocation: ${Jb}`)}}oBc(na,Gb){if(this.jv){var Xa=this.mXi(na);if(20===Xa)c.ULS.sendTraceTag(537162441,5,50,`ChartFloatingObjectControl.HandleRibbonQueryCommand: Invalid UORibbonCmd. ID:${this.floatingObject.fi}, RibbonCommand: ${Enum.toString(l,
na)}`);else switch(na){case "QueryBold":case "QueryItalics":case "QueryUnderline":if(!this.ha.$e.Gq){Gb[r.a.On]=!1;break}na=this.jv.getUORibbonCommandVal(this.HC,this.ha.$e.Gq,Xa);if(!na||!na.isValid)break;Gb[r.a.On]=Boolean.parse(na.returnVal);break;case "QueryFontName":case "QueryFontPickerFont":case "QueryFontSize":if(this.ha.$e.Gq){if((Xa=this.jv.getUORibbonCommandVal(this.HC,this.ha.$e.Gq,Xa))&&Xa.isValid)if(this.nl()&&"QueryFontPickerFont"===na){na=Xa.returnVal;let Jb=Xa=!1;const qb=this.jv.getUORibbonCommandVal(this.HC,
this.ha.$e.Gq,1),Db=this.jv.getUORibbonCommandVal(this.HC,this.ha.$e.Gq,2);qb&&qb.isValid&&(Xa=Boolean.parse(qb.returnVal));Db&&Db.isValid&&(Jb=Boolean.parse(Db.returnVal));na=P.HelperMethods.NLd(na,Xa,Jb,0,!1);Gb[b.a.SelectedFont]=na}else Gb[d.a.Value]=Xa.returnVal}else Gb[d.a.Value]=!1}}}OAa(na){switch(na){case -219946702:return this.ha.$e.Gq?!1:!0;case -287251124:case -1925065947:case 1764140053:case -1077965542:case -1293291468:case 1970784898:case 862825906:case -803000997:case -1832800737:case -1744769642:case 87208751:case 409031041:case -822056969:case 1532790410:case 1597684571:case 1849330294:case -873142594:case 1855740761:case 2117491830:case 2107851680:case -1986737526:case 119706583:case -1741941813:case 1188510340:case -1828502776:case -984702347:return this.ha.$e.Gq&&
this.jv?!this.jv.isUORibbonCommandSupported(this.HC,this.ha.$e.Gq,this.aKf(na)):!0;default:return!0}}gvf(na,Gb,Xa,Jb){Xa=this.eVa(na,Gb,Xa);const qb=new t.a;c.ULS.sendTraceTag(537162438,5,50,`ChartFloatingObjectControl.ExecuteSetPropertyOfficeJSApi: Executing OfficeJS API. ID:${this.floatingObject.fi}, PropPath: ${na}, PropVal: ${Gb}`);return this.rfa(null!==Jb&&void 0!==Jb?Jb:()=>new D.a(this.floatingObject.fi,na,Gb),Db=>{(Db=Db.Result)&&200===Db.ResponseStatusCode?qb.setResult(!0):(c.ULS.sendTraceTag(537162440,
5,10,`ChartFloatingObjectControl.ExecuteSetPropertyOfficeJSApi: Unexpected Status Code from the response of Executing OfficeJS API. ID:${this.floatingObject.fi}, PropPath: ${na}, PropVal: ${Gb}`),qb.setResult(!1));na.endsWith("_ManualPlacement")&&this.BKc.remove(this.floatingObject.fi)},()=>{c.ULS.sendTraceTag(537162439,5,10,`ChartFloatingObjectControl.ExecuteSetPropertyOfficeJSApi: Error while Executing OfficeJS API. ID:${this.floatingObject.fi}, PropPath: ${na}, PropVal: ${Gb}`);qb.setResult(!1);
na.endsWith("_ManualPlacement")&&this.BKc.remove(this.floatingObject.fi)},Xa,qb)}kXi(na){switch(na){case 9:return Hb.Ixf;case 2:case 14:case 15:case 16:return Hb.YFg;case 19:return Hb.PYh;default:return c.ULS.sendTraceTag(507510794,5,50,`ChartFloatingObjectControl.getUILocationString. Unsupported UI Location. ID:${this.floatingObject.fi}, ElementId:${this.ha.$e.Gq?this.ha.$e.Gq:"Null"}, LocationEnum:${na}`),"Invalid"}}rfa(na,Gb,Xa,Jb,qb){const Db=this.$.userOperationManager,gb=this.$.pa;let ya=null,
Aa=null,sb=null;const nc=()=>{if(Db.dWa())return!1;ya&&Db.Hv(ya);Aa&&gb.MK(Aa);sb&&gb.VY(sb);Db.vO(new W.a(507,0,(Bb,uc,Pc)=>N.h(gb.ta,"ExecuteRichApiRequest",Jb,Ha.c(Bb,Gb),Ha.b(uc,Xa),Pc,null,0),64,na));return!0};nc()||(ya=()=>{nc()},Aa=()=>{nc()},sb=()=>{nc()},Db.px(ya),gb.iI(Aa),gb.WW(sb));return qb.task}eVa(na,Gb,Xa){const Jb={HttpMethod:"POST",PathAndQuery:"ProcessQuery",RequestHeaders:null};Jb.RequestBody='{"AutoKeepReference":false,"Actions":[{"Id":390,"ActionType":3,"Name":"'+Xa+'","ObjectPathId":15,"ArgumentInfo":{"Arguments":["'+
na+'",'+Gb+']}}],"ObjectPaths":{"1":{"Id":1,"ObjectPathType":1,"Name":""},"6":{"Id":6,"ObjectPathType":4,"Name":"Worksheets","ParentObjectPathId":1,"T":"WorksheetCollection"},"8":{"Id":8,"ObjectPathType":5,"Name":"","ParentObjectPathId":6,"ArgumentInfo":{"Arguments":["'+B.d(this.$.sa.na)+'"]},"T":"Worksheet"},"10":{"Id":10,"ObjectPathType":4,"Name":"Visuals","ParentObjectPathId":8,"T":"VisualCollection"},"15":{"Id":15,"ObjectPathType":5,"Name":"","ParentObjectPathId":10,"ArgumentInfo":{"Arguments":["'+
this.HC+'"]},"T":"Visual"}}}';Jb.RequestFlags=17;na=this.$.pa.ta.Za(1);na.request=Jb;return na}w1j(na,Gb,Xa){switch(na){case -287251124:case -1925065947:case 1764140053:Xa=Gb.On?"true":"false";break;case -1077965542:case -1293291468:Xa=z.a.Wk;if(Xa in Gb){Xa=Gb[Xa];break}return{returnValue:!1,Iud:-1077965542===na?"No font size command value provided":"No font name command value provided"};case 409031041:case 1597684571:case 1650812936:case -1832800737:case 1970784898:Xa=Wc.a.c2(Wc.a.FO(Gb.Color,Jc.a.Em(Gb,
"IntColor")));break;case -803000997:Da.EwaSettings.isChangeGateEnabled("OfficeVSO:8392615_EnableChartMoreColorPicker")&&(Xa=Gb.Color);break;case 1849330294:case -873142594:case 1855740761:case 2117491830:case -1986737526:case 119706583:case -1741941813:Xa=null;!1;break;case 2107851680:Xa="true";!1;break;case 87208751:case -1744769642:Da.EwaSettings.isChangeGateEnabled("OfficeVSO:8412512_EnableChartClearOutlineFillColor")&&(Xa=Gb.clearFillOutlineCmdVal);break;default:return{returnValue:!1,Iud:Xa}}return{returnValue:!0,
Iud:Xa}}aKf(na){switch(na){case -287251124:return 1;case -1925065947:return 2;case 1764140053:return 3;case -1077965542:return 6;case -1293291468:return 5;case -1832800737:case 1970784898:case 862825906:case -803000997:case -1828502776:return 4;case 1532790410:case 1597684571:case 1650812936:case 1188510340:return this.$Jf();case -822056969:case 409031041:case -984702347:return 8;case -1744769642:return 10;case 87208751:return this.lXi();case 1849330294:return 12;case -873142594:return 14;case 1855740761:return 15;
case 2117491830:return 13;case 2107851680:return 16;case -1986737526:return 17;case 119706583:return 18;case -1741941813:return 19;default:return 20}}SNf(){return this.jv?this.jv.hasUOElementType(this.HC,this.ha.$e.Gq?this.ha.$e.Gq:"Chart",0):null}lXi(){const na=this.SNf();return null===na?20:na?11:9}$Jf(){if(Da.EwaSettings.isChangeGateEnabled("OfficeVSO:8412512_EnableChartClearOutlineFillColor")){var na=this.SNf();return null===na?20:na?7:0}if(!this.jv)return 20;na=this.ha.$e.Gq?this.ha.$e.Gq:"Chart";
return oa.a.contains(na,"Series",!0)&&this.jv.hasUOElementType(this.HC,na,0)?7:0}mXi(na){switch(na){case "QueryBold":return 1;case "QueryItalics":return 2;case "QueryUnderline":return 3;case "QueryFontSize":return 6;case "QueryFontName":return 5;case "QueryFontPickerFont":return this.nl()?5:20;default:return 20}}XBf(na,Gb){if(!na)return{returnValue:!1,aO:Gb,index:-1};const Xa=na.split("_"),Jb=Xa[Xa.length-1];if(oa.a.contains(Jb,"ChartTitle",!0))return{returnValue:!0,aO:2,index:-1};if(oa.a.contains(Jb,
"Legend",!0))return{returnValue:!0,aO:3,index:-1};if(oa.a.contains(Jb,"DataTable",!0))return{returnValue:!0,aO:11,index:-1};if(oa.a.contains(Jb,"PrimaryValue",!0))return Gb=11===this.floatingObject.Ki.ChartCategory?oa.a.contains(Jb,"0",!0)?7:8:5===this.floatingObject.Ki.ChartCategory?7:8,{returnValue:!0,aO:Gb,index:-1};if(oa.a.contains(Jb,"PrimaryCategory",!0))return Gb=5===this.floatingObject.Ki.ChartCategory?8:7,{returnValue:!0,aO:Gb,index:-1};if(oa.a.contains(Jb,"AxisTitle",!0)){if(2>Xa.length)return c.ULS.shipAssertTag(537162437,
6,!1,`ChartFloatingObjectControl.GetChartElementFromElementUOPath: Invalid UO Path for AxisTitle. ID: ${this.floatingObject.fi}, UOPath: ${na}`),{returnValue:!1,aO:Gb,index:-1};na=Xa[Xa.length-2];return oa.a.contains(na,"PrimaryValue",!0)?(Gb=11===this.floatingObject.Ki.ChartCategory?oa.a.contains(na,"0",!0)?9:10:5===this.floatingObject.Ki.ChartCategory?9:10,{returnValue:!0,aO:Gb,index:-1}):oa.a.contains(na,"PrimaryCategory",!0)?(Gb=5===this.floatingObject.Ki.ChartCategory?10:9,{returnValue:!0,aO:Gb,
index:-1}):{returnValue:!1,aO:Gb,index:-1}}if(oa.a.contains(Jb,"Gridlines",!0)){if(3>Xa.length)return c.ULS.shipAssertTag(537162436,6,!1,`ChartFloatingObjectControl.GetChartElementFromElementUOPath: Invalid UO Path for Gridlines. ID: ${this.floatingObject.fi}, UOPath: ${na}`),{returnValue:!1,aO:Gb,index:-1};na=Xa[Xa.length-3];return oa.a.contains(na,"PrimaryValue",!0)?(Gb=11===this.floatingObject.Ki.ChartCategory?oa.a.contains(na,"0",!0)?13:12:5===this.floatingObject.Ki.ChartCategory?13:12,{returnValue:!0,
aO:Gb,index:-1}):oa.a.contains(na,"PrimaryCategory",!0)?(Gb=5===this.floatingObject.Ki.ChartCategory?12:13,{returnValue:!0,aO:Gb,index:-1}):{returnValue:!1,aO:Gb,index:-1}}return oa.a.aL(Jb,"Series")?(Gb=parseInt(Jb.substring(6),10),isNaN(Gb)?{returnValue:!1,aO:4,index:-1}:{returnValue:!0,aO:4,index:Gb}):{returnValue:!1,aO:4,index:-1}}wLh(na){let Gb=0,Xa=-1;if(!(()=>{let Db=this.XBf(na,Gb);({aO:Gb,index:Xa}=Db);return Db})().returnValue)return null;const Jb=this.floatingObject.fi;let qb=502;if(Da.EwaSettings.isChangeGateEnabled("OfficeVSO:7160650_ChartSeriesDeleteMacroRecording")&&
4===Gb)return 0>Xa?null:new Zb(Jb,Xa);switch(Gb){case 2:qb=0;break;case 3:qb=100;break;case 11:qb=500;break;case 7:qb=348;break;case 8:qb=352;break;case 9:qb=300;break;case 10:qb=306;break;case 13:qb=328;break;case 12:qb=332;break;default:return null}return new C.a(Jb,qb,"")}tsc(na){const Gb=this.$.pa.ta;c.ULS.sendTraceTag(509634253,5,50,`ChartFloatingObjectControl.DeleteSubSelection. ID:${this.floatingObject.fi}, CurrentSubSelection:${na}`);const Xa=()=>this.wLh(na);J.a(this.$.userOperationManager,
(Jb,qb,Db)=>fb.b(Gb,this.floatingObject.fi,na,Jb,qb,Db,null),Jb=>new W.a(594,0,Jb,void 0,Xa),null);this.wJa=!0}JQb(na){if(!this.HC||!this.jv)return null;const Gb=[],Xa=this.ha.$e.Gq;3===na&&this.jv.supportsDeletion(this.HC,Xa)&&Gb.push(Hb.NRh);Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9FloatieEnabled",!1)&&Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?(this.SZe(Xa,na,Gb),this.RZe(Xa,Gb)):(this.RZe(Xa,Gb),this.SZe(Xa,
na,Gb));return Gb}SZe(na,Gb,Xa){this.jv.isUORibbonCommandSupported(this.HC,na,5)&&(3===Gb?Xa.push(Hb.TRh):2===Gb&&Xa.push(Hb.VRh))}RZe(na,Gb){if(this.jv.isUORibbonCommandSupported(this.HC,na,8)){const Xa=this.jv.hasUOElementType(this.HC,na,0)?7:0;this.jv.isUORibbonCommandSupported(this.HC,na,Xa)?Gb.push(Hb.RRh):Gb.push(Hb.URh)}}EQb(na){if(!this.HC||!this.jv)return null;let Gb=20;switch(na){case 1597684571:Gb=this.$Jf();break;case 409031041:Gb=8;break;case -1832800737:case 1970784898:Gb=4;break;default:c.ULS.sendTraceTag(507852897,
5,50,`ChartFloatingObjectControl.getRibbonCommandVal: Command ${na} not supported.`)}return 20!==Gb?(na=this.jv.getUORibbonCommandVal(this.HC,this.ha.$e.Gq,Gb))&&na.isValid?na.returnVal:null:null}getSelectionDescription(){if(!this.Aga()||!this.SL)return null;if(this.vBc()){var na=this.$N.getSelectionDescription(this.ha.$e.RL);if(na)return na}return(na=this.SL.getSelectionDescription())?na:null}getContextMenuButtonList(){return this.HC&&this.jv?this.jv.getContextMenuButtonList(this.HC,this.ha.$e.Gq):
null}oVc(){return this.jv.supportsDeletion(this.HC,this.ha.$e.Gq)}Neb(){this.eoa&&(R.a.HD(this.eoa.TC),this.eoa=null);this.GTc&&(k.a.Ng(this.GTc),this.GTc=null)}qdk(){this.Neb();this.GTc=La.a.instance.create(()=>{this.eoa=N.u(this.$.pa.ta,this.floatingObject.id,1,this.m7d,this.l7d,null,null,this.$.pa.ta.Jh())},0,ib.a.SRh,!0,!0)}bii(){if(void 0===this.floatingObject.Ki.ChartPlayerData.Fonts||null===this.floatingObject.Ki.ChartPlayerData.Fonts)c.ULS.sendTraceTag(537162433,6,10,`ChartFloatingObjectControl.EnsureFonts: Invalid Font List. Version: ${this.floatingObject.version}, ID: ${this.floatingObject.fi}`);
else for(const na of this.floatingObject.Ki.ChartPlayerData.Fonts)this.SL.ensureFont(na)}Aga(){return!!this.$&&Da.EwaSettings.Ra(407)}lXf(){return Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSInPlaceTextEditing",!1)}Vhj(){return!Da.EwaSettings.isChangeGateEnabled("OfficeVSO:5903230_EscapeKeyManualPlacementFix")}KTd(){return Da.EwaSettings.isChangeGateEnabled("OfficeVSO:5526587_EnterKeyPivotButtonMenu")}Pmj(){return Da.EwaSettings.isChangeGateEnabled("OfficeVSO:6102446_PreventFloatingPivotMenu")}nl(){return M.a.nl()}brj(){return Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSWebTooltipTextFormat",
!1)}hXd(){return Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSSnowballChartImprovement",!1)}vBc(){return this.Aga()&&!!this.$N&&this.$N.Upe&&!this.$N.Iaf}WEi(){const na=new m.a;this.lXf()&&na.add("EnableInPlaceTextEditing");this.Vhj()&&na.add("EnableEscKeyboardEvents");this.KTd()&&na.add("EnableEnterKeyPivotButtonMenu");this.brj()&&na.add("EnableWebTooltipTextFormat");return na.toArray()}Jij(){return Da.EwaSettings.isChangeGateEnabled("OfficeVSO:3868811_IsFontLoadingEnabled")}Gfj(){return!this.floatingObject.Ki||
!this.floatingObject.Ki.ChartPlayerData||!this.floatingObject.Ki.ChartPlayerData.SceneGraphJSON&&!this.Ikb()}Ikb(){return this.floatingObject&&this.floatingObject.Ki&&this.floatingObject.Ki.ChartPlayerData?!!this.floatingObject.Ki.ChartPlayerData.ImageData:!1}isChartDataUnhealthy(){return this.floatingObject.Ki&&this.floatingObject.Ki.Attributes&2048?!0:!1}static BXc(na){const Gb=M.a.$Gc(),Xa=0===na.type&&3===na.renderType;!Gb&&Xa&&c.ULS.sendTraceTag(537162432,5,50,`ChartFloatingObjectControl.ShouldUseForFloatingObject - Prevented ChartPlayer from being created. ID:${na.fi}, Type: ${na.type}, RenderType: ${na.renderType}`);
return Gb&&Xa}static zqj(na){return Object(e.a)(Hb,na)||Object(e.a)(Ka.a,na)&&(na=Object(w.a)(Ka.a,na).ks,Object(e.a)(Hb,na))?!0:!1}static gub(na,Gb){na&&Gb(na)}Bzd(na){if(null!=this.Kwa||na){na&&null==this.Kwa&&(this.Kwa=ba.f(this.$).Zk(1).domElement);var Gb=Wb.DOMElementExtensions.iub(this.Kwa,Hb.bBe);na&&Gb||Wb.DOMElementExtensions.toggleCssClass(this.Kwa,Hb.bBe,na)}}static Wff(na,Gb){Gb&&na&&Gb.version===na.version&&!na.Ona&&(Gb.Ki=na.Ki,na.jz&&-1!==na.jz.EffectsHeight&&(Gb.jz=na.jz),Gb.Ona=!1)}}
Hb.QRh="ewrchart-img-err";Hb.B2f=null;Hb.C2f=null;Hb.bBe="ewrchart-disable-touch";Hb.VRh="ChartRTEFloatie";Hb.RRh="ChartFillOutlineFloatie";Hb.URh="ChartOutlineFloatie";Hb.NRh="ChartDeleteFloatie";Hb.TRh="ChartFontColorFloatie";Hb.sCk="SetProperty";Hb.Ixf="Floatie";Hb.YFg="Ribbon";Hb.PYh="ContextMenu";Object(y.a)(Hb,"ChartFloatingObjectControl",x.a,[793])},1075:function(y,x,a){a.d(x,"a",function(){return c});y=a(0);class c{constructor(b,f,r,d,k,t){t=void 0===t?!1:t;this.xGg=this.absoluteRotation=
0;this.pAa=b;this.qAa=f;this.translateX=r;this.translateY=d;(this.Wnj=t)?this.xGg=k:this.absoluteRotation=k}}Object(y.a)(c,"TransformationParameters",null,[])},1076:function(y,x,a){a.d(x,"a",function(){return c});y=a(0);a=a(1023);class c extends a.a{constructor(b,f,r,d,k,t,m,e,w,l,u){super(b,f,r,d,k,t,m);this.SXh=e;this.RXh=w;this.YXh=l;this.bYh=u}}Object(y.a)(c,"ResizeConnectorCompleteEventArgs",a.a,[])},1077:function(y,x,a){a.d(x,"a",function(){return c});const c=b=>[1,7,3,5].includes(b)},1078:function(y,
x,a){a.d(x,"b",function(){return b});a.d(x,"c",function(){return f});a.d(x,"d",function(){return r});a.d(x,"a",function(){return d});var c=a(62);const b=(k,t,m,e,w,l,u,n)=>{n=k.Za(9,void 0===n?null:n);n.id=t;n.uoPath=m;return c.h(k,"RemoveChartElementUO",n,e,w,l,u,0)},f=(k,t,m,e,w,l,u)=>{u=k.Za(9,void 0===u?null:u);u.id=t;return c.h(k,"ResetVisualTrackerForChart",u,m,e,w,l,0)},r=(k,t,m,e,w,l,u,n,v,B,z,C,D)=>{D=k.Za(9,void 0===D?null:D);D.id=t;D.shapeTextJson=m;D.fResizeNeeded=e;D.absoluteLeft=w;D.absoluteTop=
l;D.absoluteRight=u;D.absoluteBottom=n;return c.h(k,"SetShapeTextV2",D,v,B,z,C,0)},d=(k,t,m,e,w,l,u)=>{u=k.Za(9,void 0===u?null:u);u.id=t;return c.h(k,"PutFloatingImageInCell",u,m,e,w,l,0)}},1079:function(y,x,a){a.d(x,"b",function(){return t});a.d(x,"c",function(){return m});a.d(x,"a",function(){return w});var c=a(14),b=a(71),f=a(55),r=a(905),d=a(16),k=a(426);const t=(l,u)=>{l.vie();l.grid.insertBefore(l.get_element(),l.grid.firstChild);m(l,new b.a(u.x,u.y,u.width,u.height),!0);l.s6a(l.Ch.jz);l.yOa(!0);
l.SBa(!0);l.isVisible=!0;l.Ch.isVisible=!1},m=(l,u,n)=>{d.DOMElementExtensions.SH(l.get_element(),u.width);d.DOMElementExtensions.cW(l.get_element(),u.height);const v=l.o5,B=new f.a(u.x,u.y);B.x=Math.max(B.x,v.x);B.y=Math.max(B.y,v.y);r.a.G5b(l.grid,l.get_element(),B,!1,!1);n&&(n=w(l,B),n=k.a.KO(n.paneType,n.view.Xm),l.floatingObject.width=u.width,l.floatingObject.height=u.height,l.floatingObject.Iz=B.x-v.x+n.x,l.floatingObject.ZZ=l.floatingObject.Iz+l.floatingObject.width,l.floatingObject.HA=B.y-
v.y+n.y,l.floatingObject.o3=l.floatingObject.HA+l.floatingObject.height)},e=(l,u)=>{l=l.da.Pg;if(!l.Uo||u.x>=l.width&&u.y>=l.height)return 1;if(u.x<l.width&&u.y<l.height)return 2;if(u.x<l.width&&u.y>=l.height)return 4;if(u.x>=l.width&&u.y<l.height)return 3;c.ULS.shipAssertTag(537162460,5,!1,`AboveGridFloatingObjectControlHelper.GetContainerPaneType: couldn't find Container Pane Type of gridPosition: X:${u.x}, Y:${u.y}`);return 1},w=(l,u)=>{const n=l.o5;u=r.a.MP(u,new f.a(n.x,n.y));u=e(l,u);return l.da.Zk(u)}},
1212:function(y,x,a){a.d(x,"a",function(){return w});y=a(0);var c=a(14),b=a(302),f=a(17),r=a(286);x=a(105);var d=a(68),k=a(7),t=a(161),m=a(74),e=a(13);class w extends x.a{constructor(l,u){u=void 0===u?!0:u;super(l.domElement);this.Oic=!1;this.yY=v=>{m.g(v.La,!1);if(3===v.oh||v.mw===Sys.UI.MouseButton.middleButton)return!1;if(v.mw===Sys.UI.MouseButton.leftButton&&!this.control.extension.selected)return this.launchHyperlink(v.La.rawEvent),!0;this.Oic||this.Wsd(!0);return!1};this.v3a=v=>{3===v.oh&&this.launchHyperlink(v.La.rawEvent);
return!0};this.control=l;l=this.control.$;const n=(new t.a(l.sa)).Hj(1);if(l.wj&32||!n)this.Oic=!0;u&&this.wE(this.control)}wE(l){b.a.instance.ya(f.a.Zi,l.domElement,this.yY);r.a.instance.ya(f.a.click,l.domElement,this.v3a);r.a.instance.ya(f.a.sr,l.domElement,this.v3a);l.domElement.classList.add(d.n)}ME(l){b.a.instance.Na(f.a.Zi,l.domElement,this.yY);r.a.instance.Na(f.a.click,l.domElement,this.v3a);r.a.instance.Na(f.a.sr,l.domElement,this.v3a);l.domElement.classList.remove(d.n)}get viewMode(){return this.Oic}set viewMode(l){this.Oic=
l}dispose(){this.ME(this.control);super.dispose()}Wsd(l){this.xaf(this.control,l)}xaf(l,u){l.domElement&&(u?l.domElement.classList.remove(d.n):l.domElement.classList.add(d.n))}launchHyperlink(l){const u=this.control.floatingObject;if(u){var n=u.nh;n?(c.ULS.sendTraceTag(537162324,5,50,`ImageHyperLinkBehavior.LaunchHyperlink: Launch ImageHyperLink for control Id: ${u.fi} , isInternalLink: ${n.HLinkTarget===k.a.dQf?!0:!1}`),n.HLinkTarget===k.a.dQf?this.control.da.qMf(l,n.HLinkRange.NamedObjectName,n.HLinkRange.SheetName,
n.HLinkRange.FirstRow,n.HLinkRange.FirstColumn,n.HLinkRange.LastRow,n.HLinkRange.LastColumn):e.HelperMethods.dm(n.HLinkTarget,"_blank",void 0,"ImageHyperLinkBehavior.HLinkTarget")):c.ULS.shipAssertTag(537162325,5,!1,`ImageHyperLinkBehavior.LaunchHyperlink: ShapeMetaData is null. Floating Object ID: ${u.fi}, Type: ${Object.getType(u)}`)}}}Object(y.a)(w,"ImageHyperLinkBehavior",x.a,[])},1213:function(y,x,a){a.d(x,"a",function(){return B});y=a(0);var c=a(2),b=a(14),f=a(17),r=a(188),d=a(286),k=a(302);
x=a(105);var t=a(68),m=a(74),e=a(24),w=a(103),l=a(72),u=a(903),n=a(5),v=a(97);class B extends x.a{constructor(z){super(z.domElement);this.fj=C=>this.vPg()?C.eventName!==f.a.sr?(this.Igb=window.setTimeout(this.nRb,B.dkf),!0):!1:!1;this.onDoubleClick=()=>{window.clearTimeout(this.Igb);this.Igb=B.HLc;return!0};this.yY=C=>{if(!this.vPg())return!1;m.g(C.La,!1);return C.mw!==Sys.UI.MouseButton.leftButton||this.control.extension.selected?!1:(this.Igb=window.setTimeout(this.nRb,B.dkf),!0)};this.nRb=()=>{this.Igb=
B.HLc;const C=this.control.floatingObject;if(this.control.Kga()){e.f(this.control.$).isEditing&&e.f(this.control.$).Cz(!0);const J=r.a.create();var D=[];D.push(Object(c.a)(new l.a,{name:u.a.Cea,string:J.toString()}));w.d(838263848,!0,void 0,2,30,void 0,D);D=v.a.Zg(n.ge);b.ULS.shipAssertTag(512276319,0,!!D);D.J2i(C.id,C.nh.ScriptLink,J,C.nh.ShapeText)}};this.rOg=()=>{if(this.control.$){const C=e.f(this.control.$).ha.$e;C.isFloatingObjectSelected?C.yh.floatingObject.id===this.control.floatingObject.id?
this.control.domElement.classList.remove(t.x):this.control.domElement.classList.add(t.x):this.control.domElement.classList.add(t.x)}};this.control=z;this.Igb=B.HLc;this.Hee(this.control)}dispose(){this.ME(this.control);super.dispose()}wE(z){d.a.instance.ya(f.a.click,z.domElement,this.fj);d.a.instance.ya(f.a.sr,z.domElement,this.onDoubleClick);k.a.instance.ya(f.a.Zi,z.domElement,this.yY);z.domElement.classList.add(t.x);e.f(this.control.$).ha.$e.MN(this.rOg)}ME(z){d.a.instance.Na(f.a.click,z.domElement,
this.fj);d.a.instance.Na(f.a.sr,z.domElement,this.onDoubleClick);k.a.instance.Na(f.a.Zi,z.domElement,this.yY);z.domElement.classList.remove(t.x);e.f(this.control.$).ha.$e.sV(this.rOg)}Hee(z){void v.a.resolve(n.ge,{va:1}).then(C=>{null===C||void 0===C?void 0:C.c_f().then(D=>{D&&this.wE(z)}).catch(()=>{})})}vPg(){return!!this.control.$&&this.control.$.Oxa&&this.Igb===B.HLc&&this.control.$.cy(null,!1,1023)}}B.HLc=-1;B.dkf=500;Object(y.a)(B,"ShapeRunFromButtonBehavior",x.a,[])},1214:function(y,x,a){a.d(x,
"a",function(){return c});y=a(0);class c{constructor(b,f){this.control=b;this.control.xKb(f)}dispose(){this.control.jtc()}update(b){c.M2g(this.control,b)}static M2g(b,f){if(b.VL&&b.floatingObject.YB&&b.VL.count===b.floatingObject.YB.length)for(let r=0,d=b.VL.count;r<d;r++)b.VL.ma(r).update(f,b,f.YB[r]);else b.jtc(),b.xKb(f);c.Z5k(b)}static Z5k(b){if(b.VL&&b.da)for(let f=0;f<b.VL.count;f++)b.VL.ma(f).setPosition(b.da.rtl)}}Object(y.a)(c,"ImageConnectableManager",null,[2])},1215:function(y,x,a){a.d(x,
"a",function(){return D});y=a(0);var c=a(14),b=a(34);x=a(105);var f=a(71),r=a(26),d=a(150),k=a(905),t=a(1023),m=a(1076),e=a(58),w=a(54),l=a(16),u=a(1);a(27);var n=a(136),v=a(151),B=a(115),z=a(57),C=a(46);class D extends x.a{constructor(J,W){super(J.domElement);this.EHe=this.j0d=this.Zy=null;this.yAb=this.canDrag=!1;this.Rm=this.x7a=this.unc=null;this.control=J;this.wAd=[];this.viewBlockContainerHelpers=W;this.control.sZ(D.Knf,!0);v.a(this.control.$,N=>{this.j0d=N.A_(d.a.Yvi,!1)})}C0e(J){this.addHandler(D.Ktc,
J)}LBg(J){this.removeHandler(D.Ktc,J)}A0e(J){this.addHandler("DragCancelled",J)}JBg(J){this.removeHandler("DragCancelled",J)}B0e(J){this.addHandler("DragFinished",J)}KBg(J){this.removeHandler("DragFinished",J)}get Unf(){return this.yAb}get Htc(){return this.canDrag}set Htc(J){this.canDrag!==J&&(this.control.sZ(D.Tnf,J),this.canDrag=J)}yna(J){return this.canDrag&&!this.bij(J.Qh)&&(3!==J.oh||!(b.a.Un&&3===this.control.floatingObject.type))}b3a(J){J=this.control.$?B.a().Ik(J):J;if(!this.yna(J))return u.EwaSettings.isChangeGateEnabled("OfficeVSO:5903230_EscapeKeyManualPlacementFix")&&
this.control.isElementMovementInProgress()&&this.control.setFocus(!0),!1;this.control.extension&&this.control.extension.bP&&this.control.extension.bP.O3b();this.control.SUa();this.yAb=!0;this.raiseEvent(D.Ktc);const W=this.viewBlockContainerHelpers.IO(this.control.fm,this.control.domElement);J=this.viewBlockContainerHelpers.Ny(this.control.fm,J.clientPoint,this.control.fm.rtl);this.EHe=k.a.MP(J,W);this.x7a=new f.a(W.x,W.y,0,0);this.Rm=this.control.fm;this.JMc();return!0}cza(J){const {FloatingObjectControlExtension:W}=
a(945);this.unc=J=this.control.$?B.a().Ik(J):J;var N=this.viewBlockContainerHelpers.Ny(this.Rm,J.clientPoint,this.Rm.rtl),M=this.Rm.ow;N=k.a.MP(N,this.EHe);N.x=Math.max(-M.x,N.x);N.y=Math.max(-M.y,N.y);M=new f.a(N.x,N.y,0,0);this.Rm=W.Tnd(M,this.x7a,this.Rm,this.control,!1);this.viewBlockContainerHelpers.G5b(this.Rm,this.control.domElement,M.topLeft,!1);this.p2e(J,!1);this.r5f();return!0}bza(J){this.control.$&&B.a().Ik(J);this.control.qX();this.yAb=!1;this.Zy=null;this.control.lia(!0);var W=this.wKf();
const N=J=W.x-this.x7a.x,M=W=W.y-this.x7a.y;5===this.control.floatingObject.type&&n.a.xR(this.control.floatingObject.nh)?this.raiseEvent("DragFinished",new m.a(N,M,J,W,!1,!1,this.Rm,100,null,-1,2)):this.raiseEvent("DragFinished",new t.a(N,M,J,W,!1,!1,this.Rm));this.control&&this.control.extension&&this.control.extension.OLa++}aza(J){J.ove?(this.control.lia(!0),this.yAb=!1,this.control.clientVersion--,this.control.qX(),this.raiseEvent("DragCancelled")):this.bza(null)}dispose(){var J;(null===(J=this.Zy)||
void 0===J?0:J.wt)&&this.Zy.cancel();this.control.domElement&&(this.control.sZ(D.Knf,!1),this.control.sZ(D.Tnf,!1));super.dispose()}update(){this.unc&&this.cza(this.unc)}duh(J){this.wAd.push(J)}bij(J){for(let W=0,N=this.wAd.length;W<N;++W)if(l.DOMElementExtensions.Cn(this.wAd[W],J))return!0;return!1}wKf(){return this.viewBlockContainerHelpers.IO(this.Rm,this.control.domElement)}JMc(){this.control.clientVersion++;this.control.lia(!1,!1);if(this.control&&this.control.extension){const J=this.control.extension;
c.ULS.sendTraceTag(537162332,5,50,`ImageDragAdapter:OnDragStart: Image-Updated=${0<J.NNa||0<J.OLa||0<J.lAa?"false":"true"} ResizeOperationsSinceLastLoad=${J.NNa} MoveOperationsSinceLastLoad=${J.OLa} RotateOperationsSinceLastLoad=${J.lAa}`)}}r5f(){this.j0d&&this.j0d(()=>({["floatingObjectType"]:n.a.dH(this.control.floatingObject),["Location"]:"canvas"}))}p2e(J,W){if(J=this.control.da.ha.Ey(J.clientPoint,J.Qh,5,W,void 0,!0)){var N=new r.Range(Math.max(1,J.top-3),Math.max(1,J.left-1),J.bottom+3,J.right+
1,!1,!1);this.Zy?this.Zy.wt||(this.Zy=e.a.instance.create(()=>{this.control.da.gD(N,60,"ImageDragAdapter.OnDragMove")},40,w.a.imageDragAdapterOnDragMove)):(c.ULS.sendTraceTag(537162331,5,50,`ImageDragAdapter.OnDragMove Viewport movement started from  ${N.top.toString()} ${N.left.toString()} ${N.bottom.toString()} ${N.right.toString()}`),this.Zy=e.a.instance.create(()=>{this.control.da.gD(N,60,"ImageDragAdapter.OnDragMove")},40,w.a.imageDragAdapterOnDragMove))}}}D.Knf=C.a.tCd;D.Tnf=z.a.oCd;D.Ktc="DragStarted";
Object(y.a)(D,"ImageDragAdapter",x.a,[841,123])},1217:function(y,x,a){a.d(x,"a",function(){return u});y=a(0);var c=a(353),b=a(158),f=a(214),r=a(1218),d=a(1026),k=a(419),t=a(212),m=a(906),e=a(1078),w=a(111),l=a(604);class u{constructor(n){this.$=n}executeAction(n){switch(n.getType()){case 0:this.setShapeText(n);break;case 1:l.a(this.$).deleteInkStrokes(n);break;case 2:break;case 3:break;default:throw Error.invalidOperation("Unknown GC2 action");}}setShapeText(n){let v;v=n.getShapeTextFormat()?()=>
new d.a(n.getShapeTextFormat(),n.getId()):()=>new r.a(n.getId(),n.getTextContent());const B=this.$.pa.ta;let z=null;var C=f.a.vI(5,n.getId());if(C=w.a(this.$).ky(C)){let D=C.floatingObject;Object(c.a)(m.a,C)&&(D=Object(b.a)(m.a,C).pj.floatingObject);z=(J,W,N)=>e.d(B,n.getId(),n.getText(),n.getResizeNeeded(),D.Iz,D.HA,D.ZZ,D.o3,J,W,N,null)}k.a(this.$.userOperationManager,z,D=>new t.a(581,0,D,void 0,v),null)}static Ghb(n){if(u.instance)return u.instance;u.instance=new u(n);return u.instance}}u.instance=
null;Object(y.a)(u,"GC2ActionHandler",null,[817])},1219:function(y,x,a){a.d(x,"a",function(){return b});y=a(0);var c=a(14);class b{logTrace(f){c.ULS.sendTraceTag(537162333,5,50,f)}}Object(y.a)(b,"GC2Logger",null,[816])},1221:function(y,x,a){a.d(x,"a",function(){return B});y=a(0);var c=a(14),b=a(96),f=a(6);x=a(914);var r=a(68),d=a(62),k=a(122),t=a(1022),m=a(964),e=a(58),w=a(54),l=a(32),u=a(35),n=a(136),v=a(600);class B extends x.a{constructor(z,C,D,J,W,N){super(z,C,r.lb,J,void 0===W?"":W,void 0===
N?!0:N);this.rDf=this.eoa=this.mlb=this.ICa=null;this.ePh=()=>{this.rDf=this.Byc.start();this.eoa=t.c(this.$.pa.ta,this.floatingObject.id,this.ZPj,this.YPj,null,null)};this.ZPj=M=>{this.tia&&this.mta(l.a.Tg.qk.m,"Step2-GetEffectsExtentsSuccess",this.Byc.ii,!1);this.TUg("GetEffectsExtentsSuccess");this.pLa.q9("GetEffectsExtentsSuccess");this.Vga(!0,!0);this.tia&&this.LId.start();this.floatingObject.version<this.clientVersion||(M&&!u.a.Jk(M.Errors)&&(this.s$a=M.Result,this.s6a(M.Result)),this.tia&&
(v.a(this.LId),this.mta(l.a.Tg.qk.m,"Step3-GetEffectsExtentsSuccess-LayoutAndRender",this.LId.ii,!1),this.KJc()),super.z6(null))};this.YPj=()=>{this.tia&&(this.mta(l.a.Tg.qk.m,"Step2-GetEffectsExtentsFailure",this.Byc.ii),this.KJc());this.TUg("GetEffectsExtentsFailure");this.pLa.q9("GetEffectsExtentsFailure");this.Vga(!1,!0);super.z6(null)};this.dPh=()=>{const M=this.$.pa.ta.Jh();this.eoa=d.u(this.$.pa.ta,this.floatingObject.id,1,this.m7d,this.l7d,null,null,M)};this.m7d=M=>{M&&!u.a.Jk(M.Errors)&&
(M=M.Result)&&this.floatingObject.Ki&&(this.floatingObject.Ki.ChartTitle=M.PreviousTitle?M.PreviousTitle:"")};this.l7d=()=>{};this.YFa=D;this.Byc=this.$.qh.Vl("ModelUpdate","FloatingObjectGetEffectsExtentsStopwatch");this.LId=this.$.qh.Vl("ModelUpdate","FloatingObjectGetEffectsExtentsBrowserLayoutStopwatch")}get bO(){return this.ICa}set bO(z){this.ICa=z}dispose(){this.floatingObject&&0===this.floatingObject.type&&n.a.Y5f(this.floatingObject.fi,!1,!1,!1,!1);b.a.Ni([this.ICa,this.mlb]);this.Neb();this.YFa=
this.mlb=this.ICa=null;super.dispose()}dN(z,C){super.dN(z,void 0===C?!1:C);this.YFa.wHb(this.$,this)}P5(){return!!this.floatingObject&&!!this.floatingObject.nh&&this.floatingObject.nh.IsHlinkPresent}cme(z){this.ICa&&this.floatingObject&&(z.version>this.floatingObject.version||z.instanceId!==this.floatingObject.instanceId&&this.floatingObject.n5b<z.n5b)&&this.ICa.ghk();super.cme(z)}v3a(){return!this.P5()}z6(z){if(!f.AFrameworkApplication.Il&&this.floatingObject){var C=this.l6b();this.Laa.stop();this.tia&&
this.mta(l.a.Tg.qk.m,(C?"Step1-":"")+"ImageLoadSuccess",this.Laa.ii,!0);this.WYc("ImageLoadSuccess",!C);this.pLa.q9("ImageLoadSuccess");if(this.zv){const D=this.Xp.block;c.ULS.sendTraceTag(537162329,5,50,`ImageFloatingObjectControl.OnLoadSuccess - Time since GetRangeContent request received [${D.eob}], FloatingObjects Count in block [${D.Qo.count}], this FloatingObject IsSvg [${this.floatingObject.isSvg}]`)}if(C){if(this.floatingObject.version<this.clientVersion)return;this.mhe(this.Laa.ii,!0);this.Neb();
b.a.Ng(this.mlb);this.mlb=e.a.instance.create(this.ePh,0,w.a.l7i,!0,!0)}else this.floatingObject.isSvg||this.floatingObject.jz?(this.s$a=this.floatingObject.jz,this.s6a(this.jz)):this.$da()&&this.Dzk(),this.Vga(!0),super.z6(z);this.bO&&(this.ICa.Yhe(this),this.ICa.Zle(this.floatingObject.Ki));0===this.floatingObject.type&&(this.movable&&(this.Neb(),b.a.Ng(this.mlb),this.mlb=e.a.instance.create(this.dPh,0,w.a.k7i,!0,!0)),m.p(this.$,this.FWa))}}Ape(){return!1}Neb(){this.eoa&&(k.a.HD(this.eoa.TC),this.eoa=
null)}TUg(z){this.Byc.stop();this.y6f(z,this.rDf,!1,this.g4f)}l6b(){if(!this.floatingObject||!this.floatingObject.nh||this.floatingObject.jz)return!1;(this.floatingObject.isSvg||this.floatingObject.Nlb)&&c.ULS.sendTraceTag(537162327,5,15,`ImageFloatingObjectControl.ShouldCallGetEffectsExtents: floating object does not have effects extents. Rendered as ${this.floatingObject.renderType}`);return 5===this.floatingObject.type?this.floatingObject.nh.HasEffects||!!this.floatingObject.nh.Rotation||this.kFk():
1===this.floatingObject.type?this.floatingObject.nh.HasEffects||!!this.floatingObject.nh.Rotation:!1}Dzk(){const z={XEffectsDelta:1,YEffectsDelta:1};z.EffectsWidth=this.floatingObject.width+1;z.EffectsHeight=this.floatingObject.height+1;this.s$a=z;this.s6a(z)}kFk(){if(5===this.floatingObject.type&&this.floatingObject.nh)switch(this.floatingObject.nh.ShapeType){case 4:case 34:case 25:case 43:case 16:case 3:case 92:case 142:case 26:case 50:case 2:case 46:case 44:break;case 0:return!this.egj();default:return!0}return!1}egj(){return n.a.xR(this.floatingObject.nh)&&
0===this.floatingObject.aWa[0].rvd&&0===this.floatingObject.aWa[1].rvd}}Object(y.a)(B,"ImageFloatingObjectControl",x.a,[756])},1222:function(y,x,a){a.r(x);a.d(x,"ConnectorFloatingObjectControlExtension",function(){return t});y=a(0);var c=a(945),b=a(481),f=a(212),r=a(1223),d=a(1022),k=a(262);class t extends c.FloatingObjectControlExtension{constructor(m,e){super(m,e)}Jqb(m){var e=this.rq;const w=e.wla;e=e.Eua;this.control.floatingObject.aWa[w.index].Dhb=!1;this.control.floatingObject.aWa[e.index].Dhb=
!1;w.u5b(!1);e.u5b(!1);super.Jqb(m)}Awd(){}wWa(){this.control.movable&&(this.rq=new r.a(this.control.domElement,this.control.Uv,this.control.da,this.control,this.ys,c.FloatingObjectControlExtension.ZW,c.FloatingObjectControlExtension.viewBlockContainerHelpers),this.ORc())}AVb(m){return(m=void 0===m?!1:m)&&super.AVb(m)}ZDg(m){var e=this.rq;const w=e.wla;e=e.Eua;w&&e&&(m.YB[0].offsetX=w.domElement.offsetLeft+m.offsetX,m.YB[0].offsetY=w.domElement.offsetTop+m.offsetY,m.YB[1].offsetX=e.domElement.offsetLeft+
m.offsetX,m.YB[1].offsetY=e.domElement.offsetTop+m.offsetY)}bjf(m){const e=this.control.floatingObject.id,w=this.control.floatingObject.type,l=this.bla,u=this.dla,n=this.cla,v=this.ala,B=m.tue,z=m.uue,C=m.RXh,D=m.SXh,J=m.YXh,W=m.bYh,N=this.control.$.pa.ta;return new f.a(521,0,(M,Q,R)=>d.e(N,w,e,l,u,n,v,B,z,D,C,J,W,k.c(M,this.akg),k.b(Q,this.$jg),R,null),64,()=>new b.a)}}Object(y.a)(t,"ConnectorFloatingObjectControlExtension",c.FloatingObjectControlExtension,[])},1223:function(y,x,a){a.d(x,"a",function(){return l});
y=a(0);var c=a(14),b=a(34),f=a(1009),r=a(217),d=a(68),k=a(1076),t=a(964),m=a(16),e=a(136),w=a(111);class l extends f.a{constructor(u,n,v,B,z,C,D,J){super(u,v,B,z,C,void 0===D?null:D,void 0===J?null:J);this.mKa=!1;this.eFg=0;this.jOb=this.zib=this.ugb=this.G8c=this.wzb=this.HG=null;this.Uv=n;this.zih=B.$.ll;this.leh=C}get Uv(){return this.wzb}set Uv(u){this.wzb=u}get wla(){return this.control.UM?0<this.control.UM.length?this.control.UM[0]:null:null}get Eua(){return this.control.UM?1<this.control.UM.length?
this.control.UM[1]:null:null}get lfa(){return this.G8c}get Kwa(){return this.zih}dispose(){this.lfa&&(m.DOMElementExtensions.Km(this.lfa.parentNode),this.G8c=null);super.dispose()}Dla(u){this.eFg=u;this.nh||(this.rotation=(this.nh=this.control.floatingObject.nh)?this.nh.Rotation:0);this.Wnd();c.ULS.shipAssertTag(537162399,0,this.control.floatingObject.YB.length===l.oGa,`ConnectorResizableBehavior.CreateAndAttachResizeHandles: expecting 2 connection points, but have ${this.control.floatingObject.YB.length}.`);
this.control.floatingObject.YB.length===l.oGa&&(this.Tyk(),this.control.Dla(u,l.oGa,this));b.a.xZc&&this.Ewd();this.m7(null)}y7a(u,n){this.m7(null);this.zib=this.RTc()?this.Eua:this.wla;this.jOb=Sys.UI.DomElement.getBounds(this.zib.domElement);super.y7a(u,n);b.a.xZc&&(this.Ewd(),this.da.ha&&this.da.ha.$e.yh&&(this.ugb=this.control.BB,m.DOMElementExtensions.setVisible(this.ugb,!1)),m.DOMElementExtensions.setVisible(this.Uv,!0));m.DOMElementExtensions.zBa(this.Kwa,!0,d.A,d.m)}KIb(){this.lfa&&(m.DOMElementExtensions.setVisible(this.ugb,
!0),this.mPd());super.KIb()}m7(u){this.control.UM&&(this.qtd(),this.x5a(this.control,u))}mPd(){this.xAd(0,0,0)}upgrade(u){u&&u.nh&&(this.nh=u.nh,this.rotation=this.nh.Rotation,(u=this.da.ha.$e.yh)&&this.control.domElement.id===u.domElement.id&&(this.i$(),this.Dla(this.eFg)))}Yqc(u,n){u=this.leh.o1h(this.zLd(n),n,this.control.floatingObject.aWa[n].Dhb);u.style.zIndex=String(this.zIndex);return u}zLd(u){return this.HG[u]}resize(u,n){super.resize(u,n);this.lfa&&!this.aHc&&this.i3g()}mfa(){m.DOMElementExtensions.zBa(this.Kwa,
!1,d.A,d.m);this.Qpf();if(this.aHc)this.Mpf();else{const {sob:u,$tb:n,bxb:v,oeb:B,flipX:z,flipY:C}=this.Opf(),D=this.JWa,{ZUh:J,YUh:W,returnValue:N}=w.a(this.control.$).C_k(this.dG);N?(this.control.floatingObject.aWa[D.index].Dhb=!0,D.u5b(!0),this.raiseEvent(f.a.P3b,new k.a(u,v,n,B,z,C,this.Rm,J.floatingObject.type,J.floatingObject.id,W.index,this.RTc()?0:1))):(this.control.floatingObject.aWa[D.index].Dhb=!1,D.u5b(!1),this.raiseEvent(f.a.P3b,new k.a(u,v,n,B,z,C,this.Rm,100,null,-1,this.RTc()?0:1)))}this.Npf();
this.ugb=null}eZa(u,n,v){return u?(v?-1:1)*n/u:1}x5a(u,n){if(u.UM){var v=0;n=n||u.floatingObject;for(const B of u.UM){const z=e.a.jyc(n,n.YB[v],u.da.rtl);m.DOMElementExtensions.updatePosition(B.domElement,z.x,z.y,!0);v++}}}qtd(){if(this.nh){this.mKa=this.nh.FlipX!==this.nh.FlipY;let u=this.L9d%360;u+=0>u?360:0;u=this.mKa?360-u:u;this.mKa=45<=u&&135>u||225<=u&&315>u?!this.mKa:this.mKa}}RTc(){return this.JWa===this.wla}Ewd(){if(!this.lfa){var u=r.a.lBa;const n=this.Uv.ownerDocument.createElementNS(u,
"svg");n.setAttribute("xmlns",u);n.setAttribute("version","1.1");n.setAttribute("height","100%");n.setAttribute("width","100%");n.setAttribute("style","position: absolute;");u=this.Uv.ownerDocument.createElementNS(u,"line");u.setAttribute("style","stroke:#000000;stroke-width:1.0;stroke-dasharray:3,3;");n.appendChild(u);this.Uv.appendChild(n);this.G8c=u}}i3g(){var u=this.control.domElement;if(u&&this.nh){var n=this.DO!==this.EO!==this.mKa;n?this.xAd(u.clientWidth,0,u.clientHeight):this.xAd(0,u.clientWidth,
u.clientHeight);n?(this.wla.ONa=1,this.Eua.ONa=5):(this.wla.ONa=7,this.Eua.ONa=3);u=t.c(this.PS);t.l(Sys.UI.DomElement.getBounds(this.Uv.parentNode),this.control.UM,u,!1);u=Sys.UI.DomElement.getBounds(this.zib.domElement);if(2<Math.abs(u.x-this.jOb.x)||2<Math.abs(u.y-this.jOb.y))u=this.wla.domElement.offsetLeft,n=this.wla.domElement.offsetTop,m.DOMElementExtensions.updatePosition(this.wla.domElement,this.Eua.domElement.offsetLeft,this.Eua.domElement.offsetTop,!0),m.DOMElementExtensions.updatePosition(this.Eua.domElement,
u,n,!0);this.jOb=Sys.UI.DomElement.getBounds(this.zib.domElement)}}xAd(u,n,v){this.lfa&&(this.lfa.setAttribute("x1",u.toString()),this.lfa.setAttribute("y1",(0).toString()),this.lfa.setAttribute("x2",n.toString()),this.lfa.setAttribute("y2",v.toString()))}Tyk(){this.HG=Array(l.oGa);const u=Array(l.oGa);if(this.rotation){var n=Array(l.oGa),v=Sys.UI.DomElement.getBounds(this.Uv.parentNode);v=new Sys.UI.Point(v.width/2,v.height/2);const B=t.c(-this.rotation);for(let z=0;z<l.oGa;z++)n[z]=e.a.jyc(this.control.floatingObject,
this.control.floatingObject.YB[z],!1),u[z]=t.n(n[z],v,B,this.control.fm.rtl)}else for(n=0;n<l.oGa;n++)u[n]=e.a.jyc(this.control.floatingObject,this.control.floatingObject.YB[n],!1);this.qtd();u[0].x===u[1].x?u[0].y<u[1].y?this.mKa?(this.HG[0]=1,this.HG[1]=5):(this.HG[0]=7,this.HG[1]=3):this.mKa?(this.HG[0]=5,this.HG[1]=1):(this.HG[0]=3,this.HG[1]=7):u[0].y===u[1].y?u[0].x<u[1].x?(this.HG[0]=7,this.HG[1]=3):(this.HG[0]=1,this.HG[1]=5):u[0].x<u[1].x?u[0].y<u[1].y?(this.HG[0]=7,this.HG[1]=3):(this.HG[0]=
5,this.HG[1]=1):u[0].y<u[1].y?(this.HG[0]=1,this.HG[1]=5):(this.HG[0]=3,this.HG[1]=7)}}l.oGa=2;Object(y.a)(l,"ConnectorResizableBehavior",f.a,[])},1358:function(y,x,a){a.d(x,"g",function(){return D});a.d(x,"f",function(){return J});a.d(x,"d",function(){return W});a.d(x,"a",function(){return N});a.d(x,"c",function(){return M});a.d(x,"b",function(){return Q});a.d(x,"e",function(){return R});a.d(x,"j",function(){return O});a.d(x,"k",function(){return U});a.d(x,"l",function(){return K});a.d(x,"h",function(){return F});
a.d(x,"i",function(){return I});var c=a(14),b=a(57),f=a(46),r=a(945);y=a(0);var d=a(158),k=a(1215),t=a(71),m=a(55),e=a(905),w=a(906),l=a(115);class u extends k.a{constructor(P,Y){super(P,Y);this.Pnf=null}get Ch(){return Object(d.a)(w.a,this.control)}b3a(P){P=this.control.$?l.a().Ik(P):P;if(!this.yna(P))return!1;this.Ch.SUa();this.yAb=!0;this.raiseEvent(k.a.Ktc);var Y=this.viewBlockContainerHelpers.IO(this.Ch.fm,this.Ch.domElement);P=this.viewBlockContainerHelpers.Ny(this.Ch.fm,P.clientPoint,this.Ch.fm.rtl);
this.Pnf=e.a.MP(P,Y);this.Rm=this.Ch.fm;Y=this.viewBlockContainerHelpers.Lfa(this.Rm,this.Ch.domElement);this.x7a=new t.a(Y.x+this.Rm.ow.x,Y.y+this.Rm.ow.y,Y.width,Y.height);P=this.Ch.pj;this.Ch.OOa(new t.a(this.x7a.x+P.o5.x,this.x7a.y+P.o5.y,Y.width,Y.height));P.SUa();this.JMc();return!0}cza(P){this.unc=P=this.control.$?l.a().Ik(P):P;this.p2e(P,!0);this.JYk(P.clientPoint);this.r5f();return!0}bza(P){P=this.control.$?l.a().Ik(P):P;this.Ch.pj.qX();this.Rm=this.Ch.pj.fm;super.bza(P)}dispose(){super.dispose()}wKf(){const P=
this.viewBlockContainerHelpers.IO(this.Rm,this.Ch.pj.domElement);return new m.a(P.x+this.Rm.ow.x,P.y+this.Rm.ow.y)}JYk(P){const Y=this.Ch.pj;P=e.a.Ny(new m.a(0,0),Y.grid,P,this.Rm.rtl);P=e.a.MP(P,this.Pnf);const ea=this.viewBlockContainerHelpers.Lfa(Y.fm,Y.domElement);Y.p5b(new t.a(P.x,P.y,ea.width,ea.height),!1)}}Object(y.a)(u,"MultiPanesImageDragAdapter",k.a,[]);x=a(1212);class n extends x.a{constructor(P){super(P,!1);this.wY=(Y,ea)=>{this.wE(ea.JT)};this.eqb=(Y,ea)=>{this.ME(ea.JT)};for(const Y of this.Ch.children)this.wE(Y);
this.Ch.$Fb(this.wY);this.Ch.mkc(this.eqb)}get Ch(){return Object(d.a)(w.a,this.control)}dispose(){for(const P of this.Ch.children)this.ME(P);super.dispose()}Wsd(P){for(const Y of this.Ch.children)this.xaf(Y,P)}}Object(y.a)(n,"MultiPanesImageHyperLinkBehavior",x.a,[]);x=a(1388);var v=a(990);class B extends x.a{constructor(P,Y,ea,Ba,Fa){super(P,Y,ea,Ba,Fa)}get Ch(){return Object(d.a)(w.a,this.control)}update(){if(this.iya){var P=this.Yt,Y=P.topLeft;v.a(P,0>Y.x?-Y.x:0,0>Y.y?-Y.y:0);this.Ch.OOa(P);this.Ch.Yxa()&&
this.Uqa(P,this.Ch.pj)}}TVc(P){this.iya||(this.Nk=this.ml(),this.Yt=this.Nk.clone());(P&&!this.U0a||!P&&!this.F0a)&&this.Zsg(P)}mNc(P){this.Yt&&(0>this.Yt.x||0>this.Yt.y)&&(this.Yt=new t.a(Math.max(this.Yt.x,0),Math.max(this.Yt.y,0),this.Yt.width,this.Yt.height));super.mNc(P)}ml(){var P=this.Ch.pj.grid;P=e.a.IO(new m.a(0,0),P,this.Ch.domElement,this.da.rtl);return new t.a(P.x,P.y,this.Ch.domElement.clientWidth,this.Ch.domElement.clientHeight)}}Object(y.a)(B,"MultiPanesImageKeyboardAdjustBehavior",
x.a,[]);x=a(1386);class z extends x.a{constructor(P){super(P,!1);this.wY=(Y,ea)=>{this.wE(ea.JT);this.selected&&ea.JT.SBa(!0)};this.eqb=(Y,ea)=>{this.ME(ea.JT)};for(const Y of this.Ch.children)this.wE(Y);this.wE(this.Ch.pj);this.Ch.$Fb(this.wY);this.Ch.mkc(this.eqb)}get Ch(){return Object(d.a)(w.a,this.control)}get pff(){return this.Ch.pj&&this.Ch.pj.isVisible?this.Ch.pj:this.Ch.ks}dispose(){for(const P of this.Ch.children)this.ME(P);this.Ch.pj&&this.ME(this.Ch.pj);this.Ch.Pfe(this.wY);this.Ch.zBg(this.eqb);
super.dispose()}Uxb(P,Y){for(const ea of this.Ch.children)super.Uxb(ea,Y);for(const ea of this.Ch.l9e)super.Uxb(ea,Y);this.Ch.pj&&super.Uxb(this.Ch.pj,Y)}ME(P){P!==this.Ch&&super.ME(P)}wE(P){P!==this.Ch&&super.wE(P)}qrb(P,Y,ea){if(this.Ch.pj){const Ba=this.Ch.pj.isVisible;this.Ch.pj.isVisible=!1;super.qrb(P,Y,void 0===ea?!1:ea);this.Ch.pj.isVisible=Ba}}}Object(y.a)(z,"MultiPanesImageSelectableBehavior",x.a,[]);a=a(1213);class C extends a.a{constructor(P){super(P);this.wY=(Y,ea)=>{this.Hee(ea.JT)};
this.eqb=(Y,ea)=>{this.ME(ea.JT)};for(const Y of this.Ch.children)this.Hee(Y);this.Ch.$Fb(this.wY);this.Ch.mkc(this.eqb)}get Ch(){return Object(d.a)(w.a,this.control)}dispose(){for(const P of this.Ch.children)this.ME(P);super.dispose()}}Object(y.a)(C,"MultiPanesShapeRunFromButtonBehavior",a.a,[]);const D=(P,Y,ea)=>{P.$Fb(Y);P.mkc(ea)},J=(P,Y,ea)=>{P.Pfe(Y);P.zBg(ea)},W=(P,Y)=>{Y.eG&&(P.WM=new z(Y),P.Ezg())},N=(P,Y)=>{if(Y.eG&&Y.movable){P.dC=new u(Y,r.FloatingObjectControlExtension.viewBlockContainerHelpers);
P.pzg();for(const ea of Y.children)P.Cba(ea);Y.pj&&P.Cba(Y.pj)}},M=(P,Y)=>{Y.eG&&(P.Hx=new B(Y.domElement,Y.da,Y,r.FloatingObjectControlExtension.viewBlockContainerHelpers,P.ys),P.wzg())},Q=P=>{P.iPg()&&(P.flb=new n(P.control),c.ULS.sendTraceTag(537162206,5,50,`MultiPanesFloatingObjectControlExtensionHelper.CreateImageHyperLinkBehavior: Create CreateImageHyperLinkBehaviorByExtension for control Id: ${P.control.floatingObject?P.control.floatingObject.fi:"unknown"}`))},R=P=>{P.jPg()&&(P.Ine=new C(P.control),
c.ULS.sendTraceTag(537162205,5,50,`MultiPanesFloatingObjectControlExtensionHelper.CreateShapeRunFromButtonBehavior: Create CreateShapeRunFromButtonBehaviorByExtension for control Id: ${P.control.floatingObject?P.control.floatingObject.fi:"unknown"}`))},O=P=>{const Y=P.pj;if(null===Y||void 0===Y?0:Y.isVisible)P.isVisible=!0},U=(P,Y,ea)=>{P.X$f(ea)&&(Y.isVisible=!0)},K=(P,Y)=>{for(const ea of Y.children)P.z0c(ea);Y.pj&&P.z0c(Y.pj)},F=(P,Y)=>{var ea;if(null===(ea=P.WM)||void 0===ea?0:ea.selected)P.rq&&
(P.rq.Dla(P.WM.eh),P.dC&&Y.JT.sZ(b.a.oCd,!0)),P.Jv&&P.Jv.qWa();P.dC&&(Y.JT.sZ(f.a.tCd,!0),P.Cba(Y.JT))},I=(P,Y)=>{P.rq&&Y.JT.i$(P.rq);P.dC&&(Y.JT.sZ(b.a.oCd,!1),Y.JT.sZ(f.a.tCd,!1),P.z0c(Y.JT));P.Jv&&Y.JT.iHa(P.Jv)}},1386:function(y,x,a){a.d(x,"a",function(){return M});y=a(0);var c=a(14),b=a(17),f=a(302),r=a(193),d=a(325),k=a(286),t=a(399),m=a(60);x=a(105);var e=a(69),w=a(964);class l extends Sys.EventArgs{constructor(Q,R){super();this.selected=Q;this.inputMethod=R}}Object(y.a)(l,"ImageSelectionChangedEventArgs",
Sys.EventArgs,[]);var u=a(86),n=a(16),v=a(74),B=a(35),z=a(1),C=a(136),D=a(47),J=a(115),W=a(97),N=a(5);class M extends x.a{constructor(Q,R){R=void 0===R?!0:R;super(Q.domElement);this.e1b=this.Jt=!1;this.qab=this.MLc=0;this.nh=null;this.PS=0;this.yY=O=>{O=this.control.$?J.a().Ik(O):O;return this.F7d(O,O.clientPoint,this.cQg(O.mw))};this.Cgg=O=>{O=this.control.$?J.a().Ik(O):O;return this.F7d(O,O.clientPoint,this.cQg(O.mw))};this.Egg=O=>{O=this.control.$?J.a().Ik(O):O;return this.F7d(O,O.clientPoint,
!1)};this.fj=O=>{if(this.control.floatingObject.Spc){if(9!==this.control.floatingObject.type&&this.lXc(O))return this.qrb(O.La,O.clientPoint,!0),!1;this.control.showE1ODialog();return!0}O=this.control.$?J.a().Ik(O):O;if(3===O.oh||O.eventName===b.a.sr){if(this.lXc(O))return this.qrb(O.La,O.clientPoint,!0),!1;this.Jt||3===O.oh&&(this.control.P5()||this.control.Kga())||(this.da.ha.$e.J1(this.control),this.da.ha.$e.hJg());if(3===O.oh){if(this.control.floatingObject&&3===this.control.floatingObject.type)return!1;
(this.control.floatingObject&&0===this.control.floatingObject.type&&3===this.control.floatingObject.renderType?!z.EwaSettings.isChangeGateEnabled("OfficeVSO:4817161_IsPointerEventEnabled"):1)&&this.Jt&&this.showChartContextMenu(O)}}return(!this.control.P5()&&!this.control.Kga()||this.Jt)&&3!==O.oh};this.onDoubleClick=O=>this.fj(O)?(this.control.$.isEditMode&&(5===this.control.floatingObject.renderType&&5===this.control.floatingObject.type?(O=new u.a(-445658892,this.eh,this.control.$.Rh,30,null),this.control.$.Ma.dh(O,
null)):5!==this.control.floatingObject.type||C.a.xR(this.control.floatingObject.nh)||this.control.floatingObject.nh.IsGroup||(c.ULS.sendTraceTag(554723232,5,15,`Shape text editing not supported on the shape with id: ${this.control.floatingObject.fi}`),O=B.a.Yi(1,0,824,825,0,-833623233,"ShapeTextEditingUnsupported"),D.a(this.control.$).lp(O))),!this.control.Kga()):!1;this.hp=O=>{O=this.control.$?J.a().Ik(O):O;this.lXc(O)?this.qrb(O.La,O.clientPoint):(this.Jt||this.da.ha.$e.J1(this.control),this.showChartContextMenu(O));
return!0};this.Dgg=O=>{O=this.control.$?J.a().Ik(O):O;if(O.mw===Sys.UI.MouseButton.leftButton||O.mw===Sys.UI.MouseButton.rightButton)this.Jt&&this.da.ha.$e.hJg(),this.da.ha.$e.eVd=!1;return!1};this.PD=Q.da;this.control=Q;R&&this.wE(this.control);this.selected=!1}wE(Q){f.a.instance.ya(b.a.Zi,Q.domElement,this.yY);r.a.instance.ya(b.a.um,Q.domElement,this.Egg);d.a.instance.ya(b.a.yy,Q.domElement,this.Cgg);f.a.instance.ya(b.a.jo,Q.domElement,this.Dgg);k.a.instance.ya(b.a.click,Q.domElement,this.fj);k.a.instance.ya(b.a.sr,
Q.domElement,this.onDoubleClick);t.a.instance.ya(Q.domElement,this.hp)}ME(Q){f.a.instance.Na(b.a.Zi,Q.domElement,this.yY);d.a.instance.Na(b.a.yy,Q.domElement,this.Cgg);r.a.instance.Na(b.a.um,Q.domElement,this.Egg);f.a.instance.Na(b.a.jo,Q.domElement,this.Dgg);k.a.instance.Na(b.a.click,Q.domElement,this.fj);k.a.instance.Na(b.a.sr,Q.domElement,this.onDoubleClick);t.a.instance.Na(Q.domElement,this.hp)}get eh(){return this.qab}set eh(Q){this.qab=Q;e.a.eh=Q}Ryh(Q){this.addHandler("ImgSeleChnged",Q)}rjk(Q){this.removeHandler("ImgSeleChnged",
Q)}get selected(){return this.Jt}set selected(Q){this.Jt!==Q&&(this.e1b||this.a5j(),this.Jt=Q,this.raiseEvent("ImgSeleChnged",new l(Q,this.eh)),this.control.SBa(Q))}get pff(){return this.control}get da(){return this.PD}dispose(){this.ME(this.control);this.PD=null;super.dispose()}upgrade(Q){Q&&(this.selected&&this.control.lia(!0,!1),Q.floatingObject.nh&&(this.nh=Q.floatingObject.nh,this.MLc=w.i(this.nh.Rotation,this.nh.FlipX!==this.nh.FlipY),this.Uxb(Q,this.MLc),this.PS=this.MLc))}Via(Q){this.PS=this.MLc+
Q;this.Uxb(this.control,this.PS)}F7d(Q,R,O){this.eh=Q.oh;if(this.lXc(Q))return this.qrb(Q.La,R),!1;v.g(Q.La,!1);if(3===Q.oh)return!1;O&&(this.Jt||this.da.ha.$e.J1(this.control),this.da.ha.$e.eVd=!0);return!1}Uxb(Q,R){w.a(Q.Uv,R);C.a.xR(this.nh)&&(Q.Uv.style.borderWidth="0px")}qrb(Q,R,O){O=void 0===O?!1:O;const U=this.control.isVisible;this.control.isVisible=!1;if(R=m.a.Cyc(R))O?n.DOMElementExtensions.JDc(R,Q):n.DOMElementExtensions.baa(R,Q,new Sys.UI.Point(0,0)),v.g(Q,!1);this.control.isVisible=U}Ojj(Q,
R){let O=!1;Q=n.DOMElementExtensions.getBoundingClientRect(Q);var U=new Sys.UI.Point(Q.x+Q.width/2,Q.y+Q.height/2),K=w.c(-this.PS);R=w.n(R,U,K,!1);U=R.x-Q.x;K=R.y-Q.y;this.Jt&&(Math.abs(U)<=M.Umc||Math.abs(K)<=M.Umc||Math.abs(K-Q.height)<=M.Umc||Math.abs(U-Q.width)<=M.Umc)?O=!0:1===this.control.floatingObject.type&&R.x>=Q.x&&R.x<=Q.x+Q.width&&R.y>=Q.y&&R.y<=Q.y+Q.height&&(O=!0);return O}a5j(){this.control.$da()&&this.upgrade(this.control);this.e1b=!0}Mjj(Q,R){if(!this.control.MCc||4===this.control.floatingObject.renderType||
9===this.control.floatingObject.type)return!1;if(this.control.floatingObject.vM)return this.Njj(Q,R);var O=document.createElement("canvas");R=this.control.N2c;const U=n.DOMElementExtensions.getBoundingClientRect(R);O.width=R.width;O.height=R.height;O=O.getContext("2d");O.drawImage(R,0,0,R.width,R.height);return this.$Wf(O,new Sys.UI.Point(Q.x-U.x,Q.y-U.y),Q,R.parentNode.parentNode)}$Wf(Q,R,O,U){if(!C.a.xR(this.nh)&&this.Ojj(U,O))return!1;var K=new Sys.UI.Point(R.x-5.5,R.y-5.5);R=Math.max(K.x,0);O=
Math.max(K.y,0);U=11+Math.min(K.x,0);K=11+Math.min(K.y,0);U||(U=5.5);K||(K=5.5);Q=Q.getImageData(R,O,U,K);R=0;for(O=3;O<Q.data.length;O+=4)R+=Q.data[O];return!R}Njj(Q,R){return(R=this.pff.getHitTestData(Q,R))?this.$Wf(R.context,new Sys.UI.Point(R.offsetPoint.x,R.offsetPoint.y),Q,this.control.domElement):!1}lXc(Q){if(!this.control.Vtd)return!1;let R=!1;try{R=this.Mjj(Q.clientPoint,Q.Qh)}catch(O){const U=this.control.floatingObject;c.ULS.sendTraceTag(537162305,5,50,`ImageSelectableBehavior.IsHitInTransparentArea, Exception was thrown when calling GetBoundingClientRect. Exception [${O.message}], Stack [${O.stack}], FOType [${U.type}], FORenderType [${U.renderType}]`)}return R&&
!this.control.JEc(Q.Qh)}showChartContextMenu(Q){const R=this.da.ha.$e.yh,O=R?R.floatingObject:null;O&&void W.a.resolve(N.R,{va:0}).then(U=>{U.KDc(O.Ki,Q.oh,Q)})}cQg(Q){const R=this.control.Kga()&&this.control.$.Oxa;return Q!==Sys.UI.MouseButton.middleButton&&!((this.control.P5()||R)&&Q===Sys.UI.MouseButton.leftButton)}}M.Umc=3;Object(y.a)(M,"ImageSelectableBehavior",x.a,[])},1387:function(y,x,a){a.d(x,"a",function(){return D});y=a(0);var c=a(14),b=a(96),f=a(1074);x=a(105);var r=a(914),d=a(150),k=
a(964),t=a(34),m=a(68),e=a(19),w=a(7),l=a(59),u=a(16);class n{constructor(){this.IRe=null;this.Xmh=document.createElement("div");this.nba.className=m.fb;if(t.a.xZc){const J=document.createElementNS("http://www.w3.org/2000/svg","svg");J.setAttribute("xmlns","http://www.w3.org/2000/svg");J.setAttribute("version","1.1");J.setAttribute("height","100%");J.setAttribute("width","100%");J.setAttribute("overflow","visible");const W=document.createElementNS("http://www.w3.org/2000/svg","line");W.setAttribute("style",
"stroke:#8c8a8a;stroke-width:1.5;");W.setAttribute("x1","12");W.setAttribute("y1","-5");W.setAttribute("x2","12");W.setAttribute("y2","10");J.appendChild(W);this.nba.appendChild(J)}this.G5h()}get nba(){return this.Xmh}get c4a(){return this.IRe}get isVisible(){return u.DOMElementExtensions.isVisible(this.nba)}set isVisible(J){u.DOMElementExtensions.setVisible(this.nba,J)}G5h(){this.IRe=document.createElement("div");this.c4a.className=e.a.bud;const J=document.createElement("img");J.classList.add(e.a.$mi);
J.src=l.a.$m(1);J.draggable=!1;this.c4a.appendChild(J);this.c4a.style.cursor=String.format(w.a.TGa,l.a.current.uu(108));this.nba.insertBefore(this.c4a,this.nba.firstChild)}}n.Zzd=10;Object(y.a)(n,"RotatePoint",null,[824]);var v=a(1075),B=a(136),z=a(151),C=a(115);class D extends x.a{constructor(J,W,N,M){super(J);this.translateY=this.translateX=0;this.cUg=null;this.MVa=!1;this.K0d=null;this.Ptg=this.Qtg=this.DO=this.EO=!1;this.N9=null;this.bLc=this.E3a=this.B1b=0;this.nh=null;this.N5a=!1;this.Nk=null;
this.mRa=0;this.P6d=Q=>{16===Q.keyCode&&!this.MVa&&this.N5a&&(this.MVa=!0,this.cU.Aa("keyup",this.Q6d),this.update())};this.Q6d=Q=>{16===Q.keyCode&&this.MVa&&this.N5a&&(this.MVa=!1,this.cU.detach("keyup"),this.update())};this.control=W;this.ys=N;this.viewBlockContainerHelpers=M;this.cU=this.Xk.sWa();this.aOa();z.a(this.control.$,Q=>{this.K0d=Q.A_(d.a.bwi,!1)})}get D_(){return this.mRa}get b$(){return this.D_+this.B1b}get p0b(){return this.control.BB.offsetTop}get o0b(){return this.control.BB.offsetLeft}dispose(){b.a.Ng(this.cU);
super.dispose()}BAh(J){this.addHandler("RotateStarted",J)}Mkk(J){this.removeHandler("RotateStarted",J)}Via(J){this.mRa=0;this.B1b=J+this.E3a;this.w5a()}oxd(){const J=new n;J.nba.style.zIndex=this.control.G0a?String(r.a.S$b-1):String(r.a.wQa+2*this.control.floatingObject.kL);return J}qWa(){this.control.qWa(this);this.w5a()}iHa(){this.control.iHa(this)}yna(J){return J.mw!==Sys.UI.MouseButton.middleButton}b3a(J){J=this.control.$?C.a().Ik(J):J;this.Rre(J);return!0}cza(J){J=this.control.$?C.a().Ik(J):
J;this.N9=this.Ny(J.clientPoint);this.update();return!0}bza(J){this.control.$&&C.a().Ik(J);this.Rpf()}aza(J){J.ove&&(this.N9=this.cUg,this.update(),this.control.clientVersion--);this.Rpf()}aIj(){this.Ptg=this.DO;this.Qtg=this.EO}$Hj(J,W){this.DO=this.Ptg!==J;this.EO=this.Qtg!==W;this.w5a()}upgrade(J){if(null===J||void 0===J?0:J.nh)this.nh=J.nh,this.E3a=this.nh.Rotation,this.EO=this.DO=!1,this.Via(0)}w5a(){this.wie(this.control)}aOa(){this.Nk=this.ml();this.B1b=this.E3a=(this.nh=this.control.floatingObject.nh)?
this.nh.Rotation:0;this.mRa=0;this.DO=this.EO=!1;this.ys&&this.ys.clear()}update(){if(this.N9){this.vrk(this.N9);const J=this.b$-this.E3a;this.control.extension&&this.control.extension.Via(J,!1);this.w5a();this.K0d&&this.K0d(()=>({["floatingObjectType"]:B.a.dH(this.control.floatingObject),["Location"]:"canvas"}))}}wie(J){if(J.vS){var W=J.fm.rtl,N=Sys.UI.DomElement.getBounds(J.Uv.parentNode),M=this.b$,Q=B.a.vaa(this.E3a,this.nh?this.nh.FlipX!==this.nh.FlipY:!1);if(Q){var R=W?n.Zzd+N.width:-n.Zzd;var O=
N.height/2;M+=90}else R=N.width/2,O=-n.Zzd;this.bLc=(Q?this.DO:this.EO)!==(this.nh?this.nh.FlipY:!1)?180:0;k.a(J.vS.nba,this.b$+this.bLc);(M+=this.bLc)?(N=new Sys.UI.Point(N.width/2,N.height/2),R=new Sys.UI.Point(R,O),M=k.c(M),k.j(J.vS.nba,R,N,M,W)):u.DOMElementExtensions.updatePosition(J.vS.nba,R,O,!0,W)}}Rre(J){const W=this.control.extension;W&&(W.eOc(),W.bP&&W.bP.O3b(),c.ULS.sendTraceTag(537162306,5,50,`ImageRotatableBehavior:OnDragStart: Image-Updated=${0<W.NNa||0<W.OLa||0<W.lAa?"false":"true"} ResizeOperationsSinceLastLoad=${W.NNa} MoveOperationsSinceLastLoad=${W.OLa} RotateOperationsSinceLastLoad=${W.lAa}`));
this.raiseEvent("RotateStarted",null);this.control.clientVersion++;this.cU.Aa("keydown",this.P6d);this.cUg=this.Ny(J.clientPoint);this.Nk=this.ml();this.MVa=!1;this.N5a=!0}Ny(J){return this.viewBlockContainerHelpers.Ny(this.control.fm,J,this.control.fm.rtl)}ml(){return this.viewBlockContainerHelpers.Lfa(this.control.fm,this.control.domElement)}yCi(J,W,N){N=(N?-1:1)*(J.x-W.x);if(J=W.y-J.y)W=f.a.N9j(Math.atan(N/J));else if(0<N)W=90;else if(0>N)W=-90;else return this.D_;0>J&&(W+=180);return W-=this.bLc}YBh(){k.m(this.control.BB,
0,0,this.ys)}vrk(J){if(this.control.BB){var W=this.control.fm.rtl,N=new Sys.UI.Point(this.Nk.x+this.Nk.width/2,this.Nk.y+this.Nk.height/2);this.mRa=this.yCi(J,N,W);this.mRa=this.D_-this.B1b;this.MVa&&(J=this.b$%15,0>J&&(J+=15),this.mRa=this.D_-J);J=new Sys.UI.Point(this.Nk.x+(W?-1:1)*this.Nk.width/2,this.Nk.y+this.Nk.height/2);W=new Sys.UI.Point(this.Nk.x+this.o0b-(W?this.Nk.width:0),this.Nk.y+this.p0b);this.translateX=J.x-W.x;this.translateY=J.y-W.y;this.nh&&this.nh.IsShapeGC2ModelRendered?this.control.extension.updateTransformDuringOperation(null,
null,!1,!1,this.nh.Rotation+this.b$-this.E3a):(this.ys.add(new v.a(1,1,this.translateX,this.translateY,this.D_,!0)),this.YBh(),this.ys.removeAt(this.ys.count-1))}}Rpf(){this.N9=null;this.control.Yxa()&&this.ys.add(new v.a(1,1,this.translateX,this.translateY,this.D_,!0));this.B1b=this.b$;this.mRa=0;this.N5a=this.MVa=!1;this.cU.sO();this.control.extension.Jqb(this.b$)}}Object(y.a)(D,"ImageRotatableBehavior",x.a,[797,123])},1388:function(y,x,a){a.d(x,"a",function(){return v});y=a(0);var c=a(96);x=a(105);
var b=a(990),f=a(1023),r=a(1076),d=a(1024),k=a(1009),t=a(964),m=a(1075),e=a(58),w=a(54),l=a(136),u=a(423);class n extends Sys.EventArgs{constructor(B,z,C,D,J,W){super();this.Mcd=B;this.ujd=z;this.Cgd=C;this.a6c=D;this.qjd=J;this.rjd=W}get sob(){return this.Mcd}get bxb(){return this.ujd}get $tb(){return this.Cgd}get oeb(){return this.a6c}get tue(){return this.qjd}get uue(){return this.rjd}}Object(y.a)(n,"MoveEventArgs",Sys.EventArgs,[]);class v extends x.a{constructor(B,z,C,D,J){super(B);this.UPe=
0;this.lhd=this.Nie=this.Cje=null;this.kbd=this.Abd=!1;this.nh=this.Rm=this.Yt=this.Nk=null;this.vUg=this.D_=0;this.da=z;this.YH=C;this.icb=D;this.ys=J;this.xR=!!this.control.floatingObject&&5===this.control.floatingObject.type&&l.a.xR(this.control.floatingObject.nh);this.aOa()}fzh(B){this.addHandler("KeyboardAdjustFinished",B)}Fjk(B){this.removeHandler("KeyboardAdjustFinished",B)}Omd(B){this.addHandler("KeyboardResize",B)}nge(B){this.removeHandler("KeyboardResize",B)}ezh(B){this.addHandler("KeyboardAdjust",
B)}Ejk(B){this.removeHandler("KeyboardAdjust",B)}hzh(B){this.addHandler("KeyboardRotate",B)}Hjk(B){this.removeHandler("KeyboardRotate",B)}get iya(){return this.U0a||this.F0a}get U0a(){return this.Abd}get F0a(){return this.kbd}get control(){return this.YH}get viewBlockContainerHelpers(){return this.icb}get Z4d(){return this.UPe}set Z4d(B){this.UPe=t.i(B,this.nh?this.nh.FlipX!==this.nh.FlipY:!1)}get ule(){return this.lhd||(this.lhd=e.a.instance.create(()=>{this.mNc(!1)},1E3,w.a.o7i,!1))}get absoluteRotation(){return this.Z4d+
this.D_}get p0b(){return this.control.BB.offsetTop}get o0b(){return this.control.BB.offsetLeft}dispose(){c.a.Ng(this.lhd);this.da=null;super.dispose()}n5d(B){this.TVc(!1);let z=0,C=0;switch(B){case 2:C=-1;break;case 3:C=1;break;case 0:z=this.da.rtl?1:-1;break;case 1:z=this.da.rtl?-1:1}b.a(this.Yt,z,C);this.update();this.raiseEvent("KeyboardAdjust",new n(z,C,z,C,!1,!1));this.ule.qA()}rotate(B){if(!this.control.extension.dyb||this.iya)this.TVc(!0),this.control.extension.Via(l.a.WLa(this.D_+15*(B?-1:
1)),!0),this.update(),this.raiseEvent("KeyboardRotate",null),this.ule.qA()}resize(B,z,C,D){if(!this.control.extension.dyb||this.iya){this.TVc(!1);var J=!1;this.nh&&(J=l.a.vaa(this.nh.Rotation,this.nh.FlipX!==this.nh.FlipY));if(B&1&&!J||B&2&&J)D=v.xEf(this.Yt.width,k.a.minWidth,D),this.Yt.topLeft.x-=D,this.Yt.bottomRight.x+=D;if(B&1&&J||B&2&&!J)B=v.xEf(this.Yt.height,k.a.minHeight,C),this.Yt.topLeft.y-=B,this.Yt.bottomRight.y+=B;this.update();this.raiseEvent("KeyboardResize",new d.a(this.Yt.width,
this.Yt.height,!1,!1));z||this.ule.qA()}}update(){const {FloatingObjectControlExtension:B}=a(945);if(this.Yt){const z=this.Yt,C=z.topLeft,D=this.Rm.ow;b.a(z,C.x<-D.x?D.x-C.x:0,C.y<-D.y?D.y-C.y:0);this.Rm=B.Tnd(z,this.Nk,this.Rm,this.control,!1);this.viewBlockContainerHelpers.HLg(this.Rm,this.control.domElement,z,!1);this.control.$da()&&this.Uqa(z,this.control)}}aOa(){this.Rm=this.control.fm;this.D_=0;this.ys&&this.ys.clear()}O3b(B){this.iya&&this.mNc(void 0===B?!1:B);this.Yt=null}upgrade(B){if(null===
B||void 0===B?0:B.nh)this.nh=B.nh,this.Z4d=this.nh.Rotation,this.D_=0}Via(B){this.D_=B}TVc(B){this.iya||(this.Nk=this.viewBlockContainerHelpers.Lfa(this.Rm,this.control.domElement),this.Yt=this.Nk.clone());(B&&!this.U0a||!B&&!this.F0a)&&this.Zsg(B)}Zsg(B){B?(this.Abd=!0,this.vUg=this.absoluteRotation):this.kbd=!0;this.Rm=this.control.fm;this.control.clientVersion++;u.c(this.control.$,!1,"ImageKeyboardAdjustBehavior:PrepareForKeyboardOperation")}mNc(B){this.iya&&(this.U0a&&(this.Abd=!1,this.dXh()),
this.F0a&&(this.kbd=!1,this.bXh(B)),u.c(this.control.$,!0,"ImageKeyboardAdjustBehavior:OnKeyboardOperationTimerFinish"))}Uqa(B,z){z.BB&&(this.nh&&this.nh.IsShapeGC2ModelRendered?(this.U0a&&this.control.extension.updateTransformDuringOperation(null,null,!1,!1,this.nh.Rotation+l.a.WLa(this.D_)),this.F0a&&(l.a.vaa(this.nh.Rotation,this.nh.FlipX!==this.nh.FlipY)?this.control.extension.updateTransformDuringOperation(B.height,B.width,!1,!1,null):this.control.extension.updateTransformDuringOperation(B.width,
B.height,!1,!1,null))):(this.U0a&&this.Owh(),this.F0a&&this.Nwh(B),this.bFh(),this.F0a&&(this.nh&&this.nh.IsShapeGC2ModelRendered||this.ys.removeAt(this.ys.count-1)),this.U0a&&this.ys.removeAt(this.ys.count-1)),B=t.c(this.absoluteRotation),t.l(Sys.UI.DomElement.getBounds(z.Uv.parentNode),z.UM,B,z.fm.rtl))}Nwh(B){let z,C;this.xR?(z=this.Nk.width?B.width/this.Nk.width:1,C=this.Nk.height?B.height/this.Nk.height:1):(z=B.width/(this.Nk.width?this.Nk.width:1),C=B.height/(this.Nk.height?this.Nk.height:1));
this.Nie=this.XJf(B,z,C,this.absoluteRotation,!1);this.ys.add(this.Nie)}Owh(){this.Cje=this.XJf(this.Nk,1,1,this.absoluteRotation-this.vUg,!0);this.ys.add(this.Cje)}XJf(B,z,C,D,J){var W=this.Rm.rtl;const N=new Sys.UI.Point(this.Nk.x+this.o0b-(W?B.width:0),this.Nk.y+this.p0b),M=new Sys.UI.Point(this.Nk.x-(W?B.width:0)+this.Nk.width/2,this.Nk.y+this.Nk.height/2),Q=t.g(M,N,this.absoluteRotation,z,C);J?(W=M.x-N.x,B=M.y-N.y):(W=M.x-Q.x+(B.width-this.Nk.width)/2,B=M.y-Q.y+(B.height-this.Nk.height)/2);return new m.a(z,
C,W,B,D,J)}bFh(){t.m(this.control.BB,0,0,this.ys)}dXh(){this.control.Yxa()&&this.ys.add(this.Cje);this.control.extension.Jqb(this.nh.Rotation+this.D_)}bXh(B){this.control.$da()&&this.ys.add(this.Nie);var z=this.Nk;let C=this.Yt;this.nh&&l.a.vaa(this.absoluteRotation,this.nh.FlipX!==this.nh.FlipY)&&(z=this.Nk.kOb(),C=this.Yt.kOb());const D=C.topLeft.x-z.topLeft.x,J=C.bottomRight.x-z.bottomRight.x,W=C.topLeft.y-z.topLeft.y;z=C.bottomRight.y-z.bottomRight.y;this.nh&&l.a.xR(this.nh)?this.raiseEvent("KeyboardAdjustFinished",
new r.a(D,W,J,z,!1,!1,this.Rm,100,null,-1,2)):this.raiseEvent("KeyboardAdjustFinished",new f.a(D,W,J,z,!1,!1,this.Rm,B))}static xEf(B,z,C){C=Math.round(B*C);C=Math.max(C,z);return Math.round((C-B)/2)}}Object(y.a)(v,"ImageKeyboardAdjustBehavior",x.a,[840])},1417:function(y,x,a){a.r(x);a.d(x,"ChartAboveGridFloatingObjectControl",function(){return t});y=a(0);x=a(1043);var c=a(68),b=a(55),f=a(77),r=a(1079),d=a(16),k=a(136);class t extends x.ChartFloatingObjectControl{constructor(m,e,w,l,u){super(m,e,
l,u,k.a.U3d,!1);this.bga=this.q0=null;this.uL=m.ll;this.nR=null;this.KCb=w;this.dN(e);this.sZ(c.l,!0);this.isVisible=!1}get grid(){return this.uL}get o5(){if(f.b(this.$.na))return this.q0||(this.q0=new b.a(this.da.ps,this.da.XB)),this.q0;this.bga||(this.bga=new b.a(this.da.ps,this.da.XB));return this.bga}get Ch(){return this.KCb}get fm(){this.nR||(this.nR=d.DOMElementExtensions.getLocation(this.grid));const m=d.DOMElementExtensions.getLocation(this.get_element());return r.a(this,new b.a(m.x-this.nR.x,
m.y-this.nR.y))}dispose(){this.nR=this.uL=null;super.dispose()}sRd(m){r.b(this,m)}hide(){this.isVisible=!1}p5b(m,e){r.c(this,m,e)}Y7b(){return!1}x6b(){return!1}vie(){f.b(this.$.na)&&(this.q0=null)}}Object(y.a)(t,"ChartAboveGridFloatingObjectControl",x.ChartFloatingObjectControl,[735,440,2,736])},1418:function(y,x,a){a.r(x);a.d(x,"GC2AboveGridFloatingObjectControl",function(){return t});y=a(0);x=a(976);var c=a(68),b=a(55),f=a(77),r=a(1079),d=a(16),k=a(136);class t extends x.GC2FloatingObjectControl{constructor(m,
e,w,l){super(m,e,l,k.a.U3d,!1);this.bga=this.q0=null;this.uL=m.ll;this.nR=null;this.KCb=w;this.dN(e);this.sZ(c.l,!0);this.isVisible=!1}get grid(){return this.uL}get o5(){if(f.b(this.$.na))return this.q0||(this.q0=new b.a(this.da.ps,this.da.XB)),this.q0;this.bga||(this.bga=new b.a(this.da.ps,this.da.XB));return this.bga}get Ch(){return this.KCb}get fm(){this.nR||(this.nR=d.DOMElementExtensions.getLocation(this.grid));const m=d.DOMElementExtensions.getLocation(this.get_element());return r.a(this,new b.a(m.x-
this.nR.x,m.y-this.nR.y))}dispose(){this.nR=this.uL=null;super.dispose()}sRd(m){r.b(this,m)}p5b(m,e){r.c(this,m,e)}hide(){this.isVisible=!1}vie(){f.b(this.$.na)&&(this.q0=null)}Y7b(){return!1}x6b(){return!1}aLd(){return"@G"}onAutoFitResize(m,e){k.a.vaa(this.floatingObject.nh.Rotation,!1)?this.Ch.extension.tmc(m,e):this.Ch.extension.tmc(e,m)}onEditStatusChanged(m){m||this.Ch.extension.bP.O3b(!0);super.onEditStatusChanged(m)}}Object(y.a)(t,"GC2AboveGridFloatingObjectControl",x.GC2FloatingObjectControl,
[735,440,2,736])},1419:function(y,x,a){x=a(476);a=a(1420);a=a.kv?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);x(a,{insert:"head",AC:!1});y.exports=a.oH||{}},1420:function(y,x,a){x=a(477)(!1);x.push([y.i,".ewa-root-rtl .ewa-fo-img-div{direction:rtl}",""]);y.exports=x},1494:function(y,x,a){a.r(x);a.d(x,"MultiPanesFloatingObjectControlExtension",function(){return B});y=a(0);var c=a(14),b=a(158),f=a(945),r=a(71),d=a(55),k=a(905),t=a(906),m=a(1358),e=a(1214);class w extends e.a{constructor(z,C){super(z,
C);this.wY=(D,J)=>{J.JT.xKb(this.floatingObject)};this.control=z;this.floatingObject=C;for(const D of this.Ch.children)D.xKb(C);this.Ch.$Fb(this.wY)}get Ch(){return Object(b.a)(t.a,this.control)}dispose(){for(const z of this.Ch.children)z.jtc();this.Ch.Pfe(this.wY);super.dispose()}update(z){for(const C of this.Ch.children)e.a.M2g(C,z)}}Object(y.a)(w,"MultiPanesImageConnectableManager",e.a,[]);var l=a(1009);class u extends l.a{constructor(z,C,D,J,W,N,M){super(z,C,D,J,W,void 0===N?null:N,void 0===M?
null:M)}get Ch(){return Object(b.a)(t.a,this.control)}dispose(){super.dispose()}y7a(z,C){this.n7||(this.Rm=this.Ch.fm,this.Nk=this.ml(),this.Ch.OOa(this.Nk),this.Wme(z,C),this.Bia=this.jPb(z),this.raiseEvent(l.a.Q3b),this.resize(z,!0))}resize(z,C){this.N9=z;z=this.jPb(z);z=k.a.MP(z,this.Bia);this.Snd(z);const D=this.Ch.pj;this.Lie(C,z.x,z.y,D.o5.x,D.o5.y,!1)}mfa(){this.Rm=this.Ch.pj.fm;super.mfa()}pne(z){this.Ch.pj.p5b(z,!1)}ml(){const z=k.a.IO(new d.a(0,0),this.Ch.pj.grid,this.Ch.domElement,this.da.rtl);
return new r.a(z.x,z.y,this.Ch.domElement.clientWidth,this.Ch.domElement.clientHeight)}m7(z){const C=this.Ch.pj;if(null===C||void 0===C?0:C.isVisible)this.x5a(C,z);else for(const D of this.Ch.children)this.x5a(D,z)}jPb(z){return k.a.Ny(new d.a(0,0),this.Ch.pj.grid,z,this.Rm.rtl)}}Object(y.a)(u,"MultiPanesImageResizableBehavior",l.a,[]);x=a(1387);var n=a(426);class v extends x.a{constructor(z,C,D,J){super(z,C,D,J)}get Ch(){return Object(b.a)(t.a,this.control)}w5a(){const z=this.Ch.pj;if(null===z||
void 0===z?0:z.isVisible)this.wie(z);else for(const C of this.Ch.children)this.wie(C)}Rre(z){super.Rre(z);this.Ch.OOa(this.wBi());this.Ch.SBa(!1)}wBi(){const z=this.Ch.pj,C=this.viewBlockContainerHelpers.Lfa(this.Ch.fm,this.Ch.domElement),D=n.a.KO(this.Ch.fm.paneType,this.Ch.fm.view.Xm);return new r.a(C.x-D.x+this.Ch.fm.ow.x+z.o5.x,C.y-D.y+this.Ch.fm.ow.y+z.o5.y,C.width,C.height)}}Object(y.a)(v,"MultiPanesImageRotatableBehavior",x.a,[]);class B extends f.FloatingObjectControlExtension{constructor(z,
C){super(z,C);this.wY=(D,J)=>{m.h(this,J)};this.UZb=(D,J)=>{m.i(this,J)};m.g(this.Ch,this.wY,this.UZb)}get Ch(){return Object(b.a)(t.a,this.control)}dispose(){m.f(this.Ch,this.wY,this.UZb);super.dispose()}Jqb(z){super.Jqb(z);this.wGg(z)&&(this.Ch.isVisible=!0,this.HEg())}startEdit(){const z=k.a.IO(new d.a(0,0),this.Ch.pj.grid,this.Ch.domElement,this.Ch.da.rtl);this.Ch.OOa(new r.a(z.x,z.y,this.Ch.domElement.clientWidth,this.Ch.domElement.clientHeight));this.Ch.pj.startEdit()}endEdit(){this.Ch.pj.endEdit()}Nwa(z,
C){const D=k.a.IO(new d.a(0,0),this.Ch.pj.grid,this.Ch.domElement,this.Ch.da.rtl);this.Ch.OOa(new r.a(D.x,D.y,this.Ch.domElement.clientWidth,this.Ch.domElement.clientHeight));this.Ch.pj.handleCommand(z,C)}dBc(z,C){if(this.control.floatingObject.paa){const D=k.a.IO(new d.a(0,0),this.Ch.pj.grid,this.Ch.domElement,this.Ch.da.rtl);this.Ch.OOa(new r.a(D.x,D.y,this.Ch.domElement.clientWidth,this.Ch.domElement.clientHeight));this.Ch.pj.handleCommand(z,C)}else c.ULS.sendTraceTag(507527238,306,15,"FloatingObjectControlExtension: Not a GC2 FOC = {0}",
this.control.floatingObject.fi)}handleQueryCommand(z,C){this.Ch.pj.handleQueryCommand(z,C)}updateTransformDuringOperation(z,C,D,J,W){this.Ch.pj.updateTransformDuringOperation(z,C,D,J,W)}updateTransformResizeEnded(z,C){this.Ch.pj.updateTransformResizeEnded(z,C)}shouldShowFloatie(z,C){return this.Ch.pj.shouldShowFloatie(z,C)}qxd(){m.d(this,this.Ch)}Dwd(){m.a(this,this.Ch)}Ywd(){m.c(this,this.Ch)}wWa(){this.Ch.movable&&(this.rq=new u(this.Ch.domElement,this.Ch.da,this.Ch,this.ys,f.FloatingObjectControlExtension.ZW,
f.FloatingObjectControlExtension.viewBlockContainerHelpers),this.ORc())}nxd(){this.AVb()&&(this.Jv=new v(this.Ch.domElement,this.Ch,this.ys,f.FloatingObjectControlExtension.viewBlockContainerHelpers))}Wwd(){m.b(this)}uxd(){m.e(this)}Awd(z){this.Lfb=new w(this.Ch,z)}S7d(){m.j(this.Ch)}x_b(z,C){super.x_b(z,C);m.k(this,this.Ch,C)}Qia(){m.l(this,this.Ch)}gFd(){}}Object(y.a)(B,"MultiPanesFloatingObjectControlExtension",f.FloatingObjectControlExtension,[])},1501:function(y,x,a){a.r(x);a.d(x,"MultiPanesConnectorFloatingObjectControlExtension",
function(){return n});y=a(0);var c=a(158);x=a(1222);var b=a(945),f=a(1223),r=a(68),d=a(71),k=a(55),t=a(905),m=a(1009),e=a(906),w=a(16);class l extends f.a{constructor(v,B,z,C,D,J,W,N){super(v,B,z,C,D,J,void 0===W?null:W,void 0===N?null:N)}get Uv(){const v=this.Ch.pj;return v?v.Uv:null}get control(){const v=this.Ch.pj;return(null===v||void 0===v?0:v.isVisible)?v:this.Ch}get Ch(){return Object(c.a)(e.a,super.control)}dispose(){super.dispose()}y7a(v,B){this.n7||(this.m7(null),this.Rm=this.Ch.fm,this.Nk=
this.ml(),this.Ch.OOa(this.Nk),this.JWa=this.Ch.pj.UM.find(z=>z.index===this.JWa.index),this.zib=this.RTc()?this.Eua:this.wla,this.jOb=Sys.UI.DomElement.getBounds(this.zib.domElement),this.Wme(v,B),this.Bia=this.jPb(v),this.raiseEvent(m.a.Q3b),this.resize(v,!0),this.Ewd(),this.ugb=this.Ch.BB,w.DOMElementExtensions.setVisible(this.ugb,!1),w.DOMElementExtensions.setVisible(this.Uv,!0),w.DOMElementExtensions.zBa(this.Kwa,!0,r.A,r.m))}resize(v,B){this.N9=v;this.dG=this.jPb(v);const z=t.a.MP(this.dG,this.Bia);
this.Snd(z);const C=this.Ch.pj;this.dG=t.a.MP(this.dG,C.o5);const D=this.da.Zk(this.da.Pg.gQi(this.dG));this.dG=this.viewBlockContainerHelpers.Ny(D,v,!1);this.dG=t.a.add(this.dG,D.ow);this.dG.x=Math.max(this.dG.x,0);this.dG.y=Math.max(this.dG.y,0);this.Lie(B,z.x,z.y,C.o5.x,C.o5.y,!1);this.lfa&&!this.aHc&&this.i3g()}mfa(){this.Rm=this.Ch.pj.fm;super.mfa()}pne(v){this.Ch.pj.p5b(v,!1)}ml(){const v=t.a.IO(new k.a(0,0),this.Ch.pj.grid,this.Ch.domElement,this.da.rtl);return new d.a(v.x,v.y,this.Ch.domElement.clientWidth,
this.Ch.domElement.clientHeight)}m7(v){this.qtd();const B=this.Ch.pj;B&&this.x5a(B,v);for(const z of this.Ch.children)this.x5a(z,v)}i$(){this.Ch.i$(this)}jPb(v){return t.a.Ny(new k.a(0,0),this.Ch.pj.grid,v,this.Rm.rtl)}set Uv(v){super.Uv=v}set control(v){super.control=v}}Object(y.a)(l,"MultiPanesConnectorResizableBehavior",f.a,[]);var u=a(1358);class n extends x.ConnectorFloatingObjectControlExtension{constructor(v,B){super(v,B);this.wY=(z,C)=>{u.h(this,C)};this.UZb=(z,C)=>{u.i(this,C)};u.g(this.Ch,
this.wY,this.UZb)}get Ch(){return Object(c.a)(e.a,this.control)}dispose(){u.f(this.Ch,this.wY,this.UZb);super.dispose()}qxd(){u.d(this,this.Ch)}Dwd(){u.a(this,this.Ch)}Ywd(){u.c(this,this.Ch)}wWa(){this.Ch.movable&&(this.rq=new l(this.Ch.domElement,null,this.Ch.da,this.Ch,this.ys,b.FloatingObjectControlExtension.ZW,b.FloatingObjectControlExtension.viewBlockContainerHelpers),this.ORc())}nxd(){}Wwd(){u.b(this)}uxd(){u.e(this)}S7d(){u.j(this.Ch)}x_b(v,B){super.x_b(v,B);u.k(this,this.Ch,B)}Qia(){u.l(this,
this.Ch)}gFd(){}}Object(y.a)(n,"MultiPanesConnectorFloatingObjectControlExtension",x.ConnectorFloatingObjectControlExtension,[])},359:function(y,x,a){a.r(x);var c={};a.r(c);a.d(c,"MOEFloatingObjectCommandHandler",function(){return B});var b={};a.r(b);a.d(b,"BehaviorsFactory",function(){return bb});var f={};a.r(f);a.d(f,"ChartElementSelectableBehaviorManager",function(){return Wb});var r={};a.r(r);a.d(r,"FloatingObjectCommandHandler",function(){return Aa});var d={};a.r(d);a.d(d,"InkCommandHandler",
function(){return qc});var k={};a.r(k);a.d(k,"LoadBlockingFloatingObjectsCommandHandler",function(){return bd});var t={};a.r(t);a.d(t,"LoadBlockingFloatingObjectsTaskPane",function(){return oe});var m=a(179),e=a(0),w=a(209),l=a(24),u=a(66),n=a(5),v=a(97);let B=class{constructor(Qb){this.$=Qb}Bi(){return!1}executeCommand(Qb,Xc){Xc=Xc.command;if(16!==Qb)return w.a(Xc);Qb=l.f(this.$).ha.$e.yh;switch(Xc){case 1872288872:return u.Task.Va(Qb.YYc());case 267796030:return u.Task.Va(Qb.startEdit());default:return w.a(Xc)}}ni(Qb,
Xc){return 16===Qb&&(267796030===Xc.command||1872288872===Xc.command)}Ji(){return!1}};B=Object(m.__decorate)([Object(v.d)(n.g),Object(m.__param)(0,Object(n.Lb)())],B);Object(e.a)(B,"MOEFloatingObjectCommandHandler",null,[39]);var z=a(105);class C extends z.a{constructor(Qb){super(document.createElement("div"));this.ONa=Qb}}Object(e.a)(C,"ResizePointBehaviorBase",z.a,[774,68,2]);class D extends C{constructor(Qb,Xc,md){super(Qb);this.Ap=Xc;this.domElement.style.position="absolute";Qb=document.createElementNS("http://www.w3.org/2000/svg",
"svg");Qb.setAttribute("xmlns","http://www.w3.org/2000/svg");Qb.setAttribute("version","1.1");Qb.setAttribute("overflow","visible");Qb.setAttribute("width","12");Qb.setAttribute("height","12");Xc=document.createElementNS("http://www.w3.org/2000/svg","circle");Xc.setAttribute("style","pointer-events: all; cursor: crosshair;");Xc.setAttribute("r","4");Xc.setAttribute("stroke-width","1");Xc.setAttribute("id","svgCircleId");Qb.appendChild(Xc);this.domElement.appendChild(Qb);this.wbf=this.getElementById("svgCircleId");
this.u5b(md)}get index(){return this.Ap}u5b(Qb){const Xc=Qb?"green":"white";this.wbf.setAttribute("stroke",Qb?"white":"grey");this.wbf.setAttribute("fill",Xc)}}Object(e.a)(D,"ConnectorResizePointBehavior",C,[776,774,68,2]);var J=a(100),W=a(380),N=a(154),M=a(17),Q=a(68),R=a(71),O=a(55),U=a(1077),K=a(59),F=a(19),I=a(1);const P=(Qb,Xc,md)=>1===md?Qb?Q.Y:Q.W:(Qb?[Q.R,Q.T,Q.Z,Q.X,Q.U,Q.V,Q.Q,Q.S]:[Q.R,Q.S,Q.Q,Q.V,Q.U,Q.X,Q.Z,Q.T])[Xc],Y=F.a.wNb,ea=F.a.oUh,Ba=F.a.bni,Fa=F.a.nUh,za=F.a.Gmi;class xa extends C{constructor(Qb,
Xc,md,ie){super(Xc);let me;const Pe=I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FOResizeHandlesFix",!1);if(Pe||U.a(Xc)||md){var gf=ea;me=1===ie?za:Y}else gf=Fa,me=Ba;Qb=P(Qb,Xc,ie);this.domElement.className=Pe?`${Q.u} ${Qb} ${gf}`:`${md?Q.v:Qb} ${gf}`;md=K.a.$m(1);gf=document.createElement("img");gf.classList.add(me);gf.src=md;gf.draggable=!1;this.domElement.appendChild(gf)}}Object(e.a)(xa,"ResizePointBehavior",C,[]);var fa=a(16);const V=Q.ab,ba=Q.bb;class la extends C{constructor(Qb,
Xc,md,ie){super(md);this.domElement.className=V;fa.DOMElementExtensions.zBa(this.domElement,ie,Q.w,P(Xc,md,0));this.domElement.classList.add(Xc&&!ie?Q.db:Q.cb);Xc=this.domElement.appendChild(document.createElement("div"));Xc.className=ba;Xc.style.borderColor=Qb;if(U.a(md)||ie)Xc.style.borderRadius="50%"}}Object(e.a)(la,"TouchResizePointBehavior",C,[]);var Ta=a(69),Ea=a(905),sa=a(1024);class Ya extends z.a{constructor(Qb,Xc,md){super(Qb);this.Kie=this.n7=!1;this.ZSe=this.dG=this.Bia=this.Nk=null;this.onKeyDown=
ie=>ie.La.shiftKey&&ie.La.keyCode>=J.a.cQa&&ie.La.keyCode<=J.a.$Ba?(this.fsj(ie),!0):!1;this.da=Xc;this.domElement.classList.add(Q.lb);this.mxd(md);this.n6e()}get Mie(){return this.ZSe}dispose(){this.da=null;this.Kie&&(W.a.instance.Qia(this.Mie.domElement,this),N.a.instance.Na(M.a.zi,this.domElement,this.onKeyDown),this.Kie=!1);this.domElement.classList.remove(Q.lb);super.dispose()}yna(Qb){return Qb.mw!==Sys.UI.MouseButton.middleButton}aza(){this.mfa()}bza(){this.mfa()}cza(Qb){this.V$f(Qb.clientPoint);
return!0}b3a(Qb){if(!this.yna(Qb))return!1;this.y7a(Qb.clientPoint);return!0}y7a(Qb){this.n7||(this.n7=!0,this.Nk=this.ml(),this.Bia=this.eGf(Qb,this.da.rtl),this.V$f(Qb))}mfa(){this.n7=!1;this.dG=this.Bia=this.Nk=null}l1e(Qb){this.addHandler("ResizeRequestedEvent",Qb)}fkk(Qb){this.removeHandler("ResizeRequestedEvent",Qb)}ml(){const Qb=new O.a(0,0);return new R.a(Qb.x,Qb.y,this.domElement.clientWidth,this.domElement.clientHeight)}eGf(Qb,Xc){const md=new O.a(0,0);return Ea.a.Ny(md,this.domElement,
Qb,Xc)}gEg(Qb){this.raiseEvent("ResizeRequestedEvent",new sa.a(this.Nk.width+Qb.x,this.Nk.height+Qb.y,!1,!1))}V$f(Qb){this.dG=this.eGf(Qb,this.da.rtl);Qb=Ea.a.MP(this.dG,this.Bia);this.gEg(Qb)}fsj(Qb){this.Nk=this.ml();let Xc=0,md=0;if(!(!Qb.La.shiftKey||Qb.La.keyCode<J.a.cQa||Qb.La.keyCode>J.a.$Ba)){if(Qb.La.keyCode===J.a.$Ba)md+=10;else if(Qb.La.keyCode===J.a.U8a)md-=10;else if(!this.da.rtl&&Qb.La.keyCode===J.a.eyb||this.da.rtl&&Qb.La.keyCode===J.a.cQa)Xc+=10;else if(!this.da.rtl&&Qb.La.keyCode===
J.a.cQa||this.da.rtl&&Qb.La.keyCode===J.a.eyb)Xc-=10;Qb=new O.a(Xc,md);this.gEg(Qb)}}n6e(){this.domElement.appendChild(this.Mie.domElement)}mxd(Qb){this.ZSe=this.Yqc(3,Qb);W.a.instance.Cba(this.Mie.domElement,this);N.a.instance.ya(M.a.zi,this.domElement,this.onKeyDown);this.Kie=!0}Yqc(Qb,Xc){const md=this.da.rtl;return 3===Ta.a.eh?new la(this.domElement.style.borderTopColor,md,Qb,!1):new xa(md,Qb,!1,Xc)}}Object(e.a)(Ya,"ResizableBehavior",z.a,[123,775,2]);let bb=class{wWa(Qb,Xc,md){return new Ya(Qb,
Xc,md)}x5h(Qb,Xc,md){return new xa(Qb,Xc,md,0)}M6h(Qb,Xc,md,ie){return new la(Qb,Xc,md,ie)}o1h(Qb,Xc,md){return new D(Qb,Xc,md)}};bb=Object(m.__decorate)([Object(v.d)(n.x)],bb);Object(e.a)(bb,"BehaviorsFactory",null,[759]);var ra=a(1005),Da=a(993),oa=a(14),Ha=a(6),ka=a(67),wa=a(96),Za=a(286),ab=a(399),db=a(302),mb=a(81),Ia=a(7),pa=a(654),lb=a(684),ha=a(212),ua=a(62),fb=a(86),Ka=a(74),La=a(595),ib=a(992);class Yb extends z.a{constructor(Qb,Xc,md,ie,me,Pe){super(Qb);this.id=this.Mcc=this.ooc=this.bA=
this.XJa=this.zla=null;this.btd=this.ctd=this.version=0;this.b8b=this.Cbb=this.Mva=this.oPb=null;this.KWa=-1;this.Qxd="";this.nFe=null;this.Kzb=0;this.ji=null;this.MPj=gf=>{this.qfe();this.nFe=gf.Result;this.cO&&(this.Fdk(),this.v3k());this.oPb=null};this.NPj=()=>{this.bYe()};this.TZb=gf=>{gf.mw!==Sys.UI.MouseButton.middleButton&&3!==gf.oh&&this.selectChartElement(gf.Qh);return!1};this.hp=gf=>{this.sxa&&this.selectChartElement(gf.Qh);void v.a.resolve(n.R,{va:0}).then(tf=>{tf.KDc(this.Ki,gf.oh,gf)});
return!0};this.Fv=()=>{this.BTb()||this.W0c(null)};this.o_b=gf=>{this.$Zb(gf,Sys.EventArgs.Empty);this.XJa&&fa.DOMElementExtensions.setVisible(this.XJa,!1)};this.$Zb=()=>{const gf=this.tvf;gf&&gf.jD();this.W0c(null)};this.fgg=()=>{this.DRc()};this.cgg=()=>{this.DRc()};this.eS=gf=>{Ka.g(gf)};this.CY=gf=>{this.KSd(this.Txc(gf.target))&&(this.domElement.style.cursor="pointer");Ka.g(gf)};this.BY=gf=>{this.domElement.style.cursor="";Ka.g(gf)};this.fj=gf=>{let tf=!1;if(2===gf.oh&&gf.La.button===Sys.UI.MouseButton.leftButton||
2!==gf.oh)tf=this.GQc(gf.Qh,gf.clientPoint,gf.oh),this.sxa&&(tf=this.selectChartElement(gf.Qh)||tf);tf||this.zla||!this.sxa||3!==gf.oh||void v.a.resolve(n.R,{va:0}).then(Qe=>{Qe.KDc(this.Ki,gf.oh,gf)});return tf};this.iNj=gf=>{Ka.g(gf);this.Aug(gf.target)};this.Feg=gf=>{this.Aug(gf.Qh);return!0};this.$=md;this.Ki=ie;this.VIb=Xc;this.ji=Pe;this.sxa=md.isEditMode&&I.EwaSettings.Ra(16);if(Qb=this.zla=me)Qb.oii(),Qb.l$&&(Qb.l$.C0e(this.$Zb),Qb.l$.B0e(this.fgg),Qb.l$.A0e(this.cgg)),Qb.Jtb&&Qb.Jtb.lnd(this.$Zb),
Qb.bP&&Qb.bP.Omd(this.o_b);l.f(md).KN(this.Fv)}Qyh(Qb){this.addHandler("ImageElementSelectionChanged",Qb)}qjk(Qb){this.removeHandler("ImageElementSelectionChanged",Qb)}get cO(){return this.nFe}get IG(){return this.Kzb}get Vpa(){return this.Cbb||(this.Cbb=Da.ChartElementManager.mHi(this.poc))}set Vpa(Qb){this.nxe(Qb,!0)}get poc(){return this.cO?this.cO.ChartElementInfoItems:null}get tvf(){return this.Mcc||(this.Mcc=pa.b(this.$))}dispose(){if(this.$){var Qb=l.f(this.$);(null===Qb||void 0===Qb?0:Qb.ha)&&
Qb.vP(this.Fv)}this.$=this.Mcc=null;if(Qb=this.zla)Qb.l$&&(Qb.l$.LBg(this.$Zb),Qb.l$.KBg(this.fgg),Qb.l$.JBg(this.cgg)),Qb.Jtb&&Qb.Jtb.qCg(this.$Zb),Qb.bP&&Qb.bP.nge(this.o_b),this.zla=null;this.qfe();this.bA=this.XJa=null;this.bYe();this.ji=null;super.dispose()}Vnk(Qb){this.bA=Qb.bA;this.id=Qb.chartId;this.version=Qb.Maf;this.ctd=Qb.o9e.width;this.btd=Qb.o9e.height;this.Kzb=0;this.pOa()}Yhe(Qb){this.bA=Qb.FWa;this.id=Qb.floatingObject.id;this.version=Qb.floatingObject.version;this.ctd=Qb.floatingObject.width;
this.btd=Qb.floatingObject.height;this.Kzb=Qb.floatingObject.IG;this.pOa()}bYe(){this.oPb&&(Ha.AFrameworkApplication.$i.HD(this.oPb.TC),this.oPb=null)}ghk(){this.qfe()}Zle(Qb){this.Ki=Qb}Fdk(){I.EwaSettings.Ra(16)&&this.Cbb&&this.nxe(Da.ChartElementManager.YBf(Da.ChartElementManager.lJf(this.Cbb),this.poc),!1)}nxe(Qb,Xc){this.Cbb!==Qb&&(this.Cbb=Qb,Xc&&this.DRc(),this.$.jm(),this.raiseEvent("ImageElementSelectionChanged"))}pOa(){const Qb=this.$.pa.ta.Jh();this.oPb=ib.d(this.$.pa.ta,this.$.$h,this.id,
this.version,this.ctd,this.btd,this.MPj,this.NPj,null,Qb,this.sxa)}v3k(){if(this.bA&&this.bA.parentNode){var Qb=this.XJa;Qb||(Qb=this.XJa=document.createElement("div"));Qb.title=this.bA.title;var Xc=null;this.cO.ContentHTML&&(this.ji.hr(Qb,this.cO.ContentHTML),this.Mva=ka.a.NDf(Qb,"map"),(Xc=this.b8b=ka.a.NDf(Qb,"svg"))&&this.Mva&&(Qb.removeChild(this.Mva),this.Mva=null));wa.a.Ng(this.ooc);if(Xc)fa.DOMElementExtensions.Oub(Xc,new Sys.UI.Bounds(0,0,this.bA.offsetWidth,this.bA.offsetHeight),this.$.isChromeRtl),
Za.a.instance.ya(M.a.click,Xc,this.fj),Za.a.instance.ya(M.a.sr,Xc,this.Feg),!this.sxa&&this.VIb||ab.a.instance.ya(Xc,this.hp),this.sxa&&db.a.instance.ya(M.a.Zi,Xc,this.TZb);else{const md=this.ooc=this.Xk.Ek(this.Mva);md.Aa("mousemove",this.eS);md.Aa("mouseout",this.BY);md.Aa("mouseover",this.CY);md.Aa("dblclick",this.iNj);Za.a.instance.ya(M.a.click,this.Mva,this.fj)}this.bA.parentNode.appendChild(Qb);this.bA.setAttribute("usemap","#"+this.cO.ImagemapId);this.DRc();this.domElement&&(this.domElement.style.cursor=
"");!Xc&&this.zla&&this.zla.l$&&this.zla.l$.duh(Qb)}}qfe(){wa.a.Ng(this.ooc);this.ooc=null;this.W0c(null);if(this.XJa){this.Mva&&(Za.a.instance.Na(M.a.click,this.Mva,this.fj),this.Mva=null);const Qb=this.b8b;Qb&&(Za.a.instance.Na(M.a.click,Qb,this.fj),Za.a.instance.Na(M.a.sr,Qb,this.Feg),!this.sxa&&this.VIb||ab.a.instance.Na(Qb,this.hp),this.sxa&&db.a.instance.Na(M.a.Zi,Qb,this.TZb),this.b8b=null);fa.DOMElementExtensions.Km(this.XJa);this.XJa=null}}KSd(Qb){if(!Qb)return!1;switch(Qb.Type){case 1:return 260===
(this.Ki.Attributes&260)&&-1===Qb.SeriesIndex;case 3:return 388===(this.Ki.Attributes&388);default:return!0}}BTb(){return this.VIb?l.f(this.$).ha.$e.yh===this.zla.control:!0}DRc(){this.sxa&&this.BTb()&&(this.KWa=Da.ChartElementManager.UEi(this.Vpa,this.cO,this.Ki),this.M1g(-1===this.KWa?"":this.KWa.toString()))}W0c(Qb){let Xc=-1,md="",ie=!1;Qb&&(md=Qb.getAttribute(Ia.a.PRh),Xc=parseInt(Qb.getAttribute(Ia.a.wof),10));this.KWa!==Xc&&(this.KWa=Xc,ie=this.M1g(md),-1!==Xc&&this.nxe(Da.ChartElementManager.VEi(this.cO.ChartElementItems[Xc],
this.Ki,this.poc),!1));return ie}M1g(Qb){if(!this.b8b||this.Qxd===Qb)return!1;const Xc=this.b8b.childNodes;for(let md=0,ie=Xc.length;md<ie;md++){const me=Xc[md],Pe=me.getAttribute("id");Pe===this.Qxd?this.GYg(me,!1):Pe===Qb&&this.GYg(me,!0)}this.Qxd=Qb;return!0}GYg(Qb,Xc){Yb.NYg(Qb,Q.F,Q.G,Xc);const md=this.Ki.ChartCategory;(!Xc||-1===this.KWa||3!==this.cO.ChartElementItems[this.KWa].Type||9!==md&&15!==md)&&Yb.NYg(Qb,Q.D,Q.E,Xc)}selectChartElement(Qb){this.VIb&&!this.BTb()&&l.f(this.$).ha.$e.J1(this.zla.control);
return this.Txc(Qb)?this.W0c(Qb):!1}GQc(Qb,Xc,md){Qb=this.Txc(Qb);if(!this.KSd(Qb))return!1;const ie={};ie.ChartId=this.id;ie.AnchorValue1=Qb.CategoryIndex;ie.AnchorValue2=Qb.SeriesIndex;const me={};let Pe=null;if(Qb.CoordList){var gf=Sys.UI.DomElement.getBounds(this.bA);const tf=this.$.isChromeRtl?2:3;Pe=new Sys.UI.Point(Qb.CoordList[tf].X+gf.x,Qb.CoordList[tf].Y+gf.y)}gf=!1;switch(Qb.Type){case 4:ie.AnchorType=4;Xc=!!(this.Ki.Attributes&128);l.f(this.$).showPivotFilter(this.$.domElement,me,this.Ki.ExternalSourceIndex,
Qb.ValueString,Xc,!0,null,ie);gf=!0;break;case 5:case 6:this.$.Mq(me);ie.AnchorType=5===Qb.Type?5:6;const tf=Qe=>{Qe&&this.lOd(me,ie,Pe,md)};void v.a.resolve(n.qb,{va:1}).then(Qe=>{Qe.UL(64===(this.Ki.Attributes&64),tf)});gf=!0;break;case 1:case 3:case 2:this.tvf&&(this.Mcc.yug(Xc,this.id,this.Ki,Qb,this.IG),this.VIb&&l.f(this.$).ha.$e.J1(this.zla.control),gf=!0)}return gf}lOd(Qb,Xc,md,ie){ie=new fb.a(37023044,ie,this.$.Rh,0,null);ie.$Tb=!0;this.$.Ma.dh(ie,{["rawEvent"]:null,["pivotName"]:null,["cell"]:Qb,
["requiresConfirmation"]:64===(this.Ki.Attributes&64),["dataSourceIndex"]:this.Ki.ExternalSourceIndex,["domElement"]:this.bA,["objectId"]:this.id,["objectVersion"]:this.cO.Version,["location"]:md,["optionalPivotMenuAnchorParameter"]:Xc})}uei(Qb,Xc){const md=ie=>{if(ie){l.f(Qb).Cz(!0);const me={};Qb.Mq(me);me.FirstRow=-1;me.FirstColumn=-1;ie=new ha.a(161,0,(Pe,gf,tf)=>ua.K(Qb.pa.ta,me,this.Ki.ExternalSourceIndex,!0,!0,!0,!1,!1,Pe,gf,tf,null,Xc),6,()=>new lb.a(me,!1));Qb.userOperationManager.enqueueOperation(ie,
null)}};void v.a.resolve(n.qb,{va:1}).then(ie=>{ie.UL(!0,md)})}Aug(Qb){Qb=this.Txc(Qb);if(this.KSd(Qb)){var Xc=Qb.Type;if(1===Xc||2===Xc||3===Xc){var md={};md.ChartId=this.id;md.AnchorValue1=Qb.SeriesIndex;md.AnchorValue2=-1;switch(Xc){case 1:md.AnchorType=2;md.AnchorValue1=Qb.CategoryIndex;break;case 2:0<=Qb.SeriesIndex?md.AnchorType=1:(md.AnchorType=2,md.AnchorValue1=Qb.CategoryIndex);break;default:md.AnchorType=3,md.AnchorValue2=Qb.CategoryIndex}this.uei(this.$,md)}}}Txc(Qb){Qb=parseInt(Qb.getAttribute(Ia.a.wof),
10);return isNaN(Qb)?null:this.cO.ChartElementItems[Qb]}static pmc(Qb,Xc){const md=La.a(Qb);md&&(Yb.B7k(Qb,md.bA),md.bTk&&Yb.Roe(Qb,md.Ki)?(md.bO||(md.bO=new Yb(md.bA,!1,Qb,md.Ki,null,Xc)),md.Lmc=!1,md.bO.Vnk(md)):md.Lmc=!0)}static wHb(Qb,Xc){!Qb.bO&&Yb.Roe(Xc,Qb.floatingObject.Ki)&&(Qb.bO=new Yb(Qb.domElement,Qb.eG,Xc,Qb.floatingObject.Ki,Qb.extension,Qb.ji),(Xc=Qb.FWa)?fa.DOMElementExtensions.isVisible(Xc.parentNode)&&Qb.bO.Yhe(Qb):oa.ULS.shipAssertTag(537155043,5,Qb.OUd,"ChartElementSelectableBehavior.AttachFloatingObjectControl currentImageTagElement is null and lightweight placeholder does not exists. We are in unknown state."))}static Roe(Qb,
Xc){const md=Qb.th,ie=[2,17,1,0];return!!Xc&&md.allowInteractivity&&(260===(Xc.Attributes&260)&&md.allowPivotSpecificOperations||!ie.includes(Xc.ChartCategory)&&Qb.isEditMode&&I.EwaSettings.Ra(16))}static B7k(Qb,Xc){if(Xc&&Qb.th.nGa&12582912){const md=Xc.getAttributeNode("Src").value,ie=mb.a.lz(md,"iro");let me=0;ie&&(me=parseInt(ie));Qb=me|Qb.th.nGa&12582912;Qb!==me&&Xc.setAttribute("Src",mb.a.mr(md,"iro",Qb.toString()))}}static NYg(Qb,Xc,md,ie){(Qb=fa.DOMElementExtensions.Uu(Qb,Xc))&&fa.DOMElementExtensions.toggleCssClass(Qb,
md,ie)}}Object(e.a)(Yb,"ChartElementSelectableBehavior",z.a,[779,2]);var Wc=a(40),Qc=a(93);let Wb=class{constructor(Qb){this.SZb=()=>{this.pmc()};this.$=Qb;Qb.ea.isNamedObjectViewMode&&(La.a(this.$).Mz(this.SZb),La.a(Qb).WX&&this.pmc())}wHb(Qb,Xc){if(Xc.extension)Yb.wHb(Xc,Qb);else{let md=null;md=ie=>{Yb.wHb(ie,Qb);ie.htb(md)};Xc.Pcb(md)}}dispose(){La.a(this.$).xE(this.SZb)}pmc(){const Qb=Object(Qc.d)(v.a.resolve(n.kd,{va:0}));Wc.TaskExtensions.Ua(Qb,Xc=>{Yb.pmc(this.$,Xc.result)},this.$.xa,3)}};
Wb=Object(m.__decorate)([Object(v.d)(n.S),Object(m.__param)(0,Object(n.Lb)())],Wb);Object(e.a)(Wb,"ChartElementSelectableBehaviorManager",null,[755,2]);var Jc=a(2),ma=a(1080),Hc=a(188),Kb=a(150),pc=a(419),$b=a(161),Ib=a(1022),Zb=a(1078);class Eb{constructor(Qb,Xc){this.type=0;this.id=null;this.type=Qb;this.id=Xc}getId(){return this.id}}Object(e.a)(Eb,"MacroRecorderFloatingObjectDeletedPayload",null,[65]);var ob=a(27),Na=a(262),nb=a(111),Hb=a(103),na=a(72);class Gb{constructor(Qb,Xc){this.id=null;
this.zOrderType=0;this.id=Qb;this.zOrderType=Xc}getId(){return this.id}}Object(e.a)(Gb,"MacroRecorderFloatingObjectZOrderChangedPayload",null,[65]);class Xa{constructor(Qb){this.id=null;this.id=Qb}getId(){return this.id}}Object(e.a)(Xa,"MacroRecorderFloatingObjectPutFloatingImageInCellPayload",null,[65]);var Jb=a(903),qb=a(35),Db=a(162),gb=a(25),ya;let Aa=ya=class{constructor(Qb,Xc,md){this.$=Qb;this.Jl=Xc;this.i8=md}Bi(Qb,Xc){let md=!1;const ie=!!(this.$.wj&32);switch(Xc){case -1096598696:case -220469023:case -445658892:case 1166778132:case -1024854261:case -1480025782:case 565697619:case -884976206:md=
ie;break;case -848953656:md=64===Qb;break;case -700002548:md=ie&&I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TransitionFloatingInCellImages",!1)}return md}executeCommand(Qb,Xc,md){let ie=!1;var me=null;Qb=l.f(this.$).ha.$e.yh;const Pe=l.f(this.$).ha.$e.Gq,gf=!!l.f(this.$).ha.$e.RL,tf=Xc.command;switch(tf){case 1872288872:I.EwaSettings.isChangeGateEnabled("OfficeVSO:5903230_EscapeKeyManualPlacementFix")&&Qb.isElementMovementInProgress()?Qb.restoreElementPosition():Pe||gf?Qb.mZc():Qb.extension.o$e();
ie=!0;break;case 267796030:Xc=md.event;Qb.kZc(!!Xc&&13===Xc.keyCode,Pe);ie=!0;break;case -867294282:Qb.showE1ODialog();ie=!0;break;case 1504715724:case 2045211913:case -848953656:case -1228228458:Pe?(Qb.tsc(Pe),ie=!0):me=ya.l$h(Qb,this.$,Xc);break;case 706199415:case 125627505:Xc=125627505===tf;Pe||gf?Qb.lZc(Xc):this.selectNextFloatingObject(Xc);ie=!0;break;case -798660877:case -1470715894:case -1231471547:case 137938150:Pe?(Qb.moveElementByKey(Xc.command),ie=!0):me=u.Task.Va(ya.z1i(Xc.command,Qb));
break;case -1603798598:case -31900117:case 2039316657:case 589730764:me=u.Task.Va(ya.d1i(Xc.command,Qb));break;case -1096598696:case -220469023:me=u.Task.Va(ya.e1i(Xc.command,Qb));break;case -445658892:me=u.Task.Va(ya.h0i(Qb));break;case 1166778132:me=u.Task.Va(ya.q0i(Qb));break;case 1517579890:gb.a.X_a()&&(me=u.Task.Va(ya.dBc(tf,md,Qb)));break;case -287251124:case -1925065947:case 1764140053:case -1590502662:case -1077965542:case -1293291468:case -394785302:case 1041132226:case -571165336:case -1150205178:case -1142465846:case -286432209:me=
u.Task.Va(ya.Nwa(tf,md,Qb));break;case 1970784898:me=md.Color;this.Jl.Msb=me;this.Jl.Oza(md,me,Xc);me=u.Task.Va(ya.Nwa(tf,md,Qb));break;case -1832800737:this.Jl&&(md.Color=this.Jl.Msb);me=u.Task.Va(ya.Nwa(tf,md,Qb));break;case 862825906:me=this.Jl.oob(1970784898,Xc,"#FFFFFF");break;case -1828502776:me=gb.a.sK()?this.Jl.launchEyedropper(tf,Xc):u.Task.Va(!1);break;case -803000997:md[ma.a.Color]="000000";me=u.Task.Va(ya.Nwa(1970784898,md,Qb));break;case -585097204:me=u.Task.Va(ya.C1i(Qb));break;case -1024854261:me=
ya.eBc(Qb,this.$,1,Xc);break;case -1480025782:me=ya.eBc(Qb,this.$,0,Xc);break;case 565697619:me=ya.eBc(Qb,this.$,3,Xc);break;case -884976206:me=ya.eBc(Qb,this.$,2,Xc);break;case -700002548:me=ya.putFloatingImageInCell(Qb,this.$,this.i8,Xc)}ie||me||(me=w.a(tf));return me||u.Task.Va(!0)}ni(Qb,Xc){var md=!1;switch(Qb){case 2:case 4:case 128:case 64:case 256:case 8:case 16:md=!0}if(md)switch(Xc.command){case 1872288872:case 1504715724:case 2045211913:case -848953656:case -1228228458:case 125627505:case 706199415:break;
case -445658892:case 1166778132:case -287251124:case -1925065947:case 1764140053:case -1590502662:case -1077965542:case -1293291468:case 1970784898:case -1832800737:case 862825906:case -803000997:case -394785302:case 1041132226:case -571165336:case -1150205178:case -1142465846:case -286432209:md=this.dbf();break;case -1828502776:md=gb.a.sK()&&this.dbf();break;case -585097204:md=l.f(this.$).ha.$e.yh;md=!!md&&!(this.$.wj&32)&&5===md.floatingObject.type;break;case -798660877:case -1470715894:case -1231471547:case 137938150:case -1603798598:case -31900117:case 2039316657:case 589730764:case -1096598696:case -220469023:case -1024854261:case -1480025782:case 565697619:case -884976206:md=
l.f(this.$).ha.$e.yh;md=!!md&&md.movable;break;case 1517579890:gb.a.X_a()&&(md=l.f(this.$).ha.$e.yh,md=!!md&&md.movable);break;case -700002548:I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TransitionFloatingInCellImages",!1)&&(md=l.f(this.$).ha.$e.yh,md=!!md&&1===md.floatingObject.type);break;default:md=!1}2===Qb&&267796030===Xc.command&&(md=I.EwaSettings.Ra(407));512!==Qb||-867294282!==Xc.command&&706199415!==Xc.command&&125627505!==Xc.command||(md=!0);return md}Ji(){return!1}selectNextFloatingObject(Qb){const Xc=
l.f(this.$).ha.$e.yh;Xc&&nb.a(this.$).selectNextFloatingObject(Xc,Qb)}static l$h(Qb,Xc,md){const ie=new $b.a(Xc.sa);let me=Qb?Qb.floatingObject.id:null;if(!Qb||!me||!ie.Hj(1))return u.Task.Va(!1);const Pe=Qb.floatingObject.type,gf=ya.Yyi(Xc,Qb);Qb.qkb();2===Pe&&(me=Qb.Hq);nb.a(Xc).deleteFloatingObject(Qb,15,!0);l.f(Xc).ha.$e.YJ=null;const tf=()=>new Eb(Pe,me);return pc.a(Xc.userOperationManager,(Qe,Ca,yb)=>Ib.b(Xc.pa.ta,Pe,me,Na.c(Qe,gf),Ca,yb,null),Qe=>new ha.a(522,0,Qe,void 0,tf),md)}static Yyi(Qb,
Xc){const md=Xc.floatingObject.an();let ie=null;Xc.Xp&&(ie=Xc.Xp.block);return me=>{const Pe=I.EwaSettings.isChangeGateEnabled("OfficeVSO:8434150_MigrateValidationTelemetryManager")?v.a.Zg(n.yg):Qb.ka.Ug(277);Pe&&ie&&Pe.Ljc(()=>!ie.Qo.Vg(md),me.StateId,"DeleteFloatingObject")}}static z1i(Qb,Xc){if(!Xc)return!1;switch(Qb){case -798660877:Qb=3;break;case -1470715894:Qb=0;break;case -1231471547:Qb=1;break;case 137938150:Qb=2;break;default:return!1}Xc.extension.n5d(Qb);return!0}static e1i(Qb,Xc){if(!Xc)return!1;
Xc.extension.psj(-1096598696===Qb);return!0}static h0i(Qb){if(!Qb)return!1;Qb.extension.startEdit();return!0}static q0i(Qb){if(!Qb)return!1;Qb.extension.endEdit();return!0}static Nwa(Qb,Xc,md){if(!md)return!1;md.extension.Nwa(Qb,Xc);return!0}static dBc(Qb,Xc,md){if(!md)return!1;md.extension.dBc(Qb,Xc);return!0}static d1i(Qb,Xc){if(!Xc)return!1;switch(Qb){case -1603798598:Qb=6;break;case -31900117:Qb=10;break;case 2039316657:Qb=5;break;case 589730764:Qb=9;break;default:return!1}Xc.floatingObject.uya&&
(Qb|=3);Xc.extension.osj(Qb);return!0}static C1i(Qb){if(!Qb)return oa.ULS.sendTraceTag(537162395,5,15,"FloatingObjectCommandHandler.HandleOfficeScriptViewScript: Parameter for IFloatingObjectControl is null"),!1;const Xc=Qb.floatingObject;if(Qb.Kga()){const md=Hc.a.create();Qb=[];Qb.push(Object(Jc.a)(new na.a,{name:Jb.a.Cea,string:md.toString()}));Hb.a(Kb.a.qJj,void 0,void 0,Qb);void v.a.resolve(n.ge,{va:0}).then(ie=>{ie.XMf(Xc.id,Xc.nh.ScriptLink,md)})}return!0}static eBc(Qb,Xc,md,ie){const me=()=>
new Gb(Qb.floatingObject.id,md);return pc.a(Xc.userOperationManager,(Pe,gf,tf)=>Ib.a(Xc.pa.ta,Qb.floatingObject.id,md,Pe,gf,tf,null),Pe=>new ha.a(263,0,Pe,void 0,me),ie)}static putFloatingImageInCell(Qb,Xc,md,ie){const me=()=>new Xa(Qb.floatingObject.id);return pc.a(Xc.userOperationManager,(Pe,gf,tf)=>Zb.a(Xc.pa.ta,Qb.floatingObject.id,Na.c(Pe,this.UUj(Xc,md)),Na.b(gf,this.TUj),tf,null),Pe=>new ha.a(269,0,Pe,void 0,me),ie)}static UUj(Qb,Xc){return md=>{let ie;!md||qb.a.Jk(md.Errors)||ob.a.qm(ie=md.Result)?
md&&qb.a.Jk(md.Errors)&&oa.ULS.sendTraceTag(509109773,0,50,`FloatingObjectCommandHandler.onConvertInCellToFloatingE2oSuccess: operation succeeded with errors. Errors: ${qb.a.Kh(md.Errors)}`):(oa.ULS.sendTraceTag(509109774,0,50,"FloatingObjectCommandHandler.onPutFloatingImageInCellSuccess: operation succeeded"),Db.a(Qb).z4a(0),md=[ie],I.EwaSettings.vga()?(md=Xc.H_g(md,"floatingObject"),Xc.UYf(md)&&Xc.jLf(md)):Xc.W_g(md,"floatingObject"))}}dbf(){const Qb=l.f(this.$).ha.$e.yh;return!!Qb&&!(this.$.wj&
32)&&5===Qb.floatingObject.renderType&&5===Qb.floatingObject.type}};Aa.TUj=()=>{oa.ULS.sendTraceTag(509109772,0,50,"FloatingObjectCommandHandler.onPutFloatingImageInCellFailed: operation failed")};Aa=ya=Object(m.__decorate)([Object(v.d)(n.mc),Object(m.__param)(0,Object(n.Lb)()),Object(m.__param)(1,Object(n.Kd)()),Object(m.__param)(2,Object(n.Bg)())],Aa);Object(e.a)(Aa,"FloatingObjectCommandHandler",null,[39]);var sb=a(1083),nc=a(661),Bb=a(34),uc=a(60),Pc=a(77),wd=a(356),Md=a(142),Nd=a(1208),ec=a(26),
gc=a(225),Mb=a(196);class sc{constructor(Qb,Xc,md,ie){this.a=this.b=this.g=this.r=0;this.r=Qb;this.g=Xc;this.b=md;this.a=ie}}Object(e.a)(sc,"Color",null,[]);class xd{constructor(Qb,Xc,md,ie){this.bottom=this.top=this.right=this.left=0;this.top=Qb;this.left=Xc;this.bottom=md;this.right=ie}}Object(e.a)(xd,"Rect2D",null,[]);class xb{constructor(Qb,Xc){this.col=this.row=0;this.row=Qb;this.col=Xc}}Object(e.a)(xb,"Cell",null,[]);class Lb{constructor(Qb,Xc,md){this.sheetName=this.bottomRight=this.topLeft=
null;this.topLeft=Qb;this.bottomRight=Xc;this.sheetName=md}}Object(e.a)(Lb,"Range",null,[]);var Rc=a(321);class nd{constructor(Qb,Xc,md){this.contextMenuManager=this.cA=null;this.$=Qb;this.zoom=md;this.inkOverlay=Xc;void v.a.hj(n.wd).then(ie=>this.cA=ie);n.db.Ha()||Qb.ka.Lh(8,ie=>{this.contextMenuManager=ie})}get zoomManager(){return this.zoom.zoomManager}isDataEntryAllowed(Qb){Qb=this.inkOverlay.dCf(Qb,!1);Qb=this.inkOverlay.yIi(Qb.left+Math.abs(Qb.right-Qb.left)/2,Qb.top+Math.abs(Qb.top-Qb.bottom)/
2);return!Qb||!!fa.DOMElementExtensions.LDf(Qb,Q.ub)}getRange(Qb){var Xc=l.f(this.$).ha;const md=this.inkOverlay.dCf(Qb,!0),ie=this.zoomManager.zoom;Qb=Xc.Ey(new Sys.UI.Point(md.left/ie,md.top/ie),null,0,!0);Xc=Xc.Ey(new Sys.UI.Point(md.right/ie,md.bottom/ie),null,0,!0);return Qb&&Xc?new Lb(new xb(Qb.top,Qb.left),new xb(Xc.top,Xc.left),this.$.na.sheetName):(oa.ULS.sendTraceTag(537155033,0,50,"DryInkStore.GetRange: Failed to resolve range."),null)}getCellBounds(Qb){var Xc=l.f(this.$);const md=Xc.za.yx(this.enc(Qb));
if(!md)return oa.ULS.sendTraceTag(537155032,0,50,"DryInkStore.GetCellBounds: Failed to obtain cellProxy."),null;Qb=this.zoomManager.zoom;Xc=Xc.getCellBounds(md);Xc=new xd(Xc.y*Qb,Xc.x*Qb,(Xc.y+Xc.height)*Qb,(Xc.x+Xc.width)*Qb);return this.inkOverlay.bQi(Xc)}getHighlight(Qb){const Xc=l.f(this.$);var md=Xc.lPb(null,Qb.topLeft.row,Qb.topLeft.col);if(!md)return oa.ULS.sendTraceTag(537155031,0,50,"DryInkStore.GetHighlight: First cell missing."),null;md=md.backgroundColor;Qb=Xc.ot("InkDataStore.GetHighlight",
nd.aIb(Qb));try{for(;Qb.$$mn();)if(Qb.$$cu().cell.backgroundColor!==md)return null}finally{Qb&&Qb.dispose()}Qb=Mb.a.tu(md);return new sc(Qb.r,Qb.g,Qb.b,1)}getInputScope(Qb){switch(this.gPi(Qb)){case 1:return 0;case 2:return 1;case 5:return 3;case 9:return 4;default:return 5}}gPi(Qb){if(!this.cA)return 0;const Xc=l.f(this.$);var md=Xc.lPb(null,Qb.topLeft.row,Qb.topLeft.col);if(!md)return oa.ULS.sendTraceTag(537155030,0,50,"DryInkStore.GetNumberFormatCategoryForRange: First cell missing."),0;md=this.zzc(md.Vn);
Qb=Xc.ot("InkDataStore.GetNumberFormatCategoryForRange",nd.aIb(Qb));try{for(;Qb.$$mn();)if(this.zzc(Qb.$$cu().cell.Vn)!==md)return 0}finally{Qb&&Qb.dispose()}return md}zzc(Qb){let Xc=0;({category:Xc}=this.cA.Rqa(Qb,!0));return Xc}eVc(Qb,Xc){Xc=void 0===Xc?!1:Xc;const md=l.f(this.$),ie=md.ha,me=nd.aIb(Qb);ie.updateSelection(me,me.topLeft,0);Xc&&oa.ULS.sendTraceTag(507588687,0,15,"InkDataStore.selectInternal: showContextMenu is true.");n.db.Ha()&&Xc?void v.a.resolve(n.db).then(Pe=>{if(Pe){var gf=md.za.yx(me.topRight);
if(gf){gf=md.getCellBounds(gf);var tf=new Nd.a;tf.clientPoint=new Sys.UI.Point(gf.x+gf.width,gf.y);tf.inputMethod=3;Pe.showContextMenu(null,null,tf)}else oa.ULS.sendTraceTag(537155029,0,50,"DryInkStore.SelectInternal: Failed to obtain cellProxy.")}}):Xc&&this.contextMenuManager&&((Qb=md.za.yx(me.topRight))?(Qb=md.getCellBounds(Qb),Xc=new Nd.a,Xc.clientPoint=new Sys.UI.Point(Qb.x+Qb.width,Qb.y),Xc.inputMethod=3,this.contextMenuManager.showContextMenu(null,null,Xc)):oa.ULS.sendTraceTag(507588686,0,
50,"DryInkStore.SelectInternal: Failed to obtain cellProxy."))}select(Qb){this.eVc(Qb,!0)}erase(Qb){this.eVc(Qb);this.$.Ma.dh(new fb.a(-848953656,2,2,30,null))}highlight(Qb,Xc){const md={};md.Color=gc.a.NOb(Xc.r,Xc.g,Xc.b).$V();md.IntColor=!0;Xc=new fb.a(1650812936,2,2,30,null);this.eVc(Qb);this.$.Ma.dh(Xc,md)}unHighlight(Qb){this.eVc(Qb);this.$.Ma.dh(new fb.a(87208751,2,2,30,null))}enterText(Qb){if(Qb.length){var Xc=l.f(this.$),md=this.enc(Qb[0].cell);for(const ie of Qb)md.union(this.enc(ie.cell));
Xc.ha.updateSelection(md,md.topLeft,0);for(const ie of Qb)Qb=Object(Jc.a)(new Rc.a,{Text:ie.text}),Xc.setCell(Qb,this.enc(ie.cell),0,127,null)}}enc(Qb){return nd.aIb(new Lb(Qb,Qb,this.$.na.sheetName))}static aIb(Qb){return new ec.Range(Qb.topLeft.row,Qb.topLeft.col,Qb.bottomRight.row,Qb.bottomRight.col,!0,!1)}}Object(e.a)(nd,"InkDataStore",null,[792]);var $d=a(42),Td=a(158),He=a(218),oc=a(214),ld=a(914),id=a(13);class fc{constructor(){this.collections=this.clipRect=null}}Object(e.a)(fc,"IInkCollections",
null,[]);var vc=a(145),Tc=a(461),Bd=a(171);class Fd{constructor(Qb){this._count=0;this.$$ge=this.getEnumerator;this.nW=Qb;this.clear()}getEnumerator(){return Bd.selectMany(Bd.asEnumerable(this.wJ),Qb=>Bd.asEnumerable(Qb)).$$ge()}[Symbol.iterator](){return Object(vc.a)(this.getEnumerator())}get count(){return this._count}add(Qb){const Xc=(()=>{let md=Tc.b(this.wJ,Qb,this.nW,this.count);({buckets:this.wJ}=md);return md})().returnValue;for(let md=0;md<Xc.length;md++)if(this.nW.equals(Xc[md],Qb))return!1;
this._count=this.count+1;Xc.push(Qb);return!0}clear(){this._count=0;this.wJ=Tc.c([],this.nW,7)}contains(Qb){const Xc=this.wJ[Tc.a(this.wJ,this.nW.getHashCode(Qb))];for(let md=0;md<Xc.length;md++)if(this.nW.equals(Xc[md],Qb))return!0;return!1}remove(Qb){const Xc=this.wJ[Tc.a(this.wJ,this.nW.getHashCode(Qb))];for(let md=0;md<Xc.length;md++)if(this.nW.equals(Xc[md],Qb))return Array.removeAt(Xc,md),this._count=this.count-1,!0;return!1}}Object(e.a)(Fd,"HashSet",null,[148,43]);var le=a(656);class dc{constructor(Qb,
Xc,md){this.PLb=[];this.CMa=(ie,me,Pe)=>{oa.ULS.sendTraceTag(537155025,0,10,`Ink method ${Pe} failed.`)};this.$=Qb;this.inkOverlay=Xc;this.zoom=md}get zoomManager(){return this.zoom.zoomManager}getInk(){const Qb={};for(var Xc of nb.a(this.$).S4){var md=Xc.dzc();if(md)for(const Pe in md){var ie=Pe,me=md[Pe];ie in Qb?Qb[ie].push(me):Qb[ie]=[me]}}ie=[];for(const Pe in Qb)me=Pe,Xc=Qb[Pe],md=new fc,md.clipRect=this.eFi(me),md.collections=Xc,ie.push(md);return ie}flush(){if(this.PLb.length){var Qb={};for(var Xc of this.PLb){var md=
Xc.getId();Qb[md]||(Qb[md]=new Fd(le.a.vU()));md=Object(Td.a)(Fd,Qb[md]);for(var ie of Xc.getStrokeIds())md.add(ie)}Xc=Object.keys(Qb);var me=Array(Xc.length);for(ie=0;ie<me.length;ie++){me[ie]={};me[ie].Id=Xc[ie];me[ie].StrokeIds=[];for(const tf of Qb[Xc[ie]])me[ie].StrokeIds.push(tf)}var Pe=this.PLb;this.PLb=[];var gf=this.$.pa.ta.Jh();pc.a(this.$.userOperationManager,(tf,Qe,Ca)=>ib.c(this.$.pa.ta,this.$.na.sheetName,me,Na.c(tf,(yb,wc,dd)=>{this.Yo(yb,wc,dd);for(const vd of Pe)vd.onCompletion()}),
Na.b(Qe,this.CMa),Ca,gf),tf=>new ha.a(579,0,tf,64),null)}}add(Qb,Xc,md,ie){try{const me=l.f(this.$),Pe=this.zoomManager.zoom,gf=nd.aIb(Qb),tf=me.Pg.ro(gf.topLeft),Qe={};Qe.CreationId=dc.Ehf();Qe.InkJSON=ie;Qe.Row=gf.top;Qe.Col=gf.left;Qe.OffsetX=Math.round((me.rtl?Xc.right-md.right:md.left-Xc.left)/Pe);Qe.OffsetY=Math.round((md.top-Xc.top)/Pe);Qe.Width=Math.abs(Math.round((md.right-md.left)/Pe));Qe.Height=Math.abs(Math.round((md.bottom-md.top)/Pe));me.rtl&&1!==tf&&(Qe.OffsetX-=Md.a.Lx);let Ca=null;
Qb.sheetName===this.$.na.sheetName&&(Ca=this.Vbj(gf,Qe));const yb=this.$.pa.ta.Jh();pc.a(this.$.userOperationManager,(wc,dd,vd)=>{this.$.AD();return ib.f(this.$.pa.ta,Qb.sheetName,Qe,Na.c(wc,(Zd,Re,ff)=>{this.Yo(Zd,Re,ff);Ca&&(Ca.Slb=!1)}),Na.b(dd,this.CMa),vd,yb)},wc=>new ha.a(578,0,wc,64),null);dc.rXf&&this.EZk()}catch(me){oa.ULS.sendTraceTag(537155028,0,10,`Add failed. Exception ${me.message}`)}}EZk(){if(I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelPenNsatSurvey",!1))try{const Qb=
$d.a.instance.Qi("Common.ISystemInitiatedFeedback");Qb&&Qb.execute(Xc=>{Xc.logActivity("AddPenStrokeInExcel",null)})}catch(Qb){oa.ULS.sendTraceTag(512501467,12,10,"Exception thrown while triggering AddPenStrokeInExcel. Exception: {0}",Qb)}}deleteInkStrokes(Qb){this.PLb.push(Qb)}Vbj(Qb,Xc){var md=l.f(this.$),ie=Qb.topLeft;Qb=md.Pg.ro(ie);var me=md.fW(ie);if(!me)return oa.ULS.sendTraceTag(537155027,0,10,"gridViewBlock is null"),null;const Pe=id.HelperMethods.cH(me.domElement,me.vq.domElement,md.rtl);
md.rtl&&1===Qb&&(Pe.x+=Md.a.Lx);ie=md.ml(ie,Qb);md=new He.a(md.za.zn(me.hashCode),me.hashCode);me={};me.Id=Xc.CreationId;me.Name=dc.Ehf();me.InstanceId=0;me.SessionRevision=0;me.AltText=[];me.AltTextDescription=[];me.ZOrder=ld.a.wQa;me.Visible=!0;me.LockAspectRatio=!1;me.IsObjectLocked=!1;me.Type=8;me.RenderType=5;me.Version=-1;me.IsClientEstimation=!0;me.ContentHtml=InkHost.excelInkHostFactoryGlobal.createPayload(Xc.Width,Xc.Height,Xc.InkJSON);me.Width=Xc.Width;me.Height=Xc.Height;me.ClippedWidth=
Xc.Width;me.ClippedHeight=Xc.Height;me.IsZeroDimension=!1;me.ContainerPane=Qb;me.OriginDeltaX=ie.x-Pe.x+Xc.OffsetX;me.OriginDeltaY=ie.y-Pe.y+Xc.OffsetY;Xc=new oc.a(me);md.block.Qo.add(Xc);Xc.Itb();nb.a(this.$).zqc(Xc,md);return Xc}Yo(){}eFi(Qb){var Xc=this.zoomManager.zoom,md=parseInt(Qb,10),ie=l.f(this.$);Qb=this.inkOverlay.getBounds();Qb.left/=Xc;Qb.top/=Xc;Qb.right/=Xc;Qb.bottom/=Xc;var me=ie.Zk(md);if(!me)return oa.ULS.sendTraceTag(537155024,0,10,"Failed to obtain clipping pane"),Qb;md=me.vr;
me=me.ow;ie.rtl?(ie=Qb.right-(me.x+Md.a.Lx/Xc),Xc=ie-md.width):(Xc=me.x,ie=Xc+md.width);return new xd(Qb.top+me.y,Qb.left+Xc,Qb.top+me.y+md.height,Qb.left+ie)}static Ehf(){const Qb=Hc.a.create().toString();return`${Qb.length+2}.{${Qb.toUpperCase()}}`}}dc.rXf=!1;Object(e.a)(dc,"InkDryStore",null,[773]);class Uc{info(Qb){oa.ULS.sendTraceTag(591943768,0,50,Qb)}error(Qb){oa.ULS.sendTraceTag(591943767,0,10,Qb)}}Object(e.a)(Uc,"InkLogger",null,[842]);var kb=a(1421),rb=a(934),cc=a(907),mc=a(1082);class Sa extends mc.a{constructor(){super();
this.animateTransition=!1}}Object(e.a)(Sa,"AdditionalInkButtonProperties",mc.a,[]);var pb=a(1224);class Ac extends pb.a{constructor(){super();this.animateTransition=!1}}Object(e.a)(Ac,"AdditionalInkFlyoutAnchorProperties",pb.a,[]);class yd{constructor(Qb,Xc){this.nnc={};this.HJb=null;this.inkOverlay=Qb;this.s4g=Xc}WDi(Qb){if(Qb in this.nnc)return this.nnc[Qb];const Xc=appChrome.selectors.getInkButtonState(Qb);return this.nnc[Qb]=Xc}byc(Qb){Qb=appChrome.selectors.getColorPickerState(Qb);return Qb?
Array.isArray(Qb.colorCells)?Qb.colorCells:null:(oa.ULS.sendTraceTag(537155021,0,50,"InkRibbonManager.GetColorPickerColors: Missing State."),[])}R6h(Qb){if(!this.HJb){this.HJb={};var Xc=Array.isArray(this.byc("InkColorPickerPen").concat(this.byc("InkColorPickerHighlighter")))?this.byc("InkColorPickerPen").concat(this.byc("InkColorPickerHighlighter")):null;for(const md of Xc)this.HJb[md.id]=md}Xc=[];for(const md of Qb)md in this.HJb&&Xc.push(this.HJb[md]);return appChrome.actions.populateColorPickerCells("InkColorPickerMRU",
Xc)}w6h(Qb,Xc){const md=this.WDi(Qb.id);return yd.Yxf.includes(Qb.id)&&Xc?[appChrome.actions.addControls([appChrome.api.createInkFlyoutAnchorModel(Qb.id,md.label,Object(Jc.a)(new Ac,{iconSet:this.s4g?md.iconSet:(new kb.a(md.iconName)).iconSet,iconColor:Qb.color,keytip:md.keytip,menuModel:appChrome.getInkFlyoutAnchorMenuModel(Qb.id),animateTransition:!0,toggled:!0}))])]:[appChrome.actions.addControls([appChrome.api.createInkButtonModel(Qb.id,md.label,Object(Jc.a)(new Sa,{iconSet:this.s4g?md.iconSet:
(new kb.a(md.iconName)).iconSet,iconColor:Qb.color,keytip:md.keytip,animateTransition:!0}))]),appChrome.actions.toggleButton(Qb.id,Xc)]}qgj(Qb,Xc){const md=appChrome.selectors.getModelType(Qb);return!yd.Yxf.includes(Qb)||"InkFlyoutAnchorModel"===md&&Xc||"InkButtonModel"===md&&!Xc}CZa(Qb,Xc){var md=this.inkOverlay.getCurrentTool();"QueryInkTool"===Qb?(Qb=this.inkOverlay.getTool(Object(Td.a)(String,Xc[rb.a.SourceControlId])),md=Qb===md,Qb.id in this.nnc&&this.qgj(Qb.id,md)?(Xc[rb.a.On]=md,Xc[cc.a.iconColor]=
Qb.color):Xc[cc.a.j2b]=this.w6h(Qb,md)):"QueryInkThickness"===Qb&&md?Xc[sb.a.Value]=md.thickness:"QueryInkRecentColors"===Qb&&md?Xc[cc.a.j2b]=[this.R6h(md.recentColors)]:"QueryInkSnapToText"===Qb&&md?Xc[rb.a.On]=md.snapToText:"QueryInkDrawWithTouch"===Qb&&(Xc[rb.a.On]=this.inkOverlay.isDrawWithTouchEnabled())}d7k(Qb){appChrome.api.dispatch([appChrome.actions.updateSliderSelectedValue("InkThickness",Qb)])}}yd.Yxf=["InkPen1","InkPen2","InkHighlighter","InkActionPen"];Object(e.a)(yd,"InkRibbonManager",
null,[]);class vb{constructor(Qb,Xc){this.analysisKey=this.analysisUrl=null;this.analysisUrl=Qb;this.analysisKey=Xc}}Object(e.a)(vb,"ServiceInfo",null,[]);class Sc{logActivity(Qb,Xc,md,ie){const me=[];for(let Pe=0;Pe<md.length;Pe++)md[Pe]&&ie[Pe]&&me.push(Object(Jc.a)(new na.a,{name:md[Pe],string:ie[Pe]}));Hb.a(Qb,!0,Xc,me)}}Object(e.a)(Sc,"InkActivityLogger",null,[794]);class hd{constructor(Qb,Xc){this.oRd=this.inkOverlay=this.container=null;this.SF=()=>{this.O9b(this.$.na);this.inkOverlay.canvas.updateCanvasDimensions();
this.inkOverlay.canvas.setZoom(this.zoomManager.zoom)};this.eMa=(md,ie)=>{ie.na!==ie.mB&&(this.inkOverlay.canvas.flush(),this.O9b(ie.na))};this.RZb=()=>{this.inkOverlay.canvas.onCanvasesCrashDetected()};this.$=Qb;this.zoom=Xc;this.Xnf=new dc(Qb,this,Xc);this.k8h=new nd(Qb,this,Xc);this.$.hI(this.SF);l.f(this.$).view.Wy(this.SF);this.$.sa.QW(this.eMa);l.f(this.$).wVa.r1e(this.RZb)}get zoomManager(){return this.zoom.zoomManager}get U_j(){return this.inkOverlay}init(){const Qb=this.$.VJ;this.container=
document.createElement("div");this.container.className=Q.L;Qb.appendChild(this.container);this.O9b(this.$.na);I.EwaSettings.isChangeGateEnabled("OfficeVSO:6052930:InkActivityMinutes")&&(this.Gbj=new Sc);this.inkOverlay=InkHost.excelInkOverlayFactoryGlobal.create(this.container,this.container,Qb,this,new Uc,this.Gbj,!0);this.inkOverlay.canvas.setZoom(this.zoomManager.zoom);this.oRd=new yd(this.inkOverlay,I.EwaSettings.isChangeGateEnabled("OfficeVSO:4373042_InkDrawTabIconSet"))}O9b(Qb){var Xc=!(new $b.a(this.$.sa)).Hj(1);
if(Pc.e(Qb)||Xc)this.container.style.display="none";else{Qb=l.f(this.$);Xc=Ea.a.QPb(Qb,this.zoomManager,!1);var md=this.zoomManager.zoom,ie=Qb.rtl?Md.a.Lx:Qb.ps*md;this.container.style.top=((parseFloat(Qb.Ym.style.top)+Qb.XB)*md).toString()+"px";this.container.style.left=ie.toString()+"px";this.container.style.width=(Xc.x*md).toString()+"px";this.container.style.height=(Xc.y*md).toString()+"px";this.container.style.display="initial"}}getDryStore(){return this.Xnf}getGrid(){return this.k8h}getLanguage(){return this.$.ua.DataCultureTag}getServiceInfo(){return new vb(this.$.ua.InkAnalysisUrl,
this.$.ua.InkAnalysisKey)}displayError(Qb){switch(Qb){case 1:Qb=927;break;case 2:Qb=928;break;default:Qb=926}Qb=qb.a.Yi(1,0,26,Qb,0,0,"InkDisplayError");new wd.a(this.$,Qb)}onPointerDown(){l.f(this.$).ha.$e.XQ(null,!0)}dCf(Qb,Xc){const md=fa.DOMElementExtensions.getBoundingClientRect(this.container);return Xc?(Xc=this.zoomManager.zoom+.5,new xd(Math.max(Qb.top,Xc)+md.y,Math.max(Qb.left,Xc)+md.x,Math.min(Qb.bottom,md.height-Xc)+md.y,Math.min(Qb.right,md.width-Xc)+md.x)):new xd(Qb.top+md.y,Qb.left+
md.x,Qb.bottom+md.y,Qb.right+md.x)}bQi(Qb){const Xc=fa.DOMElementExtensions.getBoundingClientRect(this.container);return new xd(Qb.top-Xc.y,Qb.left-Xc.x,Qb.bottom-Xc.y,Qb.right-Xc.x)}getBounds(){const Qb=fa.DOMElementExtensions.getBoundingClientRect(this.container);return new xd(Qb.y,Qb.x,Qb.y+Qb.height,Qb.x+Qb.width)}yIi(Qb,Xc){let md=null;const ie=this.container.firstChild.style.display;this.container.firstChild.style.display="none";try{md=uc.a.Cyc(new Sys.UI.Point(Qb,Xc))}catch(me){oa.ULS.sendTraceTag(537155023,
0,10,me.message)}md||oa.ULS.sendTraceTag(537155022,0,10,"InkOverlay.GetElementAt: Failed to find element.");this.container.firstChild.style.display=ie;return md}dispose(){this.$.LK(this.SF);l.f(this.$).view.Kx(this.SF);this.$.sa.t1(this.eMa);l.f(this.$).wVa.pCg(this.RZb)}CZa(Qb,Xc){this.oRd.CZa(Qb,Xc)}setThickness(Qb){this.inkOverlay.setThickness(Qb);this.oRd.d7k(Qb)}oBd(Qb){const Xc=this.inkOverlay.isDrawWithTouchEnabled();return Qb&&!Xc||!Qb&&Xc?(this.inkOverlay.setDrawWithTouch(Qb),this.$.jm(),
!0):!1}deleteInkStrokes(Qb){this.Xnf.deleteInkStrokes(Qb)}static Ghb(Qb,Xc){let md=Qb.ka.Ug(380);if(md)return md;md=new hd(Qb,Xc);md.init();Qb.ka.ph(380,md);return md}}Object(e.a)(hd,"InkOverlay",null,[780,2,781]);Object(v.b)(n.rd,{yk:"singleton"})(Qb=>No(function*(){const Xc=yield v.a.resolve(n.Lb,Qb),[,md]=yield Promise.all([Object(Qc.a)(nb.a(Xc).tya(8)),v.a.resolve(n.Lg,Qb)]);return new qc(Xc,md)}));class qc{constructor(Qb,Xc){this.$=Qb;this.zoom=Xc}executeCommand(Qb,Xc,md){Qb=Xc.command;const ie=
hd.Ghb(this.$,this.zoom),me=ie.U_j;this.OGk(Xc.method,Qb)&&me.setDrawWithTouch(!0);switch(Qb){case -1190865050:me.selectSelect();break;case -23978586:l.f(this.$).ha.$e.XQ(null,!0);me.selectEraser();break;case -661723044:me.selectPen1();break;case -661723047:me.selectPen2();break;case -2032507089:me.selectHighlighter();break;case 236119185:me.selectActionPen();break;case -1836555960:if(!(sb.a.Value in md))return oa.ULS.sendTraceTag(537155035,0,10,"InkCommandHandler.ExecuteCommand: InkThickness missing value."),
u.Task.Va(!1);ie.setThickness(md[sb.a.Value]);break;case -1065705021:me.setDrawWithTouch(!me.isDrawWithTouchEnabled());break;case 2122019213:case -1601650754:case -1004421438:if(!(ma.a.Color in md))return oa.ULS.sendTraceTag(537155034,0,10,"InkCommandHandler.ExecuteCommand: InkColor missing value."),u.Task.Va(!1);me.setColor(md[ma.a.Color]);break;case -938244532:me.setSnapToText(!me.getCurrentTool().snapToText);break;case -1224297244:return this.uKk();case 1310795349:return Db.a(this.$).ns.nMg(!1),
Db.a(this.$).ns.activateRibbonTab(Ia.a.lS),me.selectSelect(),u.Task.Va(!0);case -1464607177:return me.selectSelect(),Db.a(this.$).ns.nMg(!0),Db.a(this.$).ns.activateRibbonTab(Ia.a.uxg),u.Task.Va(!0);default:return w.a(Qb)}Ha.AFrameworkApplication.ra.$d.HI&&nc.a.eX(1,2);this.$.jm();return u.Task.Va(!0)}ni(Qb,Xc){if(!Xc||!this.$.isEditMode||8===Qb)return!1;switch(Xc.command){case -1190865050:case -2032507089:case -1836555960:case 2122019213:case -1004421438:case -1065705021:case -23978586:case -661723044:case -661723047:case -1601650754:case 236119185:case -938244532:case -1224297244:case 1310795349:case -1464607177:return!0;
default:return!1}}Bi(Qb){return 8===Qb?!0:!1}Ji(){return!1}dispose(){}OGk(Qb,Xc){dc.rXf=4===Qb?!0:!1;return 4!==Qb||Bb.a.Un||Bb.a.qEc?-1065705021!==Xc:!1}uKk(){const Qb=new fb.a(-859308420,Ta.a.eh,this.$.Rh,2,null);return this.$.Ma.dh(Qb,{[Ta.a.Wk]:"HelpID=19098",["InputMethod"]:Ta.a.eh,[Ta.a.Ai]:Ia.a.CI,["ShouldCanvasTakeFocus"]:!0})}}Object(e.a)(qc,"InkCommandHandler",null,[39,2]);var Lc=a(355);let bd=class{constructor(Qb){this.$=Qb}Bi(){return!1}executeCommand(Qb,Xc){Qb=!1;Xc=Xc.command;switch(Xc){case -104572626:this.hdj(),
Qb=!0}return Qb?u.Task.Va(!0):w.a(Xc)}ni(Qb,Xc){switch(Xc.command){case -104572626:return!0;default:return!1}}Ji(){return!1}hdj(){this.$.userOperationManager.enqueueOperation(new ha.a(1026,0,(Qb,Xc)=>Lc.d(this.$.pa.ta,Na.c(Qb,this.KLj()),Na.b(Xc,this.JLj()),null,null)),null)}KLj(){return Qb=>{if(Qb.Result){oa.ULS.sendTraceTag(512278679,0,50,"LoadBlockingFloatingObjectsCommandHandler.onCleanupRequestSuccess: Clean Up of LoadBlocking floating objects Succeeded.");this.$.workbookContext.LoadBlockingFloatingObjectsInfo=
null;const Xc=Object(Qc.d)(v.a.resolve(n.Id,{va:0}));Wc.TaskExtensions.Ua(Xc,()=>{Xc.result.zU()},this.$.xa,3);this.$.Ma.dh(new fb.a(-8805455,0,this.$.Rh,12,null))}}}JLj(){return()=>{oa.ULS.sendTraceTag(512278678,0,50,"LoadBlockingFloatingObjectsCommandHandler.onCleanupRequestFailure: Clean Up of LoadBlocking floating objects failed.")}}};bd=Object(m.__decorate)([Object(v.d)(n.Hd),Object(m.__param)(0,Object(n.Lb)())],bd);Object(e.a)(bd,"LoadBlockingFloatingObjectsCommandHandler",null,[39]);var jd=
a(181),Yd=a(1406),te=a(12);let oe=class{constructor(Qb){this.$=Qb}FS(){void jd.a.Go().then(Qb=>{Qb.showTaskPane("LoadBlockingFloatingObjectsTaskPane",this.pt());return null})}zU(){void jd.a.Go().then(Qb=>{Qb.hideTaskPane("LoadBlockingFloatingObjectsTaskPane",2);return null})}gOa(){void jd.a.Go().then(Qb=>{Qb.setSelectedTaskPane("LoadBlockingFloatingObjectsTaskPane")})}pt(){var Qb,Xc,md,ie,me,Pe;return Object.assign(new Yd.a,{contentProps:{type:"LoadBlockingFloatingObjectsTaskPaneProps",loadBlockingFloatingObjectsTaskPaneSubHeader:te.a.instance.ia(1956),
loadBlockingFloatingObjectsTaskPaneBody:te.a.instance.ia(1957),allowEditingSoftBlockedFiles:this.allowEditingSoftBlockedFiles.bind(this),isSoftBlocked:2===this.$.workbookContext.LoadBlockingFloatingObjectsInfo.LoadBlockType,containsEmptyTextBox:!!((null===(Xc=null===(Qb=this.$.workbookContext)||void 0===Qb?void 0:Qb.LoadBlockingFloatingObjectsInfo)||void 0===Xc?NaN:Xc.LoadBlockingFloatingObjects)&1),containsInvalidShape:!!((null===(ie=null===(md=this.$.workbookContext)||void 0===md?void 0:md.LoadBlockingFloatingObjectsInfo)||
void 0===ie?NaN:ie.LoadBlockingFloatingObjects)&2),containsInvalidImage:!!((null===(Pe=null===(me=this.$.workbookContext)||void 0===me?void 0:me.LoadBlockingFloatingObjectsInfo)||void 0===Pe?NaN:Pe.LoadBlockingFloatingObjects)&4)},width:300,title:te.a.instance.ia(1955)})}allowEditingSoftBlockedFiles(Qb){this.$.ea.$Ad=Qb;this.$.workbookContext.LoadBlockingFloatingObjectsInfo=null;oa.ULS.sendTraceTag(509669841,0,50,"LoadBlockingFloatingObjectsTaskPane.allowEditingSoftBlockedFiles: User has decided to skip cleaning up the load blocking floating objects.");
this.zU()}};oe=Object(m.__decorate)([Object(v.d)(n.Id),Object(m.__param)(0,Object(n.Lb)())],oe);Object(e.a)(oe,"LoadBlockingFloatingObjectsTaskPane",null,[758]);var Kd=a(9),Ee=a(1210),rc=a(894);class fd extends rc.a{constructor(Qb){super(Qb);this.create()}Qs(){if(I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",!1)){const Qb=v.a.resolve(n.Bg,{va:this.hh}),Xc=v.a.resolve(n.Kd,{va:this.hh});void Promise.all([Xc,Qb]).then(md=>{var [ie,me]=md;this.cr([new Aa(this.$,
ie,me)])})}else{const Qb=Object(Qc.d)(v.a.resolve(n.Bg,{va:this.hh})),Xc=Object(Qc.d)(v.a.resolve(n.Kd,{va:this.hh}));Wc.TaskExtensions.Ua(Wc.TaskExtensions.Ln([Xc,Qb],this.xa),()=>{this.cr([new Aa(this.$,Xc.result,Qb.result)])},this.xa,3)}}static Aa(Qb){rc.a.sx(71,new fd(Qb))}}Object(e.a)(fd,"FloatingObjectCommandHandlerFactory",rc.a,[]);var Ed=a(945),Rd=a(353),Fe=a(80),Ae=a(1043),We=a(976),ve=a(1221),Ze=a(79);const Oe=Q.H;class Nf extends ld.a{constructor(Qb,Xc,md){super(Qb,Xc,Q.mb+" "+Q.lb+" "+
Ia.a.e7i,md);this.Ys=null;this.Ura=Xc.Nn.InstanceId}get mdb(){return OSF.OsfControlTarget.InContent}get instanceId(){return this.Ura}get PT(){return Oe}dispose(){this.Ys=null;super.dispose()}select(Qb,Xc){Qb&&this.Ys&&this.Ys.g5d(this);super.select(Qb,Xc)}startEdit(){l.f(this.$).Cz(!0);l.f(this.$).ha.$e.XQ(this);this.Ys.wl.notifyAgave(this.Ura,OSF.AgaveHostAction.TabIn);return!0}YYc(){const Qb=l.f(this.$);Qb.ha.$e.J1(this);Qb.focus();return!0}V1f(){this.Ys.wl.notifyAgave(this.Ura,OSF.AgaveHostAction.TabIn)}W1f(){this.Ys.wl.notifyAgave(this.Ura,
OSF.AgaveHostAction.TabInShift)}yOa(Qb){super.yOa(Qb);this.isVisible=Qb}omc(){oa.ULS.shipAssertTag(507867616,0,!Ha.AFrameworkApplication.disableWholeAppsForOfficeFeature,"MOEFloatingObjectControl:attachCallback - we should not get here when web extension is disabled");const Qb=this.Ys?u.Task.Va(this.Ys):n.vb.Ha()?Object(Qc.d)(v.a.resolve(n.vb,{va:0})):Ze.GetServiceTaskFactory.create(this.$.ka,106,this.xa,0);Wc.TaskExtensions.Ua(Qb,()=>{const Xc=!this.Ys;this.Ys=Qb.result;this.Ys.RGh(this);Xc&&this.Ys.g5d(this)},
this.xa,3)}set PT(Qb){super.PT=Qb}}Object(e.a)(Nf,"MOEFloatingObjectControl",ld.a,[344]);var Zf=a(906),Rb=a(136);class Vb extends Fe.a{constructor(Qb,Xc,md){super();this.TUd=this.mnb=this.taa=!1;this.FVc=this.znc=null;this.Glb=this.dFa=this.p_f=this.gUf=this.o_f=this.fUf=!1;this.b_b=ie=>{ie.extension.MPa(ie.floatingObject);ie.htb(this.b_b)};this.$=Qb;this.zoom=md;this.YFa=Xc;this.taa=I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LoadGC2ShapesFromHostCache",!1);this.dFa=I.EwaSettings.isChangeGateEnabled("OfficeVSO:8651155_AddTelemetryForHostBundleConsumption");
this.mnb=this.taa&&I.EwaSettings.isChangeGateEnabled("OfficeVSO:8546928_SkipHtmlSanitizationForCachedGC2Shape");I.EwaSettings.isChangeGateEnabled("OfficeVSO:8682844_TelemetryForCreatorServiceOptimization")&&oa.ULS.sendTraceTag(507568143,5,50,"ImageMOEFloatingObjectCreator:constructor: - In the constructor of the ImageMOEFloatingObjectCreator class.");this.TUd=I.EwaSettings.isChangeGateEnabled("OfficeVSO:8567370_LogTimeDurationFromQueueToCreatorForCachedGC2Shapes");this.znc=this.$.qh.Vl("Task","HTMLSanitizationHelperService");
this.FVc=this.$.qh.Vl("Task","HTMLSanitizationHelperService");this.Glb=I.EwaSettings.isChangeGateEnabled("OfficeVSO:8668792_AdditionalTelemetryForGC2ShapesFromHostCache")}BGa(Qb,Xc){if(Xc&&(oa.ULS.sendTraceTag(537162323,5,50,`ImageMOEFloatingObjectCreator:CreateFloatingObjectControl: Create Floating object called. ID: ${Qb.fi}, IsFromWorkbookCache: ${Qb.Kr}, Block: ${Xc.hash}, ContentSource: ${Xc.block.Ks}`),!Xc.block.Fp||Qb.Kr&&(!Xc.block.Qo.exists(Qb)||!l.f(this.$).za.zn(Xc.hash)))){var md=nb.a(this.$)?
nb.a(this.$).Bza:null;Rb.a.PJc(md?md[Qb.id]:null,Qb.fi,!1,!0);Rb.a.wfe(Qb.id,Qb.fi,nb.a(this.$));oa.ULS.sendTraceTag(537162322,5,50,`ImageMOEFloatingObjectCreator:CreateFloatingObjectControl: Block or floating object mismatch. Control creation is skipped and placeholder removed. Id: ${Qb.fi}, Block: ${Xc.hash}`);return}this.TUd&&(!this.fUf&&Rb.a.Plb(Qb)?(this.znc.start(),this.fUf=!0):this.o_f||Qb.Kr||!Rb.a.rUb(Qb)||(this.FVc.start(),this.o_f=!0));this.mnb&&5===Qb.type&&Qb.vM&&Qb.Kr?(oa.ULS.sendTraceTag(507787467,
5,50,this.dFa?`ImageMOEFloatingObjectCreator.CreateFloatingObjectControl: Html Sanitization is skipped for cached GC2 shape with ID: ${Qb.fi} as it is server generated and would be replaced by next GFO call, so not harmful.`:"ImageMOEFloatingObjectCreator.CreateFloatingObjectControl :: Html Sanitization is skipped for cached GC2 shape"),this.Lwd(Qb,Xc,null)):I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",!1)?void v.a.resolve(n.kd,{va:0}).then(ie=>{this.Lwd(Qb,
Xc,ie)}):(md=Object(Qc.d)(v.a.resolve(n.kd,{va:0})),Wc.TaskExtensions.Ua(md,ie=>{this.Lwd(Qb,Xc,ie.result)},this.$.xa,3))}Lwd(Qb,Xc,md){this.TUd&&(!this.gUf&&Rb.a.Plb(Qb)?(this.znc.stop(),oa.ULS.sendTraceTag(507590285,5,50,`ImageMOEFloatingObjectCreator.CreateFloatingObjectControlInternal: Time duration for cached GC2 shape from queueing to creator: ${this.znc.ii} ms`),this.gUf=!0):this.p_f||Qb.Kr||!Rb.a.rUb(Qb)||(this.FVc.stop(),oa.ULS.sendTraceTag(507590284,5,50,`ImageMOEFloatingObjectCreator.CreateFloatingObjectControlInternal: Time duration for server GC2 shape from queueing to creator: ${this.FVc.ii} ms`),
this.p_f=!0));switch(Qb.type){case 0:Ae.ChartFloatingObjectControl.BXc(Qb)?this.Y0h(Qb,Xc,md):this.IKb(Qb,Xc,md);break;case 9:case 4:this.IKb(Qb,Xc,md);break;case 1:if(gb.a.L0a()){var ie=Xc.block.Qo.find(Qb);ie&&oc.a.yFc(Qb,ie)&&(Qb=ie);We.GC2FloatingObjectControl.Ipe(Qb)?this.Pwd(Qb,Xc,md):this.IKb(Qb,Xc,md)}else this.IKb(Qb,Xc,md);break;case 5:(ie=Xc.block.Qo.find(Qb))&&oc.a.yFc(Qb,ie)&&(Qb=ie);We.GC2FloatingObjectControl.Ipe(Qb)?!this.taa&&I.EwaSettings.isChangeGateEnabled("OfficeVSO:8551802_DontRenderCachedGC2ShapesInCreator")&&
Qb.Kr?oa.ULS.sendTraceTag(507797576,5,50,this.dFa?`ImageMOEFloatingObjectCreator.createFloatingObjectControlInternal: As the flight LoadGC2ShapesFromHostCache is not yet enabled for current ring, return and do not render the cached GC2 shape with ID: ${Qb.fi}`:`ImageMOEFloatingObjectCreator.CreateFloatingObjectControlCommon: Return and don't render for cached floating object with ID: ${Qb.fi}`):(this.taa&&this.dFa&&Qb.Kr&&oa.ULS.sendTraceTag(507585491,5,50,`ImageMOEFloatingObjectCreator.createFloatingObjectControlInternal: Create GC2 Floating Object Control for the cached GC2 shape with ID: ${Qb.fi}`),
this.Pwd(Qb,Xc,md)):this.IKb(Qb,Xc,md);break;case 8:this.Pwd(Qb,Xc,md);break;case 3:this.x3h(Qb,Xc,md);break;case 2:void v.a.resolve(n.Sf,{va:0}).then(me=>{me.i6h(Qb,Xc,md)})}}Kwd(Qb,Xc,md,ie,me){var Pe,gf,tf;const Qe=this.$,Ca=nb.a(Qe);let yb=Ca.ky(Qb.an(),Xc);if(!yb||!Qb.X0a||yb.QTb||!Qb.Ona){var wc=l.f(Qe).OV&&Rb.a.iVd(Qb.type),dd=Ae.ChartFloatingObjectControl.BXc(Qb),vd=!!yb&&wc!==Object(Rd.a)(Zf.a,yb),Zd=!1;vd=this.taa&&5===(null===(Pe=null===yb||void 0===yb?void 0:yb.floatingObject)||void 0===
Pe?void 0:Pe.type)&&(null===(gf=null===yb||void 0===yb?void 0:yb.floatingObject)||void 0===gf?0:gf.vM)&&(null===(tf=null===yb||void 0===yb?void 0:yb.floatingObject)||void 0===tf?0:tf.Kr)&&5===(null===Qb||void 0===Qb?void 0:Qb.type)&&(null===Qb||void 0===Qb?0:Qb.vM)&&(null===Qb||void 0===Qb||!Qb.Kr)?!0:vd;this.eHk()?yb&&(Zd=Ae.ChartFloatingObjectControl.zqj(yb)!==dd||oc.a.yFc(yb.floatingObject,Qb),vd=vd||Zd):vd=vd||!!yb&&Ae.ChartFloatingObjectControl.BXc(yb.floatingObject)!==dd;vd&&(dd&&Ae.ChartFloatingObjectControl.Wff(yb.floatingObject,
Qb),oa.ULS.sendTraceTag(537162320,5,50,`ImageMOEFloatingObjectCreator.CreateFloatingObjectControlCommon - Deleting FloatingObjectControl. ID:${yb.floatingObject.fi}, Type: ${yb.floatingObject.type}, RenderType: ${yb.floatingObject.renderType}, IsFromWorkbookCache: ${yb.floatingObject.Kr}, IsControlMismatch: ${Zd}`),yb.V_a=Zd,Ca.deleteFloatingObject(yb),yb=null);if(yb)Object(Rd.a)(Zf.a,yb)&&Qb.version>=yb.clientVersion&&yb.sgf(Qb);else{if(wc){if(this.taa&&I.EwaSettings.isChangeGateEnabled("OfficeVSO:8549765_DontRenderCachedGC2ShapesInMultipane")&&
5===(null===Qb||void 0===Qb?void 0:Qb.type)&&(null===Qb||void 0===Qb?0:Qb.vM)&&(null===Qb||void 0===Qb?0:Qb.Kr)){oa.ULS.sendTraceTag(507787466,5,50,this.dFa?`ImageMOEFloatingObjectCreator.CreateFloatingObjectControlCommon: Return and don't render cached GC2 shape in multi-panes mode with ID: ${Qb.fi}`:"ImageMOEFloatingObjectCreator.CreateFloatingObjectControlCommon :: Don't render cached GC2 shape in multi-panes mode");return}yb=new Zf.a(Qe,Qb,this.YFa,me,this.zoom)}else oa.ULS.sendTraceTag(537162319,
5,50,`ImageMOEFloatingObjectCreator.CreateFloatingObjectControlCommon: Creating floating object with ID: ${Qb.fi} RenderType: ${Rb.a.ZYa(Qb.renderType)} Type: ${Qb.type}`),yb=md(),yb.dN(Qb);Ca.Jjc(yb);this.s9b(yb);ie&&this.YFa.wHb(Qe,yb)}Xc&&yb&&Qb.version>=yb.clientVersion&&(yb.nwb(Xc),this.taa&&5===(null===Qb||void 0===Qb?void 0:Qb.type)&&(null===Qb||void 0===Qb?0:Qb.vM)&&(null===Qb||void 0===Qb?0:Qb.Kr)?(this.Glb&&oa.ULS.sendTraceTag(507578199,5,50,`ImageMOEFloatingObjectCreator.CreateFloatingObjectControlCommon - Invoking anchorControl api with isInvokedByImageMOECreatorForCachedFO as true for cached GC2 shape with ID:${null===
Qb||void 0===Qb?void 0:Qb.fi}`),yb.sdb(Qb,Xc,!0)):yb.sdb(Qb,Xc),yb.oUa(!1))}}IKb(Qb,Xc,md){this.Kwd(Qb,Xc,()=>new ve.a(this.$,Qb,this.YFa,md),!0,md)}Y0h(Qb,Xc,md){this.Kwd(Qb,Xc,()=>new Ae.ChartFloatingObjectControl(this.$,Qb,md,this.zoom),!1,md)}Pwd(Qb,Xc,md){this.Kwd(Qb,Xc,()=>new We.GC2FloatingObjectControl(this.$,Qb,md),!1,md)}x3h(Qb,Xc,md){if(Xc&&!Xc.block.Fp)oa.ULS.sendTraceTag(537162315,5,50,`ImageMOEFloatingObjectCreator:CreateMultiPanesFloatingObjectControl called After block was evicted, block position: ${Xc.block.jk.BlockCachePosition}, floating object ID: ${Qb.fi}`);
else{var ie=this.$,me=nb.a(ie),Pe=me.ky(Qb.an());Pe||(Pe=new Nf(ie,Qb,md),Pe.dN(Qb),me.Jjc(Pe),this.s9b(Pe));Xc&&Pe.sdb(Qb,Xc)}}s9b(Qb){Qb.extension?Qb.extension.MPa(Qb.floatingObject):Qb.Pcb(this.b_b)}eHk(){return I.EwaSettings.isChangeGateEnabled("OfficeVSO:3868811_ShouldDeleteControlCG")}static Aa(Qb){const Xc=Object(Qc.d)(v.a.resolve(n.S,{va:1})),md=Object(Qc.d)(v.a.resolve(n.ab,{va:1})),ie=Object(Qc.d)(v.a.resolve(n.Lg));Wc.TaskExtensions.Ua(Wc.TaskExtensions.Ln([Xc,md,ie],Qb.xa),()=>{Qb.ka.ph(70,
new Vb(Qb,Xc.result,ie.result))},Qb.ka.xa,3)}}Object(e.a)(Vb,"ImageMOEFloatingObjectCreator",Fe.a,[782]);var Cc=a(586),rg=a(420),yf=a(715),jg=a(426),If=a(115),cf=a(554);class Nb extends Fe.a{constructor(Qb){super();this.da=l.f(Qb);Qb.ka.ph(103,this)}Ny(Qb,Xc,md){const ie=jg.a.KO(Qb.paneType,Qb.view.Xm);return Ea.a.Ny(ie,Qb.domElement,Xc,md)}IO(Qb,Xc){const md=jg.a.KO(Qb.paneType,Qb.view.Xm);return Ea.a.IO(md,Qb.domElement,Xc,Qb.rtl)}G5b(Qb,Xc,md,ie){Ea.a.G5b(Qb.domElement,Xc,md,Qb.rtl,ie)}Lfa(Qb,
Xc){Qb=this.IO(Qb,Xc);return new R.a(Qb.x,Qb.y,Xc.clientWidth,Xc.clientHeight)}HLg(Qb,Xc,md,ie){fa.DOMElementExtensions.SH(Xc,md.width);fa.DOMElementExtensions.cW(Xc,md.height);this.G5b(Qb,Xc,md.topLeft,ie)}X8a(Qb){var Xc=Qb.view;if(!Xc||!Xc.visibleArea)return null;Xc=this.rJa(Qb);const md=Qb.RMd(Xc);let ie=null;md&&(Qb=this.IO(Qb,md.domElement),ie=new Sys.UI.Point(Xc.x-Qb.x,Xc.y-Qb.y));return md?new yf.a(md,ie):null}rJa(Qb){Qb=Qb.view.visibleArea;const Xc=new O.a(0,0);Xc.x=Math.round(Qb.topLeft.x+
Qb.width/2);Xc.y=Math.round(Qb.topLeft.y+Qb.height/2);return Xc}VUc(Qb,Xc,md){md=void 0===md?!0:md;if((!md||!Qb.vr.yi(Xc))&&this.da&&this.da.view){var ie=Qb.paneType,me=this.da.view.Xm.clone(),Pe=Qb.vr.topLeft;3!==ie&&(Pe.y>Xc.y||Pe.y+Qb.zH.y<Xc.y)&&(me.y=Math.max(0,Xc.y+(Xc.height-Qb.zH.y)/2),me.y>Xc.y&&(me.y=Xc.y));4!==ie&&(Pe.x>Xc.x||Pe.x+Qb.zH.x<Xc.x)&&(me.x=Math.max(0,Xc.x+(Xc.width-Qb.zH.x)/2),me.x>Xc.x&&(me.x=Xc.x));md||(md=If.a().Pn(20),Xc.x<Pe.x?me.x=Math.max(0,Xc.x-md):Xc.x+Xc.width>Pe.x+
Qb.zH.x&&(me.x+=Xc.x+Xc.width-(Pe.x+Qb.zH.x)+md),Xc.y<Pe.y?me.y=Math.max(0,Xc.y-md):Xc.y+Xc.height>Pe.y+Qb.zH.y&&(me.y+=Xc.y+Xc.height-(Pe.y+Qb.zH.y)+md));this.da.view.Xm.equals(me)||(oa.ULS.sendTraceTag(537150282,5,50,"ViewBlockContainerHelpers.ScrollToFitInPane: scrolls into the given view area"),cf.a.VUc)}}dispose(){this.da=null;super.dispose()}}Object(e.a)(Nb,"ViewBlockContainerHelpers",Fe.a,[791]);class Bc extends rg.a{constructor(Qb){super();this.$=Qb;this.$.ka.ph(104,this);this.Bl()}get viewBlockContainerHelpers(){return this.$.ka.Ug(103)||
new Nb(this.$)}create(){Wc.TaskExtensions.Ua(Object(Qc.d)(v.a.resolve(n.ab,{va:this.hh})),()=>{this.Yj(this.viewBlockContainerHelpers)},this.xa,3)}dispose(){this.$=null;super.dispose()}static Aa(Qb){new Bc(Qb)}}Object(e.a)(Bc,"ViewBlockContainerHelpersFactory",rg.a,[]);class Ob extends rc.a{constructor(Qb){super(Qb);this.create()}dispose(){super.dispose()}Qs(){const Qb=Ze.GetServiceTaskFactory.create(this.$.ka,104,this.xa,this.hh),Xc=Object(Qc.d)(v.a.resolve(n["if"],{va:this.hh})),md=Object(Qc.d)(v.a.resolve(n.Be,
{va:this.hh})),ie=Object(Qc.d)(v.a.resolve(n.Kd,{va:this.hh}));Wc.TaskExtensions.Ua(Wc.TaskExtensions.Ln([Qb,Xc,md],this.xa),()=>{const me=new ra.ChartCommandHandler(this.$,Qb.result,Xc.result,md.result,ie.result);this.cr([me])},this.xa,3)}static Aa(Qb){Qb.ka.ph(97,new Ob(Qb))}}Object(e.a)(Ob,"ChartCommandHandlerFactory",rc.a,[]);var zc=a(155);class od extends Fe.a{constructor(Qb,Xc,md){super();this.roc=null;this.onKeyDown=ie=>{var me=ie.keyCode,Pe=this.chartView.$;Yb.Roe(Pe,this.chartView?this.chartView.Ki:
null)&&(od.xej(ie)&&40===me||ie.shiftKey&&121===me||ie.ctrlKey&&(66===me||73===me||85===me))&&(me=this.shortcutKeyManager.dD(ie),Pe=new fb.a(me,1,Pe.Rh,6,null),this.Ma.hBc(ie,Pe))};this.chartView=Qb;this.shortcutKeyManager=Xc;this.Ma=md;this.i6e(this.chartView.Fib)}dispose(){wa.a.Ng(this.roc);this.shortcutKeyManager=this.Ma=this.chartView=null;super.dispose()}yRh(){wa.a.Ng(this.roc);this.i6e(this.chartView.Fib)}i6e(Qb){this.roc=zc.a.instance.Ek(Qb);this.roc.Aa("keydown",this.onKeyDown)}static Aa(Qb){const Xc=
La.a(Qb);var md=Qb.th;md=md.allowInteractivity&&md.allowPivotSpecificOperations;Xc&&md&&Xc.dBk(new od(Xc,Qb.shortcutKeyManager,Qb.Ma))}static xej(Qb){return Qb.altKey||Qb.rawEvent.metaKey||0===Qb.rawEvent.charCode}}Object(e.a)(od,"ChartViewKeyboardHandler",Fe.a,[772,2]);class ce extends rc.a{constructor(Qb){super(Qb)}Qs(){const Qb=nb.a(this.$).tya(8),Xc=Object(Qc.d)(v.a.resolve(n.Lg));Wc.TaskExtensions.Ua(Wc.TaskExtensions.Ln([Qb,Xc],this.$.ka.xa),()=>{this.cr([new qc(this.$,Xc.result)])},this.$.ka.xa,
3)}static Aa(Qb){const Xc=new ce(Qb);Qb.ka.ph(379,Xc)}}Object(e.a)(ce,"InkCommandHandlerFactory",rc.a,[]);Type.registerNamespace("Common.App.ImageProcessor");(()=>{Ee.a.Tka=Ed.FloatingObjectControlExtension.b6e;Zf.a.Tka=Ed.FloatingObjectControlExtension.b6e;Kd.a.Qg(Qb=>{Vb.Aa(Qb);n.mc.Ha()&&I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseCommandRouterSyncFlow",!1)?void v.a.resolve(n.mc).then(Xc=>Qb.Ma.Vh.s2b(Qb,Xc)):fd.Aa(Qb);nb.a(Qb).Epd()})})();I.EwaSettings.isChangeGateEnabled("OfficeVSO:8622880_migrate_FindCss_FilterDialogsCss_FloatingObjectCss")?
a(1419):Cc.a.gw(".ewa-root-rtl .ewa-fo-img-div{direction:rtl}");Kd.a.Qg(Bc.Aa);(()=>{ra.ChartCommandHandler.initData();Da.ChartElementManager.initData();Kd.a.Qg(Qb=>{n.P.Ha()?void v.a.resolve(n.P).then(Xc=>Qb.Ma.Vh.s2b(Qb,Xc)):Ob.Aa(Qb);od.Aa(Qb);n.rd.Ha()||ce.Aa(Qb)})})();String(c);String(b);String(ra);String(Da);String(f);String(r);String(d);String(k);String(t);window.___1708742503447_closurehack=c;window.___1708742503447_closurehack=b;window.___1708742503447_closurehack=ra;window.___1708742503447_closurehack=
Da;window.___1708742503447_closurehack=f;window.___1708742503447_closurehack=r;window.___1708742503447_closurehack=d;window.___1708742503447_closurehack=k;window.___1708742503447_closurehack=t},906:function(y,x,a){a.d(x,"a",function(){return N});y=a(0);var c=a(14),b=a(96),f=a(158);x=a(263);var r=a(214),d=a(914),k=a(68),t=a(55),m=a(77),e=a(1079),w=a(16),l=a(136);class u extends d.a{constructor(M,Q,R,O){super(M,Q,k.lb,O,l.a.U3d,!1);this.bga=this.q0=null;this.uL=M.ll;this.nR=null;this.KCb=R;this.dN(Q);
this.sZ(k.l,!0);this.isVisible=!1}get grid(){return this.uL}get o5(){if(m.b(this.$.na))return this.q0||(this.q0=new t.a(this.da.ps,this.da.XB)),this.q0;this.bga||(this.bga=new t.a(this.da.ps,this.da.XB));return this.bga}get Ch(){return this.KCb}get fm(){this.nR||(this.nR=w.DOMElementExtensions.getLocation(this.grid));const M=w.DOMElementExtensions.getLocation(this.get_element());return e.a(this,new t.a(M.x-this.nR.x,M.y-this.nR.y))}dispose(){this.nR=this.uL=null;super.dispose()}sRd(M){e.b(this,M)}p5b(M,
Q){e.c(this,M,Q)}hide(){this.isVisible=!1}vie(){m.b(this.$.na)&&(this.q0=null)}Y7b(){return!1}x6b(){return!1}aLd(){return"@G"}}Object(y.a)(u,"AboveGridFloatingObjectControl",d.a,[735,440,2,736]);class n extends Sys.EventArgs{constructor(M){super();this.JT=M}}Object(y.a)(n,"ChildAddedOrRemovedEventArgs",Sys.EventArgs,[]);var v=a(1221),B=a(39),z=a(1),C=a(111),D=a(24),J=a(423),W=a(47);class N extends x.a{constructor(M,Q,R,O,U){super(document.createElement("div"));this.Vp=null;this.Aea=0;this.ji=this.Hq=
this.pga=this.bO=this.pj=this.fX=this.GCb=null;this.ILj=K=>{K=Object(f.a)(440,K);if(K.floatingObject.version<this.clientVersion)this.Aea=0;else{this.Aea++;var F=this.Oy.values.length-(this.fX?1:0);c.ULS.sendTraceTag(23069526,5,50,`MultiPanesFloatingObjectControl.OnChildImageLoaded: childrenLoadedCount: ${this.Aea}, all viewportChildren count: ${this.Oy.values.length}, childPendingRemoval: ${!!this.fX}, aboveGrid isVisible: ${this.pj.isVisible}, childPaneType: ${K?l.a.rqg(K.floatingObject.IG):"null"}, controlType: ${K?
l.a.dH(K.floatingObject):"null"}`);this.Aea>=F&&(this.Aea>this.Oy.values.length&&c.ULS.sendTraceTag(537162245,5,15,"MultiPanesFloatingObjectControl.OnChildImageLoaded: childrenLoadedCount exceeded viewportChildren count"),this.XBc(),this.suc(),this.bO&&(this.bO.Yhe(this),this.bO.Zle(this.floatingObject.Ki)),this.raiseEvent(l.a.W8a),this.raiseEvent(l.a.a_a))}};this.ji=O;this.uL=M.ll;this.fh=M;this.zoom=U;this.Oy=new B.a(!1);this.qja=new B.a(!1);this.YFa=R;this.sgf(Q);this.suc();z.EwaSettings.isChangeGateEnabled("OfficeVSO:4390665_fixMPFOC_VisualContainer_XLUID")?
this.Hq=this.ks?this.ks.Hq:null:this.Hq=Q.Hq;N.Tka&&N.Tka(this,Q);this.Mu=!1}Qcb(M){this.get_events().addHandler(l.a.a_a,M)}itb(M){this.get_events().removeHandler(l.a.a_a,M)}$Fb(M){this.get_events().addHandler(l.a.ttd,M)}Pfe(M){this.get_events().removeHandler(l.a.ttd,M)}mkc(M){this.get_events().addHandler(l.a.vtd,M)}zBg(M){this.get_events().removeHandler(l.a.vtd,M)}Rkc(M){this.get_events().addHandler(l.a.W8a,M)}n3b(M){this.get_events().removeHandler(l.a.W8a,M)}Pcb(M){this.get_events().addHandler(l.a.eib,
M)}htb(M){this.get_events().removeHandler(l.a.eib,M)}get grid(){return this.uL}get isEditing(){return!!this.pj&&this.pj.isVisible&&this.pj.isEditing}get children(){if(void 0===this.Oy||null===this.Oy)return c.ULS.sendTraceTag(537162274,5,15,"MultiPanesFloatingObjectControl.Children: Accessing Children when viewportChildren is null"),null;this.Oy.count||c.ULS.sendTraceTag(537162273,5,15,"MultiPanesFloatingObjectControl.Children: Accessing viewportChildren when their count is 0");return this.Oy.values}get l9e(){return void 0===
this.qja||null===this.qja?null:this.qja.values}get $(){return this.fh}get isVisible(){return this.ks.isVisible}set isVisible(M){if(this.children)for(const Q of this.children)Q.isVisible=M;M&&this.XBc()}get domElement(){return this.pj&&this.pj.isVisible?this.pj.domElement:this.ks.domElement}get_element(){return this.domElement}get FWa(){return this.ks.FWa}get Frc(){return this.ks.Frc}get N2c(){return d.a.TJd(this.BB)}get Uv(){return this.ks.Uv}get Gj(){return this.ks.Gj}get BB(){return this.pj&&this.pj.isVisible&&
this.pj.BB?this.pj.BB:this.ks.BB}get clientVersion(){let M=this.GCb.clientVersion;if(this.children)for(const Q of this.children)Q.clientVersion>M&&(M=Q.clientVersion);return M}set clientVersion(M){if(this.children)for(const Q of this.children)Q.clientVersion=M}get vS(){c.ULS.shipAssertTag(537162270,5,!1,"MultiPanesFloatingObjectControl.RotatePoint: Property is used for FloatingObjectControl and shouldn't be accessed for MultiPanesFloatingObjectControl");return this.ks.vS}get kL(){return this.floatingObject.kL}get V_a(){if(this.children)for(const M of this.children)if(M.V_a)return!0;
return!1}set V_a(M){if(this.children)for(const Q of this.children)Q.V_a=M;this.pj&&(this.pj.V_a=M)}get sj(){return this.Mu}showE1ODialog(){this.ks.showE1ODialog()}get fm(){return this.ks.fm}get Xp(){return this.ks.Xp}get zv(){return!!this.Xp}get iQa(){return this.ks.iQa}get ZM(){return this.ks.ZM}get extension(){return this.Vp}set extension(M){const Q=!this.Vp&&!!M;b.a.Ng(this.Vp);this.Vp=M;Q&&this.raiseEvent(l.a.eib)}get floatingObject(){return this.ks.floatingObject}get UM(){return this.GCb.UM}get da(){return D.f(this.$)}get eG(){z.EwaSettings.eaa();
return this.ks.eG}get Vtd(){return this.ks.Vtd}get jz(){return this.ks.jz}get movable(){return this.ks.movable}get I2c(){return this.ks.I2c}set I2c(M){for(const Q of this.children)Q.I2c=M}get expanded(){return this.ks.expanded}set expanded(M){for(const Q of this.children)Q.expanded=M}get xVa(){return this.ks.xVa}get CQc(){return this.ks.CQc}set CQc(M){for(const Q of this.children)Q.CQc=M}get xQc(){return this.ks.xQc}set xQc(M){for(const Q of this.children)Q.xQc=M}get v5(){return this.ks.v5}set v5(M){for(const Q of this.children)Q.v5=
M}get MCc(){return this.children.every(M=>M.MCc)}get pSb(){return this.children&&this.Oy.count?this.children.every(M=>M.pSb):!1}get VL(){return this.ks.VL}get ks(){return this.GCb}get G0a(){return!0}get OUd(){return!1}sgf(M){var {ChartFloatingObjectControl:Q}=a(1043);const {GC2FloatingObjectControl:R}=a(976);this.fX&&this.fX.floatingObject.IG===M.IG&&(this.fX=null);if(!this.zma(M.IG)){const O=l.a.Xvi+l.a.rqg(M.IG);z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.MultipaneFOCCaching",
!1)&&this.qja.getItem(M.IG.toString())?(Q=Object(f.a)(440,this.qja.getItem(M.IG.toString())),this.qja.remove(M.IG.toString())):(Q=a(1043).ChartFloatingObjectControl.BXc(M)?new Q(this.$,M,this.ji,this.zoom,O,!1):a(976).GC2FloatingObjectControl.Ipe(M)?new R(this.$,M,this.ji,O,!1):new v.a(this.$,M,this.YFa,this.ji,O,!1),Q.dN(M),Q.Qcb(this.ILj));this.Oy.add(M.IG.toString(),Q);this.GCb=this.tU();this.raiseEvent(l.a.ttd,new n(Q))}}dispose(){if(this.$){const M=D.f(this.$);(null===M||void 0===M?0:M.ha)&&
M.ha.$e.yh===this&&M.ha.$e.XQ(this,!1)}b.a.Ni([this.Vp]);this.Oy&&b.a.Ni(this.Oy.values);this.qja&&b.a.Ni(this.qja.values);this.Vp=null;b.a.Ng(this.pj);this.ji=this.qja=this.Oy=this.uL=this.fh=this.pj=null;super.dispose();this.Mu=!0}select(M){this.extension&&this.extension.select(M);const Q=!!this.$&&z.EwaSettings.isChangeGateEnabled("OfficeVSO:4413245_fixInkFreezePaneSelection")&&!!this.floatingObject&&5===this.floatingObject.renderType;if(this.g1a()||Q){for(const R of this.children)R.select(M,!1);
this.pj&&this.pj.select(M,!1)}}kZc(M,Q){this.g1a()&&this.tU().kZc(M,Q)}jZc(M){this.g1a()&&this.tU().jZc(M)}lZc(M){this.g1a()&&this.tU().lZc(M)}mZc(){this.g1a()&&this.tU().mZc()}tsc(M){this.g1a()&&this.tU().tsc(M)}moveElementByKey(M){this.tU().moveElementByKey(M)}getSelectionDescription(){return this.g1a()?this.tU().getSelectionDescription():null}JQb(M){return this.pEc()?this.tU().JQb(M):null}EQb(M){return this.pEc()?this.tU().EQb(M):null}dh(M,Q){this.tU().dh(M,Q)}oBc(M,Q){this.tU().oBc(M,Q)}OAa(M){return this.tU().OAa(M)}getContextMenuButtonList(){return this.pEc()?
this.tU().getContextMenuButtonList():null}oVc(){return this.pEc()?this.tU().oVc():null}ekc(M){this.LTa(M,Q=>{Q.ekc(M)})}R2b(M){this.LTa(M,Q=>{Q.R2b(M)})}nzd(){for(const M of this.children)M.nzd()}qOd(){for(const M of this.children)if(M.qOd())return!0;return!1}hfe(M){const Q=this.zma(M.block.jk.BlockCachePosition.PaneType);return Q?Q.hfe(M):!1}wUa(M,Q){Q=void 0===Q?!1:Q;this.LTa(M,R=>{R.wUa(M,Q)})}qkb(){return!!this.Vp&&this.Vp.qkb()}sdb(M,Q){this.LTa(Q,R=>{R.sdb(M,Q)});this.Vp&&this.Vp.MPa(M);this.pj.floatingObject.Kr&&
!M.Kr&&this.pj.dN(M,!1)}e8b(){for(const M of this.children)M.e8b()}$sb(M){this.LTa(M,Q=>{Q.$sb(M,!1);Q.Xp||this.azd(Q)});M.block.Fp||this.$&&this.v5||this.XBc()}Qtd(){for(const M of this.children)M.Qtd()}c1c(M){this.LTa(M,Q=>{Q.c1c(M,!1);Q.Xp||this.azd(Q)})}dN(M,Q){Q=void 0===Q?!1:Q;this.zma(M.IG).dN(M,Q)}Sqa(){}$Dg(){}SUa(){this.ks.SUa()}qX(){this.ks.qX()}suc(){this.floatingObject||c.ULS.sendTraceTag(537162250,5,15,`MultiPanesFloatingObjectControl:EnsureAboveGridFloatingObjectControl: FloatingObject is null, IsDisposed: ${this.sj}`);
const M=l.a.xJb(this.floatingObject);M.ZOrder++;const Q=new r.a(M);this.pj||(this.pj=this.vBi(Q));this.clientVersion<=M.Version&&(this.pj.dN(Q),this.pj.X0c(Q))}OOa(M){this.Aea=0;this.suc();this.pj.sRd(M);this.Vp.HEg()}Dla(M,Q,R){for(const O of this.children)O.Dla(M,Q,R);this.pj.Dla(M,Q,R)}i$(M){for(const Q of this.children)Q.i$(M);this.pj&&this.pj.i$(M)}JEc(M){for(const Q of this.children)if(Q.JEc(M))return!0;return this.pj?this.pj.JEc(M):!1}qWa(M){for(const Q of this.children)Q.qWa(M);this.pj&&this.pj.qWa(M)}iHa(M){for(const Q of this.children)Q.iHa(M);
this.pj&&this.pj.iHa(M)}$0c(M,Q,R){if(this.children)for(const O of this.children)O&&O.$0c(M,Q,R)}Uld(M){if(this.children)for(const Q of this.children)null===Q||void 0===Q?void 0:Q.Uld(M)}Ffe(M){if(this.children)for(const Q of this.children)null===Q||void 0===Q?void 0:Q.Ffe(M)}a1c(M){if(this.children)for(const Q of this.children)Q&&Q.a1c(M)}SBa(M){for(const Q of this.children)Q.SBa(M);for(const Q of this.l9e)Q.SBa(M);this.pj&&this.pj.isVisible&&this.pj.SBa(M)}X0c(M){const Q=this.zma(M.IG),R=parseInt(Q.get_element().style.width,
10);for(const O of this.children)if(O.floatingObject.version===M.version&&O.floatingObject.width===M.width+1&&R===M.width+1){M=O.floatingObject;break}Q.X0c(M)}q9b(M,Q){this.pj&&this.pj.q9b(M,Q)}sxe(M,Q){for(const R of this.children)R.sxe(M,Q)}sZ(M,Q){for(const R of this.children)R.sZ(M,Q)}wWc(M){for(const Q of this.children)Q.wWc(M);this.pj&&this.pj.wWc(M)}lia(M,Q){Q=void 0===Q?!0:Q;for(const R of this.children)R.lia(M,Q,!1);this.pj&&this.pj.lia(M,Q,!1);J.c(this.$,M&&(!this.pj||!this.pj.isVisible),
"MultiPaneFOControl:SetChromeDivAndHandlesVisibility")}setFocus(){this.eG&&(this.da.focus(),this.da.ha.$e.J1(this))}P5(){return this.ks.P5()}Kga(){return this.ks.Kga()}xKb(){}jtc(){}Yxa(){return this.ks.Yxa()}Vga(){c.ULS.shipAssertTag(537162248,5,!1,"MultiPanesFloatingObjectControl.LogImageLoad: Cannot log abstract object.")}$da(){return this.ks.$da()}y0a(){return this.ks.y0a()}isElementMovementInProgress(){return this.ks.isElementMovementInProgress()}restoreElementPosition(){this.ks.restoreElementPosition()}nYd(){return z.EwaSettings.isChangeGateEnabled("OfficeVSO:4390665_fixMPFOC_VisualContainer_XLUID")?
!!this.floatingObject&&0===this.floatingObject.type:!1}get QTb(){return this.ks.QTb}TOb(){return this.Vp?this.Vp.TOb():(c.ULS.shipAssertTag(537162247,5,!1,"FOC.GenerateBase64Image was called with extension not ready"),"")}cjb(){return this.Vp?this.Vp.cjb():(c.ULS.shipAssertTag(537162246,5,!1,"FOC.GenerateBase64Image was called with extension not ready"),null)}Bpa(){for(const M of this.children)M.Bpa();this.pj.Bpa()}nwb(M){this.LTa(M,Q=>{Q.nwb(M)})}PFc(){return this.ks.PFc()}oUa(M){if((M=void 0===
M?!0:M)||this.PFc()){for(const Q of this.children)Q.oUa(M);this.pj.oUa(M);b.a.Ng(this.Vp);this.Vp=null;N.Tka(this,this.floatingObject);!W.a(this.$).Ex()&&this.extension&&this.extension.MPa(this.floatingObject)}}zma(M){return Object(f.a)(440,this.Oy.getItem(M.toString()))}omc(){}XBc(){const M=this.pj;M&&M.isVisible&&(M.hide(),this.fX&&this.azd(this.fX),this.Aea=0)}LTa(M,Q){(M=this.zma(M.block.jk.BlockCachePosition.PaneType))&&Q(M)}tU(){return this.zma(2)||this.zma(3)||this.zma(4)||this.zma(1)}s6a(){throw Error.notImplemented();
}azd(M){1<this.Oy.count?(M===this.fX&&(this.fX=null),z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.MultipaneFOCCaching",!1)&&(this.qja.add(M.floatingObject.IG.toString(),M),M.isVisible=!1),this.Oy.remove(M.floatingObject.IG.toString()),this.GCb=this.tU(),this.Aea=0<this.Aea?this.Aea-1:0,this.raiseEvent(l.a.vtd,new n(M)),z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.MultipaneFOCCaching",!1)||M.dispose(),this.Aea===this.Oy.values.length-(this.fX?1:0)&&(this.fX&&
c.ULS.sendTraceTag(537162244,5,50,"MultiPanesFloatingObjectControl.DeleteChild: childPendingRemoval exists when hiding AboveGrid"),this.XBc(),this.suc(),this.raiseEvent(l.a.W8a),this.raiseEvent(l.a.a_a))):this.pj&&this.pj.isVisible?(this.fX&&this.fX.floatingObject.IG!==M.floatingObject.IG&&c.ULS.sendTraceTag(537162243,5,15,"MultiPanesFloatingObjectControl.DeleteChild: control to delete is different than childPendingRemoval"),this.fX=M):this.fX!==M&&C.a(this.$).deleteFloatingObject(this)}g1a(){return!!this.$&&
z.EwaSettings.Ra(407)&&!!this.floatingObject&&this.floatingObject.X0a}pEc(){return z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSChartRightClickFloatie",!1)}vBi(M){const {ChartAboveGridFloatingObjectControl:Q}=a(1417),{GC2AboveGridFloatingObjectControl:R}=a(1418);switch(M.renderType){case 3:return new Q(this.$,M,this,this.ji,this.zoom);case 5:return new R(this.$,M,this,this.ji)}return new u(this.$,M,this,this.ji)}dzc(){if(!this.floatingObject||8!==this.floatingObject.type)return null;
var M=this.children;if(!M)return null;const Q={};for(const R of M)if(M=R.dzc())for(const O in M)Q[O]=M[O];return Q}iWf(){return!0}}N.Tka=null;Object(y.a)(N,"MultiPanesFloatingObjectControl",x.a,[440,2,736,756])},945:function(y,x,a){a.r(x);a.d(x,"FloatingObjectControlExtension",function(){return oa});y=a(0);var c=a(14),b=a(380),f=a(96),r=a(208),d=a(182),k=a(353),t=a(158),m=a(195),e=a(68),w=a(55),l=a(218),u=a(214),n=a(914),v=a(97),B=a(5),z=a(93),C=a(212),D=a(79),J=a(905),W=a(40),N=a(990),M=a(1022),
Q=a(1214),R=a(1215),O=a(1212),U=a(1388),K=a(1009),F=a(1387),I=a(1386);class P{constructor(Ha,ka,wa,Za){this.id=null;this.top=this.left=this.type=0;this.id=Ha;this.type=ka;this.left=wa;this.top=Za}getId(){return this.id}}Object(y.a)(P,"MacroRecorderFloatingObjectMovedAndResizedPayload",null,[65]);class Y{constructor(Ha,ka){this.id=null;this.absoluteRotation=0;this.id=Ha;this.absoluteRotation=ka}getId(){return this.id}}Object(y.a)(Y,"MacroRecorderFloatingObjectRotatedPayload",null,[65]);var ea=a(906),
Ba=a(1213);a(32);var Fa=a(16),za=a(741),xa=a(35),fa=a(1),V=a(262),ba=a(136),la=a(111),Ta=a(24),Ea=a(426),sa=a(61),Ya=a(597);class bb{constructor(Ha){this.JAj=Ha;this.qKc=this.JAj.Vl("UserAction","ImageProcessor")}bOk(Ha,ka){let wa=null;if(Ha){let Za=Ha.width,ab=Ha.height;ka=this.MUi(Za,ab,ka);Za=Math.floor(Za*ka);ab=Math.floor(ab*ka);try{wa=this.udi(Ha,Za,ab)}catch(db){c.ULS.sendTraceTag(20841027,826,15,"ShrinkHTML5ImageByResolution failed. Error message: "+db.message+", Call stack: "+db.stack)}}return wa}udi(Ha,
ka,wa){if(0>=ka||0>=wa)return null;let Za;this.qKc.start();var ab=document.createElement("canvas");ab.width=ka;ab.height=wa;var db=ab.getContext("2d");Za=this.qKc.ii;db.drawImage(Ha,0,0,ka,wa);db=this.qKc.ii-Za;ab=ab.toDataURL("image/png");Ha=String.format("DoShrink: Before={0}x{1},After={2}x{3},CreateCanvas={4}ms,DrawImage={5}ms,ToDataURL={6}ms",Ha.width,Ha.height,ka,wa,Za,db,this.qKc.ii-(Za+db));c.ULS.sendTraceTag(20841028,813,50,Ha);return ab}MUi(Ha,ka,wa){return 0>=Ha||0>=ka?0:0<wa&&(Ha>wa||ka>
wa)?Math.min(wa/Ha,wa/ka):1}get URL(){return window.URL||window.webkitURL}}Object(y.a)(bb,"ImageProcessor",null,[795]);var ra=a(25);const Da=1/1.1;class oa{constructor(Ha,ka){this.rQc=this.e1b=!1;this.QLb=0;this.hpa=null;this.lAa=this.OLa=this.NNa=0;this.Lfb=this.Jv=this.Ine=this.flb=this.rq=this.WM=this.Hx=this.dC=null;this.ala=this.cla=this.dla=this.bla=0;this.MVf=!1;this.$Nc=()=>{this.control.isEditing&&this.control.extension.endEdit();this.control.SUa();this.Jv&&this.Jv.aIj()};this.Aqb=(wa,Za)=>
{this.x_b(wa,Za)};this.$jg=()=>{this.sj||(c.ULS.sendTraceTag(537162379,5,50,`FloatingObjectControlExtension.OnMoveAndResizeFailed: Operation failed. FreezePanes support: ${this.control.da.OV}, type = ${this.control.floatingObject.type}`),2===this.control.floatingObject.type&&Ya.a(this.control.$).Bqb(this.control.floatingObject,!1))};this.akg=wa=>{!this.sj&&wa&&(xa.a.Jk(wa.Errors)?c.ULS.sendTraceTag(537162377,5,50,`FloatingObjectControlExtension.OnMoveAndResizeSuccess: Operation succeeded with errors. FreezePanes support: ${this.control.da.OV}, Errors: ${xa.a.Kh(wa.Errors)}, type = ${this.control.floatingObject.type}`):
c.ULS.sendTraceTag(537162378,5,50,`FloatingObjectControlExtension.OnMoveAndResizeSuccess: Operation succeeded. FreezePanes support: ${this.control.da.OV}, type = ${this.control.floatingObject.type}`),2===this.control.floatingObject.type&&Ya.a(this.control.$).Bqb(this.control.floatingObject,!0))};this.ANc=()=>{this.S7d()};this.jng=()=>{if(this.dC){const wa=this.control.da.ha.$e.TWd;this.dC.Htc=!wa;this.control.sZ(e.l,!wa);this.control.sZ(e.h,wa)}};this.Oig=(wa,Za)=>{this.rq&&(Za.selected?this.rq.Dla(Za.inputMethod):
this.rq.i$());this.Jv&&(Za.selected?this.Jv.qWa():this.Jv.iHa());this.dC&&(this.dC.Htc=Za.selected);Za.selected&&this.Hx&&this.Hx.upgrade(this.control.floatingObject);Za.selected&&this.VOb(!1)};this.aOc=(wa,Za)=>{this.control.q9b(Za.width,Za.height);this.Jv&&this.Jv.$Hj(Za.DO,Za.EO)};this.onFloatingObjectControlVersionChanged=wa=>{this.WM&&this.WM.upgrade(wa);this.rq&&this.rq.upgrade(wa.floatingObject);this.Hx&&this.Hx.upgrade(wa.floatingObject);this.Jv&&this.Jv.upgrade(wa.floatingObject);this.QLb=
0;this.rQc=this.uId()};this.f_b=()=>{this.rq&&(this.rq.aOa(),this.rq.n7||this.rq.mPd());this.Hx&&this.Hx.aOa();this.Jv&&this.Jv.aOa();this.QLb=0;!this.control.da.Pg.Uo&&this.control.domElement.parentNode&&(this.hpa=oa.viewBlockContainerHelpers.IO(this.control.fm,this.control.domElement));this.rQc=this.uId();this.selected?this.VOb():this.jfe();this.lAa=this.OLa=this.NNa=0};this.control=Ha;this.ys=new r.a;this.qxd();this.Dwd();this.Awd(ka);Ha.eG&&Ha.movable&&(this.control.Rkc(this.onFloatingObjectControlVersionChanged),
this.control.Qcb(this.f_b));ka=this.control.da;ka=oa.P_h(ka.Pg.Iz,ka.Pg.HA,Ha.floatingObject);1<ka&&this.oyj(Ha.floatingObject,ka);(Ha=this.control.$?la.a(this.control.$):null)&&Ha.z1e(this.jng);this.sj=!1;this.MVf=fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8627680_EwaControlNullCheck")}get dyb(){return this.kLc||!!this.Hx&&this.Hx.iya}get l$(){return this.dC}get Jtb(){return this.rq}get bP(){return this.Hx}get vGg(){return this.Jv}get selected(){return!!this.WM&&this.WM.selected}get kLc(){return!!this.dC&&
this.dC.Unf||!!this.rq&&this.rq.n7||!!this.Jv&&this.Jv.N5a}select(Ha){this.flb&&this.flb.Wsd(Ha);this.xsg();this.WM.selected=Ha}MPa(Ha){this.dC&&this.dC.Unf?(this.control.sxe(this.cla-this.bla,this.ala-this.dla),this.dC.update()):this.rq&&this.rq.n7?this.rq.update():this.Hx&&this.Hx.iya?this.Hx.update():this.Jv&&this.Jv.N5a?this.Jv.update():(this.control.X0c(Ha),this.VNh(Ha));this.rq&&(this.rq.zIndex=n.a.wQa+2*Ha.kL+1,this.rq.uya=Ha.uya,this.rq.n7||this.rq.m7(Ha));this.Jv&&!this.Jv.N5a&&this.Jv.w5a();
this.Wwd();this.uxd();this.Lfb&&this.Lfb.update(Ha)}Via(Ha,ka){this.QLb=Ha;this.WM&&this.WM.Via(Ha);this.rq&&this.rq.Via(Ha);this.Hx&&this.Hx.Via(Ha);ka&&this.Jv&&this.Jv.Via(Ha)}qkb(){if(this.dyb||this.control.floatingObject.Slb)this.control.v5=!0;return this.control.v5}dispose(){this.o$e(!0);this.Aci();this.control&&this.control.movable&&(this.control.n3b(this.onFloatingObjectControlVersionChanged),this.control.itb(this.f_b));this.control.pga&&this.jfe();this.Lfb=this.Jv=this.flb=this.rq=this.Hx=
this.dC=this.WM=null;const Ha=this.control.$?la.a(this.control.$):null;Ha&&Ha.wCg(this.jng);this.sj=!0}o$e(Ha){Ha=void 0===Ha?!1:Ha;this.kLc&&b.a.instance.jsd();(Ha||!this.kLc)&&this.WM&&this.WM.selected&&this.control.da.ha.$e.XQ(this.control)}n5d(Ha){this.Hx?this.Hx.n5d(Ha):c.ULS.sendTraceTag(537162392,5,50,`FloatingObjectControlExtension.Nudge: this.isDisposed: ${this.sj}`)}osj(Ha){if(this.control.movable&&this.Hx){let ka=1;Ha&8?ka=1.1:Ha&4&&(ka=Da);this.Hx.resize(Ha,!1,ka,ka)}}tmc(Ha,ka){this.Hx&&
this.Hx.resize(3,!0,Ha,ka)}psj(Ha){this.AVb(!0)&&this.Hx&&this.Hx.rotate(Ha)}oii(){this.xsg()}HEg(){this.Jv&&this.Jv.w5a();this.rq&&this.rq.m7(null)}eOc(){this.control.isEditing&&this.control.extension.endEdit();this.control.lia(!1);this.control.SUa()}Jqb(Ha){Ha=ba.a.WLa(Ha);this.WM.selected&&this.control.lia(!0);this.control.qX();this.control.v5=!1;if(this.wGg(Ha))this.control.clientVersion--;else{this.lAa+=1;var ka=this.control.floatingObject.id;this.control.da.Pg.Uo||(this.hpa=oa.viewBlockContainerHelpers.IO(this.control.fm,
this.control.domElement));this.rii();fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FOResizeHandlesFix",!1)&&this.rq.nXh(Ha);var wa=this.control.$,Za=wa.pa.ta;this.HDc();var ab=new C.a(523,0,(db,mb,Ia)=>M.f(Za,ka,Ha,db,mb,Ia,null),64,()=>new Y(ka,Ha));ab.Ah=wa.Ila(727263662,2);wa.userOperationManager.enqueueOperation(ab,null)}}fii(){if(this.hpa){var Ha=oa.viewBlockContainerHelpers.IO(this.control.fm,this.control.domElement),ka=this.hpa.y-Ha.y;Ha=this.hpa.x-Ha.x;if(ka||Ha)this.hpa.y-=
ka,this.hpa.x-=Ha,this.control.$Dg(ka,Ha)}}TOb(){const Ha=this.control.pga?this.control.pga:this.control.N2c;return Ha?this.control.floatingObject.Nlb?Ha.attributes.getNamedItem(m.a.src).value:this.Mvd(Ha,new bb(this.control.$.qh)):""}cjb(){const Ha=new d.a;ra.a.Cxa()&&this.control.floatingObject.paa?this.VOb(!0,!0):this.VOb();const ka=this.control.pga?this.control.pga:this.control.N2c;if(ka)if(this.control.floatingObject.Nlb)Ha.setResult(ka.attributes.getNamedItem(m.a.src).value);else if(this.control.floatingObject.isSvg||
this.control.floatingObject.X0a||this.control.floatingObject.vM){const wa=new za.a(ka);wa.Aa("load",()=>{var Za;!this.MVf||(null===(Za=this.control)||void 0===Za?0:Za.$)?Ha.setResult(this.Mvd(ka,new bb(this.control.$.qh))):(c.ULS.sendTraceTag(507601417,5,15,`FloatingObjectControlExtension.generateBase64ImageAsync: Setting base64 result to null as FO is already disposed. IsDisposed: ${this.sj}.`),Ha.setResult(null));wa.detach("load")})}else Ha.setResult(this.Mvd(ka,new bb(this.control.$.qh)));else Ha.setResult("");
return Ha.task}Ezg(){this.WM.Ryh(this.Oig)}pzg(){this.dC.B0e(this.Aqb);this.dC.A0e(this.ANc)}Cba(Ha){b.a.instance.Cba(Ha.domElement,this.dC)}wzg(){this.Hx.fzh(this.Aqb);this.Hx.Omd(this.aOc)}iPg(){return!this.flb&&this.control.P5()&&this.control.$.th.aea(8)}jPg(){return!this.Ine&&this.control.Kga()&&this.control.$.C3}X$f(Ha){return!Ha.sob&&!Ha.bxb&&!Ha.$tb&&!Ha.oeb&&this.lfj()}z0c(Ha){b.a.instance.Qia(Ha.domElement,this.dC)}wGg(Ha){return ba.a.WLa(Ha)===ba.a.WLa(this.control.floatingObject.nh.Rotation)}xsg(){this.e1b||
(this.Ywd(),this.wWa(),this.nxd(),this.e1b=!0)}Wwd(){this.iPg()&&(this.flb=new O.a(this.control),c.ULS.sendTraceTag(537162390,5,50,`FloatingObjectControlExtension.CreateImageHyperLinkBehavior: Create ImageHyperLinkBehavior for control Id: ${this.control.floatingObject?this.control.floatingObject.fi:"null"}`))}uxd(){this.jPg()&&(this.Ine=new Ba.a(this.control),c.ULS.sendTraceTag(537162389,5,50,`FloatingObjectControlExtension.CreateShapeRunFromButtonBehavior: Create ShapeRunFromButtonBehavior for control Id: ${this.control.floatingObject?
this.control.floatingObject.fi:"null"}`))}qxd(){this.control.eG&&(this.WM=new I.a(this.control),this.Ezg())}nxd(){this.AVb()&&(this.Jv=new F.a(this.control.domElement,this.control,this.ys,oa.viewBlockContainerHelpers))}Awd(Ha){this.Lfb=new Q.a(this.control,Ha)}Dwd(){this.control.eG&&this.control.movable&&(this.dC=new R.a(this.control,oa.viewBlockContainerHelpers),this.pzg(),this.Cba(this.control))}Ywd(){this.control.eG&&(this.Hx=new U.a(this.control.domElement,this.control.da,this.control,oa.viewBlockContainerHelpers,
this.ys),this.wzg())}wWa(){this.control.movable&&(this.rq=new K.a(this.control.domElement,this.control.da,this.control,this.ys,oa.ZW,oa.viewBlockContainerHelpers),this.ORc())}ORc(){this.rq.zAh(this.aOc);this.rq.yAh(this.Aqb);this.rq.xAh(this.ANc);this.rq.lnd(this.$Nc)}Qia(){this.z0c(this.control)}startEdit(){this.control.startEdit()}endEdit(){this.control.endEdit()}Nwa(Ha,ka){this.control.handleCommand(Ha,ka)}dBc(Ha,ka){this.control.floatingObject.paa?this.control.handleCommand(Ha,ka):c.ULS.sendTraceTag(507527239,
306,15,"FloatingObjectControlExtension: Not a GC2 FOC = {0}",this.control.floatingObject.fi)}handleQueryCommand(Ha,ka){this.control.handleQueryCommand(Ha,ka)}updateTransformDuringOperation(Ha,ka,wa,Za,ab){this.control.updateTransformDuringOperation(Ha,ka,wa,Za,ab)}updateTransformResizeEnded(Ha,ka){this.control.updateTransformResizeEnded(Ha,ka)}shouldShowFloatie(Ha,ka){return this.control.shouldShowFloatie(Ha,ka)}VJi(Ha){let ka,wa,Za,ab;ka=null;ab=Za=wa=0;let db;if(Object(k.a)(n.a,this.control))db=
Ta.f(this.control.$).Zk(1),Ha=this.control,ka=oa.viewBlockContainerHelpers.Lfa(db,this.control.domElement);else if(Object(k.a)(ea.a,this.control)){db=Ta.f(this.control.$).Zk(Ha);Ha=Object(t.a)(ea.a,this.control).zma(Ha);if(!Ha)return{returnValue:!1,iQa:ka,rotation:wa,translateX:Za,translateY:ab};ka=oa.viewBlockContainerHelpers.Lfa(db,Ha.domElement)}else return c.ULS.sendTraceTag(537162381,5,10,"FloatingObjectControlExtension.GetFloatingObjectViewportAreaAndTransform: Failed to retrieve viewportArea."),
{returnValue:!1,iQa:ka,rotation:wa,translateX:Za,translateY:ab};if(!ka.pk(db.vr))return{returnValue:!1,iQa:ka,rotation:wa,translateX:Za,translateY:ab};Ha.Yxa()&&(wa=ba.a.jIf(Ha.floatingObject,!0)+this.QLb,Za=ka.x-db.vr.x+ka.width/2,ab=ka.y-db.vr.y+ka.height/2);return{returnValue:!0,iQa:ka,rotation:wa,translateX:Za,translateY:ab}}Aci(){this.dC&&(this.dC.JBg(this.ANc),this.dC.KBg(this.Aqb),this.Qia());this.rq&&(this.rq.Ikk(this.ANc),this.rq.Jkk(this.Aqb),this.rq.Kkk(this.aOc),this.rq.i$());this.Jv&&
this.Jv.iHa();this.Hx&&(this.Hx.Fjk(this.Aqb),this.Hx.nge(this.aOc));this.WM&&this.WM.rjk(this.Oig);this.kLc&&b.a.instance.jsd();f.a.Ni([this.WM,this.dC,this.Hx,this.rq,this.Jv,this.Lfb])}x_b(Ha,ka){this.control.qX();Ha=this.control.$;this.control.v5=!1;this.X$f(ka)?this.control.clientVersion--:(this.control.da.Pg.Uo||(this.hpa=oa.viewBlockContainerHelpers.IO(this.control.fm,this.control.domElement)),this.bla=Math.min(this.bla+ka.sob,2147483647),this.dla=Math.min(this.dla+ka.bxb,2147483647),this.cla=
Math.min(this.cla+ka.$tb,2147483647),this.ala=Math.min(this.ala+ka.oeb,2147483647),this.gFd(ka.fm),this.HDc(),this.VOb(),ka.Kej||(ka=this.bjf(ka),ka.Ah=Ha.Ila(-1036601044,2),Ha.userOperationManager.enqueueOperation(ka,null)))}bjf(Ha){const ka=this.control.floatingObject.type;let wa=this.control.floatingObject.id;2===ka&&(wa=this.control.Hq,Ya.a(this.control.$).BNc(this.control.floatingObject));const Za=this.bla,ab=this.dla,db=this.cla,mb=this.ala,Ia=Ha.tue,pa=Ha.uue,lb=this.control.$.pa.ta;return new C.a(524,
0,(ha,ua,fb)=>M.d(lb,ka,wa,Za,ab,db,mb,Ia,pa,V.c(ha,this.akg),V.b(ua,this.$jg),fb,null),64,()=>new P(wa,ka,Za,ab))}AVb(){if(!this.control||!this.control.floatingObject)return!1;const Ha=this.control.floatingObject.nh;return this.control.movable&&this.control.Yxa()&&!!Ha&&!this.control.floatingObject.E_f}S7d(){const Ha=Object(t.a)(n.a,this.control);2===this.control.floatingObject.type&&Ya.a(this.control.$).Bqb(this.control.floatingObject,!1);Ha.v5?(Ha.v5=!1,la.a(this.control.$).deleteFloatingObject(this.control)):
(Ha.dN(Ha.floatingObject),Ha.z9=null,Ha.e8b());Ha.qX()}gFd(Ha){const ka=this.control;this.bLg(ka.floatingObject);const wa=oa.viewBlockContainerHelpers.Lfa(Ha,ka.domElement);ka.Qtd();let Za=!1;for(const Ia of Ha)for(const pa of Ia){var ab=oa.viewBlockContainerHelpers.Lfa(Ha,pa.domElement);if(wa.yi(ab)){var db=pa.hashCode;const lb=ka.da.za.zn(db);if(lb){var mb=lb.Qo.find(ka.floatingObject);mb?this.bLg(mb):(mb=ba.a.xJb(ka.floatingObject),mb=new u.a(mb),lb.Qo.add(mb));ab=J.a.MP(wa.topLeft,ab.topLeft);
mb.offsetX=ab.x;mb.offsetY=ab.y;this.ZDg(mb);db=new l.a(lb,db);ka.ekc(db);ka.Xp&&ka.Xp.equals(db)&&(Za=!0)}else c.ULS.sendTraceTag(537162374,5,15,`FixAnchorAndSpannedBlocksForMove: BlockCacheItem is null in block, hash: ${db}`)}}!Za&&0<ka.ZM.count&&(Ha=ka.ZM.Tm(0),ka.wUa(Ha))}ZDg(){}bLg(Ha){Ha.Iz=this.bla;Ha.HA=this.dla;Ha.ZZ=this.cla;Ha.o3=this.ala;Ha.width=this.cla-this.bla;Ha.height=this.ala-this.dla}VNh(Ha){this.bla=Ha.Iz;this.dla=Ha.HA;this.cla=Ha.ZZ;this.ala=Ha.o3}lfj(){const Ha=this.control.floatingObject;
return this.bla===Ha.Iz&&this.dla===Ha.HA&&this.cla===Ha.ZZ&&this.ala===Ha.o3}oyj(Ha,ka){const wa={};wa.a=this.control.$.ua.UserSessionId;wa.b=Ha.type;wa.c=Ha.fi;wa.d=ka;sa.b().f0d(28,wa)}HDc(){this.control.da.za.D5()}rii(){if(this.control.floatingObject.nh){var Ha=this.uId();this.rQc!==Ha&&(this.rQc=Ha,Ha=this.control.floatingObject.vXb.kOb(),this.bla=Ha.topLeft.x,this.dla=Ha.topLeft.y,this.cla=Ha.bottomRight.x,this.ala=Ha.bottomRight.y)}}VOb(Ha,ka){Ha=void 0===Ha?!0:Ha;ka=void 0===ka?!1:ka;if(!(this.control.QTb||
4!==this.control.floatingObject.renderType&&!this.control.floatingObject.X0a&&!this.control.floatingObject.vM||ra.a.Cxa()&&this.control.floatingObject.paa&&!ka||this.control.pga&&!Ha)){this.jfe();var wa=this.control.Frc;if(wa){Ha=this.control.$.qh.vi("Task","GenerateCopyableImage");ka=document.createElement("img");if(ra.a.Cxa()&&this.control.floatingObject.paa){wa=this.control instanceof ea.a?this.control.pj:this.control;var Za=wa.Hdi();c.ULS.sendTraceTag(507798423,5,50,`FloatingObjectControlExtension.generateCopyableImage: Floating Object Id: ${wa.floatingObject.fi}, DoesPictureHaveProps: ${Za}`);
ka.src=wa.xZh()}else Za=(new XMLSerializer).serializeToString(wa),ka.height=wa.clientHeight,ka.width=wa.clientWidth,ka.src=URL.createObjectURL(new Blob([Za],{type:"image/svg+xml;charset=utf-8"}));this.control.pga=ka;Ha.stop()}}}jfe(){this.control.pga&&(URL.revokeObjectURL(this.control.pga.src),this.control.pga=null)}Mvd(Ha,ka){const wa=new Image;wa.src=Ha.attributes.getNamedItem(m.a.src).value;wa.height=Ha.height;wa.width=Ha.width;return ka.bOk(wa,Math.max(wa.height,wa.width))}uId(){const Ha=this.control.floatingObject.nh;
return Ha?ba.a.vaa(Ha.Rotation+this.QLb,Ha.FlipX!==Ha.FlipY):!1}static get viewBlockContainerHelpers(){return oa.icb}static get ZW(){return oa.Xac}static b6e(Ha,ka){if(Ha.eG)if(oa.viewBlockContainerHelpers&&oa.ZW)Ha.extension=oa.hhf(Ha,ka);else{const wa=Object(z.d)(v.a.resolve(B.x,{va:0})),Za=D.GetServiceTaskFactory.Bj(Ha.$.ka,103,104,0);W.TaskExtensions.Ua(W.TaskExtensions.Ln([Za,wa],Ha.xa),()=>{oa.Xac=wa.result;oa.icb=Za.result;Ha.extension||(Ha.extension=oa.hhf(Ha,ka))},Ha.xa,3)}}static hhf(Ha,
ka){const {MultiPanesConnectorFloatingObjectControlExtension:wa}=a(1501),{MultiPanesFloatingObjectControlExtension:Za}=a(1494),{ConnectorFloatingObjectControlExtension:ab}=a(1222);return Object(k.a)(ea.a,Ha)?5===ka.type&&ba.a.xR(ka.nh)?new wa(Ha,ka):new Za(Ha,ka):5===ka.type&&ba.a.xR(ka.nh)?new ab(Ha,ka):new oa(Ha,ka)}static Tnd(Ha,ka,wa,Za,ab){let db=wa.paneType;const mb=Za.da,Ia=wa.ow,pa=wa.zH;ab=ab?new w.a(0,0):mb.view.Xm;let lb=0,ha=0,ua=0,fb=0;0>Ha.x?(lb=Ia.x,ua=-Ea.a.KO(db,ab).x,db=oa.Axc(db,
!1)):Ha.x>Ia.x+pa.x&&(2===db||4===db)&&(db=oa.Axc(db,!1),lb=-pa.x,ua=Ea.a.KO(db,ab).x);0>Ha.y?(ha=Ia.y,fb=-Ea.a.KO(db,ab).y,db=oa.Axc(db,!0)):Ha.y>Ia.y+pa.y&&(2===db||3===db)&&(db=oa.Axc(db,!0),ha=-pa.y,fb=Ea.a.KO(db,ab).y);if(lb||ha)N.a(Ha,lb+ua,ha+fb),N.a(ka,lb,ha),Fa.DOMElementExtensions.Km(Za.domElement),wa=mb.Zk(db),Ha=wa.Nxf,Ha.insertBefore(Za.domElement,Ha.firstChild);return wa}static Axc(Ha,ka){switch(Ha){case 2:return ka?4:3;case 3:return ka?1:2;case 4:return ka?2:1;case 1:return ka?3:4}return 0}static P_h(Ha,
ka,wa){return wa?(wa.HA<ka&&wa.HA+wa.height>ka?2:1)*(wa.Iz<Ha&&wa.Iz+wa.width>Ha?2:1):1}}oa.icb=null;oa.Xac=null;Object(y.a)(oa,"FloatingObjectControlExtension",null,[783,2])},964:function(y,x,a){a.d(x,"h",function(){return t});a.d(x,"d",function(){return m});a.d(x,"a",function(){return e});a.d(x,"k",function(){return w});a.d(x,"n",function(){return l});a.d(x,"g",function(){return u});a.d(x,"i",function(){return n});a.d(x,"b",function(){return v});a.d(x,"p",function(){return B});a.d(x,"f",function(){return z});
a.d(x,"l",function(){return C});a.d(x,"e",function(){return D});a.d(x,"o",function(){return J});a.d(x,"j",function(){return W});a.d(x,"m",function(){return N});a.d(x,"c",function(){return M});var c=a(81),b=a(1074);a(71);var f=a(16),r=a(13),d=a(136),k=a(1);const t=Q=>[1,1,2,3,3,3,2,1][Q],m=Q=>t((Q+2)%8),e=(Q,R)=>{d.a.UFb(Q,d.a.kUc+R+d.a.nsc,null)},w=(Q,R,O)=>l(Q,new Sys.UI.Point(0,0),R,O),l=(Q,R,O,U)=>{U=U?-1:1;return new Sys.UI.Point(r.HelperMethods.lUc((Q.x-R.x)*O[0]+(Q.y-R.y)*U*O[1]+R.x),r.HelperMethods.lUc((Q.x-
R.x)*U*O[2]+(Q.y-R.y)*O[3]+R.y))},u=(Q,R,O,U,K)=>{O=M(O);O[1]=-O[1];O[2]=-O[2];Q=l(Q,R,O,!1);Q.x=(Q.x-R.x)*U+R.x;Q.y=(Q.y-R.y)*K+R.y;O[1]=-O[1];O[2]=-O[2];return l(Q,R,O,!1)},n=(Q,R)=>{Q%=180;Q+=0>Q?180:0;if(d.a.vaa(Q,R))Q-=90;else if(135<Q||135===Q&&!R)Q-=180;return Q},v=(Q,R,O,U,K,F,I)=>{const P=Q.x,Y=Q.y,ea=Q.width,Ba=Q.height,Fa=new Sys.UI.Point(P+ea/2,Y+Ba/2);var za=R.width;const xa=R.height;let fa=R=0;const V=U[0],ba=I?U[1]:-U[1];Q=za*V;const la=za*ba,Ta=xa*V,Ea=xa*ba,sa=za/2*(1-V)+xa/2*ba;
za=xa/2*(1-V)-za/2*ba;switch(O){case 2:case 4:case 3:O=l(new Sys.UI.Point(P,Y),Fa,U,I);R=O.x-(sa+(K?Q:0)-(F?Ea:0));fa=O.y-(za+(K?la:0)+(F?Ta:0));break;case 6:case 5:O=l(new Sys.UI.Point(P+ea,Y),Fa,U,I);R=O.x-(sa+(K?0:Q)-(F?Ea:0));fa=O.y-(za+(K?0:la)+(F?Ta:0));break;case 0:case 1:O=l(new Sys.UI.Point(P,Y+Ba),Fa,U,I);R=O.x-(sa+(K?Q:0)-(F?0:Ea));fa=O.y-(za+(K?la:0)+(F?0:Ta));break;case 7:O=l(new Sys.UI.Point(P+ea,Y+Ba),Fa,U,I),R=O.x-(sa+(K?0:Q)-(F?0:Ea)),fa=O.y-(za+(K?0:la)+(F?0:Ta))}return new Sys.UI.Point(r.HelperMethods.lUc(R),
r.HelperMethods.lUc(fa))},B=(Q,R)=>{if(R&&Q.th.nGa&12582912){const O=R.getAttributeNode("Src").value,U=c.a.lz(O,"iro");let K=0;U&&(K=parseInt(U));Q=K|Q.th.nGa&12582912;Q!==K&&R.setAttribute("Src",c.a.mr(O,"iro",Q.toString()))}},z=(Q,R,O,U,K)=>{const F=Q.x;K=K?-Q.width:Q.width;const I=Q.y,P=Q.height;Q=null;switch(U){case 2:case 4:case 3:Q=new Sys.UI.Point(F,I);break;case 6:case 5:Q=new Sys.UI.Point(F+K,I);break;case 0:case 1:Q=new Sys.UI.Point(F,I+P);break;case 7:Q=new Sys.UI.Point(F+K,I+P)}return R?
(R=new Sys.UI.Point(F+K/2,I+P/2),l(Q,R,O,!1)):Q},C=(Q,R,O,U)=>{if(R){var K=Q.width;Q=Q.height;var F=new Sys.UI.Point(K/2,Q/2);if(k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FOResizeHandlesFix",!1))for(var I of R){var P=I.domElement;R=I.ONa;var Y=Q,ea=K;R=[new Sys.UI.Point(ea/2,0),new Sys.UI.Point(ea,0),new Sys.UI.Point(ea,Y/2),new Sys.UI.Point(ea,Y),new Sys.UI.Point(ea/2,Y),new Sys.UI.Point(0,Y),new Sys.UI.Point(0,Y/2),new Sys.UI.Point(0,0)][R];W(P,R,F,O,U)}else for(P of R){I=P.domElement;
switch(P.ONa){case 0:R=new Sys.UI.Point(K/2,0);break;case 2:R=new Sys.UI.Point(K,Q/2);break;case 4:R=new Sys.UI.Point(K/2,Q);break;case 6:R=new Sys.UI.Point(0,Q/2);break;case 1:R=new Sys.UI.Point(K,0);break;case 3:R=new Sys.UI.Point(K,Q);break;case 5:R=new Sys.UI.Point(0,Q);break;case 7:R=new Sys.UI.Point(0,0);break;default:R=new Sys.UI.Point(0,0)}W(I,R,F,O,U)}}},D=Q=>{let R=0;45>=Q||315<Q?R=0:45<Q&&135>=Q?R=1:135<Q&&225>=Q?R=2:225<Q&&315>=Q&&(R=3);return R},J=(Q,R,O,U)=>{for(const Y of Q){Q=Y.domElement;
var K=Y.ONa,F=R,I=O,P=U;const ea="n-resize ne-resize e-resize se-resize s-resize sw-resize w-resize nw-resize".split(" ");let Ba=0;const Fa=n(F,!1);25<=Fa&&45>=Fa?Ba=1:-25>Fa&&-45<=Fa&&(Ba=-1);F=D(F);I&&void 0!==P&&P!==F&&(Ba+=-2*(F-P));K=(K+Ba)%ea.length;K=0>K?K+ea.length:K;Q.style.setProperty("cursor",ea[K],"important")}},W=(Q,R,O,U,K)=>{O&&Q&&R&&U&&(R=l(R,O,U,K),f.DOMElementExtensions.updatePosition(Q,R.x,R.y,!0,K))},N=(Q,R,O,U)=>{let K="";for(const F of U){let I=U="";1!==F.pAa||1!==F.qAa?I=d.a.F_e(F.absoluteRotation,
d.a.K5h(F.pAa,F.qAa)):F.Wnj&&(U=d.a.Zld(F.xGg,-F.translateX,-F.translateY));const P=d.a.Z_e(F.translateX,F.translateY);if(0<P.length||0<U.length||0<I.length)K=P+I+U+K}0<K.length&&d.a.UFb(Q,K+";",d.a.hkc(R,O))},M=Q=>{Q=b.a.T9h(Q);const R=Array(4);R[0]=Math.cos(Q);R[1]=-Math.sin(Q);R[2]=-R[1];R[3]=R[0];return R}},965:function(y,x,a){a.d(x,"a",function(){return c});y=a(0);class c{constructor(b,f,r){this.chartId=null;this.operationType=0;this.propertyValue=null;this.chartId=b;this.operationType=f;this.propertyValue=
r}pPb(){return this.chartId}SKd(){return this.operationType}getPropertyValue(){return this.propertyValue}}Object(y.a)(c,"MacroRecorderChartPropertyAppliedPayload",null,[65])},976:function(y,x,a){a.r(x);a.d(x,"GC2FloatingObjectControl",function(){return fa});y=a(0);var c=a(14),b=a(84),f=a(934),r=a(1220),d=a(960),k=a(6),t=a(523),m=a(107);x=a(914);var e=a(68),w=a(69),l=a(932),u=a(152),n=a(40),v=a(1217),B=a(1219),z=a(183),C=a(196),D=a(32),J=a(16),W=a(39),N=a(1),M=a(13),Q=a(27),R=a(136),O=a(111),U=a(442),
K=a(423),F=a(1025);class I extends F.a{constructor(){super()}}Object(y.a)(I,"ExcelInkHostConfig",F.a,[]);class P extends F.a{constructor(){super();this.onPictureDownloadComplete=this.isEnabled=this.getPlaceHolderUrl=null}}Object(y.a)(P,"ExcelPictureHostConfig",F.a,[]);class Y extends F.a{constructor(){super();this.isEnabled=this.onAutoFitResize=this.showDialog=this.onTextSelectionChanged=this.onEditStatusChanged=null}}Object(y.a)(Y,"ExcelShapeHostConfig",F.a,[]);class ea{constructor(V,ba){this.y=
this.x=0;this.x=V;this.y=ba}}Object(y.a)(ea,"Point2D",null,[]);var Ba=a(97),Fa=a(5),za=a(25),xa=a(59);class fa extends x.a{constructor(V,ba,la,Ta,Ea){super(V,ba,e.lb,la,void 0===Ta?"":Ta,void 0===Ea?!0:Ea);this.Rt=null;this.IFc=this.Q8=!1;this.xG=this.qIb=this.OWc=null;this.Glb=!1;this.cZj=()=>{this.Q8&&this.endEdit()};this.DY=sa=>{const Ya=sa.rawEvent.type;this.qIb=new b.a(Ya,sa.rawEvent.srcElement,sa,"mouseup"===Ya?2:1);this.OWc=z.AsyncMethodContext.$B(()=>{O.a(this.$).OWj(this.qIb)},10,"ShapeTextEditingMouseUp",
this.OWc)};this.zQi=()=>{N.EwaSettings.isChangeGateEnabled("OfficeVSO:8189843_AddEwaControlNullCheckInGC2FOC")&&!this.$&&c.ULS.sendTraceTag(508359203,5,50,`GC2FloatingObjectControl: EwaControl is null/undefined. Is object disposed: ${null===this||void 0===this?void 0:this.sj}`);return(!N.EwaSettings.isChangeGateEnabled("OfficeVSO:8189843_AddEwaControlNullCheckInGC2FOC")||this.$)&&this.$.frame&&this.$.frame.oM&&this.$.frame.oM.YX?xa.a.current.uu(100):xa.a.current.uu(117)};this.bOj=sa=>{this.onEditStatusChanged(sa)};
this.isEnabled=(sa,Ya)=>{var bb;return sa&&"CG"===Ya?null!==(bb=N.EwaSettings.isChangeGateEnabled(sa))&&void 0!==bb?bb:!1:sa&&"FG"===Ya?N.EwaSettings.getBooleanFeatureGate(sa,!1):!1};this.pjj=(sa,Ya)=>{switch(Ya){case 0:return N.EwaSettings.isChangeGateEnabled(sa);case 1:return N.EwaSettings.getBooleanFeatureGate(sa,!1);default:c.ULS.sendTraceTag(508409101,0,50,"GC2FloatingObjectControl.isGateEnabled: Unsupported GateType.")}return!1};this.onPictureDownloadComplete=sa=>{N.EwaSettings.isChangeGateEnabled("OfficeVSO:8410875_IsDisposedCheckInCallback")&&
!this.iua()?c.ULS.sendTraceTag(508035138,5,15,"GC2FloatingObjectControl.onPictureDownloadComplete. Object is disposed."):u.c(()=>{if(this.iua())switch(sa){case 2:this.z6(null);break;case 3:this.Loa(null);break;default:c.ULS.sendTraceTag(508143247,5,50,`GC2FloatingObjectControl.onGC2GraphicLoadSuccess. Unsupported GraphicLoadStatus ${sa}`)}},this.$.xa)};this.wKj=(sa,Ya)=>{this.onAutoFitResize(sa,Ya)};this.onTextSelectionChanged=()=>{O.a(this.$).kng()};this.showDialog=sa=>{"clipboardErrorDialog"===
sa&&(sa=this.$.ka.Ug(254))&&sa.rsg()};if(5!==ba.renderType)throw c.ULS.sendTraceTag(537162369,5,10,"GC2FloatingObjectControl: RenderType is not GC2."),Error.invalidOperation("Creating GC2FloatingObjectControl for non GC2 render Type.");this.EEc=N.EwaSettings.isChangeGateEnabled("OfficeVSO:8279691_FixDIPTelemetryForGC2Image");this.Glb=N.EwaSettings.isChangeGateEnabled("OfficeVSO:8668792_AdditionalTelemetryForGC2ShapesFromHostCache");this.jVj=n.TaskExtensions.Ua(U.a.tya(ba.type),()=>{!this.sj&&ba.Qz&&
this.mOg(ba)},this.$.ka.xa,8);this.Ht=this.Xk.WT();this.Ht.Aa("blur",this.cZj);this.Wi.Aa("mouseup",this.DY);this.nl=za.a.nl()}get isEditing(){return this.Q8}get sw(){this.xG||(this.xG=Ba.a.Zg(Fa.og));return this.xG}dispose(){var V;(null===(V=this.OWc)||void 0===V?0:V.wt)&&this.OWc.cancel();this.Ht&&this.Ht.detach("blur");this.Ht=null;this.Wi.zv("mouseup")&&this.Wi.detach("mouseup");super.dispose()}getHitTestData(V,ba){return this.Rt.getHitTestData(this.Gj,new ea(V.x,V.y),ba)}dN(V,ba){this.Q8||super.dN(V,
void 0===ba?!1:ba)}Sqa(){za.a.L0a()&&N.EwaSettings.isChangeGateEnabled("OfficeVSO:8140451_MoveGC2PicturesToGetRange")&&this.Eoe()?this.USf():this.hVj(()=>{this.iua()&&this.C4k()})}P5(){return!!this.floatingObject&&!!this.floatingObject.nh&&this.floatingObject.nh.IsHlinkPresent}startEdit(){5===this.floatingObject.type&&(c.ULS.sendTraceTag(537162339,0,50,"GC2FloatingObjectControl.StartEdit: Starting Shape text Editing."),this.Rt.startEdit())}endEdit(){5===this.floatingObject.type&&(c.ULS.sendTraceTag(537162337,
0,50,"GC2FloatingObjectControl.EndEdit: Ending Shape text Editing."),this.Rt.endEdit())}shouldShowFloatie(V,ba){return this.Rt.shouldShowFloatie(V,ba)}handleCommand(V,ba){const la=R.a.AKi(V);if(za.a.X_a()){if("Unsupported"!==la)switch(this.floatingObject.type){case 1:this.Rt.handleCommand(la,ba);break;case 5:this.YMf(la,ba,V)}}else this.YMf(la,ba,V)}handleQueryCommand(V,ba){const la=this.$.qh.vi("ModelUpdate","GC2FloatingObjectControl.HandleQueryCommand");var Ta=R.a.BKi(V);if("Unsupported"!==Ta&&
this.Rt){var Ea=this.Rt.handleQueryCommand(Ta);if("value"in Ea){switch(V){case "QueryBold":case "QueryItalics":case "QueryUnderline":case "QueryStrikethrough":ba[f.a.On]=Ea.value;break;case "QueryFontPickerFont":c.ULS.shipAssertTag(507844167,0,this.nl,"GC2FloatingObjectControl.handleQueryCommand: Unexpected command QueryFontPickerFont triggered when modern font picker and/or font service disabled");V=Ea.value;Ta=this.bKi(V,Ea);Ea=M.HelperMethods.NLd(V,Ea.bold,Ea.italic,Ta,!0);ba[r.a.SelectedFont]=
Ea;break;case "QueryFontName":Ta=V=Ea.value;Q.a.qm(V)||(Ea=Ea.fontFamily,Ea.startsWith("+mj")?(V=M.HelperMethods.NQb(V,1),Ta="MajorThemeFont"):Ea.startsWith("+mn")&&(V=M.HelperMethods.NQb(V,2),Ta="MinorThemeFont"));ba[d.a.Key]=Ta;ba[d.a.Value]=V;break;case "QueryFontSize":ba[d.a.Value]=Ea.value;break;case "QueryAlignmentTop":case "QueryAlignmentMiddle":case "QueryAlignmentBottom":case "QueryAlignmentLeft":case "QueryAlignmentCenter":case "QueryAlignmentRight":ba[f.a.On]=Ea.value===Ta}la.stop()}else c.ULS.sendTraceTag(537162335,
0,10,"GC2FloatingObjectControl.HandleQueryCommand: resultProps missing value.")}}updateTransformDuringOperation(V,ba,la,Ta,Ea){this.Rt.updateTransformDuringOperation(la,Ta,V,ba,Ea)}updateTransformResizeEnded(V,ba){this.Rt.updateTransformResizeEnded(V,ba)}z6(V){var ba;!k.AFrameworkApplication.Il&&this.floatingObject&&(this.Glb&&R.a.Plb(this.floatingObject)&&c.ULS.sendTraceTag(507577889,5,50,`GC2FloatingObjectControl:OnImageLoadSuccess: Successfully rendered the cached GC2 shape with ID: ${null===(ba=
this.floatingObject)||void 0===ba?void 0:ba.fi} `),ba=this.l6b(),this.Laa.stop(),this.tia&&this.mta(D.a.Tg.qk.m,(ba?"Step1-":"")+"ImageLoadSuccess",this.Laa.ii,!0),this.WYc("ImageLoadSuccess",!ba),this.pLa.q9("ImageLoadSuccess"),this.Vga(!0),super.z6(V))}Ape(){return!1}ZPg(){return!!this.Xp&&!this.floatingObject.Zna&&!this.floatingObject.Qz}Eoe(){return 1===this.floatingObject.type&&this.Kr}xZh(){try{const V=JSON.parse(this.floatingObject.Qz).imageURL;c.ULS.shipAssertTag(507638432,0,!Q.a.qm(V),`GC2FloatingObjectControl.convertGC2ImageURLtoNonGC2: URL cannot be undefined, null or empty. Floating Object Id: ${this.floatingObject.fi}`);
const ba=new URL(V),la=new URLSearchParams(ba.search),Ta=la.get("iro");la.set("iro",(parseInt(Ta,10)&-9).toString());ba.search=la.toString();return ba.href}catch(V){throw c.ULS.sendTraceTag(507639189,5,50,`GC2FloatingObjectControl.convertGC2ImageURLtoNonGC2: Something went wrong while creating the nonGC2 URL. Floating Object Id: ${this.floatingObject.fi}, Exception: ${V}`),V;}}Hdi(){if(!this.floatingObject.paa||!this.floatingObject.Qz)return!1;try{const V=JSON.parse(this.floatingObject.Qz),ba=JSON.parse(V.pictureMetaData),
la=ba.flip;if(0!==ba.rotation||la.x||la.y)return!0;const Ta=JSON.parse(ba.pictureModelJson);if(Ta.line||Ta.fill||Ta.effects||Ta.pictureEffects)return!0}catch(V){c.ULS.sendTraceTag(507811730,5,50,`GC2FloatingObjectControl.doesGC2PictureHaveProps: Something went wrong while parsing the gc2 payload. Floating Object Id: ${this.floatingObject.fi}, Exception: ${V}`)}return!1}YMf(V,ba,la){let Ta=null;this.Q8||(Ta=this.kMh(la,ba));if((ba.SqmControlId||"").includes("ThemeColorPicker"))if(this.sw){let Ea,sa;
if((()=>{let Ya=this.sw.getThemeColor(ba.Color);({themeIndex:Ea,sPa:sa}=Ya);return Ya})().returnValue){const Ya=this.sw.Lwb.ma(Ea);ba.Color=l.a.uWi(Ya,Ea,sa)}}else c.ULS.sendTraceTag(537162336,0,10,"GC2FloatingObjectControl.HandleCommand: Themes Manager is null");"Unsupported"!==V&&this.Rt.handleCommand(V,ba,Ta);this.nl&&-1293291468===la&&(this.$.jm(),t.a.h_e(ba[w.a.Wk]))}C4k(){var V;if(this.iua()){var ba=this.$.qh.vi("ModelUpdate","GC2FloatingObjectControl.UpdateGC2FloatingObjectContent");this.WWf()||
(this.Gj||this.mOg(this.floatingObject),this.Gj.removeAttribute("style"),this.Gj.removeAttribute("class"),this.s$a=this.floatingObject.jz,za.a.Cxa()&&this.floatingObject.paa||this.s6a(this.jz),this.Glb&&R.a.Plb(this.floatingObject)&&c.ULS.sendTraceTag(507578197,5,50,`GC2FloatingObjectControl.updateGC2FloatingObjectContent: Invoking updateModel api for the cached GC2 shape with ID: ${null===(V=this.floatingObject)||void 0===V?void 0:V.fi}`),this.Rt.updateModel(this.floatingObject.Qz),this.Rt.isRenderOverflowSupported()&&
(this.Gj.style.overflow="visible"),this.PT=this.Rt.isRenderTransparencySupported()?e.C:e.o,this.f1c(),this.x6a(this.floatingObject.kL),this.EEc&&1===this.floatingObject.type||u.c(()=>{this.iua()&&(this.floatingObject.dTc?this.Loa(null):this.z6(null))},this.$.xa),ba.stop())}}iua(){return!this.sj}hVj(V){n.TaskExtensions.Ua(this.jVj,()=>{V()},this.$.ka.xa,8)}mOg(V){this.SCa=document.createElement("div");this.Gj.id="Host-"+this.domElement.id;this.yOa(!1);this.domElement.appendChild(this.Gj);switch(V.type){case 5:var ba=
new Y;ba.id=V.id;ba.parent=this.Gj;ba.actionHandler=v.a.Ghb(this.$);ba.onEditStatusChanged=this.bOj;ba.onTextSelectionChanged=this.onTextSelectionChanged;ba.showDialog=this.showDialog;ba.onAutoFitResize=this.wKj;ba.isEnabled=this.isEnabled;ba.logger=new B.a;ba.excelHealth=this.getHealth();this.Rt=GC2Host.excelShapeHostFactoryGlobal.createHost(ba);break;case 1:ba=new P;ba.id=V.id;ba.parent=this.Gj;ba.actionHandler=v.a.Ghb(this.$);ba.logger=new B.a;ba.excelHealth=this.getHealth();ba.getPlaceHolderUrl=
this.zQi;ba.isEnabled=this.pjj;ba.onPictureDownloadComplete=this.EEc?this.onPictureDownloadComplete:void 0;this.Rt=GC2Host.excelPictureHostFactoryGlobal.createHost(ba);break;case 8:ba=new I;ba.id=V.id;ba.parent=this.Gj;ba.actionHandler=v.a.Ghb(this.$);ba.logger=new B.a;this.Rt=InkHost.excelInkHostFactoryGlobal.createHost(ba);break;default:throw c.ULS.sendTraceTag(537162334,5,10,"GC2FloatingObjectControl: Type is not GC2 supported."),Error.invalidOperation("Creating GC2FloatingObjectControl Host for non GC2 Type.");
}this.Rt.setSelected(this.IFc)}getHealth(){return m.Health.instance}select(V,ba){super.select(V,ba);this.IFc=V;this.Rt&&this.Rt.setSelected(V)}onEditStatusChanged(V){!V&&this.extension&&this.extension.bP.O3b(!0);this.Q8=V;O.a(this.$).kng();J.DOMElementExtensions.toggleCssClass(this.Uv,e.z,V);!this.Q8&&this.IFc&&this.setFocus(!0);K.c(this.$,!V,"GC2FOControl:OnEditStatusChanged")}onAutoFitResize(V,ba){R.a.vaa(this.floatingObject.nh.Rotation,!1)?this.extension.tmc(V,ba):this.extension.tmc(ba,V)}dzc(){if(!this.floatingObject||
!this.Rt||8!==this.floatingObject.type)return null;const V={};V[this.floatingObject.IG.toString()]=this.Rt.createInkCollection();return V}kMh(V,ba){let la=0;var Ta={};const Ea={},sa={};Ea.Font=sa;switch(V){case -287251124:sa.ValidMembers=4;this.handleQueryCommand("QueryBold",Ta);sa.Bold=!Ta[f.a.On];break;case -1925065947:sa.ValidMembers=8;this.handleQueryCommand("QueryItalics",Ta);sa.Italic=!Ta[f.a.On];break;case 1764140053:sa.ValidMembers=16;this.handleQueryCommand("QueryUnderline",Ta);sa.Underline=
!Ta[f.a.On];break;case -1293291468:Ta=M.HelperMethods.fca[ba[w.a.Wk]];sa.ValidMembers=1;sa.FontName=Ta;if(this.nl&&Ta){sa.ValidMembers|=12;sa.Bold=!1;sa.Italic=!1;ba=ba.Format;if(null===ba||void 0===ba?0:ba.isBold)sa.Bold=ba.isBold;if(null===ba||void 0===ba?0:ba.isItalic)sa.Italic=ba.isItalic}break;case -1077965542:ba=parseFloat(ba[ba[d.a.IsFreeForm]?d.a.Value:w.a.Wk].toString());sa.ValidMembers=2;sa.FontSize=ba;break;case 1970784898:case -1832800737:Ta=ba.Color;sa.ValidMembers=32;sa.FontColor=C.a.FO(Ta,
W.a.Em(ba,"IntColor"));break;case -571165336:case 1041132226:case -394785302:la=1;Ea.VerticalAlignment=W.a.tw(R.a.rdb,V.toString(),0);break;case -1150205178:case -1142465846:case -286432209:la=2,Ea.HorizontalAlignment=W.a.tw(R.a.rdb,V.toString(),1)}Ea.ValidMembers=V.toString()in R.a.rdb?la:4;return Ea}bKi(V,ba){if(Q.a.qm(V))return 0;V=ba.fontFamily;return V.startsWith("+mj")?1:V.startsWith("+mn")?2:0}static Ipe(V){return za.a.L0a()?5===V.renderType||8===V.type:5===V.type&&5===V.renderType||8===V.type}}
Object(y.a)(fa,"GC2FloatingObjectControl",x.a,[])},992:function(y,x,a){a.d(x,"e",function(){return b});a.d(x,"a",function(){return f});a.d(x,"b",function(){return r});a.d(x,"d",function(){return d});a.d(x,"f",function(){return k});a.d(x,"c",function(){return t});var c=a(62);const b=(m,e,w,l,u,n,v,B,z,C,D,J)=>{J=m.Za(9,J);J.chartSource=e;J.chartType=w;J.positionRow=l;J.positionCol=u;J.positionOffsetX=n;J.positionOffsetY=v;return c.h(m,"InsertChart",J,B,z,C,D,0)},f=(m,e,w,l,u,n,v,B,z)=>{z=m.Za(9,z);
z.imageId=e;z.operationType=w;z.propertyValue=l;return c.h(m,"ApplyChartProperty",z,u,n,v,B,0)},r=(m,e,w,l,u,n,v,B,z)=>{z=m.Za(9,z);z.imageId=e;z.contextType=w;z.operationType=l;z.propertyValues=u;return c.h(m,"ApplyChartPropertyDual",z,n,v,B,null,0)},d=(m,e,w,l,u,n,v,B,z,C,D)=>{C=m.Za(1,C);C.ewaControlId=e;C.imageId=w;C.versionId=l;C.chartWidth=u;C.chartHeight=n;C.isAdvancedChartEditingEnabled=D;return c.h(m,"GetChartElementData",C,v,B,null,z,4)},k=(m,e,w,l,u,n,v)=>{const B=m.Za(9);B.sheetName=e;
B.parameters=w;return c.h(m,"InsertInk",B,l,u,n,v,0)},t=(m,e,w,l,u,n,v)=>{const B=m.Za(9);B.sheetName=e;B.selections=w;return c.h(m,"DeleteInkStrokes",B,l,u,n,v,0)}}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.fo.js.map/631681abbe6619b259690a5dd4177a76/EwaTS.fo.js.map