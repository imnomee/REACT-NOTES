'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[2],{1281:function(y,x,a){x=a(476);a=a(1456);a=a.kv?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);x(a,{insert:"head",AC:!1});y.exports=a.oH||{}},1456:function(y,x,a){x=a(477)(!1);x.push([y.i,".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}",
""]);y.exports=x},1457:function(y,x,a){(function(c){a.d(x,"a",function(){return N});var b=a(0),f=a(14),r=a(188),d=a(158),k=a(1458),t=a(38),m=a(283),e=a(45),w=a(419),l=a(212),u=a(62),n=a(86),v=a(12),B=a(24),z=a(44),C=a(1459),D=a(1),J=a(103),W=a(5);class N extends t.a{constructor(M,Q,R,O){super();this.s7i=k.a.getTypeName();this.oSb=this.V3=this.Ah=null;this.imageHeight=this.imageWidth=0;this.b_a=this.errorMessage=this.tableData=null;this.TPd=0;this.ykd=!1;this.Ojf=U=>{if(U){var K={};if((()=>{let P=
z.d(this.T8h(U.data));({hz:K}=P);return P})().returnValue){var F=Object(d.a)(Object,K);if("."===F.DataFromPictureWildcard)if(F.SessionId!==this.b_a)f.ULS.sendTraceTag(523805139,0,10,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(f.ULS.sendTraceTag(523805138,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane"),F.CmdType){case "ACK":this.ykd=!0;
this.aXg.stop();f.ULS.sendTraceTag(523805137,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - SDX pane launched.");this.nwk();0<this.errorMessage.length?this.JJg():0<this.tableData.length&&this.$Jg();break;case "insert_html":const P=this.$.pa.ta,Y={};var I=B.f(this.$).ha.qa.Ui.clone();Y.PasteId=r.a.create().toString();Y.DestinationRanges=e.t(e.w(I,this.$));I=F.Parameters.split("|",3);D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveCCforDataFromPictureXLO",
!1)||f.ULS.sendTraceTag(523805136,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - LCC:${I[0]}|${I[1]}|${I[2]}.`);I=F.Parameters.indexOf("|");I=F.Parameters.indexOf("|",I+1);I=F.Parameters.indexOf("|",I+1);Y.SourceHtml=F.Parameters.substring(I+1);Y.CopyOperationId=null;const ea=P.Za(1,P.Jh());ea.pasteHtmlParameters=Y;w.a(this.$.userOperationManager,(Ba,Fa,za)=>u.h(P,"pasteHtmlContent",ea,Ba,Fa,za,null,64),Ba=>new l.a(204,0,Ba,1),null);this.TPd++;f.ULS.sendTraceTag(523805135,
0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - Number of pastes to workbook per Session ID:${this.TPd.toString()}`);J.b("DataFromPictureCompleted")}}}};this.r7i=(U,K)=>{if(U=K.annotation)if(!K.parentPath||1>=K.parentPath.length||K.parentPath[1]!==this.b_a)f.ULS.sendTraceTag(523805124,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");else{f.ULS.sendTraceTag(523805123,0,50,"DataFromPictureManager.ImageToTableAnnotationHandler() - Annotation Received.");
K=U.errorCode;switch(K){case null:case -1:this.errorMessage=v.a.instance.ia(2273);break;case 1:this.errorMessage=v.a.instance.ia(2274);break;case 2:this.errorMessage=v.a.instance.ia(2275)}0<this.errorMessage.length&&f.ULS.sendTraceTag(523805122,0,10,`DataFromPictureManager.ImageToTableAnnotationHandler() - ErrorCode:${K?K.toString():"null"}.`);this.q3e.stop();this.tableData=U.html;this.ykd&&(0<this.errorMessage.length?this.JJg():0<this.tableData.length&&this.$Jg())}else f.ULS.sendTraceTag(523805125,
0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - Received annotation is null.")};this.$=M;this.ddaFacade=O;this.Bo=Q;this.uploaderCreator=R;this.initialize()}dispose(){window.removeEventListener("message",this.Ojf,!1);this.Bo.unregister("DataFromPicture");super.dispose()}AXj(M,Q){f.ULS.sendTraceTag(523805146,0,50,"DataFromPictureManager.onSuccessfulFileLoad - Start function.");let R=new Image;R.onload=()=>{var O=document.createElement("canvas");O.width=R.width;O.height=R.height;const U=
O.getContext("2d");try{U.drawImage(R,0,0,R.width,R.height)}catch(I){f.ULS.sendTraceTag(523805145,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't draw to canvas. ex.Message: ${I.message}`);return}let K;try{K=O.toDataURL("image/jpeg")}catch(I){f.ULS.sendTraceTag(523805144,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg. ex.Message: ${I.message}`);return}O=K.split(",");if(2>O.length)f.ULS.sendTraceTag(523805143,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg.");
else{O=O[1];try{var F=window.self.atob(O)}catch(I){f.ULS.sendTraceTag(523805142,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't convert image to byte string. ex.Message: ${I.message}`);return}28E5<F.length?(f.ULS.sendTraceTag(523805141,0,15,"DataFromPictureManager.onSuccessfulFileLoad - Image exceeds max size limit."),Q.yLk()):(this.$rk(this.Ah,this.V3,O,R.width,R.height),URL.revokeObjectURL(R.src),R=null,f.ULS.sendTraceTag(523805140,0,50,"DataFromPictureManager.onSuccessfulFileLoad - End function."))}};
R.src=M}b6j(M,Q,R,O){this.Ah=M;this.V3=O;this.uploaderCreator.I$i(this.$,Q,R,O,this)}$rk(M,Q,R,O,U){this.b_a=r.a.create().toString();this.TPd=0;this.oSb=R;this.imageWidth=O;this.imageHeight=U;this.errorMessage=this.tableData="";this.ykd=!1;this.aXg=this.$.qh.Vl("LoadResource","DataFromPictureTaskpaneLaunch");this.aXg.start();this.f_j(M,Q);this.q3e=this.$.qh.Vl("LoadResource","DataFromPictureAnnotation");this.q3e.start();this.I7k()}I7k(){if(this.oSb.length){var M=window.self.atob(this.oSb),Q=new Uint8Array(M.length);
for(let R=0;R<M.length;R++)Q[R]=M.charCodeAt(R);this.Bo.H7k(Q,this.b_a,this.imageWidth,this.imageHeight)}else f.ULS.sendTraceTag(523805134,0,10,"DataFromPictureManager.UploadImageToAugmentationLoop - imageDataBase64 is empty")}f_j(M,Q){Q.SessionID=this.b_a;Q.DataFromPictureAssetId="FA000000050";Q.LoadDataFromPictureTaskpane=!0;M=new n.a(-859308420,M.method,M.mode,M.lk,M.tabName);this.$.Ma.dh(M,Q)}qBd(M){try{const Q=c.from(M,"utf16le").toString("base64");return C.a.kWa(this.b_a,Q)}catch(Q){return f.ULS.sendTraceTag(523805133,
0,10,"DataFromPictureManager.encodeAndEncrypt - Buffer can't encode message."),""}}T8h(M){try{const Q=C.a.kWa(this.b_a,M);return c.from(Q,"base64").toString("utf16le")}catch(Q){return f.ULS.sendTraceTag(523805132,0,50,"DataFromPictureManager.decryptAndDecode - Buffer can't decode message."),""}}nwk(){if(this.oSb.length){var M=W.vb.Ha()?this.ddaFacade.R4("FA000000050"):m.a(this.$).R4("FA000000050"),Q={["DataFromPictureWildcard"]:"."};Q.imageData=this.qBd(this.oSb);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(M,
"onCustomMessage",Q,R=>{R&&f.ULS.sendTraceTag(523805130,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else f.ULS.sendTraceTag(523805131,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")}$Jg(){if(this.tableData.length){var M=W.vb.Ha()?this.ddaFacade.R4("FA000000050"):m.a(this.$).R4("FA000000050"),Q={["DataFromPictureWildcard"]:"."};Q.tableHtml=this.qBd(this.tableData);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(M,
"onCustomMessage",Q,R=>{R&&f.ULS.sendTraceTag(523805128,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else f.ULS.sendTraceTag(523805129,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")}JJg(){if(this.errorMessage.length){var M=W.vb.Ha()?this.ddaFacade.R4("FA000000050"):m.a(this.$).R4("FA000000050"),Q={["DataFromPictureWildcard"]:"."};Q.errorMessage=this.qBd(this.errorMessage);
OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(M,"onCustomMessage",Q,R=>{R&&f.ULS.sendTraceTag(523805126,0,10,"DataFromPictureManager.sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else f.ULS.sendTraceTag(523805127,0,10,"DataFromPictureManager.sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")}initialize(){window.addEventListener("message",this.Ojf,!1);this.Bo.register(this.Bo.e5().B7("DataFromPicture").A7(()=>
{}).activateAnnotation({annotationType:this.s7i,bB:!1,pY:this.r7i}).build())}}Object(b.a)(N,"DataFromPictureManager",t.a,[870])}).call(this,a(766).Buffer)},1458:function(y,x,a){a.d(x,"a",function(){return b});y=a(0);x=a(920);var c=a(893);class b extends x.a{constructor(){super();this.html=this.errorDescription=this.errorCode=null;this.H_=Object.assign(new c.a,{T_:b.getTypeName(),B_:b.getBaseTypes()})}static getTypeName(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}
Object(y.a)(b,"DetectedHtmlTableAnnotation",x.a,[])},1459:function(y,x,a){a.d(x,"a",function(){return c});y=a(0);class c{static kWa(b,f){if(!(b&&f&&b.length&&f.length)||256<b.length)return"";const r=Array(256),d=Array(256);let k,t=0,m=0;let e,w="";for(k=0;256>k;k++)r[k]=k;for(k=0;256>k;k++){var l=b.charCodeAt(k%b.length);if(256<=l)return"";t=(t+r[k]+l)%256;l=r[k];r[k]=r[t];r[t]=l}for(k=0;256>k;k++)d[k]=r[256-k-1];t=k=0;for(b=0;b<f.length;b++){k=(k+1)%256;t=(t+r[k])%256;l=r[k];r[k]=r[t];r[t]=l;l=f.charCodeAt(b);
if(256<=l)return"";e=l^r[(r[k]+r[t])%256];m=(m+d[k])%256;l=d[k];d[k]=d[m];d[m]=l;w+=String.fromCharCode(e^r[(d[k]+d[m])%256])}return w}}Object(y.a)(c,"RC4A",null,[])},190:function(y,x,a){function c(A,ja){if(!ja)return A;ja=ja.sheet;if(!ja)return A;ja=ja.cssRules;if(!ja)return A;var Ua=Array.clone(ja);Ua.reverse();let ac=ja=0,Ec=0,gd=0;for(const Jd of Ua){Ua=Jd.style;var ad=Jd.selectorText;Ua=Ua?Ua.cssText:null;ad=ad?ad.split(","):null;if(Ua&&ad&&Jd.type===Jd.STYLE_RULE){gd+=ad.length;for(const De of ad){0<=
De.indexOf("#")&&ja++;0<=De.indexOf(".")&&ac++;0>De.indexOf("#")&&0>De.indexOf(".")&&Ec++;ad=null;try{ad=A.querySelectorAll(De)}catch(Xe){F.ULS.sendTraceTag(507536148,0,50,"Exception in querySelectorAll: {0}",Xe.message)}if(ad)for(let Xe=0;Xe<ad.length;Xe++)ad[Xe].setAttribute("style",Ua+(ad[Xe].getAttribute("style")||""))}}}F.ULS.sendTraceTag(507536147,0,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",gd,ja,ac,Ec);return A}function b(A){if(void 0===A||
-1===A.indexOf("px"))return 0;A=A.match(Be);let ja=11;A&&(1===A.length?ja=parseFloat(A[0]):3===A.length&&(ja=parseFloat(A[1])));return Nd.HelperMethods.NPc(ja)}function f(A){const ja=[];if("none"!==A.borderTopStyle&&""!==A.borderTopStyle){var Ua=b(A.borderTopWidth);ja.push({BorderLineStyle:r(A.borderTopStyle,Ua),BorderPosition:0,Weight:Ua,Color:d(A.borderTopColor)})}"none"!==A.borderBottomStyle&&""!==A.borderBottomStyle&&(Ua=b(A.borderBottomWidth),ja.push({BorderLineStyle:r(A.borderTopStyle,Ua),BorderPosition:1,
Weight:Ua,Color:d(A.borderBottomColor)}));"none"!==A.borderLeftStyle&&""!==A.borderLeftStyle&&(Ua=b(A.borderLeftWidth),ja.push({BorderLineStyle:r(A.borderTopStyle,Ua),BorderPosition:2,Weight:Ua,Color:d(A.borderLeftColor)}));"none"!==A.borderRightStyle&&""!==A.borderRightStyle&&(Ua=b(A.borderRightWidth),ja.push({BorderLineStyle:r(A.borderTopStyle,Ua),BorderPosition:3,Weight:Ua,Color:d(A.borderRightColor)}));return ja}function r(A,ja){switch(A){case "solid":return 1>ja?1:1.5>ja?2:5;case "dashed":return 1>
ja?3:8;case "double":return 6;case "dotted":return 4;case "dotDash":return 10;case "dotDotDash":return 1>ja?12:10;case "dotDashSlanted":return 13;case "triple":return 6;case "hairline":return 7;default:return 0}}function d(A){const ja={};if(void 0===A||""===A)return ja.Red=0,ja.Green=0,ja.Blue=0,ja;ea.a.compare(A,"windowtext",!0)?(A=Pa.a.tu(A),ja.Red=A.r,ja.Green=A.g,ja.Blue=A.b):(ja.Red=0,ja.Green=0,ja.Blue=0);return ja}function k(A){A=Pa.a.tu(A);return Pa.a.lJ(A)}function t(A,ja,Ua,ac,Ec){if(ja&&
A.parentElement){Ua.fontFamily="Aptos Narrow";if(Ec.map(Jd=>Jd.lGa.fontFamily).some(Jd=>Jd)&&ja.fontFamily){var gd=ja.fontFamily.replace(/['"]+/g,"").split(",");0<gd.length&&(de.hasOwnProperty(gd[0])?Ua.fontFamily=de[gd[0]]:Ua.fontFamily=gd[0])}Ua.fontSize=11;gd=Ec.map(Jd=>Jd.lGa.fontSize);const ad=Ec.map(Jd=>Jd.element.tagName);(gd.some(Jd=>Jd)||ad.some(Jd=>Wh.includes(Jd)))&&ja.fontSize&&(Ua.fontSize=Math.round(b(ja.fontSize)));ja.fontWeight&&700<=parseInt(ja.fontWeight,10)&&(Ua.bold=!0);Ua.borders=
f(ja);ja.textDecoration&&"underline"===ja.zXg&&("solid"===ja.AXg?Ua.Lte=1:"double"===ja.AXg&&(Ua.Lte=2));ja.textDecoration&&"line-through"===ja.zXg&&(Ua.wyf=!0);Ua.color="#000000";Ec.map(Jd=>Jd.lGa.color).some(Jd=>Jd)&&ja.color&&(Ua.color=k(ja.color));ac&&(A=A.parentElement.closest("td,th"),Ua.backgroundColor=A.style.backgroundColor?k(A.style.backgroundColor):"");if("italic"===ja.fontStyle||"oblique"===ja.fontStyle)Ua.italic=!0}return Ua}a.r(x);var m={};a.r(m);a.d(m,"FocusBasedReadout",function(){return Za});
var e={};a.r(e);a.d(e,"AriaLiveNotifier",function(){return ab});var w={};a.r(w);a.d(w,"DataFromPictureCommandHandler",function(){return ua});var l={};a.r(l);a.d(l,"EmbeddedWorkbookReadoutHandler",function(){return Ka});var u={};a.r(u);a.d(u,"EwaAccessibilityManager",function(){return Hb});var n={};a.r(n);a.d(n,"GridHighlightBehaviorEventManager",function(){return Gb});var v={};a.r(v);a.d(v,"GridHighlightsBehaviorManager",function(){return Bc});var B={};a.r(B);a.d(B,"PictureCommandHandler",function(){return Ce});
var z={};a.r(z);a.d(z,"PasteShortcutManager",function(){return of});var C={};a.r(C);a.d(C,"SelectionReadoutHandler",function(){return Cd});var D={};a.r(D);a.d(D,"SessionReloadActivity",function(){return $e});var J={};a.r(J);a.d(J,"SessionReloadSilentActivity",function(){return S});var W={};a.r(W);a.d(W,"SparklineManager",function(){return zb});var N={};a.r(N);a.d(N,"TableManager",function(){return ke});var M={};a.r(M);a.d(M,"UploaderCreator",function(){return qg});var Q={};a.r(Q);a.d(Q,"WorkbookReadoutHandler",
function(){return jh});var R={};a.r(R);a.d(R,"HtmlProcessor",function(){return Tf});var O={};a.r(O);a.d(O,"PastableIframe",function(){return Xf});var U=a(179),K=a(0),F=a(14),I=a(68),P=a(7),Y=a(16),ea=a(27),Ba=a(12),Fa=a(431),za=a(24),xa=a(31);class fa{constructor(A){this.wUc=A||""}static get jpf(){return fa.XHe||(fa.XHe=new fa(""))}static get f1d(){return fa.DOe||(fa.DOe=fa.Dfa(2).wUc)}static Yva(A){A=xa.a.Xq(A||"");return new fa(A)}static OOb(A){return fa.Yva(Ba.a.instance.ia(A))}static Dfa(A){return new fa(Ba.a.instance.Ba(A))}static ozf(A,
...ja){return fa.nyi(Ba.a.instance.$g(A),...ja)}static nyi(A,...ja){const Ua=ja.length,ac=Array(Ua);for(let Ec=0;Ec<Ua;Ec++)ac[Ec]=(ja[Ec]||fa.jpf).wUc;return new fa(String.format(A,ac))}}fa.XHe=null;fa.DOe=null;Object(K.a)(fa,"SafeHtml",null,[251]);const V=(A,ja)=>{ja&&(A.append(ja),A.append(fa.f1d))};var ba=a(1),la=a(180),Ta=a(125),Ea=a(2),sa=a(386),Ya=a(163),bb=a(111),ra=a(934),Da=a(34),oa=a(245),Ha=a(5),ka=a(97),wa;let Za=wa=class{constructor(A,ja,Ua){this.yba=this.p1=this.mV=null;this.Uva=Ha.pc.Ha()?
ja.cellTextEditBox.$b.Ll:Ua;this.p5h(A);this.W5j()}get isActive(){return!!this.Uva&&document.activeElement===this.Uva}readText(A){A=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:7663175_RemoveGridBeingReadoutInFocusBasedReadout")?A:String.format(Ba.a.instance.$g(30),A);this.mV.setAttribute(P.a.RC,A);this.p1.setAttribute(P.a.RC,A);this.OTk()}dispose(){this.yba&&this.yba.parentNode&&this.yba.parentNode.removeChild(this.yba);this.p1=this.mV=this.yba=this.Uva=null}p5h(A){var ja=A.$h+"readoutElementWrapper";
const Ua=A.$h+"readoutElement1",ac=A.$h+"readoutElement2";this.yba=document.getElementById(ja);this.yba||(this.yba=document.createElement(oa.a.div),this.yba.id=ja,this.mV=document.createElement(oa.a.label),this.mV.id=Ua,this.mV.setAttribute(P.a.Oj,P.a.fmc),this.mV.setAttribute("aria-roledescription",""),this.mV.setAttribute("aria-multiline",!1),this.p1=document.createElement(oa.a.label),this.p1.id=ac,this.p1.setAttribute(P.a.Oj,P.a.fmc),this.p1.setAttribute("aria-roledescription",""),this.p1.setAttribute("aria-multiline",
!1),this.mV.style.width="0px",this.mV.style.height="0px",this.p1.style.width="0px",this.p1.style.height="0px",this.mV.tabIndex=-1,this.p1.tabIndex=-1,this.yba.appendChild(this.mV),this.yba.appendChild(this.p1),A=A.$h+P.a.Wpc,ja=document.getElementById(A),F.ULS.shipAssertTag(537153942,3,!!ja,`FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: ${A}`),ja&&ja.appendChild(this.yba))}W5j(){this.Uva&&this.mV&&this.p1&&(this.Uva.setAttribute(P.a.dea,this.mV.id),this.Uva.setAttribute(P.a.emc,
`${this.mV.id} ${this.p1.id}`))}OTk(){if(ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8194559_StaleValueReadoutFixEnabled")||this.isActive){let A="";Y.DOMElementExtensions.hasAttribute(this.Uva,P.a.dea)&&(A=this.Uva.getAttribute(P.a.dea).toString());this.Uva.setAttribute(P.a.dea,A===this.mV.id?this.p1.id:this.mV.id)}this.isActive||F.ULS.sendTraceTag(537153941,0,50,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")}static kmb(){if(null==wa.xOb)if(Da.a.Una){if(wa.xOb=!1,Da.a.YO||Da.a.hm)wa.xOb=
!0}else wa.xOb=!0;return wa.xOb}};Za.xOb=null;Za=wa=Object(U.__decorate)([Object(ka.d)(Ha.pc),Object(U.__param)(0,Object(Ha.Lb)()),Object(U.__param)(1,Object(Ha.dd)())],Za);Object(K.a)(Za,"FocusBasedReadout",null,[222,2]);let ab=class{constructor(A,ja,Ua,ac){Ua=void 0===Ua?A.VJ:Ua;ac=void 0===ac?A.ll:ac;this.GJg=()=>{if(!this.$.ea.Ph){var Ec={["AriaLiveOffCount"]:this.$De,["AriaLivePoliteCount"]:this.aEe,["AriaLiveAssertiveCount"]:this.ZDe,["AriaLiveRudeCount"]:this.bEe,["ScreenReaderDivCount"]:this.XTe,
["AlertScreenReaderDivCount"]:this.JDe,["AuxScreenReaderDivCount"]:this.jEe,["AriaAlertCount"]:this.XDe,["ReadCommandOnCompletionCount"]:this.ASe,["TotalAriaLiveRegionUpdates"]:this.HWe};la.a.sendTelemetryEvent(Object(Ea.a)(new sa.a,{name:"Office.Excel.Online.Accessibility.AriaLiveNotifier",dataFields:Ta.a.rn(Ec)}))}};this.$=A;this.ji=void 0===ja?null:ja;this.kja=document.createElement("div");this.kja.setAttribute(P.a.eea,P.a.pr);this.kja.className=I.J;Ua.insertBefore(this.kja,ac);this.lka=document.createElement("div");
this.lka.setAttribute(P.a.eea,P.a.pr);this.lka.className=I.J;Ua.insertBefore(this.lka,this.kja);this.slh=Ba.a.instance.Ba(2);this.hea=document.createElement("div");this.hea.setAttribute(P.a.Oj,P.a.Kta);this.hea.setAttribute(P.a.Lta,P.a.FUa);this.hea.className=I.J;Ua.insertBefore(this.hea,this.lka);this.HWe=this.ASe=this.XDe=this.jEe=this.JDe=this.XTe=this.bEe=this.ZDe=this.aEe=this.$De=0;this.register();ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)||
this.$.ka.ph(211,this)}get $1a(){return this.slh}get isActive(){return!0}get MCh(){return this.kja}get buk(){return this.lka}get activeCell(){return za.f(this.$).kh(null)}dispose(){this.$&&this.unregister();Y.DOMElementExtensions.Km(this.hea);Y.DOMElementExtensions.Km(this.kja);Y.DOMElementExtensions.Km(this.lka);this.lka=this.kja=this.hea=this.$=null}setEnabled(A){this.sLg(this.lka,A)}Jzk(){this.sLg(this.kja,!0)}readText(A){this.b2b(fa.Yva(A),!0)}xba(A){this.b2b(fa.Yva(A),!1)}Ixg(A,ja){if(1>ja||
!A)F.ULS.shipAssertTag(537153954,0,!1,"Skiping listbox description readout");else{var Ua=new Sys.StringBuilder;A=String.format(Ba.a.instance.$g(34),ja,A);V(Ua,A);V(Ua,Ba.a.instance.ia(857));this.b2b(fa.Yva(Ua.toString()),!1)}}mbk(A,ja,Ua){if(1>Ua||1>ja||ja>Ua||!A)F.ULS.shipAssertTag(537153952,0,!1,"Skipping listbox item readout");else{var ac=new Sys.StringBuilder;V(ac,A);ac.append(String.format(Ba.a.instance.$g(55),ja,Ua));this.b2b(fa.Yva(ac.toString()),!1)}}kbk(A){A=this.YSi(A);this.b2b(A,!1,!0)}b2b(A,
ja,Ua){Ua=void 0===Ua?!1:Ua;if(A=A?A.wUc:null)ja=ja?this.lka:this.kja,ea.a.equals(ja.innerHTML,A,!1)&&(A+=fa.f1d),this.mZg(ja,Ua),this.ji.hr(ja,A)}E4a(A,ja){this.hea.getAttribute(P.a.Lta)!==ja&&this.hea.setAttribute(P.a.Lta,ja);A=A?fa.Yva(A).wUc:"";this.mZg(this.hea);this.ji.hr(this.hea,A)}nbk(A,ja,Ua,ac){var Ec=!0;Ec=void 0===Ec?!1:Ec;const gd=Ba.a.instance.$g(54);F.ULS.shipAssertTag(537153949,0,!(void 0===A||null===A));F.ULS.shipAssertTag(537153948,0,!(void 0===ja||null===ja));F.ULS.shipAssertTag(537153947,
0,!(void 0===Ua||null===Ua));F.ULS.shipAssertTag(537153946,0,!(void 0===ac||null===ac));F.ULS.shipAssertTag(537153945,0,!(void 0===gd||null===gd));A=String.format(gd,A||"",ja||"",Ua||"",ac||"");Ec?this.E4a(A,P.a.DFa):this.readText(A)}U2k(A){var ja=this.lka.style;A?(A=Fa.a.GMh(A.cell,ja),ja=A.LH,ja.top=ja.left=ja.bottom=ja.right=null,A.Zda()):ja.cssText=""}YSi(A){if(6!==A.lk)return null;const ja=this.activeCell;if(!ja)return null;switch(A.command){case -1985798686:return fa.OOb(12);case -911352779:return fa.OOb(11);
case 237279923:return fa.OOb(13);case -1502853784:return fa.Dfa(81);case -111689794:return fa.Dfa(78);case 368460465:A=za.f(this.$).Yg.sl(ja.range,!0);if(null!==A)return this.cZa(2291,!A.hasAutoFilter,!1);A=this.$.sa.na;if(!A)break;return this.cZa(2291,null===A.WK,!1);case -1522760979:return this.cZa(1150,za.f(this.$).isFormulaView,!1);case 1941920197:return fa.OOb(836);case 1051390410:return fa.Dfa(589);case 1542466017:return fa.Dfa(591);case -706918724:return fa.Dfa(590);case 369708605:return fa.Dfa(592);
case -1215659745:return fa.Dfa(523);case 1783960667:return fa.Dfa(521);case -1355155015:return fa.Dfa(554);case -1158102843:return fa.Dfa(522);case -287251124:return A=this.sFc(A.command,ja),null===A?null:this.cZa(1333,A);case -1925065947:return A=this.sFc(A.command,ja),null===A?null:this.cZa(1334,A);case 1764140053:return A=this.sFc(A.command,ja),null===A?null:this.cZa(1335,A);case -1590502662:return A=this.sFc(A.command,ja),null===A?null:this.cZa(1336,A);case 862890474:case 963349338:A=this.QIa(ja);
if(null===A)break;A=fa.Yva(String(A));return fa.ozf(214,A);case 1896159024:return fa.Yva(Ba.a.instance.$g(228));case -1554384558:return fa.Yva(Ba.a.instance.$g(229))}return null}register(){F.ULS.shipAssertTag(537153944,0,!!this.$,"Can't register to ewaControl's events");this.$&&(F.ULS.shipAssertTag(537153943,0,!!this.$.Ma,"Can't register to CommandHandlerManager's event"),this.$.ea&&this.$.ea.EL(this.GJg))}unregister(){this.$&&this.$.ea.TM(this.GJg)}sLg(A,ja){const Ua=A===this.kja;ja?(Ua&&Za.kmb()||
A.setAttribute(P.a.Lta,P.a.DFa),Ua&&A.setAttribute(P.a.Oj,P.a.Kta),A.setAttribute(P.a.eea,P.a.RB),A.removeAttribute(P.a.eea),this.ji.hr(A,A.innerHTML+" ")):(A.removeAttribute(P.a.Lta),Ua&&A.removeAttribute(P.a.Oj),A.setAttribute(P.a.eea,P.a.pr))}mZg(A,ja){ja=void 0===ja?!1:ja;switch(A.getAttribute(P.a.Lta)){case P.a.u5e:++this.$De;break;case P.a.DFa:++this.aEe;break;case P.a.FUa:++this.ZDe;break;case P.a.RFh:++this.bEe}switch(A){case this.buk:++this.XTe;break;case this.MCh:++this.JDe;break;case this.hea:++this.jEe}A.getAttribute(P.a.Oj)===
P.a.Kta&&++this.XDe;ja&&++this.ASe;this.HWe++}cZa(A,ja,Ua){Ua=void 0===Ua?!0:Ua;return fa.ozf(ja?Ua?7:216:Ua?8:217,fa.OOb(A))}sFc(A,ja){return za.f(this.$).ha.$e.isFloatingObjectSelected?this.Qij(A):this.Rij(A,ja)}Qij(A){const ja={};switch(A){case -287251124:A="QueryBold";break;case -1925065947:A="QueryItalics";break;case 1764140053:A="QueryUnderline";break;case -1590502662:A="QueryStrikethrough";break;default:return!1}const Ua=bb.a(this.$);return Ua?(Ua.CZa(A,ja),ja[ra.a.On]):!1}Rij(A,ja){if(!ja)return null;
var Ua=za.f(this.$);ja=Ya.a(ja);Ua.isEditing&&(ja.Font=Ua.fp.RIa(ja.Font));Ua=ja.Font;switch(A){case -287251124:return Ua.Bold;case -1925065947:return Ua.Italic;case 1764140053:return Ua.Underline;case -1590502662:return Ua.Strikethrough}return!1}QIa(A){if(!A)return null;const ja=za.f(this.$);if(ja.ha.$e.isFloatingObjectSelected)return null;A=Ya.a(A);ja.isEditing&&(A.Font=ja.fp.RIa(A.Font));return A.Font.FontSize}};ab=Object(U.__decorate)([Object(ka.d)(Ha.l),Object(U.__param)(0,Object(Ha.Lb)()),Object(U.__param)(1,
Object(Ha.kd)())],ab);Object(K.a)(ab,"AriaLiveNotifier",null,[221,222,2]);var db=a(99),mb=a(6),Ia=a(1457),pa=a(266),lb=a(209),ha=a(66);let ua=class{constructor(A,ja,Ua,ac){this.yLb=null;this.$=A;this.ddaFacade=ac;ja?(F.ULS.sendTraceTag(537163346,0,50,"DataFromPictureCommandHandler.constructor - AugmentationLoopManager and UploaderCreator instantiated."),this.yLb=new Ia.a(A,ja,Ua,this.ddaFacade)):F.ULS.sendTraceTag(537163347,0,10,"DataFromPictureCommandHandler.constructor - Failed to instantiate AugmentationLoopManager.")}Bi(){return!1}executeCommand(A,
ja,Ua){A=!1;switch(ja.command){case 73979048:this.yLb&&this.yLb.b6j(ja,db.TaskManager.instance,mb.AFrameworkApplication.fa,Ua),A=!0}return A?ha.Task.Va(!0):lb.a(ja.command)}ni(A,ja){return 73979048===ja.command&&mb.AFrameworkApplication.Baa(pa.a)}Ji(){return!1}dispose(){this.yLb&&this.yLb.dispose()}};ua=Object(U.__decorate)([Object(ka.d)(Ha.ob),Object(U.__param)(0,Object(Ha.Lb)()),Object(U.__param)(1,Object(Ha.p)()),Object(U.__param)(2,Object(Ha.wg)()),Object(U.__param)(3,Object(Ha.vb)())],ua);Object(K.a)(ua,
"DataFromPictureCommandHandler",null,[39,2]);class fb{constructor(A,ja){this.$=ja;this.ariaLiveNotifier=A}Mxg(){const A=this.MCi();this.ariaLiveNotifier.E4a(A,P.a.FUa)}MCi(){const A=new Sys.StringBuilder;this.$.workbookContext&&V(A,this.$.workbookContext.WorkbookFileName);V(A,Ba.a.instance.ia(855));V(A,this.OCi());V(A,this.NCi());V(A,Ba.a.instance.ia(856));return A.toString()}OCi(){return this.$.isEditMode?Ba.a.instance.ia(860):Ba.a.instance.ia(861)}NCi(){var A=this.aal();const ja=this.$.sa.na;A=
1!==A?String.format(Ba.a.instance.$g(32),A):Ba.a.instance.ia(854);A=new Sys.StringBuilder(A);ja&&ja.sheetName&&(A.append(fa.f1d),A.append(String.format(Ba.a.instance.$g(33),ja.sheetName)));return A.toString()}aal(){let A=0;for(const ja of this.$.sa.items)ja.visible&&A++;return A}}Object(K.a)(fb,"WorkbookReadout",null,[]);let Ka=class{constructor(A,ja,Ua){this.hjg=()=>{this.Bze.Mxg();this.ariaLiveNotifier.setEnabled(!0)};this.$=ja;this.ariaLiveNotifier=A;this.Bze=new fb(A,ja);this.Mwc=Ua.VKd(this.$);
this.Mwc.gzh(this.hjg)}dispose(){this.Mwc&&this.Mwc.Gjk(this.hjg);this.Mwc=this.ariaLiveNotifier=this.$=null}};Ka=Object(U.__decorate)([Object(ka.d)(Ha.Ib),Object(U.__param)(0,Object(Ha.l)()),Object(U.__param)(1,Object(Ha.Lb)()),Object(U.__param)(2,Object(Ha.Cf)())],Ka);Object(K.a)(Ka,"EmbeddedWorkbookReadoutHandler",null,[2]);var La=a(159),ib=a(279),Yb=a(478),Wc=a(661),Qc=a(475),Wb=a(105),Jc=a(301),ma=a(162),Hc=a(90),Kb=a(304),pc=a(79),$b=a(40),Ib=a(86),Zb=a(74),Eb=a(667),ob=a(25);class Na extends Wb.a{constructor(A,
ja){super(A);this.S2=[];this.WMe=null;this.G5a=Ua=>{let ac="forward";Ua.Values[Yb.a.direction]?ac=Ua.Values[Yb.a.direction].toLowerCase():F.ULS.sendTraceTag(537166664,0,15,"Didn't find direction in message values");Ua=0;let Ec=!0;"backward"===ac?(Ua=this.UYd.length-1,Ec=!1):"forward"===ac?(Ua=0,Ec=!0):F.ULS.sendTraceTag(537166663,0,15,`Received unknown direction to resume focus: ${ac}`);this.Z$f(Ec,Ua,!1)};this.fjg=()=>{this.S2=[]};this.h3a=Ua=>{this.$.shortcutKeyManager.Eck(Ua);-411645385===this.$.shortcutKeyManager.dD(Ua)&&
this.CXf()&&(this.$.Ma.dh(new Ib.a(-411645385,1,this.$.Rh,6,null),{["event"]:Ua},Ua),Ua.stopPropagation())};this.DSj=Ua=>{this.iza(Ua)};this.fh=ja;this.PD=za.f(this.fh);this.Wi.Aa("keydown",this.DSj);this.Wi.Aa("keyup",this.h3a);Jc.a(ja).FAh(this.fjg);Hc.a(ja.ua,27)&&(Ha.id.Ha()?void ka.a.resolve(Ha.id,{va:1}).then(Ua=>{Ua.Tq(La.a.sCc);Ua.Ip(La.a.sCc,this.G5a)}):$b.TaskExtensions.Ua(pc.GetServiceTaskFactory.Bj(ja.ka,21,137,1),Ua=>{Ua=Ua.result;Ua.Tq(La.a.sCc);Ua.Ip(La.a.sCc,this.G5a)},ja.xa))}get $(){return this.fh}get UYd(){this.S2.length||
(this.S2=this.pFf());return this.S2}get jya(){return this.WMe}set jya(A){this.WMe=A;this.S2=this.pFf()}dispose(){this.$&&Jc.a(this.$).Qkk(this.fjg);this.fh=null;this.S2.length=0;super.dispose()}F7j(A){this.iza(A)}Z$f(A,ja,Ua,ac){ac=void 0===ac?null:ac;var Ec=this.JTk(A,ja,void 0===Ua?!0:Ua,ac);if(!Ec){Ua=ja;var gd=A?1:-1,ad=this.UYd;do{Ec=!1;if(Hc.a(this.$.ua,27)){if(Ua+=gd,Ua>=ad.length||0>Ua)Ec=!0}else Ua=(Ua+gd+ad.length)%ad.length;if(Ec){this.bAj(A,ja,ac);break}else if(Ec=this.vWg(A,ja,Ua,!1,
ac))break}while(Ua!==ja)}}JTk(A,ja,Ua,ac){ac=void 0===ac?null:ac;let Ec=null;0<=ja&&(Ec=this.S2[ja]);return(null===Ec||void 0===Ec?0:Ec.Co)&&Ec.zp(A,void 0===Ua?!0:Ua)?(ac&&Zb.g(ac),F.ULS.sendTraceTag(537166669,0,50,`Switched focus inside current section ${Ec.Hk} into a sub region`),Ec.gs(),!0):!1}vWg(A,ja,Ua,ac,Ec){Ec=void 0===Ec?null:Ec;Ua=this.S2[Ua];const gd=Jc.a(this.fh).yF(ib.a.eIa),ad=Jc.a(this.fh).yF(ib.a.bRb),Jd=this.PD.ha.$e.isFloatingObjectSelected;if(Ua===ad&&Jd||Ua===gd&&!ac&&!Jd)return!1;
if((null===Ua||void 0===Ua?0:Ua.Co)&&Ua.zp(A,!1)){Ec&&Zb.g(Ec);Ua.gs();if(A=this.S2[ja])A.Xt(),F.ULS.sendTraceTag(537166668,0,50,`Switched focus from section ${A.Hk} to ${Ua.Hk}`);return!0}return!1}bAj(A,ja,Ua){(Ua=void 0===Ua?null:Ua)&&Zb.g(Ua);if(ja=this.S2[ja])ja.Xt(),F.ULS.sendTraceTag(537166666,0,50,`Lost focus from section ${ja.Hk}`);Ha.id.Ha()?void ka.a.resolve(Ha.id,{va:0}).then(ac=>{ac.sendMessage(La.a.SEa,{[Yb.a.direction]:A?"forward":"backward"})}):$b.TaskExtensions.Ua(pc.GetServiceTaskFactory.Bj(this.$.ka,
21,137,0),ac=>{ac.result.sendMessage(La.a.SEa,{[Yb.a.direction]:A?"forward":"backward"})},this.$.xa)}iza(A){var ja=this.$.isEditMode?ma.a(this.$):null;Na.kXf(ja)&&this.$.shortcutKeyManager.w_k(A,ja.ns);if(!this.$.ih.Qna||Na.kXf(ja))if(117===A.keyCode&&(A.ctrlKey||Zb.b(A))){ja=this.xIf(A.target);var Ua=!A.shiftKey;F.ULS.sendTraceTag(537166662,0,50,`AccessibilityManager.OnKeyDownHandler: Ctrl+F6 loop. The root index section is: ${ja}`);var ac=Jc.a(this.fh).yF(ib.a.c4b);ac=this.S2.indexOf(ac);mb.AFrameworkApplication.ra.$d.HI&&
this.$.a6&&-1!==ac&&ja===ac&&Wc.a.eX(this.$.g7b,0);this.Z$f(Ua,ja,!0,A)}else 117!==A.keyCode||Na.Pvf?-411645385===this.$.shortcutKeyManager.dD(A)?this.CXf()&&(this.$.Ma.dh(new Ib.a(-411645385,1,this.$.Rh,6,null),{["event"]:A},A),A.stopPropagation()):1588554917===this.$.shortcutKeyManager.dD(A)?0===this.mode?(Eb.a(this.$)||this.$.Ma.dh(new Ib.a(1588554917,1,this.$.Rh,6,null),{["event"]:A},A),A.preventDefault(),A.stopPropagation()):3===this.mode&&(A.preventDefault(),A.stopPropagation()):1058684758===
this.$.shortcutKeyManager.dD(A)?(ja=this.xIf(A.target),ac=Jc.a(this.fh).yF(ib.a.c4b),Ua=Jc.a(this.fh).yF(ib.a.eIa),ac=this.S2.indexOf(ac),Ua=this.S2.indexOf(Ua),mb.AFrameworkApplication.ra.$d.HI&&this.$.a6&&-1!==ac&&ja===ac&&1===this.$.g7b&&Wc.a.eX(1,0),-1!==Ua&&ja!==Ua&&this.vWg(!0,ja,Ua,!0,A)):ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8198803_AddingScopeToShortcuts")&&1===this.$.shortcutKeyManager.DUi(A)?(ja=this.$.shortcutKeyManager.dD(A),F.ULS.sendTraceTag(508342917,0,50,`AccessibilityManager.OnKeyDownHandler : RibbonCommand ${ja} fired in ${this.mode} mode`),
0===this.mode?(this.$.Ma.dh(new Ib.a(ja,1,this.$.Rh,6,null)),A.preventDefault(),A.stopPropagation()):4===this.mode&&-1966746939===ja&&(A.preventDefault(),A.stopPropagation())):this.B0i(A):(A=Kb.a.IA.AK.mX(Qc.a.$Ii(),!1),A.image=ob.a.Rmb()?3:0,Kb.a.IA.AK.eF(A),Na.Pvf=!0)}xIf(A){const ja=this.UYd;for(let Ua=0,ac=ja.length;Ua<ac;++Ua){const Ec=ja[Ua];if(Ec&&Ec.Yp(A))return Ua}return-1}pFf(){const A=[];for(let ja=0,Ua=this.jya.length;ja<Ua;ja++){const ac=Jc.a(this.$).yF(this.jya[ja]);ac&&A.push(ac)}return A}CXf(){return 0===
this.mode||4===this.mode}static kXf(A){return A?A.inKeytipMode:!1}}Na.Pvf=!1;Object(K.a)(Na,"AccessibilityManager",Wb.a,[868,2]);var nb=a(176);let Hb=class extends Na{constructor(A){super(document.documentElement,A);this.xL=0;this.gIh=[ib.a.Sff,ib.a.c5d,ib.a.VBc,ib.a.Due,ib.a.c4b,ib.a.Brd,ib.a.hGd,ib.a.pLf,ib.a.Cqd,ib.a.nte,ib.a.NOk,ib.a.UOg,ib.a.bRb,ib.a.bzf,ib.a.Bsd,ib.a.eIa,ib.a.ooe,ib.a.Fsd,ib.a.LUg,ib.a.V3f,ib.a.Zqd];this.C$k=[ib.a.VBc,ib.a.F5g,ib.a.E5g,ib.a.G5g];this.e7j=[ib.a.VBc,ib.a.$tg,
ib.a.aug,ib.a.dug];this.XQh=[ib.a.Ryf,ib.a.oLf,ib.a.Qyf,ib.a.Nyf,ib.a.Xjf];this.B6j=[ib.a.Sff,ib.a.c5d,ib.a.Brd,ib.a.hGd,ib.a.Cqd,ib.a.nte,ib.a.bRb,ib.a.Bsd,ib.a.eIa,ib.a.ooe,ib.a.qtg,ib.a.Fsd,ib.a.Zqd];this.R6j=[ib.a.bRb,ib.a.lGd];const ja=Ba.a.instance.Ba(253);this.mAk=this.$.shortcutKeyManager.Ljb(ja);this.mode=0;Ha.id.Ha()?void ka.a.resolve(Ha.id,{va:1}).then(Ua=>{Ua.Tq(La.a.SEa);Ua.Ip(La.a.SEa,this.G5a)}):$b.TaskExtensions.Ua(pc.GetServiceTaskFactory.Bj(A.ka,21,137,1),Ua=>{Ua=Ua.result;Ua.Tq(La.a.SEa);
Ua.Ip(La.a.SEa,this.G5a)},A.xa)}get mode(){return this.xL}set mode(A){this.xL=A;switch(A){case 0:this.jya=this.gIh;break;case 2:this.jya=this.C$k;break;case 3:this.jya=this.e7j;break;case 4:this.jya=this.XQh;break;case 5:this.jya=this.B6j;break;case 6:this.jya=this.R6j;break;default:F.ULS.shipAssertTag(537170759,0,!0,"Accessibility Mode value is not in allowed values")}}iza(A){this.$.wj&65536&&super.iza(A)}B0i(A){if(ea.a.equals(this.mAk,this.$.shortcutKeyManager.GJd(A),!1)){const ja=nb.b(this.$);
if(null===ja||void 0===ja?0:ja.Co)Zb.g(A),ja.zp(!0,!1)}}};Hb=Object(U.__decorate)([Object(ka.d)(Ha.Kb),Object(U.__param)(0,Object(Ha.Lb)())],Hb);Object(K.a)(Hb,"EwaAccessibilityManager",Na,[]);var na=a(38);let Gb=class extends na.a{constructor(){super()}WAh(A){this.addHandler("TAF",A)}hlk(A){this.removeHandler("TAF",A)}f$j(){this.raiseEvent("TAF")}};Gb=Object(U.__decorate)([Object(ka.d)(Ha.Zc),Object(U.__param)(0,Object(Ha.Lb)())],Gb);Object(K.a)(Gb,"GridHighlightBehaviorEventManager",na.a,[857,2]);
var Xa=a(80),Jb=a(302),qb=a(17),Db=a(193),gb=a(137);class ya extends Sys.EventArgs{constructor(A,ja){super();this.start=A;this.DSb=ja}}Object(K.a)(ya,"MarqueeResizeStartedOrEndedEventArgs",Sys.EventArgs,[]);class Aa extends na.a{constructor(A){super();this.j9f=[3];this.J$a=void 0;this.da=A}get cD(){if(this.J$a)return this.J$a;const A=Ha.zc.Ha()?ka.a.Zg(Ha.zc):this.da.$.ka.Ug(464);A||F.ULS.sendTraceTag(510255179,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaAssistanceManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");
A.cD||F.ULS.sendTraceTag(510255178,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaHighlightsControl is null.");return this.J$a=A.cD}tzh(A){this.addHandler("mrek",A)}ypa(A,ja,Ua){for(const ac of this.da.yu)Jb.a.instance.ya(qb.a.$u,ac.domElement,A);Jb.a.instance.ya(qb.a.jo,document.documentElement,ja);this.da.cellTextEditBox.Chb(!0);Ua&&Jb.a.instance.ya(qb.a.HK,this.da.Ym,ja)}wek(A,ja,Ua){document.documentElement.addEventListener("pointermove",A);document.documentElement.addEventListener("pointerup",
ja);this.da.cellTextEditBox.Chb(!0);Ua&&this.da.Ym.addEventListener("pointerleave",ja)}fwe(A,ja,Ua){for(const ac of this.da.yu)Jb.a.instance.Na(qb.a.$u,ac.domElement,A);Jb.a.instance.Na(qb.a.jo,document.documentElement,ja);this.da.cellTextEditBox.Chb(!1);Ua&&Jb.a.instance.Na(qb.a.HK,this.da.Ym,ja)}R1k(A,ja,Ua){document.documentElement.removeEventListener("pointermove",A);document.documentElement.removeEventListener("pointerup",ja);this.da.cellTextEditBox.Chb(!1);Ua&&this.da.Ym.removeEventListener("pointerleave",
ja)}xek(A,ja){for(const Ua of this.da.yu)Db.a.instance.ya(qb.a.kn,Ua.domElement,A);Db.a.instance.ya(qb.a.Ok,document.documentElement,ja)}S1k(A,ja){for(const Ua of this.da.yu)Db.a.instance.Na(qb.a.kn,Ua.domElement,A);Db.a.instance.Na(qb.a.Ok,document.documentElement,ja)}$gf(A,ja,Ua,ac){const Ec=document.createElement("div");Ec.className=ja;for(const gd of Ua)Ec.classList.add(gd);A.appendChild(Ec);Jb.a.instance.ya(qb.a.Zi,Ec,ac);return Ec}zIf(A){A=A.Qh.parentNode;if(!A)return F.ULS.shipAssertTag(537159394,
0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),null;A=parseInt(A.getAttribute(P.a.DSb),10);return isNaN(A)?(F.ULS.shipAssertTag(537159393,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.da.rh.rU(3,1,A)}O5b(A,ja,Ua){A=(void 0===Ua?!0:Ua)&&!!this.cD&&this.cD.glj(A);for(const ac of ja)Y.DOMElementExtensions.setVisible(ac,A)}lHd(){return this.da.fA?gb.a(this.da.$):this.da.sh}Xxg(){const A=
this.lHd();A&&this.cD?A.f2(null):(F.ULS.sendTraceTag(510255177,0,10,"BehaviorHelperMethods.RecalculateFormulaHighlights: Can't UpdateFormulaHighlights, will hide all marquee as a last fallback."),this.da.rh.zq(this.j9f),this.da.rh.Vs(null,this.j9f))}jwg(A,ja){this.raiseEvent("mrek",new ya(A,ja))}}Object(K.a)(Aa,"BehaviorHelperMethods",na.a,[]);var sb=a(96),nc=a(60),Bb=a(93);class uc extends Wb.a{constructor(A,ja){super(A,void 0===ja?null:ja)}fdb(){}}Object(K.a)(uc,"HighlightFlyweightBehavior",Wb.a,
[]);var Pc=a(19),wd=a(484),Md=a(69),Nd=a(13),ec=a(142),gc=a(286),Mb=a(52),sc=a(263),xd=a(10),xb=a(57);class Lb extends sc.a{constructor(A,ja,Ua,ac){super(document.createElement("div"));this.yrc=null;this.y$b=!1;this.onPointerDown=Ec=>{Ec=this.zoomManager?this.zoomManager.Ik(Ec):Ec;this.y$b=!1;if(3===(Md.a.eh=Ec.oh)){const gd=Ec.La.rawEvent,ad=gd.srcElement||gd.target;Y.DOMElementExtensions.Cn(this.domElement,ad)&&Y.DOMElementExtensions.Cn(gd.currentTarget,ad)&&(this.y$b=!0,this.yrc=Ec.clientPoint)}return!1};
this.io=Ec=>{Ec=this.zoomManager?this.zoomManager.Ik(Ec):Ec;this.raiseEvent("GrPointerUp",Ec);return this.y$b=!1};this.ur=Ec=>{Ec=this.zoomManager?this.zoomManager.Ik(Ec):Ec;3===Ec.oh&&this.y$b&&this.f4i(Ec.clientPoint)&&(this.raiseEvent("GrDrag"),this.y$b=!1);return!1};this.fj=Ec=>{this.zoomManager&&this.zoomManager.Ik(Ec);return!0};this.$=Ua;this.zoom=ac;this.domElement.classList.add(xb.a.Ytf);this.domElement.classList.add(xb.a.mvc);A.appendChild(this.domElement);Y.DOMElementExtensions.setVisible(this.domElement,
!1);this.yZa=document.createElement("div");this.yZa.classList.add(xb.a.lvc);this.yZa.style.borderColor=ja;this.domElement.appendChild(this.yZa);Jb.a.instance.ya(qb.a.Zi,this.domElement,this.onPointerDown);Jb.a.instance.ya(qb.a.jo,this.domElement,this.io);Db.a.instance.ya(qb.a.Ok,this.domElement,this.io);Jb.a.instance.ya(qb.a.$u,this.domElement,this.ur);Db.a.instance.ya(qb.a.kn,this.domElement,this.ur);gc.a.instance.ya(qb.a.click,this.domElement,this.fj)}get zoomManager(){return this.zoom.zoomManager}O0e(A){this.addHandler("GrDrag",
A)}UBg(A){this.removeHandler("GrDrag",A)}N0e(A){this.addHandler("GrContxt",A)}TBg(A){this.removeHandler("GrContxt",A)}P0e(A){this.addHandler("GrPointerUp",A)}VBg(A){this.removeHandler("GrPointerUp",A)}dispose(){Mb.a.BNa(this.domElement);super.dispose()}DKg(){this.domElement.classList.remove(xb.a.mvc);this.yZa.classList.remove(xb.a.lvc);this.yZa.classList.add(ba.EwaSettings.EF?xb.a.$tf:xb.a.Ztf)}j1g(){this.yZa.classList.remove(ba.EwaSettings.EF?xb.a.$tf:xb.a.Ztf);this.yZa.classList.add(xb.a.lvc);this.domElement.classList.add(xb.a.mvc)}f4i(A){return!!this.yrc&&
(3<Math.abs(A.x-this.yrc.x)||3<Math.abs(A.y-this.yrc.y))}static qPb(A){return Math.round(9/Math.max(A.zoomManager?A.zoomManager.zoom:xd.a.t6,1))}}Lb.q2d=0;Object(K.a)(Lb,"TouchGrippie",sc.a,[]);var Rc=a(156);class nd extends uc{constructor(A,ja,Ua,ac,Ec){super(ja);this.HXd=this.fHb=!1;this.vnc=null;this.mH=this.Ina=this.DXd=!1;this.SF=()=>{this.fHb&&this.DXd?this.WAa():this.jga()};this.iig=ad=>{3===ad.oh&&(this.DXd=!0,this.WAa());return!1};this.jig=ad=>{if(3===ad.oh){if(!ad.Qh||this.Whj(ad))return!1;
this.DXd=!1;this.jga()}return!1};this.Am=()=>{this.Ina&&this.jwe();this.WAa();this.HXd=!1};this.iB=()=>{this.jga();this.HXd=!0};this.vha=(ad,Jd)=>{Jd.W$===this.W$&&(Jd.visible?this.HXd||this.WAa():this.jga())};this.pog=()=>{this.kig(this.e2.domElement,!1)};this.heg=()=>{this.kig(this.m_.domElement,!0)};this.dNc=(ad,Jd)=>{this.mH&&Rc.b(this.da.$).ix(Jd.La.rawEvent,"context_menu_grippie",null,["floatie"]);this.ha.Lza(Jd)};this.eNc=(ad,Jd)=>{this.mH&&Rc.b(this.da.$).ix(Jd.La.rawEvent,"context_menu_grippie",
null,["floatie"]);this.ha.Lza(wd.b(Jd))};this.p_b=()=>{3===Md.a.eh?this.WAa():this.jga();this.Ina&&1===Md.a.eh&&this.jwe()};this.qog=()=>{this.oyk()};this.nof=()=>{this.jga()};this.Fv=()=>{this.ha.$e.yh&&this.jga()};this.Wdg=()=>{this.jga()};this.aig=(ad,Jd)=>{this.jwe();3===Jd.oh?this.WAa():this.jga()};this.hRc=()=>{this.fHb&&(this.jga(),this.WAa())};const gd=Ua.$;this.PD=Ua;this.zoom=Ec;this.ha=Ua.ha;this.qR=A;this.Cvk=ja;this.paneType=ac;A=this.domElement.currentStyle;ja="#000000";A&&(ja=A.borderTopColor);
this.e2=new Lb(this.Vwf(),ja,gd,Ec);this.m_=new Lb(this.Vwf(),ja,gd,Ec);this.e2.O0e(this.pog);this.e2.N0e(this.dNc);this.e2.P0e(this.eNc);this.m_.O0e(this.heg);this.m_.N0e(this.dNc);this.m_.P0e(this.eNc);for(const ad of this.da.yu)Db.a.instance.ya(qb.a.um,ad.domElement,this.jig),Db.a.instance.ya(qb.a.Ok,ad.domElement,this.iig);Ua.view.Wy(this.SF);Ua.sh.nv(this.nof);Ua.rh.Vcb(this.vha);Ua.kkc(this.Wdg);gd.hI(this.hRc);Ua.Mz(this.hRc);this.ha.v9(this.Am);this.ha.xta(this.iB);Ua.KN(this.Fv);this.ha.bGb(this.aig);
Md.a.U0e(this.p_b);$b.TaskExtensions.Ua(Object(Bb.d)(ka.a.resolve(Ha.Zc,{va:0})),ad=>{ad.result.WAh(this.qog)},gd.xa,3);this.mH=ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackAsyncContextMenu",!1)}get da(){return this.PD}dispose(){sb.a.Ni([this.e2,this.m_]);this.e2.UBg(this.pog);this.e2.TBg(this.dNc);this.e2.VBg(this.eNc);this.m_.UBg(this.heg);this.m_.TBg(this.dNc);this.m_.VBg(this.eNc);for(var A of this.da.yu)Db.a.instance.Na(qb.a.um,A.domElement,this.jig),Db.a.instance.Na(qb.a.Ok,
A.domElement,this.iig);this.da.view.Kx(this.SF);this.da.sh.ev(this.nof);this.da.rh.qtb(this.vha);this.da.xSc(this.Wdg);this.da.$.LK(this.hRc);this.da.xE(this.hRc);this.ha.Gba(this.Am);this.ha.Fpa(this.iB);this.da.vP(this.Fv);this.ha.$2b(this.aig);Md.a.aCg(this.p_b);this.Ina&&F.ULS.sendTraceTag(537159314,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");(A=ka.a.Zg(Ha.Zc))&&A.hlk(this.qog);super.dispose()}P6a(){if(!this.qR.range||!this.qR.range.equals(this.uub))return!1;const A=
!this.da.K0a();return this.da.isEditing&&A&&(this.uub.isRow||this.uub.fk)?!1:this.Ina?!0:3===Md.a.eh}jga(){this.fHb&&(this.e2.set_visible(!1),this.m_.set_visible(!1),this.fHb=!1)}WAa(){if(this.P6a()){var A=Y.DOMElementExtensions.getBoundingClientRect(this.vnc);A||F.ULS.shipAssertTag(537159313,0,!1,"grippiesParentBounds is null. GridView.ContainerElement: {0}, Freezepanes: {1}",this.da.Ym,this.da.Pg.Uo);var ja=Y.DOMElementExtensions.getBoundingClientRect(this.Cvk),Ua=new Sys.UI.Bounds(ja.x-A.x,ja.y-
A.y,ja.width,ja.height),ac=this.uub,Ec=ac.topLeft,gd=ac.bottomRight,ad=ac.isRow||ac.fk;if(ac.fk){var Jd=this.yui();ac=Ua.x-2*Lb.qPb(this.zoom);var De=Jd;var Xe=Ua.x+ja.width}else ac.isRow?(ac=Xe=this.xui(),De=Ua.y-2*Lb.qPb(this.zoom),Jd=Ua.y+ja.height):(De=Ua.y,Jd=Ua.y+ja.height,this.da.rtl?(ac=Ua.x+ja.width,Xe=Ua.x):(ac=Ua.x,Xe=Ua.x+ja.width));ja=Lb.q2d+(ad?0:Lb.qPb(this.zoom));this.e2.style.left=Nd.HelperMethods.ti(ac-ja);this.e2.style.top=Nd.HelperMethods.ti(De-ja);this.m_.style.left=Nd.HelperMethods.ti(Xe-
ja);this.m_.style.top=Nd.HelperMethods.ti(Jd-ja);this.e2.set_visible(this.PWf(De,ac,Ec,ad,A));this.m_.set_visible(this.PWf(Jd,Xe,gd,ad,A));this.fHb=!0}}PWf(A,ja,Ua,ac,Ec){const gd=Y.DOMElementExtensions.getBoundingClientRect(this.da.Zk(this.paneType).domElement);Ec=new Sys.UI.Bounds(gd.x-Ec.x-3,gd.y-Ec.y-3,gd.width+6,gd.height+6);return(this.da.Pg.ro(Ua)===this.paneType||ac)&&nc.a.$X(Ec,new Sys.UI.Point(ja,A))}yui(){return(this.da.view.visibleArea.height+this.da.Pg.height+Lb.q2d-Lb.qPb(this.zoom))/
2}xui(){return(this.da.view.visibleArea.width+this.da.Pg.width+Lb.q2d-Lb.qPb(this.zoom))/2}Amg(){this.WAa()}Whj(A){return Y.DOMElementExtensions.iub(A.Qh,Pc.a.YG)&&(this.zjj(A)||this.Ajj(A))}Ajj(A){if(this.da.rtl)A=A.clientPoint.x;else{const ja=Y.DOMElementExtensions.getBoundingClientRect(A.Qh);A=A.clientPoint.x-(ja.x+ja.width-ec.a.Lx)}return 0<A&&A<=ec.a.Lx}zjj(A){const ja=Y.DOMElementExtensions.getBoundingClientRect(A.Qh);A=A.clientPoint.y-(ja.y+ja.height-ec.a.Lx);return 0<A&&A<=ec.a.Lx}kig(A,ja){this.Ina&&
F.ULS.sendTraceTag(537159312,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ha.tsd(A,ja,this.Ina);this.jga()}oyk(){this.Ina||(F.ULS.sendTraceTag(537159311,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.Ina=!0,this.e2.DKg(),this.m_.DKg(),this.da.ha.sourceRange=this.da.ha.qa.Ui,this.WAa())}jwe(){this.Ina&&(F.ULS.sendTraceTag(537159310,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),this.Ina=!1,this.e2.j1g(),this.m_.j1g())}Vwf(){this.vnc||(this.vnc=
this.da.Ym);return this.vnc}}Object(K.a)(nd,"SelectionTouchGrippiesBehaviorBase",uc,[]);class $d extends nd{constructor(A,ja,Ua,ac,Ec){super(A,ja,Ua,ac,Ec)}get W$(){return 19}get uub(){return this.da.ha.qa.activeRange}P6a(){const A=this.da.Pp||this.da.isEditing;return!this.da.ha.qa.Gn&&!A&&super.P6a()}}Object(K.a)($d,"DiscontinuousSelectionTouchGrippiesBehavior",nd,[]);var Td=a(756);class He extends uc{constructor(A){super(A);const ja=document.createElement("div");ja.className=xb.a.Qpi;A.appendChild(ja)}}
Object(K.a)(He,"SelectionBorderBehavior",uc,[]);class oc{}oc.puf="ewr-selection-draghandle-grab";oc.Hpi="ewr-selection-draghandle-top";oc.Ipi="ewr-selection-draghandle-top-enhanced";oc.ypi="ewr-selection-draghandle-bottom";oc.zpi="ewr-selection-draghandle-bottom-enhanced";oc.Bpi="ewr-selection-draghandle-left";oc.Cpi="ewr-selection-draghandle-left-enhanced";oc.Epi="ewr-selection-draghandle-right";oc.Fpi="ewr-selection-draghandle-right-enhanced";oc.Jpi="ewr-selection-draghandle-top-updated";oc.Api=
"ewr-selection-draghandle-bottom-updated";oc.Dpi="ewr-selection-draghandle-left-updated";oc.Gpi="ewr-selection-draghandle-right-updated";oc.Lpi="ewr-selection-dragtooltip-updated";oc.xpi="ewr-selection-drag-tooltip-fluent";oc.quf="ewr-selection-draghandle-reduced";oc.iqi="ewr_selection_rearrangeleft";oc.jqi="ewr_selection_rearrangeright";oc.kqi="ewr_selection_rearrangetop";oc.hqi="ewr_selection_rearrangebottom";oc.Ypi="ewr_selection_rearrange-flange-left";oc.bqi="ewr_selection_rearrange-fullrowcol-flange-left";
oc.Zpi="ewr_selection_rearrange-flange-right";oc.cqi="ewr_selection_rearrange-fullrowcol-flange-right";oc.$pi="ewr_selection_rearrange-flange-top";oc.dqi="ewr_selection_rearrange-fullrowcol-flange-top";oc.Xpi="ewr_selection_rearrange-flange-bottom";oc.aqi="ewr_selection_rearrange-fullrowcol-flange-bottom";oc.selecting="selecting";oc.vpi="ewr-selection-drag-shadow";oc.lqi="ewr-selection-resizemarqueehandle";oc.oqi="ewr-selection-resizemarqueehandle-topleft";oc.pqi="ewr-selection-resizemarqueehandle-topright";
oc.mqi="ewr-selection-resizemarqueehandle-bottomleft";oc.nqi="ewr-selection-resizemarqueehandle-bottomright";oc.bpi="ewr-marquee-thick";oc.ppi="ewr-resizemarqueehandle-thick";Object(K.a)(oc,"CssClassNames",null,[]);var ld=a(283);class id extends He{constructor(A,ja,Ua,ac,Ec){super(A);this.z7a=!1;this.$kd=this.ald=null;this.lyb=this.Zkb=this.jX=this.yka=0;this.S6=this.zh=this.sourceRange=this.ksb=null;this.io=gd=>{gd=this.zoomManager.Ik(gd);return this.glg(gd)};this.onPointerDown=gd=>{gd=this.zoomManager.Ik(gd);
if(!this.vpe())return!1;if(2===gd.oh&&gd.mw===Sys.UI.MouseButton.leftButton&&!this.z7a){var ad=this.OLd(gd);if(!ad)return F.ULS.shipAssertTag(537159379,0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;this.zh=ad.clone();this.sourceRange=this.zh.clone();this.ksb=this.zh;if(ad=this.iOi(gd))return this.lyb=ad.top-this.sourceRange.top,this.Zkb=ad.left-this.sourceRange.left,za.f(this.$).Um.Mx(id.phb),this.l8d(gd),this.z7a=!0,ld.b(this.$,!0),!0}return!1};this.ur=gd=>{gd=
this.zoomManager.Ik(gd);if(this.m8d(gd))return!0;if(gd=this.lC?this.ha.B3(gd.clientPoint,gd.Qh,5,!0):this.ha.Ey(gd.clientPoint,gd.Qh,5,void 0,void 0,!0)){gd=this.zIb(gd);if(this.zh.equals(gd))return!0;this.zh=gd;if(!this.Kxb())return F.ULS.shipAssertTag(537159378,0,!1,"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.Ivc(!0),!1}return!0};this.elg=gd=>{gd=new Sys.UI.DomEvent(gd);gd=Td.a.create(gd.type,gd.target,gd,2);return this.$kd(gd)};this.klg=gd=>{gd=new Sys.UI.DomEvent(gd);
gd=Td.a.create(gd.type,gd.target,gd,2);return this.ald(gd)};this.xj=(gd,ad)=>{ad.K0||this.Qub(this.$.isEditMode)};this.tO=[];this.$=ja;this.da=za.f(this.$);this.zoom=Ec;this.ha=za.f(this.$).ha;this.paneType=Ua;this.Tv=ac;this.lC=ba.EwaSettings.lC();ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragHandleUsabilityImprovement",!1)?this.kVc=[oc.Hpi,oc.ypi,oc.Bpi,oc.Epi]:ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8683878_UpdateDragDropHitRegionOfActiveCell")?this.kVc=[oc.Jpi,oc.Api,
oc.Dpi,oc.Gpi]:this.kVc=[oc.Ipi,oc.zpi,oc.Cpi,oc.Fpi];this.$.nr(this.xj)}get zoomManager(){return this.zoom.zoomManager}get rh(){return za.f(this.$).rh}get gz(){return this.ha.selectionType}set gz(A){this.ha.selectionType=A}dispose(){this.tO.forEach(A=>{Jb.a.instance.Na(qb.a.Zi,A,this.onPointerDown)});this.tO.length=0;this.ksb=this.sourceRange=this.zh=null;F.ULS.sendTraceTag(537159381,0,50,`DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = ${this.yka}, EwaControl is null : ${!this.$}`);
this.$&&(this.$.Pr(this.xj),1===this.yka&&(F.ULS.sendTraceTag(537159380,0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.dGa(this.$kd,this.ald,!1)));super.dispose()}glg(A){if(5!==this.gz)return!1;(A=this.n3a(A))||this.Ivc(!1);ld.b(this.$,!1);return A}ypa(A,ja){F.ULS.shipAssertTag(537159377,0,!this.yka,`DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected but got ${this.yka}`);this.yka+=1;this.$kd=A;this.ald=
ja;this.lC?this.Tv.wek(this.elg,this.klg,this.Y8b()):this.Tv.ypa(A,ja,this.Y8b())}zIb(A){if(!A||!this.zh)return F.ULS.shipAssertTag(537159376,0,!!A,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),F.ULS.shipAssertTag(537159375,0,!!this.zh,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),null;const ja=this.zh.clone();1!==this.jX&&(ja.left=Math.max(A.left-this.Zkb,1),ja.right=ja.left+this.sourceRange.width-1);2!==this.jX&&(ja.top=Math.max(A.top-
this.lyb,1),ja.bottom=ja.top+this.sourceRange.height-1);return this.BGb(ja)}dGa(A,ja,Ua,ac){Ua=void 0===Ua?!0:Ua;ac=void 0===ac?!0:ac;F.ULS.shipAssertTag(537159374,0,1===this.yka,`DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration but got ${this.yka}`);--this.yka;this.lC?this.Tv.R1k(this.elg,this.klg,this.Y8b()):this.Tv.fwe(A,ja,this.Y8b());Ua&&this.Dbf(ac);this.jX=0;this.z7a=!1}BGb(A){var ja=za.f(this.$);const Ua=A.clone();if(ja.Pg.mz){const ac=ja.Pg.ZG;ja=ja.Pg.dK;
Ua.left<ac&&1!==this.jX&&(Ua.left=ac,Ua.right=Math.min(Ua.left+A.width-1,xd.a.Qk));Ua.top<ja&&2!==this.jX&&(Ua.top=ja,Ua.bottom=Math.min(Ua.top+A.height-1,xd.a.gl))}return this.ksb=Ua}Qub(A){this.tO.forEach(ja=>{Y.DOMElementExtensions.setVisible(ja,A)})}iOi(A){const ja=A.Qh;A=A.clientPoint;if(!ja||!A)return F.ULS.shipAssertTag(537159373,0,!!ja,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),F.ULS.shipAssertTag(537159372,0,!!A,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),
null;A.y+=ja===this.tO[id.vAd]?2:ja===this.tO[id.Mnf]?-2:0;A.x+=ja===this.tO[id.Nnf]?2:ja===this.tO[id.uAd]?-2:0;return this.lC?this.ha.B3(A,ja,5,!0):this.ha.Ey(A,ja,5,void 0,void 0,!0)}}id.kqc="copy";id.phb="grabbing";id.vAd=0;id.Mnf=1;id.Nnf=2;id.uAd=3;Object(K.a)(id,"DragSelectionClickBehaviorBase",He,[]);class fc extends id{constructor(A,ja,Ua,ac,Ec,gd,ad){super(A,ja,Ua,Ec,ad);this.Gi=this.HV=null;this.AMf=()=>{this.Ivc(!0)};for(const Jd of this.kVc)ja=this.Tv.$gf(A,Jd,[oc.puf],this.onPointerDown),
this.tO.push(ja);this.Qub(this.$.isEditMode);this.hP=ac;A=Ha.zc.Ha()?ka.a.Zg(Ha.zc):this.$.ka.Ug(464);F.ULS.shipAssertTag(512312961,0,!!A,"DragMarqueeClickBehavior Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen.");this.cD=A.cD;for(const Jd of this.tO)Jb.a.instance.ya(qb.a.T6,Jd,this.hP.TPf),Jb.a.instance.ya(qb.a.HK,Jd,this.hP.UPf);this.fdb(gd)}fdb(A){this.Tv.O5b(A,this.tO);this.hP.YY()}l8d(A){F.ULS.sendTraceTag(537159390,0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");
this.da.d_a=!0;this.Gi.WN(!1);this.gz=5;this.hP.Qnf(A.Qh);this.Gi.$b.removeSelection();this.Gi.ykc(this.AMf);this.ypa(this.ur,this.io);this.jX=this.sourceRange.isRow?1:this.sourceRange.fk?2:0}n3a(){const A=this.E7();this.gz=-1;this.dGa(this.ur,this.io);return A}Dbf(){this.da.d_a=!1;this.hP.Rnf(this.tO[0]);this.Gi.$b.setCaretPositionToEnd();this.Gi.KSc(this.AMf);this.Tv.Xxg()}Ivc(A){F.ULS.sendTraceTag(537159389,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate formula highlights as a fallback in CleanUp.");
A&&this.dGa(this.ur,this.io)}OLd(A){this.Gi=this.Tv.lHd();this.HV=this.Tv.zIf(A);return this.Gi&&this.HV&&this.HV.range?this.HV.range:(F.ULS.shipAssertTag(537159388,0,!!this.Gi,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),F.ULS.shipAssertTag(537159387,0,!!this.HV,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),F.ULS.shipAssertTag(537159386,0,!!this.HV.range,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),null)}E7(){return this.HV?
this.cD.aag(this.Gi,this.HV,this.zh):(F.ULS.shipAssertTag(537159385,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),!1)}Kxb(){return this.E7()}Y8b(){return!0}m8d(){return!1}vpe(){return!0}}Object(K.a)(fc,"DragMarqueeClickBehavior",id,[]);var vc=a(100),Tc=a(154),Bd=a(188),Fd=a(353),le=a(905),dc=a(71),Uc=a(228),kb=a(35),rb=a(47),cc=a(364),mc=a(230),Sa=a(45),pb=a(426);class Ac extends id{constructor(A,
ja,Ua,ac,Ec,gd){super(A,ja,Ua,Ec,gd);this.Qua=this.mF=null;this.fk=this.isRow=!1;this.Lr=ba.EwaSettings.Lr();this.wxa=ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DragAnimationTracking",!1);this.WO=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8621300_dragHandlersWithKeydownBugFix");this.B0a=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8637867_keyPressBeforeDragDropBugFix");this.dWb=ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseSPDForDrag",!1);this.c0a=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8732599_DragInsertIndicatorAlignmentBugFix");
this.Qlj=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8675468_nonEditModeDragHandleBugFix");this.qhj=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8716744_DragHandlesDisabledForEntireSheet");this.ohb=dc.a.o$;this.Jtc=0;this.mig=(ad,Jd)=>{this.xUb=!0;this.onPointerDown(Jd)};this.Am=()=>{this.domElement.classList.remove(oc.selecting);this.qhj&&(this.Qlj?this.Qub(this.$.isEditMode&&!this.Aqf()):this.Aqf()?this.Qub(!1):this.Qub(!0));if(Ac.fdk&&this.ha.qa.H0){const ad=this.kh(this.ha.qa.Ui);null!==ad&&
(ad.hasAutoFilter?this.domElement.classList.add(oc.quf):this.domElement.classList.remove(oc.quf))}};this.iB=()=>{this.domElement.classList.add(oc.selecting)};this.Cj=ac;this.ATd=!1;if(0===Ac.ntc[Ua].length)for(const ad of this.kVc)ja=document.createElement("div"),ja.className=ad,ja.classList.add(oc.puf),Ac.ntc[Ua].push(ja);for(const ad of Ac.ntc[Ua])A.appendChild(ad),Jb.a.instance.ya(qb.a.Zi,ad,this.onPointerDown),this.tO.push(ad);this.Qub(this.$.isEditMode);this.My={};this.da.DU=!1;this.ha.xta(this.iB);
this.ha.v9(this.Am);this.lC&&1===this.paneType&&(this.fGa(),this.da.Lzh(this.mig));this.wxa&&void ka.a.resolve(Ha.yd).then(ad=>{this.eKa=ad})}dispose(){this.ha&&(this.ha.Fpa(this.iB),this.ha.Gba(this.Am));if(this.My)for(var A=1;4>=A;A++)Y.DOMElementExtensions.Km(this.My[A.toString()]);for(A=1;4>=A;A++)Ac.ntc[A].length=0;this.My=this.mF=null;this.lC&&1===this.paneType&&this.da.dkk(this.mig);super.dispose()}Dbf(A){A&&(za.f(this.$).Um.Mx(P.a.Q$),this.WO?this.Ebf():Tc.a.instance.Na(qb.a.zi,this.domElement.ownerDocument.body,
this.onKeyDown),this.da.DU=!1);for(A=1;4>=A;A++){const ja=this.My[A.toString()];ja&&ja.parentNode.removeChild(ja);this.My[A.toString()]=null}this.mF=null}OLd(){return this.ha.qa.Ui}E7(){this.ha.updateSelection(this.zh,this.zh.topLeft,0);return!0}Y6a(A,ja){ja=void 0===ja?!1:ja;var Ua=!isNullOrUndefined(this.Tea);if(A&&ja||A!==Ua){Ua=this.O5();var ac=this.Ena();A&&(Ua||ac)?(ja&&this.Tea&&(this.rh.zq(this.Tea),this.Tea=null),this.rh.gCc(!0),this.Tea=this.zTd()?[65]:[62,Ua?63:64],this.rh.Vs(this.sourceRange,
this.Tea),this.rh.rw(this.Tea),F.ULS.sendTraceTag(507872737,0,50,`DragSelectionClickBehavior.showOrHideSourceHighlights: show source highlights for ${this.zTd()?"copy":"cut"} operation`)):this.Tea&&(this.rh.zq(this.Tea),this.Tea=null,this.rh.xia(),F.ULS.sendTraceTag(507872736,0,50,"DragSelectionClickBehavior.showOrHideSourceHighlights: hide source highlights"))}}U$e(A){this.Snf=A}X6b(A){isNullOrUndefined(this.Tea)&&Math.abs(this.O5()?A.y-this.Snf.y:A.x-this.Snf.x)>=Ac.RPk&&this.Y6a(!0)}R1c(){const A=
!isNullOrUndefined(this.Tea);this.Y6a(A,!0)}Kxb(A){A=void 0===A?!1:A;if(this.Lr){const Ua=this.O5();var ja=this.Ena();Ua||ja?(ja=this.O0f(),this.Qua=Ua?Ac.hei:Ac.gei,this.rh.Vs(this.zh,this.Qua),ja?this.rh.rw(this.Qua):this.TRb()):(this.Qua=Ac.iXa,this.rh.Vs(this.zh,this.Qua),this.rh.rw(this.Qua))}else this.rh.Vs(this.zh,Ac.iXa),this.rh.rw(Ac.iXa);this.HP(A);return!0}TRb(){this.Qua&&(this.rh.zq(this.Qua),this.Qua=null)}q1c(A){A=void 0===A?!1:A;this.rh.Vs(this.zh,this.mF);if(this.Lr){const ja=this.O5()||
this.Ena(),Ua=this.P0f();ja&&!Ua?this.rh.zq(this.mF):this.rh.rw(this.mF)}else this.rh.rw(this.mF);this.HP(A)}fGa(){this.xUb=!1}nOh(A,ja,Ua,ac,Ec,gd,ad,Jd,De){ja?(ja=ad,Ec=ac.y+Ec.y-gd.y-Jd,ad=gd.width-De-ja,ac=ac.height,A=A.y-gd.y-Ec):(ja=Ua?ac.x-Ec.right+gd.right+Jd:ac.x+Ec.left-gd.left-Jd,Ec=ad,ad=ac.width,ac=gd.height-De-Ec,A=Ua?gd.width-(A.x-gd.left)-ja:A.x-gd.left-ja);return{ohb:new dc.a(ja,Ec,ad,ac),Jtc:A}}oOh(A,ja,Ua,ac,Ec,gd){ja?(ja=ac.x,A=A.y-gd.y-Ec):(ja=Ua?gd.width-(A.x-gd.left)-Ec:A.x-
gd.left-Ec,A=ac.y);return new Sys.UI.Point(ja*(Ua?-1:1),A)}jOg(A){var ja=this.da.Ym,Ua=ja.getBoundingClientRect(),ac=this.da.Yg.iCf(A),Ec=this.da.Yg.$Gf(ac)||this.da.Zk(1);ac=Ec.domElement;const gd=ac.getBoundingClientRect();Ec=this.rh.wYa(this.sourceRange,Ec.paneType,!1);const ad=this.O5(),{ohb:Jd,Jtc:De}=this.nOh(A,ad,this.da.rtl,Ec,gd,Ua,(ad?this.da.$ha:this.da.T3).KJd(),ad?ac.scrollTop:ac.scrollLeft,ec.a.Lx/this.zoomManager.zoom);this.ohb=Jd;this.Jtc=De;Ac.bfa||(Ac.bfa=document.createElement("div"),
Ac.bfa.id=`${this.da.$.$h}rowColDragShadow`,Ac.bfa.className=oc.vpi,Y.DOMElementExtensions.setVisible(Ac.bfa,!1),ja.appendChild(Ac.bfa));ja=new mc.a(Ac.bfa.style);Ua=ja.LH;Ua.height=`${this.ohb.height}px`;Ua.width=`${this.ohb.width}px`;this.Tvb(A,ja)}URb(){Ac.bfa&&Y.DOMElementExtensions.setVisible(Ac.bfa,!1)}Tvb(A,ja){if(Ac.bfa){ja=ja||new mc.a(Ac.bfa.style);var Ua=ja.LH,ac=this.da.Ym.getBoundingClientRect(),{x:Ec,y:gd}=this.oOh(A,this.O5(),this.da.rtl,this.ohb,this.Jtc,ac);Ua.transform=`translate(${Ec}px, ${gd}px)`;
Y.DOMElementExtensions.qne(ja,Ac.bfa,!0);ja.Zda()}}kh(A){return(A=this.da.za.yx(A))?new cc.a(A,this.da):null}Aqf(){if(this.ha.qa.Gn){const A=this.ha.qa.Ui;if(null!=A&&1===A.top&&1===A.left&&A.bottom===A.maxRows&&A.right===A.maxColumns)return!0}return!1}Ivc(){F.ULS.sendTraceTag(508908561,0,15,"DragSelectionClickBehavior.FailureFallback: this function was not implemented for dragging selection")}Y8b(){return!1}evb(A,ja,Ua,ac){ac=void 0===ac?!1:ac;var Ec=Y.DOMElementExtensions.getBoundingClientRect(ja);
let gd=ja===this.tO[id.vAd]||ja===this.tO[id.Mnf];var ad=ja===this.tO[id.Nnf]||ja===this.tO[id.uAd];this.isRow&&ad||this.fk&&gd?ad="100px":(gd=this.isRow||gd,ad=this.Lr?gd?(ac?Ac.PXk:Ac.UXk)+"px":(ac?Ac.MXk:Ac.QXk)+"px":(gd?ac?Ac.OXk:Ac.TXk:ac?Ac.NXk:Ac.RXk)+"px");ja=gd?ja===this.tO[id.vAd]?"top":"bottom":ja===this.tO[id.uAd]?"right":"left";A=100*(gd?A.x-Ec.x:A.y-Ec.y)/(gd?Ec.width:Ec.height);for(Ec=1;4>=Ec;Ec++){var Jd=document.createElement("div"),De=document.createElement("div");const Xe=document.createElement("div");
Jd.appendChild(De);Jd.appendChild(Xe);ac&&(De=document.createElement("div"),Jd.appendChild(De),Xe.style.fontWeight="bold");Jd.className=this.Lr?oc.xpi:oc.Lpi;this.My[Ec.toString()]=Jd;this.rh.rU(Ua,Ec).Yk.appendChild(Jd);if(Jd=this.My[Ec.toString()])Jd.style[ja]=ad,Jd.style[gd?"left":"top"]=A+"%"}}uHd(A,ja,Ua,ac){var Ec=za.f(this.$);let gd;if(this.c0a){gd=Ec.Zk(ac);const ad=pb.a.KO(ac,gd.view.Xm);Ua=le.a.Ny(ad,gd.domElement,Ua,Ec.rtl);ac=Ec.ml(A,ac,!0)}else gd=Ec.Zk(this.paneType),Ua=le.a.Ny(gd.view.Xm,
this.domElement.parentNode,Ua,Ec.rtl),ac=Ec.ml(A,void 0,!0);Ec=this.da.mj;return ja&&Ua.y-ac.topLeft.y>ac.height/2?Sa.D(Ec.ojb(A)):!ja&&Ua.x-ac.topLeft.x>ac.width/2?Sa.D(Ec.ekb(A)):A}a3g(A,ja,Ua,ac){const Ec=za.f(this.$);let gd;if(this.c0a){gd=Ec.ml(A,ac);var ad=Ec.Zk(ac);ac=pb.a.KO(ac,ad.view.Xm);Ua=le.a.Ny(ac,ad.domElement,Ua,Ec.rtl)}else gd=Ec.ml(A),ad=Ec.Zk(this.paneType),Ua=le.a.Ny(ad.view.Xm,this.domElement.parentNode,Ua,Ec.rtl);ad=!1;ac=2;ja&&Ua.y-gd.topLeft.y>gd.height/2?(ad=!0,ac=1):!ja&&
Ua.x-gd.topLeft.x>gd.width/2&&(ad=!0);if(ad){ja=Ec.ot("DragSelectionClickBehavior.updateMouseSelectionRange",Ec.c5,ac);try{ja.NF(A),ja.$$mn(),ja.$$cu()}finally{ja&&ja.dispose()}}}pua(A){this.rh.zq(this.mF);this.dGa(this.PNc,this.QNc,void 0,A);this.wxa&&this.XYc()}KT(A){this.Lr?this.TRb():this.rh.zq(Ac.iXa);this.dGa(this.ur,this.io,void 0,A);this.wxa&&this.XYc()}XYc(){var A;this.sAd&&(null===(A=this.eKa)||void 0===A?void 0:A.stopTrackAnimation(this.sAd));this.sAd=void 0}F7b(A,ja){var Ua;this.XYc();
if(null===(Ua=this.eKa)||void 0===Ua?0:Ua.startTrackAnimation(ja,A))this.sAd=A}Xlb(A){return A.La.keyCode===vc.a.T8a||Da.a.isMac&&A.La.keyCode===vc.a.d$b}kTd(A){return A.La.ctrlKey||Da.a.isMac&&A.La.altKey}cTb(A){A=za.f(this.$).getRangeInformation(A);for(let ja=0,Ua=A.length;ja<Ua;++ja)if(Object(Fd.a)(Uc.PivotTableRange,A[ja]))return A=kb.a.Yi(1,0,902,901,0,2105176604,"InsDelCellsPivotTable"),rb.a(this.$).CD([A]),!0;return!1}p_e(){this.ATd||(this.ha.t1e(this.H8d),this.ATd=!0)}g5a(){this.ha&&(this.ha.sCg(this.H8d),
this.ATd=!1)}O5(){return 1===this.jX}Ena(){return 2===this.jX}}Ac.RXk=-85;Ac.TXk=-40;Ac.NXk=-120;Ac.OXk=-50;Ac.QXk=-95;Ac.UXk=-50;Ac.MXk=-130;Ac.PXk=-60;Ac.RPk=2;Ac.iXa=[48];Ac.hei=[66,68];Ac.gei=[67,69];Ac.Tbk=[58,60];Ac.Sbk=[59,61];Ac.ntc=[[],[],[],[],[],[]];Ac.fdk=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8196440_ReduceDragAreaIfAutoFilter");Object(K.a)(Ac,"DragSelectionClickBehavior",id,[]);var yd=a(26),vb;(function(A){A[A.none=0]="none";A[A.copyPasteLengthTooLong=1]="copyPasteLengthTooLong";
A[A.applyLinkFailed=2]="applyLinkFailed";A[A.pasteHtmlFailed=3]="pasteHtmlFailed";A[A.pasteStringFailed=4]="pasteStringFailed";A[A.pasteRangeFailed=5]="pasteRangeFailed";A[A.pasteFromClipboardIsNotValidForFormattingAndTranspose=6]="pasteFromClipboardIsNotValidForFormattingAndTranspose";A[A.asyncCopyFailedToPopulateClipboard=7]="asyncCopyFailedToPopulateClipboard";A[A.clipboardIsInaccessible=8]="clipboardIsInaccessible";A[A.pasteArtFailed=9]="pasteArtFailed";A[A.noArtSourceItem=10]="noArtSourceItem";
A[A.blockedCrossSessionArtPaste=11]="blockedCrossSessionArtPaste";A[A.failedToParseShadowWorkbookJson=12]="failedToParseShadowWorkbookJson";A[A.invalidShadowWorkbook=13]="invalidShadowWorkbook";A[A.failedToStringifyShadowWorkbook=14]="failedToStringifyShadowWorkbook";A[A.failedToPasteExternalImage=15]="failedToPasteExternalImage";A[A.lastAsyncSerializeFailed=16]="lastAsyncSerializeFailed";A[A.pasteOnArtIsNotValidForText=17]="pasteOnArtIsNotValidForText";A[A.pasteFromExternalNotSupportDiscontinuousSelection=
18]="pasteFromExternalNotSupportDiscontinuousSelection";A[A.pasteFromSameSessionNotSupportDiscontinuousSelection=19]="pasteFromSameSessionNotSupportDiscontinuousSelection";A[A.pasteFromCrossSessionNotSupportDiscontinuousSelection=20]="pasteFromCrossSessionNotSupportDiscontinuousSelection";A[A.insertCopiedCutCellsFailed=21]="insertCopiedCutCellsFailed";A[A.rearrangeRowColumnFailed=22]="rearrangeRowColumnFailed";A[A.invalidHtml=23]="invalidHtml";A[A.failedToProcessClipboardHtml=24]="failedToProcessClipboardHtml"})(vb||
(vb={}));Object(K.b)("PasteErrorType",vb);class Sc{constructor(A,ja){this.errorName=this.innerError=null;this.errorName=A;this.innerError=void 0===ja?null:ja}}Object(K.a)(Sc,"CCPError",null,[]);class hd extends Sc{constructor(A,ja){ja=void 0===ja?null:ja;super(kb.a.Kh(void 0===A?null:A,"_"),ja)}}Object(K.a)(hd,"EwaCCPError",Sc,[]);class qc extends Sc{constructor(A,ja,Ua,ac,Ec){ja=void 0===ja?null:ja;Ua=void 0===Ua?null:Ua;ac=void 0===ac?"":ac;Ec=void 0===Ec?100:Ec;super(vb[A]);this.pasteErrorName=
0;this.ewaErrors=this.message=null;this.validationFailureReason=0;this.pasteErrorName=A;this.ewaErrors=ja;this.validationFailureReason=Ec;this.innerError=ja?new hd(ja,Ua):Ua;this.message=ac}}Object(K.a)(qc,"PasteInnerError",Sc,[]);var Lc=a(212),bd=a(122),jd=a(262),Yd=a(62);class te{constructor(A,ja){this.destinationRange=this.sourceRange=null;this.sourceRange=A;this.destinationRange=ja}}Object(K.a)(te,"MacroRecorderTableRowColumnRearrangedPayload",null,[65]);class oe extends Ac{constructor(A,ja,Ua,
ac,Ec,gd){super(A,ja,Ua,ac,Ec,gd);this.uqa=null;this.JI=this.nH=!1;this.iIc=0;this.XWc=this.Gtc=null;this.VQ=0;this.Onf=Ba.a.instance.ia(2269);this.nei=Ba.a.instance.ia(2270);this.WOg=Ba.a.instance.ia(2271);this.vGk=Ba.a.instance.ia(2272);this.onKeyDown=ad=>this.Xlb(ad)||ad.La.keyCode===vc.a.fyb?(this.v2b(),!this.CU&&this.Xlb(ad)&&(this.CU=!0,za.f(this.$).Um.Mx(id.kqc),this.Lr&&this.R1c()),this.GI||ad.La.keyCode!==vc.a.fyb||(this.WO||za.f(this.$).Um.Mx(id.phb),this.GI=!0,2===this.VQ?(this.KT(!1),
this.jX=0,this.nH=this.JI,this.G7b(!1,ad.La.rawEvent)):3===this.VQ?(this.cGa(!1),this.jX=this.isRow?1:2,this.aca(!1,ad.La.rawEvent)):1===this.VQ&&(this.pua(!1),this.aca(!1,ad.La.rawEvent))),!0):!1;this.onKeyUp=ad=>this.Xlb(ad)||ad.La.keyCode===vc.a.fyb?(this.iIc=this.Xlb(ad)?0:1,!this.B0a&&this.da.DU&&za.f(this.$).Um.Mx(id.phb),1===this.iIc&&(2===this.VQ?(this.cGa(!1),this.jX=0,this.aca(!0,ad.La.rawEvent)):3===this.VQ?(this.KT(!1),this.jX=this.isRow?1:2,this.G7b(!0,ad.La.rawEvent)):1===this.VQ&&(this.KT(!1),
this.owb(!0,ad.La.rawEvent))),this.Ria(this.iIc),0===this.iIc&&(this.B0a&&this.da.DU&&za.f(this.$).Um.Mx(id.phb),this.Lr&&this.R1c()),!0):!1;this.QNc=ad=>{ad=this.zoomManager.Ik(ad);this.g5a();this.WO||this.pua(!0);5===this.gz?this.glg(ad):(this.da.DU=!1,this.Lr&&(this.Y6a(!1),this.URb()),!this.$.cy([this.zh],!1)||this.Ubk()||this.oVd()||(this.ha.sourceRange=this.sourceRange.clone(),this.T7j(),this.JI?this.zh.top>this.sourceRange.top&&(ad=this.zh.height,this.zh.top-=ad,this.zh.bottom-=ad):this.zh.left>
this.sourceRange.left&&(ad=this.zh.width,this.zh.left-=ad,this.zh.right-=ad),this.E7()));this.WO&&this.pua(!0);this.tableRange=null;this.gz=-1;this.uqa=null;this.VQ=0;return!0};this.jlg=()=>{this.da.DU=!1;this.g5a();this.VQ=0;this.WO||this.cGa(!0);this.Lr&&(this.Y6a(!1),this.URb());if(!this.$.cy([this.zh],!1))return this.WO&&this.cGa(!0),this.gz=-1,this.fGa(),!0;if(this.s5g()&&!this.cTb(this.zh)&&!this.cTb(this.sourceRange)&&!this.oVd()){this.E7();this.ha.sourceRange=this.sourceRange.clone();var ad=
this.ha.sourceRange;const Jd=this.ha.qa.Ui;this.lC?this.$.ei(-694765314,2,30,{[P.a.ama]:this.CU,[P.a.Ftc]:!0,[P.a.Itc]:this.nH,[P.a.x4]:ad,[P.a.w4]:Jd,[P.a.kva]:this.GI,[P.a.mhb]:this.xUb}):this.$.ei(-694765314,2,30,{[P.a.ama]:this.CU,[P.a.Ftc]:!0,[P.a.Itc]:this.nH,[P.a.x4]:ad,[P.a.w4]:Jd,[P.a.kva]:this.GI});this.CU||(this.zh.top>this.sourceRange.top&&(this.isRow||this.zh.left===this.sourceRange.left&&this.nH)?(ad=this.zh.height,this.zh.top-=ad,this.zh.bottom-=ad):this.zh.left>this.sourceRange.left&&
(this.fk||this.zh.top===this.sourceRange.top&&!this.nH)&&(ad=this.zh.width,this.zh.left-=ad,this.zh.right-=ad),this.E7())}this.WO&&this.cGa(!0);this.uqa=this.tableRange=null;this.gz=-1;this.nH=!1;this.fGa();return!0};this.PNc=ad=>{ad=this.zoomManager.Ik(ad);var Jd=ad.clientPoint;this.S6=ad;var De=this.lC?this.ha.B3(Jd,ad.Qh,5,!0):this.ha.Ey(Jd,ad.Qh,5,void 0,void 0,!0);this.Lr&&(this.O5()||this.Ena())&&(this.Tvb(Jd),this.X6b(Jd));if(De){if(this.tableRange.contains(De.topLeft)){if(ad=this.c0a?this.da.Pg.ro(De):
void 0,this.dWb?De=this.uHd(De,this.JI,Jd,ad):this.a3g(De,this.JI,Jd,ad),this.zh=this.rVa(De),this.ha.sourceRange=this.zh,this.rh.Vs(this.zh,this.mF),this.rh.rw(this.mF),this.Lr?this.TRb():this.rh.zq(Ac.iXa),6!==this.gz){for(Jd=1;4>=Jd;Jd++)if(De=this.My[Jd.toString()])De.parentNode.removeChild(De),this.rh.rU(this.JI?11:12,Jd).Yk.appendChild(De);this.gz=6}}else this.zh=this.zIb(De),this.VLf(ad,!1);this.HP()}return!0};this.clg=ad=>{ad=this.zoomManager.Ik(ad);var Jd=ad.clientPoint;this.S6=ad;var De=
this.lC?this.ha.B3(Jd,ad.Qh,5,!0):this.ha.Ey(Jd,ad.Qh,5,void 0,void 0,!0);this.Lr&&(this.O5()||this.Ena())&&(this.Tvb(Jd),this.X6b(Jd));if(De){if(this.HNf(De))return this.zh=this.zIb(De),this.ULf(ad,!1),!0;var Xe=this.c0a?this.da.Pg.ro(De):void 0;if(this.isRow||this.fk){if(this.dWb)De=this.uHd(De,this.isRow,Jd,Xe);else{ad=za.f(this.$);if(this.c0a){var lf=ad.ml(De,Xe);var mf=ad.Zk(Xe);Xe=pb.a.KO(Xe,mf.view.Xm);Jd=le.a.Ny(Xe,mf.domElement,Jd,ad.rtl)}else lf=ad.ml(De),mf=ad.Zk(this.paneType),Jd=le.a.Ny(mf.view.Xm,
this.domElement.parentNode,Jd,ad.rtl);Xe=!1;mf=2;this.nH=!1;this.isRow&&Jd.y-lf.topLeft.y>lf.height/2?(Xe=!0,mf=1):this.fk&&Jd.x-lf.topLeft.x>lf.width/2&&(Xe=!0);if(Xe){ad=ad.ot("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",ad.c5,mf);try{ad.NF(De),ad.$$mn(),De=ad.$$cu().range}finally{ad&&ad.dispose()}}}this.zh=this.zIb(De)}else{lf=za.f(this.$);if(this.c0a){mf=lf.Zk(Xe);var Rf=pb.a.KO(Xe,mf.view.Xm);Jd=le.a.Ny(Rf,mf.domElement,Jd,lf.rtl);Xe=lf.ml(De,Xe,!0)}else Xe=lf.ml(De),
mf=lf.Zk(this.paneType),Jd=le.a.Ny(mf.view.Xm,this.domElement.parentNode,Jd,lf.rtl);mf=!1;Rf=2;this.nH=!1;this.dWb?Math.abs(Jd.x-Xe.topLeft.x)<.3*Xe.width?this.nH=!1:Math.abs(Jd.x-Xe.bottomRight.x)<.15*Xe.width?(this.nH=!1,mf=!0):Jd.y-Xe.topLeft.y<=Xe.height/2?this.nH=!0:Jd.y-Xe.topLeft.y>Xe.height/2&&(mf=this.nH=!0):Jd.x-Xe.topLeft.x===Xe.width?(this.nH=!1,mf=!0):Jd.y-Xe.topLeft.y>Xe.height/2&&(this.nH=mf=!0,Rf=1);this.uqa&&(this.nH=this.JI);if(mf)if(this.dWb)Jd=this.da.mj,De=this.nH?Sa.D(Jd.ojb(De)):
Sa.D(Jd.ekb(De));else{Jd=lf.ot("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",lf.c5,Rf);try{Jd.NF(De),Jd.$$mn(),De=Jd.$$cu().range}finally{Jd&&Jd.dispose()}}this.rh.zq(this.mF);this.mF=this.nH?[11]:[12];for(Jd=1;4>=Jd;Jd++)(Xe=this.My[Jd.toString()])&&Xe.parentNode.removeChild(Xe),this.My[Jd.toString()]=null;this.evb(ad.clientPoint,ad.Qh,this.nH?11:12);this.zh=this.rVa(De)}this.ha.sourceRange=this.zh;this.Lr?this.q1c():(this.rh.Vs(this.zh,this.mF),this.rh.rw(this.mF));this.Lr?
this.TRb():this.rh.zq(Ac.iXa);if(6!==this.gz){for(De=1;4>=De;De++)if(ad=this.My[De.toString()])Jd=this.Lr?this.isRow?58:this.fk?59:this.nH?11:12:this.isRow||this.nH?11:12,ad.parentNode.removeChild(ad),this.rh.rU(Jd,De).Yk.appendChild(ad);this.gz=6}this.Lr||this.HP()}return!0};this.H8d=()=>{this.da.DU&&5<=this.gz&&(this.tableRange?this.GI?this.KT(!0):this.pua(!0):this.GI?this.isRow||this.fk?this.KT(!0):this.cGa(!0):this.isRow||this.fk?this.cGa(!0):this.KT(!0));this.WO?this.Ria(void 0):(this.CU&&this.Ria(0),
this.GI&&this.Ria(1));this.VQ=0;this.gz=-1;this.g5a()};this.tableRange=null;this.Nna=this.CU=this.GI=!1}dispose(){this.WO?this.Ria(void 0):(this.CU&&this.Ria(0),this.GI&&this.Ria(1));super.dispose()}l8d(A){this.S6=A;this.uqa=null;this.JI=this.isRow=this.fk=this.nH=!1;Tc.a.instance.ya(qb.a.zi,this.domElement.ownerDocument.body,this.onKeyDown);this.B0a&&(A.La.shiftKey||this.kTd(A))&&(this.v2b(),A.La.shiftKey&&(this.GI=!0),this.kTd(A)&&(this.CU=!0,za.f(this.$).Um.Mx(id.kqc)));this.p_e();this.da.DU=!0;
(this.tableRange=this.UOh(this.Cj.my(this.sourceRange.topLeft)))&&!this.tableRange.equals(this.sourceRange)?(this.uqa=this.tableRange,this.VQ=1,this.JI=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right,this.B0a&&this.GI?this.aca(!1,A.La.rawEvent):this.owb(!0,A.La.rawEvent)):(this.tableRange=null,this.isRow=this.sourceRange.isRow,this.fk=this.sourceRange.fk,this.isRow||this.fk?(this.VQ=3,this.jX=this.isRow?1:2,this.B0a&&this.GI?this.aca(!1,A.La.rawEvent):
this.G7b(!0,A.La.rawEvent),this.Lr&&(A=A.clientPoint,this.jOg(A),this.U$e(A))):(this.VQ=2,this.jX=0,this.B0a&&this.GI?this.G7b(!1,A.La.rawEvent):this.aca(!0,A.La.rawEvent)))}n3a(){this.da.DU=!1;this.g5a();this.VQ=0;this.WO||this.KT(!0);this.Lr&&(this.Y6a(!1),this.URb());if(!this.$.cy([this.zh],!1))return this.WO&&this.KT(!0),this.fGa(),this.gz=-1,!0;if(!this.s5g()||this.cTb(this.zh)||this.cTb(this.sourceRange))this.gz=-1;else{this.E7();this.ha.sourceRange=this.sourceRange.clone();const A=this.ha.sourceRange,
ja=this.ha.qa.Ui;this.lC?this.$.ei(-694765314,2,30,{[P.a.ama]:this.CU,[P.a.x4]:A,[P.a.w4]:ja,[P.a.kva]:this.GI,[P.a.mhb]:this.xUb}):this.$.ei(-694765314,2,30,{[P.a.ama]:this.CU,[P.a.x4]:A,[P.a.w4]:ja,[P.a.kva]:this.GI})}this.WO&&this.KT(!0);this.fGa();return!0}m8d(A){const ja=A.clientPoint,Ua=this.lC?this.ha.B3(ja,A.Qh,5,!0):this.ha.Ey(ja,A.Qh,5,void 0,void 0,!0);this.S6=A;this.Lr&&(this.O5()||this.Ena())&&(this.Tvb(ja),this.X6b(ja));return this.HNf(Ua)?(this.zh=this.rVa(Ua),this.ULf(A,!0),!0):this.K3i(Ua)?
(this.zh=this.zIb(Ua),this.VLf(A,!0),!0):!1}HP(A){A=void 0===A?!1:A;const ja=this.zh.toString();for(let Ua=1;4>=Ua;Ua++){const ac=this.My[Ua.toString()];ac&&ac.childNodes&&0<ac.childNodes.length&&(ac.childNodes[0].innerText=ja,ac.childNodes[1].innerText=this.Gtc,A&&(ac.childNodes[2].innerText=this.XWc))}}HNf(A){return!!this.uqa&&1!==this.VQ&&!!A&&this.uqa.contains(A.topLeft)}K3i(A){return!!this.uqa&&1===this.VQ&&!!A&&!this.uqa.contains(A.topLeft)}ULf(A,ja){this.tableRange=this.uqa;this.VQ=1;const Ua=
!this.GI;ja?(this.KT(!1),this.owb(Ua,A.La.rawEvent)):(this.cGa(!1),this.aca(Ua,A.La.rawEvent))}VLf(A,ja){this.tableRange=null;this.VQ=2;const Ua=!this.GI;ja?(this.KT(!1),this.nH=this.JI,this.G7b(Ua,A.La.rawEvent)):(this.pua(!1),this.aca(Ua,A.La.rawEvent))}vpe(){if(!za.f(this.$).ha.qa.Gn)return F.ULS.sendTraceTag(507875651,0,50,"DragSelectionClickBehaviorCellRangeAndTable: shouldShowHandlesOnSelectionChanged: false because multiple ranges are selected"),!1;const A=za.f(this.$).getRangeInformation(this.ha.qa.Ui);
for(const ja of A)if(Object(Fd.a)(Uc.PivotTableRange,ja))return F.ULS.sendTraceTag(507875650,0,50,"DragSelectionClickBehaviorCellRangeAndTable: shouldShowHandlesOnSelectionChanged: false because intersecting a pivot table"),!1;return!0}UOh(A){if(A&&A.contains(this.sourceRange)&&!A.equals(this.sourceRange)){if(A.Swa&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===A.top){const ja=new yd.Range(this.sourceRange.top,this.sourceRange.left,A.bottom,this.sourceRange.right,!1,!1);if(!ja.equals(A))return this.sourceRange=
ja,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),A}this.JI=A.left===this.sourceRange.left&&A.right===this.sourceRange.right;if(A.top===this.sourceRange.top&&A.bottom===this.sourceRange.bottom||this.JI)return A}return null}rVa(A){const ja=A.clone();this.JI?ja.left=Math.max(A.left-this.Zkb,1):ja.top=Math.max(A.top-this.lyb,1);ja.right=ja.left+this.sourceRange.width-1;ja.bottom=ja.top+this.sourceRange.height-1;return this.BGb(ja)}oVd(){const A=this.zh.topLeft.yi(this.sourceRange);
return!A&&(this.tableRange||this.Lr&&(this.isRow||this.fk))?this.JI||this.Lr&&this.isRow?this.zh.top===this.sourceRange.bottom+1:this.zh.left===this.sourceRange.right+1:A}Ubk(){if(this.JI&&this.zh.left!==this.tableRange.left||!this.JI&&this.zh.top!==this.tableRange.top){const A=kb.a.Yi(1,1,0,918,0,2065438552,"RearrangeInvalidDest");rb.a(this.$).CD([A]);return!0}return!1}T7j(){const A=this.$.qh.vi("UserAction","RearrangeRowColumnClientSide"),ja={["CopyPasteTargetType"]:1,["OperationId"]:Bd.a.create().toString(),
["Stopwatch"]:A,["DragDropIsShiftKeyDown"]:this.GI,["EncounteredDeploymentErrors"]:!1},Ua=this.CU?2:1,ac=this.$.ka.Ug(254);(new Promise((Ec,gd)=>{this.iri(ad=>{ad.Errors&&0<ad.Errors.length?gd(new qc(22,ad.Errors)):Ec(!0)},ad=>{ad=bd.a.Qj(ad.data);gd(new qc(22,ad))})})).then(()=>{F.ULS.sendTraceTag(520747156,0,50,'DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: success. copyPasteTargetType="1"');ac&&ac.Oyj(ja,Ua,this.sourceRange,this.zh);return Promise.resolve(!0)},Ec=>{F.ULS.sendTraceTag(520747155,
0,10,`DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: ${Ec?copyPasteInfra.getStringifiedError(Ec):"null"}, copyPasteTargetType="${1}"`);return ac?ac.kVj(Ec,ja,Ua,this.sourceRange,this.zh):Promise.reject(Ec)})}iri(A,ja){A=void 0===A?null:A;ja=void 0===ja?null:ja;const Ua={};this.JI?(Ua.FirstRow=this.zh.top-1,Ua.FirstColumn=0,Ua.DeltaColumn=0,Ua.DeltaRow=this.zh.bottom-this.zh.top+1):(Ua.FirstRow=0,Ua.FirstColumn=this.zh.left-1,Ua.DeltaColumn=this.zh.right-this.zh.left+1,Ua.DeltaRow=
0);Ua.LastRow=xd.a.KF;Ua.LastColumn=xd.a.nE;Ua.SheetName=this.$.sa.na?this.$.sa.na.name:this.$.Gh.getItemByName(this.$.Gh.na.name).sheetName;const ac=Sa.w(this.sourceRange,this.$);this.$.userOperationManager.enqueueOperation(new Lc.a(514,0,(Ec,gd,ad)=>{var Jd=this.$.pa.ta;Ec=A?jd.c(Ec,A):Ec;gd=ja?jd.b(gd,ja):gd;const De=Jd.Za(41,null);De.sourceRange=ac;De.destinationRange=Ua;return Yd.h(Jd,"RearrangeRowColumn",De,Ec,gd,ad,null,0)},64,()=>new te(ac,Ua)),null)}Ria(A){void 0===A?this.GI=this.CU=!1:0===
A?this.CU=!1:1===A&&(this.GI=!1);if(this.WO&&this.Nna&&!this.CU&&!this.GI||!this.WO&&!this.CU&&!this.GI)Tc.a.instance.Na(qb.a.Rj,this.domElement.ownerDocument.body,this.onKeyUp),this.Nna=!1}v2b(){this.Nna||(Tc.a.instance.ya(qb.a.Rj,this.domElement.ownerDocument.body,this.onKeyUp),this.Nna=!0)}Ebf(){Tc.a.instance.Na(qb.a.zi,this.domElement.ownerDocument.body,this.onKeyDown);this.Ria(void 0)}Dee(A){A=void 0===A?!1:A;this.gz=5;this.ypa(this.ur,this.io);this.Gtc=this.nei;this.XWc=this.vGk;this.evb(this.S6.clientPoint,
this.S6.Qh,this.Lr&&this.isRow?66:this.Lr&&this.fk?67:48,A)}bek(A){A=void 0===A?!1:A;this.gz=6;let ja;this.Lr?this.isRow?(this.mF=Ac.Tbk,ja=58):this.fk?(this.mF=Ac.Sbk,ja=59):this.JI?(this.mF=[11],ja=11):(this.mF=[12],ja=12):(ja=this.isRow||this.JI?11:12,this.mF=[ja]);this.ypa(this.clg,this.jlg);this.Gtc=this.Onf;this.XWc=this.WOg;this.evb(this.S6.clientPoint,this.S6.Qh,ja,A)}Oee(A){A=void 0===A?!1:A;this.gz=6;this.mF=this.JI?[11]:[12];this.ypa(this.PNc,this.QNc);this.Gtc=this.Onf;this.XWc=this.WOg;
this.evb(this.S6.clientPoint,this.S6.Qh,this.JI?11:12,A)}aca(A,ja){this.wxa&&this.F7b(this.isRow?"drag_row_replace":this.fk?"drag_column_replace":"drag_range_replace",ja);this.Dee(A);this.Kxb(A)}G7b(A,ja){this.wxa&&this.F7b(this.isRow?"drag_row_insert":this.fk?"drag_column_insert":"drag_range_insert",ja);this.bek(A);this.q1c(A)}owb(A,ja){this.wxa&&this.F7b(this.JI?"drag_table_row_rearrange":"drag_table_column_rearrange",ja);this.Oee(A);this.q1c(A)}cGa(A){this.rh.zq(this.mF);this.dGa(this.clg,this.jlg,
void 0,A);this.wxa&&this.XYc()}O0f(){return!this.zh.equals(this.sourceRange)}P0f(){return!this.oVd()}zTd(){return this.CU}s5g(){return this.ha.qa.Ui.equals(this.zh)?(F.ULS.sendTraceTag(507787463,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Drag Drop Not Allowed because source range and destination range are the same"),!1):!0}}Object(K.a)(oe,"DragSelectionClickBehaviorCellRangeAndTable",Ac,[]);var Kd=a(428),Ee=a(161);class rc extends Ac{constructor(A,ja,Ua,ac,Ec,gd){super(A,ja,Ua,ac,Ec,gd);this.H8d=
()=>{this.da.DU&&this.pua(!0);5===this.gz&&this.KT(!0);this.g5a()};this.QNc=ad=>{this.zoomManager.Ik(ad);this.da.DU=!1;this.g5a();this.WO||this.pua(!0);this.Lr&&(this.Y6a(!1),this.URb());this.ha.sourceRange=this.sourceRange.clone();if(this.A_f)this.$.ei(927125067,Md.a.eh,30,null);else if(this.haa){this.E7();this.ha.sourceRange=this.sourceRange.clone();ad=this.ha.sourceRange;const Jd=this.ha.qa.Ui;this.lC?this.$.ei(-694765314,2,30,{[P.a.ama]:!0,[P.a.x4]:ad,[P.a.w4]:Jd,[P.a.kva]:!1,[P.a.mhb]:this.xUb}):
this.$.ei(-694765314,2,30,{[P.a.ama]:!0,[P.a.x4]:ad,[P.a.w4]:Jd,[P.a.kva]:!1});F.ULS.sendTraceTag(509617280,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerUpRearrange: dragDropCells");za.f(this.$).Um.Mx(P.a.Q$);this.haa=!1}else this.M7j();this.WO&&this.pua(!0);this.lC&&this.fGa();this.gz=-1;return!0};this.PNc=ad=>{ad=this.zoomManager.Ik(ad);const Jd=ad.clientPoint;this.S6=ad;let De=this.lC?this.ha.B3(Jd,ad.Qh,5,!0):this.ha.Ey(Jd,ad.Qh,5,void 0,void 0,!0);this.Lr&&(this.O5()||this.Ena())&&
(this.Tvb(Jd),this.X6b(Jd));if(De){if(!this.bWd(De))return this.d0i(ad),!0;ad=this.c0a?this.da.Pg.ro(De):void 0;this.dWb?De=this.uHd(De,this.isRow,Jd,ad):this.a3g(De,this.isRow,Jd,ad);if(this.isRow||this.fk)this.zh=this.rVa(De);this.ha.sourceRange=this.zh;this.rh.Vs(this.zh,this.mF);this.rh.rw(this.mF);this.Lr?this.TRb():this.rh.zq(Ac.iXa);this.HP()}return!0};this.onKeyDown=ad=>this.Xlb(ad)?(this.v2b(),this.haa||(this.haa=!0,za.f(this.$).Um.Mx(id.kqc),this.Lr&&this.R1c()),!0):!1;this.onKeyUp=ad=>
{this.Xlb(ad)&&(this.WO?this.Ria():(Tc.a.instance.Na(qb.a.Rj,this.domElement.ownerDocument.body,this.onKeyUp),this.haa=this.Nna=!1),this.da.DU?za.f(this.$).Um.Mx(id.phb):za.f(this.$).Um.Mx(P.a.Q$),this.Lr&&this.R1c());return!0};this.ckg=ad=>{ad.Errors&&0<ad.Errors.length?(F.ULS.sendTraceTag(521410185,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsSuccess: Errors: [${kb.a.Kh(ad.Errors)}]`),this.zh.left=this.sourceRange.left,this.zh.right=this.sourceRange.right,this.zh.top=this.sourceRange.top,
this.zh.bottom=this.sourceRange.bottom):this.isRow?this.sourceRange.top<=this.zh.top&&this.sourceRange.bottom>=this.zh.top-1?(this.zh.top=this.sourceRange.top,this.zh.bottom=this.sourceRange.bottom):(this.sourceRange.top>this.zh.top||(this.zh.top-=this.sourceRange.height),this.zh.bottom=this.zh.top+this.sourceRange.height-1):this.sourceRange.left<=this.zh.left&&this.sourceRange.right>=this.zh.left-1?(this.zh.left=this.sourceRange.left,this.zh.right=this.sourceRange.right):(this.sourceRange.left>this.zh.left||
(this.zh.left-=this.sourceRange.width),this.zh.right=this.zh.left+this.sourceRange.width-1);this.E7();this.gz=-1};this.bkg=ad=>{ad=bd.a.Qj(ad.data);F.ULS.sendTraceTag(521410184,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsFail: Errors: [${kb.a.Kh(ad)}]`)};this.haa=this.Nna=!1}dispose(){super.dispose()}l8d(A){this.S6=A;this.isRow=this.fk=!1;this.p_e();this.jX=null!=this.zh?this.zh.isRow?1:this.zh.fk?2:0:0;this.da.DU=!0;Tc.a.instance.ya(qb.a.zi,this.domElement.ownerDocument.body,this.onKeyDown);
this.B0a&&this.kTd(A)&&(this.v2b(),this.haa=!0,za.f(this.$).Um.Mx(id.kqc));this.Dh=this.Cj.vwa(this.sourceRange);this.GUf=this.knj(this.zh);this.Dh||F.ULS.sendTraceTag(512341332,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerDownInternal: pivotTableRange null for range {0}",this.sourceRange);this.A_f=(new Ee.a(this.$.sa)).Dn;this.WO||za.f(this.$).Um.Mx(id.phb);this.bWd(this.zh)?(this.isRow=this.boj(),this.fk=this.$fj(),this.isRow||this.fk?(this.Kmb=!1,this.zh=this.rVa(this.zh),this.owb(A)):
(this.Kmb=!0,this.aca(A))):(this.Kmb=!0,this.aca(A),this.Lr&&(this.O5()||this.Ena())&&(A=A.clientPoint,this.jOg(A),this.U$e(A)))}n3a(){this.da.DU=!1;this.g5a();this.Lr&&(this.Y6a(!1),this.URb());if(this.A_f)return this.$.ei(927125067,Md.a.eh,30,null),this.lC&&this.fGa(),this.KT(!0),this.Kmb=!1,this.gz=-1,!0;if(this.haa||this.GUf){this.E7();this.ha.sourceRange=this.sourceRange.clone();const A=this.ha.sourceRange,ja=this.ha.qa.Ui;this.lC?this.$.ei(-694765314,2,30,{[P.a.ama]:this.haa,[P.a.x4]:A,[P.a.w4]:ja,
[P.a.kva]:!1,[P.a.mhb]:this.xUb}):this.$.ei(-694765314,2,30,{[P.a.ama]:this.haa,[P.a.x4]:A,[P.a.w4]:ja,[P.a.kva]:!1});F.ULS.sendTraceTag(509617281,0,50,`DragSelectionClickBehaviorPivotTableRange.onPointerUpInternal: dragDropCells with isCopyOperation="${this.haa}"`);za.f(this.$).Um.Mx(P.a.Q$);this.KT(!0);this.lC&&this.fGa();this.Kmb=!1;this.gz=-1;this.GUf=!1;return!0}return 5===this.gz?(this.KT(!0),this.Kmb=!1,this.oLk(),this.gz=-1,!0):!1}m8d(A){const ja=A.clientPoint,Ua=this.lC?this.ha.B3(ja,A.Qh,
5,!0):this.ha.Ey(ja,A.Qh,5,void 0,void 0,!0);this.S6=A;this.Lr&&(this.O5()||this.Ena())&&(this.Tvb(ja),this.X6b(ja));return this.Kmb?!1:this.bWd(Ua)?(this.e0i(A),!0):!1}HP(){const A=new yd.Range(this.zh.top,this.zh.left,this.zh.bottom,this.zh.right,!1,!0);6===this.gz&&(this.isRow?(--A.top,A.bottom=A.top+this.zh.height-1):(--A.left,A.right=A.left+this.zh.width-1));for(let ja=1;4>=ja;ja++){const Ua=this.My[ja.toString()];Ua&&Ua.childNodes&&0<Ua.childNodes.length&&(Ua.childNodes[0].innerText=A.toString())}}vpe(){if(!za.f(this.$).ha.qa.Gn)return F.ULS.sendTraceTag(507875653,
0,50,"DragSelectionClickBehaviorPivotTableRange.shouldShowHandlesOnSelectionChanged: false because multiple ranges are selected"),!1;var A=za.f(this.$).getRangeInformation(this.ha.qa.Ui);for(var ja of A)if(Object(Fd.a)(Uc.PivotTableRange,ja)&&(A=this.Cj.vwa(ja)))return ja=!A.isOlap||!A.ynb(!0),F.ULS.sendTraceTag(512341331,0,50,"DragSelectionClickBehaviorPivotTableRange.shouldShowHandlesOnSelectionChanged: enabling for range {0}",A),A.isActionable&&ja;return!1}rVa(A){A=A.clone();this.isRow?(A.left=
this.sourceRange.left,A.right=this.Dh.right,A.bottom=A.top+this.sourceRange.height-1):this.fk?(A.top=this.sourceRange.top,A.bottom=this.Dh.zE?this.Dh.zE.bottom:this.Dh.bottom,A.right=A.left+this.sourceRange.width-1):F.ULS.sendTraceTag(520176346,0,10,"DragSelectionClickBehaviorPivotTableRange.calculateRearrangeRange: no row/column rearrange");return this.BGb(A)}M7j(){const A={},ja=Sa.w(this.sourceRange,this.$);if(this.isRow){ja.FirstColumn=A.FirstColumn=this.zh.left-1;ja.LastColumn=A.LastColumn=this.zh.right-
1;if(this.sourceRange.top<=this.zh.top&&this.sourceRange.bottom>=this.zh.top-1){F.ULS.sendTraceTag(520176345,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}this.sourceRange.top>this.zh.top?A.LastRow=A.FirstRow=this.zh.top-1:(A.FirstRow=this.zh.top-this.sourceRange.height-1,A.LastRow=A.FirstRow+this.sourceRange.height-1)}else{A.FirstRow=Math.min(this.zh.top,this.zh.bottom-1);A.LastRow=this.zh.bottom-1;if(this.sourceRange.left<=this.zh.left&&this.sourceRange.right>=
this.zh.left-1){F.ULS.sendTraceTag(520176344,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}A.LastColumn=this.sourceRange.left>this.zh.left?A.FirstColumn=this.zh.left-1:A.FirstColumn=this.zh.left-this.sourceRange.width-1}const Ua={};Ua.SheetName=this.$.sa.na?this.$.sa.na.name:this.$.Gh.getItemByName(this.$.Gh.na.name).sheetName;Ua.Ranges=Array(2);Ua.Ranges[0]=ja;Ua.Ranges[1]=A;this.dri(Ua)}dri(A){this.$.userOperationManager.enqueueOperation(new Lc.a(265,0,(ja,
Ua,ac)=>{var Ec=this.$.pa.ta;ja=this.ckg?jd.c(ja,this.ckg):ja;Ua=this.bkg?jd.b(Ua,this.bkg):Ua;const gd=Ec.Za(1,null);gd.moveRange=A;return Yd.h(Ec,"MoveLineItems",gd,ja,Ua,ac,null,0)},64),null)}bWd(A){return null!==this.Dh&&null!==A&&this.Tkj(A)&&this.Unj(A)&&this.iqj(A)&&this.Zej(A)}Tkj(A){return this.Dh.zE?A.left>=this.Dh.zE.left:this.Dh.Pz?A.left>=this.Dh.Pz.left:A.left>=this.Dh.left}Unj(A){return this.Dh.Pz?A.right<=this.Dh.Pz.right:this.Dh.zE?A.right<=this.Dh.zE.right:A.right<=this.Dh.right}iqj(A){return this.isRow?
null!==this.Dh.zE&&A.top>=this.Dh.zE.top:this.fk?null!==this.Dh.Pz&&A.top>=this.Dh.Pz.top:null===this.Dh.top||A.top>=this.Dh.top}Zej(A){return this.Dh.zE?A.bottom<=this.Dh.zE.bottom:this.Dh.Pz?A.bottom<=this.Dh.Pz.bottom:A.bottom<=this.Dh.bottom}knj(A){return null!==this.Dh&&this.Dh.left>=A.left&&this.Dh.right<=A.right&&this.Dh.top>=A.top&&this.Dh.bottom<=A.bottom}boj(){return null!==this.Dh&&null!==this.Dh.zE&&this.Dh.zE.top<=this.zh.top&&this.Dh.zE.left<=this.zh.left&&this.Dh.zE.right>=this.zh.left}$fj(){return null!==
this.Dh&&null!==this.Dh.Pz&&this.Dh.Pz.top===this.zh.top&&this.Dh.Pz.left<=this.zh.left&&this.Dh.Pz.right>=this.zh.right}Oee(A){this.gz=6;this.mF=this.isRow?[11]:[12];this.ypa(this.PNc,this.QNc);this.evb(A.clientPoint,A.Qh,this.isRow?11:12,!1)}Dee(A){this.gz=5;this.ypa(this.ur,this.io);this.evb(A.clientPoint,A.Qh,this.Lr&&this.O5()?66:this.Lr&&this.Ena()?67:48,!1)}owb(A){this.wxa&&this.F7b(this.isRow?"drag_pivot_row_rearrange":"drag_pivot_column_rearrange",A.La.rawEvent);this.Oee(A);this.q1c()}aca(A){this.wxa&&
this.F7b("drag_pivot_replace",A.La.rawEvent);this.Dee(A);this.Kxb()}e0i(A){this.KT(!1);this.zh=this.rVa(this.zh);this.owb(A)}d0i(A){this.pua(!1);this.aca(A)}oLk(){if((null==this.sourceRange||null==this.zh||this.sourceRange.xF(!1)!==this.zh.xF(!1))&&!this.cTb(this.zh)){var A=kb.a.Yi(1,0,904,903,0,2069074184,"PivotTableInvalidMove");A.HelpTopicId=Kd.a.HPk;A.HelpDescription=Ba.a.instance.ia(913);rb.a(this.$).CD([A])}}Ria(){this.haa=!1;this.Nna&&(Tc.a.instance.Na(qb.a.Rj,this.domElement.ownerDocument.body,
this.onKeyUp),this.Nna=!1)}v2b(){this.Nna||(Tc.a.instance.ya(qb.a.Rj,this.domElement.ownerDocument.body,this.onKeyUp),this.Nna=!0)}O0f(){return!this.zh.equals(this.sourceRange)}P0f(){return!1}zTd(){return this.haa}Ebf(){Tc.a.instance.Na(qb.a.zi,this.domElement.ownerDocument.body,this.onKeyDown);this.Ria()}}Object(K.a)(rc,"DragSelectionClickBehaviorPivotTableRange",Ac,[]);var fd=a(423);class Ed extends He{constructor(A,ja){super(A);this.Am=()=>{this.domElement.classList.remove(oc.selecting);fd.c(this.da.$,
!0,"FillHandleClickBehavior:OnSelectionEnded")};this.iB=()=>{this.domElement.classList.add(oc.selecting)};this.onPointerDown=Ua=>{2===Ua.oh&&Ua.mw===Sys.UI.MouseButton.leftButton&&(this.da.ha.selectionType=4,this.da.ha.sourceRange=this.da.ha.qa.Ui,fd.c(this.da.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));return!1};this.w6=()=>{this.da.$.ei(1983983164,2,30,null);return!0};this.xj=()=>{Y.DOMElementExtensions.setVisible(this.pma,this.da.$.isEditMode)};this.h0b=()=>{Y.DOMElementExtensions.setVisible(this.pma,
!1)};this.g0b=()=>{Y.DOMElementExtensions.setVisible(this.pma,!0)};this.dig=()=>{Y.DOMElementExtensions.setVisible(this.pma,!1)};this.cig=()=>{Y.DOMElementExtensions.setVisible(this.pma,!0)};this.WZb=(Ua,ac)=>{Y.DOMElementExtensions.setVisible(this.pma,!ac.fld)};this.da=ja;ja=document.createElement("div");ja.className=ba.EwaSettings.EF()?xb.a.Ppi:xb.a.Opi;this.pma=ja;this.xj(null,null);A.appendChild(ja);Jb.a.instance.ya(qb.a.Zi,this.pma,this.onPointerDown);gc.a.instance.ya(qb.a.sr,this.pma,this.w6);
this.da.$.nr(this.xj);this.da.$.ih.I1e(this.h0b);this.da.$.ih.H1e(this.g0b);this.da.t0e(this.WZb);this.da.cellTextEditBox.nv(this.dig);this.da.cellTextEditBox.Wx(this.cig)}dispose(){Jb.a.instance.Na(qb.a.Zi,this.pma,this.onPointerDown);gc.a.instance.Na(qb.a.sr,this.pma,this.w6);this.da.$&&(this.da.ha.Fpa(this.iB),this.da.ha.Gba(this.Am),this.da.$.Pr(this.xj),this.da.$.ih.GCg(this.h0b),this.da.$.ih.FCg(this.g0b),this.da.CBg(this.WZb),this.da.cellTextEditBox.ev(this.dig),this.da.cellTextEditBox.Zw(this.cig));
super.dispose()}}Object(K.a)(Ed,"FillHandleClickBehavior",He,[]);class Rd{constructor(A){this.TPf=ja=>{this.e1c(ja.Qh,1);return!0};this.UPf=ja=>{this.e1c(ja.Qh,-1);return!0};this.Am=()=>{this.FUd=!1};this.iB=()=>{this.FUd=!0};this.da=A;this.clb=0;this.FUd=this.KFc=!1;this.Qga=Number.NaN;this.da.ha.xta(this.iB);this.da.ha.v9(this.Am);this.da.ha.t1e(this.Am)}dispose(){this.da.ha.Fpa(this.iB);this.da.ha.Gba(this.Am);this.da.ha.sCg(this.Am)}YY(){this.clb=0;this.KFc=!1;this.Qga=Number.NaN}Qnf(A){this.KFc=
!0;this.e1c(A,1)}Rnf(A){this.KFc=!1;this.e1c(A,-1)}e1c(A,ja){if(A)if(A.parentNode)if(this.FUd)isNaN(this.Qga)||(this.y1c(this.Qga,!1),this.Qga=Number.NaN);else if(A=parseInt(A.parentNode.getAttribute(P.a.DSb),10),isNaN(A))F.ULS.shipAssertTag(537159366,0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");else{if(!isNaN(this.Qga)&&A!==this.Qga){if(this.KFc)return;this.y1c(this.Qga,!1)}if(isNaN(this.Qga)||A!==this.Qga)this.Qga=A,this.clb=0;!this.clb&&0<ja&&
this.y1c(A,!0);this.clb=Math.max(this.clb+ja,0);!this.clb&&0>ja&&(this.y1c(A,!1),this.Qga=Number.NaN)}else F.ULS.shipAssertTag(537159367,0,!!A.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");else F.ULS.shipAssertTag(537159368,0,!!A,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")}y1c(A,ja){var Ua=this.da.Pg.v$b;for(const ac of Ua)for(Ua=this.da.rh.rU(3,ac,A).Yk,Y.DOMElementExtensions.toggleCssClass(Ua,oc.bpi,ja),Ua=Ua.firstChild;Ua;Ua=Ua.nextSibling)ea.a.contains(Ua.className,
"resizemarqueehandle",!0)&&Y.DOMElementExtensions.toggleCssClass(Ua,oc.ppi,ja)}}Object(K.a)(Rd,"MarqueeHoveringManager",null,[]);var Fe=a(325),Ae=a(158),We=a(1035),ve=a(1367),Ze=a(387);class Oe extends uc{constructor(A,ja){super(A);this.wBc=!1;this.ONc=()=>{if(!this.ZA)return F.ULS.shipAssertTag(537159364,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),!1;this.ZA.Z$j(this.Yma);this.ZA.phi(this.Zma);if(3===this.ZA.model.state)return!0;this.ZA.PPd(!0);return!0};
this.Noa=()=>{if(!this.ZA)return!1;this.ZA.Uvg(!1);this.ZA.xie(this.Zma,!1);if(3===this.ZA.model.state)return!0;this.ZA.PPd(!1);return!0};this.onPointerDown=Ua=>this.ZA?2===Ua.oh&&Ua.mw===Sys.UI.MouseButton.leftButton?!0:!1:!1;this.v_b=()=>{if(!this.ZA)return!1;this.ZA.xie(this.Zma,!0);this.ZA.PPd(!1);this.ZA.bhb();return!0};this.onDoubleClick=Ua=>{if(Ua.La)return Ua.La.stopPropagation(),!0;F.ULS.sendTraceTag(537159363,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");
return!0};this.container=A;this.ZA=Object(Ae.a)(ve.a,ja.metadata);this.WPg(ja)&&this.kSf(ja.isVisible)}dispose(){this.jAg();this.ZA=null;super.dispose()}fdb(A){this.ZA=Object(Ae.a)(ve.a,A.metadata);this.WPg(A)?this.kSf(A.isVisible):this.jAg();!ba.EwaSettings.isChangeGateEnabled("OfficeVSO:7800556_DisableRangeHighlightAdjustBehaivor")&&A.isVisible!==A.lLa&&this.ZA&&(this.ZA.ZDk(A.isVisible?1:0),Y.DOMElementExtensions.setVisible(this.Zma,A.isVisible))}kSf(A){this.wBc||(this.wBc=!0,this.Zma=document.createElement("div"),
this.Zma.id=`${this.container.id}-${P.a.caf}`,this.Zma.className=We.f,this.Yma=document.createElement("div"),this.Yma.id=`${this.container.id}-${P.a.NQh}`,this.Yma.className=We.c,this.t0=document.createElement("div"),this.t0.appendChild(this.Yma),this.t0.className=We.d,this.Zma.appendChild(this.t0),this.container.appendChild(this.Zma),F.ULS.sendTraceTag(537159365,0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created."),Jb.a.instance.ya(qb.a.T6,
this.t0,this.ONc),Jb.a.instance.ya(qb.a.HK,this.t0,this.Noa),Jb.a.instance.ya(qb.a.Zi,this.t0,this.onPointerDown),Fe.a.instance.ya(qb.a.click,this.t0,this.v_b),Fe.a.instance.ya(qb.a.sr,this.t0,this.onDoubleClick),Y.DOMElementExtensions.setVisible(this.t0,A))}jAg(){this.wBc&&(this.wBc=!1,Jb.a.instance.Na(qb.a.T6,this.t0,this.ONc),Jb.a.instance.Na(qb.a.HK,this.t0,this.Noa),Jb.a.instance.Na(qb.a.Zi,this.t0,this.onPointerDown),Fe.a.instance.Na(qb.a.click,this.t0,this.v_b),Fe.a.instance.Na(qb.a.sr,this.t0,
this.onDoubleClick),Y.DOMElementExtensions.Km(this.Yma),this.Yma=null,Y.DOMElementExtensions.Km(this.Zma),this.Zma=null)}WPg(A){A=new Ze.a(A.range,A.sheetId);return!!this.ZA&&this.ZA.YDc(A)}}Object(K.a)(Oe,"RangeCatchUpActivityHighlightBehavior",uc,[]);class Nf extends nd{constructor(A,ja,Ua,ac,Ec){super(A,ja,Ua,ac,Ec)}get W$(){return 16}get uub(){return this.da.ha.rangePicker.nHd(!1)}P6a(){return(this.da.inRangePicker||this.da.Pp)&&super.P6a()}}Object(K.a)(Nf,"RangePickerTouchGrippiesBehavior",nd,
[]);class Zf extends uc{constructor(A,ja,Ua){super(A);const ac=document.createElement("div"),Ec=document.createElement("div");ba.EwaSettings.Lr()?Ua?(ac.className=ja?oc.bqi:oc.dqi,Ec.className=ja?oc.cqi:oc.aqi):(ac.className=ja?oc.Ypi:oc.$pi,Ec.className=ja?oc.Zpi:oc.Xpi):(ac.className=ja?oc.iqi:oc.kqi,Ec.className=ja?oc.jqi:oc.hqi);A.appendChild(ac);A.appendChild(Ec)}}Object(K.a)(Zf,"RearrangeHighlightBehavior",uc,[]);var Rb;(function(A){A[A.topLeft=0]="topLeft";A[A.topRight=1]="topRight";A[A.bottomLeft=
2]="bottomLeft";A[A.bottomRight=3]="bottomRight";A[A.error=4]="error"})(Rb||(Rb={}));Object(K.b)("Corner",Rb);class Vb extends uc{constructor(A,ja,Ua,ac,Ec,gd){super(A);this.Gi=this.HV=null;this.Pea=0;this.zh=this.sourceRange=null;this.z7a=!1;this.onPointerDown=ad=>{ad=this.zoomManager.Ik(ad);if(this.wPg(ad)&&!this.z7a){this.x6f();this.Gi=this.Tv.lHd();this.HV=this.Tv.zIf(ad);if(!this.Gi||!this.HV||!this.HV.range)return F.ULS.shipAssertTag(537159361,0,!!this.Gi,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),
F.ULS.shipAssertTag(537159360,0,!!this.HV,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),F.ULS.shipAssertTag(537159331,0,!!this.HV.range,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;this.zh=this.HV.range.clone();this.sourceRange=this.zh.clone();this.Pea=this.ODf(ad);if(4===this.Pea)return F.ULS.shipAssertTag(537159330,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;const Jd=this.fGf(ad,!0);if(!Jd)return F.ULS.shipAssertTag(537159329,
0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),!1;if(!this.Whf(Jd))return F.ULS.shipAssertTag(537159328,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;this.da.d_a=!0;this.Gi.WN(!1);this.hP.Qnf(ad.Qh);this.Tv.jwg(!0,this.qR.qla);this.Gi.$b.removeSelection();this.Gi.ykc(this.BMf);this.zzg();this.z7a=!0;ld.b(this.$,!0)}return!0};this.ur=ad=>{ad=this.zoomManager.Ik(ad);ad=this.fGf(ad,!1);if(!ad)return!0;
ad=this.Whf(ad);if(!ad)return F.ULS.shipAssertTag(537159327,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),this.twc(!0),!1;if(this.zh.equals(ad))return!0;this.zh=ad;ad=this.Kxb();ad||(F.ULS.shipAssertTag(537159326,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.twc(!0));return ad};this.io=ad=>{this.zoomManager.Ik(ad);ad=this.E7();F.ULS.shipAssertTag(537159325,0,ad,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");this.twc(!ad);
return ad};this.BMf=()=>{this.twc(!0)};this.da=ja;this.zoom=gd;this.$=ja.$;this.xV=[];this.ha=this.da.ha;this.hP=Ua;this.Tv=ac;this.qR=Ec;ja=Ha.zc.Ha()?ka.a.Zg(Ha.zc):this.$.ka.Ug(464);F.ULS.shipAssertTag(510255176,0,!!ja,"ResizeMarqueeBehaviorBase Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen.");this.cD=ja.cD;for(const ad of this.dFg())ja=this.Tv.$gf(A,ad,this.U1e(),this.onPointerDown),this.xV.push(ja);for(const ad of this.xV)Jb.a.instance.ya(qb.a.T6,
ad,this.hP.TPf),Jb.a.instance.ya(qb.a.HK,ad,this.hP.UPf);this.fdb(Ec)}dispose(){this.xV.forEach(A=>{Jb.a.instance.Na(qb.a.Zi,A,this.onPointerDown)});this.xV.length=0;super.dispose()}get zoomManager(){return this.zoom.zoomManager}fdb(A){this.qR=A;this.c2e(A);this.Tv.O5b(A,this.xV,this.upe());this.hP.YY()}fGf(A,ja){const Ua=A.Qh;A=A.clientPoint;if(!Ua||!A)return F.ULS.shipAssertTag(537159324,0,!!Ua,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),F.ULS.shipAssertTag(537159323,0,!!A,
"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),null;ja&&(A=this.bag(A));ja=this.ha.Ey(A,Ua,0,!0,!1,!0);ja||(A=this.bag(A),ja=this.ha.Ey(A,Ua,0,!0,!1,!0));return ja}bag(A){A.y+=0===this.Pea||1===this.Pea?2:-2;A.x+=0===this.Pea||2===this.Pea?2:-2;return A}Whf(A){if(!A||!this.sourceRange)return F.ULS.shipAssertTag(537159322,0,!!A,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),F.ULS.shipAssertTag(537159321,0,!!this.sourceRange,"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),
null;if(0===this.Pea)return new yd.Range(A.top,A.left,this.sourceRange.bottom,this.sourceRange.right,!0,!1);if(1===this.Pea)return new yd.Range(A.top,this.sourceRange.left,this.sourceRange.bottom,A.right,!0,!1);if(2===this.Pea)return new yd.Range(this.sourceRange.top,A.left,A.bottom,this.sourceRange.right,!0,!1);if(3===this.Pea)return new yd.Range(this.sourceRange.top,this.sourceRange.left,A.bottom,A.right,!0,!1);F.ULS.shipAssertTag(537159320,0,!1,`ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: ${Rb[this.Pea]}`);
return null}E7(){return this.cD.aag(this.Gi,this.HV,this.zh)}Kxb(){return this.E7()}twc(A){A&&F.ULS.sendTraceTag(537159319,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate formula highlights as a fallback.");this.hP.Rnf(this.xV[0]);this.Tv.jwg(!1,this.qR.qla);this.Gi.$b.setCaretPositionToEnd();this.Gi.KSc(this.BMf);this.a1g();this.z7a=this.da.d_a=!1;ld.b(this.$,!1);this.Tv.Xxg()}}Object(K.a)(Vb,"ResizeMarqueeBehaviorBase",uc,[]);class Cc extends Vb{constructor(A,
ja,Ua,ac,Ec,gd){super(A,ja,Ua,ac,Ec,gd)}dFg(){return[oc.oqi,oc.pqi,oc.mqi,oc.nqi]}U1e(){return[oc.lqi]}ODf(A){A=A.Qh;if(A===this.xV[0])return 0;if(A===this.xV[1])return 1;if(A===this.xV[2])return 2;if(A===this.xV[3])return 3;F.ULS.shipAssertTag(537159318,0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}zzg(){this.Tv.ypa(this.ur,this.io,!0)}a1g(){this.Tv.fwe(this.ur,this.io,!0)}wPg(A){return 2===(Md.a.eh=A.oh)&&A.mw===Sys.UI.MouseButton.leftButton}upe(){return!0}x6f(){F.ULS.sendTraceTag(537159317,
0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")}c2e(A){for(const ja of this.xV)ja.style.backgroundColor=A.Yk.style.borderColor}}Object(K.a)(Cc,"ResizeMarqueeMouseBehavior",Vb,[]);class rg extends Vb{constructor(A,ja,Ua,ac,Ec,gd){super(A,ja,Ua,ac,Ec,gd);this.p_b=()=>{const ad=3===Md.a.eh;this.pZd&&!ad?this.Tv.O5b(this.qR,this.xV,!1):!this.pZd&&ad&&this.Tv.O5b(this.qR,this.xV,!0);this.pZd=ad};this.HVj=(ad,Jd)=>{Jd.DSb===this.qR.qla&&this.Tv.O5b(this.qR,
this.xV,!Jd.start&&this.upe())};Md.a.U0e(this.p_b);this.pZd=3===Md.a.eh;this.Tv.tzh(this.HVj)}dispose(){Md.a.aCg(this.p_b);super.dispose()}dFg(){return[xb.a.Uoi,xb.a.Toi]}U1e(){return[xb.a.Ytf,xb.a.mvc,xb.a.lvc]}ODf(A){A=A.Qh;if(A===this.xV[0])return 0;if(A===this.xV[1])return 3;F.ULS.shipAssertTag(537159316,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}zzg(){Da.a.IU?this.Tv.ypa(this.ur,this.io,!1):this.Tv.xek(this.ur,this.io)}a1g(){Da.a.IU?this.Tv.fwe(this.ur,
this.io,!1):this.Tv.S1k(this.ur,this.io)}wPg(A){return 3===(Md.a.eh=A.oh)}upe(){return 3===Md.a.eh}x6f(){F.ULS.sendTraceTag(537159315,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")}c2e(){}}Object(K.a)(rg,"ResizeMarqueeTouchBehavior",Vb,[]);class yf extends uc{constructor(A,ja){super(A);yf.CKb(A,Pc.a.upi+" "+xb.a.QHa,null===ja||void 0===ja?void 0:ja.horizontal);yf.CKb(A,Pc.a.tpi+" "+xb.a.QHa,null===ja||void 0===ja?void 0:ja.vertical);yf.CKb(A,Pc.a.qpi+
" "+xb.a.QHa,null===ja||void 0===ja?void 0:ja.horizontal);yf.CKb(A,Pc.a.spi+" "+xb.a.QHa,null===ja||void 0===ja?void 0:ja.vertical);yf.CKb(A,xb.a.rpi)}static CKb(A,ja,Ua){const ac=document.createElement("div");ac.className=ja;Ua&&(ac.style.backgroundImage=`url("${Ua}")`);A.appendChild(ac)}}Object(K.a)(yf,"SelectionCutCopyBehavior",uc,[]);class jg extends uc{constructor(A){super(A);appChrome.renderSpinner(A)}}Object(K.a)(jg,"SelectionPasteBehavior",uc,[]);class If extends uc{constructor(A,ja){super(A);
If.UKb(A,Pc.a.Vpi+" "+xb.a.QHa,null===ja||void 0===ja?void 0:ja.horizontal);If.UKb(A,Pc.a.Upi+" "+xb.a.QHa,null===ja||void 0===ja?void 0:ja.vertical);If.UKb(A,Pc.a.Rpi+" "+xb.a.QHa,null===ja||void 0===ja?void 0:ja.horizontal);If.UKb(A,Pc.a.Tpi+" "+xb.a.QHa,null===ja||void 0===ja?void 0:ja.vertical);If.UKb(A,xb.a.Spi)}static UKb(A,ja,Ua){const ac=document.createElement("div");ac.className=ja;Ua&&(ac.style.backgroundImage=`url("${Ua}")`);A.appendChild(ac)}}Object(K.a)(If,"SelectionRangePickerBehavior",
uc,[]);class cf extends nd{constructor(A,ja,Ua,ac,Ec){super(A,ja,Ua,ac,Ec)}get W$(){return 0}get uub(){return this.da.ha.qa.Ui}P6a(){const A=this.da.Pp||this.da.isEditing;return this.da.ha.qa.Gn&&!A&&super.P6a()}}Object(K.a)(cf,"SelectionTouchGrippiesBehavior",nd,[]);var Nb=a(59);let Bc=class extends Xa.a{constructor(A,ja,Ua){super();this.vHb=(ac,Ec)=>{ac=Ec.W$;const gd=this.da;Ec=Ec.c6i;const ad=Ec.Yk,Jd=Ec.H9;switch(ac){case 24:Ec.H9.push(new Oe(ad,Ec));break;case 0:Ec.H9.push(new Ed(ad,gd));Da.a.Gx||
(Jd.push(new oe(ad,this.da.$,Ec.paneType,this.Cj,this.Tv,this.zoom)),Jd.push(new rc(ad,this.da.$,Ec.paneType,this.Cj,this.Tv,this.zoom)));Jd.push(new cf(Ec,ad,gd,Ec.paneType,this.zoom));break;case 3:Jd.push(new He(ad));Da.a.Gx||(Jd.push(new fc(ad,this.da.$,Ec.paneType,this.hP,this.Tv,Ec,this.zoom)),Jd.push(new Cc(ad,this.da,this.hP,this.Tv,Ec,this.zoom)),Jd.push(new rg(ad,this.da,this.hP,this.Tv,Ec,this.zoom)));break;case 4:case 5:case 65:Jd.push(new yf(ad,this.y3e));break;case 30:Jd.push(new jg(ad));
break;case 16:Jd.push(new If(ad,this.y3e));Jd.push(new Nf(Ec,ad,gd,Ec.paneType,this.zoom));break;case 11:case 12:case 58:case 59:case 60:case 61:Jd.push(new Zf(ad,11===ac||58===ac||60===ac,58===ac||59===ac||60===ac||61===ac));break;case 17:Jd.push(new He(ad));break;case 19:Jd.push(new He(ad)),Jd.push(new $d(Ec,ad,gd,Ec.paneType,this.zoom))}Ec.IHb=!0};this.$=A;this.zoom=Ua;this.da=za.f(A);this.Cj=ja;this.hP=new Rd(this.da);this.Tv=new Aa(this.da);this.da.rh&&(this.da.rh.Nyh(this.vHb),this.da.rh.update(!1))}get y3e(){ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6809974_DancingAnts1Cdn")&&
!this.x3e&&(this.x3e={vertical:Nb.a.current.uu(104),horizontal:Nb.a.current.uu(105)});return this.x3e}dispose(){this.da.rh.njk(this.vHb);this.hP&&(this.hP.dispose(),this.hP=null);super.dispose()}};Bc=Object(U.__decorate)([Object(ka.d)(Ha.ad),Object(U.__param)(0,Object(Ha.Lb)()),Object(U.__param)(1,Object(Ha.hg)()),Object(U.__param)(2,Object(Ha.Lg)())],Bc);Object(K.a)(Bc,"GridHighlightsBehaviorManager",Xa.a,[]);var Ob=a(182),zc=a(1282),od=a(291),ce=a(977),Qb=a(187),Xc=a(23);class md extends zc.a{constructor(A,
ja,Ua){super(A,ja,Ua);this.fgc=this.KEa=null}get mZ(){return mb.AFrameworkApplication.ra.cL}yDf(A){switch(A){case 1:return Object(Xc.a)("ImageUploadNoFileSpecified");case 2:return Object(Xc.a)("ImageUploadUnsupportedFileType");default:return""}}g5g(A){return md.bra(A,this.bYi())}bYi(){return md.uXe}bra(A,ja){ja=void 0===ja?null:ja;A=this.g5g(A);return 0!==A?(ja&&ja.IZe(),2===A&&(ja=this.yDf(A),this.lp(0,ja)),!1):!0}finalizeUpload(A,ja){F.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");
this.c9d=ja;this.lMk();od.a.mark(5576);this.fgc=this.mZ.vi("LoadResource","PictureUploadTime")}lp(A,ja){const Ua=new Qb.a;Ua.Bh=0;Ua.jG(A,Object(Xc.a)("ImageUploadFailedTitle"),ja,null)}d0b(){F.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");super.d0b();this.fgc&&(this.fgc.stop(),this.fgc=null);this.MUh()}lMk(){this.KEa=(new ce.a).create();this.KEa.message=Object(Xc.a)("ImageUploadWait");this.KEa.Bh=5;this.KEa.hC=!1;this.KEa.UOa(null,null,null)}MUh(){this.KEa&&(this.KEa.close(),
this.KEa=null)}static B4i(A,ja){A=xa.a.Rr(A);for(let Ua=0;Ua<ja.length;++Ua)if(A.endsWith(ja[Ua]))return!0;return!1}static bra(A,ja){ja=void 0===ja?null:ja;ja||(ja=md.uXe);return A?md.B4i(A,ja)?0:2:1}}md.uXe=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(K.a)(md,"PictureUploader",zc.a,[]);var ie=a(107),me=a(42),Pe=a(646),gf=a(419),tf=a(355),Qe=a(252),Ca=a(236),yb=a(128),wc=a(244),dd;(function(A){A[A.unknown=0]="unknown";A[A.bing=1]="bing";A[A.M365=2]="M365"})(dd||(dd={}));Object(K.b)("InsertMediaProviders",
dd);var vd=a(98),Zd=a(356),Re=a(1048),ff=a(81);class af extends Re.a{constructor(A,ja){super(A,ff.a.getOrigin(ja))}w2b(A,ja){this.isEnabled()&&this.PW(this.targetOrigin)&&(this.Tq(A),this.Ip(A,ja))}}Object(K.a)(af,"InsertMediaCrossDocumentMessenger",Re.a,[895,474,2]);class xf{}Object(K.a)(xf,"OnlineMediaSearchResult",null,[]);var eg=a(425),Ab=a(983),xc;(function(A){A[A.OK=0]="OK";A[A.cancel=1]="cancel";A[A.error=2]="error";A[A.open=3]="open"})(xc||(xc={}));Object(K.b)("HubbleAction",xc);var eb=a(72);
class Ub extends Ca.a{constructor(A,ja,Ua,ac,Ec,gd){super();this.NFc=!1;this.w_d=this.IK=this.$Ja=null;this.HZf=!1;this.correlationId=null;this.cLj=()=>{this.SHa(this.reb);this.i6a(1)};this.RYd=ad=>{ad.keyCode===Sys.UI.Key.tab&&("KeepFocusDiv"!==ad.target.id||ad.shiftKey?"KeepFocusStartDiv"===ad.target.id&&ad.shiftKey&&(ad.preventDefault(),document.getElementById("KeepFocusDiv").focus()):(ad.preventDefault(),document.getElementById("KeepFocusStartDiv").focus()))};this.NSj=()=>{this.WGb&&(this.WGb.launchUpsellExperience("stockimages"),
F.ULS.sendTraceTag(537155807,0,50,"OnLaunchM365Upsell: Launched Dime Upsell flow"))};this.oUj=ad=>{ad&&ad.Values&&(ad=ad.Values,delete ad.m_Origin,delete ad.m_Source,delete ad.m_ReceivedTime,F.ULS.sendTraceTag(508953229,0,50,"Received OTel event: "+ad.eventName||!1),la.a.sendOtelEvent(Object.assign(new Ab.a,{otelEvent:ad})))};this.dialogTitle=gd;this.$=A;this.pSf=ja;this.WGb=Ua;this.eia=[];this.jpb=ac;this.Zai=Ec;this.P2e=this.$.ua.InsertOnlinePictureMaxCountOfImagesToInsert;this.Po=this.c3h();this.HZf=
ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8665911_RemoveMediaDetailsInTelemetry")}aMk(A){this.NFc=!1;this.showDialog(this.dialogTitle,null);this.$Ja=document.getElementById(this.Jo("InsertMediaFrame"));if(!this.$Ja)throw this.SHa(this.reb),Error.invalidOperation("Couldn't get InsertMediaIframe.");const ja=document.getElementById(this.Jo("WACDialogPanel"));ja&&ja.setAttribute(Qc.a.Oj,Qc.a.GUa);var Ua=document.createElement("div");Ua.id="KeepFocusStartDiv";Ua.tabIndex=0;Ua.className="keep-focus-start";
this.$Ja.parentNode.insertBefore(Ua,this.$Ja.parentNode.firstChild);Ua=document.createElement("div");Ua.id="KeepFocusDiv";Ua.tabIndex=0;Ua.className="keep-focus";this.correlationId=Bd.a.create();this.$Ja.parentNode.appendChild(Ua);$addHandler(this.Vgb,"keydown",this.RYd);this.$Ja.src=this.pSf;this.$Ja.frameBorder="0";Ua=document.getElementById(this.Jo("WACDialogButtonPanel"));if(!Ua)throw Error.invalidOperation("Couldn't get WACDialogButtonPanel.");Ua.className="display-none";Ua=document.getElementById(this.Jo("WACDialogTitleText"));
if(!Ua)throw Error.invalidOperation("Couldn't get WACDialogTitleText.");Ua.className="display-none";2===this.jpb&&(document.getElementById(this.Jo("WACDialogTitlePanel")).className="display-none",document.getElementById(this.Jo("WACDialogBodyPanel")).className="padding-zero");ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8728224_StockImagesDialogHeightFix")&&ja&&(ja.style.overflow="hidden",ja.style.height="auto",Ua=document.getElementById(this.Jo("WACDialogOuterContainer")))&&(ja.style.marginTop=
"",ja.style.top=(Ua.parentElement.clientHeight-ja.clientHeight)/2+"px");yb.FocusManager.instance().i0().scope.e6=!0;this.IK=new af(this.$Ja.contentWindow,this.pSf);this.IK.PW("https://osiziwuspersimmon002.blob.core.windows.net");this.IK.PW("https://osizewuspersimmon001.blob.core.windows.net");this.IK.PW("https://osizpscuspersimmon000.blob.core.windows.net");this.IK.PW("https://cdn.hubblecontent.msit.osi.office.net");this.IK.PW("https://cdn.hubblecontent.osi.office.net");this.IK.w2b(La.a.Juh,ac=>{this.OJj(ac,
A.Wia)});this.IK.w2b(La.a.insert,()=>{this.iSj(A.Wia)});this.IK.w2b(La.a.isd,this.cLj);this.IK.w2b(La.a.nvh,ac=>{this.oUj(ac)});2===this.jpb&&0===this.Zai&&(this.IK.w2b(La.a.ztj,this.NSj),this.w_d=this.WGb.S4a("MsoPremiumStockImages",ac=>{F.ULS.sendTraceTag(537155811,0,50,"OnCompleteM365Upsell: Upsell completed from stock images");ac.isEnabled?this.IK.sendMessage(La.a.A7k,{["LicenseTier"]:ac.toString()}):F.ULS.sendTraceTag(537155810,0,10,"OnCompleteM365Upsell: Upsell completed but license tier didn't upgrade.")}));
this.i6a(3)}dispose(){this.eia=null;this.WGb&&this.w_d&&this.WGb.nfe("MsoPremiumStockImages",this.w_d);this.IK&&(this.IK.dispose(),this.IK=null);super.dispose()}hide(){super.hide();vd.a.gWc(this.$)}get Efa(){return wc.a.Esc+"/InsertMediaDialog"}get rea(){return!1}OJj(A,ja){A=A&&A.Values?(A=A.Values)?Object(Ea.a)(new xf,{Action:A.action||"",Caption:A.caption||"",ContentType:A.contentType||"",FileExtension:A.extension||"",PageUrl:A.pageUrl||"",SourceUrl:A.sourceUrl||"",ThumbnailUrl:A.thumbnailUrl||
"",LicenseUrl:A.licenseUrl||"",LicenseDisplayName:A.licenseDisplayName||"",Height:A.height||0,Width:A.width||0}):null:null;A&&(this.eia.push(A),this.NFc&&(F.ULS.sendTraceTag(537155809,0,50,"InsertMediaDialog.OnAddItem: Insert Message handling was pending"),ja(this.eia),this.NFc=!1,this.SHa(this.reb)))}iSj(A){this.eia&&0<this.eia.length?this.eia.length<=this.P2e?(A(this.eia),this.i6a(0),this.SHa(this.reb)):(this.jG(),F.ULS.sendTraceTag(537155808,0,10,"OnInsert : Tried to insert more than allowed limit of items."),
this.eia.length=0,this.i6a(2)):this.NFc=!0}c3h(){const A=document.createElement("div");A.id="InsertMediaDialog";A.className=ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixHorizonalScroll",!0)?"insert-media-dialog":"insert-media-dialog-old";const ja=document.createElement("div");ja.id="InsertMediaPanel";ja.className=ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixCancelButton",!0)?"insert-media-panel":"insert-media-panel-old";
const Ua=document.createElement("iframe");Ua.id="InsertMediaFrame";Ua.className="insert-media-frame";A.appendChild(ja);ja.appendChild(Ua);return eg.b(A)}jG(){const A=kb.a.Yi(1,0,0,0,0,466721363,"InsertPictureExceededAllowedCount");A.Description=String.format(Ba.a.instance.$g(206),this.P2e.toLocaleString());new Zd.a(this.$,A)}GNi(){return 2===this.jpb?"M365":"bing"}i6a(A){var ja,Ua;if(2===this.jpb||1===this.jpb){const Ec=mb.AFrameworkApplication.fa.Xa("InsertMediaDialogAriaTenantNameSpace");if(Ec&&
""!==Ec){var ac=[];Array.add(ac,Object.assign(new eb.a,{name:"DialogMode",string:this.GNi()}));Array.add(ac,Object.assign(new eb.a,{name:"Provider",string:dd[this.jpb]}));Array.add(ac,Object.assign(new eb.a,{name:"InsertedFiles",int64:null===(ja=this.eia)||void 0===ja?void 0:ja.length}));this.HZf||ac.push(Object.assign(new eb.a,{name:"MediaDetails",string:this.eia?JSON.stringify(this.eia.map(gd=>gd.SourceUrl)):null}));Array.add(ac,Object.assign(new eb.a,{name:"DialogResult",string:xc[A]}));Array.add(ac,
Object.assign(new eb.a,{name:"CorrelationId",string:null===(Ua=this.correlationId)||void 0===Ua?void 0:Ua.toString()}));la.a.sendTelemetryEvent(Object.assign(new sa.a,{name:String.format("{0}.{1}",Ec,"InsertOnlineImages"),dataFields:ac}))}}}}Object(K.a)(Ub,"InsertMediaDialog",Ca.a,[]);var Fc=a(429),rd=a(306),Gd=a(354);class ue extends md{constructor(A,ja,Ua,ac,Ec,gd){super(null,Ua,ac);this.h7f=0;this.Wia=ad=>{if(ad){var Jd=Array(ad.length);for(var De=0;De<ad.length;De++){const mf=ad[De];Jd[De]={};
Jd[De].SourceUrl=mf.SourceUrl;xa.a.Kxa(mf.LicenseUrl)&&xa.a.Kxa(mf.PageUrl)&&(Jd[De].LicenseUrl=mf.LicenseUrl,Jd[De].LicenseDisplayName=mf.LicenseDisplayName,Jd[De].PageUrl=mf.PageUrl);Jd[De].AltText=-2053056795===this.Ah.command?mf.Caption:"";Jd[De].IsCellPicture=15735758===this.Ah.command||570484235===this.Ah.command}var Xe=-2009825598===this.Ah.command?"bing":"M365";De=za.f(this.$);var lf=Sa.p(De.ha.qa.activeCell,this.$);gf.a(this.$.userOperationManager,(mf,Rf,sg)=>tf.w(this.$.pa.ta,lf,Jd,Xe,jd.c(mf,
this.DUj),jd.b(Rf,this.CUj),sg,null),mf=>new Lc.a(595,0,mf),this.Ah);Nd.HelperMethods.saa?(De=new Map,De.set("MediaProvider",Xe),De.set("ImagesCount",ad.length.toString()),De.set("TimeTakenToOpenDialog",this.h7f.toString()),ie.Health.instance.recordKpiUsage(rd.a.acj,Gd.b.SuccessBased,Fc.a.jXg,De)):F.ULS.sendTraceTag(537155805,0,15,"OnlinePictureUploaderWrapper.UploadResponseReceived: KPI Usage not supported.");this.d0b()}else F.ULS.sendTraceTag(537155806,0,10,"OnlinePictureUploaderWrapper.UploadResponseReceived: Response is null")};
this.DUj=ad=>{if(Qe.a(ad))F.ULS.sendTraceTag(537155799,0,10,`OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded with errors. Errors: ${kb.a.Kh(ad.Errors)}`);else{F.ULS.sendTraceTag(537155801,0,50,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded.");const Jd=this.Ah.command;15735758!==Jd&&570484235!==Jd&&(ad.Result?bb.a(this.$).fOa(1,ad.Result):F.ULS.sendTraceTag(537155800,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess:Result.result is null"))}};
this.CUj=()=>{F.ULS.sendTraceTag(537155798,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadFailed: Operation failed")};this.$=A;this.Ah=ja;this.MS=gd;this.E3e=me.a.instance.Qi("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.showDialog()}dispose(){this.$=null}showDialog(){let A=null;A=this.$.qh.vi("UserAction","showOnlineImagesDialogTimeStopwatch");switch(this.Ah.command){case -2009825598:case 15735758:this.hLk();break;case -2053056795:case 570484235:this.E3e.execute(ja=>{ja.isFeatureEnabled("MsoPremiumStockImages",
!1).catch(Ua=>F.ULS.sendTraceTag(557200643,0,10,`OnlinePictureUploaderWrapper::ShowDialog - Failed to load the premium state from application feature helper: ${Ua}`)).then(Ua=>{this.iLk(Ua);return null})})}A.stop();this.h7f=A.ii}hLk(){let A=this.$.ua.BingPictureEndpoint;const ja=Pe.a.qU(mb.AFrameworkApplication.lcid),Ua=Bd.a.create();A?(A=0<A.search(RegExp("insertmedia.bing.office.net","gi"))?String.format(A,1,1):String.format(A,1,mb.AFrameworkApplication.lcid,ja?ja.name:"en-us",mb.AFrameworkApplication.buildVersion,
Ua.toString(),1,this.$.ua.DocumentHostInfo.LoggableUserId),this.Bqc(A,1,-1,Ba.a.instance.ia(1764))):(F.ULS.sendTraceTag(537155804,0,10,"OnlinePictureUploaderWrapper::ShowDialogForBingPictures - Can't access the Bing service endpoint"),this.MS.setException(Error.create("Failed to access the Bing service endpoint")))}iLk(A){var ja=this.$.ua.M365PictureEndpoint,Ua=Bd.a.create();if(ja){var ac=this.$.ua.DocumentHostInfo.UserId;ac=ac?xa.a.jF(ac).toString():"0";var Ec=this.E3e.instance.isFreemiumUpsellEnabled();
A=A?1:Ec?0:-1;Ua=Ua.toString();Ec=Pe.a.qU(mb.AFrameworkApplication.lcid).name;ja=String.format(ja,mb.AFrameworkApplication.lcid,Ec,mb.AFrameworkApplication.buildVersion,Ua,1,ac,A,1);this.Bqc(ja,2,A,Ba.a.instance.ia(1763))}else F.ULS.sendTraceTag(537155803,0,10,"OnlinePictureUploaderWrapper::ShowDialogForStockImages - Can't access the M365 service endpoint"),this.MS.setException(Error.create("Failed to access the M365 service endpoint"))}Bqc(A,ja,Ua,ac){try{(new Ub(this.$,A,me.a.instance.mo("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
ja,Ua,ac)).aMk(this),this.MS.setResult(!0)}catch(Ec){F.ULS.sendTraceTag(537155802,0,10,`OnlinePictureUploaderWrapper::CreateAndShowDialog failed [Exception : ${Ec}] [MediaProvider : ${ja}] [DialogLicenseTier : ${Ua}]`),this.MS.setException(Ec)}}}Object(K.a)(ue,"OnlinePictureUploaderWrapper",md,[2]);let Ce=class{constructor(A,ja){this.$=A;this.uploaderCreator=ja}executeCommand(A,ja,Ua){A=ja.command;switch(A){case 1403967063:case -2060689045:if(Ua&&"dataUrl"in Ua)return ja=new Ob.a,this.uploaderCreator&&
this.uploaderCreator.t$i(this.$,db.TaskManager.instance,mb.AFrameworkApplication.fa,Ua,Ua.dataUrl,ja),ja.task;this.uploaderCreator&&this.uploaderCreator.Daj(this.$,ja,db.TaskManager.instance,mb.AFrameworkApplication.fa,Ua);return ha.Task.Va(!0);case -2053056795:case -2009825598:case 570484235:case 15735758:return A=new Ob.a,new ue(this.$,ja,db.TaskManager.instance,mb.AFrameworkApplication.fa,Ua,A),A.task;default:return lb.a(A)}}ni(A,ja){let Ua=this.$.isEditMode;if(Ua)switch(ja.command){case 1403967063:Ua=
!0;break;case -2053056795:Ua=!0;break;case -2009825598:Ua=!0;break;case -2060689045:case 15735758:case 570484235:Ua=ob.a.GUb()&&1===A;break;default:Ua=!1}return Ua}Ji(){return!1}Bi(){return!1}};Ce=Object(U.__decorate)([Object(ka.d)(Ha.td),Object(U.__param)(0,Object(Ha.Lb)()),Object(U.__param)(1,Object(Ha.wg)())],Ce);Object(K.a)(Ce,"PictureCommandHandler",null,[39]);var Se=a(155);Object(ka.b)(Ha.qe,{yk:"singleton"})(A=>No(function*(){const ja=yield ka.a.resolve(Ha.Lb,A),Ua=Tc.a.instance,ac=Se.a.instance.WT();
return new of(ja,Ua,ac)}));class of extends na.a{constructor(A,ja,Ua){super();this.statusBarManager=null;this.emf=()=>{this.Wsc()};this.Dbi=()=>{this.Wsc()};this.dmf=ac=>{10===ac&&this.Wsc()};this.onKeyDown=ac=>13===ac.La.keyCode?(ac=new Ib.a(237279923,1,2,6,null),this.$.Ma.dh(ac,{[P.a.skipClipboardAccess]:!0,[P.a.zqf]:!0}),!0):!1;this.$=A;this.oD=ja;this.Ht=Ua;this.QBd=!1;this.$.ka.Lh(29,ac=>{this.statusBarManager=ac;ac.DL(this)})}dispose(){this.$o();this.Ht=this.oD=this.$=null;this.statusBarManager&&
(this.statusBarManager.$I(this),this.statusBarManager=null)}Yq(){return!0}hy(A,ja){if("QueryPasteShortcutEnabledLabel"!==A&&!of.NRk.includes(A))return!1;const Ua=this.ZO();"QueryPasteShortcutEnabledLabel"===A?(ja.Visible=Ua,F.ULS.sendTraceTag(537167636,0,100,`PasteShortcutManager.ExecuteRootCommand: Setting visible to ${Ua} for commandId ${A}`)):(ja.Visible=!Ua,F.ULS.sendTraceTag(537167635,0,100,`PasteShortcutManager.ExecuteRootCommand: Setting visible to ${!Ua} for commandId ${A}`));return!0}Tgi(){this.fq();
this.raiseEvent("pasteShortcutStatusChanged")}Wsc(){this.$o();this.raiseEvent("pasteShortcutStatusChanged")}ZO(){return this.QBd}Xx(A){this.addHandler("pasteShortcutStatusChanged",A)}Jx(A){this.removeHandler("pasteShortcutStatusChanged",A)}fq(){if(!this.ZO()){this.QBd=!0;za.f(this.$).fp.nv(this.emf);this.Ht.Aa("blur",this.Dbi);const A=Ha.Ob.Ha()?ka.a.Zg(Ha.Ob):this.$.ka.Ug(65);A&&A.Gea&&A.Gea.registerForCommentEvents(this.dmf);this.oD.yD(qb.a.zi,this.$.VJ,this.onKeyDown,!0)}}$o(){if(this.ZO()){this.QBd=
!1;za.f(this.$).fp.ev(this.emf);this.Ht.detach("blur");const A=Ha.Ob.Ha()?ka.a.Zg(Ha.Ob):this.$.ka.Ug(65);A&&A.Gea&&A.Gea.unregisterForCommentEvents(this.dmf);this.oD.KD(qb.a.zi,this.$.VJ,this.onKeyDown,!0)}}}of.NRk=["QuerySheetNumberButton","QueryWorkbookStatisticsButton"];Object(K.a)(of,"PasteShortcutManager",na.a,[856,161,162,2]);const jf=A=>{switch(A){case 1:return 1457;case 2:return 1458;case 3:return 1459;case 4:return 1460;case 5:return 1461;case 6:return 1462;case 7:return 1463;case 8:return 1464;
case 9:return 1465;case 10:return 1466;case 11:return 1467;case 12:return 1468;case 13:return 1469;case 14:return 1470;case 15:return 1471;case 16:return 1472;case 17:return 1473;case 18:return 1474;case 19:return 1475;case 20:return 1476;case 21:return 1477;case 22:return 1480;case 23:return 1478;case 24:return 1479;case 25:return 1481;case 26:return 1482;case 27:return 1483;case 28:return 1484;default:return 1485}};var bf=a(213),pf=a(58),Ud=a(54),Ff=a(136);class Uf{static get nak(){return Uf.sSe||
(Uf.sSe=RegExp("([A-Z]+)","g"))}static get mak(){return Uf.rSe||(Uf.rSe=RegExp("([A-Z])","g"))}static get CSh(){return Uf.qFe||(Uf.qFe=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}static rLd(A){return Uf.DHf(A.toString())}static DHf(A){return Uf.CSh.test(A)?A.replace(Uf.nak,"$1 ").replace(Uf.mak,' "$1"').trim():A}static vmk(A){const ja=A.lastIndexOf("!");return A.substring(0,-1<ja?ja+1:0)+Uf.DHf(A.substring(-1<ja?ja+
1:0,A.length))}}Uf.sSe=null;Uf.rSe=null;Uf.qFe=null;Object(K.a)(Uf,"RangeAriaExtensions",null,[]);class Gf{constructor(){this.activeItemName=null;this.h_f=!1;this.tableName=null;this.ufb=0;this.MZc=!1}}Object(K.a)(Gf,"SelectionReadoutState",null,[]);var lg=a(77),Pa=a(196),lc=a(932),Gc;let Cd=Gc=class{constructor(A,ja,Ua,ac,Ec){this.TFa=this.gridReadoutNotifier=null;this.EIg=!1;this.ppa=()=>{ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5963256_DoNotReadActiveItemIfDisposed")&&!this.$?F.ULS.sendTraceTag(526235470,
0,15,"calling readActiveItemDescription after dispose, ignoring."):za.f(this.$).isEditing&&!za.f(this.$).inRangePicker||this.imc.qA()};this.JJj=()=>{if(!za.f(this.$).ha.$e.AVd){var gd,ad=(()=>{let Jd=this.HBi();({activeCell:gd}=Jd);return Jd})().returnValue;this.readText(ad,gd)}};this.dS=()=>{const gd=this.activeCell;this.readText("Editing",gd);ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||gd&&gd.DBc&&!za.f(this.$).vNf||this.imc.cancel()};this.tj=()=>{ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6053639_DoNotHandleSelectionChangedIfDisposed")&&
!this.$?F.ULS.sendTraceTag(525366409,0,15,"calling onSelectionChanged after dispose, ignoring."):this.ppa()};this.$=ja;this.ariaLiveNotifier=A;this.B7b=ac;this.Cj=Ua;this.SM=new Gf;this.kmb=Za.kmb();this.EIg=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8582263_ScreenReaderShapeInfoReadoutEnabled");this.kmb&&(this.gridReadoutNotifier=Ec,F.ULS.shipAssertTag(537153937,0,!!this.gridReadoutNotifier,"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),ba.EwaSettings.isChangeGateEnabled("OfficeVSO:7945213_removeActiveCellDelayForBraille")?
Gc.Nkd=0:Gc.Nkd=700);this.imc=pf.a.instance.create(this.JJj,Gc.Nkd,Ud.a.Ivk,!1);this.fq()}get activeCell(){return za.f(this.$).kh(null)}dispose(){this.$&&this.$o();sb.a.Ng(this.imc);this.B7b=this.$=this.imc=null}SHd(A,ja,Ua){Ua=void 0===Ua?!0:Ua;if(null!==this.$.ih.jn&&"FindAndReplaceDialog"===this.$.ih.jn.ki||!A)return"";var ac=this.$.ka;const Ec=new Sys.StringBuilder;this.vEh(Ec,A,ja);if(ba.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var gd=this.Cj.vwa(A.range);(null===
gd||void 0===gd?0:gd.Wpe)&&this.U3e(Ec,gd);gd=this.Cj.my(A.range);(null===gd||void 0===gd?0:gd.Swa)&&this.U3e(Ec,gd)}gd=A.T$?this.SEf(A):A.text;V(Ec,gd);gd=this.$.activeItemName;this.SM.activeItemName!==gd&&(V(Ec,gd),this.SM.activeItemName=gd);gd=1===ja.length?Sa.Q(ja).isSingle?"":Ba.a.instance.ia(853):String.format(Ba.a.instance.$g(31),ja.length);V(Ec,gd);for(var ad of ja)gd=this.kmb?ad.toString():Uf.rLd(ad),V(Ec,gd),1===ja.length&&Gc.lqj(ad)&&(gd=za.f(this.$).za.yx(ad.bottomRight),void 0!==gd&&
null!==gd&&gd.text&&(gd=gd.T$?this.REf(gd,gd.text):gd.text,V(Ec,gd)));ad=A.cell;ad=this.$Pi(ad.Erk,ad.GVh);V(Ec,ad);this.eEh(Ec,A);Ua&&(A.M0a?V(Ec,Ba.a.instance.ia(841)):A.BKa&&V(Ec,Ba.a.instance.ia(842)));if(A.hasAutoFilter||A.Tma)this.wEh(Ec,A.hasAutoFilter?A.cell.autoFilterType:A.cell.X2j),Ua&&V(Ec,Ba.a.instance.ia(844));bf.d(this.$,A.range)&&V(Ec,Ba.a.instance.ia(848));this.cEh(Ec,A);Ua=(Ua=ka.a.Zg(Ha.rb))?Ua.JCi():"";V(Ec,Ua);A.iC&&(Ua=za.f(this.$).za.yx(A.range),Ua=!!Ua&&Ua.hasIgnorableError,
Gc.FGk(A)?Gc.dEh(Ec,A):ba.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&Ua?V(Ec,Ba.a.instance.ia(846)):V(Ec,Ba.a.instance.ia(845)));A.oR&&(V(Ec,Ba.a.instance.ia(847)),A.xRb&&V(Ec,String.format(Ba.a.instance.$g(16),A.p8h)),V(Ec,A.iconName));A.hasRichValueIcon&&(ad=ka.a.Zg(Ha.fb),Ua="",ad&&A.cell.oJc&&(ad=ad.v4(A.cell.oJc))&&ad.DomainId.Id!==Gc.Xal&&(Ua=ad.Name),A.cell.yej?(V(Ec,String.format(Ba.a.instance.$g(187),Ua)),V(Ec,Ba.a.instance.ia(1812))):(V(Ec,String.format(Ba.a.instance.$g(185),
Ua)),V(Ec,Ba.a.instance.ia(1811))));this.U3i(A)&&V(Ec,Gc.uKi(A));(ac=ac.Ug(231))&&V(Ec,ac.hFf(ja,!0));1===ja.length&&ja[0].isSingle&&Gc.EGk(A,ja[0])&&(ja=ka.a.Zg(Ha.fb))&&V(Ec,ja.ZCi());A.R8b&&A.S8b&&V(Ec,A.S8b);(ja=A.cell.Nsd)&&V(Ec,ja);this.bEh(Ec,A);A.J0a&&A.S0b&&(A=A.T$d)&&(V(Ec,Ba.a.instance.ia(1985)),V(Ec,A));return Ec.toString()}i9e(A){this.TFa=this.SM;this.SM=Object(Ea.a)(new Gf,{activeItemName:this.TFa.activeItemName,MZc:A?this.TFa.MZc:!1,tableName:A?this.TFa.tableName:"",ufb:A?this.TFa.ufb:
-1})}vFg(){this.TFa&&(this.SM=this.TFa,this.TFa=null)}$Pi(A,ja){return 2===A||2===ja?Ba.a.instance.ia(875):1===A||1===ja?Ba.a.instance.ia(876):""}SEf(A){return this.REf(A.cell,A.text)}vEh(A,ja,Ua){if(Ua&&1===Ua.length&&Ua[0].isSingle){Ua="";var ac=this.Cj.vwa(ja.range);if(ac){Ua=ac.pivotTableName;this.Cod(A,Ua);var Ec=ac.YEc?Ba.a.instance.ia(835):"";ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6154754_NarratorReadoutForPivotTableAltText")&&(Ec+=(ac.altText?ac.altText+" . ":"")+(ac.altTextSummary?
ac.altTextSummary:""));this.W3e(A,!0,Ua,Ec);V(A,this.Cj.Znj(ac,ja.range)?Ba.a.instance.ia(838):"");V(A,this.Cj.Yfj(ac,ja.range)?Ba.a.instance.ia(837):"")}else if(ac=this.Cj.my(ja.range)){Ua=(Ec=za.f(this.$).Yg.sl(ja.range))?Ec.name:"";this.Cod(A,Ua);let gd="";Ec&&(gd=(Ec.N7a?Ec.N7a+" . ":"")+(Ec.O7a?Ec.O7a:""));this.W3e(A,!1,Ua,gd);V(A,this.Cj.QWf(ac,ja.range)?Ba.a.instance.ia(837):"")}else this.Cod(A,Ua),this.SM.tableName="",this.SM.ufb=-1}}Cod(A,ja){ja!==this.SM.tableName&&this.SM.tableName&&(A.append(Ba.a.instance.ia(this.SM.MZc?
834:833)),V(A," "+this.SM.tableName))}W3e(A,ja,Ua,ac){Ua!==this.SM.tableName&&(A.append(Ba.a.instance.ia(ja?832:831)),V(A," "+Ua),V(A,ac),this.SM.tableName=Ua,this.SM.MZc=ja,this.SM.ufb=-1)}U3e(A,ja){const Ua=za.f(this.$).ha.qa.activeCell;if(Ua.top!==ja.top&&Ua.left!==this.SM.ufb){A.append(Ba.a.instance.ia(837));ja=new yd.Range(ja.top,Ua.left,ja.top,Ua.left,!0,!0);V(A,Uf.rLd(ja));if(ja=za.f(this.$).kh(ja))ja=ja.T$?this.SEf(ja):ja.text,V(A,ja);this.SM.ufb=Ua.left}}REf(A,ja){const Ua=A.mD;return A.EJa?
String.format(Ba.a.instance.$g(14),ja,Ua):String.format(Ba.a.instance.$g(13),ja,Uf.vmk(Ua))}fq(){F.ULS.shipAssertTag(537153930,0,!!this.$,"Can't register to ewaControl's events");if(this.$){var A=za.f(this.$);F.ULS.shipAssertTag(537153929,0,!!A,"Can't register to grid's events");A&&(A.sh.nv(this.dS),A.za.Uy(this.ppa),A.KN(this.ppa),A=A.ha,F.ULS.shipAssertTag(537153928,0,!!A,"Can't register to selectionManager's events"),A&&(A.Cw(this.tj),A.add_activeCellChanged(this.ppa),A.$e.MN(this.ppa)))}}$o(){if(this.$){var A=
za.f(this.$);A&&(A.sh.ev(this.dS),A.za.Ix(this.ppa),A.vP(this.ppa),A=A.ha)&&(A.$w(this.ppa),A.remove_activeCellChanged(this.ppa),A.$e.sV(this.ppa))}}readText(A,ja){this.kmb&&this.gridReadoutNotifier&&(ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8194559_StaleValueReadoutFixEnabled")||this.gridReadoutNotifier.isActive)?this.gridReadoutNotifier.readText(A):(this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(A),ja&&this.ariaLiveNotifier.U2k(ja))}HBi(){let A;A=null;var ja=za.f(this.$).ha;
if(1!==ja.wk&&!ja.$e.yh)return F.ULS.sendTraceTag(537153927,0,15,`selectionManager.CommandSelectionMode=${ja.wk} and selectionManager.SelectedFloatingObjectControl is null`),{returnValue:"",activeCell:A};switch(ja.wk){case 2:return{returnValue:this.TEi(ja),activeCell:A};case 64:var Ua=ja.$e.yh.floatingObject;let ac="";if(ja=ja.$e.yh.BB||ja.$e.yh.Gj)ac=(ja=ja.firstChild)?Y.DOMElementExtensions.getTextContent(ja):"";return this.EIg?{returnValue:this.jUi(Ua),activeCell:A}:{returnValue:String.format(Ba.a.instance.$g(53),
Gc.txc(Ua.altText,Ua.altTextDescription,Ua.name),ac,Ua.altTextDescription),activeCell:A};case 4:return{returnValue:Gc.jDh(ja.$e.yh.floatingObject),activeCell:A};case 512:return{returnValue:Ff.a.oDf(ja.$e.yh.floatingObject.JAd),activeCell:A};case 8:return Ua=ja.$e.yh.floatingObject,{returnValue:String.format(Ba.a.instance.$g(51),Ua?Ua.name:""),activeCell:A};case 1:return A=this.activeCell,Ua=ja.qa.selectedRanges,za.f(this.$).inRangePicker?this.XRi(ja,A):{returnValue:this.SHd(A,Ua),activeCell:A}}return{returnValue:"",
activeCell:A}}XRi(A,ja){A=A.rangePicker.NY.map(ac=>ac.range);const Ua=za.f(this.$).kh(A[0]);return{returnValue:this.SHd(Ua,A),activeCell:ja}}TEi(A){const ja=new Sys.StringBuilder;ja.append(Gc.ORh(A));const Ua=this.$.ka.Ug(231);Ua&&V(ja,Ua.hFf(A.$e.yh.floatingObject,!1));return ja.toString()}jUi(A){var ja,Ua,ac,Ec,gd,ad=null;isNullOrUndefined(null===(ja=A.nh)||void 0===ja?void 0:ja.ShapeFillColor)||(-1===A.nh.ShapeFillColor?ad=A.nh.HasEffects?"gradient":null:(ad=(null===(Ua=A.nh)||void 0===Ua?0:Ua.IsShapeConnector)?
Pa.a.c2(A.nh.ShapeOutlineColor):Pa.a.c2(A.nh.ShapeFillColor),ad=Pa.a.tu(ad.toUpperCase()),ad=lc.a.YIa(ad)));Ua=!xa.a.JVa(ad);return(ja=!xa.a.JVa(null===(ac=A.nh)||void 0===ac?void 0:ac.ShapeText))&&Ua?String.format(Ba.a.instance.$g(235),A.altText,A.altTextDescription,A.name,ad,null===(Ec=A.nh)||void 0===Ec?void 0:Ec.ShapeText):!Ua&&ja?String.format(Ba.a.instance.$g(236),A.altText,A.altTextDescription,A.name,null===(gd=A.nh)||void 0===gd?void 0:gd.ShapeText):!ja&&Ua?String.format(Ba.a.instance.$g(237),
A.altText,A.altTextDescription,A.name,ad):String.format(Ba.a.instance.$g(234),A.altText,A.altTextDescription,A.name)}U3i(A){A=A.oUf();let ja=!1;this.SM.h_f!==A&&(this.SM.h_f=A,ja=!0);return ja}eEh(A,ja){if(ja.Mkb)if(ja=this.B7b.XUi(ja)){var Ua=Ba.a.instance,ac=Ua.ia;a:switch(ja.type){case 0:var Ec=828;break a;case 1:Ec=829;break a;default:Ec=830}Ua=ac.call(Ua,Ec);V(A,String.format(Ba.a.instance.$g(25),Ua));ja=String.format(Ba.a.instance.$g(24),Uf.rLd(ja.ZPk));V(A,ja)}else F.ULS.sendTraceTag(537153925,
0,15,"No sparkline range was found on a cell with sparkline."),V(A,String.format(Ba.a.instance.$g(25),""))}wEh(A,ja){switch(ja){case 1:case 11:V(A,Ba.a.instance.ia(849));break;case 6:V(A,Ba.a.instance.ia(849));V(A,Ba.a.instance.ia(851));break;case 7:V(A,Ba.a.instance.ia(849));V(A,Ba.a.instance.ia(852));break;case 2:V(A,Ba.a.instance.ia(850));V(A,Ba.a.instance.ia(851));break;case 3:V(A,Ba.a.instance.ia(850));V(A,Ba.a.instance.ia(852));break;default:V(A,Ba.a.instance.ia(850))}}cEh(A,ja){var Ua;const ac=
Ha.Ob.Ha()?ka.a.Zg(Ha.Ob):this.$.ka.Ug(65);ja=ac?ac.FIa(ja.range):null;let Ec="";const gd=Object(Ae.a)(470,ja);if(ja)Ec=!ja.wmb&&gd&&gd.Kpj?String.format(Ba.a.instance.$g(29),gd.BUk):String.format(Ba.a.instance.$g(23),ja.author);else if(null===(Ua=null===ac||void 0===ac?void 0:ac.Bt)||void 0===Ua?0:Ua.lK)Ec=String.format(Ba.a.instance.$g(28),ac.Bt.$U.author);V(A,Ec)}bEh(A,ja){const Ua=this.$.ka.Ug(286);Ua&&(ja=Ua.LCi(lg.d(this.$.na),ja.range))&&0<ja.length&&(ja=String.format(Ba.a.instance.$g(1===
ja.length?220:221),ja[0]),V(A,ja))}static jDh(A){return String.format(Ba.a.instance.$g(52),Gc.txc(A.altText,A.altTextDescription,A.name),A.altTextDescription)}static uKi(A){return Ba.a.instance.ia(A.oUf()?839:840)}static txc(A,ja,Ua){return A||ja?A:Ua}static ORh(A){var ja=A.$e.yh;A=ja.floatingObject;const Ua=A.Ki,ac=Ua.ChartTitle,Ec=A.altText,gd=A.altTextDescription,ad=!!(Ua.Attributes&4);return(ja=ja.getSelectionDescription())?ja:Ua.DataRangeForDisplay?String.format(Ba.a.instance.$g(ad?49:47),Gc.txc(Ec,
gd,A.name),gd,ac,Ba.a.instance.ia(jf(Ua.ChartCategory)),Ua.DataRangeForDisplay):String.format(Ba.a.instance.$g(ad?50:48),Gc.txc(Ec,gd,A.name),gd,ac,Ba.a.instance.ia(jf(Ua.ChartCategory)))}static FGk(A){return ba.EwaSettings.Ra(101)&&(A.ZTb||A.SEc)}static dEh(A,ja){ja.u7a?ja.ZTb?V(A,String.format(Ba.a.instance.$g(26),ja.u7a.topLeft.toString())):ja.SEc&&(ja=ja.u7a.IE(),V(A,String.format(Ba.a.instance.$g(27),(ja.LastColumn-ja.FirstColumn+1).toString(),(ja.LastRow-ja.FirstRow+1).toString()))):F.ULS.shipAssertTag(537153924,
0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.")}static EGk(A,ja){return A.iC||!ba.EwaSettings.Ra(131)?!1:(A=ka.a.Zg(Ha.fb))?A.oEc(ja):!1}static lqj(A){return A.top===A.bottom&&A.left+1===A.right||A.top+1===A.bottom&&A.left===A.right}};Cd.Gil="#";Cd.Xal=268435712;Cd.Nkd=500;Cd=Gc=Object(U.__decorate)([Object(ka.d)(Ha.of),Object(U.__param)(0,Object(Ha.l)()),Object(U.__param)(1,Object(Ha.Lb)()),Object(U.__param)(2,
Object(Ha.hg)()),Object(U.__param)(3,Object(Ha.bg)()),Object(U.__param)(4,Object(Ha.pc)())],Cd);Object(K.a)(Cd,"SelectionReadoutHandler",null,[852,2]);var Qd=a(8),ge=a(126),ye=a(36);let $e=class extends ge.a{constructor(A,ja){A=void 0===A?Qd.a.Kub:A;ja=void 0===ja?Qd.a.FG:ja;super(A,ja)}execute(A){const ja=Object(Ae.a)(10,A.sk);F.ULS.shipAssertTag(537153921,0,kb.a.gHb(A.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");ja.rP(!0,!0);A.activityState[ye.a.tjc]=
ja.ea.sessionId;A.activityState[ye.a.sFb]=!0;A.activityState[ye.a.zjc]=!0;F.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3}};$e=Object(U.__decorate)([Object(ka.d)(Ha.sf)],$e);Object(K.a)($e,"SessionReloadActivity",ge.a,[]);var qf=a(65),h=a(310),Z=a(39),E=a(43),aa=a(275),Ja=a(112);const tb=(A,ja)=>new S(A,ja,Qd.a.FG,Qd.a.yp,Qd.a.gxb);Object(ka.b)(Ha.tf,{yk:"singleton"})(()=>tb(Qd.a.bqa,Qd.a.Ydb));Object(ka.b)(Ha.uf,{yk:"singleton"})(()=>
tb(Qd.a.l5b,Qd.a.GMa));Object(ka.b)(Ha.vf,{yk:"singleton"})(()=>tb(Qd.a.m5b,Qd.a.JOc));Object(ka.b)(Ha.wf,{yk:"singleton"})(()=>tb(Qd.a.uOa,Qd.a.dW));class S extends ge.a{constructor(A,ja,Ua,ac,Ec){super(A,ja);S.X1d=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];S.W1d=[-1468309555,-315732528,-399065540,810218235,1531005923,1593924569,1112506702,1220851643];S.E8f=[-1468309555,611268539,-1750576502,61029505,-658377927];S.D8f=[-1468309555,-315732528,1112506702,-238814601,-1750576502,
61029505,-658377927,-1337545025];this.bYc=Ua;this.hOk=ac;this.dYk=Ec}execute(A){var ja=Object(Ae.a)(10,A.sk);A.activityState[ye.a.YEa]=!0;var Ua=S.NUi(A);if(S.UGk(A,Ua))return S.$Bj(A),Ua=50,0<A.errors.length&&(Ua=15),F.ULS.sendTraceTag(537153891,0,Ua,`SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : ${kb.a.Kh(A.errors)}`),A.activityState[ye.a.YEa]=!1,this.Wn(Qd.a.idle),3;switch(Ua){case 1:case 3:this.Dbj(A,Ua);break;case 2:this.Cbj(A);break;case 0:A.activityState[ye.a.Bcb]=
null}F.ULS.sendTraceTag(21837003,0,50,`SessionReloadSilentActivity.Execute: silentReloadType:${Ua}. activityName:${this.activityName}. NextActivityName:${this.Waa}. TimeFromLastStatefulResponse:${ja.ea.a8}.`);var ac=Z.a.Em(A.activityState,Ja.a.oxb);F.ULS.shipAssertTag(40502925,0,!ac||ac&&(1===Ua||3===Ua),`triggerSilentReloadAfterTokenRefresh: ${ac}, silentReloadType: ${Ua}`);ja=ja.ms.reloadCount;return 0!==Ua&&0<ja?(ac=h.a.dkb(ja,200),F.ULS.sendTraceTag(537153890,0,50,`SessionReloadSilentActivity.Execute: schedule Silent-Type [${Ua}] retryNum [${ja}] delayInMs [${ac}] activityName [${this.activityName}]`),
pf.a.instance.create(()=>{S.NT(A)},ac,Ud.a.Oxk),1):3}Dbj(A,ja){F.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");const Ua=Object(Ae.a)(10,A.sk);A.activityState[ye.a.sFb]=!0;Ua.ZDc||E.a.instance.ym("ReopenOnLoad");S.isEditMode(A)&&ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8609965_SilentReloadInCollabModeInClient")&&S.Tlb(A)||!kb.a.gHb(A.errors)||(F.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),
A.activityState[ye.a.tjc]=Ua.ea.sessionId,A.activityState[ye.a.zjc]=!0);A.r2d();3===ja?(Ua.ea.Hl()||Ua.ea.cIj(),Ua.rP(!0,!0),this.Wn(this.dYk),A.activityState[ye.a.bZe]=Ua.workbookContext.CalcMode):(ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&1===ja&&Ua.rP(!0,!0),A.activityState[ye.a.nld]=!1,this.Wn(this.bYc))}Cbj(A){F.ULS.sendTraceTag(537153888,0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");A.activityState[ye.a.Bcb]=
null;A.r2d();this.Wn(this.hOk);A=Object(Ae.a)(10,A.sk);A.ZDc||(E.a.instance.ym("RefreshOnLoad"),A.x3b())}static NT(A){A.NT()}static NUi(A){const ja=Object(Ae.a)(10,A.sk),Ua=ja.ea,ac=S.isEditMode(A),Ec=S.Tlb(A);var gd=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8609965_SilentReloadInCollabModeInClient"),ad=kb.a.Qn(A.errors,ac||gd&&Ec?S.W1d:S.X1d);gd=kb.a.Qn(A.errors,ac||gd&&Ec?S.D8f:S.E8f);const Jd=ja.z0,De=ja.ms.reloadCount,Xe=ja.ua.MaxConsecutiveSilentReloadAllowed,lf=ja.ms.TNf(),mf=kb.a.Kh(A.errors),
Rf=kb.a.Kh(A.fNa),sg=0<kb.a.uX(Qi=>!Qi.triggerSilentReopenOnly,A.errors).length;let wg=ad;const Mg=Z.a.Em(A.activityState,Ja.a.oxb);Mg&&(wg=!0);const Sg={name:"SessionReloadSilentActivity.GetSilentReloadType"};Sg.editMode=ac;Sg.isSilentReopenError=ad;Sg.isSilentRefreshError=gd;Sg.reloadSequenceCount=ja.ms.c5a;Sg.reloadCount=De;Sg.maxReloads=Xe;Sg.stopSilentReloads=lf;Sg.errorNames=mf;Sg.processedErrorNames=Rf;Sg.isClientDirty=Jd;Sg.errorsForSilentReopenOnly=sg;Sg.triggerSilentReloadAfterTokenRefresh=
Mg;Sg.IsReopenDisabled=ja.R0a;Sg.isCollabViewMode=Ec;ad=qf.a.li(Sg);F.ULS.sendTraceTag(21837004,0,50,ad);if(!lf){if(wg&&(ac||ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8671789_FixSilentRefreshInCollabView")&&Ec?S.JGk(A):S.MGk(A)))return aa.a.fPg(A,ja)?3:ja.R0a?2:1;if(gd&&(ac||ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8671789_FixSilentRefreshInCollabView")&&Ec||!Ua.Jsb))return 2}return 0}static UGk(A,ja){for(const Ua of A.errors)if(-1337545025===Ua.MessageId||-238814601===Ua.MessageId)return!1;
return kb.a.uX(Ua=>!Ua.triggerSilentReopenOnly,A.errors).length?3!==ja:!1}static $Bj(A){const ja=kb.a.uX(Ua=>!Ua.triggerSilentReopenOnly,A.errors);for(const Ua of ja)A.uoa(Ua)}static isEditMode(A){const ja=Object(Ae.a)(10,A.sk);return ja.ea.Ph?ja.Nw&&!!(ja.wj&64):Z.a.Em(A.activityState,ye.a.Jz)}static Tlb(A){const ja=Object(Ae.a)(10,A.sk);F.ULS.sendTraceTag(507618584,0,50,`SessionReloadSilentActivity.isEditMode: isEditMode [${ja.isEditMode}] Edit Mode capabilities [${ja.wj&64}]`);return ja.ea.Ph?
ja.ea.Tlb:Z.a.Em(A.activityState,ye.a.jld)}static MGk(A){const ja=Object(Ae.a)(10,A.sk);if(kb.a.ufa(A.errors,S.X1d).some(Ua=>Ua.ForceVersionUpgrade))return!1;A=kb.a.gHb(A.errors);return!ja.ea.Jsb||A?!0:!1}static JGk(A){return!kb.a.ufa(A.errors,S.W1d).some(ja=>ja.ForceVersionUpgrade)}}S.X1d=null;S.W1d=null;S.E8f=null;S.D8f=null;Object(K.a)(S,"SessionReloadSilentActivity",ge.a,[]);var Wa=a(550);let zb=class extends Wa.a{constructor(A){super(Object(za.f)(A))}XUi(A){for(const ja of this.rangeList)if(A.range.contains(ja))return ja;
return null}ade(A){return A.GridBlockModel&&(A=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(A.GridBlockModel))?A.getSparklineRanges():null}};zb=Object(U.__decorate)([Object(ka.d)(Ha.bg),Object(U.__param)(0,Object(Ha.Lb)())],zb);Object(K.a)(zb,"SparklineManager",Wa.a,[855]);var hc=a(603),cd=a(192),ta=a(189);class wb extends Wb.a{constructor(A,ja,Ua,ac,Ec){super(A);this.PWg=[6];this.KWg=[26];this.Zy=null;this.TUb=this.JHc=!1;this.aB=this.Sma=null;this.onPointerDown=gd=>{if(1!==this.$.Ma.gR())return!0;
gd=this.zoomManager.Ik(gd);if(this.tK)return!0;var ad=rb.a(this.$).CUd||rb.a(this.$).Ex();if(this.RWd||ad)return this.Dtb(),!0;this.aB=this.gv;this.mfe();this.uPd();ad=2===gd.oh&&gd.mw===Sys.UI.MouseButton.leftButton;const Jd=3===gd.oh;if(ad||Jd)gd=this.ha.Ey(gd.clientPoint,gd.Qh,5,void 0,void 0,!0),gd||(gd=this.aB),this.TUb=ad,this.JHc=Jd,this.aB=this.gKf(gd),this.uPd(),ad?this.Uek():Jd&&this.Kfk(),ld.b(this.$,!0);return!0};this.ur=gd=>{gd=this.zoomManager.Ik(gd);if(!this.tK)return!1;let ad=this.TUb?
this.ha.Ey(gd.clientPoint,gd.Qh,5,void 0,void 0,!0):this.ha.Ey(gd.clientPoint,gd.Qh,5,!0,!1,!0);ad||(ad=this.ha.B3(gd.clientPoint,gd.Qh,5));ad&&(gd=this.gKf(this.BGb(ad)),this.$mc(gd.bottomRight),this.aB.equals(gd)||(this.aB=gd,this.M2b(!1),this.mfe(!1),this.uPd(!1),this.X5i(),this.rh.update(!1)),this.K3k(this.aB));return!0};this.io=gd=>{this.zoomManager.Ik(gd);if(!this.tK)return!1;this.resizeTable();this.Dtb();return!0};this.a0b=gd=>{this.zoomManager.Ik(gd);if(!this.tK)return F.ULS.shipAssertTag(537151233,
0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1;this.resizeTable();this.Dtb();return!0};this.Noa=gd=>{this.zoomManager.Ik(gd);this.Dtb();return!0};this.veg=()=>{this.tK&&this.Dtb()};this.da=ja;this.zoom=Ec;this.$=ja.$;this.Cj=ac;this.ha=ja.ha;this.rh=ja.rh;this.parentElement=A;this.zMh();Da.a.Gx||Da.a.D0||Jb.a.instance.ya(qb.a.Zi,this.Sma,this.onPointerDown);this.gv=Ua;this.Kbd=this.RWd=!1;this.Cj.Axh(this.veg)}get tK(){return this.TUb||this.JHc}get X_f(){return this.Kbd}dispose(){this.Dtb();
this.Cj.kik(this.veg);this.X_f||Da.a.Gx||Da.a.D0||Jb.a.instance.Na(qb.a.Zi,this.Sma,this.onPointerDown);if(this.tK){ld.b(this.$,!1);try{this.ME()}catch(A){F.ULS.sendTraceTag(537151236,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${A}`)}}this.parentElement&&this.parentElement.contains(this.Sma)&&this.parentElement.removeChild(this.Sma);this.Sma=this.parentElement=null;super.dispose()}get zoomManager(){return this.zoom.zoomManager}gKf(A){const ja=A.bottom-this.gv.topLeft.bottom-
1;return 0<=A.right-this.gv.topLeft.right+1&&0<=ja&&A.bottom>=this.gv.top&&A.right>=this.gv.left?new yd.Range(this.gv.top,this.gv.left,A.bottom,A.right,!1,!1):this.aB}uPd(A){this.iWc([this.aB],6,void 0===A?!0:A);this.rh.rw(this.PWg)}M2b(A){A=void 0===A?!0:A;this.rh.zq(this.PWg);this.iWc([null],6,A)}mfe(A){A=void 0===A?!0:A;this.rh.zq(this.KWg);this.iWc([null],26,A)}X5i(){var A=!1;A=void 0===A?!0:A;const ja=this.mUk();0<ja.length&&(this.iWc(ja,26,A),this.rh.rw(this.KWg))}mUk(){const A=[];this.gv.contains(this.aB)&&
(this.gv.right!==this.aB.right&&A.push(new yd.Range(this.gv.top,this.aB.right+1,this.aB.bottom,this.gv.right,!1,!1)),this.gv.bottom!==this.aB.bottom&&A.push(new yd.Range(this.aB.bottom+1,this.gv.left,this.gv.bottom,this.gv.right,!1,!1)));return A}resizeTable(){if(!this.aB.equals(this.gv)){const A=new yd.Range(this.gv.top,this.gv.left,this.aB.bottom,this.aB.right,!1,!1);this.QZk(A);this.RWd=!0}}onKeyDown(A){this.zoomManager.Ik(A);return!0}V6d(){this.X_f&&(Da.a.Gx||Da.a.D0||(Jb.a.instance.ya(qb.a.Zi,
this.Sma,this.onPointerDown),this.Sma.classList.remove("ewr-table-resize-default-cursor"),this.Kbd=this.Sma.disabled=!1),this.Kbd=!1)}zMh(){const A=document.createElement("div");A.className="ewr-table-resize-handle";const ja=document.createElement("div");ja.className="ewr-table-resize-fillhandle-higher";const Ua=document.createElement("div");Ua.className="ewr-table-resize-fillhandle-broader";A.appendChild(ja);A.appendChild(Ua);this.Sma=A;this.parentElement.appendChild(this.Sma)}$mc(A){let ja=60;const Ua=
this.aB.contains(A);let ac=A.top,Ec=A.bottom,gd=A.left,ad=A.right,Jd=null;if(Ua){if(this.da.FF(this.gv.topLeft)&&!this.gv.o7a)return;A.bottom<this.aB.bottom?(ac=Math.max(1,Ec-2,this.gv.top),ja=16):(gd=Math.max(1,ad-2,this.gv.left),ja=4);Ec=ac;ad=gd;Jd=new yd.Range(ac,gd,ac,gd,!1,!1)}else A.right>=this.gv.right?(ad+=2,ja=8):A.bottom>=this.gv.bottom&&(Ec+=2,ja=32),ac=Ec,gd=ad,Jd=new yd.Range(Ec,ad,Ec,ad,!1,!1),ja=16;this.da.FF(Jd)||(this.Zy?this.Zy.wt||(this.Zy=pf.a.instance.create(()=>{this.da.gD(Jd,
ja,"TableResizeBehavior.BringRangeIntoView")},40,Ud.a.NWg)):this.Zy=pf.a.instance.create(()=>{this.da.gD(Jd,ja,"TableResizeBehavior.BringRangeIntoView")},40,Ud.a.NWg))}BGb(A){let ja=A;if(this.da.Pg.mz){if(!this.da.kh(A.topLeft)){const Ua=this.da.ot("TableResizeBehavior.AdjustHiddenRowColumns",this.da.c5,this.aB.top!==A.top?1:2);try{Ua.Gr=this.aB.top<A.top||this.aB.left<A.left,Ua.NF(A.topLeft),ja=Ua.$$cu().range}finally{Ua&&Ua.dispose()}}ja.right=ja.left+A.width-1;ja.bottom=ja.top+A.height-1}return ja}iWc(A,
ja,Ua){Ua=void 0===Ua?!0:Ua;const ac=[];for(const Ec of A)ac.push(new Ze.a(Ec,lg.d(this.$.na)));this.rh.BP(ac,[ja],!0,void 0,Ua)}Uek(){Jb.a.instance.ya(qb.a.$u,document.documentElement,this.ur);for(const A of this.da.yu)Jb.a.instance.ya(qb.a.$u,A.domElement,this.ur);Jb.a.instance.ya(qb.a.jo,document.documentElement,this.io);this.cmf()}Kfk(){Db.a.instance.ya(qb.a.kn,document.documentElement,this.ur);for(const A of this.da.yu)Db.a.instance.ya(qb.a.kn,A.domElement,this.ur);Db.a.instance.ya(qb.a.Ok,document.documentElement,
this.a0b);this.cmf()}ME(){this.TUb&&this.X1k();this.JHc&&this.f2k()}X1k(){Jb.a.instance.Na(qb.a.$u,document.documentElement,this.ur);for(const A of this.da.yu)Jb.a.instance.Na(qb.a.$u,A.domElement,this.ur);Jb.a.instance.Na(qb.a.jo,document.documentElement,this.io);this.Eyg()}f2k(){Db.a.instance.Na(qb.a.kn,document.documentElement,this.ur);for(const A of this.da.yu)Db.a.instance.Na(qb.a.kn,A.domElement,this.ur);Db.a.instance.Na(qb.a.Ok,document.documentElement,this.a0b);this.Eyg()}cmf(){this.da.cellTextEditBox.Chb(!0)}Eyg(){this.da.cellTextEditBox.Chb(!1)}QZk(A){this.$.ei(-1400250766,
Md.a.eh,30,{["ResizeTableRange"]:A,["OriginalTableRange"]:this.gv})}K3k(A){if(!this.gv.contains(A)){A=this.lUk();for(const ja of A)if(this.Cj.rXd(ja)){this.da.Um.Mx(P.a.pHj);return}}this.da.rtl?this.da.Um.Mx(P.a.qGj):this.da.Um.Mx(P.a.OIj)}Dtb(){if(this.tK){ld.b(this.$,!1);try{this.ME()}catch(A){F.ULS.sendTraceTag(537151232,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${A}`)}}this.Zy&&(this.Zy.cancel(),this.Zy.dispose());this.JHc=this.TUb=!1;this.M2b();this.mfe();
ld.b(this.$,!1);this.da.Um.Mx(P.a.Q$)}lUk(){const A=[];this.gv.right!==this.aB.right&&A.push(new yd.Range(this.gv.top,this.gv.right+1,this.aB.bottom,this.aB.right,!1,!1));this.gv.bottom!==this.aB.bottom&&A.push(new yd.Range(this.gv.bottom+1,this.gv.left,this.aB.bottom,this.gv.right,!1,!1));return A}static createInstance(A,ja,Ua,ac,Ec){if(!ja)return null;const gd=A.rh;gd.BP(Ua,[27],!0);gd.rw(wb.gUk);Ua=gd.rU(27,A.Pg.ro(ja.bottomRight),wb.SHi(ja,Ua)).Yk;return new wb(Ua,A,ja,ac,Ec)}static SHi(A,ja){var Ua;
for(let ac=0;ac<ja.length;ac++)if((null===(Ua=ja[ac])||void 0===Ua?0:Ua.range)&&ja[ac].range.equals(A))return ac;return 0}}wb.gUk=[27];Object(K.a)(wb,"TableResizeBehavior",Wb.a,[]);var ic=a(55),Oa=a(150),Cb=a(151),yc=a(321);class Nc extends sc.a{constructor(A,ja){super(document.createElement("div"));this.Rkd=this.BTd=this.wqg=this.r0=!1;this.Zke=null;this.onActiveCellChanged=()=>{bf.d(this.$,this.da.ha.qa.activeCell)?(this.v_a=!0,this.yKb(!1)):(this.kaa=this.v_a=!1,this.o1g())};this.zy=()=>{this.v_a?
this.yKb(!0):this.kaa=!1};this.iMa=()=>{this.Rkd=!0;this.v_a&&(this.kaa=!1)};this.onContentReady=()=>{this.$.isEditMode?bf.d(this.$,this.da.ha.qa.activeCell)&&(this.v_a=!0,this.yKb(!1)):this.kaa=!1};this.hMa=()=>{this.Rkd=!1;this.v_a?this.yKb(!1):this.kaa=!1};this.onBlockCacheItemChanged=(Ua,ac)=>{this.v_a&&(Ua=this.da.I3a(ac.Ti.block.jk.BlockCachePosition.PaneType).hL(ac.Ti.hash))&&(Ua.Mge(this.qOf),Ua.xnd(this.qOf))};this.qOf=()=>{this.ZCg()};this.$=A;this.zoom=ja;this.da=za.f(this.$);this.parentElement=
this.domElement;this.parentElement.className="ewa-ttrd-buttonarea";this.uZa=this.da.Ym;this.iFd=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:7603637_LocalizeSubtotalOfTotalRow");this.v_a=!0;this.Z$i();this.iFd&&this.y8i();this.yGh();this.yKb(!1);F.ULS.sendTraceTag(537151201,0,50,"TableTotalRowOptions - React Component Created ")}get zoomManager(){return this.zoom.zoomManager}get kaa(){return this.BTd}set kaa(A){this.BTd!==A&&(this.BTd=this.isVisible=A)}get cWb(){return!!(this.$.wj&16)}get Pkj(){const A=
this.da.ha.qa.activeCell;return A.right===A.maxColumns}get mFb(){const A=this.da.kh(null);return A&&this.da.xaa(A.range)?this.bJa(A):(A&&F.ULS.sendTraceTag(537151200,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),null)}dispose(){this.$&&this.gai();this.$=this.da=this.parentElement=this.uZa=null;super.dispose()}uFi(A){const ja=this.dXi(this.da.kh(null).range);return ja?this.iFd?`=${this.uJf()}(${A}${this.$.listSeparator}${ja})`:`=SUBTOTAL(${A},${ja})`:null}uJf(){var A,
ja,Ua;return null!==(Ua=null===(ja=null===(A=this.Ej)||void 0===A?void 0:A.localeInfo)||void 0===ja?void 0:ja.getWorksheetFuncName(344))&&void 0!==Ua?Ua:"SUBTOTAL"}dXi(A){var ja=za.f(this.$).Yg.sl(A);if(!ja)return null;ja=ta.a(ja,!1);ja.right=ja.left=A.left;return ja.toString()}Z$i(){Nc.xT={};Nc.xT["100"]=Ba.a.instance.ia(1105);Nc.xT["101"]=Ba.a.instance.ia(1108);Nc.xT["102"]=Ba.a.instance.ia(1107);Nc.xT["103"]=Ba.a.instance.ia(1112);Nc.xT["104"]=Ba.a.instance.ia(1109);Nc.xT["105"]=Ba.a.instance.ia(1110);
Nc.xT["109"]=Ba.a.instance.ia(1106);Nc.xT["107"]=Ba.a.instance.ia(1113);Nc.xT["110"]=Ba.a.instance.ia(1115);Nc.xT["111"]=Ba.a.instance.ia(1166)}y8i(){void ka.a.resolve(Ha.E).then(A=>this.Ej=A)}$0j(){var A=this.da.kh(null);if(A&&(A=A.iC?A.formulaBarText:null))if(this.iFd){const ja="="+this.uJf()+"(",Ua=ja.length;if(A.toUpperCase().startsWith(ja)){if(A=A.substring(Ua,Ua+3),A in Nc.xT)return A}else return"111"}else if("=SUBTOTAL("===A.substring(0,10)){if(A=A.substring(10,13),A in Nc.xT)return A}else return"111";
return"100"}yGh(){this.da.za.Vy(this.onBlockCacheItemChanged);this.da.ha.add_activeCellChanged(this.onActiveCellChanged);this.da.Mz(this.onContentReady);this.da.cellTextEditBox.nv(this.iMa);this.da.cellTextEditBox.Wx(this.hMa)}gai(){this.da&&(this.da.ha&&(this.da.ha.remove_activeCellChanged(this.onActiveCellChanged),this.da.za.Fy(this.onBlockCacheItemChanged)),this.da.xE(this.onContentReady),this.da.cellTextEditBox&&(this.da.cellTextEditBox.ev(this.iMa),this.da.cellTextEditBox.Zw(this.hMa)),this.o1g())}yKb(A){this.Y3k(A);
this.cWb&&(this.LSk(),this.mFb?(this.wqg||this.JGh(),this.Rkd?this.kaa=!1:(this.kaa=!0,this.ZCg())):(F.ULS.sendTraceTag(537151199,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),this.kaa=!1))}ZCg(){appChrome.renderTableTotalRowOptions(this.parentElement,Nc.xT,Nc.xT[this.$0j()].toString(),Math.round(this.zoomManager.Pn(17)),A=>{F.ULS.sendTraceTag(537151198,0,50,`TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : ${A}`);const ja=
{["SelectedOption"]:Nc.xT[A],["FunctionKeyCode"]:A,["Location"]:"canvas"};Cb.b(this.$).lj(Oa.a.qUk,ja,null,!0);if("111"===A)return this.udj(),!0;if("100"!==A){this.Zke=this.uFi(A);if(!this.Zke)return F.ULS.sendTraceTag(537151197,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),!0;this.o6a(this.Zke)}else this.o6a("");Y.DOMElementExtensions.setFocus(this.da.sh.$b.domElement);return!0})}udj(){F.ULS.sendTraceTag(537151196,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");
const A=new Ib.a(753860909,0,this.$.isEditMode?2:1,19,null);this.$.Ma.dh(A)}bJa(A){if(!A)return null;var ja=this.da.cellTextEditBox.$b.domElement;var Ua=0<Y.DOMElementExtensions.getHeight(ja)&&0<Y.DOMElementExtensions.getWidth(ja)&&0<=ja.offsetTop&&0<=ja.offsetLeft;if(Ua)ja=Y.DOMElementExtensions.bJa(ja,this.da.Ym);else{ja=this.da.getCellBounds(A.cell);var ac=Y.DOMElementExtensions.getBoundingClientRect(this.da.Ym);ja=new Sys.UI.Bounds(ja.x-ac.x,ja.y-ac.y,ja.width,ja.height)}if(ja)if(Ua)2<ja.height&&
2<ja.height&&(ja.x+=1,ja.y+=1,ja.height-=2,ja.width-=2);else if(Ua=za.f(this.$).oU(A.cell))Ua=Ua.width,ac=ea.a.equals(Fa.a.xPb(A.cell,this.da.rtl),"right",!0),this.da.rtl&&ac&&(ja.x=ja.x+ja.width-Ua),A.bya&&this.da.rtl===ac&&(ja.width=Ua);else return null;return ja}Y3k(A){var ja=this.mFb;if(ja){var Ua=17>=ja.height?ja.y:ja.y+ja.height-17-2;ja=this.Pkj?this.da.rtl?ja.x:ja.x+ja.width-(17<ja.height?17:ja.height):this.da.rtl?ja.x-(17<ja.height?17:ja.height):ja.x+ja.width;var ac=this.zoomManager.Rfa(new Sys.UI.Point(ja,
Ua));this.parentElement.style.top=Nd.HelperMethods.ti(ac.y);this.parentElement.style.left=Nd.HelperMethods.ti(ac.x);this.zoomManager.QBk(this.parentElement);A&&(this.kaa=this.da.XHc(new ic.a(ja,Ua)))}else this.kaa=!1}JGh(){this.uZa.insertBefore(this.parentElement,this.uZa.firstChild);this.wqg=!0}LSk(){this.r0||(this.da.view.Wy(this.zy),this.r0=!0)}o1g(){this.r0&&this.da.view&&(this.da.view.Kx(this.zy),this.r0=!1)}o6a(A){const ja=this.da.sh,Ua=this.da.kh(null);Ua&&(A=Object(Ea.a)(new yc.a,{Text:A}),
this.da.setCell(A,Ua.range,0,127,null),ja.endEdit(!0,"TableTotalRowOptions.SetCellContent",0))}}Nc.pUk="TableTotalRowDropDownIconButtonId";Nc.xT=null;Object(K.a)(Nc,"TableTotalRowOptions",sc.a,[2]);var Id=a(1281);let ke=class extends Wa.a{constructor(A,ja){super(za.f(A));this.xIb=this.jca=this.QZc=this.vIb=null;this.B3e=!1;this.$Me=null;this.Ybc=0;this.Grc=null;this.smc=()=>{const Ua={},ac=this.uLd();for(const gd in ac){const ad=ac[gd];if(!ad)continue;const Jd=this.ZVi(ad);if(Jd){if(Jd in this.QTa){var Ec=
this.QTa[Jd];if(Ec.tK){Ec.gv.equals(ad)||(Ec.gv=ad);delete this.QTa[Jd];Ua[Jd]=Ec;continue}}(Ec=wb.createInstance(za.f(this.$),ad,this.hCi(),this,this.zoom))?Ua[Jd]=Ec:F.ULS.sendTraceTag(537151239,0,15,`TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range ${ad.xF(!1)}`)}}this.Doc(null,null);this.xac=Ua};this.Doc=()=>{const Ua=this.QTa;for(const gd in Ua){var ac=gd,Ec=Ua[gd];Ec&&(Ec.dispose(),delete this.QTa[ac])}this.xac={}};this.Xwg=()=>{this.Doc(null,null);this.smc(null,null)};
this.onFocus=()=>{this.$Me=za.f(this.$).ha.qa.activeCell};this.kA=()=>{if(this.$.isEditMode)this.onActiveCellChanged(null,null)};this.onActiveCellChanged=()=>{!this.B3e&&bf.d(this.$,this.da.ha.qa.activeCell)&&this.Bvj()};this.SI=()=>{this.NSb(1);ba.EwaSettings.fl()||this.$.ea.dv(this.SI)};this.d1b=()=>{this.B3e=!0;this.QZc=new Nc(this.$,this.zoom)};this.$=A;this.zoom=ja;this.da=za.f(this.$);this.xac={};this.smc(null,null);this.$.sa&&this.$.sa.Qm(this.Xwg);this.jnd(this.smc);this.$.ea.JJ(this.kA);
this.da.ha.add_activeCellChanged(this.onActiveCellChanged);if(this.$.isEditMode)this.onActiveCellChanged(null,null)}jnd(A){this.addHandler(Wa.a.Bsb,A)}Bge(A){this.removeHandler(Wa.a.Bsb,A)}Axh(A){this.addHandler("tce",A)}kik(A){this.removeHandler("tce",A)}get QTa(){return this.xac}get ZYd(){return this.$Me}get MWa(){return this.Ybc}get Zv(){const A=za.f(this.$);return A.Yg.sl(A.ha.qa.activeCell,!1)}get Ebe(){return this.ZYd?za.f(this.$).Yg.sl(this.ZYd,!1):null}rXd(A){return!!this.ZGf(A)}my(A){return this.VRi(this.IHf(A))}fPb(A){return this.IHf(A)}Hfk(A){A?
(this.xIb?this.xIb!==A&&(sb.a.Ng(this.jca),this.jca=null,this.xIb=A):this.xIb=A,this.jca||(this.jca=Se.a.instance.Ek(this.xIb)),this.jca.zv("focusin")||this.jca.Aa("focusin",this.onFocus)):F.ULS.sendTraceTag(537151245,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement received")}QWf(A,ja){return A?A.Swa&&A.top===ja.top:(F.ULS.shipAssertTag(537151244,0,!!A,"autofilterRange can't be null"),!1)}vwa(A){A=this.vIb?Sa.N(A,this.vIb):this.view.getRangeInformation(A);return 0<A.length&&
Object(Fd.a)(Uc.PivotTableRange,A[0])?A[0]:null}Yfj(A,ja){return A?!A.YEc&&!!A.Pz&&A.Pz.yi(ja):(F.ULS.shipAssertTag(537151243,0,!!A,"Pivot table can't be null"),!1)}Znj(A,ja){return A?!A.YEc&&!!A.zE&&A.zE.yi(ja):(F.ULS.shipAssertTag(537151242,0,!!A,"Pivot table can't be null"),!1)}$jc(A){super.$jc(A);if((A=Nd.HelperMethods.kHf(A))&&0<A.length){this.vIb=Array(A.length);for(let ja=0;ja<A.length;ja++)this.vIb[ja]=cd.a.AI(A[ja])}}F2b(){super.F2b();this.vIb=null}J_h(A,ja){let Ua;Ua=!1;if(!A||!ja)return{returnValue:!1,
I9:Ua};A=A.clone();A.right+=1;A.left=A.right;if(!A.nD)return{returnValue:!1,I9:Ua};if(A.top<ja.Pg.Hm){const ac=A.clone();ac.bottom>=ja.Pg.Hm&&(ac.bottom=ja.Pg.Hm-1);if(!(()=>{let Ec=this.ggf(ac,ja);({I9:Ua}=Ec);return Ec})().returnValue)return{returnValue:!1,I9:Ua}}if(A.bottom>=ja.Pg.Hm){const ac=A.clone();ac.top<=ja.Pg.Hm&&(ac.top=ja.Pg.Hm);if(!(()=>{let Ec=this.ggf(ac,ja);({I9:Ua}=Ec);return Ec})().returnValue)return{returnValue:!1,I9:Ua}}return{returnValue:!0,I9:Ua}}OWg(A){(A=this.my(A.topLeft))&&
A.toString()in this.QTa&&(this.QTa[A.toString()].RWd=!1)}T9j(){this.raiseEvent("tce")}mq(A,ja){if(!this.QZc)return!1;switch(ja){case -569786022:case 541421805:if(this.QZc.kaa){const Ua=document.getElementById(Nc.pUk);Ua&&pf.a.instance.create(()=>{Y.DOMElementExtensions.JDc(Ua,null)},0,Ud.a.iUk,!0,!0)}return!0;default:return!1}}dispose(){this.Doc(null,null);this.Bge(this.smc);this.$.sa.hn(this.Xwg);this.$.Au(this.Doc);this.xac=null;this.$.ea&&this.$.ea.GH(this.kA);this.da.ha.remove_activeCellChanged(this.onActiveCellChanged);
this.QZc=null;this.jca&&(sb.a.Ng(this.jca),this.jca=null);super.dispose()}g3i(A,ja,Ua,ac){var Ec=this.da.Yg.sl(new yd.Range(ja,Ua,ja,Ua,!1,!1));if(this.Grc=Ec){var gd=Ec.usedRange,ad=A.ctrlKey||Da.a.isMac&&Zb.b(A);Ec=!A.shiftKey&&ad;A=A.shiftKey&&!ad;za.f(this.$).ha.selectionType=3;switch(ac){case 0:this.Ybc=0;ja=this.Dxd(A,gd.top,Ua,gd.bottom,Ua);this.fne(ja,Ec,A);break;case 1:this.Ybc=1;ja=this.Dxd(A,ja,gd.left,ja,gd.right);this.fne(ja,Ec,A);break;case 2:this.Ybc=2;ja=this.Dxd(A,gd.top,gd.left,
gd.bottom,gd.right);this.fne(ja,Ec,A);break;default:F.ULS.shipAssertTag(537151240,0,!1,`TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: ${ac.toString()}`);return}za.f(this.$).ha.selectionType=3;F.ULS.sendTraceTag(527212953,0,50,"TableManager.handleTableSelectorsSelection: A table selector was clicked using hover arrows")}else F.ULS.shipAssertTag(537151241,0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")}gHk(A){const ja=
this.Grc.usedRange;return this.rZf(A)||1!==this.MWa&&this.rZf(new yd.Range(ja.top,A.left,ja.bottom,A.right,!1,!1))?!0:!1}ade(A){return A.Autofilters}ggf(A,ja){let Ua;Ua=!1;const ac=ja.Pg.ro(A),Ec=ja.Zk(ac).Hp;if(!Ec)return F.ULS.sendTraceTag(537151238,0,15,`TableManager.CouldExpandImpl - loadedRange is null. PaneType=${ac}`),{returnValue:!1,I9:Ua};if(!Ec.pk(A))return{returnValue:!0,I9:Ua};A=ja.ot("TableManager.CouldExpandImpl",A,2);try{for(;A.$$mn();){if(A.$$cu().text||A.mu.GZa)return Ua=!0,{returnValue:!1,
I9:Ua};if(A.$$cu().kH)return{returnValue:!1,I9:Ua}}}finally{A&&A.dispose()}return{returnValue:!0,I9:Ua}}VRi(A){if(!A)return null;const ja=new hc.AutofilterRange(A.top,A.left,A.bottom,A.right,null,null,null,A.id,A.Swa);ja.o7a=A.o7a;const Ua=this.da.Yg.sl(A,!0);if(!Ua)return null;for(let ac=0,Ec=this.rangeList.length;ac<Ec;ac++){const gd=this.rangeList[ac],ad=this.da.Yg.sl(gd,!0);ad&&ad.name===Ua.name&&gd!==A&&this.dnj(gd)&&(ja.union(gd),gd.o7a&&(ja.o7a=!0))}return ja}dnj(A){return!!za.f(this.$).Yg.sl(A)}hCi(){const A=
[];for(const ja of this.rangeList){const Ua=new Ze.a(this.my(ja.topLeft),lg.d(this.$.na));A.push(Ua)}return A}uLd(){const A={};for(const ja of this.rangeList){if(!ja)continue;const Ua=this.my(ja.topLeft);Ua&&(A[Ua.toString()]=this.my(ja.topLeft))}return A}Bvj(){this.$.ea.Ul?this.NSb(0):ba.EwaSettings.fl()?this.$.ea.Jq(this.SI):this.$.ea.Uq(this.SI)}NSb(A){this.$.k5(ja=>{ja.F$(A).then(this.d1b)})}ZVi(A){const ja=this.da.Yg.sl(A);return ja?ja.name:A.toString()}fne(A,ja,Ua){A&&(Ua=Ua?za.f(this.$).ha.qa.activeCell:
A.topLeft,ja?this.da.ha.updateSelection(A,Ua,0,1):this.da.ha.DP([A],0,Ua,0))}Dxd(A,ja,Ua,ac,Ec){const gd=ta.d(this.Grc),ad=ta.g(this.Grc),Jd=ja+(1!==this.MWa&&gd?1:0),De=ac-(1!==this.MWa&&ad?1:0),Xe=this.da.inRangePicker||this.da.Pp;if(A){var lf=Xe&&!Ze.a.Xqc(this.da.ha.rangePicker.NY).length?new yd.Range(Jd,Ua,De,Ec,!1,!1):Xe?this.da.ha.rangePicker.activeCell:this.da.ha.qa.activeCell;lf=new yd.Range(lf.top<Jd?lf.top:Jd,lf.left<Ua?lf.left:Ua,lf.bottom>De?lf.bottom:De,lf.right>Ec?lf.right:Ec,!1,!1)}else lf=
new yd.Range(Jd,Ua,De,Ec,!1,!1);if(1!==this.MWa&&(gd||ad)&&(!A||A&&this.bvd(lf,Jd,Ua,De,Ec))){A=Xe?Ze.a.Xqc(this.da.ha.rangePicker.NY):this.da.ha.qa.selectedRanges;for(const mf of A)if(this.bvd(mf,Jd,Ua,De,Ec)){lf.top=ja;lf.bottom=ac;break}}return lf}rZf(A){const ja=this.da.inRangePicker||this.da.Pp?Ze.a.Xqc(this.da.ha.rangePicker.NY):this.da.ha.qa.selectedRanges;for(const Ua of ja)if(this.bvd(Ua,A.top,A.left,A.bottom,A.right))return!0;return!1}bvd(A,ja,Ua,ac,Ec){return!!A&&A.top===ja&&A.bottom===
ac&&A.left===Ua&&A.right===Ec}};ke=Object(U.__decorate)([Object(ka.d)(Ha.hg),Object(U.__param)(0,Object(Ha.Lb)()),Object(U.__param)(1,Object(Ha.Lg)())],ke);Object(K.a)(ke,"TableManager",Wa.a,[851,2]);String(Id);window.___1708742462436_closurehack=Id;var Ie=a(757),Le=a(638),wf=a(1283);class Kf extends Ca.a{constructor(A,ja){ja=void 0===ja?!0:ja;super(!1,!1,!0);this.dbb=null;this.CIe=!1;this.zw=[];this.Up=null;this.wPj=Ua=>{this.Loh&&(this.Up=this.LNg(Ua,this.Eic))};this.FYj=()=>{this.Up&&this.Up.AO&&
(this.CIe||(this.Up.$ek(this.b7d),this.CIe=!0),this.Up.lwf())};this.b7d=Ua=>{this.dbb.uploadStatusLabel=Ua;this.NPa(this.titleText,this.vRd,this.dbb)};this.vRd=Ua=>{1===Ua&&this.isEnabled()?this.Up.AO&&!this.Up.AO.value?(this.dbb.uploadStatusLabel=Object(Xc.a)("FileUploadNoFileSpecified"),this.NPa(this.titleText,this.vRd,this.dbb)):(this.Tkb(),this.Eic.finalizeUpload(this.Up,this.dispose)):0===Ua&&this.hide()};this.d9d=()=>{this.Cug()};this.onKeyDown=Ua=>{4!==yb.FocusManager.instance().Gug(Ua)&&Ua.preventDefault()};
this.Eic=A;this.Loh=ja;this.aI=this.bWe=!1;this.Vsa=null;this.Lk="InsertFileDialog";this.Yh(1,this.actionButtonText);this.dbb={["id"]:this.Lk,["bodyControls"]:{["uploadButtonProps"]:{["label"]:Object(Xc.a)("DialogChooseFile"),["onExecute"]:this.FYj}},["uploadStatusLabel"]:Object(Xc.a)("DialogNoFileChosen"),["onFrameReady"]:this.wPj};this.initializeAndShow(this.titleText,this.vRd,this.dbb);this.n8c=!0}get M7k(){return this.Eic}QDk(){this.AIe=!1;this.Up=this.LNg(document.getElementById("uploadFrameContainer"),
this.Eic);mb.AFrameworkApplication.fa.la("InsertPictureDialogFocusLoopFixIsEnabled")&&(this.Vsa=this.d9d,Mb.a.addHandler(this.Up.XPd,"load",this.Vsa));this.Up.AO||F.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.Cug()}Cug(){if(this.Up&&!this.AIe){var A=this.Up.AO;A&&(Mb.a.addHandler(A,qb.a.zi,this.onKeyDown),A=[A],this.zw=A.concat.apply(A,this.zw),this.o5k(),this.AIe=!0)}}dispose(){if(this.Up){const A=this.Up.AO;A&&Mb.a.removeHandler(A,qb.a.zi,this.onKeyDown);this.Vsa&&
Mb.a.removeHandler(this.Up.XPd,"load",this.Vsa)}this.Up=null;super.dispose()}o5k(){if(0<this.zw.length){const A=new wf.a(this.zw),ja=yb.FocusManager.instance().i0();ja&&(this.zw[0].focus(),ja.fo=A,ja.Zga=!0)}}static jG(A){const ja=document.getElementById("errorText");ja.innerText=A;ja.style.display="inline-block"}}Object(K.a)(Kf,"InsertFileDialog",Ca.a,[]);class cg{static get Po(){return Ca.a.UA(cg.$v,Object(Xc.a)("ImageUploadDialogText"),Object(Xc.a)("ImageUploadNoFileSpecified"))}}cg.$v="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";
Object(K.a)(cg,"InsertImageDialogHtml",null,[]);class Bg extends Kf{constructor(A,ja){super(A,void 0===ja?!0:ja)}get actionButtonText(){return Object(Xc.a)("ImageUploadButtonText")}get titleText(){return Object(Xc.a)("ImageUploadingTitle")}validate(){this.Up.AO||F.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var A=Object(Ae.a)(md,this.M7k);const ja=A.g5g(this.Up.AO.value);return 0!==ja?(A=A.yDf(ja),Kf.jG(A),!1):!0}}Object(K.a)(Bg,"InsertImageDialog",Kf,[]);var dh=a(843),
Sf=a(139),eh=a(1498);class Rg extends eh.a{constructor(A,ja,Ua,ac,Ec,gd,ad,Jd){Jd=void 0===Jd?!1:Jd;super(A,ja,Ua,ac,Ec,"UploadFrame",gd.ea.sessionId,"image/*",!1,null,void 0===ad?!1:ad);this.$=gd;this.t4g=!0;this.yfj=Jd;this.kRd()}ia(A){return A}yKg(A){F.ULS.shipAssertTag(526399105,0,!!this.sessionId,"SessionId shouldn't be null.");bd.a.Eod(A,this.$.ua);A.Sda(xd.a.sessionId,this.sessionId);var ja=za.f(this.$).ha;ja=Sa.p(ja.qa.E$,this.$);A.Sda(xd.a.nvg,this.$.sa.na.name);A.Sda(xd.a.N8j,ja.FirstRow.toString());
A.Sda(xd.a.M8j,ja.FirstColumn.toString());A.Sda(xd.a.ecj,this.yfj.toString())}hNf(){this.qFg("ServerUploadError")}x3a(A){this.qFg(A)}static hij(A){return!A||ea.a.equals(A,"ServerUploadError",!1)}}Object(K.a)(Rg,"UploadFrameWrapper",eh.a,[]);class Dg extends Bg{constructor(A,ja,Ua,ac){super(A,!1);this.xva=null;this.gPa=!1;this.ji=null;this.FMc=()=>{this.Hwe("");this.E0c();return!1};this.$=ja;this.X1c=A;this.v0=dh.a.instance;this.fa=Ua;this.ji=ac;this.QDk();this.x$i();this.$.ih.GF=!0}LNg(A,ja){return new Rg(A,
Object(Sf.a)(ja,ja.w3a,"onUploadFrameInitialized"),Object(Sf.a)(ja,ja.Wia,"uploadResponseReceived"),this.fa,!0,this.$)}dispose(){this.E0c();this.v0=this.X1c=null;super.dispose()}hide(){super.hide();this.$.ih.GF=!1}validate(){var A=this.X1c.i$b(this.Up.AO.value,this.X1c.v_g(this.Up));return 0!==A?(A=this.X1c.TId(A).Description,this.Hwe(A),this.yse(),!1):!0}isEnabled(){return!0}Hwe(A){var ja;null===(ja=this.ji)||void 0===ja?void 0:ja.wLg(this.xva,A)}x$i(){this.xva=document.getElementById("errorText");
this.xva.style.display="inline-block";this.gPa=!1;this.Hwe("");this.Vgb.style.maxWidth=this.Vgb.currentStyle.minWidth}yse(){this.v0.ya(qb.a.click,this.Up.AO,this.FMc);this.v0.ya(qb.a.zi,this.Up.AO,this.FMc);this.gPa=!0}E0c(){this.gPa&&(this.v0.Na(qb.a.click,this.Up.AO,this.FMc),this.v0.Na(qb.a.zi,this.Up.AO,this.FMc),this.gPa=!1)}}Object(K.a)(Dg,"InsertImageDialogWrapper",Bg,[]);var Kg=a(61);class Hg extends md{constructor(A,ja,Ua,ac,Ec){Ec=void 0===Ec?!0:Ec;super(null,ja,Ua);this.Dva=this.NP=null;
this.GSd=this.tnb=!1;this.V$d=null;this.Wia=gd=>{this.mze.stop();this.mmc.cancel();if(Rg.hij(gd))this.b8?this.YLf(4):(gd=new Ie.a(0,2,null,null,!1,null,null,null),gd.status=8,this.ive(new Le.a(gd),null,"InsertPictureWebMethod")),F.ULS.sendTraceTag(526399121,0,50,`Http Error occurred, isTimeoutError: ${this.b8}`);else{const ad=Hg.V9k(gd);0!==ad?(F.ULS.sendTraceTag(526399122,0,50,`Server returned error, response: ${gd}`),this.YLf(ad)):this.X2i(gd)}this.d0b();this.dispose()};this.COj=gd=>{this.bra(gd,
this.Up)&&this.finalizeUpload(this.Up,null)};this.w3a=gd=>{F.ULS.sendTraceTag(526399120,0,50,"Upload frame initialized");this.Up=gd;if(!this.aHa){if(this.$1c){if(this.a$e()||this.E2a&&Da.a.KI){gd.pMb(this.COj);return}const ad=gd.pMb(null);if(!this.bra(ad,gd))return}this.finalizeUpload(gd,null)}};this.fYj=()=>{this.b8=!0};this.fh=A;this.mze=A.qh.Vl("WebServiceCall","InsertPictureOperation");this.mmc=pf.a.instance.create(this.fYj,1E5,Ud.a.iIh,!1);this.b8=!1;this.DKc=this.$.ua.InsertPictureMaxFileSizeBytes;
ac&&(this.tnb="TestOnly"in ac);ac&&(this.GSd="IsCellPicture"in ac);Ec&&this.showDialog()}get $(){return this.fh}get nCj(){return this.DKc/1024/1024}dispose(){sb.a.Ng(this.mmc);this.Up&&this.Up.IZe();this.Up=this.mmc=this.fh=null}vbk(A){if(!this.$)return F.ULS.sendTraceTag(526399119,0,50,"ReadPictureAsDataURLTask: EwaControl is null"),ha.Task.Va(!0);if(!this.$.Bga)return ha.Task.Va(!0);const ja=new Ob.a,Ua=new FileReader;A=A.AO.files[0];const ac=()=>{ja.KE(!0)};Ua.onload=()=>{this.V$d=Ua.result;ja.KE(!0)};
Ua.onerror=ac;Ua.onabort=ac;Ua.readAsDataURL(A);return ja.task}v_g(A){let ja=-1;A=A.AO;(null===A||void 0===A?0:A.files)&&0<A.files.length&&(ja=A.files[0].size);return ja}i$b(A,ja){let Ua=Hg.g_h(md.bra(A));0===Ua?-1!==ja&&(F.ULS.sendTraceTag(526399118,0,50,`Validating picture, pictureSize: ${ja}, maxAllowedSize: ${this.DKc}, remainingWorkbookSize: ${this.$.ea.L2f}`),ja>this.DKc?Ua=3:ja>this.$.ea.L2f&&(Ua=7)):6===Ua&&this.Hzj(A);F.ULS.sendTraceTag(526399117,0,50,`Validated file on client, validation result: ${Ua}`);
return Ua}bra(A,ja){A=this.i$b(A,this.v_g(ja));return 0!==A?(this.aHa||1===A||this.kqe(A),!1):!0}GZg(A){A.ISk()}TId(A){let ja=0,Ua=1,ac=-1100324317,Ec="InsertPictureUnknownError",gd=null;switch(A){case 1:ja=1758;Ua=0;ac=940870981;Ec="InsertPictureNoFileSelected";break;case 3:Ua=0;ac=1250467391;Ec="InsertPicturePictureTooBig";gd=String.format(Ba.a.instance.$g(181),this.nCj.toLocaleString());break;case 6:ja=1762;Ua=0;ac=1380041209;Ec="InsertPictureUnsupportedFormat";break;case 7:ja=1759;Ua=0;ac=-903115058;
Ec="InsertPictureExceedWorkbookSize";break;case 4:ja=1760;Ua=0;ac=1218352119;Ec="InsertPictureUploadTimeout";break;case 5:ja=1761,Ua=0,ac=1979899005,Ec="InsertPictureServiceNonDeterministicError"}A=Hg.Yi(ja,Ua,ac,Ec);gd&&(A.Description=gd);return A}showDialog(){if(this.a$e())this.aHa=!1,this.Up=new Rg(this.$.domElement,this.w3a,this.Wia,this.fa,!1,this.$,!0,this.GSd);else if(F.ULS.sendTraceTag(526399115,0,50,"Showing Insert Picture dialog"),!this.tnb&&(Da.a.IU||Da.a.KI&&72>Da.a.vbf))this.aHa=!1,this.Up=
new Rg(this.$.domElement,this.w3a,this.Wia,this.fa,!1,this.$);else{this.aHa=!0;const A=Object(Bb.d)(ka.a.resolve(Ha.kd,{va:0}));$b.TaskExtensions.Ua(A,()=>{this.Up=(new Dg(this,this.$,this.fa,A.result)).Up},this.$.xa,3)}}X2i(A){let ja={};try{if(ja=qf.a.Gp(A),Kg.b().fI(this.mze.id,ja.ServerCorrelationId,"actions","ServerActions"),!kb.a.Jk(ja.Errors)&&ja.Result&&(this.$.ea.e8(ja.StateId,"BasePictureUploaderWrapper.UploadResponseReceived"),!this.GSd)){const Ua=ja.Result;bb.a(this.$).fOa(1,Ua);const ac=
ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8434150_MigrateValidationTelemetryManager")?ka.a.Zg(Ha.yg):this.$.ka.Ug(277);ac&&ac.Kld(this.$,1,ja.Result,ja,"InsertPicture");F.ULS.sendTraceTag(526399114,0,50,"Insert picture completed successfully :)")}}catch(Ua){F.ULS.sendTraceTag(526399113,0,50,`BasePictureUploaderWrapper.HandleSuccessCallback: got exception while try to JSON.Parse string length: ${A?A.length:-1}, errror: ${Ua}`)}this.$_c(ja,null,"InsertPictureWebMethod")}YLf(A){A=this.TId(A);const ja=
{};ja.Errors=[A];this.$_c(ja,null,"InsertPictureWebMethod")}$_c(A,ja,Ua){this.NP(A,ja,Ua)}ive(A,ja,Ua){this.Dva(A,ja,Ua)}kqe(A){A=this.TId(A);new Zd.a(this.$,A)}Hzj(A){const ja=this.$.ua.InsertPicturUnsupportedExtensionsForLogging;A=xa.a.Rr(A);for(let Ua=0;Ua<ja.length;++Ua)if(A.endsWith(ja[Ua])){F.ULS.sendTraceTag(526399112,0,50,`Insert picture blocked invalid extension: ${ja[Ua]}`);break}}static V9k(A){return!A||ea.a.equals(A,xd.a.insertPictureUnknownError,!0)?2:ea.a.equals(A,xd.a.insertPictureNoFileSelectedError,
!0)?1:ea.a.equals(A,xd.a.dcj,!0)?3:ea.a.equals(A,xd.a.gcj,!0)?5:0}static Yi(A,ja,Ua,ac){return kb.a.Yi(1,0,0,A,ja,Ua,ac)}static g_h(A){switch(A){case 1:return 1;case 2:return 6}return 0}a$e(){return this.tnb||void 0===window.self.FormData||null===window.self.FormData?!1:!0}}Object(K.a)(Hg,"BasePictureUploaderWrapper",md,[2]);class fh extends Hg{constructor(A,ja,Ua,ac,Ec,gd){gd=void 0===gd?!0:gd;super(A,ja,Ua,ac,!1);this.mti=Ec;this.bwc=A.qh.Vl("LoadResource","FileReaderUploaderLoadResource");gd&&
this.showDialog()}yLk(){this.DKc=28E5;this.kqe(3)}CEd(A){F.ULS.sendTraceTag(526399111,0,50,"FileReaderUploaderWrapper.finalizeUploadImpl - Start function.");const ja=new FileReader;A=A.AO.files;if(0==A.length)F.ULS.sendTraceTag(526399110,0,15,"FileReaderUploaderWrapper.finalizeUploadImpl - No image file found.");else{var Ua=A[0];ja.onload=()=>{this.bwc.stop();this.mti.AXj(ja.result,this);F.ULS.sendTraceTag(526399109,0,50,`FileReaderUploaderWrapper.finalizeUploadImpl - End function. Type:${Ua.type}, Size:${Ua.size.toString()}`)};
ja.onerror=()=>{this.bwc.stop();F.ULS.sendTraceTag(526399108,0,10,`FileReaderUploaderWrapper.finalizeUploadImpl - Can't read image. Type:${Ua.type}, Size:${Ua.size.toString()}`)};ja.onabort=()=>{this.bwc.stop();F.ULS.sendTraceTag(526399107,0,10,`FileReaderUploaderWrapper.finalizeUploadImpl - Aborted read image. Type:${Ua.type}, Size:${Ua.size.toString()}`)};this.bwc.start();ja.readAsDataURL(Ua)}}finalizeUpload(A,ja){this.CEd(A,ja)}}Object(K.a)(fh,"FileReaderUploaderWrapper",Hg,[871]);class Vh{constructor(A,
ja){this.dataUri=this.sheetName=null;this.sheetName=A;this.dataUri=ja}getSheetName(){return this.sheetName}}Object(K.a)(Vh,"MacroRecorderPictureInsertedPayload",null,[65]);class Yf extends Hg{constructor(A,ja,Ua,ac,Ec,gd){gd=void 0===gd?!0:gd;super(A,Ua,ac,Ec,!1);this.Ah=ja;gd&&this.showDialog()}CEd(A,ja){super.finalizeUpload(A,ja);gf.a(this.$.userOperationManager,(Ua,ac)=>{this.NP=Ua;this.Dva=ac;this.mze.start();this.mmc.qA();this.b8=!1;this.GZg(A);return this.vbk(A)},Ua=>{const ac={};this.$.Mq(ac);
const Ec=ac.SheetName;Ua=new Lc.a(510,0,Ua,72,()=>new Vh(Ec,this.V$d?this.V$d:""));Ua.COa(()=>!0);Ua.Ah=this.Ah;return Ua},this.Ah)}finalizeUpload(A,ja){this.CEd(A,ja)}}Object(K.a)(Yf,"PictureUploaderWrapper",Hg,[]);class Eg{constructor(A,ja){this.filename=A;this.blob=ja}}Object(K.a)(Eg,"UploadBlobParameters",null,[]);class hg extends Yf{constructor(A,ja,Ua,ac,Ec,gd,ad){super(A,ja,Ua,ac,Ec,!1);this.$1c=!1;this.MS=ad;this.KCc=hg.zzi(gd);A=this.i$b(this.KCc.name,this.KCc.size);0!==A?(this.kqe(A),this.MS.setException(Error.create("DataUrlUploaderWrapper: Invlid data url")),
this.dispose()):this.Up=new Rg(this.$.domElement,this.w3a,this.Wia,ac,!1,this.$)}ive(A,ja,Ua){super.ive(A,ja,Ua);this.MS.setException(Error.create("DataUrlUploaderWrapper.TriggerFailedCallback: File upload request failed"))}$_c(A,ja,Ua){super.$_c(A,ja,Ua);kb.a.Jk(A.Errors)?this.MS.setException(Error.create(`DataUrlUploaderWrapper.TriggerSuccessCallback: File upload request returned with errors: ${kb.a.Kh(A.Errors)}`)):this.MS.setResult(!0)}GZg(A){const ja=new Eg(this.KCc.name,this.KCc);A.FVg(ja)}static zzi(A){var ja=
A.split(",");A=ja[0].includes("base64")?window.self.atob(ja[1]):window.self.decodeURI(ja[1]);ja=ja[0].split(":")[1].split(";")[0];const Ua=new Uint8Array(A.length);for(let ac=0;ac<A.length;ac++)Ua[ac]=A.charCodeAt(ac);A=new Blob([Ua],{type:ja});A.name="Image.png";return A}}Object(K.a)(hg,"DataUrlUploaderWrapper",Yf,[]);let qg=class{constructor(){}Daj(A,ja,Ua,ac,Ec){-2060689045===ja.command&&(Ec.IsCellPicture=!0);new Yf(A,ja,Ua,ac,Ec,!0)}t$i(A,ja,Ua,ac,Ec,gd){new hg(A,null,ja,Ua,ac,Ec,gd)}I$i(A,ja,
Ua,ac,Ec){new fh(A,ja,Ua,ac,Ec,!0)}};qg=Object(U.__decorate)([Object(ka.d)(Ha.wg)],qg);Object(K.a)(qg,"UploaderCreator",null,[854]);let jh=class{constructor(A,ja){this.E6=()=>{this.sj||this.s3e()};this.sj=!1;this.c$=ja.e4;this.ariaLiveNotifier=A;this.Bze=new fb(A,ja);this.c$&&this.c$.WX?this.s3e():this.fq()}dispose(){this.$o();this.ariaLiveNotifier=this.c$=null;this.sj=!0}fq(){if(this.c$){this.c$.Mz(this.E6);this.c$.za.Uy(this.E6);this.c$.KN(this.E6);var A=Object(Ae.a)(167,this.c$);A&&(A.sh.nv(this.E6),
A.ha.Cw(this.E6),A.ha.add_activeCellChanged(this.E6),A.ha.$e.MN(this.E6))}else F.ULS.sendTraceTag(537153923,0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")}$o(){if(this.c$){this.c$.za.Ix(this.E6);this.c$.vP(this.E6);const A=Object(Ae.a)(167,this.c$);A&&(A.sh.ev(this.E6),A.ha.$w(this.E6),A.ha.remove_activeCellChanged(this.E6),A.ha.$e.sV(this.E6))}}s3e(){this.Bze.Mxg();this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.Jzk();this.dispose()}};jh=Object(U.__decorate)([Object(ka.d)(Ha.Gg),
Object(U.__param)(0,Object(Ha.l)()),Object(U.__param)(1,Object(Ha.Lb)())],jh);Object(K.a)(jh,"WorkbookReadoutHandler",null,[2]);var dg=a(259);const Wh="H1 H2 H3 H4 H5 H6".split(" "),Ch=["TD","TH"],Fg=["P","DIV","TABLE","TBODY","THEAD","TFOOT","ARTICLE","ADDRESS","ASIDE","BLOCKQUOTE","CAPTION","CODE","FORM","DETAILS","SUMMARY","LEGEND","FIELDSET","FOOTER","HEADER","KBD","MAIN","SECTION",...Wh],Qa="SPAN A ABBR ACRONYM B STRONG I EM SUB SUP BDO BDI BUTTON CITE DATA LABEL DEL INS DFN DIALOG HGROUP MARK S TIME U V FONT".split(" "),
Ma=["UL","OL","LI","INPUT","SELECT","AREA","AUDIO","B","BASE","BR","CANVAS","COL","COLGROUP","DATALIST","DD","DETAILS","DFN","DIR","DL","DT","EMBED","FIGCAPTION","FIGURE","HR","IFRAME","IMG","LINK","MAP","MENU","MENUITEM","META","METER","NAV","NOSCRIPT","OBJECT","OPTGROUP","OPTION","OUTPUT","PICTURE","PRE","PROGRESS","Q","RP","RT","RUBY","SAMP","SMALL","SOURCE","TEMPLATE","TEXTAREA","TR","TRACK","VAR","VIDEO",...Fg,...Qa,...Ch],$c="table table;table ul;table ol;table dl;ul ul;ol ol;ol ul;ul ol;dl;img".split(";"),
de={"sans-serif":"Arial",trl:"Times New Roman",Pjl:"Courier New",Qhl:"Comic Sans MS",oil:"Algerian"},Be=/^(\d+|\d+\.\d+)(\w+)$/,nf=/>\s+</g;let Tf=class{constructor(A){this.SPd=[];this.AU=[];this.aZd=this.LIc=this.Lla=this.Pla=0;this.K0b=A}o1j(A,ja){this.jba={I6i:-1,WPf:-1,J6i:-1,Oil:A.length,F6i:0};const Ua=[];if(!ja.token.sM){A=this.Qhk(A);const Ec=performance.now();this.eSb=this.K0b.tsk(A);this.jba.I6i=performance.now()-Ec;A=!1;for(var ac of $c)if(this.eSb.querySelector(ac)){A=!0;break}if(A)return ja=
performance.now(),this.K0b.TAg(),this.jba.WPf=performance.now()-ja,dg.a.Va({yCc:Ua,cseStatus:41,jba:this.jba});this.q6j();this.initialize();ac=performance.now();this.AU=[];ja=this.wrj(this.eSb,Ua,ja);this.jba.J6i=performance.now()-ac;ac=performance.now();this.K0b.TAg();this.jba.WPf=performance.now()-ac;if(ja)return this.jba.F6i=Ua.length,dg.a.Va({yCc:Ua,cseStatus:1,jba:this.jba})}return dg.a.Va({yCc:Ua,cseStatus:39,jba:this.jba})}initialize(){this.aZd=this.LIc=this.Lla=this.Pla=0;this.mO=null;this.BSb=
!1}q6j(){const A=this.eSb.getElementsByTagName("style");if(A&&0<A.length){F.ULS.sendTraceTag(507536152,0,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let ja=0;ja<A.length;ja++)this.eSb=c(this.eSb,A[ja]),A[ja]&&(A[ja].parentNode.removeChild(A[ja]),ja--)}}wrj(A,ja,Ua){A=A.childNodes;for(let ac=0;ac<A.length;ac++){if(Ua.token.sM)return!1;this.wMf(A[ac],ja)}return!0}Qhk(A){return A.replace(nf,"><")}y2a(){this.Pla++;this.Pla>this.LIc&&(this.LIc=this.Pla);this.mO=
null}dag(){this.Lla++;this.Lla>this.aZd&&(this.aZd=this.Lla);this.mO=null}Rqc(A){const ja={borders:[],fontFamily:"",cellText:"",Lte:0,wyf:!1,color:"",fontSize:11,italic:!1,backgroundColor:"",bold:!1,mD:"",rowIndex:this.Pla,colIndex:this.Lla};A.push(ja);return ja}CEc(){var A;return!(null===(A=this.mO)||void 0===A?0:A.cellText)||0===this.mO.cellText.length}sWb(A,ja){A=A.childNodes;for(let Ua=0;Ua<A.length;Ua++)this.wMf(A[Ua],ja)}k3i(A,ja){let Ua;if(A.textContent){if(this.AU.map(ac=>ac.element.tagName).some(ac=>
Ch.includes(ac))||A.nextElementSibling&&Qa.includes(A.nextElementSibling.nodeName))Ua=A.textContent;else if(Ua=A.textContent.trim(),!Ua||0===Ua.length)return;this.mO||(this.mO=this.Rqc(ja));this.mO.cellText=this.mO.cellText?`${this.mO.cellText}${Ua}`:Ua;A.parentElement?(ja=this.K0b.awf(A.parentElement))?this.mO=t(A,ja,this.mO,this.BSb,this.AU):F.ULS.sendTraceTag(507536151,0,50,"Computed style is null for parent element"):F.ULS.sendTraceTag(507536150,0,50,"Parent element is null")}}j1i(A,ja){const Ua=
A.getAttribute("href");Ua&&0<Ua.trim().length&&(this.mO||(this.mO=this.Rqc(ja)),this.mO.mD=Ua);this.xMf(A,ja)}INd(A,ja){this.CEc()||this.y2a();this.AU.push({element:A,lGa:A.style});this.sWb(A,ja);this.AU.pop();this.CEc()||this.y2a()}xMf(A,ja){this.AU.push({element:A,lGa:A.style});this.sWb(A,ja);this.AU.pop()}e3i(A,ja){const Ua=this.Lla,ac=this.Pla;this.CEc()||this.y2a();this.AU.push({element:A,lGa:A.style});this.sWb(A,ja);this.AU.pop();this.Pla=this.LIc;this.Pla===ac&&this.Lla>Ua&&this.y2a();this.Lla=
Ua}d3i(A,ja){const Ua=this.Pla;this.BSb=!0;this.AU.push({element:A,lGa:A.style});this.sWb(A,ja);this.AU.pop();this.BSb=!1;this.Pla=Ua;this.dag()}B_i(A){this.mO||(this.mO=this.Rqc(A));this.BSb?this.mO.cellText=`${this.mO.cellText}\n`:this.y2a()}K0i(A,ja){this.AU.push({element:A,lGa:A.style});this.SPd=[];this.INd(A,ja);this.AU.pop()}l1i(A,ja){var Ua=A.closest("ul, ol");if(Ua){this.SPd.push(A);this.CEc()||this.y2a();var ac=this.Lla;if("OL"===Ua.nodeName){Ua=this.Rqc(ja);Ua.cellText=`${this.SPd.length}`;
const Ec=this.K0b.awf(A);Ec?t(A,Ec,Ua,this.BSb,this.AU):F.ULS.sendTraceTag(507536149,0,50,"Computed style is null for list item element");this.dag()}this.AU.push({element:A,lGa:A.style});this.sWb(A,ja);this.AU.pop();this.Lla=ac;this.y2a()}}wMf(A,ja){switch(A.nodeName){case "#text":this.k3i(A,ja);break;case "A":this.j1i(A,ja);break;case "TR":this.e3i(A,ja);break;case "TD":case "TH":this.d3i(A,ja);break;case "BR":this.B_i(ja);break;case "UL":case "OL":this.K0i(A,ja);break;case "LI":this.l1i(A,ja);break;
case "CAPTION":A.parentElement&&"TABLE"===A.parentElement.nodeName&&this.INd(A,ja);break;default:A.nodeType===Node.ELEMENT_NODE&&(-1<Fg.indexOf(A.nodeName)?this.INd(A,ja):-1<Qa.indexOf(A.nodeName)&&this.xMf(A,ja))}}};Tf=Object(U.__decorate)([Object(ka.d)(Ha.jd),Object(U.__param)(0,Object(Ha.pe)())],Tf);Object(K.a)(Tf,"HtmlProcessor",null,[]);let Xf=class{constructor(A){this.ji=A;this.Swd()}tsk(A){A=this.ji.uTi(A);if(this.Vma.contentDocument)return this.Vma.contentDocument.body.replaceWith(A),this.Vma.contentDocument.body;
F.ULS.sendTraceTag(507529291,0,15,"iframe not loaded when append method was called");return A}TAg(){if(this.Vma.contentDocument){var A=this.Vma.contentDocument.body;A?this.ji.eO(A):F.ULS.sendTraceTag(507529290,0,15,"iframe body itself is null")}}awf(A){var ja;const Ua=null===(ja=this.Vma.contentDocument)||void 0===ja?void 0:ja.body;return(null===Ua||void 0===Ua?0:Ua.contains(A))?getComputedStyle(A):A?A.style:null}Swd(){const A=performance.now();this.Vma=document.createElement("iframe");Object.assign(this.Vma.style,
{visibility:"hidden",zIndex:"-100",position:"absolute",contain:"strict"});this.Vma.setAttribute("sandbox","allow-same-origin");this.Vma.setAttribute("data-debug-id","paste-iframe");const ja=document.getElementsByTagName("body")[0];ja?ja.appendChild(this.Vma):F.ULS.sendTraceTag(507529289,0,15,"Body not found");F.ULS.sendTraceTag(507529288,0,50,"Time taken to create iframe: "+(performance.now()-A))}};Xf=Object(U.__decorate)([Object(ka.d)(Ha.pe),Object(U.__param)(0,Object(Ha.kd)())],Xf);Object(K.a)(Xf,
"PastableIframe",null,[]);const zg=()=>me.a.instance.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),$f=()=>me.a.instance.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper");var Ng=a(842),pg=a(641),Ug;(function(A){A[A.chl=0]="applicationFeatureHelperHandler";A[A.Ahl=1]="cloudPolicySettings";A[A.Wgl=2]="alternateAuthToken"})(Ug||(Ug={}));Object(K.b)("ApplicationFeatureHelperRequestType",Ug);class Og{constructor(){this.message=null;this.httpStatusCode=
0}}Object(K.a)(Og,"HttpRequstToPromiseRejectData",null,[]);var bh=a(237),mh=a(529),Tg=a(201);class Vg{constructor(A,ja){this.Ga=A;this.vn=ja}uWa(A,ja,Ua,ac,Ec,gd,ad,Jd){ac=void 0===ac?null:ac;Ec=void 0===Ec?null:Ec;gd=void 0===gd?null:gd;ad=void 0===ad?null:ad;Jd=void 0===Jd?null:Jd;const De=Ug[Ua],Xe=De+"RequestFailure";ie.Health.instance.recordKpiUsage(Xe,Gd.b.FailureBased,"jpittsdirects",null);return new Promise((lf,mf)=>{F.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",
De);const Rf=null!=ad?ad:this.Ga.vj("ApplicationFeatureHelperRequestQueueTimeout",15E3),sg=null!=Jd?Jd:this.Ga.vj("ApplicationFeatureHelperRequestSentTimeout",3E4);this.vn.Tda(A,1,null,this.SPb(Ua,ac),gd,!1,1,wg=>{F.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",De);try{if(void 0===wg||null===wg||void 0===wg.data||null===wg.data||void 0===wg.data.responseData||null===wg.data.responseData){ie.Health.instance.recordKpiFailure(Xe,
"Invalid RequestSucceededEventArgs",!1,!0,null);const Sg=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",De);mf(this.jR(Sg,wg))}else if(wg.data.httpStatus!==bh.a.jN){ie.Health.instance.recordKpiFailure(Xe,"HttpStatusCode_"+wg.data.httpStatus.toString(),!1,!0,null);const Sg=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",
wg.data.httpStatus,De);mf(this.jR(Sg,wg))}else{void 0!==Ec&&null!==Ec&&void 0!==wg.data.responseHeaders&&null!==wg.data.responseHeaders&&Ec(wg.data.responseHeaders);var Mg=ja(wg.data.responseData);if(Mg)F.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",De),lf(Mg);else{ie.Health.instance.recordKpiFailure(Xe,"Parse Failure",!1,!0,null);const Sg=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",
De);mf(this.jR(Sg,wg))}}}catch(Sg){ie.Health.instance.recordKpiFailure(Xe,"Unexpected Failure",!1,!0,null),Mg=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",Sg,De),mf(this.jR(Mg,wg))}},wg=>{var Mg;if(wg.data){if(Mg=Tg.a.ey())try{Mg.set("useOwlOrigin",A.toLowerCase().includes("owl").toString())}catch(Sg){F.ULS.sendTraceTag(507876040,3004,50,"Failed to set useOwlOrigin")}ie.Health.instance.recordKpiFailure(Xe,"HttpStatusCode_"+wg.data.httpStatus.toString(),
!1,!0,{extendedProperties:Mg});Mg=mh.a.mJa(wg.data.responseData||"No Data");Mg=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",wg.data.httpStatus,Mg,De)}else ie.Health.instance.recordKpiFailure(Xe,"Invalid RequestFailedEventArgs",!1,!0,null),Mg=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",De);mf(this.jR(Mg,wg))},null,void 0,
void 0,Rf,sg)})}jR(A,ja){const Ua=new Og;Ua.message=A;Ua.httpStatusCode=ja&&ja.data?ja.data.httpStatus:-1;return Ua}SPb(A,ja){const Ua={};Ua["x-UserDataSignature"]=this.Ga.Xa("UserDataSignature");Ua["x-LicensingIsEnabled"]=this.Ga.la("LicensingIsEnabled").toString();Ua["x-CacheIsEnabled"]=this.Ga.la("LicensingRedisIsEnabled").toString();Ua["x-OcpsIsEnabled"]=this.Ga.la("OcpsIsEnabled").toString();Ua["x-LicensingAADIdIsEnabled"]=this.Ga.la("LicensingAadIdIsEnabled").toString();0===A&&(Ua["x-LicenseCheckOnTenantEnabled"]=
"true",Ua["x-SupportUserConsentDependentFeatures"]="true",Ua["x-AFHUserConsentGroupValue"]="0",Ua["x-UseShellServiceForUserConsentGroup"]="true",Ua["x-SMBUserLicensingEnabled"]="true",Ua["x-AFHPIPLComplianceEnabled"]=ff.a.lz(window.location.href,"wd_afhpipl")||"false",Ua["x-ConsumerLicensingSNICertIsEnabled"]=this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ConsumerLicensingSNICertIsEnabled",!1).toString(),Ua["x-MSGraphInLicensingIsEnabled"]=this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MSGraphInLicensingIsEnabled",
!1).toString());if(ja)for(const ac of ja.keys)Ua[ac]=ja.ma(ac);return Ua}}Object(K.a)(Vg,"HttpRequestToPromiseUtility",null,[]);var nh;(function(A){A[A.Rzj=0]="loki";A[A.ghl=1]="augloopACLP"})(nh||(nh={}));Object(K.b)("AlternateAuthSupportApp",nh);var wh=a(596),oh=a(44);class gh{constructor(){this.Token=null;this.ExpirationTime=0}}Object(K.a)(gh,"WacAlternateAuthToken",null,[]);class lh{constructor(A,ja){this.CXk=3E5;this.b1j=Ua=>{let ac=null;({hz:ac}=oh.d(Ua));return ac};if(void 0===A||null===A||
void 0===ja||null===ja)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Ga=A;this.Iac=new Ng.a(pg.a.lm());this.sBb=new Vg(A,ja);void 0!==wh.a.e1d&&null!==wh.a.e1d&&void 0!==wh.a.YJc&&null!==wh.a.YJc&&0<wh.a.YJc&&(A=new gh,A.Token=wh.a.e1d,A.ExpirationTime=wh.a.YJc,this.Iac.ga("loki",A))}sCi(){let A=null;this.Iac.Vg(nh[0])&&(A=this.Iac.ma(nh[0]));return void 0===A||null===A||this.CXd(A)?this.Rsi():Promise.resolve(A.Token)}CXd(A){return A.ExpirationTime-Date.now()<this.CXk}Rsi(){const A=
new Ng.a(pg.a.lm());A.ga("X-AlternateAuthApp",nh[0]);return this.sBb.uWa(this.Cma("/afhs/AlternateAuthHelperHandler.ashx",this.Ga.la("OwlOriginForAFHSIsEnabled")),this.b1j,2,A).then(ja=>{F.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",nh[0]);this.Iac.ga(nh[0],ja);return ja.Token},ja=>{ja=Object(Ae.a)(Og,ja);F.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",
ja.message,ja.httpStatusCode);return null})}Cma(A,ja){A=String.format("{0}{1}?{2}",ja?this.Ga.Xa("OwlOrigin"):this.Ga.Xa("WebServiceBase"),A,mb.AFrameworkApplication.qo);ja&&(A+="&usid="+mb.AFrameworkApplication.userSessionId);return A}}Object(K.a)(lh,"AlternateAuthHelper",null,[865]);var Sh=a(522);class ih{constructor(A,ja,Ua){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=A;this.isEnabled=ja;this.tierName=Ua}}Object(K.a)(ih,"FeatureStateChangeArgs",null,[]);var di=a(284),
Ra=a(94),Tb;(function(A){A[A.Enabled=0]="Enabled";A[A.Disabled=1]="Disabled"})(Tb||(Tb={}));Object(K.b)("FeatureState",Tb);var Dc=a(28),Yc=a(501);class Ad{constructor(A,ja,Ua,ac,Ec){Ua=void 0===Ua?null:Ua;ac=void 0===ac?null:ac;Ec=void 0===Ec?null:Ec;this.VHa=this.Sgc=this.VSe=this.KDa=this.Xhc=null;this.f1j=gd=>{(gd=oh.b(gd))?(F.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),F.ULS.sendTraceTag(50938594,3004,50,"{0}",gd)):F.ULS.sendTraceTag(50436171,
3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");return gd.Features};this.b0i=()=>{F.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.VHa.then(gd=>{this.Oyg(gd)}).catch(()=>{this.Oyg({})})};this.u7j=gd=>{try{gd&&"Date"in gd&&(this.Sgc=new Date(gd.Date),F.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.Sgc.toString()))}catch(ad){F.ULS.sendTraceTag(578863818,
3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",ad)}};this.sBb=new Vg(A,ja);this.Ga=A;this.dlh=A.vj("LicensingMaxRetryAttempts",0);this.KBb=A.la("IsO365ConsumerHost");this.mbd=A.la("IsO365CommercialHost");this.$ad=A.la("PremiumUpsellIsEnabled");this.bab=!1;this.Fcd=0;this.FFe=Ua;this.sXe=ac;this.$c=Ec;this.JDa=A.la("LicensingIsEnabled");this.ESa=A.la("OcpsIsEnabled")&&this.mbd;this.Ojd=A.la("ShowPrivacyDialog")&&!!ac;this.Tdc=A.la("IsAnonymousUser");this.Kvc=new Promise(gd=>
{gd(!1)});this.FPa=new Promise(gd=>{gd(!0)});this.UHa=new Ng.a(pg.a.lm());this.Kic=!0;this.bOe=this.bNi();this.YUb()&&!this.Tdc?(void 0!==mb.AFrameworkApplication.ra&&null!==mb.AFrameworkApplication.ra&&(this.Xhc=mb.AFrameworkApplication.ra.cL,void 0!==this.Xhc&&null!==this.Xhc&&(this.KDa=this.Xhc.Vl("WebServiceCall","ApplicationFeatureHelperService"))),this.VHa=this.Bve()):this.VHa=new Promise(gd=>{gd({})});this.VHa.catch(gd=>{gd=Object(Ae.a)(Og,gd);F.ULS.sendTraceTag(42513088,3004,10,"ApplicationFeatureHelper initialization failed, HttpStatus={0}",
gd?gd.httpStatusCode.toString():"Unknown")});this.Kic&&this.isFeatureEnabled("FreemiumUpsell",!0).then(gd=>{this.bab=gd;return null})}bNi(){const A=this.Ga.rv("AllLicensedFeatures")?this.Ga.aA("AllLicensedFeatures"):[],ja=new Sh.a;for(let Ua=0;Ua<A.length;Ua++)ja.add(A[Ua]);return ja}YUb(){return this.mbd||this.KBb}Bve(A,ja){A=void 0===A?0:A;ja=void 0===ja?!1:ja;F.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",ja);const Ua=Tg.a.ey();Ua&&(Ua.set("retryAttempt",
A.toString()),Ua.set("forceRefresh",ja.toString()),Ua.set("isO365ConsumerHost",this.KBb.toString()),Ua.set("isO365CommercialHost",this.mbd.toString()),Ua.set("isFreemiumUpsellSettingEnabled",this.$ad.toString()),Ua.set("useOwlOrigin",this.Ga.la("OwlOriginForAFHSIsEnabled").toString()));ie.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",Ua);ie.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",Gd.b.SuccessBased,"waclicensing",Ua);void 0!==this.KDa&&
null!==this.KDa&&this.KDa.start();let ac=null;ja&&(ac=new Ng.a(pg.a.lm()),ac.ga("x-LicensingForceRefresh","true"));this.VSe=new Date;return(this.JDa?this.sBb.uWa(this.Cma("/afhs/ApplicationFeatureHelperHandler.ashx",this.Ga.la("OwlOriginForAFHSIsEnabled")),this.f1j,0,ac,this.u7j,["Date"]):Promise.resolve({})).then(Ec=>{const gd={durationMs:this.SUg(),extendedProperties:Ua};gd.extendedProperties&&Ec&&(gd.extendedProperties.set("featureCount",Ra.a.count(Ec).toString()),gd.extendedProperties.set("licensingTestFeatureEnabled",
("LicensingTestFeature"in Ec).toString()),gd.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in Ec).toString()),"FreemiumUpsell"in Ec&&gd.extendedProperties.set("isFreemiumUpsellEnabled",Ec.FreemiumUpsell.toString()),this.Sgc&&gd.extendedProperties.set("fromCache",(this.Sgc<this.VSe).toString()));ie.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",gd);return Ec},Ec=>{const gd=Object.assign({},{durationMs:this.SUg()}),ad=Object(Ae.a)(Og,Ec);if(!ad)return F.ULS.sendTraceTag(51491471,
3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),ie.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,gd),new Promise((Jd,De)=>{De(Ec)});gd.extendedProperties=Ua;gd.extendedProperties&&gd.extendedProperties.set("status",ad.httpStatusCode.toString());ie.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,gd);return 408===ad.httpStatusCode&&++A<=this.dlh?
this.Bve(A):new Promise((Jd,De)=>{De(ad)})})}Cma(A,ja){A=String.format("{0}{1}",ja?this.Ga.Xa("OwlOrigin"):this.Ga.Xa("WebServiceBase"),A);ja&&(A+="?usid="+mb.AFrameworkApplication.userSessionId);this.Ga.rv("ApplicationFeatureHelperHttpCachingEnabled")&&this.Ga.la("ApplicationFeatureHelperHttpCachingEnabled")&&(ja=Ad.pzc(this.Ga))&&0<ja.length&&(this.Kic&&(ja+="ucbf"),A=new di.QueryStringBuilder(A),A.Kp("afhskey",ja),A=A.toString());return A}isFeatureEnabled(A,ja){if(!this.ESa&&!this.Ojd&&!this.JDa)return this.FPa;
F.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",A);if("ConnectedServices"===A){var Ua=this.ESa?this.FFe.fR("ControllerConnectedServicesEnabled"):this.FPa;const gd=this.Ojd?this.sXe.getSettings().then(ad=>2!==ad.WC,()=>ja):this.FPa;return Ua.then(ad=>ad?gd:this.Kvc)}if("FreemiumUpsell"===A&&(!this.$ad||!this.KBb||this.Tdc))return this.Kvc;Ua=null;Ua=this.ESa?this.FFe.isFeatureEnabled(A):this.FPa;let ac=null;ac=this.JDa?
this.kij(A,ja):this.FPa;let Ec=null;Ec=this.Ojd?this.sXe.isFeatureEnabled(A):this.FPa;return Ua.then(gd=>gd?Ec.then(ad=>ad?ac:this.Kvc):this.Kvc).then(gd=>{this.w5f(A,gd,!0);return gd},()=>{this.w5f(A,ja,!1);return ja})}w5f(A,ja,Ua){F.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",A,ja,Ua)}getFeatureTier(A,ja){if(!this.JDa)return new Promise(Ua=>{Ua(2)});F.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",
A);return this.VHa.then(Ua=>this.uAc(A,Ua,ja),()=>ja)}isFreemiumUpsellEnabled(){if(this.$ad&&this.KBb&&!this.Tdc){if(this.bab&&2!==this.Fcd||!this.bab&&1!==this.Fcd)F.ULS.sendTraceTag(509728161,3004,20,"ApplicationFeatureHelper_IsFreemiumUpsellEnabled: isFreemiumUpsellFeatureEnabled={0}",this.bab.toString()),this.Fcd=this.bab?2:1;return this.bab}return!1}kqj(){return Object(Yc.g)()&&this.KBb&&this.Tdc}launchUpsellExperience(A,ja){ja=void 0===ja?null:ja;F.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",
A));var Ua=Tg.a.ey();Ua&&(Ua.set("experienceId",A),ja&&Ua.set("campaignId",ja));ie.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",Gd.b.SuccessBased,"waclicensing",Ua);(Ua=me.a.instance.mo("Common.IInProductMessagingUIManager"))?Ua.i3f(A,this.b0i,ja):(F.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),ie.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.$c.Xj(Dc.a.bxc,2,{["experience"]:A}))}S4a(A,ja){if(!this.JDa)return null;
if(!A||!ja)return F.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;const Ua=Bd.a.create().toString();this.UHa.Vg(A)||this.UHa.ga(A,new Ng.a(pg.a.lm()));this.UHa.ma(A).add(Ua,ja);F.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",Ua,A));return Ua}nfe(A,ja){this.JDa&&(A&&this.UHa.Vg(A)?ja&&Bd.a.isValid(ja)?this.UHa.ma(A).Vg(ja)?
(F.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",ja,A)),this.UHa.ma(A).remove(ja)):F.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",ja,A)):F.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",
ja,A)):F.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",A)))}uAc(A,ja,Ua){return this.Kic?A in ja?ja[A].LicenseTier:Ua:A in ja?this.E1j(ja[A],Ua):Ua}E1j(A,ja){switch(A.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return ja}}Oyg(A){F.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const ja=this.Bve(0,
!0);ja.then(Ua=>{this.VHa=ja;Ra.a.count(Ua)>Ra.a.count(A)?ie.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):ie.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(const ac of this.UHa.keys)if(ac in Ua){const Ec=this.uAc(ac,Ua,0);ac in A?this.uAc(ac,A,0)!==Ec&&this.h5d(ac,!0,Ec):this.h5d(ac,!0,Ec)}else ac in A&&this.h5d(ac,!1,this.uAc(ac,A,0))}).catch(Ua=>{ie.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",
!1,!0,null);F.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(Ua))})}h5d(A,ja,Ua){F.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",A,ja,Ua);ja=new ih(A,ja,Ua);Ua=this.UHa.ma(A);for(const ac of Ua)try{ac.value(ja)}catch(Ec){F.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",
A,ac.key,Ec.message))}}Hj(A,ja){if(this.JDa){const Ua=this.bOe.contains(A);let ac=!0,Ec="",gd=!1;return this.VHa.then(ad=>{A in ad?(ad=ad[A],Ec=Tb[ad.FeatureState],ac=1!==ad.FeatureState):ac=!Ua;this.N5f(A,Ua,Ec,gd,ja,ac);return ac},()=>{gd=!0;Ua&&(ac=ja);this.N5f(A,Ua,Ec,gd,ja,ac);return ac})}return this.FPa}N5f(A,ja,Ua,ac,Ec,gd){F.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",A,ja,
ac,Ua,Ec,gd)}kij(A,ja){if(this.Kic)return this.Hj(A,ja);if(this.JDa){if(this.bOe.contains(A))return this.VHa.then(Ua=>A in Ua,()=>ja);F.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",A)}return this.FPa}SUg(){if(void 0!==this.KDa&&null!==this.KDa){const A=this.KDa.ii;this.KDa.stop();return A}return null}static pzc(A){try{if(Da.a.xTk){const ja=A.Xa("UserDataSignature").split(".");if(1<ja.length){const Ua=
window.self.atob(ja[1]),ac=JSON.parse(Ua).LocalStorageKey;if(void 0!==ac&&null!==ac&&0<ac.length)return ac}}}catch(ja){F.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",ja.toString())}return null}}Object(K.a)(Ad,"ApplicationFeatureHelper",null,[866]);var he=a(208);class re{constructor(A,ja){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=A.PolicySettings;A=new Date;A.setMinutes(A.getMinutes()+ja);this.ExpirationTime=A.getTime()}}Object(K.a)(re,"CloudPolicySettingsCacheData",
null,[]);var Me=a(956),Ve=a(525),Hf=a(290);class Qf{static MSg(){return mb.AFrameworkApplication.fa.la("SideCarIsEnabled")?Qf.QUc&&Qf.yTd?new Promise(A=>{A(!0)}):new Promise((A,ja)=>{Qf.QUc=Hf.a.create(mb.AFrameworkApplication.fa.Xa("SideCarUrl"));Ve.a.sva(Qf.QUc);Qf.QUc.Eka((Ua,ac)=>{(Qf.yTd=ac.succeeded)?A(ac.succeeded):ja(ac.succeeded)})}):new Promise(A=>{A(!1)})}}Qf.yTd=!1;Qf.QUc=null;Object(K.a)(Qf,"SideCarLoader",null,[]);class ia{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=
null}}Object(K.a)(ia,"CloudPolicySettingsData",null,[]);class Xb{constructor(A,ja){this.J6c=0;this.gpc=null;this.g1j=Ua=>{let ac=null;({hz:ac}=oh.d(Ua));Ua=!!ac;F.ULS.sendTraceTag(50622687,3004,Ua?50:10,"ParseCloudPolicySettingsResponse: Success={0}",Ua);return ac};this.A7j=Ua=>{try{if(void 0!==Ua&&null!==Ua&&"CheckIn-Interval"in Ua){const ac=parseInt(Ua["CheckIn-Interval"]);void 0!==ac&&null!==ac&&0<ac&&(this.J6c=ac)}}catch(ac){F.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",
ac)}};this.sBb=new Vg(A,ja);this.Ga=A;ja=A.Xa("HostAuthType");this.ESa=A.la("OcpsIsEnabled")&&A.la("IsO365CommercialHost")&&!(void 0===ja||null===ja)&&"aad"===ja.toLowerCase();this.kQe=oh.b(A.Xa("OcpsDefaultSettings")||"{}");this.pCb=this.pzc();ja=this.Ga.rv("ServicesControlsMicrosoftControllerServicesList")?this.Ga.aA("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.E7c=new Sh.a;for(let Ua=0;Ua<ja.length;Ua++)this.E7c.add(ja[Ua]);this.ESa&&!A.la("IsAnonymousUser")&&A.la("SideCarIsEnabled")?
this.gpc=this.U_k():this.gpc=this.LBa(this.ESa,this.g1j);this.gpc.then(()=>null).catch(Ua=>{Ua=Object(Ae.a)(Og,Ua);F.ULS.sendTraceTag(50622685,3004,10,"CloudPolicySettingsHelper initialization failed, HttpStatus={0}",Ua?Ua.httpStatusCode.toString():"Unknown")})}fR(A,ja,Ua){ja=void 0===ja?!0:ja;Ua=void 0===Ua?!0:Ua;var ac;if(!this.ESa){const De=this;return new Promise(Xe=>{Xe(De.qQb(A))})}const Ec=this,gd=this,ad=this.gpc.then(De=>{try{let Xe=null;De.PolicySettings&&"unknown"in De.PolicySettings&&
(Xe=De.PolicySettings.unknown);if(Xe){if(A in Xe&&void 0!==Xe[A]&&null!==Xe[A])return new Promise(mf=>{mf("0"!==Xe[A])});const lf=A.toLowerCase();if(lf in Xe&&void 0!==Xe[lf]&&null!==Xe[lf])return new Promise(mf=>{mf("0"!==Xe[lf])});if(Ua)return F.ULS.sendTraceTag(51512667,3004,50,"Policy"+A+" not found, using default"),new Promise(mf=>{mf(Ec.qQb(A))});F.ULS.sendTraceTag(508395746,3004,50,"Policy"+A+" not found, returning PolicyNotConfigured error");return new Promise((mf,Rf)=>{Rf("PolicyNotConfigured")})}return new Promise(lf=>
{lf(Ec.qQb(A))})}catch(Xe){return F.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+A+" policy value. Error Message: {0}",Xe.message),Ec.handleError(Xe.toString(),ja,Ec.qQb(A))}},De=>gd.handleError(De,ja,gd.qQb(A))),Jd=null===(ac=mb.AFrameworkApplication.fa)||void 0===ac?void 0:ac.la("FixPolicyNotConfiguredUnhandledPromiseRejection");ac=De=>{F.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",A,De);return Jd?De:null};if(Jd)return ad.then(ac);
ad.then(ac);return ad}isFeatureEnabled(A,ja){return this.mij(A,void 0===ja?!0:ja)}mij(A,ja){ja=void 0===ja?!0:ja;var Ua;let ac=new Promise(ad=>{ad(!0)}),Ec="";"mso_sendASmile"===A?Ec="Enabled":"Survey"===A||"FloodgateSurvey"===A?Ec="SurveyEnabled":this.E7c.contains(A)&&(Ec="ControllerConnectedServicesEnabled");""!==Ec&&(ac=this.fR(Ec,ja));ja=ad=>{F.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",A,ad,Ec);return gd?
ad:null};const gd=null===(Ua=mb.AFrameworkApplication.fa)||void 0===Ua?void 0:Ua.la("FixPolicyNotConfiguredUnhandledPromiseRejection");if(gd)return ac.then(ja);ac.then(ja);return ac}handleError(A,ja,Ua){return ja?new Promise(ac=>{ac(Ua)}):new Promise((ac,Ec)=>{Ec(A)})}LBa(A,ja){if(!A)return Promise.resolve(new ia);let Ua=!1,ac=null;(A=Tg.a.ey())&&A.set("useOwlOrigin",this.Ga.la("OwlOriginForAFHSIsEnabled").toString());ie.Health.instance.recordKpiUsage("GetCloudPolicySettings",Gd.b.SuccessBased,"jpittsdirects",
A);let Ec=this.twd("GetCloudPolicySettings");return(new Promise((gd,ad)=>{if(void 0!==this.pCb&&null!==this.pCb&&0<this.pCb.length){const Jd=this.G_k();if(void 0!==Jd&&null!==Jd){Ua=!0;gd(Jd);return}}this.sBb.uWa(this.Cma("/afhs/CloudPolicySettings.ashx",this.Ga.la("OwlOriginForAFHSIsEnabled")),ja,1,null,this.A7j,["CheckIn-Interval"],this.Ga.vj("CloudPolicySettingsRequestQueueTimeout",15E3),this.Ga.vj("CloudPolicySettingsRequestSentTimeout",3E4)).then(Jd=>{F.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");
this.w0k(Jd);gd(Jd);return Jd},Jd=>{ad(Jd);return null})})).then(gd=>{({stopwatch:Ec,returnValue:ac}=this.VYc(Ec));var ad=Tg.a.ey();ad&&(ad.set("FromCache",Ua.toString()),ad.set("useOwlOrigin",this.Ga.la("OwlOriginForAFHSIsEnabled").toString()));ad=Object.assign({},{durationMs:ac,extendedProperties:ad});ie.Health.instance.recordKpiSuccess("GetCloudPolicySettings",ad);return gd})}U_k(){return Qf.MSg().then(()=>{F.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");
return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}Cma(A,ja){A=String.format("{0}{1}",ja?this.Ga.Xa("OwlOrigin"):this.Ga.Xa("WebServiceBase"),A);ja&&(A+="?usid="+mb.AFrameworkApplication.userSessionId);return A}qQb(A){return A in this.kQe?"0"!==this.kQe[A]:!0}G_k(){try{const A=Me.a.instance.getItem(this.pCb);if(void 0===A||null===A)return F.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;F.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",
A);const ja=JSON.parse(A);if(void 0===ja||null===ja)return F.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===ja.ExpirationTime||null===ja.ExpirationTime)return F.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(ja.ExpirationTime)).getTime()<Date.now())return F.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),
null;const Ua=new ia;Ua.PolicySettings=ja.PolicySettings;Ua.ControllerConnectedServicesFeatureNames=new he.a;this.Ga.rv("ServicesControlsMicrosoftControllerServicesList")&&this.Ga.aA("ServicesControlsMicrosoftControllerServicesList");for(const ac of this.E7c)Ua.ControllerConnectedServicesFeatureNames.add(ac);F.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return Ua}catch(A){return F.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",
A.toString()),null}}w0k(A){try{if(void 0===A||null===A||void 0===A.PolicySettings||null===A.PolicySettings)F.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.J6c)F.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{const ja=new re(A,this.J6c),Ua=JSON.stringify(ja);F.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",Ua);Me.a.instance.setItem(this.pCb,
Ua);F.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(ja){F.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",ja.toString())}}pzc(){const A=Ad.pzc(this.Ga);return A&&0<A.length?"OCPS"+A:null}twd(A){const ja=me.a.instance.mo("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==ja&&null!==ja?ja.vi("WebServiceCall",A):null}VYc(A){if(void 0!==A&&null!==A){const ja=A.ii;A.stop();return{returnValue:ja,
stopwatch:null}}return{returnValue:null,stopwatch:A}}}Object(K.a)(Xb,"CloudPolicySettingsHelper",null,[863]);class Vc{constructor(){this.Cnf=this.B4g=this.WC=0;this.Dnf=this.C4g=this.jWa="";this.hid=this.$qa=2}clone(){const A=new Vc;A.WC=this.WC;A.B4g=this.B4g;A.Cnf=this.Cnf;A.jWa=this.jWa;A.C4g=this.C4g;A.Dnf=this.Dnf;A.$qa=this.$qa;A.hid=this.src;return A}get src(){return this.hid}serialize(A){A=void 0===A?null:A;const ja={};if(!A||A.contains(Vc.N2a))ja[Vc.N2a]=this.WC;if(!A||A.contains(Vc.DZb))ja[Vc.DZb]=
this.jWa;if(!A||A.contains(Vc.EZb))ja[Vc.EZb]=this.$qa;return JSON.stringify(ja)}static create(A,ja){ja=void 0===ja?null:ja;const Ua=new Vc;Ua.hid=A;void 0!==ja&&null!==ja&&(Vc.N2a in ja&&(Ua.WC=ja[Vc.N2a]),Vc.DZb in ja&&(Ua.jWa=ja[Vc.DZb]),Vc.EZb in ja&&(Ua.$qa=ja[Vc.EZb]));return Ua}static deserialize(A,ja){try{const Ua=JSON.parse(A);if(void 0!==Ua&&null!==Ua)return Vc.create(ja,Ua);F.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",A);throw Error.argument("settingsData");
}catch(Ua){throw F.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",Ua.toString()),Ua;}}}Vc.N2a="CCS";Vc.DZb="CCSTime";Vc.EZb="OfficePrivacyRoamedNoticeShown";Object(K.a)(Vc,"UserPrivacySettings",null,[]);var ud=a(147);class xe{constructor(A,ja){if(void 0===A||null===A||void 0===ja||null===ja)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Ga=A;this.vn=ja;this.shd=this.Ck=null}Cma(A){var ja=String.format("{0}RoamingServiceHandler.ashx?action=",
this.Ga.appSettings.RoamingServiceHandlerWebServiceBase||"");ja=new Sys.StringBuilder(ja);ja.append(A);ja.append("&");ja.append(mb.AFrameworkApplication.qo);return ja.toString()}executeRequest(A,ja,Ua,ac){return this.vn.$Ta(A,ja,void 0===ac?null:ac,null,Ua,"33",!1,null,6E4)}saveSettings(A){return new Promise((ja,Ua)=>{try{if(void 0===this.Ck||null===this.Ck||void 0===A||null===A)F.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),Ua("Can't determine setting changes to save");
else{var ac=this.Ck.WC!==A.WC;if(2===this.Ck.src&&ac)this.Zsk(A),ja(!0);else{var Ec=this.qxk(A);if(void 0===Ec||null===Ec||!Ec.length)F.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),Ua("No changes to save");else if(1===this.Ck.src)ja(this.M_g(Ec));else if(0===this.Ck.src){F.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",Ec);const gd=this.executeRequest(this.Cma("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",
Ec);gd.continueWith(()=>{if(gd.Sn||gd.om)F.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),ja(!1);else{var ad=gd.result;void 0!==ad.$n&&null!==ad.$n&&void 0!==ad.$n.data&&null!==ad.$n.data&&ad.$n.data.httpStatus===bh.a.jN?(F.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),ja(!0)):(F.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),ja(!1))}})}}}}catch(gd){F.ULS.sendTraceTag(50860930,
3004,10,"SaveUserPrivacySettings: Exception = {0}",gd.toString()),ja(!1)}})}qxk(A){if(void 0===this.Ck||null===this.Ck||void 0===A||null===A)throw Error.invalidOperation("User Privacy settings have not been initialized");const ja=new he.a;0===A.src?(this.Ck.WC!==A.WC&&(ja.add(Vc.N2a),ja.add(Vc.DZb)),this.Ck.$qa!==A.$qa&&ja.add(Vc.EZb)):1===A.src&&this.Ck.WC!==A.WC&&ja.add(Vc.N2a);return ja.count?A.serialize(ja):(F.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),
null)}getSettings(){if(!this.shd){const A=this;this.shd=new Promise(ja=>{try{A.Ck?ja(A.Ck.clone()):A.O_k().then(Ua=>{A.Ck=Ua;ja(A.Ck.clone());return null},()=>{A.M_k().then(Ua=>{A.Ck=Ua;ja(A.Ck.clone());return null},()=>{A.N_k().then(Ua=>{A.Ck=Ua;ja(A.Ck.clone());return null},()=>{F.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");A.Ck=new Vc;ja(A.Ck.clone());return null});return null});return null})}catch(Ua){F.ULS.sendTraceTag(50860932,3004,
10,"UserPrivacySettings GetSettings: Exception = {0}",Ua.toString()),A.Ck=new Vc,ja(A.Ck.clone())}})}return this.shd}O_k(){return new Promise((A,ja)=>{try{const ac=-1!==window.location.href.indexOf("&wd_pn=2");if(this.Ga.la("PrivacyDialogShouldCheckRoaming")||ac){var Ua=this.executeRequest(this.Cma("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");Ua.continueWith(()=>{try{if(Ua.Sn||Ua.om)F.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");
else{const Ec=Ua.result;if(Ec&&Ec.$n&&Ec.$n.data)if(Ec.$n.data.httpStatus!==bh.a.jN)F.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",Ec.$n.data.httpStatus);else{if(Ec.$n.data.responseData){A(xe.parse(Ec.$n.data.responseData,0));F.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",Ec.$n.data.responseData);return}F.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else F.ULS.sendTraceTag(50860935,
3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");ja("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(Ec){F.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",Ec.toString()),ja("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else F.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),ja("Roaming should not be used")}catch(ac){F.ULS.sendTraceTag(50860939,
3004,10,"TryGetSettingsFromRoaming Exception = {0}",ac.toString()),ja("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}M_k(){return new Promise((A,ja)=>{try{const Ua=ud.a.get("WacUPToggleState");let ac=null;void 0!==Ua&&null!==Ua&&0<Ua.length&&(ac=decodeURIComponent(Ua));if(void 0!==ac&&null!==ac&&0<ac.length){const Ec=xe.parse(ac,1);F.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",Ec.toString());A(Ec)}else{const Ec=Vc.create(1),
gd=new he.a;gd.add(Vc.N2a);const ad=Ec.serialize(gd);this.M_g(ad)?(F.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",ad),A(Ec)):(F.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",ad),ja("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(Ua){F.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",
Ua.toString()),ja("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}N_k(){return new Promise(A=>{try{var ja=-1!==window.location.href.indexOf("&wdccsoff=1");const Ua=Vc.create(2);ja?(Ua.WC=2,mb.AFrameworkApplication.Xlf(),F.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",Ua.toString())):(Ua.WC=1,F.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",Ua.toString()));A(Ua)}catch(Ua){F.ULS.sendTraceTag(50967431,
3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",Ua.toString()),ja=Vc.create(2),ja.WC=1,A(ja)}})}Zsk(A){F.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===A.WC?mb.AFrameworkApplication.Xlf():mb.AFrameworkApplication.Ngi();F.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",A)}M_g(A){try{F.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",A);const ja=
this.Ga.Xa("PrivacyCookieDomain")||"";if(!ja||!ja.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");F.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",A);return ud.a.rne("WacUPToggleState",A,ud.a.Raa,"/",ja)}catch(ja){return F.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",ja.toString()),!1}}isFeatureEnabled(A){return this.getSettings().then(ja=>{const Ua=this.Ga.rv("ServicesControlsMicrosoftControllerServicesList")?
this.Ga.aA("ServicesControlsMicrosoftControllerServicesList"):[],ac=new Sh.a;for(let Ec=0;Ec<Ua.length;Ec++)ac.add(Ua[Ec]);return ac.contains(A)?2!==ja.WC:!0},()=>{F.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",A);return!0})}static parse(A,ja){try{return F.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",A,ja),Vc.deserialize(A,ja)}catch(Ua){throw F.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",Ua.toString()),
Ua;}}}Object(K.a)(xe,"UserPrivacySettingsHelper",null,[864]);var fe=a(278);let Te;const Bf=()=>{Te||(Te=new Xb(mb.AFrameworkApplication.fa,mb.AFrameworkApplication.$i));return Te};let Cf;const Lf=()=>{Cf||(Cf=new xe(mb.AFrameworkApplication.fa,mb.AFrameworkApplication.$i));return Cf};let df;const T=()=>{df||(df=new Ad(mb.AFrameworkApplication.fa,mb.AFrameworkApplication.$i,Bf(),Lf(),mb.AFrameworkApplication.jh));return df};class Ga{constructor(){this.Mh=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}ao(A){this.Mh=
A;this.Mh.register(863,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").hi().mi(()=>mb.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowEarlyAFHCHeck",!1)?Bf():new Xb(mb.AFrameworkApplication.fa,mb.AFrameworkApplication.$i));this.Mh.register(864,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").hi().mi(()=>mb.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowEarlyAFHCHeck",!1)?Lf():new xe(mb.AFrameworkApplication.fa,
mb.AFrameworkApplication.$i));this.Mh.register(865,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").hi().mi(()=>new lh(mb.AFrameworkApplication.fa,mb.AFrameworkApplication.$i));this.Mh.register(866,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").hi().mi(()=>mb.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowEarlyAFHCHeck",!1)?($f(),zg(),T()):new Ad(mb.AFrameworkApplication.fa,mb.AFrameworkApplication.$i,$f(),zg(),mb.AFrameworkApplication.jh))}init(){mb.AFrameworkApplication.fa.ty(()=>
{const A=me.a.instance.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");mb.AFrameworkApplication.fa.la("LicensingIsEnabled")&&(A.isFeatureEnabled("LicensingTestFeature",!1).then(ja=>{F.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",ja,mb.AFrameworkApplication.fa.Xa("IsAnonymousUser"));return null}),A.getFeatureTier("LicensingTestFeature",0).then(ja=>{F.ULS.sendTraceTag(42804872,
3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",ja,mb.AFrameworkApplication.fa.Xa("IsAnonymousUser"));return null}));me.a.instance.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.XUk()})}dispose(){}XUk(){try{mb.AFrameworkApplication.fa.la("SideCarIsEnabled")&&Qf.MSg().then(A=>{F.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",A);return A})}catch(A){}}static main(){fe.a.instance.Lo(new Ga)}}
Object(K.a)(Ga,"ApplicationFeatureHelperPackage",null,[12,13]);var hb=a(420),jc=a(361),Zc=a(360);const kd=A=>{A?(A.isAsyncCopy=!1,A.isSelectionAllowed=!1,A.isFromCache=!1,A.plainTextPayloadSize=0,A.shadowWorkbookPayloadSize=0,A.htmlPayloadSize=0,A.htmlSizeExceedsLimit=!1,A.clientSideCopyTime=0,A.encounteredDeploymentErrors=!1,A.shadowWorkbookSizeExceedsLimit=!1,A.originalSourceRangesCountExceedsLimit=!1,A.copyTotalSizeExceedsLimit=!1):F.ULS.sendTraceTag(537167826,0,10,"CommonCopyPasteUtils.InitializeCopyContext: copyContext is null.")},
qd=(A,ja,Ua,ac,Ec)=>{const gd=A.Stopwatch,ad={};ad.a=Ec;ad.e=gd.id;ad.c="RearrangeRowColumn";ad.b="mouse";ad.d=A.OperationId.toString();ad.f=Ua.toString();ad.g=ac.toString();ad.h=ja.toString();ad.i=A.DragDropIsShiftKeyDown;ad.j=!0;ad.o=gd.ii;ad.q=!1;ad.r=A.CopyPasteTargetType.toString();ad.s=A.EncounteredDeploymentErrors;return ad};class ae{constructor(A,ja){this.kzi=()=>{const Ua={};Ua.SourceItem=this.toString();return Ua};this.sessionStateId=A;this.sessionId=ja;this.toJSON=this.kzi}ZEc(A){return A?
this.sessionStateId===A.sessionStateId&&this.sessionId===A.sessionId:!1}isFromCurrentSession(A){return this.sessionId===A.ua.UserSessionId}}Object(K.a)(ae,"SourceItem",null,[]);class ne extends ae{constructor(A,ja,Ua,ac,Ec){super(Ua,ac);this.activeFloatingObjectControlId=A;this.sheetName=ja;this.type=Ec}isEqual(A){return A&&Object.getType(A)===ne?this.ZEc(A)&&this.activeFloatingObjectControlId===A.activeFloatingObjectControlId&&this.sheetName===A.sheetName:!1}toString(){return this.type.toString()}}
Object(K.a)(ne,"ArtSourceItem",ae,[]);var Pd;(function(A){A[A.valid=0]="valid";A[A.notPairwiseDisjoint=1]="notPairwiseDisjoint";A[A.cutNotSupportedInDiscontinuousSelection=2]="cutNotSupportedInDiscontinuousSelection";A[A.notValidForm=3]="notValidForm";A[A.temporarilyBlockedCopy=4]="temporarilyBlockedCopy"})(Pd||(Pd={}));Object(K.b)("CopySourceValidationOptions",Pd);class Vd extends ae{constructor(A,ja){super(A,ja)}isEqual(A){return this.ZEc(A)}}Object(K.a)(Vd,"NonGridSourceItem",ae,[]);class Je extends ae{constructor(A,
ja,Ua,ac,Ec){super(ac,Ec);F.ULS.shipAssertTag(537167645,0,!!ja&&0<ja.length,"RangeSourceItem.ctor: ranges should not be null or empty");this.$=A;this.ranges=ja;this.sheetName=Ua}isEqual(A){return A&&Object.getType(A)===Je?this.ZEc(A)&&Sa.W(this.ranges,A.ranges)&&this.sheetName===A.sheetName:!1}toString(){return Sa.j(this.ranges,",",this.$,!1)}}Object(K.a)(Je,"RangeSourceItem",ae,[]);const Ge=A=>!!A&&Object.getType(A)===Je,sf=A=>!!A&&Object.getType(A)===Vd;class Mf{}Mf.n8k="PasteError_FailedToReadFromClipboard_UserHashMismatchError";
Object(K.a)(Mf,"ExpectedErrorNames",null,[]);var Df=a(915);const Of=A=>A.clipboardItems&&(A=A.clipboardItems.getItem(Df.a.Rkj))&&"1"===A?!0:!1,ig=A=>Of(A)&&!(void 0===A.clipboardItems||null===A.clipboardItems)&&!!A.clipboardItems.getItem(Df.a.png)&&!A.clipboardItems.getItem(Df.a.plainText),Ag=A=>A.clipboardItems&&(A=A.clipboardItems.getItem(Df.a.Ofj))&&"1"===A?!0:!1,ng=A=>A&&(A=A.getCachedMetadata(),null===A||void 0===A?0:A.lastCopy)?A.lastCopy:null;class xg{constructor(A,ja,Ua,ac,Ec){this.$=A;this.zoom=
Ec;this.originalDestinations=ja;this.wvc=Ua;this.ldh=ac;this.Cnh=this.originalDestinations;this.mhh=this.wvc;this.$kh="PasteRecoveryUI"}get zoomManager(){return this.zoom.zoomManager}get QBh(){return this.ldh}get u3f(){return this.$kh}get $ck(){return this.Cnh}get qvf(){return this.mhh}HIa(){return xg.$1j}QHi(){return this.wvc&&1===this.wvc.length?this.RHi(this.wvc[0]):null}GId(){return"PasteRecoveryUI-Floatie"}RHi(A){var ja=za.f(this.$);const Ua=ja.Pg.ro(A);var ac=ja.ml(A,Ua);ja=ja.rtl;if(!ac)return null;
A=za.f(this.$).Zk(Ua);const Ec=A.vr;if(!Ec.yi(ac))return null;ac=Ec.pk(ac);const gd=ac.topLeft.y;var ad=ac.bottomRight.y;const Jd=ja?ac.bottomRight.x:ac.topLeft.x;ac=ja?ac.topLeft.x:ac.bottomRight.x;var De=new ic.a(ac+(ja?-81:81),ad+38+6);if(Ec.Fua(De))return this.Zjb(A,Ec,Ua,ac,ad,ja?12:-3,66);De=new ic.a(ac+(ja?-81:81),ad);if(Ec.Fua(De))return this.Zjb(A,Ec,Ua,ac,ad,ja?20:3,22);De=new ic.a(ac,ad+38+6);if(Ec.Fua(De))return this.Zjb(A,Ec,Ua,ac,ad,-81+(ja?18:0),66);ac=new ic.a(Jd+(ja?81:-81),ad);if(Ec.Fua(ac))return this.Zjb(A,
Ec,Ua,Jd,ad,-81+(ja?12:-6),22);ad=new ic.a(Jd,gd-38-6);return Ec.Fua(ad)?this.Zjb(A,Ec,Ua,Jd,gd,ja?15:0,16):this.Zjb(A,Ec,Ua,ja?Ec.topLeft.x:Ec.bottomRight.x,Ec.bottomRight.y,-81+(ja?15:-6),22)}Zjb(A,ja,Ua,ac,Ec,gd,ad){var Jd=za.f(this.$);const De=Jd.rtl;A=Sys.UI.DomElement.getLocation(A.domElement);ac=new Sys.UI.Point(ac+(De?0:A.x)-ja.topLeft.x,Ec+A.y-ja.topLeft.y);De&&(Jd=Jd.view.visibleArea,ac.x=Jd.bottomRight.x-Jd.topLeft.x-ac.x,2===Ua||4===Ua)&&(ac.x+=ja.bottomRight.x);ac=this.zoomManager.Rfa(ac);
return new Sys.UI.Point(ac.x+gd,ac.y+ad)}}xg.$1j=["PasteRecoveryUI"];Object(K.a)(xg,"PasteRecoveryUI",null,[906]);var Pf=a(643);class ca{}ca.Ksh="ActiveSelection";ca.shadowWorkbook="ShadowWorkbook";ca.f$g="GVML";ca.plainText="PlainText";ca.html="Html";ca.KIh="Bitmap";Object(K.a)(ca,"PayloadType",null,[]);class cb{}cb.ROk="Slice6";Object(K.a)(cb,"SliceName",null,[]);class tc{}tc.qHj="NotCalled";tc.success="Success";tc.failed="Failed";Object(K.a)(tc,"SucceededPopulatingSystemClipboardOptions",null,
[]);var Kc=a(317);const Xd=(A,ja)=>A?ja&&ja.ua?A.sessionId!==ja.ua.UserSessionId:(F.ULS.shipAssertTag(537166209,0,!1,"ewaControl shouldn't be null"),!1):(F.ULS.shipAssertTag(537166210,0,!1,"copyContext shouldn't be null"),!1),qe=A=>{switch(A){case 0:return"None";case 2:return"Art";case 1:return"Range";default:return"Unknown"}},rf=A=>{if(!A)return"null";const ja=[];for(const Ua of A.get())ja.push(`${Ua.clipboardDataFormat}(${Ua.data.length})`);ja.sort();return ja.join(",")};var Af;(function(A){A[A.valid=
0]="valid";A[A.destinationRangesIsEmpty=1]="destinationRangesIsEmpty";A[A.discontinuousSelectionNotSupportPasteFromExternal=2]="discontinuousSelectionNotSupportPasteFromExternal";A[A.discontinuousSelectionNotSupportPasteCrossSession=3]="discontinuousSelectionNotSupportPasteCrossSession";A[A.multipleSourcesAndMultipleDestinationsAreNotSupported=4]="multipleSourcesAndMultipleDestinationsAreNotSupported";A[A.multipleDestinationsAreNotMultiplyOfSourceRange=5]="multipleDestinationsAreNotMultiplyOfSourceRange";
A[A.sourceAndDestinationAreOverlapping=6]="sourceAndDestinationAreOverlapping";A[A.copySourceNotValid=7]="copySourceNotValid";A[A.cutNotSupportedInDiscontinuousSelection=8]="cutNotSupportedInDiscontinuousSelection";A[A.pasteLinkNotSupportMultipleDestination=9]="pasteLinkNotSupportMultipleDestination";A[A.temporarilyBlockedPaste=10]="temporarilyBlockedPaste";A[A.unknown=100]="unknown"})(Af||(Af={}));Object(K.b)("PasteValidationOptions",Af);var gg=a(239),mg=a(141),og=a(140),ph=a(659),Yg=a(106);class Qh extends Sys.EventArgs{constructor(A,
ja,Ua){super();this.command=A;this.destinationRange=ja;this.sourceRange=Ua}}Object(K.a)(Qh,"PasteCSERenderedEventArgs",Sys.EventArgs,[]);var Lh=a(138);class Xh extends xg{constructor(A,ja,Ua,ac,Ec){super(A,ja,Ua,ac,Ec);this.Stj="DragRecoveryUI"}get u3f(){return this.Stj}HIa(){return Xh.kei}GId(){return"DragRecoveryUI-Floatie"}}Xh.kei=["DragRecoveryUI"];Object(K.a)(Xh,"DragFillRecoveryUI",xg,[]);var xh=a(751),qh=a(421);class Zh extends qh.a{constructor(A,ja,Ua){super(A);this.Bh=0;this.initializeAndShow(Ba.a.instance.ia(1060),
ja,Ua)}get ki(){return"CopyPasteShortcutReactDialog"}}Object(K.a)(Zh,"CopyPasteShortcutReactDialog",qh.a,[]);var $h=a(422);class hh{constructor(A){this.SJ=null;this.NVa=ja=>{this.SJ(1===ja?hh.CJb:xh.a[ja],!1);hh.Gha=!1};this.$=A}showDialog(A,ja,Ua,ac){this.SJ=ac;hh.MUb=Da.a.isMac||Da.a.Un;this.SJ||(this.SJ=()=>{});hh.Gha?ac(hh.BJb,!1):(hh.Gha=!0,ja={},A?(ja.forwardElementText=Ba.a.instance.ia(1061),ja.cutText=hh.MUb?Ba.a.instance.ia(1050):Ba.a.instance.ia(1062),ja.copyText=hh.MUb?Ba.a.instance.ia(1051):
Ba.a.instance.ia(1063),ja.pasteText=hh.MUb?Ba.a.instance.ia(1052):Ba.a.instance.ia(1064),ja.pasteTextOnly=hh.MUb?Ba.a.instance.ia(1055):Ba.a.instance.ia(1065)):(ja.forwardElementText=Ba.a.instance.ia(1066),ja.cutText=Ba.a.instance.ia(1067)),new Zh(this.$,this.NVa,{[$h.a.fy]:hh.id,["bodyControls"]:ja}))}}hh.Gha=!1;hh.MUb=!1;hh.BJb="notOpened";hh.CJb="ok";hh.id="CopyPasteShortcutDialog";Object(K.a)(hh,"CopyPasteShortcutDialog",null,[905]);class Gh extends qh.a{constructor(A,ja,Ua){super(A);this.Bh=
0;this.Yh(1,Ba.a.instance.ia(1054));this.mia(1);this.initializeAndShow(Ba.a.instance.ia(1046),ja,Ua)}get ki(){return"CopyPasteInstallReactDialog"}}Object(K.a)(Gh,"CopyPasteInstallReactDialog",qh.a,[]);class Mh{constructor(A){this.SJ=null;this.NVa=ja=>{1===ja?(F.ULS.sendTraceTag(508359137,0,50,"User clicked the install button"),this.T0h(),this.L4j(),this.SJ(Mh.CJb,!0)):(F.ULS.sendTraceTag(508359136,0,50,"User clicked the cancel button"),this.SJ(xh.a[ja],!1));Mh.Gha=!1};this.$=A}showDialog(A,ja,Ua,
ac){this.SJ=ac=void 0===ac?()=>{}:ac;ja=Da.a.isMac||Da.a.Un;Mh.Gha?ac(Mh.BJb,!1):(Mh.Gha=!0,ac={},A&&(ac.extensionStartText=ac.extensionStartText=Da.a.uGc?Ba.a.instance.ia(1048):Ba.a.instance.ia(1047),ac.extensionLink=null,ac.extensionEndText=null,ac.shortcutsMessageText=Ba.a.instance.ia(1049),ac.cutText=ja?Ba.a.instance.ia(1050):Ba.a.instance.ia(1062),ac.copyText=ja?Ba.a.instance.ia(1051):Ba.a.instance.ia(1063),ac.pasteText=ja?Ba.a.instance.ia(1052):Ba.a.instance.ia(1064),ac.pasteTextOnly=ja?Ba.a.instance.ia(1055):
Ba.a.instance.ia(1065)),new Gh(this.$,this.NVa,{[$h.a.fy]:Mh.id,["bodyControls"]:ac}))}T0h(){void ka.a.resolve(Ha.C,{va:0}).then(A=>{A.xm(68,null)})}L4j(){const A=this.$.ua;nc.a.dm(`${A.ChromeClipboardAccessExtensionLink}${Da.a.uGc?A.ChromeClipboardAccessExtensionId:A.OfficeOnlineChromeExtensionId}`,"_blank",void 0,"ChromeCCPInstallDialog")}}Mh.Gha=!1;Mh.BJb="notOpened";Mh.CJb="ok";Mh.id="CopyPasteInstallDialog";Object(K.a)(Mh,"CopyPasteInstallDialog",null,[905]);class Bi extends Sys.EventArgs{constructor(A,
ja){super();this.Z$h=A;this.vo=ja}}Object(K.a)(Bi,"PasteSucceededEventArgs",Sys.EventArgs,[]);var $i=a(152);class Hi extends qh.a{constructor(A,ja,Ua){super(A);this.Bh=0;mb.AFrameworkApplication.fa.la("IsNewStringEnabled")?this.Yh(1,CommonUiStrings.DialogOk):this.Yh(1,CommonUIStrings.l_DialogOk);this.mia(1);this.initializeAndShow(Ba.a.instance.ia(2390),ja,Ua)}get ki(){return"CopyPasteNoClipboardAccessReactDialog"}}Object(K.a)(Hi,"CopyPasteNoClipboardAccessReactDialog",qh.a,[]);class zh{constructor(A){this.SJ=
null;this.NVa=ja=>{1===ja?this.SJ(zh.CJb,!0):this.SJ(xh.a[ja],!1);zh.Gha=!1;this.Zvd&&URL.revokeObjectURL(this.Zvd)};this.$=A}showDialog(A,ja,Ua,ac){this.SJ=ac=void 0===ac?()=>{}:ac;ja=Da.a.isMac||Da.a.Un;zh.Gha?ac(zh.BJb,!1):(zh.Gha=!0,ac={},A&&(ac.startText=Ba.a.instance.ia(2391),ac.endText=Ba.a.instance.ia(2392),mb.AFrameworkApplication.fa.la("IsNewStringEnabled")?(ac.cutText=CommonUiStrings.CutString,ac.copyText=CommonUiStrings.CopyString,ac.pasteText=CommonUiStrings.PasteString,ac.cutShortcutText=
ja?CommonUiStrings.CutShortcut_Mac:CommonUiStrings.CutShortcut,ac.copyShortcutText=ja?CommonUiStrings.CopyShortcut_Mac:CommonUiStrings.CopyShortcut,ac.pasteShortcutText=ja?CommonUiStrings.PasteShortcut_Mac:CommonUiStrings.PasteShortcut,ac.imageAltText=CommonUiStrings.NoClipboardAccessDialogImageAltText,ac.primaryButtonLabel=CommonUiStrings.DialogOk):(ac.cutText=CommonUIStrings.l_CutString,ac.copyText=CommonUIStrings.l_CopyString,ac.pasteText=CommonUIStrings.l_PasteString,ac.cutShortcutText=ja?CommonUIStrings.l_CutShortcut_Mac:
CommonUIStrings.l_CutShortcut,ac.copyShortcutText=ja?CommonUIStrings.l_CopyShortcut_Mac:CommonUIStrings.l_CopyShortcut,ac.pasteShortcutText=ja?CommonUIStrings.l_PasteShortcut_Mac:CommonUIStrings.l_PasteShortcut,ac.imageAltText=CommonUIStrings.l_NoClipboardAccessDialogImageAltText,ac.primaryButtonLabel=CommonUIStrings.l_DialogOk),this.Zvd=URL.createObjectURL(new Blob(['\n<svg width="440" height="114" viewBox="0 0 457 114" fill="none" xmlns="http://www.w3.org/2000/svg">\n<g filter="url(#filter0_dd_2_4645)">\n<rect x="15" y="8" width="427" height="85" rx="8" fill="#F3F3F3"/>\n<g clip-path="url(#clip0_2_4645)">\n<rect x="15" y="8" width="427" height="40" fill="#CECECE"/>\n<mask id="mask0_2_4645" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="15" y="40" width="427" height="12">\n<rect x="15" y="40" width="427" height="12" fill="#FF00FF"/>\n</mask>\n<g mask="url(#mask0_2_4645)">\n<g filter="url(#filter1_dd_2_4645)">\n<rect x="15" y="48" width="427" height="4" fill="#F3F3F3"/>\n</g>\n</g>\n<mask id="mask1_2_4645" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="23" y="12" width="256" height="36">\n<rect x="23" y="12" width="256" height="36" fill="#FF00FF"/>\n</mask>\n<g mask="url(#mask1_2_4645)">\n<g filter="url(#filter2_dd_2_4645)">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M31 24C31 19.5817 34.5817 16 39 16H263C267.418 16 271 19.5817 271 24V40C271 44.4183 274.582 48 279 48V52H271H31H23V48C27.4183 48 31 44.4183 31 40V24Z" fill="#F3F3F3"/>\n</g>\n</g>\n<g clip-path="url(#clip1_2_4645)">\n<path d="M251.089 28.2157L251.146 28.1464C251.32 27.9729 251.589 27.9536 251.784 28.0886L251.854 28.1464L255 31.293L258.146 28.1464C258.342 27.9512 258.658 27.9512 258.854 28.1464C259.049 28.3417 259.049 28.6583 258.854 28.8536L255.707 32L258.854 35.1464C259.027 35.32 259.046 35.5894 258.911 35.7843L258.854 35.8536C258.68 36.0271 258.411 36.0464 258.216 35.9114L258.146 35.8536L255 32.707L251.854 35.8536C251.658 36.0488 251.342 36.0488 251.146 35.8536C250.951 35.6583 250.951 35.3417 251.146 35.1464L254.293 32L251.146 28.8536C250.973 28.68 250.954 28.4106 251.089 28.2157L251.146 28.1464L251.089 28.2157Z" fill="#1A1A1A"/>\n</g>\n<g clip-path="url(#clip2_2_4645)">\n<path d="M55 28.6641V32L52.3359 33L49.6641 32L43 28.6641V25.3359C43 25.1484 43.0651 24.9896 43.1953 24.8594C43.3255 24.7292 43.4818 24.6641 43.6641 24.6641H49.6641L55 28.6641Z" fill="#21A366"/>\n<path d="M55 25.3359V28.6641H49.6641V24.6641H54.3359C54.4245 24.6641 54.5104 24.6823 54.5938 24.7188C54.6719 24.7552 54.7422 24.8047 54.8047 24.8672C54.862 24.9245 54.9089 24.9948 54.9453 25.0781C54.9818 25.1562 55 25.2422 55 25.3359Z" fill="#33C481"/>\n<path d="M55 35.3359V38.6641C55 38.8516 54.9349 39.0104 54.8047 39.1406C54.6745 39.2708 54.5182 39.3359 54.3359 39.3359H43.6641C43.4818 39.3359 43.3255 39.2708 43.1953 39.1406C43.0651 39.0104 43 38.8516 43 38.6641V35.375V32H49.6641L55 35.3359Z" fill="#185C37"/>\n<path d="M49.6641 28.6797V32H43V28.6797H49.6641ZM55 35.3359H49.6641V32.0078H55V35.3359Z" fill="black" fill-opacity="0.5"/>\n<path d="M48.2188 28C48.4375 28 48.6224 28.0755 48.7734 28.2266C48.9245 28.3776 49 28.5625 49 28.7812V36.4297C49 36.5391 48.974 36.6484 48.9219 36.7578C48.8698 36.862 48.7995 36.9583 48.7109 37.0469C48.6224 37.1302 48.5234 37.2005 48.4141 37.2578C48.2995 37.3099 48.1849 37.3359 48.0703 37.3359H43V28H48.2188Z" fill="black" fill-opacity="0.498"/>\n<path d="M47.5547 36.6641H39.7812C39.5625 36.6641 39.3776 36.5911 39.2266 36.4453C39.0755 36.2943 39 36.1094 39 35.8906V28.1094C39 27.8906 39.0755 27.7083 39.2266 27.5625C39.3776 27.4115 39.5625 27.3359 39.7812 27.3359H47.5547C47.7734 27.3359 47.9583 27.4115 48.1094 27.5625C48.2604 27.7083 48.3359 27.8906 48.3359 28.1094V35.8906C48.3359 36.1094 48.2604 36.2943 48.1094 36.4453C47.9583 36.5911 47.7734 36.6641 47.5547 36.6641Z" fill="#107C41"/>\n<path d="M41.2812 34.6641L43.0078 31.9922L41.4297 29.3359H42.7031L43.5625 31.0312C43.6042 31.1146 43.638 31.1849 43.6641 31.2422C43.6849 31.2995 43.7057 31.349 43.7266 31.3906H43.7422C43.7682 31.3281 43.7969 31.2656 43.8281 31.2031C43.8542 31.1406 43.8854 31.0781 43.9219 31.0156L44.8438 29.3359H46.0078L44.3828 31.9766L46.0469 34.6641H44.8047L43.8125 32.7969C43.7656 32.7292 43.724 32.6458 43.6875 32.5469H43.6719C43.6615 32.5781 43.6484 32.6146 43.6328 32.6562C43.612 32.6927 43.5885 32.737 43.5625 32.7891L42.5312 34.6641H41.2812Z" fill="white"/>\n</g>\n<rect x="67" y="29" width="96" height="6" rx="3" fill="#B2AFAC"/>\n<path d="M289 24.5C289 24.2239 288.776 24 288.5 24C288.224 24 288 24.2239 288 24.5V31H281.5C281.224 31 281 31.2239 281 31.5C281 31.7761 281.224 32 281.5 32H288V38.5C288 38.7761 288.224 39 288.5 39C288.776 39 289 38.7761 289 38.5V32H295.5C295.776 32 296 31.7761 296 31.5C296 31.2239 295.776 31 295.5 31H289V24.5Z" fill="#1A1A1A"/>\n</g>\n<rect x="15" y="48" width="427" height="38" fill="#F3F3F3"/>\n<rect x="15" y="86" width="427" height="1" fill="#CCCCCC"/>\n<path d="M42.159 73.3666C42.3629 73.5528 42.6792 73.5384 42.8654 73.3345C43.0515 73.1305 43.0371 72.8143 42.8332 72.6281L36.6653 66.9974H50.4961C50.7722 66.9974 50.9961 66.7735 50.9961 66.4974C50.9961 66.2212 50.7722 65.9974 50.4961 65.9974H36.6682L42.8332 60.3693C43.0371 60.1831 43.0515 59.8668 42.8654 59.6629C42.6792 59.459 42.3629 59.4446 42.159 59.6307L35.2426 65.9448C35.1027 66.0725 35.0229 66.2401 35.0031 66.4132C34.9985 66.4406 34.9961 66.4687 34.9961 66.4974C34.9961 66.5242 34.9982 66.5506 35.0023 66.5763C35.0205 66.7522 35.1006 66.9229 35.2426 67.0526L42.159 73.3666Z" fill="#1A1A1A"/>\n<g opacity="0.3">\n<path d="M87.8371 59.6307C87.6332 59.4446 87.3169 59.459 87.1307 59.6629C86.9446 59.8668 86.959 60.1831 87.1629 60.3693L93.3307 66H79.5C79.2239 66 79 66.2239 79 66.5C79 66.7761 79.2239 67 79.5 67H93.3279L87.1629 72.6281C86.959 72.8143 86.9446 73.1305 87.1307 73.3345C87.3169 73.5384 87.6332 73.5528 87.8371 73.3666L94.7535 67.0526C94.8934 66.9248 94.9732 66.7573 94.993 66.5841C94.9976 66.5568 95 66.5287 95 66.5C95 66.4731 94.9979 66.4468 94.9938 66.421C94.9756 66.2451 94.8955 66.0745 94.7535 65.9448L87.8371 59.6307Z" fill="#1A1A1A"/>\n</g>\n<path d="M124.066 66.05C124.59 62.2198 128.121 59.5401 131.951 60.0648C133.894 60.3309 135.54 61.3695 136.623 62.8297L136.749 63H133.5C133.224 63 133 63.2239 133 63.5C133 63.7761 133.224 64 133.5 64H137.5C137.776 64 138 63.7761 138 63.5V59.5C138 59.2239 137.776 59 137.5 59C137.224 59 137 59.2239 137 59.5V61.7073C135.776 60.3185 134.065 59.3451 132.087 59.074C127.709 58.4744 123.675 61.5369 123.075 65.9143C122.475 70.2917 125.538 74.3264 129.915 74.926C134.293 75.5256 138.327 72.4631 138.927 68.0857C139.001 67.5445 139.019 67.0079 138.986 66.4821C138.968 66.2065 138.73 65.9974 138.455 66.015C138.179 66.0326 137.97 66.2703 137.988 66.5459C138.017 67.0055 138.001 67.4752 137.936 67.95C137.412 71.7802 133.881 74.4599 130.051 73.9353C126.221 73.4106 123.541 69.8802 124.066 66.05Z" fill="#1A1A1A"/>\n<g filter="url(#filter3_d_2_4645)">\n<rect x="159" y="52" width="275" height="30" rx="8" fill="#FBFBFB"/>\n</g>\n<rect x="171" y="55" width="27" height="24" rx="4" fill="#F3F2F1"/>\n<path d="M190.051 65.3663V73H178.527V65.3663H180.686V62.1832C180.686 61.7458 180.782 61.3333 180.973 60.9457C181.159 60.558 181.415 60.2201 181.741 59.9318C182.067 59.6436 182.45 59.4175 182.888 59.2535C183.327 59.0845 183.794 59 184.289 59C184.784 59 185.251 59.0845 185.689 59.2535C186.128 59.4175 186.51 59.6436 186.837 59.9318C187.163 60.2201 187.422 60.558 187.613 60.9457C187.798 61.3333 187.891 61.7458 187.891 62.1832V65.3663H190.051ZM181.412 65.3663H187.166V62.1832C187.166 61.8353 187.09 61.5073 186.938 61.1991C186.786 60.886 186.581 60.6152 186.322 60.3866C186.063 60.158 185.76 59.9766 185.411 59.8424C185.057 59.7082 184.683 59.6411 184.289 59.6411C183.889 59.6411 183.515 59.7082 183.167 59.8424C182.818 59.9766 182.514 60.158 182.256 60.3866C181.997 60.6152 181.792 60.886 181.64 61.1991C181.488 61.5073 181.412 61.8353 181.412 62.1832V65.3663ZM189.325 66H179.252V72.3589H189.325V66Z" fill="black"/>\n</g>\n<defs>\n<filter id="filter0_dd_2_4645" x="0.6" y="4.76837e-07" width="455.8" height="113.8" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">\n<feFlood flood-opacity="0" result="BackgroundImageFix"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="6.4"/>\n<feGaussianBlur stdDeviation="7.2"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.13 0"/>\n<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_2_4645"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="1.2"/>\n<feGaussianBlur stdDeviation="1.8"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"/>\n<feBlend mode="normal" in2="effect1_dropShadow_2_4645" result="effect2_dropShadow_2_4645"/>\n<feBlend mode="normal" in="SourceGraphic" in2="effect2_dropShadow_2_4645" result="shape"/>\n</filter>\n<filter id="filter1_dd_2_4645" x="7.8" y="44" width="441.4" height="18.4" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">\n<feFlood flood-opacity="0" result="BackgroundImageFix"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="3.2"/>\n<feGaussianBlur stdDeviation="3.6"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.22 0"/>\n<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_2_4645"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="0.44"/>\n<feGaussianBlur stdDeviation="0.9"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.18 0"/>\n<feBlend mode="normal" in2="effect1_dropShadow_2_4645" result="effect2_dropShadow_2_4645"/>\n<feBlend mode="normal" in="SourceGraphic" in2="effect2_dropShadow_2_4645" result="shape"/>\n</filter>\n<filter id="filter2_dd_2_4645" x="15.8" y="12" width="270.4" height="50.4" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">\n<feFlood flood-opacity="0" result="BackgroundImageFix"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="3.2"/>\n<feGaussianBlur stdDeviation="3.6"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.22 0"/>\n<feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_2_4645"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="0.44"/>\n<feGaussianBlur stdDeviation="0.9"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.18 0"/>\n<feBlend mode="normal" in2="effect1_dropShadow_2_4645" result="effect2_dropShadow_2_4645"/>\n<feBlend mode="normal" in="SourceGraphic" in2="effect2_dropShadow_2_4645" result="shape"/>\n</filter>\n<filter id="filter3_d_2_4645" x="155" y="50" width="283" height="38" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">\n<feFlood flood-opacity="0" result="BackgroundImageFix"/>\n<feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>\n<feOffset dy="2"/>\n<feGaussianBlur stdDeviation="2"/>\n<feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"/>\n<feBlend mode="multiply" in2="BackgroundImageFix" result="effect1_dropShadow_2_4645"/>\n<feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_2_4645" result="shape"/>\n</filter>\n<clipPath id="clip0_2_4645">\n<path d="M15 16C15 11.5817 18.5817 8 23 8H434C438.418 8 442 11.5817 442 16V48H15V16Z" fill="white"/>\n</clipPath>\n<clipPath id="clip1_2_4645">\n<rect width="12" height="12" fill="white" transform="translate(249 26)"/>\n</clipPath>\n<clipPath id="clip2_2_4645">\n<rect width="16" height="16" fill="white" transform="translate(39 24)"/>\n</clipPath>\n</defs>\n</svg>\n'],
{type:"image/svg+xml"})),ac.imageSrc=this.Zvd,ac.learnMoreLink=null),new Hi(this.$,this.NVa,{[$h.a.fy]:zh.id,["bodyControls"]:ac}))}}zh.Gha=!1;zh.BJb="notOpened";zh.CJb="ok";zh.id="CopyPasteNoClipboardAccessDialog";Object(K.a)(zh,"CopyPasteNoClipboardAccesslDialog",null,[905]);var rj=a(199),Hj=a(73),Ii=a(64),Cg;(function(A){A[A.source=0]="source";A[A.destination=1]="destination"})(Cg||(Cg={}));Object(K.b)("RangeType",Cg);class Wf extends na.a{constructor(A,ja,Ua,ac,Ec,gd,ad,Jd,De,Xe,lf){lf=void 0===
lf?null:lf;super();this.PXg=this.QXg=this.trb=this.BMb=null;this.fnb=!1;this.f1a=ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StickyFormattingEnabled",!1);this.rmf=()=>{var mf;(null===(mf=this.BMb)||void 0===mf?0:mf.zZf())&&!Sa.W(za.f(this.$).ha.qa.selectedRanges,this.BMb.IIc)&&(this.BMb.gva(),this.BMb=null);this.da.ha.$w(this.rmf)};this.O7d=mf=>{this.XGk(mf)&&(this.Sz.hPd(),F.ULS.sendTraceTag(537167777,0,50,"CopyPasteInfrastructure.OnMetadataChanged: found that cut/copy operation was preformed in another session therefore removed the highlight in this session."))};
this.izj=(mf,Rf)=>{F.ULS.sendTraceTag(537167768,0,50,`CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got shortcut dialog, user pressed [${mf}]. userPressedExtensionLink=${Rf}`);this.da.focus()};this.iyj=(mf,Rf)=>{F.ULS.sendTraceTag(508130372,0,50,`CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got No Clipboard Access Dialog, user pressed [${mf}]. userPressedOK=${Rf}`);this.da.focus()};this.xj=(mf,Rf)=>{Rf.K0||Rf.Hl||this.ux("OnWorkbookOpened",!1).catch(()=>{})};this.aq=(mf,Rf)=>
{mf=ng(this.yK);const sg=this.Sz.Szc(mf);sg&&(Rf.na&&Rf.na.sheetName===sg.sheetName&&sg.isFromCurrentSession(this.$)?this.Sz.nPf(sg.ranges,mf.commandParameters.commandType):this.Sz.hPd())};this.jNc=(mf,Rf)=>{mf=ng(this.yK);(mf=this.Sz.Szc(mf))&&Rf.item&&Rf.item.sheetName===mf.sheetName&&mf.isFromCurrentSession(this.$)&&this.ux("OnItemDeleting",!1).catch(()=>{})};this.D6=()=>{this.QXg()};this.zY=()=>{this.PXg()};this.c1=(mf,Rf)=>{1===Rf.By&&Rf.Wl.operation.flags&2&&this.ux("OnQueueItemChanged/ItemRemoved",
!1).catch(()=>{})};this.$=A;this.zoom=De;this.ek=Ua;this.da=za.f(A);this.Sz=Ec;this.Rbj=gd;this.yK=ja;this.nWa=ac;this.XPf=Xe;this.getStringifiedError=lf||copyPasteInfra.getStringifiedError;this.nQg=1===Jd;this.fq();ad||(F.ULS.sendTraceTag(537167824,0,50,"CopyPasteInfrastructure.ctor: userId is null, using default userId."),ad=Wf.K9h);this.userHash=xa.a.jF(ad);this.ODj="CultureTag: "+Ba.a.instance.isc+" HASH: ";this.yK.addMetadataChangeListener(Wf.w$f,this.O7d);this.SCj=this.$.ua.CCPPastePlainTextLimit;
this.qYb=this.$.ua.CCPCopyPasteHtmlLimit;void ka.a.hj(Ha.qe).then(mf=>{this.trb=mf});this.QXg=gg.b(()=>{this.sXj()},1,this.$.xa,"CopyPasteInfrastructure.OnStartEditInternal",!0);this.PXg=gg.b(()=>{this.iOj()},1,this.$.xa,"CopyPasteInfrastructure.onEndEditInternal",!0)}ghb(){var A=ng(this.yK);return A?(A=A.sourceItem)&&!A.isFromCurrentSession(this.$)?(F.ULS.sendTraceTag(537167778,0,50,"CopyPasteInfrastructure.DoesClipboardHaveCopiedOrCutContent: Last copy/cut operation was from a different session."),
!1):!0:!1}get pasteIndicationManager(){return this.$.ka.Ug(373)}Wzh(A){this.addHandler(Wf.V8d,A)}ikk(A){this.removeHandler(Wf.V8d,A)}Hkc(A){this.addHandler(Wf.N3c,A)}pkk(A){this.removeHandler(Wf.N3c,A)}copy(A){A.stopwatch=this.$.qh.vi("UserAction",Kg.b().kp(A.ribbonCommandInfo.command)+"ClientSide");void ka.a.resolve(Ha.qe).then(gd=>{this.trb=gd});const ja=!!ng(this.yK);Pf.a.B_a&&(this.fnb=!1);this.ux("Copy/before/"+jc.a[A.ribbonCommandInfo.method],!1,void 0,!0,A.copyPasteTargetType).catch(()=>{});
var Ua=-1985798686===A.ribbonCommandInfo.command;if(1===this.da.wk&&(Ua=this.Sz.LUf(this.da.ha.qa.selectedRanges,Ua),0!==Ua)){const gd=Wf.rZh(Ua);this.XMa(gd,Pd[Ua],!1);return Promise.reject(!1)}A.userHash=this.userHash;A.id=Bd.a.create().toString();const ac=this,Ec=this;return this.nWa.onCopy(A).then(gd=>{gd.isAsyncCopy||A.stopwatch.stop();ac.pasteIndicationManager.oAd();const ad=Kc.d(A);F.ULS.sendTraceTag(24150883,0,50,`CopyPasteInfrastructure.OnCopy: Copy operation finished successfully. ${ad}`);
ac.Wwj(gd,ja);gd=1===A.copyPasteTargetType;!A.isFormatPainter&&gd&&(ac.trb?ac.trb.Tgi():F.ULS.shipAssertTag(537167823,0,!1,"Copy: pasteShortcutManager is null."));return Promise.resolve(!0)},gd=>{let ad=!1,Jd="none",De=Wf.Jgb,Xe=!0,lf=-1,mf=Wf.copyErrorName+Wf.HHa,Rf=!1,sg=null;if(gd){sg=gd.copyContext;lf=gd.reason;mf+=Wf.SIa(gd);gd.message&&(De=gd.message);var wg=Wf.qZh(gd);if(wg)if(3===wg.copyErrorName)ad=!0,De=Jd="Async Copy canceled by the user.",Xe=!1;else if(kb.a.rx(wg.ewaErrors))if(De=Ec.Fyc(wg.ewaErrors),
kb.a.Qn(wg.ewaErrors,Wf.operationSucceededWithAlert))Rf=ad=!0;else if(kb.a.Qn(wg.ewaErrors,Wf.pasteDataLimitHit)||kb.a.Qn(wg.ewaErrors,Wf.copyThrottlingError))ad=!0;13===gd.reason?(ad=!0,Xe=!1):11===gd.reason&&(Xe=!1)}wg=gd?Ec.getStringifiedError(gd):"null";ad?(wg=Kc.d(A),F.ULS.sendTraceTag(36304157,0,15,`CopyPasteInfrastructure.OnCopy: Copy operation failed with an expected error. clearStateNeeded: ${Xe}, Friendly message: ${Jd}, Error Message: ${De}, CommandParameters: ${wg}`)):F.ULS.sendTraceTag(24150912,
0,10,`CopyPasteInfrastructure.OnCopy: Copy operation failed with an unexpected error. clearStateNeeded: ${Xe}, Error Message: ${wg}, CommandParameters: ${Kc.d(A)}`);Xe&&Ec.ux("Copy/fail/"+jc.a[A.ribbonCommandInfo.method],!0,void 0,void 0,A.copyPasteTargetType).catch(()=>{});Ec.k5f(A,ad,De,mf,lf,Rf,sg);return Promise.reject(gd)})}writeToClipboard(A){A.stopwatch=this.$.qh.vi("UserAction",Kg.b().kp(A.ribbonCommandInfo.command)+"ClientSide");this.ux("Copy/before/"+jc.a[A.ribbonCommandInfo.method],!1,
void 0,!0,A.copyPasteTargetType).catch(()=>{});A.userHash=this.userHash;A.id=Bd.a.create().toString();return this.nWa.onCopy(A).then(()=>{A.stopwatch.stop();return Promise.resolve(!0)},ja=>{let Ua=Wf.Jgb,ac=-1,Ec=Wf.copyErrorName+Wf.HHa,gd=null;ja&&(gd=ja.copyContext,ac=ja.reason,Ec+=Wf.SIa(ja),ja.message&&(Ua=ja.message));const ad=Kc.d(A);F.ULS.sendTraceTag(508074081,0,15,`CopyPasteInfrastructure.writeToClipboard: Copy operation failed with an error. Error Message: ${Ua}, CommandParameters: ${ad}`);
this.k5f(A,!1,Ua,Ec,ac,!1,gd);return Promise.reject(ja)})}t2j(A){if(this.ghb())return Bb.a(this.tRd(A.commandType,A.ribbonCommandInfo));const ja=Sa.d(this.da.ha.qa.selectedRanges);A.originalDestinations=ja;A.expandDestinations=this.Gnc(A.originalDestinations,A.commandType);if(this.Qnc(A.commandType,A.expandDestinations)||this.b$e())A.userHash=this.userHash,A.id=Bd.a.create().toString(),this.nWa.onPaste(A).then(()=>Promise.resolve(!0),Ua=>Promise.reject(Ua));return Promise.resolve(!0)}q2j(A){const ja=
Kc.b();ja.ribbonCommandInfo=A;ja.userHash=this.userHash;ja.id=Bd.a.create().toString();ja.isKeyboardEvent=!1;ja.copyPasteTargetType=this.gLa();ja.skipSystemClipboardAccess=!1;ja.stopwatch=this.$.qh.vi("UserAction",Kg.b().kp(ja.ribbonCommandInfo.command)+"ClientSide");this.ux("CopyPasteInfrastructure.performFullSheetCopy",!1).catch(Ua=>Promise.reject(Ua));return this.nWa.onCopy(ja).then(()=>{const Ua=Kc.d(ja);F.ULS.sendTraceTag(507818122,0,50,`CopyPasteInfrastructure.performFullSheetCopy: Operation finished successfully. ${Ua}`);
return Promise.resolve(!0)},Ua=>Promise.reject(Ua))}r2j(A,ja){if(this.ghb())return Promise.resolve(null);const Ua=Kc.c();Ua.ribbonCommandInfo=A;Ua.id=Bd.a.create().toString();Ua.clearStateOnFinish=!1;Ua.isKeyboardEvent=this.lmb(A,ja);Ua.skipClipboardAccess=rj.d(ja,P.a.skipClipboardAccess);Ua.copyPasteTargetType=this.gLa();Ua.skipSystemClipboardAccess=!1;return this.nWa.onPaste(Ua).then(ac=>ac).catch(ac=>Promise.reject(ac))}mUd(){var A;return null===(A=ng(this.yK))||void 0===A?void 0:A.isFullSheetCopy}lGi(){var A;
return null===(A=ng(this.yK))||void 0===A?void 0:A.sourceItem.sheetName}Pgg(A,ja){if(A.method){var Ua=new Xh(this.$,Sa.d(this.da.ha.qa.selectedRanges),Sa.d(this.da.ha.qa.selectedRanges),{},this.zoom);(ac=>{const Ec=Object(Bb.d)(ka.a.resolve(Ha.Ze,{va:0}));$b.TaskExtensions.Ua(Ec,()=>{A.method&&ac(Ec.result)},this.xa,8)})(ac=>{ac.Dqd(Ua);ac.yqe(A.method,ja);this.BMb=ac});F.ULS.sendTraceTag(508680074,0,50,"CopyPasteInfrastructure.OnFill: Drag Copy Fill Floatie");this.da.ha.Cw(this.rmf)}}paste(A){A.stopwatch=
this.$.qh.vi("UserAction",Kg.b().kp(A.ribbonCommandInfo.command)+"ClientSide");Pf.a.B_a&&(F.ULS.sendTraceTag(537167822,0,50,"CopyPasteInfrastructure.OnPaste: Cross-app shadow workbook paste is enabled"),this.fnb=!1);za.f(this.$).nk&&za.f(this.$).nk.KP(this.SKd(A.ribbonCommandInfo.command),A.stopwatch.id);if(A.isPasteCommandFromRecoveryUI){var ja=ka.a.Zg(Ha.Ze);var Ua=Sa.d(ja.IIc);if(!Ua)return F.ULS.sendTraceTag(508699777,0,20,"RecoveryUI paste destinations must not be null or undefined"),Promise.resolve(!0);
ja=ja.$Yd;A.pasteRecoveryCachedClipboardItems=ja?ja[Wf.Vqg]:null}else Ua=Sa.d(this.da.ha.qa.selectedRanges);A.originalDestinations=Ua;A.expandDestinations=this.Gnc(A.originalDestinations,A.commandType);if(this.Qnc(A.commandType,A.expandDestinations)||this.b$e())return A.userHash=this.userHash,A.id=Bd.a.create().toString(),Yi(this.$)&&(A.isAsyncSystemClipboardEnabled=!0),this.nWa.onPaste(A).then(ac=>this.LNc(ac,A),ac=>this.C_b(A,ac));this.$.ei(927125067,Md.a.eh,30,null);Ua=Sa.j(A.expandDestinations,
",",this.$,!1);F.ULS.sendTraceTag(24150913,0,15,`CopyPasteInfrastructure.OnPaste: paste was triggered but the estimated destination range is not editable, do nothing. ExpandDestinations: ${Ua}, CommandType: ${A.commandType}, copyPasteTargetType="${A.copyPasteTargetType}"`);return Promise.resolve(!0)}SKd(A){switch(A){case 1804571062:return 6;case -185374993:return 7;case 1766348718:return 8;case -875588320:return 19;default:return 3}}b$e(){return!!za.f(this.$).ha.$e.activeFloatingObjectControlId&&
this.$.cy(null,!1,470)}gLa(){const A=ng(this.yK);return A&&A.commandParameters?A.commandParameters.copyPasteTargetType:0}Qkj(){return!!ng(this.yK)&&Xd(ng(this.yK),this.$)}ux(A,ja,Ua,ac,Ec){Ua=void 0===Ua?!1:Ua;ac=void 0===ac?!1:ac;Ec=void 0===Ec?0:Ec;try{this.trb&&this.trb.Wsc();let gd=Ec;const ad=this.Isj();if(!ac&&2===ad)return F.ULS.sendTraceTag(537167821,0,50,`CopyPasteInfrastructure.ClearState clipboard won't be cleared as there's art in the clipboard. clearClipboardContent = '${ja}', isExplicit = '${Ua}', isForce = '${ac}', Current CCP operation copyPasteTargetType = '${Ec}', LastCopyPasteTargetType = '${ad}'`),
Promise.reject(null);0===gd&&(gd=ad);const Jd=this.$.qh.vi("UserAction","ClearCopyState"),De=Jd.id;F.ULS.sendTraceTag(537167820,0,50,`CopyPasteInfrastructure.ClearState clear clipboard state. clearClipboardContent = '${ja}', isExplicit = '${Ua}', isForce = '${ac}', Current CCP operation copyPasteTargetType = '${Ec}', LastCopyPasteTargetType = '${ad}'`);this.Sz.hPd();this.$$j();return this.nWa.onCancelCopy(ja).then(()=>{ja&&Pf.a.B_a&&(this.fnb=!1);Jd.stop();this.j5f(A,De,!0,Ua,ja,"","",Jd.ii,gd);return Promise.resolve(!0)},
Xe=>{var lf=Xe?this.getStringifiedError(Xe):"null";F.ULS.sendTraceTag(24150915,0,15,`CopyPasteInfrastructure.ClearState: error during call to copyPasteFlowManager.OnClear(). error: ${lf}`);Jd.stop();lf=Wf.iQh+Wf.HHa;let mf=Wf.Jgb;Xe&&(lf+=Wf.SIa(Xe),Xe.message&&(mf=Xe.message));this.j5f(A,De,!1,Ua,ja,mf,lf,Jd.ii,gd);return Promise.reject(Xe)})}catch(gd){return Promise.reject(null)}}Rtd(A,ja,Ua,ac){var Ec=void 0;Ec=void 0===Ec?!1:Ec;Ua=void 0===Ua?!1:Ua;ac=void 0===ac?0:ac;return Ua||this.ghb()?this.ux(A,
ja,Ec,Ua,ac):(F.ULS.sendTraceTag(537167819,0,50,"CopyPasteInfrastructure.ClearStateOnlyIfClipboardHasContentFromSameSession clipboard won't be cleared as there is no content in the clipboard from the current session"),Promise.reject(null))}XMa(A,ja,Ua){F.ULS.sendTraceTag(590705172,0,50,`CopyPasteInfrastructure.PopupDiscontinuousSelectionErrorDialog: Blocked CCP due to discontinuous selection, reason: ${ja}`);const ac=new Yg.a;ac.ga("reason",ja);ph.a(mg.a.discontinuousSelectionBlocking,[Ua?og.a.S1j:
og.a.v_h],!0,!0,!1,!1,ac);A=kb.a.Yi(1,1,751,A,0,371863010,"DiscontinuousSelectionBlocking");new Zd.a(this.$,A)}Isj(){const A=ng(this.yK);return A&&A.sourceItem&&Object.getType(A.sourceItem)!==Vd?Object.getType(A.sourceItem)===ne?2:1:0}jei(A,ja,Ua,ac,Ec){Ec=void 0===Ec?!1:Ec;A.stopwatch=this.$.qh.vi("UserAction","DragDropReplaceClientSide");A.isDragDrop=!0;this.Rtd("DragDropReplace/before/"+jc.a[A.ribbonCommandInfo.method],!1,void 0,A.copyPasteTargetType).catch(()=>{});const gd=Ec?2:1;let ad=0;ad=
Ec?4:ac?256:128;const Jd={encounteredDeploymentErrors:!1};Jd.commandParameters=A;A.isDragInsert=!1;A.userHash=this.userHash;A.id=Bd.a.create().toString();return this.Sz.pasteRange(A.ribbonCommandInfo,Sa.r(ja,this.$),Sa.r(Ua,this.$),gd,ad,[A.stopwatch],Jd,!1,()=>{F.ULS.sendTraceTag(537167816,0,50,`CopyPasteInfrastructure.DragDropReplaceCells: success. copyPasteTargetType="${A.copyPasteTargetType}"`);this.q5f(A,gd,ja,Ua,Jd)},De=>this.agg(De,A,gd,ja,Ua,Jd)).then(()=>{this.da.ha.selectionType=-1;return Promise.resolve(!0)},
De=>Promise.reject(De))}iei(A,ja,Ua,ac,Ec){Ec=void 0===Ec?!1:Ec;A.stopwatch=this.$.qh.vi("UserAction","DragDropInsertClientSide");this.Rtd("DragDropInsert/before/"+jc.a[A.ribbonCommandInfo.method],!1,void 0,A.copyPasteTargetType).catch(()=>{});const gd=Ec?2:1,ad=Sa.Q(this.Gnc([Ua],gd));var Jd=this.$.ea.na.sheetName;const De=this.$.ea.na.sheetName,Xe=Sa.w(ja,this.$);Xe.SheetName=Jd;Jd=Sa.w(ad,this.$);Jd.SheetName=De;ac=ad.isRow||ja.isRow||ac?1:0;const lf={encounteredDeploymentErrors:!1};A.isDragInsert=
!0;lf.commandParameters=A;A.userHash=this.userHash;A.id=Bd.a.create().toString();Ec=this.Sz.mei(lf,Xe,Jd,Ec,ac,A.ribbonCommandInfo,()=>{F.ULS.sendTraceTag(537167814,0,50,`CopyPasteInfrastructure.DragDropInsertCells: success. copyPasteTargetType="${A.copyPasteTargetType}"`);this.q5f(A,gd,ja,Ua,lf)},mf=>{this.agg(mf,A,gd,ja,Ua,lf)});return Bb.d(Ec.then(()=>{this.da.ha.selectionType=-1;return Promise.resolve(!0)},mf=>Promise.reject(mf))).RA(()=>!0)}tRd(A,ja,Ua,ac,Ec,gd){var ad=ng(this.yK);if(!ad)return F.ULS.sendTraceTag(537167812,
0,50,"InsertCopiedCutCells: CopyContext must not be null or undefined"),ha.Task.Va(!1);if(!Ge(ad.sourceItem))return F.ULS.sendTraceTag(537167811,0,50,"InsertCopiedCutCells: CopyContext must be a Range"),ha.Task.Va(!1);var Jd=ad.sourceItem;if(!Jd)return F.ULS.shipAssertTag(537167810,0,!!Jd,"InsertCopiedCutCells: rangeSourceItem must not be null or undefined"),ha.Task.Va(!1);if(1<Jd.ranges.length)return F.ULS.sendTraceTag(537167808,0,50,"InsertCopiedCutCells: multiple source ranges are not supported"),
this.XMa(2192,"InsertCopiedCutCells",!0),ha.Task.Va(!1);ad=Sa.Q(Jd.ranges);var De=this.da.ha.qa.Ui.clone();A=Sa.Q(this.Gnc([De],A));const Xe=this.F2f();Jd=Jd.sheetName;De=this.$.ea.na.sheetName;const lf=Sa.w(ad,this.$);lf.SheetName=Jd;const mf=Sa.w(A,this.$);mf.SheetName=De;Jd=this.da.ha.qa.activeRange;const Rf=()=>{F.ULS.sendTraceTag(508929747,0,50,"InsertCopiedCutCellsCrossSession Succeeded")},sg=()=>{F.ULS.sendTraceTag(508929746,0,50,"InsertCopiedCutCellsCrossSession Failed")};return(A.fk||ad.fk||
this.Sz.VIk(this.$,ad,Jd)?ha.Task.Va(0):A.isRow||ad.isRow||this.Sz.WIk(this.$,ad,Jd)?ha.Task.Va(1):this.Rbj.Bqc(this.$,za.f(this.$).rtl)).RA(wg=>this.ghb()?this.Sz.executeInsertCopiedCutCellsOperation(lf,mf,Xe,wg.result,ja,null,null):this.Sz.executeInsertCopiedCutCellsAcrossSession(lf,mf,Xe,wg.result,ja,Rf,sg,Ua,ac,Ec,gd)).continueWith(()=>{this.ux("InsertCopiedCutCells/success/"+jc.a[ja.method],!0)})}FUb(){const A=ng(this.yK),ja=this.da.ha.qa.Gn;return!!A&&Ge(A.sourceItem)&&ja&&1===A.sourceItem.ranges.length}F2f(){return this.G2f(-911352779)}enb(){var A,
ja;const Ua=ng(this.yK);return Ua?(null===(A=Ua.asyncClipboardItemsKeys)||void 0===A?void 0:A.includes(Df.a.shadowWorkbook))||(null===(ja=Ua.syncClipboardItemsKeys)||void 0===ja?void 0:ja.includes(Df.a.shadowWorkbook))||3!==Ua.copyStatus:!1}HIc(){return this.G2f(-1985798686)}Qnc(A,ja){var Ua=new Ee.a(this.$.sa),ac=36===A;const Ec=Ua.Hj(4);A=2===this.gLa()&&Ua.Hj(1);ac=ac&&Ec;Ua=!Ua.Dn||!this.HIc()||!Ee.a.stc(ja,za.f(this.$));return ac||A||this.$.cy(ja,!0)&&Ua}lmb(A,ja){return this.Sz.lmb(A,ja)}dispose(){super.dispose();
this.$o();this.yK.removeMetadataChangeListener(Wf.w$f)}dAd(A,ja,Ua,ac,Ec){if(!this.gUh(A.commandParameters.ribbonCommandInfo.command))return A.cseStatus=2,!1;if(ac.width%ja.width||ac.height%ja.height)return A.cseStatus=16,!1;if(ac.fk||ac.isRow)return A.cseStatus=31,!1;const gd=ac.pk(this.da.Hp);if(!gd)return A.cseStatus=7,!1;var ad=this.r7e(this.da,A.commandParameters.ribbonCommandInfo.command,ja);if(0!==ad)return A.cseStatus=ad,!1;ad=this.r7e(this.da,A.commandParameters.ribbonCommandInfo.command,
gd);if(0!==ad)return A.cseStatus=ad,!1;ad=Sa.w(ja,this.$);ad.SheetName=Ua;Ua=this.ek.X1j(this.da,ad,Sa.w(gd,this.$),A.commandParameters.ribbonCommandInfo.command,A.commandParameters.stopwatch);1===Ua&&(Ec&&(ja.yi(ac)?(ac=Sa.eb(ja,A.commandParameters.expandDestinations[0]),this.ek.Ktd(ac,!1,A.commandParameters.id),this.ek.Ktd(ac,!0,A.commandParameters.id)):(this.ek.Noc(ja,!1),this.ek.Noc(ja,!0))),ja=new Qh(A.commandParameters.ribbonCommandInfo.command,gd,ja),za.f(this.$).Sce(ja),this.pasteIndicationManager.Rkb(A.commandParameters.id,
!0),this.qub(A.commandParameters.expandDestinations,A.commandParameters.isPasteCommandFromRecoveryUI),this.Roc("DoPasteClientEstimation/"+jc.a[A.commandParameters.ribbonCommandInfo.method],A));A.cseStatus=Ua;return 1===Ua}r7e(A,ja,Ua){A=new Lh.a("CopyPasteInfrastructure.blockCseForPaste",A,Ua);try{for(;A.moveNext();){const ac=A.get_current().cell;if(ac.DF)return 8;if(237279923===ja||1804571062===ja){if(!ba.EwaSettings.UKa()&&ac.PE)return 18;if(ac.oR)return 19}}}catch(ac){Hj.a.Jn(ac,"CopyPasteInfrastructure.BlockCseForPasteRange: exception thrown before CSE")}finally{A&&
A.dispose()}return 0}rsg(){Yi(this.$)?(new zh(this.$)).showDialog(!0,!1,!1,this.iyj):(Da.a.Av||Da.a.uGc||Da.a.wUf?new Mh(this.$):new hh(this.$)).showDialog(!0,!1,!1,this.izj)}Oyj(A,ja,Ua,ac){A=qd(A,ja,Ua,ac,this.$.ua.UserSessionId);A.k=!0;Kg.b().tl(45,A,!0)}kVj(A,ja,Ua,ac,Ec){var gd=!1,ad=!1,Jd=Wf.Jgb,De=Wf.Jnf+Wf.HHa;A&&(De+=Wf.SIa(A),kb.a.rx(A.ewaErrors)?(Jd=this.Fyc(A.ewaErrors),kb.a.Qn(A.ewaErrors,[-103190598,1512686094])&&(gd=!0)):A.message&&(Jd=A.message));ad||(ad=this.QTd(A));ja=qd(ja,Ua,ac,
Ec,this.$.ua.UserSessionId);ja.k=!1;ja.l=ad;ja.n=Jd;ja.p=De;ja.q=gd;Kg.b().tl(45,ja,!0);return Promise.reject(A)}Jpd(A,ja,Ua,ac){let Ec;if(!this.XPf)return A.cseStatus=40,dg.a.Va(!1);const gd=this.dij(A.commandParameters.ribbonCommandInfo.command,Ua,this.da);if(0!==gd)return A.cseStatus=gd,dg.a.Va(!1);$b.TaskExtensions.ts(dg.a.delay(0),()=>{Ec=this.XPf.o1j(ja,ac).result;return dg.a.Va(!0)},ac.token).continueWith(()=>{F.ULS.sendTraceTag(507582610,0,50,`CopyPasteInfrastructure.AttemptExternalHtmlPasteClientEstimation: pasteId=${A.id}, result=${JSON.stringify(Ec.jba)}`);
if(1!==(null===Ec||void 0===Ec?void 0:Ec.cseStatus))return A.cseStatus=Ec.cseStatus,dg.a.Va(!1);if(ac.token.sM)return A.cseStatus=39,dg.a.Va(!1);var ad=Ua.topLeft?this.U2h(Ua.topLeft,Ec.yCc):Ua;A.commandParameters.expandDestinations=[ad];if(!za.h(this.da,ad))return A.cseStatus=7,dg.a.Va(!1);A.cseStatus=this.ek.U1j(this.da,Ec.yCc,Ua.topLeft,ac,A.commandParameters.stopwatch);return 1===A.cseStatus?(ad=new Qh(A.commandParameters.ribbonCommandInfo.command,Ua,null),za.f(this.$).nk.JS(A.commandParameters.stopwatch.id,
Ii.BasicTelemetryCalculator.uR),za.f(this.$).Sce(ad),this.pasteIndicationManager.Rkb(A.commandParameters.id,!0),this.qub(A.commandParameters.expandDestinations,A.commandParameters.isPasteCommandFromRecoveryUI),this.Roc("AttemptExternalHtmlPasteClientEstimation/"+jc.a[A.commandParameters.ribbonCommandInfo.method],A),dg.a.Va(!0)):dg.a.Va(!1)});return dg.a.Va(!1)}VGh(A,ja,Ua){A.cseStatus=0;A.cseStatus=this.fij(A.commandParameters.ribbonCommandInfo.command,Ua,this.da,ja);if(0!==A.cseStatus)return!1;A.cseStatus=
this.ek.Y1j(this.da,ja,Ua,A.commandParameters.stopwatch);ja=new Qh(A.commandParameters.ribbonCommandInfo.command,Ua,null);1===A.cseStatus&&(za.f(this.$).Sce(ja),this.pasteIndicationManager.Rkb(A.commandParameters.id,!0),this.qub(A.commandParameters.expandDestinations,A.commandParameters.isPasteCommandFromRecoveryUI),this.Roc("AttemptExternalPlainTextPasteClientEstimation/"+jc.a[A.commandParameters.ribbonCommandInfo.method],A));return 1===A.cseStatus}dij(A,ja,Ua){return 237279923!==A?2:Ua.Yg.Dmb(ja)?
8:Ua.Yg.aY(ja)?11:this.ek.Dtc(ja)?12:0}U2h(A,ja){return new yd.Range(A.top,A.left,A.top+Math.max(...ja.map(Ua=>Ua.rowIndex)),A.left+Math.max(...ja.map(Ua=>Ua.colIndex)),!0,!0)}fij(A,ja,Ua,ac){if(-875588320!==A&&-185374993!==A&&237279923!==A)return 2;if(Ua.Yg.Dmb(ja))return 8;if(!ba.EwaSettings.UKa()&&Ua.Yg.nrj(ja))return 18;if(Ua.Yg.aY(ja))return 11;if(this.ek.Dtc(ja))return 12;A=this.mOh(ja,ac);return za.h(this.da,A)?0:7}mOh(A,ja){var Ua=ja.indexOf("\r");Ua=-1!==Ua?"\n"===ja[Ua+1]?ja.split("\r\n"):
ja.split("\r"):ja.split("\n");ja=Ua.length;Ua=Ua[0].split("\t").length;return new yd.Range(A.top,A.left,A.top+ja-1,A.left+Ua-1,!0,!0)}gUh(A){switch(A){case 237279923:case 808159687:case -185374993:case 1804571062:case -875588320:return!0;default:return!1}}G2f(A){const ja=ng(this.yK);return ja?ja.commandParameters.ribbonCommandInfo.command===A:!1}XGk(A){return A&&A.lastCopy?Xd(A.lastCopy,this.$):!0}lDf(A,ja,Ua,ac,Ec){const gd={};gd.a=this.$.ua.UserSessionId;gd.e=A.stopwatch.id;gd.c=Kg.b().kp(A.ribbonCommandInfo.command);
gd.b=jc.a[A.ribbonCommandInfo.method];gd.d=A.id;gd.f=Ua.toString();gd.g=ac.toString();gd.h=ja.toString();gd.o=A.stopwatch.ii;gd.q=!1;gd.r=A.copyPasteTargetType.toString();gd.s=Ec.encounteredDeploymentErrors;gd.i=Ec.commandParameters.dragDropIsShiftKeyDown;gd.j=Ec.commandParameters.isDragInsert;ba.EwaSettings.lC()&&(gd.t=Ec.commandParameters.isHeaderDrag);return gd}q5f(A,ja,Ua,ac,Ec){A=this.lDf(A,ja,Ua,ac,Ec);A.k=!0;Kg.b().tl(45,A,!0)}dxj(A,ja,Ua,ac,Ec,gd,ad,Jd,De){A=this.lDf(A,ja,Ua,ac,De);A.k=!1;
A.l=Ec;A.n=gd;A.p=ad;A.q=Jd;Kg.b().tl(45,A,!0)}j5f(A,ja,Ua,ac,Ec,gd,ad,Jd,De){const Xe={};Xe.a=this.$.ua.UserSessionId;Xe.b=ja;Xe.c=A;Xe.f=Ua;Xe.e=ac;Xe.d=Ec;Xe.g=gd;Xe.h=ad;Xe.i=Jd;Xe.j=De.toString();Kg.b().tl(46,Xe,!0)}Wwj(A,ja){A=this.GCf(A.commandParameters,A);A.l=!0;A.j=ja;Kg.b().tl(43,A,!0)}k5f(A,ja,Ua,ac,Ec,gd,ad){A=this.GCf(A,ad);A.l=!1;A.m=ja;A.o=Ua;A.y=ac;A.x=Ec;A.z=gd;Kg.b().tl(43,A,!0);F.ULS.sendTraceTag(537167776,0,15,`CopyPasteInfrastructure.LogCopyFailedTelemetry: ErrorName=${A.y},ErrorReason=${A.x},IsExpectedError=${A.m},IsSucceededWithAlert=${A.z},ErrorMessage=${A.o}`)}GCf(A,
ja){const Ua={};Ua.a=this.$.ua.UserSessionId;Ua.f=A.stopwatch.id;Ua.g=A.id;Ua.c=Kg.b().kp(A.ribbonCommandInfo.command);Ua.b=jc.a[A.ribbonCommandInfo.method];Ua.q=A.stopwatch.ii;Ua.bd=Wf.Mxc();Ua.bg=A.copyPasteHandlerName;Ua.bj=void 0===A.ribbonCommandInfo.lk||null===A.ribbonCommandInfo.lk?null:Zc.a[A.ribbonCommandInfo.lk];Ua.bq=A.uploadToClipService;Ua.br=A.floatingObjectType;Ua.s=A.copyPasteTargetType.toString();Ua.bc=qe(A.copyPasteTargetType);Ua.z=!1;if(ja){Ua.bk=ja.id;Ua.bl=ja.serverRequestTimeInMs;
ja.requestTelemetryData&&(Ua.bm=ja.requestTelemetryData.EcsOperationDuration,Ua.bn=ja.requestTelemetryData.EcsRequestDuration,Ua.bo=ja.requestTelemetryData.WfeRequestDuration);Ua.d=ja.sourceItem?ja.sourceItem.toString():null;Ua.e=-1;if(Ge(ja.sourceItem)){Ua.e=0;A=ja.sourceItem.ranges;for(const ac of A)Ua.e+=ac.cz}Ua.h=ja.isAsyncCopy;Ua.i=ja.isFromCache;Ua.k=ja.isSelectionAllowed;Ua.r=ja.plainTextPayloadSize;Ua.u=ja.htmlPayloadSize;Ua.v=ja.htmlSizeExceedsLimit;Ua.w=ja.copyTotalSizeExceedsLimit;Ua.t=
ja.shadowWorkbookPayloadSize;Ua.p=ja.clientSideCopyTime;Ua.ba=ja.encounteredDeploymentErrors;Ua.bb=ja.shadowWorkbookSizeExceedsLimit;Ua.be=ja.syncClipboardItemsKeys;Ua.bf=ja.asyncClipboardItemsKeys;Ua.bh=this.Mff(ja.succeededPopulatingSystemClipboardSync);Ua.bi=this.Mff(ja.succeededPopulatingSystemClipboardAsync);Yi(this.$)&&(Ua.bs=ja.commandParameters.isAsyncClipboardAPI)}return Ua}qub(A,ja){ja=void 0===ja?!1:ja;if(!this.da.isEditing&&!this.da.Pp){var Ua=this.da.ha.qa,ac=!ja&&1===A.length&&Sa.W(A,
Ua.selectedRanges),Ec=ac?Ua.activeCell:A[0].topLeft;A[0].contains(Ec)||(F.ULS.shipAssertTag(537167775,0,!1,`CopyPasteInfrastructure.SelectPastedRange: SelectedRanges ${Ua.selectedRanges}, IndexOfActiveRange ${Ua.qy}, ActiveCell ${Ua.activeCell}, calculatedDestinationRanges ${A}, keepThePreviousActiveCell ${ac}, newActiveCell ${Ec}, isPasteCommandFromRecoveryUI ${ja}`),Ec=A[0].topLeft);this.da.ha.DP(A,0,Ec,0,void 0,"CopyPasteInfrastructure.SelectPastedRange")}}dHf(A,ja){const Ua={};Ua.a=this.$.ua.UserSessionId;
Ua.g=A.stopwatch.id;Ua.t=A.stopwatch.ii;Ua.bz=!1;ja&&(Ua.bv=ja.id,Ua.bw=ja.serverRequestTimeInMs,Ua.n=ja.commandParameters.clipboardFormatReadTimes,Ua.o=ja.commandParameters.clipboardFormatReadStatus,Ua.q=ja.commandParameters.asyncApiReadTimedOut,ja.requestTelemetryData&&(Ua.cb=ja.requestTelemetryData.EcsOperationDuration,Ua.cc=ja.requestTelemetryData.EcsRequestDuration,Ua.cd=ja.requestTelemetryData.WfeRequestDuration));Ua.x=A.copyPasteTargetType.toString();Ua.bl=qe(A.copyPasteTargetType);Ua.br=A.copyPasteHandlerName;
Ua.i=(null===ja||void 0===ja?0:ja.isHtmlPaste)?Sa.j(Sa.h(ja.pastedRange.Ranges),",",this.$,!1):Sa.j(A.expandDestinations,",",this.$,!1);Ua.h=Sa.j(A.originalDestinations,",",this.$,!1);Ua.e=A.id;Ua.d=A.commandType;Ua.c=Kg.b().kp(A.ribbonCommandInfo.command);Ua.b=jc.a[A.ribbonCommandInfo.method];Ua.bf=!1;Ua.bg=!1;Ua.bp=Wf.Mxc();Ua.bt=void 0===A.ribbonCommandInfo.lk||null===A.ribbonCommandInfo.lk?null:Zc.a[A.ribbonCommandInfo.lk];Ua.cj=A.isPasteCommandFromEnterShortcut;if(Ua.ca=A.isPasteCommandFromRecoveryUI)Ua.cf=
A.pasteRecoveryUndoStopwatch.id,Ua.cg=A.pasteRecoveryUndoStopwatch.ii;if(ja){if((A=ja.copyContextSnapshot)&&!ja.wasLastCopyExternal){Ua.f=A.commandParameters.id;Ua.j=A.sourceItem.toString();Ua.k=-1;if(Ge(A.sourceItem)){Ua.k=0;const ac=A.sourceItem.ranges;for(const Ec of ac)Ua.k+=Ec.cz}Ua.bg=1===A.commandParameters.commandType}else ja.clipboardItems?Ua.f=ja.clipboardItems.getItem(Df.a.lqc):F.ULS.sendTraceTag(537167774,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext.ClipboardItems is null");
Ua.bz=ja.pasteRecoveryUIDisplayed;Ua.ci=ja.cseStatus}else F.ULS.sendTraceTag(537167773,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext is null");return Ua}ryj(A,ja,Ua,ac,Ec,gd,ad,Jd,De){var Xe,lf;A=this.dHf(A,Jd);A.l=!1;A.m=ja;A.s=Ua;A.bc=ac;A.be=Ec;A.bd=gd;A.bf=ad;if(Jd){A.y=Of(Jd)||!Jd.copyContextSnapshot;A.bi=!A.y&&Xd(Jd.copyContextSnapshot,this.$);A.bj=Jd.shadowWorkbookSizeExceedsLimit;A.v=Jd.shadowWorkbookPayloadSize;A.w=Jd.htmlPayloadSize;A.bq=rf(Jd.clipboardItems);A.bb=Jd.activeSelectionType;
A.bs=Jd.isSameSession;A.bn=Jd.payloadOrigin;A.bo=Jd.payloadType;A.bu=Jd.externalAppSource;A.bx=Jd.indicationDisplayScheduled;A.by=Jd.pasteIndicationDisplayStatus;A.ck=Jd.pasteDestinationHasMergedCells;if(ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",!1)||ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",!1))A.cl=Jd.ArtSourceItemType;Yi(this.$)&&(A.cm=null===(Xe=Jd.commandParameters)||void 0===Xe?void 0:Xe.isAsyncClipboardAPI);
ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8362261_IsChromiumExtPasteTelemetryEnabled")&&(A.cn=null===(lf=Jd.commandParameters)||void 0===lf?void 0:lf.isChromiumExtension)}else A.bi=Xd(De,this.$);Kg.b().tl(44,A,!0);F.ULS.sendTraceTag(537167772,0,15,`CopyPasteInfrastructure.LogPasteFailedTelemetry: ErrorName=${A.be},ErrorReason=${A.bd},IsExpectedError=${A.m},IsSucceededWithAlert=${A.bf},ErrorMessage=${A.s}`)}tyj(A){var ja,Ua;const ac=this.dHf(A.commandParameters,A);ac.y=A.wasLastCopyExternal;ac.l=
!0;ac.u=A.plainTextPayloadSize;ac.v=A.shadowWorkbookPayloadSize;ac.w=A.htmlPayloadSize;ac.z=A.isClipboardDataContainShadowWorkbook;ac.ba=A.isShadowWorkbookParsedSuccessfully;ac.bb=A.activeSelectionType;ac.bc=A.pasteResult;ac.bh=A.encounteredDeploymentErrors;ac.bj=A.shadowWorkbookSizeExceedsLimit;ac.bk=Ag(A);ac.bq=rf(A.clipboardItems);ac.bs=A.isSameSession;ac.bn=A.payloadOrigin;ac.bo=A.payloadType;ac.bu=A.externalAppSource;ac.bx=A.indicationDisplayScheduled;ac.by=A.pasteIndicationDisplayStatus;ac.ck=
A.pasteDestinationHasMergedCells;ac.bm=A.clipboardItems?A.clipboardItems.getItem(Df.a.VSh):null;ac.bi=!A.isSameSession&&!A.wasLastCopyExternal;ac.ci=A.cseStatus;if(ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",!1)||ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",!1))ac.cl=A.ArtSourceItemType;Yi(this.$)&&(ac.cm=null===(ja=A.commandParameters)||void 0===ja?void 0:ja.isAsyncClipboardAPI);ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8362261_IsChromiumExtPasteTelemetryEnabled")&&
(ac.cn=null===(Ua=A.commandParameters)||void 0===Ua?void 0:Ua.isChromiumExtension);Kg.b().tl(44,ac,!0)}fq(){this.$.sa.Qm(this.aq);this.$.sa.$yh(this.jNc);this.$.userOperationManager.px(this.c1);this.$.nr(this.xj);za.f(this.$).sh.nv(this.D6);za.f(this.$).sh.RW(this.zY)}$o(){this.$&&this.$.sa&&(this.$.sa.hn(this.aq),this.$.sa.zjk(this.jNc));this.$&&this.$.userOperationManager&&this.$.userOperationManager.Hv(this.c1);this.da&&this.da.sh&&(this.da.sh.ev(this.D6),this.da.sh.v1(this.zY))}C_b(A,ja){var Ua=
null;let ac=!1;var Ec=null;let gd="UnknownFailure",ad=-1,Jd=Wf.Jgb,De=Wf.pasteErrorName+Wf.HHa,Xe=!1;this.pasteIndicationManager.Rkb(A.id,!1);this.pasteDestinationHasMergedCells(A.expandDestinations)&&(ja.pasteContext.pasteDestinationHasMergedCells=!0);const lf=ng(this.yK);(A.clearStateOnFinish||A.clearSystemClipboard)&&this.ux("Paste/fail/"+jc.a[A.ribbonCommandInfo.method],!0,void 0,void 0,A.copyPasteTargetType).catch(()=>{});if(ja){ad=ja.reason;De+=Wf.SIa(ja);ja.message&&(Jd=ja.message);if(Ua=Wf.HZh(ja))if(1===
Ua.pasteErrorName)ac=!0,gd="CopyPasteLengthTooLongPopup",Jd=Ec="The pasted content is too long. Popup a dialog to the user.",F.ULS.sendTraceTag(25216992,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Ec}, copyPasteTargetType="${A.copyPasteTargetType}"`),Ua=kb.a.Yi(1,0,26,690,0,1306609195,"CopyPasteOversizeError"),new Zd.a(this.$,Ua);else if(7===Ua.pasteErrorName)ac=!0,gd="No-Op",Jd=Ec="The shadow workbook is not ready yet and an async copy failed to populate the clipboard. Do nothing (by the spec)",
F.ULS.sendTraceTag(33948251,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Ec}, copyPasteTargetType="${A.copyPasteTargetType}"`);else if(8===Ua.pasteErrorName)ac=!0,gd="UseShortcutsPopup",Jd=Ec="Unable to paste content from the system clipboard. Popup dialog to the user.",F.ULS.sendTraceTag(25216994,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Ec}, copyPasteTargetType="${A.copyPasteTargetType}"`),this.rsg();else if(18===Ua.pasteErrorName){ac=!0;gd="PasteExternalNotSupportMultipleSelectionPopup";
Jd="Paste external not support multiple selection.";Ec="Unknown";var mf=2192;100!==Ua.validationFailureReason&&(Ec=Af[Ua.validationFailureReason],mf=Wf.Cff(Ua.validationFailureReason));this.XMa(mf,Ec,!0)}else 20===Ua.pasteErrorName||19===Ua.pasteErrorName?(ac=!0,20===Ua.pasteErrorName?(gd="PasteAcrossSessionNotSupportMultipleSelectionPopup",Jd="Paste across session does not support multiple selection."):(gd="PasteInSameSessionNotSupportMultipleSelectionPopup",Jd="This kind of multiple selection is not supported for same session paste."),
Ec="Unknown",mf=2192,100!==Ua.validationFailureReason&&(Ec=Af[Ua.validationFailureReason],mf=Wf.Cff(Ua.validationFailureReason)),Ua=6===Ua.validationFailureReason,this.Qnc(A.commandType,A.expandDestinations)&&Ua&&this.qub(A.expandDestinations),this.XMa(mf,Ec,!0)):6===Ua.pasteErrorName?(ac=!0,gd="No-Op",Jd=Ec="Paste Formatting/Transpose is not yet a supported operation on System Clipboard based content",F.ULS.sendTraceTag(36263241,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Ec}, copyPasteTargetType="${A.copyPasteTargetType}"`)):
17===Ua.pasteErrorName?(ac=!0,gd="No-Op",Jd=Ec="Paste text on Art is not yet a supported operation",F.ULS.sendTraceTag(0,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Ec}, copyPasteTargetType="${A.copyPasteTargetType}"`)):16===Ua.pasteErrorName?(ac=!0,gd="No-Op",Jd=Ec="Paste has failed because the previous copy has failed",Ua=this.getStringifiedError(Ua),F.ULS.sendTraceTag(537167771,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Ec}, copyPasteTargetType="${A.copyPasteTargetType}", error=${Ua}`)):
kb.a.rx(Ua.ewaErrors)?(kb.a.cea(Ua.ewaErrors)||kb.a.Qn(Ua.ewaErrors,kb.a.LAc())?(ac=!0,gd="CommunicationError",Ec=kb.a.Kh(Ua.ewaErrors),F.ULS.sendTraceTag(36304159,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Jd} copyPasteTargetType="${A.copyPasteTargetType}"`)):kb.a.Qn(Ua.ewaErrors,Wf.ltk)?(ac=!0,gd="SavingWorkbookError",Ec=kb.a.Kh(Ua.ewaErrors),F.ULS.sendTraceTag(36304160,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Jd} copyPasteTargetType="${A.copyPasteTargetType}"`)):kb.a.Qn(Ua.ewaErrors,
Wf.operationSucceededWithAlert)&&(Xe=ac=!0,gd="OperationSucceededWithAlert",Ec=kb.a.Kh(Ua.ewaErrors),F.ULS.sendTraceTag(36304161,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${Jd} copyPasteTargetType="${A.copyPasteTargetType}"`)),ac||(Jd=this.Fyc(Ua.ewaErrors),ac=this.QTd(ja))):11===Ua.pasteErrorName&&(ac=!0,gd="No-Op",Jd="Paste has failed because user try copy cross-session oart object");15===ja.reason&&(ac=!0,gd="No-Op",Jd="Rejecting deferred paste there is metadata update without copy context. Usually it means that copy canceled before finished.");
ea.a.equals(De,Mf.n8k,!1)&&(ac=!0,gd="No-Op",Jd="User hash of the copy is different then the user hash of the paste during cross-session copy-paste. Do nothing.")}ac||(Ua=ja?this.getStringifiedError(ja):"null",F.ULS.sendTraceTag(24150916,0,10,`CopyPasteInfrastructure.OnPasteFailed: ${Ua}, copyPasteTargetType="${A.copyPasteTargetType}"`));this.ryj(A,ac,Jd,gd,De,ad,Xe,ja.pasteContext,lf);return Promise.reject(ja)}LNc(A,ja){var Ua;F.ULS.sendTraceTag(24150917,0,50,`CopyPasteInfrastructure.OnPasteSuccess: paste succeed. copyPasteTargetType="${ja.copyPasteTargetType}"`);
this.pasteIndicationManager.Rkb(ja.id,!0);if(this.c2j(ja.copyPasteTargetType,A)){Pf.a.B_a&&A.wasLastCopyExternal&&A.payloadType===ca.shadowWorkbook&&(this.fnb=!0);let ac=null;(null===(Ua=A.pastedRange)||void 0===Ua?0:Ua.Ranges)&&0<A.pastedRange.Ranges.length?ac=Sa.h(A.pastedRange.Ranges):A.wasLastCopyExternal||(ac=ja.expandDestinations);this.pvk(A,ac);if(this.vJk(A,ac)){Ua=Sa.d(ja.originalDestinations);const Ec=1028===ja.commandType?Sa.d(ja.expandDestinations):Sa.d(ac);let gd=null;A.wasLastCopyExternal&&
(ja.isKeyboardEvent||ja.isPasteCommandFromRecoveryUI)&&(gd={[Wf.Vqg]:A.clipboardItems});this.pasteDestinationHasMergedCells(ja.expandDestinations)&&(A.pasteDestinationHasMergedCells=!0);A.pasteRecoveryUIDisplayed=!0;const ad=new xg(this.$,Ua,Ec,gd,this.zoom),Jd=Object(Bb.d)(ka.a.resolve(Ha.Ze,{va:0}));264209770===ja.ribbonCommandInfo.command?this.da.za.rMa(()=>{$b.TaskExtensions.Ua(Jd,()=>{const De=Jd.result;De.Dqd(ad);De.yqe(ja.ribbonCommandInfo.method)},this.xa,8)}):$b.TaskExtensions.Ua(Jd,()=>
{const De=Jd.result;De.Dqd(ad);De.yqe(ja.ribbonCommandInfo.method,ja.event)},this.xa,8)}this.hNj(A,ac)}this.Roc("Paste/success/"+jc.a[ja.ribbonCommandInfo.method],A);this.tyj(A);this.nQg&&(!ja.isKeyboardEvent||Ag(A))&&this.$.ea.sn.get(66)&&(F.ULS.sendTraceTag(537167770,0,15,"CopyPasteInfrastructure.OnPasteSuccess: show localStorage disable notification"),this.nQg=!1,this.u0h());A=new Bi(ja.expandDestinations,A.commandParameters.ribbonCommandInfo.command);this.F$j(A);return Promise.resolve(!0)}hNj(A,
ja){Ha.jg.Ha()?void ka.a.resolve(Ha.jg,{va:1}).then(Ua=>{Ua.QZg(A,ja)}):$b.TaskExtensions.Ua(pc.GetServiceTaskFactory.Bj(this.$.ka,534,535,1),Ua=>{Ua.result.QZg(A,ja)},this.$.xa,3)}vJk(A,ja){return!ja||1!==ja.length||A.commandParameters.clearSystemClipboard||A.commandParameters.clearStateOnFinish||A.commandParameters.skipClipboardAccess?!1:Of(A)&&(ja=A.clipboardItems.getItem(Df.a.plainText),A=A.clipboardItems.getItem(Df.a.html),void 0===ja||null===ja||ja.length>this.SCj||void 0===A||null===A||A.length>
this.qYb)?(F.ULS.sendTraceTag(537167769,0,50,"CopyPasteInfrastructure.ShouldShowPasteRecoveryUI: Not showing PasteRecoveryUI for external copy."),!1):!0}c2j(A,ja){return 1===A||ja.payloadType===ca.plainText||ja.payloadType===ca.html||Pf.a.B_a&&ja.payloadType===ca.shadowWorkbook}pasteDestinationHasMergedCells(A){const ja=za.f(this.$).za.Zz();if(!ja||!ja.length)return!1;for(const Ua of ja)if(Ua.fD(A[0]))return!0;return!1}Roc(A,ja){let Ua;(()=>{let ac=this.Lfj(ja);({KVa:Ua}=ac);return ac})().returnValue&&
this.ux(A,Ua,void 0,void 0,ja.commandParameters.copyPasteTargetType).catch(()=>{})}agg(A,ja,Ua,ac,Ec,gd){const ad=A?this.getStringifiedError(A):"null";let Jd=!1,De=!1,Xe=!1,lf=Wf.Jgb,mf=Wf.Jnf+Wf.HHa;A&&(mf+=Wf.SIa(A),kb.a.rx(A.ewaErrors)?(lf=this.Fyc(A.ewaErrors),kb.a.Qn(A.ewaErrors,Wf.operationSucceededWithAlert)&&(Jd=!0),kb.a.Qn(A.ewaErrors,Wf.dragDropNonEmptyRange)&&(De=Xe=!0)):A.message&&(lf=A.message));Xe||(Xe=this.QTd(A));De?this.da.ha.selectionType=-1:this.Sz.gdk(Ec);Xe||F.ULS.sendTraceTag(24150918,
0,10,`CopyPasteInfrastructure.OnDragAndDropCellsFailed: ${ad}, copyPasteTargetType="${ja.copyPasteTargetType}`);this.dxj(ja,Ua,ac,Ec,Xe,lf,mf,Jd,gd)}Gnc(A,ja){let Ua=A;const ac=this.NMi();if(null===ac||void 0===ac?0:ac.ranges)Ua=this.Sz.LOh(ja,ac.ranges,A);return Ua}NMi(){const A=ng(this.yK);return A&&Ge(A.sourceItem)?A.sourceItem:null}$$j(){this.raiseEvent(Wf.V8d,null)}F$j(A){Object($i.d)(()=>{this.raiseEvent(Wf.N3c,A)})}pvk(A,ja){const Ua=A.commandParameters.originalDestinations;ja&&(Sa.W(this.da.ha.qa.selectedRanges,
Ua)?(this.qub(ja),A=Nd.HelperMethods.nHb(ja),F.ULS.sendTraceTag(537167767,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range, range: ${A}`)):A.commandParameters.isPasteCommandFromRecoveryUI?(this.qub(ja,!0),F.ULS.sendTraceTag(537167766,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range for IsPasteCommandFromRecoveryUI, range: ${ja}, active cell: ${ja[0].topLeft}`)):(A=Nd.HelperMethods.nHb(Ua),F.ULS.sendTraceTag(537167765,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: user change his selection during paste operation. don't change selection. originalPasteDestinations: ${A}`)))}Lfj(A){if(A.isPlainTextPaste||
A.isHtmlPaste||ig(A)||A.commandParameters.isPasteCommandFromEnterShortcut)return{returnValue:!0,KVa:!1};var ja=A.copyContextSnapshot;if(A.commandParameters.clearStateOnFinish)return{returnValue:!0,KVa:!0};if(ja&&Ge(ja.sourceItem)){var Ua=ja.sourceItem;if(!Ua.isFromCurrentSession(this.$))return{returnValue:!1,KVa:!0};ja=-1985798686===ja.commandParameters.ribbonCommandInfo.command;if(!(1<Ua.ranges.length||1<A.commandParameters.expandDestinations.length)){const ac=Sa.Q(Ua.ranges),Ec=Sa.Q(A.commandParameters.expandDestinations),
gd=this.$.ea.na.sheetName;Ua=Ua.sheetName;if(Ua===gd&&Ec.equals(ac))return{returnValue:!1,KVa:!0};if(Ua===gd&&Ec.pk(ac))return{returnValue:!(this.f1a&&A.commandParameters.isFormatPainter),KVa:!1}}return{returnValue:ja,KVa:!0}}return{returnValue:!1,KVa:!0}}sXj(){ng(this.yK)&&this.ux("OnStartEdit",!1).catch(()=>{})}iOj(){ng(this.yK)&&this.ux("OnEndEdit",!0).catch(()=>{})}Fyc(A){A=kb.a.NIi(A,Wf.HHa);return this.ODj+xa.a.jF(A).toString()}QTd(A){A=Wf.SIa(A);return!!A&&ea.a.YMb(A,Wf.NDj)}u0h(){const A=
kb.a.Yi(1,2,327,328,Da.a.Av?329:Da.a.YO?330:331,530046625,"ActivateLocalStorage"),ja=Object(Bb.d)(ka.a.resolve(Ha.C,{va:0}));$b.TaskExtensions.Ua(ja,()=>{ja.result.xm(43,A)},this.xa,3)}Mff(A){return void 0===A||null===A?tc.qHj:A?tc.success:tc.failed}static HZh(A){const ja=A.innerError;return ja&&0!==ja.pasteErrorName?A.innerError:null}static qZh(A){const ja=A.innerError;return ja&&0!==ja.copyErrorName?A.innerError:null}static SIa(A){let ja="";if(!A)return Wf.okf;A.errorName&&(ja=A.errorName,A.innerError&&
(ja+=Wf.HHa+Wf.SIa(A.innerError)));ja||(ja=A&&A.name?A.name:Wf.okf);return ja}static Mxc(){Wf.Qa||(Wf.Qa=cb.ROk);return Wf.Qa}static Cff(A){switch(A){case 7:case 1:return 2199;case 5:return 2196;case 6:return 2195;case 8:case 3:case 2:case 4:case 9:case 10:return 2192;default:return F.ULS.shipAssertTag(537167764,0,!1,`CopyPasteInfrastructure.ConvertPasteValidationOptionToJsStringId: no case for validationOptions = ${A}`),2199}}static rZh(A){switch(A){case 3:return 2193;case 1:return 2194;case 2:case 4:return 2192;
default:return F.ULS.shipAssertTag(537167763,0,!1,`CopyPasteInfrastructure.ConvertCopySourceValidationOptionToJsStringId: no case for validationOptions = ${A}`),2199}}}Wf.w$f="EwaJsMetadataChangeListenerId";Wf.V8d="cpiOSC";Wf.N3c="cpiPS";Wf.K9h="cpiDID";Wf.Jgb="Unknown";Wf.okf="UnknownError";Wf.HHa="_";Wf.Jnf="DragAndDropError";Wf.pasteErrorName="PasteError";Wf.iQh="CancelError";Wf.copyErrorName="CopyError";Wf.NDj="MergedCellOverlap";Wf.Vqg="PasteRecoveryCachedClipboardItems";Wf.ltk=[1352631530,1679665408];
Wf.operationSucceededWithAlert=[-103190598,1512686094];Wf.pasteDataLimitHit=[1306609195];Wf.copyThrottlingError=[-386183710];Wf.dragDropNonEmptyRange=[563945982];Wf.Qa=null;Object(K.a)(Wf,"CopyPasteInfrastructure",na.a,[892,893,2]);class sj{constructor(){this.pfb=this.scf=null}}Object(K.a)(sj,"ClipboardPlatformInitializationResult",null,[]);var ii=a(761),aj=a(760),rh=a(242),Ji=a(127);const Dh=(A,ja,Ua,ac,Ec,gd,ad,Jd)=>{Jd=void 0===Jd?null:Jd;ad=A.Za(1,ad);ad.pasteHtmlParameters=ja;return Yd.h(A,"PasteHtmlContent",
ad,Ua,ac,Ec,gd,64,Jd)},Ld=(A,ja,Ua,ac,Ec,gd,ad,Jd,De,Xe)=>{Xe=void 0===Xe?null:Xe;De=A.Za(9,De);const lf={};lf.DestinationRange=ja;lf.Source=Ua;lf.AutoAdjustColumnsOn=ac;De.pasteStringParameters=lf;return Yd.h(A,"PasteString",De,Ec,gd,ad,Jd,64,Xe)},ze=(A,ja,Ua,ac,Ec,gd,ad,Jd)=>{Jd=void 0===Jd?null:Jd;ad=A.Za(1,void 0===ad?null:ad);ad.copyParameters=ja;return Yd.h(A,"Copy",ad,Ua,ac,Ec,gd,0,Jd)},Bj=(A,ja,Ua,ac,Ec,gd,ad,Jd)=>{Jd=void 0===Jd?null:Jd;ad=A.Za(1,void 0===ad?null:ad);ad.pasteParameters=ja;
return Yd.h(A,"Paste",ad,Ua,ac,Ec,gd,64,Jd)};class Ah{constructor(A,ja,Ua){this.destinationRange=this.sourceRange=null;this.pasteFlags=0;this.sourceRange=A;this.destinationRange=ja;this.pasteFlags=Ua}}Object(K.a)(Ah,"MacroRecorderPasteRangePayload",null,[65]);class Hh{constructor(A,ja){this.content=this.destinationRange=null;this.destinationRange=A;this.content=ja}getContent(){return this.content}}Object(K.a)(Hh,"MacroRecorderPasteStringPayload",null,[65]);class Ki{constructor(A){this.pasteParameters=
null;this.pasteParameters=A}}Object(K.a)(Ki,"MacroRecorderPastePayload",null,[65]);var Rh=a(685),Cj=a(238);class Li{constructor(A){this.parameters=null;this.parameters=A}getParameters(){return this.parameters}}Object(K.a)(Li,"MacroRecorderRangeCopyCutCellsInsertedPayload",null,[65]);class Eh{constructor(A){this.sheetName=null;this.sheetName=A}getSheetName(){return this.sheetName}}Object(K.a)(Eh,"MacroRecorderFullSheetCopyPayload",null,[65]);class Ih{constructor(A,ja){this.LWb=this.lya=null;this.zEc=
ba.EwaSettings.getBooleanFeatureGate(Pf.a.$Kb,!1);this.URd=!1;this.h_=null;this.rE=(Ua,ac)=>{if(2===ac.By)this.uE.clear(),this.lya=null;else if(1===ac.By&&this.uE&&this.uE.contains(ac.Wl)){Ua=Ji.a(ac.Wl.operation.operationName);const Ec=ac.Wl.dequeueUtcTime.getTime()-ac.Wl.enqueueUtcTime.getTime();F.ULS.sendTraceTag(526758673,0,50,`CopyPasteUtils.OnQueueChanged: web method ${Ua} returned, it took ${Ec} milliseconds to complete.`);this.uE.remove(ac.Wl);this.lya=null}};this.$=A;this.da=ja;this.URd&&
(this.$.userOperationManager.px(this.rE),this.uE=new he.a);ob.a.vna()&&void ka.a.resolve(Ha.q,{va:1}).then(Ua=>{this.h_=Ua})}get qYb(){return this.$.ua.CCPCopyPasteHtmlLimit}get A9f(){return this.$.ua.CCPPastePlainTextLimit}copy(A,ja,Ua,ac,Ec){ac=void 0===ac?null:ac;Ec=void 0===Ec?null:Ec;const gd=this.$.pa.ta.Jh();this.URd&&this.k9();this.LWb=gd.ClientRequestId;var ad=new Lc.a(505,0,(Jd,De,Xe)=>{const lf={CopyPasteTargetType:1};lf.SourceRanges=A;lf.CopyOperationId=ja.id;return this.lya=ze(this.$.pa.$vd,
lf,jd.c(Jd,Ua),ac?jd.b(De,ac):De,Xe,ja.ribbonCommandInfo,gd,Ec)},80);ad=this.$.userOperationManager.enqueueOperation(ad,ja.ribbonCommandInfo);this.URd&&this.uE.add(ad)}fullSheetCopy(A,ja,Ua,ac){ac=void 0===ac?null:ac;const Ec=this.$.pa.ta.Jh();this.LWb=Ec.ClientRequestId;const gd=new Lc.a(609,0,(ad,Jd,De)=>{var Xe=this.$.pa.ta;ad=jd.c(ad,Ua);Jd=ac?jd.b(Jd,ac):Jd;var lf=ja.ribbonCommandInfo;const mf=Xe.Za(1,void 0===Ec?null:Ec);mf.sheetName=A;return this.lya=Yd.h(Xe,"CopySheetToShadowWorkbook",mf,
ad,Jd,De,lf,0)},80,()=>new Eh(A));this.$.userOperationManager.enqueueOperation(gd,ja.ribbonCommandInfo)}Uqg(A,ja,Ua,ac,Ec,gd){return new Promise((ad,Jd)=>{var De;const Xe=gd.commandParameters.stopwatch.ii;let lf=2;20===gd.commandParameters.commandType&&(lf=16);36===gd.commandParameters.commandType&&(lf=32);68===gd.commandParameters.commandType&&(lf=64);ob.a.pYd(this.$)&&1028===gd.commandParameters.commandType&&(lf=1024);4100===gd.commandParameters.commandType&&(lf=4096);let mf=null;if(null===(De=
gd.copyContextSnapshot)||void 0===De?0:De.commandParameters)mf=gd.copyContextSnapshot.commandParameters.id;Ih.sle(this.$,A,ac,ja,Ua,null,Rf=>{Ih.jBc(Rf,gd,ad,Jd,Xe,this.$,null,!0,null,null)},Rf=>{gd.serverRequestTimeInMs=gd.commandParameters.stopwatch.ii-Xe;Rf=bd.a.Qj(Rf.data);Jd(new qc(5,Rf))},Ec,lf,mf,gd.commandParameters.id)})}pasteRange(A,ja,Ua,ac,Ec,gd,ad,Jd,De,Xe){return new Promise((lf,mf)=>{const Rf=ad.commandParameters.stopwatch.ii;Ih.zwk(this.$,A,ja,Ua,ac|-5&Ec,sg=>{Ih.jBc(sg,ad,lf,mf,Rf,
this.$,null,!0,De,Xe)},sg=>{ad.serverRequestTimeInMs=ad.commandParameters.stopwatch.ii-Rf;sg=bd.a.Qj(sg.data);sg=new qc(5,sg);null===Xe||void 0===Xe?void 0:Xe(sg);mf(sg)},gd,Jd)})}R7j(A,ja,Ua,ac,Ec,gd,ad,Jd){const De=new ii.a;return new Promise((Xe,lf)=>{if(ja)if(ja.length>this.qYb){var mf=ad.clipboardItems.getItem(Df.a.plainText);let Rf=-1;void 0!==mf&&null!==mf&&(Rf=mf.length);F.ULS.sendTraceTag(42071712,0,15,`CopyPasteInfrastructure.ProcessPasteHtml copy paste length too long. clipboardHtml.Length: ${ja.length}, MaxHtmlImportLength: ${this.qYb}, PlainTextLength: ${Rf}`);
lf(new qc(1))}else mf=new Lc.a(204,0,(Rf,sg,wg)=>{this.$.AD();const Mg=ad.commandParameters.stopwatch.ii;Rf=jd.c(Rf,hj=>{Ha.jd.Ha()&&De.cancel();Ih.jBc(hj,ad,Xe,lf,Mg,this.$,ja,!1,null,null)});sg=jd.b(sg,hj=>{ad.serverRequestTimeInMs=ad.commandParameters.stopwatch.ii-Mg;hj=bd.a.Qj(hj.data);Ha.jd.Ha()&&De.cancel();lf(new qc(3,hj))});const Sg=this.$.pa.ta.Jh(),Qi=Sa.w(A,this.$),ci={};ci.SourceHtml=ja;ci.DestinationRanges=Qi?Sa.t(Qi):null;ci.CopyOperationId=Ua;ci.PasteId=ac;ci.AutoAdjustColumnsOn=this.IL();
return Dh(this.$.pa.$vd,ci,Rf,sg,wg,null,Sg,gd)},65),this.$.userOperationManager.enqueueOperation(mf,Ec),Ha.jd.Ha()&&this.Jpd(ad,ja,A,Jd,De),this.syj(ja);else Xe("")})}Jpd(A,ja,Ua,ac,Ec){return ac.Jpd(A,ja,Ua,Ec)}syj(A){if(A&&A.trim()&&ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8472105_EnablePasteHtmlTelemetry")){var ja=performance.now(),Ua=(new DOMParser).parseFromString(A,"text/html");if(Ua){A=[];Ua.querySelector("table table")&&A.push("NestedTable");Ua.querySelector("table ol")&&A.push("OrderedListInsideTable");
Ua.querySelector("table ul")&&A.push("UnorderedListInsideTable");Ua.querySelector("ol table")&&A.push("TableInsideOrderedList");Ua.querySelector("ul table")&&A.push("TableInsideUnorderedList");Ua.querySelector("ol ol")&&A.push("NestedOrderedList");Ua.querySelector("ul ul")&&A.push("NestedUnorderedList");Ua.querySelector("ol ul")&&A.push("UnorderedListInsideOrderedList");Ua.querySelector("ul ol")&&A.push("OrderedListInsideUnorderedList");Ua.querySelector("td[rowspan], td[colspan], th[rowspan], th[colspan]")&&
A.push("TableWithCellSpan");var ac=new Set;Ua.querySelectorAll("*").forEach(Ec=>{Ec.nodeType===Node.ELEMENT_NODE&&ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8708534_PasteHtmlTelemetryFix")&&Ma.includes(Ec.tagName)&&ac.add(Ec.tagName)});Ua=Array.from(ac);A.push(...Ua);ja=performance.now()-ja;F.ULS.sendTraceTag(507545676,0,50,`htmlClipboardItem.logPasteHtmlStructureTelemetry | tagAnalysisTotalTime: ${ja.toFixed(2)} ms, htmlTagAnalysisResult: ${JSON.stringify(A)}`)}}}IL(){return null==this.h_?!1:
this.h_.IL}S7j(A,ja,Ua,ac,Ec){return new Promise((gd,ad)=>{F.ULS.sendTraceTag(537167754,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: method start. pasteContext.Id=${Ec.id}`);ja&&(ja=ea.a.trimEnd(ja,"\n","\r"));F.ULS.sendTraceTag(537167753,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after clipboardText.TrimEnd. pasteContext.Id=${Ec.id}`);if(ja)if(ja.length>this.A9f)F.ULS.sendTraceTag(24150921,0,15,"CopyPasteInfrastructure.ProcessPasteText copy paste length too long. clipboardText.Length: {0}, MaxCopyPasteLength: {1}",
ja.length,this.A9f),ad(new qc(1));else{let De,Xe;const lf=Sa.w(A,this.$);F.ULS.sendTraceTag(537167752,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before treatAsLink calculation. pasteContext.Id=${Ec.id}`);var Jd=!this.$.ea.isNamedObjectViewMode&&!ja.includes("\n")&&!ja.includes("\t");F.ULS.sendTraceTag(537167751,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before isLink check. pasteContext.Id=${Ec.id}. treatAsLink=${Jd}`);Jd=Jd&&ea.a.NXf(ja);F.ULS.sendTraceTag(537167750,
0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after treatAsLink calculation. pasteContext.Id=${Ec.id}. treatAsLink=${Jd}`);const mf=this.$.pa.ta.Jh();if(Jd){Xe=526;F.ULS.sendTraceTag(537167749,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before FixUpUrl. pasteContext.Id=${Ec.id}`);const Rf=Cj.a.Ewc(ja);F.ULS.sendTraceTag(537167748,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after FixUpUrl. pasteContext.Id=${Ec.id}`);const sg=Sa.t(lf);Jd=(wg,
Mg,Sg)=>{const Qi=Ec.commandParameters.stopwatch.ii;wg=jd.c(wg,ci=>{F.ULS.sendTraceTag(537167747,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: on ApplyHyperlink successCallback. pasteContext.Id=${Ec.id}`);Ec.requestTelemetryData=ci.RequestTelemetryData;Ec.serverRequestTimeInMs=Ec.commandParameters.stopwatch.ii-Qi;ci.Errors&&0<ci.Errors.length?ad(new qc(2,ci.Errors)):gd(ja)});Mg=jd.b(Mg,ci=>{Ec.serverRequestTimeInMs=Ec.commandParameters.stopwatch.ii-Qi;ci=bd.a.Qj(ci.data);ad(new qc(2,
ci))});this.$.AD();F.ULS.sendTraceTag(537167746,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before ApplyHyperlink. pasteContext.Id=${Ec.id}`);return Yd.b(this.$.pa.ta,sg,ja,Rf,!1,!1,63,wg,Mg,Sg,A,mf,ac)};De=()=>new Rh.a(sg,ja,Rf)}else Xe=180,Jd=(Rf,sg,wg)=>{this.$.AD();const Mg=Ec.commandParameters.stopwatch.ii;Rf=jd.c(Rf,Sg=>{F.ULS.sendTraceTag(537167745,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: on PasteString successCallback. pasteContext.Id=${Ec.id}`);
Ih.jBc(Sg,Ec,gd,ad,Mg,this.$,ja,!1,null,null)});sg=jd.b(sg,Sg=>{Ec.serverRequestTimeInMs=Ec.commandParameters.stopwatch.ii-Mg;Sg=bd.a.Qj(Sg.data);ad(new qc(4,Sg))});F.ULS.sendTraceTag(537167744,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before PasteString. pasteContext.Id=${Ec.id}`);return Ld(this.$.pa.$vd,lf,ja,this.IL(),Rf,sg,wg,null,mf,ac)},De=()=>new Hh(lf,ja);F.ULS.sendTraceTag(537167715,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before UserWebMethodOperation. pasteContext.Id=${Ec.id}`);
Jd=new Lc.a(Xe,0,Jd,65,De);F.ULS.sendTraceTag(537167714,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: returning. pasteContext.Id=${Ec.id}`);this.$.userOperationManager.enqueueOperation(Jd,Ua)}else gd("")})}nPf(A,ja){ja=[1===ja?4:5];this.da.rh.BP(Ze.a.d8a(lg.d(this.$.na),A),ja,!0);this.da.rh.rw(ja);this.da.rh.update(!0)}hPd(){const A=[4,5];this.da.rh.zq(A,!1,!1);this.da.rh.Vs(null,A,!1);1===this.da.ha.wk&&this.da.rw(!1,!1);this.da.rh.update(!1,!1)}LOh(A,ja,Ua){const ac=[];for(const Ec of Ua)ac.push(this.SOh(A,
ja,Ec));return ac}k9(){if(this.uE)for(const A of this.uE)if(this.$&&this.$.userOperationManager){if(A.operation){const ja=Ji.a(A.operation.operationName);F.ULS.sendTraceTag(526758675,0,50,`CopyPasteUtils.AbortOutstandingUserOperation: Trying to abort pending operation ${ja}.`)}this.gQh();this.$.userOperationManager.cva(A)}}gQh(){if(this.lya){const A=this.lya.TC;F.ULS.sendTraceTag(526758674,0,15,`Cancelling pending copy request with Id=${A}`);bd.a.HD(A);!ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6151555_DisableCancelCopyRequest")&&
this.LWb&&Yd.i(this.$.pa.ta,this.LWb,null,null,null);this.LWb=this.lya=null}}SOh(A,ja,Ua){F.ULS.shipAssertTag(537167713,0,!!ja,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray shouldn't be null");F.ULS.shipAssertTag(537167712,0,0<ja.length,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray length shouldn't be zero");let ac=0,Ec=0;var gd=new Set;const ad=new Set;for(const Jd of ja){ja=`${Jd.left}_${Jd.right}`;const De=`${Jd.top}_${Jd.bottom}`;ad.has(ja)||(ad.add(ja),Ec+=Jd.width);gd.has(De)||
(gd.add(De),ac+=Jd.height)}if(36===A)return Ua.isSingle?Ih.nvf(Ec,ac,Ua):Ua.clone();516===A&&(A=ac,ac=Ec,Ec=A);A=!(Ua.width%Ec)&&!(Ua.height%ac);gd=Ua.I0&&!(Ua.height%ac);Ua.Daa&&!(Ua.width%Ec)||gd?Ua=Ih.nvf(Ec,ac,Ua):A?Ua=Ua.clone():(Ua=Ua.clone(),Ua.bottom=Math.min(xd.a.gl,Ua.top+ac-1),Ua.right=Math.min(xd.a.Qk,Ua.left+Ec-1));return Ua}BFh(A,ja,Ua,ac,Ec,gd,ad,Jd,De,Xe,lf){if(!ac||!ac.length)return 1;if(1<ac.length){if(!this.zEc&&gd)return 3;if(Xe)return 0;if(Jd)return 9;if(De)return 8;if(lf)return 2;
if(1<ja.length)return 4;const mf=ja[0];if(!ad&&!rh.a.all(ac,Rf=>Rf.isSingle||!(Rf.width%mf.width)&&!(Rf.height%mf.height)))return 5;if((!this.zEc||!gd)&&ea.a.equals(A,Ua,!0))for(const Rf of Ec)if(Rf.yi(mf)&&!Rf.equals(mf))return 6}else if(ja&&0<ja.length){if(0!==this.LUf(ja,De))return 7;if(1<ja.length){if(!this.zEc&&gd)return 3;if((!this.zEc||!gd)&&ea.a.equals(A,Ua,!0))for(const mf of ja)if(A=Ec[0],mf.yi(A)&&!mf.equals(A))return 6}}return 0}LUf(A,ja){if(!A||1>=A.length)return 0;if(ja)return 2;if(!Sa.Y(A))return 1;
ja=new aj.a(pg.a.lm());for(const Ua of A)for(const ac of A){const Ec=Ua.top===ac.top&&Ua.bottom===ac.bottom,gd=Ua.left===ac.left&&Ua.right===ac.right,ad=Math.max(Ua.left,ac.left)<Math.min(Ua.right,ac.right);if(Math.max(Ua.top,ac.top)<Math.min(Ua.bottom,ac.bottom)&&!Ec||ad&&!gd)return 3;ja.add(`${Ua.top}-${Ua.bottom}-${ac.left}-${ac.right}`);ja.add(`${ac.top}-${ac.bottom}-${Ua.left}-${Ua.right}`)}for(const Ua of A)ja.remove(`${Ua.top}-${Ua.bottom}-${Ua.left}-${Ua.right}`);return 0<ja.count?3:0}gdk(A){const ja=
this.da.ha;ja.updateSelection(A,A.topLeft,0);ja.selectionType=-1}Szc(A){if(null===A||void 0===A?0:A.sourceItem){if(!Ge(A.sourceItem))return null;if((A=A.sourceItem)&&Sa.lb(A.ranges,!0))return A}return null}lmb(A,ja){F.ULS.shipAssertTag(537167711,0,!!A,"CopyPasteUtils.IsFromKeyboardShortcut: commandInfo shouldn't be null");return ja&&P.a.FE in ja||A.tabName?!1:1===A.method}static zwk(A,ja,Ua,ac,Ec,gd,ad,Jd,De){const Xe=A.pa.ta.Jh(De?{Cya:!0,ixa:1}:{Cya:!1,ixa:0});De=new Lc.a(506,0,(lf,mf,Rf)=>{A.AD();
var sg=A.pa.ta;lf=jd.c(lf,gd);mf=jd.b(mf,ad);var wg=Jd;wg=void 0===wg?null:wg;const Mg=sg.Za(9,Xe);Mg.sourceRanges=Ua;Mg.destinationRanges=ac;Mg.flags=Ec;return Yd.h(sg,"PasteRange",Mg,lf,mf,Rf,null,64,wg)},65,()=>new Ah(Ua,ac,Ec));A.userOperationManager.enqueueOperation(De,ja)}static jBc(A,ja,Ua,ac,Ec,gd,ad,Jd,De,Xe){ad=void 0===ad?null:ad;F.ULS.sendTraceTag(537167710,0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: on HandlePasteResult start. pasteContext.Id=${ja.id}`);ja.requestTelemetryData=
A.RequestTelemetryData;ja.serverRequestTimeInMs=ja.commandParameters.stopwatch.ii-Ec;kb.a.Jk(A.Errors)?kb.a.Hta(A.Errors)?(ja&&(ja.encounteredDeploymentErrors=!0),A=kb.a.Kh(A.Errors),F.ULS.sendTraceTag(537167707,0,15,`CopyPasteUtils.HandlePasteServerResponse: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${A}`)):(A=new qc(5,A.Errors),null===Xe||void 0===Xe?void 0:Xe(A),ac(A)):A.Result?(ac=!!A&&!!A.RequestTelemetryData,za.f(gd).nk.V0(ja.commandParameters.stopwatch.id,
A.StateId,ac?A.RequestTelemetryData.EcsOperationDuration:0,ac?A.RequestTelemetryData.EcsRequestDuration:0,ac?A.RequestTelemetryData.WfeRequestDuration:0),ac=A.Result,ja.pastedRange=ac.SheetMultiRange,F.ULS.sendTraceTag(537167708,0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise ewaResult.Result is not null. pasteContext.Id=${ja.id}`),null===De||void 0===De?void 0:De(),Ua(!0),ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",
!0)&&Jd&&!ja.commandParameters.isDragDrop?(ja=ka.a.Zg(Ha.ke))&&ja.Mia(6,A):ob.a.vna()&&ac.AutoAdjustedColumns&&void ka.a.resolve(Ha.q,{va:1}).then(lf=>{lf.Qdg("Paste")})):(F.ULS.sendTraceTag(537167709,0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise when ewaResult.Result is null. pasteContext.Id=${ja.id}`),Ua(ad||!0))}static sle(A,ja,Ua,ac,Ec,gd,ad,Jd,De,Xe,lf,mf){const Rf=A.pa.ta.Jh(),sg=Ih.jif(Ua,ac,Ec,Xe,lf,mf);Ua=new Lc.a(503,0,(wg,Mg,Sg)=>{A.AD();return Bj(A.pa.ta,
sg,jd.c(wg,ad),jd.b(Mg,Jd),Sg,gd,Rf,De)},65,()=>new Ki(sg));A.userOperationManager.enqueueOperation(Ua,ja)}static jif(A,ja,Ua,ac,Ec,gd){const ad={};ad.ShadowWorkbookBase64=A.shadowWorkbookBase64;ad.SourceRanges={};ad.SourceRanges.Ranges=Array(1);ad.SourceRanges.Ranges[0]={};ad.SourceRanges.Ranges[0].FirstRow=A.rangeRowStart;ad.SourceRanges.Ranges[0].LastRow=A.rangeRowEnd;ad.SourceRanges.Ranges[0].FirstColumn=A.rangeColumnStart;ad.SourceRanges.Ranges[0].LastColumn=A.rangeColumnEnd;ba.EwaSettings.getBooleanFeatureGate(Pf.a.$Kb,
!1)?Ua?ad.DestinationRanges=Sa.v(Ua.SheetName,Ua.NamedObjectName,Sa.h(Ua.Ranges)):(F.ULS.sendTraceTag(537167706,0,15,"CopyPasteInfrastructure.CreatePasteParameters: multiRangeDestination is null"),ad.DestinationRanges=null):ad.DestinationRanges=ja?Sa.t(ja):null;ad.CopyPasteTargetType=1;ad.PasteType=ac;ad.CopyOperationId=Ec;ad.PasteId=gd;ad.SourceClientPath=A.sourceClientPath;ad.SourceSheetName=A.sourceSheetName;ad.SourceWorkbookName=A.sourceWorkbookName;if(!A.originalSourceRangesCountExceedsLimit&&
A.originalSourceRanges&&0<A.originalSourceRanges.length&&1024===ac){ad.OriginalSourceMultiRange={};ja=Array(A.originalSourceRanges.length);for(Ua=0;Ua<ja.length;++Ua)ja[Ua]={},ja[Ua].FirstRow=A.originalSourceRanges[Ua][0],ja[Ua].FirstColumn=A.originalSourceRanges[Ua][1],ja[Ua].LastRow=A.originalSourceRanges[Ua][2],ja[Ua].LastColumn=A.originalSourceRanges[Ua][3];ad.OriginalSourceMultiRange.Ranges=ja}return ad}static nvf(A,ja,Ua){Ua=Ua.clone();Ua.height<ja&&(Ua.bottom=Math.min(xd.a.gl,Ua.top+ja-1));
Ua.width<A&&(Ua.right=Math.min(xd.a.Qk,Ua.left+A-1));return Ua}WIk(A,ja,Ua){return(A=za.f(A).Yg.sl(Ua))?ja.width===A.usedRange.width&&Ua.left===A.usedRange.left||Ua.left===A.usedRange.left&&Ua.right===A.usedRange.right&&0===Ua.width%ja.width:!1}VIk(A,ja,Ua){return(A=za.f(A).Yg.sl(Ua))?ja.height===A.usedRange.height&&Ua.top===A.usedRange.top||Ua.top===A.usedRange.top&&Ua.bottom===A.usedRange.bottom&&0===Ua.height%ja.height:!1}executeInsertCopiedCutCellsOperation(A,ja,Ua,ac,Ec,gd,ad){gd=void 0===gd?
null:gd;ad=void 0===ad?null:ad;const Jd={};Jd.InsertDirection=ac;Jd.SourceRange=A;Jd.DestRange=ja;Jd.CopyCutOperation=Ua?0:1;const De=this.$.pa.ta,Xe=this.$.pa.ta.Jh(),lf=()=>new Li(Jd);return gf.a(this.$.userOperationManager,(mf,Rf,sg)=>{mf=gd?jd.c(mf,gd):mf;Rf=ad?jd.b(Rf,ad):Rf;const wg=De.Za(41,null);wg.insertCopiedCutCellsParameters=Jd;return Yd.h(De,"InsertCopiedCutCellsV2",wg,mf,Rf,sg,Xe,0)},mf=>new Lc.a(104,0,mf,void 0,lf),Ec)}mei(A,ja,Ua,ac,Ec,gd,ad,Jd){return new Promise((De,Xe)=>{this.executeInsertCopiedCutCellsOperation(ja,
Ua,ac,Ec,gd,lf=>{A.requestTelemetryData=lf.RequestTelemetryData;if(lf.Errors&&0<lf.Errors.length){const mf=new qc(21,lf.Errors);null===Jd||void 0===Jd?void 0:Jd(mf);Xe(new qc(21,lf.Errors))}else null===ad||void 0===ad?void 0:ad(),De(!0)},lf=>{lf=bd.a.Qj(lf.data);lf=new qc(21,lf);null===Jd||void 0===Jd?void 0:Jd(lf);Xe(lf)})})}executeInsertCopiedCutCellsAcrossSession(A,ja,Ua,ac,Ec,gd,ad,Jd,De,Xe,lf){gd=void 0===gd?null:gd;ad=void 0===ad?null:ad;const mf={};mf.PasteParameters=Ih.jif(Xe,Jd,De,2,lf.copyContextSnapshot.commandParameters.id,
lf.commandParameters.id);mf.InsertDirection=ac;mf.SourceRange=A;mf.DestRange=ja;mf.CopyCutOperation=Ua?0:1;const Rf=this.$.pa.ta,sg=this.$.pa.ta.Jh(),wg=()=>new Li(mf);return gf.a(this.$.userOperationManager,(Mg,Sg,Qi)=>{Mg=gd?jd.c(Mg,gd):Mg;Sg=ad?jd.b(Sg,ad):Sg;const ci=Rf.Za(41,null);ci.insertCopiedCutCellsParameters=mf;return Yd.h(Rf,"InsertCopiedCutCellsCrossSession",ci,Mg,Sg,Qi,sg,0)},Mg=>new Lc.a(106,0,Mg,void 0,wg),Ec)}}Object(K.a)(Ih,"CopyPasteUtils",null,[890]);var qi=a(496),Si;(function(A){A[A.range=
0]="range";A[A.art=1]="art";A[A.nonGrid=2]="nonGrid";A[A.fullSheet=3]="fullSheet"})(Si||(Si={}));Object(K.b)("SourceItemType",Si);class dj extends ae{constructor(A,ja,Ua){super(ja,Ua);this.sheetName=A}isEqual(A){return A&&Object.getType(A)===dj?this.ZEc(A)&&this.sheetName===A.sheetName:!1}}Object(K.a)(dj,"FullSheetSourceItem",ae,[]);class ri{constructor(A){this.uVg={["SourceItemType.Range"]:0,["SourceItemType.Art"]:1,["SourceItemType.NonGrid"]:2,["SourceItemType.FullSheet"]:3};this.r7a={};this.qVg=
{["FloatingObjectType.Unknown"]:99,["FloatingObjectType.CardView"]:6,["FloatingObjectType.Chart"]:0,["FloatingObjectType.Group"]:7,["FloatingObjectType.Image"]:1,["FloatingObjectType.Ink"]:8,["FloatingObjectType.InteractiveReport"]:4,["FloatingObjectType.ModernOfficeExtension"]:3,["FloatingObjectType.Shape"]:5,["FloatingObjectType.Slicer"]:2,["FloatingObjectType.Unsupported"]:100};this.tpd={["99"]:"FloatingObjectType.Unknown",["6"]:"FloatingObjectType.CardView",["0"]:"FloatingObjectType.Chart",["7"]:"FloatingObjectType.Group",
["1"]:"FloatingObjectType.Image",["8"]:"FloatingObjectType.Ink",["4"]:"FloatingObjectType.InteractiveReport",["3"]:"FloatingObjectType.ModernOfficeExtension",["5"]:"FloatingObjectType.Shape",["2"]:"FloatingObjectType.Slicer",["100"]:"FloatingObjectType.Unsupported"};this.tVg={["RibbonCommand.Copy"]:-911352779,["RibbonCommand.Cut"]:-1985798686,["RibbonCommand.WriteToClipboard"]:396830482,["RibbonCommand.FullSheetCopy"]:-207190267};this.lje={["-911352779"]:"RibbonCommand.Copy",["-1985798686"]:"RibbonCommand.Cut",
["396830482"]:"RibbonCommand.WriteToClipboard",["-207190267"]:"RibbonCommand.FullSheetCopy"};this.sVg={["InputManager.InputMethod.NotDefined"]:-1,["InputManager.InputMethod.Unknown"]:0,["InputManager.InputMethod.Keyboard"]:1,["InputManager.InputMethod.Mouse"]:2,["InputManager.InputMethod.Touch"]:3,["InputManager.InputMethod.CrossSlide"]:9};this.gxa={};this.rVg={["FrameMode.None"]:0,["FrameMode.Reading"]:1,["FrameMode.Edit"]:2};this.Rib={};this.vVg={["UILocation.Unknown"]:0,["UILocation.UpperRibbon"]:1,
["UILocation.Ribbon"]:2,["UILocation.QAT"]:3,["UILocation.Jewel"]:4,["UILocation.NavigationPane"]:5,["UILocation.KeyboardShortcut"]:6,["UILocation.StatusBar"]:7,["UILocation.Dialog"]:8,["UILocation.Floatie"]:9,["UILocation.NotificationBar"]:10,["UILocation.StandaloneCuiRoot"]:11,["UILocation.TaskPane"]:12,["UILocation.HeroDock"]:13,["UILocation.SingleLineRibbon"]:14,["UILocation.MultilineRibbon"]:15,["UILocation.Overflow"]:16,["UILocation.TellMe"]:17,["UILocation.FarPeripheralControls"]:18,["UILocation.ContextMenu"]:19,
["UILocation.DialogMenu"]:20,["UILocation.Header"]:21,["UILocation.FileMenu"]:22,["UILocation.Toolbar"]:26,["UILocation.Canvas"]:30};this.vA={};this.$=A;this.gxa.notDefined="InputManager.InputMethod.NotDefined";this.gxa.unknown="InputManager.InputMethod.Unknown";this.gxa.keyboard="InputManager.InputMethod.Keyboard";this.gxa.mouse="InputManager.InputMethod.Mouse";this.gxa.touch="InputManager.InputMethod.Touch";this.gxa.crossSlide="InputManager.InputMethod.CrossSlide";this.Rib.none="FrameMode.None";
this.Rib.reading="FrameMode.Reading";this.Rib.edit="FrameMode.Edit";this.vA.unknown="UILocation.Unknown";this.vA.upperRibbon="UILocation.UpperRibbon";this.vA.ribbon="UILocation.Ribbon";this.vA.QAT="UILocation.QAT";this.vA.jewel="UILocation.Jewel";this.vA.navigationPane="UILocation.NavigationPane";this.vA.keyboardShortcut="UILocation.KeyboardShortcut";this.vA.statusBar="UILocation.StatusBar";this.vA.dialog="UILocation.Dialog";this.vA.floatie="UILocation.Floatie";this.vA.notificationBar="UILocation.NotificationBar";
this.vA.standaloneCuiRoot="UILocation.StandaloneCuiRoot";this.vA.taskPane="UILocation.TaskPane";this.vA.heroDock="UILocation.HeroDock";this.vA.singleLineRibbon="UILocation.SingleLineRibbon";this.vA.multilineRibbon="UILocation.MultilineRibbon";this.vA.overflow="UILocation.Overflow";this.vA.tellMe="UILocation.TellMe";this.vA.farPeripheralControls="UILocation.FarPeripheralControls";this.vA.header="UILocation.Header";this.vA.fileMenu="UILocation.FileMenu";this.vA.contextMenu="UILocation.ContextMenu";
this.vA.dialogMenu="UILocation.DialogMenu";this.vA.toolbar="UILocation.Toolbar";this.vA.canvas="UILocation.Canvas";this.r7a.range="SourceItemType.Range";this.r7a.art="SourceItemType.Art";this.r7a.nonGrid="SourceItemType.NonGrid";this.r7a.fullSheet="SourceItemType.FullSheet"}serializeSourceItem(A){const ja={};if(A&&Object.getType(A)===Je)ja.sheetName=A.sheetName,ja.topArray=rh.a.map(A.ranges,Ua=>Ua.top),ja.leftArray=rh.a.map(A.ranges,Ua=>Ua.left),ja.bottomArray=rh.a.map(A.ranges,Ua=>Ua.bottom),ja.rightArray=
rh.a.map(A.ranges,Ua=>Ua.right),ja.sessionStateId=A.sessionStateId,ja.sessionId=A.sessionId,ja.sourceItemType=this.BVc(0);else if(A&&Object.getType(A)===ne)ja.activeFloatingObjectControlId=A.activeFloatingObjectControlId,ja.sheetName=A.sheetName,ja.sessionStateId=A.sessionStateId,ja.sessionId=A.sessionId,ja.floatingObjectType=this.fxk(A.type),ja.sourceItemType=this.BVc(1);else if(A&&Object.getType(A)===Vd)ja.sessionStateId=A.sessionStateId,ja.sessionId=A.sessionId,ja.sourceItemType=this.BVc(2);else if(A&&
Object.getType(A)===dj)ja.sheetName=A.sheetName,ja.sessionStateId=A.sessionStateId,ja.sessionId=A.sessionId,ja.sourceItemType=this.BVc(3);else return F.ULS.shipAssertTag(537167705,0,!1,"EnvironmentSerializationHelper.SerializeSourceItem: sourceItem shouldn't be null."),null;return JSON.stringify(ja)}serializeCommandParameters(A){if(!A)return F.ULS.shipAssertTag(537167704,0,!1,"EnvironmentSerializationHelper.Serialize: commandParameters shouldn't be null."),null;const ja={};ja.id=A.id;ja.commandType=
A.commandType;ja.copyPasteTargetType=A.copyPasteTargetType;A.ribbonCommandInfo&&(ja.ribbonCommandName=this.pxk(A.ribbonCommandInfo.command),ja.inputMethodName=this.jxk(A.ribbonCommandInfo.method),ja.frameModeName=this.hxk(A.ribbonCommandInfo.mode),ja.uiLocationName=this.txk(A.ribbonCommandInfo.lk),ja.tabName=A.ribbonCommandInfo.tabName);return JSON.stringify(ja)}deserializeSourceItem(A){if(!A)return null;try{const ja=JSON.parse(A);if(!ja)return F.ULS.shipAssertTag(537167703,0,!1,"EnvironmentSerializationHelper.Deserialize: Json.Parse return null result."),
null;let Ua=null;switch(this.W$h(ja.sourceItemType)){case 0:Ua=new Je(this.$,this.T$h(ja),ja.sheetName,ja.sessionStateId,ja.sessionId);break;case 1:Ua=new ne(ja.activeFloatingObjectControlId,ja.sheetName,ja.sessionStateId,ja.sessionId,this.Q$h(ja.floatingObjectType));break;case 2:Ua=new Vd(ja.sessionStateId,ja.sessionId);break;case 3:Ua=new dj(ja.sheetName,ja.sessionStateId,ja.sessionId)}return Ua}catch(ja){return F.ULS.sendTraceTag(537167702,0,10,`EnvironmentSerializationHelper.DeserializeSourceItem: got exception while try to JSON.Parse string length: ${A?
A.length:0}, errror: ${ja}`),null}}deserializeCommandParameters(A){if(!A)return null;try{const ja=JSON.parse(A);if(!ja)return F.ULS.shipAssertTag(537167701,0,!1,"EnvironmentSerializationHelper.DeserializeCommandParameters: Json.Parse return null result."),null;const Ua=Kc.a();Ua.id=ja.id;Ua.ribbonCommandInfo=this.V$h(ja);Ua.commandType=ja.commandType;Ua.copyPasteTargetType=ja.copyPasteTargetType;return Ua}catch(ja){return F.ULS.sendTraceTag(537167700,0,10,`EnvironmentSerializationHelper.DeserializeCommandParameters: got exception while try to JSON.Parse string length: ${A?
A.length:0}, errror: ${ja}`),null}}T$h(A){const ja=[];F.ULS.shipAssertTag(537167699,0,!!A.topArray&&0<A.topArray.length,`EnvironmentSerializationHelper.DeserializeRanges: TopArray shouldn't be ${A.topArray?"empty":"null"}.`);F.ULS.shipAssertTag(537167698,0,!!A.leftArray&&0<A.leftArray.length,`EnvironmentSerializationHelper.DeserializeRanges: LeftArray shouldn't be ${A.leftArray?"empty":"null"}.`);F.ULS.shipAssertTag(537167697,0,!!A.bottomArray&&0<A.bottomArray.length,`EnvironmentSerializationHelper.DeserializeRanges: BottomArray shouldn't be ${A.bottomArray?
"empty":"null"}.`);F.ULS.shipAssertTag(537167696,0,!!A.rightArray&&0<A.rightArray.length,`EnvironmentSerializationHelper.DeserializeRanges: RightArray shouldn't be ${A.rightArray?"empty":"null"}.`);if(!(A.topArray&&A.leftArray&&A.bottomArray&&A.rightArray))return ja;F.ULS.shipAssertTag(537167695,0,A.topArray.length===A.bottomArray.length&&A.topArray.length===A.leftArray.length&&A.topArray.length===A.rightArray.length,`EnvironmentSerializationHelper.DeserializeRanges: The length of TopArray(${A.topArray.length}), BottomArray(${A.bottomArray.length}), LeftArray(${A.leftArray.length}), RightArray(${A.rightArray.length}) should be the same.`);
const Ua=Math.min(A.topArray.length,A.bottomArray.length,A.leftArray.length,A.rightArray.length);for(let ac=0;ac<Ua;ac++)ja.push(new yd.Range(A.topArray[ac],A.leftArray[ac],A.bottomArray[ac],A.rightArray[ac],!1,!1));return ja}V$h(A){return new Ib.a(this.U$h(A.ribbonCommandName),this.S$h(A.inputMethodName),this.R$h(A.frameModeName),this.Y$h(A.uiLocationName),A.tabName)}pxk(A){return void 0!==A&&null!==A&&A.toString()in this.lje?this.lje[A.toString()]:(F.ULS.shipAssertTag(537167694,0,!1,`EnvironmentSerializationHelper.SerializeRibbonCommand expected to get RibbonCommand.Copy(${-911352779}) or RibbonCommand.Cut(${-1985798686}) but got ${A}`),
this.lje["-911352779"])}U$h(A){return A&&A in this.tVg?this.tVg[A]:(F.ULS.shipAssertTag(537167693,0,!1,`EnvironmentSerializationHelper.DeserializeRibbonCommand: expected to get RibbonCommand.Copy(${-911352779}) or RibbonCommand.Cut(${-1985798686}) but got ${A}`),-911352779)}jxk(A){return void 0!==A&&null!==A&&jc.a[A]in this.gxa?this.gxa[jc.a[A]]:(F.ULS.shipAssertTag(537167692,0,!1,`EnvironmentSerializationHelper.SerializeInputMethod: got unexpected value ${A}`),this.gxa.unknown)}S$h(A){return A&&
A in this.sVg?this.sVg[A]:(F.ULS.shipAssertTag(537167691,0,!1,`EnvironmentSerializationHelper.DeserializeInputMethod: got unexpected value ${A}`),0)}hxk(A){return void 0!==A&&null!==A&&qi.a[A]in this.Rib?this.Rib[qi.a[A]]:(F.ULS.shipAssertTag(537167690,0,!1,`EnvironmentSerializationHelper.SerializeFrameMode: got unexpected value ${A}`),this.Rib.edit)}R$h(A){return A&&A in this.rVg?this.rVg[A]:(F.ULS.shipAssertTag(537167689,0,!1,`EnvironmentSerializationHelper.DeserializeFrameMode: got unexpected value ${A}`),
2)}BVc(A){return void 0!==A&&null!==A&&Si[A]in this.r7a?this.r7a[Si[A]]:(F.ULS.shipAssertTag(537167688,0,!1,`EnvironmentSerializationHelper.SerializeSourceItemType: got unexpected value ${A}`),this.r7a.range)}W$h(A){return A&&A in this.uVg?this.uVg[A]:(F.ULS.shipAssertTag(537167687,0,!1,`EnvironmentSerializationHelper.DeserializeSourceItemType: got unexpected value ${A}`),0)}fxk(A){return void 0!==A&&null!==A&&A.toString()in this.tpd?this.tpd[A.toString()]:(F.ULS.shipAssertTag(537167686,0,!1,`EnvironmentSerializationHelper.SerializeArtSourceItemType: got unexpected value ${A}`),
this.tpd["99"])}Q$h(A){return A&&A in this.qVg?this.qVg[A]:(F.ULS.shipAssertTag(537167685,0,!1,`EnvironmentSerializationHelper.DeserializeArtSourceItemType: got unexpected value ${A}`),99)}txk(A){return void 0!==A&&null!==A&&Zc.a[A]in this.vA?this.vA[Zc.a[A]]:(F.ULS.shipAssertTag(36229129,0,!1,`EnvironmentSerializationHelper.SerializeUILocation: got unexpected value ${A}`),this.vA.ribbon)}Y$h(A){return A&&A in this.vVg?this.vVg[A]:(F.ULS.shipAssertTag(537167684,0,!1,`EnvironmentSerializationHelper.DeserializeUILocation: got unexpected value ${A}`),
2)}}Object(K.a)(ri,"EnvironmentSerializationHelper",null,[]);class Ig{}Ig.sHg="SameSession";Ig.Jxd="CrossSession";Ig.x3f="LegacyCrossSession";Ig.external="External";Object(K.a)(Ig,"PayloadOrigin",null,[]);const Fh=A=>A?A.shadowWorkbookSizeExceedsLimit&&void 0!==A.shadowWorkbookBlockedSize&&null!==A.shadowWorkbookBlockedSize?A.shadowWorkbookBlockedSize:A.shadowWorkbookBase64?A.shadowWorkbookBase64.length:0:0,si=A=>A.shadowWorkbookSizeExceedsLimit?!0:Fh(A)>xd.a.HKc;var Yh=a(103);class ti{constructor(A,
ja,Ua){Ua=void 0===Ua?null:Ua;this.mUa=!1;this._name=ja;this.$=A;this.Fq=Ba.a.instance;this.Sz=new Ih(A,za.f(A));this.rKb=Ua}get name(){return this._name}get pHb(){return this.Fq.Ba(5)}shouldWaitForCopyToComplete(){return!1}onDeferredPasteStarted(){}onDeferredPasteCompleted(){}beforePaste(){}b0k(A){let ja;ja=null;try{const Ua=A.getItem(Df.a.shadowWorkbook);if(!Ua)return{returnValue:!1,YM:ja};ja=JSON.parse(Ua);return{returnValue:this.Nqj(ja),YM:ja}}catch(Ua){return F.ULS.sendTraceTag(537167835,0,50,
"BaseCopyPasteHandler.TryParseRangeShadowWorkbookPayload: Exception caught: "+Ua),{returnValue:!1,YM:ja}}}Nqj(A){return!!A&&(!!A.shadowWorkbookBase64||A.shadowWorkbookSizeExceedsLimit)&&void 0!==A.rangeRowStart&&void 0!==A.rangeRowEnd&&void 0!==A.rangeColumnStart&&void 0!==A.rangeColumnEnd}oPc(A){A.wasLastCopyExternal=!0;ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SetDefaultPaste",!1)&&A.commandParameters.isPasteDefault&&this.$.shortcutKeyManager&&(A.commandParameters.commandType=
-185374993===this.$.shortcutKeyManager.fsc?20:4);if(Pf.a.B_a&&516!==A.commandParameters.commandType&&1028!==A.commandParameters.commandType){let ja=null;if((()=>{let Ua=this.b0k(A.clipboardItems);({YM:ja}=Ua);return Ua})().returnValue)return A.isShadowWorkbookParsedSuccessfully=!0,this.T1j(A,ja)}if(516!==A.commandParameters.commandType&&36!==A.commandParameters.commandType&&4100!==A.commandParameters.commandType){if(20!==A.commandParameters.commandType){const ja=A.clipboardItems.getItem(Df.a.html),
Ua=this.M0f(ja),ac=A.clipboardItems.getItem(Df.a.lqc),Ec=Ya.f(A.clipboardItems.getItem(Df.a.plainText));return!Ua||!ac&&Ec?(Ec&&F.ULS.sendTraceTag(508863578,0,50,"BaseCopyPasteHandler.pasteFromExternal: Pasting a formula as plaintext"),this.w$d(A)):this.Qqg(A,ja,void 0===ac?null:ac)}return this.w$d(A)}return Promise.reject(new qc(6))}T1j(A,ja){F.ULS.sendTraceTag(537167834,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: Pasting shadow workbook from system clipboard");A.pasteResult="SystemClipboardShadowWorkbookPaste";
A.payloadType=ca.shadowWorkbook;A.payloadOrigin=Ig.external;A.shadowWorkbookPayloadSize=Fh(ja);A.shadowWorkbookSizeExceedsLimit=si(ja);let Ua=null,ac=null;const Ec=A.commandParameters.originalDestinations;ba.EwaSettings.getBooleanFeatureGate(Pf.a.$Kb,!1)?Ua=Sa.s(Ec,this.$):ac=Sa.w(Sa.Q(Ec),this.$);ja.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(A.originalSourceRangesCountExceedsLimit=ja.originalSourceRangesCountExceedsLimit);if(A.shadowWorkbookSizeExceedsLimit)return F.ULS.sendTraceTag(537167833,
0,15,`BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: shadow workbook length(${A.shadowWorkbookPayloadSize}) is over the limit(${xd.a.HKc}). reject the paste request. ShadowWorkbookSizeExceedsLimit: ${ja.shadowWorkbookSizeExceedsLimit}`),Promise.reject(new qc(1));F.ULS.sendTraceTag(537167832,0,50,`BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: trigger Paste request. PasteOperationId=${A.commandParameters.id}`);return this.Sz.Uqg(A.commandParameters.ribbonCommandInfo,ac,Ua,ja,[A.commandParameters.stopwatch],
A)}w$d(A){var ja=A.clipboardItems.getItem(Df.a.plainText);if(void 0!==ja&&null!==ja&&ja.trim()===this.pHb)return Promise.reject(new qc(7));void 0!==ja&&null!==ja&&(A.plainTextPayloadSize=ja.length);let Ua=!1;null!==this.rKb&&(Ua=this.rKb.VGh(A,ea.a.trimEnd(ja,"\n","\r"),Sa.Q(A.commandParameters.originalDestinations)));Ua&&za.f(this.$).nk.JS(A.commandParameters.stopwatch.id,Ii.BasicTelemetryCalculator.uR);this.mUa||(this.mUa=!0,Yh.b("AutoAdjustColumnWidthTriggered"));A.isPlainTextPaste=!0;A.pasteResult=
"SystemClipboardPaste";A.payloadOrigin=Ag(A)?Ig.x3f:Ig.external;A.payloadType=ca.plainText;F.ULS.sendTraceTag(537167831,0,50,`BaseRangeCopyPasteHandler.PasteByPlainText: trigger ProcessPasteText request. pasteContext.Id=${A.id}, PasteOperationId=${A.commandParameters.id}`);ja=this.Sz.S7j(Sa.Q(A.commandParameters.originalDestinations),ja,A.commandParameters.ribbonCommandInfo,[A.commandParameters.stopwatch],A);F.ULS.sendTraceTag(537167830,0,50,`BaseRangeCopyPasteHandler.PasteByPlainText: returned from ProcessPasteText. pasteContext.Id=${A.id}`);
return ja}Qqg(A,ja,Ua){this.mUa||(this.mUa=!0,Yh.b("AutoAdjustColumnWidthTriggered"));A.htmlPayloadSize=ja.length;A.isHtmlPaste=!0;A.pasteResult="SystemClipboardHtmlPaste";A.payloadType=ca.html;A.payloadOrigin=Ag(A)?Ig.x3f:Ig.external;A.cseStatus=3;F.ULS.sendTraceTag(42071711,0,50,`BaseRangeCopyPasteHandler.PasteByHtml: trigger ProcessPasteHtml request. PasteOperationId=${A.commandParameters.id}`);return this.Sz.R7j(Sa.Q(A.commandParameters.originalDestinations),ja,Ua,A.commandParameters.id,A.commandParameters.ribbonCommandInfo,
[A.commandParameters.stopwatch],A,this.rKb)}txd(A){const ja={};A&&(ja.shadowWorkbookBase64=A.ShadowWorkbookBase64,ja.shadowWorkbookSizeExceedsLimit=A.ShadowWorkbookSizeExceedsLimit,ja.originalSourceRangesCountExceedsLimit=A.OriginalSourceRangesCountExceedsLimit,ja.originalSourceRangesCount=A.OriginalSourceRangesCount,ja.shadowWorkbookBlockedSize=A.ShadowWorkbookBlockedSize);return ja}h5g(A,ja){const Ua=Of(A),ac=32===(A.commandParameters.commandType&32),Ec=1024===(A.commandParameters.commandType&1024);
let gd=!1,ad=null,Jd=null,De=!1;if(!Ua){gd=-1985798686===A.commandParameters.ribbonCommandInfo.command;var Xe=A.copyContextSnapshot;if(ja)De=!Xe.sourceItem.isFromCurrentSession(this.$);else if(Xe=this.Sz.Szc(Xe))ad=Xe.ranges,Jd=Xe.sheetName,De=!A.isSameSession}return this.Sz.BFh(Jd,ad,this.$.na.sheetName,A.commandParameters.originalDestinations,A.commandParameters.expandDestinations,De,ac,Ec,gd,ja,Ua)}M0f(A){return!(void 0===A||null===A)&&!!A&&A.trim()!==this.pHb&&(A.startsWith("<")||Da.a.hm&&A.startsWith("\n<"))}}
Object(K.a)(ti,"BaseCopyPasteHandler",null,[921,901,922]);class ni{constructor(A){this.clipboardItems=this.key=null;this.t_=A}MO(A){return this.key&&this.key.isEqual(A)?this.createClipboardItems(this.clipboardItems):null}setValue(A,ja){this.key=A;this.clipboardItems=this.createClipboardItems(ja)}createClipboardItems(A){const ja=this.t_.create();var Ua=A.getItem(Df.a.plainText);Ua&&ja.setItem(Df.a.plainText,Ua);(Ua=A.getItem(Df.a.shadowWorkbook))&&ja.setItem(Df.a.shadowWorkbook,Ua);(A=A.getItem(Df.a.html))&&
ja.setItem(Df.a.html,A);return ja}}Object(K.a)(ni,"CopyCache",null,[]);class nj extends ti{constructor(A,ja,Ua,ac,Ec){Ec=void 0===Ec?null:Ec;super(A,ac,ja);this.rKb=ja;this.t_=Ua;this.pKb=Ec||new ni(this.t_);this.da=za.f(A);this.ha=this.da.ha;ba.EwaSettings.NSd()||(this.clipboardRangeFactory=A.ka.Ug(169))}getSourceItem(){const A=Sa.d(this.da.ha.qa.selectedRanges);return new Je(this.$,A,this.$.ea.na.sheetName,this.$.ea.gk,this.$.ua.UserSessionId)}beforeSerialize(A){A.isSelectionAllowed=!1;A.isAsyncCopy=
!1;A.isFromCache=!1;A.encounteredDeploymentErrors=!1;A.plainTextPayloadSize=0;A.shadowWorkbookPayloadSize=0;A.htmlPayloadSize=0;A.clientSideCopyTime=0;if(!A.isFullSheetCopy){var ja=new Ee.a(this.$.sa),Ua=A.sourceItem;A.isSelectionAllowed=rh.a.all(Ua.ranges,ac=>this.isSelectionAllowed(ja,ac));A.isSelectionAllowed&&this.Sz.nPf(Ua.ranges,A.commandParameters.commandType)}}O0a(A){return this.da.za.H5()&&za.h(this.da,A)}v2j(A,ja,Ua,ac){if(ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8620223_PasteNoOPAfterSheetDelete")&&
!this.$.sa.yq(Ua.sheetName))return Promise.reject(new qc(5));let Ec=!1;const gd=1===ja.commandParameters.commandType,ad=ac[0].cz;1===Ua.ranges.length&&1===ac.length?gd&&1!==ad&&ad!==Ua.ranges[0].cz?A.cseStatus=17:Ec=this.rKb.dAd(A,Sa.Q(Ua.ranges),Ua.sheetName,Sa.Q(A.commandParameters.expandDestinations),gd):A.cseStatus=5;Ec&&za.f(this.$).nk.JS(A.commandParameters.stopwatch.id,Ii.BasicTelemetryCalculator.uR);return this.a2j(A,Ua,Sa.v(this.$.na.sheetName,null,ac),ja.commandParameters.commandType,Ec)}isSelectionAllowed(A,
ja){return A.OVb(ja,this.da)}a2j(A,ja,Ua,ac,Ec){ja=Sa.v(ja.sheetName,null,ja.ranges);A.pasteResult="SameSessionPaste";A.payloadOrigin=Ig.sHg;A.payloadType=ca.Ksh;F.ULS.sendTraceTag(537167829,0,50,`BaseRangeCopyPasteHandler.PasteSameSession: trigger PasteRange request. PasteOperationId=${A.commandParameters.id}`);return this.Sz.pasteRange(A.commandParameters.ribbonCommandInfo,ja,Ua,ac,A.commandParameters.commandType,[A.commandParameters.stopwatch],A,Ec,null,null)}}Object(K.a)(nj,"BaseRangeCopyPasteHandler",
ti,[]);class Ti{constructor(A){this.q4=new Z.a(!0);this.$=A}onDeferredPasteStarted(A){this.q4.Vg(A.id)||this.q4.add(A.id,!0);if(0<this.q4.count)if(ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",!1))void ka.a.resolve(Ha.C,{va:0}).then(ja=>{ja.xm(28,null)});else{const ja=Object(Bb.d)(ka.a.resolve(Ha.C,{va:0}));$b.TaskExtensions.Ua(ja,()=>{ja.result.xm(28,null)},this.$.xa,3)}}onDeferredPasteCompleted(A){const ja=0<this.q4.count;this.q4.Vg(A.id)&&this.q4.remove(A.id);
if(ja&&!this.q4.count)if(ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",!1))void ka.a.resolve(Ha.C,{va:0}).then(Ua=>{Ua.removeEntry(28)});else{const Ua=Object(Bb.d)(ka.a.resolve(Ha.C,{va:0}));$b.TaskExtensions.Ua(Ua,()=>{Ua.result.removeEntry(28)},this.$.xa,3)}}}Object(K.a)(Ti,"DeferredPasteTracker",null,[]);var ei;(function(A){A[A.none=0]="none";A[A.loadClipboardFromServerFailed=1]="loadClipboardFromServerFailed";A[A.loadCopiedDataFromServerFailed=2]="loadCopiedDataFromServerFailed";
A[A.asyncCopyCanceled=3]="asyncCopyCanceled";A[A.loadCopiedArtDataFromServerFailed=4]="loadCopiedArtDataFromServerFailed"})(ei||(ei={}));Object(K.b)("CopyErrorType",ei);class fi extends Sc{constructor(A,ja){ja=void 0===ja?null:ja;super(ei[A]);this.copyErrorName=0;this.ewaErrors=null;this.copyErrorName=A;this.ewaErrors=ja;if(null===ja||void 0===ja?0:ja.length)this.innerError=new hd(ja,null)}}Object(K.a)(fi,"CopyInnerError",Sc,[]);var fg=a(710);class uh extends nj{constructor(A,ja,Ua,ac){super(A,ja,
Ua,"AcrossSessionRangeCopyPasteHandler",void 0===ac?null:ac);this.q4=new Ti(A)}serialize(A){const ja=A.sourceItem,Ua={};let ac=this.pKb.MO(ja);if(ac)Ua.synchronousResult=ac,A.isFromCache=!0,A.clientSideCopyTime=A.commandParameters.stopwatch.ii;else{let gd=null;var Ec=Sa.J(ja.ranges);if(!ob.a.dXf()&&this.O0a(Ec)){F.ULS.sendTraceTag(537167936,0,50,"AcrossSessionRangeCopyPasteHandler.Serialize: All data is loaded prepare the data in the client side.");Ec=ba.EwaSettings.NSd()?new fg.a(this.da,Ec):this.clipboardRangeFactory.create(Ec);
try{gd=Ec.toString(),ac=this.t_.create(),ac.setItem(Df.a.plainText,gd),this.pKb.setValue(ja,ac),Ua.synchronousResult=ac,A.clientSideCopyTime=A.commandParameters.stopwatch.ii}finally{Ec&&Ec.dispose()}}else A.isAsyncCopy=!0,Ua.synchronousResult=this.t_.create(),Ua.synchronousResult.setItem(Df.a.plainText,this.pHb);Ua.asynchronousResult=this.HYa(A,ja,gd)}A.syncClipboardItemsKeys=rf(Ua.synchronousResult);return Ua}shouldWaitForCopyToComplete(A){if(!A||!A.copyContextSnapshot)return F.ULS.sendTraceTag(537167907,
0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: pasteContext or pasteContext.CopyContextSnapshot is not define, return false."),!1;F.ULS.shipAssertTag(537167906,0,!!this.$.ua,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: this.EwaControl.BootstrapContext shouldn't be null");if(A.copyContextSnapshot.sessionId===this.$.ua.UserSessionId)return F.ULS.sendTraceTag(537167905,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: Same session copy scenario, return false."),
!1;F.ULS.sendTraceTag(537167904,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0}onDeferredPasteStarted(A){this.q4.onDeferredPasteStarted(A)}onDeferredPasteCompleted(A){this.q4.onDeferredPasteCompleted(A)}deserialize(A){var ja;A.isClipboardDataContainShadowWorkbook=!(void 0===A.clipboardItems.getItem(Df.a.shadowWorkbook)||null===A.clipboardItems.getItem(Df.a.shadowWorkbook));if(za.f(this.$).ha.wk&326)return Of(A)&&(A.wasLastCopyExternal=!0),Promise.reject(new qc(17));
var Ua=this.h5g(A,!1);if(0!==Ua)return Promise.reject(new qc(Of(A)?18:A.isSameSession?19:20,void 0,void 0,void 0,Ua));Ua=A.copyContextSnapshot;var ac=this.Sz.Szc(Ua);if(Of(A)||(null===(ja=A.copyContextSnapshot)||void 0===ja?0:ja.sourceItem)&&sf(A.copyContextSnapshot.sourceItem))return this.oPc(A);ja=A.commandParameters.originalDestinations;if(ac&&A.isSameSession)return this.v2j(A,Ua,ac,ja);if(516!==A.commandParameters.commandType){let Ec=null;if((()=>{let gd=this.f9b(A.clipboardItems);({YM:Ec}=gd);
return gd})().returnValue)return A.isShadowWorkbookParsedSuccessfully=!0,ac=Ua=null,ba.EwaSettings.getBooleanFeatureGate(Pf.a.$Kb,!1)?Ua=Sa.s(ja,this.$):ac=Sa.w(Sa.Q(ja),this.$),this.Q1j(A,ac,Ua,Ec);if(A.isClipboardInaccessible)return Promise.reject(new qc(8));if(36!==A.commandParameters.commandType)return this.w$d(A)}return Promise.reject(new qc(6))}beforePaste(A){this.$.ka.Ug(373).Gtk(A);A.indicationDisplayScheduled=!0}tve(A){let ja;if(!(A&&A.SourceRanges&&A.SourceRanges.Ranges&&A.SourceRanges.Ranges.length&&
(A.OriginalSourceRangesCountExceedsLimit||A.OriginalSourceMultiRange&&A.OriginalSourceMultiRange.Ranges&&A.OriginalSourceMultiRange.Ranges.length)))return{returnValue:!1,YM:null};var Ua=A.SourceRanges.Ranges[0];if(!A.ShadowWorkbookBase64&&!A.ShadowWorkbookSizeExceedsLimit)return{returnValue:!1,YM:null};ja=this.txd(A);ja.rangeRowStart=Ua.FirstRow;ja.rangeRowEnd=Ua.LastRow;ja.rangeColumnStart=Ua.FirstColumn;ja.rangeColumnEnd=Ua.LastColumn;ja.sourceClientPath=A.SourceClientPath;ja.sourceSheetName=A.SourceSheetName;
ja.sourceWorkbookName=A.SourceWorkbookName;if(!A.OriginalSourceRangesCountExceedsLimit)for(A=A.OriginalSourceMultiRange.Ranges,ja.originalSourceRanges=Array(A.length),Ua=0;Ua<A.length;++Ua)ja.originalSourceRanges[Ua]=[A[Ua].FirstRow,A[Ua].FirstColumn,A[Ua].LastRow,A[Ua].LastColumn];return{returnValue:!0,YM:ja}}f9b(A){let ja;ja=null;A=A.getItem(Df.a.shadowWorkbook);if(!A)return{returnValue:!1,YM:ja};ja=JSON.parse(A);return{returnValue:this.$Xd(ja),YM:ja}}HYa(A,ja,Ua){F.ULS.shipAssertTag(537167901,
0,!!A,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: copyContext shouldn't be null");const ac=A.commandParameters.stopwatch.ii,Ec=Sa.v(ja.sheetName,null,ja.ranges);return new Promise((gd,ad)=>{F.ULS.sendTraceTag(26035421,0,50,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data for copy Id: ${A.id}`);this.Sz.copy(Ec,A.commandParameters,Jd=>{A.requestTelemetryData=Jd.RequestTelemetryData;A.serverRequestTimeInMs=A.commandParameters.stopwatch.ii-
ac;if(kb.a.Jk(Jd.Errors))if(kb.a.Hta(Jd.Errors))A.encounteredDeploymentErrors=!0,Jd=kb.a.Kh(Jd.Errors),F.ULS.sendTraceTag(537167898,0,15,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${Jd}. copy Id: ${A.id}`);else{var De=kb.a.Kh(Jd.Errors);if(kb.a.Qn(Jd.Errors,[-591377245])){var Xe=this.xF(Ec);if(Xe){Xe=String.format(this.Fq.$g(218),Xe.toLocaleUpperCase());var lf=Jd.Errors.findIndex(sg=>-591377245===
sg.MessageId);Jd.Errors[lf].Description=Xe;F.ULS.sendTraceTag(509125507,0,50,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Added range string to CopyMaxCellCountExceededError. copy Id: ${A.id}`)}}F.ULS.sendTraceTag(26035419,0,10,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${De}. copy Id: ${A.id}`);ad(new fi(2,Jd.Errors))}else if(F.ULS.sendTraceTag(537167900,0,50,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeed for copy Id: ${A.id}`),
A.markForCancellation)ad(new fi(3,Jd.Errors));else{var mf=Jd.Result;Xe=mf.PlainTextResult;void 0!==Ua&&null!==Ua&&(Xe=Ua);void 0!==Xe&&null!==Xe&&(A.plainTextPayloadSize=Xe.length);De=this.t_.create();var Rf;(()=>{let sg=this.tve(mf);({YM:Rf}=sg);return sg})().returnValue&&(A.shadowWorkbookPayloadSize=Fh(Rf),A.shadowWorkbookSizeExceedsLimit=si(Rf),A.originalSourceRangesCountExceedsLimit=mf.OriginalSourceRangesCountExceedsLimit,lf=JSON.stringify(Rf),De.setItem(Df.a.shadowWorkbook,lf));De.setItem(Df.a.plainText,
Xe);ob.a.dXf()&&(Xe=mf.HtmlResult,A.htmlSizeExceedsLimit=mf.HtmlSizeExceedsLimit,void 0!==Xe&&null!==Xe&&(A.htmlPayloadSize=Xe.length),De.setItem(Df.a.html,Xe));A.copyTotalSizeExceedsLimit=mf.CopyTotalSizeExceedsLimit;De.setItem(Df.a.lqc,A.commandParameters.id);this.pKb.setValue(ja,De);A.asyncClipboardItemsKeys=rf(De);gd(De);ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!0)&&(De=1===A.commandParameters.commandType?8:7,(Xe=ka.a.Zg(Ha.ke))&&
Xe.Mia(De,Jd))}},Jd=>{A.serverRequestTimeInMs=A.commandParameters.stopwatch.ii-ac;Jd=bd.a.Qj(Jd.data);const De=kb.a.Kh(Jd);F.ULS.sendTraceTag(537167897,0,10,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${De}. copy Id: ${A.id}`);ad(new fi(2,Jd))},[A.commandParameters.stopwatch])})}$Xd(A){return!!A&&(!!A.shadowWorkbookBase64||A.shadowWorkbookSizeExceedsLimit)&&void 0!==A.rangeRowStart&&void 0!==A.rangeRowEnd&&void 0!==A.rangeColumnStart&&void 0!==
A.rangeColumnEnd}Q1j(A,ja,Ua,ac){F.ULS.shipAssertTag(537167903,0,!!ac,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadowWorkbookPayload shouldn't be null");A.pasteResult="CrossSessionPaste";A.payloadOrigin=Ig.Jxd;A.payloadType=ca.shadowWorkbook;A.shadowWorkbookPayloadSize=Fh(ac);A.shadowWorkbookSizeExceedsLimit=si(ac);A.cseStatus=3;ac.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(A.originalSourceRangesCountExceedsLimit=ac.originalSourceRangesCountExceedsLimit);if(A.shadowWorkbookSizeExceedsLimit)return F.ULS.sendTraceTag(34415003,
0,15,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadow workbook length(${A.shadowWorkbookPayloadSize}) is over the limit(${xd.a.HKc}). reject the paste request. ShadowWorkbookSizeExceedsLimit: ${ac.shadowWorkbookSizeExceedsLimit}`),Promise.reject(new qc(1));if(1028===A.commandParameters.commandType&&A.originalSourceRangesCountExceedsLimit)return F.ULS.sendTraceTag(572617859,0,15,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: Original source ranges count(${ac.originalSourceRangesCount}) is over the limit(${xd.a.wCj}). Reject the paste request. OriginalSourceRangesCountExceedsLimit: ${ac.originalSourceRangesCountExceedsLimit}`),
Promise.reject(new qc(1));F.ULS.sendTraceTag(537167902,0,50,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: trigger Paste request. PasteOperationId=${A.commandParameters.id}`);return this.Sz.Uqg(A.commandParameters.ribbonCommandInfo,ja,Ua,ac,[A.commandParameters.stopwatch],A)}xF(A){return null==A||null==A.Ranges||0===A.Ranges.length?(F.ULS.sendTraceTag(509125506,0,15,"AcrossSessionRangeCopyPasteHandler.GetRangeString sourceRange is null"),null):(1===A.Ranges.length?Sa.E(A.Ranges[0]):Sa.J(Sa.h(A.Ranges))).toString()}}
Object(K.a)(uh,"AcrossSessionRangeCopyPasteHandler",nj,[]);var Jh=a(1280);class sh{constructor(A,ja,Ua,ac,Ec,gd,ad){this.floatingObjectId=A;this.commandParameters=ja;this.NP=Ua;this.V7h=ac;this.Eva=void 0===gd?null:gd;this.Uxe=void 0===ad?null:ad;this.o_h=Ec}}Object(K.a)(sh,"CopyArtRequest",null,[]);class Nh{constructor(A,ja,Ua,ac,Ec,gd,ad,Jd,De){this.promise=null;this.ribbonCommandInfo=A;this.destination=ja;this.klf=Ua;this.Uxe=Ec;this.YM=gd;this.item=ad;this.pasteContext=Jd;this.a2a=Ua||ja.FirstRow+
"_"+ja.FirstColumn;this.FXf=!0;this.ocf=De}}Object(K.a)(Nh,"PasteArtRequest",null,[]);class oi{constructor(A,ja){this.I3b=new Yg.a;this.JUa=A;this.$=ja;this.u8j=Ua=>Promise.resolve(Ua);this.C_b=Ua=>Promise.reject(Ua)}s2i(A){if(this.qmj(A.a2a)){F.ULS.sendTraceTag(537167681,5,50,`PasteArtRequestManager.HandleRequest: Enqueued paste request as a result of rapid paste on same destination: ${A.a2a}`);const ja=this.I3b.ma(A.a2a);this.I3b.ga(A.a2a,A);const Ua=ja.promise;ja.FXf=!1;return this.vhi(A,Ua)}this.I3b.ga(A.a2a,
A);return this.Ktj(A)}qmj(A){return this.I3b.Vg(A)}Ktj(A){return new Promise((ja,Ua)=>{A.promise=this.JUa.Pqg(A).then(ac=>{ja(null);return this.LNc(A,ac)},ac=>{Ua(null);return this.C_b(ac)})})}vhi(A,ja){return new Promise((Ua,ac)=>{A.promise=ja.then(Ec=>{this.S5k(A,Ec);return this.JUa.Pqg(A).then(gd=>{Ua(null);return this.LNc(A,gd)},gd=>{ac(null);return this.C_b(gd)})},Ec=>this.C_b(Ec))})}LNc(A,ja){A.FXf&&(this.HTh(A.a2a),this.Wke(A,ja));return this.u8j(ja)}HTh(A){this.I3b.remove(A)}Wke(A,ja){const Ua=
this.NTi();A.a2a===Ua&&this.JUa.Wke(A.destination,ja,A.item.type)}NTi(){var A=za.f(this.$).ha.$e.activeFloatingObjectControlId;A||(A=Sa.w(za.f(this.$).ha.qa.activeCell,this.$),A=A.FirstRow+"_"+A.FirstColumn);return A}S5k(A,ja){A.destination=null;A.klf=ja}}Object(K.a)(oi,"PasteArtRequestManager",null,[]);var gi=a(214);class Ui extends ti{constructor(A,ja,Ua,ac,Ec){Ec=void 0===Ec?null:Ec;super(A,"ArtCopyPasteHandler");this.yUh="XLO";this.zUh="3";this.q4=new Ti(A);this.t_=ja;this.JUa=Ua;this.ha=za.f(A).ha;
this.jqc=Ec||new ni(this.t_);this.R1j=new oi(Ua,A);this.oHb=ac}getSourceItem(){F.ULS.shipAssertTag(537167896,0,!!this.ha.$e.activeFloatingObjectControlId,"Expecting a floating object to be currently selected for copy");F.ULS.sendTraceTag(537167895,0,50,`ArtCopyPasteHandler.GetSourceItem: Creating ArtSourceItem with FloatingObjectId=[${this.ha.$e.activeFloatingObjectControlId}]`);return new ne(this.ha.$e.activeFloatingObjectControlId,this.$.ea.na.sheetName,this.$.ea.gk,this.$.ua.UserSessionId,this.ha.$e.yh.floatingObject.type)}beforeSerialize(A){A&&
A.commandParameters?(kd(A),A.commandParameters.copyPasteTargetType=2):F.ULS.sendTraceTag(537167894,0,10,"ArtCopyPasteHandler.BeforeSerialize: copyContext or copyContext.CommandParameters is null.")}serialize(A){const ja=A.sourceItem,Ua={};if(!ja)return F.ULS.sendTraceTag(537167893,0,10,"ArtCopyPasteHandler.Serialize: artSourceItem should not be null"),Ua;if(!this.Bpj())return F.ULS.sendTraceTag(36824456,0,50,"ArtCopyPasteHandler.Serialize: Unsupported floating object type. This will clear the clipboard"),
Ua;F.ULS.sendTraceTag(537167892,0,50,`ArtCopyPasteHandler.Serialize: Serializing ArtSourceItem with FloatingObjectId=[${ja.activeFloatingObjectControlId}]`);this.Uae();let ac=this.jqc.MO(ja);if(ac)Ua.synchronousResult=ac,A.isFromCache=!0,A.isAsyncCopy=!1,A.clientSideCopyTime=A.commandParameters.stopwatch.ii,1===A.commandParameters.commandType&&this.$.ei(2045211913,A.commandParameters.ribbonCommandInfo.method,A.commandParameters.ribbonCommandInfo.lk,null);else{A.isFromCache=!1;A.isAsyncCopy=!0;ac=
this.t_.create();if(A.commandParameters.uploadToClipService){const Ec={};Ec["data-clipservice-ccpid"]=A.commandParameters.id;Ec["data-pkey"]=A.commandParameters.pKey;Ec["data-clipservice-type"]=A.commandParameters.clipServiceDataType;Ec["data-clipservice-count"]=A.commandParameters.objectCount.toString();Ec["data-clipservice-dc"]=A.commandParameters.clipServiceDataCenter;Ec["data-clipservice-client"]=this.yUh;Ec["data-TimeStamp"]=(new Date).toUTCString();Ec["data-clipservice-version"]=this.zUh;ac.setItem(Df.a.RBh,
JSON.stringify(Ec))}ob.a.Cxa()?(Ua.synchronousResult=this.OVi(ac),Ua.asynchronousResult=this.RCi(A,ja,ac)):(Ua.synchronousResult=this.a_e(ac),Ua.asynchronousResult=this.HYa(A,ja,ac))}A.syncClipboardItemsKeys=rf(Ua.synchronousResult);return Ua}OVi(A){return this.ha.$e.yh.floatingObject.paa?(A.setItem(Df.a.plainText,this.pHb),A):this.a_e(A)}a_e(A){F.ULS.shipAssertTag(537167891,0,!!this.ha.$e.yh,"Expecting a floating object to be currently selected for copy");A||(A=this.t_.create());const ja=this.ha.$e.yh.TOb();
ja&&A.setItem(Df.a.html,`<img src='${ja}'>`);return A}Uae(){const A=this.ha.$e.yh;this.oHb.Uae(Ff.a.xJb(A.floatingObject),Ff.a.BUh(A.jz))}shouldWaitForCopyToComplete(){F.ULS.sendTraceTag(537167890,0,50,"ArtCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0}onDeferredPasteStarted(A){this.q4.onDeferredPasteStarted(A)}onDeferredPasteCompleted(A){this.q4.onDeferredPasteCompleted(A)}deserialize(A){var ja=Of(A),Ua=null;let ac=null;var Ec=!1;if(!ja){Ua=A.copyContextSnapshot;ac=Ua.sourceItem;
if(!ac)return Promise.reject(new qc(10));Ec=ac.isFromCurrentSession(this.$)}var gd=this.h5g(A,!0);if(0!==gd)return Promise.reject(new qc(ja?18:Ec?19:20,void 0,void 0,void 0,gd));if(ja)return this.oPc(A);if(!Ec&&!Ui.ygj(ac))return A=`User attempted to paste art of type [${ac.type}] between sessions.`,F.ULS.sendTraceTag(537167889,0,50,A),Promise.reject(new qc(11,void 0,void 0,A));if(Ua.isAsyncSerializeFailed)return Promise.reject(new qc(16,void 0,void 0,"Last async serialize failed, therefore no current shadow workbook payload to paste"));
let ad;try{const Jd=A.clipboardItems.getItem(Df.a.shadowWorkbook);if(ob.a.Cxa()&&!Jd&&1===ac.type)return this.z7j(A);ad=JSON.parse(Jd)}catch(Jd){return A=copyPasteInfra.getStringifiedError(Jd),F.ULS.sendTraceTag(507798424,0,10,`ArtCopyPasteHandler.Deserialize: Failed to parse shadow workbook JSON with exception: ${A}`),Promise.reject(new qc(12,void 0,Jd))}ad.floatingObjectId!==ac.activeFloatingObjectControlId?F.ULS.sendTraceTag(537167887,0,10,`ArtCopyPasteHandler.Deserialize: FloatingObjectId mismatch! Deserializing with artSourceItem.ActiveFloatingObjectControlId=[${ac.activeFloatingObjectControlId}], shadowWorkbookPayload.FloatingObjectId=[${ad.floatingObjectId}]`):
F.ULS.sendTraceTag(537167886,0,50,`ArtCopyPasteHandler.Deserialize: Deserializing with artSourceItem.ActiveFloatingObjectControlId=[${ac.activeFloatingObjectControlId}], shadowWorkbookPayload.FloatingObjectId=[${ad.floatingObjectId}]`);if(!ad||!ad.shadowWorkbookBase64)return Promise.reject(new qc(13,void 0,void 0,`shadowWorkbookPayload is null = ${!ad}`));A.isShadowWorkbookParsedSuccessfully=!0;A.shadowWorkbookPayloadSize=Fh(ad);A.shadowWorkbookSizeExceedsLimit=si(ad);A.payloadOrigin=Ec?Ig.sHg:Ig.Jxd;
A.payloadType=ca.f$g;A.cseStatus=0;if(si(ad))return A=`Shadow workbook size [${A.shadowWorkbookPayloadSize}] is over the limit [${xd.a.HKc}]. ShadowWorkbookSizeExceedsLimit: ${ad.shadowWorkbookSizeExceedsLimit}`,F.ULS.sendTraceTag(36304156,0,15,`ArtCopyPasteHandler.Deserialize: ${A}`),Promise.reject(new qc(1,void 0,void 0,A));Ua=ja=null;za.f(this.$).ha.wk&326?Ua=za.f(this.$).ha.$e.activeFloatingObjectControlId:ja=this.$.na&&this.$.na.activeCell?Sa.w(this.$.na.activeCell,this.$):Sa.w(Sa.Q(A.commandParameters.originalDestinations),
this.$);Ec||!ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",!1)&&!ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",!1)||(A.ArtSourceItemType=Jh.a[ac.type],F.ULS.sendTraceTag(508422155,0,20,`User is attempting to paste art of type [${ac.type}] between sessions.`));Ec=null;if(this.oHb.MPg(ac))try{Ec=this.oHb.dAd(),A.cseStatus=1}catch(Jd){A.cseStatus=15,gd=copyPasteInfra.getStringifiedError(Jd),F.ULS.sendTraceTag(537167885,
0,10,`ArtCopyPasteHandler.Deserialize: Exception encountered while performing client-side estimation. Exception: ${gd}`)}else A.cseStatus=26;return this.R1j.s2i(new Nh(A.commandParameters.ribbonCommandInfo,ja,Ua,A.commandParameters.commandType,[A.commandParameters.stopwatch],ad,ac,A,Ec))}oPc(A){A.wasLastCopyExternal=!0;if(A.clipboardItems.getItem("image/png")){const ja=A.commandParameters.stopwatch.ii;A.payloadType=ca.KIh;return Bb.c(this.$.ei(1403967063,A.commandParameters.ribbonCommandInfo.method,
A.commandParameters.ribbonCommandInfo.lk,{["dataUrl"]:A.clipboardItems.getItem("image/png")})).then(Ua=>{A.serverRequestTimeInMs=A.commandParameters.stopwatch.ii-ja;return Ua?Promise.resolve(null):Promise.reject(new qc(15))},()=>{A.serverRequestTimeInMs=A.commandParameters.stopwatch.ii-ja;return Promise.reject(new qc(15))})}F.ULS.shipAssertTag(537167884,0,!1,"Should not paste external content that is not image via ArtCopyPasteHandler");return super.oPc(A)}z7j(A){try{const ja=A.clipboardItems.getItem(Df.a.html);
return this.M0f(ja)?this.Qqg(A,ja,null):Promise.reject(new qc(23))}catch(ja){return A=copyPasteInfra.getStringifiedError(ja),F.ULS.sendTraceTag(507782405,0,10,`ArtCopyPasteHandler.processClipboardHtml: Failed to process clipboard html with exception: ${A}`),Promise.reject(new qc(24,void 0,ja))}}Bpj(){const A=za.f(this.$).ha;return A.$e.activeFloatingObjectControlId&&A.$e.yh&&A.$e.yh.floatingObject?A.$e.yh.floatingObject.Ise():!1}RCi(A,ja,Ua){return this.ha.$e.yh.floatingObject.paa?new Promise((ac,
Ec)=>{const gd=this.SCi(A,Ua),ad=this.HYa(A,ja,Ua);void Promise.allSettled([gd,ad]).then(Jd=>{var [De,Xe]=Jd;"rejected"===De.status?(1===A.commandParameters.commandType&&this.JUa.s0g(ja.type,ja.activeFloatingObjectControlId),Ec(De.reason)):("rejected"===Xe.status&&F.ULS.sendTraceTag(507811728,0,50,`ArtCopyPasteHandler.getAsyncData: Promise fetching data from server has failed with error ${Xe.reason}. Proceeding with resolving clipboard items from asyncArtData.`),Jd=De.value,this.jqc.setValue(ja,Jd),
ac(Jd))})}):this.HYa(A,ja,Ua)}SCi(A,ja){return new Promise((Ua,ac)=>{const Ec=this.ha.$e.yh;Ec.cjb().continueWith(gd=>{var ad;try{const Jd=gd.result;ja.setItem(Df.a.plainText,"");if(Jd){const De=new Image;De.src=Jd;ja.setItem(Df.a.html,eg.b(De))}else return F.ULS.sendTraceTag(507811727,0,15,`ArtCopyPasteHandler.getAsyncImageData: Base64 URL of picture is null. ArtSourceItem id: ${Ec.floatingObject.fi}`),ac(new fi(4));A.asyncClipboardItemsKeys=rf(ja);Ua(ja)}catch(Jd){gd=null===(ad=null===Ec||void 0===
Ec?void 0:Ec.floatingObject)||void 0===ad?void 0:ad.fi,F.ULS.sendTraceTag(507811726,0,10,`ArtCopyPasteHandler.getAsyncImageData: Failed to fetch base64 URL of picture. ArtSourceItem id: ${gd}. Exception: ${Jd}`),ac(new fi(4))}})})}HYa(A,ja,Ua){return new Promise((ac,Ec)=>{const gd=A.commandParameters.stopwatch.ii,ad=this.ha.$e.yh;F.ULS.sendTraceTag(41562516,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data...");this.JUa.r_h(new sh(ja.activeFloatingObjectControlId,
A.commandParameters,Jd=>{var De;A.requestTelemetryData=Jd.RequestTelemetryData;A.serverRequestTimeInMs=A.commandParameters.stopwatch.ii-gd;if(kb.a.Jk(Jd.Errors))if(kb.a.Hta(Jd.Errors))A.encounteredDeploymentErrors=!0,Jd=kb.a.Kh(Jd.Errors),F.ULS.sendTraceTag(537167879,0,15,`ArtCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${Jd}`);else{var Xe=kb.a.Kh(Jd.Errors);F.ULS.sendTraceTag(36229122,0,10,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${Xe}`);
Ec(new fi(4,Jd.Errors))}else if(F.ULS.sendTraceTag(537167883,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeeded for FloatingObjectId=[${ja.activeFloatingObjectControlId}].`),A.markForCancellation)Ec(new fi(3,Jd.Errors));else{if(kb.a.rx(Jd.Errors)){var lf=kb.a.Kh(Jd.Errors);F.ULS.sendTraceTag(537167882,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: Server messages present. Errors: ${lf}`)}if(lf=Jd.Result){lf=this.txd(lf);lf.floatingObjectId=ja.activeFloatingObjectControlId;
A.shadowWorkbookPayloadSize=Fh(lf);A.shadowWorkbookSizeExceedsLimit=si(lf);try{Xe=JSON.stringify(lf)}catch(mf){Ec(new qc(14,void 0,mf,`Failed to stringify shadow workbook: copyContext.ShadowWorkbookPayloadSize: [${A.shadowWorkbookPayloadSize}], shadowWorkbookPayload.FloatingObjectId: [${lf.floatingObjectId}]`));return}F.ULS.shipAssertTag(537167881,0,!!Ua,"Expecting syncClipboardItems to be defined");ob.a.Cxa()&&(null===(De=null===ad||void 0===ad?void 0:ad.floatingObject)||void 0===De?0:De.paa)?(De=
new Blob([Xe]),1048576<De.size?F.ULS.sendTraceTag(507798425,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: ShadowWorkbookPayload size is ${De.size} for floating object id ${ad.floatingObject.fi}. Ignoring shadow workbook to avoid failure in saving to local storage.`):Ua.setItem(Df.a.shadowWorkbook,Xe)):Ua.setItem(Df.a.shadowWorkbook,Xe);1===A.commandParameters.commandType&&(this.V5j(ja.type,ja.activeFloatingObjectControlId,Jd.StateId),this.deleteFloatingObject(ja.activeFloatingObjectControlId,
ja.type));this.jqc.setValue(ja,Ua);A.asyncClipboardItemsKeys=rf(Ua);ac(Ua)}else F.ULS.sendTraceTag(537167880,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: Result form server returned null, copied item id: ${ja.activeFloatingObjectControlId}`),ac(this.jqc.MO(ja))}},A.commandParameters.commandType,ja.type,Jd=>{A.serverRequestTimeInMs=A.commandParameters.stopwatch.ii-gd;Jd=bd.a.Qj(Jd.data);1!==A.commandParameters.commandType||ob.a.Cxa()&&ad.floatingObject.paa||this.JUa.s0g(ja.type,ja.activeFloatingObjectControlId);
const De=kb.a.Kh(Jd);F.ULS.sendTraceTag(537167878,0,10,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${De}`);Ec(new fi(4,Jd))},[A.commandParameters.stopwatch]))})}deleteFloatingObject(A,ja){A=gi.a.vI(ja,A);if(A=bb.a(this.$).ky(A))bb.a(this.$).deleteFloatingObject(A,14,!0),za.f(this.$).ha.$e.YJ=null}V5j(A,ja,Ua){const ac=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8434150_MigrateValidationTelemetryManager")?ka.a.Zg(Ha.yg):this.$.ka.Ug(277);if(ac){let gd=null;
A=gi.a.vI(A,ja);A=bb.a(this.$).ky(A);if(null===A||void 0===A?0:A.Xp)gd=A.Xp.block;if(gd){var Ec=A.floatingObject.an();ac.Ljc(()=>!gd.Qo.Vg(Ec),Ua,"CutArt")}}}static ygj(A){return 1===A.type||5===A.type||ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",!1)&&0===A.type||ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",!1)&&8===A.type}}Object(K.a)(Ui,"ArtCopyPasteHandler",ti,[]);class ui extends Ki{constructor(A,ja,Ua,
ac){super(A);this.isFromCurrentSession=!1;this.left=this.top=0;this.isFromCurrentSession=ja;this.top=Ua;this.left=ac}}Object(K.a)(ui,"MacroRecorderPasteArtPayload",Ki,[]);class Mi{constructor(A,ja){this.$=A;this.oHb=ja}D8i(A,ja,Ua,ac,Ec,gd,ad){gd=void 0===gd?null:gd;ad=void 0===ad?null:ad;const Jd=this.$.pa.ta.Jh();let De=null;const Xe={CopyPasteTargetType:2};Xe.FloatingObjectId=A;Xe.CopyOperationId=Ua.id;Ua.floatingObjectType=ja;Xe.UploadToClipService=Ua.uploadToClipService;Xe.PKey=Ua.pKey;Xe.ClipServiceDataCenter=
Ua.clipServiceDataCenter;let lf=0;2===Ec?(Ec=505,lf=16,De=(mf,Rf,sg)=>ze(this.$.pa.ta,Xe,jd.c(mf,ac),gd?jd.b(Rf,gd):Rf,sg,Ua.ribbonCommandInfo,Jd,ad)):(Ec=179,De=(mf,Rf,sg)=>{this.ddi(ja,A);this.$.AD();var wg=this.$.pa.ta;mf=jd.c(mf,ac);Rf=gd?jd.b(Rf,gd):Rf;var Mg=Ua.ribbonCommandInfo,Sg=ad;Sg=void 0===Sg?null:Sg;const Qi=wg.Za(1,void 0===Jd?null:Jd);Qi.copyParameters=Xe;return Yd.h(wg,"Cut",Qi,mf,Rf,sg,Mg,0,Sg)});this.$.userOperationManager.enqueueOperation(new Lc.a(Ec,0,De,lf|64),Ua.ribbonCommandInfo)}ddi(A,
ja){var Ua=gi.a.vI(A,ja);(Ua=bb.a(this.$).ky(Ua))?(za.f(this.$).ha.$e.XQ(Ua),Ua.isVisible=!1):F.ULS.sendTraceTag(537167876,0,50,`ArtCopyPasteUtils.DoCutClientEstimation: floatingObjectcontrol is null. FloatingObjectType : ${A}, FloatingObjectId: ${ja}`)}s0g(A,ja){A=gi.a.vI(A,ja);if(A=bb.a(this.$).ky(A))A.isVisible=!0}r_h(A){this.D8i(A.floatingObjectId,A.o_h,A.commandParameters,A.NP,A.V7h,A.Eva,A.Uxe)}k9i(A,ja,Ua,ac,Ec,gd,ad,Jd,De){Jd=void 0===Jd?null:Jd;De=void 0===De?!0:De;return new Promise((Xe,
lf)=>{const mf=gd.commandParameters.stopwatch.ii;this.sle(A,Ec,ja,Ua,Rf=>{gd.requestTelemetryData=Rf.RequestTelemetryData;gd.serverRequestTimeInMs=gd.commandParameters.stopwatch.ii-mf;if(kb.a.Hta(Rf.Errors))gd&&(gd.encounteredDeploymentErrors=!0),Rf=kb.a.Kh(Rf.Errors),F.ULS.sendTraceTag(537167875,0,15,`ArtCopyPasteUtils.PasteArt: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${Rf}`);else if(kb.a.Jk(Rf.Errors)){var sg=kb.a.Kh(Rf.Errors);F.ULS.sendTraceTag(36459652,
0,10,`ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: ${sg}`);lf(new qc(9,Rf.Errors))}else Rf.Result?(sg=Rf.Result,F.ULS.sendTraceTag(537167874,0,50,"ArtCopyPasteUtils.PasteArt: PasteArt succeeded."),this.g6j(ad,sg.FloatingObjectId,Rf.StateId),Xe(Mi.mQd(sg.FloatingObjectId))):(F.ULS.sendTraceTag(537167873,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed, result returned from server is null."),lf(new qc(9,Rf.Errors)))},Rf=>{gd.serverRequestTimeInMs=gd.commandParameters.stopwatch.ii-mf;Rf=bd.a.Qj(Rf.data);
F.ULS.sendTraceTag(537167872,0,10,`ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: ${kb.a.Kh(Rf)}`);lf(new qc(9,Rf))},ac,Jd,De)})}g6j(A,ja,Ua){const ac=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8434150_MigrateValidationTelemetryManager")?ka.a.Zg(Ha.yg):this.$.ka.Ug(277);if(ac){const Ec=gi.a.vI(A,Mi.mQd(ja));ac.Ljc(()=>!!bb.a(this.$).ky(Ec),Ua,"PasteArt")}}Sve(A,ja){ja&&this.oHb.Sve(A,gi.a.vI(A.type,ja))}Pqg(A){return this.k9i(A.ribbonCommandInfo,A.destination,A.klf,A.Uxe,A.YM,A.pasteContext,
A.item.type,A.ocf,A.item.isFromCurrentSession(this.$)).then(ja=>ja,ja=>{this.Sve(A.item,A.ocf);return Promise.reject(ja)})}Wke(A,ja,Ua){A||(A=Sa.w(za.f(this.$).ha.qa.activeCell,this.$));za.f(this.$).NGc(Sa.G(A),1)?bb.a(this.$).fOa(Ua,ja,!0):za.f(this.$).ha.$e.FVa(A,ja,Ua).continueWith(ac=>{ac.result?F.ULS.sendTraceTag(537167843,5,50,`ArtCopyPasteUtils.SelectPastedObject: Selection succeeded in async manner for object ID [${ja}]`):F.ULS.sendTraceTag(537167842,5,10,`ArtCopyPasteUtils.SelectPastedObject: Selection failed in async manner for object ID [${ja}]`)})}sle(A,
ja,Ua,ac,Ec,gd,ad,Jd,De){De=void 0===De?!0:De;const Xe=this.$.pa.ta.Jh(),lf={};lf.ShadowWorkbookBase64=ja.shadowWorkbookBase64;lf.FloatingObjectId=ac;lf.DestinationRanges=Ua?Sa.t(Ua):null;lf.CopyPasteTargetType=2;lf.ClientEstimationFloatingObjectId=Jd;Ua=new Lc.a(503,0,(mf,Rf,sg)=>{Jd||this.$.AD();return Bj(this.$.pa.ta,lf,jd.c(mf,Ec),jd.b(Rf,gd),sg,null,Xe,ad)},void 0,()=>{if(De){let mf;mf=qf.a.Gp(qf.a.li(lf));mf.FloatingObjectId=ja.floatingObjectId;lf.DestinationRanges||(mf.DestinationRanges=Sa.q(this.$.sa.na.sheetName,
"",0,0,0,0));return new ui(mf,De,0,0)}return new ui(lf,De,0,0)});Ua.flags=65;this.$.userOperationManager.enqueueOperation(Ua,A)}static mQd(A){return`${A.length+2}.{${A.toUpperCase()}}`}}Object(K.a)(Mi,"ArtCopyPasteUtils",null,[904]);var ej=a(218);class vi{constructor(A){this.Uvd=this.wGa=null;this.srb=15;this.$=A}Uae(A,ja){this.wGa=A;this.Uvd=ja}dAd(){if(!this.wGa||!this.Uvd)return F.ULS.sendTraceTag(537167841,0,15,"ArtPasteClientEstimation.DoPasteClientEstimation: copiedFloatingObjectControl and/or copiedEffectsExtents is null, aborting client side estimation."),
"";const A=Ff.a.xJb(new gi.a(this.wGa));A.Id=Mi.mQd(Bd.a.create().toString());A.Version=-1;A.Name="";A.IsClientEstimation=!0;var ja=this.L$i(A);if(!ja)return null;const Ua=new gi.a(A);ja.block.Qo.add(Ua);Ua.Itb();const ac=bb.a(this.$);ac.zqc(Ua,ja);ja=ac.ky(gi.a.cLi(A));!ja||ja.floatingObject.vM||ja.floatingObject.X0a||ja.s6a(this.Uvd);ac.fOa(A.Type,A.Id,!0);return A.Id}MPg(A){return ba.EwaSettings.Ra(205)&&A.isFromCurrentSession(this.$)&&!za.f(this.$).rtl&&!za.f(this.$).Pg.Uo}Sve(A,ja){this.MPg(A)&&
(A=bb.a(this.$).ky(ja))&&(F.ULS.sendTraceTag(537167840,5,50,`ArtPasteClientEstimation.UndoPasteClientEstimation: undoing client-side estimation. Removing floating object with ID: [${ja}] of type [${A.floatingObject.type}]`),bb.a(this.$).deleteFloatingObject(A,15,!0),A.Xp&&A.$sb(A.Xp,!1))}L$i(A){if(!A)return F.ULS.sendTraceTag(537167839,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: Called with null FloatingObjectData."),null;if(za.f(this.$).ha.$e.activeFloatingObjectControlId){var ja=
za.f(this.$).ha.$e.YJ.floatingObject;A.OriginDeltaX=ja.offsetX+this.srb;A.OriginDeltaY=ja.offsetY+this.srb;A.AbsoluteLeft+=this.srb;A.AbsoluteTop+=this.srb;A.AbsoluteRight+=this.srb;A.AbsoluteBottom+=this.srb;A.ZOrder=ja.kL+1;return za.f(this.$).ha.$e.YJ.Xp}if(!this.$.na||!this.$.na.activeCell)return F.ULS.sendTraceTag(537167838,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: ActiveItem/ActiveCell is null - cannot perform estimation for grid paste."),null;var Ua=this.$.na.activeCell;
ja=za.f(this.$).fW(Ua);if(!ja)return F.ULS.sendTraceTag(537167837,0,15,`ArtPasteClientEstimation.InitializeFloatingObjectLocation: gridViewBlock for range ${Ua.toString()} is null.`),null;const ac=Nd.HelperMethods.OKd(ja.domElement,ja.vq.domElement);Ua=ja.da.ml(Ua,2);if(!ac||!Ua)return F.ULS.sendTraceTag(537167836,0,15,`ArtPasteClientEstimation.InitializeFloatingObjectLocation: blockPositionRelativeToGridOrigin is null: ${!ac}. cellPositionRelativeToGridOrigin is null: ${!Ua} .`),null;A.OriginDeltaX=
Ua.topLeft.x-ac.x;A.OriginDeltaY=Ua.topLeft.y-ac.y;A.AbsoluteLeft=Ua.topLeft.x;A.AbsoluteTop=Ua.topLeft.y;A.AbsoluteRight=A.AbsoluteLeft+Math.abs(this.wGa.AbsoluteRight-this.wGa.AbsoluteLeft);A.AbsoluteBottom=A.AbsoluteTop+Math.abs(this.wGa.AbsoluteBottom-this.wGa.AbsoluteTop);A.ZOrder=this.wGa.ZOrder+100;return new ej.a(ja.da.za.zn(ja.hashCode),ja.hashCode)}}Object(K.a)(vi,"ArtPasteClientEstimation",null,[903]);class wi{create(){const A=window.clipboardPlatform;return A?A.createClipboardItems():
null}}Object(K.a)(wi,"ClipboardItemsFactory",null,[902]);class xi{}xi.undefined="Undefined";Object(K.a)(xi,"CCPTelemetryConsts",null,[]);class Vi{}Vi.cells="Cells";Vi.floatingObject="FloatingObject";Vi.unknown="Unknown";Object(K.a)(Vi,"ActiveSelection",null,[]);class Ni{}Ni.mci="DisplayNotInvoked";Ni.Xzd="Displayed";Ni.r6j="PrerequisitesNotReady";Object(K.a)(Ni,"PasteIndicationDisplayStatus",null,[]);class fj extends uh{constructor(A,ja,Ua,ac){super(A,ja,Ua,void 0===ac?null:ac);this.oWa=null}beforePaste(){F.ULS.sendTraceTag(508121693,
0,50,"AcrossSessionInsertCopiedCutCellsHandler is called")}deserialize(A){A.isClipboardDataContainShadowWorkbook=!(void 0===A.clipboardItems.getItem(Df.a.shadowWorkbook)||null===A.clipboardItems.getItem(Df.a.shadowWorkbook));const ja=A.commandParameters.originalDestinations;if(!A.isClipboardDataContainShadowWorkbook)return Promise.resolve(!0);let Ua=null;if((()=>{let ac=this.f9b(A.clipboardItems);({YM:Ua}=ac);return ac})().returnValue){A.isShadowWorkbookParsedSuccessfully=!0;let ac=null,Ec=null;ba.EwaSettings.getBooleanFeatureGate(Pf.a.$Kb,
!1)?ac=Sa.s(ja,this.$):Ec=Sa.w(Sa.Q(ja),this.$);return this.o2j(A,Ec,ac,Ua)}return A.isClipboardInaccessible?Promise.reject(new qc(8)):Promise.reject(new qc(6))}get copyPasteInfrastructure(){var A;null!==(A=this.oWa)&&void 0!==A?A:this.oWa=this.$.ka.Ug(254,!0);return this.oWa}Qbj(A,ja,Ua,ac){return this.copyPasteInfrastructure?Bb.a(this.copyPasteInfrastructure.tRd(null,ac.commandParameters.ribbonCommandInfo,A,ja,Ua,ac)):Promise.reject(new qc(0))}o2j(A,ja,Ua,ac){A.pasteResult="CrossSessionPaste";A.payloadOrigin=
Ig.Jxd;A.payloadType=ca.shadowWorkbook;A.shadowWorkbookPayloadSize=Fh(ac);A.shadowWorkbookSizeExceedsLimit=si(ac);ac.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(A.originalSourceRangesCountExceedsLimit=ac.originalSourceRangesCountExceedsLimit);return A.shadowWorkbookSizeExceedsLimit?Promise.reject(new qc(1)):1028===A.commandParameters.commandType&&A.originalSourceRangesCountExceedsLimit?Promise.reject(new qc(1)):this.Qbj(ja,Ua,ac,A)}}Object(K.a)(fj,"AcrossSessionInsertCopiedCutCellsHandler",
uh,[]);class tj{constructor(A,ja){this.$=A;this.t_=ja}get name(){return"NonGridCopyHandler"}getSourceItem(){return new Vd(this.$.ea.gk,this.$.ua.UserSessionId)}beforeSerialize(A){kd(A);A.commandParameters.copyPasteTargetType=0}serialize(A){const ja={};if(!A.sourceItem)return F.ULS.sendTraceTag(508074082,0,10,"NonGridCopyHandler.Serialize: sourceItem should not be null"),ja;A.isFromCache=!1;A.isAsyncCopy=!1;const Ua=this.t_.create();Df.a.plainText in A.commandParameters.clipboardItems&&Ua.setItem(Df.a.plainText,
A.commandParameters.clipboardItems[Df.a.plainText]);Df.a.html in A.commandParameters.clipboardItems&&Ua.setItem(Df.a.html,A.commandParameters.clipboardItems[Df.a.html]);ja.synchronousResult=Ua;return ja}}Object(K.a)(tj,"NonGridCopyHandler",null,[901]);class ai extends uh{constructor(A,ja,Ua,ac){super(A,ja,Ua,void 0===ac?null:ac)}getSourceItem(){return new dj(this.$.ea.na.sheetName,this.$.ea.gk,this.$.ua.UserSessionId)}beforeSerialize(A){A.isFullSheetCopy=!0;super.beforeSerialize(A)}tve(A){if(!A.ShadowWorkbookBase64&&
!A.ShadowWorkbookSizeExceedsLimit)return{returnValue:!1,YM:null};const ja=this.txd(A);ja.sourceClientPath=A.SourceClientPath;ja.sourceSheetName=A.SourceSheetName;ja.sourceWorkbookName=A.SourceWorkbookName;return{returnValue:!0,YM:ja}}HYa(A,ja){F.ULS.shipAssertTag(507834589,0,!!A,"AcrossSessionFullSheetCopyPasteHandler.GetCopiedDataFromServer: copyContext shouldn't be null");const Ua=A.commandParameters.stopwatch.ii;return new Promise((ac,Ec)=>{F.ULS.sendTraceTag(507815952,0,50,`AcrossSessionFullSheetCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data for copy Id: ${A.id}`);
this.Sz.fullSheetCopy(ja.sheetName,A.commandParameters,gd=>{A.requestTelemetryData=gd.RequestTelemetryData;A.serverRequestTimeInMs=A.commandParameters.stopwatch.ii-Ua;if(!kb.a.Jk(gd.Errors)){F.ULS.sendTraceTag(507834588,0,50,`AcrossSessionFullSheetCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeeded for copy Id: ${A.id}`);const ad=this.t_.create();let Jd;const De=gd.Result;(()=>{let Xe=this.tve(De);({YM:Jd}=Xe);return Xe})().returnValue&&(A.shadowWorkbookPayloadSize=Fh(Jd),
A.shadowWorkbookSizeExceedsLimit=si(Jd),A.originalSourceRangesCountExceedsLimit=De.OriginalSourceRangesCountExceedsLimit,gd=JSON.stringify(Jd),ad.setItem(Df.a.shadowWorkbook,gd));ad.setItem(Df.a.lqc,A.commandParameters.id);this.pKb.setValue(ja,ad);A.asyncClipboardItemsKeys=rf(ad);ac(ad)}},gd=>{A.serverRequestTimeInMs=A.commandParameters.stopwatch.ii-Ua;gd=bd.a.Qj(gd.data);const ad=kb.a.Kh(gd);F.ULS.sendTraceTag(507834587,0,10,`AcrossSessionFullSheetCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${ad}. copy Id: ${A.id}`);
Ec(new fi(2,gd))})})}beforePaste(){}deserialize(A){A.isClipboardDataContainShadowWorkbook=!A.clipboardItems.getItem(Df.a.shadowWorkbook);return A.isClipboardDataContainShadowWorkbook?this.f9b(A.clipboardItems).returnValue?(A.isShadowWorkbookParsedSuccessfully=!0,Promise.resolve(!0)):A.isClipboardInaccessible?Promise.reject(new qc(8)):Promise.reject(new qc(6)):Promise.resolve(!0)}serialize(A){const ja=A.sourceItem,Ua={},ac=this.pKb.MO(ja);ac?(Ua.synchronousResult=ac,A.isFromCache=!0,A.clientSideCopyTime=
A.commandParameters.stopwatch.ii):(A.isAsyncCopy=!0,Ua.synchronousResult=this.t_.create(),Ua.synchronousResult.setItem(Df.a.plainText,this.pHb),Ua.asynchronousResult=this.HYa(A,ja,null));A.syncClipboardItemsKeys=rf(Ua.synchronousResult);return Ua}}Object(K.a)(ai,"AcrossSessionFullSheetCopyPasteHandler",uh,[]);class bi{constructor(A){this.ied=this.K9c=this.sad=this.B5c=this.Qfd=null;this.$=A}get hHj(){!this.ied&&this.$.ka.Ug(254,!0)&&(this.ied=new tj(this.$,new wi));return this.ied}get $ce(){if(!this.Qfd){const A=
this.$.ka.Ug(254,!0);A&&(this.Qfd=new uh(this.$,A,new wi))}return this.Qfd}get Tbj(){if(!this.sad){const A=this.$.ka.Ug(254,!0);A&&(this.sad=new fj(this.$,A,new wi))}return this.sad}get rzf(){if(!this.K9c){const A=this.$.ka.Ug(254,!0);A&&(this.K9c=new ai(this.$,A,new wi))}return this.K9c}get spd(){if(!this.B5c&&this.$.ka.Ug(254,!0)){const A=new vi(this.$);this.B5c=new Ui(this.$,new wi,new Mi(this.$,A),A)}return this.B5c}getCopyFlowHandler(A){if(-207190267===A.commandParameters.ribbonCommandInfo.command)return this.rzf;
if(A.commandParameters.clipboardItems)return this.hHj;const ja=this.oGi(za.f(this.$).wk);A.commandParameters.copyPasteHandlerName=ja.name;return ja}getPasteFlowHandler(A){var ja=A.copyContextSnapshot;switch(A.commandParameters.ribbonCommandInfo.command){case 440556491:return A=this.rzf;case -160032004:case -1065525230:return A=this.Tbj;default:return ja=ig(A)?this.spd:Of(A)?this.$ce:(null===ja||void 0===ja?0:ja.sourceItem)&&Object.getType(ja.sourceItem)===ne?this.spd:this.$ce,A.commandParameters.copyPasteHandlerName=
ja.name,ja}}initializePasteContext(A){if(A){A.isSameSession=!1;A.isShadowWorkbookParsedSuccessfully=!1;A.pasteResult=xi.undefined;A.payloadOrigin=xi.undefined;A.payloadType=xi.undefined;A.encounteredDeploymentErrors=!1;A.shadowWorkbookSizeExceedsLimit=!1;A.originalSourceRangesCountExceedsLimit=!1;A.activeSelectionType=this.KBi();A.indicationDisplayScheduled=!1;A.pasteDestinationHasMergedCells=!1;A.cseStatus=0;A.pasteIndicationDisplayStatus=Ni.mci;if(ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",
!1)||ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",!1))A.ArtSourceItemType=xi.undefined;if(A.copyContextSnapshot){var ja=A.copyContextSnapshot;const ad=Ge(ja.sourceItem);var Ua=ja.sourceItem;var ac=!!Ua&&Object.getType(Ua)===ne;Ua=0;var Ec=!1;ad?(Ec=ja.sourceItem,A.isSameSession=Ec.isFromCurrentSession(this.$),Ua=1,Ec=this.tmj(Ec,A)):ac&&(A.isSameSession=ja.sourceItem.isFromCurrentSession(this.$),Ua=2);if(A.copyContextSnapshot.commandParameters){const Jd=
-1985798686===ja.commandParameters.ribbonCommandInfo.command;ac=A.commandParameters;var gd=this.$;ja?gd&&gd.ua?ja=ja.sessionId===gd.ua.UserSessionId:(F.ULS.shipAssertTag(537166211,0,!1,"ewaControl shouldn't be null"),ja=!1):(F.ULS.shipAssertTag(537166212,0,!1,"copyContext shouldn't be null"),ja=!1);ac.clearSystemClipboard=ja&&Jd&&ad&&!Ec;A.commandParameters.copyPasteTargetType=Ua}}}}getSessionId(){return this.$.ua.UserSessionId}tmj(A,ja){const Ua=A.ranges.some(ac=>ac.fk)&&ja.commandParameters.originalDestinations.some(ac=>
1!==ac.top);return A.ranges.some(ac=>ac.isRow)&&ja.commandParameters.originalDestinations.some(ac=>1!==ac.left)||Ua}oGi(A){switch(A){case 1:return this.$ce;case 64:case 4:case 2:case 256:return this.spd;default:throw Error.invalidOperation("Unsupported selection");}}KBi(){return za.f(this.$).ha.wk&470?Vi.floatingObject:1===za.f(this.$).ha.wk?Vi.cells:Vi.unknown}getDialogResponse(){}}Object(K.a)(bi,"ExcelCopyPasteApplicationHost",null,[889]);class ji extends qh.a{constructor(A,ja){super(A);this.bC=
null;this.Sbj=(Ua,ac)=>{1===Ua?(Ua=ji.ubi[ac[ji.tbi]],F.ULS.sendTraceTag(537167683,0,50,`InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler OK button pressed with valid input, shift direction = ${0===Ua?"Horizontal":"Vertical"}`),this.bC.setResult(Ua)):(F.ULS.sendTraceTag(537167682,0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler cancel button pressed"),this.bC.xC())};this.Im(ja)}get ki(){return"InsertCopiedCutCellsDialog"}Im(A){this.bC=new Ob.a;const ja=Ba.a.instance.ia(16);
A=this.iR(A);this.initializeAndShow(ja,this.Sbj,A)}iR(A){return{[ji.fy]:this.ki,[ji.foj]:A}}}ji.tbi="direction";ji.foj="isRtl";ji.ubi={["Vertical"]:1,["Horizontal"]:0};Object(K.a)(ji,"InsertCopiedCutCellsDialog",qh.a,[]);class Wi{Bqc(A,ja){return(new ji(A,ja)).bC.task}}Object(K.a)(Wi,"InsertCopiedCutCellsDialogFactory",null,[888]);var Ij=a(32),Ef=a(307),Ci=a(902);class kf{constructor(A){this.fLb="";this.OF=this.TB=null;this.rrb=new Map;this.Ida=null;this.kQc=!1;this.POf=(ja,Ua)=>{this.hide(void 0===
ja?null:ja,void 0===Ua?null:Ua)};this.$=A;this.da=za.f(A);this.da.ha.Cw(this.POf)}oAd(){this.kQc||(F.ULS.sendTraceTag(537167680,0,50,"PasteIndicationManager.DownloadPrerequisitesIfNeeded: Trying to get appChrome"),this.da.$.k5(A=>{A.F$(0).then(()=>{this.kQc=!0})}))}Htk(A){this.oAd();this.fLb=A;this.BIg(A)}Gtk(A){const ja=A.commandParameters.id;F.ULS.sendTraceTag(537167651,0,50,`PasteIndicationManager.ScheduleDisplay: pasteCommandId = ${ja}, cancelCtx is null = ${!this.TB}, PrerequisitesDownloaded = ${this.kQc}`);
this.oAd();this.fLb=ja;const Ua=!this.sbg();if(!this.TB||Ua)this.s$e(),this.TB=pf.a.instance.create(()=>{this.lci(A)},void 0===A.timeoutToShowSpinnerInMs||null===A.timeoutToShowSpinnerInMs?100:A.timeoutToShowSpinnerInMs,Ud.a.V1j);this.Ida=A.commandParameters.originalDestinations;this.BIg(ja)}lci(A){this.kQc?(this.display(A.commandParameters.originalDestinations),A.pasteIndicationDisplayStatus=Ni.Xzd):(F.ULS.sendTraceTag(537167650,0,50,"PasteIndicationManager.DisplayIfPossible: Prerequisites were not ready, skipping display"),
this.hide(),A.pasteIndicationDisplayStatus=Ni.r6j)}BIg(A){this.rrb.set(A,Ij.a.Tg.qk);pf.a.instance.create(()=>{this.wci(A)},this.$.ua.PasteToastNotificationDelayTime,Ud.a.W1j)}wci(A){this.rrb.has(A)&&(this.OF?this.OF.displayTimeoutSeconds+=this.$.ua.PasteToastNotificationDefaultDisplayDuration:(A=Ba.a.instance.ia(2341),this.OF=Kb.a.IA.AK.mX(A,!1),this.OF.image=5,this.OF.u0=Ci.a.jdk,this.OF.displayTimeoutSeconds=this.$.ua.PasteToastNotificationDefaultDisplayDuration,Kb.a.IA.AK.eF(this.OF)))}kga(A,
ja,Ua){A&&this.OF&&(A=Ua?`"${ja}" ${Ba.a.instance.ia(2433)}`:Ba.a.instance.ia(2342),this.OF.s1c(A),this.OF.image=5,this.OF.u0=Ua?Ci.a.RWk:Ci.a.qbf);setTimeout(()=>{this.Hhk()},3E3)}Hhk(){this.OF&&(Kb.a.IA.AK.removeEntry(this.OF),this.OF=null)}display(A){F.ULS.sendTraceTag(537167649,0,50,"PasteIndicationManager.Display: started");this.da.rh.BP(Ze.a.d8a(lg.d(this.da.$.na),A),kf.pPc,!0);this.da.rh.rw(kf.pPc)}Rkb(A,ja,Ua,ac){ja=void 0===ja?!0:ja;Ua=void 0===Ua?null:Ua;ac=void 0===ac?!1:ac;F.ULS.sendTraceTag(537167648,
0,50,`PasteIndicationManager.HideForPasteId: pasteCommandId = ${A}, currentPasteCommandId = ${this.fLb}`);A&&ea.a.equals(A,this.fLb,!1)&&this.hide();if(A&&this.rrb.has(A)){const Ec=Ef.a(Ij.a.Tg.qk,this.rrb.get(A));6E4<Ec&&F.ULS.sendTraceTag(508839751,0,50,`PasteIndicationManager.hideForPasteId: large paste. CommandId (${A}), scheduleDisplayToHideDurationInMs (${Ec}))`);this.rrb.delete(A);null!=this.OF&&0===this.rrb.size&&this.kga(ja,Ua,ac)}}hide(A){this.Ida&&(void 0===A?0:A)&&this.sbg()&&F.ULS.sendTraceTag(537167647,
0,15,"PasteIndicationManager.Hide: Triggered by a SelectionChanged event while indication is (or will be) active but active range did not change");this.fLb="";this.s$e();this.Ida=null;0!==this.da.rh.yHd([30]).length&&(this.da.rh.zq(kf.pPc),this.da.rh.Vs(null,kf.pPc))}sbg(){return Sa.W(this.da.ha.qa.selectedRanges,this.Ida)}s$e(){this.TB&&(sb.a.Ng(this.TB),this.TB=null)}dispose(){this.hide();this.OF&&this.kga(!1);this.da.ha.$w(this.POf)}}kf.pPc=[30];Object(K.a)(kf,"PasteIndicationManager",null,[887,
2]);var uj=a(1186),Zg=a(901),oj=a(602);const Xi=()=>{var A=navigator.userAgentData;if(A)for(let ja=0;ja<A.brands.length;ja++){if("Microsoft Edge"===A.brands[ja].brand&&79<=parseFloat(A.brands[ja].version))return!0}else if(navigator.userAgent&&(A=navigator.userAgent.match(/(Edg|EdgiOS|EdgA)\/(\d+)/i))&&79<=parseFloat(A[2]))return!0;return!1},Yi=A=>{const ja=Pf.a.Eej&&!A.isMobileMode,Ua=Pf.a.Fej&&A.isMobileMode&&A.isEditMode;A=A.Tj.get(57);return(ja||Ua)&&!A&&!!(navigator&&navigator.clipboard&&navigator.clipboard.read&&
navigator.clipboard.write&&(Xi()||Da.a.Av&&Da.a.kKa(86)))};class Di extends hb.a{constructor(A){super();this.xUh="clipboard-read";this.$=A;this.Fq=Ba.a.instance;this.Pfj=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8282600_EnableClipboardPermissionLogging");this.Bl()}create(){const A=Nb.a.m6([75,76],4,this.hh,void 0,void 0,void 0,Di.i5b),ja=Object(Bb.d)(ka.a.resolve(Ha.sc,{va:this.hh})),Ua=Object(Bb.d)(ka.a.resolve(Ha.Lg)),ac=Ha.jd.Ha()?Object(Bb.d)(ka.a.resolve(Ha.jd,{va:this.hh})):dg.a.Va(null);
$b.TaskExtensions.Ua($b.TaskExtensions.Ln([ja,A,Ua,ac],this.xa),()=>{const Ec=new uj.a;let gd=null;this.xXh(Ec).then(ad=>{gd=ad.scf;const Jd=copyPasteInfra.createCopyPasteInfra(gd,new bi(this.$),Ec);F.ULS.shipAssertTag(537167762,0,!!this.$.ua,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext should not be null");F.ULS.shipAssertTag(537167761,0,!!this.$.ua&&!!this.$.ua.DocumentHostInfo,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext.DocumentHostInfo should not be null");
const De=gd.getMetadataManager();var Xe=Object(Zg.a)(this.$.ka,254,()=>new Wf(this.$,De,ja.result,Jd,new Ih(this.$,za.f(this.$)),new Wi,this.$.ua.DocumentHostInfo.UserId,gd.getInitializationError(),Ua.result,ac.result));this.Yj(Xe);if(ad.pfb){Xe=Wf.Mxc();const lf=JSON.stringify(ad.pfb.dataClipboardCapabilities),mf=ad.pfb.clipboardStrategiesToInitialize[0].clipboardStrategyType===ad.pfb.dataClipboardStrategyType,Rf=void 0===window.bsqmXLSPageLoadStartTime||null===window.bsqmXLSPageLoadStartTime?"-1":
(Date.now()-window.bsqmXLSPageLoadStartTime.getTime()).toString();F.ULS.sendTraceTag(41731933,0,50,`CopyPasteInfrastructureFactory.Create: Initialize CCP infra succeed. SliceName=${Xe}, StrategyType=${ad.pfb.dataClipboardStrategyType}, StrategyCapabilities=${lf}, IsBestStrategyTypeInitialized=${mf}, InfraLoadTimeMS=${Rf}`)}else F.ULS.shipAssertTag(537167760,0,!1,"CopyPasteInfrastructureFactory.Create: initResult.ClipboardPlatformEnvironmentInitializationInfo should not be null")},ad=>{const Jd=Wf.Mxc();
ad=ad?copyPasteInfra.getStringifiedError(ad):"null";F.ULS.shipAssertTag(38847436,0,!1,`CopyPasteInfrastructureFactory.Create: error during call to clipboardPlatformEnvironment.Init(). Copy Paste operations will not be available in this session. SliceName: ${Jd} error: ${ad}`)})},this.xa,3)}dispose(){super.dispose()}xXh(A){var ja,Ua;let ac=null;var Ec=window.clipboardPlatform;Ec&&(ac=Ec.getClipboardPlatformEnvironment(),null===(ja=Ec.setClipboardPlatformFeatureGateManager)||void 0===ja?void 0:ja.call(Ec,
oj.a()));if(!ac)return F.ULS.shipAssertTag(537167759,0,!1,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: getClipboardPlatformEnvironment should have returned a valid object"),Promise.reject(null);ja=this.$.ua;Ec=[ja.OfficeOnlineChromeExtensionId,ja.ChromeClipboardAccessExtensionId];const gd=this.Fq.Ba(5),ad=this.$.Tj.get(57);let Jd=!ad&&this.$.Tj.get(5);var De=this.$.ea.th;De&&(De.inWebPart||De.inViewerFromWebPart||De.isDivSyndicated)&&(Jd=!1);(De=Yi(this.$))&&F.ULS.sendTraceTag(508703874,
0,50,"CopyPasteInfrastructureFactory.configureClipboardPlatformEnvironment: Async System Clipboard is allowed");try{this.Pfj&&(null===(Ua=null===navigator||void 0===navigator?void 0:navigator.permissions)||void 0===Ua?0:Ua.query)&&navigator.permissions.query({name:this.xUh}).then(Xe=>{F.ULS.sendTraceTag(508151361,0,50,`CopyPasteInfrastructureFactory.configureClipboardPlatformEnvironment: Clipboard read permission state: ${null===Xe||void 0===Xe?void 0:Xe.state}`)}).catch(Xe=>{F.ULS.sendTraceTag(508151360,
0,50,`CopyPasteInfrastructureFactory.configureClipboardPlatformEnvironment: Failed to get clipboard-read permission state. Error: ${JSON.stringify(Xe)}`)})}catch(Xe){F.ULS.sendTraceTag(508151331,0,50,`CopyPasteInfrastructureFactory.configureClipboardPlatformEnvironment: Failed to get clipboard-read permission state. Error: ${JSON.stringify(Xe)}`)}Ua=this.fFi(Jd,!ad,De);F.ULS.shipAssertTag(537167758,0,!!ja.DocumentHostInfo,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: bootstrapContext.DocumentHostInfo should not be null");
return ac.init(A,Ec,ja.SharedClipboardHostingApp,ja.SharedClipboardHostingApps,ja.SharedClipboardHostingEnvironments,ja.SharedClipboardOverrideOrigin,ja.SharedClipboardSchemaVersion,ja.SharedClipboardExpirationInMinutes,ja.ClipboardPromiseTimeoutInMinutes,gd,ja.MachineCluster,new ri(this.$),Ua,ja.DocumentHostInfo.UserId,ja.ClipboardTtlInMS,ba.EwaSettings.Ra(273),ja.UserSessionId,ja.BulsEndpointUrl).then(Xe=>Object(Ea.a)(new sj,{scf:ac,pfb:Xe}),Xe=>Promise.reject(Xe))}fFi(A,ja,Ua){const ac=[];A&&Ua&&
ac.push(this.Oif(9));A&&ja&&ac.push(this.Oif(6));ja&&(ac.push(this.Cxd(7)),ac.push(this.Cxd(0)));A&&ac.push(this.Khf());ac.push({clipboardStrategyType:4});Ua=ac?ac.map(Ec=>JSON.stringify(Ec)).join(","):"[]";F.ULS.sendTraceTag(39978242,0,50,`CopyPasteInfrastructureFactory.GetClipboardStrategiesInitList: create clipboard stratgy initialization list: isBrowserStorageAllowed=${A}, isSystemClipboardAllowed=${ja}, result = ${Ua}`);return ac}Khf(){const A=this.$.ua,ja={clipboardStrategyType:5};ja.sessionId=
A.UserSessionId;ja.useSharedClipboardIframe=!0;ja.sharedClipboardHostingApp=A.SharedClipboardHostingApp;ja.sharedClipboardHostingApps=A.SharedClipboardHostingApps;ja.sharedClipboardHostingEnvironments=A.SharedClipboardHostingEnvironments;ja.sharedClipboardOverrideOrigin=A.SharedClipboardOverrideOrigin;ja.sharedClipboardSchemaVersion=A.SharedClipboardSchemaVersion;ja.sharedClipboardExpirationInMinutes=A.SharedClipboardExpirationInMinutes;ja.wacCluster=A.MachineCluster;return ja}Oif(A){const ja={};
ja.clipboardStrategyType=A;ja.localStorageStrategyParameters=this.Khf();ja.systemClipboardStrategyParameters=this.Cxd(0);return ja}Cxd(A){const ja={};ja.clipboardStrategyType=A;ja.skipFilesIfPlainTextExists=!0;return ja}static Aa(A){A.ka.ph(373,new kf(A));A.ka.ph(Di.i5b,new Di(A))}}Di.i5b=255;Object(K.a)(Di,"CopyPasteInfrastructureFactory",hb.a,[]);var $g=a(9),vj=a(586),yj=a(438);class bj{constructor(){this.rpa=this.wAf=null}}Object(K.a)(bj,"GestureAdapterInfo",null,[]);class gj{constructor(){this.b8c=
null}gvj(){if(!this.b8c){var A="hammer.min.js";mb.AFrameworkApplication.fa.rv("IsServerFlavorDebug")&&(A=mb.AFrameworkApplication.fa.la("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");A=mb.AFrameworkApplication.fJ(String.format("{0}",A),5);A=Hf.a.create(A,null,null);Ve.a.sva(A);this.b8c=A.Bob}return this.b8c}static get instance(){gj.Wa||(gj.Wa=new gj);return gj.Wa}}gj.Wa=null;Object(K.a)(gj,"HammerJsDependencyLoader",null,[891]);var th;(function(A){A[A.none=-1]="none";A[A.HPc=0]="pinch";A[A.pan=
1]="pan";A[A.Wse=2]="swipe"})(th||(th={}));Object(K.b)("GestureEvent",th);var Th=a(84);class Oh extends Th.a{constructor(A,ja,Ua,ac,Ec,gd,ad,Jd){super(A,Ua,ac,gd);this.xzb=ja;this.Isa=ad;this.z8=Jd;this.dih=Ec}get shiftKey(){return this.Isa}get ctrlKey(){return this.z8}get clientPoint(){return this.xzb}get rIa(){return this.dih}static create(A,ja,Ua,ac,Ec,gd){if(Ua.rawEvent)if(gd){var ad=Ua.rawEvent;ad=new Sys.UI.Point(ad.clientX,ad.clientY)}else ad=Th.a.sPb(Ua);else ad=new Sys.UI.Point(Ua.clientX,
Ua.clientY);return new Oh(A,ad,ja,Ua,ac,Ec,Ua.shiftKey,Ua.ctrlKey,gd)}}Object(K.a)(Oh,"GestureEventArgs",Th.a,[]);class pi{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=
null}}Object(K.a)(pi,"GestureManagerData",null,[]);class kh{}kh.Nah=2;kh.Oah=4;kh.Pah=8;kh.Qah=8;Object(K.a)(kh,"HammerConstants",null,[]);var cj=a(108),wj=a(219),Ei=a(171);class Oi extends Mb.a{constructor(A,ja){super();this.wDa=yj.a.rBi;this.sfd=!!window.PointerEvent;this.IWe=window.hasOwnProperty("ontouchstart");this.L$a=this.WCb=null;this.Nja=!1;this.W2=new Yg.a;this.pDb=new Yg.a;this.eih=new he.a;this.RCa=null;this.M9a=this.e$c=this.pFe=this.I6c=this.Zcd=this.XSe=this.vFe=this.VEb=!1;this.zCb=
-1;this.curRecognizer=this.element=this.handlers=this.session=this.vid=null;this.yMa=(Ua,ac,Ec)=>{Ua=this.dFf(Ua);ac=this.RLi(Ec);Hammer.inputHandler(this,Ua,ac);this.Nja&&Ec.preventDefault();return this.Nja};this.m3a=(Ua,ac,Ec)=>{var gd=Ec.rawEvent.pointerType.toString();const ad=Ec.rawEvent.pointerId.toString();if("touch"!==gd)return!1;Ua=this.dFf(Ua);if(1!==Ua&&!this.W2.Vg(ad))return!1;this.vFe&&1===Ua&&Ec.rawEvent.isPrimary&&this.W2.count&&(F.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),
this.Wnc());this.VEb?this.jvh(ad,ac,Ec):this.W2.ga(ad,Ec);this.Zcd&&2===Ua&&(!this.I6c||this.I6c&&"function"===typeof Ec.rawEvent.getCoalescedEvents)&&(ac=Ec.rawEvent.getCoalescedEvents())&&this.kNf()&&(this.zCb=Math.max(this.zCb,ac.length));this.XSe&&(this.Nja=!1);gd=this.QLi(this.W2,Ec,gd);Hammer.inputHandler(this,Ua,gd);if(4===Ua||8===Ua)this.VEb?this.VAg(ad):this.W2.remove(ad),this.W2.count||(this.session=null,this.Zcd&&-1!==this.zCb&&(F.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",
this.zCb),this.zCb=-1));this.Nja&&Ec.preventDefault();return this.Nja};this.zNc=()=>!1;this.Pj=cj.EventHandlerManager.instance;this.sfd?(F.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.WCb=this.m3a,this.L$a=qb.a.tBi):this.IWe?(F.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.WCb=this.yMa,this.L$a=qb.a.ixb):(F.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.WCb=this.zNc,this.L$a=qb.a.sBi);this.oo=ja;this.Hra=A;mb.AFrameworkApplication.fa&&(this.VEb=mb.AFrameworkApplication.fa.la("UsePointerCaptureIsEnabled"),
this.vFe=mb.AFrameworkApplication.fa.la("ClearCacheOnPrimaryPointerIsEnabled"),this.XSe=mb.AFrameworkApplication.fa.la("ResetHandledBeforeInputHandlerIsEnabled"),this.Zcd=mb.AFrameworkApplication.fa.la("LogCoalescedEventsIsEnabled"),this.I6c=mb.AFrameworkApplication.fa.la("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.pFe=mb.AFrameworkApplication.fa.la("CheckIfHammerExistsAfterDownloadIsEnabled"),this.e$c=mb.AFrameworkApplication.fa.la("HammerJsPerformanceTimersIsEnabled"),this.M9a=this.VEb&&
mb.AFrameworkApplication.fa.la("CancelDragFromGestureInputManagerIsEnabled")&&mb.AFrameworkApplication.fa.la("UseGestureInputManagerPointerCacheIsEnabled"))}HKi(){return this.sfd?0:this.IWe?1:2}xv(A){super.xv(A);this.Pj.exa(this.L$a,A,0,this.WCb)}ou(A){super.ou(A);this.Pj.WWa(A,this.L$a)}qek(A,ja,Ua){Ua=void 0===Ua?null:Ua;var ac=void 0===ac?null:ac;mb.AFrameworkApplication.iGc()?gj.instance.gvj().continueWith(Ec=>{this.qRk();if(Ec.om||Ec.Sn)F.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",
Ec.status);else{F.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",Ec.status);if(this.pFe){Ec=window.Hammer;if("undefined"===typeof Ec){F.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.aZc();return}if("undefined"===typeof Ec.inputHandler){F.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");this.aZc();return}}if(!A)throw this.aZc(),Error.argumentNull("source element can not be null");Ec=wj.a.aJa(A,this.wDa);if(void 0===Ec||null===Ec)Ec=new Yg.a,
wj.a.Xub(A,this.wDa,Ec),this.rek(A);var gd=null;if(!Ec.Vg(th[0])){gd=Object;var ad=gd.assign,Jd=new bj,De=th[0],Xe=ac;Xe=void 0===Xe?null:Xe;if(void 0===this||null===this)throw F.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");let lf=null;switch(De){case qb.a.HPc:lf=new Hammer.Pinch(Xe);break;case qb.a.pan:lf=new Hammer.Pan(Xe)}lf&&(lf.manager=this);gd=ad.call(gd,Jd,{rpa:lf,wAf:ja});Ec.add(th[0],gd)}if(void 0!==Ua&&null!==Ua)for(ad=0;ad<Ua.length;ad++)Ec.Vg(th[Ua[ad]])&&
(Jd=Ec.ma(th[Ua[ad]]),gd.rpa.recognizeWith(Jd.rpa))}this.aZc()}):F.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}qRk(){this.e$c&&(this.oo?this.vid=this.oo.vi("Task","RegisterGestureAdapterAfterLoad"):F.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}aZc(){this.e$c&&(this.vid?this.vid.stop():F.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}rek(A){this.eih.add(A);this.Pj.exa(this.L$a,
A,0,this.WCb)}recognize(A){var ja=Array(A.pointers.length);for(var Ua=0;Ua<A.pointers.length;Ua++)ja[Ua]=A.pointers[Ua].target;Ua=null;for(this.RCa=this.uNi(ja);void 0!==this.RCa&&null!==this.RCa&&(Ua=wj.a.aJa(this.RCa,this.wDa),void 0===Ua||null===Ua);this.RCa=this.RCa.parentNode);if(void 0!==Ua&&null!==Ua){this.curRecognizer&&this.curRecognizer.state===kh.Qah&&(this.curRecognizer=null);ja=Ua.keys;for(const ac of ja){ja=Ua.ma(ac);void 0!==ja&&null!==ja&&void 0!==ja.rpa&&null!==ja.rpa&&(void 0===
this.curRecognizer||null===this.curRecognizer||ja.rpa===this.curRecognizer||ja.rpa.canRecognizeWith(this.curRecognizer))&&ja.rpa.recognize(A);const Ec=ja.rpa.state;this.curRecognizer||kh.Nah!==Ec&&kh.Oah!==Ec&&kh.Pah!==Ec||(this.curRecognizer=ja.rpa)}}}emit(A,ja){if("hammer.input"!==A){this.Nja=!1;ja=Oh.create(A,this.RCa,ja.srcEvent,ja,3,this.sfd);var Ua=wj.a.aJa(this.RCa,this.wDa);if(this.zmj(A))var ac=0;else if(this.kmj(A))ac=1;else if(this.Gpj(A))ac=2;else{F.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");
return}({value:Ua}=Ua.gj(th[ac]));void 0!==Ua&&null!==Ua&&((Ua=Ua.wAf,Ua.rjj())?A.endsWith("start")?this.Nja=Ua.DPj(ja):A.endsWith("end")?(Ua.BPj(ja),this.Nja=!0):A.endsWith("cancel")?(Ua.APj(ja),this.Nja=!0):A.endsWith("move")&&(this.Nja=Ua.CPj(ja)):F.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",A))}}get(A){return Object(Ae.a)(Hammer.Recognizer,A)}uNi(A){if(1>A.length)return null;if(1===A.length)return A[0];var ja=A[0],Ua=!0;for(let ac=1;ac<A.length;ac++){if(!A[ac])return null;
if(ja!==A[ac]){Ua=!1;break}}if(Ua)return ja;ja=this.LAf(A[0]);Ua=0;for(const ac of A){A=this.LAf(ac);if(ja.ma(ja.count-1)!==A.ma(A.count-1))return null;for(let Ec=ja.count-2,gd=A.count-2;Ec>=Ua&&0<=gd;Ec--,gd--)if(ja.ma(Ec)!==A.ma(gd)){Ua=Ec+1;break}}return ja.ma(Ua)}LAf(A){const ja=new he.a;for(;void 0!==A&&null!==A;A=A.parentNode)ja.add(A);return ja}dFf(A){switch(A){case qb.a.um:case qb.a.aua:return 1;case qb.a.kn:case qb.a.$Ua:return 2;case qb.a.Ok:case qb.a.XHb:return 4;case qb.a.Q_c:case qb.a.ard:return 8}return 0}kNf(){return 1<
this.W2.count}Wnc(){F.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.VEb)for(const A of this.W2)this.VAg(A.key);else this.W2=new Yg.a;this.session=null}jvh(A,ja,Ua){F.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",A);if(!this.pDb.Vg(A)){try{ja.setPointerCapture(A)}catch(ac){F.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",ac)}this.pDb.add(A,ja)}this.W2.ga(A,Ua);this.M9a&&1<this.W2.count&&this.Hra&&!this.Hra.HIb&&(this.Hra.HIb=!0)}VAg(A){F.ULS.sendTraceTag(594055957,
310,50,"RemovePointerFromCaches: pointerId: {0}",A);if(this.pDb.Vg(A)){try{this.pDb.ma(A).releasePointerCapture(A)}catch(ja){F.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",ja)}this.pDb.remove(A)}else F.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",A);this.W2.remove(A);this.M9a&&1>=this.W2.count&&this.Hra&&this.Hra.HIb&&(this.Hra.HIb=!1)}RLi(A){const ja=new pi;var Ua=A.rawEvent;const ac=Ua.touches;Ua=Ua.changedTouches;ja.pointers=Array.clone(ac);
ja.pointers=Array.clone(0<ac.length?ac:Ua);ja.changedPointers=Array.clone(Ua);ja.srcEvent=A;ja.pointerType="touch";return ja}QLi(A,ja,Ua){const ac=new pi;ac.pointers=Ei.toArray(A.values);ac.changedPointers=[ja];ac.pointerType=Ua;ac.srcEvent=ja;return ac}zmj(A){return xa.a.startsWith(A,qb.a.HPc)}kmj(A){return xa.a.startsWith(A,qb.a.pan)}Gpj(A){return xa.a.startsWith(A,qb.a.Wse)}}Object(K.a)(Oi,"GestureInputManager",Mb.a,[881,882]);var Zi=a(380);class Ph{constructor(){this.Mh=null;this.qG=!1}get name(){return"Common.App.GestureInputManager"}ao(A){A.register(Oi,
"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").hi().mi(()=>new Oi(Zi.a.instance,mb.AFrameworkApplication.ra.cL));this.Mh=A}init(){this.qG||(me.a.instance.resolve("Common.App.GestureManager.GestureInputManager"),this.qG=!0)}dispose(){}static main(){fe.a.instance.Lo(new Ph)}}Object(K.a)(Ph,"GestureInputManagerPackage",null,[12,13]);const Pi=()=>me.a.instance.mo("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo");var L=a(113);class qa extends L.a{constructor(){super()}static instance(){return qa.Wa||
(qa.Wa=new qa)}}qa.XXj="OnTextSelectionHighlightChangeEvent";qa.Wa=null;Object(K.a)(qa,"TextSelectionHighlightChangeEvent",L.a,[]);class Va extends Ca.a{constructor(A,ja){super(!1,!1,!0);this.Y3b=(Ua,ac)=>{1===Ua&&(this.CQa.RPd=ac.tooltipPersistenceEnabled,Ua=ac.textSelectionChangeEnabled,this.CQa.w8b!==Ua&&this.xqh.raiseEvent(qa.XXj),this.CQa.w8b=Ua)};this.CQa=A;this.xqh=ja}start(){const A={["tooltipPersistenceEnabled"]:this.CQa.RPd};A.textSelectionChangeEnabled=this.CQa.w8b;this.initializeAndShow("",
this.Y3b,{["id"]:"AccessibilitySettingsDialog",["bodyControls"]:A});F.ULS.sendTraceTag(507905246,324,50,"User opened the Accessibility Settings Dialog")}}Object(K.a)(Va,"AccessibilitySettingsDialog",Ca.a,[]);var Fb=a(134);class bc{constructor(A,ja){this.sKk=()=>{(new Va(this.CQa,qa.instance())).start();return 32};this.$c=A;this.CQa=ja}ko(){this.$c.Hh(Dc.a.rKk,Fb.a.frame,this.sKk)}}Object(K.a)(bc,"AccessibilitySettingsDialogActor",null,[885]);const Ic=A=>{const ja=new Ob.a;mb.AFrameworkApplication.$i.Ou(Hd(A),
1,null,null,!0,2,Ua=>{200===Ua.data.httpStatus?ja.setResult("true"===Ua.data.responseData.toLowerCase()):ja.setResult(!1)},()=>{ja.setResult(!1)},null,void 0,void 0,void 0,void 0,"7");return ja.task},td=(A,ja)=>{mb.AFrameworkApplication.$i.Ou(Hd(A),2,ja.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8")},Hd=A=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",mb.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",A,mb.AFrameworkApplication.qo);
var pe=a(133);class Ke{constructor(){this.Wbb=this.S$a=null}get RPd(){return!!this.S$a}set RPd(A){A!==this.S$a&&(this.S$a=A,pe.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(A),this.eHc()&&td("saveHoverableRibbonTooltipIsEnabled",A))}get w8b(){return!!this.Wbb}set w8b(A){A!==this.Wbb&&(this.Wbb=A,this.eHc()&&td("saveTextSelectionHighlightChangeIsEnabled",A))}nvj(){const A=new Ob.a;if(this.S$a)A.setResult(this.S$a);else if(this.eHc()){const ja=Ic("getHoverableRibbonTooltipIsEnabled");
ja.continueWith(()=>{this.S$a=ja.result;pe.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(ja.result);A.setResult(ja.result)},8)}else A.setResult(!1)}Nvj(){const A=new Ob.a;if(this.Wbb)A.setResult(this.Wbb);else if(this.eHc()){const ja=Ic("getTextSelectionHighlightChangeIsEnabled");ja.continueWith(()=>{this.Wbb=ja.result;A.setResult(ja.result)},8)}else A.setResult(!1)}eHc(){const A=mb.AFrameworkApplication.fa.la("IsRoamingServiceEnabled"),ja=mb.AFrameworkApplication.fa.la("IsAnonymousUser");
return A&&!ja}}Object(K.a)(Ke,"AccessibilitySettingsInfo",null,[880]);var uf=a(116);class zf{constructor(){this.Mh=null}get name(){return"Common.App.AccessibilitySettings"}ao(A){this.Mh=A;this.Mh.register(Ke,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").mi(()=>new Ke).hi();this.Mh.register(bc,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").mi(()=>
new bc(mb.AFrameworkApplication.jh,Pi())).hi()}init(){const A=Pi(),ja=me.a.instance.mo("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");A&&ja?(ja.ko(),A.nvj(),A.Nvj(),uf.a(508827098,200,50,"Text Selection Highlight Change Setting value on boot: {0}",A.w8b)):uf.a(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){fe.a.instance.Lo(new zf)}}Object(K.a)(zf,"AccessibilitySettingsPackage",
null,[12,13]);class bg extends Ca.a{constructor(A,ja){super(!1,!1,!0);this.Y3b=(Ua,ac)=>{if(1===Ua){Ua=ac.showRibbonChoice;if(this.mTe!==ac.ribbonLayoutChoice)appChrome.onRibbonModeToggle();this.eVe!==Ua&&("AlwaysShow"===Ua?appChrome.api.getAlwaysShowCommandHandler():appChrome.api.getHideCommandHandler())()}};this.mTe=A;this.eVe=ja}start(){this.initializeAndShow("",this.Y3b,{["id"]:"RibbonSettingsDialog",["bodyControls"]:{["ribbonLayoutChoice"]:this.mTe,["showRibbonChoice"]:this.eVe}})}}Object(K.a)(bg,
"RibbonSettingsDialog",Ca.a,[]);class kg{constructor(A){this.$c=A}ko(){this.$c.Hh(Dc.a.nNk,Fb.a.frame,this.oNk)}oNk(){let A="SingleLineRibbon";"Multiline"===appChrome.selectors.getRibbonMode()&&(A="ClassicRibbon");const ja=appChrome.selectors.getShyState().isActive?"AutomaticallyHide":"AlwaysShow";(new bg(A,ja)).start();return 32}}Object(K.a)(kg,"RibbonSettingsDialogActor",null,[886]);class ug{constructor(){this.Mh=null}get name(){return"Common.App.RibbonSettings"}ao(A){this.Mh=A;this.Mh.register(kg,
"Common.App.RibbonSettings.RibbonSettingsDialogActor").as("Common.App.RibbonSettings.IRibbonSettingsDialogActor").mi(()=>new kg(mb.AFrameworkApplication.jh)).hi()}init(){const A=me.a.instance.mo("Common.App.RibbonSettings.IRibbonSettingsDialogActor");A?A.ko():uf.a(508436678,200,15,"Failed to resolve IRibbonSettingsDialogActor. Ribbon dialog feature is not enabled.")}dispose(){}static main(){fe.a.instance.Lo(new ug)}}Object(K.a)(ug,"RibbonSettingsPackage",null,[12,13]);class Gg extends hb.a{constructor(A){super();
this.$=A;this.Bl()}create(){const A=Object(Bb.d)(ka.a.resolve(Ha.kd,{va:this.hh}));$b.TaskExtensions.Ua($b.TaskExtensions.Ln([A],this.$.xa),()=>{this.Yj(this.$.ka.Ug(211)||new ab(this.$,A.result,this.$.VJ,this.$.ll))},this.xa,3)}static Aa(A){A.ka.ph(212,new Gg(A))}}Object(K.a)(Gg,"AriaLiveNotifierFactory",hb.a,[]);var ah=a(592),Qg=a(1249),Uh=a(1392);class vh extends Uh.a{constructor(){super();this.wid=this.nDb=null;this.state=0;this.yad=this.TKe=!1}get MY(){return this.nDb}get fBa(){return this.wid}get Acj(){return this.TKe}cIf(){return"GetMoreInfo Result"}}
Object(K.a)(vh,"GetMoreInfoResult",Uh.a,[900,310]);var X=a(1108),jb=a(123);class Pb{constructor(A,ja,Ua){this.nhc=this.iq=null;this.wgd=0;this.Foh=A;this.$j=ja;this.WGe=Ua}sCh(){this.wgd=this.Qtb+1}Cie(A){this.iq&&(this.$j.wx(this.iq),this.iq=null);A&&(this.wgd=0)}gRk(A){const ja=this.CWk;0<=ja?(this.sCh(),this.Cie(!1),this.iq=new jb.a(4,1,ja,A,107),this.$j.Ol(this.iq)):(this.Cie(!0),F.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.WGe}))}get Qtb(){return this.wgd}get CWk(){return this.Qtb>=
this.jKg.length?-1:this.jKg[this.Qtb]}get jKg(){if(!this.nhc){const A=(this.Foh.value||"0").split(",");this.nhc=[];for(let ja=0;ja<A.length;ja++){const Ua=parseInt(A[ja]);isNaN(Ua)?F.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.WGe,["Entry"]:A[ja]}):Array.add(this.nhc,Ua)}}return this.nhc}}Object(K.a)(Pb,"RetryHelper",null,[]);class ed extends Qg.a{constructor(A,ja){super();this.nda=A;this.QDb=new Pb(ja,this.HYb.ALc,"GetMoreInfo");this.Hz=
new vh}dBj(){this.h2d("Document opened")}z3h(A){return()=>{this.h2d(A,!0)}}amg(A,ja){ja=void 0===ja?null:ja;F.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:A});3===this.Hz.state?(ja&&this.fpf(ja,this.Hz),F.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:A})):this.h2d(A);return this.Hz}h2d(A,ja){this.QDb.Cie(!(void 0===ja?0:ja));1===this.Hz.state?F.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",
{["Trigger"]:A,["RetryIndex"]:this.QDb.Qtb}):(F.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:A,["RetryIndex"]:this.QDb.Qtb}),this.Hz.state=1,ja=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.HYb.Y0,mb.AFrameworkApplication.qo),this.HYb.Jpb.Tda(ja,1,null,null,[ed.BRe,ed.KVe],!1,5,this.E2h(),this.D2h(A),null))}E2h(){return A=>{var ja=!1;let Ua=!1;var ac=!1,Ec;if(mb.AFrameworkApplication.fa.la("GetMoreInfoDataFromResponseBody"))if(A.data.responseData){let gd=oh.d(A.data.responseData);
({hz:Ec}=gd);gd.returnValue?Ec?(ac=!0,this.Hz.wid=Ec.StorageServiceDisplayName,this.Hz.nDb=ed.Q0f(Ec.PersonalFileStorageUrl)?Ec.PersonalFileStorageUrl:"",""===this.Hz.MY&&"SharePointOnlineConsumer"===mb.AFrameworkApplication.fa.Xa("FileSource")&&(this.Hz.nDb=ff.a.Dba(mb.AFrameworkApplication.breadcrumbFolderUrl)),ja=""===this.Hz.MY&&""!==this.Hz.fBa):F.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):
F.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers")}else F.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers");ac||((Ec=A.data.responseHeaders)?(this.Hz.wid=(Ec[ed.KVe]||"").toString(),ja=(Ec[ed.BRe]||"").toString(),this.Hz.nDb=ed.Q0f(ja)?ja:"",""===this.Hz.MY&&"SharePointOnlineConsumer"===mb.AFrameworkApplication.fa.Xa("FileSource")?
(this.Hz.nDb=ff.a.Dba(mb.AFrameworkApplication.breadcrumbFolderUrl),ja=""===this.Hz.MY&&""!==this.Hz.fBa):ja=""===ja&&""!==this.Hz.fBa):(F.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),Ua=!0));ac=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",this.QDb.Qtb,Ua,ja,ac);this.HYb.noa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",A.data,ac);this.xKg(3,ja,Ua)}}D2h(A){return ja=>{this.HYb.noa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",
ja.data,"Failure");this.xKg(2);this.QDb.gRk(this.z3h(A))}}xKg(A,ja,Ua){this.Hz.state=A;this.Hz.TKe=void 0===ja?!1:ja;this.Hz.yad=void 0===Ua?!1:Ua;this.jBd(this.Hz)}get HYb(){return this.nda.value}static get instance(){return ed.Wa||(ed.Wa=ed.HX())}static HX(){return new ed(new ah.a(()=>X.a.instance),new ah.a(()=>mb.AFrameworkApplication.eOi))}static Q0f(A){if(!A)return F.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(xa.a.Rr(A).startsWith("https://"))return!0;
F.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}ed.BRe="PersonalFileStorageUrl";ed.KVe="StorageServiceDisplayName";ed.Wa=null;Object(K.a)(ed,"GetMoreInfoActor",Qg.a,[]);class zd{constructor(A,ja,Ua,ac,Ec){this.kjh=6E4;this.PQf="inactive";this.DYe="active";this.R2=!0;this.$j=A;this.lih=ja;this.U9c=Ua;this.sic=ac;this.Rg=new L.a;Ec&&this.WQk();this.aNe=this.vFf()}uZe(A){this.Rg.addHandler(this.DYe,A)}hvh(A){this.Rg.addHandler(this.PQf,A)}WQk(){const A=new jb.a(5,2,this.kjh,
Object(Sf.a)(this,this.I7i,"inactiveLoop"),108);this.J7i.Ol(A)}I7i(){const A=this.vFf(),ja=this.wF()-A;ja>this.u_c&&this.R2&&(F.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:ja}),this.R2=!1,this.Rg.raiseEvent(this.PQf));A-this.aNe>this.u_c&&(this.R2=!0,this.Rg.raiseEvent(this.DYe));this.aNe=A}get J7i(){return this.$j.value}get vFf(){return this.lih}get wF(){return this.U9c}get u_c(){return this.sic.value}static get instance(){return zd.Wa||(zd.Wa=zd.HX())}static HX(){return new zd(new ah.a(()=>
db.TaskManager.instance),()=>mb.AFrameworkApplication.E1a.getTime(),()=>(new Date).getTime(),new ah.a(()=>mb.AFrameworkApplication.u_c),!0)}}zd.Wa=null;Object(K.a)(zd,"InactivityManager",null,[]);var be=a(1368);class we{constructor(){this.UEb=this.CSe=this.Mh=null;this.Mu=!1;this.p$h=()=>{db.TaskManager.instance.wx(this.kag)};this.XZe=()=>{db.TaskManager.instance.Ol(this.kag)}}get name(){return"Common.App.NewAndOpen.Core"}ao(A){this.Mh=A;A.register(308,"Common.INewAndOpenCommonHelpers").hi().mi(()=>
X.a.instance);A.register(311,"Common.IEventEmitter<Common.IGetMoreInfoResult>").hi().mi(()=>ed.instance);A.register(311,"Common.IEventEmitter<Common.IMruResult>").hi().mi(()=>be.a.instance)}init(){mb.AFrameworkApplication.fa.ty(()=>{this.GSb()})}GSb(){me.a.instance.resolve("Common.INewAndOpenCommonHelpers");me.a.instance.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");me.a.instance.resolve("Common.IEventEmitter<Common.IMruResult>");var A=!1;X.a.instance.Wdk();mb.AFrameworkApplication.qY&&
(A=!0);mb.AFrameworkApplication.Hxg&&(be.a.instance.fBj(),0<mb.AFrameworkApplication.jag&&this.XZe(),this.bFk(),A=!0);mb.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&A&&ed.instance.dBj();mb.AFrameworkApplication.v5k&&(A=be.a.instance,A.Tfk(),A.oBj(),db.TaskManager.instance.Ol(this.w5k))}bFk(){zd.instance.uZe(Object(Sf.a)(be.a.instance,be.a.instance.eBj,"makeGetMruRequestActivityTrigger"));zd.instance.uZe(this.XZe);zd.instance.hvh(this.p$h)}get kag(){return this.CSe||(this.CSe=new jb.a(5,
2,mb.AFrameworkApplication.jag,Object(Sf.a)(be.a.instance,be.a.instance.oOi,"getMruFromServerTask"),109))}get w5k(){return this.UEb||(this.UEb=new jb.a(2,2,6E4*mb.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(Sf.a)(be.a.instance,be.a.instance.pBj,"makeUpdateMruTask"),197))}dispose(){this.Mu||(this.Mu=!0,this.UEb&&(db.TaskManager.instance.wx(this.UEb),this.UEb=null))}}Object(K.a)(we,"CorePackageManager",null,[12,13,2]);var ef=a(950);
class vf{constructor(A,ja){this.Chd=this.Bhd=null;this.Hbb=new Ob.a;this.U_b=Ua=>{let ac=null;ac&&ac.length||!Ua||!Ua.data||(ac=Ua.data.responseData);if(ac&&ac.length)try{const Ec=oh.a(ac);this.Bhd=Ec.NavBarDataJson;F.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");this.Bhd?(()=>{let gd=oh.d(Ec.NavBarDataJson);({hz:this.Chd}=gd);return gd})().returnValue?(this.gyj(this.Chd),this.Hbb.setResult(this.Chd)):(F.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",
{["ShellData"]:ef.a.n8a(this.Bhd)}),this.Hbb.xC()):(F.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.Hbb.xC())}catch(Ec){F.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.Hbb.xC()}else F.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")};this.c_b=()=>{this.Hbb.xC();F.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")};this.vn=A;this.tka=ja.appSettings[vf.Gal]||""}get tGk(){return this.Hbb.task}get ola(){return this.vn.value}iok(){const A=
{};A[vf.y3i]=mb.AFrameworkApplication.qo;A["Content-Type"]="application/json; charset=utf-8";F.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const ja=ff.a.mr(this.tka+vf.uGk,vf.dJj,mb.AFrameworkApplication.ra.$d.Om.toString());this.ola.Ou(ja,1,"",A,!0,2,this.U_b,this.c_b,null,void 0,void 0,void 0,void 0,"20")}gyj(A){try{const ja={};ja.FlightName=A.FlightName;ja.SessionID=A.SessionID;F.ULS.sendTraceTag(594883776,215,50,oh.c(ja))}catch(ja){F.ULS.sendTraceTag(594883747,
215,10,"Unable to log NavBarData")}}static get instance(){return vf.Wa||(vf.Wa=vf.bwa())}static bwa(){return new vf(new ah.a(()=>mb.AFrameworkApplication.$i),mb.AFrameworkApplication.fa,mb.AFrameworkApplication.ra.$d.Om)}}vf.y3i="X-qs";vf.dJj="at";vf.uGk="O365ShellServiceProxy.ashx";vf.Wa=null;vf.Gal="ShellWebServiceBase";Object(K.a)(vf,"O365ShellActor",null,[894]);class Jf{constructor(){this.Mh=null;this.CK=()=>{mb.AFrameworkApplication.useO365ShellService&&mb.AFrameworkApplication.ra.$d.jw&&me.a.instance.resolve("Common.App.O365Shell.O365ShellActor").iok()}}get name(){return"Common.App.O365Shell"}ao(A){this.Mh=
A;this.Mh.register(vf,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").hi().mi(()=>new vf(new ah.a(()=>mb.AFrameworkApplication.$i),mb.AFrameworkApplication.fa,mb.AFrameworkApplication.ra.$d.Om))}init(){mb.AFrameworkApplication.fa.ty(this.CK)}dispose(){}static main(){fe.a.instance.Lo(new Jf)}}Object(K.a)(Jf,"PackageManager",null,[12,13]);class yg extends hb.a{constructor(A,ja){super();this.activityName=A;this.ZT=ja;this.Bl()}create(){this.Yj(new S(this.activityName,
this.ZT,Qd.a.FG,Qd.a.yp,Qd.a.gxb))}static Aa(A){A.ka.ph(143,new yg(Qd.a.bqa,Qd.a.Ydb));A.ka.ph(144,new yg(Qd.a.l5b,Qd.a.GMa));A.ka.ph(145,new yg(Qd.a.m5b,Qd.a.JOc));A.ka.ph(154,new yg(Qd.a.uOa,Qd.a.dW))}}Object(K.a)(yg,"SessionReloadSilentActivityFactory",hb.a,[]);var Pg=a(281),Wg=a(143),ch=a(1123);class yh{constructor(A){this.C7f=A}get name(){return"CopilotBootVisibilityCheck"}ao(){}init(){const A=ja=>{const Ua=this;return No(function*(){var ac=Date.now();const Ec=yield ja.isFeatureEnabled("Copilot",
!1);ac=Date.now()-ac;F.ULS.sendTraceTag(507839317,3050,50,"[Copilot Chat] Early call to Copilot license check latency: "+ac);mb.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowEarlyAFHCHeck",!1)&&Object(ch.b)(Ua.C7f,Ec);Wg.a.get_instance().Fm(10,()=>{pe.c()&&(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(Ua.C7f,!Ec)),F.ULS.sendTraceTag(507839316,306,50,"Copilot Chat visibility marked early"))})})};mb.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowEarlyAFHCHeck",
!1)?mb.AFrameworkApplication.fa.ty(()=>A(T())):Object(Pg.a)().execute(A)}dispose(){}}Object(K.a)(yh,"CopilotBootVisibilityCheck",null,[12,13]);(()=>{var A;null!==(A=mb.AFrameworkApplication.fa)&&void 0!==A&&A.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DemandLoadApplicationFeatureHelper",!1)||(Type.registerNamespace("Common"),Type.registerNamespace("Common.App.ApplicationFeatureHelper"),Ga.main())})();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");
(()=>{$g.a.Qg(A=>{Di.Aa(A)})})();vj.a.gw(".insert-media-dialog-old{width:870px;float:left;margin-top:7px}.insert-media-dialog{width:870px;width:clamp(400px,870px,80vw);float:left;margin-top:7px}.app-rtl .insert-media-dialog{float:right}.insert-media-frame{width:100%;height:100%;visibility:visible}.insert-media-panel-old{height:550px}.insert-media-panel{height:550px;height:clamp(300px,550px,90vh)}.keep-focus-start{position:absolute;width:-1000px;top:-1000px}.keep-focus{position:absolute;width:-1000px;top:1000px}.display-none{display:none}.padding-zero{padding:0}");
Type.registerNamespace("Common.App.GestureManager");Ph.main();Type.registerNamespace("Common.App.AccessibilitySettings");zf.main();Type.registerNamespace("Common.App.RibbonSettings");ug.main();(()=>{$g.a.Qg(A=>{ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)||Gg.Aa(A)})})();vj.a.gw(".ewr-selection-draghandle,.ewr-selection-draghandle-grab{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-grab{cursor:grab}.ewr-selection-draghandle-top{top:-2px;left:-2px;right:-2px;height:calc(1px + 4px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-top-enhanced{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1));border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom{right:0;left:-2px;bottom:calc(-1px - 2px/var(--zoom-level-canvas,1));height:calc(1px + 2px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-enhanced{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1));border-top:1.25px solid transparent}.ewr-selection-draghandle-left{top:0;left:calc(-1px - 1px/var(--zoom-level-canvas,1));bottom:0;width:calc(1px + 5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-enhanced{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1));border-left:1.5px solid transparent}.ewr-selection-draghandle-right{top:0;right:-2px;bottom:0;width:calc(1px + 5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-enhanced{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1));border-right:1.5px solid transparent}.ewr-selection-draghandle-top-updated{border-top:1px solid transparent;top:-2px;left:-2px;right:-2px;height:calc(3.5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-updated{border-top:.75px solid transparent;right:0;left:-2px;bottom:-2px;height:calc(2.5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-updated{border-left:1.25px solid transparent;top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-updated{border-right:1.25px solid transparent;top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:fit-content;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr-selection-drag-tooltip-fluent{position:absolute;background-color:#fff;box-shadow:0 0 2px 0 #0000001f,0 4px 8px 0 #00000024;outline:1px solid transparent;border-radius:4px;height:fit-content;width:max-content;font-size:10px;padding:4px 8px 6px 8px}.ewr-selection-draghandle-reduced .ewr-selection-draghandle-top-enhanced{height:calc(3px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-reduced .ewr-selection-draghandle-bottom-enhanced{height:calc(3px/var(--zoom-level-canvas,1))}.ewa-root-ltr .ewr-selection-draghandle-reduced .ewr-selection-draghandle-right-enhanced,.ewa-root-ltr .ewr-selection-draghandle-reduced .ewr-selection-draghandle-right{width:calc(3px/var(--zoom-level-canvas,1))}.ewa-root-rtl .ewr-selection-draghandle-reduced .ewr-selection-draghandle-left-enhanced,.ewa-root-rtl .ewr-selection-draghandle-reduced .ewr-selection-draghandle-left{width:calc(3px/var(--zoom-level-canvas,1))}.ewr_selection_rearrangeleft{border-left:3px solid #107c41;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #107c41;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #107c41;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #107c41;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr_selection_rearrange-flange-left,.ewr_selection_rearrange-fullrowcol-flange-left{border-left:3px solid #107c41;border-radius:1.5px;position:absolute;height:10px;width:0;left:-2px;top:-3.5px}.ewr_selection_rearrange-flange-right,.ewr_selection_rearrange-fullrowcol-flange-right{border-right:3px solid #107c41;border-radius:1.5px;position:absolute;height:10px;width:0;right:-5px;top:-3.5px}.ewr_selection_rearrange-flange-top,.ewr_selection_rearrange-fullrowcol-flange-top{border-top:3px solid #107c41;border-radius:1.5px;position:absolute;width:10px;height:0;top:-2px;left:-3.5px}.ewr_selection_rearrange-flange-bottom,.ewr_selection_rearrange-fullrowcol-flange-bottom{border-bottom:3px solid #107c41;border-radius:1.5px;position:absolute;width:10px;height:0;bottom:-5px;left:-3.5px}.ewr_selection_rearrange-fullrowcol-flange-left{left:0}.ewr_selection_rearrange-fullrowcol-flange-right{right:-3px}.ewr_selection_rearrange-fullrowcol-flange-top{top:0}.ewr_selection_rearrange-fullrowcol-flange-bottom{bottom:-3px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-drag-shadow{position:absolute;top:0;background-color:#107c41;opacity:15%;z-index:52;pointer-events:none;border-radius:2px}.ewa-grid-ltr .ewr-selection-drag-shadow{left:0}.ewa-grid-rtl .ewr-selection-drag-shadow{right:0}@media(forced-colors:active){.ewr-selection-drag-shadow{forced-color-adjust:none;background-color:#fff;opacity:20%}}@media(forced-colors:active) and (prefers-color-scheme:light){.ewr-selection-drag-shadow{background-color:#000}}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#107c41;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}");
Type.registerNamespace("Common.App.NewAndOpen.Core");fe.a.instance.Lo(new we);Type.registerNamespace("Common.App.O365Shell");Jf.main();ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveRequireFromSlices",!1)||a(1281);fe.a.instance.Lo(new yh("Copilot"));(()=>{$g.a.Qg(A=>{Ha.tf.Ha()||yg.Aa(A)})})();String(e);String(w);String(l);String(u);String(m);String(n);String(v);String(B);String(z);String(C);String(D);String(J);String(W);String(N);String(M);String(Q);String(R);String(O);window.___1708742503452_closurehack=
e;window.___1708742503452_closurehack=w;window.___1708742503452_closurehack=l;window.___1708742503452_closurehack=u;window.___1708742503452_closurehack=m;window.___1708742503452_closurehack=n;window.___1708742503452_closurehack=v;window.___1708742503452_closurehack=B;window.___1708742503452_closurehack=z;window.___1708742503452_closurehack=C;window.___1708742503452_closurehack=D;window.___1708742503452_closurehack=J;window.___1708742503452_closurehack=W;window.___1708742503452_closurehack=N;window.___1708742503452_closurehack=
M;window.___1708742503452_closurehack=Q;window.___1708742503452_closurehack=R;window.___1708742503452_closurehack=O}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.frs.js.map/c7e0cf266afc054687e806ae5cb2b452/EwaTS.frs.js.map