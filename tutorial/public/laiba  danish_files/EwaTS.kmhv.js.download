'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1251:function(y,x,a){a.d(x,"a",function(){return f});y=a(0);x=a(243);var c=a(16),b=a(13);class f extends x.a{constructor(r,d,k,t){super(r,k,2,void 0===t?null:t);this.O$c=null;this.RF=()=>{const m=this.yLi();this.UZa.setAttribute("width",m.x.toString());this.UZa.setAttribute("height",m.y.toString());this.P3k(m);this.Qig()};this.Dkf=d;this.$.hI(this.RF);this.ePd()}get UZa(){return this.O$c}initialize(){const r=
this.$.$h+"iframeDialog_frame",d=this.$.$h+"iframeDialog";this.dj.style.margin=b.HelperMethods.ti(0);this.dj.style.marginBottom=b.HelperMethods.ti(-2);const k=document.createElement("iframe");k.id=r;k.frameBorder="0";k.scrolling="auto";k.src=this.lEf(d);this.dj.appendChild(k);this.O$c=document.getElementById(r);this.domElement.id=d;this.RF(null,Sys.EventArgs.Empty);super.initialize()}dispose(){this.$&&this.$.LK(this.RF);super.dispose()}setFocus(){c.DOMElementExtensions.setFocus(this.UZa)}onHide(){this.UZa.contentWindow.close();
c.DOMElementExtensions.Km(this.UZa);this.O$c=null;super.onHide()}P3k(r){const d=this.domElement.style;d.width=b.HelperMethods.ti(r.x);d.marginLeft=b.HelperMethods.ti(-r.x/2)}yLi(){const r=c.DOMElementExtensions.getBounds(document.body);return new Sys.UI.Point(Math.min(Math.floor(.9*r.width),this.Dkf.x),Math.min(Math.floor(.9*r.height),this.Dkf.y))}}Object(y.a)(f,"IFrameDialog",x.a,[])},1252:function(y,x,a){a.d(x,"a",function(){return d});y=a(0);x=a(963);var c=a(146),b=a(19),f=a(59),r=a(12);class d extends x.a{constructor(k,
t,m,e,w,l,u){l=void 0===l?0:l;super(k,r.a.instance.ia(t),!1);this.ji=null;this.message=m;this.Q5d=e;this.ize=w;this.operationFlags=l;this.ji=u}get ki(){return"WebMethodConfirmationDialog"}get oJ(){return 1005}get Ifb(){return this.operationFlags}initialize(){let k="<div class='"+c.e+"'>\r\n\t<div class='"+c.v+"'>\r\n\t\t<div class='"+b.a.rcf+"'>\r\n\t\t\t<img src='{0}' class='"+b.a.ztf+"' alt='{1}' />\r\n\t\t</div>\r\n\t</div>\r\n\t<div class='"+c.A+"'>\r\n\t\t<p>{2}</p>\r\n\t</div>\r\n</div>";k=
String.format(k,f.a.$m(13),r.a.instance.ia(25),r.a.instance.ia(this.message));this.ji.hr(this.dj,k);this.addButton(0,this.Q5d);this.addButton(1);super.initialize()}UN(){return this.ize}}Object(y.a)(d,"WebMethodConfirmationDialog",x.a,[])},1253:function(y,x,a){a.d(x,"b",function(){return b});a.d(x,"c",function(){return f});a.d(x,"a",function(){return r});var c=a(62);const b=(d,k,t,m,e,w)=>{w=d.Za(1,w);return c.h(d,"ShareForm",w,k,t,m,e,0)},f=(d,k,t,m,e,w)=>{w=d.Za(1,w);return c.h(d,"UnshareForm",w,
k,t,m,e,0)},r=(d,k,t,m,e,w)=>{w=d.Za(9,w);w.surveyId=null;return c.h(d,"DeleteSurvey",w,k,t,m,e,0)}},1436:function(y,x,a){a.r(x);(function(c){a.d(x,"SocialSharingCommandHandler",function(){return mb});var b=a(179),f=a(0),r=a(14),d=a(6),k=a(478),t=a(159),m=a(188),e=a(34),w=a(259),l=a(229),u=a(253),n=a(95),v=a(77),B=a(63),z=a(40),C=a(238),D=a(689),J=a(86),W=a(35),N=a(1),M=a(13),Q=a(209),R=a(27),O=a(24),U=a(47),K=a(282),F=a(1438),I=a(1495),P=a(1440),Y=a(1439),ea=a(1253),Ba=a(1252),Fa=a(275),za=a(8),
xa=a(92),fa=a(287),V=a(75),ba=a(737),la=a(166),Ta=a(605),Ea=a(103),sa=a(289),Ya=a(28),bb=a(18),ra=a(1437),Da=a(93),oa=a(97),Ha=a(5),ka=a(162),wa=a(7),Za=a(213),ab;const db=N.EwaSettings.isChangeGateEnabled("OfficeVSO:8560736_shouldEnableBase64EncodingForContextualLocation");let mb=ab=class extends l.a{constructor(Ia,pa,lb){super();this.V9e=this.W9e=!1;this.jib=0;this.Cva=!1;this.aLj=()=>{this.W9e=!0;this.TQg()};this.$=Ia;this.Ya=pa;this.PU=lb;V.a(this.$).wee(new la.a(za.a.s1g,za.a.idle,ab.wRh),new Fa.a(za.a.Ccf,
za.a.Vaa,null,za.a.dW,za.a.idle))}get e3c(){return n.b(this.$.Bk)}get $je(){return this.$.isEditMode&&(this.$.ea.ffi||this.$.z0)}Bi(Ia,pa){switch(pa){case 353606613:case -1099009678:case 192430811:return!N.EwaSettings.isChangeGateEnabled("OfficeVSO:8096934_ShareExcelSection")||this.Moe();case 783415632:return!N.EwaSettings.isChangeGateEnabled("OfficeVSO:8096933_ShareExcelSheet")||this.Moe();case 709515373:return!N.EwaSettings.isChangeGateEnabled("OfficeVSO:8575759_CopyLinkContextMenu")||this.Moe();
case 869186573:return this.mPg();case -1570751769:case 1986648902:return 131072!==(this.$.tX&131072);case 330035228:return!(this.Pib(!0)&&this.e3c);case -509039657:return!(this.Pib()&&this.e3c);case 1334518759:return!(this.Pib()&&this.e3c&&this.h$e())}return!1}Moe(){return this.$.ea.isNamedObjectViewMode||this.$.isMobileMode||this.mPg()}mPg(){const Ia=this.$.workbookContext.FullDocumentInfo,pa=sa.a()&&this.$.ea.sn.get(5);return!Ia.FileSharingUrl&&!pa}executeCommand(Ia,pa,lb){Ia=this.$.workbookContext.FullDocumentInfo;
const ha=Ya.a.workflow;var ua=z.TaskExtensions.sq();const fb=pa.command;if(fb===ha||-266099===fb)return this.v3i(pa,ha,Ia);switch(fb){case 1986648902:this.KNg();break;case -1570751769:this.i0i(pa);break;case 869186573:var Ka=Ya.a.qFk;ua=d.AFrameworkApplication.fa.la("ShareMenuIsEnabled");pa=null;(N.EwaSettings.Ra(478)||ua)&&lb&&"CopyLink"===lb.SourceControlId?(pa={},pa[k.a.kvb]="copy",Ka=Ya.a.Kne):ua&&lb&&"ManageAccess"===lb.SourceControlId?(pa={},pa[k.a.kvb]="manageAccess",Ka=Ya.a.sFk):lb&&"LinkToComment"===
lb.SourceControlId?(pa={},pa[k.a.kvb]="copy",pa[k.a.Lne]=lb.navId,N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareContextualInfo",!1)&&(pa[k.a.tOg]=8),Ka=Ya.a.Kne):!lb||"SaveAsCopyLink"!==lb.SourceControlId&&"ShareCopyLink"!==lb.SourceControlId&&"ShareTabCopyLink"!==lb.SourceControlId||(pa={},pa[k.a.kvb]="copy",Ka=Ya.a.Kne);ua=this.sSg(Ia,pa);Ea.c(Ka);break;case -1099009678:ua=this.b6b(12,Ia);break;case 192430811:ua=this.b6b(13,Ia);break;case 353606613:ua=this.b6b(14,Ia);break;case -1592351768:ua=
w.a.Va(!0);N.EwaSettings.isChangeGateEnabled("OfficeVSO:8501332_ShareExcelNamedSheetView")&&(lb=this.$.sa.na,(null===(Ka=null===lb||void 0===lb?void 0:lb.Kj)||void 0===Ka?0:Ka.BM)?(r.ULS.sendTraceTag(508164248,0,50,"SocialSharingCommandHandler.ExecuteCommand: Auto save named sheet view invoked, on sharing temporary named sheet view"),this.$.ei(621685370,-1,0,{[wa.a.hnf]:!0})):(lb=wa.a.D4a,ua=this.b6b(16,Ia),lb!==ka.a(this.$).ns.rA&&ka.a(this.$).ns.activateRibbonTab(lb)));break;case 783415632:lb&&
"LinkToThisSheet"===lb.SourceControlId&&r.ULS.sendTraceTag(509691100,0,50,"SocialSharingCommandHandler.ExecuteCommand: Share Sheet invoked from Collab Corner");ua=this.b6b(15,Ia);break;case -59906385:case 1197060601:this.r2i(pa,Ia);break;case 1305810481:this.mMf(!1,pa);break;case 330035228:this.mMf(!0,pa);break;case -509039657:Ia=Object(Da.d)(oa.a.resolve(Ha.kd,{va:0}));z.TaskExtensions.Ua(Ia,La=>{this.deleteForm(La.result)},this.$.xa,3);break;case 1334518759:pa.$Tb=!0;Ia=Object(Da.d)(oa.a.resolve(Ha.kd,
{va:0}));z.TaskExtensions.Ua(Ia,La=>{this.shareForm(La.result)},this.$.xa,3);break;case 710925581:B.a.Al.bXc("710925581")&&(ua=z.TaskExtensions.Ua(Object(Da.d)(this.PU(0)),La=>{La.result.sendMessage(t.a.conversation,{})},this.xa,3));break;case 327119921:this.R_i();break;default:ua=Q.a(fb)}return ua}ni(Ia,pa){Ia=!1;pa=pa.command;if(pa===Ya.a.workflow)return!0;switch(pa){case 1986648902:case -1570751769:case 869186573:case -59906385:case 1197060601:case 1305810481:case 330035228:case -509039657:case 1334518759:case -266099:case 710925581:case 327119921:Ia=
!0;break;case 353606613:case -1099009678:case 192430811:Ia=N.EwaSettings.isChangeGateEnabled("OfficeVSO:8096934_ShareExcelSection")&&!this.$.ea.isNamedObjectViewMode;break;case -1592351768:Ia=N.EwaSettings.isChangeGateEnabled("OfficeVSO:8501332_ShareExcelNamedSheetView")&&!this.$.ea.isNamedObjectViewMode;break;case 783415632:Ia=N.EwaSettings.isChangeGateEnabled("OfficeVSO:8096933_ShareExcelSheet")&&!this.$.ea.isNamedObjectViewMode;break;case 709515373:Ia=N.EwaSettings.isChangeGateEnabled("OfficeVSO:8575759_CopyLinkContextMenu")&&
!this.$.ea.isNamedObjectViewMode}return Ia}Ji(Ia,pa,lb){if("PopulateFormMenu"===pa){pa=this.e3c?this.h$e()?ab.rri:ab.sri:ab.FGj;Ia=this.Ya.Oh();for(let ha=0;ha<pa.length;ha++)Ia.buttons.push(this.Ya.Sg(pa[ha]));pa=this.Ya.Vv("Forms.Flyout");pa.vh.push(Ia);lb.MenuItems=pa.ML();return!0}return!1}v3i(Ia,pa,lb){return this.$je&&Ia.command===pa?(this.Yje(Ia,-266099),z.TaskExtensions.N$()):z.TaskExtensions.Ua(Object(Da.d)(this.PU(0)),ha=>{D.a(ha.result,t.a.workflow,null,lb.WorkflowPostMessage)||M.HelperMethods.dm(lb.WorkflowUrl,
"_blank",void 0,"SocialSharingCommandHandler.WorkflowUrl")},this.xa,3)}h$e(){return!!this.$.workbookContext.FullDocumentInfo.ShareFormCommandUrl||this.$.ea.sn.get(26)}R_i(){const Ia=m.a.create().toString();r.ULS.sendTraceTag(528581128,306,50,`Calling share to teams deeplink with ID: ${Ia}`);this.$.frame.ZYb(Object(ra.a)(Ia,this.$),!0)}i0i(Ia){this.$je?this.Yje(Ia,1986648902):this.KNg()}mMf(Ia,pa){!Ia&&this.$.ua.SurveyRedirectUrl?this.r8j():(Ia=new I.a(this.$,Ia,pa),Ia.initialize(),Ia.us())}r2i(Ia,
pa){this.$je&&1197060601===Ia.command?this.Yje(Ia,-59906385):z.TaskExtensions.Ua(Object(Da.d)(this.PU(0)),lb=>{lb=lb.result;lb&&D.a(lb,t.a.replyWithChanges,null,this.$.ea.sn.get(8))||(lb=new Sys.StringBuilder(pa.ReplyWithChangesUrl),C.a.Dr(lb,Ta.e,Ta.d),u.a.ntw(lb.toString(),this.$))},this.xa,3)}Yje(Ia,pa){const lb=V.a(this.$).ij.activityState,ha=new J.a(pa,Ia.method,Ia.mode,Ia.lk,Ia.tabName);U.a(this.$).Dy(new K.a(za.a.bD,5,()=>{lb[fa.a.Aw]=za.a.AHg;lb[ba.a.kld]=ha;this.$.ms.gI("SocialSharingSaveBeforeCommand");
this.$.ms.x_e(ha.command)}))}KNg(){const Ia=this.$.ua.DocumentHostInfo;Ia.HostEmbeddedViewUrl||this.W9e?this.TQg():this.$.Tj.get(53)&&z.TaskExtensions.Ua(Object(Da.d)(this.PU(0)),pa=>{this.u0k(pa.result)||u.a.ntw(Ia.FileEmbedCommandUrl,this.$)},this.xa,3)}u0k(Ia){return Ia.isEnabled()&&(this.V9e||(this.V9e=Ia.Ip(t.a.U9e,this.aLj)))?Ia.sendMessage(t.a.$si,null):!1}TQg(){if(e.a.Gx)u.a.ntw(this.$.ua.EmbedConfiguratorUrl,this.$);else{const Ia=new F.a(this.$);Ia.initialize();Ia.us()}}deleteForm(Ia){const pa=
this.$;Ia=new Ba.a(pa,1277,1278,1270,(lb,ha,ua)=>{const fb=pa.pa.ta.Jh();return ea.a(pa.pa.ta,lb,ha,ua,null,fb)},0,Ia);Ia.initialize();Ia.us()}shareForm(Ia){const pa=this.$.workbookContext.FullDocumentInfo;this.$.ea.sn.get(26)?(Ia=new Y.a(this.$,Ia),Ia.initialize(),Ia.us()):z.TaskExtensions.Ua(Object(Da.d)(this.PU(0)),lb=>{D.a(lb.result,t.a.shareForm,{[k.a.CTk]:this.$.workbookContext.SurveyTitle},this.$.ea.sn.get(10))||u.a.ntw(pa.ShareFormCommandUrl,this.$)},this.xa,3)}r8j(){const Ia=this.$;Ia.ua.SurveyRedirectUrl.replace(RegExp("&startupdialog=[formedit|formpreview]",
"gi"),"");const pa=new Sys.StringBuilder(Ia.ua.SurveyRedirectUrl);C.a.Dr(pa,"startupDialog","FormEdit");const lb=V.a(this.$),ha=lb.ij.activityState;ha[xa.a.Jda]=pa.toString();ha[xa.a.MW]=xa.a.f4d;this.$.ms.gI("SocialSharingEnvironmentChange");U.a(Ia).Dy(new K.a(za.a.bD,5,()=>{const ua=W.a.Yi(3,2,1322,1323,1324,554412057,"FossEnvironmentUnsupported");lb.ij.Sy([ua]);ha[fa.a.Aw]=za.a.s1g}))}Pib(Ia){return(this.$.ea.isEditMode||(void 0===Ia?!1:Ia))&&this.$.ea.sn.get(25)&&sa.a()}rUi(Ia){var pa=void 0===
pa?null:pa;var lb=O.f(this.$).ha;let ha=!1;const ua=this.$.sa.na?v.d(this.$.sa.na):null;if(!ua)return r.ULS.sendTraceTag(537151649,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find current sheet id for navType: ${P.a[Ia]}.`),null;var fb=pa;let Ka=pa=null;const La=N.EwaSettings.isChangeGateEnabled("OfficeVSO:8683552_ShareContextualInfo");switch(Ia){case 15:La&&(Ka=this.$.activeItemName,pa=5);break;case 14:fb=this.PTi(lb);La&&(Ka=this.OTi(lb),pa=6);break;case 12:fb=lb.Vua;fb=R.a.contains(fb,
"!",!0)?fb.split("!")[1]:fb;O.f(this.$).ha.qa.FI()&&(ha=!0);La&&(pa=3,Ka=fb);break;case 13:var ib=lb.qa.selectedRanges;ib[0]&&(lb=ib[0],N.EwaSettings.isChangeGateEnabled("OfficeVSO:8116498_FShareTableContainingActiveCell")&&(lb=O.f(this.$).ha.qa.activeCell),lb=O.f(this.$).Yg.sl(lb),N.EwaSettings.isChangeGateEnabled("OfficeVSO:8627979_CopyLinkToTableFix")&&!lb&&(lb=Za.a(this.$,ib[0])),lb&&(lb.activate({scenario:"namedObject"}),fb=lb.Hq,La&&(pa=4,Ka=lb.name)));break;case 16:N.EwaSettings.isChangeGateEnabled("OfficeVSO:8501332_ShareExcelNamedSheetView")&&
(fb=this.$.sa.na,fb=null===(ib=null===fb||void 0===fb?void 0:fb.Kj)||void 0===ib?void 0:ib.$Z,La&&(pa=7,Ka=fb))}if(!fb&&15!==Ia)return r.ULS.sendTraceTag(537151648,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find the selected range reference or object id for navType: ${P.a[Ia]}`),null;ib={};ib[k.a.kvb]="copy";ib[k.a.Lne]=this.DIi(Ia,fb,ua);ib[k.a.tFk]="deepLinkShare";La&&(ib[k.a.tOg]=pa,Ka?(pa=db?this.base64Encoding("'"+Ka+"'"):btoa("'"+Ka+"'"),ib[k.a.pFk]=pa):r.ULS.sendTraceTag(508036745,
0,10,"SocialSharingCommandHandler.GetSharingDetail: Unable to find contextual sharing location for navType: ${NavigationType[navigationType]}"));r.ULS.sendTraceTag(537151647,0,50,`SocialSharingCommandHandler.GetSharingDetail: Send Section_Sharing post message with navType: ${P.a[Ia]} and sectionNameOrId: ${fb} and SheetId: ${ua} and isPartialTable: ${ha}`);return ib}PTi(Ia){if(Ia.$e.isFloatingObjectSelected&&(Ia=Ia.$e.yh.floatingObject)&&0===Ia.type){const pa=Ia.id.split(".");if(1<pa.length)return pa[1];
r.ULS.sendTraceTag(537151646,0,10,`SocialSharingCommandHandler.GetSelectedFloatingObjectXluid: Invalid floating object id =  ${Ia.id}`)}return null}OTi(Ia){var pa;return(Ia=null===Ia||void 0===Ia?void 0:Ia.$e)&&Ia.isFloatingObjectSelected&&(Ia=null===(pa=Ia.yh)||void 0===pa?void 0:pa.floatingObject)&&0===Ia.type?Ia.name:null}DIi(Ia,pa,lb){let ha=Ia+"_";ha=15===Ia?ha+lb:ha+(pa+"_"+lb);db?ha=this.base64Encoding(ha):(ha=btoa(ha),ha=ha.replace(RegExp("\\+","g"),"-"),ha=ha.replace(RegExp("\\/","g"),"_"),
ha=ha.replace(RegExp("\\=+$","g"),""));1024<ha.length&&r.ULS.sendTraceTag(507785753,0,50,"SocialSharingCommandHandler.GetEncodedValue: The length of navid : ${rawNavigationId} exceeds 1024 characters.");return ha}base64Encoding(Ia){try{let pa=c.from(Ia).toString("base64");pa=pa.replace(RegExp("\\+","g"),"-");pa=pa.replace(RegExp("\\/","g"),"_");return pa=pa.replace(RegExp("\\=+$","g"),"")}catch(pa){r.ULS.sendTraceTag(507785752,0,10,"SocialSharingCommandHandler.Base64Encoding: Error while base64 encoding the content: ${content}")}return null}sSg(Ia,
pa,lb){lb=void 0===lb?!1:lb;return z.TaskExtensions.Ua(Object(Da.d)(this.PU(0)),ha=>{D.a(ha.result,t.a.sharing,pa,this.$.ea.sn.get(5))?(r.ULS.sendTraceTag(537151644,0,50,`SocialSharingCommandHandler.ShowShareDialog: Send UI_Sharing post message with mode: ${pa?pa[k.a.kvb]:""}`),lb&&N.EwaSettings.isChangeGateEnabled("OfficeVSO:8096934_ShareExcelSection")&&!this.Cva&&(this.jib=window.setInterval(()=>{this.lZk()},6E4),this.Cva=!0)):M.HelperMethods.dm(Ia.FileSharingUrl,"_blank",void 0,"SocialSharingCommandHandler.FileSharingUrl")},
this.xa,3)}b6b(Ia,pa){if(15===Ia&&!N.EwaSettings.isChangeGateEnabled("OfficeVSO:8096933_ShareExcelSheet")||15!==Ia&&!N.EwaSettings.isChangeGateEnabled("OfficeVSO:8096934_ShareExcelSection")||this.$.isMobileMode)return null;const lb=this.rUi(Ia);if(lb)return r.ULS.sendTraceTag(520737606,0,50,`SocialSharingCommandHandler.ShareExcelSection: Calling share dialog with nav id=${lb[k.a.Lne]}`),this.sSg(pa,lb,!0);r.ULS.sendTraceTag(537151643,0,10,`SocialSharingCommandHandler.ShareExcelSection: Unable to get the sharing details for navType: ${P.a[Ia]}`);
return null}lZk(){this.Cva&&window.clearInterval(this.jib);this.$.ei(638984051,0,0,null);r.ULS.sendTraceTag(512328542,0,50,"SocialSharingCommandHandler.triggerDeepLinkCreationSurvey: FPS survey got triggered.")}};mb.FGj=[103];mb.rri=[107,104,105,106];mb.sri=[104,105];mb.wRh=[new bb.a(za.a.Ccf,554412057,0,0,1325),new bb.a(za.a.idle,554412057,0,1)];mb=ab=Object(b.__decorate)([Object(oa.d)(Ha.Xf),Object(b.__param)(0,Object(Ha.Lb)()),Object(b.__param)(1,Object(Ha["if"])()),Object(b.__param)(2,Object(Ha.id)({k6:!0}))],
mb);Object(f.a)(mb,"SocialSharingCommandHandler",l.a,[39])}).call(this,a(766).Buffer)},1437:function(y,x,a){function c(m,e){const w=new f.QueryStringBuilder(b.AFrameworkApplication.fa.Xa("TeamsMeetingShareEndpoint"));w.Kp("deeplinkId",m);w.Kp("lm","deeplink");m=w.Kp;var l={};const u=new f.QueryStringBuilder(b.AFrameworkApplication.fa.Xa("TeamsAppSharingUrl"));u.Kp("auth","2");u.Kp("flight","officeunihost");u.Kp("source","deepLink_online");var n={};n.fileType=r.a.H$(e.workbookContext.FullDocumentInfo.WorkbookPath).substring(1);
n.objectUrl=t.EwaSettings.isChangeGateEnabled("OfficeVSO:8053799_EncodeUrlFixForDeeplink")?encodeURI(e.workbookContext.FullDocumentInfo.WorkbookPath):e.workbookContext.FullDocumentInfo.WorkbookPath;n.baseUrl=t.EwaSettings.isChangeGateEnabled("OfficeVSO:8053799_EncodeUrlFixForDeeplink")?encodeURI(e.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl):e.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl;{e=e.workbookContext.WorkbookFileVersionId;let v=decodeURIComponent(e);for(;e!=v;)e=v,v=decodeURIComponent(e);
0>e.indexOf("{")||0>e.indexOf("}")?(k.ULS.sendTraceTag(528250338,306,15,`Decoded fileId does not match expected format. Decoded id: ${e}`),e=""):e=e.substring(e.indexOf("{")+1,e.indexOf("}")).toLowerCase()}n.fileId=e;n=d.c(d.c(n));u.Kp("subEntityId",n.substring(1,n.length-1));l.appSharingUrl=u.toString();l.appId=b.AFrameworkApplication.fa.Xa("TeamsAppId");l.useMeetNow=!0;l=JSON.stringify(l);m.call(w,"appContext",l);return w.toString()}a.d(x,"a",function(){return c});var b=a(6),f=a(284),r=a(31),d=
a(44),k=a(14),t=a(1)},1438:function(y,x,a){a.d(x,"a",function(){return d});y=a(0);var c=a(14);x=a(1251);var b=a(7),f=a(238),r=a(12);class d extends x.a{constructor(k){super(k,new Sys.UI.Point(960,680),r.a.instance.ia(1264));this.name=b.a.epf}get ki(){return"EmbeddingDialog"}lEf(k){const t=new Sys.StringBuilder(this.$.ua.EmbedConfiguratorUrl);f.a.Dr(t,b.a.bki,k);this.$.ua.AlternateEwaBasePrefix&&f.a.Dr(t,b.a.srf,this.$.ua.AlternateEwaBasePrefix);return t.toString()}onShow(){c.ULS.sendTraceTag(537151690,
0,50,"EmbeddingDialog.OnShow: the dialog is being shown");super.onShow()}}Object(y.a)(d,"EmbeddingDialog",x.a,[])},1439:function(y,x,a){a.d(x,"a",function(){return u});y=a(0);var c=a(96),b=a(34);x=a(1206);var f=a(146),r=a(19),d=a(649),k=a(1154),t=a(16),m=a(12),e=a(326),w=a(1253),l=a(1252);class u extends x.a{constructor(n,v){super(n,m.a.instance.ia(1271));this.ji=this.y8a=this.c6a=this.$b=null;this.Bog=()=>{const B=this.$;this.TJ();const z=new l.a(B,1274,1275,1276,(C,D,J)=>{const W=B.pa.ta.Jh();return w.c(B.pa.ta,
C,D,J,null,W)},16,this.ji);z.initialize();z.us()};this.ji=v}get ki(){return"ShareFormDialog"}dispose(){this.y8a&&this.y8a.Tha(this.Bog);c.a.Ni([this.$b,this.c6a,this.y8a]);this.y8a=this.c6a=this.$b=null;super.dispose()}initialize(){let n="<div class='"+f.e+"'>\r\n\t<span>{0}</span>\r\n</div>\r\n<div class='"+f.d+"'>\r\n\t<input type='text' id='{1}' class='"+f.c+"' aria-live='polite' aria-atomic='true'/>\r\n\t<br />\r\n\t<a href='#' id='{2}' class='{3}'>{4}</a>\r\n</div>";n=String.format(n,m.a.instance.ia(1272),
"sfd_input","sfd_unshare",r.a.$C,m.a.instance.ia(1273));this.ji.hr(this.dj,n);this.$b=new e.a(this.getElementById("sfd_input"));this.c6a=new k.a(this.$b.domElement);this.y8a=d.a.create(this.getElementById("sfd_unshare"));this.y8a.s9(this.Bog);this.$b.text=m.a.instance.ia(736);this.$b.enabled=!1;this.$b.readOnly=!b.a.Un;this.addButton(1,10);super.initialize()}web(){return(n,v,B)=>{const z=this.$.pa.ta.Jh();return w.b(this.$.pa.ta,this.tjb(n),this.zYa(v),B,null,z)}}bba(n,v,B){this.$b.text=n.Result;
this.$b.enabled=!0;t.DOMElementExtensions.setVisible(this.y8a.domElement,!0);super.bba(n,v,B)}setFocus(){if(this.$b&&this.$b.enabled)try{this.$b.focus();return}catch(n){}super.setFocus()}}Object(y.a)(u,"ShareFormDialog",x.a,[])},1440:function(y,x,a){a.d(x,"a",function(){return c});y=a(0);var c;(function(b){b[b.comment=10]="comment";b[b.range=12]="range";b[b.table=13]="table";b[b.chart=14]="chart";b[b.sheet=15]="sheet";b[b.namedSheetView=16]="namedSheetView"})(c||(c={}));Object(y.b)("NavigationType",
c)},1495:function(y,x,a){a.d(x,"a",function(){return z});y=a(0);var c=a(1048),b=a(96),f=a(81),r=a(937);x=a(1251);class d{}d.uOg="FrameDialog_ShareFromEdit";d.view="FrameDialog_View";d.ycf="FrameDialog_CloseAndRefresh";d.rFk="FrameDialog_ShareFromView";d.edit="FrameDialog_Edit";d.Adk="FrameDialog_RefreshGrid";d.NUh="FrameDialog_CloseMe";d.Dcf="FrameDialog_CloseMeError";d.ready="FrameDialog_Ready";d.x3j="FrameDialog_PleaseClose";d.wU="GotoRange";Object(y.a)(d,"PostMessageConstants",null,[]);var k=a(7),
t=a(212),m=a(355),e=a(238),w=a(122),l=a(252),u=a(12),n=a(262),v=a(24);class B{constructor(){this.wU=null;this.Dae=1461300262}}Object(y.a)(B,"SessionUpdateContext",null,[]);class z extends x.a{constructor(C,D,J){super(C,new Sys.UI.Point(z.O9h,z.i9h),u.a.instance.ia(D?1269:1268));this.qgb=null;this.gbd=!1;this.zOc=W=>{const N=this.$,M=new B;M.wU=W.Values[d.wU];let Q=!1;switch(W.MessageId){case d.uOg:this.TJ();Q=!0;M.Dae=1334518759;break;case d.view:this.wPa=u.a.instance.ia(1269);this.I3g(!0);break;
case d.ycf:this.TJ(),Q=!0}W=new t.a(140,0,(R,O,U)=>m.r(N.pa.ta,n.c(R,this.CWj),O,U,M));W.flags=Q?16:80;N.userOperationManager.enqueueOperation(W,this.Ah)};this.aOj=()=>{const W=this.$;W.ua.SurveyRedirectUrl?(this.TJ(),W.ei(1305810481,0,8,null)):(this.wPa=u.a.instance.ia(1268),this.I3g(!1))};this.PWj=()=>{const W=this.$;this.TJ();W.ei(1334518759,0,8,null)};this.yMc=W=>{const N=this.$;this.TJ();W.MessageId===d.Dcf&&N.ea.aGd()};this.iVj=()=>{this.gbd=!0;this.raiseEvent(z.y_d)};this.CWj=(W,N)=>{if(!l.a(W)){W=
this.$;if(N.wU){const M=W.ea.sa;if(M.contains(N.wU.SheetName))this.kNc(N);else{let Q=null;Q=()=>{M.Yza(Q);this.kNc(N)};M.tta(Q)}}1461300262!==N.Dae&&W.ei(N.Dae,0,8,null)}};this.zW=D;this.Ah=J}lzh(C){this.addHandler(z.y_d,C)}Ljk(C){this.removeHandler(z.y_d,C)}get ki(){return"FormDialog"}get LXf(){return this.gbd}get KGc(){return this.zW}dispose(){b.a.Ng(this.qgb);this.qgb=null;super.dispose()}initialize(){super.initialize();const C=f.a.getOrigin(this.$.ua.FormLightBoxUrl),D=this.qgb=new c.a(this.UZa.contentWindow,
C);D.isEnabled()&&D.PW(C)&&(this.Sza(d.uOg,this.zOc),this.Sza(d.view,this.zOc),this.Sza(d.ycf,this.zOc),this.Sza(d.rFk,this.PWj),this.Sza(d.edit,this.aOj),this.Sza(d.Adk,this.zOc),this.Sza(d.ready,this.iVj),this.Sza(d.NUh,this.yMc),this.Sza(d.Dcf,this.yMc))}close(C){C===this.u_&&this.LXf&&this.qgb.send(new r.a(d.x3j))||super.close(C)}lEf(){return this.ohf(this.KGc)}ohf(C){const D=this.$.ua,J=new Sys.StringBuilder(D.FormLightBoxUrl);e.a.Dr(J,k.a.uxi,this.$.ea.sessionId);e.a.Dr(J,k.a.sxi,C?k.a.txi:
k.a.rxi);w.a.ZGb(J,D);return J.toString()}I3g(C){this.gbd=!1;this.UZa.src=this.ohf(C);this.zW=C}Sza(C,D){this.qgb.Tq(C);this.qgb.Ip(C,D)}kNc(C){const D=this.$.ea.sa.getItemByName(C.wU.SheetName);D&&0===D.iJ&&v.f(this.$).To(C.wU,null,null,null,20,"FormDialog.OnItemInserted")}}z.O9h=900;z.i9h=1200;z.y_d="lightBoxReady";Object(y.a)(z,"FormDialog",x.a,[415])},328:function(y,x,a){a.r(x);var c={};a.r(c);a.d(c,"CreateNewCommandHandler",function(){return D});var b={};a.r(b);a.d(b,"MsFormCommandHandler",function(){return xa});
var f={};a.r(f);a.d(f,"NamedSheetViewPublic",function(){return ka});var r={};a.r(r);a.d(r,"NamedSheetViewTeachingCallout",function(){return ua});var d={};a.r(d);var k={};a.r(k);a.d(k,"OpenFromMruCommandHandler",function(){return Rc});var t={};a.r(t);a.d(t,"SheetOptionsToggleCommandHandler",function(){return Bd});var m={};a.r(m);a.d(m,"SortFilterManager",function(){return mc});var e={};a.r(e);a.d(e,"TryOfficeThroughTellMeCommandHandler",function(){return Sa});var w=a(179),l=a(0),u=a(6),n=a(209),v=
a(28),B=a(66),z=a(5),C=a(97);let D=class{constructor(qc){this.Wp=qc}Bi(){return!1}executeCommand(qc,Lc,bd){return 2!==this.Wp.Xj(v.a.newDocument,2,bd)?B.Task.Va(!0):n.a(Lc.command)}ni(qc,Lc){return 1056925771===Lc.command}Ji(qc,Lc,bd){qc=!0;switch(Lc){case "PopulateNewMenu":this.Wp&&(u.AFrameworkApplication.fa.la("IsO365ConsumerHost")&&(u.AFrameworkApplication.fa.appSettings.TemplateCollectionId="ExcelConsumerWAC",u.AFrameworkApplication.fa.appSettings.NumberOfTemplatesInBackstage="23"),this.Wp.Xj(v.a.Srb,
2,bd));break;default:qc=!1}return qc}};D=Object(w.__decorate)([Object(C.d)(z.ib),Object(w.__param)(0,Object(z.f)()),Object(w.__param)(1,Object(z.ab)()),Object(w.__param)(2,Object(z.Vd)())],D);Object(l.a)(D,"CreateNewCommandHandler",null,[39]);var J=a(31),W=a(95),N=a(212),M=a(40),Q=a(13),R=a(27),O=a(262),U=a(524);class K{}K.create="Create";K.activate="Activate";K.close="Close";K.remove="Delete";K.duplicate="Duplicate";Object(l.a)(K,"Actions",null,[]);var F=a(35),I=a(47);class P extends B.Task{constructor(qc){super();
this.Tze=null;this.Vze=0;this.Uac=null;this._state=0;this.moveNext=()=>{try{for(this._state=1;1===this._state;)this.Oab=this.Oab()}catch(Lc){this.dispose(),this.FOa(Lc),this._state=3}};this.JC=qc;this.Oab=this.p3c;this.moveNext()}p3c(){this.Tze=F.a.Yi(3,2,0,1667,0,-1244327602,"MsFormDeleteConfirmation");this.Uac=I.a(this.JC.$).lp(this.Tze).G();this.Uac.isCompleted||(this._state=2,this.Uac.gqb(this.moveNext));return this.I7g}I7g(){this.Vze=this.Uac.kR();0===this.Vze&&(this.JC.$.workbookContext.Options=
Q.HelperMethods.jZ(!1,this.JC.$.workbookContext.Options,2048),this.JC.deleteMsFormMetaDataSheet());this._state=3;this.p6a(!0)}dispose(){}}Object(l.a)(P,"$$sm_Microsoft$Office$Excel$WebUI$Client$MsForm$MsFormCommandHandler$DeleteMsForm",B.Task,[2]);class Y{}Y.action="Action";Y.Kvi="FlexPane";Y.Vwc="formId";Y.id="id";Y.title="Title";Y.R$b="XlWorkbookId";Y.Rxi="Fragment";Y.host="Host";Y.ZYg="TopView";Y.accountType="auth_pvr";Y.wse="subpage";Object(l.a)(Y,"Parameters",null,[]);var ea=a(62);const Ba=(qc,
Lc,bd,jd,Yd,te,oe)=>{oe=qc.Za(9,void 0===oe?null:oe);oe.sheetName=Lc;oe.confirmationChoice=!0;return ea.h(qc,"DeleteSheet",oe,bd,jd,Yd,te,0)};var Fa=a(1),za=a(765);let xa=class{constructor(qc){this.Rt="Excel";this.$=qc;this.X4=U.a.current;this.W9b=Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8570812_UseFormsDesignPageV2")}get hasMsForm(){return W.c(this.$.Bk)||this.W9b&&this.$.workbookContext.HasMsFormsExcelDataSync}get A2a(){return this.$.workbookContext.MsFormId}get M$b(){return this.$.workbookContext.MsFormDocUrl}get accountType(){return R.a.contains(this.$.lI.DocumentHostInfo.FileSource,
"onedrive",!0)?"MSA":"OrgId"}Bi(qc,Lc){switch(Lc){case -105284469:return!W.j(this.$.Bk)||this.hasMsForm||Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8155542_MsFormsRibbonAndDisconnectionSupport")&&this.$.workbookContext.HasMsFormsExcelDataSync;case -1219864912:case 1674421386:case -1128532220:case 2023601781:return!this.hasMsForm}return!1}executeCommand(qc,Lc){qc=M.TaskExtensions.sq();Lc=Lc.command;switch(Lc){case -105284469:this.insertMsForm();break;case -1219864912:this.previewMsForm();break;
case -1128532220:this.editMsForm();break;case 1674421386:this.sendMsForm();break;case 2023601781:qc=this.deleteMsForm();break;default:qc=n.a(Lc)}return qc}ni(qc,Lc){if(!this.$.ea.sn.get(61))return!1;qc=!1;switch(Lc.command){case -105284469:qc=W.j(this.$.Bk)&&!this.hasMsForm;break;case -1219864912:case 1674421386:case -1128532220:case 2023601781:qc=this.hasMsForm}return qc}Ji(){return!1}insertMsForm(){const qc=J.a.kz(this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),Lc={},bd={};Lc[Y.action]=
K.create;Lc[Y.accountType]=this.accountType;bd[Y.action]=K.create;bd[Y.R$b]=encodeURIComponent(this.M$b);bd[Y.host]=this.Rt;bd[Y.title]=encodeURIComponent(qc);this.iYb(Lc,bd);this.$.workbookContext.Options=Q.HelperMethods.jZ(!1,this.$.workbookContext.Options,2048)}editMsForm(){const qc={},Lc={};this.W9b&&this.$.workbookContext.HasMsFormsExcelDataSync?(Lc[Y.host]=this.Rt,Lc[Y.wse]="design",Lc[Y.id]=this.A2a,Lc[Y.accountType]=this.accountType):(qc[Y.accountType]=this.accountType,Lc[Y.Vwc]=this.A2a,
Lc[Y.R$b]=encodeURIComponent(this.M$b),Lc[Y.host]=this.Rt);this.iYb(qc,Lc)}previewMsForm(){const qc={},Lc={};this.W9b&&this.$.workbookContext.HasMsFormsExcelDataSync?(Lc[Y.host]=this.Rt,Lc[Y.wse]="design",Lc[Y.id]=this.A2a,Lc[Y.accountType]=this.accountType):(qc[Y.accountType]=this.accountType,Lc[Y.Vwc]=this.A2a,Lc[Y.R$b]=encodeURIComponent(this.M$b),Lc[Y.host]=this.Rt);Lc[Y.ZYg]="Preview";this.iYb(qc,Lc)}sendMsForm(){const qc={},Lc={};this.W9b&&this.$.workbookContext.HasMsFormsExcelDataSync?(Lc[Y.host]=
this.Rt,Lc[Y.wse]="design",Lc[Y.id]=this.A2a,Lc[Y.accountType]=this.accountType,Lc[Y.ZYg]="Send"):(qc[Y.accountType]=this.accountType,Lc[Y.Vwc]=this.A2a,Lc[Y.Kvi]="SendForm",Lc[Y.R$b]=encodeURIComponent(this.M$b),Lc[Y.host]=this.Rt);this.iYb(qc,Lc)}deleteMsForm(){return new P(this)}deleteMsFormMetaDataSheet(){this.$.userOperationManager.vO(new N.a(158,0,(qc,Lc,bd)=>Ba(this.$.pa.Z0,this.X4.EOb,O.c(qc,()=>{this.t$h()}),Lc,bd,null)))}t$h(){const qc={},Lc={};qc[Y.action]=K.remove;qc[Y.accountType]=this.accountType;
Lc[Y.action]=K.remove;Lc[Y.host]=this.Rt;Lc[Y.Vwc]=encodeURIComponent(this.A2a);Lc[Y.R$b]=encodeURIComponent(this.M$b);this.iYb(qc,Lc)}iYb(qc,Lc){var bd=void 0===bd?!0:bd;if(this.W9b&&this.$.workbookContext.HasMsFormsExcelDataSync){bd=this.$.ua.MsFormBaseUrl+"/Pages/DesignPageV2.aspx";var jd="";if(Lc)for(var Yd in Lc){qc=Yd;var te=Lc[Yd];jd+=jd.length?"&":"?";jd+=qc+"="+te}window.open(bd+jd,"_blank")}else{Yd=this.$.ua.MsFormBaseUrl+"/Pages/"+(bd?"DesignPage":"ResponsePage")+".aspx";let Ee=bd="";if(Lc){for(jd in Lc){var oe=
jd,Kd=Lc[jd];Ee+=Ee.length?"&":"";Ee+=oe+"="+Kd}qc||(qc={});qc[Y.Rxi]=encodeURIComponent(Ee)}if(qc)for(te in qc)Lc=te,jd=qc[te],bd+=bd.length?"&":"?",bd+=Lc+"="+jd;window.open(Yd+bd,"_blank")}}};xa=Object(w.__decorate)([Object(C.d)(z.Ld),Object(w.__param)(0,Object(z.Lb)()),Object(w.__param)(1,Object(za.d)())],xa);Object(l.a)(xa,"MsFormCommandHandler",null,[39]);var fa=a(182),V=a(422),ba=a(236),la=a(175);class Ta{static g5(){return ba.a.UA(Ta.$v,la.a.Ba(444))}}Ta.$v="<div class='namedsheetview_teaching_dialog_control' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_description_label' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_textarea' id='TextArea'> <label id='TeachingDescriptionId' class='WACDialogLabel' >{0}</label> </div> </div> </div>";
Object(l.a)(Ta,"NamedSheetViewTeachingDialogHtml",null,[]);var Ea=a(69),sa=a(197),Ya=a(86),bb=a(12),ra=a(61),Da=a(7);class oa extends V.a{constructor(qc){super(qc);this.stopwatch=this.bC=null;this.NFj=Lc=>{if(1===Lc){var bd={[Da.a.Z3d]:!1};this.$.Ma.dh(new Ya.a(-2050946363,Ea.a.eh,2,8,null),bd).continueWith(jd=>{this.bC.setResult(!sa.a(jd)&&jd.result)});Lc="Yes"}else bd=2===Lc,this.bC.setResult(bd),Lc=2===Lc?"No":"Close",bd&&this.J6j();this.fyj(Lc);this.hide()}}get ki(){return"ShowNamedSheetViewTeachingDialog"}Im(){this.Bh=
4;this.stopwatch=this.$.qh.vi("UserAction",this.ki);const qc=bb.a.instance.ia(1913);this.Po=Ta.g5();this.bC=new fa.a;this.initializeAndShow(qc,this.NFj,{});return this.bC.task}VK(qc){super.VK(qc);this.Yh(1,bb.a.instance.ia(1915));this.Yh(2,bb.a.instance.Ba(457))}J6j(){this.$.ea.$3d=!1}fyj(qc){const Lc={};Lc.a=this.$.ua.UserSessionId;Lc.b="NamedSheetViewTeachingDialogClose";Lc.c=qc;Lc.e=!0;this.stopwatch&&(this.stopwatch.stop(),Lc.d=this.stopwatch.ii);ra.b().tl(53,Lc,!0)}}Object(l.a)(oa,"NamedSheetViewTeachingDialog",
V.a,[]);var Ha=a(149);let ka=class{constructor(qc){this.$=qc;this.kVd=Fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DisableSortFilterNSVEntryInSelfCoauthor",!1)}W6a(){return this.gJk()?(new oa(this.$)).Im():B.Task.Va(!0)}gJk(){const qc=this.$.sa.na;return this.$.ea.Xaa&&this.$.ea.$3d&&!qc.Kj.Ow&&(this.kVd?this.$.ea.OSd()||!this.$.ea.e_&&this.$.ea.H0f():this.$.ea.eU)&&!Object(Ha.e)(this.$)&&!this.$.ea.th.allowViewCollab}};ka=Object(w.__decorate)([Object(C.d)(z.Qd),Object(w.__param)(0,
Object(z.Lb)())],ka);Object(l.a)(ka,"NamedSheetViewPublic",null,[246]);var wa=a(2),Za=a(208),ab=a(1435),db=a(1092),mb=a(528);class Ia{constructor(qc,Lc,bd,jd,Yd,te,oe){this.title=qc;this.body=Lc;this.Y6j=bd;this.primaryButtonAction=jd;this.secondaryButtonAction=te;this.eJg=Yd;this.targetObject=oe}}Object(l.a)(Ia,"NamedSheetViewTeachingCalloutContent",null,[]);class pa{constructor(qc){this.nWe=0;this.dXg=qc}get bXg(){return this.nWe}get D8j(){return this.bXg<this.dXg.count?this.dXg.ma(this.nWe++):
null}}Object(l.a)(pa,"NamedSheetViewTeachingCalloutList",null,[]);var lb=a(1250),ha;let ua=ha=class{constructor(qc){this.$=qc;this.stopwatch=this.vlc=this.ZZc=this.vte=null;this.cXg=0}J9i(qc){this.cXg=qc;const Lc=Object(wa.a)(new Za.a,{});ha.uij(qc)?(Lc.add(new Ia(bb.a.instance.Ba(446),bb.a.instance.Ba(447),bb.a.instance.ia(1943),()=>{this.Xga(2,"Continue");this.$la(!0)},bb.a.instance.ia(1944),()=>{this.$la();this.Xga(1,"ExitGuide")},lb.a())),1===qc&&Lc.add(new Ia(bb.a.instance.ia(1945),bb.a.instance.Ba(449),
bb.a.instance.ia(1943),()=>{this.Xga(2,"FirstEnterTempViewContinueSecond");this.$la(!0)},bb.a.instance.ia(1944),()=>{this.$la();this.Xga(1,"FirstEnterTempViewExitGuideSecond")},lb.a())),Lc.add(new Ia(bb.a.instance.Ba(450),bb.a.instance.Ba(451),bb.a.instance.ia(1943),()=>{this.Xga(2,"FirstEnterExitCalloutContinue");this.$la(!0)},bb.a.instance.ia(1944),()=>{this.$la();this.Xga(1,"FirstEnterExitCalloutGuide")},ha.COi())),Lc.add(new Ia(bb.a.instance.ia(1946),bb.a.instance.Ba(448),bb.a.instance.ia(1947),
()=>{this.vMk();this.$la();this.Xga(1,"LearnMore")},bb.a.instance.ia(1948),()=>{this.$la();this.Xga(1,"Done")},ha.BOi()))):2===qc&&Lc.add(new Ia(bb.a.instance.ia(1945),bb.a.instance.Ba(449),bb.a.instance.ia(1942),()=>{this.$la();this.Xga(1,"EnterTempViewAfterPersistedView")},null,null,lb.a()));this.vte=new pa(Lc)}vMk(){const qc=new Ya.a(-859308420,Ea.a.eh,this.$.Rh,9,null);this.$.Ma.dh(qc,{[Ea.a.Wk]:"HelpID=SheetViews",["InputMethod"]:Ea.a.eh,[Ea.a.Ai]:Da.a.CI,["ShouldCanvasTakeFocus"]:!0})}show(qc){this.J9i(qc);
this.showInternal()}IBk(qc){this.vlc=qc}showInternal(){var qc=this.vte.D8j;if(qc){var Lc=Object(wa.a)(new ab.a,{label:qc.Y6j,onExecute:qc.primaryButtonAction}),bd=null;qc.eJg&&(bd=Object(wa.a)(new ab.a,{label:qc.eJg,onExecute:qc.secondaryButtonAction}));qc=Object(wa.a)(new db.a,{target:qc.targetObject,content:qc.body,title:qc.title,showCloseIcon:!0,primaryButtonProps:Lc,secondaryButtonProps:bd,useTeachingStyles:!0});qc=this.vlc.callout(qc);Lc=Object(wa.a)(new mb.a,{onShow:()=>{this.Xga(0)}});this.ZZc=
this.vlc.addNotification(qc,Lc)}}dismiss(){this.$la();this.Xga(1,"DismissedByOthers")}$la(qc){qc=void 0===qc?!1:qc;this.ZZc&&(this.vlc.removeNotification(this.ZZc),this.ZZc=null);qc&&this.showInternal()}Xga(qc,Lc){const bd={};bd.a=this.$.ua.UserSessionId;bd.b=this.cXg;bd.c=this.vte.bXg;bd.d=qc;bd.e=void 0===Lc?null:Lc;0===qc?this.stopwatch=this.$.qh.vi("UserAction","ShowNamedSheetViewTeachingCallout"):(this.stopwatch&&(this.stopwatch.stop(),bd.f=this.stopwatch.ii,this.stopwatch=null),2===qc&&(this.stopwatch=
this.$.qh.vi("UserAction","ShowNamedSheetViewTeachingCalloutNext")));ra.b().tl(52,bd,!0)}static BOi(){return document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv")}static COi(){return document.querySelector("[data-unique-id=Ribbon-NamedSheetViewExit]")}static uij(qc){return 0===qc||1===qc}};ua=ha=Object(w.__decorate)([Object(C.d)(z.Rd),Object(w.__param)(0,Object(z.Lb)())],ua);Object(l.a)(ua,"NamedSheetViewTeachingCallout",null,[247]);var fb=a(1248),Ka=a(42),La=a(1247),ib=a(592),Yb=
a(14),Wc=a(139),Qc=a(1007),Wb=a(157),Jc=a(23);class ma{static Ygi(qc){return ma.H8e("New",qc)}static Zgi(qc){return ma.H8e("Open",qc)}static t8e(qc,Lc){return ma.cua("LoadingMenuSection",ma.Yvj,qc,ma.eIb("lblLoading",Lc))}static fIb(qc,Lc,bd,jd){return ma.cua("MessageMenuSection",ma.gag,Lc,ma.eIb("lblMessage",qc,void 0===bd?null:bd,void 0===jd?null:jd))}static GLh(qc){return ma.t8e(qc,Object(Jc.a)("VoicedLoadingText"))}static HLh(qc,Lc){return ma.fIb(Object(Jc.a)("NewCreationLocationMessage"),qc.so,
Lc.MY,Lc.fBa)}static FLh(qc,Lc){return ma.fIb(String.format(Object(Jc.a)("NewProvisioningStorageMessage"),Lc.fBa,"\n\n"),qc.so)}static v8e(qc){return ma.fIb(Object(Jc.a)("NewGenericErrorMessage"),qc.so)}static DLh(qc,Lc,bd){return ma.cua("menuNewBlank",ma.N4i,bd?qc.so:null,ma.ZHb(qc.rOf,qc.sOf,qc.tOf,null,qc.u5,qc.mSb,Lc,"blank"))}static DMh(){return ma.eIb("lblTemplatesLoading",Object(Jc.a)("VoicedLoadingText"))}static F8e(){return ma.eIb("lblTemplatesError",Object(Jc.a)("NewTemplateErrorMessage"))}static EMh(qc,
Lc){return ma.cua("menuNewTemplates",qc,null,Lc)}static BLh(qc,Lc){return ma.cua("menuNewMoreTemplates",ma.xyf,null,ma.ZHb("menuNewMoreTemplatesButton",Object(Jc.a)("NewMoreTemplates"),Object(Jc.a)("NewMoreTemplates"),null,null,null,qc,Lc))}static FKh(qc,Lc,bd){let jd="";bd&&Lc&&(jd=ma.cua("BrowseMoreMenuSection",ma.xyf,null,ma.ZHb("btnBrowseMore",Lc,Lc,null,null,null,qc||"1959943459",bd)));return jd}static eIb(qc,Lc,bd,jd){bd=void 0===bd?null:bd;let Yd=jd=void 0===jd?null:jd;Lc&&0<Lc.length&&(Yd=
ma.pbg.CPc(Lc).trimEnd(),Yd=0<=Yd.indexOf("{0}")?String.format(Yd,jd):String.format("{0} {1}",Yd,jd));bd=bd&&jd?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',J.a.Yl(bd),J.a.Yl(jd),J.a.Yl(Yd)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',J.a.Yl(qc||""),ma.pbg.CPc(J.a.Yl(Lc||"")),bd)}static ZHb(qc,Lc,bd,jd,Yd,te,oe,Kd){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',
J.a.Yl(qc||""),J.a.Yl(Lc||""),J.a.Yl(bd||""),jd||"32by32",J.a.Yl(Yd||""),J.a.Yl(te||""),oe,J.a.Yl(Kd||""))}static H8e(qc,Lc){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',qc,Lc)}static cua(qc,Lc,bd,jd){bd=bd?String.format('Title="{0}"',J.a.Yl(bd)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',
J.a.Yl(qc||""),J.a.Yl(Lc||""),bd,jd)}}ma.gag="MenuMru";ma.Yvj="MenuLoading";ma.N4i="MenuHeader";ma.xyf="MenuFooter";ma.pbg=Wb.a.KG("\n","&#10;");Object(l.a)(ma,"NewAndOpenXmlUtilities",null,[]);var Hc=a(107),Kb=a(103),pc=a(133),$b=a(44);class Ib{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(l.a)(Ib,"HostInformation",null,[]);var Zb=a(123),Eb=a(60),ob=a(478),Na=a(159),nb=a(763),Hb=a(666),na=a(134),Gb=a(653),Xa=a(72),Jb=a(354),qb=a(280),Db=a(295),gb=a(34),ya=a(305),
Aa=a(482),sb=a(424),nc=a(285),Bb=a(950),uc=a(237);const Pc={J_c:"CreateNewDocument_FileMenu",featureName:"New",Jla:"wwbootperf",myb:"Boot",Gdb:"Boot",anf:!1};class wd{get Zaa(){this.UCb||(this.UCb=Ka.a.instance.mo("Common.App.SaveToCloudStorage.ODCXStackOperationManager"));return this.UCb}constructor(qc,Lc,bd,jd,Yd,te){this.GEb=this.Nv=this.lbc=null;this.Jhc=this.Rhd=!1;this.$Oe=0;this.wbd=!1;this.Cce=()=>32;this.WHb=(oe,Kd,Ee,rc,fd)=>{if(1===Ee)return 32;fd.MenuItemId=this.gOi();return this.iA.TLa.Xj(v.a.openUrlInNewTab,
Ee,fd,rc)};this.BGj=oe=>{if(oe&&oe.data&&oe.data.responseData){var Kd;let Ee=$b.d(oe.data.responseData);({hz:Kd}=Ee);Ee.returnValue?(oe=Kd,oe.NewDocumentUrl?(Yb.ULS.sendTraceTag(507565458,202,50,"Got NewDocumentUrl with server StatusCode: {0}",oe.StatusCode),Eb.a.dm(oe.NewDocumentUrl,"_blank",void 0,"CreateNewDocument"+(oe.StatusCode!==uc.a.jN&&oe.StatusCode!==uc.a.zWa?"ErrorRedirect":""))):(Yb.ULS.sendTraceTag(507565459,202,10,"NewDocumentUrl not available"),this.ARc())):(Yb.ULS.sendTraceTag(507565461,
202,10,"Failed to deserialize: {0}",{["ResponseData"]:Bb.a.n8a(oe.data.responseData)}),this.ARc())}else Yb.ULS.sendTraceTag(507565462,202,10,"Response data not available"),this.ARc()};this.AGj=oe=>{oe&&oe.data&&Yb.ULS.sendTraceTag(507565457,202,10,"Request failed with status: {0}",oe.data.status);this.ARc()};this.c4j=(oe,Kd,Ee,rc,fd)=>{if(1===Ee)return 32;this.iA.supportsGetMoreInfoForPersonalStorage&&!this.Nv&&this.qbg.kR("Opened New menu",!0);fd.MenuItems=Object.assign(new Aa.a,{Id:"NewSection",
MenuSectionList:[],UpdateDynamically:!0});oe=this.i2h();fd.MenuItems.MenuSectionList.push(oe);return 32};this.Srb=(oe,Kd,Ee,rc,fd)=>{if(1===Ee)return 32;2!==Ee||this.wbd||(this.$Oe=(new Date).getTime(),this.nec&&this.Occ.Naa({kw:"CreateNewDocument_FileMenuRender",Tnb:Jb.b.FailureBased}),Yb.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.xXc,["CachedNewMenuXmlExists"]:!!this.lbc,["ShouldCallGetMoreInfo"]:this.iA.supportsGetMoreInfoForPersonalStorage}));
return this.Pjh&&Db.a.instance.AM(u.AFrameworkApplication.accessTokenTtl)?(Yb.ULS.sendTraceTag(507863243,202,15,"CreateNewActor: session is expired"),this.atc(),32):this.r4j(fd)};this.nda=qc;this.PAb=Lc;this.URa=new ib.a(()=>new Qc.a(bd.value,Object(Wc.a)(this,this.lQb,"getMoreInfoEventReceived")));this.Klh=jd;this.XDa=Yd;this.aph=te;this.iEb=this.xXc;this.yec=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.la("GateTemplateRenderingByGetMoreInfoResponse");this.okh=!!u.AFrameworkApplication.fa&&
u.AFrameworkApplication.fa.la("PremiumTemplateEnabled");this.Pjh=3===this.iA.JM&&!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.la("CreateNewButtonGrayOutForExpiredSessionEnabled");this.nec=3===this.iA.JM&&!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.la("NewKpiForCreateNewActor");this.Occ=Gb.a.getInstance(Pc)}get PN(){switch(this.iA.JM){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}ko(){var qc,Lc;const bd=this.iA.TLa;
bd.Hh(v.a.Cce,na.a.frame,this.Cce);bd.Hh(v.a.newDocument,na.a.frame,Object(Wc.a)(this,this.newDocument,"newDocument"));bd.Hh(v.a.Srb,na.a.frame,this.Srb);if(null===(qc=u.AFrameworkApplication.fa)||void 0===qc?0:qc.la("FileMenuTemplateErrorFixIsEnabled"))null===(Lc=ya.AFrameworkApplication_ActionManager.jh)||void 0===Lc?void 0:Lc.o3i(v.a.Srb);bd.Hh(v.a.q4j,na.a.frame,this.c4j);bd.Hh(v.a.WHb,na.a.frame,this.WHb)}newDocument(qc,Lc,bd,jd,Yd){var te;if(1===bd)return(null===(te=u.AFrameworkApplication.fa)||
void 0===te?0:te.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FileMenuRedesignIsEnabled",!1))&&!this.cWd()?2:32;if(2===bd&&Yd){this.nec&&this.Occ.Naa({kw:"CreateNewDocument_FileMenuExec",Tnb:Jb.b.FailureBased});if(u.AFrameworkApplication.fa.la("BackstagePremiumTemplateExperienceEnabled")&&Yd.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),u.AFrameworkApplication.jh.Gk(v.a.K5j,2);if(Yd.MenuItemId&&Yd.SourceControlId)return"NewDocumentHome"===Yd.SourceControlId&&
Kb.a("NewDocumentFromHomeTab"),this.jgb(Yd.MenuItemId,Yd.SourceControlId)}return 8}gOi(){switch(this.iA.JM){case 3:return"https://www.office.com/template/Word";case 1:return"https://www.office.com/template/Excel";case 2:return"https://www.office.com/template/PowerPoint"}return null}jgb(qc,Lc){var bd=this.DLc.dxd;if(null===bd)return this.BXb("RelativePathIsNull",!0),8;var jd=u.AFrameworkApplication.fa.la("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const Yd=u.AFrameworkApplication.NU;"blank"===
qc&&this.Llj()&&(Yb.ULS.sendTraceTag(508687196,202,50,"Updating blank document id with new template id for appId={0}",this.PN),qc="blankNew");if(Yd&&jd){Yb.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const te={};te[ob.a.rXg]=qc;te[ob.a.PN]=this.PN;te[ob.a.lcid]=u.AFrameworkApplication.lcid.toString();te[ob.a.reason]=nb.a.createNew;te[ob.a.uiCulture]=u.AFrameworkApplication.uiCulture;te[ob.a.dataCulture]=u.AFrameworkApplication.dataCulture;
u.AFrameworkApplication.BI().execute(oe=>{oe.sendMessage(Na.a.jgb,te)})}else jd=(new Date).getTime(),Lc=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",bd,J.a.kl(this.qY),J.a.kl(qc),J.a.kl(this.PN),J.a.kl(u.AFrameworkApplication.lcid.toString()),J.a.kl(jd.toString()),J.a.kl(Lc),J.a.kl(u.AFrameworkApplication.HT),u.AFrameworkApplication.qo),(bd=u.AFrameworkApplication.fa.Xa("ScenarioId"))&&""!==bd&&(Lc+="&wdscenarioid="+J.a.kl(bd)),
Lc+="&"+u.AFrameworkApplication.gAc(),bd=this.Nv?this.Nv.MY:null,this.Zaa&&this.Zaa.Fyb&&(bd=this.Zaa.PersonalFileStorageUrl),bd?Lc+="&DestinationUrl="+J.a.kl(bd):3===this.iA.JM&&this.iA.supportsGetMoreInfoForPersonalStorage&&(this.BXb("GetMoreInfoOrPersonalFileStorageUrlIsEmpty",!0),Yb.ULS.sendTraceTag(508928088,202,10,"CreateNewDocument: getMorInfoResult is null or PersonalFileStorageUrl is empty")),"SharePoint"===this.qY?qb.a.dB("6f63j813;9a66f561"):"OneDriveWopi"===this.qY&&qb.a.dB("b8jd0489;3228j491"),
(bd=gb.a.D0||gb.a.A0||gb.a.WHc)&&Yb.ULS.sendTraceTag(507569058,202,15,"CreateNewDocument: Opening window via form POST is blocked, isMobileBrowser: {0}, isElectron: {1}, isWebview2: {2}",gb.a.D0,gb.a.A0,gb.a.WHc),u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseGraphFileUploaderForCreateNew",!1)||u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseGraphFileUploaderForOneDriveConsumerCreateNew",!1)?bd?this.iA.Jpb.Ou(Lc,2,null,{"X-UseGraphFileUploader":"1",
"X-DoNotRedirect":"1"},!1,2,this.BGj,this.AGj,null):(bd={ugfu:"1"},bd.wacAadToken=u.AFrameworkApplication.$i.Cca,Eb.a.i1b("_blank",Lc,bd)):Eb.a.dm(Lc,"_blank",void 0,"CreateNewDocument");2!==this.iA.JM&&3!==this.iA.JM||Yb.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:Hb.a[this.iA.JM],["Template"]:qc});u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.Excel.ChangeGate.ConsumerTemplateTelemetry")&&1===this.iA.JM&&("blank"===
qc||"blankNew"===qc?Kb.b("ConsumerTemplateNewBlank"):(qc=[Object.assign(new Xa.a,{name:"TemplateId",string:qc})],Kb.b("ConsumerTemplateNew",null,0,!0,0,qc)));this.O5f(!0);return 32}Llj(){let qc=!1;switch(this.iA.JM){case 3:qc=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefaultsUpdate",!1);break;case 2:qc=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PPTODefaultThemeChange",!1);break;case 1:qc=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.NewDefaultTemplate",
!1)}return qc}ARc(){this.PN||Yb.ULS.sendTraceTag(507565456,202,10,"CreateNewDocument app ID not available");const qc="https://office.live.com/start/"+(this.PN?this.PN.replace("WAC",".aspx"):"")+"?ec=1&auth=0&originalauth="+("SharePoint"===this.qY?"2":"1")+"&wdPreviousSession="+u.AFrameworkApplication.userSessionId;Eb.a.dm(qc,"_blank",void 0,"CreateNewDocumentErrorRedirect")}wzj(qc){let Lc=Number.MAX_VALUE,bd=Number.MIN_VALUE;const jd=window.performance;if(jd&&"undefined"!==typeof jd.getEntriesByName){for(let te=
0;te<qc.length;te++){var Yd=jd.getEntriesByName(qc[te]);Yd&&0<Yd.length&&(Yd=Yd[0],Lc=Math.min(parseInt(String(Yd.fetchStart)),Lc),bd=Math.max(parseInt(String(Yd.responseEnd)),bd))}bd>Lc&&Yb.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:bd-Lc,["MinFetchStart"]:Lc,["MaxResponseEnd"]:bd})}}i2h(){const qc=Object.assign(new sb.a,{Title:"",Id:"FileMenuNewSection",DisplayMode:"Menu",ShowMenuSectionSeparator:!0,ControlList:[]});qc.ControlList.push(Object.assign(new nc.a,
{ExternalId:"btnBlankDocument",Command:v.a.newDocument,CommandValueId:v.a.newDocument,LabelText:Object(Jc.a)("BlankDocumentLabel"),Alt:Object(Jc.a)("BlankDocumentLabel"),AriaDescription:Object(Jc.a)("BlankDocumentLabel"),ExternalImageId:"DocumentAddColorFluent_20",MenuItemId:"blank"}));qc.ControlList.push(Object.assign(new nc.a,{ExternalId:"btnBrowseTemplates",Command:v.a.WHb,CommandValueId:v.a.WHb,LabelText:Object(Jc.a)("BrowseTemplatesLabel"),Alt:Object(Jc.a)("BrowseTemplatesLabel"),AriaDescription:Object(Jc.a)("BrowseTemplatesLabel"),
ExternalImageId:"TemplateBrowseColorFluent_20"}));return qc}r4j(qc){qc&&(this.lbc?qc.PopulationXML=this.lbc:(this.iA.supportsGetMoreInfoForPersonalStorage&&!this.Nv&&this.qbg.kR("Opened New menu",!0),qc.PopulationXML=this.oBi(this.oWi())));return 32}cWd(){return!this.iA.supportsGetMoreInfoForPersonalStorage||!!this.Nv&&3===this.Nv.state&&!!this.Nv.fBa&&!!this.Nv.MY||this.Zaa&&this.Zaa.Fyb&&!!this.Zaa.PersonalFileStorageUrl}dWd(){return u.AFrameworkApplication.ra&&u.AFrameworkApplication.ra.$d.zaa&&
!this.yec?!0:this.cWd()}oWi(){if(!this.xXc&&!this.yec&&!this.dWd())return null;if(this.iEb&&!this.Jhc){let Lc=!1;var qc="9";const bd=u.AFrameworkApplication.fa.appSettings;"NumberOfTemplatesInBackstage"in bd&&(qc=bd.NumberOfTemplatesInBackstage);let jd=this.PN;"TemplateCollectionId"in bd&&(jd=bd.TemplateCollectionId);this.okh&&"PowerPointWAC"===jd&&(Lc=!0);qc=String.format(this.iA.Y0+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",J.a.kl(u.AFrameworkApplication.lcid.toString()),J.a.kl(jd),
qc);Boolean.parse(bd.AppendOriginQueryParam||"false")&&(qc+="&org=backstage");Boolean.parse(bd.BackstagePremiumTemplateExperienceEnabled||"false")&&"TemplateTier"in bd&&(qc+="&templateTier="+bd.TemplateTier);qc=Lc?qc+"&p=1":qc+"&p=0";qc+="&"+u.AFrameworkApplication.gAc();this.iA.Jpb.Ou(qc,1,null,null,!1,2,Yd=>{this.iA.noa("CreateNewActor.GetTemplateListJson",Yd.data);this.WUk(Yd.data.responseData)},Yd=>{this.iA.noa("CreateNewActor.GetTemplateListJson",Yd.data);this.VUk()},null,void 0,void 0,void 0,
void 0,"5");this.iEb=!1}return this.GEb}WUk(qc){this.GEb=qc;this.iEb=!1;this.o2b();this.yec?this.dWd()?this.Szd():this.Nv&&(Yb.ULS.sendTraceTag(508867410,202,10,"GetMoreInfo Received but info is missing"),this.BXb("GetMoreInfoReceivedButInfoIsMissing",!1),this.atc()):this.Szd()}Szd(){if(u.AFrameworkApplication.ra&&u.AFrameworkApplication.ra.$d.zaa&&pc.c()){const qc=u.AFrameworkApplication.fa.la("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC"),Lc=u.AFrameworkApplication.NU;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.GEb,
!0,qc&&Lc));this.O5f(!1);3===this.iA.JM&&Yb.ULS.sendTraceTag(508867409,202,15,"DispatchSuccessTemplateListJson")}}VUk(){this.Jhc=this.iEb=!0;this.o2b();this.BXb("TemplateServiceFailed",!1);this.atc();Hc.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}atc(){u.AFrameworkApplication.ra&&u.AFrameworkApplication.ra.$d.zaa&&pc.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1)),3===this.iA.JM&&Yb.ULS.sendTraceTag(508867408,
202,15,"DispatchFailureTemplateListJson"))}O5f(qc){this.nec&&this.Occ.tLa({kw:qc?"CreateNewDocument_FileMenuExec":"CreateNewDocument_FileMenuRender"})}BXb(qc,Lc){this.nec&&this.Occ.loa({kw:Lc?"CreateNewDocument_FileMenuExec":"CreateNewDocument_FileMenuRender",errorName:qc})}CWi(qc){var Lc=0;for(var bd=0;bd<qc.length;bd++)if("ST"===qc[bd].ImageType){Lc=bd;break}const jd=qc.length?qc[Lc]:null;qc=jd?jd.Url||"":"";var Yd;let te=bd=Lc=!1;if(jd&&(Yd=jd.AspectRatio))Yd=parseFloat(Yd),1>Yd?Lc=!0:1.5<Yd?bd=
!0:1===Yd&&(te=!0);else switch(Yb.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:qc}),this.iA.JM){case 3:Lc=!0;break;case 2:bd=!0;break;case 5:te=!0}return{returnValue:qc,p7i:Lc?"95by123":bd?"123by69":te?"100by100":"123by95"}}oBi(qc){let Lc;const bd=this.DLc.gVa||"1056925771",jd=(()=>{let Yd=this.ELh(qc,this.DLc,bd);({$Wc:Lc}=Yd);return Yd})().returnValue;if(Lc){this.lbc=jd;const Yd=(new Date).getTime()-this.$Oe;Yb.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",
{["ElapsedMsSinceMenuOpened"]:Yd})}return jd}lQb(qc,Lc){Yb.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.Nv||3!==qc.state?2===qc.state&&(Yb.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.Rhd=!0,this.o2b()):(this.Nv=qc,Lc||this.o2b(),u.AFrameworkApplication.ra&&u.AFrameworkApplication.ra.$d.zaa&&pc.c()&&pc.d("setFileMenuHostInformation")&&(qc=Object.assign(new Ib,{hostUrl:this.Nv.MY,hostName:this.Nv.fBa,folderUrl:u.AFrameworkApplication.breadcrumbFolderUrl,
folderName:u.AFrameworkApplication.breadcrumbFolderName}),this.Zaa&&this.Zaa.Fyb&&(qc.hostUrl=this.Zaa.PersonalFileStorageUrl),Yb.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(qc)),this.yec&&this.GEb&&this.GEb.length&&(this.dWd()?this.Szd():(this.BXb("PersonalFileStorageInfoIsMissing",!1),this.atc()),Yb.ULS.sendTraceTag(508867407,202,15,"Dispatched on GetMoreInfoReceived"))))}ELh(qc,Lc,bd){let jd;jd=!1;
const Yd=this.cWd();let te="";this.iA.supportsGetMoreInfoForPersonalStorage&&(this.Rhd?(te=ma.v8e(Lc),this.Rhd=!1,Yb.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.Nv?Yd?te=ma.HLh(Lc,this.Nv):this.Nv.Acj?(jd=!0,this.iEb=!1,te=ma.FLh(Lc,this.Nv),Yb.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(jd=!0,te=ma.v8e(Lc),Yb.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",
{["PersonalFileStorageUrlIsSet"]:!!this.Nv.MY,["StorageServiceDisplayNameIsSet"]:!!this.Nv.fBa})):(te=ma.GLh(Lc.so),Yb.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));Yd&&(te+=ma.DLh(Lc,bd,!te)+(()=>{let oe=this.CMh(qc,bd);({$Wc:jd}=oe);return oe})().returnValue);return{returnValue:ma.Ygi(te),$Wc:jd}}CMh(qc,Lc){let bd;bd=!1;if(!this.xXc)return bd=!0,Yb.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",$Wc:bd};let jd=
"",Yd="",te="MenuTemplate";if(this.Jhc)jd=ma.F8e(),this.Jhc=!1,Yb.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(qc){try{const oe=Sys.Serialization.JavaScriptSerializer.deserialize(qc,!0);jd=this.BMh(oe,Lc);Yb.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");u.AFrameworkApplication.rbg&&"OneDrive"===this.qY&&(Yd=ma.BLh(this.GGj,u.AFrameworkApplication.rbg))}catch(oe){Yb.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",
{["JsonToConvert"]:qc}),jd=ma.F8e()}bd=!0}else te="MenuLoading",jd=ma.DMh(),Yb.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:ma.EMh(te,jd)+Yd,$Wc:bd}}BMh(qc,Lc){let bd="";const jd=[];for(let te=0;te<qc.length;te++){var Yd=qc[te];let oe="";if(Yd){const Kd=Yd.Title,Ee=Yd.AssetId;Yd=Yd.Thumbnails;Ee&&Kd&&Yd&&({p7i:Yd,returnValue:oe}=this.CWi(Yd),bd+=ma.ZHb("jbtnNewTemplate"+te,Kd,null,Yd,null,oe,Lc,Ee))}jd[te]=oe}qc=new Zb.a(4,1,5E3,()=>{this.wzj(jd)},
106);this.iA.ALc.Ol(qc);return bd}o2b(){this.wbd=!0;this.iA.jbg.wA(this.DLc.uOb);this.wbd=!1}get iA(){return this.nda.value}get DLc(){return this.PAb.value}get qbg(){return this.URa.value}get GGj(){return this.Klh.value}get qY(){return this.Zaa&&this.Zaa.Fyb?this.Zaa.NewDocumentDestinationHost:this.XDa.value}get xXc(){return this.aph.value}}Object(l.a)(wd,"CreateNewActor",null,[]);var Md=a(1434);class Nd extends Md.a{constructor(){super()}O_e(){this.s3(0,Object(Jc.a)("OpenMenuEmptyMruMessage"));this.s3(1,
Object(Jc.a)("OpenMenuServerErrorMessage"));this.s3(2,Object(Jc.a)("Open"));this.s3(3,Object(Jc.a)("OpenMenuRecentDocuments"));this.s3(4,Object(Jc.a)("OpenMenuMoreOnHost"));this.s3(5,Object(Jc.a)("VoicedLoadingText"))}static get instance(){return Nd.Wa||(Nd.Wa=new Nd)}static b_j(qc){return Nd.instance.ia(qc)}}Nd.Wa=null;Object(l.a)(Nd,"MruActorIntlHelper",Md.a,[]);var ec;(function(qc){qc[qc.success=0]="success";qc[qc.failure=1]="failure";qc[qc.spinner=2]="spinner";qc[qc.none=3]="none"})(ec||(ec={}));
Object(l.b)("DisplayState",ec);var gc=a(1368);class Mb{constructor(qc,Lc,bd,jd,Yd,te,oe,Kd){this.q6c=null;this.bkd=!0;this.kbc="";this.Lqh=0;this.uab=null;this.ncd=3;this.vfc=new Map;this.nbd=null;this.T6g="SaveAsWordDocx_32";this.q5j="SaveAsPowerPointPptx_32";this.Dqi="SaveAsExcelXlsx_32";this.O$k="LayerDiagonalColorFluent_20";this.G7k="DesktopArrowUpColorFluent_20";this.hag="MruNoDataSection";this.oFj="MruSection";this.FE="SourceControlId";this.menuItemId="MenuItemId";this.fag="Mru";this.JZj=(Ee,
rc,fd,Ed,Rd)=>{if(1==fd)return 32;if(!Rd[this.FE]||!this.vfc.has(Rd[this.FE]))return Yb.ULS.sendTraceTag(507605730,324,15,"Unable to get the url for the document"),2;Rd[this.menuItemId]=this.vfc.get(Rd[this.FE])[1];Rd[this.FE]="";return this.qC.TLa.Xj(v.a.FMa,fd,Rd,Ed)};this.tae=(Ee,rc,fd,Ed,Rd)=>{if(!this.YUb)return 2;if(1===fd)return 32;Rd.MenuItems=Object.assign(new Aa.a,{Id:"MruList",MenuSectionList:[],UpdateDynamically:!0});return this.l4j(Rd,gc.a.instance.uPe)};this.XPc=(Ee,rc,fd,Ed,Rd)=>1!==
fd&&Rd?this.m4j(Rd):32;this.Ga=Kd;this.nda=qc;this.uG=Lc;this.zhh=bd;this.zeh=jd;this.yeh=Yd;this.URa=new ib.a(()=>new Qc.a(te.value,null));this.nih=new ib.a(()=>new Qc.a(oe.value,Object(Wc.a)(this,this.nFj,"mruEventResultReceived")));this.Ga.la("WacInTabOpenMRUIsEnabledForUiHost");this.Ga.la("UiHostSupportsDocRebootFeatures")}nFj(qc,Lc){this.uab=qc;Lc||this.Qyg()}pfk(){const qc=this.qC.TLa;qc.Vk(v.a.XPc,na.a.frame,this.XPc,96);qc.Hh(v.a.t9d,na.a.frame,this.JZj);qc.Hh(v.a.tae,na.a.frame,this.tae)}l4j(qc,
Lc){(Lc=this.K3h(Lc))?(Yb.ULS.sendTraceTag(507605729,324,50,"Mru flyout data loaded successfully in file menu"),qc.MenuItems.MenuSectionList.push(Lc)):this.a4j(qc);Lc=this.b7h();qc.MenuItems.MenuSectionList.push(Lc);return 32}K3h(qc){if(qc){var Lc=this.Iwd(this.oFj,!0);qc=JSON.parse(qc);this.vfc.clear();qc.forEach((bd,jd)=>{this.vfc.set(this.fag+jd.toString(),[bd.FileName,bd.DocumentUrl]);const Yd=this.pOi(bd.FileName);Lc.ControlList.push(Object.assign(new nc.a,{ExternalId:this.fag+jd.toString(),
Command:v.a.t9d,CommandValueId:v.a.t9d,LabelText:Yd,Alt:bd.FileName,AriaDescription:bd.FileName,ExternalImageId:this.zLi(this.qC.JM),KeyTip:bd.FileName}))});return Lc}}b7h(){const qc=this.Iwd("ViewAllFilesAndUploadSection",!1);if(!this.N$c){let bd=this.W7e;var Lc=this.V7e;bd&&Lc||!this.qC.supportsGetMoreInfoForPersonalStorage||(Lc=this.mQb.kR("File Open",!1),3===Lc.state&&(bd=Lc.MY));this.N$c=bd}this.N$c&&qc.ControlList.push(Object.assign(new nc.a,{ExternalId:"btnViewMoreFiles",Command:v.a.openUrlInNewTab,
CommandValueId:v.a.openUrlInNewTab,LabelText:Object(Jc.a)("ViewMoreFilesLabel"),Alt:Object(Jc.a)("ViewMoreFilesLabel"),AriaDescription:Object(Jc.a)("ViewMoreFilesLabel"),ExternalImageId:this.O$k,MenuItemId:this.N$c}));qc.ControlList.push(Object.assign(new nc.a,{ExternalId:"btnUploadDocument",Command:v.a.i4g,CommandValueId:v.a.i4g,LabelText:Object(Jc.a)("UploadFilesLabel"),Alt:Object(Jc.a)("UploadFilesLabel"),AriaDescription:Object(Jc.a)("UploadFilesLabel"),ExternalImageId:this.G7k}));return qc}Iwd(qc,
Lc){Lc=void 0===Lc?!1:Lc;return Object.assign(new sb.a,{Title:Lc?Object(Jc.a)("MruTitle"):"",Id:qc,DisplayMode:"Menu",ShowMenuSectionSeparator:!0,ControlsId:"Ctrl_"+qc,ControlList:[]})}a4j(qc){Yb.ULS.sendTraceTag(507605728,324,50,"Mru data could not load in file menu flyout");qc.MenuItems.MenuSectionList.push(this.L3h())}L3h(){const qc=this.Iwd(this.hag,!1);qc.ControlList.push(Object.assign(new nc.a,{ExternalId:this.hag,LabelText:Object(Jc.a)("MruNoDataLabel")}));return qc}pOi(qc){return qc&&qc.length<=
Mb.wPe?qc:qc.substring(0,Mb.wPe-3)+"..."}zLi(qc){let Lc=this.T6g;switch(qc){case 3:Lc=this.T6g;break;case 2:Lc=this.q5j;break;case 1:Lc=this.Dqi}return Lc}m4j(qc){this.Phi();this.Ohi();qc.PopulationXML=ma.Zgi(this.kbc+this.q6c);return 32}Phi(){let qc=3,Lc=!1;if(this.kbc&&this.Lqh===this.uab.HWk)Yb.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),qc=this.ncd;else{Yb.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",
{["CacheRefresh"]:"Starting"});var bd=this.qC.wF();this.uab=this.mFj.kR("File Open opened",!0);if(this.kbc&&2!==this.ncd&&3!==this.uab.state)Lc=!0;else{const jd=this.YTi(this.uab);u.AFrameworkApplication.ra&&u.AFrameworkApplication.ra.$d.zaa&&pc.c()&&jd&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(jd,!0));this.kbc=(()=>{let Yd=this.pBi(this.uab);({wGj:qc}=Yd);return Yd})().returnValue}bd=this.qC.wF()-bd;Yb.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",
{["CacheRefresh"]:"Complete",["ElapsedMs"]:bd})}2!==qc&&(bd={["DisplayState"]:ec[qc]},1!==qc&&(bd.IsStale=Lc),Yb.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",bd));this.ncd=qc}YTi(qc){let Lc;try{Lc=$b.c(qc.O3d)}catch(bd){Lc=null,Yb.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",bd)}return Lc}Ohi(){this.bkd?(Yb.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.q6c=(()=>{let qc=this.XAj();
({Aal:this.bkd}=qc);return qc})().returnValue):Yb.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");Yb.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.bkd,["NotDisplayingLink"]:!this.q6c})}pBi(qc){let Lc;1===qc.state||0===qc.state?(Yb.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),qc=2,Lc=ma.t8e(this.Dwa(2),this.Dwa(5))):3===qc.state&&qc.O3d?(Lc=this.CLh(qc.O3d),qc=0):(Yb.ULS.sendTraceTag(5849634,
202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),Lc=ma.fIb(this.Dwa(1),this.Dwa(2)),qc=1);return{returnValue:Lc,wGj:qc}}CLh(qc){let Lc;const bd=this.uYb.gVa||"2155708348";if(qc.length){Lc=ma.eIb("lblRecentDocuments",this.Dwa(3));let jd=0;for(let Yd=0;Yd<qc.length;Yd++){const te=qc[Yd];"FileName"in te&&"DocumentUrl"in te&&"Path"in te&&(Lc+=ma.ZHb("MruButton"+Yd,te.FileName.toString(),te.Path.toString(),null,this.uYb.u5,this.uYb.mSb,bd,te.DocumentUrl.toString()),te.IsPinned&&jd++)}Lc=
ma.cua("RecentDocumentsMenuSection",ma.gag,this.Dwa(2),Lc);Yb.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:qc.length,["NumPinnedDocuments"]:jd})}else Lc=ma.fIb(this.Dwa(0),this.Dwa(2)),Yb.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return Lc}XAj(){let qc;qc=!0;let Lc=this.W7e;var bd=this.V7e;if(Lc&&bd||!this.qC.supportsGetMoreInfoForPersonalStorage)qc=!1;else{const jd=this.mQb.kR("File Open",!1);3===jd.state&&
(Lc=jd.MY,bd=jd.fBa,qc=!1)}bd=bd?String.format(this.Dwa(4),bd):null;return{returnValue:ma.FKh(this.uYb.gVa,bd,Lc),Aal:qc}}Qyg(){this.qC.jbg.wA(this.uYb.uOb)}get qC(){return this.nda.value}get Dwa(){return this.uG.value}get uYb(){return this.zhh.value}get W7e(){return this.zeh.value}get V7e(){return this.yeh.value}get mQb(){return this.URa.value}get mFj(){return this.nih.value}get YUb(){this.nbd||(this.nbd=this.Ga?this.Ga.la("IsO365CommercialHost")||this.Ga.la("IsO365ConsumerHost"):!1);return this.nbd}}
Mb.wPe=35;Object(l.a)(Mb,"MruRenderer",null,[]);class sc{constructor(qc,Lc,bd,jd,Yd,te,oe){this.Nv=null;this.eUe=!1;this.jDa=this.UEe=0;this.lQb=Kd=>{if(!this.Nv&&3===Kd.state)this.Nv=Kd;else if(2===Kd.state){this.eUe?Yb.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.mQb.kR("NewDocumentFromStream",!0),this.eUe=!0);return}this.Thf()};this.zGj=Kd=>{if(Kd&&Kd.data&&Kd.data.responseData){let rc=$b.d(Kd.data.responseData);({hz:Ee}=rc);if(rc.returnValue)if(Kd=Ee,Kd.StatusCode!==
uc.a.jN&&Kd.StatusCode!==uc.a.zWa)Yb.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.PN,this.jDa,Kd.StatusCode),this.Nab(null);else if(Kd.NewDocumentUrl&&""!==Kd.NewDocumentUrl){var Ee=(new Date).getTime()-this.UEe;Yb.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.PN,this.jDa,Ee);this.Rlh(Kd.NewDocumentUrl)}else Yb.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",
this.PN,this.jDa),this.Nab(null);else Yb.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.PN,this.jDa,{["ResponseData"]:Bb.a.n8a(Kd.data.responseData)}),this.Nab(null)}else Yb.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.PN,this.jDa),this.Nab(null)};this.yGj=Kd=>{Kd&&Kd.data&&Yb.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",
this.PN,this.jDa,Kd.data.status);this.Nab(null)};this.Rlh=qc;this.Nab=Lc;this.xfc=bd;this.PAb=jd;this.XDa=Yd;this.nda=te;this.URa=new ib.a(()=>new Qc.a(oe.value,this.lQb))}jgb(){!this.Nv&&this.v4d.supportsGetMoreInfoForPersonalStorage?this.mQb.kR("NewDocumentFromStream",!0):this.Thf()}Thf(){this.UEe=(new Date).getTime();var qc=this.kti.dxd;if(null===qc)this.Nab(null);else{var Lc=this.xfc.menuItemId,bd=this.xfc.FE,jd=this.xfc.pSk,Yd=this.xfc.pti;this.jDa="streamBase64"===jd?Yd.length/1024:0;Yb.ULS.sendTraceTag(35156358,
202,50,"FileType:{0}, FileSize:{1}",this.PN,this.jDa);var te=(new Date).getTime();qc=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",qc,J.a.kl(this.qY),J.a.kl(Lc),J.a.kl(this.PN),J.a.kl(u.AFrameworkApplication.lcid.toString()),J.a.kl(te.toString()),J.a.kl(bd),J.a.kl(u.AFrameworkApplication.HT),u.AFrameworkApplication.qo,J.a.kl(jd));qc+="&"+u.AFrameworkApplication.gAc();(Lc=this.Nv?this.Nv.MY:null)&&(qc+="&DestinationUrl="+J.a.kl(Lc));
"SharePoint"===this.qY?qb.a.dB("6f63j813;9a66f561"):"OneDriveWopi"===this.qY&&qb.a.dB("b8jd0489;3228j491");Lc={"Content-Type":"application/json; charset=utf-8"};if(u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseGraphFileUploaderForCreateNew",!1)||u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseGraphFileUploaderForOneDriveConsumerCreateNew",!1))Lc["X-UseGraphFileUploader"]="1";this.v4d.Jpb.Ou(qc,2,Yd,Lc,!0,2,this.zGj,this.yGj,null,
void 0,void 0,void 0,void 0,"31")}}get PN(){switch(this.v4d.JM){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get kti(){return this.PAb.value}get qY(){return this.XDa.value}get v4d(){return this.nda.value}get mQb(){return this.URa.value}}Object(l.a)(sc,"NewDocumentFromStreamOperation",null,[]);class xd{constructor(qc,Lc,bd,jd){this.PAb=qc;this.XDa=Lc;this.nda=bd;this.mih=jd}create(qc,Lc,bd){return new sc(qc,Lc,bd,this.PAb,this.XDa,
this.nda,this.mih)}}Object(l.a)(xd,"NewDocumentFromStreamOperationFactory",null,[280]);var xb=a(599);class Lb{get name(){return"Common.App.NewAndOpen.UX"}ao(qc){qc.register(xd,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").hi().mi(()=>new xd(new ib.a(()=>u.AFrameworkApplication.ra.$d.bJd()),new ib.a(()=>u.AFrameworkApplication.qY),new ib.a(()=>Ka.a.instance.mo("Common.INewAndOpenCommonHelpers")),new ib.a(()=>
Object(La.b)())))}init(){u.AFrameworkApplication.fa.ty(()=>{this.GSb()})}GSb(){const qc=xb.a.hv(Ka.a.instance.Qi("Common.INewAndOpenCommonHelpers")),Lc=xb.a.hv(Object(La.a)());u.AFrameworkApplication.qY&&B.Task.WAA.call(null,qc,Lc).continueWith(()=>{const bd=new wd(new ib.a(()=>qc.result),new ib.a(()=>u.AFrameworkApplication.ra.$d.bJd()),new ib.a(()=>Lc.result),new ib.a(()=>u.AFrameworkApplication.ra.$d.cJd().gVa||"1959943459"),new ib.a(()=>u.AFrameworkApplication.qY),new ib.a(()=>u.AFrameworkApplication.Mlj));
bd.ko();bd.o2b()});if(u.AFrameworkApplication.Hxg){const bd=xb.a.hv(Object(fb.a)());B.Task.WAA.call(null,qc,Lc,bd).continueWith(()=>{const jd=new Mb(new ib.a(()=>qc.result),new ib.a(()=>Nd.b_j),new ib.a(()=>u.AFrameworkApplication.ra.$d.cJd()),new ib.a(()=>u.AFrameworkApplication.a_j),new ib.a(()=>u.AFrameworkApplication.$Zj),new ib.a(()=>Lc.result),new ib.a(()=>bd.result),u.AFrameworkApplication.fa);jd.pfk();jd.Qyg()})}}dispose(){}}Object(l.a)(Lb,"UXPackageManager",null,[12,13,2]);Object(C.b)(z.Vd,
{yk:"transient"})(qc=>No(function*(){yield C.a.resolve(z.Ud,qc);return new Lb}));let Rc=class{constructor(qc,Lc){this.Wp=Lc;this.$=qc}executeCommand(qc,Lc,bd){qc=2;switch(Lc.command){case v.a.openUrlInNewTab:qc=this.Wp.Xj(v.a.openUrlInNewTab,2,bd);break;case v.a.FMa:qc=this.Wp.Xj(v.a.FMa,2,bd)}return 2!==qc?B.Task.Va(!0):n.a(Lc.command)}ni(qc,Lc){return Lc.command===v.a.openUrlInNewTab||Lc.command===v.a.FMa}Ji(qc,Lc,bd){return"PopulateMruMenu"===Lc?(this.Wp.Xj(v.a.XPc,2,bd),!0):!1}Bi(){return!1}};
Rc=Object(w.__decorate)([Object(C.d)(z.he),Object(w.__param)(0,Object(z.Lb)()),Object(w.__param)(1,Object(z.f)()),Object(w.__param)(2,Object(z.ab)()),Object(w.__param)(3,Object(z.Vd)())],Rc);Object(l.a)(Rc,"OpenFromMruCommandHandler",null,[39]);var nd=a(158),$d=a(419),Td=a(117),He=a(24),oc=a(423);class ld{constructor(qc,Lc){this.sheetName=null;this.value=!1;this.sheetName=qc;this.value=Lc}getSheetName(){return this.sheetName}MO(){return this.value}}Object(l.a)(ld,"MacroRecorderSheetOptionToggledPayload",
null,[65]);const id=(qc,Lc,bd,jd,Yd,te,oe,Kd)=>{Kd=qc.Za(9,void 0===Kd?null:Kd);Kd.sheetName=Lc;Kd.show=bd;return ea.h(qc,"ShowGridlines",Kd,jd,Yd,te,oe,0)},fc=(qc,Lc,bd,jd,Yd,te,oe,Kd)=>{Kd=qc.Za(9,void 0===Kd?null:Kd);Kd.sheetName=Lc;Kd.show=bd;return ea.h(qc,"ShowHeadings",Kd,jd,Yd,te,oe,0)},vc=(qc,Lc,bd,jd,Yd,te,oe,Kd)=>{Kd=qc.Za(9,void 0===Kd?null:Kd);Kd.sheetName=Lc;Kd.directionRtl=bd;return ea.h(qc,"ChangeSheetDirection",Kd,jd,Yd,te,oe,0)};var Tc;let Bd=Tc=class{constructor(qc){this.$=qc}Bi(){return!1}executeCommand(qc,
Lc){const bd={};this.$.Mq(bd);qc=Lc.command;const jd=Object(nd.a)(Td.a,this.$.sa.getItemByName(bd.SheetName));if(!jd)return n.a(qc);let Yd,te,oe,Kd,Ee;switch(qc){case 705559150:case -1411193626:Yd=16;te=!jd.hideGridLines;oe=id;Ee=183;Kd=jd.hideGridLines;break;case -2052321504:case 515737500:Yd=4;te=!jd.headersVisible;oe=fc;Ee=184;Kd=!jd.headersVisible;break;case -1478455630:Yd=2;te=!jd.displayRtl;oe=vc;Ee=185;Kd=!jd.displayRtl;He.f(this.$).za.c3k(te);break;default:return n.a(qc)}jd.RIb(Yd,te);const rc=
()=>new ld(bd.SheetName,Kd),fd=this.$.pa.ta;return $d.a(this.$.userOperationManager,(Ed,Rd,Fe)=>oe(fd,bd.SheetName,Kd,O.c(Ed,Ae=>{Tc.U_b(Ae,jd,Yd,te)}),O.b(Rd,()=>{Tc.c_b(jd,Yd,te)}),Fe,null),Ed=>new N.a(Ee,0,Ed,void 0,rc),Lc)}ni(qc,Lc){qc=!1;switch(Lc.command){case -1411193626:case 515737500:case -1478455630:qc=!0;break;case 705559150:case -2052321504:qc=oc.a(this.$)}return qc}Ji(){return!1}static U_b(qc,Lc,bd,jd){F.a.rx(qc.Errors)&&Lc.RIb(bd,!jd)}static c_b(qc,Lc,bd){qc.RIb(Lc,!bd)}};Bd=Tc=Object(w.__decorate)([Object(C.d)(z.Hf),
Object(w.__param)(0,Object(z.Lb)())],Bd);Object(l.a)(Bd,"SheetOptionsToggleCommandHandler",null,[39]);var Fd=a(1436),le=a(16),dc=a(885),Uc=a(886),kb=a(279),rb=a(301);class cc{constructor(qc){this.$=qc;this.R9e="SheetViewEntryCallout";this.kEc=!1;this.Vha=Lc=>{He.f(this.$).focus();this.kEc=!Lc;Lc&&this.olf()};this.mIj=document.createElement("div");this.Yx=document.getElementById(this.$.$h+Da.a.iGd);rb.a(this.$).Eq(this);this.Vta()}dispose(){var qc;this.$=null;null===(qc=rb.a(this.$))||void 0===qc?
void 0:qc.FH(this)}uMk(){var qc;!this.$.sa||(null===(qc=this.$.sa.na)||void 0===qc?0:qc.Kj.BM)?this.$.ea.gFa(this.showCallout):this.$.sa.Lmd(this.showCallout);this.$.ea.eGb(this.ULb)}Vta(){this.showCallout=this.showCallout.bind(this);this.chb=this.chb.bind(this);this.ULb=this.ULb.bind(this)}showCallout(){var qc;this.ULb();null!==(qc=this.$.sa.na)&&void 0!==qc&&qc.Kj.BM?(this.WRg(!0),this.kEc=!0,this.$.ea.eGb(this.chb),this.$.sa.Qm(this.chb)):Yb.ULS.sendTraceTag(508048723,dc.a.zpb,Uc.a.warning,"SheetViewEntryCallout.showCallout: skipped as current sheet is not in temporary sheet view mode.")}chb(){this.kEc&&
(this.WRg(!1),this.kEc=!1);this.olf()}ULb(qc,Lc){var bd;Lc&&Yb.ULS.sendTraceTag(507839433,dc.a.zpb,Uc.a.warning,"SheetViewEntryCallout.detachShowCalloutListeners: detaching without showing callout.");this.$.ea.LSc(this.ULb);null===(bd=this.$.sa)||void 0===bd?void 0:bd.kge(this.showCallout);this.$.ea.Xza(this.showCallout)}olf(){this.$.ea.LSc(this.chb);this.$.sa.hn(this.chb)}WRg(qc){appChrome.showOrHideSheetViewEntryCallout(this.mIj,{showCallout:qc,calloutId:this.R9e,anchor:this.Yx,restoreFocus:this.Vha})}get Pi(){return document.getElementById(this.R9e)}get Co(){return le.DOMElementExtensions.isVisible(this.Pi)}get Hk(){return kb.a.UOg}zp(qc,
Lc){if(Lc)return!1;qc=this.Pi.querySelectorAll(le.DOMElementExtensions.zI);let bd;for(Lc=0;Lc<qc.length;Lc++){const jd=qc[Lc];le.DOMElementExtensions.Co(jd)&&(bd=jd)}if(!bd)return Yb.ULS.sendTraceTag(508117186,dc.a.zpb,Uc.a.error,"SheetViewEntryCallout.SetFocusOnSection: Could not find focusable element in SheetViewEntryCallout"),!1;bd.focus();return!0}Yp(qc){return le.DOMElementExtensions.Cn(this.Pi,qc)}gs(){}Xt(){}}Object(l.a)(cc,"SheetViewEntryCallout",null,[59,2]);let mc=class{constructor(qc){this.$=
qc;this.Ibb=!1;this.toe=null;this.oTb=Fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NsvEntryOptimizationApplyForEveryone",!1);this.kVd=Fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DisableSortFilterNSVEntryInSelfCoauthor",!1);this.HNc=(Lc,bd)=>{var jd;Lc=null===(jd=bd.Wl)||void 0===jd?void 0:jd.operation;0===bd.By&&Lc&&Lc.operationName===this.MZd&&(this.WWb=Lc,this.$.userOperationManager.Hv(this.HNc))};this.toe=new cc(this.$);this.HNc=this.HNc.bind(this)}dispose(){this.toe=
this.$=this.MZd=this.WWb=this.PIc=null}Bi(){return!1}ni(qc,Lc){switch(Lc.command){case -1062729243:return!0;default:return!1}}executeCommand(qc,Lc){qc=Lc.command;switch(qc){case -1062729243:return this.applyLastSortFilterInDefaultView(Lc.lk)}return n.a(qc)}Ji(){return!1}DHd(){return{isVisible:this.MTf(),isChecked:this.Ibb}}xXk(){this.Ibb=!this.Ibb;Yb.ULS.sendTraceTag(508180431,0,50,`SortFilterManager::toggleShouldApplySortFilterForEveryone: Apply for everyone value updated to ${this.Ibb}`)}PMa(qc,
Lc,bd,jd,Yd){Yb.ULS.sendTraceTag(508180430,0,50,`SortFilterManager::performAction: Performing sort filter action. Caller: ${bd}`);this.Tsk(qc,jd,Yd);return this.HGk?(qc(),B.Task.Va(!0)):this.Kii(qc,Lc)}get HGk(){if(this.MTf())return this.Ibb;const qc=this.$.sa.na;return!Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8421225_NamedSheetViewUpdateDisableCommandsBasedOnRealTimeView")||!this.$.ea.th.allowViewCollab||null!==qc&&void 0!==qc&&qc.Kj.Ow?!0:!1}MTf(){const qc=this.$.sa.na;return this.oTb&&this.$.ea.Xaa&&
!(null===qc||void 0===qc?0:qc.Kj.Ow)&&(this.kVd?this.$.ea.OSd()||!this.$.ea.e_&&this.$.ea.H0f():this.$.ea.eU)&&!Object(Ha.e)(this.$)&&!this.$.ea.th.allowViewCollab}Kii(qc,Lc){const bd={[Da.a.Z3d]:!1},jd=Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8336194_FUseNewNsvCreateCommand")?2052531625:-2050946363;Lc=this.$.Ma.dh(new Ya.a(jd,Ea.a.eh,2,Lc,null),bd);Lc.continueWith(Yd=>{!sa.a(Yd)&&Yd.result&&(qc(),(Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8421225_NamedSheetViewUpdateDisableCommandsBasedOnRealTimeView")?
!this.$.ea.th.allowViewCollab:1)?this.toe.uMk():Yb.ULS.sendTraceTag(508044257,0,50,"SortFilterManager::enterNamedSheetViewAndPerformAction: showNamedSheetViewEntryCallout skipped in view collab mode."))});return Lc}applyLastSortFilterInDefaultView(qc){this.Ibb=!0;var Lc=B.Task.Va(!0);const bd=this.$.sa.na;(null===bd||void 0===bd?0:bd.Kj.Ow)?(Lc={[Da.a.Dag]:!0},Lc=this.$.Ma.dh(new Ya.a(1690118309,Ea.a.eh,2,qc,null),Lc),Lc.continueWith(jd=>{jd.isCompleted&&this.Uxg()})):this.Uxg();return Lc}Tsk(qc,
Lc,bd){this.MZd=this.WWb=this.PIc=null;this.PIc=Lc?Lc:bd?this.iSi(bd):qc}iSi(qc){this.MZd=qc;this.$.userOperationManager.px(this.HNc);return()=>{this.WWb?this.$.userOperationManager.enqueueOperation(this.WWb,this.WWb.Ah):Yb.ULS.sendTraceTag(507901280,0,10,"SortFilterManager::getReapplyActionFromOperationName: lastSortFilterOperation is null.")}}Uxg(){this.PIc?this.PIc():Yb.ULS.sendTraceTag(507901279,0,10,"SortFilterManager::reapplyLastSortFilterAction: lastSortFilterReapplyAction is null.")}};mc=
Object(w.__decorate)([Object(C.d)(z.Zf),Object(w.__param)(0,Object(z.Lb)())],mc);Object(l.a)(mc,"SortFilterManager",null,[245,39,2]);let Sa=class{constructor(qc){this.Wp=qc}executeCommand(qc,Lc,bd){return 2!==this.Wp.Xj(v.a.tryOfficeThroughTellMe,2,bd)?B.Task.Va(!0):n.a(Lc.command)}ni(qc,Lc){return 215809929===Lc.command}Ji(){return!1}Bi(){return!1}};Sa=Object(w.__decorate)([Object(C.d)(z.sg),Object(w.__param)(0,Object(z.f)())],Sa);Object(l.a)(Sa,"TryOfficeThroughTellMeCommandHandler",null,[39]);
var pb=a(278),Ac=a(586),yd=a(9),vb=a(894),Sc=a(79);class hd extends vb.a{constructor(qc){super(qc)}Qs(){const qc=Sc.GetServiceTaskFactory.create(this.$.ka,203,this.xa,this.hh);M.TaskExtensions.Ua(M.TaskExtensions.Ln([qc],this.xa),()=>{this.cr([new xa(this.$)])},this.xa,3)}static Aa(qc){qc.ea.sn.get(61)&&vb.a.sx(215,new hd(qc))}}Object(l.a)(hd,"MsFormCommandHandlerFactory",vb.a,[]);Type.registerNamespace("Common.App.NewAndOpen.UX");pb.a.instance.Lo(new Lb);Ac.a.gw(".MsformCalloutContent{color:#fff;font-size:13pt;line-height:1;padding-right:5px;margin-bottom:12px;margin-top:-6px;padding-left:10px;width:90%}.MsFormCalloutOuter{background-color:#107c41;z-index:1030}");
(()=>{yd.a.Qg(qc=>{z.Ld.Ha()||hd.Aa(qc)})})();String(c);String(b);String(f);String(r);String(d);String(k);String(t);String(Fd);String(m);String(e);window.___1708742503466_closurehack=c;window.___1708742503466_closurehack=b;window.___1708742503466_closurehack=f;window.___1708742503466_closurehack=r;window.___1708742503466_closurehack=d;window.___1708742503466_closurehack=k;window.___1708742503466_closurehack=t;window.___1708742503466_closurehack=Fd;window.___1708742503466_closurehack=m;window.___1708742503466_closurehack=
e}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.kmhv.js.map/6221780947f98ab8b7688d31cdc70a3f/EwaTS.kmhv.js.map