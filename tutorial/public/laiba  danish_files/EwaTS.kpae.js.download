'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[5],{1138:function(y,x,a){function c(){return"undefined"===typeof f.globalThis.o4c?r:f.globalThis.o4c()}function b(d,k){var t;return null!==(t=c()[d])&&void 0!==t?t:k}Object.defineProperty(x,"__esModule",{value:!0});x.setFeatureGateDictionaryGetter=x.getIntFeatureGate=x.DGf=x.getBooleanFeatureGate=x.getStringFeatureGate=x.IPb=void 0;var f=a(1336),r={};x.IPb=c;x.getStringFeatureGate=b;x.getBooleanFeatureGate=function(d,
k){var t;d=null===(t=b(d))||void 0===t?void 0:t.trim().toLowerCase();return"true"===d?!0:"false"===d?!1:k};x.DGf=function(d,k){var t;d=null===(t=b(d))||void 0===t?void 0:t.trim().toLowerCase();if(void 0===d)return k;if("infinity"===d||"+infinity"===d)return Infinity;if("-infinity"===d)return-Infinity;t=parseFloat(d);return isNaN(t)?k:t};x.getIntFeatureGate=function(d,k){var t;d=null===(t=b(d))||void 0===t?void 0:t.trim();if(void 0===d)return k;t=parseInt(d,10);return isNaN(t)?k:t};x.setFeatureGateDictionaryGetter=
function(d){var k=f.globalThis.o4c;f.globalThis.o4c=d;return k}},1139:function(y,x,a){function c(){return"undefined"===typeof b.globalThis.n4c?{}:b.globalThis.n4c()}Object.defineProperty(x,"__esModule",{value:!0});x.setChangeGateDictionaryGetter=x.isChangeGateEnabled=x.Sxc=void 0;var b=a(1336);x.Sxc=c;x.isChangeGateEnabled=function(f){var r;return null!==(r=c()[f])&&void 0!==r?r:!0};x.setChangeGateDictionaryGetter=function(f){var r=b.globalThis.n4c;b.globalThis.n4c=f;return r}},1336:function(y,x,
a){Object.defineProperty(x,"__esModule",{value:!0});x.globalThis=void 0;y=a(1473);x.globalThis=y},1472:function(y,x,a){Object.defineProperty(x,"__esModule",{value:!0});var c=a(179);c.__exportStar(a(1138),x);c.__exportStar(a(1476),x);c.__exportStar(a(1139),x);c.__exportStar(a(1477),x);c.__exportStar(a(1478),x);c.__exportStar(a(1479),x)},1473:function(y,x,a){y.exports=a(1474)()?globalThis:a(1475)},1474:function(y){y.exports=function(){return"object"===typeof globalThis&&globalThis?globalThis.Array===
Array:!1}},1475:function(y){function x(){if("object"===typeof self&&self)return self;if("object"===typeof window&&window)return window;throw Error("Unable to resolve global `this`");}y.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(a){return x()}try{return __global__?__global__:x()}finally{delete Object.prototype.Bgl}}()},1476:function(y,x,a){Object.defineProperty(x,"__esModule",{value:!0});x.gBj=
void 0;var c=a(1138);x.gBj=function(b){return function(f){var r=b[f];switch(typeof r){case "boolean":return(0,c.getBooleanFeatureGate)(f,r);case "number":return(0,c.DGf)(f,r);case "string":return(0,c.getStringFeatureGate)(f,r);default:throw Error("Wrong defaultValue type");}}}},1477:function(y,x,a){Object.defineProperty(x,"__esModule",{value:!0});x.nBj=void 0;var c=a(1139);x.nBj=function(){return function(b){return(0,c.isChangeGateEnabled)(b)}}},1478:function(y,x,a){function c(r){var d=(0,f.setChangeGateDictionaryGetter)(void 0);
(0,f.setChangeGateDictionaryGetter)(function(){var k=void 0!==d?d():{};return b.__assign(b.__assign({},k),r)});return d}Object.defineProperty(x,"__esModule",{value:!0});x.h0j=x.$_j=void 0;var b=a(179),f=a(1139);x.$_j=c;x.h0j=function(r,d){return c(d)}},1479:function(y,x,a){function c(r){function d(){return{}}for(var k,t,m={},e=0,w=Object.keys(r);e<w.length;e++){var l=w[e];m[l]=null===(k=r[l])||void 0===k?void 0:k.toString()}var u=null!==(t=(0,f.setFeatureGateDictionaryGetter)(void 0))&&void 0!==t?
t:d;(0,f.setFeatureGateDictionaryGetter)(function(){return b.__assign(b.__assign({},u()),m)});return u}Object.defineProperty(x,"__esModule",{value:!0});x.i0j=x.e0j=void 0;var b=a(179),f=a(1138);x.e0j=c;x.i0j=function(r,d){return c(d)}},210:function(y,x,a){function c(Ab){if(window&&window.performance&&window.performance.mark)try{window.performance.mark(Ab)}catch(xc){}}function b(){return{show:{count:0,repairCounts:[]},hideDurations:{escape:[],ignore:[],selection:[],edit:[],commit:[],scroll:[]},hide:{escape:0,
ignore:0,selection:0,edit:0,commit:0,scroll:0}}}a.r(x);var f={};a.r(f);a.d(f,"AutoSumCommandHandler",function(){return ra});var r={};a.r(r);a.d(r,"CellImageToFloatingObjectController",function(){return lb});var d={};a.r(d);a.d(d,"ClearCommandHandler",function(){return Yb});var k={};a.r(k);a.d(k,"ClearContentNotifier",function(){return Qc});var t={};a.r(t);a.d(t,"DefinedNameManager",function(){return ya});var m={};a.r(m);a.d(m,"FileCollectionOperation",function(){return Mb});var e={};a.r(e);a.d(e,
"FloatingObjectToCellImageController",function(){return xd});var w={};a.r(w);a.d(w,"FontDropdownHelper",function(){return oc});var l={};a.r(l);a.d(l,"FormatCellsCommandHandler",function(){return yd});var u={};a.r(u);a.d(u,"FormulaAnonymizer",function(){return vb});var n={};a.r(n);var v={};a.r(v);a.d(v,"FormulaRepairTelemetry",function(){return Ee});var B={};a.r(B);a.d(B,"FreezePanesDragDirection",function(){return Nf});a.d(B,"FreezePaneDragAction",function(){return Zf});var z={};a.r(z);a.d(z,"FreezePanesCommandHandler",
function(){return ce});var C={};a.r(C);a.d(C,"HeaderInsert",function(){return Xc});var D={};a.r(D);a.d(D,"ImageInCellCommandHandler",function(){return Pe});var J={};a.r(J);a.d(J,"NameManagerCommandHandler",function(){return yb});var W={};a.r(W);a.d(W,"OfficePyUXCommandHandler",function(){return vd});var N=a(179),M=a(0),Q=a(14),R=a(229),O=a(62);const U=(Ab,xc,eb,Ub,Fc,rd)=>{if(xc){const Gd=Ab.$b;Ab.isEditing||Ab.startEdit(xc,!0);Ab.RVd=!0;Ab.text=eb;Gd.caretPosition=Fc;Fc<rd&&(Ub&&Ab.ZOa(),Gd.selectRange(0,
rd+1),Gd.selectRange(Fc,rd))}};var K=a(69);class F{constructor(Ab,xc){this.sharedSheetRange=null;this.type=0;this.sharedSheetRange=Ab;this.type=xc}fkb(){return this.sharedSheetRange}}Object(M.a)(F,"MacroRecorderAutoSumPayload",null,[65]);var I=a(45),P=a(419),Y=a(212),ea=a(79),Ba=a(40),Fa=a(356),za=a(35),xa=a(1),fa=a(209),V=a(262),ba=a(24),la=a(141),Ta=a(659),Ea=a(66),sa=a(5),Ya=a(97),bb=a(93);let ra=class extends R.a{constructor(Ab){super();this.zKj=xc=>{const eb=ba.f(this.$);if(xc=xc.Result){let Ub=
I.G(xc.NewSelection),Fc=I.G(xc.NewActiveCell);if(Ub&&Fc)if(!xc.Committed&&xc.AutoSumFormula){const rd=eb.kh(Fc);rd&&(eb.ha.updateSelection(Ub,Fc,60),Ub=Fc=I.G(xc.MarkedArea),eb.eM=2,U(eb.cellTextEditBox,rd,xc.AutoSumFormula,!!Ub,xc.FormulaMarkStart,xc.FormulaMarkEnd),Ub&&Fc&&eb.ha.updateSelection(Ub,Fc,0),Ba.TaskExtensions.Ua(xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)?Object(bb.d)(Ya.a.resolve(sa.l,{va:0})):ea.GetServiceTaskFactory.Bj(this.$.ka,211,
212,0),Gd=>{Gd.result.xba(eb.cellTextEditBox.text)},this.$.xa,3),eb.cellTextEditBox.RVd=!1,void Ya.a.resolve(sa.Rc,{va:0}).then(Gd=>{Gd.Jhb(null)}))}else eb.ha.updateSelection(Ub,Fc,60)}};this.$=Ab}Bi(){return!1}executeCommand(Ab,xc,eb){Ab=xc.command;switch(Ab){case 1220954656:case 505713221:xc=this.Umf(0,xc);break;case -1537138325:xc=this.Umf(parseInt(eb[K.a.Ai].toString(),10),xc);break;default:xc=fa.a(Ab)}return xc}ni(Ab,xc){if(Ab=1===Ab)switch(xc.command){case 1220954656:case 505713221:case -1537138325:break;
default:Ab=!1}return Ab}Ji(){return!1}Umf(Ab,xc){const eb=ba.f(this.$);eb.Um.MT(!1);if(!ba.f(this.$).ha.qa.Gn)return xc=ba.f(this.$).ha.qa.aS,Q.ULS.sendTraceTag(537170308,0,50,`AutoSumCommandHandler.DoAutoSum: Unhandled AutoSum of type ${Ab} due to discontinuous selection. Number of selected ranges is ${xc}`),this.XMa(),Ea.Task.Va(!1);const Ub=eb.jK();if(!Ub)return null;const Fc=I.w(eb.ha.qa.Ui,this.$),rd=I.p(eb.ha.qa.activeCell,this.$),Gd=I.p(Ub,this.$),ue=this.$.pa.ta.Jh(),Ce=()=>new F(Fc,Ab);return this.$.cy(eb.ha.qa.selectedRanges,
!0)?P.a(this.$.userOperationManager,(Se,of,jf)=>{var bf=this.$.pa.ta;Se=V.c(Se,this.zKj);const pf=bf.Za(9,ue);pf.selectedRange=Fc;pf.activeCell=rd;pf.autoSumType=Ab;pf.topLeftCell=Gd;return O.h(bf,"AutoSum",pf,Se,of,jf,Ab,0)},Se=>new Y.a(502,0,Se,64,Ce),xc):Ea.Task.Va(!1)}XMa(){Ta.a(la.a.discontinuousSelectionBlocking,["OtherICE"],!0,!0,!1,!1,null);const Ab=za.a.Yi(1,1,751,2192,0,371863010,"DiscontinuousSelectionBlocking");new Fa.a(this.$,Ab)}};ra=Object(N.__decorate)([Object(Ya.d)(sa.t),Object(N.__param)(0,
Object(sa.Lb)())],ra);Object(M.a)(ra,"AutoSumCommandHandler",R.a,[39]);var Da=a(80),oa=a(765),Ha=a(180),ka=a(34),wa=a(902),Za=a(12),ab=a(86),db=a(386),mb=a(125),Ia=a(2),pa=a(161);let lb=class extends Da.a{constructor(Ab,xc,eb,Ub){super();this.fj=()=>{this.button.getButton(this.da.Pg.ro(this.da.ha.qa.activeCell)).Nrb();Ha.a.sendTelemetryEvent(Object(Ia.a)(new db.a,{name:"Office.Excel.Online.OnObjectUI.ButtonPressed",dataFields:mb.a.rn({["buttonType"]:"CellImageToFloatingObject"})}));const Fc=new ab.a(2000316912,
K.a.eh,this.$.Rh,9,null);this.$.Ma.dh(Fc,null)};this.Am=()=>{this.Zba()};this.Rp=()=>{this.Zba()};this.oE=()=>{this.Zba()};this.zy=()=>{this.Zba()};this.en=()=>{this.PX()};this.xu=()=>{this.PX()};this.kA=()=>{this.Zba()};this.$=Ab;this.button=eb.NKb(Ab,xc,this.fj,null,null,Za.a.instance.ia(2318),"CellImageToFloatingObjectPointerDown");this.isVisible=!1;this.da=ba.f(this.$);this.da.ha.VW(this.Am);this.da.sh.FQ(this.en);this.da.Mz(this.oE);this.$.hI(this.Rp);xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8726584_DisablePictureOOUIForViewMode")&&
this.$.ea.JJ(this.kA);this.da.view.Wy(this.zy);this.da.ha.$e.MN(this.xu);this.ariaLiveNotifier=Ub}dispose(){this.da&&(this.da.ha.UY(this.Am),this.da.view.Kx(this.zy),this.da.xE(this.oE),this.da.ha.$e.sV(this.xu),this.da.sh&&this.da.sh.nS(this.en));this.$&&(this.$.LK(this.Rp),xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8726584_DisablePictureOOUIForViewMode")&&this.$.ea.GH(this.kA));this.button.dispose();this.ariaLiveNotifier=this.$=this.da=this.button=null;super.dispose()}tkd(){this.isVisible&&this.fj(null,
null)}Zba(){if(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8726584_DisablePictureOOUIForViewMode")&&!this.$.isEditMode)this.PX();else{xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8478102_HideOOUIOnFloatingObjectSelected")&&this.da.ha.$e.isFloatingObjectSelected&&this.PX();var Ab=this.da.ha.qa.activeCell;if(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8495249_DisableOOUIOnProtectedSheet")){var xc=new pa.a(this.$.sa);if(xc&&xc.Dn&&(xc.j_f(Ab,this.da)||!xc.Hj(1))){this.PX();return}}xc=this.da.za.yx(Ab);
null!=xc&&xc.GZa?this.oqa(Ab):this.PX()}}oqa(Ab){const xc=this.da.Pg.ro(Ab);Ab=this.da.ml(Ab,xc);const eb=this.da.Zk(xc).vr;var Ub=this.da.ha.qa.activeCell;if(!(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8352188_DisableInCellOOUIForFormulaBasedImage")&&Ub&&this.da.Yg.yTb(Ub)&&this.da.Yg.ESd(Ub)||xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8352225_DisableInCellOOUIForPivotTable")&&this.da.Yg.aY(Ub)))if(1===this.da.ha.wk&&Ab&&Ab.yi(eb)&&eb.width>Ab.width){Ub=Ab.bottomRight.x+this.iE;let Fc=Ab.topLeft.y-
this.iE-this.button.buttonWidth;Ub+this.button.buttonWidth>eb.bottomRight.x&&(Ub=Ab.topLeft.x-this.iE-this.button.buttonWidth);Fc<eb.topLeft.y+this.iE&&(Fc=eb.topLeft.y+this.iE);this.Ft(Ub,Fc,this.da.rtl,xc)}else this.PX()}Ft(Ab,xc,eb,Ub){this.button.r1c(wa.a.fcj,Za.a.instance.ia(2318),Ub);this.button.S0c(Za.a.instance.ia(2318),Ub);this.button.Ft(Ab,xc,eb,Ub,!1,!0);this.isVisible=!0;this.CDh()}PX(){this.button.hide();this.isVisible=!1}CDh(){let Ab;Ab=ka.a.isMac?Za.a.instance.ia(2321):Za.a.instance.ia(2320);
this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.xba(Ab)}get iE(){return this.button.iE}};lb=Object(N.__decorate)([Object(Ya.d)(sa.L),Object(N.__param)(0,Object(sa.Lb)()),Object(N.__param)(1,Object(oa.m)()),Object(N.__param)(2,Object(sa.Cf)()),Object(N.__param)(3,Object(sa.l)())],lb);Object(M.a)(lb,"CellImageToFloatingObjectController",Da.a,[]);var ha=a(188),ua=a(242),fb=a(38),Ka=a(1271),La=a(252),ib=a(64);let Yb=class extends fb.a{constructor(Ab,xc,eb,Ub){super();this.$=Ab;this.Cj=xc;this.ek=
eb;this.clearContentNotifier=Ub;this.MLj=(Fc,rd)=>{if(!La.a(Fc)&&rd){const Gd=!!Fc&&!!Fc.RequestTelemetryData;ba.f(this.$).nk.V0(rd.toString(),Fc.StateId,Gd?Fc.RequestTelemetryData.EcsOperationDuration:0,Gd?Fc.RequestTelemetryData.EcsRequestDuration:0,Gd?Fc.RequestTelemetryData.WfeRequestDuration:0)}}}Bi(){return!1}executeCommand(Ab,xc){Ab=xc.command;switch(Ab){case -730106152:xc=this.KNd(xc,3);break;case -1228228458:xc=this.KNd(xc,4);break;case -848953656:case 2045211913:if(this.Qmj()){xc=Ea.Task.Va(!0);
break}xc=this.KNd(xc,1);break;default:xc=fa.a(Ab)}return xc}ni(Ab,xc){if(Ab=1===Ab)switch(xc.command){case -730106152:case -1228228458:case -848953656:case 2045211913:break;default:Ab=!1}return Ab}Ji(){return!1}KNd(Ab,xc){const eb=ba.f(this.$),Ub=eb.ha.qa.selectedRanges,Fc=Ab.command,rd=ha.a.create().toString();if(!this.$.cy(Ub,!0)&&-730106152!==Fc)return Ea.Task.Va(!0);const Gd=I.s(Ub,this.$);this.cMk(Fc,eb,Ub,rd);xa.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&
this.clearContentNotifier.U9j();const ue=this.$.pa.ta.Jh({Cya:!0,ixa:1}),Ce=()=>new Ka.a(xc,Gd);return P.a(this.$.userOperationManager,(Se,of,jf)=>{this.$.AD();return O.d(this.$.pa.ta,xc,Gd,!1,V.c(Se,this.MLj),of,jf,rd,ue)},Se=>new Y.a(508,0,Se,67,Ce),Ab)}cMk(Ab,xc,eb,Ub){if(-848953656!==Ab&&2045211913!==Ab&&-730106152!==Ab&&-1228228458!==Ab)Q.ULS.sendTraceTag(537167938,0,10,`ClearCommandHandler.ShowInstantaneousClear: Unexpected command ${Ab}.`);else if(!ua.a.any(eb,rd=>0<xc.getRangeInformation(rd).length)){var Fc=
ua.a.any(eb,rd=>this.Cj.rXd(rd));if(-730106152!==Ab&&-1228228458!==Ab||!Fc)this.CQk(xc,Ab,Ub,eb),-730106152!==Ab&&-1228228458!==Ab||this.ek.qqa(xc,-730106152,{}),-1228228458!==Ab&&2045211913!==Ab&&-848953656!==Ab||this.ek.Ktd(eb,!0,Ub),xc.nk.JS(Ub,ib.BasicTelemetryCalculator.uR)}}CQk(Ab,xc,eb,Ub){let Fc="";switch(xc){case -1228228458:Fc="ClearAll";break;case 2045211913:case -848953656:Fc="ClearContent";break;case -730106152:Fc="ClearFormat";break;default:Q.ULS.sendTraceTag(537167937,0,15,`ClearCommandHandler.StampTimeWithCompatibleDescription: Unexpected command ${xc}.`)}xc=
Ub.length;Ub=I.b(Ub);Ab.nk.KP(15,eb,Fc+(", ranges to clear: "+xc+", cells to clear: "+Ub))}Qmj(){if(ba.f(this.$).iH){const Ab=this.$.ka.Ug(296);return!!Ab&&Ab.y4.tK}return!1}};Yb=Object(N.__decorate)([Object(Ya.d)(sa.U),Object(N.__param)(0,Object(sa.Lb)()),Object(N.__param)(1,Object(sa.hg)()),Object(N.__param)(2,Object(sa.sc)()),Object(N.__param)(3,Object(sa.V)())],Yb);Object(M.a)(Yb,"ClearCommandHandler",fb.a,[39]);var Wc=a(365);let Qc=class extends fb.a{mmd(Ab){this.addHandler("ekcvc",Ab)}ySc(Ab){this.removeHandler("ekcvc",
Ab)}U9j(){this.raiseEvent("ekcvc",new Wc.a)}};Qc=Object(N.__decorate)([Object(Ya.d)(sa.V)],Qc);Object(M.a)(Qc,"ClearContentNotifier",fb.a,[536]);var Wb=a(122),Jc=a(75),ma;(function(Ab){Ab[Ab.NameManagerListView=0]="NameManagerListView";Ab[Ab.NameManagerItemView=1]="NameManagerItemView";Ab[Ab.NameManagerMultiSelectView=2]="NameManagerMultiSelectView";Ab[Ab.NameManagerClosedView=3]="NameManagerClosedView";Ab[Ab.NameManagerErrorView=4]="NameManagerErrorView"})(ma||(ma={}));var Hc;(function(Ab){Ab[Ab.Workbook=
0]="Workbook";Ab[Ab.Sheet=1]="Sheet"})(Hc||(Hc={}));var Kb;(function(Ab){Ab[Ab.NameInput=0]="NameInput";Ab[Ab.ReferenceInput=1]="ReferenceInput";Ab[Ab.CommentInput=2]="CommentInput"})(Kb||(Kb={}));var pc;(function(Ab){Ab[Ab.NamedRange=0]="NamedRange";Ab[Ab.Table=1]="Table";Ab[Ab.NamedFormula=2]="NamedFormula";Ab[Ab.NamedConstant=3]="NamedConstant";Ab[Ab.Lambda=4]="Lambda";Ab[Ab.TableSlicer=5]="TableSlicer";Ab[Ab.PrintArea=6]="PrintArea";Ab[Ab.Others=7]="Others"})(pc||(pc={}));var $b;(function(Ab){Ab[Ab.ASC=
0]="ASC";Ab[Ab.DESC=1]="DESC"})($b||($b={}));var Ib;(function(Ab){Ab[Ab.Default=0]="Default";Ab[Ab.Name=1]="Name";Ab[Ab.Scope=2]="Scope"})(Ib||(Ib={}));var Zb;(function(Ab){Ab[Ab.Workbook=0]="Workbook";Ab[Ab.Worksheets=1]="Worksheets";Ab[Ab.withErrors=2]="withErrors";Ab[Ab.withoutErrors=3]="withoutErrors";Ab[Ab.DefinedNames=4]="DefinedNames";Ab[Ab.TableNames=5]="TableNames"})(Zb||(Zb={}));class Eb{}Eb.x8k="utf-8";Eb.FPi="GetOperationTimer";Eb.y$h="DeleteOperationTimer";Eb.O7k="UpsertOperationTimer";
Eb.g9h=[pc.NamedRange,pc.Table,pc.PrintArea,pc.Others];Eb.AFj=[0];Eb.Rtk=[0,1];Object(M.a)(Eb,"ConstantsDefinedNameManager",null,[]);class ob extends Sys.EventArgs{constructor(Ab,xc,eb,Ub){Ub=void 0===Ub?!1:Ub;super();this.status=Ab;this.operationType=xc;this.Iub=eb;this.Dkj=Ub}}Object(M.a)(ob,"DefinedNameOperationEventArgs",Sys.EventArgs,[]);var Na=a(65);class nb{static create(Ab){const xc=new nb;Object.assign(xc,Ab);return Na.a.li(xc)}}Object(M.a)(nb,"NameManagerTelemetryData",null,[]);class Hb{static mE(Ab,
xc){(Ab||xc)&&Q.ULS.sendTraceTag(507581128,0,Ab,xc)}static Mma(Ab){switch(Ab){case "success":return 50;case "successWithServerException":case "failure":return 10}}}Object(M.a)(Hb,"NameManagerTelemetry",null,[]);var na=a(27);const Gb={namedrange:pc.NamedRange,table:pc.Table,others:pc.Others,print_area:pc.PrintArea},Xa={global:0,local:1},Jb=[1546370075,472177316,-1818810228,-201732986],qb={[0]:Ab=>0===Ab.scope,[1]:Ab=>1===Ab.scope,[2]:Ab=>Ab.isInvalidReference,[3]:Ab=>!Ab.isInvalidReference,[4]:Ab=>
Ab.type===pc.NamedRange,[5]:Ab=>Ab.type===pc.Table},Db=(Ab,xc,eb,Ub,Fc)=>{Ab=Object.assign({},{method:`NameManagerUtils.${eb}`,executionTime:xc-Ab},Ub&&{input_length:Ub},Fc&&{output_length:Fc});Q.ULS.sendTraceTag(507581578,0,50,Na.a.li(Ab))};class gb{static x4i(Ab,xc,eb,Ub,Fc){return void 0===Ub&&0!==(null===Ab||void 0===Ab?void 0:Ab.length)&&0!==(null===xc||void 0===xc?void 0:xc.length)?!0:Ub&&Ab&&xc&&Fc?(Fc=Fc.find(rd=>rd.runtimeUid===Ub))?(null===Fc||void 0===Fc?void 0:Fc.name)!==Ab||(null===Fc||
void 0===Fc?void 0:Fc.reference)!==xc||(null===Fc||void 0===Fc?void 0:Fc.comment)!==eb:!1:!1}static vOi(Ab){return void 0!==Ab?Gb[Ab.toLowerCase()]:null}static xTi(Ab){return void 0!==Ab?Xa[Ab.toLowerCase()]:null}static search(Ab,xc){if(!Ab||0===Ab.length||!xc)return Ab;const eb=performance.now(),Ub=Ab.filter(rd=>rd.name.toLowerCase().includes(xc.toLowerCase().trim())),Fc=performance.now();Db(eb,Fc,"search",Ab.length,Ub.length);return Ub}static uHi(Ab,xc){return null!==Ab&&void 0!==Ab&&Ab.length&&
null!==xc&&void 0!==xc&&0!==xc.length?Ab.find(eb=>eb.runtimeUid===xc):null}static ILi(Ab,xc){return null!==Ab&&void 0!==Ab&&Ab.length&&null!==xc&&void 0!==xc&&0!==xc.length?Ab.findIndex(eb=>eb.metadata.runtimeUid===xc):-1}static gXc(Ab){return Ab?Jb.includes(Ab):!1}static QIi(Ab){if(!Ab||!Ab.Iub||Ab.status)return null;const xc=[];let eb;if(gb.gXc(Ab.Iub))switch(null===Ab||void 0===Ab?void 0:Ab.Iub){case 472177316:xc.push({target:1,errorMessage:Za.a.instance.Ba(912)});break;case 1546370075:xc.push({target:0,
errorMessage:Za.a.instance.Ba(911)});break;case -1818810228:eb=Za.a.instance.Ba(1008);break;default:eb=gb.VCf(Ab.operationType)}return{Cag:xc,J8b:eb}}static VCf(Ab){if(Ab)switch(Ab){case "add":return Za.a.instance.Ba(905);case "update":return Za.a.instance.Ba(906);case "delete":return Za.a.instance.Ba(907)}return null}static b$k(Ab,xc,eb,Ub,Fc){const rd=[];let Gd;Fc!==pc.Table&&(Gd=gb.zQh(eb,Ab));Ab=gb.xQh(Ub);xc=gb.yQh(xc);Gd&&rd.push(Gd);Ab&&rd.push(Ab);xc&&rd.push(xc);return rd}static QLd(Ab){return Ab&&
1===Ab.length?Ab[0].MessageId:null}static yQh(Ab){let xc;var eb;if(!(eb=!Ab||0===(null===Ab||void 0===Ab?void 0:Ab.length)||255<(null===Ab||void 0===Ab?void 0:Ab.length))){a:{for(eb=0;eb<Ab.length;eb++){const Ub=Ab.charAt(eb),Fc=Ab.charCodeAt(eb);if(!eb){if("\\"!==Ub&&"_"!==Ub&&!na.a.isLetter(Fc)){eb=!1;break a}}else if("_"!==Ub&&"."!==Ub&&!na.a.JXf(Fc)&&!na.a.isNumeral(Fc)){eb=!1;break a}}eb=!0}eb=!eb}if(eb||na.a.aL(Ab,"_xl"))xc=Za.a.instance.Ba(910);return xc?{target:0,errorMessage:xc}:null}static xQh(Ab){let xc;
255<(null===Ab||void 0===Ab?void 0:Ab.length)&&(xc=Za.a.instance.Ba(914));return xc?{target:2,errorMessage:xc}:null}static zQh(Ab,xc){if(Ab&&0===Ab.length)Ab=Za.a.instance.Ba(912);else switch(xc(Ab)){case "valid":return null;case "notFormulaString":Ab=Za.a.instance.Ba(913);break;default:Ab=Za.a.instance.Ba(912)}return{target:1,errorMessage:Ab}}static filterBy(Ab,xc){if(!Ab||0===Ab.length||void 0===xc)return Ab;const eb=performance.now();xc=Ab.filter(qb[xc]);const Ub=performance.now();Db(eb,Ub,"filterBy",
Ab.length,xc.length);return xc}static K_h(Ab){const xc={[0]:0,[1]:0,[2]:0,[3]:0,[4]:0,[5]:0};if(!Ab||0===Ab.length)return xc;const eb=performance.now();for(var Ub of Ab)for(const Fc in qb)qb[Fc](Ub)&&xc[Fc]++;Ub=performance.now();Db(eb,Ub,"countByFilter",Ab.length);return xc}static groupBy(Ab,xc,eb){const Ub={};xc.forEach(Fc=>{Ub[Fc]=[]});for(const Fc of Ab)Ab=eb(Fc),Ub[Ab].push(Fc);return Ub}static WKi(Ab){switch(Ab){case 0:return{CNd:Eb.g9h,DNd:xc=>xc.type};case 1:return{CNd:Eb.AFj,DNd:()=>0};case 2:return{CNd:Eb.Rtk,
DNd:xc=>xc.scope}}}static sort(Ab,xc){switch(xc){case 0:return Ab.sort((eb,Ub)=>eb.name.localeCompare(Ub.name));case 1:return Ab.sort((eb,Ub)=>Ub.name.localeCompare(eb.name))}}static BNd(Ab,xc,eb){if(!Ab||0===Ab.length||void 0===xc||void 0===eb)return Ab;const Ub=performance.now(),{CNd:Fc,DNd:rd}=gb.WKi(xc),Gd=gb.groupBy(Ab,Fc,rd),ue=[];Fc.forEach(Ce=>{ue.push(...gb.sort(Gd[Ce],eb))});xc=performance.now();Db(Ub,xc,"groupAndSortBy",Ab.length,ue.length);return ue}static L_h(Ab){if(!Ab)return null;const xc=
{};Ab.forEach(eb=>{const Ub=eb.scope;eb=eb.metadata.type;xc[Ub]||(xc[Ub]={});xc[Ub][eb]||(xc[Ub][eb]=0);xc[Ub][eb]++});return xc}}Object(M.a)(gb,"NameManagerUtils",null,[]);let ya=class{constructor(Ab,xc){this.Og=new fb.a;this.stateId=0;this.gAh=eb=>{this.Og.addHandler("dnek",eb)};this.aYd=eb=>this.Ej.aYd(eb);this.ol=()=>{var eb;const Ub=null===(eb=this.$.ea.Cq)||void 0===eb?void 0:eb.NamedManagerResponseStateId;Ub>this.stateId&&(this.stateId=Ub,Q.ULS.sendTraceTag(507639444,0,50,"DefinedNameManager.OnWorkbookMetadataChanged : Received a stateId change and Invoked GetDefinedNames API"),
this.asg(!0))};this.asg=eb=>{this.cJa=this.$.qh.vi("WebServiceCall",Eb.FPi);const Ub=rd=>{this.Y_i(rd,eb)},Fc=rd=>{var Gd,ue;null===(Gd=this.cJa)||void 0===Gd?void 0:Gd.stop();rd=Wb.a.Qj(rd.data);rd=za.a.Kh(rd);Gd=nb.create({operationType:"get",status:"failure",executionTime:null===(ue=this.cJa)||void 0===ue?void 0:ue.ii,error:rd});Hb.mE(Hb.Mma("failure"),Gd);this.UWa=null;this.raiseEvent("dnek",new ob(!1,"get",null,eb))};P.a(this.$.userOperationManager,(rd,Gd,ue)=>{var Ce=this.$.pa.ta;rd=V.c(rd,
Ub);Gd=V.b(Gd,Fc);var Se=this.$;const of=Ce.Za(1,null);return O.h(Ce,"GetDefinedNames",of,rd,Gd,ue,Se,0)},rd=>new Y.a(1037,0,rd,16),null)};this.raiseEvent=(eb,Ub)=>{this.Og.raiseEvent(eb,Ub)};this.upsertDefinedName=(eb,Ub,Fc,rd,Gd)=>{var ue;this.Zxb=this.$.qh.vi("WebServiceCall",Eb.O7k);const Ce=gb.ILi(null===(ue=this.UWa)||void 0===ue?void 0:ue.nameManagerItems,rd),Se=bf=>{this.q3i(bf,Ce,Gd)},of=bf=>{var pf,Ud;null===(pf=this.Zxb)||void 0===pf?void 0:pf.stop();bf=Wb.a.Qj(bf.data);bf=za.a.Kh(bf);
pf=nb.create({operationType:-1!==Ce?"update":"add",status:"failure",executionTime:null===(Ud=this.Zxb)||void 0===Ud?void 0:Ud.ii,error:bf,type:Gd});Hb.mE(Hb.Mma("failure"),pf);this.raiseEvent("dnuek",new ob(!1,-1!==Ce?"update":"add",null))},jf={Name:eb,Reference:Ub,SheetName:"",Comment:Fc,Type:Gd,Jfl:rd};P.a(this.$.userOperationManager,(bf,pf,Ud)=>{var Ff=this.$.pa.ta;bf=V.c(bf,Se);pf=V.b(pf,of);var Uf=this.$;const Gf=Ff.Za(9,null);Gf.definedNameRequest=jf;return O.h(Ff,"UpsertDefinedName",Gf,bf,
pf,Ud,Uf,0)},bf=>new Y.a(1035,0,bf),null)};this.$=Ab;this.Ej=xc}hBh(Ab){this.Og.addHandler("dnuek",Ab)}eyh(Ab){this.Og.addHandler("dndok",Ab)}tkk(Ab){this.Og.removeHandler("dnek",Ab)}slk(Ab){this.Og.removeHandler("dnuek",Ab)}Mik(Ab){this.Og.removeHandler("dndok",Ab)}Xy(){var Ab;this.$.ea.Xy(this.ol);this.$.ea.Cq&&(this.stateId=null===(Ab=this.$.ea.Cq)||void 0===Ab?void 0:Ab.NamedManagerResponseStateId)}pA(){this.$.ea.pA(this.ol)}Y_i(Ab,xc){var eb,Ub,Fc,rd,Gd,ue,Ce,Se,of;let jf=!1,bf;try{if(Ab&&!La.a(Ab)){const pf=
new Uint8Array(Ab.Result),Ud=(new TextDecoder(Eb.x8k)).decode(pf.buffer);this.UWa=JSON.parse(Ud);null===(eb=this.cJa)||void 0===eb?void 0:eb.stop();jf=!0;const Ff=nb.create({operationType:"get",status:"success",executionTime:null===(Ub=this.cJa)||void 0===Ub?void 0:Ub.ii,count:null===(rd=null===(Fc=this.UWa)||void 0===Fc?void 0:Fc.nameManagerItems)||void 0===rd?void 0:rd.length,metadata:gb.L_h(null===(Gd=this.UWa)||void 0===Gd?void 0:Gd.nameManagerItems)});Hb.mE(Hb.Mma("success"),Ff)}else{null===
(ue=this.cJa)||void 0===ue?void 0:ue.stop();bf=gb.QLd(null===Ab||void 0===Ab?void 0:Ab.Errors);this.UWa=null;const pf=nb.create({operationType:"get",status:"successWithServerException",executionTime:null===(Ce=this.cJa)||void 0===Ce?void 0:Ce.ii,serverMessageId:bf.toString()});Hb.mE(Hb.Mma("successWithServerException"),pf)}}catch(pf){this.UWa=null,null===(Se=this.cJa)||void 0===Se?void 0:Se.stop(),Ab=nb.create({operationType:"get",status:"failure",executionTime:null===(of=this.cJa)||void 0===of?void 0:
of.ii,error:"JsonParsingError"}),Hb.mE(Hb.Mma("failure"),Ab)}this.raiseEvent("dnek",new ob(jf,"get",bf,xc))}ssc(Ab){this.Rgb=this.$.qh.vi("WebServiceCall",Eb.y$h);const xc=Ub=>{this.Z_i(Ub,Ab)},eb=Ub=>{var Fc,rd;null===(Fc=this.Rgb)||void 0===Fc?void 0:Fc.stop();Ub=Wb.a.Qj(Ub.data);Ub=za.a.Kh(Ub);Fc=nb.create({operationType:"delete",status:"failure",executionTime:null===(rd=this.Rgb)||void 0===rd?void 0:rd.ii,error:Ub});Hb.mE(Hb.Mma("failure"),Fc);this.raiseEvent("dndok",new ob(!1,"delete",null))};
P.a(this.$.userOperationManager,(Ub,Fc,rd)=>{var Gd=this.$.pa.ta;Ub=V.c(Ub,xc);Fc=V.b(Fc,eb);var ue=this.$;const Ce=Gd.Za(9,null);Ce.definedNameIds=Ab;return O.h(Gd,"DeleteDefinedNames",Ce,Ub,Fc,rd,ue,0)},Ub=>new Y.a(1036,0,Ub),null)}Z_i(Ab,xc){var eb,Ub,Fc;let rd=!1,Gd;if(Ab&&!La.a(Ab)&&xc){rd=!0;null===(eb=this.Rgb)||void 0===eb?void 0:eb.stop();var ue=nb.create({operationType:"delete",status:"success",executionTime:null===(Ub=this.Rgb)||void 0===Ub?void 0:Ub.ii,countOfNamesDeleted:xc.length});
Hb.mE(Hb.Mma("success"),ue)}else Gd=gb.QLd(null===Ab||void 0===Ab?void 0:Ab.Errors),null===(Fc=this.Rgb)||void 0===Fc?void 0:Fc.stop(),gb.gXc(Gd)&&Jc.a(this.$).ij.CL(Gd),Ub=nb.create({operationType:"delete",status:"successWithServerException",executionTime:null===(ue=this.Rgb)||void 0===ue?void 0:ue.ii,serverMessageId:Gd.toString(),countOfNamesDeleted:xc.length}),Hb.mE(Hb.Mma("successWithServerException"),Ub);this.raiseEvent("dndok",new ob(rd,"delete",Gd))}q3i(Ab,xc,eb){var Ub,Fc,rd;let Gd=!1,ue;
if(Ab&&!La.a(Ab)){Gd=!0;null===(Ub=this.Zxb)||void 0===Ub?void 0:Ub.stop();var Ce=nb.create({operationType:-1!==xc?"update":"add",status:"success",executionTime:null===(Fc=this.Zxb)||void 0===Fc?void 0:Fc.ii,type:eb});Hb.mE(Hb.Mma("success"),Ce)}else null===(rd=this.Zxb)||void 0===rd?void 0:rd.stop(),ue=gb.QLd(null===Ab||void 0===Ab?void 0:Ab.Errors),gb.gXc(ue)&&Jc.a(this.$).ij.CL(ue),eb=nb.create({operationType:-1!==xc?"update":"add",status:"successWithServerException",type:eb,executionTime:null===
(Ce=this.Zxb)||void 0===Ce?void 0:Ce.ii,serverMessageId:ue.toString()}),Hb.mE(Hb.Mma("successWithServerException"),eb);this.raiseEvent("dnuek",new ob(Gd,-1!==xc?"update":"add",ue))}};ya=Object(N.__decorate)([Object(Ya.d)(sa.xb),Object(N.__param)(0,Object(sa.Lb)()),Object(N.__param)(1,Object(sa.E)())],ya);Object(M.a)(ya,"DefinedNameManager",null,[535]);var Aa=a(6),sb=a(134),nc=a(52),Bb=a(13),uc=a(236);class Pc{}Pc.HTML='<div id="WACDialogRow" class="WACDialogRow">\r\n\t\t\t\t\t<div id="WACDialogIconPanel" class="WACDialogIconPanel"></div>\r\n\t\t\t\t\t<div id="WACDialogTextPanel" class="WACDialogTextPanel" style="padding-right: 30px;">\r\n\t\t\t\t\t\t<div id="WACDialogErrorMessage"></div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorReportMessage"> </div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorTextPrompt" ></div> \r\n\t\t\t\t\t\t<textarea id="WACDialogInput" class="WACDialogInput" rows="5" style="margin-bottom: 10px; margin-top: 9px; overflow: auto;" maxlength="256"></textarea>\r\n\t\t\t\t\t\t<div id = "WACDialogSendFileCheckboxContainer" class="WACDialogRow" >\r\n\t\t\t\t\t\t<input type="checkbox" id="WACDialogSendFileCheckbox">\r\n\t\t\t\t\t\t<span id="WACDialogSendFileCheckboxText">text</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<a id="WACDialogPrivacyText"> </a> \r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>';
Object(M.a)(Pc,"FileUploadDialogHTML",null,[]);var wd=a(168),Md=a(28),Nd=a(23);class ec extends uc.a{constructor(Ab){super(!1,!1,ec.k2);this.J1d=!1;this.C8f=!0;this.J7f=0;this.duj=(xc,eb)=>{const Ub=eb[ec.Mrd]||"";let Fc=!0;void 0!==eb[ec.snc]&&null!==eb[ec.snc]&&(Fc=eb[ec.snc]);this.YC(xc,Ub,Fc)};this.nde=(xc,eb)=>{this.YC(xc,eb.text||"",eb.reportErrorChecked)};this.PUj=xc=>{Aa.AFrameworkApplication.jh.Xj(Md.a.G1b,2,xc)};this.Bh=1;this.Yh(1,Object(Nd.a)("Send"));this.Yh(0,Object(Nd.a)("NoThanks"));
this.Po=Pc.HTML;this.z7f=Ab;this.Lk=ec.uNh}lp(Ab,xc,eb,Ub,Fc){Fc=void 0===Fc?!0:Fc;this.J1d=void 0===Ub?!1:Ub;this.jLk(xc);this.J7f=Ab;Fc&&Aa.AFrameworkApplication.wC(Ab)}jLk(Ab){if(ec.k2)this.eNk(Ab);else{var xc={};xc[ec.qNh]=Ab;xc[ec.wNh]=Object(Nd.a)("SendFileErrorReportMessage");xc[ec.xNh]=Object(Nd.a)("SendFileErrorReportTextCaption");xc[ec.Mrd]="";xc[ec.tNh]=Object(Nd.a)("UserReportLinkText");xc[ec.snc]=!0;this.initializeAndShow(Object(Nd.a)("DefaultDialogTitle"),this.duj,xc);this.nia(ec.DNh)}}eNk(Ab){Ab=
{["id"]:this.Lk,["bodyControls"]:{["reportErrorCheckboxProps"]:this.J1d?{["label"]:Object(Nd.a)("UserReportLinkText")}:null,["textAreaProps"]:this.C8f?{}:null,["privacyStatementLinkProps"]:{["text"]:Object(Nd.a)("PrivacyStatement"),["handler"]:{["href"]:Aa.AFrameworkApplication.privacyUrl,["target"]:"_blank"}}},["errorMessage"]:Ab,["errorReportMessage"]:Object(Nd.a)("SendFileErrorReportMessage"),["errorTextPrompt"]:Object(Nd.a)("SendFileErrorReportTextCaption")};this.initializeAndShow(Object(Nd.a)("DefaultDialogTitle"),
this.nde,Ab)}gNc(){if(!ec.k2){var Ab=document.getElementById(ec.zNh);Ab&&(Ab.className=ec.yNh,Ab.appendChild(wd.a(32,32,ec.vNh,null,!0,Object(Nd.a)("DialogError"))));if(Ab=document.getElementById(ec.BNh))Ab.innerText=Object(Nd.a)("PrivacyStatement"),Ab.href=Aa.AFrameworkApplication.privacyUrl,nc.a.addHandler(Ab,"click",this.PUj);this.C8f||(Ab=document.getElementById(ec.Mrd))&&Ab.parentNode&&Ab.parentNode.removeChild(Ab);this.J1d||(Ab=document.getElementById(ec.sNh))&&Ab.parentNode&&Ab.parentNode.removeChild(Ab)}}GS(){ec.k2||
(super.GS(),document.getElementById(this.Jo("WACDialogPanel")).style.width=String.format("{0}px",400))}YC(Ab,xc,eb){this.z7f&&(eb&&Q.ULS.sendTraceTag(5768786,306,50,"Error Report sent for errorCode:{0}",this.J7f),this.z7f(Ab,xc,eb))}get rea(){return!1}static get k2(){return Aa.AFrameworkApplication.ra.$d.zM&&Aa.AFrameworkApplication.ra.$d.qnj}}ec.qNh="WACDialogErrorMessage";ec.wNh="WACDialogErrorReportMessage";ec.xNh="WACDialogErrorTextPrompt";ec.Mrd="WACDialogInput";ec.BNh="WACDialogPrivacyText";
ec.zNh="WACDialogIconPanel";ec.vNh="CancelRequest_32x32x32";ec.yNh="WACDialogIcon";ec.DNh="WACDialogTextPanel";ec.snc="WACDialogSendFileCheckbox";ec.sNh="WACDialogSendFileCheckboxContainer";ec.tNh="WACDialogSendFileCheckboxText";ec.uNh="FileUploadErrorDialog";Object(M.a)(ec,"FileUploadErrorDialog",uc.a,[]);var gc;let Mb=gc=class extends fb.a{constructor(Ab){super();this.$=Ab;this.Otg=0;this.fM=null;this.Ugk=xc=>{this.zik(xc)};this.qVh=(xc,eb)=>{if(1===xc&&this.fM.FileCollectionErrorStateId){xc=this.$.pa.ta;
var Ub=this.fM.MessageId,Fc=this.fM.OriginalEcsServerId,rd=this.fM.FileCollectionErrorStateId;const Gd=xc.Za(0);Gd.errorMessageId=Ub;Gd.ecsServerId=Fc;Gd.fileCollectionErrorStateId=rd;Gd.userComment=eb;xc.$rd("CollectFile",Gd,null,null,null,null,0)}this.raiseEvent("fileCollectionComplete",null,this)}}Rxh(Ab){this.addHandler("fileCollectionComplete",Ab)}zik(Ab){this.removeHandler("fileCollectionComplete",Ab)}pVh(Ab,xc,eb){this.Otg=xc;this.fM=Ab;this.Rxh(eb);Aa.AFrameworkApplication.privacyUrl=this.$.workbookContext.FullDocumentInfo.PrivacyUrl;
Ab=new ec(this.qVh);Aa.AFrameworkApplication.jh.Hh(Md.a.G1b,sb.a.frame,gc.p7j);Ab.lp(0,"",null,!1,!1)}static p7j(Ab,xc,eb,Ub,Fc){nc.a.OA(Fc);Aa.AFrameworkApplication.privacyUrl&&Bb.HelperMethods.dm(Aa.AFrameworkApplication.privacyUrl,void 0,void 0,"FileCollectionOperation.PrivacyUrl");return 32}};Mb=gc=Object(N.__decorate)([Object(Ya.d)(sa.dc),Object(N.__param)(0,Object(sa.Lb)()),Object(N.__param)(1,Object(sa.ab)())],Mb);Object(M.a)(Mb,"FileCollectionOperation",fb.a,[538,2]);var sc=a(71);let xd=class extends Da.a{constructor(Ab,
xc,eb,Ub){super();this.dl=null;this.fj=()=>{this.button.getButton(this.dl.fm.paneType).Nrb();Ha.a.sendTelemetryEvent(Object(Ia.a)(new db.a,{name:"Office.Excel.Online.OnObjectUI.ButtonPressed",dataFields:mb.a.rn({["buttonType"]:"FloatingObjectToCellImage"})}));const Fc=new ab.a(-700002548,K.a.eh,this.$.Rh,9,null);this.$.Ma.dh(Fc,null)};this.oE=()=>{this.Zba()};this.jgg=()=>{this.Hwb()};this.$Nc=()=>{this.Hwb()};this.eOc=()=>{this.Hwb()};this.gjg=()=>{this.Hwb()};this.o_b=()=>{this.Hwb()};this.ijg=
()=>{this.Hwb()};this.Rp=()=>{this.Zba()};this.zy=()=>{this.Zba()};this.xu=()=>{this.Zba()};this.kA=()=>{this.Zba()};this.$=Ab;this.isVisible=!1;this.button=eb.NKb(Ab,xc,this.fj,null,null,Za.a.instance.ia(2319),"FloatingObjectToCellImagePointerDown");this.da=ba.f(this.$);xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8726712_MoveGridViewContentReadyToCtor")&&this.da.Mz(this.oE);this.$.hI(this.Rp);xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8726584_DisablePictureOOUIForViewMode")&&this.$.ea.JJ(this.kA);
this.da.view.Wy(this.zy);this.da.ha.$e.MN(this.xu);this.ariaLiveNotifier=Ub}dispose(){this.da&&(this.da.view.Kx(this.zy),this.da.ha.$e.sV(this.xu));this.$&&(this.$.LK(this.Rp),xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8726584_DisablePictureOOUIForViewMode")&&this.$.ea.GH(this.kA));this.button.dispose();this.$=this.da=this.button=null;super.dispose()}tkd(){this.isVisible&&this.fj(null,null)}Zba(){if(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8726584_DisablePictureOOUIForViewMode")&&!this.$.isEditMode)this.PX();
else{var Ab=this.da.ha.$e;if(Ab.isFloatingObjectSelected&&1===Ab.yh.floatingObject.type){if(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8495249_DisableOOUIOnProtectedSheet")){const xc=new pa.a(this.$.sa);if(xc&&xc.Dn){this.PX();return}}null!==this.dl&&this.AAg(this.dl);this.dl=Ab.yh;this.oqa()}else this.PX()}}oqa(){const Ab=this.dl.fm.vr,xc=this.dl.floatingObject;this.juh(this.dl);let eb=xc.ZZ+this.mnc,Ub=xc.HA,Fc=0;var rd=0;switch(this.dl.fm.paneType){case 3:Fc=this.da.Pg.Iz;rd=this.da.Pg.HA-this.da.ow.y;
break;case 4:Fc=this.da.Pg.Iz-this.da.ow.x;rd=this.da.Pg.HA;break;case 1:Fc=this.da.Pg.Iz;rd=this.da.Pg.HA;break;case 2:Fc=this.da.Pg.Iz-this.da.ow.x,rd=this.da.Pg.HA-this.da.ow.y}eb-=Fc;Ub-=rd;rd=new sc.a(xc.Iz-Fc,Ub,xc.width,xc.height);eb+this.button.buttonWidth>Ab.bottomRight.x&&(eb=xc.Iz-Fc-this.mnc-this.button.buttonWidth);Ub<Ab.topLeft.y+this.mnc&&(Ub=Ab.topLeft.y+this.mnc);4===this.da.ha.wk&&Ab.yi(rd)&&Ab.width>xc.width?this.Ft(eb,Ub,this.da.rtl,this.dl.fm.paneType,!0):this.PX()}Ft(Ab,xc,eb,
Ub,Fc){xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8726712_MoveGridViewContentReadyToCtor")||this.da.Mz(this.oE);this.button.r1c(wa.a.T2j,Za.a.instance.ia(2319),Ub);xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8352230_UpdateDivTitleForSVGLaunchButtonOOUI")&&this.button.S0c(Za.a.instance.ia(2319),Ub);this.button.Ft(Ab,xc,eb,Ub,!1,Fc);this.isVisible=!0;this.BDh()}PX(){this.da.xE(this.oE);null!==this.dl&&(this.AAg(this.dl),this.dl=null);this.button.hide();this.isVisible=!1}Hwb(){this.button.hide();
this.isVisible=!1}BDh(){let Ab;Ab=ka.a.isMac?Za.a.instance.ia(2323):Za.a.instance.ia(2322);this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.xba(Ab)}get mnc(){return this.button.TIb}juh(Ab){var xc,eb,Ub,Fc,rd,Gd;if(Ab=Ab.extension)null===(xc=Ab.l$)||void 0===xc?void 0:xc.C0e(this.jgg),null===(eb=Ab.Jtb)||void 0===eb?void 0:eb.lnd(this.$Nc),null===(Ub=Ab.vGg)||void 0===Ub?void 0:Ub.BAh(this.eOc),null===(Fc=Ab.bP)||void 0===Fc?void 0:Fc.Omd(this.o_b),null===(rd=Ab.bP)||void 0===rd?void 0:rd.ezh(this.gjg),
null===(Gd=Ab.bP)||void 0===Gd?void 0:Gd.hzh(this.ijg)}AAg(Ab){var xc,eb,Ub,Fc,rd,Gd;if(Ab=Ab.extension)null===(xc=Ab.l$)||void 0===xc?void 0:xc.LBg(this.jgg),null===(eb=Ab.Jtb)||void 0===eb?void 0:eb.qCg(this.$Nc),null===(Ub=Ab.vGg)||void 0===Ub?void 0:Ub.Mkk(this.eOc),null===(Fc=Ab.bP)||void 0===Fc?void 0:Fc.nge(this.o_b),null===(rd=Ab.bP)||void 0===rd?void 0:rd.Ejk(this.gjg),null===(Gd=Ab.bP)||void 0===Gd?void 0:Gd.Hjk(this.ijg)}};xd=Object(N.__decorate)([Object(Ya.d)(sa.oc),Object(N.__param)(0,
Object(sa.Lb)()),Object(N.__param)(1,Object(oa.m)()),Object(N.__param)(2,Object(sa.Cf)()),Object(N.__param)(3,Object(sa.l)())],xd);Object(M.a)(xd,"FloatingObjectToCellImageController",Da.a,[]);var xb=a(482),Lb=a(424),Rc=a(31),nd=a(619),$d=a(586),Td=a(1270);a(224);var He=a(25);Object(Ya.b)(sa.qc,{yk:"singleton"})(Ab=>No(function*(){const xc=yield Ya.a.resolve(sa.Lb,Ab),eb=He.a.nl()?yield Ya.a.resolve(sa.rc,Ab):null;return new oc(xc,eb)}));class oc{constructor(Ab,xc){this.$=Ab;this.Xz=xc;this.menuId=
this.Drd=this.fca=this.Vva=null;this.OFd=0;this.nEj="+mn-lt";this.VAj="+mj-lt";this.UNc=eb=>{this.jVb=!0;this.$.k5(Ub=>{Ub.Rrb("FontName_New")});Q.ULS.sendTraceTag(520710160,1,15,`PreviewFont Status is ${eb}`)};this.bfj=!!String.fromCodePoint&&!ka.a.gA&&!!window.gridRenderer&&gridRenderer.CanvasRendererGlobals.isFontLoadApiSupported();this.jVb=!1;this.da=ba.f(this.$);this.nl=He.a.nl();this.mYf=xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NewDefaultTemplate",!1);this.nl&&this.Xz&&(this.Xz.Iij?
this.lLg():this.Xz.Ryc(()=>{this.lLg()}))}get sw(){this.xG||(this.xG=Ya.a.Zg(sa.og));return this.xG}lLg(){this.fca=this.Xz.eWg;this.Vva=this.Xz.Vwi;this.OFd=2;this.jVb=this.Xz.jVb}get eWg(){return this.fca}Uzf(Ab,xc,eb,Ub){Ub=void 0===Ub?null:Ub;const Fc=Object.assign(new xb.a,{Id:"FontDropdownMenu"});Fc.MenuSectionList=[];this.sw&&(this.sw.WHa(Ub),Ub=Object.assign(new Lb.a,{ControlsId:"ThemeFontsMenuSectionControl",Title:Za.a.instance.ia(1337),ControlList:this.vWi(Ab,xc,eb)}),Fc.MenuSectionList.push(Ub));
Ub=Object.assign(new Lb.a,{ControlsId:"FontsMenuSectionControl"});Ub.Title=Za.a.instance.ia(1338);Ub.ControlList=this.ZJi(Ab,xc,eb);Fc.MenuSectionList.push(Ub);return Fc}vWi(Ab,xc,eb){var Ub;const Fc=[];var rd=this.da.ha.$e.yh;rd=5===(null===(Ub=null===rd||void 0===rd?void 0:rd.floatingObject)||void 0===Ub?void 0:Ub.type);let Gd,ue;this.sw.Ly?(Gd=this.sw.Ly.v3d,ue=this.sw.Ly.e2d):Q.ULS.sendTraceTag(520710165,1,15,"ThemeFonts are Null");(Ub=this.Sif(ue,1,rd,Ab,xc,eb))&&Fc.push(Ub);(Ab=this.Sif(Gd,
2,rd,Ab,xc,eb))&&Fc.push(Ab);return Fc}Sif(Ab,xc,eb,Ub,Fc,rd){var Gd=2===xc?this.nEj:this.VAj;let ue;Ab?(eb=eb?Gd:Rc.a.Yl(Ab),Gd=Rc.a.Yl(Bb.HelperMethods.NQb(Ab,xc)),ue=Rc.a.Yl(Ab)):(eb=eb?Gd:void 0,Gd=Rc.a.Yl(String.fromCodePoint(0)),ue="msofp");return Object.assign(new nd.a,{MenuItemId:2===xc?Td.b:Td.a,CommandValueId:eb,LabelText:Gd,LabelCss:String.format("font-size:12pt;font-family:{0};",ue),Styles:oc.tQb(ue),AriaLabel:Gd,Alt:Gd,Command:Ub.toString(),CommandPreviewId:Fc.toString(),CommandRevertId:rd.toString(),
Disabled:!Ab})}ZJi(Ab,xc,eb){if(this.Drd)return this.Drd.Byd;let Ub;const Fc=Bb.HelperMethods.HM(()=>{const rd=this.bfj&&!this.jVb;let Gd=!1;this.Vva||(this.RRf(),Gd=!0,Q.ULS.sendTraceTag(509654348,1,15,"FontDropdownHelper.getFontButtonsForMenuSection: fontCodepointMap is Null. Initialize with old Font Dictionary."));Ub=this.nhf(Ab,xc,eb,this.Vva,rd,Gd);Ub.fXc&&!Gd&&(Q.ULS.sendTraceTag(520710162,1,15,"FontDropdownHelper.getFontButtonsForMenuSection: ddEntries is Null. Fallback to old Font Dictionary."),
this.RRf(),Ub=this.nhf(Ab,xc,eb,this.Vva,rd,Ub.fXc));this.nl&&!Ub.fXc&&(this.Drd=Ub);rd&&!this.nl&&gridRenderer.CanvasRendererGlobals.loadPreviewFont(this.UNc)});10<Fc&&Q.ULS.sendTraceTag(512340117,1,50,`FontDropdownHelper.getFontButtonsForMenuSection: Duration for getFontButtonsForMenuSection, duration=${Fc}`);return Ub.Byd}nhf(Ab,xc,eb,Ub,Fc,rd){const Gd=[];let ue;const Ce=this.nl&&!rd;ue=Ce?"msofpNew":this.mYf?"msofp_v4_29":"msofp";for(const pf in Ub){var Se=pf,of=Ub[pf],jf=Rc.a.Yl(Se),bf=void 0;
if(Ce)if(bf=this.fca?this.fca[Se]:null)bf=Rc.a.Yl(bf);else return Q.ULS.sendTraceTag(520710161,1,15,`FontDropdownHelper.getFontButtonsForMenuSection: localizedFontName in supportedFontFamiliesNew is not found for ${Se}`),{fXc:!0,Byd:[]};else bf=Rc.a.Yl(Bb.HelperMethods.fca[Se]);Se=Rc.a.Yl(Se);Fc||(of=0);jf=Object.assign(new nd.a,{MenuItemId:jf,CommandValueId:jf,LabelText:Fc&&0<of?Rc.a.Yl(String.fromCodePoint(of)):bf,LabelCss:String.format("font-size:12pt;font-family:{0};",Fc&&0<of?ue:Se),Styles:oc.tQb(Fc&&
0<of?ue:Se),AriaLabel:bf,Alt:bf,Command:Ab.toString(),CommandPreviewId:xc.toString(),CommandRevertId:eb.toString()});Gd.push(jf)}return{fXc:rd,Byd:Gd}}zBk(Ab){this.menuId=Ab}Kij(){return 2!==this.OFd&&3!==this.OFd?!1:!0}RRf(){this.mYf?(this.Vva={["Angsana New"]:983051,["Aptos Display"]:983056,["Aptos Narrow"]:983060,["Arial Black"]:983065,["Arial"]:983064,["Batang"]:983087,["Book Antiqua"]:983104,["Browallia New"]:983109,["Calibri"]:983112,["Cambria"]:983116,["Candara"]:983118,["Century"]:983121,
["Comic Sans MS"]:983128,["Consolas"]:983134,["Constantia"]:983135,["Corbel"]:983139,["Cordia New"]:983140,["Courier New"]:983142,["DilleniaUPC"]:983153,["Dotum"]:983155,["FangSong"]:983175,["Garamond"]:983193,["Georgia"]:983195,["Gulim"]:983222,["GungSuh"]:983226,["KaiTi"]:983263,["JasmineUPC"]:983258,["Malgun Gothic"]:983302,["Mangal"]:983306,["Meiryo"]:983309,["Microsoft JhengHei"]:983317,["Microsoft YaHei"]:983329,["MingLiU"]:983337,["MingLiU_HKSCS"]:983341,["MS Gothic"]:983290,["MS Mincho"]:983292,
["MS PGothic"]:983294,["MS PMincho"]:983296,["PMingliU"]:983372,["PMingLiU-ExtB"]:983374,["SimHei"]:983441,["SimSun"]:983443,["SimSun-ExtB"]:983445,["Source Sans Pro"]:983464,["Tahoma"]:983472,["THSarabunPSK"]:983471,["Times New Roman"]:983484,["Trebuchet MS"]:983495,["Verdana"]:983519,["Yu Gothic"]:983540,["Yu Mincho"]:983550},$d.a.gw('@font-face{font-family:"msofp_v4_29";font-style:normal;font-weight:normal;src:url("https://fs.microsoft.com/fs/4.35/flat_officeFontsPreview.ttf") format(\'truetype\')}')):
this.Vva={["Angsana New"]:983046,["Arial Black"]:983051,["Arial"]:983050,["Batang"]:983061,["Book Antiqua"]:983077,["Browallia New"]:983082,["Calibri"]:983085,["Cambria"]:983089,["Candara"]:983091,["Century"]:983095,["Comic Sans MS"]:983100,["Consolas"]:983101,["Constantia"]:983102,["Corbel"]:983106,["Cordia New"]:983107,["Courier New"]:983109,["DilleniaUPC"]:983121,["Dotum"]:983123,["FangSong"]:983138,["Garamond"]:983154,["Georgia"]:983156,["Gulim"]:983182,["GungSuh"]:983186,["KaiTi"]:983222,["JasmineUPC"]:983218,
["Malgun Gothic"]:983258,["Mangal"]:983262,["Meiryo"]:983264,["Microsoft JhengHei"]:983272,["Microsoft YaHei"]:983284,["MingLiU"]:983292,["MingLiU_HKSCS"]:983296,["MS Gothic"]:983245,["MS Mincho"]:983247,["MS PGothic"]:983249,["MS PMincho"]:983251,["PMingliU"]:983322,["PMingLiU-ExtB"]:983324,["SimHei"]:983382,["SimSun"]:983384,["SimSun-ExtB"]:983386,["Source Sans Pro"]:983396,["Tahoma"]:983405,["THSarabunPSK"]:983404,["Times New Roman"]:983415,["Trebuchet MS"]:983419,["Verdana"]:983443,["Yu Gothic"]:983464,
["Yu Mincho"]:983474}}static tQb(Ab){const xc={};xc["font-family"]=Ab;xc["font-size"]="12pt";Ab={};Ab.optionText=xc;return Ab}}Object(M.a)(oc,"FontDropdownHelper",null,[281]);var ld=a(845),id;(function(Ab){Ab[Ab.FormatCellsListView=0]="FormatCellsListView";Ab[Ab.NumberFormatItemView=1]="NumberFormatItemView";Ab[Ab.AlignmentItemView=2]="AlignmentItemView";Ab[Ab.FontItemView=3]="FontItemView";Ab[Ab.BorderItemView=4]="BorderItemView"})(id||(id={}));var fc;(function(Ab){Ab[Ab.General=0]="General";Ab[Ab.Number=
1]="Number";Ab[Ab.Currency=2]="Currency";Ab[Ab.Accounting=3]="Accounting";Ab[Ab.Date=4]="Date";Ab[Ab.Time=5]="Time";Ab[Ab.Percentage=6]="Percentage";Ab[Ab.Fraction=7]="Fraction";Ab[Ab.Scientific=8]="Scientific";Ab[Ab.Text=9]="Text";Ab[Ab.Special=10]="Special";Ab[Ab.Custom=11]="Custom"})(fc||(fc={}));var vc=a(10),Tc=a(213),Bd=a(1472);Object(Bd.isChangeGateEnabled)("OfficeVSO:8756610_UserBrowserPerformanceAPI");class Fd{constructor(Ab,xc,eb){this.B9=!1;this.P_a=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8611831_FixEditingUxOnAlignment");
this.qK=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8586390_FloatingObjectFormatCellsCentralFix");this.qE=()=>{this.dispose()};this.C6=()=>{this.$o()};this.onActiveCellChanged=(Ub,Fc)=>{Fc&&Fc.description===id[id.AlignmentItemView]&&this.POa()};this.xu=(Ub,Fc)=>{Fc&&Fc.dGd===id.AlignmentItemView&&(this.qK?0!==(Fc.wk&470)?this.So.K7(id.AlignmentItemView,null):this.POa():this.So.K7(id.AlignmentItemView,null,!0))};this.hB=(Ub,Fc)=>{Fc&&Fc.description===id[id.AlignmentItemView]&&this.POa()};this.tMc=
(Ub,Fc)=>{Fc&&Fc.description===id[id.AlignmentItemView]&&(this.reactRibbonRoot.fn(),this.POa())};this.$=Ab;this.properties=xc;this.Ah=eb;this.So=Ac.Uyc(this.$,this.properties,this.Ah);this.alignmentModel={horizontalAlignmentType:0,verticalAlignmentType:0,readingOrderType:0,isJustifyDistributed:!1,indent:0,orientation:0,isWrapText:!1,isShrinkToFit:!1,isMergeCells:!1,isMergeCellsDisabled:!1,isFlipVertical:!1,disableAllControls:!1};this.Gyf={};this.P_a&&(this.reactRibbonRoot=Ab.ka.Ug(337,!0))}static getInstance(Ab,
xc,eb){return this.Wa||(this.Wa=new this(Ab,xc,eb))}POa(){var Ab;const xc=ba.f(this.$),eb=null===(Ab=xc.kh(xc.ha.qa.activeCell))||void 0===Ab?void 0:Ab.cell;eb&&(c("AlignmentTab::Update::Start"),this.alignmentModel.horizontalAlignmentType=eb.yH,this.alignmentModel.verticalAlignmentType=eb.verticalAlignment,this.alignmentModel.isJustifyDistributed=8===eb.yH?!0:!1,this.alignmentModel.indent=eb.indentation||0,this.alignmentModel.isWrapText=eb.PE,this.alignmentModel.isShrinkToFit=eb.e7b,this.alignmentModel.isMergeCells=
eb.DF,this.alignmentModel.isMergeCellsDisabled=Tc.c(xc),this.alignmentModel.readingOrderType=eb.oRc,this.P_a&&(this.alignmentModel.disableAllControls=xc.sh.isEditing),xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8475627_FixVerticalTextOrientation")?(this.alignmentModel.orientation=eb.UHc?0:eb.HE||0,this.alignmentModel.isFlipVertical=eb.UHc):(this.alignmentModel.orientation=eb.HE||0,this.alignmentModel.isFlipVertical=this.alignmentModel.orientation===vc.a.verticalText?!0:!1),this.w4k(this.alignmentModel))}w4k(Ab){this.Gyf.alignmentModel=
Ab;this.So.K7(id.AlignmentItemView,this.Gyf);this.B9||this.fq()}dh(Ab,xc){c("AlignmentTab::CmdUpdate::Start");xc=Object.assign({},xc);xc[ld.a.sia]=!1;this.$.ei(Ab,K.a.eh,12,xc);Q.ULS.sendTraceTag(508389411,0,50,`Ribbon command called from Alignment Task Pane: ${Ab}`)}Rwe(Ab){switch(Ab){case 0:this.Rwe(this.alignmentModel.horizontalAlignmentType);break;case 1:this.dh(-1150205178,null);break;case 2:this.dh(-1142465846,null);break;case 3:this.dh(-286432209,null);break;case 6:this.dh(2007171328,null)}}CIa(){return{onHorizontalAlignmentChange:Ab=>
{this.alignmentModel.horizontalAlignmentType!==Ab&&this.Rwe(Ab)},onVerticalAlignmentChange:Ab=>{switch(Ab){case 0:this.dh(-394785302,null);break;case 1:this.dh(1041132226,null);break;case 2:this.dh(-571165336,null)}},justifyDistributed:Ab=>{Ab&&this.Rwe(8)},onTextDirectionChange:()=>{},onIndentationChange:Ab=>{const xc=this.alignmentModel.indent;this.dh(Ab>xc?-1942512156:-1920201820,{Indentation:Ab-xc});this.POa()},onOrientationChange:Ab=>{this.dh(-1220714308,{Orientation:Ab});this.POa()},wrapText:()=>
{this.dh(-1116189897,null)},mergeCells:Ab=>{this.dh(Ab?1097660126:155820588,null)},flipVertical:()=>{this.dh(-1526602249,null)}}}dispose(){this.$o();this.So.age(this.qE);Fd.Wa=null}fq(){this.So.Cmd(this.C6);this.So.Bmd(this.qE);this.So.add_activeCellChanged(this.onActiveCellChanged);this.So.MN(this.xu);this.So.g1e(this.hB);this.P_a&&(this.So.Fxh(this.tMc),this.So.Exh(this.tMc));this.B9=!0;Q.ULS.sendTraceTag(508355650,0,50,"AlignmentViewModel events registered")}$o(){this.So.bge(this.C6);this.So.remove_activeCellChanged(this.onActiveCellChanged);
this.So.sV(this.xu);this.So.jCg(this.hB);this.P_a&&(this.So.pik(this.tMc),this.So.oik(this.tMc));this.B9=!1;Q.ULS.sendTraceTag(508355649,0,50,"AlignmentViewModel events Unregistered")}}Object(M.a)(Fd,"AlignmentTaskPaneManager",null,[2]);var le=a(181),dc=a(1406);class Uc{constructor(Ab,xc){this.qK=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8586390_FloatingObjectFormatCellsCentralFix");this.$=xc;this.So=Ab}showTaskPane(Ab,xc,eb){void le.a.Go().then(Ub=>{Ub.showTaskPane("FormatCellsTaskPane",this.pt(Ab,
xc,eb));return null})}updateTaskPane(Ab,xc,eb){void le.a.Go().then(Ub=>{Ub.updateTaskPane("FormatCellsTaskPane",this.pt(Ab,xc,eb));return null})}hideTaskPane(){void le.a.Go().then(Ab=>{Ab.hideTaskPane("FormatCellsTaskPane",2);return null})}close(){throw Error("Method not implemented.");}pt(Ab,xc,eb){Ab={type:"FormatCellsTaskPaneProps",activePage:Ab,callbacks:this.So.CIa(),viewModelData:xc,isFloatingObjectSelected:eb};return Object.assign(new dc.a,{contentProps:Ab,actionButtonProps:Ab.activePage!==
id.FormatCellsListView&&(this.qK||!eb)&&{label:Za.a.instance.ia(2351),icon:"CommonControlArrowLeftUseWithBorder_24",onExecute:()=>{this.updateTaskPane(id.FormatCellsListView,null,this.qK?void 0:eb);this.So.activePage=id.FormatCellsListView}},title:Ab.activePage===id.FormatCellsListView?Za.a.instance.ia(2304):Za.a.instance.ia(2305),onShow:()=>{this.So.vUj()},onHide:()=>{this.So.C6()},onClose:()=>{this.So.qE()},width:320})}}Object(M.a)(Uc,"FormatCellsTaskPane",null,[600]);var kb=a(1273);class rb extends Sys.EventArgs{constructor(Ab,
xc,eb,Ub){super();this.vo=Ab;this.cellFormat=xc;this.dGd=eb;this.wk=Ub}}Object(M.a)(rb,"FormatCellsTaskPaneEventArgs",Sys.EventArgs,[]);class cc extends fb.a{constructor(Ab,xc,eb){super();this.NX=!1;this.P_a=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8611831_FixEditingUxOnAlignment");this.qK=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8586390_FloatingObjectFormatCellsCentralFix");this.activePage=id.FormatCellsListView;this.isFloatingObjectSelected=this.snb=!1;this.fPi=()=>this.activePage===id.NumberFormatItemView?
Ac.KKd(this.$,this.properties,this.Ah).CIa():null;this.gCi=()=>this.activePage===id.AlignmentItemView?Ac.wHd(this.$,this.properties,this.Ah).CIa():null;this.Aeg=()=>{this.raiseEvent("CellEditingStarted",new kb.a(id[this.activePage],null))};this.zeg=()=>{this.raiseEvent("CellEditingEnded",new kb.a(id[this.activePage],null))};this.onActiveCellChanged=()=>{this.raiseEvent("ActiveCellChanged",new kb.a(id[this.activePage],null));this.activePage===id.FormatCellsListView&&this.isFloatingObjectSelected&&
this.K7(id.FormatCellsListView,null,this.qK?void 0:!1);this.qK||(this.isFloatingObjectSelected=!1)};this.xu=(Ub,Fc)=>{this.isFloatingObjectSelected=this.qK?Fc&&0!==(Fc.wk&470):!0;this.activePage===id.FormatCellsListView?this.K7(id.FormatCellsListView,null,this.qK?void 0:!0):this.raiseEvent("FloatingObjectSelectionChanged",new rb(1461300262,null,this.activePage,Fc.wk))};this.$Wb=()=>{this.$.ea.gk!==vc.a.kk&&this.$.ea.Ph&&(this.NX=!0)};this.hB=()=>{this.$.ea.gk!==vc.a.kk&&this.NX&&(this.NX=!1,(new pa.a(this.$.sa)).Hj(4)?
this.raiseEvent("OnGridConsistent",new kb.a(id[this.activePage],null)):this.Lib.hideTaskPane())};this.Li=(Ub,Fc)=>{!Fc.Hl&&this.snb&&this.Lib.hideTaskPane()};this.$=Ab;this.properties=xc;this.Ah=eb;this.Lib=new Uc(this,Ab);this.da=ba.f(this.$);this.JXd=xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AsyncTaskPaneUITiming",!1);this.qK&&(this.isFloatingObjectSelected=this.da.ha.$e.isFloatingObjectSelected)}static getInstance(Ab,xc,eb){return this.Wa||(this.Wa=new this(Ab,xc,eb))}K7(Ab,
xc,eb){eb=void 0===eb?this.qK?this.iJk(Ab)?this.isFloatingObjectSelected:!1:!1:eb;this.snb?this.Lib.updateTaskPane(Ab,xc,eb):(this.JXd&&void this.BYk(),this.Lib.showTaskPane(Ab,xc,eb),this.snb=!0,this.yz());this.activePage=Ab}Cmd(Ab){this.addHandler("FCPaneCollapsed",Ab)}bge(Ab){this.removeHandler("FCPaneCollapsed",Ab)}Bmd(Ab){this.addHandler("FCPaneClosed",Ab)}age(Ab){this.removeHandler("FCPaneClosed",Ab)}add_activeCellChanged(Ab){this.addHandler("ActiveCellChanged",Ab)}remove_activeCellChanged(Ab){this.removeHandler("ActiveCellChanged",
Ab)}MN(Ab){this.addHandler("FloatingObjectSelectionChanged",Ab)}sV(Ab){this.removeHandler("FloatingObjectSelectionChanged",Ab)}g1e(Ab){this.addHandler("OnGridConsistent",Ab)}jCg(Ab){this.removeHandler("OnGridConsistent",Ab)}Fxh(Ab){this.addHandler("CellEditingStarted",Ab)}pik(Ab){this.removeHandler("CellEditingStarted",Ab)}Exh(Ab){this.addHandler("CellEditingEnded",Ab)}oik(Ab){this.removeHandler("CellEditingEnded",Ab)}C6(){this.raiseEvent("FCPaneCollapsed");this.q0c();this.snb=!1;Q.ULS.sendTraceTag(508385100,
0,50,"TaskPane Collapsed")}qE(){this.raiseEvent("FCPaneClosed");this.q0c();window.setTimeout(()=>{this.dispose()},0);Q.ULS.sendTraceTag(508385099,0,50,"TaskPane Closed")}vUj(){this.qK&&(this.isFloatingObjectSelected=this.da.ha.$e.isFloatingObjectSelected);if(!this.snb)if(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8593272_FormatCellSheetProtectionFix")&&!(new pa.a(this.$.sa)).Hj(4))this.Lib.hideTaskPane();else switch(this.activePage){case id.NumberFormatItemView:Ac.KKd(this.$,this.properties,this.Ah).TRg(this.properties);
Q.ULS.sendTraceTag(508389441,0,50,"NumberFormatTaskPane Opened");break;case id.AlignmentItemView:Ac.wHd(this.$,this.properties,this.Ah).POa();Q.ULS.sendTraceTag(508389440,0,50,"Alignment TaskPane Opened");break;case id.FontItemView:Ac.pAc(this.$,this.properties,this.Ah).Z6b(id.FontItemView);Q.ULS.sendTraceTag(508078217,0,50,"Font tab opened");break;case id.BorderItemView:Ac.pAc(this.$,this.properties,this.Ah).Z6b(id.BorderItemView),Q.ULS.sendTraceTag(507896131,0,50,"Border tab opened")}}dispose(){this.Lib=
this.$=null;this.snb=!1;this.properties=null;cc.Wa=null}BYk(){const Ab=this;return No(function*(){var xc;if(null!==(xc=Ab.properties)&&void 0!==xc&&xc.event){xc=Ab.properties.event.rawEvent||Ab.properties.event;var eb=xc.type.includes("key")?"keyboard":"mouse";(yield Ya.a.resolve(sa.yd)).ix(xc,`task_pane_open_format_cell_${eb}`,null,["task-pane"])}})}yz(){this.da.ha.add_activeCellChanged(this.onActiveCellChanged);this.da.ha.$e.MN(this.xu);this.$.ea&&(this.$.ea.EL(this.$Wb),this.$.ea.gFa(this.hB));
this.$.Lp(this.Li);this.P_a&&(this.da.sh.FQ(this.zeg),this.da.sh.RW(this.Aeg))}q0c(){this.da.ha.remove_activeCellChanged(this.onActiveCellChanged);this.da.ha.$e.sV(this.xu);this.$.ea&&(this.$.ea.TM(this.$Wb),this.$.ea.Xza(this.hB));this.$.Au(this.Li);this.P_a&&(this.da.sh.nS(this.zeg),this.da.sh.v1(this.Aeg))}CIa(){return{onItemClick:Ab=>{if(this.qK||!this.isFloatingObjectSelected){this.activePage===id.FormatCellsListView&&Q.ULS.sendTraceTag(507597594,0,50,`User switched from Format Cells List View to ${id[Ab]}`);
var xc={};xc[ld.a.sia]=!1;switch(Ab){case id.NumberFormatItemView:this.$.ei(-395879625,K.a.eh,12,xc);break;case id.AlignmentItemView:this.$.ei(-2019948858,K.a.eh,12,xc);break;case id.FontItemView:this.$.ei(456320978,K.a.eh,12,xc);break;case id.BorderItemView:this.$.ei(119664190,K.a.eh,12,xc)}}},numberFormatCallbacks:this.fPi(),alignmentCallbacks:this.gCi()}}iJk(Ab){switch(Ab){case id.AlignmentItemView:case id.NumberFormatItemView:return!0;default:return!1}}}Object(M.a)(cc,"FormatCellsTaskPaneManager",
fb.a,[]);var mc=a(957);class Sa{constructor(Ab,xc,eb){this.B9=!1;this.cN=this.Hyf=this.Xv=null;this.uZb=-1;this.ZWc=!0;this.GP=!1;this.qK=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8586390_FloatingObjectFormatCellsCentralFix");this.categoryDescriptionStrings=[Za.a.instance.ia(2306),Za.a.instance.ia(2307),Za.a.instance.ia(2308),Za.a.instance.ia(2309),Za.a.instance.ia(2310),Za.a.instance.ia(2311),Za.a.instance.ia(2312),Za.a.instance.ia(2313),Za.a.instance.ia(2314),Za.a.instance.ia(2315),Za.a.instance.ia(2316),
Za.a.instance.ia(2317)];this.MR=Ub=>{this.cN[Ub]=this.cN[Ub]?this.cN[Ub]+1:1;this.cN.Total+=1};this.qE=()=>{this.dispose()};this.C6=()=>{this.c1g()};this.tMa=()=>{const Ub=this.numberFormatViewModel.fGc(4,"NumberFormatTaskPaneManager.OnNumberFormatViewModelLoaded"),Fc=this.numberFormatViewModel.fGc(3,"NumberFormatTaskPaneManager.OnNumberFormatViewModelLoaded");if(Fc||Ub)this.So.K7(id.NumberFormatItemView,this.dEf()),Fc?(this.ZWc?(this.numberFormatViewModel.formatCells(this.numberFormatViewModel.UYa(),
this.Ah),this.uZb=-1):this.ZWc=!0,Q.ULS.sendTraceTag(508355619,0,50,"NumberFormatViewModel Loaded by the TaskPane")):Q.ULS.sendTraceTag(508355618,0,50,"NumberFormatViewModel Loaded by the Active Cell")};this.sMa=()=>{Q.ULS.sendTraceTag(508889099,0,50,"NumberFormatTaskPaneManager.onNumberFormatViewModelFailedLoad - Webservice call failed")};this.onActiveCellChanged=(Ub,Fc)=>{var rd;if(Fc&&Fc.description===id[id.NumberFormatItemView]){this.MR("ActiveCellChange");Ub=null===(rd=ba.f(this.$).kh(null))||
void 0===rd?void 0:rd.cell;if(!this.qK&&this.So.isFloatingObjectSelected||this.BYf(Ub))this.qK||(this.So.isFloatingObjectSelected=!1),this.x5(!0,4);!xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8606029_PaneUpdateRegressionFix")&&Ub&&(this.Tkd=Ub)}};this.xu=(Ub,Fc)=>{Fc&&Fc.dGd===id.NumberFormatItemView&&(this.qK?0!==(Fc.wk&470)?this.So.K7(id.NumberFormatItemView,null):this.x5(!0,4):this.So.K7(id.NumberFormatItemView,null,!0))};this.hB=(Ub,Fc)=>{var rd,Gd;Fc&&Fc.description===id[id.NumberFormatItemView]&&
(Ub=null===(rd=ba.f(this.$).kh(null))||void 0===rd?void 0:rd.cell,this.BYf(Ub)&&!this.GP?(this.ZWc=!1,this.x5(!0)):(this.GP=!1,xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8606029_PaneUpdateRegressionFix")&&(this.uZb=null!==(Gd=null===Ub||void 0===Ub?void 0:Ub.Vn)&&void 0!==Gd?Gd:-1)))};this.$=Ab;this.properties=xc;this.Ah=eb;this.So=Ac.Uyc(this.$,this.properties,this.Ah);this.cN={Total:0}}static getInstance(Ab,xc,eb){return this.Wa||(this.Wa=new this(Ab,xc,eb))}TRg(Ab){this.So.K7(id.NumberFormatItemView,
this.Hyf);xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8589523_AvoidApplyingFormatOnPaneOpen")&&(this.ZWc=!1);this.x5(!0,3,Ab)}dispose(){Q.ULS.sendTraceTag(507875737,0,20,`Number format usage ${JSON.stringify(this.cN)}`);this.c1g();this.So.age(this.qE);Sa.Wa=null}CIa(){return{onCategoryTypeChange:Ab=>{this.MR("CategoryTypeChange");this.Xv.NumberFormatCategory=Ab;this.GP=!0;switch(Ab){case 0:case 9:this.Nka();break;default:this.x5()}Q.ULS.sendTraceTag(508387598,0,50,`Number Format Category Changed ${Ab}`)},
onThousandSeparatorChanged:Ab=>{this.MR("ThousandsSeparatorChange");this.Xv.IsComma=Ab;this.GP=!0;this.x5();Q.ULS.sendTraceTag(508368995,0,50,`Thousand Separator Changed ${Ab}`)},onDecimalPlacesChanged:Ab=>{this.MR("DecimalPlacesChange");this.Xv.DecimalPlaces=Ab;this.GP=!0;switch(this.Xv.NumberFormatCategory){case 3:case 6:case 8:xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8507884_FixIncreaseDecreaseDecimalFlicker")?this.x5():this.Nka();break;default:this.x5()}Q.ULS.sendTraceTag(508368994,0,50,
`Decimal Places Changed ${Ab}`)},onLocaleChanged:Ab=>{this.MR("LocaleChange");this.Xv.LocaleType=Ab;this.GP=!0;this.x5();Q.ULS.sendTraceTag(508389409,0,50,`Locale Changed ${Ab}`)},overrideLocale:()=>{this.MR("overrideLocale");this.GP=!0;this.$.ei(151715844,K.a.eh,12,{selectedIndex:this.Xv.LocaleType});Q.ULS.sendTraceTag(508389408,0,50,`Override default Locale button clicked ${this.Xv.LocaleType}`)},onInputCalendarChecked:Ab=>{this.MR("InputCalendarChecked");this.GP=!0;this.Xv.IsInputCalendar=Ab;this.x5();
Q.ULS.sendTraceTag(508387596,0,50,"Change in Input Calendar Type")},onGannenChecked:Ab=>{this.MR("GannenChecked");this.Xv.IsGannen=Ab;this.GP=!0;this.x5();Q.ULS.sendTraceTag(508389407,0,50,`Gannen changed ${this.Xv.LocaleType} ${Ab}`)},onCalendarTypeChanged:Ab=>{this.MR("CalendarTypeChange");this.Xv.CalendarType=Ab;this.GP=!0;this.x5();Q.ULS.sendTraceTag(508389406,0,50,`Calendar Type changed ${Ab}`)},onSymbolChanged:Ab=>{this.MR("SymbolChange");this.Xv.CurrencyType=Ab;this.GP=!0;3===this.Xv.NumberFormatCategory?
this.Nka():this.x5();Q.ULS.sendTraceTag(508387595,0,50,`Currency Symbol changed ${Ab}`)},onNegativeNumberTypeChanged:Ab=>{this.MR("NegativeNumberTypeChange");this.GP=!0;this.Xv.NegativeNumberType=Ab;this.Nka();Q.ULS.sendTraceTag(508387594,0,50,`Negative Number Type changed ${Ab}`)},onDateTypeChanged:Ab=>{this.MR("DateTypeChange");this.GP=!0;this.Xv.DateType=Ab;this.Nka();Q.ULS.sendTraceTag(508387593,0,50,`Date Type Changed ${Ab}`)},onTimeTypeChanged:Ab=>{this.MR("TimeTypeChange");this.GP=!0;this.Xv.TimeType=
Ab;this.Nka();Q.ULS.sendTraceTag(508387592,0,50,`Time Type changed ${Ab}`)},onFractionTypeChanged:Ab=>{this.MR("FractionTypeChange");this.GP=!0;this.Xv.FractionType=Ab;this.Nka();Q.ULS.sendTraceTag(508387591,0,50,`Fraction Type changed ${Ab}`)},onSpecialTypeChanged:Ab=>{this.MR("SpecialTypeChange");this.GP=!0;this.Xv.SpecialType=Ab;this.Nka();Q.ULS.sendTraceTag(508387590,0,50,`Special Type changed ${Ab}`)},onCustomTypeChanged:Ab=>{this.MR("CustomTypeChange");this.GP=!0;this.Xv.CustomType=Ab;this.Nka();
Q.ULS.sendTraceTag(508387589,0,50,`CustomType changed ${Ab}`)},onNegativeCurrencyTypeChanged:Ab=>{this.MR("NegativeCurrencyTypeChange");this.GP=!0;this.Xv.NegativeCurrencyType=Ab;this.Nka();Q.ULS.sendTraceTag(508387588,0,50,`Negative Currency Type changed ${Ab}`)}}}x5(Ab,xc,eb){xc=void 0===xc?3:xc;let Ub=null;if(this.activeCell=this.wxc())c("NumberFormatTab::DelayedUpdate::Start"),eb&&(eb.currencyType||K.a.Ai in eb&&eb[K.a.Ai])&&(Ub=parseInt(eb[K.a.Ai].toString(),10)),this.numberFormatViewModel?(this.B9||
this.QRc(),Ub||Ab?this.i4f(Ub,xc,eb):(this.Xv.Caller=xc,this.numberFormatViewModel.gNb(this.activeCell,this.Xv))):this.d4h(Ub)}d4h(Ab){void Ya.a.resolve(sa.Zd,{va:0}).then(xc=>{this.numberFormatViewModel=xc;this.B9||this.QRc();this.numberFormatViewModel.Gie();this.i4f(Ab)})}QRc(){this.B9=!0;this.numberFormatViewModel.Ucb(this.tMa);this.numberFormatViewModel.Rmd(this.sMa);this.So.Cmd(this.C6);this.So.Bmd(this.qE);this.So.add_activeCellChanged(this.onActiveCellChanged);this.So.MN(this.xu);this.So.g1e(this.hB);
Q.ULS.sendTraceTag(508355648,0,50,"NumberFormatViewModel events Registered")}i4f(Ab,xc,eb){xc=void 0===xc?3:xc;Ab=Object(Ia.a)(new mc.a,{Caller:xc,NumberFormatCategory:null!==Ab&&void 0!==Ab?Ab:-1});eb&&eb.currencyType&&(Ab.CurrencyType=eb.currencyType,Ab.NumberFormatCategory=3);this.numberFormatViewModel.gNb(this.activeCell,Ab)}dEf(Ab){var xc=this.numberFormatViewModel.Wo.NumberFormatElement.toString();this.Xv=Ab=Ab?this.eCf():this.numberFormatViewModel.UYa();return this.Hyf=xc={numberFormatModel:{categories:this.numberFormatViewModel.Wo.Categories,
categoryDescriptionStrings:this.categoryDescriptionStrings,negativeNumberTypes:this.numberFormatViewModel.Wo.NegativeNumberTypes,negativeCurrencyTypes:this.numberFormatViewModel.Wo.NegativeCurrencyTypes,currencySymbols:this.numberFormatViewModel.Wo.CurrencySymbols,dateTypes:this.numberFormatViewModel.Wo.DateTypes,timeTypes:this.numberFormatViewModel.Wo.TimeTypes,fractionTypes:this.numberFormatViewModel.Wo.FractionTypes,specialTypes:this.numberFormatViewModel.Wo.SpecialTypes,customTypes:this.numberFormatViewModel.Wo.CustomTypes,
localeOptions:this.numberFormatViewModel.Wo.Locales,calendarTypes:this.numberFormatViewModel.Wo.Calendars,isInputCalendarCheckboxRequired:"57607"===xc||"319751"===xc?!0:!1,isGannenCheckboxRequired:"319751"===xc?!0:!1,currentCategory:Ab.NumberFormatCategory,decimalPlaces:Ab.DecimalPlaces,isComma:Ab.IsComma,currencyType:Ab.CurrencyType,negativeNumberType:Ab.NegativeNumberType,dateType:Ab.DateType,timeType:Ab.TimeType,fractionType:Ab.FractionType,specialType:Ab.SpecialType,customType:Ab.CustomType,negativeCurrencyType:Ab.NegativeCurrencyType,
calendarType:Ab.CalendarType,localeIndex:Ab.LocaleType,isInputCalendarChecked:Ab.IsInputCalendar,isGannenChecked:Ab.IsGannen}}}wxc(){var Ab,xc;let eb;const Ub=ba.f(this.$),Fc=Ub.ha.qa.activeCell;if(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8606029_PaneUpdateRegressionFix")){var rd=null===(Ab=Ub.kh(Fc))||void 0===Ab?void 0:Ab.cell;this.uZb=null!==(xc=null===rd||void 0===rd?void 0:rd.Vn)&&void 0!==xc?xc:-1}else this.Tkd=null===(rd=Ub.kh(Fc))||void 0===rd?void 0:rd.cell;Fc&&(eb=I.p(Fc,this.$));return eb}c1g(){this.B9=
!1;this.numberFormatViewModel&&(this.numberFormatViewModel.ltb(this.tMa),this.numberFormatViewModel.rge(this.sMa),this.So.bge(this.C6),this.So.remove_activeCellChanged(this.onActiveCellChanged),this.So.sV(this.xu),this.So.jCg(this.hB),Q.ULS.sendTraceTag(508355617,0,50,"NumberFormatViewModel events Un-registered"))}eCf(){const Ab=this.numberFormatViewModel.UYa();Ab.NumberFormatCategory=this.Xv.NumberFormatCategory;Ab.NegativeNumberType=this.Xv.NegativeNumberType;Ab.NegativeCurrencyType=this.Xv.NegativeCurrencyType;
Ab.DateType=this.Xv.DateType;Ab.TimeType=this.Xv.TimeType;Ab.FractionType=this.Xv.FractionType;Ab.SpecialType=this.Xv.SpecialType;Ab.CustomType=this.Xv.CustomType;Ab.DecimalPlaces=this.Xv.DecimalPlaces;Ab.CurrencyType=this.Xv.CurrencyType;return Ab}Nka(){c("NumberFormatTab::InstantUpdate::Start");this.numberFormatViewModel.formatCells(this.eCf(),this.Ah);this.uZb=-1;this.So.K7(id.NumberFormatItemView,this.dEf(!0))}BYf(Ab){return xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8606029_PaneUpdateRegressionFix")?
Ab&&Ab.Vn!==this.uZb:Ab&&this.Tkd&&Ab.Vn!==this.Tkd.Vn}}Object(M.a)(Sa,"NumberFormatTaskPaneManager",null,[2]);class pb{constructor(Ab,xc,eb){this.B9=!1;this.activePage=id.FormatCellsListView;this.isFloatingObjectSelected=!1;this.qK=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8586390_FloatingObjectFormatCellsCentralFix");this.qE=()=>{this.dispose()};this.C6=()=>{this.$o()};this.onActiveCellChanged=(Ub,Fc)=>{this.isFloatingObjectSelected&&Fc&&Fc.description===id[this.activePage]&&(this.Z6b(this.activePage),
this.isFloatingObjectSelected=!1)};this.xu=(Ub,Fc)=>{Fc&&Fc.dGd===this.activePage&&(this.isFloatingObjectSelected=!0,this.So.K7(this.activePage,null,!0))};this.So=Ac.Uyc(Ab,xc,eb);xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8498050_PollForStateFontTabEdgeFix")&&(this.reactRibbonRoot=Ab.ka.Ug(337,!0))}static getInstance(Ab,xc,eb){return this.Wa||(this.Wa=new this(Ab,xc,eb))}Z6b(Ab){this.So.K7(Ab,null);this.activePage=Ab;this.B9||this.fq();xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8498050_PollForStateFontTabEdgeFix")&&
requestAnimationFrame(()=>{this.reactRibbonRoot.fn()})}dispose(){this.$o();this.So.age(this.qE);pb.Wa=null}fq(){this.So.Cmd(this.C6);this.So.Bmd(this.qE);this.qK||(this.So.add_activeCellChanged(this.onActiveCellChanged),this.So.MN(this.xu));this.B9=!0;Q.ULS.sendTraceTag(508078168,0,50,"Events registered")}$o(){this.So.bge(this.C6);this.qK||(this.So.remove_activeCellChanged(this.onActiveCellChanged),this.So.sV(this.xu));this.B9=!1;Q.ULS.sendTraceTag(508078167,0,50,"Events unregistered")}}Object(M.a)(pb,
"StoreConnectedItemViewTaskPaneManager",null,[2]);class Ac{constructor(){}static Uyc(Ab,xc,eb){return cc.getInstance(Ab,xc,eb)}static KKd(Ab,xc,eb){return Sa.getInstance(Ab,xc,eb)}static wHd(Ab,xc,eb){return Fd.getInstance(Ab,xc,eb)}static pAc(Ab,xc,eb){return pb.getInstance(Ab,xc,eb)}}Object(M.a)(Ac,"FormatCellsTaskPaneHelper",null,[]);let yd=class{constructor(Ab,xc){this.WJ=xc;this.$=Ab}Bi(){return!1}executeCommand(Ab,xc,eb){var Ub;Ab=!1;const Fc=xc.command;switch(Fc){case 2055979337:Ac.Uyc(this.$,
eb,xc).K7(id.FormatCellsListView,null);Ab=!0;Q.ULS.sendTraceTag(508369024,0,50,"FormatCellsTaskPane opened using FormatCells Command");break;case -395879625:Ac.KKd(this.$,eb,xc).TRg(eb);Ab=!0;Q.ULS.sendTraceTag(508385094,0,50,"NumberFormat Tab in FormatCellsTaskPane opened using showNumberFormat");break;case -2019948858:Ac.wHd(this.$,eb,xc).POa();Ab=!0;Q.ULS.sendTraceTag(508385093,0,50,"Alignment Tab in FormatCellsTaskPane opened using showAlignmentPane");break;case 456320978:Ac.pAc(this.$,eb,xc).Z6b(id.FontItemView);
Ab=!0;Q.ULS.sendTraceTag(508078218,0,50,"Font Tab in FormatCellsTaskPane opened.");break;case 119664190:Ac.pAc(this.$,eb,xc).Z6b(id.BorderItemView),Ab=!0,Q.ULS.sendTraceTag(507896130,0,50,"Border Tab in FormatCellsTaskPane opened.")}xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8607151_FormatTaskpaneFloatieUI")&&(xc=null!==(Ub=eb[ld.a.t8a])&&void 0!==Ub?Ub:0,Ab&&9===xc&&this.WJ.hUb()&&this.WJ.xI());return Ab?Ea.Task.Va(!0):fa.a(Fc)}ni(Ab,xc){switch(xc.command){case 2055979337:case -395879625:case -2019948858:case 456320978:case 119664190:return!0;
default:return!1}}Ji(){return!1}};yd=Object(N.__decorate)([Object(Ya.d)(sa.tc),Object(N.__param)(0,Object(sa.Lb)()),Object(N.__param)(1,Object(sa.cb)())],yd);Object(M.a)(yd,"FormatCellsCommandHandler",null,[39]);Object(Ya.b)(sa.wc)(Ab=>No(function*(){const xc=yield Ya.a.resolve(sa.Dc,Ab),eb=yield Ya.a.resolve(sa.E,Ab);yield eb.DRf;return new vb(xc.getFormulaAnonymizer(eb.config))}));class vb{constructor(Ab){this.DDh=Ab}anonymize(Ab,xc){return this.DDh.anonymize(Ab,{row:xc.top-1,col:xc.left-1,rows:1,
cols:1})}}Object(M.a)(vb,"FormulaAnonymizer",null,[]);class Sc{constructor(Ab,xc,eb,Ub){this.$=Ab;this.formulaAssistanceUIControl=xc;this.BC=eb;this.sF=Ub;this.kYb=He.a.WXf();this.Gxa=this.lLe=!1;this.Iaa={repairs:[],cell:null};this.da=Object(ba.f)(this.$);this.container=document.createElement("div");this.$.domElement.appendChild(this.container)}get jKa(){return this.lLe}set jKa(Ab){this.lLe=Ab;this.sF.Co=Ab}lNk(Ab,xc,eb,Ub){Ub=void 0===Ub?"beside":Ub;this.vpd("card");this.BC.xhe("repair",xc.repairs.length);
this.jKa=!0;const Fc=this.Psd(Ab),rd=Object.assign({},xc,{callbacks:eb,grl:Ub});this.Iaa={repairs:xc.repairs,cell:Ab.fC};this.formulaAssistanceUIControl.renderFormulaRepair(this.container,Fc,rd);this.hxe=Gd=>{Gd=Object.assign({},rd,{repairs:Gd});this.formulaAssistanceUIControl.renderFormulaRepair(this.container,Fc,Gd)}}FNk(Ab,xc){this.vpd("card");this.BC.xhe("errorIndication");this.jKa=!0;Ab=this.Psd(Ab);this.formulaAssistanceUIControl.renderSyntaxErrorIndication(this.container,Ab,xc)}FLk(Ab,xc){this.vpd("icon");
this.BC.xhe("icon");this.Gxa=!0;Ab=this.Psd(Ab);this.formulaAssistanceUIControl.renderFormulaRepairIcon(this.container,Ab,xc)}hide(Ab){let xc=!1;this.Gxa&&(xc=!0,this.Gxa=!1);this.jKa&&(this.kYb&&"commit"!==Ab&&this.Iaa.repairs&&0<this.Iaa.repairs.length&&this.Iaa.cell&&this.BC.w8d(this.Iaa),xc=!0,this.jKa=!1,this.hxe=null);xc&&(this.formulaAssistanceUIControl.dismiss(this.container),this.BC.enk(Ab),this.Iaa={repairs:[],cell:null});return xc}vpd(Ab){Q.ULS.shipAssertTag(508315279,0,!this.jKa&&!this.Gxa,
`FormulaRepairControl: Trying to show ${Ab} while a ui is shown. Card: ${this.jKa}, icon:${this.Gxa}.`)}Psd(Ab){Ab=this.da.getCellBounds(Ab,!0);return{top:Ab.y,bottom:Ab.y+Ab.height,left:Ab.x,right:Ab.x+Ab.width}}}Object(M.a)(Sc,"FormulaRepairControl",null,[]);var hd=a(303),qc=a(7),Lc=a(301),bd=a(16);class jd{constructor(Ab,xc,eb){this.$=Ab;this.Mke=xc;this.formulaAssistanceUIControl=eb;this.uVa=!1}get Co(){return this.uVa}set Co(Ab){this.uVa!==Ab&&(Ab?Lc.a(this.$).Eq(this):Lc.a(this.$).FH(this),
this.uVa=Ab)}get Hk(){return this.Mke}get Pi(){return this.Bs}set Pi(Ab){this.Bs=Ab}zp(Ab,xc){Ab=!1;xc||(Ab=this.formulaAssistanceUIControl.focusElement(this.Pi));return Ab}Yp(Ab){return null!=this.Pi?bd.DOMElementExtensions.Cn(this.Pi,Ab):!1}gs(){}Xt(){}}Object(M.a)(jd,"FormulaRepairFocusManager",null,[59]);var Yd=a(279),te=a(642);class oe{constructor(Ab,xc,eb,Ub,Fc){this.$=Ab;this.pluginScheduler=xc;this.d0g=eb;this.BC=Ub;this.tye=Fc;this.PYd=He.a.RFc();this.isValuePreviewEnabled=this.EWd=this.GYf=
this.QXd=!1;this.DQc=this.Arc=null;this.Yv={id:0,active:!1,cell:null};this.WEc=!1;this.onActiveCellChanged=(rd,Gd)=>{var ue,Ce;this.QXd=!1;if(this.WEc){if(this.Yv.active&&Object(hd.b)(Gd.cell)&&Gd.cell.range.toString()===(null===(ue=this.Yv.cell)||void 0===ue?void 0:ue.fC.toString()))return;if(Object(hd.b)(this.DQc)){rd=null===(Ce=this.da.kh(this.DQc))||void 0===Ce?void 0:Ce.cell;void this.F3b("editCommitted",rd);this.DQc=null;return}}this.hide("selection");void this.F3b("selection")};this.onScroll=
()=>{this.hide("scroll")};this.LYj=(rd,Gd)=>{const ue=this.Yv.cell;if(Object(hd.c)(rd))this.control.FNk(ue,this.CIa("SyntaxErrorIndication"));else{this.Arc=rd;var Ce;this.isValuePreviewEnabled&&(Ce=this.lji(this.Arc.repairs));this.Aij&&"editCommitted"!==Gd?this.Zvb("icon"):this.isValuePreviewEnabled?void this.Ual(Ce):this.Zvb("card")}};this.Zvb=rd=>{this.EWd&&!this.GYf&&this.da.domElement.addEventListener("scroll",this.onScroll);"card"===rd?this.control.lNk(this.Yv.cell,this.Arc,this.CIa("FormulaRepairCard"),
this.NQi()):"icon"===rd&&this.control.FLk(this.Yv.cell,this.SRj)};this.SRj=()=>{this.control.hide("commit");this.Zvb("card")};this.CIa=rd=>({onCommit:this.onCommit,onFeedback:this.onFeedback(rd),onDismiss:this.onDismiss,onIgnore:this.onIgnore,onRender:this.onRender,getItemHighlights:this.zWf?this.GSi:void 0});this.onCommit=rd=>{const Gd=this.Yv.cell.fC;this.da.setCell({Text:rd.text,Fonts:[],TextRuns:[]},Gd,0,127,null);this.PYd&&this.BC.QYd.Ong({kq:Gd,cellText:rd.text,committed:!0});this.hide("commit")};
this.onDismiss=()=>{this.Arc=null};this.onIgnore=()=>{this.Oog("ignore")};this.onFeedback=rd=>()=>{const Gd={};Gd[qc.a.zO]=rd;this.$.ei(802602464,0,19,Gd)};this.onRender=rd=>{rd&&(this.sF.Pi=rd)};this.Yfk=rd=>{const Gd=this.Yv.id,ue=()=>{this.Yv.id===Gd&&void this.F3b(rd,this.Yv.cell);this.da.za.Ix(ue)};this.da.za.Uy(ue)};this.GSi=rd=>{this.cD||Q.ULS.sendTraceTag(508347539,0,15,"FormulaRepair.getRepairItemHighlights: formulaHighlightsControl is null");var Gd=this.cD.rWi(rd.text,[te.HighlightKind.Parentheses]);
if(!Gd)return null;const ue=Gd.highlightRanges;var Ce=Gd.i_c;Gd=[];var Se=0;for(var of=0;of<Ce.length;of++){const jf=Ce[of];Gd.push({start:Se,end:Se+jf.text.length,color:jf.color});Se+=jf.text.length}rd=rd.repairedFormulaParts;Ce=[];for(of=Se=0;Se<rd.length&&of<Gd.length;)Ce.push({location:{start:Math.max(rd[Se].location.start,Gd[of].start),end:Math.min(rd[Se].location.end,Gd[of].end)},type:rd[Se].type,color:Gd[of].color}),rd[Se].location.end<Gd[of].end?Se++:(rd[Se].location.end>Gd[of].end||Se++,
of++);return{coloredParts:Ce,highlightRanges:ue}};this.en=()=>{this.hide("edit")};this.yl=(rd,Gd)=>{rd=Gd.committed;var ue=Gd.kHa;Gd=Gd.kq;const Ce="keydown"===(null===ue||void 0===ue?void 0:ue.type);ue=rd&&Ce&&!(null===ue||void 0===ue?0:ue.ctrlKey);this.WEc?ue?this.DQc=Gd:Ce&&void this.F3b(rd?"editCommitted":"editDismissed"):rd||void this.F3b("editDismissed")};this.da=Object(ba.f)(this.$);this.sF=new jd(this.$,Yd.a.bzf,this.d0g);this.control=new Sc(this.$,this.d0g,Ub,this.sF);this.da.ha.add_activeCellChanged(this.onActiveCellChanged);
this.da.sh.FQ(this.en);this.da.sh.Wx(this.yl);(this.zWf=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8165579_isFormulaRepairHighlightingEnabled"))&&(sa.zc.Ha()?void Ya.a.hj(sa.zc).then(rd=>{this.cD=rd.cD}):this.$.ka.Lh(464,rd=>{this.cD=rd.cD}));this.EWd=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8232494_formulaRepairCardUIAdditions");this.isValuePreviewEnabled=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8098420_formulaRepairValuePreview")&&He.a.Dna();this.Aij=xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaRepairIcon",
!1)&&"renderFormulaRepairIcon"in eb;this.WEc=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8268618_showFormulaRepairOnCellEditEnded")}Oog(Ab){this.hide(Ab)&&(this.QXd=!0)}F3b(Ab,xc){xc=void 0===xc?null:xc;const eb=this;return No(function*(){var Ub;if(!eb.da.isEditing&&!eb.QXd){var Fc=null!==xc&&void 0!==xc?xc:null===(Ub=eb.da.kh(null))||void 0===Ub?void 0:Ub.cell;eb.Yv={active:!1,id:eb.Yv.id+1,cell:Fc};eb.da.za.H5()?!Object(hd.c)(Fc)&&Fc.hasError&&(eb.Yv.active=!0,eb.BC.addressable.selected++,Ub=
eb.pluginScheduler.requester().formulaRepair({formula:eb.Yv.cell.text},te.PluginGroup.Excel,null),Ub=yield eb.WEc?eb.rze(Ub):Ub,Object(hd.c)(Ub)||"Done"!==Ub.kind?eb.Yv.active=!1:eb.LYj(Ub.payload,Ab)):eb.Yfk(Ab)}})}Ual(Ab){const xc=this;return No(function*(){let eb;var Ub=new Promise(Fc=>{eb=setTimeout(()=>{Fc(!0)},100)});Ub=Promise.race([Ub,Ab]).finally(()=>clearTimeout(eb));(yield xc.rze(Ub))&&xc.Zvb("card")})}lji(Ab){const xc=this;return No(function*(){const eb=Array(Ab.length);for(let Fc=0;Fc<
Ab.length;Fc++){var Ub=xc.tye.eie({text:Ab[Fc].text,index:0,length:Ab[Fc].text.length},2E3,!1);if((Ub=yield xc.rze(Ub))&&"Success"===Ub.kind)eb[Fc]=Ub.value;else return!1}Ab.forEach((Fc,rd)=>Fc.formulaValue=eb[rd]);xc.control.jKa&&Object(hd.b)(xc.control.hxe)&&xc.control.hxe(Ab);return!0})}rze(Ab){const xc=this;return No(function*(){const eb=xc.Yv.id,Ub=yield Ab;return xc.Yv.id===eb&&xc.Yv.active?Ub:null})}hide(Ab){this.Yv.active=!1;this.Yv.cell=null;this.EWd&&this.GYf&&this.da.domElement.removeEventListener("scroll",
this.onScroll);return this.control.hide(Ab)}NQi(){const Ab=this.da.ha.qa.activeCell,xc=this.Yv.cell.fC;if(Ab&&xc&&Ab.left!==xc.left)return"below"}}Object(M.a)(oe,"FormulaRepair",null,[]);Object(Ya.b)(sa.Mc,{yk:"singleton"})(Ab=>No(function*(){var xc;const eb=yield Ya.a.resolve(sa.Lb,Ab),Ub=Ya.a.resolve(oa.k,Ab),Fc=Object(bb.e)(ea.GetServiceTaskFactory.Bj(eb.ka,448,449,null!==(xc=Ab.va)&&void 0!==xc?xc:0));var rd=sa.zc.Ha();xc=rd?Promise.resolve(void 0):Ya.a.resolve(sa.Rc,Ab);rd=rd?Ya.a.resolve(sa.zc,
Ab):Promise.resolve(void 0);const Gd=Ya.a.resolve(sa.Nc,Ab),ue=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8098420_formulaRepairValuePreview")?Ya.a.resolve(sa.Cc,Ab):Promise.resolve(void 0),[Ce,Se,of,jf,bf]=yield Promise.all([Ub,Fc,xc,Gd,ue,rd]);return new oe(eb,Ce,Se,jf,bf,of)}));class Kd{constructor(Ab){this.$=Ab;this.Iaa=null;this.o2d=0;this.yl=(xc,eb)=>{this.$o();this.Qhj(eb)&&this.o2d++;this.Iaa=null};this.da=ba.f(this.$)}w8d(Ab){this.Iaa=Ab;this.registerEvent()}registerEvent(){this.da.cellTextEditBox.RW(this.yl)}$o(){this.da.cellTextEditBox.v1(this.yl)}Qhj(Ab){return Ab.committed&&
null!==this.Iaa&&Ab.kq.equals(this.Iaa.cell)&&this.Iaa.repairs.some(xc=>xc.text.toLowerCase().replace(/\s+/g,"")===Ab.cellText.toLowerCase().replace(/\s+/g,""))}}Object(M.a)(Kd,"ManualFormulaRepairTelemetry",null,[]);let Ee=class{constructor(Ab,xc){this.QYd=Ab;this.$=xc;this.PYd=He.a.RFc();this.kYb=He.a.WXf();this.id=0;this.mya=null;this.SUd=!1;this.Ak={reportName:"FormulaRepair",addressable:{selected:0,committed:0},repairUsage:b(),indicationUsage:b(),iconUsage:b()};xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8187492_addKeptTelemetryToXlencReport")&&
(this.Ak.repairUsage.keptData=this.QYd.fKd());this.kYb&&(this.n2d=new Kd(this.$),this.Ak.repairUsage.manualRepair=this.n2d.o2d);this.repairUsage=this.Ak.repairUsage;this.indicationUsage=this.Ak.indicationUsage;this.iconUsage=this.Ak.iconUsage;this.addressable=this.Ak.addressable;this.Ufk();this.SUd=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8171627_FormulaRepairLogDurations")}xhe(Ab,xc){switch(Ab){case "repair":this.ycb=this.repairUsage;this.ycb.show.repairCounts.push(xc);break;case "icon":this.ycb=
this.iconUsage;break;case "errorIndication":this.ycb=this.indicationUsage}this.ycb.show.count++;this.SUd&&(this.mya=performance.now());this.FSf()}enk(Ab){if(this.SUd)if(null!==this.mya){const xc=performance.now()-this.mya;this.ycb.hideDurations[Ab].push(xc)}else Q.ULS.sendTraceTag(508370960,1,10,"FormulaRepairTelemetry.reportHide: lastShowTime is null");else this.ycb.hide[Ab]++;this.FSf();this.mya=null}w8d(Ab){this.kYb&&this.n2d.w8d(Ab)}Ufk(){this.$.ka.Lh(276,Ab=>{Ab.r3(this.Ak)})}FSf(){Q.ULS.sendTraceTag(509137429,
1,50,`${JSON.stringify({id:this.id++,addressable:this.addressable,repairUsage:this.repairUsage,indicationUsage:this.indicationUsage,keptData:this.PYd?this.QYd.fKd():"",manualRepair:this.kYb?this.n2d.o2d:""})}`)}};Ee=Object(N.__decorate)([Object(Ya.d)(sa.Nc),Object(N.__param)(0,Object(sa.Bd)()),Object(N.__param)(1,Object(sa.Lb)())],Ee);Object(M.a)(Ee,"FormulaRepairTelemetry",null,[]);var rc=a(46),fd=a(905),Ed=a(26),Rd=a(121),Fe=a(479);class Ae{static getSelection(Ab,xc,eb){var Ub=Ab.qa;Ab=Ub.activeCell.clone();
Ub=Ub.activeRange;Ub.fk&&(Q.ULS.sendTraceTag(507556643,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top (${Ab.top}) and firstUnfreezeCell.Bottom (${Ab.bottom}) to equal topLeftRange.Top (${xc.top})`),Ab.top=Ab.bottom=xc.top);Ub.isRow&&(Q.ULS.sendTraceTag(507556642,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left (${Ab.left}) and firstUnfreezeCell.Right (${Ab.right}) to equal topLeftRange.Left (${xc.left})`),
Ab.left=Ab.right=xc.left);if(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8599861_RowColumnFreezeOnLastBlockFix"))switch(eb.command){case -73576432:case -1156879868:Ab.top===Ab.maxRows&&(Ab.top=Ab.bottom=Ab.maxRows-1);break;case -1564089444:case -1929078919:Ab.left===Ab.maxColumns&&(Ab.left=Ab.right=Ab.maxColumns-1)}return Ab}static nVb(Ab,xc){if(Ab.FF(xc))return!0;for(const eb of Ab.yu){if(!Ab.Pg.hD(eb.paneType))continue;const Ub=Ab.ml(xc,eb.paneType),Fc=eb.vr;if(Ub&&Fc&&Ae.ATb(Ub,Fc))return!0}return!1}static ATb(Ab,
xc){return!Ab||xc.topLeft.y>Ab.bottomRight.y||xc.topLeft.x>Ab.bottomRight.x||xc.bottomRight.y<Ab.bottomRight.y||xc.bottomRight.x<Ab.bottomRight.x?!1:!0}static gP(Ab,xc,eb,Ub){if(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8581986_FreezePanesPreviewTelemetry")){var Fc="FreezePanesCommandHandler.LogFreezePreviewTelemetry: ",rd={};rd.operationType=Fe.a(xc.command);rd.isSuccessful=eb;rd.preExistingPanes=Ab.Pg.mz;rd.message=Ub?Ub:"";Fc+=Na.a.li(rd);Q.ULS.sendTraceTag(507556641,0,50,Fc)}}static MPb(Ab){var xc,
eb=null!==(xc=Ab.xAc())&&void 0!==xc?xc:Ab.aga();if(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8728140_FreezePanesHiddenRowColFix"))return xc=Ab.mj,Ab=Math.max(eb.top,xc.j5(eb.top,!0,!0)),eb=Math.max(eb.left,xc.j5(eb.left,!1,!0)),{rowNumber:Ab,columnNumber:eb};xc=Ab.z$(!0);Ab=Ab.z$(!1);return{rowNumber:xc>eb.top?xc:eb.top,columnNumber:Ab>eb.left?Ab:eb.left}}}Object(M.a)(Ae,"FreezePanesUtils",null,[]);var We=a(142),ve;(function(Ab){Ab[Ab.HORIZONTAL=0]="HORIZONTAL";Ab[Ab.VERTICAL=1]="VERTICAL";Ab[Ab.BOTH=
2]="BOTH"})(ve||(ve={}));Object(M.b)("FreezePanesPreviewDirection",ve);var Ze;(function(Ab){Ab[Ab.TOPLEFT=0]="TOPLEFT";Ab[Ab.BOTTOMRIGHT=1]="BOTTOMRIGHT"})(Ze||(Ze={}));Object(M.b)("FreezePanesPreviewPosition",Ze);class Oe{constructor(Ab){this.da=Ab}z2h(Ab){Oe.sDa||Ab===ve.VERTICAL||(Oe.sDa=document.createElement("div"),Oe.sDa.classList.add(rc.a.Rtf),Oe.sDa.role="presentation",this.da.Ym.appendChild(Oe.sDa));Oe.Eda||Ab===ve.HORIZONTAL||(Oe.Eda=document.createElement("div"),Oe.Eda.classList.add(rc.a.Stf),
Oe.Eda.role="presentation",this.da.Ym.appendChild(Oe.Eda))}LEd(Ab,xc){xc=void 0===xc?Ze.BOTTOMRIGHT:xc;var eb=this.da.Pg.qJ,Ub=this.da.Pg.iL;var Fc=this.da.Pg.Hm;const rd=this.da.Pg.Sm,{mJ:Gd,gB:ue}=this.da.m5(),Ce=this.da.mj;if(Ce){var Se=this.g0(Ce,Gd.top,Gd.left);xc=this.g0(Ce,Ab.top+xc,Ab.left+xc);var of=this.g0(Ce,Fc,rd);var jf=ue.x+Se.dk-of.dk,bf=ue.y+Se.Sj-of.Sj;Se=this.da.ps;var pf=this.da.XB;of=pf+xc.Sj-bf;0<eb&&(eb=this.fwa(Ce,0,0),of=Ab.top<Fc?pf+xc.Sj-eb.Sj:pf+xc.Sj-eb.Sj-bf);Fc=Se+xc.dk-
jf;0<Ub&&(Ub=this.fwa(Ce,0,0),Fc=rd>Ab.left?Se+xc.dk-Ub.dk:Se+xc.dk-Ub.dk-jf);return{Zkb:Fc,lyb:of}}}Wvb(Ab,xc,eb){eb=void 0===eb?Ze.BOTTOMRIGHT:eb;Ab=this.LEd(Ab,eb);void 0!==Ab?this.KLk(Ab.Zkb,Ab.lyb,xc):Ea.Task.Va(!1)}KLk(Ab,xc,eb){this.z2h(eb);eb!==ve.BOTH&&eb!==ve.HORIZONTAL||!this.WPh(xc)||(Oe.sDa.style.top=Bb.HelperMethods.ti(Math.max(xc,this.da.XB)));eb!==ve.BOTH&&eb!==ve.VERTICAL||!this.$Ph(Ab)||(this.da.rtl?(Oe.Eda.style.left="unset",Oe.Eda.style.right=Bb.HelperMethods.ti(Math.max(Ab,this.da.ps))):
(Oe.Eda.style.right="unset",Oe.Eda.style.left=Bb.HelperMethods.ti(Math.max(Ab,this.da.ps))));Ea.Task.Va(!0)}WPh(Ab){return xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8762407_FreezePanesDragShadowHeadersScrollBarFix")?Ab>=this.da.Ym.clientHeight-We.a.Lx?(this.QJa(ve.HORIZONTAL),!1):!0:!0}$Ph(Ab){return xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8762407_FreezePanesDragShadowHeadersScrollBarFix")?Ab>=this.da.Ym.clientWidth-We.a.Lx?(this.QJa(ve.VERTICAL),!1):!0:!0}QJa(Ab){Ab=void 0===Ab?ve.BOTH:
Ab;Ab!==ve.HORIZONTAL&&Ab!==ve.BOTH||!Oe.sDa||(this.da.Ym.removeChild(Oe.sDa),Oe.sDa=null);Ab!==ve.VERTICAL&&Ab!==ve.BOTH||!Oe.Eda||(this.da.Ym.removeChild(Oe.Eda),Oe.Eda=null);return Ea.Task.Va(!0)}g0(Ab,xc,eb){return Ab.nU(Rd.a.gi(xc,eb))}fwa(Ab,xc,eb){const {rowNumber:Ub,columnNumber:Fc}=Ae.MPb(this.da);return this.g0(Ab,Ub+xc,Fc+eb)}freezePanesRowAndColumnPreview(Ab,xc){let eb=!0,Ub=!0,Fc=Ze.TOPLEFT;var rd=this.da.mj;if(!rd)return Ae.gP(this.da,Ab,!1,"sheetProcessedData is not available."),Ea.Task.Va(!1);
xc=Ae.getSelection(this.da.ha,xc,Ab);if(!Ae.nVb(this.da,xc))return Ae.gP(this.da,Ab,!0,"Preview not shown as selection is not in visible area"),Ea.Task.Va(!0);switch(Ab.command){case -1006176541:var Gd=this.da.Pg.Hm;const Ce=this.da.Pg.Sm,{mJ:Se,gB:of}=this.da.m5(),jf=this.fwa(rd,0,0);var ue=this.g0(rd,Se.top,Se.left);const bf=this.g0(rd,xc.top,xc.left);rd=this.g0(rd,Gd,Ce);Gd=of.x+ue.dk-rd.dk;ue=of.y+ue.Sj-rd.Sj;if(bf.Sj===jf.Sj&&bf.dk===jf.dk)return this.D0b(Ab);if(bf.Sj===jf.Sj||bf.Sj<=jf.Sj||
bf.cJ>=rd.cJ&&bf.Sj<rd.Sj+ue)eb=!1;if(bf.Sj===jf.Sj&&bf.dk===jf.dk||bf.dk<=jf.dk||bf.qI>=rd.qI&&bf.dk<rd.dk+Gd)Ub=!1;break;case -1156879868:Fc=Ze.BOTTOMRIGHT;Ub=!1;break;case -1929078919:Fc=Ze.BOTTOMRIGHT;eb=!1;break;default:return Ae.gP(this.da,Ab,!1,"Unexpected preview Ribbon Command"),Ea.Task.Va(!0)}Ub&&this.Wvb(xc,ve.VERTICAL,Fc);eb&&this.Wvb(xc,ve.HORIZONTAL,Fc);Ae.gP(this.da,Ab,!0);return Ea.Task.Va(!0)}D0b(Ab){const {rowNumber:xc,columnNumber:eb}=Ae.MPb(this.da),Ub=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8728140_FreezePanesHiddenRowColFix")?
Ed.Range.gi(xc,eb):this.da.aga();this.Wvb(Ub,ve.HORIZONTAL,Ze.BOTTOMRIGHT);Ae.gP(this.da,Ab,!0);return Ea.Task.Va(!0)}m$d(Ab){const {rowNumber:xc,columnNumber:eb}=Ae.MPb(this.da),Ub=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8728140_FreezePanesHiddenRowColFix")?Ed.Range.gi(xc,eb):this.da.aga();this.Wvb(Ub,ve.VERTICAL,Ze.BOTTOMRIGHT);Ae.gP(this.da,Ab,!0);return Ea.Task.Va(!0)}}Object(M.a)(Oe,"FreezePanesPreviewManager",null,[]);var Nf;(function(Ab){Ab[Ab.HORIZONTAL=0]="HORIZONTAL";Ab[Ab.VERTICAL=
1]="VERTICAL"})(Nf||(Nf={}));Object(M.b)("FreezePanesDragDirection",Nf);let Zf=class{constructor(Ab){this.da=Ab;this.Nic=this.Bdc=null;this.fIe=!1;this.Z9c=this.hcb=this.R$a=this.CXe=this.fKe=null;this.uig=xc=>{this.fKe=xc.clientY;this.l2e(Nf.HORIZONTAL);this.pQ||(this.pQ=document.createElement("div"),this.pQ.classList.add(rc.a.Noi),this.da.Ym.appendChild(this.pQ));this.Z9c=this.da.Ym.getBoundingClientRect();this.pQ.style.display="block";this.pQ.style.top=xc.clientY/this.da.kW-this.Z9c.top+"px";this.pQ.setPointerCapture(xc.pointerId);
this.pQ.style.cursor="grabbing";this.pQ.addEventListener("pointermove",this.shg);this.pQ.addEventListener("pointerup",this.UMc);this.pQ.addEventListener("pointercancel",this.UMc)};this.Tog=xc=>{this.CXe=xc.clientX;this.l2e(Nf.VERTICAL);this.CQ||(this.CQ=document.createElement("div"),this.CQ.classList.add(rc.a.Qoi),this.da.Ym.appendChild(this.CQ));this.CQ.style.display="block";this.CQ.style.left=xc.clientX/this.da.kW+"px";this.CQ.setPointerCapture(xc.pointerId);this.CQ.style.cursor="grabbing";this.CQ.addEventListener("pointermove",
this.thg);this.CQ.addEventListener("pointerup",this.VMc);this.CQ.addEventListener("pointercancel",this.VMc)};this.shg=xc=>{const eb=Bb.HelperMethods.ti(this.da.XB),Ub=Bb.HelperMethods.ti(xc.clientY/this.da.kW-this.Z9c.top),Fc=`calc(100% - ${Bb.HelperMethods.ti(We.a.Lx)} - 2px)`;this.pQ.style.top=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8762407_FreezePanesDragShadowHeadersScrollBarFix")?`clamp(${eb}, ${Ub}, ${Fc})`:Ub;(this.R$a=this.Bui(xc))?this.nDa.Wvb(this.R$a,0):this.nDa.QJa(0);return!0};
this.thg=xc=>{const eb=this.da.rtl?Bb.HelperMethods.ti(We.a.Lx):Bb.HelperMethods.ti(this.da.ps),Ub=Bb.HelperMethods.ti(xc.clientX/this.da.kW),Fc=`calc(100% - ${Bb.HelperMethods.ti(this.da.rtl?this.da.ps:We.a.Lx)} - 2px)`;this.CQ.style.left=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8762407_FreezePanesDragShadowHeadersScrollBarFix")?`clamp(${eb}, ${Ub}, ${Fc})`:Ub;(this.hcb=this.Xui(xc))?this.nDa.Wvb(this.hcb,1):this.nDa.QJa(1);return!0};this.UMc=xc=>{this.pQ.style.display="none";this.pQ.removeEventListener("pointermove",
this.shg);this.pQ.removeEventListener("pointerup",this.UMc);this.pQ.removeEventListener("pointercancel",this.UMc);this.nDa.QJa(0);if(this.fKe===xc.clientY)return!0;this.R$a?this.da.$.ei(-73576432,2,30,{dragProperties:{dragDirection:Nf.HORIZONTAL,target:this.kCh(this.R$a)}}):this.da.$.ei(83934709,2,30,{dragProperties:{dragDirection:Nf.HORIZONTAL,target:null}});this.R$a=null;return!0};this.VMc=xc=>{this.CQ.style.display="none";this.CQ.removeEventListener("pointermove",this.thg);this.CQ.removeEventListener("pointerup",
this.VMc);this.CQ.removeEventListener("pointercancel",this.VMc);this.nDa.QJa(1);if(this.CXe===xc.clientX)return!0;this.hcb?this.da.$.ei(-1564089444,2,30,{dragProperties:{dragDirection:Nf.VERTICAL,target:this.jCh(this.hcb)}}):this.da.$.ei(83934709,2,30,{dragProperties:{dragDirection:Nf.VERTICAL,target:null}});this.hcb=null;return!0};this.Bui=xc=>{const {position:eb,area:Ub,Jcf:Fc}=this.Lwf(xc);if(!Fc)return null;if(eb.y-Ub.topLeft.y<Ub.height/2){xc=this.da.mj.XOb(Fc);xc=Ed.Range.gi(xc.top,xc.left);
if(xc.equals(Fc))return null;const rd=this.nDa.LEd(xc);return void 0!==rd&&rd.lyb<=this.da.XB?null:xc}return Fc};this.Xui=xc=>{const {position:eb,area:Ub,Jcf:Fc}=this.Lwf(xc);if(null===Fc)return null;if(eb.x-Ub.topLeft.x<Ub.width/2){xc=this.da.mj.dQb(Fc);xc=Ed.Range.gi(xc.top,xc.left);if(xc.equals(Fc))return null;const rd=this.nDa.LEd(xc);return void 0!==rd&&rd.Zkb<=this.da.ps?null:xc}return Fc};this.nDa=new Oe(this.da)}W$i(){this.Bdc&&this.Nic||(this.Bdc=bd.DOMElementExtensions.getElementById(this.da.Ym,
qc.a.izf),this.Nic=bd.DOMElementExtensions.getElementById(this.da.Ym,qc.a.jzf));this.fIe||(this.Bdc.addEventListener("pointerdown",this.uig),this.Nic.addEventListener("pointerdown",this.Tog),this.fIe=!0)}y2g(Ab,xc){this.Bdc.className=Ab?rc.a.Ooi:rc.a.Ttf;this.Nic.className=xc?rc.a.Poi:rc.a.Utf}dispose(){this.Egl.removeEventListener("pointerdown",this.uig);this.Igl.removeEventListener("pointerdown",this.Tog);this.pQ&&this.da.Ym.removeChild(this.pQ);this.CQ&&this.da.Ym.removeChild(this.CQ)}l2e(Ab){const xc=
this.da.Pg;if(xc.mz){var eb=xc.qJ,Ub=xc.iL;Ab===Nf.HORIZONTAL&&0<eb?this.da.gD(Ed.Range.AX(xc.Hm,xc.Hm,!0),60,"FreezePaneDragAction.adjustScroll"):Ab===Nf.VERTICAL&&0<Ub&&this.da.gD(Ed.Range.f0(xc.Sm,xc.Sm,!0),60,"FreezePaneDragAction.adjustScroll")}}Lwf(Ab){var xc=new Sys.UI.DomEvent(Ab);Ab=new Sys.UI.Point(Ab.clientX/this.da.kW,Ab.clientY/this.da.kW);xc=this.da.ha.B3(Ab,xc.target,-1,!0);const eb=ba.f(this.da.$),Ub=eb.ml(xc),Fc=eb.Zk(this.da.paneType);return{position:fd.a.Ny(Fc.view.Xm,this.da.domElement.parentNode,
Ab,eb.rtl),area:Ub,Jcf:xc}}kCh(Ab){return Ab&&Ab.top===vc.a.gl?Object(I.D)(this.da.mj.XOb(Ab)):Ab}jCh(Ab){return Ab&&Ab.left===vc.a.Qk?Object(I.D)(this.da.mj.dQb(Ab)):Ab}};Zf=Object(N.__decorate)([Object(Ya.d)(sa.Oc),Object(N.__param)(0,Object(sa.dd)())],Zf);Object(M.a)(Zf,"FreezePaneDragAction",null,[248,2]);var Rb=a(661),Vb=a(96);class Cc{}Object(M.a)(Cc,"FreezePanesCommandParameters",null,[]);var rg=a(400),yf=a(32),jg=a(307),If=a(271);class cf{constructor(Ab){this.freezeOptions=null;this.freezeOptions=
Ab}getSheetName(){return this.freezeOptions.SheetName}}Object(M.a)(cf,"MacroRecorderSheetPaneFrozenPayload",null,[65]);var Nb=a(47),Bc=a(304),Ob=a(19),zc,od;(function(Ab){Ab[Ab.horizontal=0]="horizontal";Ab[Ab.vertical=1]="vertical"})(od||(od={}));Object(M.b)("Direction",od);let ce=zc=class{constructor(Ab,xc,eb,Ub){this.$=Ab;this.da=eb;this.Uib=this.jce=null;this.UMb=this.pBd=this.H5f=this.qpf=this.Bhb=!1;this.bja=Ob.a.$C;this.n$g=qc.a.kzf;this.Ibh=qc.a.lzf;this.cxc=this.n0a=!1;this.oaa=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8683456_FreezePanePreviewRefactor");
this.DKd=(Fc,rd,Gd,ue)=>{const Ce=this.da.Pg,Se=this.da.IX(),of=Ce.qJ,jf=Ce.iL;let bf=0,pf=0,Ud=0,Ff=0;const Uf=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8528403_FixFreezePaneCalcWhenGridUnderPane");switch(Fc.command){case 1844679312:bf=Gd.top-1;pf=Gd.left-1;Ud=bf-(rd.top-1);Ff=pf-(rd.left-1);Uf&&Ce.mz&&(of&&Se&&Ud>=Se.bottom-Se.top+1+of&&(Ud=of+(Gd.top-Se.top)+1),jf&&Se&&Ff>=Se.right-Se.left+1+jf&&(Ff=jf+(Gd.left-Se.left)+1));break;case -73576432:bf=Gd.top;Ud=bf-(rd.top-1);Uf&&Ce.mz&&of&&Se&&
Ud>=Se.bottom-Se.top+1+of&&(Ud=of+(Gd.top-Se.top)+1);ue&&(pf=Ce.Sm-1,Ff=pf-rd.left+1,Uf&&Ce.mz&&jf&&Se&&Ff>=Se.right-Se.left+1+jf&&(Ff=jf+(Ce.Sm-Se.left)+1));break;case -1564089444:pf=Gd.left,Ff=pf-(rd.left-1),Uf&&Ce.mz&&jf&&Se&&Ff>=Se.right-Se.left+1+jf&&(Ff=jf+(Gd.left-Se.left)+1),ue&&(bf=Ce.Hm-1,Ud=bf-rd.top+1,Uf&&Ce.mz&&of&&Se&&Ud>=Se.bottom-Se.top+1+of&&(Ud=of+(Ce.Hm-Se.top)+1))}return{e$d:bf,d$d:pf,yGd:Ud,xGd:Ff}};this.vhg=()=>{xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8593029_RevertFPLinesIfExist")&&
(this.oaa?this.iYa.QJa():this.Jtg());xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesRowsAndColumns",!1)&&xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8551192_HighlightSelectionPostFreezeOp")&&(this.da.rh.G9b(),this.da.rh.xia());if(this.Uib){const Fc=jg.a(yf.a.Tg.qk,this.Uib);zc.dV.totalDuration=Fc;const rd=zc.dV;this.qpf?window.requestIdleCallback?window.requestIdleCallback(()=>{this.YZe(rd);this.i7d(rd)}):window.setTimeout(()=>{this.YZe(rd);this.i7d(rd)},100):this.i7d(rd)}zc.dV=
{};this.Uib=null;this.LOc()};this.xPj=(Fc,rd)=>{var Gd,ue,Ce,Se;zc.dV.EcsOperationDuration=null===(Gd=Fc.RequestTelemetryData)||void 0===Gd?void 0:Gd.EcsOperationDuration;zc.dV.WfeRequestDuration=null===(ue=Fc.RequestTelemetryData)||void 0===ue?void 0:ue.WfeRequestDuration;zc.dV.EcsRequestDurations=null===(Ce=Fc.RequestTelemetryData)||void 0===Ce?void 0:Ce.EcsRequestDuration;zc.dV.isSuccessful=!(0<(null===(Se=Fc.Errors)||void 0===Se?void 0:Se.length));this.n0a&&(Gd=!!Fc&&!!Fc.RequestTelemetryData,
!La.a(Fc)&&rd&&rd.correlationId&&this.da.nk.V0(rd.correlationId,Fc.StateId,Gd?Fc.RequestTelemetryData.EcsOperationDuration:0,Gd?Fc.RequestTelemetryData.EcsRequestDuration:0,Gd?Fc.RequestTelemetryData.WfeRequestDuration:0))};this.d5f=()=>{if(this.Uib){const Fc=jg.a(yf.a.Tg.qk,this.Uib);zc.dV.lastCacheUpdateDuration=Fc}};this.$=Ab;this.da=ba.f(Ab);this.gridInstantaneousAction=Ub;this.DM=xc.YKb(this.$.domElement,500,null,null);this.Bhb=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8406295_AddFreezePanePropsTo8cadq");
this.qpf=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8452940_AddGridContentPropsToFreezePaneTelemtry");this.H5f=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8606820_addHasPanesLogTo8cadq");this.UMb=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8561471_EstimatePaneDataFix");this.pBd=xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnablePaneEstimationForAllFpOps",!1);this.iYa=new Oe(this.da);this.n0a=xa.EwaSettings.xFc();xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8508634_PreviewLinesForFreezePanes")&&
xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesSlice2",!1)&&(this.ana=document.getElementById(this.n$g),this.m2=document.getElementById(this.Ibh));this.cxc=xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePaneDrag",!1)}Bi(Ab,xc){let eb=!1;switch(xc){case 1844679312:eb=1!==Ab&&!this.da.Pg.mz;break;case -73576432:case -1564089444:xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8475425_DisableFreezeUpToCommandsWhenSelectionNotCell")&&(eb=1!==Ab);break;case -1006176541:case 179232729:case -1156879868:case -247664224:case -1929078919:eb=
!(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8508634_PreviewLinesForFreezePanes")&&xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesSlice2",!1))}this.$.ea.isEditMode||this.$.ea.th.allowViewCollab||(eb=!0);return eb}executeCommand(Ab,xc,eb){var Ub;Ab=this.da.Pg;const Fc=null!==(Ub=this.da.xAc())&&void 0!==Ub?Ub:this.da.aga();this.a6(xc);Ub=this.oaa?Ae.getSelection(this.da.ha,Fc,xc):this.getSelection(Fc,xc);switch(xc.command){case 1844679312:return this.setFreezePanes(xc,Fc,
Ab.Uo);case 83934709:return this.l0g(xc,Fc,eb);case -73576432:return xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8380523_AlwaysEnableFreezeRowsAndFreezeColumns")?this.Lsg(Ub,xc.command,xc.lk)?this.tme(xc,Fc,!1,eb):Ea.Task.Va(!1):this.tme(xc,Fc,Ab.Uo,eb);case -1564089444:return xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8380523_AlwaysEnableFreezeRowsAndFreezeColumns")?this.Lsg(Ub,xc.command,xc.lk)?this.sme(xc,Fc,!1,eb):Ea.Task.Va(!1):this.sme(xc,Fc,Ab.Uo,eb);case 340334732:return Ab.ywc?Ea.Task.Va(!1):
this.vAk(xc,Fc);case -806625837:return Ab.j8a?Ea.Task.Va(!1):this.wAk(xc,Fc);case -1006176541:return this.oaa?this.iYa.freezePanesRowAndColumnPreview(xc,Fc):this.freezePanesRowAndColumnPreview(xc,Fc);case -342472547:case 1558501543:case -2036655906:case 1870830702:case -1588000013:return this.oaa?this.iYa.QJa():this.Jtg();case 179232729:if(this.oaa)return this.iYa.D0b(xc);this.da.jK();return this.D0b(xc);case -1156879868:return this.oaa?this.iYa.freezePanesRowAndColumnPreview(xc,Fc):this.freezePanesRowAndColumnPreview(xc,
Fc);case -247664224:if(this.oaa)return this.iYa.m$d(xc);this.da.jK();return this.m$d(xc);case -1929078919:return this.oaa?this.iYa.freezePanesRowAndColumnPreview(xc,Fc):this.freezePanesRowAndColumnPreview(xc,Fc)}return Ea.Task.Va(!1)}ni(Ab,xc){Ab=!1;switch(xc.command){case 1844679312:case 340334732:case -806625837:case 1745254833:case 83934709:Ab=!0;break;case -73576432:case -1564089444:Ab=xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesRowsAndColumns",!1);break;case -1006176541:case -342472547:case 179232729:case 1558501543:case -1156879868:case -2036655906:case -247664224:case 1870830702:case -1929078919:case -1588000013:Ab=
xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8508634_PreviewLinesForFreezePanes")&&xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesSlice2",!1)}return Ab}Ji(){return!1}a6(Ab){Aa.AFrameworkApplication.ra.$d.HI&&this.$.a6&&(1844679312===Ab.command||340334732===Ab.command||-806625837===Ab.command)&&Rb.a.eX(1,2)}Lsg(Ab,xc,eb){const Ub=this.da.Pg;if(!Ub.Uo||this.cxc&&30===eb||Ub.qJ&&Ub.iL)return!0;switch(xc){case -73576432:return Ab.top!==Ub.Hm-1;case -1564089444:return Ab.left!==
Ub.Sm-1}return!1}ATb(Ab,xc){return!Ab||xc.topLeft.y>Ab.bottomRight.y||xc.topLeft.x>Ab.bottomRight.x||xc.bottomRight.y<Ab.bottomRight.y||xc.bottomRight.x<Ab.bottomRight.x?!1:!0}nVb(Ab){if(this.da.FF(Ab))return!0;for(const xc of this.da.yu){if(!this.da.Pg.hD(xc.paneType))continue;const eb=this.da.ml(Ab,xc.paneType),Ub=xc.vr;if(eb&&Ub&&this.ATb(eb,Ub))return!0}return!1}kye(Ab,xc,eb){const Ub=this.da.ml(Ab),Fc=this.da.view.visibleArea;return(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8380523_AlwaysEnableFreezeRowsAndFreezeColumns")?
this.oaa?Ae.nVb(this.da,Ab):this.nVb(Ab):this.oaa?Ae.ATb(Ub,Fc):this.ATb(Ub,Fc))?0>=xc&&0>=eb?(Q.ULS.sendTraceTag(537159582,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create empty freeze pane"),Ab=ba.f(this.$).rtl?1493:1492,xc=ba.f(this.$).rtl?-2131054257:-1953454131,Ab=za.a.Yi(1,0,26,Ab,0,xc,"FreezePaneA1SelectedErr"),this.Amf(this.$,Ab),!1):!0:(Q.ULS.sendTraceTag(537159583,0,50,`FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range=${Ab}, rangeViewportArea=${Ub?
Ub.toString():"null"}, visibleArea=${Fc.toString()}`),Ab=za.a.Yi(1,0,26,1491,0,2105967339,"FreezePaneSelectionNotInViewErr"),this.Amf(this.$,Ab),!1)}getSelection(Ab,xc){var eb=this.da.ha.qa;const Ub=eb.activeCell.clone();eb=eb.activeRange;eb.fk&&(Q.ULS.sendTraceTag(537159585,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top (${Ub.top}) and firstUnfreezeCell.Bottom (${Ub.bottom}) to equal topLeftRange.Top (${Ab.top})`),Ub.top=Ub.bottom=Ab.top);
eb.isRow&&(Q.ULS.sendTraceTag(537159584,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left (${Ub.left}) and firstUnfreezeCell.Right (${Ub.right}) to equal topLeftRange.Left (${Ab.left})`),Ub.left=Ub.right=Ab.left);if(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8599861_RowColumnFreezeOnLastBlockFix"))switch(xc.command){case -73576432:case -1156879868:Ub.top===Ub.maxRows&&(Ub.top=Ub.bottom=Ub.maxRows-1);break;case -1564089444:case -1929078919:Ub.left===
Ub.maxColumns&&(Ub.left=Ub.right=Ub.maxColumns-1)}return Ub}l0g(Ab,xc,eb){if(this.cxc&&"dragProperties"in eb){eb=eb.dragProperties.dragDirection;if(0===eb&&this.da.Pg.hD(4))return this.da.Pg.hD(3)?this.sme(new ab.a(-1564089444,Ab.method,Ab.mode,Ab.lk,Ab.tabName),xc,!1,{dragProperties:{dragDirection:1,target:Ed.Range.f0(this.da.Pg.Sm-1,this.da.Pg.Sm,!1),unfreeze:!0}}):Ea.Task.Va(!0);if(1===eb&&this.da.Pg.hD(3))return this.da.Pg.hD(4)?this.tme(new ab.a(-73576432,Ab.method,Ab.mode,Ab.lk,Ab.tabName),
xc,!1,{dragProperties:{dragDirection:0,target:Ed.Range.AX(this.da.Pg.Hm-1,this.da.Pg.Hm,!1),unfreeze:!0}}):Ea.Task.Va(!0)}return this.Cub(Ab,!1,0,0,0,0,xc,null)}setFreezePanes(Ab,xc,eb){if(xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesSlice2",!1)||!eb){eb=this.oaa?Ae.getSelection(this.da.ha,xc,Ab):this.getSelection(xc,Ab);eb.top===xc.top&&eb.left===xc.left&&(eb=Ed.Range.gi(eb.top+1,eb.left));const {e$d:Ub,d$d:Fc,yGd:rd,xGd:Gd}=this.DKd(Ab,xc,eb,!1);return this.kye(eb,rd,
Gd)?this.Cub(Ab,!0,Ub,Fc,rd,Gd,xc,eb):(this.$.jm(),this.LOc(),Ea.Task.Va(!0))}return this.l0g(Ab,xc)}sGf(Ab,xc){const eb=this.da.mj;let Ub=null;xc===od.vertical?Ub=eb.ojb(Ab):xc===od.horizontal&&(Ub=eb.ekb(Ab));if(Ub&&Ub!==Ab)return new Ed.Range(Ub.top,Ub.left,Ub.bottom,Ub.right,!1,!1);Q.ULS.sendTraceTag(507790169,0,50,`Could Not get First Scrollable Cell for : ${xc===od.horizontal?"horizontal":"vertical"}`);return Ab}TBf(Ab,xc,eb){return this.cxc&&"dragProperties"in eb?(Ab=eb.dragProperties,xc=Ab.dragDirection,
{mZd:Ab.target,$Rd:Ab.unfreeze?!1:this.da.Pg.hD(3)&&1===xc||this.da.Pg.hD(4)&&0===xc}):{mZd:this.oaa?Ae.getSelection(this.da.ha,xc,Ab):this.getSelection(xc,Ab),$Rd:!1}}tme(Ab,xc,eb,Ub){if(eb)return Ea.Task.Va(!1);const {mZd:Fc,$Rd:rd}=this.TBf(Ab,xc,Ub),{e$d:Gd,d$d:ue,yGd:Ce,xGd:Se}=this.DKd(Ab,xc,Fc,rd);return this.kye(Fc,Ce,Se)?this.Cub(Ab,!0,Gd,ue,Ce,Se,xc,this.UMb?this.sGf(Fc,od.vertical):Fc):(this.$.jm(),this.LOc(),Ea.Task.Va(!0))}sme(Ab,xc,eb,Ub){if(eb)return Ea.Task.Va(!1);const {mZd:Fc,$Rd:rd}=
this.TBf(Ab,xc,Ub),{e$d:Gd,d$d:ue,yGd:Ce,xGd:Se}=this.DKd(Ab,xc,Fc,rd);return this.kye(Fc,Ce,Se)?this.Cub(Ab,!0,Gd,ue,Ce,Se,xc,this.UMb?this.sGf(Fc,od.horizontal):Fc):(this.$.jm(),this.LOc(),Ea.Task.Va(!0))}vAk(Ab,xc){let eb=0;const Ub=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8728140_FreezePanesHiddenRowColFix");Ub&&(eb=Ae.MPb(this.da).columnNumber);return this.Cub(Ab,!0,0,Ub?eb:xc.left,0,Ub?eb-xc.left+1:1,xc,null)}wAk(Ab,xc){let eb=0;const Ub=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8728140_FreezePanesHiddenRowColFix");
Ub&&(eb=Ae.MPb(this.da).rowNumber);return this.Cub(Ab,!0,Ub?eb:xc.top,0,Ub?eb-xc.top+1:1,0,xc,null)}Amf(Ab,xc){xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesSlice2",!1)?this.pLk(Za.a.instance.ia(2427)):this.lp(Ab,xc)}pLk(Ab){Ab=Bc.a.IA.AK.mX(Ab,!1);Ab.image=He.a.Rmb()?1:0;Bc.a.IA.AK.eF(Ab)}lp(Ab,xc){new Fa.a(this.$,xc)}Cub(Ab,xc,eb,Ub,Fc,rd,Gd,ue){var Ce;this.jce=Nb.a(this.$).sta(5,"SendFreezePanesRequest","SendFreezePanesRequest");this.Bhb&&this.da.za.Vy(this.d5f);this.da.r9(this.vhg);
this.DM.v7a();this.da.iRk(xc?"":"UnsetFreezePane");const Se=Object(Ia.a)(new Cc,{SheetName:null===(Ce=this.$.na)||void 0===Ce?void 0:Ce.name,Freeze:xc,FrozenRows:Fc,FrozenColumns:rd,FirstRow:eb,FirstColumn:Ub});Q.ULS.sendTraceTag(573101852,0,50,`FreezePanesCommandHandler.SendFreezePanesRequest: Freeze=${xc}, FrozenRows=${Fc}, FrozenColumns=${rd}, FirstRow=${eb}, FirstColumn=${Ub} `);const of=()=>new cf(Se),jf=ha.a.create().toString();this.Bhb&&(zc.dV.isFreeze=xc,zc.dV.operationType=Fe.a(Ab.command),
zc.dV.frozenRows=Fc,zc.dV.frozenColumns=rd,zc.dV.firstRow=eb,zc.dV.firstColumn=Ub,zc.dV.referencedBlocksBefore=this.da.za.Bzc(),this.H5f&&(zc.dV.hasPanes=this.da.Pg.mz));this.Uib=yf.a.Tg.qk;this.n0a&&this.sZk(Ab,Se,Gd,ue,jf);return P.a(this.$.userOperationManager,(bf,pf,Ud)=>{if(xa.EwaSettings.Ra(59)){var Ff=window.performance;Ff.clearMarks();Ff.mark("FreezePanes request sent")}Ff=this.da.mj;var Uf=xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase2",!1),Gf=this.da.Pg.Uo;
Uf=Uf?Gf||!xc:!0;Ff&&(Uf||this.pBd)?this.UMb&&Gf?this.$.AD():(Ff=this.Tqf(Se,Ff,Gd,ue),this.mZk(Ff)):this.$.AD();Gf=V.c(bf,this.xPj);Ff=this.$.pa.ta;bf=this.Bhb?Gf:bf;Gf=this.n0a?{setPanes:xc,correlationId:jf}:xc;Uf=Ff.Za(9,null);Uf.freezeSettings=Se;return O.h(Ff,"FreezeOrUnfreezePanes",Uf,bf,pf,Ud,Gf,0)},bf=>new Y.a(151,0,bf,void 0,of),Ab)}sZk(Ab,xc,eb,Ub,Fc){Q.ULS.sendTraceTag(507577612,0,50,"FreezePanesCommandHandler.triggerFreezePaneCSE triggerFreezePaneCSE Initiated ");const rd=this.da.mj;this.da.Pg.Uo?
Q.ULS.sendTraceTag(507574365,0,15,`FreezePanesCommandHandler.triggerFreezePaneCSE command=${Ab.command}, parameter = ActiveSheetProcessedData, value = null reason = No active sheet processed data`):(this.gridInstantaneousAction.Yde(),window.setTimeout(()=>{this.da.nk.Dya();this.da.nk.KP(23,Fc,Fe.a(Ab.command));const Gd={wz:this.Tqf(xc,rd,eb,Ub)};this.gridInstantaneousAction.Kpd(Ab.command,void 0,Gd);Q.ULS.sendTraceTag(507585429,0,50,`FreezePanesCommandHandler.triggerFreezePaneCSE command=${Ab.command}, parameter = FreezePaneCSEAttempted, value = Success reason = Initiated FreezePane CSE`)},
10))}Tqf(Ab,xc,eb,Ub){Q.ULS.shipAssertTag(537159580,1,!!xc,"FreezePaneCommandHandler.EstimatePaneViewDataOnPaneRequest: called with null Sheet Processed Data");if(!Ab.Freeze)return null;const Fc=If.a();Fc.State=1;Fc.IsEstimated=!0;let rd=!1,Gd=!1;const ue=xc.nU(Ed.Range.gi(eb.top,eb.left));if(null===ue)return Q.ULS.sendTraceTag(507893269,1,50,"EstimatePaneViewDataOnPaneRequest.topLeftAllPanesOffsetData Null"),null;let Ce=Ab.FrozenRows;var Se=Ab.FrozenColumns;1!==Ab.FrozenRows||Ab.FrozenColumns?Ab.FrozenRows||
1!==Ab.FrozenColumns?(Se=xc.nU(Ed.Range.gi(Ab.FirstRow+1,Ab.FirstColumn+1)),xc=xc.nU(Ed.Range.gi(eb.top,eb.left)),Fc.Width=Se.dk-ue.dk,Fc.Height=Se.Sj-ue.Sj,this.UMb&&(0>Fc.Width?Fc.Width=0:Fc.Width,0>Fc.Height?Fc.Height=0:Fc.Height),0<Ab.FrozenRows&&(Fc.AbsoluteTop=Se.Sj,Gd=!0),0<Ab.FrozenColumns&&(Fc.AbsoluteLeft=Se.dk,rd=!0),Ce=Se.cJ-xc.cJ,Se=Se.qI-xc.qI):(Fc.Width=xc.Uzc(Rd.a.gi(eb.top,eb.left)),Ub=Ed.Range.gi(eb.top,eb.left+1),Fc.AbsoluteLeft=ue.dk+Fc.Width,rd=!0):(Fc.Height=xc.Rzc(Rd.a.gi(eb.top,
eb.left)),Ub=Ed.Range.gi(eb.top+1,eb.left),Fc.AbsoluteTop=ue.Sj+Fc.Height,Gd=!0);Gd&&(Fc.FirstFrozenRow=eb.top,Fc.FirstScrollableRow=Ub.top);rd&&(Fc.FirstFrozenColumn=eb.left,Fc.FirstScrollableColumn=Ub.left);Fc.VisibleRows=Ce;Fc.VisibleColumns=Se;return Fc}mZk(Ab){Ea.Task.delay(this.$.ua.GetRangeContentPrefetchDelayInMs).continueWith(()=>{this.$.na&&this.$.ea&&(this.$.ea.e8(vc.a.kk,"FreezePaneCommandHandler.TriggerDelayActiveItemPaneChange"),rg.b(this.$.na,Ab,-1,void 0,!0))})}LOc(){this.DM.A7a();
Vb.a.Ng(this.jce);this.jce=null;this.da.u1(this.vhg);this.Bhb&&this.da.za.Fy(this.d5f)}i7d(Ab){let xc=`FreezePanesCommandHandler.OnFreezePanesUpdateCompleted: duration of FreezePane from operation until allBlockUpdated: ${Ab.totalDuration} `;if(this.Bhb){var eb=this.EYa();eb&&(eb=this.da.Yg.Azc(Array(eb)),Ab.activeCells=eb);Ab.referencedBlocksAfter=this.da.za.Bzc();Ab.enabledExperiments=[];this.pBd&&Ab.enabledExperiments.push("paneEstimation");this.n0a&&Ab.enabledExperiments.push("cseEnabled");xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8581986_FreezePanesPreviewTelemetry")&&
xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FreezePanesRowsAndColumns",!1)&&Ab.enabledExperiments.push("freezePanesNewEntries");xc+=Na.a.li(Ab)}Q.ULS.sendTraceTag(570949840,0,50,xc)}YZe(Ab){let xc=0,eb=0,Ub=0,Fc=0;const rd=new Set,Gd=new Set,ue=new Set,Ce=Bb.HelperMethods.HM(()=>{var Se=this.da.za.yIa(this.da.IX(),this.$.na.name);if(Se)for(var of of Se)if(0!==of.Us){if(Se=Tc.b(this.da.$,of.jj,!0))for(var jf of Se){Se=jf.type;const bf=jf.Hq;if(""!==bf||null!=bf)2===Se?Gd.add(bf):1===
Se&&ue.add(bf)}if(of.rIb)for(const bf of of.rIb)rd.add(bf.Id);jf=of.Ci;of=of.jJa();if(of=null===of||void 0===of?void 0:of.Cells)for(const bf of of)if(of=this.da.za.bGf(jf,bf.Row,bf.Col))xc+=of.DF?1:0,Ub+=of.oR?1:0,Fc+=of.EZa?1:0,eb+=of.iC?1:0;break}});Ab.mergedCells=xc;Ab.formulaCells=eb;Ab.conditionalFormatting=Ub;Ab.coloredCells=Fc;Ab.tables=Gd.size;Ab.pivotTables=ue.size;Ab.floatingObjects=rd.size;Ab.gridContentLogTime=Ce}EYa(){const Ab=this.da.aga(),xc=this.da.KHd();return null===Ab||null===xc?
null:new Ed.Range(Ab.top,Ab.left,xc.bottom,xc.right,!0,!0)}g0(Ab,xc,eb){return Ab.nU(Rd.a.gi(xc,eb))}m$d(Ab){const xc=this.da.Pg.iL;var {gB:eb}=this.da.m5(),Ub=this.da.mj;if(null===Ub)return this.gP(Ab,!1,"sheetProcessedData is not available."),Ea.Task.Va(!1);const Fc=this.fwa(Ub,0,0);Ub=this.fwa(Ub,0,1);eb=this.da.ps+Ub.dk-(eb.x+Fc.dk);0<xc&&(eb=this.da.ps+Ub.dk-Fc.dk);if(null!==this.m2)this.da.rtl?this.m2.style.right=Bb.HelperMethods.ti(eb):this.m2.style.left=Bb.HelperMethods.ti(eb),this.m2.classList.remove(this.bja);
else return this.gP(Ab,!1,"verticalPreviewBar is null"),Ea.Task.Va(!0);this.gP(Ab,!0);return Ea.Task.Va(!0)}D0b(Ab){const xc=this.da.Pg.qJ;var eb=this.da.mj;if(null===eb)return this.gP(Ab,!1,"sheetProcessedData is not available."),Ea.Task.Va(!1);({gB:Fc}=this.da.m5());const Ub=this.fwa(eb,0,0);eb=this.fwa(eb,1,0);var Fc=this.da.XB+eb.Sj-(Fc.y+Ub.Sj);0<xc&&(Fc=this.da.XB+eb.Sj-Ub.Sj);if(null!==this.ana)this.ana.style.top=Bb.HelperMethods.ti(Fc),this.ana.classList.remove(this.bja);else return this.gP(Ab,
!1,"horizontalPreviewBar is null"),Ea.Task.Va(!0);this.gP(Ab,!0);return Ea.Task.Va(!0)}freezePanesRowAndColumnPreview(Ab,xc){let eb,Ub;let Fc=!0,rd=!0;const Gd=this.da.Pg.qJ,ue=this.da.Pg.iL,Ce=this.da.Pg.Hm,Se=this.da.Pg.Sm,{mJ:of,gB:jf}=this.da.m5();var bf=this.da.mj;if(null===bf)return this.gP(Ab,!1,"sheetProcessedData is not available."),Ea.Task.Va(!1);const pf=this.fwa(bf,0,0);xc=this.getSelection(xc,Ab);if(!this.nVb(xc))return this.gP(Ab,!0,"Preview not shown as selection is not in visible area"),
Ea.Task.Va(!0);var Ud=this.g0(bf,of.top,of.left);const Ff=this.g0(bf,xc.top+0,xc.left+0);var Uf=this.g0(bf,xc.top+1,xc.left);const Gf=this.g0(bf,xc.top,xc.left+1);bf=this.g0(bf,Ce,Se);const lg=jf.x+Ud.dk-bf.dk;Ud=jf.y+Ud.Sj-bf.Sj;if(-1006176541===Ab.command){Uf=Ff;if(Ff.Sj===pf.Sj&&Ff.dk===pf.dk)return this.D0b(Ab);if(Ff.Sj===pf.Sj||Ff.Sj<=pf.Sj||Ff.cJ>=bf.cJ&&Ff.Sj<bf.Sj+Ud)Fc=!1}Fc&&(Ub=this.da.XB+Uf.Sj-Ud,0<Gd&&(Ub=xc.top<Ce?this.da.XB+Uf.Sj-pf.Sj:this.da.XB+Uf.Sj-pf.Sj-Ud));if(-1006176541===Ab.command){if(Uf=
Ff,Ff.Sj===pf.Sj&&Ff.dk===pf.dk||Ff.dk<=pf.dk||Ff.qI>=bf.qI&&Ff.dk<bf.dk+lg)rd=!1}else Uf=Gf;rd&&(eb=this.da.ps+Uf.dk-lg,0<ue&&(eb=Se>xc.left?this.da.ps+Uf.dk-pf.dk:this.da.ps+Uf.dk-pf.dk-lg));if(null!==this.ana&&Fc)this.ana.style.top=Bb.HelperMethods.ti(Ub),this.ana.classList.remove(this.bja);else if(Fc)return this.gP(Ab,!1,"horizontalPreviewBar is null"),Ea.Task.Va(!0);if(null!==this.m2&&rd)this.da.rtl?this.m2.style.right=Bb.HelperMethods.ti(eb):this.m2.style.left=Bb.HelperMethods.ti(eb),this.m2.classList.remove(this.bja);
else if(rd)return this.gP(Ab,!1,"verticalPreviewBar is null"),Ea.Task.Va(!0);-1156879868===Ab.command&&this.m2.classList.add(this.bja);-1929078919===Ab.command&&this.ana.classList.add(this.bja);this.gP(Ab,!0);return Ea.Task.Va(!0)}Jtg(){this.m2&&(this.m2.style.left=null,this.m2.style.right=null,this.m2.classList.contains(this.bja)||this.m2.classList.add(this.bja));this.ana&&(this.ana.classList.contains(this.bja)||this.ana.classList.add(this.bja));return Ea.Task.Va(!0)}gP(Ab,xc,eb){if(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8581986_FreezePanesPreviewTelemetry")){var Ub=
"FreezePanesCommandHandler.LogFreezePreviewTelemetry: ",Fc={};Fc.operationType=Fe.a(Ab.command);Fc.isSuccessful=xc;Fc.preExistingPanes=this.da.Pg.mz;Fc.message=eb?eb:"";Ub+=Na.a.li(Fc);Q.ULS.sendTraceTag(507655369,0,50,Ub)}}fwa(Ab,xc,eb){var Ub;const Fc=null!==(Ub=this.da.xAc())&&void 0!==Ub?Ub:this.da.aga();Ub=this.da.z$(!0);const rd=this.da.z$(!1);return this.g0(Ab,(Ub>Fc.top?Ub:Fc.top)+xc,(rd>Fc.left?rd:Fc.left)+eb)}};ce.dV={};ce=zc=Object(N.__decorate)([Object(Ya.d)(sa.Pc),Object(N.__param)(0,
Object(sa.Lb)()),Object(N.__param)(1,Object(sa.Cf)()),Object(N.__param)(2,Object(sa.dd)()),Object(N.__param)(3,Object(sa.bd)())],ce);Object(M.a)(ce,"FreezePanesCommandHandler",null,[39]);var Qb;let Xc=Qb=class{constructor(Ab,xc){this.da=Ab;this.$=xc;this.selectedRanges=[];this.Hxa=!1;this.Hxa=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8756282_HeaderInsertAllowedRefactor")}isHeaderInsertAllowed(Ab,xc,eb){return this.Hxa?this.Vu&&this.Vu.isRow===xc&&(this.Vu.VM===Ab&&this.Vu.rxa===eb||this.Vu.X1e===
Ab&&this.Vu.rxa===!eb):this.z0a(xc)&&(!this.N_a(Ab,xc)||this.nEc(Ab,xc,eb))}uOf(Ab,xc,eb,Ub){Ub?(!this.py||this.py.VM===xc&&this.py.isRow===eb||this.uOf(this.py.dw,this.py.VM,this.py.isRow,!1),this.py={isRow:eb,VM:xc,dw:Ab}):(this.py&&this.py.VM===xc&&this.py.isRow===eb||Q.ULS.sendTraceTag(507581474,0,15,"HeaderInsert.headerCellHoveredCallback: Got unset hover event for a cell that was not previously hovered."),this.py=void 0);this.z0a(eb)&&!this.N_a(xc,eb)&&this.Swe(Ab,xc,eb,!0,!0)}headerInsertHitAreaHoveredCallback(Ab,
xc,eb,Ub){Ub?(!this.Vu||this.Vu.VM===Ab&&this.Vu.isRow===xc&&this.Vu.rxa===eb||this.headerInsertHitAreaHoveredCallback(this.Vu.VM,this.Vu.isRow,this.Vu.rxa,!1),this.Hxa?this.$Lk(Ab,xc,eb):this.Vu={isRow:xc,VM:Ab,X1e:void 0,rxa:eb}):(this.Vu&&this.Vu.VM===Ab&&this.Vu.isRow===xc&&this.Vu.rxa===eb||Q.ULS.sendTraceTag(507581473,0,15,"HeaderInsert.headerInsertHitAreaHoveredCallback: Got unset hover event for a hit region that was not previously hovered."),this.Hxa?this.A5i():this.Vu=void 0);!this.Hxa&&
this.isHeaderInsertAllowed(Ab,xc,eb)&&(this.K2g(Ab,xc,eb),Ub?this.BRg(Ab,xc,eb):this.$Of(xc))}headerInsertButtonInvokedCallback(Ab,xc,eb){1!==this.da.ha.wk&&this.da.C7();const Ub=this.N_a(Ab,xc);Ab=Ub?[Ub]:[xc?Ed.Range.AX(Ab,Ab):Ed.Range.f0(Ab,Ab)];this.da.$.ei(eb?xc?-1113896058:1415868706:xc?75170472:-612877076,2,32,{[qc.a.Utb]:Ab})}BRg(Ab,xc,eb){eb||Ab++;eb=xc?Ed.Range.AX(Ab,Ab):Ed.Range.f0(Ab,Ab);xc=xc?Qb.uSf:Qb.lSf;this.da.rh.Vs(eb,xc,!1);this.da.rh.rw(xc,void 0,void 0,xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8741722_HeaderInsertHighlightLag")?
!0:void 0)}$Of(Ab){this.da.rh.zq(Ab?Qb.uSf:Qb.lSf,xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8741722_HeaderInsertHighlightLag")?!0:void 0)}pBc(Ab){var xc,eb;Ab=Ab.filter(Ub=>Ub.isRow||Ub.fk);if(0!==this.selectedRanges.length||0!==Ab.length)this.L2g(this.selectedRanges,!1),this.selectedRanges=Ab,this.L2g(this.selectedRanges,!0),this.py&&this.z0a(this.py.isRow)&&this.Swe(this.py.dw,this.py.VM,this.py.isRow,!0,!0),this.Hxa||!this.Vu||this.Vu.isRow===(null===(xc=this.py)||void 0===xc?void 0:xc.isRow)&&
this.Vu.VM===(null===(eb=this.py)||void 0===eb?void 0:eb.VM)||!this.z0a(this.Vu.isRow)||this.K2g(this.Vu.VM,this.Vu.isRow,this.Vu.rxa)}z0a(Ab){var xc;if(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8740942_DisableHeaderInsertEditing")){if(!this.$.ea.isEditMode||this.da.isEditing)return!1;null!==(xc=this.DD)&&void 0!==xc?xc:this.DD=new pa.a(this.$.sa);return!this.DD.Hj(Ab?64:32)||this.$.ih.GF?!1:!0}this.DD||(this.DD=new pa.a(this.$.sa));return this.DD.Hj(Ab?64:32)&&this.$.ea.isEditMode&&!this.$.ih.GF}L2g(Ab,
xc){Ab.forEach(eb=>{var Ub=eb.isRow;if(this.z0a(Ub)){var Fc=Ub?eb.top:eb.left,rd=this.vib(Ub,Fc);this.Yub(rd,Fc,!0,xc?0:void 0);eb=Ub?eb.bottom:eb.right;Ub=eb===Fc?rd:this.vib(Ub,eb);this.Yub(Ub,eb,!1,xc?0:void 0)}})}Swe(Ab,xc,eb,Ub,Fc){Ub&&this.Yub(Ab,xc,!0,this.$Jd(xc,eb,!0,!0));Fc&&this.Yub(Ab,xc,!1,this.$Jd(xc,eb,!1,!0))}qJk(Ab,xc,eb,Ub){if(!Ub)return!1;Ub=!!this.N_a(Ab,xc);return!Ub&&this.py&&this.py.isRow===xc&&this.py.VM===Ab||this.nEc(Ab,xc,eb)||!Ub&&this.CTf(Ab,xc,!eb)?!0:!1}oJk(Ab,xc,eb){return this.z0a(xc)&&
(!this.N_a(Ab,xc)||this.nEc(Ab,xc,eb))}$Lk(Ab,xc,eb){this.oJk(Ab,xc,eb)&&(this.Yub(this.vib(xc,Ab),Ab,eb,1),this.BRg(Ab,xc,eb),this.Vu={isRow:xc,VM:Ab,X1e:this.tHd(Ab,xc,!eb),rxa:eb})}A5i(){if(this.Vu){var Ab=this.Vu.isRow,xc=this.Vu.VM,eb=this.Vu.rxa;this.Vu=void 0;this.Yub(this.vib(Ab,xc),xc,eb,this.$Jd(xc,Ab,eb,this.z0a(Ab)));this.$Of(Ab)}}K2g(Ab,xc,eb){var Ub,Fc,rd;const Gd=Ab===(null===(Ub=this.py)||void 0===Ub?void 0:Ub.VM)&&xc===(null===(Fc=this.py)||void 0===Fc?void 0:Fc.isRow)?null===(rd=
this.py)||void 0===rd?void 0:rd.dw:this.vib(xc,Ab);Gd&&this.Swe(Gd,Ab,xc,eb,!eb)}vib(Ab,xc){if(this.Hxa&&this.py&&this.py.isRow===Ab&&this.py.VM===xc)return this.py.dw;Ab=Ab?this.da.h$d:this.da.A0b;for(const eb of Ab)if(Ab=eb.zui(xc))return Ab}$Jd(Ab,xc,eb,Ub){const Fc=!!this.N_a(Ab,xc),rd=this.nEc(Ab,xc,eb);if(this.Vu&&this.Vu.VM===Ab&&this.Vu.isRow===xc&&this.Vu.rxa===eb&&(this.Hxa||!Fc||rd))return 1;if(this.Hxa){if(this.qJk(Ab,xc,eb,Ub))return 0}else if(this.py&&this.py.isRow===xc&&this.py.VM===
Ab&&!Fc||rd||!Fc&&this.CTf(Ab,xc,!eb))return 0}Yub(Ab,xc,eb,Ub){var Fc;if(Ab&&!Ab.OMg(xc,eb,Ub)){const rd=this.tHd(xc,Ab.isRow,!eb);rd!==xc&&(null===(Fc=this.vib(Ab.isRow,rd))||void 0===Fc?void 0:Fc.OMg(rd,!eb,Ub))}}N_a(Ab,xc){var eb;return null===(eb=this.selectedRanges)||void 0===eb?void 0:eb.find(Ub=>xc?Ub.isRow&&Ub.V0a(Ab):Ub.fk&&Ub.T_a(Ab))}nEc(Ab,xc,eb){return this.selectedRanges.some(Ub=>xc?Ub.isRow&&(eb?Ub.top===Ab:Ub.bottom===Ab):Ub.fk&&(eb?Ub.left===Ab:Ub.right===Ab))}CTf(Ab,xc,eb){eb=this.tHd(Ab,
xc,eb);return eb===Ab?!1:!!this.N_a(eb,xc)}tHd(Ab,xc,eb){const Ub=this.da.mj;if(xc)return Ab=Rd.a.gi(Ab,1),eb?Ub.ojb(Ab).top:Ub.XOb(Ab).top;Ab=Rd.a.gi(1,Ab);return eb?Ub.ekb(Ab).left:Ub.dQb(Ab).left}};Xc.uSf=[70,72];Xc.lSf=[71,73];Xc=Qb=Object(N.__decorate)([Object(Ya.d)(sa.ed),Object(N.__param)(0,Object(sa.dd)()),Object(N.__param)(1,Object(sa.Lb)())],Xc);Object(M.a)(Xc,"HeaderInsert",null,[]);class md{constructor(Ab,xc){this.selectedRanges=null;this.fRemoveOriginRef=!1;this.selectedRanges=Ab;this.fRemoveOriginRef=
xc}}Object(M.a)(md,"MacroRecorderImageInCellConvertToFloatingObjectPayload",null,[65]);var ie=a(162),me=a(111);let Pe=class{constructor(Ab,xc,eb){this.NMj=Ub=>{let Fc;!Ub||za.a.Jk(Ub.Errors)||na.a.qm(Fc=Ub.Result)?Ub&&za.a.Jk(Ub.Errors)&&Q.ULS.sendTraceTag(509142304,0,50,`ImageInCellCommandHandler.onConvertInCellToFloatingE2oSuccess: operation succeeded with errors. Errors: ${za.a.Kh(Ub.Errors)}`):(Q.ULS.sendTraceTag(509142305,0,50,"ImageInCellCommandHandler.onConvertInCellToFloatingE2oSuccess: operation succeeded"),
ie.a(this.$).z4a(3),me.a(this.$).fOa(1,Fc))};this.MMj=()=>{Q.ULS.sendTraceTag(509142303,0,50,"ImageInCellCommandHandler.onConvertInCellToFloatingE2oFailed: operation failed")};this.$=Ab;this.da=ba.f(this.$);this.dRh=xc;this.cwi=eb;this.bWb=xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TransitionFloatingInCellImages",!1);this.NTb=xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateReferenceFloatingInCellImages",!1);this.wfj=xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CellImagesOnObjectUI",
!1)}Bi(){return!1}executeCommand(Ab,xc){Ba.TaskExtensions.sq();Ab=I.s(this.da.ha.qa.selectedRanges,this.$);const eb=xc.command;switch(eb){case 2000316912:xc=this.zff(Ab,!0,xc);break;case 1983877126:xc=this.zff(Ab,!1,xc);break;case -1125542248:xc=this.popInCellImageToFloatingFromOnObjectUI();break;case 457756232:xc=this.H8j();break;default:return fa.a(eb)}return xc||Ea.Task.Va(!0)}ni(Ab,xc){Ab=!1;switch(xc.command){case 457756232:case -1125542248:Ab=this.$.isEditMode&&this.bWb&&this.NTb&&this.wfj;
break;case 2000316912:case 1983877126:Ab=this.$.isEditMode&&this.bWb&&this.NTb}return Ab}Ji(){return!1}popInCellImageToFloatingFromOnObjectUI(){if(!this.$.cy(null,!1))return Ea.Task.Va(!0);this.dRh.tkd();return Ea.Task.Va(!0)}H8j(){if(!(new pa.a(this.$.sa)).Hj(1))return Ea.Task.Va(!0);this.cwi.tkd();return Ea.Task.Va(!0)}zff(Ab,xc,eb){if(!this.$.cy(null,!1))return Ea.Task.Va(!0);const Ub=()=>new md(Ab,xc);return P.a(this.$.userOperationManager,(Fc,rd,Gd)=>{var ue=this.$.pa.ta;Fc=V.c(Fc,this.NMj);
rd=V.b(rd,this.MMj);const Ce=ue.Za(41,null);Ce.selectedRanges=Ab;Ce.fRemoveOriginRef=xc;return O.h(ue,"ConvertToFloatingE2o",Ce,Fc,rd,Gd,null,0)},Fc=>new Y.a(268,0,Fc,void 0,Ub),eb)}};Pe=Object(N.__decorate)([Object(Ya.d)(sa.nd),Object(N.__param)(0,Object(sa.Lb)()),Object(N.__param)(1,Object(sa.L)()),Object(N.__param)(2,Object(sa.oc)())],Pe);Object(M.a)(Pe,"ImageInCellCommandHandler",null,[39]);var gf=a(885),tf=a(886);class Qe{constructor(Ab,xc,eb,Ub){this.$=Ab;this.yz=xc;this.x8a=eb;this.rfb=Ub}showTaskPane(Ab,
xc,eb,Ub,Fc,rd,Gd,ue){He.a.ut()?void Ya.a.resolve(sa.We,{va:0}).then(Ce=>Ce.hS("NameManagerTaskPane",this.pt(Ab,xc,eb,Ub,Fc,void 0,rd,Gd,ue))):le.a.Go().then(Ce=>{Ce.showTaskPane("NameManagerTaskPane",this.pt(Ab,xc,eb,Ub,Fc,void 0,rd,Gd,ue));return null}).catch(()=>{throw Error("showTaskPane: Error while opening task pane");})}updateTaskPane(Ab,xc,eb,Ub,Fc,rd,Gd,ue,Ce){He.a.ut()?void Ya.a.resolve(sa.We,{va:0}).then(Se=>Se.updateTaskPane("NameManagerTaskPane",this.pt(Ab,xc,eb,Ub,Fc,rd,Gd,ue,Ce))):
le.a.Go().then(Se=>{Se.updateTaskPane("NameManagerTaskPane",this.pt(Ab,xc,eb,Ub,Fc,rd,Gd,ue,Ce));return null}).catch(()=>{throw Error("updateTaskPane: Error while opening task pane");})}hideTaskPane(){He.a.ut()?void Ya.a.resolve(sa.We,{va:0}).then(Ab=>Ab.hideTaskPane("NameManagerTaskPane")):le.a.Go().then(Ab=>{Ab.hideTaskPane("NameManagerTaskPane",2);return null}).catch(()=>{throw Error("hideTaskPane: Error while hiding task pane");})}iX(){this.ZWg&&this.ZWg()}getTitle(Ab,xc){switch(Ab){case 1:return Za.a.instance.Ba(xc?
1003:902);case 0:return Za.a.instance.Ba(901);default:return""}}pt(Ab,xc,eb,Ub,Fc,rd,Gd,ue,Ce){eb={type:"NameManagerTaskPaneProps",activePage:Ab,showLoader:Gd,rangePickerController:ba.f(this.$).Um.YYa(),callbacks:eb,items:xc,errors:ue,updateView:Ub,toast:Fc,filterCountMap:Ce};return Object.assign(new dc.a,{id:"NameManagerTaskPane",title:this.getTitle(Ab,this.umb(xc)),actionButtonProps:rd,contentProps:eb,width:320,onOpen:()=>{this.yz()},onClose:()=>{this.x8a()},preventCloseCallback:Se=>{this.ZWg=Se;
xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8720866_XLONameManagerApplyChangesToast")?1===Ab?this.rfb(xc):Se():Se()}})}umb(Ab){return Ab&&null===Ab[0]?!0:!1}}Object(M.a)(Qe,"NameManagerTaskPane",null,[282]);class Ca{constructor(Ab,xc){this.yYg=0;this.uUc=[];this.searchText="";this.yz=()=>{this.nX.gAh(this.Mkf);this.nX.hBh(this.b2g);this.nX.eyh(this.ssc);this.nX.Xy();this.$.Lp(this.DMa)};this.callbacks={onItemClick:eb=>{this.c1i(eb)},onItemSave:(eb,Ub,Fc,rd,Gd)=>{this.zMf(eb,Ub,Fc,rd,Gd)},onItemsDelete:eb=>
{eb&&(this.uUc=eb,this.nX.ssc(eb))},onSearch:(eb,Ub)=>{this.searchText=eb;this.Ilc=Ub;if(xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.XLONameManagerFastFollow",!1)){Q.ULS.sendTraceTag(507610080,gf.a.zpb,tf.a.info,Na.a.li({isSearching:""!==eb,sortBy:Ub.sortBy,sortOrder:Ub.sortOrder,filterBy:Ub.filterBy}));const Fc=gb.filterBy(this.items,Ub.filterBy);eb=gb.search(Fc,eb);Ub=gb.BNd(eb,Ub.sortBy,Ub.sortOrder);this.f8(0,void 0,Ub)}else Q.ULS.sendTraceTag(507581340,gf.a.zpb,tf.a.info,"NameManagerTaskPaneController.callbacks Search functionality is used"),
Ub=gb.search(this.items,eb),this.f8(0,void 0,Ub)},onCloseButtonClick:(eb,Ub,Fc,rd,Gd)=>{gb.x4i(eb,Ub,Fc,rd,this.getDefinedNames())?(this.H3b={name:eb,reference:Ub,comment:Fc,type:Gd,runtimeUid:rd,scope:0,topLeft:"",bottomRight:"",isInvalidReference:!1,referenceSheetName:""},this.toast=this.wAc(Za.a.instance.Ba(915),Za.a.instance.Ba(916),()=>{this.zMf(eb,Ub,Fc,rd,Gd)},!0,()=>{this.Cpb.iX()}),this.f8(1,this.Xdb(),[this.H3b],null)):this.Cpb.iX()}};this.updateView=(eb,Ub)=>{switch(eb){case 1:case 3:this.f8(eb,
this.Xdb(),[Ub]);break;case 0:this.f8(eb,void 0);break;default:this.f8(eb,this.Xdb())}};this.Xdb=()=>({label:Za.a.instance.Ba(903),icon:"CommonControlArrowLeftUseWithBorder_24",onExecute:()=>{this.updateView(0)},onTabKeyDown:()=>{}});this.Mkf=(eb,Ub)=>{this.eYh();(null===Ub||void 0===Ub?0:Ub.Dkj)?this.V2i():this.updateView(this.items?0:4)};this.b2g=(eb,Ub)=>{let Fc;eb=null===Ub||void 0===Ub?void 0:Ub.status;!eb&&(Fc=gb.QIi(Ub),null===Fc||void 0===Fc?0:Fc.J8b)&&(this.toast=this.wAc(Fc.J8b,null,null));
eb?this.f8(0,null,this.getDefinedNames(),null===Fc||void 0===Fc?void 0:Fc.Cag):this.f8(1,this.Xdb(),[this.H3b],null===Fc||void 0===Fc?void 0:Fc.Cag)};this.ssc=(eb,Ub)=>{(null===Ub||void 0===Ub?0:Ub.status)&&this.items&&(this.items=this.items.filter(Fc=>!this.uUc.includes(Fc.runtimeUid)));this.toast=(null===Ub||void 0===Ub?0:Ub.status)?this.JWi(Ub):this.IWi(Ub);this.f8(0,null,this.items,null)};this.DMa=(eb,Ub)=>{!Ub.Hl&&this.Cpb&&this.Cpb.hideTaskPane()};this.x8a=()=>{this.nX.tkk(this.Mkf);this.nX.slk(this.b2g);
this.nX.Mik(this.ssc);this.nX.pA();this.$.Au(this.DMa)};this.rfb=eb=>{this.f8(3,this.Xdb(),eb)};this.$=Ab;this.nX=xc;this.da=ba.f(Ab);this.Cpb=new Qe(Ab,this.yz,this.x8a,this.rfb)}tMk(){this.yYg=0;this.toast={sequenceNumber:0,message:"",actionButtonText:"",onActionButtonClick:null,autoHide:!1,onCloseButtonClick:null,allowDismiss:!1};this.Ilc={filterBy:void 0,sortOrder:0,sortBy:0};this.Cpb.showTaskPane(0,this.getDefinedNames(),this.callbacks,this.updateView,this.toast,!0,void 0,this.filterCountMap);
this.nX.asg(!1)}f8(Ab,xc,eb,Ub){this.H7h=Ab;this.Cpb.updateTaskPane(Ab,eb||this.getDefinedNames(),this.callbacks,this.updateView,this.toast,xc,!1,Ub,this.filterCountMap);this.H3b=null}c1i(Ab){if(Ab=gb.uHi(this.items,Ab)){Ab=I.jb(Ab.reference.slice(1),this.$.listSeparator,this.$.sa);const xc=ba.f(this.$).ha;this.da.p0(Ab&&Ab.Y6&&Ab.sheetName?Ab.Y6:[xc.qa.E$],xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8756334_NameManagerSelectionUpdateAfterDiscontinuousSelection")?0:xc.qa.qy,Ab.sheetName,null,null,
null,null,3,"NameManager.SelectNamedRange",null,null,null,!0)}}V2i(){switch(this.H7h){case 0:if(this.items)if(xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.XLONameManagerFastFollow",!1)){var Ab=gb.filterBy(this.items,this.Ilc.filterBy);Ab=gb.search(Ab,this.searchText);Ab=gb.BNd(Ab,this.Ilc.sortBy,this.Ilc.sortOrder);this.f8(0,void 0,Ab)}else Ab=gb.search(this.items,this.searchText),this.f8(0,void 0,Ab);else this.updateView(4);break;case 4:this.updateView(this.items?0:4);break;case 2:this.updateView(this.items?
2:4)}}eYh(){const Ab=this.nX.UWa;Ab?(this.items=[],0!==Ab.nameManagerItems.length&&(Ab.nameManagerItems.forEach(xc=>{xc&&xc.metadata&&xc.metadata.isVisibleToNameManager&&this.items.push({runtimeUid:xc.metadata.runtimeUid,name:xc.name,reference:"="+xc.reference,comment:xc.comment,type:gb.vOi(xc.metadata.type),scope:gb.xTi(xc.scope),referenceSheetName:xc.referenceSheetName,isInvalidReference:xc.isInvalidReference,topLeft:xc.topLeft,bottomRight:xc.bottomRight})}),this.items=gb.BNd(this.items,0,0),xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.XLONameManagerFastFollow",
!1)&&(this.filterCountMap=gb.K_h(this.items)))):this.items=null}IWi(Ab){return Ab&&!Ab.status&&Ab.Iub?gb.gXc(Ab.Iub)?this.wAc(gb.VCf("delete"),null,null):null:null}JWi(Ab){var xc,eb;if(!Ab||!Ab.status||Ab.Iub)return null;Ab=1===(null===(xc=this.uUc)||void 0===xc?void 0:xc.length)?Za.a.instance.Ba(908):String.format(Za.a.instance.Ba(909),null===(eb=this.uUc)||void 0===eb?void 0:eb.length);return this.wAc(Ab,Za.a.instance.Ba(904),()=>{this.$.ei(-1502853784,K.a.eh,12,null)})}getDefinedNames(){return this.items}wAc(Ab,
xc,eb,Ub,Fc){return Ab?{sequenceNumber:++this.yYg,message:Ab,actionButtonText:xc,onActionButtonClick:eb,autoHide:void 0===Ub?!0:Ub,onCloseButtonClick:void 0===Fc?null:Fc,allowDismiss:!0}:null}zMf(Ab,xc,eb,Ub,Fc){const rd=gb.b$k(this.nX.aYd,Ab,xc,eb,Fc);this.H3b={name:Ab,reference:xc,comment:eb,type:Fc,runtimeUid:Ub,scope:0,topLeft:"",bottomRight:"",isInvalidReference:!1,referenceSheetName:""};0!==rd.length?this.f8(1,this.Xdb(),[this.H3b],rd):this.nX.upsertDefinedName(Ab,xc,eb,Ub,pc[Fc])}}Object(M.a)(Ca,
"NameManagerTaskPaneController",null,[]);let yb=class{constructor(Ab,xc){this.qda=null;this.$=Ab;this.nX=xc}Bi(){return!1}get fPc(){this.qda||(this.qda=new Ca(this.$,this.nX));return this.qda}executeCommand(Ab,xc){Ab=!1;xc=xc.command;switch(xc){case 1910465940:this.fPc.tMk(),Ab=!0}return Ab?Ea.Task.Va(!0):fa.a(xc)}ni(Ab,xc){switch(xc.command){case 1910465940:return!0;default:return!1}}Ji(){return!1}};yb=Object(N.__decorate)([Object(Ya.d)(sa.Nd),Object(N.__param)(0,Object(sa.Lb)()),Object(N.__param)(1,
Object(sa.xb)())],yb);Object(M.a)(yb,"NameManagerCommandHandler",null,[39]);var wc=a(187);class dd extends wc.a{constructor(){super();this.YC=()=>{this.hide()}}showDialog(Ab,xc){try{this.Lk="OfficePyBlockPythonEditDialog",this.Bh=0,this.show({["type"]:"StandardDialogProps",["id"]:this.Lk,["headerText"]:Ab,["resultHandler"]:this.YC,["titleText"]:xc})}catch(eb){this.I3c(Ab,xc)}}I3c(Ab){const xc=new uc.a(!1,!1,!1);xc.Bh=0;xc.Lk="OfficePyBlockPythonEditLegacyDialog";xc.initializeAndShow(Ab,this.dah,null)}dah(){this.hide()}}
Object(M.a)(dd,"OfficePyBlockPythonEditDialog",wc.a,[]);let vd=class{constructor(Ab){this.$=Ab}Bi(){return!1}executeCommand(Ab,xc){Ab=!1;xc=xc.command;switch(xc){case 883532127:(new dd).showDialog("Python is not supported in Excel for the web","Excel for the web does not support calculating or interacting with Python formulas. To use Python formulas, open this file with the desktop app for Windows."),Ab=!0}return Ab?Ea.Task.Va(!0):fa.a(xc)}ni(Ab,xc){switch(xc.command){case 883532127:return xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OfficePyUX",
!1);default:return!1}}Ji(){return!1}};vd=Object(N.__decorate)([Object(Ya.d)(sa.ee),Object(N.__param)(0,Object(sa.Lb)())],vd);Object(M.a)(vd,"OfficePyUXCommandHandler",null,[39]);var Zd=a(9),Re=a(894);class ff extends Re.a{constructor(Ab){super(Ab)}Qs(){const Ab=Object(bb.d)(Ya.a.resolve(sa.Cf,{va:this.hh})),xc=Object(bb.d)(Ya.a.resolve(sa.bd,{va:this.hh}));Ba.TaskExtensions.Ua(Ab,eb=>{eb=eb.result;const Ub=ba.f(this.$);this.cr([new ce(this.$,eb,Ub,xc.result)])},this.$.xa)}static Aa(Ab){Ab.ka.ph(116,
new ff(Ab))}}Object(M.a)(ff,"FreezePanesCommandHandlerFactory",Re.a,[]);var af=a(420),xf=a(901);class eg extends af.a{constructor(Ab){super();this.$=Ab;this.Bl()}create(){He.a.nl()?void Ya.a.hj(sa.rc).then(Ab=>{this.Yj(Object(xf.a)(this.$.ka,502,()=>new oc(this.$,Ab)))}):this.Yj(Object(xf.a)(this.$.ka,502,()=>new oc(this.$,null)))}static Aa(Ab){Ab.ka.ph(503,new eg(Ab))}}Object(M.a)(eg,"FontDropdownHelperFactory",af.a,[]);(()=>{Zd.a.Qg(Ab=>{sa.Pc.Ha()||ff.Aa(Ab)})})();(()=>{Zd.a.Qg(Ab=>{sa.qc.Ha()||
eg.Aa(Ab)})})();String(f);String(r);String(d);String(k);String(t);String(m);String(e);String(w);String(l);String(u);String(n);String(v);String(B);String(z);String(C);String(D);String(J);String(W);window.___1708742503467_closurehack=f;window.___1708742503467_closurehack=r;window.___1708742503467_closurehack=d;window.___1708742503467_closurehack=k;window.___1708742503467_closurehack=t;window.___1708742503467_closurehack=m;window.___1708742503467_closurehack=e;window.___1708742503467_closurehack=w;window.___1708742503467_closurehack=
l;window.___1708742503467_closurehack=u;window.___1708742503467_closurehack=n;window.___1708742503467_closurehack=v;window.___1708742503467_closurehack=B;window.___1708742503467_closurehack=z;window.___1708742503467_closurehack=C;window.___1708742503467_closurehack=D;window.___1708742503467_closurehack=J;window.___1708742503467_closurehack=W}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.kpae.js.map/959c8fd1854a1c85b94809b937f647f6/EwaTS.kpae.js.map