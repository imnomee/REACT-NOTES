'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[19],{1045:function(y,x,a){a.d(x,"a",function(){return l});y=a(0);class c{constructor(){this.P8b=this.VSb=null;this.O2d=this.score=this.oYb=0}p$d(u,n,v){this.score=u.ma(n);++n;this.VSb=u.ma(n)?v.h5(u.ma(n)):null;++n;this.P8b=u.ma(n)?v.h5(u.ma(n)):null;++n;this.oYb=u.ma(n);++n;this.O2d=u.ma(n);++n;return n}}Object(y.a)(c,"TokenStringGeneratorInit",null,[]);class b{constructor(u,n,v,B,z){this.dIa=u;this.count=n;this.Cwc=
v;this.SG=B;this.depth=z}}Object(y.a)(b,"ErrorTolerantTrieMatch",null,[]);var f=a(1147),r=a(1276);class d{constructor(u,n,v,B){n=void 0===n?0:n;v=void 0===v?0:v;B=void 0===B?0:B;this.Wqh=(void 0===u?null:u)||new r.a;this.y$=n;this.SG=v;this.depth=B}get SS(){return this.Wqh}getKey(){return this.SS.Wu.toString()+":"+this.y$.toString()}}Object(y.a)(d,"TrieBookmark",null,[]);class k{constructor(u,n){this.soa=u;this.L1d=n}$zj(u){if(null==u)throw Error.argumentNull("prefix");let n={};var v=n[""]=new d;
this.BCc(v,n);for(v=0;v<u.length;++v){const B=u.charCodeAt(v),z={};for(let C in n)this.rCh(B,n[C],z);n=z}return this.SYk(n)}BCc(u,n){if(!(u.SG>=this.L1d)&&(u=new d(f.a.eud(u.SS),u.y$,u.SG+1,u.depth),u.SS.yA&f.a.oCa&&(u.y$+=1),this.soa.k8a(u.SS))){u.depth+=1;let v=!0;for(;v;)k.H1c(u,n),this.BCc(u,n),u.y$+=this.soa.xjb(u.SS,!0)+(u.SS.yA&f.a.oCa?1:0),v=this.soa.Z8b(u.SS)}}rCh(u,n,v){n.SG+1<=this.L1d&&(n.SG+=1,k.H1c(n,v),--n.SG);n.SS.yA&f.a.oCa&&(n.y$+=1);if(this.soa.k8a(n.SS)){n.depth+=1;let B=!0;for(;B;)n.SS.e9a===
u?(k.H1c(n,v),this.BCc(n,v)):n.SG+1<=this.L1d&&(n.SG+=1,k.H1c(n,v),this.BCc(n,v),--n.SG),n.y$+=this.soa.xjb(n.SS,!0)+(n.SS.yA&f.a.oCa?1:0),B=this.soa.Z8b(n.SS)}}SYk(u){const n=[];for(var v in u){const B=u[v];if(!B.SS.Wu)continue;const z=!!(B.SS.yA&f.a.oCa),C=this.soa.xjb(B.SS,!1)+(z?1:0);Array.add(n,new b(B.y$,C,z,B.SG,B.depth))}n.sort((B,z)=>{let C=B.dIa-z.dIa;return C||(C=-(B.count-z.count))?C:C=B.depth-z.depth});if(2>n.length)return n;u=[];for(v=0;v<n.length;)v+=k.uZg(v,n,u);return u}static H1c(u,
n){const v=u.getKey();v in n?(n=n[v],n.SG=Math.min(n.SG,u.SG)):n[v]=new d(f.a.eud(u.SS),u.y$,u.SG,u.depth)}static uZg(u,n,v){const B=n[u];let z=B.dIa;const C=z+B.count;let D=1,J=B.Cwc;for(;u+D<n.length&&n[u+D].dIa<C;){const W=n[u+D];W.dIa>z&&(Array.add(v,new b(z,W.dIa-z,J,B.SG,B.depth)),J=!1);D+=k.uZg(u+D,n,v);z=W.dIa+W.count}z<C&&Array.add(v,new b(z,C-z,J,B.SG,B.depth));return D}}Object(y.a)(k,"ErrorTolerantTrieLookupEngine",null,[739]);class t extends c{constructor(u,n,v){super();this.RQf=this.upg=
!1;this.Oqf=null;if(u){var B=0;try{B=this.p$d(u,B,n);this.upg=1===u.ma(B);++B;this.RQf=1===u.ma(B);++B;const z=u.ma(B);this.Oqf=this.i1j(v,z)}catch(z){throw Error.argument("initData");}}}i1j(u,n){return new k(u,n)}}Object(y.a)(t,"FuzzyMatchTokenStringGeneratorInit",c,[]);class m extends c{constructor(u,n){super();this.query=this.name=null;if(u){this.annotations=n.annotations;var v=0;try{v=this.p$d(u,v,n),this.name=n.ia(u.ma(v)),++v,this.query=n.dE(u.ma(v))}catch(B){throw Error.argument("initData");
}}}}Object(y.a)(m,"QueryTokenStringGeneratorInit",c,[]);class e extends c{constructor(u,n){super();if(u)try{this.p$d(u,0,n)}catch(v){throw Error.argument("initData");}}}Object(y.a)(e,"SurfaceStringTokenStringGeneratorInit",c,[]);var w=a(929);class l{constructor(u){this.x1d=u}get VSb(){return this.x1d.VSb}get P8b(){return this.x1d.P8b}get oYb(){return this.x1d.oYb}static create(u,n,v){const {SurfaceStringTokenStringGenerator:B}=a(1451),{QueryTokenStringGenerator:z}=a(1452),{FuzzyMatchTokenStringGenerator:C}=
a(1453);let D=0;try{if(u.ma(D)!==l.lVa)throw Error.argument("initData","Input does not represent a token string generator");++D;const J=u.ma(D);++D;const W=new w.a;W.oIa(u,D,u.count-D);switch(J){case B.mIb:return new B(new e(W,n));case z.mIb:return new z(new m(W,n));case C.mIb:return new C(new t(W,n,v));default:throw Error.argument("initData");}}catch(J){throw Error.argument("initData");}}static X_e(u,n,v,B,z,C){u=u.FXk.getId(n,null);if(0>u)return++C,C;l.Y_e(u,v,B,z);return C}static Y_e(u,n,v,B){Array.add(B.tse,
u);Array.add(B.pVg,n);++B.Zwb[v]}}l.lVa=1099767983;Object(y.a)(l,"TokenStringGenerator",null,[709])},1119:function(y,x,a){a.d(x,"a",function(){return c});y=a(0);class c{constructor(b){this.Ia=b}get Sya(){return this.Ia.Sya}get rTk(){return 4!==this.Ia.style}get vTk(){return!0}get trie(){return this.Ia.trie}getId(b,f){if(!this.rTk)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Ia.style){case 0:return this.CLi(b,f);default:throw Error.notImplemented();}}ia(b){if(!this.vTk)throw Error.invalidOperation("String lookup not supported on this string table");
if(0>b||b>=this.Sya)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Ia.style){case 0:return this.xVi(b);case 4:return this.wVi(b);default:throw Error.notImplemented();}}CLi(b,f){b=this.Ia.trie.c7f(b,0,b.length,f);if(!b.succeeded)return-1;if(0>b.mxb||b.mxb>=this.Ia.Sya)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Ia.$8b?this.Ia.X1b.Gv(this.Ia.$8b+4*b.mxb,4):b.mxb}xVi(b){if(this.Ia.$8b){let f=0;for(;f<this.Ia.Sya&&this.Ia.X1b.Gv(this.Ia.$8b+
4*f,4)!==b;++f);if(f>=this.Ia.Sya)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Ia.trie.jJf(f)}return this.Ia.trie.jJf(b)}wVi(b){const f=this.Ia.X1b.Gv(this.Ia.nVg+4*b,4);let r=this.Ia.X1b.Gv(this.Ia.oVg+4*b,4);if(0>r||0>f)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");b=Array(f);for(let d=0;d<f;++d)b[d]=(()=>{let k=this.rbk(r);({T6i:r}=k);return k})().returnValue;return String.fromCharCode.apply(null,b)}rbk(b){let f=
0;for(let r=0;3>r;++r){const d=this.Ia.X1b.ma(this.Ia.Haf+b)^182;++b;f|=(d&127)<<7*r;if(!(d&128))break}return{returnValue:f,T6i:b}}}Object(y.a)(c,"StringTable",null,[690])},1120:function(y,x,a){a.d(x,"a",function(){return b});y=a(0);var c=a(1147);class b{constructor(f){this.trie=null;this.Haf=this.nVg=this.oVg=this.$8b=0;if(f){this.X1b=f;var r=0;if(f.Gv(r,4)!==b.lVa)throw Error.argument("bytes","Input does not represent a string table");r+=4;this.Sya=f.Gv(r,4);r+=4;this.style=f.Gv(r,4);r+=4;switch(this.style){case 0:const d=
1===f.Gv(r,4);r+=4;d||(this.$8b=r,r+=4*this.Sya);f.Gv(r,4);this.trie=this.G1j(f,r+4);break;case 4:this.oVg=r;this.nVg=r+=4*this.Sya;r+=4*this.Sya;f.Gv(r,4);this.Haf=r+4;break;default:throw Error.argument("bytes");}}}G1j(f,r){return new c.a(f,r)}}b.lVa=1025118440;Object(y.a)(b,"StringTableInit",null,[])},1147:function(y,x,a){a.d(x,"a",function(){return k});y=a(0);class c{constructor(t){this.Dbg=t;this.succeeded=!1;this.mxb=t?t.mxb:0;this.Jpj=!1;this.length=this.wUk=0}}Object(y.a)(c,"TrieResult",null,
[]);class b{constructor(t,m,e){this.BLa=new c(null);this.yAj=t;this.aYb=m;this.H7f=m+e-1}get result(){return this.BLa}qGf(){let t;return this.aYb<=this.H7f?(t=this.yAj.charAt(this.aYb),++this.aYb,{returnValue:!0,ch:t}):{returnValue:!1,ch:"\x00"}}Ree(t,m,e){t&&(this.BLa.Jpj=!0,this.BLa.wUk=m);this.BLa.length=this.aYb;this.BLa.succeeded=!0;this.BLa.mxb=e;this.aYb!==this.H7f+1&&(this.BLa=new c(this.BLa))}}Object(y.a)(b,"LookUpStringVisitor",null,[705]);var f=a(1276);class r{constructor(){this.daf=this.b9e=
this.d9e=this.a9e=this.c9e=this.Grd=this.Frd=this.Ird=this.Erd=0}}Object(y.a)(r,"TRIESTATS",null,[]);class d{constructor(){this.symbol=this.sZb=0}}Object(y.a)(d,"TrieSymbol",null,[]);class k{constructor(t,m){this.NR=null;this.jKc=this.c8f=this.a8f=this.e8f=this.X7f=this.d8f=this.b8f=this.f8f=this.Y7f=0;this.qD=t;if(t.Gv(m,4)!==k.lVa)throw Error.argument("Input does not represent a trie");m+=4;this.L7f=1===t.Gv(m,4);m+=4;this.pAj=1===t.Gv(m,4);m+=4;this.mAj=t.Gv(m,4);m+=4;if(t.Gv(m,4)){t=m+4;this.NR=
this.ybk(t);this.Y7f=m=t+k.rNh;this.f8f=m+=k.rnc*(this.NR.Erd+(this.NR.Erd%2?1:0));this.b8f=m+=k.rnc*(this.NR.Ird+(this.NR.Ird%2?1:0));this.d8f=m+=k.rnc*(this.NR.Frd+(this.NR.Frd%2?1:0));this.X7f=m+=k.rnc*(this.NR.Grd+(this.NR.Grd%2?1:0));this.e8f=m+=k.Krd*this.NR.a9e;this.a8f=m+=k.Lrd*this.NR.d9e;this.c8f=m+=k.Lrd*this.NR.b9e;m+=k.Lrd*this.NR.c9e;if(m!==t+this.NR.daf)throw Error.argument("Corrupted trie binary");this.jKc=m}else this.NR=null}c7f(t,m,e,w){t=new b(t,m,e);this.k6g(t,w);return t.result}jJf(t){if(this.L7f)if(t)--t;
else return"";if(!this.NR)throw Error.argument("Invalid trieID");const m=new f.a;m.yA=0;this.k8a(m);const e=[];for(;;){if(m.yA&k.oCa)if(t)--t;else return Array.add(e,m.e9a),String.fromCharCode.apply(null,e);const w=!!(m.yA&k.e4c),l=this.xjb(m,!0);if(w||t<l){if(Array.add(e,m.e9a),!this.k8a(m))throw Error.argument("Invalid trieID");}else if(t-=l,!this.Z8b(m))throw Error.argument("Invalid trieID");}}k6g(t,m){let e=0;this.L7f&&(t.Ree(this.pAj,this.mAj,0),++e);if(this.NR){var w=new f.a;w.yA=0;if(this.k8a(w))for(;;){var l=
void 0,u=t.qGf();({ch:l}=u);if(!u.returnValue)break;m&&(l=m(l));l=l.toString().charCodeAt(0);for(u=!1;!u;){const n=!!(w.yA&k.oCa);if(w.e9a===l){if(u=!0,n&&t.Ree(!!(w.yA&k.fCe),w.RZc,e),!this.k8a(w))return}else if(e+=this.xjb(w,!0),!this.Z8b(w))return;n&&++e}}}}k8a(t){if(!t.yA)return this.eve(t),!0;if(!(t.yA&k.d4c))return!1;t.ena=0;t.Wu=t.VJa;this.eve(t);return!0}Z8b(t){if(t.yA&k.e4c)return!1;this.eve(t);return!0}xjb(t,m){return t.yA&k.eCe?t.qnc:t.yA&k.d4c?!m&&t.yA&k.e4c?this.rGi(t):1:0}rGi(t){t=k.eud(t);
if(!this.k8a(t))return 0;let m=0;do t.yA&k.oCa&&++m,m+=this.xjb(t,!1);while(this.Z8b(t));return m}eve(t){t.yA||(t.ena=0,t.Wu=this.jKc);var m=this.asc(this.Y7f,t.Wu),e=m.symbol;t.Wu+=m.sZb;m=this.qD.Gv(this.X7f+k.Krd*e,k.Krd);t.e9a=m&65535;t.yA=m>>16;t.yA&k.eCe&&(t.qnc=this.L8h(t));t.yA&k.fCe&&(m=this.asc(this.f8f,t.Wu),e=m.symbol,t.Wu+=m.sZb,t.RZc=this.qD.Gv(this.e8f+4*e,4));t.yA&k.ubh?(t.VJa=this.jKc+((this.qD.ma(t.Wu)<<8|this.qD.ma(t.Wu+1))<<8|this.qD.ma(t.Wu+2)),t.Wu+=3):t.yA&k.vbh?(t.VJa=t.Wu,
t.ena=t.VJa):t.yA&k.wbh?(m=this.asc(this.b8f,t.Wu),e=m.symbol,t.Wu+=m.sZb,t.VJa=this.jKc+this.qD.Gv(this.a8f+4*e,4)):t.yA&k.d4c&&(m=this.asc(this.d8f,t.Wu),e=m.symbol,t.Wu+=m.sZb,t.ena||(t.ena=t.Wu),t.ena+=this.qD.Gv(this.c8f+4*e,4),t.VJa=t.ena)}asc(t,m){const e=new d;let w=0;for(;;){w+=this.qD.ma(m);++m;++e.sZb;const l=this.qD.Gv(t,2);if(w<l)break;e.symbol+=l;w-=l;t+=2;w<<=8}e.symbol+=w;return e}L8h(t){let m=this.qD.ma(t.Wu);192<=m?(m=(m&63)<<15|(this.qD.ma(t.Wu+1)&127)<<8,m|=this.qD.ma(t.Wu+2),
t.Wu+=3):128<=m?(m=(m&127)<<8|this.qD.ma(t.Wu+1),t.Wu+=2):t.Wu+=1;return m}ybk(t){const m=new r;m.Erd=this.qD.Gv(t+12,2);m.Ird=this.qD.Gv(t+14,2);m.Frd=this.qD.Gv(t+16,2);m.Grd=this.qD.Gv(t+18,2);m.c9e=this.qD.Gv(t+24,4);m.a9e=this.qD.Gv(t+28,4);m.d9e=this.qD.Gv(t+32,4);m.b9e=this.qD.Gv(t+36,4);m.daf=this.qD.Gv(t+40,4);return m}static eud(t){const m=new f.a;m.e9a=t.e9a;m.yA=t.yA;m.qnc=t.qnc;m.Wu=t.Wu;m.VJa=t.VJa;m.ena=t.ena;m.RZc=t.RZc;return m}}k.lVa=1654263084;k.rNh=48;k.rnc=2;k.Lrd=4;k.Krd=4;k.oCa=
1;k.e4c=2;k.eCe=4;k.fCe=8;k.d4c=16;k.vbh=64;k.wbh=128;k.ubh=256;Object(y.a)(k,"Trie",null,[699])},1276:function(y,x,a){a.d(x,"a",function(){return c});y=a(0);class c{constructor(){this.RZc=this.ena=this.VJa=this.Wu=this.qnc=this.yA=this.e9a=0}}Object(y.a)(c,"TRIESCAN",null,[])},1451:function(y,x,a){a.r(x);a.d(x,"SurfaceStringTokenStringGenerator",function(){return b});y=a(0);var c=a(1045);class b extends c.a{constructor(f){super(f);this.Ia=f}apply(f,r,d,k,t,m,e){null==m&&(m=f.OJf(t,r));e=c.a.X_e(f,
m,this.Ia.score,d,k,e);return{Q8b:m,lIb:e}}}b.mIb=0;Object(y.a)(b,"SurfaceStringTokenStringGenerator",c.a,[])},1452:function(y,x,a){a.r(x);a.d(x,"QueryTokenStringGenerator",function(){return f});y=a(0);var c=a(1045),b=a(892);class f extends c.a{constructor(r){super(r);this.Ia=r}apply(r,d,k,t,m,e,w){d=this.Ia.query.load(d,null);m=0;let l=null;this.Ia.query.qS===b.Annotations.pca?d&&(l=this.Ia.name):((l=this.Ia.name)&&(l+="_"),l+=this.Ia.annotations.AZ(this.Ia.query.qS,d));null!=l&&(m=c.a.X_e(r,l,this.Ia.score,
k,t,m));return{Q8b:e,lIb:w+m}}}f.mIb=1;Object(y.a)(f,"QueryTokenStringGenerator",c.a,[])},1453:function(y,x,a){a.r(x);a.d(x,"FuzzyMatchTokenStringGenerator",function(){return b});y=a(0);var c=a(1045);class b extends c.a{constructor(f){super(f);this.Ia=f}apply(f,r,d,k,t,m,e){null==m&&(m=f.OJf(t,r));f=this.Ia.Oqf.$zj(m);if(this.Ia.upg)for(const l of f)if(!l.SG&&l.Cwc)return{Q8b:m,lIb:e};let w=0;for(const l of f)if(l.SG&&!(()=>{let u=this.$4e(l,!0,d,k,w);({Hrd:w}=u);return u})().returnValue)return{Q8b:m,
lIb:e};if(this.Ia.RQf)for(const l of f)if(!(()=>{let u=this.$4e(l,!1,d,k,w);({Hrd:w}=u);return u})().returnValue)break;return{Q8b:m,lIb:e}}$4e(f,r,d,k,t){let m;r?(r=0,m=f.Cwc?1:0):(r=f.Cwc?1:0,m=f.count-r);for(let e=0;e<m;++e)if(c.a.Y_e(f.dIa+r+e,this.Ia.score,d,k),++t,0<this.Ia.O2d&&t>=this.Ia.O2d)return{returnValue:!1,Hrd:t};return{returnValue:!0,Hrd:t}}}b.mIb=2;Object(y.a)(b,"FuzzyMatchTokenStringGenerator",c.a,[])},485:function(y,x,a){a.r(x);var c={};a.r(c);a.d(c,"AccountingFormatMenuCommandHandler",
function(){return Q});var b={};a.r(b);a.d(b,"AssistanceCommandHandler",function(){return Ha});var f={};a.r(f);a.d(f,"ConditionalFormattingCommandHandler",function(){return uc});var r={};a.r(r);a.d(r,"NumberFormatCommandHandler",function(){return gc});var d={};a.r(d);a.d(d,"NumberFormatViewModel",function(){return fc});var k={};a.r(k);a.d(k,"TellMeCommandHandler",function(){return kh});var t=a(179),m=a(0),e=a(14),w=a(38),l=a(69),u=a(209),n=a(66),v=a(5),B=a(212),z=a(35),C=a(262);class D extends Sys.EventArgs{constructor(L){super();
this.ocb=L}}Object(m.a)(D,"AccountingFormatMenuDataLoadedEventArgs",Sys.EventArgs,[]);var J=a(62);class W extends w.a{constructor(L,qa){super();this.FJj=()=>{this.raiseEvent("AccountingFormatOptionsDataLoadFailed")};this.GJj=Va=>{!z.a.rx(Va.Errors)&&Va.Result?this.raiseEvent("AccountingFormatMenuDataLoaded",new D(Va.Result)):this.raiseEvent("AccountingFormatOptionsDataLoadFailed")};this.ta=L;this.userOperationManager=qa}jmd(L){this.addHandler("AccountingFormatMenuDataLoaded",L)}oBg(L){this.removeHandler("AccountingFormatMenuDataLoaded",
L)}imd(L){this.addHandler("AccountingFormatOptionsDataLoadFailed",L)}nBg(L){this.removeHandler("AccountingFormatOptionsDataLoadFailed",L)}Xuj(){this.userOperationManager.enqueueOperation(new B.a(166,0,(L,qa,Va)=>{var Fb=this.ta;L=C.c(L,this.GJj);qa=C.b(qa,this.FJj);const bc=Fb.Za(5);return J.h(Fb,"GetAccountingFormatMenuData",bc,L,qa,Va,null,4)},16),null)}}Object(m.a)(W,"AccountingFormatMenuDataLoader",w.a,[416]);class N{constructor(L){this.Ya=L}gAi(L,qa){return this.OAi(L,qa).ML()}OAi(L,qa){qa=this.Ya.Vv(qa);
if(L){var Va=this.Ya.Oh();for(let Fb=0;Fb<L.NumberOfMenuItems;++Fb){const bc=this.U_h(Fb.toString(),L.MenuItemLabels[Fb]);Va.buttons.push(bc)}qa.vh.push(Va)}L=this.Ya.Oh();Va=this.H3h();L.buttons.push(Va);qa.vh.push(L);return qa}U_h(L,qa){L=this.Ya.b4(137,"Number.AccountingFormatOptionMenuItem_"+L,443187837,null,1,"None",0,0,L,!1,0);L.label=qa;L.L1(qa);return L}H3h(){return this.Ya.b4(137,"Number.MoreAccountingFormatOptionsMenuItem",2105621672,null,1,"None",496,0,"3",!1,1594)}}Object(m.a)(N,"AccountingFormatMenuRenderer",
null,[260]);var M=a(97);let Q=class extends w.a{constructor(L,qa,Va,Fb,bc,Ic){Fb=void 0===Fb?null:Fb;bc=void 0===bc?null:bc;Ic=void 0===Ic?null:Ic;super();this.kYe=0;this.ocb=null;this.fB=0;this.menuId=this.NQ=null;this.hdg=()=>{this.ocb=null;this.fB=3;this.M4f("OnAccountingFormatMenuDataLoadFailure");this.wpa();this.raiseEvent("ek2")};this.idg=(td,Hd)=>{this.ocb=Hd.ocb;this.fB=2;this.M4f("OnAccountingFormatMenuDataLoadSuccess");this.wpa();this.raiseEvent("ek1")};this.frame=v.e.Ha()?L.frame:Fb;this.zLb=
v.e.Ha()?new W(L.pa.ta,L.userOperationManager):bc;this.zLb.jmd(this.idg);this.zLb.imd(this.hdg);this.ek=Va;this.npb=v.e.Ha()?new N(qa):Ic;this.Pnk()}jmd(L){this.addHandler("ek1",L)}oBg(L){this.removeHandler("ek1",L)}imd(L){this.addHandler("ek2",L)}nBg(L){this.removeHandler("ek2",L)}dispose(){this.zLb.oBg(this.idg);this.zLb.nBg(this.hdg);super.dispose()}Ji(L,qa,Va){if("PopulateAccountingFormatsMenu"!==qa)return!1;this.menuId=Va.MenuId;if(2!==this.fB&&3!==this.fB)return!1;this.NQ=this.NQ||this.npb.gAi(this.ocb,
Va.MenuId);Va.MenuItems=this.NQ;return!0}Bi(){return!1}ni(L,qa){return 443187837===qa.command}executeCommand(L,qa,Va){return 443187837===qa.command?(L={ValidMembers:32,NumberFormat:14},L.NumberFormatOptions=this.ocb.NumberFormatOptions[parseInt(Va[l.a.Ai].toString(),10)],this.ek.formatCells(443187837,L,qa),n.Task.Va(!0)):u.a(qa.command)}Pnk(){this.kYe=Date.now();this.fB=1;this.zLb.Xuj()}M4f(L){const qa=Date.now()-this.kYe;e.ULS.sendTraceTag(537155170,0,50,`AccountingFormatMenuCommandHandler.${L}: AccountingFormat Menu loading time was : ${qa} ms`)}wpa(){this.menuId&&
this.frame.wA(this.menuId)}};Q=Object(t.__decorate)([Object(M.d)(v.e),Object(t.__param)(0,Object(v.Lb)()),Object(t.__param)(1,Object(v["if"])()),Object(t.__param)(2,Object(v.sc)())],Q);Object(m.a)(Q,"AccountingFormatMenuCommandHandler",w.a,[39,232]);var R=a(6),O=a(278),U=a(60),K=a(7),F=a(86),I=a(1),P=a(151),Y=a(28),ea=a(281),Ba=a(139);class Fa{constructor(){this.correlationId=this.sessionId=this.Ofd=null;this.actionId=0;this.pcb=null}get Ij(){return this.Ofd?this.Ofd:""}set Ij(L){this.Ofd=L}}Object(m.a)(Fa,
"AssistanceSearchVariableUrlParameterSet",null,[]);var za=a(291),xa=a(598),fa=a(134);class V{constructor(){this.qG=!1;this.zN=!0;this.dUe=this.Vyb=null}get isInitialized(){return this.qG}initialize(L,qa){const Va=!!L&&!!qa;Va&&(this.Vyb=L,this.dUe=qa);this.qG=Va}ko(L){L||(L=R.AFrameworkApplication.jh);this.zN=R.AFrameworkApplication.zC;Object(ea.a)().execute(qa=>{qa.isFeatureEnabled("mso_sendASmile",!0).then(Va=>{this.zN=R.AFrameworkApplication.zC&&Va;(Va=R.AFrameworkApplication.ra)&&Va.AB();return null},
()=>null)});L.Hh(Y.a.searchHelp,fa.a.frame,Object(Ba.a)(this,this.pNk,"showSearchResults"))}pNk(L,qa,Va,Fb,bc){if(1===Va)return R.AFrameworkApplication.fa.la("IsFeedbackExperiencesAvailable")||(this.zN=!1),bc&&"SourceControlId"in bc&&(bc=bc.SourceControlId,("GiveFeedback"===bc||"btnFeedback"===bc||"btnFeedbackPane"===bc||"PptEditingStatusBar.GiveFeedbackPane"===bc||"GiveFeedbackPane"===bc)&&!this.zN)?8:xa.SessionStatusManager.instance.Fkb?8:32;e.ULS.sendTraceTag(4761738,1302,50,"");za.a.mark(4771);
if(this.isInitialized){L=bc.CommandValueId;qa=bc.SourceControlId;bc=Object.assign(new Fa,{actionId:Y.a.searchHelp,pcb:bc});if(void 0!==L&&null!==L)bc=V.FXi(L);else if(void 0!==qa&&null!==qa)switch(qa){case "btnFeedback":case "btnFeedbackPane":case "PptEditingStatusBar.GiveFeedbackPane":case "GiveFeedbackPane":case "GiveFeedback":bc.actionId=Y.a.giveFeedback;break;case "btnContactSupport":case "ContactSupport":bc.actionId=Y.a.contactSupport;break;case "btnShowTraining":case "Training":bc.actionId=
Y.a.FYk;break;case "btnWhatsNew":case "WhatsNew":bc.actionId=Y.a.Nal}this.Vyb.ZKk(this.dUe,bc);za.a.mark(4772);return 32}za.a.mark(4772);return 8}dispose(){this.Vyb&&(this.Vyb.dispose(),this.Vyb=null)}static get instance(){V.Wa||(V.Wa=new V);return V.Wa}static FXi(L){const qa=new Fa,Va=L.indexOf("|");qa.sessionId=L.substring(0,Va);const Fb=L.indexOf("|",Va+1);qa.correlationId=L.substring(Va+1,Fb);qa.Ij=L.substr(Fb+1);return qa}}V.Wa=null;Object(m.a)(V,"AssistanceActor",null,[2]);var ba=a(31),la=a(890);
class Ta{constructor(){this.cEe=this.Ga=this.F9a=null;this.Ued=!1}ZKk(L,qa){if(qa.actionId!==Y.a.giveFeedback||R.AFrameworkApplication.zC)if(this.Ued&&!R.AFrameworkApplication.disableWholeAppsForOfficeFeature)this.F9a||(this.F9a=this.cEe()),this.F9a.T6b();else if(qa.actionId===Y.a.giveFeedback)this.CKk();else{L=L.yAc(qa);qa=null;try{ba.a.Kxa(L)&&(qa=U.a.dm(L,"_blank","height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no",
"AssistanceDisplayManager:HelpWindow"))}catch(Va){throw e.ULS.sendTraceTag(4543175,1302,10,"An exception has occured while trying to launch the Online Assistance window: "+Va.message),Va;}qa?e.ULS.sendTraceTag(4543177,1302,50,"Window.Open() returned a window when opened with URL {0}",L):e.ULS.sendTraceTag(4543176,1302,15,"Window.Open() returned a null window when opened with URL {0} and help options {1}",L,"height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no")}else e.ULS.sendTraceTag(554295451,
356,15,"ShowFeedbackButton is false, but ShowContent got called, some feedback entry point is still visible")}dispose(){this.F9a&&(this.F9a.dispose(),this.F9a=null)}iOg(L,qa,Va){Va&&la.c(L)?this.Ued=!1:(this.cEe=L,this.Ued=Va);this.Ga=qa}CKk(){R.AFrameworkApplication.jh.Gk(Y.a.giveFeedback,2)}static createInstance(L,qa,Va){Va=void 0===Va?null:Va;const Fb=new Ta;null==Va?Fb.iOg(L,qa,R.AFrameworkApplication.O5e||qa.la("HelpTabIsEnabled")):Fb.iOg(L,qa,Va);return Fb}}Object(m.a)(Ta,"AssistanceDisplayManager",
null,[631,2]);var Ea=a(646);class sa{constructor(L,qa,Va,Fb,bc){this.bsa=L;this.Qlh=qa;this.cfc=Va;this.Idh=Fb;this.Wcd=bc}get lcid(){return this.bsa}get namespace(){return this.Qlh}get k2a(){return this.cfc}get cFh(){return this.Idh}get locale(){return this.Wcd}static hXi(L){const qa=L.indexOf(".");return 0<=qa&&qa<L.length&&(L=parseInt(L.substring(0,qa)),!isNaN(L))?L:sa.dGh}static createInstance(L){return new sa(R.AFrameworkApplication.lcid,L,sa.hXi(R.AFrameworkApplication.buildVersion),"WDWAENDUSER,XLWAENDUSER,PPWAENDUSER,ONWAENDUSER",
Ea.a.qU(R.AFrameworkApplication.lcid).name)}}sa.dGh=16;Object(m.a)(sa,"AssistanceSearchUrlParameterSet",null,[]);var Ya=a(284);class bb{constructor(L,qa){L=new Ya.QueryStringBuilder(L);L.Kp("clid",qa.lcid.toString());L.Kp("p1",qa.namespace);L.Kp("ver",qa.k2a.toString());L.Kp("apps",qa.cFh);L.Kp("lc",qa.locale);this._url=L.toString()}yAc(L){const qa=new Ya.QueryStringBuilder(this._url);qa.Kp("src","TellMe");qa.Kp("query",L.Ij);qa.Kp("sessionid",L.sessionId);qa.Kp("correlationid",L.correlationId);return qa.toString()}static createInstance(L){return new bb(R.AFrameworkApplication.P5e,
L)}}Object(m.a)(bb,"AssistanceSearchUrlProvider",null,[629]);class ra{ao(){}init(){R.AFrameworkApplication.KUa&&!R.AFrameworkApplication.suppressHelp&&V.instance.ko(R.AFrameworkApplication.jh)}dispose(){V.instance.dispose()}b$i(){V.instance.initialize(Ta.createInstance("XLWAEndUser",R.AFrameworkApplication.fa),bb.createInstance(sa.createInstance(void 0)))}}Object(m.a)(ra,"AssistancePackage",null,[12,13]);class Da extends ra{constructor(){super()}get name(){return"Excel.Assistance"}init(){super.init();
this.b$i()}}Object(m.a)(Da,"ExcelAssistancePackage",ra,[]);var oa=a(103);let Ha=class{constructor(L,qa){this.Wp=L;this.$=qa;R.AFrameworkApplication.KUa&&O.a.instance.Lo(new Da)}Bi(){return!1}executeCommand(L,qa,Va,Fb){I.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback")&&P.b(this.$).she();L=Va[l.a.Ai];if(!I.EwaSettings.Ra(221)&&(L&&L===K.a.Hde||7===qa.lk&&Va.SourceControlId===this.$.$h+K.a.vJa))return 2===this.Wp.Xj(Y.a.giveFeedback,2,Va)?u.a(qa.command):n.Task.Va(!0);
if(I.EwaSettings.Ra(221)&&!R.AFrameworkApplication.disableWholeAppsForOfficeFeature&&(2===qa.lk||7===qa.lk||I.EwaSettings.isChangeGateEnabled("OfficeVSO:3009717_EnableTellMeHelpForAgaveHelpPane")&&-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback Tutorials".split(" "),L))){Va[K.a.Fia]=Fb?Fb.enabledInViewModeRibbon:!1;qa=new F.a(-859308420,qa.method,qa.mode,qa.lk,qa.tabName);I.EwaSettings.isChangeGateEnabled("OfficeVSO:8192446_HelpTabTelemetry")&&oa.b("HelpTab"+L);if("WhatsNew"===
L&&I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.HelpTabShip",!1))return U.a.dm("https://techcommunity.microsoft.com/t5/excel-blog/bg-p/ExcelBlog"),n.Task.Va(!0);"Tutorials"===L&&(Va[l.a.Wk]="AssetID=9bc05390-e94c-46af-a5b3-d7c22f6990bb");return this.$.Ma.dh(qa,Va)}return 2===this.Wp.Xj(Y.a.searchHelp,2,Va)?u.a(qa.command):n.Task.Va(!0)}ni(L,qa){return R.AFrameworkApplication.KUa?-1376725189===qa.command||-1969051244===qa.command:!1}Ji(){return!1}};Ha=Object(t.__decorate)([Object(M.d)(v.m),
Object(t.__param)(0,Object(v.f)()),Object(t.__param)(1,Object(v.Lb)())],Ha);Object(m.a)(Ha,"AssistanceCommandHandler",null,[39]);var ka=a(2);class wa{constructor(){this.QuickFormatType=this.Command=0;this.Formula2=this.Formula1=null;this.Value=10;this.Unique=!1;this.TimePeriodType=0;this.StopIfTrue=!1;this.Priority=-1;this.CustomFormat=null}}Object(m.a)(wa,"ConditionalFormattingOptions",null,[]);var Za=a(10),ab=a(991),db=a(181);const mb=(L,qa,Va,Fb,bc,Ic,td,Hd)=>{Hd=L.Za(1,void 0===Hd?null:Hd);Hd.entireSheet=
qa;Hd.selectedRanges=Va;return J.h(L,"GetConditionalFormattingRules",Hd,Fb,bc,Ic,td,4)},Ia=(L,qa,Va,Fb,bc,Ic,td,Hd,pe)=>{pe=L.Za(9,void 0===pe?null:pe);pe.deleteCommandType=qa;pe.selectedRanges=Va;pe.id=Fb;return J.h(L,"DeleteConditionalFormattingRules",pe,bc,Ic,td,Hd,0)},pa=(L,qa,Va,Fb,bc,Ic,td,Hd,pe)=>{pe=L.Za(9,void 0===pe?null:pe);pe.conditionalFormattingOptions=qa;pe.selectedRanges=Va;pe.activeCell=Fb;return J.h(L,"AddConditionalFormattingRule",pe,bc,Ic,td,Hd,0)},lb=(L,qa,Va,Fb,bc,Ic,td,Hd,pe,
Ke)=>{Ke=L.Za(9,void 0===Ke?null:Ke);Ke.id=qa;Ke.conditionalFormattingOptions=Va;Ke.range=Fb;Ke.activeCell=bc;return J.h(L,"QuickEditConditionalFormattingRule",Ke,Ic,td,Hd,pe,0)};var ha=a(45),ua=a(225),fb=a(196),Ka=a(252),La=a(1531);const ib=(L,qa,Va,Fb,bc,Ic)=>{var td,Hd,pe,Ke,uf,zf,bg,kg,ug,Gg,ah,Qg,Uh,vh,X,jb,Pb,ed,zd,be,we,ef,vf,Jf;e.ULS.sendTraceTag(537167185,0,50,"GetConditionalFormattingRulesHelper.OnGetConditionalRulesSuccessCallback");if(L&&Ka.a(L)){a:switch(L.Errors[0].MessageId){case -139005925:qa=
1;break a;case 1557873584:qa=2;break a;default:qa=0}0!==qa?(e.ULS.sendTraceTag(593589700,0,15,`GetConditionalFormattingRulesHelper.OnGetConditionalRulesSuccessCallback: request ended with expected error: ${L.Errors[0].MessageIdName}.`),bc(Fb,null,qa)):(Fb=z.a.Kh(L.Errors),e.ULS.sendTraceTag(593589699,0,15,`GetConditionalFormattingRulesHelper.OnGetConditionalRulesSuccessCallback: request ended with errors: ${Fb}.`),I.EwaSettings.isChangeGateEnabled("OfficeVSO:8380585_InvestigateConditionalFormattingCriticalError_5")&&
Ic&&"InvalidSheetName"===Fb&&e.ULS.sendTraceTag(508071950,0,15,`GetConditionalFormattingRulesHelper.OnGetConditionalRulesSuccessCallback: \
            request ended with errors: ${Fb}. \
            triggerMethod: ${Ic.triggerMethod}. \
            isInputSheetNameValid: ${Ic.rkj}. \
            isActiveItemSheetNameValid: ${Ic.Wdj}. \
            onConditionalFormattingRulesChangedCallTimeStamp: ${null!==(Hd=null===(td=Ic.qMj)||void 0===td?void 0:td.getTime())&&void 0!==Hd?Hd:-1}. \
            metadataVersionBeforeLastUpdate: ${Ic.UDj}. \
            lastMetadataVersionNumber: ${Ic.uZd}. \
            lastMetadataVersionNumberUpdateOwner: ${Ic.vZd}. \
            lastMetadataVersionNumberUpdateTimestamp: ${null!==(Ke=null===(pe=Ic.wZd)||void 0===pe?void 0:pe.getTime())&&void 0!==Ke?Ke:-1}. \
            lastRaiseEventStart: ${null!==(zf=null===(uf=Ic.DZd)||void 0===uf?void 0:uf.getTime())&&void 0!==zf?zf:-1}. \
            lastRaiseEventEnd: ${null!==(kg=null===(bg=Ic.CZd)||void 0===bg?void 0:bg.getTime())&&void 0!==kg?kg:-1}. \
            lastDeleteSheetBeforeGoingToServerTimeStamp: ${null!==(Gg=null===(ug=Ic.gZd)||void 0===ug?void 0:ug.getTime())&&void 0!==Gg?Gg:-1}. \
            lastDeleteMetadataVersionNumber: ${Ic.bZd}. \
            lastDeleteMetadataVersionNumberUpdateTimestamp: ${null!==(Qg=null===(ah=Ic.cZd)||void 0===ah?void 0:ah.getTime())&&void 0!==Qg?Qg:-1}. \
            lastDeleteRaiseEventStart: ${null!==(vh=null===(Uh=Ic.eZd)||void 0===Uh?void 0:Uh.getTime())&&void 0!==vh?vh:-1}. \
            lastDeleteRaiseEventEnd: ${null!==(jb=null===(X=Ic.dZd)||void 0===X?void 0:X.getTime())&&void 0!==jb?jb:-1}. \
            lastWorkbookMetadataChangedEventOnDeleteSheetTimeStamp: ${null!==(ed=null===(Pb=Ic.UZd)||void 0===Pb?void 0:Pb.getTime())&&void 0!==ed?ed:-1}. \
            lastDeleteSheetFromClientTimeStamp: ${null!==(be=null===(zd=Ic.hZd)||void 0===zd?void 0:zd.getTime())&&void 0!==be?be:-1}. \
            lastDeleteSetActiveItemTimeStamp: ${null!==(ef=null===(we=Ic.fZd)||void 0===we?void 0:we.getTime())&&void 0!==ef?ef:-1}. \
            isActiveSheetNameValidCalled: ${Ic.caa.wTf}. \
            isActiveSheetNameValidCallTime: ${null!==(Jf=null===(vf=Ic.caa.vTf)||void 0===vf?void 0:vf.getTime())&&void 0!==Jf?Jf:-1}. \
            activeItemSheetNameValid: ${Ic.caa.KYe}. \
            activeItemErrorCode: ${Ic.caa.JYe}. \
            latestWorkbookMetadataValid: ${Ic.caa.f3f}. \
            sheetChangesValid: ${Ic.caa.JOg}. \
            sheetChangesSize: ${Ic.caa.IOg}. \
            deleteOrRenameChangeInfoFound: ${Ic.caa.dzd}. \
            deletedRenamedSheetNameValid: ${Ic.caa.gzd}. \
            deletedRenamedErrorCode: ${Ic.caa.fzd}. \
            activeSheetNameEqualsChangeInfoName: ${Ic.caa.dld}. \
            isActiveSheetNameValidReturnValue: ${Ic.caa.YRd}. \
            `))}else if(L&&L.Result){td=L.Result;Hd=td.Rules.length;Ic=pe=0;for(var yg of td.Rules)yg&&pe++;e.ULS.sendTraceTag(537167184,0,50,`GetConditionalFormattingRulesHelper.ProcessConditionalFormattingResult got ${Hd} rules from server, ${Hd-pe} rules with errors.`);if(1>pe)qa=[];else{yg=Array(pe);for(const Pg of td.Rules)if(Pg){td=ha.j(ha.h(Pg.Range.Ranges),qa.listSeparator,qa,!1,!1,!1);td=pe={ruleType:0,ruleId:Pg.RuleId,ruleName:Pg.Name,priority:Pg.Priority,stopIfTrue:Pg.StopIfTrue,ruleRange:td,
ruleRangeSheetName:Va};Hd=Pg;switch(Hd.Type){case 0:td.ruleType=0;td.colorScaleFormat={};Hd.ColorScaleFormat?(td.colorScaleFormat.maximumColor=Hd.ColorScaleFormat.MaxPointColor,td.colorScaleFormat.maximumCFObjectValues={type:Hd.ColorScaleFormat.MaxPointCFValueObject.Type,formula:Hd.ColorScaleFormat.MaxPointCFValueObject.Formula,number:Hd.ColorScaleFormat.MaxPointCFValueObject.Number},td.colorScaleFormat.minimumColor=Hd.ColorScaleFormat.MinPointColor,td.colorScaleFormat.minimumCFObjectValues={type:Hd.ColorScaleFormat.MinPointCFValueObject.Type,
formula:Hd.ColorScaleFormat.MinPointCFValueObject.Formula,number:Hd.ColorScaleFormat.MinPointCFValueObject.Number},td.colorScaleFormat.midpointColor=Hd.ColorScaleFormat.MidPointColor,Hd.ColorScaleFormat.MidPointCFValueObject&&(td.colorScaleFormat.midpointCFObjectValues={type:Hd.ColorScaleFormat.MidPointCFValueObject.Type,formula:Hd.ColorScaleFormat.MidPointCFValueObject.Formula,number:Hd.ColorScaleFormat.MidPointCFValueObject.Number})):e.ULS.shipAssertTag(537167183,0,!1,"GetConditionalFormattingRulesHelper.SetFormatForRuleType: got null rule.ColorScaleFormat for color scale rule type");
break;case 1:td.ruleType=1;td.dataBarFormat={isGradientFill:!1,isLTRDirection:!1,isNegativeValuesFillColorCustom:!1,isNegativeValuesBorderColorCustom:!1,isShowValueEnabled:!1,axisPositionType:0};Hd.DataBarFormat?(td.dataBarFormat.isGradientFill=Hd.DataBarFormat.IsGradientFill,td.dataBarFormat.isLTRDirection=Hd.DataBarFormat.IsLTRDirection,td.dataBarFormat.fillColor=Hd.DataBarFormat.FillColor,td.dataBarFormat.borderColor=Hd.DataBarFormat.BorderColor,td.dataBarFormat.isNegativeValuesFillColorCustom=
Hd.DataBarFormat.IsNegativeValuesFillColorCustom,td.dataBarFormat.negativeValuesFillColor=Hd.DataBarFormat.NegativeValuesFillColor,td.dataBarFormat.isNegativeValuesBorderColorCustom=Hd.DataBarFormat.IsNegativeValuesBorderColorCustom,td.dataBarFormat.negativeValuesBorderColor=Hd.DataBarFormat.NegativeValuesBorderColor,td.dataBarFormat.isShowValueEnabled=Hd.DataBarFormat.IsShowValueEnabled,td.dataBarFormat.axisColor=Hd.DataBarFormat.AxisColor,td.dataBarFormat.axisPositionType=Hd.DataBarFormat.AxisPositionType,
td.dataBarFormat.minBoundCFObjectValues={type:Hd.DataBarFormat.MinBoundCFValueObject.Type,formula:Hd.DataBarFormat.MinBoundCFValueObject.Formula,number:Hd.DataBarFormat.MinBoundCFValueObject.Number},td.dataBarFormat.maxBoundCFObjectValues={type:Hd.DataBarFormat.MaxBoundCFValueObject.Type,formula:Hd.DataBarFormat.MaxBoundCFValueObject.Formula,number:Hd.DataBarFormat.MaxBoundCFValueObject.Number}):e.ULS.shipAssertTag(537167182,0,!1,"GetConditionalFormattingRulesHelper.SetFormatForRuleType: got null rule.DataBar for color data bar rule type");
break;case 2:td.ruleType=2;td.iconSetFormat={isReverseIconsOrder:!1,isIconOnly:!1};if(Hd.IconSetFormat)for(td.iconSetFormat.isReverseIconsOrder=Hd.IconSetFormat.ReverseOrder,td.iconSetFormat.isIconOnly=Hd.IconSetFormat.IsIconOnly,e.ULS.shipAssertTag(537167181,0,!!Hd.IconSetFormat.Icons,"GetConditionalFormattingRulesHelper.SetFormatForRuleType: got null rule.IconSetFormat.Icons for icon set rule type"),td.iconSetFormat.icons=Array(Hd.IconSetFormat.Icons.length),td.iconSetFormat.conditionalFormattingIconsCustomOptions=
[],Ke=0;Ke<Hd.IconSetFormat.Icons.length;Ke++)td.iconSetFormat.icons[Ke]={index:Hd.IconSetFormat.Icons[Ke].Icon,iconSet:Hd.IconSetFormat.Icons[Ke].IconSet},td.iconSetFormat.conditionalFormattingIconsCustomOptions.push({isGreaterEqual:Hd.IconSetFormat.ConditionalFormattingIconsCustomOptions[Ke].IsGreaterEqual,thl:{type:Hd.IconSetFormat.ConditionalFormattingIconsCustomOptions[Ke].CFValueObject.Type,formula:Hd.IconSetFormat.ConditionalFormattingIconsCustomOptions[Ke].CFValueObject.Formula,number:Hd.IconSetFormat.ConditionalFormattingIconsCustomOptions[Ke].CFValueObject.Number}});
else e.ULS.shipAssertTag(537167180,0,!1,"GetConditionalFormattingRulesHelper.SetFormatForRuleType: got null rule.IconSetFormat for icon set rule type");break;case 3:td.ruleType=3;td.customFormat={isTextBold:!1,isTextItalic:!1,isTextStrikethrough:!1,isTextUnderlined:!1,isTextDoubleUnderlined:!1};if(Hd.CustomFormat){td.customFormat.backgroundColor=Hd.CustomFormat.BackgroundColor;td.customFormat.textColor=Hd.CustomFormat.TextColor;td.customFormat.isTextBold=Hd.CustomFormat.IsTextBold;td.customFormat.isTextItalic=
Hd.CustomFormat.IsTextItalic;td.customFormat.isTextStrikethrough=Hd.CustomFormat.IsTextStrikethrough;td.customFormat.isTextUnderlined=Hd.CustomFormat.IsTextUnderlined;td.customFormat.isTextDoubleUnderlined=Hd.CustomFormat.IsTextDoubleUnderlined;if(Hd.CustomFormat.BorderFormat)for(td.customFormat.borderFormat={},td.customFormat.borderFormat.lineStyle=Array(4),td.customFormat.borderFormat.color=Array(4),td.customFormat.borderFormat.thickness=Array(4),Ke=0;4>Ke;Ke++)td.customFormat.borderFormat.lineStyle[Ke]=
Hd.CustomFormat.BorderFormat.LineStyle[Ke],td.customFormat.borderFormat.color[Ke]=fb.a.lJ(ua.a.mM(Hd.CustomFormat.BorderFormat.Color[Ke])),td.customFormat.borderFormat.thickness[Ke]=Hd.CustomFormat.BorderFormat.Thickness[Ke];Ke=td.customFormat;if(uf=Hd.CustomFormat.GradientFill)if(!uf.GradientStops||1>=uf.GradientStops.length||uf.Type===La.a.Path&&2!==uf.GradientStops.length)e.ULS.shipAssertTag(591663646,0,!1,`GetConditionalFormattingRulesHelper.GetFillGradientProperties: missing gradient stops, length=${uf.GradientStops?
uf.GradientStops.length:-1}.`),uf=null;else{zf={isLinearGradient:uf.Type===La.a.Linear,degree:uf.Degree};zf.gradientStops=Array(uf.GradientStops.length);for(bg=0;bg<uf.GradientStops.length;bg++)zf.gradientStops[bg]=fb.a.lJ(ua.a.mM(uf.GradientStops[bg].Color));zf.isLinearGradient||(zf.radialGradientPosition={},uf.FillToRight&&1!==uf.FillToRight?zf.radialGradientPosition.isCenter=!0:(zf.radialGradientPosition.isCenter=!1,zf.radialGradientPosition.isRight=1===uf.FillToRight,zf.radialGradientPosition.isBottom=
1===uf.FillToBottom));uf=zf}else uf=null;Ke.gradientFill=uf;Hd.EditOptions&&(td.editOptions={command:Hd.EditOptions.Command,formula1:Hd.EditOptions.Formula1,formula2:Hd.EditOptions.Formula2,value:Hd.EditOptions.Value,unique:Hd.EditOptions.Unique,timePeriod:Hd.EditOptions.TimePeriodType})}else e.ULS.shipAssertTag(537167179,0,!1,"GetConditionalFormattingRulesHelper.SetFormatForRuleType: got null rule.CustomFormat for custom rule type");break;default:e.ULS.sendTraceTag(537167178,0,10,"GetConditionalFormattingRulesHelper.GetReactRuleType unexpected rule type")}yg[Ic]=
pe;Ic++}qa=yg}bc(Fb,qa,0)}else e.ULS.sendTraceTag(593589698,0,10,`GetConditionalFormattingRulesHelper.OnGetConditionalRulesSuccessCallback: failed to get rules from server. Result is null: ${!L}.`)},Yb=L=>{e.ULS.sendTraceTag(593589697,0,50,`GetConditionalFormattingRulesHelper.OnGetConditionalRulesFailed: status = ${L.data.status}, HTTP status = ${L.data.httpStatus}.`)},Wc=(L,qa)=>L.priority-qa.priority;var Qc=a(24),Wb=a(161);class Jc extends Sys.EventArgs{constructor(L,qa){super();this.xSd=qa}}Object(m.a)(Jc,
"ConditionalFormattingSheetProtectionOptionsChangedEventArgs",Sys.EventArgs,[]);var ma=a(32);class Hc{constructor(L){this.SUj="OnProtectionOptionsChanged";this.KJj="OnActiveSheetChanging";this.n1a=!1;this.Og=new w.a;this.mrc=this.MIc=this.ZIc=this.m4b=0;this.Hpc=null;this.CF=!1;this.eMa=(qa,Va)=>{Qc.f(this.$).inRangePicker||Qc.f(this.$).Pp||!Va.na||(this.Obf(),this.Ydj(Va.na)?this.Og.raiseEvent("sheetProtectionOptionsChangedEventKey",new Jc(!0,!1)):this.Ioa(this.KJj,Va.na.sheetName,!1))};this.O_b=
(qa,Va)=>{Va.newName!==Va.oldName&&Va.newName===this.$.sa.na.name&&this.I2k(Va.newName);I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CondFormatHandleDeletedRenamedSheet",!1)&&this.VSd()&&(this.CF&&e.ULS.sendTraceTag(507831453,0,50,"Calling onConditionaFormattingRulesChanged(onSheetRenameMethod)"),this.Ioa("OnSheetRename"))};this.vH=()=>{I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CondFormatHandleDeletedRenamedSheet",!1)&&this.VSd()&&(this.CF&&e.ULS.sendTraceTag(507831452,
0,50,"Calling onConditionaFormattingRulesChanged(onSheetDeletedMethod)"),this.Ioa("OnSheetDeletedMethod"))};this.ol=()=>{if(I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CondFormatHandleDeletedRenamedSheet",!1))this.VSd()&&this.Ioa("LatestCFStateIdChanged");else{const {Pmb:qa,oce:Va}=this.Pmb();qa&&this.$.na&&this.$.na.sheetName===Va||this.mrc===this.$.ea.Cq.ConditionalFormattingRulesStateId||this.Ioa("LatestCFStateIdChanged")}};this.Oi=(qa,Va)=>{e.ULS.sendTraceTag(537167202,0,50,"ActiveSheetConditionalFormattingRules.OnSessionIdChanged Begin of OnSessionIdChanged");
Va.rM&&this.Ioa("OnSessionIdChanged");e.ULS.sendTraceTag(537167201,0,50,"ActiveSheetConditionalFormattingRules.OnSessionIdChanged End of OnSessionIdChanged")};this.Dt=()=>{e.ULS.sendTraceTag(537167200,0,50,"ActiveSheetConditionalFormattingRules.OnLoadOnDemand");this.Ioa("OnLoadOnDemand")};this.A3k=(qa,Va,Fb)=>{qa>this.MIc&&(this.MIc=qa,this.Hpc=Va,this.T9c=void 0===Fb?0:Fb,this.n1a=!0,this.Og.raiseEvent("ConditionalFormattingRulesChangedEventKey"))};this.QPj=(qa,Va,Fb)=>{this.n1a=!1;Yb(qa,Va,Fb)};
this.$=L;this.T9c=0;this.$.ea.Cq&&(this.mrc=this.$.ea.Cq.ConditionalFormattingRulesStateId);this.CF=I.EwaSettings.isChangeGateEnabled("OfficeVSO:8380585_InvestigateConditionalFormattingCriticalError_5")}get xBf(){return this.T9c}Sxh(L){this.Og.addHandler("ConditionalFormattingRulesChangedEventKey",L);this.m4b++;1===this.m4b&&this.Jdk();this.Ioa("OnConditionalFormattingRulesChangedEventRegistered")}Aik(L){this.Og.removeHandler("ConditionalFormattingRulesChangedEventKey",L);1>this.m4b||(this.m4b--,
this.m4b||this.N0g())}PAh(L){this.Og.addHandler("sheetProtectionOptionsChangedEventKey",L)}clk(L){this.Og.removeHandler("sheetProtectionOptionsChangedEventKey",L)}getConditionalFormattingRules(L){L=void 0===L?null:L;let qa;qa=null;if(!this.n1a)return this.Ioa("OnInvalidCache"),{returnValue:!1,Fpc:qa};qa=this.sXh(this.Hpc,L);return{returnValue:!0,Fpc:qa}}Obf(){this.MIc=this.ZIc;this.Hpc=null;this.n1a=!0;this.T9c=0;this.Og.raiseEvent("ConditionalFormattingRulesChangedEventKey")}dispose(){this.N0g()}xSd(){return this.$.sa?
(new Wb.a(this.$.sa)).Hj(4):!1}Ioa(L,qa,Va){qa=void 0===qa?null:qa;Va=void 0===Va?!0:Va;var Fb,bc,Ic;const td=ma.a.Tg.Wh;if(this.$.ea.Ph)if(qa||this.$.sa.na&&this.$.sa.na.sheetName)if(Va&&!this.xSd())this.Og.raiseEvent("sheetProtectionOptionsChangedEventKey",new Jc(!0,!1));else if(Va={wTf:!1,vTf:new Date,KYe:!1,JYe:0,f3f:!1,JOg:!1,IOg:0,dzd:!1,gzd:!1,fzd:0,dld:!1,Xkf:!1,YRd:!1},!I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CondFormatHandleDeletedRenamedSheet",!1)||qa||this.Xdj(Va)){++this.ZIc;
var Hd=this.ZIc;this.mrc=this.$.ea.Cq?this.$.ea.Cq.ConditionalFormattingRulesStateId:0;var pe=qa||this.$.sa.na.sheetName,Ke;this.CF&&(Ke={triggerMethod:L,rkj:!!qa,Wdj:!(null===(Ic=null===(bc=null===(Fb=null===this||void 0===this?void 0:this.$)||void 0===Fb?void 0:Fb.sa)||void 0===bc?void 0:bc.na)||void 0===Ic||!Ic.sheetName),qMj:td,UDj:this.$.ea.VDj,uZd:this.$.ea.uZd,vZd:this.$.ea.vZd,wZd:this.$.ea.wZd,DZd:this.$.ea.DZd,CZd:this.$.ea.CZd,gZd:this.$.ea.gZd,bZd:this.$.ea.bZd,cZd:this.$.ea.cZd,eZd:this.$.ea.eZd,
dZd:this.$.ea.dZd,UZd:this.$.ea.UZd,hZd:this.$.ea.hZd,fZd:this.$.ea.fZd,caa:Va});mb(this.$.pa.ta,!0,this.HIi(pe),uf=>{this.RPj(uf,pe,Hd,Ke)},this.QPj,null,this.$.pa.ta.Jh())}else this.CF&&e.ULS.sendTraceTag(507831456,0,50,"ActiveSheetConditionalFormattingRules, isActiveSheetNameValid() is false");else e.ULS.sendTraceTag(592487841,0,10,"ActiveSheetConditionalFormattingRules.OnConditionaFormattingRulesChanged: Sheets Active Item is null. ActiveItem is null: {0}. ActiveItem.SheetName is null: {1}. Is during application shut down: {2}. Get rules trigger method: {3}.",
!this.$.na,this.$.na?!this.$.na.sheetName:!1,!Sys.Application||Sys.Application.get_isDisposing(),L),this.n1a=!1;else e.ULS.sendTraceTag(592843921,0,10,"ActiveSheetConditionalFormattingRules.OnConditionaFormattingRulesChanged: Session is not active."),this.n1a=!1}RPj(L,qa,Va,Fb){L&&L.Result&&!Ka.a(L)||(this.n1a=!1);ib(L,this.$,qa,Va,this.A3k,Fb)}I2k(L){for(const qa of this.Hpc)qa.ruleRangeSheetName=L}sXh(L,qa){if(!L)return null;const Va=[];qa=qa?ha.h(qa):null;for(const Fb of L)qa&&!ha.a(ha.cb(Fb.ruleRange,
this.$.listSeparator),qa)||Va.push(Fb);return Va}Jdk(){this.$.sa.QW(this.eMa);this.$.ea.uq(this.Oi);this.$.sa.uta(this.O_b);this.$.sa.u3(this.vH);this.$.ea.Xy(this.ol);this.$.ea.NN(this.Dt);this.CF&&e.ULS.sendTraceTag(507831455,0,50,"loading ActiveSheetConditionalFormattingRules.ts register event handlers. (TimeStamp {0})",ma.a.Tg.Wh.getTime())}N0g(){this.$.sa.t1(this.eMa);this.$.ea.pq(this.Oi);this.$.sa.Zza(this.O_b);this.$.sa.Eba(this.vH);this.$.ea.pA(this.ol);this.$.ea.wP(this.Dt);this.CF&&e.ULS.sendTraceTag(507831454,
0,50,"unloading ActiveSheetConditionalFormattingRules.ts event handlers . (TimeStamp {0})",ma.a.Tg.Wh.getTime())}Xdj(L){var qa,Va,Fb,bc,Ic,td,Hd,pe,Ke,uf;this.CF&&(L.wTf=!0,L.vTf=ma.a.Tg.Wh,L.KYe=!!this.$.sa.na.sheetName,L.JYe=null!==(Va=null===(qa=this.$.sa.na.sheetName)||void 0===qa?void 0:qa.length)&&void 0!==Va?Va:0,L.f3f=!!this.$.ea.Cq,L.JOg=!(null===(Fb=this.$.ea.Cq)||void 0===Fb||!Fb.SheetChanges),L.IOg=null!==(td=null===(Ic=null===(bc=this.$.ea.Cq)||void 0===bc?void 0:bc.SheetChanges)||void 0===
Ic?void 0:Ic.length)&&void 0!==td?td:0,L.dzd=!1,L.gzd=!1,L.fzd=0,L.dld=!1,L.Xkf=!1,L.YRd=!1);qa=this.$.sa.na.sheetName;if(!qa)return!1;Va=null!==(pe=null===(Hd=this.$.ea.Cq)||void 0===Hd?void 0:Hd.SheetChanges)&&void 0!==pe?pe:[];Hd=null;for(const zf of Va)if(!this.CF||1!==zf.Type&&2!==zf.Type||(L.dzd=!0,L.gzd=!!zf.Name,L.fzd=null!==(uf=null===(Ke=zf.Name)||void 0===Ke?void 0:Ke.length)&&void 0!==uf?uf:0,L.dld=zf.Name===qa,Hd=zf.Name),(1===zf.Type||2===zf.Type)&&zf.Name===qa)return!1;if(this.CF&&
Hd)for(let zf=0,bg=this.$.sa.count;zf<bg;zf++)Hd===this.$.sa.getItem(zf).name&&(L.Xkf=!0);this.CF&&(L.YRd=!0);return!0}VSd(){const {Pmb:L,oce:qa}=this.Pmb();return!(L&&this.$.na&&this.$.na.sheetName===qa)&&this.mrc!==this.$.ea.Cq.ConditionalFormattingRulesStateId}Pmb(){let L=!1,qa;const Va=this.$.ea.Cq;if(Va&&Va.SheetChanges&&this.$.sa){var Fb=Va.SheetChanges;const bc=this.$.sa.na;if(!bc)return{Pmb:!1,oce:void 0};for(const Ic of Fb)Fb=128===Ic.Options||131072===Ic.Options,6!==Ic.Type&&7!==Ic.Type||
!Fb||(this.RUj(Va,bc,Ic),qa=Ic.Name,L=!0)}return{Pmb:L,oce:qa}}RUj(L,qa,Va){Va=this.$.Kt.getItemByName(Va.Name).index;L=L.Sheets[Va];Va=1024===(L.Flags&1024);const Fb=!!L.AllowSheetProtectionFeatures&&!!(L.AllowSheetProtectionFeatures&4);Va=!(16===(L.Flags&16)&&!Va)||Fb;if(qa=L.Name===qa.sheetName)Va?(this.Obf(),this.Ioa(this.SUj,void 0,!1)):this.MIc=this.ZIc;this.Og.raiseEvent("sheetProtectionOptionsChangedEventKey",new Jc(qa,Va))}Ydj(L){const qa=L.tUa&4;return!!L&&L.Dn&&!qa}HIi(L){return ha.q(L,
"",0,0,0,0)}}Object(m.a)(Hc,"ActiveSheetConditionalFormattingRules",null,[]);var Kb=a(1406),pc=a(356);class $b{static sdg(L,qa){if(qa&&Ka.a(qa)){const Va=z.a.Kh(qa.Errors);e.ULS.sendTraceTag(578336280,0,50,`OnAddConditionalFormattingRuleSuccess: request ended with errors: ${Va}.`);$b.HQg(L,qa)}oa.b("ConditionalFormatting_OnAddConditionalFormattingRuleSuccess")}static LJj(L){e.ULS.sendTraceTag(578336279,0,50,`GetConditionalFormattingRulesHelper.OnAddConditionalFormattingRuleFailed: status = ${L.data.status}, HTTP status = ${L.data.httpStatus}.`)}static XNj(L,
qa,Va){if(Va&&Ka.a(Va)){const Fb=z.a.Kh(Va.Errors);e.ULS.sendTraceTag(573686987,0,50,`OnEditConditionalFormattingRuleSuccess: request ended with errors: ${Fb}.`);$b.HQg(L,Va);$b.MKk(L,Va);qa.Axe()}}static WNj(L){e.ULS.sendTraceTag(573686986,0,50,`GetConditionalFormattingRulesHelper.OnEditConditionalFormattingRuleFailed: status = ${L.data.status}, HTTP status = ${L.data.httpStatus}.`)}static HQg(L,qa){qa&&z.a.Qn(qa.Errors,$b.conditionalFormattingAddRuleInvalidFormula)&&(qa=z.a.Yi(1,1,2221,2222,0,104275673,
"ConditionalFormattingAddRuleInvalidFormula"),new pc.a(L,qa))}static MKk(L,qa){if(qa){let Va=null;z.a.Qn(qa.Errors,$b.conditionalFormattingCantApplyRangeOutsidePivotTable)?Va=z.a.Yi(1,1,2221,2223,0,666127521,"ConditionalFormattingCantApplyRangeOutsidePivotTable"):z.a.Qn(qa.Errors,$b.conditionalFormattingCantApplyRangeInsidePivotTable)&&(Va=z.a.Yi(1,1,2221,2224,0,1259721746,"ConditionalFormattingCantApplyRangeInsidePivotTable"));Va&&new pc.a(L,Va)}}static $sg(L){if(L.startsWith("="))return L;var qa=
M.a.Zg(v.E);return qa&&(qa=qa.toXLNumber(L),null!=qa)?qa.toString():`="${L}"`}static cjj(L,qa,Va){let Fb;var bc;if(bc=L.startsWith("="))L=ha.jb(L.substring(1,L.length),qa,Va),{Y6:Fb}=L,bc=L.returnValue;return bc?0<Fb.length&&!(1===Fb.length&&Fb[0].isSingle):!1}static Zij(L,qa,Va){for(const Fb of qa.sa.items){const bc=Va.extractReferences(L,Fb.sheetName,qa.workbookContext.WorkbookFileName,!0);if(bc&&bc.Items.some(Ic=>Ic.IsStructRef))return!0}return!1}static getFormulaErrorType(L,qa,Va){return L?$b.cjj(L,
qa.listSeparator,qa.sa)||$b.Zij(L,qa,Va)?3:0:1}static getRangeErrorType(L,qa,Va){if(!L)return 1;qa=ha.jb(L,qa,Va);({Y6:L}=qa);return qa.returnValue&&ha.bb(L)?0:2}static getRangeError(L,qa,Va,Fb){if(!L)return 1;qa=ha.jb(L,qa,Va);({Y6:L}=qa);return qa.returnValue&&ha.bb(L)?this.Qoj(Va,Fb)?6:0:2}static Qoj(L,qa){L=L.getItemByName(qa);if(!L)return!1;qa=L.tUa&4;return!(!L||!L.Dn||qa)}}$b.conditionalFormattingAddRuleInvalidFormula=[104275673];$b.conditionalFormattingCantApplyRangeOutsidePivotTable=[666127521];
$b.conditionalFormattingCantApplyRangeInsidePivotTable=[1259721746];Object(m.a)($b,"ConditionalFormattingRuleEditorHelper",null,[]);var Ib=a(12);class Zb{constructor(L,qa){this.rfb=null;this.QJ=L;this.$=qa}FS(L,qa,Va,Fb){Fb=void 0===Fb?null:Fb;db.a.Go().then(bc=>{bc.showTaskPane("ConditionalFormattingTaskPane",this.pt(L,qa,Va,void 0,Fb));this.QJ.aSj();return null})}gL(L,qa,Va,Fb,bc,Ic,td){Fb=void 0===Fb?null:Fb;bc=void 0===bc?null:bc;Ic=void 0===Ic?0:Ic;td=void 0===td?null:td;db.a.Go().then(Hd=>{const pe=
this.$.qh.vi("UserAction","ConditionalFormattingTPRenderStopwatch");Hd.updateTaskPane("ConditionalFormattingTaskPane",this.pt(L,qa,Va,Fb,bc,Ic,td));pe.stop();this.QJ.MXj();return null})}zU(){db.a.Go().then(L=>{L.hideTaskPane("ConditionalFormattingTaskPane",2);return null})}iX(){this.rfb()}gOa(){db.a.Go().then(L=>{L.setSelectedTaskPane("ConditionalFormattingTaskPane");return null})}pt(L,qa,Va,Fb,bc,Ic,td){Ic=void 0===Ic?0:Ic;td=void 0===td?null:td;L={firstPaneElementId:K.a.Gpc,ruleManagerId:K.a.zef,
loadingRuleListId:K.a.tXh,ruleListId:K.a.yef};qa={type:"ConditionalFormattingTaskPaneProps",taskPaneViewType:qa,ruleFilterOption:Va,rules:void 0===Fb?null:Fb,rule:void 0===bc?null:bc,firstPaneElementId:K.a.Gpc,callbacks:{onRuleFilteringOptionsChange:this.QJ.onRuleFilteringOptionsChange,onRuleHoverStateChange:this.QJ.onRuleHoverStateChange,setFocusOnToolbarFirstElement:this.QJ.setFocusOnToolbarFirstElement,onRuleDelete:this.QJ.onRuleDelete,onRuleDuplicate:this.QJ.onRuleDuplicate,changeTaskPaneView:this.QJ.NXj,
onDeleteRulesByFilter:this.QJ.onDeleteRulesByFilter,onRuleAdded:this.QJ.onRuleAdded,onRuleEdited:this.QJ.onRuleEdited,addNewRuleFromTaskPane:this.QJ.addNewRuleFromTaskPane,onEmptyPaneHelpLinkClick:this.QJ.onEmptyPaneHelpLinkClick,getFormulaErrorType:Hd=>$b.getFormulaErrorType(Hd,this.$,this.Ej),getRangeErrorType:Hd=>$b.getRangeErrorType(Hd,this.$.listSeparator,this.$.sa),getRangeError:(Hd,pe)=>$b.getRangeError(Hd,this.$.listSeparator,this.$.sa,pe)},rangePickerController:Qc.f(this.$).Um.YYa(),error:Ic,
uiElementsIds:L,notification:td,colorPickerButtonController:this.QJ.colorPickerButtonController,borderMenuController:this.QJ.borderMenuController};return Object(ka.a)(new Kb.a,{contentProps:qa,onOpen:()=>{this.QJ.sha()},onClose:()=>{this.QJ.qE()},onShow:()=>{this.QJ.uUj()},onHide:()=>{this.QJ.C6()},width:320,title:Ib.a.instance.ia(1299),preventCloseCallback:Hd=>{this.QJ.tUj();this.rfb=Hd}})}}Object(m.a)(Zb,"ConditionalFormattingReactTaskPane",null,[572]);class Eb{constructor(L,qa,Va,Fb,bc){this.iconSetFormat=
this.colorScaleFormat=this.dataBarFormat=this.conditionalFormatting=this.range=null;this.range=qa;this.conditionalFormatting=L;this.dataBarFormat=Va;this.colorScaleFormat=Fb;this.iconSetFormat=bc}getRange(){return this.range}}Object(m.a)(Eb,"MacroRecorderRangeConditionalFormattingCreatedPayload",null,[65]);class ob{constructor(L,qa){this.range=null;this.priority=0;this.range=L;this.priority=qa}getRange(){return this.range}xHf(){return this.priority}}Object(m.a)(ob,"MacroRecorderRangeConditionalFormattingRuleDeletedPayload",
null,[65]);var Na=a(77),nb=a(419),Hb=a(79),na=a(40),Gb=a(27),Xa=a(387),Jb=a(213),qb=a(93);const Db=()=>L=>L;class gb{constructor(L,qa){this.afb=this.$5c=this.NFe=null;this.M_a=this.iEc=!1;this.Rsd=[28];this.Lgb=this.Vtb=null;this.$2f=this.P9b=this.XV=0;this.ide=this.WGg=null;this.tUj=()=>{this.wea.gL(this.afb,0,this.i4)};this.lmg=()=>{this.r9b(!1)};this.P8d=Va=>{2===this.XV?this.xAa({sheetProtectionOptionsChangedEvent:{}}):1===this.XV&&Va&&(++this.P9b,this.Dwe(this.P9b,[],3))};this.NXj=Va=>{1===Va&&
1!==this.XV&&(this.XV=1,this.r9b());1!==Va&&1===this.XV&&this.M2b();0===Va&&this.wea.iX();this.XV=Va};this.O_b=(Va,Fb)=>{this.xAa({sheetRenameEvent:{oldSheetName:Fb.oldName,newSheetName:Fb.newName}})};this.vH=(Va,Fb)=>{this.xAa({sheetDeletedEvent:{sheetName:Fb.item.name}})};this.Am=()=>{1!==this.XV||this.LTd||Qc.f(this.$).inRangePicker||Qc.f(this.$).Pp||this.r9b()};this.onRuleFilteringOptionsChange=Va=>{this.i4!==Va&&(e.ULS.sendTraceTag(42824727,0,50,`ConditionalFormattingPaneManager.OnRuleFilteringOptionsChange: filtering option has changed to: ${Va}`),
this.i4=Va,this.r9b())};this.onRuleHoverStateChange=(Va,Fb,bc)=>{if(Va){let Ic;(()=>{let td=ha.jb(bc,this.$.listSeparator,this.$.sa);({Y6:Ic}=td);return td})().returnValue?Qc.f(this.$).rh.BP(Xa.a.d8a(Na.d(this.$.na),Ic),this.Rsd,!0):e.ULS.shipAssertTag(537948622,0,!1,"ConditionalFormattingPaneManager.OnRuleHoverStateChange: Failed to parse range when highlighting rule range")}else Qc.f(this.$).rh.zq(this.Rsd)};this.onRuleDelete=Va=>{this.deleteConditionalFormattingRules(61,this.selectedRanges,Va)};
this.onRuleDuplicate=Va=>{this.Fei(Va)};this.onRuleAdded=Va=>{const {appliedRange:Fb,Y6:bc}=this.nIf(Va.range,Va.ruleRangeSheetName,"onRuleAdded");if(Fb){var Ic={};Va.activeCell?(Ic.FirstRow=Va.activeCell.row,Ic.FirstColumn=Va.activeCell.column):(Ic.FirstRow=Fb.Ranges[0].FirstRow,Ic.FirstColumn=Fb.Ranges[0].FirstColumn);var td=this.n1b(Va,!0),Hd=()=>new Eb(td,Fb,null,null,null),pe=this.$.pa.ta.Jh(),Ke=this.VGg(Fb,bc);e.ULS.sendTraceTag(526930257,0,50,`ConditionalFormattingPaneManager.OnRuleAdded: Adding a new rule with: ${Ke}`);
nb.a(this.$.userOperationManager,(uf,zf,bg)=>pa(this.$.pa.ta,this.n1b(Va,!1),Fb,Ic,C.c(uf,kg=>{$b.sdg(this.$,kg)}),C.b(zf,$b.LJj),bg,pe),uf=>new B.a(105,0,uf,void 0,Hd),null)}};this.onRuleEdited=Va=>{let Fb,bc=null,Ic;if(Va.range)if((()=>{let uf=ha.jb(Va.range,this.$.listSeparator,this.$.sa);({Y6:Ic,sheetName:bc}=uf);return uf})().returnValue)if(ha.bb(Ic))e.ULS.shipAssertTag(574410754,0,!bc||Gb.a.equals(bc,Va.ruleRangeSheetName,!1),"ConditionalFormattingPaneManager.OnRuleEdited: Sheet name was modified in rule range, which is not allowed when editing range"),
Fb=ha.v(Va.ruleRangeSheetName,null,Ic);else{e.ULS.shipAssertTag(557601051,0,!1,"ConditionalFormattingPaneManager.OnRuleEdited: Range is invalid.");return}else{e.ULS.shipAssertTag(574410753,0,!1,"ConditionalFormattingPaneManager.OnRuleEdited: Failed to parse range when editing an existing rule");return}else Fb={},Fb.SheetName=Va.ruleRangeSheetName;if(this.$.sa.contains(Fb.SheetName)){var td={FirstRow:0,FirstColumn:0},Hd=this.$.pa.ta.Jh(),pe=null;this.$.Bga&&(pe=this.n1b(Va,!0));var Ke=()=>new Eb(pe,
this.ide,null,null,null);if(Va.range){const uf=this.VGg(Fb,Ic);e.ULS.sendTraceTag(526930256,0,50,`ConditionalFormattingPaneManager.OnRuleEdited: Editing a rule with: ${uf}`)}nb.a(this.$.userOperationManager,(uf,zf,bg)=>lb(this.$.pa.ta,Va.guid,this.n1b(Va,!1),Fb,td,C.c(uf,kg=>{$b.XNj(this.$,this,kg)}),C.b(zf,$b.WNj),bg,Hd),uf=>new B.a(105,0,uf,64,Ke),null)}else e.ULS.shipAssertTag(557682696,1,!1,"ConditionalFormattingPaneManager.OnRuleEdited: sheet wasn't found, might be renamed or deleted.")};this.onDeleteRulesByFilter=
()=>{let Va,Fb;switch(this.i4){case 0:Va=60;Fb=this.selectedRanges;break;case 1:Va=59;Fb=ha.q(this.$.sa.na.name,"",0,0,0,0);break;default:e.ULS.sendTraceTag(590448070,0,10,`ConditionalFormattingPaneManager.OnClearRules with an unknown Rule Filtering: ${this.i4}`);return}this.deleteConditionalFormattingRules(Va,Fb,null)};this.uNj=Va=>{Va&&Ka.a(Va)&&(Va=z.a.Kh(Va.Errors),e.ULS.sendTraceTag(595092188,0,15,`ConditionalFormattingPaneManager.OnRuleDelete: request ended with errors: ${Va}.`),this.Axe())};
this.TNj=Va=>{Va&&Ka.a(Va)&&(Va=z.a.Kh(Va.Errors),e.ULS.sendTraceTag(536966945,0,15,`ConditionalFormattingPaneManager.onDuplicateRuleSuccess: request ended with errors: ${Va}.`),this.Axe())};this.tNj=Va=>{e.ULS.sendTraceTag(595116629,0,50,`ConditionalFormattingPaneManager.OnDeleteRuleFailure: status = ${Va.data.status}, HTTP status = ${Va.data.httpStatus}.`)};this.SNj=Va=>{e.ULS.sendTraceTag(536966944,0,50,`ConditionalFormattingPaneManager.onDuplicateRuleFailure: status = ${Va.data.status}, HTTP status = ${Va.data.httpStatus}.`)};
this.setFocusOnToolbarFirstElement=()=>{db.a.Go().then(Va=>{Va.focusTabbedTaskPaneArea();return null})};this.addNewRuleFromTaskPane=()=>{e.ULS.sendTraceTag(573686988,0,50,"ConditionalFormattingPaneManager.AddNewRuleFromTaskPane");this.sRf(this.Lgb)};this.onEmptyPaneHelpLinkClick=()=>{const Va=new F.a(-859308420,l.a.eh,this.$.Rh,12,null);this.$.Ma.dh(Va,{[l.a.Wk]:"AssetID="+gb.Z8g,["InputMethod"]:l.a.eh,[l.a.Ai]:K.a.CI,["ShouldCanvasTakeFocus"]:!0})};this.Li=(Va,Fb)=>{!Fb.Hl&&this.iEc&&this.qE()};
this.$=L;this.Lgb=qa;this.wea=new Zb(this,this.$);this.TQd=this.$.qh.vi("UserAction","ConditionalFormattingTPInitialLoadStopwatch");this.n9=new Hc(L);this.i4=this.Bkf=0;this.$.Lp(this.Li)}get colorPickerButtonController(){return this.NFe}get borderMenuController(){return this.$5c}get selectedRanges(){return ha.s(Qc.f(this.$).ha.qa.selectedRanges,this.$)}get LTd(){return 1===this.i4}eif(L){L=void 0===L?null:L;const qa=qb.d(M.a.resolve(v.Be,{va:0})),Va=Hb.GetServiceTaskFactory.Bj(this.$.ka,296,468,
0),Fb=qb.d(M.a.resolve(v.E,{va:0}));na.TaskExtensions.Ua(na.TaskExtensions.Ln([qa,Va,Fb],this.$.xa),()=>{this.wea.Ej=Fb.result;this.F8i(qa.result,Va.result);this.sRf(L)},this.$.xa,3)}sha(){e.ULS.sendTraceTag(42824723,0,50,"ConditionalFormattingPaneManager.OnPaneOpen Begin of OnPaneOpen");this.M_a||(this.yz(),this.M_a=!0)}qE(){I.EwaSettings.isChangeGateEnabled("OfficeVSO:8561735_CFTaskpaneUnregisterEventsOnPaneClose")&&this.C6();this.hideTaskPane();this.XV=0;this.i4=this.Bkf}M2b(){Qc.f(this.$).rh.Vs(null,
this.Rsd)}yz(){this.n9.PAh(this.P8d);this.n9.Sxh(this.lmg);Qc.f(this.$).ha.VW(this.Am);this.$.sa.uta(this.O_b);this.$.sa.u3(this.vH)}r9b(L){if(1===this.XV)if(void 0!==L&&!L||this.n9.xSd()){++this.P9b;var qa=null;this.LTd||1!==this.n9.xBf?(()=>{let Va=this.n9.getConditionalFormattingRules(this.LTd?null:this.selectedRanges.Ranges);({Fpc:qa}=Va);return Va})().returnValue&&(this.p3g(),this.Dwe(this.P9b,qa,this.n9.xBf)):(this.p3g(),this.B3k())}else this.P8d(!0)}p3g(){const L={};L.SheetName=this.selectedRanges.SheetName;
L.NamedObjectName=this.selectedRanges.NamedObjectName;L.Ranges=Array(this.selectedRanges.Ranges.length);for(let qa=0;qa<this.selectedRanges.Ranges.length;qa++)L.Ranges[qa]=this.selectedRanges.Ranges[qa];this.ide=L}B3k(){if(this.$.ea.Ph){var L=this.selectedRanges;mb(this.$.pa.ta,!1,L,qa=>{ib(qa,this.$,L.SheetName,this.P9b,(Va,Fb,bc)=>{this.Dwe(Va,Fb,bc)})},Yb,null,this.$.pa.ta.Jh())}else e.ULS.sendTraceTag(592843217,0,10,"ConditionalFormattingPaneManager.UpdateConditionalFormattingRulesFromSelection: Session is not active.")}Dwe(L,
qa,Va){1===this.XV&&L>=this.$2f&&(this.wea.gL(this.afb,this.XV,this.i4,qa,void 0,Va),this.WGg=qa,this.$2f=L)}uUj(){e.ULS.sendTraceTag(507618453,0,50,"ConditionalFormattingPaneManager.onPaneExpand Begin of onPaneExpand");this.M_a||(this.yz(),this.M_a=!0);this.xAa({taskPaneExpandEvent:{}})}C6(){this.M_a&&(this.x8a(),this.M2b(),this.M_a=!1,this.Vtb=null)}OVj(){this.M_a&&(this.Vtb=this.$.qh.vi("UserAction","ConditionalFormattingRibbonCommandRenderStopwatch"))}PVj(){this.Vtb=null}x8a(){this.n9.clk(this.P8d);
this.n9.Aik(this.lmg);Qc.f(this.$)&&Qc.f(this.$).ha&&Qc.f(this.$).ha.UY(this.Am);this.$.sa.Zza(this.O_b);this.$.sa.Eba(this.vH)}xAa(L){2===this.XV&&this.wea.gL(this.afb,2,this.i4,void 0,void 0,void 0,L)}deleteConditionalFormattingRules(L,qa,Va){e.ULS.sendTraceTag(591925914,0,50,`ConditionalFormattingPaneManager.OnRuleDelete with type: ${L}, id: ${Va||"empty"}`);const Fb=this.$.pa.ta.Jh(),bc=this.PDi(L,Va);nb.a(this.$.userOperationManager,(Ic,td,Hd)=>Ia(this.$.pa.ta,L,qa,Va,C.c(Ic,this.uNj),C.b(td,
this.tNj),Hd,Fb),Ic=>new B.a(221,0,Ic,64,bc),null)}Fei(L){const qa=L.guid;qa||e.ULS.sendTraceTag(536966946,0,10,"ConditionalFormattingPaneManager.duplicateConditionalFormattingRule with missing id!");const {appliedRange:Va}=this.nIf(L.range,L.ruleRangeSheetName,"duplicateConditionalFormattingRule");if(Va){var Fb=this.$.pa.ta.Jh(),bc=this.n1b(L,!0),Ic=()=>new Eb(bc,Va,L.dataBarFormat,L.colorScaleFormat,L.iconSetFormat);nb.a(this.$.userOperationManager,(td,Hd,pe)=>{var Ke=this.$.pa.ta,uf=L.ruleRangeSheetName;
td=C.c(td,this.TNj);Hd=C.b(Hd,this.SNj);const zf=Ke.Za(9,null);zf.sheetName=uf;zf.id=qa;return J.h(Ke,"DuplicateConditionalFormattingRule",zf,td,Hd,pe,Fb,0)},td=>new B.a(105,0,td,64,Ic),null)}}PDi(L,qa){let Va=-1,Fb=null;this.$.Bga&&(qa?1===this.i4?{priority:Va,range:Fb}=this.PFi(qa):(Va=this.zCf(this.WGg,qa),Fb=this.ide):Fb=59===L?ha.s([],this.$):this.selectedRanges);return()=>new ob(Fb,Va)}nIf(L,qa,Va){let Fb=null,bc;if((()=>{let Ic=ha.jb(L,this.$.listSeparator,this.$.sa);({Y6:bc,sheetName:Fb}=
Ic);return Ic})().returnValue)if(ha.bb(bc)){qa=ha.v(Fb||qa,null,bc);if(this.$.sa.contains(qa.SheetName))return{appliedRange:qa,Y6:bc};e.ULS.shipAssertTag(557682697,1,!1,`ConditionalFormattingPaneManager.${Va}: sheet wasn't found, might be renamed or deleted.`)}else e.ULS.shipAssertTag(557601052,0,!1,`ConditionalFormattingPaneManager.${Va}: Range is invalid.`);else e.ULS.shipAssertTag(574410755,0,!1,`ConditionalFormattingPaneManager.${Va}: Failed to parse range when adding a new rule`)}zCf(L,qa){for(let Va=
0;Va<L.length;++Va)if(L[Va].ruleId===qa)return L=Va;return 0}PFi(L){({Fpc:Fb}=this.n9.getConditionalFormattingRules());var qa=null;for(var Va of Fb)Va.ruleId===L&&(qa=Va);qa=ha.cb(qa.ruleRange,this.$.listSeparator);var Fb=Array(qa.length);for(Va=0;Va<qa.length;++Va)Fb[Va]=ha.k(qa[Va]);({Fpc:Fb}=this.n9.getConditionalFormattingRules(Fb));Fb.sort(Wc);L=this.zCf(Fb,L);qa=ha.s(qa,this.$);return{priority:L,range:qa}}dispose(){this.$.Au(this.Li);this.$=null;this.hideTaskPane();this.wea=null;this.n9.dispose();
this.n9=null}Axe(){1===this.XV&&this.r9b()}wUi(L){return 1==L.Ranges.length?(L=L.Ranges[0],L.FirstRow===L.LastRow?L.FirstColumn===L.LastColumn?"Single Cell":"Row":L.FirstColumn===L.LastColumn?"Column":"Rectangle"):"Multi"}vUi(L){let qa=null;for(const Va of L.Ranges){L=ha.E(Va);const Fb=Object(Jb.a)(this.$,L);L=null===Fb?"None":Fb.usedRange.contains(L)?"Containing":"Intersecting";qa=null===qa||qa===L?L:"Intersecting"}return null===qa?"None":qa}aJf(L){return 100*Math.ceil(L/100)}VGg(L,qa){const Va=
this.wUi(L);L=this.vUi(L);qa=this.aJf(ha.b(qa));const Fb=this.aJf(Qc.f(this.$).usedRange.bottom);return`rangeType ${Va} ; tableRelation: ${L} ; numOfCellsInRangeBucket: ${qa} ; usedRangeRowsBucket: ${Fb}`}n1b(L,qa){const Va=L.options;let Fb=null,bc=Va.quickFormat?Db()(Va.quickFormat):0;6===bc&&(L.customFormat?(Fb=this.Cti(L),bc=6):(e.ULS.sendTraceTag(540615491,0,15,"ConditionalFormattingPaneManager.PrepareConditionalFormattingOptions: invalid custom format."),bc=0));return Object(ka.a)(new wa,{Command:Db()(Va.command),
QuickFormatType:bc,CustomFormat:Fb,Formula1:Va.formula1&&qa?$b.$sg(Va.formula1):Va.formula1,Formula2:Va.formula2&&qa?$b.$sg(Va.formula2):Va.formula2,Value:Va.value||0,Unique:Va.unique||!1,TimePeriodType:Va.timePeriod?Db()(Va.timePeriod):0,StopIfTrue:L.stopIfTrue||!1,Priority:L.priority||-1})}Cti(L){const qa={};qa.BackgroundColor=L.customFormat.backgroundColor;qa.PreserveBackgroundColor=L.customFormat.preserveBackgroundColor||!1;L.customFormat.backgroundColorThemeInfo&&(qa.BackgroundColorTheme={},
qa.BackgroundColorTheme.ThemeColorIndex=L.customFormat.backgroundColorThemeInfo.index,qa.BackgroundColorTheme.ThemeColorRow=L.customFormat.backgroundColorThemeInfo.row);qa.TextColor=L.customFormat.textColor;qa.PreserveTextColor=L.customFormat.preserveTextColor||!1;L.customFormat.textColorThemeInfo&&(qa.TextColorTheme={},qa.TextColorTheme.ThemeColorIndex=L.customFormat.textColorThemeInfo.index,qa.TextColorTheme.ThemeColorRow=L.customFormat.textColorThemeInfo.row);qa.IsTextBold=L.customFormat.isTextBold;
qa.IsTextItalic=L.customFormat.isTextItalic;qa.IsTextStrikethrough=L.customFormat.isTextStrikethrough;qa.IsTextUnderlined=L.customFormat.isTextUnderlined;qa.IsTextDoubleUnderlined=L.customFormat.isTextDoubleUnderlined;this.Bti(L,qa);return qa}Bti(L,qa){qa.BorderFormat={};if(L.customFormat.borderFormat){if(qa.BorderFormat.Position=L.customFormat.borderFormat.position||15,qa.BorderFormat.LineStyle=Db()(L.customFormat.borderFormat.lineStyle.slice(0,4)),qa.BorderFormat.Color=[fb.a.tu(L.customFormat.borderFormat.color[0]).$V(),
fb.a.tu(L.customFormat.borderFormat.color[1]).$V(),fb.a.tu(L.customFormat.borderFormat.color[2]).$V(),fb.a.tu(L.customFormat.borderFormat.color[3]).$V()],qa.BorderFormat.Thickness=[0,0,0,0],qa.BorderFormat.ThemeBorderColor=[null,null,null,null],L.customFormat.borderFormat.themeColor)for(let Va=0;Va<L.customFormat.borderFormat.themeColor.length;Va++)L.customFormat.borderFormat.themeColor[Va]&&(qa.BorderFormat.ThemeBorderColor[Va]={},qa.BorderFormat.ThemeBorderColor[Va].ThemeColorIndex=L.customFormat.borderFormat.themeColor[Va].index,
qa.BorderFormat.ThemeBorderColor[Va].ThemeColorRow=L.customFormat.borderFormat.themeColor[Va].row)}else qa.BorderFormat.Position=15,qa.BorderFormat.LineStyle=[0,0,0,0],qa.BorderFormat.Color=[0,0,0,0],qa.BorderFormat.ThemeBorderColor=[null,null,null,null],qa.BorderFormat.Thickness=[0,0,0,0]}aSj(){this.TQd&&(this.TQd.stop(),this.TQd=null)}MXj(){this.Vtb&&(this.Vtb.stop(),this.Vtb=null)}sRf(L){const qa=L?2:1;L=this.NLi(L);this.iEc?(this.wea.gOa(),2===qa?this.wea.gL(this.afb,2,this.i4,void 0,L):1!==this.XV&&
this.wea.gL(this.afb,1,this.i4)):(this.iEc=!0,this.XV=qa,this.wea.FS(this.afb,this.XV,this.i4,L))}hideTaskPane(){this.iEc=!1;this.wea.zU()}NLi(L){if(!L)return null;const qa=ha.p(Qc.f(this.$).ha.qa.activeCell,this.$);return{guid:null,addRuleType:L,activeCell:{row:qa.FirstRow,column:qa.FirstColumn},range:ha.j(Qc.f(this.$).ha.qa.selectedRanges,this.$.listSeparator,this.$,!1,!1,!1),ruleRangeSheetName:qa.SheetName}}F8i(L,qa){this.NFe=L.e1h();L.fJf(!1,!1,!1,!1,!1);this.$5c=qa.CDi();this.l$k(this.$5c.getBorderLineStyleProps())}l$k(L){L.some(qa=>
"BorderStyleSolidLine"===qa.key)&&L.some(qa=>"BorderStyleDashedLine"===qa.key)&&L.some(qa=>"BorderStyleDottedLine"===qa.key)||e.ULS.sendTraceTag(540038171,0,10,"ConditionalFormattingPaneManager.VerifyCFBorderLineStyles: CF line styles are missing.")}}gb.Z8g="fed60dfa-1d3f-4e13-9ecb-f1951ff89d7f";Object(m.a)(gb,"ConditionalFormattingPaneManager",null,[]);var ya=a(26),Aa=a(25),sb=a(524),nc=a(95),Bb;let uc=Bb=class{constructor(L,qa){this.qda=null;this.Og=new w.a;this.Lgb=null;this.qNj=Va=>{e.ULS.sendTraceTag(537167193,
0,50,"ConditionalFormattingCommandHandler.OnDeleteConditionalFormattingSuccessCallback Clear CF rules from ribbon command");Va&&Ka.a(Va)&&(Va=z.a.Kh(Va.Errors),e.ULS.sendTraceTag(589947023,0,15,`ConditionalFormattingCommandHandler.OnDeleteConditionalFormattingSuccessCallback: Clear CF rules request ended with errors: ${Va}.`))};this.ofg=()=>{this.qda&&this.qda.OVj()};this.pfg=()=>{this.qda&&this.qda.PVj()};this.$=L;this.eKa=qa;Bb.Ihc=!0;this.uy=Aa.a.uy();this.nZg=I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AsyncTaskPaneUITiming",
!1);this.Lgb=this.rHi()}rHi(){if(R.AFrameworkApplication.fa.la("IsO365ConsumerHost"))return"HighlightCellsNoBlanks";let L=I.EwaSettings.getStringFeatureGate("Microsoft.Office.Excel.DefaultNewRuleTypeConditionalFormatting","HighlightCellsGT");L in this.Adf||(e.ULS.sendTraceTag(507605590,0,15,"ConditionalFormattingCommandHandler.GetDefaultNewRuleType: Invalid rule type"),L="HighlightCellsGT");return L}get Adf(){Bb.l7c||this.UKh();return Bb.l7c}get fPc(){this.qda||(this.qda=new gb(this.$,this.Lgb));
return this.qda}Bi(){return!1}executeCommand(L,qa,Va){L=na.TaskExtensions.sq();if(this.uy){var Fb=this.$.sa.na;if(Fb&&Fb.name===sb.a.current.lU&&nc.c(this.$.Bk)){Fb=this.$.ka.Ug(237);var bc=Qc.f(this.$);Fb.Oaa(qa.command,bc.ha.qa.activeCell)}}-300973317===qa.command&&I.EwaSettings.isChangeGateEnabled("OfficeVSO:8202953_HomeTabCleanUpTelemetry")&&"Home"===qa.tabName&&oa.b("HomeTabConditionalFormatting");if(-20558303===qa.command)return Bb.Ihc=!1,this.nZg&&Va.event&&this.eKa.ix(Va.event,"test_pane_open_conditional_formatting",
[{["itemKey"]:"command",["value"]:ab.a[qa.command]}],["task-pane"]),this.fPc.eif(),L;Fb=Va[l.a.Ai];if(2063445891===qa.command||454361567===qa.command)Fb=this.Lgb,454361567===qa.command&&I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ColorPickerHighlightWhenEnabled",!1)&&e.ULS.sendTraceTag(507609410,0,50,"ConditionalFormattingCommandHandler.executeCommand: HighlightWhen clicked"),e.ULS.sendTraceTag(542782275,0,50,"ConditionalFormattingPaneManager.QuickAccessNewRuleFromRibbon");bc=this.OFi(Fb);
switch(bc){case 12:case 13:case 8:case 9:case 10:case 11:case 1:case 2:case 4:case 5:case 3:case 7:case 6:case 65:Bb.Ihc=!1;2063445891!==qa.command&&454361567!==qa.command&&e.ULS.sendTraceTag(573686991,0,50,"ConditionalFormattingPaneManager.QuickAccessNewRuleFromTaskPane");this.nZg&&Va.event&&this.eKa.ix(Va.event,"test_pane_open_conditional_formatting",[{["itemKey"]:"command",["value"]:ab.a[qa.command]}],["task-pane"]);this.fPc.eif(Fb);break;case 59:case 62:this.k$h(bc);break;case 60:case 61:e.ULS.shipAssertTag(589947025,
0,!1,"ConditionalFormattingCommandHandler.ExecuteCommand: Not expecting to execute command of type ConditionalFormattingCommand.DeleteCells or ConditionalFormattingCommand.DeleteRule from the Ribbon");break;default:this.m1h(bc)}return L}dispose(){this.Og.dispose()}ni(L,qa){L=!1;switch(qa.command){case -20558303:case 2063445891:case 454361567:case -300973317:case 97385776:L=this.$.isEditMode}return L}Ji(){return!1}NCf(){return ha.s(Qc.f(this.$).ha.qa.selectedRanges,this.$)}nSg(){if(Bb.pMk){const L=
new F.a(-847286761,l.a.eh,this.$.Rh,0,K.a.b7);this.$.Ma.dh(L,{["InputMethod"]:l.a.eh,CalloutName:1})}}m1h(L){e.ULS.sendTraceTag(573686989,0,50,"ConditionalFormattingPaneManager.QuickAccessNewRuleNonCustom");this.ofg();const qa=this.$.pa.ta.Jh(),Va=ha.p(Qc.f(this.$).ha.qa.activeCell,this.$),Fb=this.NCf(),bc=Object(ka.a)(new wa,{Command:L,StopIfTrue:!1}),Ic=()=>new Eb(bc,Fb,null,null,null);nb.a(this.$.userOperationManager,(td,Hd,pe)=>pa(this.$.pa.ta,bc,Fb,Va,C.c(td,Ke=>{$b.sdg(this.$,Ke)}),C.b(Hd,()=>
{this.pfg()}),pe,qa),td=>new B.a(105,0,td,void 0,Ic),null);this.nSg()}k$h(L){this.ofg();const qa=this.$.pa.ta.Jh();let Va,Fb;59===L?(Fb=ha.s([],this.$),Va=ha.r(new ya.Range(1,1,Za.a.gl,Za.a.Qk,!1,!0),this.$)):Fb=Va=this.NCf();const bc=()=>new ob(Fb,-1);nb.a(this.$.userOperationManager,(Ic,td,Hd)=>Ia(this.$.pa.ta,L,Va,null,C.c(Ic,this.qNj),C.b(td,()=>{this.pfg()}),Hd,qa),Ic=>new B.a(221,0,Ic,void 0,bc),null);this.nSg()}OFi(L){return this.Adf[L]}UKh(){Bb.l7c={["HighlightCellsGT"]:1,["HighlightCellsLT"]:2,
["HighlightCellsBetween"]:3,["HighlightCellsEQ"]:4,["HighlightCellsContains"]:5,["HighlightCellsDate"]:6,["HighlightCellsDupe"]:7,["HighlightCellsNoBlanks"]:65,["TopBottomTop10"]:8,["TopBottomTop10P"]:9,["TopBottomBot10"]:10,["TopBottomBot10P"]:11,["TopBottomAA"]:12,["TopBottomBA"]:13,["DataBarsGradientFillBlue"]:15,["DataBarsGradientFillGreen"]:16,["DataBarsGradientFillRed"]:17,["DataBarsGradientFillOrange"]:18,["DataBarsGradientFillLightBlue"]:19,["DataBarsGradientFillPurple"]:20,["DataBarsSolidFillBlue"]:21,
["DataBarsSolidFillGreen"]:22,["DataBarsSolidFillRed"]:23,["DataBarsSolidFillOrange"]:24,["DataBarsSolidFillLightBlue"]:25,["DataBarsSolidFillPurple"]:26,["ColorScalesGYR"]:28,["ColorScalesRYG"]:27,["ColorScalesGWR"]:29,["ColorScalesRWG"]:30,["ColorScalesBWR"]:31,["ColorScalesRWB"]:32,["ColorScalesWR"]:35,["ColorScalesRW"]:36,["ColorScalesGW"]:38,["ColorScalesWG"]:37,["ColorScalesGY"]:33,["ColorScalesYG"]:34,["IconSetDirectional3Arrows"]:39,["IconSetDirectional3ArrowsGray"]:40,["IconSetDirectional3Triangles"]:57,
["IconSetDirectional4ArrowsGray"]:48,["IconSetDirectional4Arrows"]:47,["IconSetDirectional5ArrowsGray"]:53,["IconSetDirectional5Arrows"]:52,["IconSetShapes3TrafficLights1"]:42,["IconSetShapes3TrafficLights2"]:43,["IconSetShapes3Signs"]:44,["IconSetShapes4TrafficLights"]:51,["IconSetShapes4RedToBlack"]:49,["IconSetIndicators3Symbols"]:45,["IconSetIndicators3Symbols2"]:46,["IconSetIndicators3Flags"]:41,["IconSetRatings3Stars"]:56,["IconSetRatings4Rating"]:50,["IconSetRatings5Quarters"]:55,["IconSetRatings5Rating"]:54,
["IconSetRatings5Boxes"]:58,["ClearRulesClearCells"]:62,["ClearRulesClearSheet"]:59}}static get pMk(){return Bb.Ihc}};uc.l7c=null;uc.Ihc=!1;uc=Bb=Object(t.__decorate)([Object(M.d)(v.bb),Object(t.__param)(0,Object(v.Lb)()),Object(t.__param)(1,Object(v.yd)()),Object(t.__param)(2,Object(v.Ve)())],uc);Object(m.a)(uc,"ConditionalFormattingCommandHandler",null,[39,2]);var Pc=a(236),wd=a(957),Md=a(422);class Nd{constructor(L,qa,Va){this.QUh=(Fb,bc)=>{1===Fb?(Fb=bc.resultLanguageIndex,e.ULS.sendTraceTag(537155167,
0,50,`ChangeLocaleDialog.CloseReactChangeLocaleDialog pressing on OK. selected index:${Fb}`),this.numberFormatViewModel.tWc(Fb,"ChangeLocaleDialog")):e.ULS.sendTraceTag(537155166,0,50,"ChangeLocaleDialog.CloseReactChangeLocaleDialog pressing on Cancel");this.dispose()};this.tMa=()=>{this.numberFormatViewModel.fGc(2,"ChangeLocaleDialog.OnNumberFormatViewModelLoaded")&&(e.ULS.sendTraceTag(537155165,0,50,"ChangeLocaleDialog.OnNumberFormatViewModelLoaded success"),this.c_j())};this.sMa=()=>{e.ULS.sendTraceTag(537155164,
0,15,"ChangeLocaleDialog.OnNumberFormatViewModelLoaded failure")};this.numberFormatViewModel=qa;this.activeCell=L;this.numberFormatViewModel.Ucb(this.tMa);this.numberFormatViewModel.Rmd(this.sMa);this.selectedIndex=Va}initialize(){const L=Object(ka.a)(new wd.a,{Caller:2,NumberFormatCategory:-1});this.numberFormatViewModel.gNb(this.activeCell,L)}dispose(){this.numberFormatViewModel&&(this.numberFormatViewModel.ltb(this.tMa),this.numberFormatViewModel.rge(this.sMa))}c_j(){const L={[Md.a.fy]:"ChangeLocaleDialog",
["languageList"]:this.numberFormatViewModel.Wo.Locales,["selectedIndex"]:this.selectedIndex,["helpLink"]:this.numberFormatViewModel.bqg},qa=new Pc.a(!1,!1,!0);qa.Bh=1;qa.Lk="ChangeLocaleDialog";qa.initializeAndShow(Ib.a.instance.ia(2218),this.QUh,L)}}Object(m.a)(Nd,"ChangeLocaleDialog",null,[2]);var ec=a(1352);let gc=class{constructor(L,qa){this.$=L;this.numberFormatViewModel=qa}Bi(){return!1}ni(L,qa){L=!1;switch(qa.command){case 2105621672:case -168056295:case 151715844:L=!0}return L}executeCommand(L,
qa,Va){L=!1;switch(qa.command){case 151715844:L=this.GZj(Va);break;case 2105621672:case -168056295:if(Aa.a.mUb()&&2105621672!==Va.CommandValueId)return e.ULS.sendTraceTag(508385092,0,50,"NumberFormatTaskPane opened using Pivot table entry point"),this.$.ei(-395879625,l.a.eh,0,Va);L=this.openNumberFormatDialog(qa,Va)}return n.Task.Va(L)}Ji(){return!1}wxc(){let L=null;const qa=Qc.f(this.$).ha.qa.activeCell;qa&&(L=ha.p(qa,this.$));return L}openNumberFormatDialog(L,qa){var Va;let Fb=null;l.a.Ai in qa&&
qa[l.a.Ai]&&(Fb=parseInt(qa[l.a.Ai].toString(),10));const bc=this.wxc();if(!bc)return!1;this.numberFormatViewModel.Gie();qa=null!==(Va=null===qa||void 0===qa?void 0:qa.onClose)&&void 0!==Va?Va:Ic=>{Ic&&this.numberFormatViewModel.formatCells(this.numberFormatViewModel.UYa(),L)};(new ec.a(this.$,bc,this.numberFormatViewModel,L,Fb,qa)).initialize();return!0}GZj(L){const qa=this.wxc();if(!qa)return!1;this.numberFormatViewModel.Gie();(new Nd(qa,this.numberFormatViewModel,L.selectedIndex||0)).initialize();
return!0}};gc=Object(t.__decorate)([Object(M.d)(v.Yd),Object(t.__param)(0,Object(v.Lb)()),Object(t.__param)(1,Object(v.Zd)())],gc);Object(m.a)(gc,"NumberFormatCommandHandler",null,[39]);var Mb=a(320),sc=a(13),xd=a(1272),xb=a(47),Lb=a(282),Rc=a(8),nd=a(170),$d=a(287),Td=a(75),He=a(65);class oc extends Sys.EventArgs{constructor(L){super();this.viewModelData=L}}Object(m.a)(oc,"NumberFormatViewModelLoadedEventArgs",Sys.EventArgs,[]);var ld=a(61);class id extends w.a{constructor(L){super();this.SYj=qa=>
{z.a.rx(qa.Errors)?this.raiseEvent("NumberFormatViewModelFailed"):this.raiseEvent("NumberFormatViewModelLoaded",new oc(qa.Result))};this.RYj=()=>{this.raiseEvent("NumberFormatViewModelFailed")};this.$=L}Ucb(L){this.addHandler("NumberFormatViewModelLoaded",L)}ltb(L){this.removeHandler("NumberFormatViewModelLoaded",L)}Dzh(L){this.addHandler("NumberFormatViewModelFailed",L)}$jk(L){this.removeHandler("NumberFormatViewModelFailed",L)}Rvj(L,qa,Va){const Fb={};Fb.a=this.$.ua.UserSessionId;Va&&(Fb.b=He.a.li(Va));
qa&&(Fb.c=He.a.li(qa));ld.b().tl(6,Fb);this.$.userOperationManager.enqueueOperation(new B.a(160,0,(bc,Ic,td)=>{var Hd=this.$.pa.ta;bc=C.c(bc,this.SYj);Ic=C.b(Ic,this.RYj);const pe=Hd.Za(1);pe.activeCell=L;pe.numberFormatOptions=qa;pe.prevNumberFormatOptions=Va;return J.h(Hd,"GetNumberFormatViewModelData",pe,bc,Ic,td,null,0)},16),null)}}Object(m.a)(id,"NumberFormatClientViewModelDataLoader",w.a,[550]);Object(M.b)(v.Zd,{yk:"singleton"})(L=>No(function*(){const qa=yield M.a.resolve(v.Lb,L),Va=yield M.a.resolve(v.sc,
L);return new fc(qa,Va,new id(qa))}));class fc extends w.a{constructor(L,qa,Va){super();this.Uai=[Ib.a.instance.ia(485),Ib.a.instance.ia(486),Ib.a.instance.ia(487),Ib.a.instance.ia(488),Ib.a.instance.ia(489),Ib.a.instance.ia(490),Ib.a.instance.ia(491),Ib.a.instance.ia(492),Ib.a.instance.ia(493),Ib.a.instance.ia(494),Ib.a.instance.ia(495),Ib.a.instance.Ba(746)];this.Wo=null;this.xkg=(Fb,bc)=>{(this.Wo=bc?bc.viewModelData:null)?this.B$j():this.mwg()};this.wkg=()=>{this.mwg()};this.$=L;this.QQh=qa;this.wZb=
Va;this.wZb.Ucb(this.xkg);this.wZb.Dzh(this.wkg);this.$.ka.ph(193,this)}Ucb(L){this.addHandler("NumberFormatViewModelLoaded",L)}ltb(L){this.removeHandler("NumberFormatViewModelLoaded",L)}Rmd(L){this.addHandler("NumberFormatViewModelFailed",L)}rge(L){this.removeHandler("NumberFormatViewModelFailed",L)}get bqg(){return"https://go.microsoft.com/fwlink/p/?linkid=2134522"}dispose(){this.wZb.ltb(this.xkg);this.wZb.$jk(this.wkg);super.dispose()}formatCells(L,qa){const Va={};Va.NumberFormatOptions=L;Va.ValidMembers=
32;Va.NumberFormat=14;L=Object(ka.a)(new xd.a,{color:this.Wo.Color,sample:this.Wo.Sample,VLc:this.Wo.NumberFormatString});this.QQh.formatCells(2105621672,Va,qa,L)}get VLc(){return this.Wo.NumberFormatString}IBf(L){return this.Uai[L]}UYa(){return this.$ff(this.Wo.NumberFormatOptions)}$ff(L){return Object(ka.a)(new wd.a,{NumberFormatCategory:L.NumberFormatCategory,DecimalPlaces:L.DecimalPlaces,IsComma:L.IsComma,NegativeNumberType:L.NegativeNumberType,NegativeCurrencyType:L.NegativeCurrencyType,CurrencyType:L.CurrencyType,
DateType:L.DateType,TimeType:L.TimeType,FractionType:L.FractionType,SpecialType:L.SpecialType,CustomType:L.CustomType,LocaleType:L.LocaleType,IsInputCalendar:L.IsInputCalendar,CalendarType:L.CalendarType,IsGannen:L.IsGannen,IsOverrideDataLocale:L.IsOverrideDataLocale,Caller:L.Caller})}Gie(){this.Wo=null}gNb(L,qa){this.wZb.Rvj(L,qa,this.Wo?this.Wo.NumberFormatOptions:null)}fGc(L,qa){e.ULS.shipAssertTag(537155107,0,!!this.Wo,"NumberFormatViewModel.IsModelLoadedBy: numberFormatViewModelData is null");
const Va=this.UYa().Caller,Fb=Va===L;Fb||e.ULS.sendTraceTag(537155106,0,15,`NumberFormatViewModel.IsModelLoaddedBy: expected caller in '${qa}' should be ${L} but caller is ${Va}`);return Fb}tWc(L,qa){const Va=this.Wo.LocaleTags;if(Mb.a(Va))e.ULS.shipAssertTag(537155105,0,!1,"NumberFormatViewModel.SetOverrideDataLocaleCookie: localeTags array is null or empty");else if(Va.length!==this.Wo.Locales.length)e.ULS.shipAssertTag(537155104,0,!1,`NumberFormatViewModel.SetOverrideDataLocaleCookie: length mismatch: localeTags:${Va.length}. localeNames:${this.Wo.Locales.length}.`);
else if(0>L||L>=Va.length)e.ULS.shipAssertTag(537155103,0,!1,`NumberFormatViewModel.SetOverrideDataLocaleCookie: selectedLocaleIndex ${L} is out of range:[0:${Va.length}]`);else{var Fb=Va[L];if(Fb){var bc={};sc.HelperMethods.zLg(fc.a0j,Fb,this.$.ua.OverrrideDataLocaleCookieTTLDays,"OverrideDataLocale",bc);this.$.sendBeaconTraceTag(590878544,50,!0,"NumberFormatViewModel.SetOverrideDataLocaleCookie: setting cookie. caller:{0}. currentDomain:{1}. cookieDomain:{2}. hostNameJsApi:{3}. hostName:{4}. uiHost:{5}. prevDataLocale:{6}. prevCookieVal:{7}. selectedLocaleIndex:{8}. selectedCultureTag:{9}. cookieSetOK:{10}. newCookieVal:{11}.",
qa,bc.currentDomain,bc.parentDomain,this.$.ua.HostNameJsApi,this.$.ua.HostName,this.$.ua.UiHost,Va[0],bc.prevCookieVal,L,Fb,bc.cookieSetOK,bc.newCookieVal);xb.a(this.$).Dy(new Lb.a(Rc.a.bD,5,()=>{const Ic=Td.a(this.$).ij.activityState;Ic[nd.a.o9]=!0;Ic[$d.a.Aw]=Rc.a.fud;this.$.ms.gI("OverrideDataLocale_"+qa.substring(0,1))}))}else e.ULS.shipAssertTag(537155102,0,!1,"NumberFormatViewModel.SetOverrideDataLocaleCookie: selectedCultureTag is null or empty")}}B$j(){this.raiseEvent("NumberFormatViewModelLoaded")}mwg(){this.raiseEvent("NumberFormatViewModelFailed")}}
fc.a0j="rsOverride";Object(m.a)(fc,"NumberFormatViewModel",w.a,[537,2]);class vc{}vc.tellMe="TellMe";vc.contextMenu="ContextMenu";vc.unknown="Unknown";Object(m.a)(vc,"TellMeScenario",null,[]);class Tc{}Tc.appName="AppName";Tc.QQ="CloseAllMenus";Tc.commandId="CommandId";Tc.context="Context";Tc.culture="Culture";Tc.message="Message";Tc.errorMessage="ErrorMessage";Tc.event="Event";Tc.interactionId="CorrelationID";Tc.Y0j="ParentUiElement";Tc.query="Input";Tc.v4a="QueryID";Tc.uvg="QueryLength";Tc.vsb=
"QueryIndex";Tc.pqk="ResultsList";Tc.suggestions="Suggestions";Tc.scenario="Scenario";Tc.sessionId="SessionID";Tc.source="Source";Tc.timeStamp="Time";Tc.e0g="UiElement";Tc.lRc="ReactUx";Tc.value="Val";Tc.statusCode="StatusCode";Tc.Vba="Service";Tc.isSuccess="IsSuccess";Tc.AXk="TokenAcquired";Tc.Usj="LatencyType";Tc.groupName="GroupName";Tc.zZa="GroupIndex";Tc.groupType="GroupType";Tc.mqk="ResultInfoList";Tc.resultType="ResultType";Tc.vse="SubResultType";Tc.pkj="IsInputBlur";Tc.qkj="IsInputFocus";
Tc.Toj="IsShortCutUsed";Tc.actionType="ActionType";Tc.count="Count";Tc.Nei="DwellTime";Tc.e1f="IsZeroTerm";Tc.cbl="WordsCount";Tc.lHc="IsSearchUxEnabled";Tc.Rpj="IsTellMeInHeaderEnabled";Tc.module="Module";Tc.resultIndex="ResultIndex";Tc.Uzd="DisplayIndex";Tc.Rgi="EnableList";Tc.provider="Provider";Tc.contentType="ContentType";Tc.Boj="IsSelectionBased";Tc.yIh="BeginPerformanceMarker";Tc.ihi="EndPerformanceMarker";Tc.z2j="PerformanceMeasure";Object(m.a)(Tc,"Columns",null,[]);class Bd{}Bd.click="Click";
Bd.dKa="InteractionBegin";Bd.p_a="InteractionEnd";Bd.nff="ControlActivated";Bd.query="Query";Bd.tvg="QueryIndexRecorded";Bd.sdf="Clicks";Bd.pYe="ActionEvents";Bd.Ewf="FilteredActionEvents";Bd.nKg="SessionContext";Bd.latency="Latency";Bd.performance="Performance";Bd.hDg="RenderedResults";Bd.events="Events";Bd.B5h="CreateResultsMenu";Bd.wca="UpdateRibbonControls";Bd.oqk="ResultsAggregation";Bd.nC="IssueQuery";Bd.QVh="CommandSuggestions";Bd.error="Error";Bd.N_d="LoadModelData";Bd.CEj="ModelDataWaitTime";
Bd.timedOut="TimedOut";Bd.JBh="AddinQueryCommandReady";Bd.SBi="GetAddinEntitlements";Bd.gvg="ProviderMRUEvents";Bd.Jgi="EnableAddinSearchCommands";Object(m.a)(Bd,"EventNames",null,[]);class Fd{constructor(L,qa,Va,Fb,bc,Ic,td){Va=void 0===Va?null:Va;this.additionalInfo="";this.glc=-1;this.value=L;this.type=qa;this.subType=void 0===bc?4:bc;this.label=this.GK=Va;this.groupType=31;this.description=void 0===Fb?null:Fb;this.score=void 0===Ic?-99999:Ic;this.count=void 0===td?0:td}}Object(m.a)(Fd,"ResultBinding",
null,[]);class le{constructor(L,qa){this.coh=[];this.groupType=void 0===L?31:L;this.displayName=void 0===qa?"":qa}get results(){return this.coh}mt(L){L.groupType=this.groupType;Array.add(this.results,L)}Jfe(L){L=void 0===L?1:L;if(this.results.length>=L)for(let qa=0;qa<L;qa++)Array.removeAt(this.results,this.results.length-1)}}Object(m.a)(le,"SimpleResultGroup",null,[599]);class dc{constructor(L){this.attributes=null;this.query=L;this.lo=[]}Hs(L){this.lo.push(L)}aBg(L){const qa=[];for(const Va of this.lo)Va.groupType!==
L&&qa.push(Va);this.lo.length!==qa.length&&(this.lo=qa)}get Qmb(){return!1}}Object(m.a)(dc,"SimpleResultsUpdatedEventArgs",null,[598]);var Uc=a(374);class kb{constructor(){this.userId=this.email=this.displayName=null}}Object(m.a)(kb,"InsertMentionParameters",null,[]);class rb{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(m.a)(rb,"InsightsParameters",null,[]);var cc=a(224),mc=a(23);class Sa{constructor(L,qa,Va,Fb,bc){this.ehc=L;this.dhc=qa;this.uqh=Va;this.Iih=
Fb;this.xKe=bc}get F5a(){return 4}x_(L,qa){qa=void 0===qa?null:qa;qa=qa.sessionId+"|"+qa.interactionId+"|"+L.GK;if(this.xKe||this.Iih){let Va=this.xKe||ba.a.Nqa(Object(mc.a)("HelpTooltip"))===ba.a.Nqa(L.GK.trim());if(this.uqh&&2<L.GK.length){const Fb=L.GK;";"===Fb.charAt(0)&&";"===Fb.charAt(Fb.length-1)&&Fb.substring(1,Fb.length-1)===Sa.cPd&&(Va=!0)}L=Va?Object(mc.a)("HelpButtonTextNoPlaceholder"):String.format(Object(mc.a)("TextWithQuotation"),L.GK);return this.kAf(qa,ba.a.Yl(L),Va)}return this.kAf(qa,
ba.a.Yl(String.format(Object(mc.a)("TextWithQuotation"),L.GK)),!1)}kAf(L,qa,Va){return cc.a(Sa.cPd,Va?this.dhc:this.ehc,qa,"OfficeAssistant_16x16x32","A0",ba.a.Yl(L),qa,null,null)}}Sa.cPd="bSearchHelp";Object(m.a)(Sa,"AssistanceMenuItemFactory",null,[602]);var pb=a(168);class Ac{get F5a(){return 13}x_(){return Ac.gLh()}static gLh(){return cc.b(Ac.qxf,"798637440",ba.a.Yl(Object(mc.a)("LookupFirstRunExperienceTitle")),R.AFrameworkApplication.kE,pb.c("Info_32x32x32"),null,null,ba.a.Yl(Object(mc.a)("LookupFirstRunExperienceTitle")),
"Menu32",null,null,ba.a.Yl(Object(mc.a)("LookupFirstRunExperienceDescription")),null,null)}}Ac.qxf="bTellMeFirstRun";Object(m.a)(Ac,"FirstRunMenuItemFactory",null,[602]);class yd{constructor(L,qa){this.RPe=void 0===L?null:L;this.Xlh=(void 0===qa?null:qa)||Object(mc.a)("LookupNoResultsDescription")}get F5a(){return 14}x_(L){L=String.format(this.Xlh,L.GK);return this.JLh(L)}JLh(L){return cc.b(yd.Kbg,"798637440",ba.a.Yl(Object(mc.a)("LookupNoResultsTitle")),this.RPe?R.AFrameworkApplication.kE:null,this.RPe,
null,null,ba.a.Yl(Object(mc.a)("LookupNoResultsTitle")),"Menu32",null,null,ba.a.Yl(L),null,null)}}yd.Kbg="lookupNoResults";Object(m.a)(yd,"NoCommandsFoundMenuItemFactory",null,[602]);class vb{constructor(L,qa){this.FontWeight=0;this.Text=null;this.FontWeight=L;this.Text=qa}}Object(m.a)(vb,"LabelFormatted",null,[]);class Sc{constructor(){this.currentDocumentPath=R.AFrameworkApplication.fa.Xa("EditDocInClientUrl")}}Object(m.a)(Sc,"SmartLookupApplicationInterface",null,[]);class hd{}Object(m.a)(hd,"SmartLookupSelection",
null,[]);var qc=a(44),Lc=a(34);class bd{}bd.xSf="bInsights";Object(m.a)(bd,"InsightsMenuItemFactoryStatic",null,[]);class jd{static get ocj(){return"Insights_16x16x32"}static get Cui(){return"Find_16x16x32"}static get N0j(){return"-Parameterized"}static get Pqe(){return"Parameterized"}static get h0c(){return"bTryQuery"}static get Eve(){return"TellMeSuggestion_"}static get I_g(){return"bTryQueryAlternate"}static get Ate(){return"MenuTellMe"}static get k2j(){const L={},qa=[];Array.add(qa,{Term:{PeopleType:"Person"}});
L.And=qa;return L}static getParameter(L){let qa="",Va="";if(L)for(let Fb=0;Fb<L.fwf;++Fb)"Type"===L.getFieldName(Fb)?qa=L.MO(Fb):"Value"===L.getFieldName(Fb)&&(Va=L.MO(Fb));return new Uc.a(qa,Va)}static rxd(L){L=Object.assign(new rb,{neighborhood:L,mentionStart:0,mentionLength:L.length});return qc.c(L)}static Dif(L,qa,Va){L=Object.assign(new kb,{displayName:L,email:qa,userId:Va});return qc.c(L)}static Oua(L,qa,Va){return qc.c(jd.cJf(L,qa,void 0===Va?null:Va,null))}static cJf(L,qa,Va,Fb){Va=void 0===
Va?null:Va;Fb=void 0===Fb?null:Fb;L=Object.assign(new hd,{neighborhood:L,mentionStart:0,mentionLength:L?L.length:0});return Object.assign(new Sc,{selection:L,userIntent:Fb,entryPoint:qa,launchData:Va})}static nqk(L,qa){return jd.Oua(L,jd.DFg(qa))}static DFg(L){switch(L){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;case "GenerateDeckFromFile":return 38;default:return 0}}static wjj(){return!!R.AFrameworkApplication.fa&&
R.AFrameworkApplication.fa.la("IsGoLocalEnvironment")}static pnb(){const L=R.AFrameworkApplication.fa?R.AFrameworkApplication.fa.Xa("SovereignEnvironmentName"):null;return!!L&&0<L.length}static isEnterpriseUser(){const L=R.AFrameworkApplication.fa?R.AFrameworkApplication.fa.Xa("HostAuthType"):null;return!!L&&"aad"===L.toLowerCase()||"external"===L&&jd.qTd()}static Uoe(L){return L.TUk&&!jd.pnb()}static yoj(){const L=R.AFrameworkApplication.fa?R.AFrameworkApplication.fa.Xa("UiHostIntegrationType"):
"";return!!R.AFrameworkApplication.fa&&"UnifiedUiHostTeams"===L&&R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",!1)}static Toe(L){return L.tellMeInSharedHeaderIsEnabled&&L.fetchTokensForSearch&&(L.q8b||L.p8b||L.RKa)&&!jd.yoj()&&jd.isEnterpriseUser()&&!jd.pnb()}static Z5(){return R.AFrameworkApplication.fa?R.AFrameworkApplication.dBa||R.AFrameworkApplication.fa.la("SmartLookupEnableNativePane"):R.AFrameworkApplication.dBa}static lE(L){return!L||
jd.M_f(L.Ij)}static M_f(L){return!L||!L.trim().length}static d0c(L){if(!L)return 0;const qa=Math.pow(10,5);return Math.round(L*qa)/qa}static toUtc(L){return L?new Date(L.getUTCFullYear(),L.getUTCMonth(),L.getUTCDate(),L.getUTCHours(),L.getUTCMinutes(),L.getUTCSeconds(),L.getUTCMilliseconds()):null}static yMd(L){L=new Date(L);return(jd.toUtc(new Date).getTime()-L.getTime())/1E3}static c0f(L){switch(L){case Sa.cPd:case Ac.qxf:case bd.xSf:case yd.Kbg:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "ActionAIFromTellMe":case "LaunchAddinDialogFromTellMe":case "GenerateSlidesFromTellMe":case "QuickActionOnFile":case "SummarizeDeckFromTellMe":case "SummarizeSlidesFromTellMe":case "InsertFunctionParameterized":return!0}return L.startsWith(jd.h0c)||
L.startsWith(jd.Eve)||L.startsWith(jd.I_g)||L.startsWith("PeopleSuggestion")||L.startsWith("FileSuggestion")||L.startsWith("FindInDocumentSuggestion")||L.startsWith("NotesSuggestion")||L.startsWith("OnenoteNotesSuggestion")||L.startsWith("SmartLookupFromTellMe")||L.startsWith("GetHelpFromTellMe")||L.startsWith("GetHelpWithDescriptionFromTellMe")||L.startsWith("AddinSuggestion")||L.startsWith("OfficeScripts")?!0:!1}static wJd(L,qa){const Va=[];Array.add(Va,new vb(400,L));Array.add(Va,new vb(200,qa));
L={};L.parts=Va;return JSON.stringify(L)}static zIa(L){const qa=L.indexOf("<b0>"),Va=L.lastIndexOf("</b0>"),Fb=[];Array.add(Fb,new vb(400,L.substring(0,qa)));Array.add(Fb,new vb(600,L.substring(qa+4,Va)));Array.add(Fb,new vb(400,L.substring(Va+5,L.length)));L={};L.parts=Fb;return JSON.stringify(L)}static JJf(L){const qa=jd.yMd(L);60>qa?L=Object(mc.a)("TimeSince_SecsAgo"):3600>qa?(L=Math.floor(qa/60),L=String.format(Object(mc.a)("TimeSince_MinsAgo"),L.toString())):86400>qa?(L=Math.floor(qa/3600),L=
String.format(Object(mc.a)("TimeSince_HoursAgo"),L.toString())):172800>qa?L=Object(mc.a)("TimeSince_Yesterday"):(L=new Date(L),L=String.format(Object(mc.a)("TimeSince_Date"),L.localeFormat("MMMM dd, yyyy")));return L}static wFi(L){const qa=Array(L.length);for(let Va=0;Va<L.length;Va++)qa[Va]=L[Va].commandId;return qa}static qTd(){if("Dev Box"===R.AFrameworkApplication.fa.Xa("StatusBarEnvironmentNameToUse"))return!0;let L=R.AFrameworkApplication.fa.Xa("UserPrincipalName");L=la.c(L)?"":ba.a.Rr(L);const qa=
R.AFrameworkApplication.fa.rv("TellMeIntEnabledForFeatureCrew")?R.AFrameworkApplication.fa.aA("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(qa,L)&&"inner"===R.AFrameworkApplication.fa.Xa("Microsoft365Ring")}static ALi(L){switch(jd.Myc(L)){case "PowerPoint":return"SaveAsPowerPointPptx_20";case "Word":return"SaveAsWordDocx_20";case "Excel":return"SaveAsExcelXlsx_20";case "Pdf":return"PdfFile_20";case "OneNote":return"OneNote_20";case "Visio":return"visio_20"}return""}static TUi(L){L=
jd.Myc(L);switch(L){case "PowerPoint":return"pptx";case "Word":return"docx";case "Excel":return"xlsx";default:return L}}static Myc(L){switch(L.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"PowerPoint";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"Word";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"Excel";
case "pdf":return"Pdf";case "one":case "onepkg":return"OneNote";case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio"}return"Unknown"}static Lna(){return Lc.a.IU&&!Lc.a.Av}static mGi(L){if("word"===L.application.toLowerCase())return"ChatPane";if("powerpoint"===L.application.toLowerCase())return"ChatPPTPane";if("excel"===L.application.toLowerCase())return"Copilot"}static lFi(L){if("excel"===
L.application.toLowerCase())return"ShareMenu"}}jd.SYg=9E5;Object(m.a)(jd,"TellMeUtils",null,[]);class Yd{constructor(){this.data=this.landingTab=null}}Object(m.a)(Yd,"LaunchData",null,[]);var te=a(842),oe=a(641);class Kd{constructor(){this.ATa=null;this.ZP=[];this.Hdd=!0;this.tfc=null;this.iXe=!1;this.DZ=null;this.Ndd=[];this.f7c=[];this.e7c=[];this.Kjd=[];this.Lhc=this.lda=null;this.Odd=[];this.wad=this.Tid=this.Wg=null;this.LDb=-1;this.pbc=this.c$c=null}static get instance(){return Kd.Wa||(Kd.Wa=
new Kd)}ZHd(){return this.Ndd}dyc(){return this.f7c}dId(){return this.e7c}LMd(){return this.Kjd}oKd(){return this.lda}get d7b(){return this.Lhc}set d7b(L){this.Lhc=L}$Hd(){return this.Odd}v9b(L,qa,Va){qa=void 0===qa?"":qa;Va=void 0===Va?null:Va;L?this.pbc=new te.a(oe.a.lm()):qa&&Va&&this.pbc.add(qa,Va)}ikb(){return Kd.instance.Nm?Kd.instance.Nm.oV.interactionId:null}get kua(){return this.pbc}set kua(L){this.pbc=L}get OH(){return Kd.instance.Tid}set OH(L){Kd.instance.Tid=L}tMd(){return this.Tid}get actions(){return Kd.instance.ZP}set actions(L){Kd.instance.ZP=
L}eE(){return this.Wg}xk(){return this.wad}zrc(){return this.LDb}FJd(){return this.c$c}get pn(){return Kd.instance.Wg}set pn(L){Kd.instance.Wg=L}set h4c(L){Kd.instance.ATa=L}get zkb(){return Kd.instance.c$c}set zkb(L){Kd.instance.c$c=L}get Nm(){return Kd.instance.wad}set Nm(L){Kd.instance.wad=L}get j7(){return Kd.instance.LDb}set j7(L){Kd.instance.LDb=L}static get Unknown(){return Kd.unknown}get jLb(){return this.DZ?this.DZ.contentType:Kd.unknown}wca(L){const qa=window.performance.now();this.ATa&&
!la.c(L)&&(this.ATa(L),Kd.instance.Nm.bV(Bd.wca,window.performance.now()-qa))}get GYb(){return this.Hdd}set GYb(L){this.Hdd=L}get x$b(){return this.tfc}set x$b(L){this.tfc=L}get YBa(){return this.iXe}set YBa(L){this.iXe=L}get xpb(){return this.Ndd}set xpb(L){this.Ndd=L}get zfb(){return this.f7c}set zfb(L){this.f7c=L}get yfb(){return this.e7c}set yfb(L){this.e7c=L}get byb(){return this.Kjd}set byb(L){this.Kjd=L}get X0(){return this.lda}set X0(L){this.lda=L}get b7a(){return this.Lhc}set b7a(L){this.Lhc=
L}get ypb(){return this.Odd}set ypb(L){this.Odd=L}}Kd.Wa=null;Kd.unknown="Unknown";Object(m.a)(Kd,"TellMeActorConstants",null,[]);class Ee{constructor(L){this.Wg=L}hE(){return"ActionAI"}iK(){return 0===this.Wg.Ir?0:1===this.Wg.Ir?1:2}nC(L,qa,Va,Fb,bc){Va=void 0===Va?!1:Va;bc=void 0===bc?null:bc;Fb=new dc(L);if(!bc||Array.contains(bc,24))if(this.XIk()||!jd.lE(L)){bc=new le(24);var Ic=jd.lE(L);Va&&(Va=null,jd.Z5()&&(Va=jd.Oua(Ic?"":L.Ij,1,Object.assign(new Yd,{landingTab:"ActionAI"}))),this.Wg.R$?Va&&
Kd.instance.actions.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",Va)):(L=[],Va&&L.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",Va)),appChrome.api.dispatch(L)));bc.mt(new Fd("ActionAIFromTellMe",25,null,null,1));Fb.Hs(bc)}qa.gr(Fb)}XIk(){return jd.Z5()&&this.Wg.SDc}}Object(m.a)(Ee,"ActionAIResultsProvider",null,[552]);class rc{}rc.i9f=0;rc.EQc=10;Object(m.a)(rc,"AppsForOfficeStoreType",null,[]);var fd=a(123);class Ed{constructor(){this.iid=0}S8j(L,qa){this.iid=
window.performance.now();this.z$b(()=>{const Va=window.performance.now(),Fb={},bc=R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinUseLocalStoreTypeClass",!0);qa.R1e&&(Fb.callback=Ic=>{L(Ic,rc.i9f,Va)},bc&&(Fb.storeType=rc.i9f),R.AFrameworkApplication.jh.Xj(Y.a.usb,2,Fb));qa.S1e&&(Fb.callback=Ic=>{L(Ic,rc.EQc,Va)},bc?Fb.storeType=rc.EQc:R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",!0)?Fb.storeType=
10:Fb.storeType=rc.EQc,R.AFrameworkApplication.jh.Xj(Y.a.usb,2,Fb))},0,()=>{if(Kd.instance.xk())Kd.instance.xk().onError("AddinEntitlementsQuery:QueryEntitlementAsync","Query entitlements timeout after "+(window.performance.now()-this.iid)+" ms")})}z$b(L,qa,Va){qa=void 0===qa?0:qa;Va=void 0===Va?null:Va;2!==R.AFrameworkApplication.jh.Gk(Y.a.usb,1)?(Kd.instance.xk()&&Kd.instance.xk().bV(Bd.JBh,window.performance.now()-this.iid),L()):qa<Ed.bDj?R.AFrameworkApplication.pp.Ol(new fd.a(2,1,Ed.xal,()=>{this.z$b(L,
qa+1,Va)})):Va&&Va()}static get instance(){Ed.Wa||(Ed.Wa=new Ed);return Ed.Wa}}Ed.Wa=null;Ed.bDj=20;Ed.xal=500;Object(m.a)(Ed,"AddinEntitlementsQuery",null,[]);class Rd{constructor(){this.description=this.id=this.displayName=null;this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.TYd=this.storeType=this.storeId=this.z8j=this.iconUrl=null}}Object(m.a)(Rd,"AddinInfo",null,[]);var Fe=a(133);class Ae{constructor(L){this.bgd=[];this.Wg=L;this.$Pj=(qa,Va,
Fb)=>{if(qa){const bc=qa.errorCode;if(Kd.instance.xk()){const Ic={};Ic.StoreType=Va;Ic.ErrorCode=bc;Ic.AddinCount=qa.value?qa.value.length:0;Kd.instance.xk().bV(Bd.SBi,window.performance.now()-Fb,Ic)}if(0===bc&&qa.value){Ae.kUa=Ae.kUa||{};qa=qa.value;for(const Ic of qa)qa=new Rd,qa.displayName=Ic[0],qa.id=Ic[1],qa.description=Ic[2],qa.targetType=Ic[3],qa.appVersion=4<Ic.length?Ic[4]:"",qa.assetId=5<Ic.length?Ic[5]:"",qa.assetStoreId=6<Ic.length?Ic[6]:"",qa.width=7<Ic.length?Ic[7]:0,qa.height=8<Ic.length?
Ic[8]:0,qa.iconUrl=9<Ic.length?Ic[9]:"",qa.z8j=10<Ic.length?Ic[10]:"",qa.storeId=11<Ic.length?Ic[11]:"",qa.storeType=12<Ic.length?Ic[12]:"",qa.TYd=this.BMi(qa),Ae.kUa[qa.id]=qa,0<qa.iconUrl.length&&(Va="AddinIcon_"+qa.id,R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)?this.yNa(Va,qa.iconUrl):appChrome.addInApi.registerAddinIcon(Va,qa.iconUrl))}}};Ed.instance.S8j(this.$Pj,this.Wg)}hE(){return"Add-ins"}iK(){return 0===this.Wg.Ir?0:
1===this.Wg.Ir?1:2}nC(L,qa,Va,Fb,bc){bc=void 0===bc?null:bc;Va=new dc(L);bc&&!Array.contains(bc,27)||jd.lE(L)||(bc=new le(27),bc.displayName=Object(mc.a)("TellMeAddinProviderTitle"),this.VLi(L.Ij,bc),Va.Hs(bc));qa.gr(Va)}VLi(L,qa){if((L=this.Juk(L))&&0<L.length){let Va=0;L.forEach(Fb=>{if(!(3<++Va)){var bc="AddinSuggestion"+Va,Ic={};if(R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)){var td="AddinIcon_"+Fb.id;0>Array.indexOf(this.bgd,
td)&&0<Fb.iconUrl.length&&this.yNa(td,Fb.iconUrl);Ic["default"]=0<=Array.indexOf(this.bgd,td)?td:"AppForOfficeLogo_20"}else Ic["default"]=0<Fb.iconUrl.length?"AddinIcon_"+Fb.id:"AppForOfficeLogo_20";td=[];td.push(appChrome.actions.setControlLabel(bc,Fb.displayName));td.push(appChrome.actions.setControlIconSet(bc,Ic));td.push(appChrome.actions.setCompoundButtonCommandValueId(bc,Fb.id));td.push(appChrome.actions.updateCompoundButtonDescription(bc,Fb.description));R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchEnableCommands",
!0)&&(Ic=window.performance.now(),td.push(appChrome.actions.updateControlEnabledDisabledState(bc,!1)),Kd.instance.xk()&&Kd.instance.xk().bV(Bd.Jgi,window.performance.now()-Ic));appChrome.api.dispatch(td);bc=new Fd(bc,27,void 0,void 0,1);bc.additionalInfo=Telemetry.PrivacyRules.GetPrivacyCompliantId(Fb.id,Fb.storeType,Fb.assetId,null,null,Fb.storeId);qa.mt(bc)}})}}yNa(L,qa){Fe.c()&&appChrome.addInApi.registerAddinIcon&&(appChrome.addInApi.registerAddinIcon(L,qa),Array.add(this.bgd,L))}Juk(L){if(!Ae.kUa)return null;
const qa=[],Va=Ae.kUa;for(const bc in Va){var Fb=Va[bc];Fb&&Ae.jCj(L,Fb)&&Array.add(qa,Fb)}return qa}BMi(L){return Ae.mQk(L.displayName)}static jCj(L,qa){if(!qa.TYd)return!1;for(const Va of L.split(" ")){L=!1;for(const Fb of qa.TYd)if(Fb.toLowerCase().startsWith(Va.toLowerCase())){L=!0;break}if(!L)return!1}return!0}static mQk(L){const qa=[];for(const Va of L.split(" ")){L=0;for(let Fb=0;Fb<Va.length;Fb++){const bc=Va.charAt(Fb);bc.toString().toUpperCase()===bc.toString()&&Fb>L&&(Array.add(qa,Va.substring(L,
Fb)),L=Fb)}Array.add(qa,Va.substring(L,Va.length));L&&Array.add(qa,Va.substring(0,Va.length))}return qa}}Ae.kUa=null;Object(m.a)(Ae,"AddinResultsProvider",null,[552]);class We{constructor(L,qa){this.qdh=L;this.Ap=qa}gr(L){this.qdh.DCk(this.Ap,L)}}Object(m.a)(We,"AggregatorResultsProviderCallback",null,[624]);class ve{constructor(L){this.r8=null;this.Wg=L;this.Wg.AUa&&(this.r8=null)}hE(){return"AppsForOffice"}iK(){return 0===this.Wg.Ir?0:1===this.Wg.Ir?1:2}nC(L,qa,Va,Fb,bc){bc=void 0===bc?null:bc;
Va=new dc(L);if(!bc||Array.contains(bc,1))bc=new le(1),this.r8.Ogl(bc,L.Ij),Va.Hs(bc);qa.gr(Va)}}Object(m.a)(ve,"AppsForOfficeRecommendationResultsProvider",null,[552]);class Ze{constructor(L){this.Wg=L}hE(){return"Assistance"}iK(){return 0===this.Wg.Ir?0:1===this.Wg.Ir?1:this.Wg.j0b?3:2}nC(L,qa,Va,Fb,bc){Va=void 0===Va?!1:Va;bc=void 0===bc?null:bc;Fb=new dc(L);if((!bc||Array.contains(bc,8))&&!jd.lE(L)){bc=new le(8);if(Va){Va=ba.a.Nqa(Object(mc.a)("HelpTooltip"))===ba.a.Nqa(L.Ij.trim())?Object(mc.a)("HelpButtonTextNoPlaceholder"):
String.format(Object(mc.a)("TextWithQuotation"),L.Ij);const Ic=[];this.Wg.QKa&&(this.Wg.Hpe||Ic.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",{"default":"search_20"})),Va=this.vGf(L.Ij));const td="||"+L.Ij;Ic.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",Va));Ic.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",td));appChrome.api.dispatch(Ic);L=new Fd("GetHelpFromTellMe",4,L.Ij,null,1)}else L=new Fd("bSearchHelp",4,L.Ij,null,1);bc.mt(L);bc.displayName=
Object(mc.a)("HelpButtonTitle");Fb.Hs(bc)}qa.gr(Fb)}AJa(L,qa){qa=void 0===qa?null:qa;const Va=new le(8),Fb=ba.a.Nqa(Object(mc.a)("HelpTooltip"))===ba.a.Nqa(L.Ij.trim())?Object(mc.a)("HelpButtonTextNoPlaceholder"):String.format(Object(mc.a)("TextWithQuotation"),L.Ij);for(let Ic=0;Ic<qa.length&&2>Ic;Ic++){var bc=[];let td="GetHelpWithDescriptionFromTellMe"+(Ic+1).toString(),Hd=4;if(this.Wg.p6b)bc.push(appChrome.actions.setControlLabel(td,Fb)),bc.push(appChrome.actions.setCompoundButtonCommandValueId(td,
L.Ij)),bc.push(appChrome.actions.updateCompoundButtonDescription(td,this.aXi(qa.length)));else if(this.Wg.q6b){let pe=this.VJf(qa[Ic]);td="GetHelpFromTellMe"+(Ic+1).toString();this.Wg.QKa&&(pe=this.vGf(pe));Hd=9;bc.push(appChrome.actions.setControlLabel(td,pe));bc.push(appChrome.actions.setButtonCommandValueId(td,this.ZWi(qa[Ic])))}appChrome.api.dispatch(bc);bc=new Fd(td,Hd,null,null,0);bc.label=this.VJf(qa[Ic]);bc.description=this.YWi(qa[Ic]);Va.mt(bc);if(this.Wg.q6b)break}Va.displayName=Object(mc.a)("HelpButtonTitle");
return Va}aXi(L){return 1===L?String.format(Object(mc.a)("SearchResultText"),L):String.format(Object(mc.a)("SearchResultsText"),L)}vGf(L){return this.Wg.oXd?jd.wJd(L,Object(mc.a)("HelpScopedButtonText")):L+Object(mc.a)("HelpScopedButtonText")}VJf(L){return L.name?L.name:""}YWi(L){return L.description?L.description:""}ZWi(L){return L.id?"AssetID="+L.id:""}}Object(m.a)(Ze,"AssistanceResultsProvider",null,[552]);var Oe=a(892),Nf=a(912),Zf=a(353);class Rb{constructor(L,qa){this.Ia=L;this.oAj=qa}isMatch(L,
qa){if(!Object(Zf.a)(681,L))throw Error.argument("objToTest","Expected feature bundle");let Va;return(()=>{let Fb=L.Tp(this.Ia.C9);({value:Va}=Fb);return Fb})().returnValue?this.Ia.sye.isMatch(Va,qa):this.oAj}}Object(m.a)(Rb,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[695]);class Vb{constructor(L,qa){this.Ia=L;this.D1d=qa}isMatch(L){if(!Object(Zf.a)(681,L))throw Error.argument("objToTest","Expected feature bundle");return!!(this.D1d^(()=>L.Tp(this.Ia.C9))().returnValue)}}Object(m.a)(Vb,"AnnotatedWithAnnotationFilter",
null,[695]);class Cc{constructor(L){this.Ia=L}isMatch(L,qa){if(!Object(Zf.a)(684,L))throw Error.argument("objToTest","Expected struct value");return this.Ia.sye.isMatch(L.MIa(this.Ia.fieldIndex),qa)}}Object(m.a)(Cc,"FieldValueMatchesStructFilter",null,[695]);class rg{constructor(L,qa){L&&(this.fieldIndex=L.ma(0),this.sye=qa.h5(L.ma(1)))}}Object(m.a)(rg,"FieldValueMatchesStructFilterInit",null,[]);class yf{constructor(L){this.D1d=L}isMatch(L){if(!Object(Zf.a)(681,L))throw Error.argument("objToTest",
"Expected feature bundle");return!!(this.D1d^L.oOd)}}Object(m.a)(yf,"HasAnnotationsAnnotationFilter",null,[695]);class jg{constructor(L,qa){this.Ia=L;this.XU=qa}isMatch(L,qa){if(!Object(Zf.a)(683,L))throw Error.argument("objToTest","Expected list value");switch(this.XU){case 0:for(const Va of L.items)if(this.Ia.filter.isMatch(Va,qa))return!0;return!1;case 1:for(const Va of L.items)if(!this.Ia.filter.isMatch(Va,qa))return!1;return!0;default:throw Error.notImplemented();}}}Object(m.a)(jg,"ItemTestListFilter",
null,[695]);class If{constructor(L){this.Ia=L}isMatch(L,qa){if(!Object(Zf.a)(683,L))throw Error.argument("objToTest","Expected list value");return this.Ia.filter.isMatch(L.items.length,qa)}}Object(m.a)(If,"LengthMatchesListFilter",null,[695]);class cf{constructor(L,qa){this.Ia=L;this.XU=qa}isMatch(L,qa,Va){Va=void 0===Va?null:Va;let Fb=0===this.XU;for(const bc of this.Ia.tbf)if((Fb=bc.isMatch(L,qa,Va))?1===this.XU:0===this.XU)return Fb;2===this.XU&&(Fb=!Fb);return Fb}}Object(m.a)(cf,"NonterminalFilter",
null,[695]);class Nb{constructor(L,qa){if(L){var Va=L.ma(0);this.tbf=Array(Va);for(let Fb=0;Fb<Va;++Fb)this.tbf[Fb]=qa.h5(L.ma(1+Fb))}}}Object(m.a)(Nb,"NonterminalFilterInit",null,[]);class Bc{constructor(L,qa){this.Ia=L;this.XU=qa}isMatch(L,qa){if("number"!==typeof L)throw Error.argument("objToTest","Expected number value");let Va=this.Ia.number;if(this.Ia.query){qa=this.Ia.query.tr(null,qa);if("number"!==typeof qa)throw Error.invalidOperation("Query did not return number");Va+=qa}switch(this.XU){case 0:return L===
Va;case 1:return L<Va;case 2:return L<=Va;case 3:return L>Va;case 4:return L>=Va;default:throw Error.notImplemented();}}}Object(m.a)(Bc,"NumberFilter",null,[695]);class Ob{constructor(L,qa){L&&(this.number=L.ma(0),this.query=L.ma(1)?qa.dE(L.ma(1)):null)}}Object(m.a)(Ob,"NumberFilterInit",null,[]);class zc{constructor(L,qa,Va){this.Jyc=this.dJi;this.mKc=L;this.Q7f=qa;this.P7f=Va}Usd(L){this.Q7f=L}dJi(L){if(!L)throw Error.argument("name","Invalid named feature bundle reference");const qa=L.substr(1);
return 1===L.charCodeAt(0)&&qa===this.mKc?this.Q7f:this.P7f?this.P7f.Jyc(L):null}}Object(m.a)(zc,"SimpleNamedFeatureBundleResolver",null,[706]);class od{constructor(L){this.Ia=L}isMatch(L,qa){if(!Object(Zf.a)(681,L))throw Error.argument("objToTest","Expected feature bundle");L=this.Ia.query.tr(null,new zc(this.Ia.v2c,L,qa));if("boolean"!==typeof L)throw Error.invalidOperation("Query did not return bool");return L}}Object(m.a)(od,"PredicateAnnotationFilter",null,[695]);class ce{constructor(L,qa){L&&
(this.v2c=qa.ia(L.ma(0)),this.query=qa.dE(L.ma(1)))}}Object(m.a)(ce,"PredicateAnnotationFilterInit",null,[]);class Qb{constructor(L){this.Ia=L}isMatch(L,qa){if("boolean"!==typeof L)throw Error.argument("objToTest","Expected bool value");qa=this.Ia.query.tr(null,qa);if("boolean"!==typeof qa)throw Error.invalidOperation("Query did not return bool");return L===qa}}Object(m.a)(Qb,"QueryBooleanFilter",null,[695]);class Xc{constructor(L,qa){this.Ia=L;this.XU=qa}isMatch(L,qa){if("number"!==typeof L)throw Error.argument("objToTest",
"Expected integer");qa=this.Ia.query.tr(null,qa);if("number"!==typeof qa)throw Error.invalidOperation("Query did not return an enum value");switch(this.XU){case 0:return L===qa;case 1:return 0!==(L&qa);case 2:return L===(L&qa);case 3:return qa===(L&qa);default:throw Error.notImplemented();}}}Object(m.a)(Xc,"QueryEnumFilter",null,[695]);class md{constructor(L,qa){L&&(this.hGc=1===L.ma(0),this.query=qa.dE(L.ma(1)))}}Object(m.a)(md,"QueryEnumFilterInit",null,[]);class ie{constructor(L,qa){this.Ia=L;
this.XU=qa}isMatch(L,qa){if(!Object(Zf.a)(683,L))throw Error.argument("objToTest","Expected list value");qa=this.Ia.query.tr(null,qa);if(!Object(Zf.a)(683,qa))throw Error.invalidOperation("Query did not return list value");if(L.QR!==qa.QR)return!1;switch(this.XU){case 0:return Oe.Annotations.gQa(Oe.Annotations.eNi(L.QR),L,qa);case 1:for(const Va of L.items)for(const Fb of qa.items)if(Oe.Annotations.gQa(L.QR,Va,Fb))return!0;return!1;case 2:for(const Va of L.items)for(const Fb of qa.items)if(!Oe.Annotations.gQa(L.QR,
Va,Fb))return!1;return!0;case 3:for(const Va of qa.items)for(const Fb of L.items)if(!Oe.Annotations.gQa(L.QR,Va,Fb))return!1;return!0;default:throw Error.notImplemented();}}}Object(m.a)(ie,"QueryListFilter",null,[695]);class me{constructor(L,qa){this.Ia=L;this.XU=qa}isMatch(L,qa){if("string"!==typeof L)throw Error.argument("objToTest","Expected string");qa=this.Ia.query.tr(null,qa);if("string"!==typeof qa)throw Error.invalidOperation("Query did not return string");this.Ia.BSd&&(L=L.toUpperCase(),
qa=qa.toUpperCase());switch(this.XU){case 0:return L===qa;case 1:return 0<=L.indexOf(qa);case 2:return L.startsWith(qa);case 3:return L.endsWith(qa);case 4:return 0<=qa.indexOf(L);case 5:return qa.startsWith(L);case 6:return qa.endsWith(L);default:throw Error.notImplemented();}}}Object(m.a)(me,"QueryStringFilter",null,[695]);class Pe{constructor(L,qa){L&&(this.query=qa.dE(L.ma(0)),this.BSd=1===L.ma(1))}}Object(m.a)(Pe,"QueryStringFilterInit",null,[]);class gf{constructor(L){this.Ia=L}isMatch(L,qa){if(!Object(Zf.a)(684,
L))throw Error.argument("objToTest","Expected struct value");qa=this.Ia.query.tr(null,qa);if(!Object(Zf.a)(684,qa))throw Error.invalidOperation("Query did not return struct value");return L.isEqual(L)}}Object(m.a)(gf,"QueryStructFilter",null,[695]);class tf{constructor(L){this.Ia=L}isMatch(L,qa){L=this.Ia.query.tr(null,qa);if("boolean"!==typeof L)throw Error.invalidOperation("Query did not return bool");return L}}Object(m.a)(tf,"QueryWhereConstraintFilter",null,[695]);class Qe{constructor(L){this.Ia=
L}isMatch(L){if("string"!==typeof L)throw Error.argument("objToTest","Expected string");return this.Ia.vee.test(L)}}Object(m.a)(Qe,"RegexStringFilter",null,[695]);class Ca{constructor(L,qa){L&&(this.vee=qa.QHf(L.ma(0)))}}Object(m.a)(Ca,"RegexStringFilterInit",null,[]);class yb{constructor(L,qa){L&&(this.filter=qa.h5(L.ma(0)))}}Object(m.a)(yb,"SingleFilterFilterInit",null,[]);class wc{constructor(L,qa){L&&(this.query=qa.dE(L.ma(0)))}}Object(m.a)(wc,"SingleQueryFilterInit",null,[]);class dd{constructor(L){this.Ia=
L}isMatch(L){if("boolean"!==typeof L)throw Error.argument("objToTest","Expected bool value");return L===this.Ia.value}}Object(m.a)(dd,"StoredValueBooleanFilter",null,[695]);class vd{constructor(L){L&&(this.value=1===L.ma(0))}}Object(m.a)(vd,"StoredValueBooleanFilterInit",null,[]);class Zd{constructor(L,qa){this.Ia=L;this.XU=qa}isMatch(L){if("number"!==typeof L)throw Error.argument("objToTest","Expected integer");switch(this.XU){case 0:return this.Ia.hGc?this.Ia.value?!!(L&this.Ia.value):!L:L===this.Ia.value;
case 1:return this.Ia.hGc?(L&this.Ia.value)===this.Ia.value:32>L&&(1<<L&this.Ia.value)===this.Ia.value;case 2:return this.Ia.hGc?!!(L&this.Ia.value):32>L&&!!(1<<L&this.Ia.value);default:throw Error.notImplemented();}}}Object(m.a)(Zd,"StoredValueEnumFilter",null,[695]);class Re{constructor(L){L&&(this.hGc=1===L.ma(0),this.value=L.ma(1))}}Object(m.a)(Re,"StoredValueEnumFilterInit",null,[]);class ff{constructor(){this.U0j=null;this.Jrd=this.TZa=0}}Object(m.a)(ff,"WHEREConstraintData",null,[]);class af{constructor(L){this.Ia=
L}isMatch(L,qa){if(!Object(Zf.a)(ff,L))throw Error.argument("objToTest","Expected WHERE constraint data");let Va=-1,Fb=-1;const bc=L.U0j;switch(this.Ia.vsd){case 4:Va=bc.hOb;Fb=bc.qre;break;case 5:Va=L.TZa;Fb=bc.hOb-L.TZa;break;case 6:Va=bc.hOb+bc.qre;Fb=L.TZa+L.Jrd-Va;break;case 1:case 2:case 3:let Ic=!1;for(let td=bc.qhl;td;td=td.next)if(this.Ia.k8k===td.name){Ic=!0;1===this.Ia.vsd?(Va=td.hOb,Fb=td.qre):2===this.Ia.vsd?(Va=L.TZa,Fb=td.hOb-L.TZa):(Va=td.hOb+td.qre,Fb=L.TZa+L.Jrd-Va);break}if(!Ic)return!1;
break;case 7:Va=L.TZa;Fb=L.Jrd;break;default:throw Error.notImplemented();}return null!==this.Ia.nQk.Bil(bc.Orl,Va,Fb,Va,!0,2,qa)}}Object(m.a)(af,"SubSreWhereConstraintFilter",null,[695]);class xf{constructor(L,qa){if(L){var Va=qa.ia(L.ma(0));this.vsd=Va.charCodeAt(0);this.k8k=Va.substr(1);this.nQk=qa.oTi(L.ma(1))}}}Object(m.a)(xf,"SubSreWhereConstraintFilterInit",null,[]);class eg{constructor(L){this.Ia=L}isMatch(L,qa,Va){Va=void 0===Va?null:Va;if(!Object(Zf.a)(681,L))throw Error.argument("objToTest",
"Expected feature bundle");if(null==Va)throw Error.argumentNull("parentTextForSpan");if(this.Ia.r3e&&!this.Ia.r3e.isMatch(L,qa))return!1;if(this.Ia.Kte){let Fb;if((()=>{let bc=L.Tp(this.Ia.WPk);({value:Fb}=bc);return bc})().returnValue){if(!this.Ia.Kte.isMatch(Fb,qa))return!1}else{let bc,Ic;if(!(()=>{let td=L.Tp(this.Ia.STg);({value:bc}=td);return td})().returnValue||!(()=>{let td=L.Tp(this.Ia.RTg);({value:Ic}=td);return td})().returnValue||0>bc||0>Ic||bc+Ic>Va.length||!this.Ia.Kte.isMatch(Va.substr(bc,
Ic),qa))return!1}}if(this.Ia.mUg){let Fb;if(!(()=>{let bc=L.Tp(this.Ia.STg);({value:Fb}=bc);return bc})().returnValue||!this.Ia.mUg.isMatch(Fb,qa))return!1}if(this.Ia.B3f){let Fb;if(!(()=>{let bc=L.Tp(this.Ia.RTg);({value:Fb}=bc);return bc})().returnValue||!this.Ia.B3f.isMatch(Fb,qa))return!1}return!0}}Object(m.a)(eg,"TextSpanFilter",null,[695]);class Ab{constructor(L,qa){L&&(this.annotations=qa.annotations,this.STg=L.ma(0),this.RTg=L.ma(1),this.WPk=L.ma(2),this.Kte=L.ma(3)?qa.h5(L.ma(3)):null,this.r3e=
L.ma(4)?qa.h5(L.ma(4)):null,this.mUg=L.ma(5)?qa.h5(L.ma(5)):null,this.B3f=L.ma(6)?qa.h5(L.ma(6)):null)}}Object(m.a)(Ab,"TextSpanFilterInit",null,[]);class xc{constructor(L,qa){L&&(this.annotations=qa.annotations,this.C9=L.ma(0),this.sye=L.ma(1)?qa.h5(L.ma(1)):null)}}Object(m.a)(xc,"ValueFilterAnnotationFilterInit",null,[]);var eb=a(929);class Ub{h5(L,qa){const Va=L.ma(0),Fb=new eb.a;Fb.oIa(L,1,L.count-1);switch(Va){case 1:return new cf(new Nb(Fb,qa),0);case 2:return new cf(new Nb(Fb,qa),1);case 3:return new cf(new Nb(Fb,
qa),2);case 101:return new Qe(new Ca(Fb,qa));case 103:return new me(new Pe(Fb,qa),0);case 104:return new me(new Pe(Fb,qa),1);case 105:return new me(new Pe(Fb,qa),2);case 106:return new me(new Pe(Fb,qa),3);case 107:return new me(new Pe(Fb,qa),4);case 108:return new me(new Pe(Fb,qa),5);case 109:return new me(new Pe(Fb,qa),6);case 201:return new dd(new vd(Fb));case 202:return new Qb(new wc(Fb,qa));case 301:return new Bc(new Ob(Fb,qa),0);case 302:return new Bc(new Ob(Fb,qa),1);case 303:return new Bc(new Ob(Fb,
qa),2);case 304:return new Bc(new Ob(Fb,qa),3);case 305:return new Bc(new Ob(Fb,qa),4);case 401:return new Zd(new Re(Fb),0);case 402:return new Zd(new Re(Fb),1);case 403:return new Zd(new Re(Fb),2);case 404:return new Xc(new md(Fb,qa),0);case 405:return new Xc(new md(Fb,qa),1);case 406:return new Xc(new md(Fb,qa),2);case 407:return new Xc(new md(Fb,qa),3);case 501:return new Cc(new rg(Fb,qa));case 502:return new gf(new wc(Fb,qa));case 601:return new jg(new yb(Fb,qa),0);case 602:return new jg(new yb(Fb,
qa),1);case 603:return new If(new yb(Fb,qa));case 604:return new ie(new wc(Fb,qa),0);case 605:return new ie(new wc(Fb,qa),1);case 606:return new ie(new wc(Fb,qa),2);case 607:return new ie(new wc(Fb,qa),3);case 701:return new yf(!1);case 702:return new yf(!0);case 703:return new Vb(new xc(Fb,qa),!1);case 704:return new Vb(new xc(Fb,qa),!0);case 705:return new Rb(new xc(Fb,qa),!1);case 706:return new Rb(new xc(Fb,qa),!0);case 707:return new od(new ce(Fb,qa));case 901:return new eg(new Ab(Fb,qa));case 1002:return new tf(new wc(Fb,
qa));case 1001:return new af(new xf(Fb,qa));default:throw Error.argument("initData");}}}Object(m.a)(Ub,"FilterFactory",null,[678]);var Fc=a(898);class rd{constructor(L){this.Ia=L}get oz(){return this.Ia.oz}get qS(){return this.Ia.qS}get yZc(){return this.Ia.yZc}get uEc(){return this.Ia.uEc}load(L,qa){return this.tr(L,L?new zc("root",L,qa):qa)}store(L,qa,Va){this.rwb(L,qa,L?new zc("root",L,Va):Va,null)}tr(L,qa){if(!this.uEc&&!this.Ia.annotations.xmb(this.oz,L))throw Error.argument("input","Input value not of expected type");
let Va=this.Ia.vxf;for(;Va;)L=Va.load(L,qa),Va=Va.next;return L}rwb(L,qa,Va,Fb){if(!this.yZc)throw Error.invalidOperation("Attempt to store into query that supports only loading");if(!this.uEc&&!this.Ia.annotations.xmb(this.oz,L))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.Ia.annotations.xmb(this.qS,qa))throw Error.argument("rvalue","Rvalue not of expected type");return this.Ia.vxf.store(L,qa,Va,Fb)}static cdf(L,qa,Va,Fb){if(Va===Fb)return qa;if(Oe.Annotations.DC(Va)&&Oe.Annotations.DC(Fb)){Va=
Oe.Annotations.swa(Va);Fb=Oe.Annotations.swa(Fb);const bc=new Fc.a(L,Fb);for(const Ic of qa.items)Array.add(bc.items,rd.cdf(L,Ic,Va,Fb));return bc}if(Va===Oe.Annotations.Nia){if(Fb===Oe.Annotations.d8)return qa;if(Fb===Oe.Annotations.bW)return qa.toString()}else if(Va===Oe.Annotations.d8){if(Fb===Oe.Annotations.Nia)return Math.floor(qa);if(Fb===Oe.Annotations.bW)return qa.toString()}else if(Va===Oe.Annotations.bW){if(Fb===Oe.Annotations.Nia)return parseInt(qa);if(Fb===Oe.Annotations.d8)return parseFloat(qa)}throw Error.invalidOperation("Type conversion failure in query step");
}}Object(m.a)(rd,"AnnotationQuery",null,[694]);class Gd{constructor(){this.qS=this.oz=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}uwa(L){if(this.next)return{returnValue:this.next,Dia:L};if(L){const qa=L.jff;L=L.Mtg;return{returnValue:qa,Dia:L}}return{returnValue:null,Dia:L}}}Object(m.a)(Gd,"AnnotationQueryStep",null,[716]);class ue extends Gd{constructor(L){super();this.Ia=L}load(L,qa){qa=this.Ia.query.tr(L,qa);if(Oe.Annotations.DC(this.oz)){var Va=Oe.Annotations.swa(this.oz);
let bc=new Fc.a(this.Ia.annotations,Va);if(Oe.Annotations.DC(this.Ia.query.qS)){if(L.items.length!==qa.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(let Ic=0,td=L.items.length;Ic<td;++Ic)Array.add(bc.items,this.Inc(L.items[Ic],qa.items[Ic],Va===Oe.Annotations.d8))}else for(var Fb of L.items)Array.add(bc.items,this.Inc(Fb,qa,Va===Oe.Annotations.d8));return bc}if(Oe.Annotations.DC(this.Ia.query.qS)){Fb=new Fc.a(this.Ia.annotations,this.oz);for(Va of qa.items)Array.add(Fb.items,
this.Inc(L,Va,this.oz===Oe.Annotations.d8));return Fb}return this.Inc(L,qa,this.oz===Oe.Annotations.d8)}Inc(L,qa,Va){L=this.Heb(L,qa);return Va?L:Math.floor(L)}}Object(m.a)(ue,"NumericAnnotationQueryStep",Gd,[]);class Ce extends ue{constructor(L){super(L)}Heb(L,qa){return L+qa}}Object(m.a)(Ce,"AddAnnotationQueryStep",ue,[]);class Se extends Gd{constructor(L){super();this.Ia=L}load(L,qa){if(this.oz===Oe.Annotations.pca&&this.Ia.query.qS===Oe.Annotations.pca){let bc;if((()=>{let Ic=this.i$e(L);({result:bc}=
Ic);return Ic})().returnValue)return bc}if(Oe.Annotations.DC(this.oz)){var Va=new Fc.a(this.Ia.annotations,Oe.Annotations.pca);qa=this.Ia.query.tr(L,qa);if(Oe.Annotations.DC(this.Ia.query.qS)){if(L.items.length!==qa.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let bc=0,Ic=L.items.length;bc<Ic;++bc)Array.add(Va.items,this.XJb(qa.items[bc],L.items[bc]))}else for(var Fb of L.items)Array.add(Va.items,this.XJb(qa,Fb));return Va}Fb=this.Ia.query.tr(L,
qa);if(Oe.Annotations.DC(this.Ia.query.qS)){qa=new Fc.a(this.Ia.annotations,Oe.Annotations.pca);for(Va of Fb.items)Array.add(qa.items,this.XJb(Va,L));return qa}return this.XJb(Fb,L)}}Object(m.a)(Se,"BinaryBooleanAnnotationQueryStep",Gd,[]);class of extends Se{constructor(L){super(L)}i$e(L){return{returnValue:!L,result:!1}}XJb(L,qa){return L&&qa}}Object(m.a)(of,"AndAnnotationQueryStep",Se,[]);class jf{constructor(L){L&&(this.annotations=L)}}Object(m.a)(jf,"AnnotationsOnlyQueryStepInit",null,[]);class bf extends Gd{constructor(L){super();
this.Ia=L}load(L,qa){qa=this.Ia.query.tr(L,qa);L=L.clone();Oe.Annotations.DC(this.Ia.query.qS)?Array.addRange(L.items,qa.items):Array.add(L.items,qa);return L}}Object(m.a)(bf,"AppendAnnotationQueryStep",Gd,[]);class pf extends Gd{constructor(L){super();this.Ia=L}load(L,qa){if(this.oz===Oe.Annotations.eL)return this.executeScript(L,qa);const Va=new Fc.a(this.Ia.annotations,Oe.Annotations.eL);for(const Fb of L.items)Array.add(Va.items,this.executeScript(Fb,qa));return Va}executeScript(L,qa){const Va=
new Nf.a(this.Ia.annotations);Va.Jua(L);L=new Nf.a(this.Ia.annotations);this.Ia.script.kma(null,new zc("Input",Va,new zc("Output",L,qa)));return L}}Object(m.a)(pf,"ApplyAnnotationQueryStep",Gd,[]);class Ud extends Gd{constructor(L){super();this.Ia=L}load(L,qa){if(this.oz===Oe.Annotations.eL){let Fb=this.executeScript(L,qa);(()=>Fb.Tp(this.Ia.p3e))().returnValue||new Fc.a(this.Ia.annotations,Oe.Annotations.eL);return Fb}const Va=new Fc.a(this.Ia.annotations,Oe.Annotations.eL);for(const Fb of L.items){let bc=
this.executeScript(Fb,qa),Ic;if((()=>{let td=bc.Tp(this.Ia.p3e);({value:Ic}=td);return td})().returnValue)for(const td of Ic.items)Array.add(Va.items,td)}return Va}executeScript(L,qa){const Va=new Nf.a(this.Ia.annotations);Va.Jua(L);L=new Nf.a(this.Ia.annotations);this.Ia.script.kma(null,new zc("Input",Va,new zc("Output",L,qa)));return L}}Object(m.a)(Ud,"ApplyExpandAnnotationQueryStep",Gd,[]);class Ff{constructor(L,qa){L&&(this.annotations=qa.annotations,this.script=qa.rYa(L.ma(0)),this.p3e=L.ma(1))}}
Object(m.a)(Ff,"ApplyExpandQueryStepInit",null,[]);class Uf{constructor(L,qa){L&&(this.annotations=qa.annotations,this.script=qa.rYa(L.ma(0)))}}Object(m.a)(Uf,"ApplyQueryStepInit",null,[]);class Gf extends Gd{constructor(L){super();this.Ia=L}load(L){if(this.oz===Oe.Annotations.eL)return this.xJc(L);const qa=new Fc.a(this.Ia.annotations,this.Ia.annotations.getAttributeType(this.Ia.C9));for(const Va of L.items)Array.add(qa.items,this.xJc(Va));return qa}store(L,qa,Va,Fb){if(this.oz===Oe.Annotations.eL){var bc=
qa,Ic=(()=>{let Hd=this.uwa(Fb);({Dia:Fb}=Hd);return Hd})().returnValue;Ic&&(bc=Ic.store(Oe.Annotations.RJ(this.xJc(L)),qa,Va,Fb));L.Kv(this.Ia.C9,bc)}else{var td=qa;if(bc=(()=>{let Hd=this.uwa(Fb);({Dia:Fb}=Hd);return Hd})().returnValue){td=new Fc.a(this.Ia.annotations,this.Ia.annotations.getAttributeType(this.Ia.C9));for(Ic of L.items)Array.add(td.items,this.xJc(Ic));td=bc.store(td,qa,Va,Fb)}qa=td;if(qa.items.length!==L.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");
for(let Hd=0,pe=L.items.length;Hd<pe;++Hd)Va=L.items[Hd],Va.isReadOnly&&(Va=Va.clone(),L.items[Hd]=Va),Va.Kv(this.Ia.C9,qa.items[Hd])}return L}xJc(L){let qa;(()=>{let Va=L.Tp(this.Ia.C9);({value:qa}=Va);return Va})().returnValue||(qa=this.Ia.annotations.TCi(this.Ia.C9));return qa}}Object(m.a)(Gf,"AttrAnnotationQueryStep",Gd,[]);class lg{constructor(L,qa){L&&(this.annotations=qa,this.C9=L.ma(0))}}Object(m.a)(lg,"AttrQueryStepInit",null,[]);class Pa extends Gd{constructor(L){super();this.Ia=L}load(L){const qa=
new Nf.a(this.Ia.annotations);qa.Jua(L);return this.Ia.module.execute(qa)}}Object(m.a)(Pa,"CallModuleAnnotationQueryStep",Gd,[]);class lc{constructor(L,qa){L&&(this.annotations=qa.annotations,this.module=qa.zKd(L.ma(0)))}}Object(m.a)(lc,"CallModuleQueryStepInit",null,[]);class Gc extends Gd{constructor(L){super();this.Ia=L}load(L,qa){if(Oe.Annotations.DC(this.oz)){var Va=this.Ia.query.tr(L,qa);qa=new Fc.a(this.Ia.annotations,Oe.Annotations.bW);let Ic="string"===typeof Va;for(var Fb of L.items)if(Ic)Array.add(qa.items,
Fb+Va);else for(var bc of Va.items)Array.add(qa.items,Fb+bc);return qa}Fb=this.Ia.query.tr(L,qa);if("string"===typeof Fb)return L+Fb;bc=new Fc.a(this.Ia.annotations,Oe.Annotations.bW);for(Va of Fb.items)Array.add(bc.items,L+Va);return bc}}Object(m.a)(Gc,"ConcatAnnotationQueryStep",Gd,[]);class Cd extends Gd{constructor(L){super();this.Ia=L}load(L){return rd.cdf(this.Ia.annotations,L,this.oz,this.qS)}}Object(m.a)(Cd,"ConvertAnnotationQueryStep",Gd,[]);class Qd extends Gd{constructor(){super()}load(L){return L.items.length}}
Object(m.a)(Qd,"CountAnnotationQueryStep",Gd,[]);class ge extends ue{constructor(L){super(L)}Heb(L,qa){return L/qa}}Object(m.a)(ge,"DivideAnnotationQueryStep",ue,[]);class ye extends Gd{constructor(L){super();this.Ia=L}load(L,qa){qa=new zc(this.Ia.v2c,null,qa);for(const Va of L.items)if(qa.Usd(Va),this.Ia.query.tr(Va,qa))return!0;return!1}}Object(m.a)(ye,"ExistsAnnotationQueryStep",Gd,[]);class $e extends ue{constructor(L){super(L)}Heb(L,qa){return Math.pow(L,qa)}}Object(m.a)($e,"ExpAnnotationQueryStep",
ue,[]);class qf{constructor(L,qa){L&&(this.oma=qa.ia(L.ma(0)))}}Object(m.a)(qf,"FeatureBundleNameQueryStepInit",null,[]);class h extends Gd{constructor(L){super();this.Ia=L}load(L){if(Oe.Annotations.DC(this.oz)){const qa=new Fc.a(this.Ia.annotations,this.Ia.annotations.jZa(Oe.Annotations.swa(this.oz),this.Ia.fieldIndex));for(const Va of L.items)Array.add(qa.items,Va.MIa(this.Ia.fieldIndex));return qa}return L.MIa(this.Ia.fieldIndex)}store(L,qa,Va,Fb){if(Oe.Annotations.DC(this.oz)){var bc=qa,Ic=(()=>
{let Hd=this.uwa(Fb);({Dia:Fb}=Hd);return Hd})().returnValue;if(Ic){bc=new Fc.a(this.Ia.annotations,this.Ia.annotations.jZa(Oe.Annotations.swa(this.oz),this.Ia.fieldIndex));for(var td of L.items)Array.add(bc.items,td.MIa(this.Ia.fieldIndex));bc=Ic.store(bc,qa,Va,Fb)}qa=bc;if(qa.items.length!==L.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");for(let Hd=0,pe=L.items.length;Hd<pe;++Hd)Va=L.items[Hd],Va.isReadOnly&&(Va=Va.clone(),L.items[Hd]=Va),Va.nme(this.Ia.fieldIndex,
qa.items[Hd])}else Ic=qa,(td=(()=>{let Hd=this.uwa(Fb);({Dia:Fb}=Hd);return Hd})().returnValue)&&(Ic=td.store(Oe.Annotations.RJ(L.MIa(this.Ia.fieldIndex)),qa,Va,Fb)),L.nme(this.Ia.fieldIndex,Ic);return L}}Object(m.a)(h,"FieldAnnotationQueryStep",Gd,[]);class Z{constructor(L,qa){L&&(this.annotations=qa,this.fieldIndex=L.ma(0))}}Object(m.a)(Z,"FieldQueryStepInit",null,[]);class E extends Gd{constructor(L){super();this.Ia=L}load(L,qa){for(const Va of L.items)if(this.Ia.filter.isMatch(Va,qa))return Va;
throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(L,qa,Va,Fb){let bc=qa,Ic=-1;for(let Hd=0,pe=L.items.length;Hd<pe;Hd++)if(this.Ia.filter.isMatch(L.items[Hd],Va)){Ic=Hd;break}if(0>Ic)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const td=(()=>{let Hd=this.uwa(Fb);({Dia:Fb}=Hd);return Hd})().returnValue;td&&(bc=td.store(Oe.Annotations.RJ(L.items[Ic]),qa,Va,Fb));L.items[Ic]=bc;return L}}Object(m.a)(E,"FirstItemMatchingAnnotationQueryStep",
Gd,[]);class aa extends Gd{constructor(L){super();this.Ia=L}load(L,qa){qa=new zc(this.Ia.v2c,null,qa);for(const Va of L.items)if(qa.Usd(Va),!this.Ia.query.tr(Va,qa))return!1;return!0}}Object(m.a)(aa,"ForAllAnnotationQueryStep",Gd,[]);class Ja extends Gd{constructor(L){super();this.Ia=L}load(L,qa){L=qa?qa.Jyc(this.Ia.oma):null;if(!L)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ia.oma+'"');return L}store(L,qa,Va,Fb){L=Va?Va.Jyc(this.Ia.oma):null;if(!L)throw Error.invalidOperation('Feature bundle resolution failure: "'+
this.Ia.oma+'"');let bc=qa;const Ic=(()=>{let td=this.uwa(Fb);({Dia:Fb}=td);return td})().returnValue;Ic&&(bc=Ic.store(L,qa,Va,Fb));L!==bc&&L.Jua(bc);return L}}Object(m.a)(Ja,"GetAnnotationQueryStep",Gd,[]);class tb{constructor(L,qa){this.Pfh=L;this.inh=qa}get jff(){return this.Pfh}get Mtg(){return this.inh}}Object(m.a)(tb,"AnnotationQueryStoreContinuation",null,[719]);class S extends Gd{constructor(L){super();this.Ia=L}load(L,qa){return this.Ia.g_c.tr(L,qa)?this.Ia.a_g.tr(L,qa):this.Ia.Lvc?this.Ia.Lvc.tr(L,
qa):L}store(L,qa,Va,Fb){var bc=this.Ia.g_c.tr(L,Va);this.next&&(Fb=new tb(this.next,Fb));if(bc)return this.Ia.a_g.rwb(L,qa,Va,Fb);if(this.Ia.Lvc)return this.Ia.Lvc.rwb(L,qa,Va,Fb);bc=qa;let Ic=null;Fb&&(Ic=Fb.jff,Fb=Fb.Mtg);Ic&&(bc=Ic.store(Oe.Annotations.RJ(L),qa,Va,Fb));return bc}}Object(m.a)(S,"IfAnnotationQueryStep",Gd,[]);class Wa{constructor(L,qa){L&&(this.g_c=qa.dE(L.ma(0)),this.a_g=qa.dE(L.ma(1)),this.Lvc=L.ma(2)?qa.dE(L.ma(2)):null)}}Object(m.a)(Wa,"IfQueryStepInit",null,[]);class zb{constructor(L,
qa){L&&(this.h8i=qa.dE(L.ma(0)),this.j1f=qa.dE(L.ma(1)))}}Object(m.a)(zb,"IndexAndItemQueryStepInit",null,[]);class hc extends Gd{constructor(L){super();this.Ia=L}load(L,qa){const Va=this.Ia.h8i.tr(L,qa);qa=this.Ia.j1f.tr(L,qa);L=L.clone();if(0>Va||Va>L.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(Oe.Annotations.DC(this.Ia.j1f.qS))for(let Fb=0;Fb<qa.items.length;++Fb)Array.insert(L.items,Va+Fb,qa.items[Fb]);else Array.insert(L.items,Va,qa);return L}}
Object(m.a)(hc,"InsertAtAnnotationQueryStep",Gd,[]);class cd extends Gd{constructor(L){super();this.Ia=L}load(L,qa){return!(!qa||!qa.Jyc(this.Ia.oma))}}Object(m.a)(cd,"IsDefinedAnnotationQueryStep",Gd,[]);class ta extends Gd{constructor(L){super();this.Ia=L}load(L,qa){qa=this.WPb(L,qa);return L.items[qa]}store(L,qa,Va,Fb){const bc=this.WPb(L,Va);let Ic=qa;const td=(()=>{let Hd=this.uwa(Fb);({Dia:Fb}=Hd);return Hd})().returnValue;td&&(Ic=td.store(Oe.Annotations.RJ(L.items[bc]),qa,Va,Fb));L.items[bc]=
Ic;return L}WPb(L,qa){qa=this.Ia.query.tr(L,qa);if(0>qa||qa>=L.items.length)throw Error.invalidOperation("Index out of range in Item store step");return qa}}Object(m.a)(ta,"ItemAnnotationQueryStep",Gd,[]);class wb extends Gd{constructor(L){super();this.Ia=L}load(L,qa){const Va=new Fc.a(this.Ia.annotations,Oe.Annotations.swa(this.oz));for(const Fb of L.items)this.Ia.filter.isMatch(Fb,qa)&&Array.add(Va.items,Fb);return Va}}Object(m.a)(wb,"ItemsMatchingAnnotationQueryStep",Gd,[]);class ic extends Gd{constructor(L){super();
this.Ia=L}load(L,qa){qa=this.WPb(L,qa);return L.items[L.items.length-qa-1]}store(L,qa,Va,Fb){const bc=this.WPb(L,Va);let Ic=qa;const td=(()=>{let Hd=this.uwa(Fb);({Dia:Fb}=Hd);return Hd})().returnValue;td&&(Ic=td.store(Oe.Annotations.RJ(L.items[L.items.length-bc-1]),qa,Va,Fb));L.items[L.items.length-bc-1]=Ic;return L}WPb(L,qa){qa=this.Ia.query?this.Ia.query.tr(L,qa):0;if(0>qa||qa>=L.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");return qa}}Object(m.a)(ic,"LastItemAnnotationQueryStep",
Gd,[]);class Oa extends Gd{constructor(L){super();this.Ia=L}load(L){if(Oe.Annotations.DC(this.oz)){const qa=new Fc.a(this.Ia.annotations,Oe.Annotations.Nia);for(const Va of L.items)Array.add(qa.items,Va.length);return qa}return L.length}}Object(m.a)(Oa,"LengthAnnotationQueryStep",Gd,[]);class Cb extends Gd{constructor(L){super();this.Ia=L}load(L,qa){if(Oe.Annotations.DC(this.oz)){const Va=new Fc.a(this.Ia.annotations,Oe.Annotations.pca);for(const Fb of L.items)Array.add(Va.items,this.Ia.filter.isMatch(Fb,
qa));return Va}return this.Ia.filter.isMatch(L,qa)}}Object(m.a)(Cb,"MatchesAnnotationQueryStep",Gd,[]);class yc extends Gd{constructor(L){super();this.Ia=L}load(L,qa){return this.Ia.filter.isMatch(L,qa)}}Object(m.a)(yc,"MatchesAsListAnnotationQueryStep",Gd,[]);class Nc extends ue{constructor(L){super(L)}Heb(L,qa){return L%qa}}Object(m.a)(Nc,"ModuloAnnotationQueryStep",ue,[]);class Id extends ue{constructor(L){super(L)}Heb(L,qa){return L*qa}}Object(m.a)(Id,"MultiplyAnnotationQueryStep",ue,[]);class ke extends Gd{constructor(L){super();
this.Ia=L}load(L){if(Oe.Annotations.DC(this.oz)){const qa=new Fc.a(this.Ia.annotations,Oe.Annotations.pca);for(const Va of L.items)Array.add(qa.items,!Va);return qa}return!L}}Object(m.a)(ke,"NotAnnotationQueryStep",Gd,[]);class Ie extends Se{constructor(L){super(L)}i$e(L){return{returnValue:L,result:!0}}XJb(L,qa){return L||qa}}Object(m.a)(Ie,"OrAnnotationQueryStep",Se,[]);class Le extends Gd{constructor(L){super();this.Ia=L}load(L,qa){const Va=this.Ia.Pre.tr(L,qa);L=this.Ia.vKb.tr(L,qa);qa=new Fc.a(this.Ia.annotations,
Oe.Annotations.Nia);for(let Fb=0;Fb<L;++Fb)Array.add(qa.items,Va+Fb);return qa}}Object(m.a)(Le,"RangeAnnotationQueryStep",Gd,[]);class wf{constructor(L,qa){L&&(this.annotations=qa.annotations,this.filter=qa.h5(L.ma(0)))}}Object(m.a)(wf,"SingleFilterQueryStepInit",null,[]);class Kf{constructor(L,qa){L&&(this.annotations=qa.annotations,this.query=L.ma(0)?qa.dE(L.ma(0)):null)}}Object(m.a)(Kf,"SingleOptionalQueryQueryStepInit",null,[]);class cg{constructor(L,qa){L&&(this.annotations=qa.annotations,this.query=
qa.dE(L.ma(0)))}}Object(m.a)(cg,"SingleQueryQueryStepInit",null,[]);class Bg{constructor(L,qa){L&&(this.annotations=qa.annotations,this.Pre=qa.dE(L.ma(0)),this.vKb=L.ma(1)?qa.dE(L.ma(1)):null)}}Object(m.a)(Bg,"StartAndCountOrLengthQueryStepInit",null,[]);class dh extends Gd{constructor(L){super();this.Ia=L}load(L,qa){let Va;({startIndex:qa,length:Va}=this.mAc(L,qa));const Fb=new Fc.a(this.Ia.annotations,L.QR);for(let bc=0;bc<Va;++bc)Array.add(Fb.items,L.items[qa+bc]);return Fb}store(L,qa,Va,Fb){let bc,
Ic;({startIndex:bc,length:Ic}=this.mAc(L,Va));var td=qa;const Hd=(()=>{let pe=this.uwa(Fb);({Dia:Fb}=pe);return pe})().returnValue;if(Hd){td=new Fc.a(this.Ia.annotations,L.QR);for(let pe=0;pe<Ic;++pe)Array.add(td.items,L.items[bc+pe]);td=Hd.store(td,qa,Va,Fb)}qa=td;for(Va=0;Va<Ic;++Va)Array.removeAt(L.items,bc);for(let pe=0,Ke=qa.items.length;pe<Ke;++pe)Array.insert(L.items,bc+pe,qa.items[pe]);return L}mAc(L,qa){let Va;Va=this.Ia.Pre.tr(L,qa);if(0>Va)throw Error.invalidOperation("Invalid start index in Sublist() query step");
qa=this.Ia.vKb?this.Ia.vKb.tr(L,qa):L.items.length-Va;if(0>qa||Va+qa>L.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{startIndex:Va,length:qa}}}Object(m.a)(dh,"SublistAnnotationQueryStep",Gd,[]);class Sf extends Gd{constructor(L){super();this.Ia=L}load(L,qa){if(Oe.Annotations.DC(this.oz)){const Va=new Fc.a(this.Ia.annotations,Oe.Annotations.bW);for(let Fb=0,bc=L.items.length;Fb<bc;++Fb)Array.add(Va.items,this.tJf(L.items[Fb],qa));return Va}return this.tJf(L,
qa)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}tJf(L,qa){let Va;({startIndex:qa,length:Va}=this.mAc(L,qa));return L.substr(qa,Va)}mAc(L,qa){let Va;Va=this.Ia.Pre.tr(L,qa);if(0>Va)throw Error.invalidOperation("Invalid start index in Substring() query step");qa=this.Ia.vKb?this.Ia.vKb.tr(L,qa):L.length-Va;if(0>qa||Va+qa>L.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{startIndex:Va,length:qa}}}
Object(m.a)(Sf,"SubstringAnnotationQueryStep",Gd,[]);class eh extends ue{constructor(L){super(L)}Heb(L,qa){return L-qa}}Object(m.a)(eh,"SubtractAnnotationQueryStep",ue,[]);class Rg extends Gd{constructor(L){super();this.Ia=L}load(L){const qa=new Fc.a(this.Ia.annotations,Oe.Annotations.bW);for(let Va=0;Va<L.length;++Va)Array.add(qa.items,L.charAt(Va).toString());return qa}}Object(m.a)(Rg,"ToCharListAnnotationQueryStep",Gd,[]);class Dg extends Gd{constructor(L){super();this.Ia=L}load(L){const qa=new Fc.a(this.Ia.annotations,
this.oz);Array.add(qa.items,L);return qa}}Object(m.a)(Dg,"ToListAnnotationQueryStep",Gd,[]);class Kg extends Gd{constructor(L){super();this.Ia=L}load(){return this.Ia.value}}Object(m.a)(Kg,"ValueAnnotationQueryStep",Gd,[]);class Hg{constructor(L,qa){if(L){var Va=L.ma(0);L=qa.YWa(Va,L,1,null,null,null);this.value=L.returnValue;Oe.Annotations.T1a(this.value)}}}Object(m.a)(Hg,"ValueQueryStepInit",null,[]);class fh{constructor(L,qa){L&&(this.v2c=qa.ia(L.ma(0)),this.query=qa.dE(L.ma(1)))}}Object(m.a)(fh,
"VarNameAndQueryQueryStepInit",null,[]);class Vh{constructor(L,qa){this.NIe=null;if(L){this.annotations=qa.annotations;var Va=0;this.oz=L.ma(Va);++Va;this.qS=L.ma(Va);++Va;this.yZc=1===L.ma(Va);++Va;this.uEc=1===L.ma(Va);++Va;var Fb=L.ma(Va);++Va;if(Fb){var bc=Va,Ic=Va+Fb,td=Va+2*Fb;Va+=3*Fb;var Hd=L.count-Va,pe=null;for(let uf=0;uf<Fb;++uf){var Ke=Va+L.ma(td+uf);const zf=(uf===Fb-1?Hd:L.ma(td+uf+1))-L.ma(td+uf),bg=new eb.a;bg.oIa(L,Ke,zf);Ke=Vh.IOi(L.ma(Ic+uf),bg,qa);Ke.oz=L.ma(bc+uf);Ke.qS=uf===
Fb-1?this.qS:L.ma(bc+uf+1);pe?pe.next=Ke:this.NIe=Ke;pe=Ke}}}}get vxf(){return this.NIe}static IOi(L,qa,Va){switch(L){case 1:return new Ja(new qf(qa,Va));case 2:return new cd(new qf(qa,Va));case 3:return new Gf(new lg(qa,Va.annotations));case 4:return new h(new Z(qa,Va.annotations));case 5:return new S(new Wa(qa,Va));case 6:return new Cb(new wf(qa,Va));case 43:return new yc(new wf(qa,Va));case 45:return new pf(new Uf(qa,Va));case 49:return new Ud(new Ff(qa,Va));case 46:return new Kg(new Hg(qa,Va.annotations));
case 51:return new Pa(new lc(qa,Va));case 52:return new Le(new Bg(qa,Va));case 53:return new Cd(new jf(Va.annotations));case 13:return new ta(new cg(qa,Va));case 14:return new ic(new Kf(qa,Va));case 15:return new Qd;case 18:return new E(new wf(qa,Va));case 16:return new aa(new fh(qa,Va));case 17:return new ye(new fh(qa,Va));case 22:return new hc(new zb(qa,Va));case 24:return new bf(new cg(qa,Va));case 26:return new dh(new Bg(qa,Va));case 27:return new wb(new wf(qa,Va));case 30:return new Dg(new jf(Va.annotations));
case 31:return new Sf(new Bg(qa,Va));case 32:return new Gc(new cg(qa,Va));case 47:return new Oa(new jf(Va.annotations));case 48:return new Rg(new jf(Va.annotations));case 34:return new Ce(new cg(qa,Va));case 35:return new eh(new cg(qa,Va));case 36:return new Id(new cg(qa,Va));case 37:return new ge(new cg(qa,Va));case 38:return new Nc(new cg(qa,Va));case 39:return new $e(new cg(qa,Va));case 40:return new of(new cg(qa,Va));case 41:return new Ie(new cg(qa,Va));case 42:return new ke(new jf(Va.annotations));
default:throw Error.argument("currStepInitData");}}}Object(m.a)(Vh,"AnnotationQueryInit",null,[]);class Yf{constructor(L){this.Ia=L}execute(L,qa){this.kma(L,L?new zc("root",L,qa):qa)}kma(L,qa){for(const Va of this.Ia.commands)qa=Va.execute(L,qa)}}Object(m.a)(Yf,"AnnotationScript",null,[693]);class Eg{constructor(L){this.Ia=L}execute(L,qa){const Va=this.Ia.Mbj.tr(L,qa),Fb=this.Ia.S_j.tr(L,qa);this.Ia.script.kma(L,new zc("Input",Va,new zc("Output",Fb,qa)));return qa}}Object(m.a)(Eg,"ApplyAnnotationScriptCommand",
null,[707]);class hg{constructor(L,qa){L&&(this.Mbj=qa.dE(L.ma(0)),this.S_j=qa.dE(L.ma(1)),this.script=qa.rYa(L.ma(2)))}}Object(m.a)(hg,"ApplyScriptCommandInit",null,[]);class qg{constructor(L){this.Ia=L}execute(L,qa){const Va=this.Ia.Sje.tr(L,qa);this.Ia.$Jc.rwb(L,Va,qa,null);return qa}}Object(m.a)(qg,"AssignAnnotationScriptCommand",null,[707]);class jh{constructor(L){this.Ia=L}execute(L,qa){const Va=this.Ia.$Jc.tr(L,qa);L=this.Ia.Sje.tr(L,qa);Va!==L&&Va.Jua(L);return qa}}Object(m.a)(jh,"CopyAnnotationScriptCommand",
null,[707]);class dg{constructor(L){this.Ia=L}execute(L,qa){let Va=this.Ia.J_d.tr(L,qa);if(this.Ia.J_d.yZc){Va=Oe.Annotations.RJ(Va);var Fb=new zc(this.Ia.oma,null,qa);for(let bc=0,Ic=Va.items.length;bc<Ic;++bc){const td=this.Xuf(L,Va.items[bc],Fb);if(0>this.Ia.VTc)Va.items[bc]=td;else{let Hd;if((()=>{let pe=td.Tp(this.Ia.VTc);({value:Hd}=pe);return pe})().returnValue)Va.items[bc]=Hd;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");}}this.Ia.J_d.rwb(L,
Va,qa,null)}else{Fb=new zc(this.Ia.oma,null,qa);for(let bc=0,Ic=Va.items.length;bc<Ic;++bc)this.Xuf(L,Va.items[bc],Fb)}return qa}Xuf(L,qa,Va){let Fb;0>this.Ia.VTc?Fb=Oe.Annotations.RJ(qa):(Fb=new Nf.a(this.Ia.annotations),Fb.Kv(this.Ia.VTc,qa));Va.Usd(Fb);this.Ia.vJh.kma(L,Va);return Fb}}Object(m.a)(dg,"EnumerateAnnotationScriptCommand",null,[707]);class Wh{constructor(L,qa){L&&(this.annotations=qa.annotations,this.oma=qa.ia(L.ma(0)),this.J_d=qa.dE(L.ma(1)),this.vJh=qa.rYa(L.ma(2)),this.VTc=L.ma(3))}}
Object(m.a)(Wh,"EnumerateScriptCommandInit",null,[]);class Ch{constructor(L){this.Ia=L}execute(L,qa){this.Ia.g_c.tr(L,qa)?this.Ia.h_k.kma(L,qa):this.Ia.Uvf&&this.Ia.Uvf.kma(L,qa);return qa}}Object(m.a)(Ch,"IfAnnotationScriptCommand",null,[707]);class Fg{constructor(L,qa){L&&(this.g_c=qa.dE(L.ma(0)),this.h_k=qa.rYa(L.ma(1)),this.Uvf=L.ma(2)?qa.rYa(L.ma(2)):null)}}Object(m.a)(Fg,"IfScriptCommandInit",null,[]);class Qa{constructor(L,qa){L&&(this.annotations=qa.annotations,this.$Jc=qa.dE(L.ma(0)),this.Sje=
qa.dE(L.ma(1)))}}Object(m.a)(Qa,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class Ma{constructor(L){this.Ia=L}execute(L,qa){const Va=this.Ia.Sje.tr(this.Ia.$Jc.tr(L,qa),qa);this.Ia.$Jc.rwb(L,Va,qa,null);return qa}}Object(m.a)(Ma,"ModifyAnnotationScriptCommand",null,[707]);class $c{constructor(L){this.Ia=L}execute(L,qa){const Va=new Nf.a(this.Ia.annotations);this.Ia.query&&Va.Jua(this.Ia.query.tr(L,qa));return qa=new zc(this.Ia.oma,Va,qa)}}Object(m.a)($c,"NewAnnotationScriptCommand",null,[707]);
class de{constructor(L,qa){L&&(this.annotations=qa.annotations,this.oma=qa.ia(L.ma(0)),this.query=L.ma(1)?qa.dE(L.ma(1)):null)}}Object(m.a)(de,"NewScriptCommandInit",null,[]);class Be{constructor(L){this.Ia=L}execute(L,qa){L=this.Ia.query.tr(L,qa);if(this.Ia.query.qS===Oe.Annotations.eL)L.Zsb(this.Ia.C9);else for(const Va of L.items)Va.Zsb(this.Ia.C9);return qa}}Object(m.a)(Be,"RemoveAnnotationScriptCommand",null,[707]);class nf{constructor(L,qa){L&&(this.annotations=qa.annotations,this.query=qa.dE(L.ma(0)),
this.C9=L.ma(1))}}Object(m.a)(nf,"RemoveScriptCommandInit",null,[]);class Tf{constructor(L,qa){if(L){var Va=0,Fb=L.ma(Va);++Va;if(Fb){var bc=Va,Ic=Va+Fb;Va+=2*Fb;var td=L.count-Va;this.commands=Array(Fb);for(let Hd=0;Hd<Fb;++Hd){const pe=Va+L.ma(Ic+Hd),Ke=(Hd===Fb-1?td:L.ma(Ic+Hd+1))-L.ma(Ic+Hd),uf=new eb.a;uf.oIa(L,pe,Ke);this.commands[Hd]=Tf.GOi(L.ma(bc+Hd),uf,qa)}}}}static GOi(L,qa,Va){switch(L){case 1:return new qg(new Qa(qa,Va));case 2:return new Ma(new Qa(qa,Va));case 3:return new Be(new nf(qa,
Va));case 6:return new $c(new de(qa,Va));case 7:return new dg(new Wh(qa,Va));case 8:return new Ch(new Fg(qa,Va));case 9:return new jh(new Qa(qa,Va));case 10:return new Eg(new hg(qa,Va));default:throw Error.argument("initData");}}}Object(m.a)(Tf,"AnnotationScriptInit",null,[]);var Xf=a(1147);class zg{constructor(L){this.Iq=L;this.pL=0}lV(){const L=this.Iq.Gv(this.pL,4);this.pL+=4;return L}get array(){return this.Iq}get offset(){return this.pL}set offset(L){this.pL=L}}Object(m.a)(zg,"ByteArrayReader",
null,[]);class $f{constructor(){this.qD=null;this.Z7f=this.kY=0}ma(L){if(0>L||L>=this.kY)throw Error.argumentOutOfRange("index");return this.qD.Gv(this.Z7f+4*L,4)}get count(){return this.kY}static A2h(L,qa,Va){const Fb=new $f;Fb.qD=L;Fb.Z7f=qa;Fb.kY=Va;return Fb}}Object(m.a)($f,"ReadOnlyListOverByteArray",null,[689]);class Ng{constructor(L,qa){this.O7f=this.N7f=!1;this.$t=this.soa=this.q1d=this.R7f=null;try{this.$t=qa.annotations;const Va=qa.AIa(L.ma(0)),Fb=new zg(Va);if(-914743053!==Fb.lV())throw Error.argument("Input does not represent a flat lexicon");
this.N7f=1===Fb.lV();this.O7f=1===Fb.lV();const bc=Fb.lV();Fb.offset+=bc;const Ic=Fb.lV();this.q1d=Ng.c1j(Fb,Ic,this.$t);const td=Fb.lV();this.R7f=Ng.j1j(Fb,td);const Hd=Fb.lV();this.soa=new Xf.a(Fb.array,Fb.offset);Fb.offset+=Hd}catch(Va){throw Error.argument("initData");}}get trie(){return this.soa}wEi(L){return"i"===L&&this.O7f?"\u0130":L.toUpperCase()}BSd(){return this.N7f}tCi(L){let qa;qa=new Fc.a(this.$t,Oe.Annotations.eL);if(1!==L)if(0===L)L=new Nf.a(this.$t),Array.add(qa.items,L);else if(L&
1073741824){L=this.R7f[L&-1073741825];for(let Fb=0;Fb<L.length;++Fb){var Va=L[Fb];Va=0===Va?new Nf.a(this.$t):this.q1d[Va-2];Array.add(qa.items,Va)}}else Array.add(qa.items,this.q1d[L-2]);return{returnValue:!0,quj:qa}}static c1j(L,qa,Va){if(qa%4)throw Error.argument("reader");const Fb=$f.A2h(L.array,L.offset,qa/4);L.offset+=qa;L=[];for(qa=0;qa<Fb.count;){let bc=Va.YWa(Oe.Annotations.eL,Fb,qa,null,null,null);({t5:qa}=bc);Array.add(L,bc.returnValue)}return L}static j1j(L,qa){qa=L.offset+qa;const Va=
[];for(;L.offset<qa;){const Fb=L.lV(),bc=Array(Fb);for(let Ic=0;Ic<Fb;++Ic){const td=L.lV();bc[Ic]=td}Array.add(Va,bc)}return Va}}Object(m.a)(Ng,"RawFlatLexicon",null,[692]);var pg=a(1119),Ug=a(1120);class Og{constructor(L){if(null==L)throw Error.argumentNull("base64String");const qa=L.length;if(qa%4)throw Error.argument("base64String's length must be a multiple of 4");this.kY=.75*qa;this.c2a=Array(Math.ceil(this.kY/4));L.endsWith("==")?this.kY-=2:L.endsWith("=")&&--this.kY;let Va=0;for(let Fb=0;Fb<
qa;Fb+=4){const bc=Og.vUc[L.charCodeAt(Fb)-43]<<18|Og.vUc[L.charCodeAt(Fb+1)-43]<<12|Og.vUc[L.charCodeAt(Fb+2)-43]<<6|Og.vUc[L.charCodeAt(Fb+3)-43];let Ic=bc>>16&255;this.c2a[Math.floor(Va/4)]|=Ic<<Va%4*8;++Va;Ic=bc>>8&255;this.c2a[Math.floor(Va/4)]|=Ic<<Va%4*8;++Va;Ic=bc&255;this.c2a[Math.floor(Va/4)]|=Ic<<Va%4*8;++Va}}get length(){return this.kY}ma(L){if(0>L||L>=this.kY)throw Error.argumentOutOfRange("i");return this.wBf(L)}Gv(L,qa){if(0>L||0>qa||L+qa>this.kY)throw Error.argument("Bad range");let Va=
0;for(let Fb=0;Fb<qa;++Fb)Va|=this.wBf(L+Fb)<<8*Fb;return Va}Bbk(L,qa){let Va=0,Fb=0,bc=Math.floor(L/8);for(L%=8;Fb<qa;){const Ic=8-L>qa-Fb?qa-Fb:8-L,td=this.ma(bc);Va|=(td>>L&~(255<<Ic))<<Fb;Fb+=Ic;++bc;L=0}return Va}wBf(L){return this.c2a[Math.floor(L/4)]>>L%4*8&255}}Og.vUc=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(m.a)(Og,
"ByteArray",null,[]);class bh{constructor(L,qa,Va){this.uz=L;this.qAj=qa;this.zAj=Va;this.g8f=Array(L.b?L.b.length:0);this.Z1d=new pg.a(new Ug.a(this.AIa(this.uz.s)));this.WU=Array(L.t.length);this.Cdh=new Oe.Annotations(this.wIa(0),this)}get annotations(){return this.Cdh}get Vdi(){return this.uz.d}$Ni(){if(!(""in this.uz.m))throw Error.argument("name","Unrecognized module");return this.zKd(this.uz.m[""])}AIa(L){if(0>L||!this.uz.b||L>=this.uz.b.length)throw Error.argumentOutOfRange("byteArrayID");
return this.g8f[L]||(this.g8f[L]=new Og(this.uz.b[L]))}ia(L){if(1>L||L>=this.uz.t.length)throw Error.argumentOutOfRange("blobID");if(1!==this.uz.t[L])throw Error.argument("blobID","Requested blob is not a string");if(null==this.WU[L]){const qa=this.wIa(L).ma(0);this.WU[L]=this.Z1d.ia(qa)}return this.WU[L]}QHf(L){if(1>L||L>=this.uz.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.uz.t[L])throw Error.argument("blobID","Requested blob is not a Regex");if(!this.WU[L]){var qa=this.wIa(L);
const Va=this.ia(qa.ma(0));qa=1===qa.ma(1);this.WU[L]=new RegExp(Va,qa?"i":"")}return this.WU[L]}oTi(L){if(1>L||L>=this.uz.t.length)throw Error.argumentOutOfRange("blobID");if(3!==this.uz.t[L])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}zKd(L){if(1>L||L>=this.uz.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.uz.t[L])throw Error.argument("blobID","Requested blob is not an NL module");return this.WU[L]||(this.WU[L]=this.zAj.tOi(this.wIa(L),
this))}dE(L){if(1>L||L>=this.uz.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.uz.t[L])throw Error.argument("blobID","Requested blob is not an annotation query");return this.WU[L]||(this.WU[L]=new rd(new Vh(this.wIa(L),this)))}rYa(L){if(1>L||L>=this.uz.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.uz.t[L])throw Error.argument("blobID","Requested blob is not an annotation script");return this.WU[L]||(this.WU[L]=new Yf(new Tf(this.wIa(L),this)))}h5(L){if(1>L||L>=this.uz.t.length)throw Error.argumentOutOfRange("blobID");
if(7!==this.uz.t[L])throw Error.argument("blobID","Requested blob is not a filter");return this.WU[L]||(this.WU[L]=this.qAj.h5(this.wIa(L),this))}bSi(L){if(1>L||L>=this.uz.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.uz.t[L])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.WU[L]||(this.WU[L]=new Ng(this.wIa(L),this))}wIa(L){const qa=this.uz.n[L];L=(L<this.uz.t.length-1?this.uz.n[L+1]:this.uz.n.length)-qa;if(0>qa||0>L||qa+L>this.uz.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+
qa+","+L+")");const Va=new eb.a;Va.wGd(this.uz.n,qa,L);return Va}}Object(m.a)(bh,"ObjectFetcher",null,[679]);class mh{constructor(L,qa,Va){if(!L)throw Error.argumentNull("prediction");if(!qa)throw Error.argumentNull("fieldNames");if(!Va)throw Error.argumentNull("values");if(qa.length!==Va.length)throw Error.argument("values","fieldNames and values do not have same length");this.anh=L;this.e2a=qa;this.gYb=Va}get prediction(){return this.anh}get fwf(){return this.e2a.length}getFieldName(L){return 0<=
L&&L<this.e2a.length?this.e2a[L]:null}MO(L){return 0<=L&&L<this.gYb.length?this.gYb[L]:null}}Object(m.a)(mh,"PredictionData",null,[]);class Tg{constructor(L,qa){if(!L)throw Error.argumentNull("predictions");if(!qa)throw Error.argumentNull("tokenAttributes");this.BAj=L;this.MAj=qa}lLd(){return this.BAj}JAf(){return this.MAj}}Object(m.a)(Tg,"PredictionDataWithTokenAttributes",null,[]);class Vg{constructor(L,qa){this.prediction=null;this.score=0;this.prediction=L;this.score=qa}}Object(m.a)(Vg,"PredictionWithScore",
null,[]);class nh{constructor(L,qa){if(!L)throw Error.argumentNull("predictions");if(!qa)throw Error.argumentNull("attributes");this.bnh=L;this.Tac=qa}lLd(){return this.bnh}JAf(){return this.Tac}}Object(m.a)(nh,"PredictionsWithTokenAttributes",null,[]);class wh{constructor(L,qa,Va){if(!L)throw Error.argumentNull("attributeName");if(!qa)throw Error.argumentNull("fieldNames");if(!Va)throw Error.argumentNull("values");if(qa.length!==Va.length)throw Error.argument("values","fieldNames and values do not have same length");
this.Ydh=L;this.e2a=qa;this.gYb=Va}get attributeName(){return this.Ydh}get fwf(){return this.e2a.length}getFieldName(L){return 0<=L&&L<this.e2a.length?this.e2a[L]:null}MO(L){return 0<=L&&L<this.gYb.length?this.gYb[L]:null}}Object(m.a)(wh,"TokenAttributes",null,[]);var oh=a(145);class gh{constructor(L,qa,Va,Fb,bc){this.Y$b=0;this.Uze=null;this.Z$b=this.zyb=0;this.q3c=this.j9a=this.n8=this.Ayb=null;this.Wze=0;this.Oab=this.kx=null;this._state=-1;this.$$ge=this.getEnumerator;this.$$cu=this.get_current;
this.$$mn=this.moveNext;this.$$rst=this.reset;this.JC=L;this.D7g=this.H7g=qa;this.C7g=this.F7g=Va;this.W$b=this.E7g=Fb;this.X$b=this.G7g=bc}p3c(){this.Z$b=0;return this.Rze}Rze(){if(!(this.Z$b<this.W$b))return this.Sze;this.Ayb=this.D7g.items[this.Z$b+this.C7g];this.n8=new Nf.a(this.JC.Ia.annotations);1!==this.W$b&&this.JC.Ia.CTb||this.n8.Jua(this.Ayb);if(0<=this.JC.Ia.rLc){(()=>{let L=this.n8.Tp(this.JC.Ia.rLc);({value:this.j9a}=L);return L})().returnValue?this.j9a=this.j9a.RJ():this.j9a=new Fc.a(this.JC.Ia.annotations,
Oe.Annotations.eL);this.q3c=this.X$b.items;this.Wze=this.q3c.length;for(this.Y$b=0;this.Y$b<this.Wze;++this.Y$b)this.Uze=this.q3c[this.Y$b],Array.add(this.j9a.items,this.Uze);this.n8.Kv(this.JC.Ia.rLc,this.j9a)}else 0<=this.JC.Ia.Rqe?this.n8.Kv(this.JC.Ia.Rqe,this.X$b.items[0]):0<=this.JC.Ia.Wqd?this.n8.Kv(this.JC.Ia.Wqd,!0):this.JC.Ia.OYf?this.X$b.items[0].Swc((L,qa)=>this.n8.Kv(L,qa)):(this.n8.Jua(this.X$b.items[0]),1!==this.W$b&&this.JC.Ia.CTb||((()=>{let L=this.Ayb.Tp(this.JC.Ia.IQ);({value:this.zyb}=
L);return L})().returnValue&&this.n8.Kv(this.JC.Ia.IQ,this.zyb),(()=>{let L=this.Ayb.Tp(this.JC.Ia.DT);({value:this.zyb}=L);return L})().returnValue&&this.n8.Kv(this.JC.Ia.DT,this.zyb),(()=>this.Ayb.Tp(this.JC.Ia.HFa))().returnValue&&this.n8.Kv(this.JC.Ia.HFa,this.zyb)));this.kx=this.n8;this._state=2;return this.K7g}Sze(){this._state=3}J7g(){this.Z$b++;return this.Rze}K7g(){return 1<this.W$b&&this.JC.Ia.CTb?this.Sze:this.J7g}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new gh(this.JC,
this.H7g,this.F7g,this.E7g,this.G7g)).getEnumerator()}[Symbol.iterator](){return Object(oh.a)(this.getEnumerator())}moveNext(){if(3===this._state)return!1;this._state?this._state=1:(this._state=1,this.Oab=this.p3c());for(;1===this._state;)this.Oab=this.Oab();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.kx}}Object(m.a)(gh,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",
null,[2,43,93]);class lh{constructor(L,qa,Va){this.bYb=this.$7f=0;this.Wob=null;this.$1d=this.y1d=this.Uob=this.gKc=this.B1d=0;this.iKc=!1;this.O1d=L;this.a2d=qa;this.AAj=Va}qGf(){null===this.Wob&&({CXg:this.Wob,gQf:this.B1d,length:this.gKc,nsi:L}=this.O1d.PJf(this.a2d.items[this.bYb],this.AAj),this.iKc=L||this.iKc);if(this.Uob<this.gKc){var L=this.Wob.charAt(this.B1d+this.Uob);++this.Uob;return{returnValue:!0,ch:L}}if(this.bYb===this.a2d.items.length-1)return{returnValue:!1,ch:"\x00"};++this.bYb;
this.Uob=0;this.Wob=null;return{returnValue:!0,ch:" "}}Ree(L,qa){this.Uob===this.gKc&&this.Wob&&(this.$1d=qa,this.y1d=this.bYb-this.$7f+1)}$ok(L){if(0>L||L>=this.a2d.items.length)throw Error.argumentOutOfRange("iToken");this.bYb=this.$7f=L;this.Wob=null;this.y1d=this.Uob=this.gKc=this.B1d=0;this.$1d=-1;this.iKc=!1}tNi(){return{pNh:this.y1d,ksj:this.$1d,jsi:this.iKc}}}Object(m.a)(lh,"TriePrefixVisitor",null,[705]);class Sh{constructor(L){this.Ia=L}execute(L){let qa;if(!(()=>{let Ic=L.Tp(this.Ia.Uka);
({value:qa}=Ic);return Ic})().returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Va;(()=>{let Ic=L.Tp(this.Ia.Mta);({value:Va}=Ic);return Ic})().returnValue||(Va=null);const Fb=this.aCi(qa,Va),bc=Oe.Annotations.RJ(L);bc.Kv(this.Ia.Uka,Fb);return bc}aCi(L,qa){let Va=null;const Fb=this.Ia.flatLexicon.trie,bc=new lh(this,L,qa);let Ic=null;this.Ia.flatLexicon.BSd()&&(Ic=Object(Ba.a)(this.Ia.flatLexicon,this.Ia.flatLexicon.wEi,"getCaseInsensitiveForm"));let td=0,Hd;
var pe;let Ke;for(;td<L.items.length;){const uf=L.items[td];bc.$ok(td);Fb.k6g(bc,Ic);({pNh:Hd,ksj:pe,jsi:Ke}=bc.tNi());if(0<Hd){({quj:pe}=this.Ia.flatLexicon.tCi(pe));for(let zf of this.Z3h(L,td,Hd,pe)){1<Hd&&this.Ia.CTb&&this.H4h(L,qa,td,uf,Hd,Ke,zf);if(!Va)for(Va=new Fc.a(this.Ia.annotations,Oe.Annotations.eL),pe=0;pe<td;++pe)Array.add(Va.items,L.items[pe]);Array.add(Va.items,zf)}td+=Hd}else Va&&Array.add(Va.items,uf),++td}return Va||L}H4h(L,qa,Va,Fb,bc,Ic,td){if(Ic)Ic=!0;else if(this.Ia.wYf){Ic=
!1;var Hd=-1;for(var pe=0;pe<bc;pe++){const kg=L.items[Va+pe];let ug,Gg;if(!(()=>{let ah=kg.Tp(this.Ia.IQ);({value:ug}=ah);return ah})().returnValue||!(()=>{let ah=kg.Tp(this.Ia.DT);({value:Gg}=ah);return ah})().returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");if(0<pe){if(ug>Hd+1){Ic=!0;break}if(0>Hd||null===qa||Hd>=qa.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");
if(" "!==qa.charAt(Hd)){Ic=!0;break}}Hd=ug+Gg}}else Ic=!1;if(Ic){Ic=new Sys.StringBuilder;for(Hd=0;Hd<bc;++Hd){let kg,ug;({CXg:pe,gQf:kg,length:ug}=this.PJf(L.items[Va+Hd],qa));0<Hd&&Ic.append(" ");Ic.append(pe.substr(kg,ug))}td.Kv(this.Ia.HFa,Ic.toString())}const Ke=L.items[Va+bc-1];let uf,zf,bg;(()=>{let kg=Fb.Tp(this.Ia.IQ);({value:uf}=kg);return kg})().returnValue&&(()=>{let kg=Ke.Tp(this.Ia.IQ);({value:zf}=kg);return kg})().returnValue&&(()=>{let kg=Ke.Tp(this.Ia.DT);({value:bg}=kg);return kg})().returnValue?
(td.Kv(this.Ia.IQ,uf),td.Kv(this.Ia.DT,zf+bg-uf)):(td.Zsb(this.Ia.IQ),td.Zsb(this.Ia.DT))}Z3h(L,qa,Va,Fb){return new gh(this,L,qa,Va,Fb)}PJf(L,qa){let Va,Fb,bc,Ic;if((()=>{let td=L.Tp(this.Ia.HFa);({value:Va}=td);return td})().returnValue)Ic=!0,Fb=0,bc=Va.length;else{Ic=!1;if(null===qa)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");Va=qa;if(!(()=>{let td=L.Tp(this.Ia.IQ);({value:Fb}=td);return td})().returnValue)throw Error.argument("Token missing required Span.StartIndex annotation",
"token");if(!(()=>{let td=L.Tp(this.Ia.DT);({value:bc}=td);return td})().returnValue)throw Error.argument("Token missing required Span.Length annotation","token");if(0>Fb||0>bc||Fb+bc>Va.length)throw Error.argument("Token start/length values out of range","token");}return{CXg:Va,gQf:Fb,length:bc,nsi:Ic}}}Object(m.a)(Sh,"FlatLexiconNLModule",null,[688]);class ih{constructor(L,qa){this.Wqd=this.rLc=this.Rqe=this.HFa=this.DT=this.IQ=this.Mta=this.Uka=0;this.OYf=this.wYf=this.CTb=!1;this.flatLexicon=
null;this.annotations=qa.annotations;let Va=0;try{this.Uka=L.ma(Va),++Va,this.Mta=L.ma(Va),++Va,this.IQ=L.ma(Va),++Va,this.DT=L.ma(Va),++Va,this.HFa=L.ma(Va),++Va,this.Rqe=L.ma(Va),++Va,this.rLc=L.ma(Va),++Va,this.Wqd=L.ma(Va),++Va,this.CTb=1===L.ma(Va),++Va,this.wYf=1===L.ma(Va),++Va,this.OYf=1===L.ma(Va),++Va,this.flatLexicon=qa.bSi(L.ma(Va))}catch(Fb){throw Error.argument("initData");}}}Object(m.a)(ih,"FlatLexiconNLModuleInit",null,[]);class di{constructor(){this.fSb=0;this.wEd=null;this.z4b=0}}
Object(m.a)(di,"FeatureGenStackRec",null,[]);class Ra{constructor(L){this.zue=Array(L);this.Zwb=Array(L);this.tse=[];this.pVg=[]}}Object(m.a)(Ra,"TokenStringLattice",null,[]);const Tb=(L,qa,Va)=>{for(let Fb=0;Fb<L.length;Fb++)Va=qa(Va,L[Fb]);return Va},Dc=(L,qa)=>{const Va=Array(L.length);for(let Fb=0;Fb<L.length;Fb++)Va[Fb]=qa(L[Fb]);return Va},Yc=(L,qa)=>{qa=Array(Math.min(qa,L.length));for(let Va=0;Va<qa.length;Va++)qa[Va]=L[Va];return qa},Ad=(L,qa)=>{const Va=[];for(const Fb of L)qa(Fb)&&Array.add(Va,
Fb);return Va};class he{constructor(L,qa){this.key=L;this.value=qa}}Object(m.a)(he,"KeyValuePair",null,[]);const re=(L,qa)=>({returnValue:qa in L,value:L[qa]}),Me=L=>{const qa=[];for(let Va in L){const Fb=new he(Va,L[Va]);Array.add(qa,Fb)}return qa};class Ve{constructor(L){this.OJf=this.MWi;this.Ia=L;this.lKc=this.M1d=this.N1d=0;for(const qa of this.Ia.Mvc)this.N1d=Math.max(this.N1d,qa.Jae),this.M1d=Math.max(this.M1d,qa.Aae),this.lKc=Math.max(this.lKc,qa.gwb.length)}get aui(){return this.Ia.H_c.trie}execute(L){if(!L)throw Error.argumentNull("input");
let qa,Va;({tokens:qa,Wsj:Va}=this.NWi(L));let Fb=null,bc=null,Ic={};if(this.Ia.lUb){qa=Oe.Annotations.RJ(qa);for(var td=0;td<qa.items.length;++td)qa.items[td]=Oe.Annotations.RJ(qa.items[td])}else({Yvf:bc,returnValue:Fb}=this.TGf(L,Ic));td=Array(this.lKc);const Hd=Array(this.lKc);for(var pe=0;pe<Hd.length;++pe)Hd[pe]=new di;for(pe=-this.N1d;pe<qa.items.length+this.M1d;++pe){let Ke=null;this.Ia.lUb&&(Ke=qa.items[pe],Ic={},{Yvf:bc,returnValue:Fb}=this.TGf(Ke,Ic));for(const uf of this.Ia.Mvc){if(0>pe&&
-pe>uf.Jae||pe>=qa.items.length&&pe-qa.items.length+1>uf.Aae)continue;let zf=!0;for(let bg=0;bg<uf.gwb.length;++bg){const kg=pe+uf.gwb[bg];td[bg]=kg;if(0>kg?0>this.Ia.Kae:kg>=qa.items.length?0>this.Ia.Bae:!Va.Zwb[kg]){zf=!1;break}}zf&&({x7h:Fb,y7h:bc}=this.ycj(uf,Va,Fb,bc,Ic,Hd,td))}this.Ia.lUb&&(Ke.Kv(this.Ia.Dxa?this.Ia.Sdb:this.Ia.Qdb,Fb),this.Ia.Dxa&&Ke.Kv(this.Ia.Rdb,bc))}L=Oe.Annotations.RJ(L);this.Ia.lUb?L.Kv(this.Ia.Uka,qa):(L.Kv(this.Ia.Dxa?this.Ia.Sdb:this.Ia.Qdb,Fb),this.Ia.Dxa&&L.Kv(this.Ia.Rdb,
bc));return L}NWi(L){let qa,Va;if(!L||!(()=>{let Ic=L.Tp(this.Ia.Uka);({value:qa}=Ic);return Ic})().returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Fb;(()=>{let Ic=L.Tp(this.Ia.Mta);({value:Fb}=Ic);return Ic})().returnValue||(Fb="");Va=new Ra(qa.items.length);const bc=Ad(this.Ia.Bue,Ic=>!Ic.VSb||Ic.VSb.isMatch(L,null));for(let Ic=0;Ic<qa.items.length;++Ic){const td=qa.items[Ic];let Hd=null;Va.zue[Ic]=Va.tse.length;let pe=Va.Zwb[Ic]=0;for(const Ke of bc)0<Ke.oYb&&
Va.Zwb[Ic]+pe>=Ke.oYb||Ke.P8b&&!Ke.P8b.isMatch(td,null)||({Q8b:Hd,lIb:pe}=Ke.apply(this,td,Ic,Va,Fb,Hd,pe))}return{tokens:qa,Wsj:Va}}ycj(L,qa,Va,Fb,bc,Ic,td){let Hd=0;Ic[0].fSb=-1;for(Ic[0].wEd=L.rGg;;){const Ke=td[Hd],uf=0>Ke||Ke>=qa.Zwb.length?1:qa.Zwb[Ke];let zf=!1;for(;Ic[Hd].fSb<uf-1;){++Ic[Hd].fSb;let bg;var pe=void 0;0>Ke?(bg=this.Ia.Kae,pe=1):Ke>=qa.zue.length?(bg=this.Ia.Bae,pe=1):(pe=qa.zue[Ke]+Ic[Hd].fSb,bg=qa.tse[pe],pe=qa.pVg[pe]);Ic[Hd].z4b=pe*(Hd?Ic[Hd-1].z4b:L.score);let kg;if((()=>
{let ug=re(Ic[Hd].wEd,bg.toString());({value:kg}=ug);return ug})().returnValue){if(Hd===L.gwb.length-1){const ug=kg;if(Ic[Hd].z4b){let Gg;(()=>{let ah=re(bc,ug.toString());({value:Gg}=ah);return ah})().returnValue||(Gg=-1);0>Gg&&(Va=Oe.Annotations.RJ(Va),Array.add(Va.items,ug));this.Ia.Dxa&&(Fb=Oe.Annotations.RJ(Fb),0>Gg?Array.add(Fb.items,Ic[Hd].z4b):Fb.items[Gg]+=Ic[Hd].z4b);0>Gg&&(this.Ia.y0f||this.Ia.Dxa)&&(bc[ug.toString()]=Va.items.length-1)}}else++Hd,Ic[Hd].fSb=-1,Ic[Hd].wEd=kg;zf=!0;break}}if(!zf&&
(--Hd,0>Hd))break}return{x7h:Va,y7h:Fb}}TGf(L,qa){let Va,Fb;if((()=>{let bc=L.Tp(this.Ia.Dxa?this.Ia.Sdb:this.Ia.Qdb);({value:Fb}=bc);return bc})().returnValue)for(let bc=0;bc<Fb.items.length;++bc)qa[Fb.items[bc].toString()]=bc;else Fb=new Fc.a(this.Ia.annotations,Oe.Annotations.Nia);if(this.Ia.Dxa){if((()=>{let bc=L.Tp(this.Ia.Rdb);({value:Va}=bc);return bc})().returnValue||(Va=new Fc.a(this.Ia.annotations,Oe.Annotations.d8)),Va.items.length!==Fb.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+
this.Ia.annotations.AZ(Oe.Annotations.eL,L));}else Va=null;return{returnValue:Fb,Yvf:Va}}get FXk(){return this.Ia.H_c}MWi(L,qa){let Va;if((()=>{let Fb=qa.Tp(this.Ia.HFa);({value:Va}=Fb);return Fb})().returnValue)L=Va;else{let Fb;if(!(()=>{let Ic=qa.Tp(this.Ia.IQ);({value:Fb}=Ic);return Ic})().returnValue)throw Error.argument("Token is missing Span.StartIndex");let bc;if(!(()=>{let Ic=qa.Tp(this.Ia.DT);({value:bc}=Ic);return Ic})().returnValue)throw Error.argument("Token is missing Span.Length");if(0>
Fb||0>bc||Fb+bc>L.length)throw Error.argument("Token indices are out of range");L=L.substr(Fb,bc)}return L}}Object(m.a)(Ve,"NGramNLModule",null,[688,691]);class Hf{constructor(L){this.gwb=null;this.score=this.Aae=this.Jae=0;this.rGg=null;if(L){var qa=0;try{if(L.ma(qa)!==Hf.lVa)throw Error.argument("initData","Input does not represent a feature template");++qa;const Va=L.ma(qa);++qa;this.gwb=Array(Va);for(let bc=0;bc<Va;++bc)this.gwb[bc]=L.ma(qa),++qa;this.Jae=L.ma(qa);++qa;this.Aae=L.ma(qa);++qa;
this.score=L.ma(qa);++qa;let Fb=Hf.Gxg(L,qa);({eQf:qa}=Fb);this.rGg=Fb.returnValue}catch(Va){throw Error.argument("initData");}}}static Gxg(L,qa){const Va=L.ma(qa);++qa;const Fb={};for(let Ic=0;Ic<Va;++Ic){var bc=L.ma(qa);++qa;if(L.ma(qa)){bc=bc.toString();let td=Hf.Gxg(L,qa);({eQf:qa}=td);Fb[bc]=td.returnValue}else++qa,Fb[bc.toString()]=L.ma(qa),++qa}return{returnValue:Fb,eQf:qa}}}Hf.lVa=240803228;Object(m.a)(Hf,"FeatureTemplate",null,[708]);var Qf=a(1045);class ia{constructor(L,qa){this.Dxa=this.y0f=
this.lUb=!1;this.HFa=this.DT=this.IQ=this.Uka=this.Mta=this.Rdb=this.Sdb=this.Qdb=0;this.H_c=null;this.Bae=this.Kae=0;this.Mvc=this.Bue=null;if(L){this.annotations=qa.annotations;var Va=0;try{this.lUb=1===L.ma(Va);++Va;this.y0f=1===L.ma(Va);++Va;this.Dxa=1===L.ma(Va);++Va;this.Qdb=L.ma(Va);++Va;this.Sdb=L.ma(Va);++Va;this.Rdb=L.ma(Va);++Va;this.Mta=L.ma(Va);++Va;this.Uka=L.ma(Va);++Va;this.IQ=L.ma(Va);++Va;this.DT=L.ma(Va);++Va;this.HFa=L.ma(Va);++Va;this.H_c=this.B1j(qa.AIa(L.ma(Va)));++Va;this.Kae=
L.ma(Va);++Va;this.Bae=L.ma(Va);++Va;const Fb=L.ma(Va);++Va;this.Bue=Array(Fb);for(let Ic=0;Ic<Fb;++Ic){const td=L.ma(Va);++Va;const Hd=this.H_c.trie,pe=new eb.a;pe.oIa(L,Va,td);this.Bue[Ic]=this.F1j(pe,qa,Hd);Va+=td}const bc=L.ma(Va);++Va;this.Mvc=Array(bc);for(qa=0;qa<bc;++qa){const Ic=L.ma(Va);++Va;const td=new eb.a;td.oIa(L,Va,Ic);this.Mvc[qa]=this.k1j(td);Va+=Ic}}catch(Fb){throw Error.argument("initData");}}}B1j(L){return new pg.a(new Ug.a(L))}F1j(L,qa,Va){return Qf.a.create(L,qa,Va)}k1j(L){return new Hf(L)}}
Object(m.a)(ia,"NGramNLModuleInit",null,[]);class Xb{constructor(L){this.Ia=L}execute(L){if(!L)throw Error.argumentNull("input");L=L.clone();this.Ia.script.execute(L,null);return L}}Object(m.a)(Xb,"ScriptNLModule",null,[688]);class Vc{constructor(L,qa){L&&(this.script=qa.rYa(L.ma(0)))}}Object(m.a)(Vc,"ScriptNLModuleInit",null,[]);const ud=L=>{L=Dc(L,qa=>qa*qa);return Math.sqrt(Tb(L,(qa,Va)=>qa+Va,0))},xe=L=>Tb(L,(qa,Va)=>qa>Va?qa:Va,L[0]);class fe{constructor(L){this.Ia=L}execute(L){if(!L)throw Error.argumentNull("input");
var qa=[],Va=[];this.uVh(L,qa,Va);this.UBh(qa,Va);const Fb={};for(let Ic=0;Ic<qa.length;++Ic){var bc=qa[Ic];const td=this.Ia.HSf.ma(bc);bc=this.Ia.ISf.ma(bc);for(let Hd=0;Hd<bc;++Hd){const pe=this.Ia.aTh.ma(this.Ia.zbf.ma(td+Hd)),Ke=this.Ia.Abf.ma(td+Hd);let uf;(()=>{let zf=re(Fb,pe);({value:uf}=zf);return zf})().returnValue||(uf=0);Fb[pe]=uf+Va[Ic]*Ke}}Va=Me(Fb);Va.sort((Ic,td)=>{var Hd=Ic.value,pe=td.value;(Hd=-(Hd>pe?1:Hd<pe?-1:0))||(Hd=Ic.key.localeCompare(td.key));return Hd});qa=new Fc.a(this.Ia.annotations,
Oe.Annotations.eL);for(const Ic of Yc(Va,this.Ia.rCj))Va=new Nf.a(this.Ia.annotations),Va.Kv(this.Ia.ZGh,Ic.key),Va.Kv(this.Ia.aHh,Ic.value),Array.add(qa.items,Va);L.Kv(this.Ia.$Gh,qa);return L}uVh(L,qa,Va){let Fb;if((()=>{let bc=L.Tp(this.Ia.YGh);({value:Fb}=bc);return bc})().returnValue){let bc;if((()=>{let Ic=Fb.Tp(this.Ia.Sdb);({value:bc}=Ic);return Ic})().returnValue){let Ic;if(!(()=>{let td=Fb.Tp(this.Ia.Rdb);({value:Ic}=td);return td})().returnValue||bc.items.length!==Ic.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");
this.lpc(bc,Ic,qa,Va)}if((()=>{let Ic=Fb.Tp(this.Ia.cHh);({value:bc}=Ic);return Ic})().returnValue){let Ic;if(!(()=>{let td=Fb.Tp(this.Ia.dHh);({value:Ic}=td);return td})().returnValue||bc.items.length!==Ic.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");this.lpc(bc,Ic,qa,Va)}(()=>{let Ic=Fb.Tp(this.Ia.Qdb);({value:bc}=Ic);return Ic})().returnValue&&this.lpc(bc,null,qa,Va);(()=>{let Ic=Fb.Tp(this.Ia.bHh);({value:bc}=Ic);return Ic})().returnValue&&
this.lpc(bc,null,qa,Va)}}lpc(L,qa,Va,Fb){for(let Ic=0;Ic<L.items.length;++Ic){let td;if(L.QR===Oe.Annotations.bW){const Hd=L.items[Ic];(()=>{let pe=re(this.Ia.eof,Hd);({value:td}=pe);return pe})().returnValue||(td=-1)}else{var bc=L.items[Ic];td=bc>=this.Ia.n3d&&bc<=this.Ia.UCj?this.Ia.S4d?this.Ia.S4d.ma(bc-this.Ia.n3d)-1:bc-this.Ia.n3d:-1}0<=td&&(bc=qa?qa.items[Ic]:1,0<bc&&(Array.add(Va,td),Array.add(Fb,bc)))}}UBh(L,qa){if(L.length){switch(this.Ia.T8j){case 0:break;case 1:for(var Va=0;Va<qa.length;++Va)qa[Va]=
1+Math.log(qa[Va]);break;case 2:Va=xe(qa);for(let Fb=0;Fb<qa.length;++Fb)qa[Fb]=.5+qa[Fb]/Va*.5;break;case 3:for(Va=0;Va<qa.length;++Va)qa[Va]=1;break;default:throw Error.notImplemented();}if(this.Ia.zDc)for(Va=0;Va<qa.length;++Va)qa[Va]*=this.Ia.zDc.ma(L[Va]);L=ud(qa);for(Va=0;Va<qa.length;++Va)qa[Va]/=L}}}Object(m.a)(fe,"TfIdfRankerNLModule",null,[688]);class Te{constructor(L,qa){qa=void 0===qa?0:qa;if(!L)throw Error.argumentNull("byteArray");this.nKc=qa;if(604662927!==L.Gv(this.nKc+0,4))throw Error.argument("byteArray",
"Input does not represent a compact int array");this._count=L.Gv(this.nKc+4,4);this.v7f=L.Gv(this.nKc+8,4);this.jAj=L}ma(L){if(0>L||L>=this.count)throw Error.argumentOutOfRange("index");return this.jAj.Bbk(8*this.nKc+96+L*this.v7f,this.v7f)}get count(){return this._count}}Object(m.a)(Te,"CompactIntArray",null,[689]);const Bf=(L,qa)=>{qa=Array(qa);for(let Ic=0;Ic<qa.length;Ic++){var Va=Ic,Fb=L.lV(),bc=1===(Fb>>31&1)?-1:1;const td=Fb&8388607;Fb=Fb>>23&255;256===Fb+1?bc=td?Number.NaN:1===bc?Number.POSITIVE_INFINITY:
Number.NEGATIVE_INFINITY:Fb?(Fb-=127,bc=bc*Cf(td,1)*Math.pow(2,Fb)):bc=bc*Cf(td,0)*Math.pow(2,-126);qa[Va]=bc}return qa},Cf=(L,qa)=>{let Va=0;for(let Fb=0;23>Fb;Fb++)Va+=(L>>22-Fb&1)/Math.pow(2,Fb+1);return qa+Va};class Lf{constructor(L,qa){this.S4d=null;this.vcg=0;this.ISf=this.HSf=this.zDc=null;this.ucg=0;this.Abf=this.zbf=null;this.annotations=qa.annotations;let Va=0;this.bHh=L.ma(Va);++Va;this.Qdb=L.ma(Va);++Va;this.cHh=L.ma(Va);++Va;this.dHh=L.ma(Va);++Va;this.Sdb=L.ma(Va);++Va;this.Rdb=L.ma(Va);
++Va;this.YGh=L.ma(Va);++Va;this.$Gh=L.ma(Va);++Va;this.ZGh=L.ma(Va);++Va;this.aHh=L.ma(Va);++Va;var Fb=L.ma(Va);++Va;var bc=Array(Fb);for(var Ic=0;Ic<Fb;++Ic)bc[Ic]=qa.ia(L.ma(Va)),++Va;this.aTh=eb.a.lxd(bc);this.rCj=L.ma(Va);++Va;this.T8j=L.ma(Va);++Va;Fb=L.ma(Va);++Va;this.eof={};for(bc=0;bc<Fb;++bc){Ic=qa.ia(L.ma(Va));++Va;const td=L.ma(Va);++Va;this.eof[Ic]=td}this.n3d=L.ma(Va);++Va;this.UCj=L.ma(Va);++Va;Fb=L.ma(Va);++Va;0<Fb&&(Fb=qa.AIa(L.ma(Va)),++Va,this.S4d=this.kPc(new zg(Fb)));++Va;L=
qa.AIa(L.ma(Va));this.q1j(L)}kPc(L){return new Te(L.array,L.offset)}q1j(L){try{const qa=new zg(L);this.vcg=qa.lV();1===qa.lV()?this.zDc=eb.a.lxd(Bf(qa,this.vcg)):this.zDc=null;const Va=qa.lV();this.HSf=this.kPc(qa);qa.offset+=Va;const Fb=qa.lV();this.ISf=this.kPc(qa);qa.offset+=Fb;this.ucg=qa.lV();const bc=qa.lV();this.zbf=this.kPc(qa);qa.offset+=bc;this.Abf=eb.a.lxd(Bf(qa,this.ucg))}catch(qa){throw Error.argument("byteReader");}}}Object(m.a)(Lf,"TfIdfRankerNLModuleInit",null,[]);class df{constructor(L,
qa,Va,Fb){this.n$d=L;this.kxf=Va;this.tokens=Fb;this.j4=qa;this.Gub=-1;this.zVc=0}}Object(m.a)(df,"TokenizerData",null,[]);class T{constructor(L){this.Ia=L}execute(L){if(!L)throw Error.argumentNull("input");let qa;if(!(()=>{let td=L.Tp(this.Ia.Mta);({value:qa}=td);return td})().returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Va;(()=>{let td=L.Tp(this.Ia.IQ);({value:Va}=td);return td})().returnValue||(Va=0);let Fb;(()=>{let td=L.Tp(this.Ia.DT);
({value:Fb}=td);return td})().returnValue||(Fb=qa.length-Va);if(0>Va||Va>qa.length)throw Error.argument("input","Start index out of range");if(0>Fb||Fb>qa.length)throw Error.argument("input","Length out of range");if(Va+Fb>qa.length)throw Error.argument("input","Bad start-length range");const bc=new df(qa,Va,Va+Fb,new Fc.a(this.Ia.annotations,Oe.Annotations.eL));this.GXk(bc);const Ic=L.isReadOnly?L.clone():L;Ic.Kv(this.Ia.Uka,bc.tokens);return Ic}GXk(L){for(;L.j4<L.kxf;){if(this.Ia.nNd){var qa=this.Ia.nNd.c7f(L.n$d,
L.j4,L.kxf-L.j4,null);!qa.succeeded&&qa.Dbg&&(qa=qa.Dbg);if(qa.succeeded){this.ukg(L,qa.length,this.Ia.lLf);L.j4+=qa.length;continue}}qa=L.n$d.substr(L.j4);let Va=-1,Fb=-1,bc=-1;for(let Ic=0;Ic<this.Ia.pUc.length;++Ic){const td=this.Ia.pUc[Ic].exec(qa);td&&0<td[1].length&&(0>Va||td[0].length>Fb)&&(Va=Ic,Fb=td[0].length,bc=td[1].length)}0<=Va?(this.ukg(L,bc,this.Ia.Oje[Va]),L.j4+=bc):L.j4+=1}}ukg(L,qa,Va){if(this.Ia.m_f)Va!==T.FNh&&(0>L.Gub&&(L.Gub=L.j4),L.zVc=L.j4+qa-L.Gub,Va===T.ENh&&(0<=L.Gub&&
0<L.zVc&&(qa=new Nf.a(this.Ia.annotations),qa.Kv(this.Ia.IQ,L.Gub),qa.Kv(this.Ia.DT,L.zVc),qa.Kv(this.Ia.Mpd,T.GNh),qa.Kv(this.Ia.Mta,L.n$d),Array.add(L.tokens.items,qa)),L.Gub=-1,L.zVc=0));else{let Fb=new Nf.a(this.Ia.annotations);Fb.Kv(this.Ia.IQ,L.j4);Fb.Kv(this.Ia.DT,qa);Fb.Kv(this.Ia.Mpd,Va);Array.add(L.tokens.items,Fb)}}}T.FNh="GAP";T.ENh="EOS_CHUNK";T.GNh="SENTENCE";Object(m.a)(T,"TokenizerNLModule",null,[688]);class Ga{constructor(L,qa){this.DT=this.IQ=this.Mpd=this.Uka=this.Mta=0;this.m_f=
!1;this.Oje=this.pUc=this.lLf=this.nNd=null;if(L){this.annotations=qa.annotations;var Va=0;try{this.Mta=L.ma(Va);++Va;this.Uka=L.ma(Va);++Va;this.Mpd=L.ma(Va);++Va;this.IQ=L.ma(Va);++Va;this.DT=L.ma(Va);++Va;this.m_f=1===L.ma(Va);++Va;var Fb=L.ma(Va);++Va;0<Fb&&(this.nNd=qa.zKd(Fb).aui);this.lLf=L.ma(Va)?qa.ia(L.ma(Va)):"";++Va;const bc=L.ma(Va);++Va;this.pUc=Array(bc);this.Oje=Array(bc);for(Fb=0;Fb<bc;++Fb)this.pUc[Fb]=new RegExp(qa.ia(L.ma(Va))),++Va,this.Oje[Fb]=qa.ia(L.ma(Va)),++Va}catch(bc){throw Error.argument("initData");
}}}}Object(m.a)(Ga,"TokenizerNLModuleInit",null,[]);class hb{constructor(L){this.Ia=L}execute(L){if(!L)throw Error.argumentNull("input");let qa;if(!(()=>{let Fb=L.Tp(this.Ia.u6e);({value:qa}=Fb);return Fb})().returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(var Va of this.Ia.Bre)qa=Va.apply(qa);Va=Oe.Annotations.RJ(L);Va.Kv(this.Ia.v6e,qa);return Va}static Qod(L,qa){const Va=new Sys.StringBuilder;for(let Fb=0;Fb<L.length;++Fb)Va.append(qa(L.substr(Fb,
1)));return Va.toString()}}Object(m.a)(hb,"TransliteratorNLModule",null,[688]);class jc{constructor(L){L&&(this.style=L.ma(0))}apply(L){return hb.Qod(L,qa=>jc.uRh(qa,this.style))}static uRh(L,qa){switch(qa){case 0:return L.toLowerCase();case 1:return"I"===L?"\u0131":L.toLowerCase();case 2:return L.toUpperCase();case 3:return"i"===L?"\u0130":L.toUpperCase();default:throw Error.invalidOperation();}}}jc.mVa=0;Object(m.a)(jc,"ChangeCaseTransliterationStage",null,[698]);class Zc{apply(L){return hb.Qod(L,
Zc.KYk)}static KYk(L){const qa=L.charCodeAt(0);return 65281<=qa&&65374>=qa?String.fromCharCode(qa-65248):L}}Zc.mVa=4;Object(m.a)(Zc,"LatinFullWidthToHalfWidthTransliterationStage",null,[698]);class kd{constructor(L,qa){L&&(this.vee=qa.QHf(L.ma(0)),this.ymk=qa.ia(L.ma(1)))}apply(L){return L.replace(this.vee,this.ymk)}}kd.mVa=1;Object(m.a)(kd,"RegexReplaceTransliterationStage",null,[698]);class qd{constructor(L,qa){if(L){var Va=L.ma(0),Fb=qa.ia(L.ma(1)),bc=new Te(qa.AIa(L.ma(2)));L=0>L.ma(3)?null:new Te(qa.AIa(L.ma(3)));
this.Dse={};for(qa=0;qa<Va;++qa)this.Dse[Fb.charAt(qa).toString()]=Fb.substr(bc.ma(qa),L?L.ma(qa):1)}}apply(L){return hb.Qod(L,qa=>qa in this.Dse?this.Dse[qa]:qa)}}qd.mVa=2;Object(m.a)(qd,"SingleCharSubstitutionsTransliterationStage",null,[698]);class ae{constructor(L,qa){this.v6e=this.u6e=0;this.Bre=null;if(L){this.annotations=qa.annotations;var Va=0;try{this.u6e=L.ma(Va);++Va;this.v6e=L.ma(Va);++Va;const Fb=L.ma(Va);++Va;this.Bre=Array(Fb);for(let bc=0;bc<Fb;++bc){const Ic=L.ma(Va);++Va;const td=
L.ma(Va);++Va;const Hd=new eb.a;Hd.oIa(L,Va,td);Va+=td;this.Bre[bc]=this.A1j(Ic,Hd,qa)}}catch(Fb){throw Error.argument("initData");}}}A1j(L,qa,Va){switch(L){case jc.mVa:return new jc(qa);case kd.mVa:return new kd(qa,Va);case qd.mVa:return new qd(qa,Va);case Zc.mVa:return new Zc;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(m.a)(ae,"TransliteratorNLModuleInit",null,[]);class ne{tOi(L,qa){const Va=L.ma(0),Fb=new eb.a;Fb.oIa(L,1,L.count-1);
switch(Va){case 0:return new Xb(new Vc(Fb,qa));case 2:return new T(new Ga(Fb,qa));case 3:return new Ve(new ia(Fb,qa));case 5:return new Sh(new ih(Fb,qa));case 9:return new hb(new ae(Fb,qa));case 10:return new fe(new Lf(Fb,qa));default:throw Error.notImplemented();}}}Object(m.a)(ne,"NLModuleFactory",null,[680]);class Pd{constructor(L){this.CNh=";";if(!L)throw Error.argumentNull("resource");this.T0=new bh(L,new Ub,new ne);this.O1d=this.T0.$Ni();this.t7f=this.T0.annotations.ePb("Text.Text");this.r7f=
this.T0.annotations.ePb("Classification.Predictions");this.w1d=this.T0.annotations.ePb("Classification.PredictionString");this.s7f=this.T0.annotations.ePb("Classification.Probability");this.gAj=this.T0.annotations.ePb("NLMod.Tokens");if(0>this.t7f||0>this.r7f||0>this.w1d||0>this.s7f)throw Error.argument("resourceObj","Resource does not represent a ranker");}iDi(){const L=[];this.xDd(void 0,this.kBf(L),null);return L}kDi(L,qa){const Va=[],Fb=[];this.xDd(L,this.kBf(Va),(bc,Ic)=>{const td=this.T0.annotations.aBf(bc),
Hd=[],pe=[];qa&&qa.length&&-1===Array.indexOf(qa,td)||(bc=this.T0.annotations.getAttributeType(bc),this.qsg(bc,Ic,Hd,pe),Ic=new wh(td,Hd,pe),Array.add(Fb,Ic))});return new nh(Va,Fb)}jDi(L){const qa=[];this.xDd(L,Va=>{let Fb;if((()=>{let bc=Va.Tp(this.w1d);({value:Fb}=bc);return bc})().returnValue){let bc;(()=>{let Ic=Va.Tp(this.s7f);({value:bc}=Ic);return Ic})().returnValue&&Array.add(qa,new Vg(Fb,bc))}},null);return qa}xDd(L,qa,Va){const Fb=new Nf.a(this.T0.annotations);Fb.Kv(this.t7f,L);const bc=
this.O1d.execute(Fb);let Ic;if((()=>{let td=bc.Tp(this.r7f);({value:Ic}=td);return td})().returnValue)for(const td of Ic.items)qa(td);if(Va){let td;if((()=>{let Hd=bc.Tp(this.gAj);({value:td}=Hd);return Hd})().returnValue)for(const Hd of td.items)Hd.Swc(Va)}}qsg(L,qa,Va,Fb){if(Oe.Annotations.DC(L))for(var bc of qa.items)this.qsg(qa.QR,bc,Va,Fb);else if(Oe.Annotations.a0g(L)){bc=this.T0.annotations.CGf(L);for(let Ic=0;Ic<bc;Ic++)Array.add(Va,this.T0.annotations.oJf(L,Ic)),Array.add(Fb,this.T0.annotations.AZ(this.T0.annotations.jZa(L,
Ic),qa.MIa(Ic)))}else Array.add(Va,"VALUE"),Array.add(Fb,this.T0.annotations.AZ(L,qa))}kBf(L){return qa=>{let Va;(()=>{let Fb=qa.Tp(this.w1d);({value:Va}=Fb);return Fb})().returnValue&&Array.add(L,this.TQi(Va))}}TQi(L){const qa=L.indexOf(this.CNh);return 0>qa?L:L.substring(0,qa)}}Object(m.a)(Pd,"Ranker",null,[]);class Vd{constructor(L,qa){this.commandId=L;this.score=qa}}Object(m.a)(Vd,"CommandSuggestion",null,[]);var Je=a(21);class Ge{static Z0c(L,qa){if(qa&&qa.Aq){const Va={};for(const Fb of L)qa.Bnb(Fb)&&
(Va[Fb]=appChrome.selectors.getModelType(Fb));Kd.instance.wca(Va)}}static faa(L){const qa=Kd.instance.eE();return!!qa&&qa.Aq&&!appChrome.selectors.isControlDisabled(L)}static Hld(L,qa,Va){if(!(qa&&qa.results&&L&&L.results&&L.results.length))return{returnValue:!1,Gld:L,dmd:qa};const Fb=[];for(var bc of qa.results)Array.add(Fb,bc.value);bc=0;const Ic=0<qa.results.length?qa.results[0].score:0;for(const td of L.results)if(td.score>Va&&!Array.contains(Fb,td.value)&&Ge.faa(td.value)&&(0<Ic&&(td.score=Ic),
Array.insert(qa.results,bc,td),bc++),2===bc)break;return 0<bc?(Va=qa.results.length-5,0<Va&&qa.Jfe(Va),{returnValue:!0,Gld:L,dmd:qa}):{returnValue:!1,Gld:L,dmd:qa}}static Fob(L,qa,Va,Fb){if(Kd.instance.xk()&&L){const bc=[];for(const Ic of L)bc.push(String.format('{{"Id":"{0}","Score":{1}}}',Ic.commandId,Ic.score));L={};L[Tc.suggestions]="[{"+bc.join(",")+"}]";L[Tc.e1f]=qa;L[Tc.groupType]=Va;L[Tc.provider]=Fb;Kd.instance.xk().bV(Bd.QVh,window.performance.now(),L)}}static bZa(L,qa,Va,Fb,bc,Ic,td,Hd){var pe,
Ke;Va.pId&&(qa=Ge.pGi(Va.pId,qa));var uf=jd.wFi(qa);Ge.Z0c(uf,Va);const zf=[];var bg=[];uf=[];const kg=new le(td);td=16===td||18===td||7===td||4===td?Je.AFrameworkApplication_AppSettingsManager.fa?Je.AFrameworkApplication_AppSettingsManager.fa.vj("TellMeMaxRecommendedResultsToReturn",3):3:0===td||17===td||25===td?5:0;const ug=Kd.instance.oKd(),Gg=jd.mGi(Va),ah=jd.lFi(Va),Qg=null===(pe=Je.AFrameworkApplication_AppSettingsManager.fa)||void 0===pe?void 0:pe.getBooleanFeatureGate("Microsoft.Office.Excel.UpdateTellMeSuggestions",
!1);jd.lE(L)&&(Va.HZj&&Va.Bnb(Gg)&&Ge.faa(Gg)&&!ug.dKb(Gg)&&zf.push(new Fd(Gg,5,null,null,Hd)),Qg&&Va.Bnb(ah)&&Ge.faa(ah)&&!ug.dKb(ah)&&zf.push(new Fd(ah,5,null,null,Hd)));pe=Qg&&jd.lE(L);for(const vh of qa)if(!(Ge.ngj(vh.commandId)||pe&&Ge.zpj(vh.commandId))){qa=Ge.aVk(vh.commandId);if(Va.Bnb(vh.commandId)&&!qa){if(jd.c0f(vh.commandId))continue;qa=null;bc&&Ic&&(qa=bc.hQi(vh.commandId,Ic));Ge.faa(vh.commandId)?Array.add(zf,new Fd(vh.commandId,5,qa,null,Hd,vh.score)):Array.add(bg,new Fd(vh.commandId,
5,qa,null,Hd,vh.score))}else Va.AUa&&qa&&Fb&&Array.add(uf,vh.commandId.substr(21));if(zf.length+uf.length>=td)break}bc=0;for(Ic=0;Ic<zf.length&&bc<td;Ic++,bc++)kg.mt(zf[Ic]);var Uh=(Ke=(Va="excel"===(null===(Ke=null===Va||void 0===Va?void 0:Va.application)||void 0===Ke?void 0:Ke.toLowerCase())?Qg:!0)?null===(Uh=null===appChrome||void 0===appChrome?void 0:appChrome.api)||void 0===Uh?void 0:Uh.getSharedUxSettings():void 0)?Ke.commonSettings:void 0;if(!Va||!Uh||!Uh().shouldHideDisabledButtonsFromTellMe())for(Uh=
0;Uh<bg.length&&bc<td;Uh++,bc++)kg.mt(bg[Uh]);for(bg=0;bg<uf.length&&bc<td;bg++,bc++)Fb.osl(L,uf[bg],kg);return kg}static pGi(L,qa){const Va=[],Fb=[];for(const bc of qa){qa=bc.commandId;let Ic=bc;bc.commandId in L&&(qa=L[bc.commandId],Ic=new Vd(qa,bc.score));Array.contains(Fb,qa)||(Va.push(Ic),Fb.push(qa))}return Va}static ngj(L){Ge.w7e||(Je.AFrameworkApplication_AppSettingsManager.fa&&Je.AFrameworkApplication_AppSettingsManager.fa.rv("TellMeControlPredictionBlockList")&&Je.AFrameworkApplication_AppSettingsManager.fa.aA("TellMeControlPredictionBlockList").forEach(qa=>
{Array.add(Ge.v7e,qa.toLowerCase())}),Ge.w7e=!0);return Array.contains(Ge.v7e,L.toLowerCase())}static zpj(L){!Ge.y7e&&Je.AFrameworkApplication_AppSettingsManager.fa&&Je.AFrameworkApplication_AppSettingsManager.fa.rv("TellMeZeroCaseSuggestionsBlockList")&&(Ge.x7e=Je.AFrameworkApplication_AppSettingsManager.fa.aA("TellMeZeroCaseSuggestionsBlockList"),Ge.y7e=!0);return Ge.x7e.includes(L.toLowerCase())}static aVk(L){return L.startsWith("btnTellMeOfficeAddIn")}static HTb(L){return 2<L.length&&";"===L.charAt(0)&&
";"===L.charAt(L.length-1)&&!!Je.AFrameworkApplication_AppSettingsManager.fa&&(Je.AFrameworkApplication_AppSettingsManager.fa.la("TellMeCommandHookIsEnabled")||Je.AFrameworkApplication_AppSettingsManager.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",!1))}}Ge.w7e=!1;Ge.y7e=!1;Ge.v7e=[];Ge.x7e=[];Object(m.a)(Ge,"CommandResultsUtilityHelper",null,[]);class sf{static Z0c(L,qa){return Ge.Z0c(L,qa)}static faa(L){return Ge.faa(L)}static Fob(L,qa,Va,Fb){return Ge.Fob(L,
qa,Va,Fb)}static bZa(L,qa,Va,Fb,bc,Ic,td,Hd){return Ge.bZa(L,qa,Va,Fb,bc,Ic,td,Hd)}static HTb(L){return Ge.HTb(L)}static tCf(L){const qa=new le(0);var Va=L.split(";");L=Kd.instance.eE();for(const Fb of Va)if(0<Fb.length){Va=Fb.split(":");const bc=2===Va.length?Va[0]:Fb;if(!L.Bnb(bc))break;if(1===Va.length)Va=new Fd(bc,5,null,null,1),qa.mt(Va);else if(2===Va.length)Va=new Fd(bc,5,Va[1],null,1),qa.mt(Va);else break}return qa}static Hld(L,qa,Va){return Ge.Hld(L,qa,Va)}}Object(m.a)(sf,"CommandResultsUtility",
null,[]);class Mf{constructor(L,qa){this.ENe="";this.Rfd=null;this.Sfd=!1;this.r8=null;this.Zdh=["TellMe.TellMeParamCollection"];this.Wg=L;this.nsa=qa;this.Wg.AUa&&(this.r8=null)}get PQc(){if(!this.Rfd&&!this.Sfd){let L=null;try{L=window.TellMeModel}catch(qa){if(Kd.instance.xk())Kd.instance.xk().onError("QueryRanker","TellMeModel not found. Exception: "+qa)}if(L){try{this.Rfd=new Pd(L)}catch(qa){if(Kd.instance.xk())Kd.instance.xk().onError("QueryRanker","Exception thrown while loading classifier. Exception: "+
qa)}this.Sfd=!0}else if(Kd.instance.xk())Kd.instance.xk().onError("QueryRanker","Classifier model not found")}return this.Rfd}hE(){return"Command"}iK(){return 0===this.Wg.Ir?0:1===this.Wg.Ir?1:2}nC(L,qa,Va,Fb,bc){Va=void 0===Va?!1:Va;Fb=void 0===Fb?vc.tellMe:Fb;bc=void 0===bc?null:bc;const Ic=new dc(L);if((!bc||Array.contains(bc,0))&&!jd.lE(L)){if(!this.PQc&&this.Sfd){if(Kd.instance.xk())Kd.instance.xk().onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");
}this.Wg.AUa&&this.r8&&this.r8.initialize();if(sf.HTb(L.Ij)&&(bc=sf.tCf(L.Ij),0<bc.results.length)){bc.displayName="Classifier Debug";Ic.Hs(bc);qa.gr(Ic);return}bc=L?this.ENe=L.Ij:this.ENe;if(R.AFrameworkApplication.fa.la("TellMeParameterizedQueriesEnabled")){bc=this.VQi(bc);var td=this.fyc(bc.lLd());bc=bc.JAf()}else bc=this.UQi(bc),td=this.BFi(bc),bc=[];sf.Fob(td,!1,"Classifier","TFIDF");td=sf.bZa(L,td,this.Wg,this.r8,this.nsa,bc,0,1);0<td.results.length&&Fb!==vc.contextMenu&&(td.displayName=Object(mc.a)("TellMeCommandProviderTitle"));
Va||td.results.length||this.Wg.aKa||this.Wg.dBa||(L=new Fd("lookupNoResults",14,L.Ij,null,1),td.mt(L));0<td.results.length&&Ic.Hs(td);Ic.attributes=bc}qa.gr(Ic)}lLd(){let L=[];try{L=this.PQc.iDi()}catch(qa){if(Kd.instance.xk())Kd.instance.xk().onError("GetPredictions","Exception: "+qa)}return L}UQi(L){let qa=[];try{qa=this.PQc.jDi(L)}catch(Va){if(Kd.instance.xk())Kd.instance.xk().onError("GetPredictionsWithScore","Exception: "+Va)}return qa}VQi(L){try{return this.PQc.kDi(L,this.Zdh)}catch(qa){if(Kd.instance.xk())Kd.instance.xk().onError("GetPredictionsWithTokenAttributes",
"Exception: "+qa)}return new nh([],[])}fyc(L){const qa=[];if(L)for(const Va of L)qa.push(new Vd(Va,-99999));return qa}BFi(L){const qa=[];if(L)for(const Va of L)qa.push(new Vd(Va.prediction,Va.score));return qa}}Object(m.a)(Mf,"CommandResultsProvider",null,[552]);class Df extends Fd{constructor(L,qa,Va,Fb,bc){super(L,qa,void 0===bc?null:bc,null,Va);this.id=Fb}}Object(m.a)(Df,"TryQueryResultBinding",Fd,[]);class Of{constructor(L,qa,Va,Fb){this.lda=L;this.HEa=qa;this.LWe=Fb;this.Mhh=Va;this.Wg=Kd.instance.eE()}hE(){return"EmptyQuery"}iK(){return 1===
this.Wg.Ir?1:0}nC(L,qa,Va,Fb,bc){Va=void 0===Va?!1:Va;bc=void 0===bc?null:bc;Fb=new dc(L);if((!bc||Array.contains(bc,5)||Array.contains(bc,6)||Array.contains(bc,4))&&jd.lE(L)){this.lda.HIa().length||!this.Mhh||this.LWe||(L=new le(6),bc=new Fd(null,13,void 0,void 0,1),L.mt(bc),Fb.Hs(L));L=new le(4);if(0<this.lda.HIa().length){L.displayName=Object(mc.a)("TellMeRecentlyUsedTitle");bc=this.lda.HIa();var Ic=[];for(var td of bc)Ic.push(td.Id);Ge.Z0c(Ic,this.Wg);for(var Hd of bc)Ge.faa(Hd.Id)&&L.mt(new Fd(Hd.Id,
5,null,null,2));Fb.Hs(L)}if(this.LWe&&0<this.HEa.length&&this.lda.HIa().length<Of.K9f){td=new le(5);td.displayName=Object(mc.a)("TellMeTryQueryTitle");Hd=Of.K9f-L.results.length;L=[];for(bc=0;bc<this.HEa.length&&bc<Hd;++bc){if(Va){Ic=jd.Eve+(bc+1);const pe=this.HEa[bc].key,Ke=ba.a.replaceAll(pe,'"',"");L.push(appChrome.actions.setControlLabel(Ic,pe));L.push(appChrome.actions.setButtonCommandValueId(Ic,Ke));Ic=new Df(pe,7,0,Ke,Ic)}else Ic=new Df(this.HEa[bc].key,7,0,this.HEa[bc].value);td.mt(Ic)}0<
L.length&&appChrome.api.dispatch(L);Fb.Hs(td)}}qa.gr(Fb)}}Of.K9f=5;Object(m.a)(Of,"EmptyQueryResultsProvider",null,[552]);class ig{constructor(L){this.Wg=L}hE(){return"Feedback"}iK(){return 0===this.Wg.Ir?0:1===this.Wg.Ir?1:2}nC(L,qa,Va,Fb,bc){bc=void 0===bc?null:bc;L=new dc(L);if(!bc||Array.contains(bc,21))bc=[],bc.push(appChrome.actions.setControlLabel("TellMeFeedback",Object(mc.a)("TellMeFeedbackText"))),appChrome.api.dispatch(bc),bc=new le(22),bc.displayName="",bc.mt(new Fd("TellMeFeedback",23,
null,null,1)),L.Hs(bc);qa.gr(L)}}Object(m.a)(ig,"FeedbackResultsProvider",null,[552]);class Ag{constructor(L,qa,Va,Fb){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=L;this.CommandId=qa;this.CommandValueId=Va;this.InputText=Fb}}Object(m.a)(Ag,"FindInDocumentProp",null,[]);class ng{constructor(L){this.rdd=2;this.BSa=[];this.VDa=[];this.Wg=L;ng.wfa=L.Rwf;ng.Twf="FindInDocumentSuggestion";ng.rrg="FindInDocumentSuggestion3";this.Ykh=Object.assign(new Yd,{landingTab:"Indoc",
data:null});this.Uoh=this.Wg.Dvb||!!R.AFrameworkApplication.ra&&R.AFrameworkApplication.ra.$d.Dvb}hE(){return"FindInDocument"}iK(){return 0===this.Wg.Ir?0:1===this.Wg.Ir?1:3===this.Wg.Ir?this.Wg.oTg?2:3:2}nC(L,qa,Va,Fb,bc){Va=void 0===Va?!1:Va;bc=void 0===bc?null:bc;const Ic=new dc(L);if(bc&&!Array.contains(bc,2))qa.gr(Ic);else if(Array.clear(this.BSa),jd.lE(L)){if(Va&&this.kQg()){Va=new le(2);Va.displayName=Object(mc.a)("TellMeFindInDocProviderTitle");bc=1;Fb="";if(0<this.VDa.length&&!this.Wg.Fvb)for(var td of this.VDa)if(""!==
td.Label.toLowerCase()){if(bc>=this.rdd)break;this.q3g(Va,td.Label,td.CommandValueId,ng.Twf+bc,td.InputText);bc++}td="";this.Wg.KH?(Ic.Hs(Va),Va=new le(3),td=this.Wg.CFa?jd.zIa(Object(mc.a)("TellMeOpenFindPaneTextV2Bolded")):Object(mc.a)("TellMeOpenFindPaneTextV2")):td=Object(mc.a)("TellMeOpenFindPaneText");Fb=this.sCf("");this.q3g(Va,td,Fb,ng.rrg,"");Ic.Hs(Va)}qa.gr(Ic)}else td="",Va&&(Va=this.sCf(L.Ij),Fb=[],this.Wg.QKa?(this.Wg.Hpe&&Fb.push(appChrome.actions.setControlIconSet(ng.wfa,{"default":"FindInDocument_20"})),
td=this.Wg.oXd?jd.wJd(L.Ij,Object(mc.a)("FindInDocumentScopedButtonText")):L.Ij+Object(mc.a)("FindInDocumentScopedButtonText")):this.Wg.KH?(td=this.Wg.CFa?jd.zIa(String.format(Object(mc.a)("FindInDocumentScopedButtonTextV2Bolded"),L.Ij)):String.format(Object(mc.a)("FindInDocumentScopedButtonTextV2"),L.Ij),Fb.push(appChrome.actions.setControlIconSet(ng.wfa,{"default":"FindInDocument_20"}))):td=this.Wg.Fvb?Object(mc.a)("TellMeOpenFindPaneText"):String.format(Object(mc.a)("TextWithQuotation"),L.Ij),
this.Wg.R$?(Kd.instance.actions.push(appChrome.actions.setControlLabel(ng.wfa,td)),Kd.instance.actions.push(appChrome.actions.setButtonCommandValueId(ng.wfa,Va))):(Fb.push(appChrome.actions.setControlLabel(ng.wfa,td)),Fb.push(appChrome.actions.setButtonCommandValueId(ng.wfa,Va)),appChrome.api.dispatch(Fb)),this.xMg(td,ng.wfa,Va,L.Ij)),this.Wg.oTg?(td=new Fd(ng.wfa,8,L.Ij),Va=new le(2),Va.displayName=Object(mc.a)("TellMeFindInDocProviderTitle"),Va.mt(td),Ic.Hs(Va),qa.gr(Ic)):this.Wg.CJi().then(Hd=>
{const pe=new Fd(ng.wfa,8,L.Ij,null,1);pe.count=Hd;Hd=new le(2);Hd.displayName=Object(mc.a)("TellMeFindInDocProviderTitle");Hd.mt(pe);Ic.Hs(Hd);qa.gr(Ic)},Hd=>{Kd.instance.xk().onError("FindInDocumentResultsProvider:issueQuery","Find manager promise rejected: "+Hd);Hd=new Fd(ng.wfa,8,L.Ij,null,1);const pe=new le(2);pe.displayName=Object(mc.a)("TellMeFindInDocProviderTitle");pe.mt(Hd);Ic.Hs(pe);qa.gr(Ic)})}kQg(){return!!this.Wg&&this.Wg.uXc}q3g(L,qa,Va,Fb,bc){bc=void 0===bc?null:bc;var Ic=void 0===
Ic?null:Ic;var td=void 0===td?-99999:td;const Hd=[];qa&&Hd.push(appChrome.actions.setControlLabel(Fb,qa));this.Wg.KH&&Hd.push(appChrome.actions.setControlIconSet(Fb,{"default":"FindInDocument_20"}));Hd.push(appChrome.actions.setButtonCommandValueId(Fb,Va));appChrome.api.dispatch(Hd);this.xMg(qa,Fb,Va,"");L.mt(new Fd(Fb,8,bc,Ic,1,td))}sCf(L){return this.Uoh?jd.Oua(L,15,this.Ykh):ba.a.Yl(L)}xMg(L,qa,Va,Fb){this.kQg()&&this.BSa.length<this.rdd&&(L=new Ag(L,qa,Va,Fb),Array.add(this.BSa,L))}tBk(L){for(let qa=
0;qa<this.BSa.length;qa++)if(this.BSa[qa].CommandId===L){const Va=this.BSa[qa].Label;let Fb=!1;if(0<this.VDa.length){let bc=0;for(const Ic of this.VDa){if(Ic.Label===Va){Array.removeAt(this.VDa,bc);Fb=!0;break}bc++}}!Fb&&this.VDa.length>=this.rdd-1&&Array.removeAt(this.VDa,1);Array.insert(this.VDa,0,this.BSa[qa])}}}ng.wfa=null;ng.Twf=null;ng.rrg=null;Object(m.a)(ng,"FindInDocumentResultsProvider",null,[552]);class xg{constructor(L){this.Wg=L}hE(){return"Image"}iK(){return 0===this.Wg.Ir?0:1===this.Wg.Ir?
1:3===this.Wg.Ir?3:2}nC(L,qa,Va,Fb,bc){bc=void 0===bc?null:bc;Va=new dc(L);(!bc||Array.contains(bc,19))&&jd.lE(L)&&this.Wg.KH&&this.AJa(L,Va,1);qa.gr(Va)}AJa(L,qa,Va,Fb){Fb=void 0===Fb?null:Fb;var bc=[];let Ic;Kd.instance.eE()&&Kd.instance.eE().QKa?(Ic=this.Wg.oXd?jd.wJd(L.Ij,Object(mc.a)("TellMeImageSuggestionScopedButtonTextNoHeader")):L.Ij+Object(mc.a)("TellMeImageSuggestionScopedButtonTextNoHeader"),this.Wg.Hpe||bc.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):
Ic=this.Wg.KH?jd.lE(L)?this.Wg.CFa?jd.zIa(Object(mc.a)("TellMeImageSuggestionButtonTextV2Bolded")):Object(mc.a)("TellMeImageSuggestionButtonTextV2"):this.Wg.CFa?jd.zIa(String.format(Object(mc.a)("TellMeScopedImageSuggestionButtonTextBolded"),L.Ij)):String.format(Object(mc.a)("TellMeScopedImageSuggestionButtonText"),L.Ij):this.Wg.Fvb?Object(mc.a)("TellMeImageSuggestionButtonText"):L.Ij+Object(mc.a)("TellMeImageSuggestionScopedButtonTextWithHeader");this.Wg.R$?(Kd.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",
Ic)),bc=jd.Oua(L.Ij,9,Object.assign(new Yd,{landingTab:"Image"})),Kd.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",bc))):(bc.push(appChrome.actions.setControlLabel("ImageForSearch",Ic)),L=jd.Oua(L.Ij,9,Object.assign(new Yd,{landingTab:"Image"})),bc.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",L)),appChrome.api.dispatch(bc));Va=new Fd("ImageForSearch",12,null,null,Va);Fb&&(Va.score=Fb.ConfidenceScore);Fb=new le(19,this.Wg.Fvb?Object(mc.a)("TellMeImageTitleV2"):
Object(mc.a)("TellMeImageTitle"));Fb.mt(Va);qa.Hs(Fb)}}Object(m.a)(xg,"ImageResultsProvider",null,[552]);class Pf{constructor(L){this.Wg=L}hE(){return"Insights"}iK(){return 0===this.Wg.Ir?0:1===this.Wg.Ir?1:2}nC(L,qa,Va,Fb,bc){Va=void 0===Va?!1:Va;bc=void 0===bc?null:bc;Fb=new dc(L);if(!bc||Array.contains(bc,13))if(this.rJk()||!jd.lE(L)){bc=new le(13);var Ic=""===L.Ij.trim(),td=Ic?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",Hd=new Fd(td,10,L.Ij,null,1);Va&&(Va=null,jd.Z5()?Ic?Ic=Object(mc.a)("SeeMoreOpenSearchPaneLabel"):
(Ic=this.Wg.Fvb?Object(mc.a)("SeeMoreResultsButtonTextNonParameteriedV2"):String.format(Object(mc.a)("SeeMoreResultsButtonText"),L.Ij),Va=jd.Oua(L.Ij,1)):(Ic=String.format(Object(mc.a)("InsightsButtonText"),L.Ij),Va=jd.rxd(L.Ij)),this.Wg.R$?(Kd.instance.actions.push(appChrome.actions.setControlLabel(td,Ic)),Va&&Kd.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",Va))):(L=[],L.push(appChrome.actions.setControlLabel(td,Ic)),Va&&L.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",
Va)),appChrome.api.dispatch(L)),Hd.label=Ic);bc.mt(Hd);Fb.Hs(bc)}qa.gr(Fb)}rJk(){return jd.Z5()&&this.Wg.RUk&&!this.Wg.O_}}Object(m.a)(Pf,"InsightsResultsProvider",null,[552]);class ca{constructor(L){this.Wg=L}hE(){return"Learning"}iK(){return 0===this.Wg.Ir?0:1===this.Wg.Ir?1:2}nC(L,qa,Va,Fb,bc){bc=void 0===bc?null:bc;Va=new dc(L);bc&&!Array.contains(bc,21)||!jd.lE(L)||(bc=[],Fb=this.Wg.Ztj,bc.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",Fb)),Fb=ca.mKi(Fb),bc.push(appChrome.actions.setControlLabel("LearningForSearch",
Fb)),appChrome.api.dispatch(bc),L=new Fd("LearningForSearch",22,L.Ij,null,1),bc=new le(21),bc.mt(L),Va.Hs(bc));qa.gr(Va)}static mKi(L){const qa=[];Array.add(qa,new vb(600,Object(mc.a)("TellMeLearningButtonTipText")));Array.add(qa,new vb(400,Object(mc.a)("TellMeLearningButtonText")));Array.add(qa,new vb(600,L));Array.add(qa,new vb(400,Object(mc.a)("TellMeLearningButtonPunctuation")));L={};L.parts=qa;return JSON.stringify(L)}}Object(m.a)(ca,"LearningProvider",null,[552]);var cb=a(522);class tc{constructor(L,
qa){this.nab=this.dcb=this.iEa=this.rfc=null;this.wL=!1;this.Kab=L;this.fgh=qa;L&&this.Ivf(L)}f0c(){this.Kab.f0c()&&this.Ivf(this.Kab)}IVi(L){let qa=[];var Va=[];L=tc.lHj(L);var Fb="";Array.clear(Va);for(let bc=0;bc<L.length;bc++){const Ic=L.charAt(bc);-1!==" ".indexOf(Ic)?(Fb.length&&Array.add(Va,Fb),Fb=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(Ic)?(Fb.length&&Array.add(Va,Fb),Fb=Ic,Array.add(Va,Fb),Fb=""):Fb+=Ic}Fb.length&&Array.add(Va,Fb);for(L=0;L<Va.length;L++)Fb=this.AFi(Va[L]),Fb=
this.YZh(Fb),qa=tc.IDj(qa,Fb);return qa=this.Dvh(qa)}Fmb(){this.wL||this.f0c();return this.wL}Zrc(L){return this.rfc[L.toString()]}Dvh(L){for(let qa=0;qa<L.length;qa++){const Va=this.iEa[qa];if(L[qa].commandId!==this.Zrc(Va[0]))throw Error.create("Incorrect Tcid orders with Priors data");let Fb;(Fb=L[qa]).score=Fb.score+Va[1]}return L}YZh(L){const qa=[];for(var Va=0;Va<this.iEa.length;Va++)qa.push(new Vd(this.Zrc(this.iEa[Va][0]),-5));Va=new cb.a;for(var Fb=0;Fb<L.length;Fb++)Va.add(this.Zrc(L[Fb][0]));
for(Fb=0;Fb<qa.length;Fb++){const Ic=qa[Fb];for(let td=0;td<L.length;td++){var bc=L[td];const Hd=this.Zrc(bc[0]);bc=bc[1];if(Hd===Ic.commandId){Ic.score=bc;Va.remove(Hd);break}}if(!Va.count)break}return qa}AFi(L){const qa=1>L.length;for(let td=0;2>=td;td++){const Hd=this.nab;for(const pe in Hd){var Va=Hd[pe],Fb=L,bc=pe;const Ke=bc.length+1,uf=Array((Fb.length+1)*Ke);for(var Ic=0;Ic<=Fb.length;Ic++)uf[Ic*Ke]=Ic;for(Ic=0;Ic<=bc.length;Ic++)uf[Ic]=Ic;for(Ic=0;Ic<bc.length;Ic++)for(let zf=0;zf<Fb.length;zf++)uf[(zf+
1)*Ke+(Ic+1)]=Fb.charAt(zf)===bc.charAt(Ic)?uf[zf*Ke+Ic]:Math.min(Math.min(uf[zf*Ke+(Ic+1)]+1,uf[(zf+1)*Ke+Ic]+1),uf[zf*Ke+Ic]+1);Fb=uf[Fb.length*Ke+bc.length];if((!Fb||!qa)&&Fb<=td)return Va}}return this.dcb}Ivf(L){this.rfc=L.yKd();this.iEa=L.uRi();this.dcb=L.tXi();this.nab=L.DMi();if(this.wL=!!this.rfc&&!!this.iEa&&!!this.nab&&!!this.dcb)this.wL=0<this.iEa.length&&tc.hSd(this.iEa);this.wL&&(this.wL=0<this.dcb.length&&tc.hSd(this.dcb));this.wL&&(this.nab=tc.cYi(this.nab));this.wL||(this.nab=this.dcb=
this.iEa=this.rfc=null)}$Wi(L){L=this.IVi(L);return this.Pti(L,this.fgh)}Pti(L,qa){let Va=[];for(let Fb=0;Fb<L.length;Fb++)L[Fb].score>=qa&&Va.push(L[Fb]);Va.sort((Fb,bc)=>Fb.score<bc.score?1:Fb.score>bc.score?-1:0);0<Va.length-10&&(Va=Va.slice(0,10));return Va}static IDj(L,qa){if(!L.length)return qa;if(L.length!==qa.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");for(let Va=0;Va<L.length;Va++){if(L[Va].commandId!==qa[Va].commandId)throw Error.create("Incorrect CommandId");
let Fb;(Fb=L[Va]).score=Fb.score+qa[Va].score}return L}static lHj(L){return ba.a.Rr(L)}static hSd(L){for(let qa=0;qa<L.length;qa++)if(2!==L[qa].length)return!1;return!0}static cYi(L){const qa={};for(const bc in L){var Va=bc,Fb=L[bc];const Ic=Fb;Ic.length&&tc.hSd(Ic)&&(qa[Va]=Fb)}return qa}}Object(m.a)(tc,"NaiveBayesClassifierModel",null,[]);class Kc{constructor(L,qa){this.r8=null;this.Wg=L;this.FCb=new tc(qa,L.iGf);this.Wg.AUa&&(this.r8=null)}hE(){return"NBCommand"}iK(){return 0===this.Wg.Ir?0:1===
this.Wg.Ir?1:2}nC(L,qa,Va,Fb,bc){Va=void 0===Va?!1:Va;Fb=void 0===Fb?vc.tellMe:Fb;bc=void 0===bc?null:bc;const Ic=new dc(L);if((!bc||Array.contains(bc,0))&&!jd.lE(L)){if(sf.HTb(L.Ij)&&(bc=sf.tCf(L.Ij),0<bc.results.length)){bc.displayName="Classifier Debug";Ic.Hs(bc);qa.gr(Ic);return}if(!this.FCb.Fmb()){if(Kd.instance.xk())Kd.instance.xk().onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.Wg.AUa&&
this.r8&&this.r8.initialize();bc=this.FCb.$Wi(L.Ij);sf.Fob(bc,!1,"Classifier","NaiveBayesian");bc=sf.bZa(L,bc,this.Wg,this.r8,null,null,0,1);0<bc.results.length&&Fb!==vc.contextMenu&&(bc.displayName=Object(mc.a)("TellMeCommandProviderTitle"));Va||bc.results.length||this.Wg.aKa||this.Wg.dBa||(L=new Fd("lookupNoResults",14,L.Ij,null,1),bc.mt(L));0<bc.results.length&&Ic.Hs(bc)}qa.gr(Ic)}}Object(m.a)(Kc,"NaiveBayesCommandProvider",null,[552]);class Xd{constructor(){this.zSa=null;this.wL=!1;this.f0c()}f0c(){this.wL||
(this.zSa=window.NBCRM)&&4===this.zSa.length&&(this.wL=!0);return this.wL}uRi(){return this.wL?this.zSa[1]:null}tXi(){return this.wL?this.zSa[2]:null}DMi(){return this.wL?this.zSa[3][0]:null}yKd(){return this.wL?this.zSa[0][0]:null}}Object(m.a)(Xd,"NaiveBayesModelAdapter",null,[644]);var qe=a(124);class rf{constructor(L){this.Wg=L}hE(){return"OfficeScript"}iK(){return 0===this.Wg.Ir?0:1===this.Wg.Ir?1:2}nC(L,qa){const Va=new dc(L);if(!jd.lE(L)){L=qe.d(L.Ij);var Fb=new le(28);Fb.displayName=Object(mc.a)("TellMeOfficeScriptsTitle");
Fb=this.bkc(L,rf.m1k,"OfficeScriptsUnhideAllRowsCols","samples-11",Object(mc.a)("TellMeUnhideAllRowsColsTitle"),Fb);Fb=this.bkc(L,rf.lyi,"OfficeScriptsFreezeSelection","samples-12",Object(mc.a)("TellMeFreezeSelectionTitle"),Fb);Va.Hs(Fb)}qa.gr(Va)}bkc(L,qa,Va,Fb,bc,Ic){const td=[];for(const Hd of qa)if(qe.a(L,Hd)){this.Wg.R$?(Kd.instance.actions.push(appChrome.actions.setControlLabel(Va,bc)),Kd.instance.actions.push(appChrome.actions.setButtonCommandValueId(Va,Fb))):(td.push(appChrome.actions.setControlLabel(Va,
bc)),td.push(appChrome.actions.setButtonCommandValueId(Va,Fb)),appChrome.api.dispatch(td));Ic.mt(new Fd(Va,28,null,null,1));break}return Ic}}rf.m1k="unhide row rows col cols column columns".split(" ");rf.lyi=["freeze","selection","pane","panes"];Object(m.a)(rf,"OfficeScriptsSamplesProvider",null,[552]);var Af=a(208);class gg{}gg.dna="HttpRequest";gg.provider="Provider";Object(m.a)(gg,"LatencyTypes",null,[]);var mg;(function(L){L[L.Tcl=0]="Classifier";L[L.Fcl=1]="AppsForOffice";L[L.$9g=2]="FindInDocument";
L[L.bel=3]="FindInDocumentScopedSearch";L[L.Afl=4]="RecentlyUsed";L[L.Cbh=5]="TryQuery";L[L.Empty=6]="Empty";L[L.pgl=7]="TryCommand";L[L.g8g=8]="Assistance";L[L.d8g=9]="Answer";L[L.E9g=10]="Definition";L[L.O9g=11]="Entity";L[L.Cch=12]="WolframAnswer";L[L.A$g=13]="Insights";L[L.People=14]="People";L[L.Document=15]="Document";L[L.Bfl=16]="Recommended";L[L.Ufl=17]="ServiceClassifier";L[L.Vfl=18]="ServiceRecommended";L[L.Image=19]="Image";L[L.Notes=20]="Notes";L[L.I$g=21]="Learning";L[L.Feedback=22]=
"Feedback";L[L.Abh=23]="Template";L[L.X7g=24]="ActionAI";L[L.Y7g=25]="ActionAICommand";L[L.mbh=26]="SummarizeDeck";L[L.a8g=27]="Addin";L[L.$$g=28]="OfficeScript";L[L.c8g=29]="AddinStoreEntry";L[L.Formula=30]="Formula";L[L.None=31]="None";L[L.Tel=32]="MergedActions";L[L.Uel=33]="MergedScopedSearches";L[L.Vel=34]="MergedSuggestedSearches"})(mg||(mg={}));Object(m.b)("ResultGroupType",mg);class og{}og.tellMe="TellMe";og.Rzj="Loki";og.QVg="Substrate";og.vsb="QueryIndex";og.mXg="TellMeRanker";og.nXg="TellMeRankerLogging";
Object(m.a)(og,"Services",null,[]);var ph=a(188);class Yg{constructor(L){this.bI=null;this.eQ=-1;this.P2d=14;this.R2d=12;this.attributes=this.Ejd=this.query=null;this.Qmb=!1;this.nbb=[];this.vn=R.AFrameworkApplication.$i;R.AFrameworkApplication.fa&&(this.P2d=R.AFrameworkApplication.fa.vj("TellMeMaxTermedResults",this.P2d),this.R2d=R.AFrameworkApplication.fa.vj("TellMeMaxZeroTermResults",this.R2d));this.QI=L}get lo(){return this.nbb}get w0c(){return this.Ejd}Hs(L){let qa=!1;for(let Va=0;Va<this.lo.length;Va++)if(31!==
this.lo[Va].groupType&&this.lo[Va].groupType===L.groupType){this.Yld(this.lo[Va],L);qa=!0;break}qa||this.lo.push(L)}Yld(L,qa){for(let Va=0;Va<qa.results.length;Va++)L.mt(qa.results[Va])}aBg(L){const qa=[];for(const Va of this.lo)Va.groupType!==L&&qa.push(Va);this.lo.length!==qa.length&&(this.nbb=qa)}khk(L){let qa=null,Va=null,Fb=null;for(let bc=0;bc<L.length;bc++){const Ic=L[bc];if(Ic&&Ic.lo&&Ic.lo.length)for(const td of Ic.lo)if(17===td.groupType||18===td.groupType)qa=td;else if(0===td.groupType||
16===td.groupType)Va=td,Fb=Ic}qa&&Va&&0<Va.results.length&&(17===qa.groupType&&({Gld:Va,dmd:qa}=Ge.Hld(Va,qa,this.QI.eE()?this.QI.eE().bFi:-.6)),Fb.aBg(Va.groupType))}KPk(){this.QI&&(new Af.a,this.y7b(this.QI.u8f))}TVb(L,qa){return this.query.Ij.length>this.QI.eE().FRi&&this.Nmj(L,qa)||this.query.Ij.length>this.QI.eE().GRi&&this.ypj(L,qa)?!0:!1}ypj(L,qa){return L&&L.length&&qa&&qa.length?-1===qa.toLowerCase().indexOf(L.toLowerCase())?!1:!0:!1}Nmj(L,qa){return L&&L.length&&qa&&qa.length?qa.toLowerCase().startsWith(L.toLowerCase()):
!1}Yti(L){const qa=[];for(const Va of this.QI.eE().KH?this.w0c:this.lo)L.contains(Va.groupType)||qa.push(Va);this.QI.eE().KH?this.Ejd=qa:this.nbb=qa}t6k(L,qa){const Va=[];for(const Fb of this.lo){const bc=Fb;if(13!==bc.groupType||24!==bc.groupType){const Ic=L[mg[bc.groupType].toLowerCase()];let td="False";Ic<qa&&(td="True");bc.displayName=bc.displayName+" ("+td+": "+Ic+")"}Va.push(bc)}this.nbb=Va}y7b(L,qa,Va){qa=void 0===qa?!1:qa;Va=void 0===Va?null:Va;if(this.QI.eE().KH){if(!qa)for(this.Ejd=Array(this.lo.length),
qa=0;qa<this.lo.length;qa++)this.w0c[qa]=this.lo[qa];this.QI.F8f.y7b(this.lo,this.w0c,this.query,L,Va)}else{for(Va=new Af.a;this.lo.length;){qa=this.lo.pop();const Fb=mg[qa.groupType].toLowerCase(),bc=L[Fb];if(la.c(bc))throw Error.create("GroupId "+Fb+" missed from group SortingOrder");Va.add(new Uc.a(bc,qa))}Va.Sc((Fb,bc)=>Fb.key<bc.key?-1:1);for(L=0;L<Va.count;L++)qa=Va.ma(L).value,this.lo.push(qa)}}LPk(){var L=!1;let qa=!1,Va=!1;for(let bc=0;bc<this.lo.length;bc++){var Fb=this.lo[bc];const Ic=
Fb.groupType;if(8===Ic||15===Ic||14===Ic){Fb=Fb.results;for(let td=0;td<Fb.length;td++){if(8===Ic&&this.TVb(this.query.Ij,Fb[td].label)){L=!0;break}if(15===Ic&&this.TVb(this.query.Ij,Fb[td].label)){qa=!0;break}if(14===Ic){if(this.TVb(this.query.Ij,Fb[td].label)||this.TVb(this.query.Ij,Fb[td].description)){Va=!0;break}const Hd=Fb[td].label.split(" ");for(const pe of Hd)if(this.TVb(this.query.Ij,pe)){Va=!0;break}}}}}L=this.QI.kTi(L,qa,Va);this.y7b(L)}t3a(L,qa,Va,Fb,bc,Ic){if(bc===this.bI){var td=L.data.responseData;
bc=null;try{bc=qc.b(td)}catch(Gg){Kd.instance.xk().onError("OnSuccessCallBack","Exception occured while deserializing ranker inference response:"+Gg);return}if("RankerResults"in bc&&bc.RankerResults){this.Bea();var Hd=bc.RankerResults,pe=new Af.a,Ke=new Af.a;td=0;for(var uf of Hd){Hd=uf.ProviderId;var zf=uf.Score;td+=zf;pe.add(new Uc.a(Hd,zf))}pe.Sc((ah,Qg)=>ah.value>Qg.value?-1:1);zf=Ic?Ic.eUi:1E-6;uf={};Hd={};let Gg=0;for(var bg=0;bg<pe.count;bg++){const ah=parseInt(pe.ma(bg).key),Qg=pe.ma(bg).value/
td;1===ah&&(Hd.answer=Gg++,Hd.entity=Gg++,Hd.definition=Gg++,Hd.wolframanswer=Gg++,Qg<zf&&(Ke.add(9),Ke.add(11),Ke.add(10),Ke.add(12)),uf.answer=Qg,uf.entity=Qg,uf.definition=Qg,uf.wolframanswer=Qg);2===ah&&(Hd.assistance=Gg++,Qg<zf&&Ke.add(8),uf.assistance=Qg);3===ah&&(Hd.classifier=Gg++,Hd.serviceclassifier=Gg++,Qg<zf&&(Ke.add(0),Ke.add(17)),uf.classifier=Qg,uf.serviceclassifier=Qg);4===ah&&(Hd.people=Gg++,Qg<zf&&Ke.add(14),uf.people=Qg);5===ah&&(Hd.document=Gg++,Qg<zf&&Ke.add(15),uf.document=Qg);
6===ah&&(Hd.findindocument=Gg++,Qg<zf&&Ke.add(2),uf.findindocument=Qg);7===ah&&(Hd.notes=Gg++,Qg<zf&&Ke.add(20),uf.notes=Qg);8===ah&&(Hd.image=Gg++,Qg<zf&&Ke.add(19),uf.image=Qg)}pe=new Af.a;pe.add("classifier");pe.add("serviceclassifier");pe.add("appsforoffice");pe.add("addin");pe.add("findindocument");pe.add("assistance");pe.add("document");pe.add("people");pe.add("answer");pe.add("wolframanswer");pe.add("definition");pe.add("entity");pe.add("image");pe.add("template");pe.add("officescript");pe.add("formula");
for(bg=0;bg<pe.count;bg++)pe.ma(bg)in Hd||(Hd[pe.ma(bg)]=Gg++);Hd.learning=Gg++;Hd.insights=Gg++;Hd.actionai=Gg++;Hd.actionaicommand=Gg++;Hd.feedback=Gg++;Ic&&Ic.slj&&this.t6k(uf,zf);Ic&&Ic.tlj&&this.Yti(Ke);Ke={};for(var kg in uf)Ke[kg]=uf[kg]*td;this.y7b(Hd,!0,Ke)}if(Ic.PWd&&"Intents"in bc&&bc.Intents){kg=bc.Intents;for(var ug of kg)if(this.VXd(ug)&&"Serplet"===ug.GroupType&&ug.ConfidenceScore>ug.ConfidenceThreshold){kg=!1;bc=0;if(Ic.QWd){td=new Fd("",33);for(Ke=0;Ke<this.lo.length;Ke++)if((pe=
this.lo[Ke].results)&&0<pe.length){bc=Ke;td=pe[0];break}2===td.groupType&&(kg=!0)}td=new le(13);kg&&Ic.QWd&&(td=new le(13,Object(mc.a)("TellMeWebTitle")));Ke=new Fd("SmartLookupFromTellMeQueryTermAtTop",10,this.query.Ij,null,0);pe=[];uf=null;uf=jd.Z5()?jd.Oua(this.query.Ij,1):jd.rxd(this.query.Ij);pe.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",uf));uf=String.format(Object(mc.a)("SeeMoreResultsButtonTextAtTop"),this.query.Ij);pe.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",
uf));appChrome.api.dispatch(pe);td.mt(Ke);Ke=[];if(kg&&Ic.QWd)for(Ke.push(this.lo[bc]),Ke.push(td),kg=bc+1;kg<this.lo.length;kg++)(bc=this.lo[kg].results)&&0<bc.length&&Ke.push(this.lo[kg]);else for(Ke.push(td),kg=0;kg<this.lo.length;kg++)(bc=this.lo[kg].results)&&0<bc.length&&Ke.push(this.lo[kg]);this.nbb=Ke}}if(Ic.ZVb&&!Ic.KH){ug=kg=-1;for(bc=0;bc<this.lo.length;bc++)switch(this.lo[bc].groupType){case 23:kg=bc;break;case 0:case 17:case 2:-1===ug&&(ug=bc)}if(-1!==kg){ug=-1===ug?0:kg>ug?ug+1:ug;kg=
this.lo[kg];bc=Array(this.lo.length);td=0;for(Ke=0;Ke<bc.length;Ke++)Ke===ug?bc[Ke]=kg:(23===this.lo[td].groupType&&td++,bc[Ke]=this.lo[td],td++);this.nbb=bc}}Fb.gr(this);Fb=Kd.instance.xk();Fb.dba(qa.length,"RankerInference",L.data.httpStatus.toString(),Math.round(window.performance.now()-Va),og.mXg,!0,gg.dna);this.Qmb&&Fb&&(L=this.query.kNa,qa=Fb.Vbc,Ic.CHc&&L>qa&&!Ic.KH&&(Fb.G0d(this.query.Ij),Fb.hme(L)))}}VXd(L){if("GroupType"in L&&L.GroupType&&"ConfidenceScore"in L&&"ConfidenceThreshold"in L)return!0;
Kd.instance.xk().onError("IsValidIntentGroup","Invalid intents found");return!1}e3a(L,qa,Va,Fb,bc){Fb===this.bI&&(this.Bea(),Kd.instance.xk().dba(qa.length,"RankerInference",L.data.httpStatus.toString(),Math.round(window.performance.now()-Va),og.mXg,!1,gg.dna));bc.gr(this)}Bea(){-1!==this.eQ&&(window.clearTimeout(this.eQ),this.eQ=-1)}MPk(L){let qa;qa=this.QI.eE().KH?Kd.instance.xk().lMd(this.w0c,this.query.Ij):Kd.instance.xk().lMd(this.lo,this.query.Ij);var Va=this.QI.eE().dUi;""!==Va&&(Va="_"+Va);
let Fb="";this.QI.eE().cVd&&(Fb="RankerInference"+Va+",");this.QI.eE().PWd&&(Fb+="SerpletClassifier");","===Fb.charAt(Fb.length-1)&&(Fb=Fb.substring(0,Fb.length-1));Va=Kd.instance.xk().EJf(Fb);const bc=this.bI=ph.a.create().toString();Va["Client-Request-Id"]=bc;const Ic=window.performance.now(),td=this.QI.eE()?this.QI.eE().fUi:600;this.Bea();this.eQ=window.setTimeout(()=>{if(bc===this.bI){this.bI="";this.eQ=-1;L.gr(this);const Hd={};Hd[Tc.provider]="Ranker";Hd[Tc.v4a]=this.query.kNa;Kd.instance.xk().bV(Bd.timedOut,
td,Hd)}},td);this.vn.Ou(Kd.instance.xk().FJf(),2,qa,Va,!1,0,Hd=>{this.t3a(Hd,this.query.Ij,Ic,L,bc,this.QI.eE())},Hd=>{this.e3a(Hd,this.query.Ij,Ic,bc,L)},null,null,!1,4E3,6E3)}XZk(){var L=0,qa=new Af.a,Va=this.QI.s8f,Fb=this.QI.t8f;for(var bc=0;bc<this.lo.length;bc++){var Ic=this.lo[bc],td=mg[Ic.groupType].toLowerCase(),Hd=Va[td];L+=Ic.results.length;Ic.results.length>Hd&&(td=Fb[td],la.c(td)||qa.add(new Uc.a(td,Ic)))}Fb=!this.query||""===this.query.Ij.trim();bc=L-(Fb?this.R2d:this.P2d);if(!(0>=bc)){Fb=
window.performance.now();L=L.toString()+" total,"+bc.toString()+" to remove.";if(0<qa.count)for(qa.Sc((pe,Ke)=>pe.key>Ke.key?-1:1),Ic=0;Ic<qa.count&&0<bc;Ic++){td=qa.ma(Ic).value;Hd=mg[td.groupType].toLowerCase();let pe=td.results.length-Va[Hd];pe>bc&&(pe=bc);0<pe&&(td.Jfe(pe),L+=Hd+": "+pe.toString()+" results removed.",bc-=pe)}if(0<bc){L+=bc.toString()+" results left after trimming.";qa=new Af.a;Va=this.QI.x8f;for(Ic=0;Ic<this.lo.length;Ic++)td=this.lo[Ic],Hd=Va[mg[td.groupType].toLowerCase()],
la.c(Hd)||qa.add(new Uc.a(Hd,td));qa.Sc((pe,Ke)=>pe.key<Ke.key?-1:1);for(Va=0;0<bc;)Ic=qa.ma(Va++).value,bc>=Ic.results.length?(Array.remove(this.lo,Ic),L+=mg[Ic.groupType]+": "+Ic.results.length.toString()+" results force removed.",bc-=Ic.results.length):(Ic.Jfe(bc),L+=mg[Ic.groupType]+": "+bc.toString()+" results force removed.",bc=0)}Kd.instance.xk()&&(qa={},qa[Tc.message]=L,Kd.instance.xk().bV("ShowOptimal",window.performance.now()-Fb,qa))}}}Object(m.a)(Yg,"CombineResultsUpdatedEventArgs",null,
[598]);class Qh{constructor(L,qa,Va,Fb,bc){this.bfd=this.rgd=!1;this.nN=L;this.ZSa=[];this.kSe=qa.length;this.Wg=Kd.instance.eE();this.xec=void 0===Fb?!1:Fb;this.IEa=void 0===bc?"":bc;this.Qbb={};for(L=0;L<qa.length;++L)this.Qbb[L.toString()]=Va?0:qa[L].iK()}DCk(L,qa){qa&&qa.query&&qa.query.kNa<Kd.instance.zrc()||(this.ZSa[L]=qa,this.bfd?this.rgd=!0:(!this.Wg||3!==this.Wg.Ir||3!==this.Qbb[L.toString()]||this.Nlf())&&this.gKa())}b2j(){this.bfd=!0}B1k(){this.bfd=!1;this.rgd&&(this.rgd=!1,this.gKa())}Nlf(){if(this.ZSa.length<
this.kSe)return!1;for(let L=0;L<this.kSe;++L)if(!this.ZSa[L])return!1;return!0}gKa(){var L=this.Nlf();const qa=window.performance.now(),Va=new Yg(Kd.instance.FJd());Va.khk(this.ZSa);for(var Fb=0;Fb<this.ZSa.length;++Fb){var bc=this.ZSa[Fb];if(bc&&bc.lo&&bc.lo.length&&(Va.query=bc.query,bc.attributes&&0<bc.attributes.length&&(Va.attributes=bc.attributes),bc&&bc.lo&&(L||this.GSh(Fb,this.ZSa))))for(const Ic of bc.lo)Va.Hs(Ic)}Va.lo&&Va.lo.length&&(Va.Qmb=L,this.Wg&&this.Wg.pve&&Va.XZk(),this.Wg&&this.Wg.goj&&
Va.query.Ij&&0<Va.query.Ij.length?Va.LPk():Va.KPk(),this.Wg&&(this.Wg.cVd||this.Wg.PWd)&&this.xec&&Va.query.Ij&&0<Va.query.Ij.length&&Va.Qmb&&this.IEa!==vc.contextMenu?(3===this.Wg.Ir&&L||this.nN.gr(Va),Va.MPk(this.nN)):this.nN.gr(Va),L=Kd.instance.xk(),Va.Qmb&&L&&(Fb=Va.query.kNa,bc=L.Vbc,Va.query.Ij&&0<Va.query.Ij.length&&this.xec&&this.Wg.CHc&&this.IEa!==vc.contextMenu&&Fb>bc&&!this.Wg.cVd&&!this.Wg.KH&&(L.G0d(Va.query.Ij),L.hme(Fb)),L.bV(Bd.oqk,window.performance.now()-qa)))}GSh(L,qa){if(!(this.Qbb&&
L.toString()in this.Qbb)||qa.length<=L||!qa[L])return!1;if(!qa[L].lo.length)return!0;const Va=this.Qbb[L.toString()];if(0===Va)return!0;const Fb=this.Qbb;for(const Ic in Fb){var bc=Fb[Ic];const td=Number.parseInvariant(Ic);if(td!==L&&bc===Va&&!(qa.length>td&&qa[td]))return!1}return!0}}Object(m.a)(Qh,"ResultsAggregator",null,[]);var Lh=a(674);class Xh{constructor(L,qa,Va,Fb,bc,Ic){this.lastModified=this.size=this.uniqueId=this.spWebUrl=this.url=this.fileType=null;this.fileType=L;this.url=qa;this.spWebUrl=
Va;this.uniqueId=Fb;this.size=bc;this.lastModified=Ic}}Object(m.a)(Xh,"FileInfo",null,[]);class xh{constructor(L,qa){this.DimensionValue=this.DimensionName=null;this.DimensionName=L;this.DimensionValue=qa}}Object(m.a)(xh,"Dimension",null,[]);class qh{constructor(L,qa,Va,Fb,bc){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=L;this.Query=qa;this.From=Va;this.Size=Fb;bc&&(this.Filter=bc)}}Object(m.a)(qh,"EntityRequest",null,[]);class Zh{constructor(L){this.QueryString=
null;this.QueryString=L}}Object(m.a)(Zh,"Query",null,[]);class $h{constructor(L,qa){this.Dimensions=this.Name=null;this.Name=L;this.Dimensions=qa}}Object(m.a)($h,"Scenario",null,[]);class hh{constructor(L,qa,Va,Fb){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=L;this.TimeZone=qa;this.Cvid=Va;this.Scenario=Fb}}Object(m.a)(hh,"SubstrateBody",null,[]);var Gh=a(1274),Mh=a(1275);class Bi{constructor(L){this.YCb=this.pEa=this.yfc=this.RAb=this.mDb=0;this.VPe=this.ARe=
this.bI=null;this.Dcd=0;this.eQ=-1;this.AEb="";this.R9c=!1;this.vn=R.AFrameworkApplication.$i;this.Wg=L;this.Zhc=this.nMd();this.dTa=new Lh.a;this.QOe=this.Wg.pve?3:2;this.Wid=this.Wg.pve&&this.Wg.KRg?5:3;this.okd=this.Wg.uXc?2:3;this.$Xe=1;this.ffc=this.Wg.IGf;this.pVe=this.Wg.dpj;this.MDb=L.bJf;R.AFrameworkApplication.fa&&(this.ARe=R.AFrameworkApplication.fa.Xa("AppCatalogUrl")+R.AFrameworkApplication.fa.Xa("SearchPersonaPhotoBaseUrl"),this.R9c=this.Wg.fuc||this.Wg.O_||this.Wg.juc);this.Wg.O_&&
(this.okd=this.Wid=5)}hE(){return"Substrate"}iK(){return 0===this.Wg.Ir?0:1===this.Wg.Ir?1:3}nC(L,qa,Va,Fb,bc){Fb=void 0===Fb?vc.tellMe:Fb;bc=void 0===bc?null:bc;const Ic=new dc(L);if(!bc||Array.contains(bc,14)||Array.contains(bc,15)||Array.contains(bc,20))if(!this.Dcd||window.performance.now()-this.Dcd>=jd.SYg)if(Va=this.dTa.rJf())this.Dcd=window.performance.now(),Va.then(td=>{td&&""!==td?(this.AEb=td,""!==this.bI&&this.qJf(L,Fb,this.AEb,qa,bc)):(Kd.instance.xk().onError("SubstrateResultsProvider:IssueQuery",
"Empty or null token returned"),qa.gr(Ic))},td=>{Kd.instance.xk().onError("SubstrateResultsProvider:IssueQuery","SubstrateTokenPromise rejected "+td);qa.gr(Ic)});else{if(Kd.instance.xk())Kd.instance.xk().onError("SubstrateResultsProvider:IssueQuery","undefined token promise");qa.gr(Ic)}else this.AEb&&""!==this.AEb?this.qJf(L,Fb,this.AEb,qa,bc):(qa.gr(Ic),Kd.instance.xk().onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else qa.gr(Ic)}YY(){this.pEa=this.YCb=this.yfc=this.RAb=
this.mDb=0}qJf(L,qa,Va,Fb,bc){this.YY();const Ic=new dc(L),td=this.bI=ph.a.create().toString();this.Bea();this.eQ=window.setTimeout(()=>{if(td===this.bI){this.bI="";this.eQ=-1;Fb.gr(Ic);const Ke={};Ke[Tc.provider]=this.hE();Ke[Tc.v4a]=L.kNa;Kd.instance.xk().bV(Bd.timedOut,this.MDb,Ke)}},this.MDb);const Hd={"Content-Type":"application/json",Accept:"application/json"};Hd.Authorization="Bearer "+Va;Hd["X-Office-Version"]=R.AFrameworkApplication.buildVersion;Hd["X-Office-Application"]=R.AFrameworkApplication.fa.Xa("Application");
Hd["X-Office-Platform"]="WAC";Hd["X-TellMe-SessionId"]=Kd.instance.ikb();Hd["X-TellMe-Culture"]=R.AFrameworkApplication.uiCulture;Hd["X-TellMe-ProcessSessionId"]=R.AFrameworkApplication.userSessionId;Hd["Client-Request-Id"]=td;const pe=window.performance.now();this.vn.Ou(this.CVi(),2,this.DVi(L.Ij,this.Wg.application,Kd.instance.ikb(),jd.lE(L)),Hd,!1,0,Ke=>{this.t3a(Ke,L,Fb,td,pe,qa,bc)},Ke=>{this.e3a(Ke,L,Fb,td,pe)},null,null,!1,4E3,6E3)}Bea(){-1!==this.eQ&&(window.clearTimeout(this.eQ),this.eQ=
-1)}t3a(L,qa,Va,Fb,bc,Ic,td){Kd.instance.xk().dba(qa.Ij.length,this.Zhc.join(","),L.data.httpStatus.toString(),Math.round(window.performance.now()-bc),og.QVg,!0,gg.dna);const Hd=jd.lE(qa),pe=new dc(qa);if(Fb===this.bI){this.Bea();L=qc.b(L.data.responseData);if(L.Groups){L=L.Groups;for(const Ke of L)"People"===Ke.Type&&this.Wg.q8b&&(td?Array.contains(td,14):1)?(L=this.eHf(Ke.Suggestions,Hd,Ic),0<L.results.length&&pe.Hs(L)):"File"===Ke.Type&&this.Wg.p8b&&(td?Array.contains(td,15):1)?(L=this.dJd(Ke.Suggestions,
Hd,Ic),0<L.results.length&&(this.zFc()&&(Fb=new Fd("GenerateSlidesFromTellMe",30,"",null,1),L.mt(Fb)),pe.Hs(L))):"Notes"===Ke.Type&&this.Wg.RKa&&Ic!==vc.contextMenu&&(td?Array.contains(td,20):1)&&(L=this.BGf(Ke.Suggestions,Hd,qa),0<L.results.length&&pe.Hs(L))}Va.gr(pe);Kd.instance.xk().dba(qa.Ij.length,this.Zhc.join(","),"",Math.round(window.performance.now()-bc),"",!0,gg.provider)}else Va.gr(pe)}BGf(L,qa,Va){const Fb=new le(20);Fb.displayName=Object(mc.a)("TellMeNotesProviderTitle");for(const bc of L)this.Lqj(bc)&&
(L=bc.NotesType,L=ba.a.Rr(L),L=this.bPi(L,bc.LastModifiedTime,bc.BodyPreview,bc.Subject,qa,Va,bc))&&(L.groupType=20,Fb.mt(L));return Fb}eHf(L,qa,Va){const Fb=new le(14);Fb.displayName=Object(mc.a)("TellMePeopleProviderTitle");for(const Ic of L)if(this.Mqj(Ic)){var bc=Ic.Id.split("@")[0];L=Ic.EmailAddresses[0];let td=Ic.Type;if(void 0===td||null===td)td="User";if(bc=this.mQi(td,Ic.DisplayName,Ic.JobTitle,L,bc,Va,qa))bc.description=L,L=Ic.JobTitle,"Department"in Ic&&"CompanyName"in Ic&&(L+="@"+Ic.Department+
"@"+Ic.CompanyName),bc.additionalInfo=L,Fb.mt(bc)}return Fb}dJd(L,qa,Va){const Fb=new le(15);Fb.displayName=Object(mc.a)("TellMeFileProviderTitle");for(const Ke of L)if(this.Eqj(Ke)){var bc=Ke.FileName;L=Ke.FileExtension;var Ic=bc;bc.length>L.length&&Ic.endsWith(L)&&(Ic=bc.substr(0,bc.length-L.length-1));var td=void 0,Hd=0;"DateCreated"in Ke&&Ke.DateCreated?(Hd=jd.yMd(Ke.DateCreated),td=jd.JJf(Ke.DateCreated),td=String.format(Object(mc.a)("CreatedTimeFormatString"),Ke.Author,td)):td=Ke.Author;var pe=
Ke.AccessUrl+"?web=1";const uf=ba.a.dlb(pe);bc=String.format('<a href="{0}">{1}</a>',uf,ba.a.Xq(bc));if(Va!==vc.contextMenu||ba.a.Kxa(pe))if(Ic=this.mJi(Ic,Va===vc.contextMenu?bc:pe,td,Ke.FileExtension,Ke.Text,qa))Ic.description=Ke.Author,Ic.glc=Hd,Fb.mt(Ic),this.R9c&&(Hd=Ke.AccessUrl,bc=jd.Myc(L),td=Ke.DateModified?Ke.DateModified:Ke.DateCreated,pe=Ke.Size?Ke.Size:Ke.FileSize,this.kIk()&&(Hd=Hd.replace(RegExp("%20","g")," "),bc=jd.TUi(L)),L=new Xh(bc,Hd,Ke.SPWebUrl,Ke.Id,pe,td),Kd.instance.v9b(!1,
Ic.value,L))}return Fb}e3a(L,qa,Va,Fb,bc){Fb===this.bI&&(this.Bea(),Kd.instance.xk().dba(qa.Ij.length,this.Zhc.join(","),L.data.httpStatus.toString(),Math.round(window.performance.now()-bc),og.QVg,!1,gg.dna));L=new dc(qa);Va.gr(L)}mQi(L,qa,Va,Fb,bc,Ic,td){td=td?this.$Xe:this.QOe;if(!window.LPC&&!jd.qTd()||this.mDb===td)return null;this.mDb+=1;td="PeopleSuggestion"+this.mDb.toString();var Hd=this.ARe+"?size=1&accountName="+Fb;L=Object.assign(new Gh.a,{PersonaType:L,Smtp:Fb,ProfilePictureUrl:Hd,AadObjectId:bc});
const pe=Object.assign(new Mh.a,{identifiers:L,displayName:qa});L=Ic===vc.contextMenu;this.Wg.R$?(Kd.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(td,pe,qa,Va)),Ic===vc.contextMenu&&(Va=jd.Dif(qa,Fb,bc),Kd.instance.actions.push(appChrome.actions.setButtonCommandValueId(td,Va))),Kd.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(td,L))):(Hd=[],Hd.push(appChrome.actions.setPersonaButtonCoauthor(td,pe,qa,Va)),Ic===vc.contextMenu&&(Va=jd.Dif(qa,Fb,
bc),Hd.push(appChrome.actions.setButtonCommandValueId(td,Va))),Hd.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(td,L)),appChrome.api.dispatch(Hd));return new Fd(td,11,qa,Fb,0)}bPi(L,qa,Va,Fb,bc,Ic,td){if(bc&&!this.Wg.g0f||this.yfc===this.ffc||this.YCb===this.ffc||this.pEa===this.ffc)return null;var Hd=null;this.yfc+=1;bc="";const pe=[],Ke={};td.type="Notes";this.VPe=Object.assign(new Yd,{landingTab:"Notes",data:td});Ic=jd.Oua(Ic.Ij,33,this.VPe);if("onenotepagepreviews"===L){if(!("ClickthroughUrl"in
td&&td.ClickthroughUrl)||""===td.ClickthroughUrl)return null;this.YCb+=1;bc="OnenoteNotesSuggestion"+this.YCb.toString();Ke["default"]="SaveAsonetoc2_20";Hd=td.ClickthroughUrl;pe.push(appChrome.actions.setControlIconSet(bc,Ke));pe.push(appChrome.actions.setCompoundButtonCommandValueId(bc,Hd));Hd=new Fd(bc,19,null,null,0)}else if("stickynote"===L){if(!this.pVe)return null;this.pEa+=1;bc="NotesSuggestion"+this.pEa.toString();Ke["default"]="ShowAllNotes_20";pe.push(appChrome.actions.setControlIconSet(bc,
Ke));pe.push(appChrome.actions.setCompoundButtonCommandValueId(bc,Ic));Hd=new Fd(bc,21,null,null,0)}else if("samsung"===L){if(!this.pVe)return null;this.pEa+=1;bc="NotesSuggestion"+this.pEa.toString();Ke["default"]="CategoryCollapsed_20";pe.push(appChrome.actions.setControlIconSet(bc,Ke));pe.push(appChrome.actions.setCompoundButtonCommandValueId(bc,Ic));Hd=new Fd(bc,20,null,null,0)}""!==bc&&(L=jd.JJf(qa),L=String.format(Object(mc.a)("LastModifiedString"),L),Hd.label=Fb,Hd.glc=jd.yMd(qa),pe.push(appChrome.actions.setControlLabel(bc,
Fb)),pe.push(appChrome.actions.updateCompoundButtonDescription(bc,L)),pe.push(appChrome.actions.setControlCustomTooltip(bc,Va)),appChrome.api.dispatch(pe));return Hd}mJi(L,qa,Va,Fb,bc,Ic){if(this.RAb===(Ic?this.okd:this.Wid)||this.R9c&&"Word"!==jd.Myc(Fb))return null;this.RAb+=1;Ic="FileSuggestion"+this.RAb.toString();const td=[],Hd={};Hd["default"]=jd.ALi(Fb);this.Wg.R$?(Kd.instance.actions.push(appChrome.actions.setControlLabel(Ic,L)),Kd.instance.actions.push(appChrome.actions.setControlIconSet(Ic,
Hd)),Kd.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(Ic,Va)),Kd.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(Ic,qa)),Kd.instance.actions.push(appChrome.actions.setControlCustomTooltip(Ic,bc))):(td.push(appChrome.actions.setControlLabel(Ic,L)),td.push(appChrome.actions.setControlIconSet(Ic,Hd)),td.push(appChrome.actions.updateCompoundButtonDescription(Ic,Va)),td.push(appChrome.actions.setCompoundButtonCommandValueId(Ic,qa)),td.push(appChrome.actions.setControlCustomTooltip(Ic,
bc)),appChrome.api.dispatch(td));return new Fd(Ic,6,L,Va,0)}nMd(){const L=[];this.Wg.q8b&&Array.add(L,"People");this.Wg.p8b&&Array.add(L,"File");this.Wg.RKa&&Array.add(L,"Notes");return L}DVi(L,qa,Va,Fb){var bc=new Zh(L);L=new qh("File",bc,0,Fb?this.okd:this.Wid,null);Fb=new qh("People",bc,0,Fb?this.$Xe:this.QOe,jd.k2j);bc=new qh("Notes",bc,0,this.ffc,null);(this.Wg.fuc||this.Wg.juc)&&"powerpoint"===qa.toLowerCase()&&(qa="word");qa=new xh("app",qa.toLowerCase());var Ic=[];Array.add(Ic,qa);qa=new $h("tellmesearch",
Ic);Ic=[];this.Wg.p8b&&Array.add(Ic,L);this.Wg.q8b&&Array.add(Ic,Fb);this.Wg.RKa&&Array.add(Ic,bc);Va=new hh(Ic,"UTC",Va,qa);return qc.c(Va)}CVi(){let L=this.Wg.VSk;this.Wg.RKa&&(L+="?&setflight=NotesFrom3S");""!==this.Wg.sJf&&(L=L+"&"+this.Wg.sJf);return L}Mqj(L){return"DisplayName"in L&&"Id"in L&&"EmailAddresses"in L&&!!L.Id&&!!L.EmailAddresses}Eqj(L){return"FileExtension"in L&&!!L.FileExtension&&"FileName"in L&&!!L.FileName&&""!==L.FileName&&"AccessUrl"in L&&!!L.AccessUrl&&""!==L.AccessUrl}Lqj(L){return"Id"in
L&&!!L.Id&&"NotesType"in L&&!!L.NotesType&&"Subject"in L&&!!L.Subject&&""!==L.Subject}zFc(){return!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}kIk(){return!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShouldPerformFileInfoFixes",!0)}}Object(m.a)(Bi,"SubstrateResultsProvider",null,[552]);class $i{constructor(){this.Pwb=this.Qwb=this.Owb=
this.yXb=this.Lob=this.Clb=0}nuh(L,qa){switch(L){case 1:this.Clb=qa;break;case 3:this.Lob=qa;break;case 2:this.yXb=qa;break;case 5:this.Owb=qa;break;case 4:this.Qwb=qa;break;case 6:this.Pwb=qa}}}Object(m.a)($i,"CommandFeatures",null,[]);class Hi{constructor(L){this.vIe=0;this.jda=L;this.efh={}}get modelId(){return this.jda}get Dsi(){return this.vIe}get FJb(){return this.efh}Dth(L,qa,Va){0===qa?this.vIe=Va:(this.FJb[L]||(this.FJb[L]=new $i),this.FJb[L].nuh(qa,Va))}}Object(m.a)(Hi,"CoefficientsModel",
null,[]);const zh=(L,qa)=>Math.pow(10,-qa/(60*Math.LN10/Math.LN2*L));class rj{constructor(L,qa){this.vnh=L;this._count=1;this.KRa=new $i;this.features.yXb=1+Math.log(this.count)/Math.LN2;this.features.Clb=L?1/L:0;this.features.Lob=2/Math.pow(2,L);this.features.Owb=zh(10,qa);this.features.Qwb=zh(2,qa);this.features.Pwb=zh(1,qa)}get rank(){return this.vnh}get count(){return this._count}get features(){return this.KRa}R7i(){this._count=this.count+1;this.features.yXb=1+Math.log(this.count)/Math.LN2}n6k(L){const qa=
2/Math.pow(2,L);this.features.Clb=Math.max(this.features.Clb,L?1/L:0);this.features.Lob=Math.max(this.features.Lob,qa)}f7k(L){const qa=zh(10,L),Va=zh(2,L);L=zh(1,L);this.features.Owb=Math.max(this.features.Owb,qa);this.features.Qwb=Math.max(this.features.Qwb,Va);this.features.Pwb=Math.max(this.features.Pwb,L)}}Object(m.a)(rj,"CommandModel",null,[]);class Hj{constructor(L){this.yzb=null;if(!L&&Kd.instance.xk())Kd.instance.xk().onError("PredictionEngine","IModelAdapter can't be null");this.Kab=L;this.qfc=
this.N_d()}N_d(){const L=this.Kab.VNi(),qa=this.Kab.yKd();if(void 0===L||null===L||void 0===qa||null===qa)return!1;try{window.performance.now();this.yzb={};for(let Va=0;Va<L.length;Va++){const Fb=L[Va],bc=qa[Fb[0].toString()].trim(),Ic=Fb[1],td=0!==Ic?qa[Fb[2].toString()].trim():"",Hd=Fb[3];bc in this.yzb||(this.yzb[bc]=new Hi(bc));this.yzb[bc].Dth(td,Ic,Hd)}}catch(Va){if(Kd.instance.xk())Kd.instance.xk().onError("LoadModelData","Error Loading Suggestions Model: "+Va);return!1}return!0}Qzi(){const L=
this.Kab.TLi(),qa={};if(!L)return qa;let Va=1;for(let Fb=0;Fb<L.length;Fb++){const bc=L[Fb];bc.Id in qa?(qa[bc.Id].R7i(),qa[bc.Id].n6k(Va),qa[bc.Id].f7k(bc.TimeElapsedSinceClick)):qa[bc.Id]=new rj(Va,bc.TimeElapsedSinceClick);Va++}return qa}Fmb(){this.qfc||(this.qfc=this.N_d());return this.qfc}SQi(){let L=[];if(!this.qfc){if(Kd.instance.xk())Kd.instance.xk().onError("GetPredictedCommands","IModelAdapter returned no data");return L}const qa=this.Qzi(),Va=this.yzb;for(const bc in Va){const Ic=Va[bc],
td=Ic.modelId;let Hd=0;for(const pe in qa){var Fb=pe;const Ke=qa[pe].features;(Fb=Fb in Ic.FJb?Ic.FJb[Fb]:null)&&(Hd+=Ke.Clb*Fb.Clb+Ke.Lob*Fb.Lob+Ke.yXb*Fb.yXb+Ke.Owb*Fb.Owb+Ke.Qwb*Fb.Qwb+Ke.Pwb*Fb.Pwb)}Hd+=Ic.Dsi;L.push(new Vd(td,Hd))}L.sort((bc,Ic)=>bc.score<Ic.score?1:bc.score>Ic.score?-1:0);0<L.length-10&&(L=L.slice(0,10));return L}}Object(m.a)(Hj,"PredictionEngine",null,[]);class Ii{constructor(){this.qUe={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),
"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),
"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),
"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),
"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}fyc(L,qa){return qa&&"word"===qa.application.toLowerCase()&&
L in this.qUe?this.qUe[L]:[]}}Object(m.a)(Ii,"SuggestionResultsUtility",null,[]);class Cg{constructor(L,qa,Va){this.Wg=qa;this.FCb=new Hj(L);this.lda=Va;this.TVe=new Ii}hE(){return"Suggestion"}iK(){return 0===this.Wg.Ir?0:1===this.Wg.Ir?1:2}nC(L,qa,Va,Fb,bc){Fb=void 0===Fb?vc.tellMe:Fb;bc=void 0===bc?null:bc;Va=new dc(L);Kd.instance.YBa=!1;if((!bc||Array.contains(bc,16))&&jd.lE(L)){if(!this.FCb.Fmb()){if(Kd.instance.xk())Kd.instance.xk().onError("CRASH","SuggestionResultsProvider: Found invalid Model data");
throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}Date.now();if(this.KWd()&&0<this.TVe.fyc(Kd.instance.jLb,this.Wg).length){const td=this.TVe.fyc(Kd.instance.jLb,this.Wg);bc=[];for(var Ic of td)this.Wg.uXc&&"Find"===Ic||bc.push(new Vd(Ic,0));Kd.instance.YBa=!0}else bc=this.FCb.SQi();Ge.Fob(bc,!0,"Recommended","LRE");Ic=[];for(const td of bc)this.lda&&this.lda.dKb(td.commandId)||Ic.push(td);L=Ge.bZa(L,Ic,this.Wg,null,null,null,16,1);0<L.results.length&&Fb!==vc.contextMenu&&
(L.displayName=Object(mc.a)("TellMeTryCommandTitle"));0<L.results.length&&Va.Hs(L)}qa.gr(Va)}KWd(){return!!this.Wg&&(this.Wg.KWd||this.Wg.qrj)}}Object(m.a)(Cg,"SuggestionResultsProvider",null,[552]);class Wf{TLi(){return Kd.instance.dyc()}VNi(){return window.TellMeSuggestionModel}yKd(){return window.CoefficientModelIdMap}}Object(m.a)(Wf,"SuggestionsModelAdapter",null,[643]);class sj{constructor(L){this.Wg=L;this.Zhc=this.nMd()}hE(){return"Add-ins"}iK(){return 0===this.Wg.Ir?0:1===this.Wg.Ir?1:3}nC(L,
qa){L=new dc(L);qa.gr(L)}AJa(L,qa,Va){let Fb;Fb=this.Wg.KH?new le(29):new le(27);Fb.displayName=Object(mc.a)("TellMeAddinProviderTitle");Va&&this.CNk(L.Ij,qa,Fb)}CNk(L,qa,Va){const Fb=[];let bc;bc=this.Wg.dej?this.Wg.KH&&this.Wg.CFa?jd.zIa(String.format(Object(mc.a)("TellMeLaunchAddinDialogButtonText_1_Bolded"),L)):String.format(Object(mc.a)("TellMeLaunchAddinDialogButtonText_1"),L):this.Wg.eej?this.Wg.KH&&this.Wg.CFa?jd.zIa(String.format(Object(mc.a)("TellMeLaunchAddinDialogButtonText_2_Bolded"),
L)):String.format(Object(mc.a)("TellMeLaunchAddinDialogButtonText_2"),L):this.Wg.KH&&this.Wg.CFa?jd.zIa(String.format(Object(mc.a)("TellMeLaunchAddinDialogButtonText_0_Bolded"),L)):String.format(Object(mc.a)("TellMeLaunchAddinDialogButtonText_0"),L);this.Wg.R$?(Kd.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",bc)),Kd.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",L))):(Fb.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",
bc)),Fb.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",L)),appChrome.api.dispatch(Fb));Va.mt(new Fd("LaunchAddinDialogFromTellMe",29));qa.Hs(Va)}nMd(){const L=[];this.Wg.VDc&&Array.add(L,"Addin");return L}}Object(m.a)(sj,"AddinStoreResultsProvider",null,[552]);class ii{constructor(L){this.Wg=L}hE(){return"Template"}iK(){return 0===this.Wg.Ir?0:1===this.Wg.Ir?1:3}nC(L,qa){L=new dc(L);qa.gr(L)}AJa(L,qa,Va){var Fb=[];let bc;bc=this.Wg.KH?this.Wg.CFa?jd.zIa(String.format(Object(mc.a)("TellMeTemplateButtonTextV2Bolded"),
L.Ij)):String.format(Object(mc.a)("TellMeTemplateButtonTextV2"),L.Ij):String.format(Object(mc.a)("TellMeTemplateButtonText"),L.Ij);Fb.push(appChrome.actions.setControlLabel("TemplateForSearch",bc));Fb.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",String.format(R.AFrameworkApplication.fa.Xa("TellMeTemplateProviderURL"),R.AFrameworkApplication.uiCulture,L.Ij)));appChrome.api.dispatch(Fb);L=new le(23);L.displayName=Object(mc.a)("TellMeTemplateProviderTitle");Fb=new Fd("TemplateForSearch",
24,null,null,0);Fb.label=Va[0].Title?Va[0].Title:"";Fb.description=Va[0].Description?Va[0].Description:"";L.mt(Fb);qa.Hs(L)}}Object(m.a)(ii,"TemplateResultsProvider",null,[552]);class aj{constructor(L,qa,Va){this.xEa=this.jEb=this.kEb=this.Dhc=!1;this.bI=null;this.eQ=-1;this.Jsa=this.FEb=this.IEa=this.pTa=null;this.JNe=this.PNe=0;this.Wg=L;const Fb=jd.Z5();this.bDa=qa||[];this.vn=R.AFrameworkApplication.$i;this.YUe=L.p9d;this.lEb=L.o9d;this.Bhc=Fb&&this.Kvb();this.Chc=Fb&&this.Mvb();this.ZUe=Fb&&
this.Nvb();this.Fhc=this.Qvb();this.Nhd=this.Ovb();if((qa=L.Ese&&jd.Toe(L))||L.O_)this.pTa=new Bi(L),this.Dhc=L.p8b;qa&&(this.kEb=L.q8b,this.jEb=L.RKa,this.xEa=this.Dhc&&this.vu("File")||this.kEb&&this.vu("People")||this.jEb&&this.vu("Notes"));this.Ahc=this.ZIk();this.nEb=L.j0b;this.Ehc=this.AJk();this.Lhd=this.YIk();this.Jbb=this.tXc();this.qEe=this.mWi();this.dEe=new Ze(L);this.gjh=new xg(L);this.sqh=new ii(L);this.kdh=new sj(L);this.MDb=Va;this.dTa=new Lh.a;this.nEb&&(this.dEe=new Ze(L));L.O_&&
(this.Lhd=this.Ehc=this.nEb=this.xEa=this.jEb=this.kEb=this.Nhd=this.Fhc=this.ZUe=this.Chc=this.Bhc=this.lEb=!1,R.AFrameworkApplication.fa&&this.vu("File")&&this.zQg()||this.Jbb)&&(L=this.dTa.AMd("Search",R.AFrameworkApplication.fa.Xa("TellMeServiceAuthEndpointForSearch")),this.ONb(L,"TellMeService",!0),L=this.dTa.AMd("SmartLookup",R.AFrameworkApplication.fa.Xa("SmartLookupShredderServiceEndpoint")),this.ONb(L,"Shredder",!1));R.AFrameworkApplication.fa&&this.xEa&&this.vu("File")&&this.zQg()&&(L=this.dTa.AMd("Search",
R.AFrameworkApplication.fa.Xa("TellMeServiceAuthEndpointForSearch")),this.ONb(L,"TellMeService",!0))}vu(L){return Array.contains(this.bDa,L)?!0:!1}hE(){return"TellMeService"}iK(){return 0===this.Wg.Ir?0:1===this.Wg.Ir?1:this.vu("Command")||this.vu("Recommended")?2:3}iWi(L){let qa="";if(!L&&this.vu("Command")&&this.Wg.hVd){qa+="CommandSearch_DLIS,";var Va=this.Wg.qXg;0<Va.length&&(qa+=Va+",")}L&&this.vu("Recommended")&&this.lEb&&(Va=this.NYi(),0<Va.length&&(qa+=Va+","));!L&&this.vu("Help")&&(L=this.Wg.pXg,
0<L.length&&(qa+=L+","));this.Wg.O_&&this.Jsa&&0<this.Jsa.length&&(qa+="IsRecallEnabled_true,");(this.Wg.fuc||this.Wg.juc||this.Wg.O_)&&this.xEa&&(qa+="IsGenerateSlidesEnabled_true,");0<qa.length&&(qa=qa.substr(0,qa.length-1));return qa}ONb(L,qa,Va){const Fb=Va?this.PNe:this.JNe;if(!Fb||window.performance.now()-Fb>=jd.SYg)if(L)Va?this.PNe=window.performance.now():this.JNe=window.performance.now(),L.then(bc=>{Va?this.FEb=bc:(this.Jsa=bc,Kd.instance.d7b=bc)},bc=>{Kd.instance.xk().onError("TellMeServiceProvider:FetchTokenForService_"+
qa,"tellMeServiceToken promise rejected: "+bc)});else if(Kd.instance.xk())Kd.instance.xk().onError("TellMeServiceProvider:FetchTokenForService_"+qa,"undefined token promise")}nC(L,qa,Va,Fb,bc){Fb=void 0===Fb?vc.tellMe:Fb;bc=void 0===bc?null:bc;const Ic=new dc(L);Va=jd.lE(L);this.vu("File")&&(this.xEa||this.Wg.O_)&&this.ONb(this.dTa.nWi(),"TellMeService",!0);(this.vu("File")&&this.Wg.O_||this.vu("ActionAI")&&this.Jbb)&&this.ONb(this.dTa.LUi(),"Shredder",!1);var td=this.xEa&&!!this.FEb;const Hd=this.Wg.O_&&
!!this.Jsa;var pe=td||Hd||Va&&this.vu("Recommended")&&this.lEb;td=td||Hd||!Va&&(this.YUe&&this.vu("Command")||this.Bhc&&this.vu("Answer")||this.Chc&&this.vu("Definition")||this.Nhd&&this.vu("Image")||this.nEb&&this.vu("Help")||this.Fhc&&this.vu("WolframAnswer")||this.Ehc&&this.vu("Template")||this.Lhd&&this.vu("Addin"));if(pe||td)if(this.IEa=Fb,Fb={"Content-Type":"application/json",Accept:"application/json"},Fb["X-Office-Version"]=R.AFrameworkApplication.buildVersion,Fb["X-Office-Application"]=R.AFrameworkApplication.fa.Xa("Application"),
Fb["X-Office-Platform"]="WAC",Fb["X-TellMe-SqmUserId"]=R.AFrameworkApplication.fa.Xa("LoggableUserId")||"",Fb["X-TellMe-SessionId"]=Kd.instance.ikb(),this.FEb&&(Fb.Authorization="Bearer "+this.FEb),this.Jsa&&0<this.Jsa.length&&(Fb["X-TellMe-ShredderToken"]="Bearer "+this.Jsa),pe=this.iWi(Va),0<pe.length&&(Fb["X-TellMe-Flights"]=pe),pe=[],!Va&&this.vu("Answer")&&this.Bhc&&(bc?Array.contains(bc,9):1)&&Array.add(pe,"Answer"),!Va&&this.vu("Command")&&this.YUe&&!Ge.HTb(L.Ij)&&(bc?Array.contains(bc,17):
1)&&Array.add(pe,"Command"),!Va&&this.vu("Definition")&&this.Chc&&(bc?Array.contains(bc,10):1)&&Array.add(pe,"Definition"),!Va&&this.vu("Help")&&this.nEb&&(bc?Array.contains(bc,8):1)&&Array.add(pe,"Help"),!Va&&this.vu("WolframAnswer")&&this.Fhc&&(bc?Array.contains(bc,12):1)&&Array.add(pe,"WolframAnswer"),Va&&this.vu("Recommended")&&this.lEb&&!Kd.instance.YBa&&(bc?Array.contains(bc,18):1)&&Array.add(pe,"Recommended"),!Va&&this.vu("Image")&&this.Nhd&&(bc?Array.contains(bc,19):1)&&Array.add(pe,"Image"),
this.FEb&&this.xEa&&(bc?Array.contains(bc,14)||Array.contains(bc,15)||Array.contains(bc,20):1)&&(this.pTa.YY(),this.Dhc&&this.vu("File")&&Array.add(pe,"File"),this.kEb&&this.vu("People")&&Array.add(pe,"People"),this.jEb&&this.vu("Notes")&&Array.add(pe,"Notes")),this.Jsa&&0<this.Jsa.length&&this.Wg.O_&&(bc?Array.contains(bc,15):1)&&(this.pTa.YY(),this.vu("File")&&Array.add(pe,"File")),!Va&&this.vu("Template")&&this.Ehc&&(bc?Array.contains(bc,23):1)&&Array.add(pe,"Template"),!Va&&this.vu("Addin")&&
this.Lhd&&(bc?Array.contains(bc,27):1)&&Array.add(pe,"Addin"),!Va&&this.vu("ActionAI")&&this.Jbb&&(bc?Array.contains(bc,25):1)&&Array.add(pe,"ActionAI"),pe.length){Fb["X-TellMe-SuggestionTypes"]=pe.join(",");Fb["X-TellMe-Culture"]=R.AFrameworkApplication.uiCulture;Fb["X-TellMe-ProcessSessionId"]=R.AFrameworkApplication.userSessionId;var Ke=this.bI=ph.a.create().toString();Fb["Client-Request-Id"]=Ke;var uf=window.performance.now();this.Bea();this.eQ=window.setTimeout(()=>{if(Ke===this.bI){this.bI=
"";this.eQ=-1;qa.gr(Ic);const zf={};zf[Tc.provider]=this.hE();zf[Tc.v4a]=L.kNa;Kd.instance.xk().bV(Bd.timedOut,this.MDb,zf)}},this.MDb);this.vn.Ou(this.qEe,2,this.lWi(L.Ij),Fb,!1,0,zf=>{this.t3a(zf,L,qa,Ke,uf,bc)},zf=>{this.e3a(zf,L,qa,Ke,uf)},null,null,!1,4E3,this.Jbb?3E4:6E3)}else Kd.instance.xk().onError("IssueQuery","Empty Online Provider List: No online calls by provider"),qa.gr(Ic);else qa.gr(Ic)}Bea(){-1!==this.eQ&&(window.clearTimeout(this.eQ),this.eQ=-1)}t3a(L,qa,Va,Fb,bc,Ic){const td=new dc(qa);
if(Fb===this.bI){this.Bea();Kd.instance.xk().dba(qa.Ij.length,this.bDa.join(","),L.data.httpStatus.toString(),Math.round(window.performance.now()-bc),og.tellMe,!0,gg.dna);Fb=L.data.responseData;L=null;try{L=qc.b(Fb)}catch(bg){Kd.instance.xk().onError("OnSuccessCallBack","Exception occured while deserializing response:"+bg);return}Fb=jd.lE(qa);if("Groups"in L&&L.Groups){var Hd=L.Groups;for(var pe of Hd)if("GroupType"in pe&&"Suggestions"in pe&&pe.Suggestions)if("Commands"===pe.GroupType&&(Ic?Array.contains(Ic,
17):1)||"Recommended"===pe.GroupType&&(Ic?Array.contains(Ic,18):1)){var Ke=(Hd="Recommended"===pe.GroupType)?"DLIS":"NaiveBayes";"Source"in pe&&pe.Source&&(Ke=pe.Source);var uf=pe.Suggestions;new Af.a;var zf=[];for(const bg of uf)this.Cqj(bg)&&(uf=bg.Type,("Command"===uf||Hd&&"Recommended"===uf)&&zf.push(new Vd(bg.CommandId,bg.Score)));Ge.Fob(zf,!qa.Ij.trim().length,pe.GroupType,Ke);Ke=Kd.instance.oKd();uf=[];for(const bg of zf)Hd&&Ke&&Ke.dKb(bg.commandId)||uf.push(bg);zf=Ge.bZa(qa,uf,this.Wg,null,
null,null,Hd?18:17,0);0<zf.results.length&&(this.IEa!==vc.contextMenu&&(zf.displayName=Hd?Object(mc.a)("TellMeTryCommandTitle"):Object(mc.a)("TellMeCommandProviderTitle")),td.Hs(zf))}else if("Answer"===pe.GroupType){uf=pe.Suggestions;Hd=null;zf=2147483647;Ke="";for(const bg of uf)if(this.Aqj(bg))if(Ke=bg.Type,uf=this.xHf(Ke),"Answer"===Ke&&this.Bhc){Hd=this.uif(Ke,bg,qa.Ij);break}else uf&&uf<zf&&(zf=uf,Hd=this.uif(Ke,bg,qa.Ij));zf=jd.nqk(qa.Ij,Ke);Hd&&(Ic?Array.contains(Ic,Hd.type):1)&&(Ke=[],this.Ahc?
this.Wg.R$?(Kd.instance.actions.push(appChrome.actions.setControlLabel(Hd.value,Hd.GK)),Kd.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(Hd.value,Hd.description)),Kd.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(Hd.value,zf))):(Ke.push(appChrome.actions.setControlLabel(Hd.value,Hd.GK)),Ke.push(appChrome.actions.updateCompoundButtonDescription(Hd.value,Hd.description)),Ke.push(appChrome.actions.setCompoundButtonCommandValueId(Hd.value,zf)),appChrome.api.dispatch(Ke)):
this.Wg.R$?(Kd.instance.actions.push(appChrome.actions.setControlLabel(Hd.value,Hd.GK+" - "+Hd.description)),Kd.instance.actions.push(appChrome.actions.setButtonCommandValueId(Hd.value,zf))):(Ke.push(appChrome.actions.setControlLabel(Hd.value,Hd.GK+" - "+Hd.description)),Ke.push(appChrome.actions.setButtonCommandValueId(Hd.value,zf)),appChrome.api.dispatch(Ke)),zf=this.f6h(Hd.type),zf.mt(Hd),td.Hs(zf))}else"Help"===pe.GroupType&&pe.Suggestions.length&&(Ic?Array.contains(Ic,8):1)?this.nEb&&(Hd=this.dEe.AJa(qa,
pe.Suggestions))&&0<Hd.results.length&&td.Hs(Hd):"Template"===pe.GroupType&&(Ic?Array.contains(Ic,23):1)?(Hd=pe.Suggestions)&&0<Hd.length&&this.sqh.AJa(qa,td,Hd):"Addin"===pe.GroupType&&(Ic?Array.contains(Ic,27):1)?(Hd=pe.Suggestions)&&0<Hd.length&&this.kdh.AJa(qa,td,Hd):"ActionAI"===pe.GroupType&&(Ic?Array.contains(Ic,25):1)?(zf=pe.Suggestions,Hd=[],new le(25),zf&&1===zf.length&&(Ke=zf[0])&&Ke.CommandId&&(zf=Ke.CommandId,Hd.push(new Vd(zf,"Score"in Ke?Ke.Score:0)),Hd=Ge.bZa(qa,Hd,this.Wg,null,null,
null,25,0),Hd.displayName=Object(mc.a)("TellMeActionAIProviderTitle"),td.Hs(Hd))):"Substrate"===pe.GroupType&&this.xEa&&"Type"in pe?"File"===pe.Type&&this.Dhc&&(Ic?Array.contains(Ic,15):1)?(Hd=this.pTa.dJd(pe.Suggestions,Fb,this.IEa))&&0<Hd.results.length&&(this.zFc()&&(zf=new Fd("GenerateSlidesFromTellMe",30,"",null,1),Hd.mt(zf)),td.Hs(Hd)):"People"===pe.Type&&this.kEb&&(Ic?Array.contains(Ic,14):1)?(Hd=this.pTa.eHf(pe.Suggestions,Fb,this.IEa))&&0<Hd.results.length&&td.Hs(Hd):"Notes"===pe.Type&&this.jEb&&
(Ic?Array.contains(Ic,14):1)&&(Hd=this.pTa.BGf(pe.Suggestions,Fb,qa))&&0<Hd.results.length&&td.Hs(Hd):"Recall"===pe.GroupType&&this.Wg.O_&&"Type"in pe&&"IntentService"===pe.Type&&(Ic?Array.contains(Ic,15):1)&&(Hd=this.pTa.dJd(pe.Suggestions,Fb,this.IEa))&&0<Hd.results.length&&(this.zFc()&&(zf=new Fd("GenerateSlidesFromTellMe",30,"",null,1),Hd.mt(zf)),td.Hs(Hd));else Kd.instance.xk().onError("OnSuccessCallBack","GroupType"in pe?"Invalid group suggestions found for "+pe.GroupType:"Invalid group found")}if(L.Intents){pe=
L.Intents;for(const bg of pe)this.VXd(bg)&&("Image"===bg.GroupType&&bg.ConfidenceScore>bg.ConfidenceThreshold&&(Ic?Array.contains(Ic,19):1)?this.gjh.AJa(qa,td,0,bg):"Commands"===bg.GroupType&&bg.ConfidenceScore<bg.ConfidenceThreshold&&(Ic?Array.contains(Ic,17):1)&&(pe=new le(17),td.Hs(pe)))}Va.gr(td);Kd.instance.xk().dba(qa.Ij.length,this.bDa.join(","),"",Math.round(window.performance.now()-bc),"",!0,gg.provider)}}e3a(L,qa,Va,Fb,bc){const Ic=new dc(qa);Fb===this.bI&&(this.Bea(),Kd.instance.xk().dba(qa.Ij.length,
this.bDa.join(","),L.data.httpStatus.toString(),Math.round(window.performance.now()-bc),og.tellMe,!1,gg.dna));Va.gr(Ic)}xHf(L){switch(L){case "Entity":return this.ZUe?3:0;case "Definition":return this.Chc?5:0;case "WolframAnswer":return this.Fhc?2:0;default:return 0}}uif(L,qa,Va){switch(L){case "Answer":return new Fd(this.Ahc?"AnswerForSearch":"AnswerForSearchSingleLine",0,""===qa.Title?Va:qa.Title,qa.Description,0);case "Entity":return new Fd(this.Ahc?"AnswerForSearch":"AnswerForSearchSingleLine",
2,""===qa.Title?Va:qa.Title,qa.Description,0);case "Definition":return new Fd(this.Ahc?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===qa.Title?Va:qa.Title,qa.Description,0);case "WolframAnswer":return new Fd("WolframForSearch",3,""===qa.Title?Va:qa.Title,qa.Description,0);default:return null}}f6h(L){switch(L){case 0:return new le(9,Object(mc.a)("TellMeAnswersTitle"));case 2:return new le(11,Object(mc.a)("TellMeEntityTitle"));case 1:return new le(10,Object(mc.a)("TellMeDefinitionTitle"));case 3:return new le(12,
Object(mc.a)("TellMeAnswersTitle"));case 12:return new le(19,this.Wg.Fvb?Object(mc.a)("TellMeImageTitleV2"):Object(mc.a)("TellMeImageTitle"));default:return null}}Aqj(L){return"Type"in L&&!!L.Type&&""!==L.Type&&"Description"in L&&!!L.Description&&""!==L.Description}Cqj(L){return"Type"in L&&!!L.Type&&""!==L.Type&&"CommandId"in L&&!!L.CommandId&&""!==L.CommandId&&"Score"in L&&!!L.Score}VXd(L){if("GroupType"in L&&L.GroupType&&"ConfidenceScore"in L&&"ConfidenceThreshold"in L)return!0;Kd.instance.xk().onError("IsValidIntentGroup",
"Invalid intents found");return!1}lWi(L){const qa=jd.M_f(L),Va={};Va.Query=L;qa&&this.lEb&&(this.Nlj()?Va.UserActionEvents=Kd.instance.LMd():(Va.CommandClickedEvents=Kd.instance.dyc(),Va.CommandActionEvents=Kd.instance.dId()),Va.TellMeCommandClickMruEvents=Kd.instance.ZHd(),Va.ContentType=Kd.instance.jLb);this.Ehc&&(L={},L.Application=this.Wg.application,Va.TemplateInfo=L);return qc.c(Va)}Kvb(){return!!this.Wg&&this.Wg.Kvb||!!R.AFrameworkApplication.ra&&R.AFrameworkApplication.ra.$d.Kvb}Mvb(){return!!this.Wg&&
this.Wg.Mvb||!!R.AFrameworkApplication.ra&&R.AFrameworkApplication.ra.$d.Mvb}Nvb(){return!!this.Wg&&this.Wg.Nvb||!!R.AFrameworkApplication.ra&&R.AFrameworkApplication.ra.$d.Nvb}Qvb(){return!!this.Wg&&this.Wg.Qvb||!!R.AFrameworkApplication.ra&&R.AFrameworkApplication.ra.$d.Qvb}Ovb(){return!!this.Wg&&(this.Wg.Ovb||this.Wg.KH)}ZIk(){return!!this.Wg&&!this.Wg.QKa}AJk(){return!!this.Wg&&this.Wg.ZVb}YIk(){return!!this.Wg&&this.Wg.fej&&this.Wg.cej}tXc(){return!!this.Wg&&this.Wg.tXc}e0f(){return!!R.AFrameworkApplication.fa&&
R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",!1)}f0f(){return!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}Nlj(){return!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewZeroSearchTermModel",!1)}zFc(){return!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",
!1)}zQg(){return!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FetchTellMeTokensAtBoot",!1)}NYi(){return R.AFrameworkApplication.fa?R.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.TellMeZeroTermModelName",""):""}mWi(){if(!R.AFrameworkApplication.fa)return"";if(this.f0f())return R.AFrameworkApplication.fa.Xa("TellMeServiceProdEndpointForSearch");if(this.e0f())return R.AFrameworkApplication.fa.Xa("TellMeServiceEdogEndpointForSearch");
if(jd.qTd())return R.AFrameworkApplication.fa.Xa("TellMeServiceIntEndpointForSearch");let L=R.AFrameworkApplication.fa.Xa("TellMeServiceSearchEndpoint");L&&""!==L||(L=R.AFrameworkApplication.oXg);return L}static Qif(L,qa){if(qa)return new aj(L,["Command","Recommended"],L.cJi);qa=jd.Z5()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin ActionAI".split(" "):"Help WolframAnswer File People Notes Template Addin ActionAI".split(" ");return new aj(L,qa,L.bJf)}}Object(m.a)(aj,
"TellMeServiceProvider",null,[552]);class rh{constructor(L){this.cbb={};this.cbb[vc.tellMe]=[];this.cbb[vc.contextMenu]=[];this.xec=void 0===L?!1:L}h1f(L,qa,Va,Fb,bc){bc=void 0===bc?null:bc;let Ic;var td=!1;switch(Fb){case vc.contextMenu:Ic=this.cbb[vc.contextMenu];td=!0;break;default:Ic=this.cbb[vc.tellMe]}qa=new Qh(qa,Ic,td,this.xec,Fb);qa.b2j();for(let Hd=0;Hd<Ic.length;++Hd){const pe=window.performance.now(),Ke=new We(qa,Hd);(td=Kd.instance.eE())&&td.VJh?window.setTimeout(()=>{Ic[Hd].nC(L,Ke,
Va,Fb,bc);if(Kd.instance.xk()){const uf={};uf[Tc.provider]=Ic[Hd].hE();uf[Tc.v4a]=L.kNa;Kd.instance.xk().bV(Bd.nC,window.performance.now()-pe,uf)}},0):(Ic[Hd].nC(L,Ke,Va,Fb,bc),Kd.instance.xk()&&(td={},td[Tc.provider]=Ic[Hd].hE(),td[Tc.v4a]=L.kNa,Kd.instance.xk().bV(Bd.nC,window.performance.now()-pe,td)))}qa.B1k()}hE(){return"Aggregator"}iK(){return 0}nC(L,qa,Va,Fb,bc){Va=void 0===Va?!1:Va;Fb=void 0===Fb?vc.tellMe:Fb;bc=void 0===bc?null:bc;if(Kd.instance.GYb)this.h1f(L,qa,Va,Fb,bc);else{const Ic=
window.performance.now();Kd.instance.x$b.then(()=>{Kd.instance.xk()&&Kd.instance.xk().bV(Bd.CEj,window.performance.now()-Ic);this.h1f(L,qa,Va,Fb,bc);return!0})}}Lz(L,qa){this.cbb[qa].push(L)}Ruh(L){switch(L){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const qa=this.cbb[vc.tellMe];for(const Va of qa)if("FindInDocument"===Va.hE()){Va.tBk(L);break}}}static createInstance(L,qa,Va,Fb){const bc=qa.O_;var Ic=Fb&&jd.Uoe(qa),td=Ic&&qa.o9d&&!bc;const Hd=qa.tXd&&
!jd.pnb()&&!bc,pe=qa.rVd&&!bc,Ke=new rh(Ic);if(qa.sJk&&!bc){var uf=new ca(qa);Ke.Lz(uf,vc.tellMe)}uf=qa.Aq?R.AFrameworkApplication.fa.la("TellMeIsSuggestionsForSimplifiedUxEnabled"):R.AFrameworkApplication.fa.la("TellMeSuggestionsIsEnabled");const zf=!uf&&R.AFrameworkApplication.fa.la("TellMeFirstRunExperienceIsEnabled");Ke.Lz(new Of(L,qa.g0k,zf,!1),vc.tellMe);uf&&!bc&&Ke.Lz(new Cg(new Wf,qa,L),vc.tellMe);L=R.AFrameworkApplication.ra.$d.uXd?new Kc(qa,new Xd):new Mf(qa,Va);Ke.Lz(L,vc.contextMenu);
(Ic&&qa.p9d||td)&&Ke.Lz(aj.Qif(qa,!0),vc.tellMe);Ke.Lz(L,vc.tellMe);!qa.Dui||bc||"Word"===qa.application&&qa.Swf||Ke.Lz(new ng(qa),vc.tellMe);qa.AUa&&!bc&&(td=new ve(qa),Ke.Lz(td,vc.tellMe),Ke.Lz(td,vc.contextMenu));!qa.KUa||qa.q6b||qa.p6b||bc||Ke.Lz(new Ze(qa),vc.tellMe);Fb&&(qa.aKa||jd.Z5())&&(td=new Pf(qa),Ke.Lz(td,vc.tellMe),Ke.Lz(td,vc.contextMenu));Ic&&Ke.Lz(aj.Qif(qa,!1),vc.tellMe);Fb&&!qa.Ese&&jd.Toe(qa)&&!bc&&(Ke.Lz(new Bi(qa),vc.tellMe),qa.USk&&Ke.Lz(new Bi(qa),vc.contextMenu));Hd&&Ke.Lz(new ig(qa),
vc.tellMe);!qa.Ovb&&!qa.KH||bc||Ke.Lz(new xg(qa),vc.tellMe);qa.ZVb&&!bc&&Ke.Lz(new ii(qa),vc.tellMe);qa.SDc&&(Ic=new Ee(qa),Ke.Lz(Ic,vc.tellMe),Ke.Lz(Ic,vc.contextMenu));Fb&&qa.VDc&&!bc&&Ke.Lz(new Ae(qa),vc.tellMe);pe&&"Excel"===qa.application&&!bc&&Ke.Lz(new rf(qa),vc.tellMe);return Ke}}Object(m.a)(rh,"AggregatorResultsProvider",null,[552]);var Ji=a(1148);class Dh{constructor(L,qa,Va,Fb,bc,Ic){L=void 0===L?"":L;qa=void 0===qa?"":qa;Va=void 0===Va?"":Va;this.Type=this.Description=this.Title=null;
this.Count=this.Age=this.Score=0;this.Title=L?L:"";this.Description=qa?qa:"";this.Type=Va?Va:"";this.Score=void 0===Fb?-99999:Fb;this.Age=void 0===bc?-1:bc;this.Count=void 0===Ic?0:Ic}}Object(m.a)(Dh,"Suggestion",null,[]);class Ld{constructor(L,qa){this.GroupType=this.Suggestions=null;this.Suggestions=L;this.GroupType=qa}}Object(m.a)(Ld,"SuggestionGroup",null,[]);class ze{}ze.help="help";ze.FDh="answer";ze.commands="commands";ze.zxk="servicecommands";ze.rXg="template";Object(m.a)(ze,"SuggestionGroupType",
null,[]);class Bj{constructor(L,qa,Va){this.u8c=0;this.Vid=this.gCb=null;this.kr=L;this.$hd=this.C7c=this.iad=!1;this.Vfh=qa;this.vn=R.AFrameworkApplication.$i;this.Wg=Va;this.Vbc=this.Zed=0}get oV(){return this.kr.oV}yWc(L){this.kr.yWc(L)}j6f(){if(this.gCb){var L=0;for(const qa of this.gCb)this.kr.Wyj(qa,L++);this.gCb=null}}beginQuery(L,qa,Va){this.kr.Kyj(L,qa,Va)}oMa(L,qa){this.kr.uIh(L,qa);this.iad=!0;this.$hd=!1}fza(){this.iad=!1;this.C7c||(this.j6f(),this.kr.Gpf(this.u8c))}Lyj(L,qa){this.kr.Myj(L,
qa)}iMj(L,qa,Va,Fb,bc){for(const Ic of this.Vfh)if(L.startsWith(Ic)){this.$hd=!0;break}this.kr.Pwj(L,qa,Va,Fb,bc)}IMj(L){this.C7c=!1;this.u8c=L;this.iad||this.$hd||(this.j6f(),this.kr.Gpf(this.u8c,!1))}HMj(L,qa){this.kr.Twj(L,qa);this.C7c=!0}UGd(L,qa){if(!L.count)return"";let Va="";const Fb=Date.now();for(const bc of L)L=(Fb-bc.timeStamp)/1E3,L=jd.d0c(L),0<Va.length&&(Va+=";"),Va+=qa?bc.commandId:bc.controlId,Va+=":",Va+=L.toString();return Va}gza(){var L=this.UGd(Ji.a.instance.Pzb,!1);0<L.length&&
this.kr.Mwj(L);L=this.UGd(Ji.a.instance.bRa,!0);0<L.length&&this.kr.nwj(L);L=this.UGd(Ji.a.instance.Xcc,!0);0<L.length&&this.kr.xxj(L);L=Kd.instance.$Hd();0<L.length&&this.kr.Jyj(qc.c(L))}gzj(L){this.kr.uwj(L)}dba(L,qa,Va,Fb,bc,Ic,td){this.kr.Uxj(L,qa,Va,Fb,bc,Ic,td)}z0d(L,qa,Va,Fb){this.kr.z0d(L,qa,Va,Fb)}bV(L,qa,Va){this.kr.nxj(L,qa,void 0===Va?null:Va)}onError(L,qa,Va){this.kr.SU(L,qa,void 0===Va?null:Va)}kBk(L){this.gCb=L}HVi(L){const qa=[];if(!L)return qa;for(let Va=0;Va<L.length;Va++){const Fb=
mg[L[Va].groupType].toLowerCase(),bc=[],Ic=L[Va].results;if(Ic){for(let td=0;td<Ic.length;td++)"findindocument"===Fb?Array.add(bc,new Dh("","",Fb,Ic[td].score,Ic[td].glc,Ic[td].count)):Array.add(bc,new Dh(Ic[td].label,Ic[td].description,Fb,Ic[td].score,Ic[td].glc,Ic[td].count));"answer"===Fb||"definition"===Fb||"wolframanswer"===Fb||"entity"===Fb?Array.add(qa,new Ld(bc,ze.FDh)):"classifier"===Fb||"appsforoffice"===Fb?Array.add(qa,new Ld(bc,ze.commands)):"serviceclassifier"===Fb?Array.add(qa,new Ld(bc,
ze.zxk)):"assistance"===Fb?Array.add(qa,new Ld(bc,ze.help)):("document"===Fb||"people"===Fb||"findindocument"===Fb||"notes"===Fb||"image"===Fb||"template"===Fb)&&Array.add(qa,new Ld(bc,Fb))}}return qa}lMd(L,qa){const Va={};Va.Query=qa;Va.SuggestionGroups=qc.c(this.HVi(L));return qc.c(Va)}EJf(L){const qa={"Content-Type":"application/json",Accept:"application/json"};qa["X-Office-Version"]=R.AFrameworkApplication.buildVersion;qa["X-Office-Application"]=R.AFrameworkApplication.fa.Xa("Application");qa["X-Office-Platform"]=
"WAC";qa["X-TellMe-SqmUserId"]=R.AFrameworkApplication.fa.Xa("LoggableUserId")||"";qa["X-TellMe-SessionId"]=this.kr.oV.interactionId;qa["X-TellMe-SuggestionTypes"]="Ranker";qa["X-TellMe-Culture"]=R.AFrameworkApplication.uiCulture;qa["X-TellMe-ProcessSessionId"]=R.AFrameworkApplication.userSessionId;qa["X-TellMe-Flights"]=L;qa["X-TellMe-PartialQueryIndex"]=this.Zed;return qa}t3a(L,qa,Va){this.dba(qa.length,"RankerLogging",L.data.httpStatus.toString(),Math.round(window.performance.now()-Va),og.nXg,
!0,gg.dna)}e3a(L,qa,Va){this.dba(qa.length,"RankerLogging",L.data.httpStatus.toString(),Math.round(window.performance.now()-Va),og.nXg,!1,gg.dna)}FJf(){this.Vid||(this.Vid=new aj(this.Wg,null,6E3));return this.Vid.qEe}G0d(L){const qa=this.lMd(this.gCb,L),Va=this.EJf("RankerLogging"),Fb=window.performance.now();this.vn.Ou(this.FJf(),2,qa,Va,!1,0,bc=>{this.t3a(bc,L,Fb)},bc=>{this.e3a(bc,L,Fb)},null,null,!1,4E3,6E3);this.Zed++}Nok(){this.Zed=0}hme(L){this.Vbc=L}}Object(m.a)(Bj,"InteractionLogger",null,
[]);var Ah=a(158);class Hh{constructor(L,qa,Va,Fb){this.xLf=L;this.groupType=qa;this.ENd=void 0===Fb?0:Fb;this.Z3b=Va}}Object(m.a)(Hh,"SortingGroup",null,[]);class Ki{constructor(L,qa,Va,Fb){this.order=L;this.zZa=qa;this.k_i=Va;this.groupType=Fb}}Object(m.a)(Ki,"SortingProp",null,[]);class Rh{constructor(L,qa){this.w8f={};this.v8f={};this.p8f=this.J8f=1;this.E8e(L,qa)}NPk(L,qa,Va){var Fb=jd.lE(Va)?this.w8f:this.v8f;Va=new Af.a;for(var bc of qa)qa=Object(Ah.a)(Ki,Fb[mg[bc.groupType].toLowerCase()]),
la.c(qa)||Va.add(new Uc.a(qa,bc));Va.Sc((td,Hd)=>td.key.order<Hd.key.order?-1:1);Array.clear(L);bc=Kd.instance.tMd();for(qa=0;qa<Va.count;){Fb=Va.ma(qa).key.zZa;var Ic=Va.ma(qa).value;const td=new le(Va.ma(qa).key.groupType);la.c(bc)||bc.Location===vc.contextMenu||(td.displayName=Va.ma(qa).key.k_i);for(const Hd of Ic.results)td.mt(Hd);for(Ic=++qa;Ic<Va.count&&Va.ma(Ic).key.zZa===Fb;)this.Yld(td,Va.ma(Ic).value),Ic=++qa;L.push(td)}}M6k(L,qa){this.p8f=this.J8f=1;this.E8e(L,qa)}E8e(L,qa){this.JTg(L);
for(var Va=0;Va<L.length;Va++){const Fb=L[Va];for(const bc of Fb.Z3b)this.yuh(bc,Va,Fb.xLf,Fb.groupType)}this.JTg(qa);for(L=0;L<qa.length;L++){Va=qa[L];for(const Fb of Va.Z3b)this.xuh(Fb,L,Va.xLf,Va.groupType)}}JTg(L){L.sort((qa,Va)=>Object(Ah.a)(Hh,qa).ENd>Object(Ah.a)(Hh,Va).ENd?-1:1)}yuh(L,qa,Va,Fb){this.w8f[mg[L].toLowerCase()]=new Ki(this.J8f++,qa,Va,Fb)}xuh(L,qa,Va,Fb){this.v8f[mg[L].toLowerCase()]=new Ki(this.p8f++,qa,Va,Fb)}Yld(L,qa){for(let Va=0;Va<qa.results.length;Va++)L.mt(qa.results[Va])}}
Object(m.a)(Rh,"BaseGroupingSorter",null,[]);class Cj{constructor(){this.wKc=[new Hh("",26,[26]),new Hh("",24,[24]),new Hh(Object(mc.a)("TellMeRecentlyUsedTitleV2"),4,[4,2]),new Hh(Object(mc.a)("TellMeCommandProviderTitle"),7,[18,16,7]),new Hh(Object(mc.a)("TellMeSuggestionsProviderTitle"),34,[15,14,19,3]),new Hh("",13,[13]),new Hh("",22,[22])];this.pKc=[new Hh("",25,[25]),new Hh(Object(mc.a)("TellMeCommandProviderTitle"),32,[17,0,1,8,28]),new Hh(Object(mc.a)("TellMeSuggestedSearchesProviderTitle"),
33,[2,19,23,29]),new Hh(Object(mc.a)("TellMePotentialMatchesProviderTitle"),34,[15,14,20,9,12,10,11,27,30]),new Hh("",13,[13]),new Hh("",22,[22])];this.T7f=new Rh(this.wKc,this.pKc)}y7b(L,qa,Va,Fb,bc){Fb=void 0===Fb?null:Fb;bc=void 0===bc?null:bc;let Ic=!1;if(Fb){for(const td of jd.lE(Va)?this.wKc:this.pKc)this.xak(td,Fb);Ic=!0}if(bc){for(const td of jd.lE(Va)?this.wKc:this.pKc)this.N6k(qa,td,bc);Ic=!0}Ic&&this.T7f.M6k(this.wKc,this.pKc);this.T7f.NPk(L,qa,Va)}xak(L,qa){const Va=new Af.a;for(var Fb of L.Z3b){const bc=
qa[mg[Fb].toLowerCase()];Va.add(new Uc.a(la.c(bc)?Number.MAX_VALUE:bc,Fb))}if(Va.count){Va.Sc((bc,Ic)=>bc.key<Ic.key?-1:1);qa=Array(Va.count);for(Fb=0;Fb<Va.count;Fb++)qa[Fb]=Va.ma(Fb).value;L.Z3b=qa}}N6k(L,qa,Va){let Fb=0;for(const bc of qa.Z3b)if(mg[bc].toLowerCase()in Va&&Va[mg[bc].toLowerCase()])for(const Ic of L)if(Ic.groupType===bc){Fb+=Va[mg[bc].toLowerCase()];break}qa.ENd=Fb}}Object(m.a)(Cj,"SimplifiedGroupingSorter",null,[]);class Li{constructor(L){this.u8f={};this.s8f={};this.t8f={};this.x8f=
{};this.U1d={};this.A8f=this.OAj=this.FAj=this.HAj=1;this.F8f=null;this.$q=L;this.yMh();this.s4j();this.nMh();this.nLh();L.KH&&(this.F8f=new Cj)}Ty(L){this.u8f[mg[L].toLowerCase()]=this.HAj++}JA(L,qa){this.s8f[mg[L].toLowerCase()]=qa}Oda(L){this.t8f[mg[L].toLowerCase()]=this.FAj++}HN(L){this.x8f[mg[L].toLowerCase()]=this.OAj++}nx(L){this.U1d[mg[L].toLowerCase()]=this.A8f++}yMh(){const L=!!this.$q&&this.$q.QKa,qa=!!this.$q&&this.$q.j0b,Va=!!this.$q&&this.$q.RKa,Fb=!!this.$q&&this.$q.tXd&&!jd.pnb(),
bc=!!this.$q&&this.$q.ZVb,Ic=!!this.$q&&this.$q.VDc,td=!!this.$q&&this.$q.rVd,Hd=!!this.$q&&this.$q.SDc,pe=!!this.$q&&this.$q.jUd;this.$q&&(this.$q.fuc||this.$q.O_||this.$q.juc)&&this.Ty(26);Hd&&this.Ty(24);this.Ty(4);this.Ty(18);this.Ty(16);this.Ty(7);this.Ty(17);this.Ty(0);this.Ty(1);td&&this.Ty(28);bc&&this.Ty(23);L||this.Ty(2);L&&!qa||this.Ty(8);this.Ty(15);Va&&this.Ty(20);this.Ty(14);this.Ty(9);this.Ty(12);this.Ty(10);this.Ty(11);L&&this.Ty(2);L&&!qa&&this.Ty(8);this.Ty(19);Ic&&this.Ty(27);this.Ty(21);
this.Ty(13);pe&&this.Ty(30);Fb&&this.Ty(22);this.Ty(31)}s4j(){this.JA(21,1);this.JA(4,3);this.JA(18,3);this.JA(16,3);this.JA(7,3);this.JA(17,5);this.JA(0,5);this.JA(1,1);this.JA(28,2);this.JA(2,1);this.JA(8,2);this.JA(15,3);this.JA(14,2);this.JA(27,3);this.JA(9,1);this.JA(12,1);this.JA(10,1);this.JA(11,1);this.JA(19,1);this.JA(23,1);this.JA(13,1);this.JA(24,1);this.JA(25,1);this.JA(20,2);this.JA(22,1);this.JA(26,1);this.JA(30,1)}nMh(){this.Oda(4);this.Oda(0);this.Oda(17);this.Oda(7);this.Oda(16);
this.Oda(18);this.Oda(15);this.Oda(30);this.Oda(20);this.Oda(8);this.Oda(14)}nLh(){this.HN(14);this.HN(10);this.HN(12);this.HN(9);this.HN(11);this.HN(20);this.HN(15);this.HN(30);this.HN(8);this.HN(2);this.HN(1);this.HN(27);this.HN(7);this.HN(18);this.HN(16);this.HN(17);this.HN(0);this.HN(4)}Wok(){this.U1d={};this.A8f=1}kTi(L,qa,Va){this.Wok();const Fb=!!this.$q&&this.$q.QKa,bc=!!this.$q&&this.$q.j0b,Ic=!!this.$q&&this.$q.RKa,td=!!this.$q&&this.$q.tXd&&!jd.pnb(),Hd=!!this.$q&&this.$q.ZVb,pe=!!this.$q&&
this.$q.VDc,Ke=!!this.$q&&this.$q.rVd,uf=!!this.$q&&this.$q.jUd,zf=!!this.$q&&this.$q.tXc,bg=!!this.$q&&this.$q.SDc;L=L&&bc;zf&&this.nx(25);this.nx(4);this.nx(18);this.nx(16);this.nx(7);this.nx(17);this.nx(0);this.nx(1);bg&&this.nx(24);Ke&&this.nx(28);Hd&&this.nx(23);uf&&this.nx(30);Fb&&!bc||!L||this.nx(8);qa&&this.nx(15);Fb||this.nx(2);pe&&this.nx(27);Va&&this.nx(14);Fb&&!bc||L||this.nx(8);qa||this.nx(15);Ic&&this.nx(20);Va||this.nx(14);this.nx(9);this.nx(12);this.nx(10);this.nx(11);Fb&&this.nx(2);
Fb&&!bc&&this.nx(8);this.nx(19);this.nx(21);this.nx(13);td&&this.nx(22);return this.U1d}eE(){return this.$q}}Object(m.a)(Li,"GroupsPlacementInfo",null,[]);var Eh=a(109);class Ih{constructor(L,qa,Va,Fb,bc,Ic){this.groupType=L;this.resultType=qa;this.vse=Va;this.zZa=Fb;this.Uzd=bc;this.resultIndex=Ic}}Object(m.a)(Ih,"ClickLoggingInfo",null,[]);const qi=L=>{const qa=[];for(;L;)Array.add(qa,"{ContextId:"+L.contextId+", IsGraphNodeContext:"+L.tUb+"}"),L=L.Mpb;qa.reverse();return"{"+qa.join(", ")+"}"};
class Si{constructor(){this.interactionId=this.sessionId=null}}Object(m.a)(Si,"CorrelationRecord",null,[626]);class dj{constructor(L,qa){this.provider=L;this.t8a=qa}}Object(m.a)(dj,"ExternalResultProvider",null,[]);class ri{constructor(L,qa){this.Id=null;this.TimeStamp=0;this.Id=L;this.TimeStamp=qa}}Object(m.a)(ri,"MRUControl",null,[]);var Ig;(function(L){L[L.d8g=0]="Answer";L[L.E9g=1]="Definition";L[L.O9g=2]="Entity";L[L.Cch=3]="WolframAnswer";L[L.g8g=4]="Assistance";L[L.Command=5]="Command";L[L.Document=
6]="Document";L[L.Cbh=7]="TryQuery";L[L.$9g=8]="FindInDocument";L[L.qel=9]="HelpAction";L[L.A$g=10]="Insights";L[L.People=11]="People";L[L.Image=12]="Image";L[L.fel=13]="FirstRunResult";L[L.dfl=14]="NoCommandsFoundResult";L[L.Bbh=15]="TestResult";L[L.Gcl=16]="AppsForOffice_Installed";L[L.Icl=17]="AppsForOffice_Recommandation";L[L.Hcl=18]="AppsForOffice_Query";L[L.efl=19]="Notes_Onenote";L[L.ffl=20]="Notes_Samsung";L[L.gfl=21]="Notes_Sticky";L[L.I$g=22]="Learning";L[L.Feedback=23]="Feedback";L[L.Abh=
24]="Template";L[L.X7g=25]="ActionAI";L[L.Y7g=26]="ActionAICommand";L[L.a8g=27]="Addin";L[L.$$g=28]="OfficeScript";L[L.c8g=29]="AddinStoreEntry";L[L.hel=30]="GenerateSlides";L[L.mbh=31]="SummarizeDeck";L[L.Formula=32]="Formula";L[L.Unknown=33]="Unknown"})(Ig||(Ig={}));Object(m.b)("ResultType",Ig);var Fh=a(956);class si{constructor(L,qa){this.Clh=10;this.iT=[];this.mda=[];this.ULe=this.TLe=!1;this.JCb=this.ICb="";this.Eab=qa;this.Wg=L}HIa(){!this.TLe&&this.Wg&&(this.ICb="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+
this.Wg.application,this.iT=this.zBf(),this.TLe=!0);return this.iT}CRi(){!this.ULe&&this.Wg&&(this.JCb="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.Wg.application,this.mda=this.zBf(!0),this.ULe=!0);return this.mda}Upj(L){return L.startsWith("TellMeUpsell")||"OpenInClientUpsell"===L||"TryOfficeUpsell"===L}aTd(L){return this.Cej(L)||this.Upj(L)||jd.c0f(L)?!1:!0}Aka(L){L=L.ControlId;this.aTd(L)&&(L=this.Nfe(L),this.qhk(L),this.lBj(),Array.insert(this.iT,0,new ri(L,Date.now())),this.ICb.length&&(L=JSON.stringify(this.iT),
Fh.a.instance.setItem(this.ICb,L)))}Lz(L){this.kBj();Array.insert(this.mda,0,new ri(Ig[L],Date.now()));this.JCb.length&&(L=JSON.stringify(this.mda),Fh.a.instance.setItem(this.JCb,L))}zBf(L){L=void 0===L?!1:L;if(!this.iT.length){var qa=L?Fh.a.instance.getItem(this.JCb):Fh.a.instance.getItem(this.ICb);if(!qa||""===qa)return L?this.mda:this.iT;let Va=null;try{Va=JSON.parse(qa)}catch(Fb){this.rTh(L),Va=null}if(!Va||!Va.length||10<Va.length)return L?this.mda:this.iT;qa=0;for(const Fb of Va)if(L||this.Wg.Bnb(Fb.Id)&&
this.aTd(Fb.Id))if(L?Array.insert(this.mda,qa++,Fb):Array.insert(this.iT,qa++,Fb),qa===this.Eab)break}return L?this.mda:this.iT}dKb(L){L=this.Nfe(L);for(const qa of this.iT)if(qa.Id===L)return!0;return!1}rTh(L){Fh.a.instance.setItem((void 0===L?0:L)?this.JCb:this.ICb,"")}ogj(L){L=this.Nfe(L.ControlId);return this.aTd(L)?this.dKb(L):!1}qhk(L){if(0<this.iT.length){let qa=0;for(const Va of this.iT){if(Va.Id===L){Array.removeAt(this.iT,qa);break}qa++}}}Nfe(L){return"Excel"===this.Wg.application&&L.startsWith("m_excelWebRenderer_ewaCtl_")?
L.substr(26,L.length):L}lBj(){this.iT.length===this.Eab&&Array.removeAt(this.iT,this.iT.length-1)}kBj(){this.mda.length===this.Clh&&Array.removeAt(this.mda,this.mda.length-1)}Cej(L){L=L.split("|");let qa="";if(6<=L.length)qa=L[0];else if(3<=L.length){if("3"===L[0])return!0;qa=L[1]}return qa.startsWith("WA")}static createInstance(L){let qa=3;R.AFrameworkApplication.fa&&(qa=R.AFrameworkApplication.fa.vj("TellMeMaxRecommendedResultsToReturn",3));return new si(L,qa)}}Object(m.a)(si,"MruControlsManager",
null,[625]);class Yh{constructor(L){this.ISa=L}x_(L,qa){let Va;return L.GK&&(Va=this.ISa[L.value])?Va.x_(L,qa):(Va=this.pCf(L.value))?Va.x_(Va.OEj,qa):null}hQi(L,qa){if(L=this.ISa[L])for(const Va of qa)if(qa=jd.getParameter(Va),qa.key===L.O0j)return qa.value;return null}JHj(L){(L=this.pCf(L))&&L.HHj()}pCf(L){const qa=L.indexOf(jd.N0j);return 0<qa?this.ISa[L.substring(0,qa)]:null}}Object(m.a)(Yh,"ParameterizedCommandManager",null,[623]);class ti{constructor(L,qa){this.Ij=L;this.kNa=qa}}Object(m.a)(ti,
"TellMeQuery",null,[]);class ni{constructor(L,qa){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=L;this.TimeElapsedSinceClick=qa}}Object(m.a)(ni,"CommandClickedEvent",null,[]);class nj{constructor(L,qa){this.lmh=L;this.LDb=qa}gr(L){this.lmh(la.c(L.query)?"":L.query.Ij,L.lo,L.attributes,this.LDb,L.Qmb)}}Object(m.a)(nj,"ResultsUpdatedCallback",null,[624]);class Ti{constructor(L,qa,Va,Fb,bc){this.CommandId=this.ControlId=null;this.TimeElapsedSinceClick=0;this.TerminalParentControlId=this.CommandSurface=
null;this.ControlId=L;this.TimeElapsedSinceClick=Va;this.CommandSurface=Fb;this.CommandId=qa;this.TerminalParentControlId=bc}}Object(m.a)(Ti,"UserActionEvent",null,[]);class ei{constructor(L,qa){this.menuModel=L;this.BFg=qa}}Object(m.a)(ei,"GeneratedMenuModel",null,[]);class fi{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=!1;this.ariaRoleDescription=null}}Object(m.a)(fi,"MenuModel",null,[]);class fg{constructor(L,qa,Va){this.Wg=L;this.ISa=qa;this.ATa=Va}cBi(L,qa,
Va){let Fb=0;const bc=new fi,Ic=[];let td="";bc.sections=[];let Hd=new Af.a;const pe=!!this.Wg&&this.Wg.QKa;var Ke=!!this.Wg&&this.Wg.Dvb||R.AFrameworkApplication.ra.$d.Dvb;for(const zf of L){L=0;pe||(Hd=new Af.a);const bg=new Af.a;let kg=zf.displayName;for(const ug of zf.results){if(0<=ug.value.indexOf(jd.Pqe)){if(ug.GK){var uf=this.ISa[ug.value];if(uf&&ug.value.endsWith(jd.Pqe)){if("FindParameterized"!==ug.value&&!Ke){const Gg=[];Gg.push(appChrome.actions.setControlLabel(ug.value,uf.sFf(ug)));Gg.push(appChrome.actions.setButtonCommandValueId(ug.value,
uf.CFi(ug)));appChrome.api.dispatch(Gg)}uf=ug.value.replace(jd.Pqe,"");Hd.remove(uf)?L--:bg.add(uf);Hd.add(ug.value);L++}}}else switch(ug.type){case 5:bg.contains(ug.value)||(Hd.add(ug.value),L++);break;case 7:Hd.add(ug.GK);L++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 25:case 26:case 6:case 19:case 20:case 21:case 27:case 29:case 28:case 30:case 32:case 31:Hd.add(ug.value),L++}13===zf.groupType&&(kg=jd.Z5()?0<qa.length?String.format(Object(mc.a)("SeeMoreResultsButtonText"),
qa):Object(mc.a)("SeeMoreResultsButtonTextNonParameteried"):String.format(Object(mc.a)("InsightsButtonText"),qa));21===zf.groupType&&(kg=Object(mc.a)("LearningUILiveText"))}Fb+=L;""!==kg&&0<L&&(td+=" , "+L.toString()+" "+Object(mc.a)("TellMeSectionLiveNotification")+" "+kg+" , ");0<Hd.count&&!pe&&(L=appChrome.api.menuSection(Hd.toArray(),zf.displayName,null,mg[zf.groupType]),Ic.push(L))}Ke=null;0<Fb&&(Ke=0<qa.length?1!==Fb?String.format(Object(mc.a)("SearchLiveNotificationForTermedQueryResults"),
Fb,qa):String.format(Object(mc.a)("SearchLiveNotificationForTermedQueryResult"),qa):1!==Fb?String.format(Object(mc.a)("LookupLiveNotificationResultPluralFormText"),Fb):Object(mc.a)("LookupLiveNotificationResultSingularFormText"),pe?(qa=appChrome.api.menuSection(Hd.toArray(),"",null,null),Ic.push(qa)):Ke+=td);Va&&(this.Wg.R$?Kd.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(Ke)):appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(Ke)));bc.sections=Ic;return new ei(bc,
Fb,[])}static get lBd(){return fg.UHe||(fg.UHe=new ei(Object.assign(new fi,{sections:[]}),0,[]))}}fg.UHe=null;Object(m.a)(fg,"TellMeMenuDefintionGenerator",null,[]);var uh;(function(L){L[L.egl=0]="TellMeControlActivated";L[L.ggl=1]="TellMeQueryExecuted";L[L.igl=2]="TellMeResultsRendered";L[L.fgl=3]="TellMeControlDeactivated"})(uh||(uh={}));Object(m.b)("PerformanceMarker",uh);var Jh;(function(L){L[L.kgl=0]="TellMeTimeToRender";L[L.jgl=1]="TellMeSessionLength";L[L.hgl=2]="TellMeResultTriageTime"})(Jh||
(Jh={}));Object(m.b)("PerformanceMeasure",Jh);class sh{mark(L){window.performance.mark(uh[L])}measure(L,qa,Va){try{window.performance.measure(Jh[L],uh[qa],uh[Va])}catch(Fb){Kd.instance.xk().onError("TellMePerformance:Measure","error measuring "+Jh[L])}}q0d(L,qa,Va){Kd.instance.xk().z0d(qa,Va,L,this.FNi(L))}ITh(){var L=[0,1,2,3];for(const qa of L)window.performance.clearMarks(uh[qa])}clearMeasures(L){for(const qa of L)window.performance.clearMeasures(Jh[qa])}FNi(L){let qa=0;(L=this.kCi(L))&&0<L.length&&
(qa=L[L.length-1].duration);return qa}kCi(L){return window.performance.getEntriesByName(Jh[L],"measure")}}Object(m.a)(sh,"TellMePerformance",null,[]);class Nh{constructor(L){this.rqh=L}U_b(L,qa,Va){Kd.instance.xk().dba(qa,og.vsb,L.data.httpStatus.toString(),Math.round(window.performance.now()-Va),og.vsb,!0,gg.dna);L=qc.b(L.data.responseData);qa=-1;L.Index&&(qa=L.Index);Kd.instance.xk().Lyj(qa,this.rqh)}c_b(L,qa,Va){Kd.instance.xk().dba(qa,og.vsb,L.data.httpStatus.toString(),Math.round(window.performance.now()-
Va),og.vsb,!1,gg.dna)}ERi(L){if(L&&""!==L.trim()){const Va=window.performance.now(),Fb=R.AFrameworkApplication.lXg;var qa={};qa.Text=L;qa.IsFileHash="false";qa=qc.c(qa);R.AFrameworkApplication.$i.Ou(Fb,2,qa,{"Content-Type":"application/json",Accept:"application/json"},!1,0,bc=>{this.U_b(bc,L.length,Va)},bc=>{this.c_b(bc,L.length,Va)},null,null,!1,4E3,6E3)}}}Object(m.a)(Nh,"TellMeQueryIndexCallback",null,[]);class oi{constructor(L,qa,Va){this.xml=L;this.BFg=qa;this.zci=Va}}Object(m.a)(oi,"GeneratedMenuXml",
null,[]);class gi{constructor(L,qa){this.Lbc=L||{};this.nsa=qa}get F5a(){return 5}x_(L,qa){return this.nsa.x_(L,void 0===qa?null:qa)||this.PKh(L.value)}PKh(L){return gi.krd(L,this.Lbc[L]||null)}static krd(L,qa){qa=void 0===qa?null:qa;L=String.format('<ClonedControl Id="{0}" ',L);for(const bc in qa){var Va=bc,Fb=qa[bc];Fb=Fb?ba.a.Yl(Fb.toString()):"";L+=String.format('{0}="{1}" ',Va,Fb)}return L+"/>"}}Object(m.a)(gi,"CommandMenuItemFactory",null,[602]);class Ui{constructor(){this.Ghh=Object(mc.a)("FindInDocumentText")}get F5a(){return 8}x_(L){var qa=
L.GK;L=ba.a.Yl(L.value);const Va=ba.a.Yl(qa);qa=ba.a.Yl(String.format(this.Ghh,qa));return this.Bzi(L,Va,qa)}Bzi(L,qa,Va){return cc.a(L,"1540292897",Va,jd.Cui,null,qa,Va,null,null)}}Object(m.a)(Ui,"FindInDocumentMenuItemFactory",null,[602]);class ui{constructor(L){this.tjh=(void 0===L?null:L)||Object(mc.a)("InsightsButtonText")}get F5a(){return 10}x_(L){var qa=L.GK;L=jd.Z5()?jd.Oua(qa,1):jd.rxd(qa);qa=String.format(this.tjh,qa);return this.Zzi(L,qa)}Zzi(L,qa){return cc.a(bd.xSf,jd.Z5()?"1914896509":
"3317204163",ba.a.Yl(qa),jd.ocj,null,ba.a.Yl(L),ba.a.Yl(qa),null,null)}}Object(m.a)(ui,"InsightsMenuItemFactory",null,[602]);class Mi{get F5a(){return 7}x_(L){const qa=Object(Ah.a)(Df,L);return this.kBi(ba.a.Yl(L.value),qa.id)}kBi(L,qa){return cc.a(qa,"1404166600",L,null,null,L,L,null,null)}}Object(m.a)(Mi,"TryQueryMenuItemFactory",null,[602]);class ej{constructor(L){this.qIe=[];this.Wg=L}bJi(L){for(const qa of this.qIe)if(qa.F5a===L)return qa;return null}xNa(L){this.qIe.push(L)}$dk(L){this.xNa(new gi(this.Wg.lZh,
L));this.xNa(new yd(this.Wg.Lbg));this.xNa(new Sa(this.Wg.Muk,this.Wg.Luk,this.Wg.$Uk,this.Wg.c5i,this.Wg.THk));this.xNa(new ui);this.xNa(new Ui);this.xNa(new Ac);this.xNa(new Mi)}}Object(m.a)(ej,"MenuItemFactoryRegistry",null,[]);class vi{constructor(L,qa){this.Wg=L;this.XOe=new ej(this.Wg);this.XOe.$dk(qa)}dBi(L,qa){let Va=0;const Fb=[],bc=[];for(const td of L){L=jd.Ate;var Ic=[];for(const Hd of td.results){const pe=this.XOe.bJi(Hd.type).x_(Hd,qa);L=jd.Ate;Ic.push(pe);if(13===Hd.type||14===Hd.type)L=
"Menu32";17===Hd.type&&(L="MenuTellMeExtended");Hd.groupType=td.groupType;bc.push(Object(Ah.a)(Fd,Hd))}Va=Va?Va:Ic.length;Ic=cc.e("TellMeDropdownControls",Ic);L=cc.h("TellMeDropdownMenuSection",Ic,L,td.displayName);Fb.push(L)}qa=cc.i(Fb,"LookupDropdownMenu");return new oi(qa,Va,bc)}static get euc(){return vi.VHe||(vi.VHe=new oi(cc.i([],"LookupDropdownMenu"),0,[]))}}vi.VHe=null;Object(m.a)(vi,"TellMeXmlGenerator",null,[]);class wi{}wi.jFj="MRU";wi.test="Test";Object(m.a)(wi,"ActionType",null,[]);var xi;
(function(L){L[L.Tfl=0]="Service";L[L.Local=1]="Local";L[L.Nel=2]="MRU";L[L.Bbh=3]="TestResult";L[L.Unknown=4]="Unknown"})(xi||(xi={}));Object(m.b)("SubResultType",xi);var Vi=a(94);class Ni{constructor(L,qa,Va,Fb,bc){bc=void 0===bc?null:bc;this.CommandId=null;this.IsEnabled=!1;this.OptionalData=this.SubResultType=this.ResultType=null;this.CommandId=L;this.IsEnabled=qa;this.ResultType=Ig[Va];this.SubResultType=xi[Fb];this.OptionalData=bc?Vi.a.toJSON(bc):null}}Object(m.a)(Ni,"ResultInfo",null,[]);var fj=
a(125),tj=a(180),ai=a(308);class bi{constructor(L,qa){this.UKe="TellMeWAC.";this.Gmh=L;this.Xqh=void 0===qa?null:qa}gia(L,qa,Va){qa=fj.a.rn(qa);L=fj.a.brc(L,this.Gmh,this.Xqh,Va,qa);tj.a.gia(L,this.UKe)}yAa(L,qa,Va){Va=void 0===Va?0:Va;qa=fj.a.rn(qa);tj.a.yAa(Object.assign(new ai.a,{name:L,dataFields:qa,durationMs:Va}),this.UKe)}}Object(m.a)(bi,"TellMeOtelLogger",null,[634]);class ji{constructor(L,qa,Va,Fb,bc,Ic,td){this.kT=this.e3=this.XFe=null;this.nG=L;this.Tzb=qa;this.gka=Va;this.zDa=Fb;this.Wra=
bc;this.Ekh=Ic;this.kT=td?td:new bi(this.zDa?Eh.a.Oqe:Eh.a.a_c)}get Aq(){return this.zDa}get oV(){return this.gka}yWc(L){this.XFe=L;switch(L){case vc.contextMenu:this.e3=vc.contextMenu;break;default:this.e3=vc.tellMe}}uIh(L,qa){this.gka.interactionId||(this.gka.interactionId=ph.a.create().toString(),this.Y4f(L,!0,qa))}Gpf(L,qa){this.gka.interactionId&&this.gxj(L,void 0===qa?!0:qa);this.zDa&&appChrome.api.updateTellMeCorrelationId("");this.gka.interactionId=null}Y4f(L,qa,Va){const Fb=this.VT(Bd.dKa);
Fb[Tc.culture]=this.Tzb;Fb[Tc.appName]=this.nG;Fb[Tc.context]=L;Fb[Tc.lHc]=this.Wra;Fb[Tc.Rpj]=this.Ekh;Fb[Tc.Toj]=Va;Fb[Tc.qkj]=qa;Fb[Tc.contentType]=Kd.instance.jLb;this.kT.gia(Bd.dKa,Fb,this.XFe);this.zDa&&appChrome.api.updateTellMeCorrelationId(this.gka.interactionId)}gxj(L,qa){const Va=this.VT(Bd.p_a);Va[Tc.Nei]=L;Va[Tc.pkj]=qa;this.kT.yAa(Bd.p_a,Va)}Kyj(L,qa,Va){let Fb=0;!Va&&0<L.length&&(Fb=L.trim().split(" ").length);const bc=this.VT(Bd.query);bc[Tc.query]="!";bc[Tc.v4a]=qa;bc[Tc.uvg]=L.length;
bc[Tc.e1f]=Va;bc[Tc.cbl]=Fb;this.kT.gia(Bd.query,bc,this.e3)}Uxj(L,qa,Va,Fb,bc,Ic,td){var Hd=null;Hd=void 0===Hd?null:Hd;const pe=this.VT(Bd.latency);pe[Tc.culture]=this.Tzb;pe[Tc.uvg]=L;pe[Tc.e0g]=qa;pe[Tc.statusCode]=Va;pe[Tc.Vba]=bc;pe[Tc.isSuccess]=Ic;pe[Tc.Usj]=td;Hd&&(pe[Tc.AXk]=Hd);this.kT.yAa(Bd.latency,pe,Fb)}z0d(L,qa,Va,Fb){const bc=this.VT(Bd.performance);bc[Tc.culture]=this.Tzb;bc[Tc.yIh]=uh[L];bc[Tc.ihi]=uh[qa];bc[Tc.z2j]=Jh[Va];this.kT.yAa(Bd.performance,bc,Fb)}Wyj(L,qa){if(L.results.length){var Va=
this.VT(Bd.hDg);Va[Tc.zZa]=qa.toString();Va[Tc.groupType]=mg[L.groupType];16===L.groupType&&(Va[Tc.Boj]=Kd.instance.YBa);qa=[];var Fb=[],bc=[];for(const Ic of L.results)Va[Tc.resultType]||(Va[Tc.resultType]=Ig[Ic.type]),L={},27===Ic.type&&(L.AssetId=Ic.additionalInfo),Fb.push(Ge.faa(Ic.value)),qa.push(Ic.value),bc.push(new Ni(Ic.value,Ge.faa(Ic.value),Ic.type,Ic.subType,L));0<qa.length&&(Va[Tc.pqk]="{"+qa.join(", ")+"}",Va[Tc.Rgi]="{"+Fb.join(", ")+"}",Va[Tc.mqk]=qc.c(bc));this.kT.gia(Bd.hDg,Va,this.e3)}}GBi(L,
qa){if(4===L)return wi.jFj;switch(qa){case 5:case 16:case 17:case 18:return"Command";case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return Ig[qa]}Pwj(L,qa,Va,Fb,bc){const Ic=this.VT(Bd.click);Ic[Tc.e0g]=L;Ic[Tc.Y0j]=qa;Ic[Tc.commandId]=Va;Ic[Tc.QQ]=Fb;Ic[Tc.actionType]=this.GBi(bc.groupType,bc.resultType);Ic[Tc.resultType]=Ig[bc.resultType];Ic[Tc.vse]=xi[bc.vse];Ic[Tc.groupType]=mg[bc.groupType];Ic[Tc.zZa]=bc.zZa.toString();Ic[Tc.Uzd]=bc.Uzd.toString();
Ic[Tc.resultIndex]=bc.resultIndex.toString();this.kT.gia(Bd.click,Ic,this.e3)}Twj(L,qa){this.gka.interactionId||(this.gka.interactionId=ph.a.create().toString(),this.Y4f("",!1,qa));qa=this.VT(Bd.nff);qa[Tc.v4a]=L;this.kT.yAa(Bd.nff,qa)}u5f(L,qa,Va){if(L){if(Va)for(const Fb in Va)L[Fb]=Va[Fb];this.kT.yAa(Bd.events,L,qa)}}nxj(L,qa,Va){Va=void 0===Va?null:Va;const Fb=this.VT(Bd.events);Fb[Tc.event]=L;this.u5f(Fb,Math.round(qa),Va)}SU(L,qa,Va){Va=void 0===Va?null:Va;const Fb=this.VT(Bd.events);Fb[Tc.event]=
Bd.error;Fb[Tc.module]=L;Fb[Tc.errorMessage]=qa;Fb[Tc.message]=qa;this.u5f(Fb,Math.round(window.performance.now()),Va)}Mwj(L){const qa=this.VT(Bd.sdf);qa[Tc.value]=L;qa[Tc.lRc]=this.zDa;this.kT.gia(Bd.sdf,qa,this.e3)}nwj(L){const qa=this.VT(Bd.pYe);qa[Tc.value]=L;qa[Tc.lRc]=this.zDa;this.kT.gia(Bd.pYe,qa,this.e3)}xxj(L){const qa=this.VT(Bd.Ewf);qa[Tc.value]=L;qa[Tc.lRc]=this.zDa;this.kT.gia(Bd.Ewf,qa,this.e3)}Jyj(L){const qa=this.VT(Bd.gvg);qa[Tc.value]=L;qa[Tc.lRc]=this.zDa;this.kT.gia(Bd.gvg,qa,
this.e3)}uwj(L){const qa=this.VT(Bd.nKg);qa[Tc.value]=L;this.kT.gia(Bd.nKg,qa,this.e3)}Myj(L,qa){const Va=this.VT(Bd.tvg);Va[Tc.vsb]=L;qa&&(Va[Tc.interactionId]=qa);this.kT.yAa(Bd.tvg,Va)}VT(L){return{["SessionID"]:this.gka.sessionId,["CorrelationID"]:this.gka.interactionId,["Time"]:(new Date).getTime(),["Event"]:L,["Scenario"]:this.e3}}}Object(m.a)(ji,"UsageLogger",null,[622]);var Wi=a(128),Ij=a(1277),Ef=a(845),Ci=a(475);a(1036);a(525);class kf{constructor(L){L=void 0===L?null:L;this.nsa=this.Ei=
this.Ga=this.DZ=this.EZ=this.$j=this.$c=this.RD=this.ydd=this.ZXe=this.c3=null;this.tMe=this.lab=!1;this.V9a=null;this.OBb=this.Wra=!1;this.QCa=this.f$a=this.Sca=this.qgc=this.Hdc=null;this.X$a=!1;this.Ddd=0;this.L9a=null;this.ZOe=0;this.VBb=!1;this.Mo=this.AQ=this.bDa=null;this.K9j=(qa,Va,Fb,bc,Ic)=>{if(1===Fb)return 32;if(la.c(Ic))return kf.instance.Nm.onError("TellMeActor:QuickActionOnFileHandler","actiondata comes null"),16;this.Ei.eyf();if(qa=Ic.TerminalParentControlId){qa=this.kua.ma(qa);if(!qa)return 16;
Va=[];Array.add(Va,qa);if(!this.t3f(Va))return 8}return 32};this.WAi=()=>{if(!this.kua.count)return 16;const qa=[];for(const Va of this.kua.values)Array.add(qa,Va);return this.t3f(qa)?32:8};this.sDc=(qa,Va,Fb,bc,Ic)=>{if(1===Fb)return 32;if(la.c(Ic))return kf.instance.Nm.onError("TellMeActor:InsertMention","actiondata comes null"),16;qa=Ic.UILocation;let td;Ic=Ic.CommandValueId;try{td=qc.a(Ic)}catch(Hd){return kf.instance.Nm.onError("TellMeActor:InsertMention","commandValueId is not in proper format"),
16}return la.c(td)?(kf.instance.Nm.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):la.c(this.Hdc)?(kf.instance.Nm.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),16):19!==qa?(kf.instance.Nm.onError("TellMeActor:InsertMention","location "+qa+" is unexpected"),16):this.Hdc.sDc(td.displayName,td.email,td.userId)?32:(kf.instance.Nm.onError("TellMeActor:InsertMention","mention is not inserted"),16)};this.qza=(qa,Va,Fb,bc,Ic)=>1===Fb?32:la.c(Ic)?(kf.instance.Nm.onError("TellMeActor:OpenOrInsertUrl",
"actiondata comes null"),16):19===Ic.UILocation?this.ncj(Fb,Ic):this.openUrlInNewTab(qa,Va,Fb,bc,Ic);this.openFeedback=(qa,Va,Fb,bc,Ic)=>{if(1===Fb)return 32;if(la.c(Ic))return kf.instance.Nm.onError("TellMeActor:OpenFeedback","actiondata comes null"),16;this.AQ&&window.setTimeout(()=>{this.AQ.execute(td=>{td.$vb("TellMeSurvey",null)})},kf.Fsi);return 32};this.eba=(qa,Va,Fb,bc,Ic)=>{Fb=window.performance.now();this.X3j(Va);kf.instance.Nm.kBk(Va);kf.instance.pn.Aq?(this.QCa=this.ydd.cBi(Va,qa,Ic),
kf.instance.pn.R$?(kf.instance.actions.push(appChrome.actions.updateTellMeSearchResults(this.QCa.menuModel,qa,Ic)),appChrome.api.dispatch(kf.instance.actions)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.QCa.menuModel,qa,Ic)),kf.instance.pn.b2c&&this.X$a&&(la.c(kf.instance.OH)||kf.instance.OH.Location!==vc.contextMenu)&&(this.RD.mark(2),this.RD.measure(0,1,2))):this.Sca=this.ZXe.dBi(Va,kf.instance.Nm.oV);this.L9a&&this.$j.Ol(this.L9a);Ic={};Ic.GroupsCount=Va.length;Ic.QueryID=
bc;Ic.QueryLength=qa.length;kf.instance.Nm.bV(Bd.B5h,window.performance.now()-Fb,Ic)};this.Zsj=(qa,Va,Fb,bc,Ic)=>{if(1===Fb)return 32;if(la.c(Ic))return kf.instance.Nm.onError("TellMeActor:LaunchAddinStore","actiondata comes null"),16;if(this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinActionDataRefactor",!1)){qa={};qa.SourceControlId=Ic.SourceControlId;qa.Query=Ic.CommandValueId;Ic=this.$c.Xj(Y.a.dXb,2,qa);if(32!==Ic)kf.instance.Nm.onError("TellMeActor:LaunchAddinStore","CommonCommands.LaunchAppforOfficeDialog failed. Response: "+
Ic+".");return Ic}return this.$c.Xj(Y.a.dXb,2,Ic)};this.e_d=(qa,Va,Fb,bc,Ic)=>{if(1===Fb)return 32;if(la.c(Ic))return kf.instance.Nm.onError("TellMeActor:LaunchAddin","actiondata comes null"),16;qa=Ic.CommandValueId;if(la.b(qa))return kf.instance.Nm.onError("TellMeActor:LaunchAddin","Add-in assetId is null"),16;if(!Ae.kUa[qa])return kf.instance.Nm.onError("TellMeActor:LaunchAddin","Add-in with assetId "+qa+" doesn't not exist in entitlements"),16;Va=Ae.kUa[qa];Fb={};Fb.solutionId=Va.id;Fb.version=
Va.appVersion;Fb.storeType=Va.storeType;Fb.storeId=Va.storeId;Fb.assetId=Va.assetId;Fb.assetStoreId=Va.assetStoreId;Fb.displayName=Va.displayName;Fb.targetType=Va.targetType;Fb.height=Va.height;Fb.width=Va.width;Va=this.$c.Xj(Y.a.rSf,2,Fb);if(32!==Va)kf.instance.Nm.onError("TellMeActor:LaunchAddin","CommonCommands.InsertOfficeAddin failed. Response: "+Va+". AssetId: "+qa);return Va};this.YXc=()=>{if(!la.c(this.AQ))for(const qa of Ji.a.instance.bRa){if("ShowContextMenuWithFloatie"===qa.commandId)return this.AQ.execute(Va=>
{Va.logActivity("TellMe1TabSwitchCoachMarkActivity",null)}),32;if(qa.commandId&&-1===qa.commandId.indexOf("Tab"))break}return 8};this.Mo=L?L:new Kd}dyc(){return this.Mo.dyc()}dId(){return this.Mo.dId()}LMd(){return this.Mo.LMd()}ZHd(){return this.Mo.ZHd()}$Hd(){return this.Mo.$Hd()}get jLb(){return this.DZ?this.DZ.contentType:kf.unknown}oKd(){return this.Mo.X0}xk(){return this.Mo.xk()}get actions(){return this.Mo.actions}set actions(L){this.Mo.actions=L}ikb(){return this.Mo.ikb()}eE(){return this.Mo.eE()}FJd(){return this.Mo.FJd()}get GYb(){return this.Mo.GYb}set Hdd(L){this.Mo.GYb=
L}get x$b(){return this.Mo.x$b}set tfc(L){this.Mo.x$b=L}tMd(){return this.Mo.tMd()}performance(){return this.RD}get d7b(){return this.Mo.b7a}set d7b(L){this.Mo.b7a=L}get YBa(){return this.Mo.YBa}set YBa(L){this.Mo.YBa=L}wca(L){return this.Mo.wca(L)}initialize(L,qa,Va,Fb,bc,Ic,td,Hd,pe,Ke,uf){qa=void 0===qa?null:qa;Va=void 0===Va?null:Va;Fb=void 0===Fb?null:Fb;bc=void 0===bc?null:bc;Ic=void 0===Ic?null:Ic;td=void 0===td?null:td;Hd=void 0===Hd?null:Hd;pe=void 0===pe?null:pe;Ke=void 0===Ke?null:Ke;uf=
void 0===uf?null:uf;kf.instance.pn=L;this.Wra=!!R.AFrameworkApplication.ra&&R.AFrameworkApplication.ra.$d.VWd;kf.instance.Nm=Fb;if(!Fb){Fb=new Si;Fb.sessionId=R.AFrameworkApplication.userSessionId;const zf=Ea.a.qU(R.AFrameworkApplication.lcid)||Ea.a.edj;kf.instance.Nm=new Bj(new ji(kf.instance.pn.application,zf.name,Fb,kf.instance.pn.Aq,this.Wra,L.tellMeInSharedHeaderIsEnabled,null),kf.instance.pn.mZh,kf.instance.pn)}this.nsa=new Yh(kf.instance.pn.parameterData);this.ZXe=Va||new vi(kf.instance.pn,
this.nsa);kf.instance.h4c=td;this.ydd=this.ydd||new fg(kf.instance.pn,kf.instance.pn.parameterData,td);this.Ei=Wi.FocusManager.instance();this.X0=si.createInstance(kf.instance.pn);kf.instance.zkb=new Li(L);this.$c=bc||R.AFrameworkApplication.jh;this.$j=Ic||R.AFrameworkApplication.pp;this.EZ=pe;this.c3=qa;this.AQ=uf;this.RD=new sh;this.kua=new te.a(oe.a.lm());this.qgc=[];pe?pe.execute(zf=>{zf.isFeatureEnabled(kf.SUk,!0).then(bg=>{this.VBb=bg;this.c3=this.c3||rh.createInstance(this.X0,kf.instance.pn,
this.nsa,this.VBb);for(const kg of this.qgc)this.c3.Lz(kg.provider,kg.t8a);this.qgc=[];return null})}):(this.VBb=!0,this.c3=this.c3||rh.createInstance(this.X0,kf.instance.pn,this.nsa,this.VBb));this.Ga=Hd;this.Sca=vi.euc;this.tfc=new Promise(()=>{});Ke&&Ke.execute(zf=>{this.DZ=zf})}ko(){this.wwh()}wwh(){this.$c.Vk(Y.a.tellMe,fa.a.frame,Object(Ba.a)(this,this.tellMe,"tellMe"),96);this.$c.Vk(Y.a.tellMeCacheAsyncMenuRefresh,fa.a.frame,Object(Ba.a)(this,this.INh,"cacheAsyncMenuRefreshFunction"),96);this.$c.Vk(Y.a.tellMeLogCommandExecuted,
fa.a.frame,Object(Ba.a)(this,this.Qxj,"logItemExecuted"),96);this.$c.Vk(Y.a.tellMeLogMenuClose,fa.a.frame,Object(Ba.a)(this,this.Vwj,"logControlDeactivation"),96);this.$c.Vk(Y.a.tellMeLogInputFocus,fa.a.frame,Object(Ba.a)(this,this.Mxj,"logInputFocus"),96);this.$c.Vk(Y.a.tellMeInteractionBegin,fa.a.frame,Object(Ba.a)(this,this.dKa,"interactionBegin"),96);this.$c.Vk(Y.a.tellMeRestoreFocus,fa.a.frame,Object(Ba.a)(this,this.dKa,"interactionBegin"),96);this.$c.Vk(Y.a.tellMeLogInputBlur,fa.a.frame,Object(Ba.a)(this,
this.Lxj,"logInputBlur"),96);this.$c.Vk(Y.a.tellMeLogMenuOpen,fa.a.frame,Object(Ba.a)(this,this.Swj,"logControlActivated"),96);this.$c.Vk(Y.a.tellMeFocusInput,fa.a.frame,Object(Ba.a)(this,this.Pwi,"focusSearchBox"),96);this.$c.Vk(Y.a.tellMeAccessibilityMenuText,fa.a.frame,Object(Ba.a)(this,this.jYh,"constructLiveNotificationForMenu"),96);this.$c.Vk(Y.a.tellMeTryQuery,fa.a.frame,Object(Ba.a)(this,this.wSf,"insertTryQuery"),96);this.$c.Vk(Y.a.Ytj,fa.a.frame,Object(Ba.a)(this,this.wSf,"insertTryQuery"),
96);this.$c.Vk(Y.a.qti,fa.a.frame,this.qza,96);this.$c.Vk(Y.a.rti,fa.a.frame,this.qza,96);this.$c.Vk(Y.a.sti,fa.a.frame,this.qza,96);this.$c.Vk(Y.a.tti,fa.a.frame,this.qza,96);this.$c.Vk(Y.a.uti,fa.a.frame,this.qza,96);this.$c.Vk(Y.a.zZj,fa.a.frame,this.qza,96);this.$c.Vk(Y.a.AZj,fa.a.frame,this.qza,96);this.$c.Vk(Y.a.BZj,fa.a.frame,this.qza,96);this.$c.Vk(Y.a.l2j,fa.a.frame,this.sDc,96);this.$c.Vk(Y.a.m2j,fa.a.frame,this.sDc,96);this.$c.Vk(Y.a.n2j,fa.a.frame,this.sDc,96);this.$c.Vk(Y.a.tellMeFeedback,
fa.a.frame,this.openFeedback,96);this.$c.Vk(Y.a.UUk,fa.a.frame,this.qza,96);this.$c.Vk(Y.a.KBh,fa.a.frame,this.e_d,96);this.$c.Vk(Y.a.LBh,fa.a.frame,this.e_d,96);this.$c.Vk(Y.a.MBh,fa.a.frame,this.e_d,96);this.$c.Vk(Y.a.YXc,fa.a.frame,this.YXc,96);this.$c.Vk(Y.a.Ysj,fa.a.frame,this.Zsj,96);this.$c.Vk(Y.a.J9j,fa.a.frame,this.K9j,96);this.$c.Vk(Y.a.XAi,fa.a.frame,this.WAi,96)}Pwi(L,qa,Va){if(1===Va)return 32;this.ANg();L=!1;(kf.instance.pn.tellMeInSharedHeaderIsEnabled||this.Wra)&&(qa=document.getElementById("SearchButton"))&&
qa.click();if(!kf.instance.pn.tellMeInSharedHeaderIsEnabled&&this.Wra)for(qa=document.getElementsByClassName("ms-suiteux-search-box"),Va=0;Va<qa.length;Va++){const Fb=qa[Va].querySelector("input[type=search]");Fb&&(L=Wi.FocusManager.KBa(Fb))}else L=Wi.FocusManager.KBa($get(kf.instance.pn.Aq?Eh.a.Oqe:Eh.a.a_c));this.OBb=!0;return L?32:8}wSf(L,qa,Va,Fb,bc){if(1===Va)return 32;if(la.c(bc))return kf.instance.Nm.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.ANg();L=bc.CommandValueId;
qa=kf.instance.pn.Aq?Eh.a.Oqe:Eh.a.a_c;kf.instance.pn.Aq&&!la.c(bc[Ef.a.sia])&&(bc[Ef.a.sia]=!1);if(L){if(kf.instance.pn.Aq)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(L)),this.bDa=[19],32;if(bc=$get(qa))bc.value=L}return Wi.FocusManager.KBa($get(qa))?32:8}ANg(){this.Ei.tba(kf.instance.pn.tellMeInSharedHeaderIsEnabled||this.Wra?kf.instance.pn.NBc:kf.instance.pn.TNa,!1)}CBi(L,qa){switch(L){case 0:return String.format(Object(mc.a)("TellMeClassifierCommandAccessibleLabelFormat"),
qa);case 4:return String.format(Object(mc.a)("TellMeRecentlyUsedAccessibleLabelFormat"),qa);case 5:return String.format(Object(mc.a)("TellMeTryQueryAccessibleLabelFormat"),qa);case 7:case 16:return String.format(Object(mc.a)("TellMeTryCommandAccessibleLabelFormat"),qa)}return qa}jYh(L,qa,Va,Fb,bc){if(1===Va)return 32;if(la.c(bc))return kf.instance.Nm.onError("TellMeActor:ConstructLiveNotificationForMenu","actiondata comes null"),16;L=this.Sca?this.Sca.BFg:0;bc.Value=1!==L?String.format(Object(mc.a)("LookupLiveNotificationResultPluralFormText"),
L):Object(mc.a)("LookupLiveNotificationResultSingularFormText");if(this.Sca)for(const Ic of this.Sca.zci)bc=Object(Zf.a)(Df,Ic)?Ic.id:ba.a.replaceAll(Ic.value,'"',""),(bc=$get(bc+"-"+jd.Ate))&&Ci.a.gq(bc,Ci.a.RC,ba.a.Yl(this.CBi(Ic.groupType,bc.innerText)));return 32}INh(L,qa,Va,Fb,bc){if(1===Va)return 32;if(la.c(bc))return kf.instance.Nm.onError("TellMeActor:CacheAsyncMenuRefreshFunction","actiondata comes null"),16;this.L9a=new fd.a(2,1,0,()=>{bc[Ij.a.Callback]()},97);this.Sca&&this.$j.Ol(this.L9a);
return 32}Qxj(L,qa,Va,Fb,bc){if(1===Va)return 32;if(la.c(bc))return kf.instance.Nm.onError("TellMeActor:LogItemExecuted","actiondata comes null"),16;bc.CloseAllMenus&&(L=void 0===bc.ParentControlId||null===bc.ParentControlId?"<NA>":bc.ParentControlId,qa=this.V9a?this.V9a[bc.ControlId]:null,!qa&&this.V9a&&"<NA>"!==L&&(qa=this.V9a[L]),qa||(qa=this.lab&&this.X0.ogj(bc),qa=this.Fai(qa,bc.ControlId),qa=new Ih(qa,33,4,-1,-1,-1),kf.instance.Nm.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+
bc.ControlId+" determined group:"+mg[qa.groupType])),kf.instance.Nm.iMj(bc.ControlId,L,bc.CommandId,bc.CloseAllMenus,qa),this.nsa.JHj(bc.ControlId),bc.Location!==vc.contextMenu&&(this.X0.Aka(bc),this.X0.Lz(qa.resultType),kf.instance.pn.uXc&&this.c3.Ruh(bc.CommandId)));return 32}Vwj(L,qa,Va,Fb,bc){if(1===Va)return 32;(new Nh(this.ikb())).ERi(this.f$a);L=this.f$a;qa=this.zrc();Va=kf.instance.Nm.Vbc;if(la.c(bc))return kf.instance.Nm.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),
16;bc=bc.UILocation;L&&0<L.length&&this.VBb&&jd.Uoe(kf.instance.pn)&&kf.instance.pn.CHc&&19!==bc&&qa>Va&&!kf.instance.pn.KH&&(kf.instance.Nm.G0d(L),kf.instance.Nm.hme(qa));kf.instance.Nm.Nok();kf.instance.pn.b2c&&19!==bc&&(this.RD.mark(3),this.RD.measure(1,0,3),this.RD.measure(2,2,3),this.RD.q0d(0,1,2),this.RD.q0d(2,2,3),this.RD.q0d(1,0,3),this.RD.ITh(),this.RD.clearMeasures([0,2,1]));kf.instance.Nm.IMj(window.performance.now()-this.Ddd);kf.instance.pn.Aq&&(this.QCa=null,kf.instance.Nm.fza());this.OBb=
this.X$a=!1;this.f$a="";return 32}Mxj(L,qa,Va){if(1===Va)return 32;kf.instance.Nm.oMa(qi(qa),this.OBb);return 32}Lxj(L,qa,Va){if(1===Va)return 32;kf.instance.Nm.fza();this.X$a=!1;return 32}Swj(L,qa,Va,Fb,bc){if(1===Va)return 32;kf.instance.OH=null;bc&&(kf.instance.OH=bc);kf.instance.pn.b2c&&(la.c(kf.instance.OH)||kf.instance.OH.Location!==vc.contextMenu)&&this.RD.mark(0);kf.instance.Nm.yWc(la.c(kf.instance.OH)||la.c(kf.instance.OH.Location)?vc.unknown:kf.instance.OH.Location);kf.instance.Nm.HMj(this.ZOe,
this.OBb);this.X$a||this.gza();return 32}ehf(L,qa){const Va=[],Fb=Date.now();for(const bc of L)L=(Fb-bc.timeStamp)/1E3,L=jd.d0c(L),Array.add(Va,new ni(qa?bc.commandId:bc.controlId,L));return Va}o7h(L){const qa=[],Va=Date.now();for(const Fb of L)if(Fb.controlId||"keyboardShortcut"===Fb.commandSurface)L=(Va-Fb.timeStamp)/1E3,L=jd.d0c(L),Array.add(qa,new Ti(Fb.controlId,Fb.commandId,L,Fb.commandSurface,Fb.f_c));return qa}Nhf(L){var qa=(void 0===L?0:L)?this.X0.CRi():this.X0.HIa();L=[];const Va=Date.now();
for(const Fb of qa)qa=(Va-Fb.TimeStamp)/1E3,qa=jd.d0c(qa),Array.add(L,new ni(Fb.Id,qa));return L}gza(){if(!this.X$a){this.lab=this.X$a=!0;if(!this.tMe){this.tMe=!0;const L={};L.IsMLREnabled=kf.instance.pn.Elj;L.IsReactRibbonEnabled=kf.instance.pn.Aq;L.IsSharedHeaderEnabled=!!R.AFrameworkApplication.ra&&R.AFrameworkApplication.ra.$d.jw;L.IsSearchUxEnabled=this.Wra;L.IsTellMeInHeaderEnabled=kf.instance.pn.tellMeInSharedHeaderIsEnabled;L.IsGoLocalEnv=jd.wjj();L.IsSovereignEnvironment=jd.pnb();L.IsTellMeServiceResultsEnabled=
jd.Uoe(kf.instance.pn);L.IsSubstrateProviderEnabled=jd.Toe(kf.instance.pn);L.ShouldFetchTokens=!!R.AFrameworkApplication.ra&&R.AFrameworkApplication.ra.$d.O6a;L.IsSerpletEnabled=jd.Z5();L.FirstOnClickTimeInMS=Math.round(window.performance.now());L.IsHeaderHidden=R.AFrameworkApplication.hideHeader||R.AFrameworkApplication.hideHeaderEmbedded;L.IsSearchInHeaderHidden=R.AFrameworkApplication.hideSearchInHeaderByUiHost;void 0!==window.performance.timing&&null!==window.performance.timing&&(L.TimeSinceFetchStart=
Math.round(Date.now()-window.performance.timing.fetchStart));L.IsFindWithMatchesEnabled=kf.instance.pn.Swf;L.HelpShowsTopSearchResult=kf.instance.pn.q6b;L.HelpShowsNumberOfMatches=kf.instance.pn.p6b;R.AFrameworkApplication.fa&&(L.UiHost=R.AFrameworkApplication.fa.Xa("UiHostIntegrationType"));kf.instance.Nm.gzj(JSON.stringify(L))}this.zfb=this.ehf(Ji.a.instance.Pzb,!1);this.yfb=this.ehf(Ji.a.instance.bRa,!0);this.byb=this.o7h(Ji.a.instance.bRa);this.xpb=this.Nhf();this.ypb=this.Nhf(!0);kf.instance.Nm.gza()}}dKa(L,
qa,Va,Fb,bc){if(1===Va)return 32;if(la.c(bc))return kf.instance.Nm.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(Lc.a.AXf)return 32;this.Ddd=window.performance.now();this.gza();L=new nj(this.eba,0);kf.instance.j7++;kf.instance.Nm.beginQuery("",kf.instance.j7,this.lab);this.v9b(!0,null);this.Sca=vi.euc;this.QCa=fg.lBd;if(this.c3)kf.instance.actions=[],this.c3.nC(new ti("",kf.instance.j7),L,kf.instance.pn.Aq);else kf.instance.Nm.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");
this.L9a&&this.$j.Ol(this.L9a);return 32}Vha(L,qa,Va){if(1===Va)return 32;this.Ei.cpa(kf.instance.pn.tellMeInSharedHeaderIsEnabled||this.Wra?kf.instance.pn.NBc:kf.instance.pn.TNa,!1);return 32}tellMe(L,qa,Va,Fb,bc){if(1===Va)return 32;if(la.c(bc))return kf.instance.Nm.onError("TellMeActor:TellMe","actiondata comes null"),16;kf.instance.OH=bc;kf.instance.Nm.yWc(la.c(kf.instance.OH.Location)?vc.unknown:kf.instance.OH.Location);L=kf.instance.OH.Value;kf.instance.pn.Aq||L&&""!==L.trim()?(!this.QCa&&kf.instance.pn.Aq&&
(kf.instance.Nm.oMa(qi(qa),this.OBb),this.gza()),this.nri(L,kf.instance.OH.Location),kf.instance.OH.PopulationXML=this.Sca.xml):this.lab?kf.instance.OH.PopulationXML=this.Sca.xml:(kf.instance.OH.PopulationXML=vi.euc.xml,this.QCa=fg.lBd,this.f$a="");return 32}nri(L,qa){this.Ddd=window.performance.now();kf.instance.pn.b2c&&qa!==vc.contextMenu&&this.RD.mark(1);kf.instance.pn.Aq&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(L));L&&0<L.trim().length&&(this.lab=!1);kf.instance.pn.Fii();
qa=la.c(qa)?vc.tellMe:qa;if(L!==this.f$a||kf.instance.pn.Aq){kf.instance.j7++;kf.instance.Nm.beginQuery(L,kf.instance.j7,this.lab);this.v9b(!0,null);const Va=new ti(L,kf.instance.j7),Fb=new nj(this.eba,kf.instance.j7);this.Sca=vi.euc;this.QCa=fg.lBd;if(this.c3)kf.instance.actions=[],this.c3.nC(Va,Fb,kf.instance.pn.Aq,qa,this.bDa),this.bDa=null;else kf.instance.Nm.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.ZOe=kf.instance.j7;this.f$a=L}}f5k(L){if(kf.instance.pn.Aq){var qa=
appChrome.selectors.getActiveControlStates();if(qa=Object(Ah.a)(Object,qa[L.value])){L.label=qa.label;let Va=null;"description"in qa&&(Va=qa.description);Va&&Object.getType(Va)===String?L.description=Va:"secondaryText"in qa?L.description=qa.secondaryText:"fullDescriptionLabel"in qa&&(L.description=qa.fullDescriptionLabel)}}}X3j(L){this.V9a={};let qa=0,Va=0;for(const Fb of L){L=0;for(const bc of Fb.results)this.V9a[bc.value]=new Ih(bc.groupType,bc.type,bc.subType,qa,L,Va),L++,Va++,bc.label||5!==bc.type||
this.f5k(bc);0<L&&qa++}}openUrlInNewTab(L,qa,Va,Fb,bc){if(1===Va)return 32;if(la.c(bc))return kf.instance.Nm.onError("TellMeActor:OpenUrlInNewTab","actiondata comes null"),16;(L=bc.CommandValueId)&&window.open(L,"_blank");return 32}t3f(L){const qa={};qa.token=this.d7b;qa.files=qc.c(L);qa.type="MultiFilesDeckGeneration";if(R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFastCards",!1))return this.$c.Xj(Y.a.ptj,2,qa),!0;L=jd.cJf("",jd.DFg("GenerateDeckFromFile"),
Object.assign(new Yd,{landingTab:"All",data:qa}));L=this.$c.Xj(Y.a.Edj,2,L);return 32!==L?(kf.instance.Nm.onError("LaunchSmartLookupWithFilesData","CommonCommands.InvokeSerplet failed. Response: "+L+"."),!1):!0}ncj(L,qa){if(1===L)return 32;if(la.c(qa))return kf.instance.Nm.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(la.c(this.Hdc))return kf.instance.Nm.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),16;L=qa.CommandValueId;return la.c(L)?(kf.instance.Nm.onError("TellMeActor:InsertUrl",
"commandValueId comes null"),16):this.Hdc.insertHtmlText(L)?32:(kf.instance.Nm.onError("TellMeActor:InsertUrl","url is not inserted"),16)}Fai(L,qa){return qa.startsWith(kf.instance.pn.Aq?jd.Eve:jd.h0c)?5:L?4:"bSearchHelp"===qa||qa.startsWith("GetHelpFromTellMe")?8:"bInsights"===qa||qa.startsWith("SmartLookupFromTellMe")?13:"ActionAIFromTellMe"===qa?24:qa===kf.instance.pn.Rwf?2:0}zrc(){return this.Mo.zrc()}Lz(L,qa){this.c3?this.c3.Lz(L,qa):Array.add(this.qgc,new dj(L,qa))}v9b(L,qa,Va){return this.Mo.v9b(L,
void 0===qa?"":qa,void 0===Va?null:Va)}static get instance(){return kf.Wa||(kf.Wa=new kf(Kd.instance))}get pn(){return this.Mo.pn}set pn(L){this.Mo.pn=L}set h4c(L){this.Mo.h4c=L}get zkb(){return this.Mo.zkb}set zkb(L){this.Mo.zkb=L}get Nm(){return this.Mo.Nm}set Nm(L){this.Mo.Nm=L}get j7(){return this.Mo.j7}set j7(L){this.Mo.j7=L}get kua(){return this.Mo.kua}set kua(L){this.Mo.kua=L}get OH(){return this.Mo.OH}set OH(L){this.Mo.OH=L}get xpb(){return this.Mo.xpb}set xpb(L){this.Mo.xpb=L}get zfb(){return this.Mo.zfb}set zfb(L){this.Mo.zfb=
L}get yfb(){return this.Mo.yfb}set yfb(L){this.Mo.yfb=L}get byb(){return this.Mo.byb}set byb(L){this.Mo.byb=L}get X0(){return this.Mo.X0}set X0(L){this.Mo.X0=L}get b7a(){return this.Mo.b7a}set b7a(L){this.Mo.b7a=L}get ypb(){return this.Mo.ypb}set ypb(L){this.Mo.ypb=L}}kf.Wa=null;kf.SUk="mso_tellMeService";kf.unknown="Unknown";kf.Fsi=500;Object(m.a)(kf,"TellMeActor",null,[]);var uj=a(42),Zg=a(176),oj=a(304),Xi=a(847);class Yi{constructor(L,qa,Va,Fb,bc){L=void 0===L?null:L;qa=void 0===qa?null:qa;Va=
void 0===Va?null:Va;bc=void 0===bc?null:bc;this.W4c=null;this.CDe=!1;this.Hhh=this.E9a=null;this.bph=this.UUe=this.Jdh=this.Ihh=!1;this.Lbc=null;this.Udh=null==qa?R.AFrameworkApplication.KUa:qa;this.ujh=null==Va?R.AFrameworkApplication.aKa:Va;this.yph=null==bc?R.AFrameworkApplication.dBa:bc;this.Jih=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.la("TellMeHelpOnHelpIsEnabled");this.vqh=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.la("TellMeCommandHookIsEnabled");this.PEk(!!R.AFrameworkApplication.fa&&
R.AFrameworkApplication.fa.la("TellMeIgnoreQueryForHelp"));this.nqh=!!R.AFrameworkApplication.ra&&R.AFrameworkApplication.ra.$d.YVb;this.oqh=!jd.Lna()&&!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.la("TellMePeopleSuggestionIsEnabled");this.mqh=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.la("TellMeFileSuggestionIsEnabled");this.thh=!!R.AFrameworkApplication.ra&&R.AFrameworkApplication.ra.$d.O6a;this.pqh=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.la("TellMeSeeMoreButtonIsEnabledInZeroTerm");
this.Voh=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.la("HelpShowsTopSearchResult");this.qmh=this.q6b||this.p6b;this.omh=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.la("OnlineCommandSuggestionsIsEnabled");this.pmh=this.hVd;this.ykh=!!R.AFrameworkApplication.fa&&this.tellMeInSharedHeaderIsEnabled&&R.AFrameworkApplication.fa.la("StyledHeaderInLabelIsEnabled");this.kih=R.AFrameworkApplication.fa?R.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",
1400):1400;this.qih=R.AFrameworkApplication.fa?R.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",1400):1400;this.gih=R.AFrameworkApplication.fa?parseFloat(R.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold","-0.6")):-.6;this.wkh=!!R.AFrameworkApplication.fa&&(R.AFrameworkApplication.fa.la("SmartLookupNoteSearchIsEnabled")||R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",
!1));this.kkh=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PPTOChatPPTCopilot",!1);this.Jkh=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotPaneEnabled",!1);this.Ajh=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.isActionAIEnabledInTellMe",!1)&&(this.krj||this.gmj);this.Jbb=!!R.AFrameworkApplication.fa&&
R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceActionAIEnabled",!1);this.Xph=R.AFrameworkApplication.fa?R.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl","https://substrate.office.com/search/api/v1/suggestions"):"https://substrate.office.com/search/api/v1/suggestions";this.rih=R.AFrameworkApplication.fa?R.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",
""):"";this.Woh=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",!1);this.sph=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",!1);this.$oh=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.la("ShowFindInDocumentInZeroTermSearchBox")||this.KH;this.Gkh=!!R.AFrameworkApplication.fa&&(R.AFrameworkApplication.fa.la("TellMeTemplateProviderIsEnabled")||
R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1));this.Xjh=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.FormulaProviderEnabled",!1);this.gkh=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",!1);this.skh=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.la("TellMeIsRuleBasedSortingEnabled")&&
"en-US"===R.AFrameworkApplication.uiCulture;this.Dkh=!!R.AFrameworkApplication.fa&&(R.AFrameworkApplication.fa.la("TellMeFeedbackProviderIsEnabled")||R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",!1));this.Mkh=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.la("TellMeZeroTermContextualCommandSuggestionsEnabled");this.Kdh=this.tellMeInSharedHeaderIsEnabled&&!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",
!1);this.Cih=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",!1);this.vph=!!R.AFrameworkApplication.fa&&(R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",!1)||"Word"!==R.AFrameworkApplication.fa.Xa("Application"));this.xeh=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",
!1);this.mrh=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.la("TellMePerformanceMarkerEnabled");this.Ejh=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",!1);this.Ijh=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1);this.pih=R.AFrameworkApplication.fa?R.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",
0):0;this.Fkh=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.la("TellMeNotesSuggestionIsEnabled")||this.d0f;this.Gjh=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",!1);this.Hjh=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",!1);this.Fjh=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",
!1);this.Xgh=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMe",!1);this.Ygh=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMeMVP",!1);this.Vgh=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.Wvd&&R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableBumblebeeEntryPointInTellMe",!1);
this.rmh=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.Wvd&&R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OpenCopilotFromTellMe",!1);this.qqh=this.Spj&&(this.o9d||this.p9d||this.j0b||this.tellMeInSharedHeaderIsEnabled&&jd.Z5()&&!!R.AFrameworkApplication.fa&&(this.Ovb||this.Kvb||this.Mvb||this.Nvb||this.Qvb||R.AFrameworkApplication.fa.la("ShowAnswerSearchResults")||R.AFrameworkApplication.fa.la("ShowDefinitionSearchResults")||R.AFrameworkApplication.fa.la("ShowEntitySearchResults")||
R.AFrameworkApplication.fa.la("ShowWolframSearchResults")));this.idh=!!R.AFrameworkApplication.fa&&!R.AFrameworkApplication.fa.la("AppsForOfficeThirdPartyIsDisabled")&&R.AFrameworkApplication.fa.la("AppsForOfficeAllowExternalMarketplace")&&R.AFrameworkApplication.C3;this.jdh=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.la("AppsForOfficePrivateCatalogIsEnabled");this.q$i(L||{});this.ehc="2918242107";this.dhc="1454393937";this.ISa={};this.HEa=[];this.mZh=[jd.h0c]}get application(){return this.E9a}get KUa(){return this.Udh}get Muk(){return this.ehc}get Luk(){return this.dhc}get Rwf(){return this.Hhh}get Dui(){return this.Ihh}get aKa(){return this.ujh}get dBa(){return this.yph}get AUa(){return this.Jdh}get c5i(){return this.Jih}get $Uk(){return this.vqh}get Spj(){return!0}get TUk(){return this.qqh}get THk(){return this.UUe}PEk(L){this.UUe=
L}get tellMeInSharedHeaderIsEnabled(){return this.nqh}get q8b(){return this.oqh}get p8b(){return this.mqh}get fetchTokensForSearch(){return this.thh}get RUk(){return this.pqh}get pve(){return!1}get j0b(){return this.qmh}get o9d(){return this.omh}get p9d(){return this.pmh}get QKa(){return!1}get CHc(){return!1}get oXd(){return this.ykh}get Hpe(){return this.bph}get Ovb(){return!1}get sJk(){return!1}get Ztj(){return""}get FRi(){return 4}get GRi(){return 5}get dUi(){return""}get cJi(){return this.kih}get bJf(){return this.qih}get fUi(){return 1E3}get eUi(){return 1E-6}get VSk(){return this.Xph}get Ese(){return!1}get USk(){return!1}get goj(){return this.skh}get PWd(){return!1}get QWd(){return!1}get tlj(){return!1}get slj(){return!1}get d0f(){return!1}get g0f(){return!1}get Swf(){return!1}get Dvb(){return!1}get Kvb(){return!1}get Mvb(){return!1}get Nvb(){return!1}get Qvb(){return!1}get q6b(){return this.Voh}get Fvb(){return this.Woh}get p6b(){return!1}get pId(){return null}get KWd(){return!1}get uXc(){return this.$oh}get IGf(){return 0}get bFi(){return this.gih}get sJf(){return this.rih}get dpj(){return this.wkh}get SDc(){return this.Ajh}get tXc(){return this.Jbb}get iGf(){return-3.9}get KH(){return this.sph}get ZVb(){return this.Gkh}get jUd(){return this.Xjh}get rVd(){return this.gkh}get tXd(){return this.Dkh}get CFa(){return this.Kdh}get qrj(){return this.Mkh}get R$(){return this.Cih}get oTg(){return this.vph}get VJh(){return this.xeh}get b2c(){return this.mrh}get VDc(){return this.Ejh}get fej(){return this.Ijh}get Ir(){return this.pih}get RKa(){return this.Fkh}get dej(){return this.Gjh}get eej(){return this.Hjh}get cej(){return this.Fjh}get R1e(){return this.idh}get S1e(){return this.jdh}get O_(){return this.Xgh}get juc(){return this.Ygh}get fuc(){return this.Vgh}get krj(){return this.Jkh}get gmj(){return this.kkh}get HZj(){return this.rmh}get MU(){return!!R.AFrameworkApplication.ra&&
R.AFrameworkApplication.ra.$d.Aq}get Aq(){return!!R.AFrameworkApplication.ra&&R.AFrameworkApplication.ra.$d.Aq}get Elj(){return!!R.AFrameworkApplication.ra&&R.AFrameworkApplication.ra.$d.CIk}get Lbg(){return pb.c("OfficeAssistant_32x32x32")}CJi(){return Promise.reject("GetFindMatchCount method is not overridden")}Bnb(L){return Array.contains(appChrome.selectors.getVisibleControlIds(),L)}xEc(){return!1}get cVd(){return!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.la("TellMeModelRankerEnabled")}get pXg(){return R.AFrameworkApplication.fa?
R.AFrameworkApplication.fa.Xa("TellMeServiceHelpClassifierModelName"):""}get hVd(){return!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.la("TellMeMultiLingualCommandModelEnabled")}get NBc(){return"NoOpHeaderUi"}get lZh(){return this.Lbc}get parameterData(){return this.ISa}get g0k(){return this.HEa}Fii(){if(this.W4c&&!this.CDe&&(this.CDe=!0,this.INg(this.W4c),this.Aq)){var L=uj.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");L=(new Xi.a(L)).ijb(this.W4c.Sp);appChrome.api.dispatch(L)}}INg(){}Kai(L){const qa=
[];for(let Va=0;Va<L.length;++Va)L[Va].fKk?qa.push(new Uc.a(L[Va].kDh,jd.I_g+Va.toString())):qa.push(new Uc.a(L[Va].standard,jd.h0c+Va.toString()));return qa}q$i(L){const qa={};for(const Va in L){const Fb=Va,bc=L[Va];for(const Ic in bc){const td=Ic,Hd=bc[Ic];(qa[td]||(qa[td]={}))[Fb]=Hd}}this.Lbc=qa}get qXg(){return""}get KRg(){return!1}}Object(m.a)(Yi,"TellMeApplicationData",null,[578]);class Di{constructor(L,qa,Va){this.standard=L;this.kDh=void 0===qa?null:qa;this.fKk=void 0===Va?!1:Va}}Object(m.a)(Di,
"TryQuerySet",null,[]);var $g=a(279);class vj{constructor(){this.pPe=this.qPe=null}get OEj(){return this.pPe}x_(L){this.qPe=L;return null}HHj(){this.pPe=this.qPe}sFf(L){return 8===L.type?String.format(Object(mc.a)("FindInDocumentText"),L.GK):L.GK}CFi(L){return L.GK}}Object(m.a)(vj,"ParameterizedCommand",null,[]);class yj extends vj{constructor(){super(...arguments);this.QUk='Find function for "{0}"'}get commandId(){return"InsertFunctionParameterized"}get O0j(){return"InsertFunction"}sFf(L){return String.format(this.QUk,
L.GK)}}Object(m.a)(yj,"InsertFunctionParameterizedCommand",vj,[]);class bj extends Yi{constructor(L){super();this.E9a="Excel";this.ehc="-1376725189";this.dhc="-1386334072";if(R.AFrameworkApplication.fa.la("TellMeTryQueriesIsEnabled")){var qa=[new Di(Ib.a.instance.Ba(426),"",!1),new Di(Ib.a.instance.Ba(427),"",!1),new Di(Ib.a.instance.Ba(428),"",!1),new Di(Ib.a.instance.Ba(429),"",!1),new Di(Ib.a.instance.Ba(430),"",!1)];this.HEa=this.Kai(qa)}R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.FormulaProviderEnabled",
!1)&&(qa=new yj,this.parameterData[qa.commandId]=qa);this.$=L}get TNa(){return $g.a.c4b}get Lbg(){return pb.c("OfficeAssistant_32x32x32")}INg(L){const qa=R.AFrameworkApplication.fa.la("TellMeDesktopUpSellIsEnabled"),Va=R.AFrameworkApplication.Tpj;L=L.Sp;L.MacrosUpSellButton=!qa||Va;L.HeaderFooterUpSellButton=!qa||Va;L.MacrosUpSellButtonEnterprise=!qa||!Va;L.HeaderFooterUpSellButtonEnterprise=!qa||!Va}get d0f(){return R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.NotesSuggestionIsEnabled",
!1)}get g0f(){return R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.ZeroTermNotesSuggestionIsEnabled",!1)}get IGf(){return R.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.Excel.TellMe.NumberOfNotesSuggestionsToShow",2)}get qXg(){return R.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.Excel.TellMe.MultiLanguageModelName","")}get Ese(){return R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.ServiceAADAuthIsEnabled",
!1)}get pXg(){return R.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.Excel.TellMe.HelpClassifierModelName","")}get Ovb(){return R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.ShowImageSearchResults",!1)}get hVd(){return R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.MLCModelIsEnabled",!1)}get KRg(){return R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.ShowMoreFileResults",!1)}get CHc(){return R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.EnableRankerLogging",
!1)}get iGf(){var L=R.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.Excel.TellMe.NBClassifierScoreThreshold","-7.0");L=parseFloat(L);return isNaN(L)?-7:L}get R1e(){return!I.EwaSettings.Ra(174)&&this.$.ea.sn.get(27)&&this.$.C3}get S1e(){return this.$.Tj.get(35)}get pId(){return Aa.a.nl()?{["FontName_New"]:"FontPicker"}:null}}Object(m.a)(bj,"ExcelTellMeApplicationData",Yi,[]);var gj=a(765),th=a(59),Th;(function(L){L[L.immediate=0]="immediate";L[L.bze=1]="waitAll";L[L.$rl=2]="synchronizeAndWaitAll";
L[L.asl=3]="synchronizeAndWaitForRanker"})(Th||(Th={}));Object(m.b)("MenuUpdatePolicy",Th);var Oh;(function(L){L[L.none=0]="none";L[L.bze=1]="waitAll";L[L.VTk=2]="synchronizeFast";L[L.bsl=3]="synchronizeSlow"})(Oh||(Oh={}));Object(m.b)("ProviderSynchronizationType",Oh);class pi{constructor(L){this.Wg=L}hE(){return"Formula"}iK(){return this.Wg.Ir===Th.immediate?Oh.none:this.Wg.Ir===Th.bze?Oh.bze:Oh.VTk}nC(L,qa,Va,Fb,bc){bc=void 0===bc?null:bc;Va=new dc(L);bc&&!Array.contains(bc,mg.Formula)||jd.lE(L)||
(L=this.bkc(L.Ij,"InsertFunctionParameterized"),Va.Hs(L));qa.gr(Va)}bkc(L,qa){const Va=new le(mg.Formula);Va.displayName="Functions";Va.mt(new Fd(qa,Ig.Formula,L,null,xi.Local));return Va}}Object(m.a)(pi,"FormulaResultsProvider",null,[552]);Object(M.b)(v.lg,{yk:"singleton"})(L=>No(function*(){const qa=yield M.a.resolve(v.Lb),Va=L.va;yield Promise.all([Object(qb.a)(th.a.loadScript(R.AFrameworkApplication.ra.$d.uXd?93:92,4,Va,void 0,void 0,v.lg)),Object(qb.a)(th.a.loadScript(94,4,Va,void 0,void 0,v.lg)),
R.AFrameworkApplication.disableWholeAppsForOfficeFeature?null:M.a.resolve(gj.a,L)]);kh.initData(qa);return new kh(qa)}));class kh{constructor(L){this.commandUIManager=null;this.jMj=qa=>{this.commandUIManager=qa;Zg.a(this.Xi).hFa(this.xY)};this.xY=()=>{this.commandUIManager=this.Xi.ka.Ug(53)};this.Xi=L;this.Xi.ka.Lh(53,this.jMj)}Bi(){return!1}executeCommand(L,qa,Va){L=0;switch(qa.command){case -1642491107:L=Y.a.tellMe;break;case -240091811:L=Y.a.tellMeAccessibilityMenuText;break;case -1543335331:L=
Y.a.tellMeCacheAsyncMenuRefresh;break;case 815990803:L=Y.a.tellMeFocusInput;break;case 586156566:L=Y.a.tellMeInteractionBegin;break;case -1051173363:L=Y.a.tellMeRestoreFocus;break;case 878547493:L=Y.a.tellMeLogCommandExecuted;break;case 1024534176:L=Y.a.tellMeLogInputBlur;break;case -1991747669:L=Y.a.tellMeLogInputFocus;break;case -28797232:L=Y.a.tellMeLogMenuClose;break;case -1814078912:L=Y.a.tellMeLogMenuOpen;break;case 1404166600:L=Y.a.tellMeTryQuery;break;case -2064212100:L=Y.a.tellMeFeedback}let Fb=
0;L&&(Fb=R.AFrameworkApplication.jh.Xj(L,2,Va),this.updateView());e.ULS.sendTraceTag(537151007,0,50,`TellMeCommandHandler.ExecuteCommand: ActionId (${L}) , response (${Fb})`);return L&&2!==Fb?n.Task.Va(!0):u.a(qa.command)}ni(L,qa){L=!1;switch(qa.command){case -1642491107:case -240091811:case -1543335331:case 815990803:case 586156566:case 878547493:case 1024534176:case -1991747669:case -28797232:case -1814078912:case 1404166600:case -2064212100:L=!0}return L}Ji(L,qa,Va){"PopulateTellMe"===qa&&R.AFrameworkApplication.jh.Xj(Y.a.tellMe,
2,Va);return!1}dispose(){!!this.Xi&!!Zg.a(this.Xi)&&Zg.a(this.Xi).q5a(this.xY);this.commandUIManager=null}updateView(){this.commandUIManager&&this.commandUIManager.T1g("sbTellMe",!1)}static initData(L){L=new bj(L);kf.instance.initialize(L,null,null,null,null,null,oj.a.IA.wca,R.AFrameworkApplication.fa,uj.a.instance.Qi("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),null,uj.a.instance.Qi("Common.ISystemInitiatedFeedback"));kf.instance.ko();L.jUd&&kf.instance.Lz(new pi(L),vc.tellMe)}}
Object(m.a)(kh,"TellMeCommandHandler",null,[39,2]);var cj=a(586),wj=a(9),Ei=a(894);class Oi extends Ei.a{constructor(L){super(L)}Qs(){const L=Object(qb.d)(M.a.resolve(v.sc,{va:this.hh})),qa=Object(qb.d)(M.a.resolve(v["if"],{va:this.hh}));na.TaskExtensions.Ua(na.TaskExtensions.Ln([L,qa],this.xa),()=>{var Va=new W(this.$.pa.ta,this.$.userOperationManager);const Fb=new N(qa.result);Va=new Q(null,null,L.result,this.$.frame,Va,Fb);this.$.ka.ph(191,Va);this.cr([Va])},this.$.xa,3)}static Aa(L){Ei.a.sx(190,
new Oi(L))}}Object(m.a)(Oi,"AccountingFormatMenuCommandHandlerFactory",Ei.a,[]);class Zi extends Ei.a{constructor(L){super(L)}Qs(){void M.a.resolve(v.Zd,{va:this.hh}).then(L=>{L=new gc(this.$,L);this.cr([L])})}static Aa(L){Ei.a.sx(189,new Zi(L))}}Object(m.a)(Zi,"NumberFormatCommandHandlerFactory",Ei.a,[]);class Ph extends Ei.a{constructor(L){super(L)}Qs(){const L=[];L.push(th.a.loadScript(R.AFrameworkApplication.ra.$d.uXd?93:92,4,this.hh,void 0,void 0,108));L.push(th.a.loadScript(94,4,this.hh,void 0,
void 0,108));R.AFrameworkApplication.disableWholeAppsForOfficeFeature||L.push(Hb.GetServiceTaskFactory.Bj(this.$.ka,374,375,1));na.TaskExtensions.Ua(n.Task.XP(...L),()=>{kh.initData(this.$);this.cr([new kh(this.$)])},this.xa,3)}static Aa(L){Ei.a.sx(108,new Ph(L))}}Object(m.a)(Ph,"TellMeCommandHandlerFactory",Ei.a,[]);var Pi=window.AssistanceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AssistanceTaskPane",Title:"Office Assistance",
Width:"330"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AssistanceIFrameContainer",IsStretched:"true"}}]}]}]};Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ConditionalFormatting");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.NumberFormat");Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.Assistance");Type.registerNamespace("NLRT");cj.a.gw('.NumberFormatStyleItem{color:#444;font:inherit}.NumberFormatStyleItem select,.NumberFormatStyleItem input{margin-bottom:1.5%}.NumberFormatCategoryList{width:22%;height:50%;margin-bottom:20%;height:65%}.NumberFormatRtlFloat{float:right}.NumberFormatLtrFloat{float:left}.NumberFormatDynamicList{width:70%;height:70%}.NumberFormatDynamicListRtlMargin{margin-right:3%}.NumberFormatDynamicListLtrMargin{margin-left:3%}.NumberFormatDlgFunctionBody{margin:0 13px 10px 13px;width:100%;height:346px}.NumberFormatDlgWidth{width:560px}.NumberFormatDlgBodyWidth{width:560px}.NumberFormatDescriptionItem{height:32%;width:95%;position:relative;top:4%;z-index:-1}.NumberFormatLinkItem{margin-bottom:6px;display:inline-block}.NumberFormatRtlLabelItem{margin-left:2%}.NumberFormatLtrLabelItem{margin-right:2%}.NumberFormatSampleItem{width:100%;background-color:#fff}.NumberFormatDynamicListItemWidth{width:100%;font:inherit}.NumberFormatCategoryListItemWidth{width:100%;font:inherit}.NumberFormatCategoryListItemHeight{max-height:325px}.NumberFormatSymbolItemWidth{width:100%}.NumberFormatItemColorStyle{color:#f00}.NumberFormatFocusCheckbox{outline:none}.NumberFormatBorderLabel{border:1px #808080 dashed}.NumberFormatFontLabel{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif}.NumberFormatSelectionBorder{border:1px solid #a9a9a9}');
(()=>{wj.a.Qg(L=>{v.Yd.Ha()||Zi.Aa(L);v.e.Ha()||Oi.Aa(L)})})();cj.a.gw('.ewa-condfmt-dlg-err-label{width:400px;min-height:21px;margin-bottom:-15px;font-size:8pt;color:#d90000}.ewa-condfmt-dlg-header-label{font-weight:bold}.ewa-condfmt-dlg-with-label{padding-left:3px;padding-right:3px}.ewa-condfmt-dlg-list{width:auto;width:initial}.ewa-condfmt-dlg-input{width:auto;width:initial;padding-left:3px}.CondtionalFormattingPane{background:#edebe9;height:100%;overflow:hidden;display:flex;flex-direction:column}.CondtionalFormattingPaneHeader{position:relative;overflow:hidden;padding:16px 16px 16px 16px}.CondtionalFormattingPaneBody{flex:auto;position:relative}.CondtionalFormattingPaneTitle{position:relative !important;max-width:230px;display:inline-block;text-overflow:ellipsis;overflow:hidden;height:22px;font-weight:normal;background:#edebe9;font-size:16px;color:#252423;font-family:"Segoe UI Semibold","Segoe UI Web",Arial,Verdana,sans-serif}.CondtionalFormattingCloseButton{display:inline-block;padding:0 5px;font-size:16px}');
Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");(()=>{wj.a.Qg(L=>{v.lg.Ha()||Ph.Aa(L)})})();Type.registerNamespace("Common.App.Assistance");Pi;String(c);String(b);String(f);String(r);String(d);String(k);window.___1708742503469_closurehack=c;window.___1708742503469_closurehack=b;window.___1708742503469_closurehack=f;window.___1708742503469_closurehack=r;window.___1708742503469_closurehack=
d;window.___1708742503469_closurehack=k},892:function(y,x,a){a.r(x);a.d(x,"Annotations",function(){return t});y=a(0);var c=a(353),b=a(912),f=a(898),r=a(1119),d=a(1120);class k{constructor(m,e){this.ADa=!1;this.S0=null;if(!m)throw Error.argumentNull("annotations");if(!m.Dnb(e))throw Error.argument("structTypeID","Invalid struct type ID");this.$t=m;this.Vob=this.$t.CGf(e);this.Qph=e}get vdb(){return this.$t}get isReadOnly(){return this.ADa}get Cqa(){return this.Qph}MIa(m){if(0>m||m>=this.Vob)throw Error.argument("iField",
"Invalid field index");return this.S0&&null!=this.S0[m]?this.S0[m]:this.$t.nJf(this.Cqa,m)}nme(m,e){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>m||m>=this.Vob)throw Error.argument("iField","Invalid field index");if(!this.$t.xmb(this.$t.jZa(this.Cqa,m),e))throw Error.argument("value","Value is not of the correct type for the specified field");(this.S0||(this.S0=Array(this.Vob)))[m]=e}AZ(){const {Annotations:m}=a(892);let e="[";if(this.S0){let w=
!0;for(let l=0;l<this.Vob;++l){if(null==this.S0[l])continue;const u=this.$t.jZa(this.Cqa,l);if(m.gQa(u,this.S0[l],this.$t.nJf(this.Cqa,l)))continue;w?w=!1:e+=", ";e+=this.$t.oJf(this.Cqa,l);e+="=";const n=this.$t.AZ(u,this.S0[l]);u===m.bW?(e+='"',e+=b.a.cCd(n),e+='"'):e+=n}}return e+"]"}isEqual(m){const {Annotations:e}=a(892);if(this===m)return!0;if(!m||this.$t!==m.vdb||this.Cqa!==m.Cqa)return!1;for(let w=0;w<this.Vob;++w)if(!e.gQa(this.$t.jZa(this.Cqa,w),this.MIa(w),m.MIa(w)))return!1;return!0}clone(){const m=
new k(this.$t,this.Cqa);this.S0&&(m.S0=Array.clone(this.S0));return m}RJ(){return this.isReadOnly?this.clone():this}Y_d(){const {Annotations:m}=a(892);if(!this.isReadOnly&&(this.ADa=!0,this.S0))for(let e=0;e<this.Vob;++e){const w=this.S0[e];null!=w&&m.T1a(w)}}toString(){return this.AZ()}}Object(y.a)(k,"StructValue",null,[684,682]);class t{constructor(m,e){if(!m)throw Error.argumentNull("initData");if(!e)throw Error.argumentNull("objectFetcher");this.kAj=e.Vdi;let w=0;var l=e.AIa(m.ma(w));++w;this.Z1d=
new r.a(new d.a(l));this.fhh=m.ma(w);++w;this.I7f=Array(this.Duc);this.XXb=Array(this.Duc);this.yLa=Array(this.Duc);for(l=0;l<this.Duc;++l){this.I7f[l]=e.ia(m.ma(w));++w;this.XXb[l]=m.ma(w);++w;const u=m.ma(w);++w;this.yLa[l]=Array(u);for(let n=0;n<u;++n)this.yLa[l][n]=e.ia(m.ma(w)),++w}this.Pph=m.ma(w);++w;this.G8f=Array(this.O7b);this.sKc=Array(this.O7b);this.tKc=Array(this.O7b);this.rKc=Array(this.O7b);for(let u=0;u<this.O7b;++u){this.G8f[u]=e.ia(m.ma(w));++w;l=m.ma(w);++w;this.sKc[u]=Array(l);
this.tKc[u]=Array(l);this.rKc[u]=Array(l);for(let n=0;n<l;++n)this.sKc[u][n]=e.ia(m.ma(w)),++w,this.tKc[u][n]=m.ma(w),++w,this.rKc[u][n]=(()=>{let v=this.YWa(this.tKc[u][n],m,w,null,null,null);({t5:w}=v);return v})().returnValue,t.T1a(this.rKc[u][n])}this.Xdh=m.ma(w);++w;this.u1d=Array(this.Tdb);this.v1d=Array(this.Tdb);this.t1d=Array(this.Tdb);for(let u=0;u<this.Tdb;++u)this.u1d[u]=e.ia(m.ma(w)),++w,this.v1d[u]=m.ma(w),++w,this.t1d[u]=(()=>{let n=this.YWa(this.v1d[u],m,w,null,null,null);({t5:w}=
n);return n})().returnValue,t.T1a(this.t1d[u])}ePb(m){for(let e=0;e<this.Tdb;++e)if(this.u1d[e]===m)return e;return-1}aBf(m){if(!this.Anb(m))throw Error.argument("attrID","Invalid attribute ID");return this.u1d[m]}getAttributeType(m){if(!this.Anb(m))throw Error.argument("attrID","Invalid attribute ID");return this.v1d[m]}jZa(m,e){if(!this.Dnb(m))throw Error.argument("structTypeID","Invalid struct type ID");m=this.tKc[t.P7b(m)];if(0>e||e>=m.length)throw Error.argument("iField","Invalid field index");
return m[e]}AZ(m,e){if(!this.eYd(m))throw Error.argument("typeID","Invalid type ID");if(!this.xmb(m,e))throw Error.argument("value","Value is not of the correct type");switch(m){case t.bW:return e;case t.pca:return e?"True":"False";case t.Nia:case t.d8:return e.toString();case t.eL:return e.AZ();default:if(!t.DC(m)&&t.g9b(m)){m=t.TBd(m);const u=this.yLa[m].length;switch(this.XXb[m]){case 0:return this.yLa[m][e];case 1:if(e){var w="";for(var l=1;l<u;++l)e&1<<l-1&&(0<w.length&&(w+=" & "),w+=this.yLa[m][l]);
return w}return this.yLa[m][0];case 2:w="";for(l=0;l<u;++l)e&1<<l&&(0<w.length&&(w+=" & "),w+=this.yLa[m][l]);return w;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.XXb[m]);}}else return e.AZ()}}eYd(m){switch(m){case t.bW:case t.pca:case t.Nia:case t.d8:case t.eL:return!0;default:return t.DC(m)?this.eYd(t.swa(m)):t.g9b(m)?this.Dqj(m):this.Dnb(m)}}Dqj(m){m=t.TBd(m);return 0<=m&&m<this.I7f.length}Dnb(m){m=t.P7b(m);return 0<=m&&m<this.G8f.length}Anb(m){return 0<=m&&m<this.Tdb}xmb(m,
e){if(null==e)return!1;switch(m){case t.bW:return"string"===typeof e;case t.pca:return"boolean"===typeof e;case t.Nia:return"number"===typeof e;case t.d8:return"number"===typeof e;case t.eL:return Object(c.a)(681,e);default:if(t.DC(m))return Object(c.a)(683,e)&&e.QR===t.swa(m);if(t.g9b(m)){if("number"!==typeof e)return!1;m=t.TBd(m);const w=this.yLa[m].length;switch(this.XXb[m]){case 0:return 0<=e&&e<w;case 1:return!(e&-1<<w-1);case 2:return!!e&&!(e&-1<<w);default:throw Error.invalidOperation("Unrecognized enum type flavor "+
this.XXb[m]);}}else return Object(c.a)(684,e)&&e.Cqa===m}}get Tdb(){return this.Xdh}get Duc(){return this.fhh}get O7b(){return this.Pph}TCi(m){if(!this.Anb(m))throw Error.argument("attrID","Invalid attribute ID");return this.t1d[m]}CGf(m){if(!this.Dnb(m))throw Error.argument("structTypeID","Invalid struct type ID");return this.sKc[t.P7b(m)].length}oJf(m,e){if(!this.Dnb(m))throw Error.argument("structTypeID","Invalid struct type ID");return this.sKc[t.P7b(m)][e]}nJf(m,e){if(!this.Dnb(m))throw Error.argument("structTypeID",
"Invalid struct type ID");m=this.rKc[t.P7b(m)];if(0>e||e>=m.length)throw Error.argument("iField","Invalid field index");return m[e]}YWa(m,e,w,l,u,n){if(!e)throw Error.argumentNull("initData");if(t.DC(m)){var v=e.ma(w);++w;const C=t.swa(m);var B=new f.a(this,C);for(var z=0;z<v;++z)Array.add(B.items,(()=>{let D=this.YWa(C,e,w,l,u,n);({t5:w}=D);return D})().returnValue);return{returnValue:B,t5:w}}switch(m){case t.bW:return{returnValue:(l||this.Z1d).ia(e.ma(w++)),t5:w};case t.pca:return{returnValue:1===
e.ma(w++),t5:w};case t.Nia:return{returnValue:e.ma(w++),t5:w};case t.d8:return{returnValue:(u||this.kAj)[e.ma(w++)],t5:w};case t.eL:v=e.ma(w++);B=new b.a(this);for(z=0;z<v;++z){let C=e.ma(w);++w;n&&(C=n[C]);B.Kv(C,(()=>{let D=this.YWa(this.getAttributeType(C),e,w,l,u,n);({t5:w}=D);return D})().returnValue)}return{returnValue:B,t5:w};default:if(t.g9b(m))return{returnValue:e.ma(w++),t5:w};if(t.a0g(m)){v=e.ma(w++);B=new k(this,m);for(z=0;z<v;++z){const C=e.ma(w);++w;B.nme(C,(()=>{let D=this.YWa(this.jZa(m,
C),e,w,l,u,n);({t5:w}=D);return D})().returnValue)}return{returnValue:B,t5:w}}throw Error.argument("typeID","Invalid type ID");}}static g9b(m){return 16<=(m&16383)&&16384!==(m&16384)&&32768!==(m&32768)}static a0g(m){return 16<=(m&16383)&&16384===(m&16384)&&32768!==(m&32768)}static DC(m){return 32768===(m&32768)}static eNi(m){if(t.DC(m))throw Error.argument("nonListTypeID","Non-list type ID required");return m|32768}static swa(m){if(!t.DC(m))throw Error.argument("listTypeID","List type ID required");
return m&-32769}static gQa(m,e,w){switch(m){case t.bW:case t.pca:case t.Nia:case t.d8:return e===w;case t.eL:return e.isEqual(w);default:return t.DC(m)?e.isEqual(w):t.g9b(m)?e===w:e.isEqual(w)}}static T1a(m){Object(c.a)(682,m)&&m.Y_d()}static RJ(m){return Object(c.a)(682,m)?m.RJ():m}static TBd(m){return m-16}static P7b(m){return(m&-16385)-16}}t.bW=1;t.pca=2;t.Nia=3;t.d8=5;t.eL=9;Object(y.a)(t,"Annotations",null,[685])},898:function(y,x,a){a.d(x,"a",function(){return b});y=a(0);var c=a(912);class b{constructor(f,
r){this.ADa=!1;const {Annotations:d}=a(892);if(!f)throw Error.argumentNull("annotations");if(!f.eYd(r))throw Error.argument("memberTypeID","Invalid type ID");if(d.DC(r))throw Error.argument("memberTypeID","Lists of lists are not permitted");this.$t=f;this.Dlh=r;this.As=[]}get vdb(){return this.$t}get isReadOnly(){return this.ADa}get QR(){return this.Dlh}get items(){return this.As}AZ(){const {Annotations:f}=a(892);let r="[";for(let d=0,k=this.items.length;d<k;++d){0<d&&(r+=", ");const t=this.$t.AZ(this.QR,
this.items[d]);this.QR===f.bW?(r+='"',r+=c.a.cCd(t),r+='"'):r+=t}return r+"]"}isEqual(f){const {Annotations:r}=a(892);if(this===f)return!0;if(!f||f.vdb!==this.$t||f.QR!==this.QR||f.items.length!==this.items.length)return!1;for(let d=0;d<this.items.length;++d)if(!r.gQa(this.QR,this.items[d],f.items[d]))return!1;return!0}clone(){const f=new b(this.$t,this.QR);Array.addRange(f.items,this.items);return f}RJ(){return this.isReadOnly?this.clone():this}Y_d(){const {Annotations:f}=a(892);if(!this.isReadOnly){this.ADa=
!0;for(const r of this.items)f.T1a(r)}}toString(){return this.AZ()}}Object(y.a)(b,"ListValue",null,[683,682])},912:function(y,x,a){a.d(x,"a",function(){return b});y=a(0);class c{constructor(f,r){this.GFa=f;this.value=r}}Object(y.a)(c,"AttrValuePair",null,[]);class b{constructor(f){this.ADa=!1;if(!f)throw Error.argumentNull("annotations");this.$t=f;this.FM=[]}get vdb(){return this.$t}get isReadOnly(){return this.ADa}get oOd(){return 0<this.FM.length}Tp(f){if(!this.$t.Anb(f))throw Error.argument("attributeID",
"Invalid attribute ID");for(const r of this.FM)if(f===r.GFa)return f=r.value,{returnValue:!0,value:f};return{returnValue:!1,value:null}}Kv(f,r){var {Annotations:d}=a(892);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.$t.Anb(f))throw Error.argument("attributeID","Invalid attribute ID");if(!this.$t.xmb(this.$t.getAttributeType(f),r))throw Error.argument("value","Value is not of the correct type for the specified attribute");d.T1a(r);
for(d=0;d<this.FM.length;++d){const k=this.FM[d];if(f===k.GFa){k.value=r;return}}Array.add(this.FM,new c(f,r))}Zsb(f){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.$t.Anb(f))throw Error.argument("attributeID","Invalid attribute ID");for(let r=0;r<this.FM.length;++r)if(f===this.FM[r].GFa){Array.removeAt(this.FM,r);break}}Swc(f){if(!f)throw Error.argumentNull("action");for(const r of this.FM)f(r.GFa,r.value)}clone(){const f=new b(this.$t);
f.Jua(this);return f}Jua(f){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!f)throw Error.argumentNull("other");if(f.vdb!==this.$t)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.FM);f.Swc((r,d)=>{this.Kv(r,d)})}AZ(){const {Annotations:f}=a(892);let r="[",d=!0;for(const k of this.FM){d?d=!1:r+=", ";r+=this.$t.aBf(k.GFa);r+="=";const t=this.$t.getAttributeType(k.GFa),m=this.$t.AZ(t,k.value);t===f.bW?(r+='"',
r+=b.cCd(m),r+='"'):r+=m}return r+"]"}isEqual(f){const {Annotations:r}=a(892);if(!f)throw Error.argumentNull("other");if(this===f)return!0;if(!f||this.$t!==f.vdb||this.oOd!==f.oOd)return!1;let d=0,k=null,t=!1;f.Swc((m,e)=>{++d;if(!t){var w=-1;for(let l=0,u=this.FM.length;l<u;++l)if(this.FM[l].GFa===m){w=l;break}0>w?t=!0:(k||(k=Array(this.FM.length)),k[w]=e)}});if(this.FM.length!==d||t)return!1;for(let m=0,e=this.FM.length;m<e;++m)if(!r.gQa(this.$t.getAttributeType(this.FM[m].GFa),this.FM[m].value,
k[m]))return!1;return!0}RJ(){return this.isReadOnly?this.clone():this}Y_d(){const {Annotations:f}=a(892);if(!this.isReadOnly){this.ADa=!0;for(const r of this.FM)f.T1a(r.value)}}toString(){return this.AZ()}static cCd(f){return f.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(y.a)(b,"FeatureBundle",null,[681,682])},929:function(y,x,a){a.d(x,"a",function(){return c});y=a(0);class c{constructor(){this.S1d=null;this.kY=this.Y1d=0}wGd(b,f,r){if(!b)throw Error.argumentNull("referenceList");
if(0>f||f>b.length)throw Error.argumentOutOfRange("startIndex");if(0>r||r>b.length)throw Error.argumentOutOfRange("length");if(f+r>b.length)throw Error.argument("Invalid start-length range");this.S1d=b;this.Y1d=f;this.kY=r}oIa(b,f,r){this.wGd(b.S1d,b.Y1d+f,r)}ma(b){if(0>b||b>=this.kY)throw Error.argumentOutOfRange("index");return this.S1d[this.Y1d+b]}get count(){return this.kY}static lxd(b){const f=new c;f.wGd(b,0,b.length);return f}}Object(y.a)(c,"ReadOnlyList",null,[689])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.kxta.js.map/8b545dce2989d1b1f0d4813be8293b21/EwaTS.kxta.js.map