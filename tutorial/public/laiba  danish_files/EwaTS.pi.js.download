'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[1],{1013:function(y,x,a){a.d(x,"a",function(){return b});y=a(0);x=a(896);var c=a(86);class b extends x.a{constructor(f,r,d){super(f,r);this.Bx=!0;this.command=d}ar(f){super.ar(f);this.businessBar.$.Ma.dh(new c.a(this.command,f,this.businessBar.$.Rh,10,null))}}Object(y.a)(b,"CommandActionBusinessBarEntry",x.a,[])},1062:function(y,x,a){function c(t){const m=r.a.instance;return Object.assign({},(()=>{switch(d.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.DataCleansingBusinessBarDifferentStrings",
k.Control)){case k.Clean:return{title:m.ia(2480),message:String.format(m.$g(240),t)};case k.Fix:return{title:m.ia(2481),message:String.format(m.$g(241),t)};case k.MakeConsistent:return{title:m.ia(2482),message:String.format(m.$g(242),t)};case k.MakeProfessional:return{title:m.ia(2483),message:String.format(m.$g(243),t)};case k.AvoidIncorrections:return{title:String.format(m.$g(244),t),message:m.ia(2484)};case k.Polish:return{title:m.ia(2486),message:String.format(m.$g(245),t)};default:return{title:String.format(m.$g(239),
t),message:m.ia(2475)}}})(),{GXc:m.ia(2474)})}function b(){return d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingBusinessBarLearnMoreLinkEnabled",!1)}function f(){switch(d.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.DataCleansingBusinessBarDifferentStrings",k.Control)){case k.Clean:return"Error";case k.Fix:return"Error";case k.MakeConsistent:return"Lightbulb";case k.MakeProfessional:return"Lightbulb";case k.AvoidIncorrections:return"Warning";case k.Polish:return"AutoEnhanceOn";
default:return"Lightbulb"}}a.d(x,"b",function(){return c});a.d(x,"c",function(){return b});a.d(x,"a",function(){return f});y=a(0);var r=a(12),d=a(1),k;(function(t){t[t.Control=0]="Control";t[t.Clean=1]="Clean";t[t.Fix=2]="Fix";t[t.MakeConsistent=3]="MakeConsistent";t[t.MakeProfessional=4]="MakeProfessional";t[t.AvoidIncorrections=5]="AvoidIncorrections";t[t.Polish=6]="Polish"})(k||(k={}));Object(y.b)("BusinessBarExperiment",k)},1064:function(y,x,a){a.d(x,"a",function(){return d});y=a(0);var c=a(14),
b=a(6),f=a(60),r=a(34);class d{static WAf(k,t){switch(k){case 3:return d.HYi(t);case 2:return d.dQi(t);case 1:return d.WIi(t)}return""}static HYi(k){switch(k){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static dQi(k){switch(k){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static WIi(k){switch(k){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString();
case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static x9d(k,t,m){if(r.a.Un||r.a.hw)window.setTimeout(()=>{d.Byg(m,d.FKf())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(d.O3e(m),k,0,!1)}static kUh(k,t,m,e){t&&e&&e();d.x9d(k,t,m)}static FKf(){return r.a.Un?1:r.a.hw?2:r.a.r1a?3:r.a.isMac?4:0}static get LUb(){return"zh-CN"===window.navigator.language}static Byg(k,t){1===t?(c.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),
k=d.WAf(k,t),8<r.a.gSb?f.a.dm(k,void 0,void 0,"RedirectToAppStore"):f.a.V4(k)):document.hidden||(d.LUb?(k=b.AFrameworkApplication.fa.appSettings.WildFireUrlChinaStoreAndroid.toString())?(c.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),f.a.V4(k)):c.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(c.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(d.WAf(k,t),null,null)))}static O3e(k){switch(k){case 3:return 5;
case 2:return 3;case 1:return 1;default:return 0}}static get Gpe(){return(r.a.r1a||r.a.isMac)&&r.a.Av}static mBf(k){switch(k){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static $kj(k){return(k=d.rMi(k))&&""!==k?Boolean.parse(k):!1}static kne(k){d.bBk(k)}static rMi(k){try{return localStorage.getItem(k)}catch(t){return c.ULS.sendTraceTag(18416668,306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+t.message),
null}}static bBk(k){try{localStorage.setItem(k,"true")}catch(t){c.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+t.message)}}}d.TSh="ChromeExtensionBarDismiss";Object(y.a)(d,"WildFireUtilities",null,[])},114:function(y,x,a){function c(G){return G.includes("aadInteractionRequired")||G.includes("sessionRevocation")||G.includes("blockAccessForTenantRestrictions")||G.includes("revoked")||G.includes("Due to organizational policies, you can't access these resources from this network location")?
!0:!1}function b(){return Za.AFrameworkApplication.fa?Za.AFrameworkApplication.fa.la("WopiTokenRevokedTokenExperiment")&&Za.AFrameworkApplication.fa.la("ShowTokenRevocationErrorMessage"):!1}function f(G,da){return No(function*(){if(Object(Lc.l)(G.na)){const $a=G.na.sheetProcessedData;Object(xc.a)($a);return da.map(Sb=>af(Sb,!0)).filter(Sb=>$a.value.Pxa(Sb))}return[]})}function r(G,da,$a,Sb){const Mc=new Map;if(0===Sb.size)return Mc;if(!Object(Lc.l)(G.na))return wa.ULS.sendTraceTag(507568209,0,15,
"Grid.getFormulasPointingToRange Unable to get activeItem."),Mc;if(G.na.sheetId===$a){const sd=Object(fc.f)(G);$a=sd.za.Zz();const Od=G.na.sheetName;$a.forEach(se=>{var Ye;if(se.na.sheetName===Od){const hf=sd.$.workbookContext.WorkbookFileName;(se=null===(Ye=se.el)||void 0===Ye?void 0:Ye.getCalcBlockModel())?d(da,se,Od,hf,Sb).forEach(ag=>{const Jg=Mc.get(ag.mBe)||new Set;Jg.add(ag.uah);Mc.set(ag.mBe,Jg)}):wa.ULS.sendTraceTag(507597516,0,15,"Grid.getFormulasPointingToRange Unable to get CalcBlockModel.")}})}return Mc}
function d(G,da,$a,Sb,Mc){const sd=new Set;if(G){var Od=da.getRowNumbers(),se=da.getColumnNumbers();Od=Od[0];se=se[0];da.reset();let Ye=null;for(;Ye=da.getNextCell();)if(Object(Vb.f)(Ye.formula)){const hf=G.extractReferences(Ye.formula,$a,Sb,!0);if(hf){const ag=new ce.Range(Ye.row+Od,Ye.col+se,Ye.row+Od,Ye.col+se,!1,!1);for(const Jg of hf.Items){const tg=Object(Pe.E)(Jg.Range);Mc.forEach(Xg=>tg.pk(Xg)?sd.add({mBe:ag,uah:Xg}):null)}}}}else wa.ULS.sendTraceTag(507597515,0,15,"Grid.getInBlockFormulasPointingToRange Unable to get calcManager.");
return sd}function k(G){switch(G){case 0:return 1;case 2:return 2;case 1:return 4;default:throw wa.ULS.sendTraceTag(508559903,0,10,`ConvertExtraSpacesTypeToTrimWhitespaceType: Unknown ExtraSpacesPaddingType ${G}`),Error.argument("illegal ExtraSpacesPaddingType");}}function t(G,da,$a,Sb,Mc){return No(function*(){const sd=Object(Pe.v)(G.activeItemName,null,da),{c8d:Od,b8d:se,F9d:Ye}=w();Object(mc.a)(G.userOperationManager,(hf,ag,Jg)=>le.D(G.pa.ta,Mc,sd,Sb,Object(Ac.c)(hf,Od),Object(Ac.b)(ag,se),Jg,
null),hf=>new Sa.a(258,0,hf),null);yield Ye;return $a.length})}function m(G,da,$a){return No(function*(){const Sb=Object(Pe.v)(G.activeItemName,null,da),Mc=G.pa.ta.Jh({Cya:!0,ixa:1}),{c8d:sd,b8d:Od,F9d:se}=w();Object(mc.a)(G.userOperationManager,(Ye,hf,ag)=>ec.m(G.pa.ta,Sb,Object(Pe.p)(fc.f(G).ha.qa.activeCell,G),$a,!1,null,null,!0,!1,Object(Ac.c)(Ye,sd),Object(Ac.b)(hf,Od),ag,null,Mc,null),Ye=>new Sa.a(11,0,Ye),null);yield se;return-1})}function e(G,da,$a){return No(function*(){const Sb=Object(Pe.v)(G.activeItemName,
null,da),{c8d:Mc,b8d:sd,F9d:Od}=w(),se=$a.reduce((hf,ag)=>hf|ag,0);Object(mc.a)(G.userOperationManager,(hf,ag,Jg)=>{var tg=G.pa.ta;hf=Object(Ac.c)(hf,Mc);ag=Object(Ac.b)(ag,sd);const Xg=tg.Za(9,null);Xg.ranges=Sb;Xg.trimWhitespaceType=se;return ec.h(tg,"TrimWhitespace",Xg,hf,ag,Jg,null,0)},hf=>new Sa.a(253,0,hf),null);const {Result:Ye}=yield Od;return Ye})}function w(){const G=new ma.a;return{c8d(da){da&&lb.a.Jk(da.Errors)?(wa.ULS.sendTraceTag(509617682,0,10,"DataCleansing onOperationSuccess: Ewa result contains error messages after applying"),
G.setResult(null)):da?(wa.ULS.sendTraceTag(537163359,0,20,"DataCleansing onOperationSuccess: Suggestion applied successfully"),G.setResult(da)):(wa.ULS.sendTraceTag(508424517,0,10,"DataCleansing onOperationSuccess: Ewa result is null after applying"),G.setResult(null))},b8d(da){wa.ULS.sendTraceTag(509617681,0,10,`DataCleansing onOperationFailed: Ewa result contains error messages HttpStatus [${da.data.httpStatus}]`);G.setResult(null)},F9d:Ze.e(G.task)}}function l(G,da){if(Object(E.c)(G)||xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInEditMode",
!1)&&G.isMobileMode)return!0;G=da.worksheetState;return!!da.hostState.errorState||G.isInNamedSheetView||G.isProtected}function u(G){if(!G)return!1;G=G.sheetProcessedData;return Object(xc.d)(G)||"PartialResult"===(null===G||void 0===G?void 0:G.reason)?!1:!0}function n(G){return Object(Eh.f)(G.name)}function v(){const G=new EventTarget;return{addEventListener:function(da,$a,Sb){G.addEventListener(da,Mc=>{$a(Mc)},{signal:null===Sb||void 0===Sb?void 0:Sb.signal,once:null===Sb||void 0===Sb?void 0:Sb.once})},
dispatchEvent:function(da,$a){G.dispatchEvent(new CustomEvent(da,{detail:$a}))}}}function B(G){const da=new Dj.a;da.Bh=4;Za.AFrameworkApplication.fa.la("IsNewStringEnabled")?(G=CommonUiStrings.AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUiStrings.AppsForOfficeDeveloperManifestUrl,G)+CommonUiStrings.AppsforOfficeLoadManifestUrl,da.QV(CommonUiStrings.AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,G,Sd)):(G=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+
String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,G)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl,da.QV(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,G,Sd))}a.r(x);var z={};a.r(z);a.d(z,"EwaAccessTokenExpirationManager",function(){return He});var C={};a.r(C);a.d(C,"AutoAdjustColumnsManager",function(){return Uc});var D={};a.r(D);a.d(D,"RenameFileManager",function(){return hd});var J={};a.r(J);a.d(J,"BlockPrefetcher",function(){return te});var W={};a.r(W);
a.d(W,"CalcInterfaceAdapter",function(){return Fe});var N={};a.r(N);a.d(N,"CalcManager",function(){return dd});var M={};a.r(M);a.d(M,"CopilotNewBadgeManager",function(){return Zd});var Q={};a.r(Q);a.d(Q,"DataCleansingHostManager",function(){return cd});var R={};a.r(R);a.d(R,"EnrichmentTaskPane",function(){return ke});var O={};a.r(O);var U={};a.r(U);a.d(U,"ExtendedTooltipsManager",function(){return Kf});var K={};a.r(K);a.d(K,"FilteredResultsStatusBarManager",function(){return dh});var F={};a.r(F);
a.d(F,"FirstRunExperienceManager",function(){return Rg});var I={};a.r(I);a.d(I,"HeaderSnappingFeature",function(){return fh});var P={};a.r(P);a.d(P,"InProductMessagingManagerFactory",function(){return qg});var Y={};a.r(Y);a.d(Y,"InstantaneousSupportInformationManager",function(){return Be});var ea={};a.r(ea);a.d(ea,"LineageTeachingCalloutTriggerManager",function(){return Tf});var Ba={};a.r(Ba);a.d(Ba,"NavigationFailHandler",function(){return Xf});var Fa={};a.r(Fa);a.d(Fa,"NetworkConnectionStateManager",
function(){return Me});var za={};a.r(za);var xa={};a.r(xa);a.d(xa,"ProactiveSuggestionDebugToolsManager",function(){return fe});var fa={};a.r(fa);a.d(fa,"ProactiveSuggestionManager",function(){return Te});var V={};a.r(V);a.d(V,"ReactTaskPaneManager",function(){return Zc});var ba={};a.r(ba);a.d(ba,"SdxManifestPrefetcher",function(){return ne});var la={};a.r(la);a.d(la,"SharedUIControlsFactory",function(){return Lh});var Ta={};a.r(Ta);a.d(Ta,"SheetProcessedDataPrefetcher",function(){return xh});var Ea=
{};a.r(Ea);a.d(Ea,"StatusBarAggregateManager",function(){return rj});var sa={};a.r(sa);a.d(sa,"ThemesManager",function(){return ii});var Ya={};a.r(Ya);a.d(Ya,"UnifiedConsentAdapter",function(){return Li});var bb={};a.r(bb);a.d(bb,"ViewportObserver",function(){return ti});var ra={};a.r(ra);a.d(ra,"ViewportTelemetryManager",function(){return bi});var Da={};a.r(Da);a.d(Da,"ZoomEventManager",function(){return ji});var oa={};a.r(oa);a.d(oa,"ZoomManager",function(){return bj});var Ha={};a.r(Ha);a.d(Ha,
"FullScreenStatusBarManager",function(){return Oh});var ka=a(0),wa=a(14),Za=a(6),ab=a(85),db=a(295);class mb{constructor(){this.zUe=this.ohd=!1;this.s3a=()=>{db.a.instance.Hge(this.s3a);wa.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.F2i()};this.Xmg=()=>{db.a.instance.Gge(this.Xmg);this.zUe||this.ohd||(wa.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.zUe=!0,this.tNk())};const G=Za.AFrameworkApplication.accessTokenTtl;0>=G||(this.accessTokenTtl=
G,wa.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.accessTokenTtl,["NowGetTime"]:(new Date).getTime(),["BootTime"]:Za.AFrameworkApplication.LQ}),db.a.instance.qnd(this.s3a),db.a.instance.ond(this.Xmg))}F2i(){this.ohd||(Za.AFrameworkApplication.wC(ab.a.Jub),this.ohd=!0,this.sNk())}$md(){throw Error("Method not implemented.");}lCg(){throw Error("Method not implemented.");}}Object(ka.a)(mb,"ASessionExpirationManager",null,[]);var Ia=a(96),pa=a(38),
lb=a(35),ha=a(12),ua=a(47),fb=a(282),Ka=a(8),La=a(92),ib=a(287),Yb=a(75),Wc=a(97),Qc=a(5),Wb=a(208),Jc=a(139),ma=a(182),Hc=a(158),Kb=a(353);class pc{}Object(ka.a)(pc,"Error",null,[]);class $b{}Object(ka.a)($b,"NamedResult",null,[]);class Ib extends $b{}Object(ka.a)(Ib,"ErrorInfo",$b,[]);class Zb{}Zb.njc="ActivityDuration";Zb.error="Error";Zb.aCd="Errors";Zb.failed="Failed";Zb.ovi="FirstActivity";Zb.initialized="Initialized";Zb.Gsj="LastActivity";Zb.KFg="RetryOverride";Zb.Znk="RequestGroups";Zb.requests=
"Requests";Zb.responses="Responses";Zb.HVc="SessionDuration";Zb.status="Status";Zb.success="Success";Zb.successful="Successful";Zb.tokens="Tokens";Object(ka.a)(Zb,"SessionExpirationStrings",null,[]);var Eb=a(123);class ob{constructor(G){this.kx={};this.s8={};this.Ymh={};this.M5f=15;this.CMe=!1;this.Joh=new Date;this.Fec=new Date;this.h7g=()=>{wa.ULS.sendTraceTag(41964821,217,50,wa.ULS.li({["Aggregate"]:this.s8,["Current"]:this.kx}))};this.$j=G;this.iic=new Eb.a(2,2,6E4*this.M5f,this.h7g,135,"SL",
!1);this.$j.Ol(this.iic);this.qaj()}qaj(){this.s8[Zb.Znk]=0;this.s8[Zb.requests]=0;this.s8[Zb.responses]=0;this.s8[Zb.status]=Zb.initialized;this.s8[Zb.ovi]=new Date;this.s8[Zb.HVc]=0;this.s8[Zb.njc]=0;this.s8[Zb.HVc]=0;this.kx[Zb.HVc]=0;this.s8[Zb.njc]=0;this.kx[Zb.njc]=0}DQd(G,da){var $a=G[da];$a=$a?$a:0;$a++;G[da]=$a;this.Cme(G)}Cme(G){const da=new Date;G[Zb.njc]=+da-+this.Fec;this.Fec=da;G[Zb.HVc]=+this.Fec-+this.Joh;G[Zb.Gsj]=this.Fec}Wba(G,da){this.kx[G]=da;this.Cme(this.kx)}eme(G,da){this.kx[G]=
da;this.Cme(this.kx)}incrementCounter(G){this.DQd(this.kx,G);this.DQd(this.s8,G);this.DQd(this.Ymh,G)}flush(){this.CMe||(this.s8[Zb.status]=this.kx[Zb.status],this.h7g(this.iic),this.$j.Lba(this.iic,6E4*this.M5f))}stop(){wa.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.CMe=!0;this.$j.wx(this.iic)}}Object(ka.a)(ob,"SessionLogger",null,[274]);class Na{constructor(G,da){this.vic=G;this.dT=da}get tokens(){return this.vic}get errors(){return this.dT}}Object(ka.a)(Na,
"TokenRefreshArgs",null,[258]);var nb=a(107),Hb=a(598),na=a(529),Gb=a(188),Xa=a(478),Jb=a(159),qb=a(1047),Db=a(354),gb=a(280),ya=a(1059),Aa=a(653);class sb{constructor(G,da,$a,Sb,Mc,sd,Od,se,Ye,hf,ag){Sb=void 0===Sb?null:Sb;Mc=void 0===Mc?!1:Mc;sd=void 0===sd?null:sd;Od=void 0===Od?!1:Od;se=void 0===se?!1:se;Ye=void 0===Ye?!1:Ye;hf=void 0===hf?!1:hf;ag=void 0===ag?!1:ag;this.jka=0;this.i3=this.iq=null;this.vic=new Wb.a;this.dT=new Wb.a;this.Fs=null;this.CDa=!1;this.OEb=this.PEb=null;this.lok=()=>
{this.kEg()};Object(ya.a)()||(this.$j=G,this.RRe=da,this.RRe.execute(Jg=>{Jg.Ip(Jb.a.KPd,Object(Jc.a)(this,this.MRj,"onHostResponseReceived"))}),this.xQ=$a,this.EWe=new qb.a("WebServiceCall","TokenRefresh"),this.kr=Sb||new ob(G),this.Eoh=Mc,this.HW=sd?sd:Hb.SessionStatusManager.instance,this.ZHe=Od,this.Gcc=se,this.Qoh=Ye,this.Roh=hf,this.SUe=ag,this.A$a=Aa.a.getInstance({Jla:"wwrelfc",featureName:"TokenRefreshManager",Gdb:"Infrastructure"}))}MRj(G){if(G.MessageId!==Jb.a.KPd)wa.ULS.sendTraceTag(39408099,
217,15,"Unexpected message.");else{var da=new Wb.a,$a=new Wb.a;this.kr.incrementCounter(Zb.responses);var Sb=G.Values[Xa.a.pKg];if(!Sb||0>=Sb.length)wa.ULS.sendTraceTag(40122317,217,15,"Found no tokens in the dictionary"),Sb=G.Values;this.kr.Wba("Correlation",G.CorrelationId);var Mc="";for(let Ye=0;Ye<Sb.length;Ye++){this.kr.eme(Zb.tokens,Sb.length);var sd=Sb[Ye],Od=sd;if(Od&&Od.Name){this.kr.incrementCounter(Od.Name);var se=sd;if(se&&se.Value)da.add(se),this.vic.add(se),this.Gcc||this.kr.Wba(Zb.status,
Zb.success),this.ZHe&&this.HW&&this.HW.epk();else{if(this.QPg){se=sd;sd=Object.assign(new Ib,{Name:se.Name,Errors:[],SPCorrelationId:se.SPCorrelationId});for(const hf of se.Errors)se=new pc,se.Id=hf.Id,se.Details=na.a.mJa(hf.Details,500),sd.Errors.push(se)}else sd=this.GTi(sd);wa.ULS.sendTraceTag(39408129,217,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",Od.Name,JSON.stringify(sd),this.i3);$a.add(sd);this.Gcc||(this.dT.add(sd),Mc=JSON.stringify(sd),this.kr.Wba(Zb.error,
JSON.stringify(sd)),this.kr.Wba(Zb.status,Zb.failed));if(this.ZHe)for(const hf of sd.Errors){if(this.QPg)if(Od=ab.a.Jub,sd=parseInt(hf.Id),se=hf.Details.toString(),isNaN(sd))Od=void 0;else{switch(sd){case 401:Od=ab.a.N6g;b&&c(se)&&(Od=ab.a.$2c);break;case 403:Od=ab.a.J6g;b&&c(se)&&(Od=ab.a.$2c);break;case 500:Od=ab.a.K6g;break;case 503:Od=ab.a.M6g}Od===ab.a.Jub&&(Od=500<sd?ab.a.L6g:ab.a.I6g)}else Od=this.JIi(hf);this.HW&&this.HW.Lwh(Od)}}}}this.Gcc?(0<$a.count?this.OEb?this.OEb(new Na(da,$a)):wa.ULS.sendTraceTag(512267295,
217,15,"Received errors but the promise has completed.TaskId {0}, IsSessionExpired: {1}, IsTokenExpiring: {2}, Error: {3}",this.i3,this.HW.eFc,this.CDa.toString(),Mc):this.PEb?this.PEb(new Na(da,$a)):wa.ULS.sendTraceTag(512267294,217,15,"Received valid tokens but the promise has completed. TaskId {0}, IsSessionExpired: {1}, IsTokenExpiring: {2}",this.i3,this.HW.eFc,this.CDa.toString()),wa.ULS.sendTraceTag(512344162,217,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",
da.count,$a.count,G.CorrelationId,this.i3)):(0<$a.count&&""!==Mc?(Sb=Object.assign({},{extendedProperties:new Map}),Sb.extendedProperties.set("Errors",Mc),Sb.extendedProperties.set("RetryCount",this.jka.toString()),Sb.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),Sb.extendedProperties.set("IsTokenExpiring",this.CDa.toString()),this.tWd()&&Sb.extendedProperties.set("IsAppShuttingDown",Za.AFrameworkApplication.Il.toString()),this.Svb?(Sb.extendedProperties.set("SkipAria",
"false"),Sb.extendedProperties.set("TokenRefreshCorrelationId",G.CorrelationId),this.A$a.loa({kw:"WACTokenRefresh",errorName:"TokenRefreshFailed",ik:{HUb:!1,isInternal:!1,GQ:Sb}})):nb.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,Sb)):this.Svb?(Mc=Object.assign({},{extendedProperties:new Map}),Mc.extendedProperties.set("SkipAria","false"),Mc.extendedProperties.set("TokenRefreshCorrelationId",G.CorrelationId),this.A$a.tLa({kw:"WACTokenRefresh",ik:{GQ:Mc}})):nb.Health.instance.recordKpiSuccess("WACTokenRefresh",
null),wa.ULS.sendTraceTag(39408130,217,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",da.count,$a.count,G.CorrelationId,this.i3),0<$a.count&&!this.gVb($a)?(G=this.xQ.dIf($a),G!==this.xQ.Rtb&&(this.kr.eme(Zb.KFg,G),this.$j.Lba(this.iq,G))):(this.kr.flush(),this.iq&&this.$j.wx(this.iq),this.Fs&&!this.Fs.task.isCompleted?this.Fs.setResult(new Na(da,$a)):wa.ULS.sendTraceTag(512267293,217,15,"Received results but the task has completed")))}}GTi(G){if(!G)return null;
const da=Object.assign(new Ib,{Name:G.Name,Errors:[],SPCorrelationId:G.SPCorrelationId});for(const $a of G.Errors)G=new pc,G.Id=$a.Id,G.Details=na.a.mJa($a.Details,500),da.Errors.push(G);return da}kEg(){gb.a.dB("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");if(this.jka>=this.xQ.M9f)wa.ULS.sendTraceTag(39408132,217,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.i3),this.dhf(this.Fs,"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts");
else{var G=Gb.a.create().toString();if(this.Svb){const da=new Map;da.set("SkipAria","false");da.set("TokenRefreshCorrelationId",G);this.A$a.Naa({kw:"WACTokenRefresh",Tnb:Db.b.SuccessBased,ik:{extendedProperties:da}})}else nb.Health.instance.recordKpiUsage("WACTokenRefresh",Db.b.SuccessBased,"wwrelfc",null);this.DJg(G)}}DJg(G){const da={};da[Xa.a.pKg]=this.xQ.tokens;this.Qoh&&(da[Xa.a.Lxk]=this.Roh);wa.ULS.sendTraceTag(39408133,217,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",
JSON.stringify(this.xQ.tokens),this.jka+1,G,this.i3);this.RRe.execute($a=>{$a.sendMessage(Jb.a.J3e,da,G)});this.jka++;this.kr.incrementCounter(Zb.requests)}dhf(G,da,$a){const Sb=new Wb.a;for(let Mc=0;Mc<this.xQ.tokens.length;Mc++){const sd=Object.assign(new Ib,{Name:this.xQ.tokens[Mc],Errors:[Object.assign(new pc,{Id:da,Details:$a})]});Sb.add(sd);this.dT.add(sd)}this.$j.wx(this.iq);this.kr.Wba(Zb.aCd,JSON.stringify(this.dT));this.kr.Wba(Zb.status,Zb.failed);G&&!G.task.isCompleted&&G.setResult(new Na(new Wb.a,
this.dT))}tWd(){return Za.AFrameworkApplication.fa&&Za.AFrameworkApplication.fa.isChangeGateEnabled("SkipSessionExpiredVetoForShutdown")}Hdk(G,da){da=void 0===da?null:da;gb.a.dB("ej4if276;fheca743");gb.a.dB("5d4fi128;abe10395");gb.a.dB("7db39907;cegi0367;ijicc640");this.EWe.start();this.tWd()&&this.$j.HZa&&(wa.ULS.sendTraceTag(508351137,217,15,"Restarting taskmanager, is shutting down {0}",Za.AFrameworkApplication.Il),this.$j.W3b());this.CDa=G;this.i3=Gb.a.create().toString();wa.ULS.sendTraceTag(41755338,
217,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.i3,this.CDa);this.jka=0;this.dT.clear();this.vic.clear();const $a=new ma.a;this.Fs=$a;da&&da.R(()=>{const Sb=!!$a&&!$a.task.isCompleted;wa.ULS.sendTraceTag(588096223,217,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",this.i3,this.CDa,Sb);Sb&&this.dhf($a,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});this.Gcc?this.lEg(this.xQ.M9f).then(Sb=>{this.Fs&&!this.Fs.task.isCompleted&&
this.Fs.setResult(Sb);this.OEb=this.PEb=null;this.kr.Wba(Zb.aCd,JSON.stringify(this.dT));this.kr.Wba(Zb.status,Zb.success);this.kr.flush()}).catch(Sb=>{this.Fs&&!this.Fs.task.isCompleted&&this.Fs.setResult(Object(Hc.a)(258,Sb));this.OEb=this.PEb=null;this.kr.Wba(Zb.aCd,JSON.stringify(this.dT));this.kr.Wba(Zb.status,Zb.failed);this.kr.flush()}):(this.iq=new Eb.a(this.xQ.priority,2,this.xQ.Rtb,this.lok,98,Jb.a.J3e,!0),this.Eoh&&this.kEg(),this.$j.Ol(this.iq));return this.Fs.task}lEg(G){const da=this,
$a=Gb.a.create().toString(),Sb=new Promise((Ye,hf)=>{da.PEb=Ye;da.OEb=hf;this.Svb?(Ye=new Map,Ye.set("SkipAria","false"),Ye.set("TokenRefreshCorrelationId",$a),this.A$a.Naa({kw:"WACTokenRefresh",Tnb:Db.b.SuccessBased,ik:{extendedProperties:Ye}})):nb.Health.instance.recordKpiUsage("WACTokenRefresh",Db.b.SuccessBased,"wwrelfc",null);da.DJg($a)}),Mc=this,sd=new Promise((Ye,hf)=>{window.setTimeout(()=>{hf(Mc.jhf("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},
Mc.xQ.Rtb)});let Od=G;const se=this;return new Promise((Ye,hf)=>{Od--;Promise.race([Sb,sd]).then(ag=>{if(this.Svb){const Jg=Object.assign({},{extendedProperties:new Map});Jg.extendedProperties.set("SkipAria","false");Jg.extendedProperties.set("TokenRefreshCorrelationId",$a);this.A$a.tLa({kw:"WACTokenRefresh",ik:{GQ:Jg}})}else nb.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Ye(ag)}).catch(ag=>{var Jg=se.xQ.Rtb;if(Object(Kb.a)(258,ag)&&(ag=Object(Hc.a)(258,ag),0<ag.errors.count)){se.lxj(ag.errors,
$a);se.Sy(ag.errors);if(se.gVb(ag.errors)){hf(ag);return}const tg=se.xQ.dIf(ag.errors);tg!==se.xQ.Rtb?(se.kr.eme(Zb.KFg,tg),Jg=tg):se.cqj(ag.errors)&&(Jg=0)}Od?window.setTimeout(()=>{se.lEg(Od).then(Ye).catch(hf)},Jg):(Jg=se.jhf("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),se.Sy(Jg.errors),hf(Jg),wa.ULS.sendTraceTag(512267292,217,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",se.i3))})})}Sy(G){for(const da of G)this.dT.add(da)}cqj(G){if(!G.count)return!1;
G=G.ma(G.count-1);return G.Errors.length?"TIMEOUT"==G.Errors[0].Id:!1}jhf(G,da){const $a=new Wb.a;for(let Sb=0;Sb<this.xQ.tokens.length;Sb++){const Mc=this.$1h(this.xQ.tokens[Sb],G,da);$a.add(Mc)}return new Na(new Wb.a,$a)}$1h(G,da,$a){return Object.assign(new Ib,{Name:G,Errors:[Object.assign(new pc,{Id:da,Details:$a})]})}lxj(G,da){if(G.count){G=G.ma(G.count-1);G=JSON.stringify(G);var $a=Object.assign({},{extendedProperties:new Map});$a.extendedProperties.set("Errors",G);$a.extendedProperties.set("RetryCount",
this.jka.toString());$a.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());$a.extendedProperties.set("IsTokenExpiring",this.CDa.toString());this.tWd()&&$a.extendedProperties.set("IsAppShuttingDown",Za.AFrameworkApplication.Il.toString());this.Svb?($a.extendedProperties.set("SkipAria","false"),$a.extendedProperties.set("TokenRefreshCorrelationId",da),this.A$a.loa({kw:"WACTokenRefresh",errorName:"TokenRefreshFailed",ik:{GQ:$a}})):nb.Health.instance.recordKpiFailure("WACTokenRefresh",
"TokenRefreshFailed",!1,!1,$a);this.kr.Wba(Zb.error,G);this.kr.Wba(Zb.status,Zb.failed)}}d8j(G){this.EWe.stop();const da=this.N3i(G.result.errors);wa.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!da,this.i3,this.CDa,this.jka,this.dT.count,0<G.result.errors.count?G.result.errors.ma(0).Name:"",0<G.result.errors.count&&0<G.result.errors.ma(0).Errors.length?
G.result.errors.ma(0).Errors[0].Id:"",0<G.result.errors.count&&0<G.result.errors.ma(0).Errors.length?G.result.errors.ma(0).Errors[0].Details:"");return da?!1:this.c8j(G.result.tokens)}gVb(G){return this.xQ.gVb(G)}c8j(G){for(let da=0;da<G.count;da++){const $a=G.ma(da);if($a.Name===Xa.a.accessToken){const Sb=(new Date).getTime();$a.Expiry>Za.AFrameworkApplication.accessTokenTtl?(wa.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:$a.Expiry,["NowGetTime"]:Sb,["BootTime"]:Za.AFrameworkApplication.LQ},
"PreviousAccessTokenTtl",Za.AFrameworkApplication.accessTokenTtl),Za.AFrameworkApplication.accessToken=$a.Value,Za.AFrameworkApplication.accessTokenTtl=Math.floor($a.Expiry),Za.AFrameworkApplication.h9a=Sb,Za.AFrameworkApplication.vka=Math.floor($a.Expiry)):wa.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:$a.Expiry,["NowGetTime"]:Sb,["BootTime"]:Za.AFrameworkApplication.LQ},"PreviousAccessTokenTtl",Za.AFrameworkApplication.accessTokenTtl)}}return!0}N3i(G){let da=
!1;for(let $a=0;$a<G.count;$a++){da=!0;const Sb=G.ma($a);wa.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2}, SPCorrelationId: {3}",Sb.Name,JSON.stringify(Sb.Errors),this.i3,Sb.SPCorrelationId)}return da}p0f(G){return G.includes("aadInteractionRequired")||G.includes("sessionRevocation")||G.includes("blockAccessForTenantRestrictions")||G.includes("revoked")||G.includes("Due to organizational policies, you can't access these resources from this network location")?
!0:!1}JIi(G){let da=ab.a.Jub;const $a=parseInt(G.Id);G=G.Details.toString();if(isNaN($a))da=ab.a.Zal;else{switch($a){case 401:da=ab.a.N6g;this.SUe&&this.p0f(G)&&(da=ab.a.$2c);break;case 403:da=ab.a.J6g;this.SUe&&this.p0f(G)&&(da=ab.a.$2c);break;case 500:da=ab.a.K6g;break;case 503:da=ab.a.M6g}da===ab.a.Jub&&(da=500<$a?ab.a.L6g:ab.a.I6g)}return da}get Svb(){return null!=this.aDe?this.aDe:this.aDe=Za.AFrameworkApplication.fa?Za.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldUseNewKPIApiForTokenRefresh",
!1):!1}get QPg(){return null!=this.XCe?this.XCe:this.XCe=Za.AFrameworkApplication.fa?Za.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldRefactorProcessingTokenRefreshError",!1):!1}}Object(ka.a)(sb,"TokenRefreshManager",null,[259]);class nc{constructor(){this.Rtb=Za.AFrameworkApplication.bbl;this.M9f=Za.AFrameworkApplication.$al;this.tokens=Za.AFrameworkApplication.nZi();this.priority=Za.AFrameworkApplication.wze;this.eTe=this.ECk();this.lcb=Za.AFrameworkApplication.mZi()}gVb(G){if(this.hKk){var da=
[];for(const Sb of G)if(Sb.Errors)for(const Mc of Sb.Errors)da.push(Mc.Id);G=JSON.stringify(da);if(this.lcb&&0<this.lcb.length)for(var $a of this.lcb)if(0<$a.length&&0<=G.indexOf($a))return!0}else if($a=JSON.stringify(G),this.lcb&&0<this.lcb.length)for(da of this.lcb)if(0<da.length&&0<=$a.indexOf(da))return!0;return!1}dIf(G){try{if(G)for(const da of G)if(da.Errors)for(const $a of da.Errors)if($a.Id in this.eTe)return Number.parseInvariant(this.eTe[$a.Id].toString())}catch(da){wa.ULS.sendTraceTag(41501720,
217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",da.toString())}return this.Rtb}ECk(){const G={};try{if(!Za.AFrameworkApplication.MAc()||0>=Za.AFrameworkApplication.MAc().length||""===Za.AFrameworkApplication.MAc()[0])return G;for(const da of Za.AFrameworkApplication.MAc())0<da.length&&(G[da]=Za.AFrameworkApplication.abl)}catch(da){wa.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",da.toString())}return G}get hKk(){return null!=
this.$Ce?this.$Ce:this.$Ce=Za.AFrameworkApplication.fa?Za.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldUseErrorsForParsingPermanentErrors",!1):!1}}Object(ka.a)(nc,"TokenRefreshPolicy",null,[257]);var Bb=a(2),uc=a(81),Pc=a(761),wd=a(32);class Md{constructor(G,da){this.q2b=!1;this.correlationID=G;this.Ixd=da;this.I_c=!1;this.creationTime=wd.a.Tg.Wh}}Object(ka.a)(Md,"RefreshAccessTokenContext",null,[]);var Nd=a(65),ec=a(62),gc=a(183),Mb=a(54),sc=a(129),xd=a(144),
xb=a(1),Lb=a(27),Rc=a(170),nd=a(36),$d=a(112);class Td{constructor(G,da){this.documentVisibilityObserver=null;this.Og=new pa.a;this.PL=null;this.B7a=this.hbb=!1;this.JRc=null;this.z2b=!1;this.a1d=!0;this.ocd=this.KMe=this.bE=this.MEb=!1;this.z2=null;this.RYg=this.MGd=this.Hvc=this.Il=!1;this.IMf=()=>{if(this.$.ea.Ph)this.eNf(!1);else if(this.a1d){this.a1d=!1;const $a=Yb.a(this.$);wa.ULS.sendTraceTag(537170709,0,50,`EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [${$a.Dp?
$a.Dp.activityName:"None"}] TimeUntilTokenExpirationInMin [${this.lYg()}]`)}};this.Oi=($a,Sb)=>{this.context&&($a=this.$.ea,Sb.rM&&this.context.q2b&&!this.context.I_c?(this.context.I_c=!0,Sb={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},Sb.IsUserActive=$a.ql.Yu,Sb.RefreshAccessTokenCorrelationID=this.context.correlationID,Sb=Nd.a.li(Sb),wa.ULS.sendTraceTag(537170708,0,50,Sb)):!this.hbb||$a.Ph||this.context.Ixd||(Sb={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},
this.PL&&(this.PL.cancel(),Sb.Aborted=!0,Sb.ResetStopRefreshRetriesUntilTokenExpired=!0,this.B7a=!1),Sb.TimeUntilTokenExpirationInMin=this.lYg(),Sb.RefreshAccessTokenCorrelationID=this.context.correlationID,Sb=Nd.a.li(Sb),wa.ULS.sendTraceTag(572019856,0,50,Sb)))};this.uMa=()=>{if(this.context&&this.context.q2b&&!this.context.I_c){var $a={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};$a.CreatedForExpired=this.context.Ixd;$a.RefreshAccessTokenCorrelationID=this.context.correlationID;
$a.OpenWorkbookErrors=lb.a.Kh(this.$.ea.oP);$a.ExecutionContextErrors=lb.a.Kh(Yb.a(this.$).ij.errors);$a.accesstokenTTL=Za.AFrameworkApplication.accessTokenTtl;$a=Nd.a.li($a);wa.ULS.sendTraceTag(537170707,0,15,$a)}};this.dNf=()=>{this.B7a=!1;this.eNf(!0)};this.e9d=()=>{this.z2b&&(this.$.ea.ql.HNa(this.e9d),this.z2b=!1);this.zUg()};this.$=G;this.Aue=da;this.ree=G.qh.Vl("WebServiceCall","refreshToken");db.a.instance.qnd(this.dNf);db.a.instance.ond(this.IMf);da=this.$.ea;da.uq(this.Oi);da.Ekc(this.uMa);
this.gEj=this.$.ua.MinTokenLifetimeForRegularExpirationPromptInMin;this.XOg=this.$.ua.ShortAccessTokenExpirationPromptSeconds;this.Gyg=this.$.ua.RefreshAccessTokenDurationLimitInSec;this.R3g(G.ea.mqg,Za.AFrameworkApplication.accessTokenTtl);G=JSON.stringify({["AccessTokenTtl"]:Za.AFrameworkApplication.accessTokenTtl,["NowGetTime"]:(new Date).getTime(),["BootTime"]:Za.AFrameworkApplication.LQ,["WopiTokenExpiresAfterMinutes"]:Za.AFrameworkApplication.fCa,["WopiTokenTaskItemPriority"]:Za.AFrameworkApplication.wze});
wa.ULS.sendTraceTag(537170714,217,50,`Initializing EwaAccessTokenExpirationRefreshManager. ${G}`);xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void Wc.a.resolve(Qc.Ab).then($a=>{this.documentVisibilityObserver=$a}):this.$.ka.Lh(291,$a=>{this.documentVisibilityObserver=$a})}$Eg(){this.B7a=this.hbb=this.ocd=this.bE=!1;$d.a.kha=0;$d.a.sY=0;$d.a.tY=0}Ymd(G){this.Og.addHandler("SessionExpired",G)}vta(G){this.Og.addHandler("TokenRefreshed",G)}ntb(G){this.Og.removeHandler("TokenRefreshed",
G)}$md(){}lCg(){}get yue(){return this.MEb}get b6(){return this.KMe}get N0(){return this.ocd}get context(){return this.z2}get zvb(){return this.N0?!1:this.$.ea.ql.Yu?1>$d.a.sY:6>$d.a.tY}get Ssb(){return this.hbb}FBc(){return db.a.instance.AM(Za.AFrameworkApplication.accessTokenTtl)}dispose(){db.a.instance.Hge(this.dNf);db.a.instance.Gge(this.IMf);const G=this.$.ea;G&&(G.pq(this.Oi),G.SSc(this.uMa));Ia.a.Ng(this.Og);this.documentVisibilityObserver=this.$=null}lYg(){return this.FBc()?0:(Za.AFrameworkApplication.accessTokenTtl-
(new Date).getTime())/6E4}R3g(G,da){if(0<da&&!this.FBc()){const $a=Za.AFrameworkApplication.fa.vj("AccessTokenExpirationPromptSeconds",Za.AFrameworkApplication.qT),Sb=(da-G.getTime())/6E4;wa.ULS.shipAssertTag(537170713,0,0<=Sb,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [${da}] creationTime [${G.getTime()}] tokenLifetimeInMin [${Sb}]`);Sb<this.gEj?(wa.ULS.sendTraceTag(537170712,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${this.XOg}] tokenLifetimeInMin [${Sb}]`),
Za.AFrameworkApplication.qT=this.XOg):Za.AFrameworkApplication.qT!==$a&&(wa.ULS.sendTraceTag(537170711,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${$a}] tokenLifetimeInMin [${Sb}]`),Za.AFrameworkApplication.qT=$a)}}m0h(G){return!this.context||this.context.q2b||this.context.Ixd!==G?(G=new Md(Gb.a.create().toString(),G),this.context&&!this.context.I_c&&wa.ULS.sendTraceTag(537170710,0,15,`TokenManager.InitContext: creating new context [${G.correlationID}] although previeous one [${this.context.correlationID}] not used successfully, isPreviousOneRefreshedSuccessfully [${this.context.q2b}] `),
this.z2=G,!0):!1}Hok(G){G&&this.bE&&!this.b6&&this.$.ea.ql.Yu&&!this.N0&&(this.bE=!1)}eNf(G){this.Hok(G);if(!(this.hbb||this.B7a&&!G||this.bE)&&this.zvb){this.hbb=!0;var da=this.context?this.context.creationTime:null,$a=this.m0h(G);this.a1d=!0;var Sb=this.$.ea;this.Il=Za.AFrameworkApplication.Il;var Mc={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh"};Mc.newContextCreated=$a;Mc.IsUserActive=Sb.ql.Yu;Mc.IsSessionActive=Sb.Ph;Mc.ContainsChangesWorkbookOperations=this.$.userOperationManager.dWa();
Mc.isSessionExpired=G;Mc.stopRefreshRetriesUntilTokenExpired=this.B7a;Mc.FailedToRefreshExpiredToken=this.bE;Mc.numOfFailuresWhileUserIsActive=$d.a.sY;Mc.numOfFailuresWhileUserIsInActive=$d.a.tY;Mc.numOfFailuresWhileOffline=$d.a.kha;Mc.RefreshAccessTokenCorrelationID=this.context.correlationID;Mc.isShuttingDown=this.Il;$a&&da&&(Mc.TimeInMinFromPreviosContextCreation=Math.round(xd.b(wd.a.Tg,da)/60));da=Nd.a.li(Mc);wa.ULS.sendTraceTag(40416199,0,50,da);if(this.Il)wa.ULS.sendTraceTag(508126686,0,15,
da);else{this.ree.start();this.KMe=Sb.ql.Yu;this.PL=new Pc.a;this.zuj(G);var sd=this.Aue.Hdk(!G,this.PL?this.PL.token:null);sd.continueWith(()=>{this.xTh();const Od=this.Aue.d8j(sd);this.ree.stop();const se=this.FBc();if(!Od||xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&se){const Ye=sd.result.errors;Od&&se&&this.luh(Ye);this.g2i(Ye,G)}else this.B7a=!1,this.m2i(sd.result.tokens,G);this.hbb=!1},8)}}}luh(G){const da=[Object(Bb.a)(new pc,{Id:"200",Details:"Expired access token received on successful token request."})];
G.add(Object(Bb.a)(new Ib,{Name:"ExpiredTokenAfterSuccessfulRefresh",Errors:da}))}zuj(G){G&&(this.$.ea.ql.Yu?this.zUg():(this.$.ea.ql.jFa(this.e9d),this.z2b=!0))}zUg(){this.JRc=gc.AsyncMethodContext.$B(()=>{this.Gdk()},1E3*this.Gyg,Mb.a.kdk,this.JRc)}xTh(){this.JRc&&this.JRc.cancel();this.z2b&&(this.$.ea.ql.HNa(this.e9d),this.z2b=!1);this.PL=null}Gdk(){wa.ULS.sendTraceTag(537170706,0,15,`EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [${this.Gyg}]`);
this.PL.cancel()}g2i(G,da){this.B7a=!0;da&&(this.bE||(this.MEb=this.bE=!0),this.Aue.gVb(G)&&(this.ocd=!0));const $a=!da||this.zvb&&!$d.a.mXc?40380379:39982555;da=this.Ygf(da);da.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";da.FailedToRefreshExpiredToken=this.bE;da.LastErrorIsPermanent=this.N0;if(0<G.count){var Sb=G.ma(0);da.errorName=Sb.Name;0<Sb.Errors.length&&(da.ErrorId=Sb.Errors[0].Id,Sb=Sb.Errors[0].Details,da.ErrorDetails=this.Fdi(Sb.toString())?"PiiScrubbed":Sb)}da=Nd.a.li(da);
wa.ULS.sendTraceTag($a,0,15,da);if(0<G.count&&xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8514343_ReCategorizeSessionExpiryVeto")){this.Hvc=!1;for(const Mc of G)if(Mc.Errors)for(const sd of Mc.Errors)"GatekeeperCookieMismatch"===sd.Details&&(this.MGd=!0),"403"===sd.Id&&(this.Hvc=!0)}this.Og.raiseEvent("TokenRefreshed",new Na(null,G))}Fdi(G){return Lb.a.contains(G,"makes the internet safe for businesses",!0)}Ygf(G){const da={},$a=this.$.ea;da.Name="";da.IsUserActive=$a.ql.Yu;da.IsSessionActive=$a.Ph;
da.GotDeploymentOrTimedOutError=$a.O$;da.TimeInSecFromLastStatefulSuccessfulRequest=$a.a8;da.TimeFromLastUserActivityInMs=$a.ql.Rwb;da.calledFromSessionExpiredFlow=G;da.RefreshTokenDurationInMS=this.ree.ii;da.numOfFailuresWhileUserIsActive=$d.a.sY;da.numOfFailuresWhileUserIsInActive=$d.a.tY;da.numOfFailuresWhileOffline=$d.a.kha;da.RefreshAccessTokenCorrelationID=this.context.correlationID;da.accessTokenTTL=Za.AFrameworkApplication.accessTokenTtl;da.ContainsChangesWorkbookOperations=this.$.userOperationManager.dWa();
da.IsDocumentHidden=this.documentVisibilityObserver?this.documentVisibilityObserver.tn.toString():"Unknown";da.TimeFromFirstOpenInHr=Math.floor(xd.b(wd.a.Tg,sc.toUtc($a.mqg))/3600);return da}m2i(G,da){this.bE=!1;this.h7k();this.R3g(new Date,Za.AFrameworkApplication.accessTokenTtl);const $a=this.$.ea,Sb=!da&&$a.ql.Yu,Mc=!this.$.isEditMode&&$a.Jsb;da=this.Ygf(da);da.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";da.shouldTriggerSilentReloadAfterExpiring=Sb;da.WopiTokenTaskItemPriority=
Za.AFrameworkApplication.wze;da.isDirtyViewSession=Mc;da=Nd.a.li(da);wa.ULS.sendTraceTag(39982556,0,15,da);this.Og.raiseEvent("TokenRefreshed",new Na(G,null));Mc?$a.ql.Yu&&(wa.ULS.sendTraceTag(537170705,0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),$a.aGd()):$a.ql.Yu?xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UpdateNewUserAccessToken",!1)&&Sb&&this.$.isEditMode?wa.ULS.sendTraceTag(507827846,
0,50,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: successful token refresh when user is active."):Sb&&(G=Yb.a(this.$).ij.activityState,G[$d.a.oxb]=!0,G[Rc.a.o9]=!0,G[nd.a.Jz]=this.$.isEditMode,G[nd.a.jld]=this.$.ea.Tlb,ua.a(this.$).Dy(new fb.a(Ka.a.bqa,2,null))):$a.Ph&&ec.k(this.$.pa.ta,!0,!1,!1,null,null,null,null,null)}h7k(){void 0!==this.$.ea.workbookContext.WorkbookUri&&null!==this.$.ea.workbookContext.WorkbookUri?(this.$.ea.workbookContext.WorkbookUri=uc.a.a_(this.$.ea.workbookContext.WorkbookUri,
Za.AFrameworkApplication.BL,Za.AFrameworkApplication.accessToken),this.$.ea.workbookContext.WorkbookUri=uc.a.a_(this.$.ea.workbookContext.WorkbookUri,Za.AFrameworkApplication.rT,Za.AFrameworkApplication.accessTokenTtl.toString()),this.$.ea.EOc()):wa.ULS.sendTraceTag(537170704,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");this.$.ua.AccessToken=Za.AFrameworkApplication.accessToken;this.$.ua.AccessTokenValidTo=Za.AFrameworkApplication.accessTokenTtl;void 0!==
this.$.ua.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.ua.DocumentHostInfo.QuerySignatureWithoutVersion&&(this.$.ua.DocumentHostInfo.QuerySignatureWithoutVersion=uc.a.a_(this.$.ua.DocumentHostInfo.QuerySignatureWithoutVersion,Za.AFrameworkApplication.BL,Za.AFrameworkApplication.accessToken),this.$.ua.DocumentHostInfo.QuerySignatureWithoutVersion=uc.a.a_(this.$.ua.DocumentHostInfo.QuerySignatureWithoutVersion,Za.AFrameworkApplication.rT,Za.AFrameworkApplication.accessTokenTtl.toString()));
void 0!==this.$.ua.EmbedConfiguratorUrl&&null!==this.$.ua.EmbedConfiguratorUrl&&(this.$.ua.EmbedConfiguratorUrl=uc.a.a_(this.$.ua.EmbedConfiguratorUrl,Za.AFrameworkApplication.BL,Za.AFrameworkApplication.accessToken),this.$.ua.EmbedConfiguratorUrl=uc.a.a_(this.$.ua.EmbedConfiguratorUrl,Za.AFrameworkApplication.rT,Za.AFrameworkApplication.accessTokenTtl.toString()));this.context.q2b=!0}}Object(ka.a)(Td,"EwaAccessTokenExpirationRefreshManager",null,[233,234,2]);Object(Wc.b)(Qc.a,{yk:"singleton"})(G=>
No(function*(){const da=yield Wc.a.resolve(Qc.Lb,G);if(Za.AFrameworkApplication.fa.la("RefreshAccessTokenSilently")){const $a=new sb(Za.AFrameworkApplication.pp,Za.AFrameworkApplication.BI(),new nc);return new Td(da,$a)}return new He(da)}));class He extends mb{constructor(G){super();this.Og=new pa.a;this.MGd=this.Hvc=this.bE=this.MEb=!1;this.$=G}$Eg(){}Ymd(G){this.Og.addHandler("SessionExpired",G)}vta(G){this.Og.addHandler("TokenRefreshed",G)}ntb(G){this.Og.removeHandler("TokenRefreshed",G)}get accessTokenExpiringMessage(){const G=
(new Date(this.accessTokenTtl)).format(this.$.ua.ShortTimeFormat);return String.format(ha.a.instance.$g(78),G)}get yue(){return this.MEb}get zvb(){return!1}get b6(){return!1}get Ssb(){return!1}get N0(){return!1}FBc(){return db.a.instance.AM(Za.AFrameworkApplication.accessTokenTtl)}dispose(){Ia.a.Ng(this.Og);this.$=null}tNk(){this.$.isEditMode&&this.aBc(!1)}sNk(){this.MEb=!0;this.aBc(!0);this.Og.raiseEvent("SessionExpired")}aBc(G){wa.ULS.sendTraceTag(537170715,0,15,`EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired ${G}, GotDeploymentOrTimedOutError ${this.$.ea.O$}`);
const da=this.$.ih.Wv;G&&da&&da.isVisible&&1299163859===da.error.MessageId&&this.$.ih.Wv.TJ();const $a=this.Yi(G);ua.a(this.$).Dy(new fb.a(Ka.a.bD,5,()=>{const Sb=Yb.a(this.$),Mc=Sb.ij.activityState;Mc[La.a.Jda]=this.$.cIb(this.$.isEditMode);Mc[La.a.MW]=La.a.Fpb;Mc[ib.a.Aw]=Ka.a.accessTokenExpiringWarning;Sb.ij.Sy([$a])}))}Yi(G){return xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8691397_RecategorizeAccessTokenExpiredSilentRefreshDisabled")?this.U5h():G?lb.a.sxd():this.T5h()}T5h(){const G=lb.a.Yi(12,
1,0,0,0,1299163859,"AccessTokenExpiringWarning");G.Description=this.accessTokenExpiringMessage;return G}U5h(){const G=lb.a.Yi(12,1,0,0,0,-727342302,"AccessTokenExpiredSilentRefreshDisabled");G.Description=this.accessTokenExpiringMessage;return G}}Object(ka.a)(He,"EwaAccessTokenExpirationManager",mb,[233,234,2]);var oc=a(179),ld=a(103),id=a(125),fc=a(24),vc=a(7),Tc=a(86),Bd=a(69),Fd=a(25),le=a(355),dc=a(122);let Uc=class{constructor(G,da){this.Ppd=this.D6e=this.Qpd=0;this.C6e=!1;this.proactiveSuggestionCard=
null;this.Kfb=this.Gef=!1;this.sessionCount=this.autoAdjustColumnWidthSettings=0;this.IL=!1;this.Oi=($a,Sb)=>{wa.ULS.sendTraceTag(508363741,0,50,"AutoAdjustColumnsManagerService::onSessionIdChanged detected.");Sb.Ph?this.initialize():wa.ULS.sendTraceTag(508360707,0,15,"AutoAdjustColumnsManagerService::onSessionIdChanged but session is still not active.");this.$.ea.pq(this.Oi)};this.p3a=$a=>{if(lb.a.Jk($a.Errors)){const Sb=$a.Errors[0].MessageId;xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8157898_AutoAdjustColumnCheckIsSessionActive")&&
-315732528===Sb||wa.ULS.sendTraceTag(508641556,0,10,`AutoAdjustColumnWidth.onReadRoamingStringSuccess encountered an error. Errors: ${lb.a.Kh($a.Errors)}.`)}else $a.Result&&(this.autoAdjustColumnWidthSettings=parseInt($a.Result,10),this.Kfb=0!==(this.autoAdjustColumnWidthSettings&3),this.sessionCount=(this.autoAdjustColumnWidthSettings&65280)>>8),this.IL=2!==(this.autoAdjustColumnWidthSettings&2),this.C6e||0!==(this.autoAdjustColumnWidthSettings&2)||(0===this.sessionCount&&(this.Kfb=!1),this.$7i())};
this.Hqb=$a=>{$a=dc.a.Qj($a.data);wa.ULS.sendTraceTag(508641555,0,10,`AutoAdjustColumnWidth.onReadWriteRoamingStringFailure: Encountered errors while reading/writing roaming setting. Errors: ${lb.a.Kh($a)}.`)};this.z3a=$a=>{lb.a.Jk($a.Errors)?wa.ULS.sendTraceTag(508641554,0,10,`AutoAdjustColumnWidth.onWriteRoamingStringSuccess: encountered an error. Errors: ${lb.a.Kh($a.Errors)}`):$a.Result||wa.ULS.sendTraceTag(508641553,0,10,"AutoAdjustColumnWidth.onWriteRoamingStringSuccess failed to write to roaming service.")};
this.gVj=$a=>{if(lb.a.Jk($a.Errors))wa.ULS.sendTraceTag(508641552,0,10,`AutoAdjustColumnWidth.onReadRoamingStringSuccess encountered an error. Errors: ${lb.a.Kh($a.Errors)}.`);else{var Sb=0;$a.Result&&(Sb=parseInt($a.Result,10));Sb=Sb&-4|this.autoAdjustColumnWidthSettings&3;this.i3c(Sb)}};this.rfg=()=>{ld.a("AutoAdjustColumnWidthKeepOn");0===(this.autoAdjustColumnWidthSettings&1)&&(this.autoAdjustColumnWidthSettings|=1,this.Fxg());this.Kfb=!0;this.proactiveSuggestionCard.hide()};this.rMj=()=>{this.JXh();
this.proactiveSuggestionCard.hide()};this.h_j=()=>{ld.a("AutoAdjustColumnWidthHelp");const $a=new Tc.a(-859308420,Bd.a.eh,this.$.Rh,9,null);this.$.Ma.dh($a,{[Bd.a.Wk]:"HelpID=151880",["InputMethod"]:Bd.a.eh,["ShouldCanvasTakeFocus"]:!0,[Bd.a.Ai]:vc.a.CI,[vc.a.Fia]:!0})};this.yRj=()=>{const $a={};$a[vc.a.zO]="AutoAdjustColumnWidth";this.$.ei(802602464,Bd.a.eh,8,$a)};this.vYj=()=>{ld.a("AutoAdjustColumnWidthTurnedOff");this.autoAdjustColumnWidthSettings|=2;this.Fxg();this.Kfb=!0;this.proactiveSuggestionCard.hide();
this.IL=!1};this.$=G;this.proactiveSuggestionCard=da;this.D6e=xb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.AutoAdjustColumnConfirmThreshold",3);this.Ppd=xb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.AutoAdjustColumnConfirmSessionCycle",3);this.C6e=0===this.Ppd;!xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8157898_AutoAdjustColumnCheckIsSessionActive")||this.$.ea.Ph?this.initialize():this.$.ea.uq(this.Oi)}dispose(){this.proactiveSuggestionCard&&this.proactiveSuggestionCard.dispose();
this.$=null}initialize(){wa.ULS.shipAssertTag(508641557,0,Fd.a.vna(),"AutoAdjustColumnWidth feature is off");le.C(this.$.pa.ta,5,this.p3a,this.Hqb,null,null)}i3c(G){le.J(this.$.pa.ta,5,G.toString(),this.z3a,this.Hqb,null,null)}$7i(){if(2!==(this.autoAdjustColumnWidthSettings&2)){var G=this.sessionCount+1;G>=this.Ppd&&(G=0);this.i3c(this.autoAdjustColumnWidthSettings&-65281|G<<8)}}Fxg(){le.C(this.$.pa.ta,5,this.gVj,this.Hqb,null,null)}Qdg(G){if(0===this.Qpd){const da=[];da.push(id.a.Rl("Command",G,
2));ld.a("AutoAdjustedColumnWidth",void 0,void 0,da)}++this.Qpd;wa.ULS.shipAssertTag(508641551,0,0===(this.autoAdjustColumnWidthSettings&2),"AutoAdjustedColumns when AutoAdjustColumnWidthSettings is Off");!this.Kfb&&this.Qpd>=this.D6e&&this.IXh()}IXh(){if(null!=this.proactiveSuggestionCard){ld.a("AutoAdjustColumnWidthDialog");var G=ha.a.instance.Ba(858),da=ha.a.instance.Ba(859),$a=ha.a.instance.Ba(860),Sb=ha.a.instance.Ba(861),Mc=ha.a.instance.Ba(863);this.proactiveSuggestionCard.show(fc.f(this.$).ha.qa.Ui,
G,da,$a,Sb,this.rfg,this.rMj,this.uzc(),void 0,void 0,"WrapText",void 0,void 0,void 0,void 0,!1,!1,Mc,this.yRj);this.Gef?this.Kfb=!0:this.Gef=!0}}uzc(){return[{key:"learnMessage",text:ha.a.instance.Ba(862),onClick:this.h_j}]}JXh(){const G=ha.a.instance.Ba(864),da=ha.a.instance.Ba(865),$a=ha.a.instance.Ba(866),Sb=ha.a.instance.Ba(861);this.proactiveSuggestionCard.show(fc.f(this.$).ha.qa.Ui,G,da,$a,Sb,this.rfg,this.vYj,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,!1,!1,void 0,void 0)}};Uc=
Object(oc.__decorate)([Object(Wc.d)(Qc.q),Object(oc.__param)(0,Object(Qc.Lb)()),Object(oc.__param)(1,Object(Qc.Oe)())],Uc);Object(ka.a)(Uc,"AutoAdjustColumnsManager",null,[2,642]);var kb=a(31),rb=a(80),cc=a(430),mc=a(419),Sa=a(212),pb=a(252),Ac=a(262);class yd{constructor(G){this.$=G}get XVf(){return this.$.workbookContext.FileCoauthorable}get JUb(){return!1}get bPb(){return this.$.ea.e_}get pnf(){if(this.bPb)return!0;for(const G of this.$.ea.yt)if(!G.SupportsRename)return!1;return!0}}Object(ka.a)(yd,
"EwaCoauthManager",null,[606]);var vb=a(28),Sc;let hd=Sc=class extends rb.a{constructor(G,da){super();this.tpa=this.Sge=this.JCg=this.Nyd=null;this.Owa=()=>{var $a=this.$.ea.Cq;if($a&&$a.WorkbookFileName){var Sb=kb.a.kz($a.WorkbookFileName),Mc=!!Lb.a.compare(this.$.workbookContext.WorkbookFileName,$a.WorkbookFileName,!1),sd=xb.EwaSettings.Ra(465)&&!!$a.BreadcrumbFolderUrl&&!!Lb.a.compare(this.$.workbookContext.FullDocumentInfo.BreadcrumbFolderUrl,$a.BreadcrumbFolderUrl,!1);if(Mc||sd)this.tpa={},this.tpa.NewFileName=
Sb,this.tpa.EditDocInClientUrl=$a.EditDocInClientUrl,this.tpa.DirectInvokeDAVUrl=$a.DirectInvokeDAVUrl,this.tpa.DownloadACopyUrl=$a.DownloadACopyUrl,xb.EwaSettings.Ra(465)&&$a.BreadcrumbFolderUrl&&(this.tpa.BreadcrumbFolderName=$a.BreadcrumbFolderName,this.tpa.BreadcrumbFolderUrl=$a.BreadcrumbFolderUrl),$a=Za.AFrameworkApplication.jh.Xj(vb.a.awc,2,Sb),this.tpa=null,wa.ULS.shipAssertTag(537154064,0,32===$a,"RenameFileManager.HandleWorkbookMetadataChanged - Workbook Name Update Failed")}};this.rOj=
($a,Sb,Mc)=>{this.JCg=Sb;this.Sge=Mc;this.$.Ma.dh(new Tc.a(1897077126,Bd.a.eh,2,3,null),{["newFileName"]:$a})};this.qOj=$a=>{this.tpa&&$a(this.VHf(this.tpa),this.fw)};this.G_b=$a=>{pb.a($a)||!$a.Result?($a=Sc.KAi($a),Yb.a(this.$).ij.CL([-414480287,650565124,-782844485,1223808266,-62451516,1636785843]),this.Sge($a)):this.JCg(this.VHf($a.Result),this.fw)};this.vVj=()=>{this.Sge(5)};this.$=G;this.fw=da;this.$.ea.Xy(this.Owa)}initialize(){Za.AFrameworkApplication.uvc=this.rOj;Za.AFrameworkApplication.JXa=
this.qOj;this.Nyd=Za.AFrameworkApplication.pI;Za.AFrameworkApplication.pI=new yd(this.$)}dispose(){Za.AFrameworkApplication.uvc=null;Za.AFrameworkApplication.JXa=null;this.$.ea.pA(this.Owa);Za.AFrameworkApplication.pI=this.Nyd;this.$=this.Nyd=null;super.dispose()}renameFile(G,da){const $a=G.newFileName;if($a&&(G=kb.a.kz(this.$.workbookContext.WorkbookFileName),Lb.a.compare(G,$a,!1))){const Sb=this.$.pa.ta.Jh();mc.a(this.$.userOperationManager,(Mc,sd,Od)=>{var se=this.$.pa.ta;Mc=Ac.c(Mc,this.G_b);
sd=Ac.b(sd,this.vVj);const Ye=se.Za(9,Sb);Ye.newFileName=$a;return ec.h(se,"RenameFile",Ye,Mc,sd,Od,null,0)},Mc=>new Sa.a(134,0,Mc),da)}}TSd(){return 32===Za.AFrameworkApplication.jh.Gk(vb.a.vla,1)}VHf(G){var da=this.$.workbookContext;Za.AFrameworkApplication.afa=G.DownloadACopyUrl;const $a=xb.EwaSettings.Ra(465)&&!!G.BreadcrumbFolderUrl;$a&&(Za.AFrameworkApplication.Qt.breadcrumbFolderName=G.BreadcrumbFolderName,Za.AFrameworkApplication.Qt.breadcrumbFolderUrl=G.BreadcrumbFolderUrl,da.FullDocumentInfo.BreadcrumbFolderUrl=
G.BreadcrumbFolderUrl,da.FullDocumentInfo.BreadcrumbFolderName=G.BreadcrumbFolderName);da.FullDocumentInfo.BreadcrumbDocName=G.NewFileName;cc.d(da,G.NewFileName);da={};da.NewName=G.NewFileName;da.DirectInvokeDavUrl=G.DirectInvokeDAVUrl;da.EditDocInClientUrl=G.EditDocInClientUrl;$a&&(da.BreadcrumbFolderName=G.BreadcrumbFolderName,da.BreadcrumbFolderUrl=G.BreadcrumbFolderUrl);da.OperationResult=0;return da}static KAi(G){switch(G.Errors[0].MessageId){case -414480287:G=2;break;case 650565124:G=1;break;
case 1636785843:G=6;break;case -782844485:G=4;break;default:G=5}return G}};hd=Sc=Object(oc.__decorate)([Object(Wc.d)(Qc.df),Object(oc.__param)(0,Object(Qc.Lb)()),Object(oc.__param)(1,Object(Qc.id)())],hd);Object(ka.a)(hd,"RenameFileManager",rb.a,[584,2]);var qc=a(206),Lc=a(77),bd=a(83),jd=a(152),Yd;let te=Yd=class{constructor(G,da,$a){this.da=G;this.j8=da;this.iN=$a;this.gra=new AbortController;this.qCc=xb.EwaSettings.qCc();this.A2c=xb.EwaSettings.A2c();this.yIg=()=>{window.requestIdleCallback?window.requestIdleCallback(()=>
this.prefetch()):xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8740155_PrefetchPolyfillRequestIdleCallback")&&jd.e(()=>{this.prefetch()},this.da.$.xa,Yd.Lae)};this.oIk()&&(this.j8.i_e(this.yIg,this.gra.signal,!1),this.yIg())}prefetch(){const G=this.da.$.na;if(this.Lmj(G)){const da=this.rDi();da.length>Yd.wcg&&(wa.ULS.sendTraceTag(507545357,0,50,`BlockPrefetcher.prefetch Trying to prefetch more than the limit. blocksToPrefetch.length: ${da.length}`),da.splice(Yd.wcg));let $a=0;for(let Sb=0;Sb<da.length;Sb++)this.Snk(da[Sb],
G)&&($a++,this.iN.znk());this.zyj($a)}}Snk(G,da){const $a=this.da.za,Sb=$a.an(da,G);let Mc=!1;$a.zn(Sb)||(Mc=$a.bEg(G,da,"PrefetchCachedBufferedBlock"));wa.ULS.sendTraceTag(507569688,0,50,`BlockPrefetcher.requestBlockCacheItem getRange request for block: hashCode ${Sb} is pending? ${Mc}. isBeyondUsedRange? ${this.da.dEc(G).result}`);return Mc}Lmj(G){const da=this.da.$.ea;(G=da.Ph&&G&&Lc.i(G)&&!da.isNamedObjectViewMode)||wa.ULS.sendTraceTag(507569687,0,50,"BlockPrefetcher.isPrefetchingBlocksPossible prefetching is not possible");
return G}rDi(){const G=bd.f(this.da.mj,this.da.su,this.da.sJa(),this.qCc,this.A2c);return qc.c(G,this.da.Pg,!1)}oIk(){return-1!==this.qCc&&-1!==this.A2c}zyj(G){wa.ULS.sendTraceTag(507569686,0,50,`BlockPrefetcher.logPrefetchEnded prefetchedBlocksCount is ${G}`)}};te.wcg=10;te.Lae=100;te=Yd=Object(oc.__decorate)([Object(Wc.d)(Qc.y),Object(oc.__param)(0,Object(Qc.dd)()),Object(oc.__param)(1,Object(Qc.Cg)()),Object(oc.__param)(2,Object(Qc.Dg)())],te);Object(ka.a)(te,"BlockPrefetcher",null,[]);var oe=
a(731),Kd=a(1370),Ee=a(1065),rc=a(196);class fd{}fd.editCell="Edited";fd.dependentCell="Dependents";Object(ka.a)(fd,"RecalcPriorityGroupType",null,[]);var Ed=a(1184),Rd=a(303);let Fe=class{constructor(){this.I5=xb.EwaSettings.AEc()}fGd(G,da){G=G.units;var $a=da.units;if(G.length!==$a.length)return wa.ULS.sendTraceTag(508367051,0,15,"CalcInterfaceAdapter.FormattedValueToNumberFormatInformation: can't convert to NumberFormatInformation: units and finalized units don't have the same length!"),null;da=
[];let Sb=-1;for(let Mc=0;Mc<G.length;Mc++)switch(G[Mc].kind){case Ed.a.blank:da.push(...Array($a[Mc].str.length).fill(" "));break;case Ed.a.string:da.push(G[Mc].str);break;case Ed.a.Fxf:da.push("");Sb=Mc;break;case Ed.a.general:da.push($a[Mc].str);break;default:wa.ULS.sendTraceTag(508367050,0,15,"CalcInterfaceAdapter.ProcessFormattedValue: unknown FormattedUnitKind!")}if(0>=Sb||""===$a[Sb].str)return null;$a={};$a.Start=da.slice(0,Sb).join("");$a.Separator=G[Sb].str;$a.End=da.slice(Sb+1,da.length).join("");
return $a}PEf(G){switch(G.alignment){case "Center":return 2;case "Left":return 1;case "Right":return 3;default:return wa.ULS.sendTraceTag(508367049,0,10,"CalcInterfaceAdapter.GetHorizontalAlignmentFromFormattedValue: unknown horizontal alignment!"),0}}aEf(G){if(G=G.color){if("String"===Object.getType(G).getName())return rc.a.tu(G);if("Number"===Object.getType(G).getName())return null}else return null;wa.ULS.sendTraceTag(508367048,0,10,"CalcInterfaceAdapter.GetFontColorFromFormattedValue: unknown color type!");
return null}Afj(G,da){G=excelOnlineCalc.calc.getCellValueKind(G.rangeDelta.data.value);switch(G){case "number":case "string":case "boolean":case "Blank":case "Error":return!0;case "Rich":return da.numberOfUnsupportedRichCellTypes++,!1;default:return wa.ULS.shipAssertTag(508367047,0,!1,`CalcInterfaceAdapter.IsCellValueTypeSupported: Unexpected unsupported type ${G}`),!1}}VBf(G){G=excelOnlineCalc.calc.getCellValueKind(G.rangeDelta.data.value);let da=0;switch(G){case "number":da=1;break;case "string":da=
2;break;case "boolean":da=3;break;case "Error":da=4;break;case "Blank":da=0;break;default:wa.ULS.shipAssertTag(508367046,0,!1,`CalcInterfaceAdapter.GetCellValueType: Unexpected unsupported type ${G}`)}return da}X0h(G){const da=G.value;switch(G.type){case 2:return void 0===da||null===da?"":da;case 1:return G=parseFloat(da),isNaN(G)?null:G;case 3:return G=parseFloat(da),isNaN(G)?null:1===G;case 4:return G=parseFloat(da),isNaN(G)?null:excelOnlineCalc.calc.errorValue(G);default:return excelOnlineCalc.calc.blankValue}}nPb(G){"kind"in
G&&wa.ULS.shipAssertTag(508367045,0,G.kind!==Ee.a.formula,"CalcInterfaceAdapter.GetCellValueTypeFromParsedEdit: given parsed edit must be a value edit!");G=excelOnlineCalc.numfmt.getValueEditOperKind(G);let da=0;switch(G){case 0:case 128:da=0;break;case 1:da=1;break;case 2:da=2;break;case 4:da=3;break;case 8:da=4;break;case 16:case 32:case 64:case 256:wa.ULS.sendTraceTag(508367044,0,15,`CalcInterfaceAdapter.OperKindToCellValueType: can't convert given OperKind ${G} to a CellValueType`);break;default:wa.ULS.shipAssertTag(508367043,
0,!1,`CalcInterfaceAdapter.OperKindToCellValueType: Unexpected oper kind ${G}`)}return da}NHf(G,da){const $a=this.Wzc(da);var Sb=!(void 0===da.rangeDelta.data.format||null===da.rangeDelta.data.format);wa.ULS.shipAssertTag(508367042,0,0===$a||!Sb,`CalcInterfaceAdapter.GetRecalcInferredFormat: Format inference expected for Edited cell only ${da.priorityGroup}`);G=Math.max(G.cell.Vn,0);Sb&&(Sb=excelOnlineCalc.calc.getCellFormatKind(da.rangeDelta.data.format.format),"number"===Sb?G=da.rangeDelta.data.format.format:
"string"===Sb?wa.ULS.sendTraceTag(508367041,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind string"):"Unavailable"===Sb?wa.ULS.sendTraceTag(508367040,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind unavailable"):wa.ULS.shipAssertTag(508367011,0,!1,"CalcInterfaceAdapter.GetRecalcInferredFormat: unknown format kind!"));return G}Wzc(G){if(G.priorityGroup===fd.editCell)return 0;if(G.priorityGroup===fd.dependentCell)return 1;wa.ULS.sendTraceTag(508367010,0,10,"CalcInterfaceAdapter.GetRecalcPriorityGroup: unknown priority group!");
return 2}XLi(G){G=this.Wzc(G);if(0===G)return 1;if(1===G)return 2;wa.ULS.sendTraceTag(508367009,0,10,"CalcInterfaceAdapter.GetInstantaneousUpdatedCellType: unknown updated cell type!");return 0}GEi(G){return G.rangeDelta.range.column+1}NEi(G){return G.rangeDelta.range.row+1}OHf(G){return this.I5?this.OMd(G.rangeDelta.data.value):G.rangeDelta.data.value.toString()}getCellValueKind(G){return excelOnlineCalc.calc.getCellValueKind(G.rangeDelta.data.value)}mPb(G,da){var $a,Sb;if(!this.I5)return null===
(Sb=null===($a=null===G||void 0===G?void 0:G.value)||void 0===$a?void 0:$a.value)||void 0===Sb?void 0:Sb.toString();G=excelOnlineCalc.calc.readOperToCellValue(da,G.value);return this.OMd(G)}OMd(G){if(!Object(Rd.c)(G)){if("string"===typeof G)return G;if("number"===typeof G)return String(G);if("boolean"===typeof G)return G?"1":"0";if("kind"in G){if("Error"===G.kind)return String(G.type);if("Blank"===G.kind)return}wa.ULS.shipAssertTag(507646812,0,!1,"CalcInterfaceAdapter.GetValue: unknown cell value type!")}}};
Fe=Object(oc.__decorate)([Object(Wc.d)(Qc.D),Object(oc.__param)(0,Object(Qc.Rb)())],Fe);Object(ka.a)(Fe,"CalcInterfaceAdapter",null,[641]);var Ae=a(10),We=a(94),ve=a(227),Ze=a(93);class Oe{}Oe.local="Local";Oe.yVk="Thread";Object(ka.a)(Oe,"RecalcServiceCreateMode",null,[]);var Nf=a(189);class Zf{constructor(G){this.KFe=null;this.init(G)}get pla(){return this.KFe}init(G){this.KFe=new ve.a;if(void 0!==G&&null!==G&&void 0!==G.HeadersList&&null!==G.HeadersList&&0<G.HeadersList.length)for(const da of G.HeadersList)this.pla.ga(da.Index,
da.Name)}}Object(ka.a)(Zf,"ColHeadersListData",null,[]);var Rb=a(117),Vb=a(163);class Cc{constructor(G,da){this.r9e=G;this.sheetName=da;this.f5b=!1}}Object(ka.a)(Cc,"CalcBlockInformation",null,[]);class rg{constructor(G,da,$a,Sb,Mc){this.type=G;this.fullName=da;this.range=$a;this.sheetId=Sb;this.attributes=Mc;this.gO=null}}Object(ka.a)(rg,"CalcNamedObject",null,[]);class yf{get ir(){return this.QUe}constructor(){this.QUe=[];this.rwe=[];this.Feb={}}tNg(G,da){this.QUe[G]=da}getSheetIndex(G){for(let da=
1;da<this.ir.length;da++)if(Lb.a.equals(this.ir[da].NAa.sheetName,G,!1))return da;return-1}}Object(ka.a)(yf,"GridCache",null,[]);var jg=a(842),If=a(641);class cf{constructor(G){this.NAa=G;this.gha=new jg.a(If.a.lm());this.xLc=!1}}Object(ka.a)(cf,"SheetInformation",null,[]);var Nb=a(1150),Bc;(function(G){G[G.initialization=0]="initialization";G[G.contentReady=1]="contentReady";G[G.cellEdit=2]="cellEdit"})(Bc||(Bc={}));Object(ka.b)("UpdateDataTrigger",Bc);class Ob{constructor(G){this.Mde=null;this.W_d=
this.Lde=this.v8d=!1;this.Abe=0;this.sbe=this.ube=this.vbe=this.tbe=-1;this.trueName="TRUE";this.falseName="FALSE";this.instantaneousSupportInformationManager=this.cx=null;this.cB=this.currentStateId=-1;this.KGa="";this.Ola=null;this.getNameLoc=(da,$a)=>this.jGc()?this.xl.ma(this.currentStateId).ir[0].gha.Vg($a)?(da=excelOnlineCalc.location.nameLoc(da,$a),excelOnlineCalc.util.success(da)):excelOnlineCalc.util.success(null):(da=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(da));
this.getContainingTable=da=>{if(!this.jGc())return da=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(da);const $a=da.range.col,Sb=da.range.row;var Mc=this.xl.ma(this.currentStateId).ir[0].gha,sd=null;for(const Od of Mc)if(Mc=Od.value,2===Mc.type&&Lb.a.equals(da.sheet.index.toString(),Mc.sheetId,!0)){const se=Mc.range;$a>=se.left-1&&$a<=se.right-1&&Sb<=se.bottom-1&&Sb>=se.top-1&&(sd=excelOnlineCalc.location.nameScope(this.documentLoc,Mc.sheetId),sd=excelOnlineCalc.location.nameLoc(sd,
Mc.fullName))}return sd?excelOnlineCalc.util.success(sd):excelOnlineCalc.util.success(null)};this.getStructRefColumn=(da,$a)=>{if(!this.jGc()){var Sb=excelOnlineCalc.util.unavailable([2]);return excelOnlineCalc.util.failure(Sb)}Sb=da.name;var Mc=this.xl.ma(this.currentStateId).ir[0].gha;if(Mc.Vg(Sb)){Mc=Mc.ma(Sb);const Od=Mc.range;if(2!==Mc.type)return excelOnlineCalc.util.failure(this.Xwd(5));const se=Mc.gO?Mc.gO.pla:null;if(!se)return excelOnlineCalc.util.success(null);for(var sd of se)if(Lb.a.equals(sd.value,
$a,!0))return da=excelOnlineCalc.location.documentLoc(da.scope.document.path,da.scope.document.name),da=excelOnlineCalc.location.sheetIndex(da,Mc.sheetId),sd=excelOnlineCalc.location.gridRange(Od.top-1,sd.key,Od.bottom-Od.top+1,1),sd=excelOnlineCalc.location.sheetGridRange(da,sd),Sb=excelOnlineCalc.location.structRefColumnLoc(Sb,sd,!!(Mc.attributes&16),!!(Mc.attributes&8)),excelOnlineCalc.util.success(Sb);return Od.right-Od.left+1!==se.count?(Sb=excelOnlineCalc.util.unavailable([17,da,$a]),excelOnlineCalc.util.failure(Sb)):
excelOnlineCalc.util.failure(this.Xwd(0))}return excelOnlineCalc.util.success(null)};this.getStructRefSpecialRef=(da,$a)=>{if(!this.jGc())return $a=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure($a);var Sb=this.xl.ma(this.currentStateId).ir[0].gha;if(Sb.Vg(da.name)){var Mc=Sb.ma(da.name);if(2!==Mc.type)return excelOnlineCalc.util.failure(this.Xwd(5));Sb=!!(Mc.attributes&16);const sd=!!(Mc.attributes&8),Od=Sb?1:0,se=sd?1:0;da=excelOnlineCalc.location.documentLoc(da.scope.document.path,
da.scope.document.name);da=excelOnlineCalc.location.sheetIndex(da,Mc.sheetId);Mc=Mc.range;let Ye={};if(1===$a)Ye=excelOnlineCalc.location.gridRange(Mc.top-Od-1,Mc.left-1,Mc.bottom+se-Mc.top+Od+1,Mc.right-Mc.left+1);else if(2===$a)Ye=excelOnlineCalc.location.gridRange(Mc.top-1,Mc.left-1,Mc.bottom-Mc.top+1,Mc.right-Mc.left+1);else if(3===$a)if(Sb)Ye=excelOnlineCalc.location.gridRange(Mc.top-2,Mc.left-1,1,Mc.right-Mc.left+1);else return excelOnlineCalc.util.success(null);else if(4===$a)if(sd)Ye=excelOnlineCalc.location.gridRange(Mc.bottom,
Mc.left-1,1,Mc.right-Mc.left+1);else return excelOnlineCalc.util.success(null);$a=excelOnlineCalc.location.sheetGridRange(da,Ye);return excelOnlineCalc.util.success($a)}return excelOnlineCalc.util.success(null)};this.getDocumentLoc=(da,$a)=>{if((Lb.a.equals(da,this.documentLoc.path,!0)||!da)&&Lb.a.equals($a,this.documentLoc.name,!0))return excelOnlineCalc.util.success(this.documentLoc);da=excelOnlineCalc.util.unavailable([0,excelOnlineCalc.location.documentLoc(da,$a)]);return excelOnlineCalc.util.failure(da)};
this.getSheetIndex=(da,$a)=>{if(!this.xl.Vg(this.currentStateId)||!this.xl.ma(this.currentStateId).ir)return $a=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure($a);da=this.xl.ma(this.currentStateId).ir;for(let Sb=1;Sb<da.length;Sb++)if(Lb.a.equals(da[Sb].NAa.sheetName,$a,!0))return excelOnlineCalc.util.success(da[Sb].NAa.sheetId);return excelOnlineCalc.util.success(null)};this.getSheetName=(da,$a)=>{if(!this.xl.Vg(this.currentStateId)||!this.xl.ma(this.currentStateId).ir)return $a=
excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure($a);da=this.xl.ma(this.currentStateId).ir;for(let Sb=1;Sb<da.length;Sb++)if(Lb.a.equals(da[Sb].NAa.sheetId,$a,!0))return excelOnlineCalc.util.success(da[Sb].NAa.sheetName);return excelOnlineCalc.util.success(null)};this.getUserDefinedFuncLoc=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetUserDefinedFuncLoc not implemented in main thread"]);this.getSheetRangeIndexes=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetSheetRangeIndexes not implemented in main thread"]);
this.zkg=()=>{this.setNumberFormats()};this.xj=()=>{wa.ULS.sendTraceTag(537170081,0,50,"CalcAsyncEngine.OnWorkbookOpened() called");this.xl=new ve.a;this.currentStateId=this.cB=-1;this.KGa="";this.ygb=null;this.Lde=!1;this.cx&&this.clearCache()};this.Xi=G;this.xl=new ve.a;this.ygb=null;this.documentLoc=excelOnlineCalc.location.documentLoc("",this.Xi.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.LBa()}dispose(){this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.MSc(this.zkg);
this.Xi&&this.Xi.Pr(this.xj);this.close()}t9b(G){if(!this.cx)return!1;if(!this.instantaneousSupportInformationManager&&(this.instantaneousSupportInformationManager=Wc.a.Zg(Qc.wd),!this.instantaneousSupportInformationManager))return wa.ULS.sendTraceTag(537170198,0,50,"CalcAsyncEngine.UpdateData Failed to get instantaneousSupportInformationManager"),!1;2!==G&&(this.currentStateId=this.Xi.ea.pD,this.currentStateId===Ae.a.kk&&(this.currentStateId=this.Xi.ea.gk));if(1===G&&this.currentStateId<this.cB)return wa.ULS.sendTraceTag(537170197,
0,50,`CalcAsyncEngine::UpdateData() currentStateId:${this.currentStateId} < lastUpdatedStateId:${this.cB} - ignoring update`),!1;this.mzk();0!==G&&this.Lde||(this.fEk(),this.ZAk(),this.PBk(),this.setNumberFormats(),this.instantaneousSupportInformationManager.Smd(this.zkg),this.Xi.nr(this.xj),this.Lde=!0);this.hck();let da=!1;0===G&&(da=this.X$i());if(0!==G||da)this.nDk()?(this.SDk(G),this.RDk(),this.cB=this.currentStateId,this.gTh()):wa.ULS.sendTraceTag(537170196,0,15,`CalcAsyncEngine::UpdateData() for StateId:${this.currentStateId} failed - no Sheets information`);
2!==G&&this.resumeRecalc();return!0}evalFormula(G,da,$a,Sb){if(!this.cx)return wa.ULS.sendTraceTag(537170195,0,15,"CalcAsyncEngine.EvalFormula: recalc engine is null"),Promise.resolve({});da=excelOnlineCalc.calc.sheetCellLocation(null!==$a&&void 0!==$a?$a:Lc.d(this.Xi.sa.na),da.top-1,da.left-1);G=this.cx.evalFormula(this.Xi.ea.gk,G,da,Sb);this.resumeRecalc();return G}tOh(G,da,$a,Sb){Sb=void 0===Sb?null:Sb;const Mc=Lc.d(this.Xi.sa.na);let sd=G.cell.gH-1,Od=G.cell.oK-1;var se=sd,Ye=Od;let hf=null;Sb&&
(hf=excelOnlineCalc.calc.cellLocation(sd,Od),sd=Sb.top-1,Od=Sb.left-1,se=Sb.bottom-1,Ye=Sb.right-1);$a=this.jye(G,$a,"SetCell");0>$a||(Ye=Ob.Mea("CalculateFormula.cell",Mc,sd,Od,se,Ye),se=[],Sb=this.CAc(Mc),da=excelOnlineCalc.calc.inferredRangeFormulaEdit(Ye,da,hf,Sb),se.push(da),G=(da=this.UMd())?String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",Mc,sd,Od,Lb.a.l3e(G.cell.text),$a,da.top-1,da.left-1,da.bottom-1,da.right-
1):String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",Mc,sd,Od,Lb.a.l3e(G.cell.text),$a,"","","",""),wa.ULS.sendTraceTag(537170180,0,50,G),this.cx.editRangeFormulas($a,se),this.resumeRecalc())}uOh(G,da){const $a=[];var Sb=Lc.d(this.Xi.sa.na),Mc=this.CAc(Sb);da=this.jye(G[0].Wea,da,"SetCellBatched");if(0>da)return!1;for(var sd of G){var Od=sd.Wea.cell,se=Od.gH-1;Od=Od.oK-1;se=Ob.Mea("CalculateFormulaBatched.cell",Sb,se,
Od,se,Od);se=excelOnlineCalc.calc.inferredRangeFormulaEdit(se,sd.editText,null,Mc);$a.push(se)}Mc=this.UMd();sd=G[0].Wea.cell.gH-1;se=G[0].Wea.cell.oK-1;Od=G[G.length-1].Wea.cell.gH-1;G=G[G.length-1].Wea.cell.oK-1;Sb=Mc?String.format("CalcAsyncEngine::CalculateFormulaBatched() for sheet:{0} range:({1},{2},{3},{4}) stateId:{5} viewport:(({6},{7})-({8},{9}))",Sb,sd,se,Od,G,da,Mc.top-1,Mc.left-1,Mc.bottom-1,Mc.right-1):String.format("CalcAsyncEngine::CalculateFormulaBatched() for sheet:{0} range:({1},{2},{3},{4}) stateId:{5} viewport:(({6},{7})-({8},{9}))",
Sb,sd,se,Od,G,da,"","","","");wa.ULS.sendTraceTag(508932947,0,50,Sb);this.cx.editRangeFormulas(da,$a);this.resumeRecalc();return!0}J4(G,da,$a,Sb,Mc){if(!this.cx)return wa.ULS.sendTraceTag(537170179,0,15,"CalcAsyncEngine::EvalFormulaRangeOnClone recalc engine is null"),Promise.reject("RecalcService is null");if(!$a||!da)return wa.ULS.sendTraceTag(524120779,0,15,`CalcAsyncEngine::EvalFormulaRangeOnClone inputs are null. originCell null: ${!$a}, outputColumnRange null: ${!da}`),Promise.reject("CalcAsyncEngine::EvalFormulaRangeOnClone: null inputs");
wa.ULS.shipAssertTag(537170178,0,$a.isSingle,"CalcAsyncEngine::EvalFormulaRangeOnClone originCell must be a single cell.");const sd=Lc.d(this.Xi.sa.na),Od=this.CAc(sd);let se=null;if(G){se=[];for(const hf of G)if(hf.column!==$a.left){G=hf.row-1;var Ye=hf.column-1;G=Ob.Mea("EvalFormulaRangeOnClone.cell",sd,G,Ye,G,Ye);Ye=xb.EwaSettings.isChangeGateEnabled("OfficeVSO:7459428_TypedValueInCloneWrite")?zc(hf.Xn,hf.formulaBarText,hf.Vn):excelOnlineCalc.calc.valueCellData(hf.text,hf.text,hf.Vn,null);se.push(excelOnlineCalc.calc.rangeWrite(G,
Ye))}}$a=excelOnlineCalc.calc.cellLocation($a.top-1,$a.left-1);da=Ob.Mea("EvalFormulaRangeOnClone.outputColumnRange",sd,da.top-1,da.left-1,da.bottom-1,da.right-1);Mc?(Sb=[excelOnlineCalc.calc.inferredRangeFormulaEdit(da,Sb,$a,Od)],Mc=this.cx.evalOnClonedModel(se,Sb,Mc)):(Sb=[excelOnlineCalc.calc.cellFormulaRangeFormulaEdit(da,Sb,$a,Od)],Mc=this.cx.evalOnClonedModel(se,Sb,Mc));this.resumeRecalc();return Mc}localizeEnglishFormula(G,da,$a){da=excelOnlineCalc.calc.sheetCellLocation(Lc.d(da),$a.top-1,
$a.left-1);return this.cx.localizeEnglishFormula(G,da)}Xif(G){let da=null;try{if(G)if(this.KGa=fc.f(this.Xi).za.xIa(G),this.currentStateId=G.hPa,this.currentStateId<this.cB||this.currentStateId===Ae.a.kk)wa.ULS.sendTraceTag(537170176,0,50,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() hash:${this.KGa} blockRevision:${this.currentStateId} < lastUpdatedStateId:${this.cB}`);else{if(this.baj(),1===G.Kq.PaneType&&this.n7k(G.na),!this.fJh())if(da=this.Xi.qh.vi("ModelUpdate",`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() Block Hash:${this.KGa} StateId:${this.currentStateId}`),
this.ygb=this.m0(G.na.sheetName))if(fc.f(this.Xi).za.Bu.vMb(G.Ci)){var $a=G.el;if($a){var Sb=$a.getCalcBlockModel();if(Sb)if(this.YIh(Sb)){this.xl.ma(this.currentStateId).Feb[this.KGa]=new Cc(Sb,G.na.sheetName);var Mc=G.Fj;Mc?this.Yuh(Mc.NamedObjects):wa.ULS.sendTraceTag(537170144,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel GetGridBlockContentResponse is null")}else wa.ULS.sendTraceTag(509117971,0,50,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel block is invalid (might be freeze panes removal)");
else wa.ULS.sendTraceTag(537170145,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model for block")}else wa.ULS.sendTraceTag(537170146,0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model accessor for block:${this.KGa}`)}else wa.ULS.sendTraceTag(509117972,0,50,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel skipping block update because renderStateInfo doesn't have the block");else{const sd=!!(this.Xi.wj&32),Od=this.xl.Vg(this.currentStateId)&&this.xl.ma(this.currentStateId).ir?
this.xl.ma(this.currentStateId).ir.length:0;wa.ULS.sendTraceTag(537170147,0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel SheetName not found. Number of existing sheets ${Od}, scratchPad:${sd}, sheetNameLength:${G.na.sheetName?G.na.sheetName.length:-1} Hash:${G.na.hash}`)}}else wa.ULS.shipAssertTag(537170177,0,!1,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() blockCacheItem is null")}finally{da&&da.stop()}}lZa(G){var da;if(!this.xl.Vg(this.currentStateId))return wa.ULS.sendTraceTag(509646790,
0,15,`CalcAsyncEngine.getTableHeaders: stateId ${this.currentStateId} not found in gridCache`),null;const $a=null===(da=this.xl.ma(this.currentStateId))||void 0===da?void 0:da.ir;if(!$a||!$a[0])return null;da=$a[0].gha;if(!da||!da.Vg(G.name))return wa.ULS.sendTraceTag(509646789,0,15,`CalcAsyncEngine.getTableHeaders: table key found wasn't found in cached named objects list. cached named objects is null: ${null==da}`),null;G=da.ma(G.name);if(!G||!G.gO)return null;da=new Wb.a;for(const Sb of G.gO.pla)da.add(Sb.value);
return da}vOh(G,da,$a){var Sb=fc.f(this.Xi).kh(G[0].targetRange);da=this.jye(Sb,da,"CopyPaste");if(0>da)wa.ULS.sendTraceTag(508065925,0,15,`CalcAsyncEngine::CalculateFormulaForCopyPasteBatched(). Revision not valid. targetRevision:${da}.`);else{Sb=[];for(const Mc of G)G=this.WRi(da,$a,Mc.sourceRange,Mc.targetRange),Sb.push(G);this.cx.editRangePaste(da,Sb);this.resumeRecalc()}}WRi(G,da,$a,Sb){const Mc=Lc.d(this.Xi.sa.na);da=da?Lc.d(this.Xi.sa.getItemByName(da)):Mc;const sd=this.CAc(Mc);$a=Ob.Mea("getRangePasteEdit.srcRange",
da,$a.top-1,$a.left-1,$a.bottom-1,$a.right-1);Sb=Ob.Mea("getRangePasteEdit.targetRange",Mc,Sb.top-1,Sb.left-1,Sb.bottom-1,Sb.right-1);Sb=excelOnlineCalc.calc.copyPasteRangePasteEdit(Sb,$a,sd);G=sd?String.format("CalcAsyncEngine::getRangePasteEdit() from sheet:{0} to sheet:{1}, stateId:{2} viewport:(({3},{4})-({5},{6}))",da,Mc,G,sd.row,sd.column,sd.lastRow,sd.lastColumn):String.format("CalcAsyncEngine::getRangePasteEdit() from sheet:{0} to sheet:{1}, stateId:{2} viewport:(({3},{4})-({5},{6}))",Mc,
G,"","","","");wa.ULS.sendTraceTag(537170142,0,50,G);return Sb}CAc(G){const da=this.UMd();let $a=null;da?$a=Ob.Mea("GetViewport.viewport",G,da.top-1,da.left-1,da.bottom-1,da.right-1):wa.ULS.sendTraceTag(537170141,0,50,"CalcAsyncEngine::GetViewport() viewportRange is null, calc will use entire sheet...");return $a}UMd(){const G=fc.f(this.Xi);let da=G.Hp;if(fc.f(this.Xi).Pg.Uo){da=G.Zk(1).Hp;if(xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5497152_JSCrash_At_CalcAsyncEngine_GetViewportRange")&&!da)return wa.ULS.sendTraceTag(537170140,
0,15,"CalcAsyncEngine::GetViewportRange viewportRange is null."),null;da.eqa(1,1);da.eqa(3,1)}return da}jye(G,da,$a){let Sb;if(!this.cx||!G)return wa.ULS.sendTraceTag(537170139,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() recalc engine is null:${!this.cx}, modifiedCell is null:${!G}, operation:${$a}`),-1;const Mc=G.cell.gH-1,sd=G.cell.oK-1;if(G.cell.zF){if(Sb=G.cell.zF.Nmc,Sb===Ae.a.kk)return wa.ULS.sendTraceTag(537170138,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() BlockRevision unknown for block:${G.cell.zF.Ci}, operation:${$a}`),
-1}else return wa.ULS.sendTraceTag(537170137,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() GridBlockModelProxy is null cell:(${G.cell.gH},${G.cell.oK}), operation:${$a}`),-1;if(Sb<this.cB)return wa.ULS.sendTraceTag(537170136,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${Mc},${sd}) - blockRevision:${Sb} < lastUpdatedStateId:${this.cB}, operation:${$a}`),-1;if(Sb<this.currentStateId)return wa.ULS.sendTraceTag(537170135,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${Mc},${sd}) - blockRevision:${Sb} < currentStateId:${this.currentStateId}, operation:${$a}`),
-1;da&&!this.v8d&&(this.cx.setOnRecalcResults(da),this.v8d=!0);return this.o2k()&&!this.t9b(2)?(wa.ULS.sendTraceTag(537170134,0,15,`CalcAsyncEngine.ValidateCalculateFormulaInit: UpdateData failed. operation:${$a}`),-1):Sb}getFormulaBarText(G,da,$a){return da&&da.startsWith("'")?da:G.cell.formulaBarText||$a.toString()}g5h(G,da,$a){let Sb=null;this.ygb=this.m0($a);if(this.d$e()&&this.xl.ma(this.cB).Feb){const se=this.xl.ma(this.cB).Feb[G];if(null===se||void 0===se?0:se.f5b)Sb=se.r9e}$a=this.Tej(Sb,
da,$a);const {LIj:Mc,numberOfNonEmptyCells:sd,JIj:Od}=this.LWh(Sb,da,$a);wa.ULS.sendTraceTag(50671754,0,50,`CalcAsyncEngine::CreateRangeUpdateCommands() completed for Block Hash:${G} StateId:${this.currentStateId} number of formulas ${Mc}, number of non-empty cells ${sd}, number of cells ${Od}`)}Tej(G,da,$a){let Sb=!1;const Mc=Ob.DBf(da);if(G){const sd=Ob.DBf(G);Lb.a.equals(sd,Mc,!1)&&(Sb=!0)}Sb?this.Gvh(G,this.cB,$a):this.Ivh(da,$a);return Sb}d$e(){let G=!1;this.cx&&-1!==this.cB&&(G=this.cx.stateIdAvailable(this.cB));
return G&&this.xl.Vg(this.cB)&&this.cB<this.currentStateId}LWh(G,da,$a){let Sb=0,Mc=0,sd=0,Od,se;for(da.reset();Od=da.getNextCell();)sd++,(Od.value||Od.formula)&&Mc++,Vb.f(Od.formula)&&Sb++,(se=$a?G.getCell(Od.row,Od.col):null)?this.FWh(da,Od,se):this.Hvh(da,Od);if($a)for(G.reset();se=G.getNextCell();)(Od=da.getCell(se.row,se.col))||this.w_e(G,se);return{LIj:Sb,numberOfNonEmptyCells:Mc,JIj:sd}}PBk(){this.cx.setOnUpdateRequest(()=>{})}OBk(){this.cx.setOnUnresponsive((G,da,$a,Sb)=>{this.xYj(G,da,$a,
Sb)})}xYj(G,da,$a,Sb){wa.ULS.sendTraceTag(537170126,0,15,`CalcAsyncEngine.onUnresponsive: worker thread was unresponsive. timeout:${G}, waitTime:${da}, timeoutCount:${$a}, hasBeenClosed:${Sb}.`);Sb&&(this.gpk(),this.LBa())}gpk(){this.xj(null,null);this.W_d=this.v8d=!1;this.Abe=0;this.sbe=this.ube=this.vbe=this.tbe=-1}close(){this.cx.close()}clearCache(){this.cx.clearCache()}resumeRecalc(){this.cx.resumeRecalc()}ZAk(){this.cx.setA1ReferenceStyle(!0)}hck(){if(this.instantaneousSupportInformationManager){var G=
this.instantaneousSupportInformationManager.tcj;const $a=this.instantaneousSupportInformationManager.wcj,Sb=this.instantaneousSupportInformationManager.vcj,Mc=this.instantaneousSupportInformationManager.ucj;var da=!1;G!==this.tbe&&(da=!0,this.tbe=G);$a!==this.vbe&&(da=!0,this.vbe=$a);Sb!==this.ube&&(da=!0,this.ube=Sb);Mc!==this.sbe&&(da=!0,this.sbe=Mc);const sd=[];xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled",!1)&&(da=excelOnlineCalc.calc.runExperiment("ExceLintExperiment",
null),sd.push(da),da=!0);xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnitExperiment",!1)&&(da=excelOnlineCalc.calc.runExperiment("UnitExperiment",null),sd.push(da),da=!0);xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1)&&(da=excelOnlineCalc.calc.runExperiment("AutocompleteExperiment",null),sd.push(da),da=!0);da&&(G=excelOnlineCalc.calc.recalcServiceConfig(null,G,null,$a,null,null,null,Sb,sd,Mc),this.cx.reconfigure(G))}}SDk(G){let da=
null;if(this.xl.Vg(this.currentStateId))try{this.Ola=[],da=this.Xi.qh.vi("ModelUpdate",`CalcAsyncEngine::SetUpdatedRanges() StateId:${this.currentStateId} UpdateTriggerData:${Bc[G]}`),We.a.forEach(this.xl.ma(this.currentStateId).Feb,($a,Sb)=>{Sb.f5b||(this.g5h($a,Sb.r9e,Sb.sheetName),Sb.f5b=!0)},null),this.cx.updateRanges(this.currentStateId,this.Ola)}finally{da&&da.stop()}else wa.ULS.sendTraceTag(537170122,0,15,`CalcAsyncEngine::SetUpdatedRanges StateId:${this.currentStateId} does not exist in GridCache`)}RDk(){const G=
[],da=this.d$e();var $a=da&&this.xl.ma(this.cB).ir&&this.xl.ma(this.cB).ir[0]&&this.xl.ma(this.cB).ir[0].xLc?this.xl.ma(this.cB).ir[0].gha:null;this.cef($a,this.xl.ma(this.currentStateId).ir[0].gha,null,this.cB,G);this.xl.ma(this.currentStateId).ir[0].xLc=!0;for(let Sb=1;Sb<this.xl.ma(this.currentStateId).ir.length;Sb++)$a=-1,da&&this.xl.ma(this.cB).ir&&($a=this.XLd(this.xl.ma(this.currentStateId).ir[Sb].NAa.sheetName,this.cB)),$a=-1!==$a&&this.xl.ma(this.cB).ir[$a].xLc?this.xl.ma(this.cB).ir[$a].gha:
null,this.cef($a,this.xl.ma(this.currentStateId).ir[Sb].gha,this.xl.ma(this.currentStateId).ir[Sb].NAa.sheetId,this.cB,G),this.xl.ma(this.currentStateId).ir[Sb].xLc=!0;this.cx.updateNamedObjects(this.currentStateId,G)}cef(G,da,$a,Sb,Mc){if(void 0!==$a&&null!==$a){var sd=excelOnlineCalc.calc.undefinedNamesWrite($a);Mc.push(sd)}if(G){var Od=!1;sd=[];var se=[];if(da)for(const hf of da){const ag=hf.value;if(G.Vg(hf.key)){var Ye=G.ma(hf.key);Ob.VGj(Ye,ag)?Od=!0:(Ye=excelOnlineCalc.calc.namedObject(hf.key,
null),sd.push(Ye),Ob.Old(hf.key,ag,se))}else Ob.Old(hf.key,ag,se)}for(const hf of G)da&&da.Vg(hf.key)||(G=excelOnlineCalc.calc.namedObject(hf.key,null),sd.push(G));Od&&(da=excelOnlineCalc.calc.namedObjectsPromote($a,Sb),Mc.push(da));0<sd.length&&(da=excelOnlineCalc.calc.namedObjectsWrite($a,sd),Mc.push(da));0<se.length&&($a=excelOnlineCalc.calc.namedObjectsWrite($a,se),Mc.push($a))}else if(da){Sb=[];for(se of da)Ob.Old(se.key,se.value,Sb);0<Sb.length&&($a=excelOnlineCalc.calc.namedObjectsWrite($a,
Sb),Mc.push($a))}}fJh(){const G=this.xl.ma(this.currentStateId).Feb[this.KGa];return G?(wa.ULS.sendTraceTag(509117004,0,50,`CalcAsyncEngine::BlockPreviouslyHandled Block Hash:${this.KGa} StateId:${this.currentStateId} previously handled. LastUpdatedStateId: ${this.cB}. sentToRecalcEngine: ${null===G||void 0===G?void 0:G.f5b}`),!0):!1}YIh(G){return 1===G.getColumnNumbers().length&&G.getColumnNumbers()[0]===Ob.M2d+1?!1:!0}X$i(){let G=!1;fc.f(this.Xi).za.Iib(da=>{da.state&1&&this.Xi.ea.gk===da.jk.Revision&&
(this.Xif(da),G=!0)});return G}Hgf(G,da){var $a=G.getRowNumbers(),Sb=G.getColumnNumbers();G=$a[0]-1;$a=$a[$a.length-1]-1;const Mc=Sb[0]-1;Sb=Sb[Sb.length-1]-1;da=this.m0(da);if(!da){const sd=this.xl.Vg(this.currentStateId)&&this.xl.ma(this.currentStateId).ir?this.xl.ma(this.currentStateId).ir.length:0;wa.ULS.sendTraceTag(537170120,0,15,`CalcAsyncEngine::CreateBlockRangeLocation SheetName not found. Number of existing sheets ${sd}`)}return Ob.Mea("CreateBlockRangeLocation",da,G,Mc,$a,Sb)}Gvh(G,da,
$a){if($a=this.Hgf(G,$a)){var Sb=Ob.Mqc(G.getRowNumbers());G=Ob.Mqc(G.getColumnNumbers());da=excelOnlineCalc.calc.rangePromote($a,da,Sb,G);this.Ola[this.Ola.length]=da}}Ivh(G,da){if(da=this.Hgf(G,da)){var $a=Ob.Mqc(G.getRowNumbers());G=Ob.Mqc(G.getColumnNumbers());G=excelOnlineCalc.calc.rangeWrite(da,null,$a,G);this.Ola[this.Ola.length]=G}}FWh(G,da,$a){let Sb=null,Mc=0,sd=0;switch(da.valueType){case 2:Sb=this.PMd(da);var Od=this.PMd($a);Od=Lb.a.equals(Od,Sb,!1);break;case 1:null===da.value&&null===
$a.value?Od=!0:(Mc=parseFloat(da.value),Od=parseFloat($a.value)===Mc);break;default:null===da.value&&null===$a.value?Od=!0:(sd=parseFloat(da.value),Od=sd===parseFloat($a.value))}Od&&da.valueType===$a.valueType&&da.ifmt===$a.ifmt&&da.formulaType===$a.formulaType&&Lb.a.equals($a.formula,da.formula,!1)||(void 0!==da.formula&&null!==da.formula||void 0!==da.value&&null!==da.value||void 0!==da.text&&null!==da.text||0!==da.valueType?this.Zjc(G,da,Sb,Mc,sd):this.w_e(G,da))}Yuh(G){if(this.Xi.Gh&&this.Xi.Gh.items)for(let sd=
0;sd<this.Xi.Gh.count;sd++){var da=this.Xi.Gh.items[sd];if(2!==da.type&&3!==da.type)continue;var $a=0,Sb=da.name,Mc=Sb.lastIndexOf("!");if(0<Mc){$a=Sb.substr(0,Mc);"'"===$a.charAt(0)&&($a=$a.substr(1,$a.length-2));$a=this.XLd($a,this.currentStateId);if(-1===$a){Sb=this.xl.Vg(this.currentStateId)&&this.xl.ma(this.currentStateId).ir?this.xl.ma(this.currentStateId).ir.length:0;wa.ULS.sendTraceTag(595096334,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${Sb}`);
continue}Sb=Sb.substr(Mc+1)}Mc=this.xl.ma(this.currentStateId).ir[$a].gha;let Od=da.usedRange;2===da.type&&(Od=Nf.a(da));if(Mc.Vg(Sb)){if($a=Mc.ma(Sb),$a.range=Od,$a.attributes=da.attributes,2===$a.type)if(Sb=da.U7,!$a.gO)$a.gO=new Zf(Sb);else if(Sb)for(const se of Sb.HeadersList)$a.gO.pla.ga(se.Index,se.Name)}else if($a=this.m0(da.sheetName)){$a=new rg(da.type,da.name,Od,$a,da.attributes);if(2===$a.type)if(da.U7)$a.gO=new Zf(da.U7);else if(da=Ob.Fui(da.name,G))$a.gO=new Zf(da.ColHeadersList);Mc.ga(Sb,
$a)}else Sb=this.xl.Vg(this.currentStateId)&&this.xl.ma(this.currentStateId).ir?this.xl.ma(this.currentStateId).ir.length:0,wa.ULS.sendTraceTag(537170117,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${Sb}`)}}Zjc(G,da,$a,Sb,Mc){var sd=G.getRowNumbers()[da.row]-1;G=G.getColumnNumbers()[da.col]-1;sd=Ob.Mea("AddRangeUpdateCommand",this.ygb,sd,G,sd,G);G=null;let Od=da.formula||da.text;const se=excelOnlineCalc.calc.blankValue;let Ye=null;void 0!==da.text&&
null!==da.text||void 0!==da.value&&null!==da.value||($a="",Ye="This cell contains blanks only",0===da.formulaType&&(Od=""));switch(da.valueType){case 2:null!==$a&&(0===da.formulaType&&(G=excelOnlineCalc.calc.valueCellData(Od,$a,da.ifmt,Ye)),1===da.formulaType&&(G=excelOnlineCalc.calc.cellFormulaCellData(Od,$a,da.ifmt,Ye)),2===da.formulaType&&(G=excelOnlineCalc.calc.valueCellData("",se,0,"This cell is a part of an array")));break;case 1:isNaN(Sb)?wa.ULS.sendTraceTag(537170116,0,50,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${da.row},${da.col}) invalid numeric value`):
(0===da.formulaType&&(G=excelOnlineCalc.calc.valueCellData(Od,Sb,da.ifmt,null)),1===da.formulaType&&(G=excelOnlineCalc.calc.cellFormulaCellData(Od,Sb,da.ifmt,null)),2===da.formulaType&&(G=excelOnlineCalc.calc.valueCellData("",se,0,"This cell is a part of an array")));break;case 3:isNaN(Mc)?wa.ULS.sendTraceTag(537170115,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${da.row},${da.col}) invalid boolean value`):($a=1===Mc?!0:!1,0===da.formulaType&&(G=excelOnlineCalc.calc.valueCellData(Od,$a,da.ifmt,
null)),1===da.formulaType&&(G=excelOnlineCalc.calc.cellFormulaCellData(Od,$a,da.ifmt,null)),2===da.formulaType&&(G=excelOnlineCalc.calc.valueCellData("",se,0,"This cell is a part of an array")));break;case 4:isNaN(Mc)?wa.ULS.sendTraceTag(537170114,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${da.row},${da.col}) invalid error value`):($a=excelOnlineCalc.calc.errorValue(Mc),0===da.formulaType&&(G=excelOnlineCalc.calc.valueCellData(Od,$a,da.ifmt,null)),1===da.formulaType&&(G=excelOnlineCalc.calc.cellFormulaCellData(Od,
$a,da.ifmt,null)),2===da.formulaType&&(G=excelOnlineCalc.calc.valueCellData("",se,0,"This cell is a part of an array")));break;default:G=excelOnlineCalc.calc.valueCellData("",se,da.ifmt,null)}G&&(da=excelOnlineCalc.calc.rangeWrite(sd,G,null,null),this.Ola[this.Ola.length]=da)}Hvh(G,da){switch(da.valueType){case 2:this.Zjc(G,da,this.PMd(da),null,0);break;case 1:this.Zjc(G,da,null,parseFloat(da.value),0);break;default:this.Zjc(G,da,null,null,parseFloat(da.value))}}w_e(G,da){var $a=G.getRowNumbers()[da.row]-
1;G=G.getColumnNumbers()[da.col]-1;$a=Ob.Mea("AddRangeUpdateCommandEmptyCell",this.ygb,$a,G,$a,G);da=excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,da.ifmt,null);da=excelOnlineCalc.calc.rangeWrite($a,da,null,null);this.Ola[this.Ola.length]=da}m0(G){G=this.XLd(G,this.currentStateId);return 0<G?this.xl.ma(this.currentStateId).ir[G].NAa.sheetId:null}XLd(G,da){if(!this.xl.Vg(da))return wa.ULS.sendTraceTag(537170113,0,15,`CalcAsyncEngine.GetSheetInternalIndex StateId:${da} does not exist in GridCache`),
-1;const $a=this.xl.ma(da);return $a.ir?$a.getSheetIndex(G):(wa.ULS.sendTraceTag(537170112,0,15,`CalcAsyncEngine.GetSheetInternalIndex sheetsInformation == null for StateId:${da}`),-1)}nDk(){if(!this.xl.Vg(this.currentStateId)||!this.xl.ma(this.currentStateId).ir.length)return wa.ULS.sendTraceTag(537170083,0,15,`CalcAsyncEngine::SetSheetNamesAndUsedRanges() No sheets information for StateId:${this.currentStateId} or StateId does not exist in GridCache`),!1;const G=[];for(let da=1;da<this.xl.ma(this.currentStateId).ir.length;da++){const $a=
this.xl.ma(this.currentStateId).ir[da];$a&&G.push($a.NAa)}this.cx.updateSheetNames(this.currentStateId,G);this.cx.updateUnusedCells(this.currentStateId,this.xl.ma(this.currentStateId).rwe);return!0}setNumberFormats(){if(this.instantaneousSupportInformationManager){var G=[];for(const da of this.instantaneousSupportInformationManager.YLa){const $a=excelOnlineCalc.calc.numberFormat(da.IfmtIndex,da.FormatString,da.Builtin);G.push($a)}this.cx.setNumberFormats(G,!0)}}mzk(){if(this.instantaneousSupportInformationManager&&
this.instantaneousSupportInformationManager.hk){var G=this.$$i();if(!this.W_d||G)this.instantaneousSupportInformationManager.hk.TrueValueString&&(this.trueName=this.instantaneousSupportInformationManager.hk.TrueValueString),this.instantaneousSupportInformationManager.hk.FalseValueString&&(this.falseName=this.instantaneousSupportInformationManager.hk.FalseValueString),G=Nb.CalcHelper.Lhf(this.instantaneousSupportInformationManager,G),this.cx.setLocale(G),this.W_d=!0}}fEk(){var G=null;if(void 0!==this.Xi.workbookContext.TimeZoneInformation&&
null!==this.Xi.workbookContext.TimeZoneInformation){G=null;this.Xi.workbookContext.TimeZoneInformation.StandardDate.Month&&(G=excelOnlineCalc.date.dateTime(this.Xi.workbookContext.TimeZoneInformation.StandardDate.Year,this.Xi.workbookContext.TimeZoneInformation.StandardDate.Month,this.Xi.workbookContext.TimeZoneInformation.StandardDate.Day,this.Xi.workbookContext.TimeZoneInformation.StandardDate.Hour,this.Xi.workbookContext.TimeZoneInformation.StandardDate.Minute,this.Xi.workbookContext.TimeZoneInformation.StandardDate.Second,
this.Xi.workbookContext.TimeZoneInformation.StandardDate.DayOfWeek+1,this.Xi.workbookContext.TimeZoneInformation.StandardDate.Milliseconds,3));let da=null;this.Xi.workbookContext.TimeZoneInformation.DaylightDate.Month&&(da=excelOnlineCalc.date.dateTime(this.Xi.workbookContext.TimeZoneInformation.DaylightDate.Year,this.Xi.workbookContext.TimeZoneInformation.DaylightDate.Month,this.Xi.workbookContext.TimeZoneInformation.DaylightDate.Day,this.Xi.workbookContext.TimeZoneInformation.DaylightDate.Hour,
this.Xi.workbookContext.TimeZoneInformation.DaylightDate.Minute,this.Xi.workbookContext.TimeZoneInformation.DaylightDate.Second,this.Xi.workbookContext.TimeZoneInformation.DaylightDate.DayOfWeek+1,this.Xi.workbookContext.TimeZoneInformation.DaylightDate.Milliseconds,3));G=excelOnlineCalc.date.tzData(this.Xi.workbookContext.TimeZoneInformation.Bias,G,this.Xi.workbookContext.TimeZoneInformation.StandardBias,da,this.Xi.workbookContext.TimeZoneInformation.DaylightBias)}else wa.ULS.sendTraceTag(537170082,
0,15,"CalcAsyncEngine.SetWorkbookProperties: TimeZoneInformation is null");G=excelOnlineCalc.calc.workbookProps(this.Xi.workbookContext.F1904,this.Xi.workbookContext.FDateCompatibility,G);this.cx.setWorkbookProps(G)}LBa(){const G=xb.EwaSettings.Ra(570)?Oe.local:Oe.yVk,[da,$a]=[excelOnlineCalc.x10.PluginSchedulerSingleton.instance(),excelOnlineCalc.x10.GridImportManagerSingleton.instance()];this.Mde=Ze.d(excelOnlineCalc.calc.createRecalcService(G,da,$a));this.Mde.continueWith(Sb=>{Sb.exception?wa.ULS.sendTraceTag(537170075,
0,50,`CalcAsyncEngine.TryInitialize: Calc web worker failed: ${Sb.exception.toString()}`):(wa.ULS.sendTraceTag(537170078,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker is working as expected"),(this.cx=this.Mde.result)?this.t9b(0)?this.OBk():wa.ULS.sendTraceTag(537170077,0,15,"CalcAsyncEngine.TryInitialize: UpdateData failed to initialize"):wa.ULS.sendTraceTag(537170076,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker result is null"))})}$$i(){const G=this.instantaneousSupportInformationManager.$va;
if(!G||this.Abe===G.length)return null;this.Abe=G.length;return Nb.CalcHelper.qhf(G)}baj(){if(!(this.xl.Vg(this.currentStateId)&&0<this.xl.ma(this.currentStateId).ir.length)){this.xl.ga(this.currentStateId,new yf);this.xl.ma(this.currentStateId).tNg(0,new cf(null));var G=this.Xi.sa;for(let Sb=0;Sb<G.count;Sb++){var da=Object(Hc.a)(Rb.a,G.getItem(Sb));if(da){void 0!==da.sheetId&&null!==da.sheetId&&void 0!==da.name&&null!==da.name&&da.sheetId.length&&da.sheetName.length||wa.ULS.sendTraceTag(537170074,
0,15,`CalcAsyncEngine::InitializeGridForStateId() invalid sheet - index:${Sb} Id:${da.sheetId} Hash:${da.hash} NameLength:${da.name?da.name.length:-1}`);var $a=excelOnlineCalc.calc.sheetName(da.sheetId,da.name);this.xl.ma(this.currentStateId).tNg(Sb+1,new cf($a));$a=da.usedRange.IE();$a=excelOnlineCalc.calc.rangeLocation(0,0,$a.LastRow,$a.LastColumn);da=excelOnlineCalc.calc.unusedCellsUpdate(da.sheetId,$a);this.xl.ma(this.currentStateId).rwe.push(da)}else wa.ULS.sendTraceTag(537170073,0,15,`CalcAsyncEngine.InitializeGridForStateId(): not sheet item for StateId:${this.currentStateId} sheet-index:${Sb}`)}}}n7k(G){if(G instanceof
Rb.a){var da=G.usedRange.IE();da=excelOnlineCalc.calc.rangeLocation(0,0,da.LastRow,da.LastColumn);da=excelOnlineCalc.calc.unusedCellsUpdate(G.sheetId,da);this.xl.ma(this.currentStateId).rwe[G.index]=da}}gTh(){for(const G of this.xl)G.key<this.cB&&this.xl.remove(G.key)}PMd(G){G=G.value||G.text;if(void 0===G||null===G)G="";return G}o2k(){if(!this.xl.Vg(this.currentStateId))return!1;let G=!1;We.a.forEach(this.xl.ma(this.currentStateId).Feb,(da,$a)=>{$a.f5b||(G=!0)},null);return G}Xwd(G){const da={};
da.reason=G;da.kind=1;return da}jGc(){return this.xl.Vg(this.currentStateId)&&this.xl.ma(this.currentStateId).ir&&this.xl.ma(this.currentStateId).ir[0]&&this.xl.ma(this.currentStateId).ir[0].gha?!0:!1}static f1h(G){const da=[];if(null===G||void 0===G?0:G.pla)for(const $a of G.pla)G=excelOnlineCalc.calc.columnData($a.key,$a.value),da.push(G);return da}static VGj(G,da){if(G.type!==da.type||G.attributes!==da.attributes||!Lb.a.equals(G.fullName,da.fullName,!1)||!G.range.equals(da.range))return!1;if(!G.gO&&
!da.gO)return!0;if(!G.gO||!da.gO||G.gO.pla.count!==da.gO.pla.count)return!1;for(const $a of G.gO.pla){let Sb;if(G=$a.value)G=da.gO.pla.gj($a.key),{value:Sb}=G,G=G.returnValue;if(!(G&&Sb&&Lb.a.equals($a.value,Sb,!1)))return!1}return!0}static Old(G,da,$a){var Sb=Ob.Mea("NamedObject",da.sheetId,da.range.top-1,da.range.left-1,da.range.bottom-1,da.range.right-1);if(2===da.type){const Mc=!!(da.attributes&16),sd=!!(da.attributes&8);da=Ob.f1h(da.gO);Sb=excelOnlineCalc.calc.namedTableData(Sb,Mc,sd,da);G=excelOnlineCalc.calc.namedObject(G,
Sb)}else Sb=excelOnlineCalc.calc.namedRangeData(Sb),G=excelOnlineCalc.calc.namedObject(G,Sb);$a.push(G)}static DBf(G){const da=Sys.Serialization.JavaScriptSerializer.serialize(G.getRowNumbers());G=Sys.Serialization.JavaScriptSerializer.serialize(G.getColumnNumbers());return da+G}static Mqc(G){let da=null;if(1<G.length)for(let $a=1;$a<G.length;$a++){let Sb=0;for(;G[$a-1]+1+Sb<G[$a];)da=da||[],da.push(G[$a-1]+Sb),Sb++}return da}static Fui(G,da){if(!da)return null;for(let $a=0,Sb=da.length;$a<Sb;++$a)if(Lb.a.equals(G,
da[$a].Name,!1))return da[$a];return null}static Mea(G,da,$a,Sb,Mc,sd){const Od=(se,Ye,hf,ag)=>{(0>hf||hf>=ag)&&wa.ULS.sendTraceTag(537170072,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${se} invalid ${Ye}:${hf}`)};void 0!==da&&null!==da||wa.ULS.sendTraceTag(537170071,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${G} sheetId is null`);Od(G,"top",$a,Ob.Q9f);Od(G,"left",Sb,Ob.M2d);Od(G,"bottom",Mc,Ob.Q9f);Od(G,"right",sd,Ob.M2d);return excelOnlineCalc.calc.sheetRangeLocation(da,
$a,Sb,Mc,sd)}}Ob.Q9f=1048576;Ob.M2d=16384;Object(ka.a)(Ob,"CalcAsyncEngine",null,[2]);const zc=(G,da,$a)=>{switch(G.type){case 2:return excelOnlineCalc.calc.valueCellData(da,G.value,$a,null);case 1:return excelOnlineCalc.calc.valueCellData(da,parseFloat(G.value),$a,null);case 3:return excelOnlineCalc.calc.valueCellData(da,1===parseFloat(G.value),$a,null);case 4:return excelOnlineCalc.calc.valueCellData(da,excelOnlineCalc.calc.errorValue(parseFloat(G.value)),$a,null);default:return excelOnlineCalc.calc.valueCellData("",
excelOnlineCalc.calc.blankValue,$a,null)}};class od{constructor(){this.lxa=this.mxa=this.rna=this.sna=this.P0a=!1}}Object(ka.a)(od,"AbsoluteRelativeReferenceInfo",null,[]);var ce=a(26);class Qb{}Qb.Dsg="#";Object(ka.a)(Qb,"Operators",null,[]);var Xc=a(1185);class md{}md.sheet="Sheet";md.sheetRange="SheetRange";md.document="Document";md.a7i="Ident";Object(ka.a)(md,"TraverseFormulaQualifierTypes",null,[]);var ie=a(1066),me=a(981),Pe=a(45),gf=a(66),tf=a(78),Qe=a(322);class Ca extends Sys.EventArgs{constructor(G){super();
this.kq=G}}Object(ka.a)(Ca,"EditedCellRecalcCompleteEventArgs",Sys.EventArgs,[]);var yb=a(1377),wc;let dd=wc=class extends pa.a{constructor(G,da){super();this.$x=da;this.az=null;this.A$b=!1;this.Qie=this.instantaneousSupportInformationManager=this.slc=this.wza=null;this.u5d=new Map;this.$Pe=null;this.rNc=$a=>{wa.ULS.sendTraceTag(537170005,0,50,"CalcManager.OnLocaleInformationAvailable() called");$a.MSc(this.rNc);$a.$va.length?this.WMc($a,Sys.EventArgs.Empty):(wa.ULS.sendTraceTag(537170004,0,50,"CalcManager.OnLocaleInformationAvailable() - waiting for functions information"),
$a.K0e(this.WMc))};this.WMc=$a=>{wa.ULS.sendTraceTag(537170003,0,50,"CalcManager.OnFunctionsInfoReady called");$a.dge(this.WMc);this.S_k($a)};this.onContentReady=()=>{this.az&&(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.vDc||gf.Task.delay(0).continueWith(()=>{this.az.t9b(1)?this.raiseEvent(wc.Xtd):wa.ULS.sendTraceTag(508368722,0,15,"CalcManager.onContentReady: calc engine failed to update in the calc model")},0,null,tf.a.current))};this.eeg=($a,Sb)=>{this.az&&
(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.vDc||this.az.Xif(Sb.Ti.block))};wa.ULS.sendTraceTag(537170067,0,50,"Creating CalcManager");this.jEc=!1;this.fh=G;this.PD=fc.f(G);this.u6c=null;this.da.Mz(this.onContentReady);this.da.za.Ncb(this.eeg);this.DRf=new Promise(($a,Sb)=>{this.Dpk=$a;this.Yee=Sb});void Wc.a.hj(Qc.wd).then($a=>{$a.hk?(wa.ULS.sendTraceTag(537170066,0,50,"CalcManager.ctor: LocaleInformation already available..."),this.rNc($a,Sys.EventArgs.Empty)):
(wa.ULS.sendTraceTag(537170065,0,50,"CalcManager.ctor: waiting for LocaleInformation..."),$a.Smd(this.rNc))});this.OKa=xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8373394_setCellEstimationPrefetch");this.bTd=Qc.xf.Ha();this.OKa&&!this.bTd&&(this.vhc=new yb.SetCellEstimationPrefetcher(this,this.PD,da))}tmd(G){this.addHandler(wc.rof,G)}acg(G){this.raiseEvent(wc.rof,new Ca(G))}cxh(G){this.addHandler(wc.Ukd,G)}Thk(G){this.removeHandler(wc.Ukd,G)}NLc(G){this.raiseEvent(wc.Ukd,G)}nkc(G){this.addHandler(wc.Xtd,
G)}Sfe(G){this.removeHandler(wc.Xtd,G)}get wOa(){return this.vhc}get O3(){return this.u6c}get da(){return this.PD}get $(){return this.fh}get MM(){return this.$Pe}get localeInfo(){return this.O3?this.O3.config.localeInfo:null}get config(){var G;return null===(G=this.O3)||void 0===G?void 0:G.config}dispose(){wa.ULS.sendTraceTag(537170064,0,50,"CalcManager.Dispose called");void Wc.a.hj(Qc.wd).then(G=>{G.MSc(this.rNc);G.dge(this.WMc)});this.da&&(this.da.xE(this.onContentReady),this.da.za&&this.da.za.Y2b(this.eeg),
this.PD=null);this.u6c=null;this.jEc=!1;this.OKa&&(Ia.a.Ng(this.wOa),this.vhc=null)}wOh(G,da,$a,Sb){this.az&&this.az.tOh(G,da,$a,void 0===Sb?null:Sb)}xOh(G,da){return this.az?this.az.uOh(G,da):!1}evalFormula(G,da,$a,Sb){return this.az?this.az.evalFormula(G,da,$a,Sb):Promise.reject("calc engine not initialized")}J4(G,da,$a,Sb,Mc){return this.az?this.az.J4(G,da,$a,Sb,Mc):Promise.reject("CalcEngine is null")}localizeEnglishFormula(G,da,$a){return this.az?this.az.localizeEnglishFormula(G,da,$a):Promise.resolve(void 0)}lZa(G){if(!G)return wa.ULS.sendTraceTag(509649312,
0,100,"CalcManager.GetTableHeaders: table is null"),null;if(!this.az)return null;wa.ULS.shipAssertTag(537170059,0,2===G.type,"CalcManager.GetTableHeaders() - ActiveItem is not a table");return this.az.lZa(G)}C2e(G,da){if(!da||2!==G.type)return!1;G=Nf.a(G);return G.right-G.left+1===da.count}VDd(G,da){if(!this.wza)return this.A$b||wa.ULS.sendTraceTag(537170057,0,15,"CalcManager.ExtractReferenceWrappers - parser not initialized"),null;var $a=this.gqc(ce.Range.gi(1,1));$a=this.wza.parseFormula(excelOnlineCalc.parse.parseLocals(1,
$a.range),G);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess($a))return wa.ULS.sendTraceTag(537170056,0,10,"CalcManager.ExtractReferenceWrappers - ParseFormula failed"),null;try{const Sb=null!==da&&void 0!==da?da:this.da.ha.qa.activeCell,Mc=excelOnlineCalc.location.gridCell(Sb.top-1,Sb.left-1),sd=excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),Od=excelOnlineCalc.location.sheetIndex(sd,this.$.sa.na.sheetId),se=this.A5h(Mc,Od);this.Qie||(this.Qie=
excelOnlineCalc.util.createResolver(this.z5h()));const Ye=excelOnlineCalc.parse.parseResultHelper.extractReferences($a,this.O3.config.localeInfo,!1,se,this.Qie);xb.EwaSettings.Ra(101)&&this.b6k(Ye,G);return Ye}catch(Sb){return wa.ULS.sendTraceTag(537170055,0,10,`CalcManager.ExtractReferenceWrappers - exception: ${Sb.message}`),null}}aYd(G){if(!this.wza||!this.slc)return this.A$b||wa.ULS.sendTraceTag(507912481,0,15,this.wza||this.slc?this.wza?"CalcManager.isValidReference - analyzer not initialized":
"CalcManager.isValidReference - parser not initialized":"CalcManager.isValidReference - parser and analyzer not initialized"),null;var da=this.gqc(ce.Range.gi(1,1));G=this.wza.parseFormula(excelOnlineCalc.parse.parseLocals(1,da.range),G);if(!excelOnlineCalc.util.isSuccess(G))return G.reason.kind===excelOnlineCalc.parse.ReasonKind.NotFormulaString?"notFormulaString":"internalError";da=this.slc.checkFormula(excelOnlineCalc.analyze.analyzeLocalsName(da),G.value);return excelOnlineCalc.util.isSuccess(da)?
da.value.isWellFormed?"valid":"illFormed":"internalError"}extractLetVariables(G,da){if(!this.wza)return this.A$b||wa.ULS.sendTraceTag(537170054,0,15,"CalcManager.ExtractLetVariables - parser not initialized"),null;const $a=this.gqc(ce.Range.gi(1,1));G=this.wza.parseFormula(excelOnlineCalc.parse.parseLocals(1,$a.range),G);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(G))return wa.ULS.sendTraceTag(537170053,0,10,"CalcManager.ExtractLetVariables - ParseFormula failed"),null;try{return excelOnlineCalc.parse.parseResultHelper.extractLetVariables(G,
da,this.O3.config.localeInfo)}catch(Sb){return wa.ULS.sendTraceTag(537170052,0,10,`CalcManager.ExtractLetVariables - exception: ${Sb.message}`),null}}extractReferences(G,da,$a,Sb,Mc,sd){if(!da)return wa.ULS.sendTraceTag(537170051,0,10,"CalcManager.ExtractReferences - sheetName is null"),null;if(!$a)return wa.ULS.sendTraceTag(537170050,0,10,"CalcManager.ExtractReferences - documentName is null"),null;const Od=this.VDd(G,Mc);if(!Od)return wa.ULS.sendTraceTag(537170049,0,15,"CalcManager.ExtractReferences - ExtractReferenceWrappers returned null"),
null;try{return this.y4h(Od,da,$a,G,Sb,Mc,sd)}catch(se){return wa.ULS.sendTraceTag(537170048,0,10,`CalcManager.ExtractReferences - exception: ${se.message}`),null}}gqc(G,da){da=void 0===da?!0:da;return G&&this.O3?this.O3.X5h(this.O3.K7h(),G.top-1,G.left-1,da):null}uFc(G,da){G=this.Hma(G);if(!Object(Qe.c)(G))return null;da=this.MM.parseEdit(da,G.value);return excelOnlineCalc.util.isSuccess(da)?da.value.kind===Ee.a.formula:null}vXd(G){G=this.Hma(G);return Object(Qe.c)(G)?"Text"===G.value.valueType:
null}aVf(G){G=this.Hma(G);return Object(Qe.c)(G)?"Date"===G.value.valueType&&!G.value.hasTime:null}Hma(G){if(null==this.MM)return Object(Qe.a)("Number formatter is null");if(null==this.instantaneousSupportInformationManager)return Object(Qe.a)("Instantaneous manager is null");if(this.u5d.has(G))return Object(Qe.d)(this.u5d.get(G));if("number"===typeof G){var da=this.FGf(G);if(null==da)return Object(Qe.a)(`Invalid ifmt=${G}`);var $a=da.FormatString;da=da.Builtin}else $a=G,da=!1;$a=this.MM.createFormat($a,
da);return excelOnlineCalc.util.isSuccess($a)?(this.u5d.set(G,$a.value),Object(Qe.d)($a.value)):Object(Qe.a)("Could not create number format")}getWorksheetFuncId(G){return this.localeInfo.getWorksheetFuncId(G)}y4h(G,da,$a,Sb,Mc,sd,Od){const se={Items:[]};for(let ag=0;ag<G.length;ag++){var Ye=G[ag];const Jg={};Jg.Start=Ye.span.start;Jg.End=Ye.span.end;if(Mc||Ye.kind!==Xc.a.func)if(Mc||Ye.kind!==Xc.a.Uuj){if(xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8719736_calcFormulaExtractReferencesCrossSheet")&&
Od&&!Ye.ref.qualifier)continue;if(!this.Jdi(Ye,da,$a))continue;var hf=new od;const tg=this.URi(Ye,da,hf,Sb,sd);if(tg){const Xg={};Xg.Span=Jg;Xg.Range=tg;Xg.IsRangeRef=hf.P0a;Xg.IsAbsoluteFirstRow=hf.sna;Xg.IsAbsoluteFirstColumn=hf.rna;Xg.IsAbsoluteSecondRow=hf.mxa;Xg.IsAbsoluteSecondColumn=hf.lxa;Xg.IsStructRef=Ye.kind===Xc.a.zVg;se.Items.push(Xg)}}else Ye=Ye.ref.value.oper.kind,hf={},hf.Span=Jg,hf.IsString=2===Ye,hf.IsBoolean=4===Ye,hf.IsNumber=1===Ye,se.Items.push(hf);else Jg.End=Ye.span.start+
Ye.ref.name.length,Ye={},Ye.Span=Jg,Ye.IsFunction=!0,Ye.FunctionId=this.getWorksheetFuncId(Sb.substring(Jg.Start,Jg.End)),se.Items.push(Ye)}se.Items.sort((ag,Jg)=>ag.Span.Start-Jg.Span.Start);return se}URi(G,da,$a,Sb,Mc){if(G.kind===Xc.a.range)return $a.P0a=!0,this.xff(G,da,$a,Sb);if(G.kind===Xc.a.namedRange){$a=G.ref;(G=this.$.Gh.getItemByName($a.name))||(G=this.$.Gh.getItemByName(da+"!"+$a.name));if(!(G&&G.sheetName&&G.usedRange&&Lb.a.equals(G.sheetName,da,!0)))return null;da=2===G.type?Nf.a(G):
G.usedRange;return Pe.n(da,G)}if(G.kind===Xc.a.zVg){const sd=G.ref;sd.name?(Mc=this.$.Gh.getItemByName(sd.name))||(Mc=this.$.Gh.getItemByName(da+"!"+sd.name)):Mc=xb.EwaSettings.isChangeGateEnabled("OfficeVSO:7907929_RecognizeTableRangeFromOriginCell")&&Mc?this.da.Yg.sl(Mc):this.da.Yg.sl(this.da.ha.qa.activeCell);if(!(Mc&&Mc.sheetName&&Mc.usedRange&&Lb.a.equals(Mc.sheetName,da,!0)))return null;$a.P0a=!1;return this.xff(G,da,$a,Sb)}return null}xff(G,da,$a,Sb){G=G.ref;if(G.type){if(G.type===ie.a.column){var Mc=
G.startIndex;G=G.endIndex;$a.rna=Mc.kind===me.a.abs;$a.lxa=G.kind===me.a.abs;return this.createRange(0,Mc.index,Ae.a.gl,G.index,da)}if(G.type===ie.a.row)return Mc=G.endIndex,$a.sna=G.startIndex.kind===me.a.abs,$a.mxa=Mc.kind===me.a.abs,this.createRange(G.startIndex.index,0,G.endIndex.index,Ae.a.Qk,da);if(G.type===ie.a.cell){Mc=G.row;var sd=G.col;$a.sna=$a.mxa=Mc.kind===me.a.abs;$a.rna=$a.lxa=sd.kind===me.a.abs;return this.CVa(G.span.end,Sb)&&($a=ce.Range.gi(Mc.index+1,sd.index+1),$a=this.da.Yg.dJf($a))?
Pe.o($a,da):this.createRange(Mc.index,sd.index,Mc.index,sd.index,da)}if(G.type===ie.a.range){Mc=G.top;sd=G.left;Sb=G.bottom;G=G.right;const Od=Math.min(Mc.index,Sb.index),se=Math.min(sd.index,G.index),Ye=Math.max(Mc.index,Sb.index),hf=Math.max(sd.index,G.index);$a.sna=Mc.kind===me.a.abs;$a.mxa=Sb.kind===me.a.abs;$a.rna=sd.kind===me.a.abs;$a.lxa=G.kind===me.a.abs;return this.createRange(Od,se,Ye,hf,da)}wa.ULS.sendTraceTag(537170010,0,10,`CalcManager.CovertFormulaRefToRange: Unsupported formula ref type '${G.type}'`);
return null}wa.ULS.sendTraceTag(537170011,0,15,"CalcManager.CovertFormulaRefToRange: traverseFormulaRef.Type is null");return null}CVa(G,da){return da.length>=G&&0<G&&da.charAt(G-1)===Qb.Dsg}kOh(G,da,$a){this.az&&this.az.vOh(G,da,$a)}FGf(G){return this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.YLa&&this.instantaneousSupportInformationManager.YLa[G]&&this.MM?this.instantaneousSupportInformationManager.YLa[G]:null}B1i(G){var da;"number"!==typeof G&&"string"!==
typeof G?this.NLc(null):(G=this.Hma(G),Object(Qe.c)(G)?(G=G.value,Object(Rd.c)(G)||Object(Rd.c)(G.formatString)?this.NLc(null):this.NLc({formatString:G.formatString,builtIn:null!==(da=G.isBuiltIn)&&void 0!==da?da:!1})):this.NLc(null))}toXLNumber(G){if(!this.MM)return null;G=excelOnlineCalc.numfmt.toXLNumber(this.config.mathpack,this.MM,G);return excelOnlineCalc.util.isSuccess(G)?G.value:null}v$(G,da,$a,Sb,Mc,sd,Od){if(!G)return Object(Qe.a)("Null");var se=excelOnlineCalc.numfmt.renderCallback($a,
hf=>gridRenderer.CanvasRendererGlobals.measureTextWidth(hf,Sb,!0,xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1)),sd),Ye=this.MM.renderValue(G,se);if(!excelOnlineCalc.util.isSuccess(Ye))return Object(Qe.a)("Finalize");$a=null;if(sd=excelOnlineCalc.numfmt.isHashesValue(Ye.value)){if(Ye=this.MM.renderHashesValue(Ye.value,se),!excelOnlineCalc.util.isSuccess(Ye))return Object(Qe.a)("Hashes")}else $a=this.$x.fGd(G,Ye.value);Ye=Ye.value;G=excelOnlineCalc.numfmt.renderedValueToString(Ye);
se=this.$x.PEf(Ye);Ye=this.$x.aEf(Ye);return Object(Qe.d)({text:G,valueType:da,fontColor:Ye,format:Mc,horizontalAlignment:se,numFmt:$a,isHashesValue:sd,cellValue:Od})}b6k(G,da){if(G)for(const $a of G)$a.ref.type&&$a.ref.type===ie.a.cell&&(G=$a.ref,wc.l5j(G,da)&&(G.span.end+=1,$a.span.end+=1))}createRange(G,da,$a,Sb,Mc){const sd={};sd.FirstRow=G;sd.FirstColumn=da;sd.LastRow=$a;sd.LastColumn=Sb;sd.SheetName=Mc;return sd}Jdi(G,da,$a){var Sb=G.ref.qualifier;if(!Sb)return!0;switch(G.ref.qualifier.type){case md.sheet:return G=
Sb.document,Lb.a.equals(Sb.sheet,da,!0)&&(!G||Lb.a.equals(G.document,$a,!0));case md.sheetRange:return da=this.$.sa.getItemByName(da),$a=this.$.sa.getItemByName(Sb.sheet1),Sb=this.$.sa.getItemByName(Sb.sheet2),!!da&&!!$a&&!!Sb&&($a.index<=da.index&&da.index<=Sb.index||Sb.index<=da.index&&da.index<=$a.index);case md.document:return Lb.a.equals(Sb.document,$a,!0);case md.a7i:return Sb=Sb.name,Lb.a.equals(Sb,da,!0)||Lb.a.equals(Sb,$a,!0);default:return wa.ULS.sendTraceTag(537170009,0,10,`CalcManager.GetQualifierData: Unsupported formula qualifier type '${Sb.type}'`),
!1}}aij(){try{void 0!==excelOnlineCalc}catch(G){return!1}try{void 0!==excelOnlineCalc.location}catch(G){return!1}return!0}S_k(G){this.instantaneousSupportInformationManager=G;if(G.YLa.length&&G.$va.length)if(this.aij())try{this.u6c=new Nb.CalcHelper(this.da.$,this.instantaneousSupportInformationManager),this.wza=this.O3.createParser(),this.slc=this.O3.createAnalyzer(),this.$Pe=this.O3.createNumberFormatter(),this.jEc=!0,wa.ULS.sendTraceTag(537170007,0,50,"CalcManager.TryInitializeInternal: calc initialized"),
this.az||(wa.ULS.sendTraceTag(537170006,0,50,"CalcManager creating calc engine"),this.az=new Ob(this.$)),this.Dpk()}catch(da){wa.ULS.sendTraceTag(507533056,0,10,`CalcManager.TryInitializeInternal: Exception while trying to create CalcManager. Exception message is: ${da.message}`),xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8723645_RejectCalcPromiseOnError")&&this.Yee()}else wa.ULS.shipAssertTag(40939861,0,this.A$b,"CalcManager.TryInitializeInternal: ExcelOnlineCalc is not loaded, any usage of it causes JS crash. Aborting calc initialization."),
this.A$b=!0,xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8723645_RejectCalcPromiseOnError")&&this.Yee();else wa.ULS.sendTraceTag(537170008,0,15,`CalcManager.TryInitializeInternal: IInstantaneousSupportInformationManager locale information missing, cannot initialize calc. number formats count = ${G.YLa.length}, functions info count = ${G.$va.length}`),xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8723645_RejectCalcPromiseOnError")&&this.Yee()}A5h(G,da){const $a={allowUnqualifiedCell:!0,wrapCellReferences:!0};
$a.config=this.O3.config;$a.originGridCell=excelOnlineCalc.util.success(G);$a.originSheet=excelOnlineCalc.util.success(da);return $a}z5h(){const G={};G.config=this.O3.config;G.getNameLoc=this.az.getNameLoc;G.getContainingTable=this.az.getContainingTable;G.getStructRefColumn=this.az.getStructRefColumn;G.getStructRefSpecialRef=this.az.getStructRefSpecialRef;G.getDocumentLoc=this.az.getDocumentLoc;G.getSheetIndex=this.az.getSheetIndex;G.getSheetName=this.az.getSheetName;G.getUserDefinedFuncLoc=this.az.getUserDefinedFuncLoc;
G.getSheetRangeIndexes=this.az.getSheetRangeIndexes;return G}static l5j(G,da){return da.length>G.span.end&&da.charAt(G.span.end)===Qb.Dsg}};dd.rof="ECRC";dd.Ukd="ActiveCellNumberFormatChanged";dd.Xtd="ClientDataFlushedToWorkerKey";dd=wc=Object(oc.__decorate)([Object(Wc.d)(Qc.E),Object(oc.__param)(0,Object(Qc.Lb)()),Object(oc.__param)(1,Object(Qc.D)()),Object(oc.__param)(2,Object(Qc.Rb)())],dd);Object(ka.a)(dd,"CalcManager",pa.a,[640,2]);var vd=a(952);let Zd=class{constructor(G){this.b6a=!1;this.p3a=
da=>{lb.a.Jk(da.Errors)?(-315732528!==da.Errors[0].MessageId&&wa.ULS.sendTraceTag(507609629,0,10,`CopilotNewBadgeManager.onReadRoamingStringSuccess: encountered an error. Errors: ${lb.a.Kh(da.Errors)}`),this.b6a=!1,this.d1c(!1)):da.Result&&((this.b6a=!!parseInt(da.Result,10))||this.d1c(!1))};this.Hqb=da=>{da=dc.a.Qj(da.data);wa.ULS.sendTraceTag(507609627,0,10,`CopilotNewBadgeManager.onReadWriteRoamingStringFailure: Encountered errors while reading/writing roaming setting. Errors: ${lb.a.Kh(da)}.`);
this.b6a=!1;this.d1c(!1)};this.z3a=da=>{lb.a.Jk(da.Errors)?wa.ULS.sendTraceTag(507609628,0,10,`CopilotNewBadgeManager.onWriteRoamingStringSuccess: encountered an error. Errors: ${lb.a.Kh(da.Errors)}`):da.Result||wa.ULS.sendTraceTag(507609626,0,10,"CopilotNewBadgeManager.onWriteRoamingStringSuccess failed to write to roaming service.")};this.$=G;this.initialize()}dispose(){this.$=null}initialize(){wa.ULS.shipAssertTag(507609630,0,Fd.a.dTd(),"Copilot New Badge feature is off");this.$.ea.Ph||wa.ULS.shipAssertTag(507569056,
0,this.$.ea.Ph,"CopilotNewBadgeManager.initialize but session is inactive");le.C(this.$.pa.ta,8,this.p3a,this.Hqb,null,null)}i3c(G){le.J(this.$.pa.ta,8,G.toString(),this.z3a,this.Hqb,null,null)}d1c(G){G&&this.b6a||(appChrome.api.dispatch(appChrome.actions.setControlIconSet("Copilot",this.yXi(G))),G&&(this.b6a=!0,this.i3c(Number(this.b6a))))}yXi(G){const da=xb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopilotNewBadgeEnabled",0),$a={"default":"M365Excel_20",icon32:"M365Excel_32"};G||(1===
da?($a["default"]="CopilotExcelNewBadge_20",$a.icon32="CopilotExcelNewBadge_32"):2===da&&($a["default"]="CopilotExcelDotBadge_20",$a.icon32="CopilotExcelDotBadge_32"));return $a}};Zd=Object(oc.__decorate)([Object(Wc.d)(Qc.gb),Object(oc.__param)(0,Object(Qc.Lb)())],Zd);Object(ka.a)(Zd,"CopilotNewBadgeManager",null,[2]);var Re=a(732),ff=a(387);const af=(G,da)=>{da=void 0===da?!1:da;G=new ce.Range(G.top,G.left,G.bottom,G.right,!1,da);if(da&&(1>G.top||G.top>G.maxRows||1>G.bottom||G.bottom>G.maxRows||
G.top>G.bottom||1>G.left||G.left>G.maxColumns||1>G.right||G.right>G.maxColumns||G.left>G.right))throw wa.ULS.sendTraceTag(510247817,0,10,"Range.ValidateRange: range is invalid"),Error.argument("Range.ValidateRange: range is invalid");return G};var xf=a(986),eg=a(1063),Ab=a(925),xc=a(118),eb=a(957);const Ub={[0]:[45],[1]:[46]};class Fc{constructor(G,da){this.$=G;this.sessionStorage=da;this.BJc=new Map;this.doUndo=()=>{const $a=this;return No(function*(){yield Object(xf.e)($a.$)})};this.highlightRangesOnGrid=
($a,Sb,Mc)=>{const sd=this;return No(function*(){sd.highlightRanges($a,Sb,Ub[Mc])})};this.openLearnMore=()=>{const $a=this;return No(function*(){Object(eg.b)($a.$)})};this.openCustomNumberFormat=()=>{const $a=this;return No(function*(){return new Promise(Sb=>{Object(xf.a)($a.$,Mc=>{Sb(Mc);wa.ULS.sendTraceTag(509617692,0,50,`HostAppCallbacks.openCustomNumberFormat: resolved with "${Mc?"OK":"Cancel"}"`)})})})};this.openFeedback=$a=>{const Sb=this;return No(function*(){Object(xf.f)(Sb.$,$a)})};this.sendOtelEvent=
$a=>No(function*(){Object(Ab.b)($a)});this.containsHiddenCells=$a=>f(this.$,$a);this.getSessionStorageItem=($a,Sb)=>{const Mc=this;return No(function*(){var sd;return null===(sd=Mc.BJc.get($a))||void 0===sd?void 0:sd.get(Sb)})};this.setSessionStorageItem=($a,Sb,Mc)=>{const sd=this;return No(function*(){var Od;sd.BJc.has($a)||sd.BJc.set($a,new Map);null===(Od=sd.BJc.get($a))||void 0===Od?void 0:Od.set(Sb,Mc)})};this.replaceMultipleStrings=($a,Sb,Mc,sd)=>{const Od=this;return No(function*(){const se=
$a.map(Ye=>af(Ye,!1));return t(Od.$,se,Sb,Mc,{["SheetName"]:Od.$.na.sheetName,["MatchCase"]:sd.matchCase,["MatchEntireCell"]:sd.matchEntireCell,["SearchAllSheets"]:!1,["ExcludeFormulaResult"]:!1,["SearchUp"]:!1,["SearchStrings"]:Sb,["ReplaceWholeWordOnly"]:sd.replaceWholeWordOnly})})};this.trimWhitespace=($a,Sb)=>{const Mc=this;return No(function*(){const sd=$a.map(Od=>af(Od,!1));return e(Mc.$,sd,Sb.map(k))})};this.formatCells=($a,Sb)=>{const Mc=this;return No(function*(){const sd=$a.map(se=>af(se,
!1)),Od={NumberFormatOptions:Object(Bb.a)(new eb.a,{NumberFormatCategory:-1,CustomFormatString:Sb}),ValidMembers:32,NumberFormat:15};return m(Mc.$,sd,Od)})};this.getIgnoredSuggestions=()=>{const $a=this;return No(function*(){return $a.sessionStorage.getIgnoredSuggestions()})};this.setIgnoredSuggestions=$a=>{const Sb=this;return No(function*(){return Sb.sessionStorage.setIgnoredSuggestions($a)})};this.addToIgnoredSuggestions=$a=>{const Sb=this;return No(function*(){return Sb.sessionStorage.addToIgnoredSuggestions($a)})};
this.getAppliedSuggestions=()=>{const $a=this;return No(function*(){return $a.sessionStorage.getAppliedSuggestions()})};this.addToAppliedSuggestions=$a=>{const Sb=this;return No(function*(){return Sb.sessionStorage.addToAppliedSuggestions($a)})};this.removeFromAppliedSuggestions=$a=>{const Sb=this;return No(function*(){return Sb.sessionStorage.removeFromAppliedSuggestions($a)})}}get grid(){return fc.f(this.$)}highlightRanges(G,da,$a){$a=void 0===$a?[45]:$a;const Sb=this.grid.rh;Sb.zq($a,!1,!0);Sb.Vs(null,
$a,!1);if(null===G||void 0===G?0:G.length){const Mc=ff.a.d8a(Lc.d(this.$.na),G.map(sd=>af(sd,!1)));Sb.BP(Mc,$a,!0,void 0,!1);da&&this.gFj(G)}Sb.update(!1)}gFj(G){if(null===G||void 0===G?0:G.length){const da=this.grid;[G]=G.sort(($a,Sb)=>$a.top<Sb.top?-1:$a.top>Sb.top?1:0);G=ce.Range.gi(G.top,G.left);da.FF(G)||(wa.ULS.sendTraceTag(509617691,0,50,"HostAppCallbacks.moveViewportToRangeIfNeeded moving viewport"),da.gD(G,0,"DataCleansing"))}else wa.ULS.sendTraceTag(509617690,0,10,"HostAppCallbacks.moveViewportToRangeIfNeeded no ranges to move viewport")}}
Object(ka.a)(Fc,"HostAppCallbacks",null,[]);class rd{constructor(){this.annotations=[];this.hostState={isInCoauthoring:!1,isFeedbackAllowed:!1};this.worksheetState={isInNamedSheetView:!1,isProtected:!1}}}Object(ka.a)(rd,"DataCleansingHostState",null,[]);class Gd{constructor(G){this.$=G;this.Qlf=!1}get isEnabled(){return xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingLearnMoreTeachingCallout",!1)}show(){this.Qlf||(wa.ULS.sendTraceTag(508887310,0,20,"DataCleansing.showCallout: dispatchShowCalloutCommand."),
Object(xf.c)(this.$),this.Qlf=!0)}}Object(ka.a)(Gd,"TeachingCallout",null,[]);var ue=a(175),Ce=a(264),Se=a(1062);class of{constructor(G){this.$=G;this.Plf=!1;this.localStorage=new Ce.a;this.wok()}S6a(G,da){const $a=this;return No(function*(){if($a.Plf)wa.ULS.sendTraceTag(509089825,0,50,"DataCleansingBusinessBar.showBusinessBar: Data cleansing business bar was already shown.");else if($a.$Ik()){var Sb=String.format(ha.a.instance.$g(239),G),Mc=ue.a.ia(2474),sd=ue.a.ia(2475);Sb=xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8683561_DataCleansingNewBusinessBarStrings")?
Object(Se.b)(G):{title:Sb,message:sd,GXc:Mc};$a.fVa||($a.fVa=yield Wc.a.resolve(Qc.C,{va:1}));$a.fVa.fLk(Sb.title,Sb.message,Sb.GXc,()=>{wa.ULS.sendTraceTag(508117194,0,20,"DataCleansingBusinessBar.showBusinessBar: Show suggestions was clicked.");$a.s0();$a.FEg()},()=>{wa.ULS.sendTraceTag(507789517,0,20,'DataCleansingBusinessBar.showBusinessBar: "X" button was clicked.');$a.O7i();da()});$a.Plf=!0;wa.ULS.sendTraceTag(509089824,0,20,`DataCleansingBusinessBar.showBusinessBar: Data cleansing business bar with  ${G} suggestions.`)}else wa.ULS.sendTraceTag(507789518,
0,20,"DataCleansingBusinessBar.showBusinessBar: Data cleansing business bar should not be shown.")})}s0(){this.fVa&&this.fVa.dO(70)&&this.fVa.removeEntry(70)}$Ik(){if(this.localStorage.jl()){const G=this.localStorage.getItem("CleanDataBBClosedCount");return!G||this.GXf()||3>parseInt(G,10)}wa.ULS.sendTraceTag(507789516,0,20,"DataCleansingBusinessBar.shouldShowBusinessBar: Local storage is not supported.");return!0}wok(){this.GXf()?this.FEg():wa.ULS.sendTraceTag(507787410,0,20,"DataCleansingBusinessBar.resetBBCloseValuesIfNeeded: Last close was less than 30 days ago.")}GXf(){if(this.localStorage.jl()){const G=
this.localStorage.getItem("CleanDataBBClosedDate");if(G){const da=Date.now()-parseInt(G,10),$a=2592E6<da;wa.ULS.sendTraceTag(507787409,0,20,`DataCleansingBusinessBar.isLastCloseAboveCooldown: timeFromLastClose: ${da}, lastCloseDate: ${G}, isLastCloseAboveCooldown: ${$a} `);return $a}}return!1}FEg(){this.localStorage.jl()&&(this.localStorage.removeItem("CleanDataBBClosedCount"),this.localStorage.removeItem("CleanDataBBClosedDate"),wa.ULS.sendTraceTag(507789515,0,20,"DataCleansingBusinessBar.resetBBClosedCount"))}O7i(){if(this.localStorage.jl()){let G=
this.localStorage.getItem("CleanDataBBClosedCount");G=G?(parseInt(G,10)+1).toString():"1";const da=Date.now().toString();this.localStorage.setItem("CleanDataBBClosedCount",G);this.localStorage.setItem("CleanDataBBClosedDate",da);wa.ULS.sendTraceTag(507789514,0,20,`DataCleansingBusinessBar.increaseBBClosedCount: new count is: ${G}, new date is: ${da}`)}}}Object(ka.a)(of,"BusinessBar",null,[]);var jf=a(883);class bf{constructor(G){jf.a.assign(bf,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=
G}static getTypeName(){return"AugLoop_Tablelint_TableLintAnnotationBase"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(G){return jf.a.matchesTypesFor(G,[bf.getTypeName()])}}bf.H_={T_:bf.getTypeName(),B_:bf.getBaseTypes()};class pf{constructor(G){jf.a.assign(pf,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_Tablelint_TableLintAnnotation"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(G){return jf.a.matchesTypesFor(G,
[pf.getTypeName()])}}pf.H_={T_:pf.getTypeName(),B_:pf.getBaseTypes()};class Ud{constructor(G){jf.a.assign(Ud,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_Tablelint_TableLintColumnAnnotation"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(G){return jf.a.matchesTypesFor(G,[Ud.getTypeName()])}}Ud.H_={T_:Ud.getTypeName(),B_:Ud.getBaseTypes()};class Ff{constructor(G){jf.a.assign(Ff,
this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_Tablelint_TableLintWorksheetAggregateAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(G){return jf.a.matchesTypesFor(G,[Ff.getTypeName()])}}Ff.H_={T_:Ff.getTypeName(),B_:Ff.getBaseTypes()};class Uf{constructor(G){jf.a.assign(Uf,this,G)}static getTypeName(){return"AugLoop_Tablelint_TableLintSuggestion"}static getBaseTypes(){return[]}static typeGuard(G){return jf.a.matchesTypesFor(G,
[Uf.getTypeName()])}}Uf.H_={T_:Uf.getTypeName(),B_:Uf.getBaseTypes()};class Gf{constructor(G){jf.a.assign(Gf,this,G)}static getTypeName(){return"AugLoop_Tablelint_TableLintTextInconsistencySuggestion"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintSuggestion"]}static typeGuard(G){return jf.a.matchesTypesFor(G,[Gf.getTypeName()])}}Gf.H_={T_:Gf.getTypeName(),B_:Gf.getBaseTypes()};class lg{constructor(G){jf.a.assign(lg,this,G)}static getTypeName(){return"AugLoop_Tablelint_TableLintNumberFormattingInconsistencySuggestion"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintSuggestion"]}static typeGuard(G){return jf.a.matchesTypesFor(G,
[lg.getTypeName()])}}lg.H_={T_:lg.getTypeName(),B_:lg.getBaseTypes()};class Pa{constructor(G){jf.a.assign(Pa,this,G)}static getTypeName(){return"AugLoop_Tablelint_TableLintExtraSpacesSuggestion"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintSuggestion"]}static typeGuard(G){return jf.a.matchesTypesFor(G,[Pa.getTypeName()])}}Pa.H_={T_:Pa.getTypeName(),B_:Pa.getBaseTypes()};class lc{constructor(G){jf.a.assign(lc,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_ExcelCleanData_ExtraSpacesColumnAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(G){return jf.a.matchesTypesFor(G,
[lc.getTypeName()])}}lc.H_={T_:lc.getTypeName(),B_:lc.getBaseTypes()};class Gc{constructor(G){jf.a.assign(Gc,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_ExcelCleanData_ExtraSpacesTableAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(G){return jf.a.matchesTypesFor(G,[Gc.getTypeName()])}}Gc.H_={T_:Gc.getTypeName(),B_:Gc.getBaseTypes()};class Cd{constructor(G){jf.a.assign(Cd,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=
G}static getTypeName(){return"AugLoop_ExcelCleanData_CleanDataResolverAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(G){return jf.a.matchesTypesFor(G,[Cd.getTypeName()])}}Cd.H_={T_:Cd.getTypeName(),B_:Cd.getBaseTypes()};class Qd{constructor(G){jf.a.assign(Qd,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_ExcelCleanData_RowsIdentityAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(G){return jf.a.matchesTypesFor(G,
[Qd.getTypeName()])}}Qd.H_={T_:Qd.getTypeName(),B_:Qd.getBaseTypes()};class ge{constructor(G){jf.a.assign(ge,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_ExcelCleanData_DuplicatedRowsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(G){return jf.a.matchesTypesFor(G,[ge.getTypeName()])}}ge.H_={T_:ge.getTypeName(),B_:ge.getBaseTypes()};class ye{constructor(G){jf.a.assign(ye,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=
G}static getTypeName(){return"AugLoop_ExcelCleanData_UnprintableCharactersColumnAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(G){return jf.a.matchesTypesFor(G,[ye.getTypeName()])}}ye.H_={T_:ye.getTypeName(),B_:ye.getBaseTypes()};class $e{constructor(G){jf.a.assign($e,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_ExcelCleanData_UnprintableCharactersTableAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(G){return jf.a.matchesTypesFor(G,
[$e.getTypeName()])}}$e.H_={T_:$e.getTypeName(),B_:$e.getBaseTypes()};class qf{constructor(G){jf.a.assign(qf,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_ExcelCleanData_DataOutlierAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(G){return jf.a.matchesTypesFor(G,[qf.getTypeName()])}}qf.H_={T_:qf.getTypeName(),B_:qf.getBaseTypes()};class h{constructor(G,da){this.Bo=G;this.Ndg=da;this.Ita=!1;this.qF=new EventTarget;
this.aWg=($a,Sb)=>{if($a=Sb.annotation)switch(Sb.operationType){case 1:case 2:this.qF.dispatchEvent(new CustomEvent("suggestionsAnnotationReceived",{detail:$a}));break;case 3:break;default:wa.ULS.sendTraceTag(508560024,306,15,`AnnotationsProvider.suggestionsAnnotationHandler Received unexpected OperationType:${Sb.operationType}`)}else wa.ULS.sendTraceTag(508560025,306,50,"AnnotationsProvider.suggestionsAnnotationHandler suggestionsAnnotation is null.")};this.Hpk=($a,Sb)=>{if($a=Sb.annotation)switch(Sb.operationType){case 1:case 2:this.qF.dispatchEvent(new CustomEvent("resolverAnnotationReceived",
{detail:$a}));break;case 3:break;default:wa.ULS.sendTraceTag(508560027,306,15,`AnnotationsProvider.resolverAnnotationHandler Received unexpected OperationType:${Sb.operationType}`)}else wa.ULS.sendTraceTag(508560028,306,50,"AnnotationsProvider.resolverAnnotationHandler: resolverAnnotation is null.")};wa.ULS.sendTraceTag(507777624,0,50,"AnnotationsProvider.constructor: AnnotationsProvider is created.");this.Bo=G;this.Ndg=da}activateEvents(){this.Ita?wa.ULS.sendTraceTag(508560026,0,50,"AnnotationsProvider.ActivateEvents: Events are already registered"):
(this.Udk(),this.Ita=!0)}deactivateEvents(){this.Ita&&(this.H1k(),this.Ita=!1)}registerSuggestionsAnnotationReceived(G){this.qF.addEventListener("suggestionsAnnotationReceived",da=>{da instanceof CustomEvent&&G(null===da||void 0===da?void 0:da.detail)})}registerResolverAnnotationReceived(G){this.qF.addEventListener("resolverAnnotationReceived",da=>{da instanceof CustomEvent&&G(null===da||void 0===da?void 0:da.detail)})}H1k(){this.Bo.unregister("DataCleansing")}Udk(){wa.ULS.sendTraceTag(574482312,
0,50,"AnnotationsProvider.registerCleanDataEvents: activate annotations");const G=this.Bo.e5().B7("DataCleansing").A7(this.Ndg).activateAnnotation({annotationType:Ud.getTypeName(),bB:!0,dQa:this.aWg}).activateAnnotation({annotationType:Gc.getTypeName(),bB:!0,dQa:this.aWg}).activateAnnotation({annotationType:Cd.getTypeName(),bB:!0,dQa:this.Hpk});xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FindDuplicatedRowsLinter",!1)&&G.activateAnnotation({annotationType:ge.getTypeName(),bB:!0});
xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FindUnprintableCharacters",!1)&&G.activateAnnotation({annotationType:$e.getTypeName(),bB:!0});xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FindDataOutliers",!1)&&G.activateAnnotation({annotationType:qf.getTypeName(),bB:!0});this.Bo.register(G.build())}}Object(ka.a)(h,"AnnotationsProvider",null,[]);var Z=a(1189),E=a(149);class aa{constructor(G,da){this.$=G;this.Ej=da}isUsageRangeTable(G){const da=fc.f(this.$),$a=da.Wvj;return G.worksheetName!==
da.$.na.sheetName?null:null==$a?(wa.ULS.sendTraceTag(507847903,0,20,"AnnotationsHostCallbacks.isUsageRangeTable: usedRange is null"),null):1===G.tableRange.top&&G.tableRange.bottom===$a.bottom}logCtrlAComparisonResults(G){G={["range"]:new ce.Range(G.tableRange.top,G.tableRange.left,G.tableRange.bottom-1,G.tableRange.right,!1,!1),["sheetId"]:G.worksheetId,["sheetName"]:G.worksheetName,["callback"]:this.WNd};Object(xf.b)(this.$,G)}getDependentFormulasSuggestionInfo(G,da){const $a=new Set;da.forEach(Sb=>
$a.add(af(Sb)));G=r(this.$,this.Ej,G,$a);return new Map(Array.from(G.entries(),Sb=>{var [Mc,sd]=Sb;return[Mc.toString(),Array.from(new Set(Array.from(sd,Od=>Od.toString())))]}))}WNd(G,da,$a){G.Result?lb.a.rx(G.Errors)?($a=lb.a.Kh(G.Errors),wa.ULS.sendTraceTag(507867614,0,15,`AnnotationsHostCallbacks.handleGetSelectAllRangeSuccess: result return with errors: ${$a}, AnnotationRange: ${da}`)):(G=Pe.G(G.Result),da.bottom+=1,wa.ULS.sendTraceTag(507867613,0,20,`AnnotationsHostCallbacks.handleGetSelectAllRangeSuccess: sheetId: ${$a}, annotationRange: ${da}, ctrlARange: ${G}, isSameRangeAsCtrl+A: ${G.toString()===
da.toString()}, isTopAndBottomAsCtrl+A: ${G.top===da.top&&G.bottom===da.bottom}`)):wa.ULS.sendTraceTag(507867615,0,50,`AnnotationsHostCallbacks.handleGetSelectAllRangeSuccess: result.Result is null. AnnotationRange: ${da}`)}}Object(ka.a)(aa,"AnnotationsHostCallbacks",null,[]);class Ja{constructor(G){this.$=G}readIgnoredSuggestions(){return new Promise(G=>{le.B(this.$.pa.ta,9,da=>{lb.a.Jk(da.Errors)?(wa.ULS.sendTraceTag(507577634,0,10,`RoamingOperations.readIgnoredSuggestions: encountered an error while reading roaming setting. Errors: ${lb.a.Kh(da.Errors)}`),
G(null)):(da=da.Result?JSON.parse(da.Result):[],wa.ULS.sendTraceTag(507577633,0,20,`RoamingOperations.readIgnoredSuggestions: ignoredSuggestionsIds.size: ${da.length}`),G(new Set(da)))},da=>{this.pQj(da);G(null)},null,null)})}writeIgnoredSuggestions(G){G=Array.from(G);wa.ULS.sendTraceTag(507549142,0,50,`RoamingOperations.writeIgnoredSuggestions: ignoredSuggestions.size: ${G.length}`);le.I(this.$.pa.ta,9,JSON.stringify(G),da=>{this.uZj(da)},da=>{this.sZj(da)},null,null)}pQj(G){({data:G}=G);G=dc.a.Qj(G);
wa.ULS.sendTraceTag(507577632,0,10,`RoamingOperations.onGetIgnoredSuggestionsFromRoamingFailure: encountered errors while reading roaming setting. Errors: ${lb.a.Kh(G)}.`)}sZj(G){G=dc.a.Qj(G.data);wa.ULS.sendTraceTag(507577631,0,10,`RoamingOperations.onWriteRoamingFailed: encountered errors: ${lb.a.Kh(G)}.`)}uZj(G){lb.a.Jk(G.Errors)||!G.Result?wa.ULS.sendTraceTag(507577630,0,10,`RoamingOperations.onWriteRoamingSuccess: write Failed${lb.a.Jk(G.Errors)?", Encountered some errors. Errors: "+lb.a.Kh(G.Errors):
""}`):wa.ULS.sendTraceTag(507577629,0,50,"RoamingOperations.onWriteRoamingSuccess: write Succeeded")}}Object(ka.a)(Ja,"RoamingOperations",null,[]);class tb{constructor(G,da,$a,Sb){this.$=G;this.yT=da;this.aR=$a;this.SGb=Sb;this.R6f=new Set}gRb(){if(xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingFormulasDependencies",!1)&&xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8691394_logDependentSuggestionsInfoForEveryActiveSheet")&&Lc.l(this.$.na)){var G=this.$.na.sheetId,da=this.yT.sheetAnnotations(G);
if(0<da.length){let $a=!1;this.R6f.has(G)||(this.R6f.add(G),$a=!0);this.logDependentSuggestionsInfo(G,da,$a)}}}logDependentSuggestionsInfo(G,da,$a){let Sb;Sb=xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8727064_FormulaDependencyOnSuggestionAffectedRanges")?this.aR.annotationsUtils.getSuggestionAffectedRanges(da):this.aR.annotationsUtils.getSuggestionRanges(da);this.aR.suggestionsTelemetryUtils.logDependentSuggestionsInfo(G,da,$a,this.SGb.getDependentFormulasSuggestionInfo(G,Sb))}}Object(ka.a)(tb,
"SuggestionDependency",null,[]);var S;(function(G){G.None="None";G.ShowBusinessBar="ShowBusinessBar";G.HideBusinessBar="HideBusinessBar"})(S||(S={}));class Wa{constructor(G,da,$a,Sb){this.$=G;this.aR=da;this.yT=$a;this.sessionStorage=Sb;this.isEnabled=!0;this.dze=!1;this.businessBar=new of(this.$);this.o8b=new Gd(this.$)}s0(){this.businessBar.s0()}I_i(G){const da=this;return No(function*(){da.dze?da.businessBar.s0():yield da.yZg(G)})}yZg(G){const da=this;return No(function*(){if(da.isEnabled&&!da.dze){var $a=
yield da.eld(G),Sb=da.aR.disoverabilityUtils.getDiscoverabilityCommand($a);$a=da.aR.listsUtils.sum($a.values());switch(Sb){case S.ShowBusinessBar:yield da.iZk($a);break;case S.HideBusinessBar:da.businessBar.s0()}}})}dMb(){this.businessBar.s0();this.isEnabled=!1}l8a(){this.o8b.isEnabled&&this.o8b.show()}eld(G){const da=this;return No(function*(){const $a=da.yT.sheetAnnotations(G);if(xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionIgnoredSuggestion",!1)){const Sb=yield da.sessionStorage.getIgnoredSuggestions();
return da.aR.annotationsUtils.suggestionsToShowCountByType($a,Sb)}return da.aR.annotationsUtils.suggestionCountByType($a)})}iZk(G){const da=this;return No(function*(){da.yT.pauseAugmentationLoop("triggerBusinessBar");yield da.businessBar.S6a(G,()=>{da.MKj()});da.dze=!0})}MKj(){this.l8a()}}Object(ka.a)(Wa,"DiscoverabilityManager",null,[]);var zb=a(1190),hc;let cd=hc=class extends pa.a{constructor(G,da,$a,Sb){super();this.$=G;this.aR=$a;this.Ej=Sb;this.dMb=!1;this.N6f=new Set;this.aha=new rd;this.SWj=
()=>{const Mc=this;return No(function*(){Mc.stateChanged();if(xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingDiscoverabilityRefactor",!1)){const sd=Mc.YOb();if(!sd)return;yield Mc.hMb.yZg(sd)}else yield Mc.TLf();xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8723353_separateSuggestionDependency")?Mc.$Vg.gRb():Mc.gRb()})};this.aq=(Mc,sd)=>{const Od=this;return No(function*(){Od.n1g(sd.mB);Od.PVg(sd.na);Od.stateChanged();if(xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingDiscoverabilityRefactor",
!1)){const se=Od.YOb();if(!se)return;yield Od.hMb.I_i(se)}else Od.businessBar.s0(),yield Od.TLf();xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8723353_separateSuggestionDependency")?Od.$Vg.gRb():Od.gRb()})};this.jza=()=>{this.stateChanged()};this.sE=()=>{this.stateChanged()};this.kA=()=>{this.$.ea.isEditMode?(void this.yT.activateEvents(),this.$.ea.GH(this.kA)):wa.ULS.sendTraceTag(507856794,0,20,"DataCleansingHostManager.onApplicationModeChanged: the workbook is not in edit mode, therefore we don't activate the events.")};
this.wYj=(Mc,sd)=>{Mc=void 0===Mc?"Unknown":Mc;wa.ULS.sendTraceTag(520987272,0,20,`DataCleansingHostManager.onUnrecoverableErrorOccurred: Received augmentation loop session close. ${JSON.stringify({["closeReason"]:Z.a[Mc],["errorCode"]:sd})}`);xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8749328_SendCrucialOtelEvents")&&Object(Ab.b)(Object(zb.a)(Z.a[Mc],sd));this.aha.hostState.errorState=sd;this.stateChanged()};this.wha=(Mc,sd)=>{Lc.l(sd.item)&&sd.item.Dn!==this.aha.worksheetState.isProtected&&(wa.ULS.sendTraceTag(509613388,
0,50,`DataCleansingHostManager.onSheetOptionsChanged: sheet protection has changed to ${sd.item.Dn}.`),this.stateChanged())};this.mza=(Mc,sd)=>{l(this.$,sd)&&(xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingDiscoverabilityRefactor",!1)?this.hMb.dMb():this.bmf())};wa.ULS.sendTraceTag(507777625,0,50,"DataCleansingHostManager.constructor: DataCleansingHostManager is created.");xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionIgnoredSuggestion",!1)&&(this.sessionStorage=
$a.getOrCreateSessionStorage(new Ja(this.$)));this.JDh=new Fc(this.$,this.sessionStorage);this.o8b=new Gd(this.$);this.businessBar=new of(this.$);da=new h(da,this.wYj);this.SGb=new aa(this.$,this.Ej);this.yT=$a.createAnnotationsManger(da,this.SGb);this.yT.registerSheetAnnotationsChanged(this.SWj);xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingDiscoverabilityRefactor",!1)&&(this.hMb=new Wa(this.$,this.aR,this.yT,this.sessionStorage));this.$.ea.isEditMode?void this.yT.activateEvents():
this.$.ea.JJ(this.kA);G.Kt.Qm(this.aq);G.ea.Vda(this.sE);this.PVg(this.$.na);this.Mkc(this.mza);this.$.uoc(()=>{this.stateChanged()});xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8723353_separateSuggestionDependency")&&(this.$Vg=new tb(G,this.yT,$a,this.SGb))}Mkc(G){this.addHandler(hc.Vre,G)}ACg(G){this.removeHandler(hc.Vre,G)}DUk(){this.yT.pauseAugmentationLoop("taskPaneClosed");xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingDiscoverabilityRefactor",!1)?this.hMb.l8a():
this.l8a()}HUk(){this.yT.resumeAugmentationLoop("taskPaneOpened")}dispose(){this.$.Kt.hn(this.aq);this.$.ea.g7(this.sE);this.$.ea.GH(this.kA);this.n1g(this.$.na);super.dispose()}get state(){this.aha.annotations=this.yT.allAnnotations();if(Lc.l(this.$.na)){const G=this.$.na.Dn,da=this.$.na.sheetId,$a=this.$.na.sheetName;this.aha.worksheetState.isInNamedSheetView=this.$.na.Kj.Ow;this.aha.worksheetState.isProtected=G;this.aha.worksheetState.sheetId=da;this.aha.worksheetState.sheetName=$a}this.aha.hostState.isInCoauthoring=
this.isInCoauthoring();this.aha.hostState.isFeedbackAllowed=this.$.isFeedbackEnabled;return this.aha}bmf(){this.businessBar.s0();this.dMb=!0}R8d(){this.hMb.s0()}isInCoauthoring(){return!1}stateChanged(){this.raiseEvent(hc.Vre,this.state)}PVg(G){Lc.l(G)&&(G.Kj.Tcb(this.jza),G.Wcb(this.wha))}n1g(G){Lc.l(G)&&(G.Kj.d3b(this.jza),G.WSc(this.wha))}YOb(){if(Lc.l(this.$.na))return this.$.na.sheetId;wa.ULS.sendTraceTag(507510927,0,50,"DataCleansingHostManager.getActiveSheetId: active item is not a sheet.")}eld(){const G=
this;return No(function*(){if(!Lc.l(G.$.na))return new Map;const da=G.yT.sheetAnnotations(G.$.na.sheetId);if(!G.aR.annotationsUtils.getAggregateAnnotation(da))return new Map;if(xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionIgnoredSuggestion",!1)){const $a=yield G.sessionStorage.getIgnoredSuggestions();return G.aR.annotationsUtils.suggestionsToShowCountByType(da,$a)}return G.aR.annotationsUtils.suggestionCountByType(da)})}TLf(){const G=this;return No(function*(){const da=
yield G.eld(),$a=G.aR.listsUtils.sum(da.values());0===$a?G.businessBar.s0():G.WJk($a,da)&&(yield G.nZk($a),G.dMb=!0)})}l8a(){this.o8b.isEnabled&&this.o8b.show()}nZk(G){const da=this;return No(function*(){da.yT.pauseAugmentationLoop("triggerDiscoverabilityBusinessBar");yield da.businessBar.S6a(G,()=>{da.VMh()})})}VMh(){this.l8a()}WJk(G,da){var $a;if(!($a=this.dMb)){$a=this.$;var Sb;(Sb=l($a,this.state))||($a=$a.ea,Sb=!$a.isEditMode&&!$a.Hl());$a=Sb}return $a||2>G||!da.get("TextInconsistency")?!1:!0}gRb(){if(xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingFormulasDependencies",
!1)&&xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8691394_logDependentSuggestionsInfoForEveryActiveSheet")&&Lc.l(this.$.na)){var G=this.$.na.sheetId,da=this.yT.sheetAnnotations(G);if(0<da.length){let $a=!1;this.N6f.has(G)||(this.N6f.add(G),$a=!0);da=xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8727064_FormulaDependencyOnSuggestionAffectedRanges")?this.aR.annotationsUtils.getSuggestionAffectedRanges(da):this.aR.annotationsUtils.getSuggestionRanges(da);this.aR.suggestionsTelemetryUtils.logDependentSuggestionsInfo(G,
this.aha.annotations,$a,this.SGb.getDependentFormulasSuggestionInfo(G,da))}}}};cd.Vre="scek";cd=hc=Object(oc.__decorate)([Object(Wc.d)(Qc.mb),Object(oc.__param)(0,Object(Qc.Lb)()),Object(oc.__param)(1,Object(Qc.p)()),Object(oc.__param)(2,Object(Qc.Nb)()),Object(oc.__param)(3,Object(Qc.E)())],cd);Object(ka.a)(cd,"DataCleansingHostManager",pa.a,[]);var ta=a(263),wb=a(301),ic=a(279),Oa=a(16),Cb=a(924),yc=a(19),Nc=a(765);const Id=yc.a.Rni;let ke=class extends ta.a{constructor(G,da){let $a=document.getElementById(G.$h+
vc.a.Ypf);$a||($a=Cb.a("div",G.$h+vc.a.Ypf,"cui-taskpane"));super($a);this.oZ=0;this.d9a=!1;this.Li=()=>{this.DE(!1)};this.$=G;this.taskPaneManager=da;wb.a(G).Eq(this);this.$.Lp(this.Li);this.isVisible=!1}yta(G){this.addHandler("EnrichmentTaskPaneVilibilityChanged",G)}aAa(G){this.removeHandler("EnrichmentTaskPaneVilibilityChanged",G)}Izh(G){this.addHandler("EnrichmentTaskPaneOnFocus",G)}bkk(G){this.removeHandler("EnrichmentTaskPaneOnFocus",G)}get isVisible(){return super.isVisible}set isVisible(G){super.isVisible=
G;this.raiseEvent("EnrichmentTaskPaneVilibilityChanged")}get Co(){return this.isVisible}get Hk(){return ic.a.Ghi}get U7a(){return 10}get Dx(){return Id}get titleText(){return xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8207038_EnrichmentTaskPaneHeaderFix")?Za.AFrameworkApplication.fa.la("IsNewStringEnabled")?CommonUiStrings.EnrichmentPaneTitle:CommonUIStrings.l_EnrichmentPaneTitle:"Enrichment"}get kP(){return 300}get isResizable(){return!1}get Pi(){return this.domElement}get height(){return this.taskPaneManager.UZc.offsetHeight}get jJ(){return this.taskPaneManager.gjb(this.Pi,
this.titleText,this.kP,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.kP)}EU(){return this.d9a}L5(){return this.d9a}dispose(){this.$&&this.$.Au(this.Li);this.taskPaneManager=this.$=null;super.dispose()}zp(G,da){da||this.raiseEvent("EnrichmentTaskPaneOnFocus");return!da}Yp(G){return Oa.DOMElementExtensions.Cn(this.Pi,G)}gs(){}Xt(){}DE(G){(this.isVisible=this.d9a=G)?this.taskPaneManager.hS("EnrichmentTaskPane",this.jJ):this.taskPaneManager.hideTaskPane("EnrichmentTaskPane");
G||(fc.f(this.$).zp(!0,!1),this.$.jm())}};ke=Object(oc.__decorate)([Object(Wc.d)(Qc.Jb),Object(oc.__param)(0,Object(Qc.Lb)()),Object(oc.__param)(1,Object(Qc.We)()),Object(oc.__param)(2,Object(Nc.d)()),Object(oc.__param)(3,Object(Qc.ab)())],ke);Object(ka.a)(ke,"EnrichmentTaskPane",ta.a,[635,2,224,59]);var Ie=a(535),Le=a(897);Object(Wc.b)(Qc.Nb,{yk:"singleton"})(G=>No(function*(){yield Object(Le.a)("excelCleanData",{va:G.va});const da=window.excelCleanData.ExcelCleanDataGlobal;da.init(new Ie.a);wa.ULS.shipAssertTag(507777623,
0,!!da,"Failed to initialize ExcelCleanDataGlobal");return da}));var wf=a(34);let Kf=class{constructor(G,da){this.$=G;this.shortcutKeyManager=da;this.keg=()=>{this.J8a(this.$.ea.LPa,this.$.ea.P4a);this.a5k()};this.isMac=wf.a.isMac;xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8368791_ExtendedTooltips_NewArchitecture_UndoRedo")||this.shortcutKeyManager.o0e(this.keg)}dispose(){xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8368791_ExtendedTooltips_NewArchitecture_UndoRedo")||this.shortcutKeyManager.wBg(this.keg);
this.$=null}IAk(){const G=this.CWh.concat(this.wEj).map(da=>appChrome.actions.setControlCustomTooltip(da.commandId,this.jkb(da)));appChrome.api.dispatch(G)}J8a(G,da){this.h1k&&(this.JW[0].title=this.JW[2].title=this.Wxb(G),this.JW[1].title=this.D9b(da),this.JW[1].shortcut=this.isMac?this.shortcutKeyManager.uk(192):this.shortcutKeyManager.uk(154));G=this.jkb(this.JW[1]);da=this.jkb(this.JW[2]);G=[appChrome.actions.setControlCustomTooltip(this.JW[0].commandId,this.jkb(this.JW[0])),appChrome.actions.setControlCustomTooltip(this.JW[1].commandId,
G),appChrome.actions.setControlCustomTooltip(this.JW[2].commandId,da)];appChrome.api.dispatch(G)}get wEj(){this.tQ||(this.tQ=[],this.tQ.push(this.ep("Paste_MLR",ha.a.instance.Ba(513),ha.a.instance.Ba(767),this.shortcutKeyManager.uk(176))),this.tQ.push(this.ep("Cut",ha.a.instance.Ba(511),ha.a.instance.Ba(768),this.shortcutKeyManager.uk(172))),this.tQ.push(this.ep("Copy",ha.a.instance.Ba(512),ha.a.instance.Ba(769),this.shortcutKeyManager.uk(174))),this.tQ.push(this.ep("AlignTop_MLR",ha.a.instance.Ba(791),
ha.a.instance.Ba(792))),this.tQ.push(this.ep("AlignMiddle_MLR",ha.a.instance.Ba(793),ha.a.instance.Ba(794))),this.tQ.push(this.ep("AlignBottom_MLR",ha.a.instance.Ba(795),ha.a.instance.Ba(796))),this.tQ.push(this.ep("AlignLeft_MLR",ha.a.instance.Ba(797),ha.a.instance.Ba(799))),this.tQ.push(this.ep("AlignCenter_MLR",ha.a.instance.Ba(800),ha.a.instance.Ba(801))),this.tQ.push(this.ep("AlignRight_MLR",ha.a.instance.Ba(802),ha.a.instance.Ba(803))),this.tQ.push(this.ep("IncreaseIndent",ha.a.instance.Ba(804),
ha.a.instance.Ba(805))),this.tQ.push(this.ep("DecreaseIndent",ha.a.instance.Ba(806),ha.a.instance.Ba(807))),this.tQ.push(this.ep("Wrap",ha.a.instance.Ba(808),ha.a.instance.Ba(809))),this.tQ.push(this.ep("Merge",ha.a.instance.Ba(810),ha.a.instance.Ba(811))),this.tQ.push(this.ep("NumberFormatPercentage_MLR",ha.a.instance.ia(453),ha.a.instance.Ba(814),this.shortcutKeyManager.uk(404))),this.tQ.push(this.ep("NumberFormatComma_MLR",ha.a.instance.Ba(815),ha.a.instance.Ba(816))));return this.tQ}get CWh(){this.Ov||
(this.Ov=[],this.Ov.push(this.ep("UndoRedo",ha.a.instance.Ba(83),"",this.isMac?this.shortcutKeyManager.uk(191):this.shortcutKeyManager.uk(153))),this.Ov.push(this.ep("FormatPainter",ha.a.instance.ia(14),ha.a.instance.Ba(770))),this.Ov.push(this.ep("FontName_New",ha.a.instance.Ba(771),ha.a.instance.Ba(772))),Fd.a.nl()&&this.Ov.push(this.ep("FontPicker",ha.a.instance.Ba(771),ha.a.instance.Ba(772))),this.Ov.push(this.ep("FontSize",ha.a.instance.Ba(773),ha.a.instance.Ba(774))),this.Ov.push(this.ep("Bold",
ha.a.instance.ia(1333),ha.a.instance.Ba(775),this.isMac?this.shortcutKeyManager.uk(180):this.shortcutKeyManager.uk(179))),this.Ov.push(this.ep("Italic",ha.a.instance.ia(1334),ha.a.instance.Ba(776),this.isMac?this.shortcutKeyManager.uk(184):this.shortcutKeyManager.uk(183))),this.Ov.push(this.ep("BordersSplitButtonCompactMenu",ha.a.instance.Ba(777),ha.a.instance.Ba(779),this.isMac?this.shortcutKeyManager.uk(190):this.shortcutKeyManager.uk(189))),this.Ov.push(this.ep("FillColor",ha.a.instance.ia(537),
ha.a.instance.Ba(780))),this.Ov.push(this.ep("FontColor",ha.a.instance.Ba(781),ha.a.instance.Ba(782))),this.Ov.push(this.ep("GrowFontSize",ha.a.instance.Ba(783),ha.a.instance.Ba(784),this.shortcutKeyManager.uk(187))),this.Ov.push(this.ep("ShrinkFontSize",ha.a.instance.Ba(785),ha.a.instance.Ba(786),this.shortcutKeyManager.uk(188))),this.Ov.push(this.ep("Underline",ha.a.instance.ia(1335),ha.a.instance.Ba(787),this.isMac?this.shortcutKeyManager.uk(182):this.shortcutKeyManager.uk(181))),this.Ov.push(this.ep("Strikethrough",
ha.a.instance.ia(1336),ha.a.instance.Ba(788),this.isMac?this.shortcutKeyManager.uk(186):this.shortcutKeyManager.uk(185))),this.Ov.push(this.ep("DoubleUnderline",ha.a.instance.Ba(789),ha.a.instance.Ba(790))),this.Ov.push(this.ep("NumberFormatNew",ha.a.instance.Ba(812),ha.a.instance.Ba(813))),this.Ov.push(this.ep("NumberFormatAccountingNew",ha.a.instance.ia(449),ha.a.instance.Ba(817))),this.Ov.push(this.ep("IncreaseDecimal",ha.a.instance.Ba(818),ha.a.instance.Ba(819))),this.Ov.push(this.ep("DecreaseDecimal",
ha.a.instance.Ba(820),ha.a.instance.Ba(821))),this.Ov.push(this.ep("ConditionalFormatting",ha.a.instance.Ba(822),ha.a.instance.Ba(823))),this.Ov.push(this.ep("CellStylesGallery",ha.a.instance.Ba(824),ha.a.instance.Ba(825))),this.Ov.push(this.ep("FormatAsTableAlt",ha.a.instance.Ba(826),ha.a.instance.Ba(827))),this.Ov.push(this.ep("Format",ha.a.instance.Ba(828),ha.a.instance.Ba(829))),this.Ov.push(this.ep("AutoSum",ha.a.instance.Ba(830),ha.a.instance.Ba(831),this.shortcutKeyManager.uk(259))),this.Ov.push(this.ep("SortAndFilter",
ha.a.instance.Ba(832),ha.a.instance.Ba(833))),this.Ov.push(this.ep("FindAndSelect",ha.a.instance.Ba(834),ha.a.instance.Ba(835),this.shortcutKeyManager.uk(85))),this.Ov.push(this.ep("AnalyzeData",ha.a.instance.Ba(836),ha.a.instance.Ba(837))),this.Ov.push(this.ep("Sensitivity",ha.a.instance.Ba(838),ha.a.instance.Ba(839))),this.Ov.push(this.ep("InsertCells",ha.a.instance.ia(345),ha.a.instance.Ba(840),this.shortcutKeyManager.J6?this.shortcutKeyManager.uk(409):"")),this.Ov.push(this.ep("DeleteCells",ha.a.instance.ia(409),
ha.a.instance.Ba(841),this.shortcutKeyManager.J6?this.shortcutKeyManager.uk(407):"")),this.Ov.push(this.ep("ClearCells",ha.a.instance.Ba(842),ha.a.instance.Ba(843))));return this.Ov}get h1k(){this.JW||(this.JW=[],this.JW.push(this.ep("Undo",this.Wxb(2),ha.a.instance.Ba(765),this.isMac?this.shortcutKeyManager.uk(191):this.shortcutKeyManager.uk(153))),this.JW.push(this.ep("Redo",this.D9b(2),ha.a.instance.Ba(766),this.isMac?this.shortcutKeyManager.uk(192):this.shortcutKeyManager.uk(154))),this.JW.push(this.ep("UndoRedo",
this.Wxb(2),"",this.isMac?this.shortcutKeyManager.uk(191):this.shortcutKeyManager.uk(153))));return this.JW}ep(G,da,$a,Sb){return{commandId:G,title:da,description:$a,shortcut:Sb,s4i:Sb?!0:!1}}jkb(G){let da;da=G.title;G.s4i&&(da+=" "+G.shortcut);"UndoRedo"!==G.commandId&&(da+="\n\n"+G.description);return da}Wxb(G){switch(G){case 1:case 0:return G=ha.a.instance.Ba(81);case 3:return G=ha.a.instance.Ba(84);case 2:return G=ha.a.instance.Ba(83);case 4:return G=ha.a.instance.Ba(82);default:return G=ha.a.instance.Ba(81)}}D9b(G){switch(G){case 1:case 0:return G=
ha.a.instance.Ba(78);case 2:return G=ha.a.instance.Ba(80);case 4:return G=ha.a.instance.Ba(79);default:return G=ha.a.instance.Ba(78)}}a5k(){var G=this.ep("InsertCells",ha.a.instance.ia(345),ha.a.instance.Ba(840),this.shortcutKeyManager.J6?this.shortcutKeyManager.uk(409):"");const da=this.ep("DeleteCells",ha.a.instance.ia(409),ha.a.instance.Ba(841),this.shortcutKeyManager.J6?this.shortcutKeyManager.uk(407):"");G=[appChrome.actions.setControlCustomTooltip(G.commandId,this.jkb(G)),appChrome.actions.setControlCustomTooltip(da.commandId,
this.jkb(da))];appChrome.api.dispatch(G)}};Kf=Object(oc.__decorate)([Object(Wc.d)(Qc.Sb),Object(oc.__param)(0,Object(Qc.Lb)()),Object(oc.__param)(1,Object(Qc.Lf)())],Kf);Object(ka.a)(Kf,"ExtendedTooltipsManager",null,[2]);var cg=a(1015),Bg=a(89);let dh=class extends pa.a{constructor(G){super();this.statusBarManager=null;this.tooltip=this.Unb="";this.isVisible=!1;this.h8b=-1;this.sheetName=null;this.Pq=()=>{this.w9b();this.$.ea.qB(this.Pq)};this.hB=()=>{this.w9b();this.$.ea.Xza(this.hB)};this.Zhg=
()=>{this.w9b(!0);this.$.ea.Xza(this.Zhg)};this.sVj=da=>{if(this.isVisible&&this.Unb){da=this.da.Yg.sl(da);var $a=this.$.sa.na;if(da?da.hasAutoFilter&&da.PUa:$a&&0===$a.iG&&$a.hasAutoFilter&&$a.PUa)this.T5b(ha.a.instance.ia(2421),!0,da?this.CMd(da.name):this.BMd()),this.Ev()}};this.L_b=()=>{this.w9b()};this.$=G;this.da=fc.f(this.$);this.ha=this.da.ha;this.qa=this.ha.qa;this.ha.Cw(this.L_b);this.$.ka.Lh(29,da=>{this.statusBarManager=da;da.DL(this)});this.$.ea.An?this.w9b():this.$.ea.Bw(this.Pq)}Xx(G){this.addHandler("FilteredResultsStateChangedEventKey",
G)}Jx(G){this.removeHandler("FilteredResultsStateChangedEventKey",G)}Ev(){this.Yq("QueryFilteredResultsButton")&&this.raiseEvent("FilteredResultsStateChangedEventKey")}Ioc(){this.isVisible&&this.Unb&&(this.T5b(null,!1,null),this.Ev())}h4k(G,da){this.h8b=G;this.sheetName=da}T5b(G,da,$a){this.Unb=G;this.isVisible=da;this.tooltip=$a}UAa(G,da,$a){$a=void 0===$a?-1:$a;null!==G&&G.HasFilters?(this.h4k(da?$a:-1,this.$.sa.na.name),$a=new ce.Range(G.FirstRow+1,G.FirstColumn+1,G.LastRow+1,G.LastColumn+1,!1,
!1),$a=da?this.da.Yg.sl($a):void 0,this.T5b(this.Unb=String.format(ha.a.instance.$g(233),G.NumRowsFiltered,G.LastRow-G.FirstRow),!0,da?this.CMd(null===$a||void 0===$a?void 0:$a.name):this.BMd()),this.Ev()):(wa.ULS.sendTraceTag(507852319,0,50,"FilteredResultsStatusBarManager: EwaResult is null. All filters of that object will be cleared"),this.Ioc())}w9b(G){G=void 0===G?!1:G;if(!this.da.isEditing&&!this.da.Pp){var da=!1,$a=this.$.sa.na,Sb=this.da.Yg.sl(this.qa.activeCell);if(Sb&&(G||Sb.objectId!==
this.h8b))if(this.h8b=Sb.objectId,this.sheetName=$a.name,Sb.hasAutoFilter&&Sb.PUa)this.T5b(ha.a.instance.ia(2421),!0,this.CMd(Sb.name)),da=!0;else{this.Ioc();return}else if(!Sb&&$a&&0===$a.iG){if(!this.sheetName||0<this.h8b||G||$a.name!==this.sheetName)this.sheetName=$a.name,$a.hasAutoFilter&&$a.PUa?$a.WK&&(this.T5b(ha.a.instance.ia(2421),!0,this.BMd()),da=!0):this.Unb&&this.Ioc();this.h8b=-1}da&&this.Ev()}}Yq(){return xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowFilteredResultsInStatusBar",
!1)}hy(G,da){if("QueryFilteredResultsButton"!==G)return!1;da[cg.a.Visible]=this.isVisible;da[cg.a.LabelText]=this.Unb;window.setTimeout(()=>{appChrome.api.dispatch(appChrome.actions.setControlCustomTooltip(Bg.a.yEd,this.tooltip))},0);return!0}dispose(){this.$&&this.ha.$w(this.L_b);this.statusBarManager&&(this.statusBarManager.$I(this),this.statusBarManager=null);this.$=null;super.dispose()}CMd(G){return ha.a.instance.ia(2422)+`${G?": "+G:""}`}BMd(){return ha.a.instance.ia(2423)}};dh=Object(oc.__decorate)([Object(Wc.d)(Qc.gc),
Object(oc.__param)(0,Object(Qc.Lb)())],dh);Object(ka.a)(dh,"FilteredResultsStatusBarManager",pa.a,[2,161,162]);var Sf=a(42);class eh{constructor(G){this.$=G}get zod(){return"Excel"}get campaignId(){return"aed9de6b-d4e7-4878-988a-9dfec66fed9e"}get version(){return 1}get currentVersion(){return 0}get Vgj(){return this.isEnabled()&&xb.EwaSettings.Ra(295)}get xnb(){return this.isEnabled()&&xb.EwaSettings.Ra(297)}get tnb(){return xb.EwaSettings.Ra(296)}get Mvi(){return null}get D$f(){return 24}get mGg(){return 4E3}get g4b(){return this.$.ua.WebServiceBase||
""}isEnabled(){if(Za.AFrameworkApplication.fa?Za.AFrameworkApplication.fa.la("IsAnonymousUser"):1)return!1;const G=Za.AFrameworkApplication.Nh?Object(Hc.a)(String,Za.AFrameworkApplication.Nh.AudienceGroup):"";return"Unknown"!==G&&"Automation"!==G}}Object(ka.a)(eh,"FirstRunExperienceLauncherSettings",null,[586]);let Rg=class{constructor(G){this.txf=Sf.a.instance.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher");this.Avi=new eh(G);this.dqe()}dqe(){this.txf&&this.txf.dqe(this.Avi)}};
Rg=Object(oc.__decorate)([Object(Wc.d)(Qc.jc),Object(oc.__param)(0,Object(Qc.Lb)())],Rg);Object(ka.a)(Rg,"FirstRunExperienceManager",null,[560]);var Dg=a(241),Kg=a(1188),Hg=a(13);let fh=class{constructor(G,da){this.kLa=1;this.eta=[];this.active=!1;this.SF=()=>{const $a=this.da.GMd();if(xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8645951_removeShouldWaitForAll")){if(0>=$a||$a===this.kLa)return}else if(0>=$a||$a===this.kLa||this.da.ex)return;let Sb=!1;const Mc=[],sd=[];for(var Od=this.eta.length-
1;0<=Od;Od--){var se=this.eta[Od];if(this.FMd(se)>$a||se.bottom<$a)Mc.push(se),this.eta.splice(Od,1),Sb=!0}for(Od=this.Cj.rangeList.length-1;0<=Od;Od--){se=this.Cj.rangeList[Od];const Ye=this.FMd(se);Ye<=$a&&se.bottom>=$a&&!(Ye<=this.kLa&&se.bottom>=this.kLa)&&se.Swa&&(sd.push(se),Sb=!0)}if(Sb){se=this.da.A0b;for(const Ye of se)for(const hf of Ye)for(const ag of hf)this.HSh(ag,Mc,sd)}else wa.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");
this.kLa=$a};this.rig=($a,Sb)=>{Sb.isRow||Sb.xnd(this.KBc)};this.sig=($a,Sb)=>{Sb.isRow||(this.Cj.rangeList.length||this.deactivate(),Sb.Mge(this.KBc))};this.KBc=($a,Sb)=>{if(this.Hj())this.activate();else if($a=this.active,this.deactivate(),!$a){wa.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlock: detected an opportunity for bailing out");return}(Sb=Sb.dw)&&this.HTg(Sb)};this.ulg=($a,Sb)=>{!this.da.ex&&(this.Hj()?this.activate():($a=this.active,this.deactivate(),$a||
wa.ULS.sendTraceTag(537157651,0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),Sb=Sb.dw)&&($a=Kg.a(Sb.Rwa),this.HTg(Sb)&&Sb.YLg($a))};this.onActiveItemChanged=()=>{this.da.Pg.mz?this.deactivate():this.activate()};this.Cj=G;this.da=da;this.$=da.$;G.jnd(this.ulg);da.Iyh(this.rig);da.Jyh(this.sig);this.$.sa.Qm(this.onActiveItemChanged);this.$.Gh.Qm(this.onActiveItemChanged);this.Q4e($a=>{$a.xnd(this.KBc)});this.Hj()&&(this.activate(),this.SF(this,null))}dispose(){this.deactivate();
this.da&&(this.Cj.Bge(this.ulg),this.da.jjk(this.rig),this.da.kjk(this.sig),this.$.sa.hn(this.onActiveItemChanged),this.$.Gh.hn(this.onActiveItemChanged),this.Q4e(G=>{G.Mge(this.KBc)}));this.da=this.Cj=this.eta=null}D_c(G,da,$a){if(!Lc.b(this.$.na)||this.$.ea.isNamedObjectViewMode||this.da.Pg.j8a)return da&&wa.ULS.sendTraceTag(509166923,0,50,"HeaderSnappingFeature.toggleHeaderSnapping: Header snapping should be disabled in named object view or in top row frozen."),!0;const Sb=$a.fKf();if(xb.EwaSettings.aUd()&&
!Sb)return wa.ULS.sendTraceTag(508368917,0,15,`HeaderSnappingFeature.toggleHeaderSnapping: HeaderNumbers should have been initialized, isActivate=${da}, headerViewBlock.hashCode=${$a.hashCode}`),!1;var Mc=Sb.length;if(Sb[Mc-1]<G.left)return!1;var sd=Hg.HelperMethods.KJ(new Dg.a(Sb),0,Mc,G.left,Hg.HelperMethods.$R);if(0>sd)return!1;const Od=G.rYg,se=G.I6e;Mc=Math.min(Od.length+sd,Mc);let Ye=0;if(!se)return wa.ULS.sendTraceTag(509220160,0,10,"HeaderSnappingFeature.toggleHeaderSnapping: autoFilterDatas should be initialized."),
!1;for(;sd<Mc;sd++){const hf=Sb[sd],ag=se[Ye];da?($a.updateCellText(sd,Od[Ye]),$a.updateCellAlignment(sd,!0),xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8133326_fixAceRegressionInAutoFilterMenu")?ag&&($a.activateCellAutoFilter(sd,ag),this.g_e(G,Ye,hf)):($a.activateCellAutoFilter(sd,ag),this.g_e(G,Ye,hf)),xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8161977_fixHeaderSnappingAutoFilterNone")&&$a.N2g(sd,!0)):($a.updateCellText(sd,ce.Range.OT(hf)),$a.updateCellAlignment(sd,!1),$a.deactivateCellAutoFilter(sd),
xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8161977_fixHeaderSnappingAutoFilterNone")&&$a.N2g(sd,!1),this.xei(hf));da&&$a.FAk();Ye++}$a.fr("HeaderSnappingFeature::toggleHeaderSnapping");G.o7a=da;return!0}g_e(G,da,$a){Qc.db.Ha()?void Wc.a.hj(Qc.db).then(Sb=>{Sb.rib.pig(G,da,$a)}):this.$.ka.Lh(8,Sb=>{Sb.rib.pig(G,da,$a)})}xei(G){Qc.db.Ha()?void Wc.a.hj(Qc.db).then(da=>{da.rib.qig(G)}):this.$.ka.Lh(8,da=>{da.rib.qig(G)})}HSh(G,da,$a){if(G.sPh()){for(var Sb=da.length-1;0<=Sb;Sb--)this.D_c(da[Sb],!1,
G)&&(wa.ULS.sendTraceTag(509166921,0,50,"HeaderSnappingFeature.checkTablesForSnapping: Table deactivation succeeded"),da.splice(Sb,1));for(da=$a.length-1;0<=da;da--)Sb=$a[da],this.D_c(Sb,!0,G)&&(wa.ULS.sendTraceTag(509166919,0,50,"HeaderSnappingFeature.checkTablesForSnapping: Table activation succeeded"),this.eta.push(Sb))}else wa.ULS.sendTraceTag(509166922,0,15,"HeaderSnappingFeature.checkTablesForSnapping: headerViewBlock can't be snapped")}HTg(G){var da=G.fKf();if(xb.EwaSettings.aUd()&&!da)return wa.ULS.sendTraceTag(508368916,
0,15,`HeaderSnappingFeature.snapHeadersAfterGetRange: HeaderNumbers should have been initialized, headerViewBlock.hashCode=${G.hashCode}`),!1;const $a=da[0];da=da[da.length-1];const Sb=this.vXi($a,da);let Mc=!1;for(let sd=this.eta.length-1;0<=sd;sd--){const Od=this.eta[sd];da>=Od.left&&$a<=Od.right&&(this.D_c(Od,!1,G),this.eta.splice(sd,1),Mc=!0)}for(let sd=0,Od=Sb.length;sd<Od;sd++)this.D_c(Sb[sd],!0,G)&&(this.eta.push(Sb[sd]),Mc=!0);return Mc}activate(){this.Hj()&&!this.active&&(this.da.view.Wy(this.SF),
this.active=!0)}deactivate(){this.active&&(this.da.view.Kx(this.SF),this.active=!1)}Hj(){return Lc.b(this.$.na)&&!this.$.ea.isNamedObjectViewMode&&0>=this.da.Pg.qJ&&0<this.Cj.rangeList.length}Q4e(G){const da=this.da.A0b;for(const $a of da)for(const Sb of $a)for(const Mc of Sb)G(Mc)}vXi(G,da){const $a=[];if(!this.active)return $a;this.kLa=this.da.GMd();for(let Sb=this.Cj.rangeList.length-1;0<=Sb;Sb--){const Mc=this.Cj.rangeList[Sb];Mc.bottom>=this.kLa&&this.FMd(Mc)<=this.kLa&&Mc.left>=G&&Mc.right<=
da&&Mc.Swa&&$a.push(Mc)}return $a}FMd(G){const da=this.da.Yg.sl(G);return da&&this.Cj.QWf(G,da.usedRange.topLeft)?G.top+1:G.top}};fh=Object(oc.__decorate)([Object(Wc.d)(Qc.fd),Object(oc.__param)(0,Object(Qc.hg)()),Object(oc.__param)(1,Object(Qc.dd)())],fh);Object(ka.a)(fh,"HeaderSnappingFeature",null,[2]);var Vh=a(143),Yf=a(420),Eg=a(63),hg=a(901);Object(Wc.b)(Qc.pd,{yk:"singleton"})(()=>No(function*(){const G=Sf.a.instance.mo("Common.IInProductMessagingUIManager"),da=()=>{Sf.a.instance.Qi("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute($a=>
{void $a.isFeatureEnabled("MsoPremiumBadge",!0).then(Sb=>{!Sb&&$a.isFreemiumUpsellEnabled()&&G.K_d();return null})})};Eg.a.Al.jw?Vh.a.get_instance().Fm(16,()=>{da()}):da();return G}));class qg extends Yf.a{constructor(G){super();this.vQd=null;this.$=G;this.Bl()}create(){const G=Object(hg.a)(this.$.ka,361,()=>this.a3h());this.Yj(G)}a3h(){this.vQd=Sf.a.instance.mo("Common.IInProductMessagingUIManager");Eg.a.Al.jw?Vh.a.get_instance().Fm(16,()=>{this.cSf()}):this.cSf();return this.vQd}cSf(){Sf.a.instance.Qi("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(G=>
{G.isFeatureEnabled("MsoPremiumBadge",!0).then(da=>{!da&&G.isFreemiumUpsellEnabled()&&this.vQd.K_d();return null})})}static Aa(G){G.ka.ph(362,new qg(G))}}Object(ka.a)(qg,"InProductMessagingManagerFactory",Yf.a,[]);var jh=a(1069),dg=a(254),Wh=a(668);class Ch extends Sys.EventArgs{constructor(){super()}}Object(ka.a)(Ch,"NumberFormatsUpdatedEventArgs",Sys.EventArgs,[]);var Fg=a(58),Qa=a(39),Ma=a(721);class $c{constructor(G){this.data=G}}Object(ka.a)($c,"NumberFormatDataHolder",null,[]);var de;let Be=
de=class extends pa.a{constructor(G){super();this.NZd=Ae.a.kk;this.Urd=null;this.pyb=this.wIc=!1;this.jdg=(da,$a)=>{var Sb;(da=fc.f(this.$))&&($a=null!==(Sb=$a.cell)&&void 0!==Sb?Sb:da.kh(null))&&this.Rqa($a.cell.Vn,!0)};this.LPj=da=>{this.isActive()&&(lb.a.rx(da.Errors)||!da.Result?(da=da.Errors?da.Errors.map($a=>JSON.stringify($a)).join(","):"None",wa.ULS.sendTraceTag(537155726,0,50,`GetCategoryFromServer failed, ignoring - server errors: ${da}`)):(da=da.Result,wa.ULS.sendTraceTag(537155725,0,50,
`Updating number format category cache, format index = ${da.Index}, category = ${da.Category}`),this.KBk(da.Index,da.Category),this.raiseEvent(de.Gsd,new jh.a(da.Index,da.Category),this)))};this.refresh=()=>{wa.ULS.sendTraceTag(537155722,0,50,"InstantaneousSupportInformationManager.Refresh: start refresh");this.Xnc();this.isActive()&&this.ea.th.allowEdits&&(this.pyb||this.Rw&&!(this.ea.pD>this.NZd)?this.R2c():(wa.ULS.sendTraceTag(537155721,0,50,"InstantaneousSupportInformationManager.Refresh: getting instantaneous support information."),
this.cKd=Wh.a(this.$.pa.ta,this.Rw?this.Rw.Digest:"",this.uQj,this.tQj,null,null)),wa.ULS.sendTraceTag(537155720,0,50,"InstantaneousSupportInformationManager.Refresh: getting functions info."),this.oEf())};this.Khg=da=>{wa.ULS.sendTraceTag(537155716,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListFailed failed, status = ${da.data.status}, HTTP status = ${da.data.httpStatus}.`);this.NYa=null};this.a1=()=>{this.pyb=!1;this.ea.TM(this.a1);this.X5a(this.wIc?de.uoe:de.U4d)};this.Oi=(da,$a)=>
{wa.ULS.sendTraceTag(537155715,0,50,"InstantaneousSupportInformationManager.OnSessionIdChanged called");dg.a($a)&&this.X5a(de.uoe)};this.ol=()=>{wa.ULS.sendTraceTag(537155714,0,50,"InstantaneousSupportInformationManager.OnWorkbookMetadataChanged called");3!==this.$.workbookContext.CalcMode&&this.d5d(0===this.$.workbookContext.CalcMode)};this.xj=()=>{wa.ULS.sendTraceTag(537155713,0,50,"InstantaneousSupportInformationManager.OnWorkbookOpened called");this.X5a(de.uoe);3!==this.$.workbookContext.CalcMode&&
this.d5d(0===this.$.workbookContext.CalcMode)};this.lQj=(da,$a,Sb)=>{wa.ULS.sendTraceTag(537155712,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess called.");this.NYa=null;this.isActive()?da.StateId===Ae.a.kk?(wa.ULS.sendTraceTag(537155682,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: no session, waiting for session."),this.R2c()):!da.Result||this.L8&&this.L8.length?this.X5a(de.U4d):this.Mlg(da,$a,Sb):wa.ULS.sendTraceTag(537155683,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: manager is inactive, skipping.")};
this.Mlg=da=>{this.L8=da.Result;wa.ULS.sendTraceTag(537155681,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListSuccess refreshing functions info list, returned ${this.L8?this.L8.length:-1} functions.`);da=!1;if(this.L8){for(const $a of this.L8)$a&&(this.vzf[$a.NameUI.toLocaleUpperCase()]=$a.FunctionIndex.toString(),$a.NameUI!==$a.NameDataStrings&&(this.vzf[$a.NameDataStrings.toLocaleUpperCase()]=$a.FunctionIndex.toString(),da=!0),this.Gyi.ga($a.FunctionIndex,$a.NameUI));this.raiseEvent(de.HGd,
Sys.EventArgs.Empty,this)}da&&wa.ULS.sendTraceTag(537155680,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess NameDataStrings functions names were used.")};this.uQj=da=>{if(this.isActive())if(wa.ULS.shipAssertTag(537155679,0,!!this.$,"null ewaControl"),this.wIc=!1,this.NZd=da.StateId,this.NZd===Ae.a.kk)this.wIc=!0,this.R2c();else{if(da.Result){var $a=this.Rw;this.Rw=da.Result;wa.ULS.sendTraceTag(537155678,0,50,`InstantaneousSupportInformation updated, new result digest: ${this.Rw.Digest}.`);
da=[];if($a)da=de.XNi($a.NumberFormats,this.Rw.NumberFormats);else for($a=0;$a<this.Rw.NumberFormats.length;$a++)this.ULc.ga($a,this.Rw.NumberFormats[$a].NumberFormatCategory);for(const Sb of da)this.ULc.ga(Sb,this.Rw.NumberFormats[Sb].NumberFormatCategory);this.raiseEvent(de.x5d,new Ch(da),this);this.raiseEvent(de.H4f)}this.X5a(de.U4d)}};this.tQj=da=>{this.isActive()&&(10===da.data.status?wa.ULS.sendTraceTag(537155677,0,50,"Instantaneous support information request cancelled."):(wa.ULS.sendTraceTag(21311555,
0,10,`Failed to update instantaneous support information, status = ${da.data.status}, HTTP status = ${da.data.httpStatus}.`),this.wIc=!0,this.R2c()))};wa.ULS.sendTraceTag(537155737,0,50,"InstantaneousSupportInformationManager ctor start");this.ea=G.ea;this.$=G;this.Rw=this.NYa=this.cKd=this.p2b=null;this.ULc=new ve.a;this.kPb=new ve.a;this.L8=[];this.Gyi=new ve.a;this.vzf={};this.ea.uq(this.Oi);this.$.nr(this.xj);fc.f(this.$).ha.eUa(this.jdg);this.ea.Xy(this.ol);this.X5a(de.IQf);wa.ULS.sendTraceTag(537155736,
0,50,"InstantaneousSupportInformationManager ctor end")}Smd(G){this.addHandler(de.x5d,G)}MSc(G){this.removeHandler(de.x5d,G)}Dxh(G){this.addHandler(de.Gsd,G)}nik(G){this.removeHandler(de.Gsd,G)}K0e(G){this.addHandler(de.HGd,G)}dge(G){this.removeHandler(de.HGd,G)}pzh(G){this.addHandler(de.H4f,G)}get hk(){return this.Rw?this.Rw.LocaleInformation:null}get YLa(){return this.Rw?this.Rw.NumberFormats:[]}get $va(){this.L8&&this.L8.length||this.oEf();return this.L8}get tcj(){return this.Rw&&void 0!==this.Rw.InstantaneousCalcWebWorkerPrecisionSamplingRate&&
null!==this.Rw.InstantaneousCalcWebWorkerPrecisionSamplingRate?this.Rw.InstantaneousCalcWebWorkerPrecisionSamplingRate:de.k9h}get wcj(){return this.Rw&&void 0!==this.Rw.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate&&null!==this.Rw.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate?this.Rw.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate:de.o9h}get vcj(){return this.Rw&&void 0!==this.Rw.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate&&null!==this.Rw.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate?
this.Rw.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate:de.n9h}get ucj(){return this.Rw&&void 0!==this.Rw.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate&&null!==this.Rw.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate?this.Rw.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate:de.m9h}get YSb(){return this.Rw?this.Rw.InstantaneousCalcWebWorkerRenderingTimeLimitInMs:de.l9h}get vDc(){return null!==this.Urd?this.Urd:!1}L_k(G){let da;if(!G)return{returnValue:!0,category:"General"};
let $a;da="";if(!(()=>{let Sb=this.Rqa(G,!1);({category:$a}=Sb);return Sb})().returnValue)return{returnValue:!1,category:da};da=this.FZh($a);return{returnValue:!0,category:da}}FZh(G){let da="";switch(G){case 0:da="General";break;case 1:da="Number";break;case 2:da="Currency";break;case 3:da="Accounting";break;case 4:da="Date";break;case 5:da="Time";break;case 6:da="Percentage";break;case 7:da="Fraction";break;case 8:da="Scientific";break;case 9:da="Text";break;case 10:da="Special";break;case 11:da=
"Custom"}return da}Rqa(G,da){let $a,Sb=(()=>{let Mc=this.ULc.gj(G,0);({value:$a}=Mc);return Mc})().returnValue;!Sb&&0<G&&this.$&&(wa.ULS.sendTraceTag(537155735,0,50,`InstantaneousSupportInformationManager.TryGetNumberFormatCategory: failed to get category from numberFormatIndexToCategoryCache ${G}`),this.AEi(G),da&&($a=this.zEi(G),Sb=!0),Ma.a(G,this.$.fL)&&($a=6));return{returnValue:Sb,category:$a}}Uij(G){let da=0;if((()=>{let $a=this.Rqa(G,!0);({category:da}=$a);return $a})().returnValue)return 6===
da;wa.ULS.sendTraceTag(537155733,0,50,`InstantaneousSupportInformationManager.IsFormatInPercentageCategory: failed to get category from format index ${G}`);return!1}dxi(G){this.ea.Ph&&(wa.ULS.sendTraceTag(537155730,0,50,"InstantaneousSupportInformationManager.ForceRefreshFunctionInfo: Forcing refresh of functions"),this.NYa=ec.p(this.$.pa.ta,{FilterType:0},Ac.c(this.Mlg,G),this.Khg,null,null,null))}Byf(){this.X5a(de.IQf)}b2h(){return Object(Rd.c)(this.hk.ErrorNames)?(wa.ULS.shipAssertTag(508699781,
0,!1,"ErrorNames undefined"),this.qHi()):this.hk.ErrorNames.map((G,da)=>excelOnlineCalc.calc.errorTypeName(da+1,G))}qHi(){const G=[],da=Object.keys(Ae.a.errorNames);for(let $a=0;$a<da.length;$a++){const Sb=excelOnlineCalc.calc.errorTypeName($a+1,da[$a]);Sb&&G.push(Sb)}return G}d5d(G){this.Urd=G}AEi(G){if(this.kPb&&this.$){var da;if(!(()=>{let Sb=this.kPb.gj(G);({value:da}=Sb);return Sb})().returnValue||da.isCompleted){wa.ULS.sendTraceTag(537155728,0,50,`Getting number format category for format index: ${G}`);
var $a=Wh.c(this.$.pa.ta,G,this.LPj,null,null,null);$a&&this.kPb.ga(G,$a)}}else wa.ULS.sendTraceTag(537155729,0,15,"GetCategoryFromServerAsync called on disposed InstantaneousSupportInformationManager instance, skipping")}zEi(G){return 1<=G&&8>=G?1:9<=G&&12>=G?2:13===G||14===G?6:15===G?8:17===G|18===G?7:19===G?4:16===G||20<=G&&29>=G||31===G?11:30===G?9:32<=G&&35>=G?3:0}isActive(){const G=void 0===this.ea||null===this.ea,da=!G&&this.ea.Ph;wa.ULS.sendTraceTag(537155727,0,50,`InstantaneousSupportInformationManager.IsActive: instantaneous support information manager active:${da} - sessionStateManager IsNullOrUndefined: ${G}`);
return da}KBk(G,da){this.ULc.ga(G,da)}dispose(){Ia.a.Ng(this.p2b);this.p2b=null;this.Xnc();for(const G of this.kPb){const da=G.value;da&&!da.isCompleted&&Za.AFrameworkApplication.$i.HD(da.TC)}this.kPb=null;this.ea&&(this.ea.pq(this.Oi),this.pyb&&this.ea.TM(this.a1),this.pyb=!1,this.ea.pA(this.ol));this.ea=null;this.$&&fc.f(this.$)&&fc.f(this.$).ha&&(fc.f(this.$).ha.CNa(this.jdg),this.$.Pr(this.xj));this.$=null;super.dispose()}isFeatureEnabled(G){try{switch(G){case "LocaleLongDateFormat":return xb.EwaSettings.Ra(184);
case "GetLocaleDayNames":return xb.EwaSettings.Ra(185);case "OfficeVSO:3657744_CalcFixForDateFormat":return xb.EwaSettings.isChangeGateEnabled("OfficeVSO:3657744_CalcFixForDateFormat");case "OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero":return xb.EwaSettings.isChangeGateEnabled("OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero");case "CalcAutocompleteExperiment":return xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1);
case "CalcWebWorker":return!0;case "CalcPreventSpillingHack":return xb.EwaSettings.isChangeGateEnabled("OfficeVSO:7504597_calcPreventSpillingHack");case "CalcDynamicArrayOperators":return xb.EwaSettings.Ra(101);default:return G.startsWith("OfficeVSO:")?xb.EwaSettings.isChangeGateEnabled(G):!1}}catch(da){return wa.ULS.sendTraceTag(537155724,0,15,`InstantaneousSupportInformation.IsFeatureEnabled(${G}): feature parsing failed, returning false. Exception: ${da.toString()}.`),!1}}X5a(G){this.isActive()&&
this.ea.th.allowEdits?(Ia.a.Ng(this.p2b),this.p2b=null,this.p2b=Fg.a.instance.create(this.refresh,G,Mb.a.xcj)):wa.ULS.sendTraceTag(537155723,0,50,`InstantaneousSupportInformationManager.ScheduleRefresh: won't schedule refresh. Edit permission: AllowEdits ${void 0!==this.ea&&null!==this.ea&&void 0!==this.ea.th&&null!==this.ea.th?this.ea.th.allowEdits:!1}, IsEditMode ${void 0===this.ea||null===this.ea?!1:this.$.ea.isEditMode}`)}oEf(){wa.ULS.sendTraceTag(537155719,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync called.");
this.NYa?wa.ULS.sendTraceTag(537155718,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync already running, skipping."):this.isActive()?this.L8&&this.L8.length||(this.NYa=ec.p(this.$.pa.ta,{FilterType:0},this.lQj,this.Khg,null,null,null)):wa.ULS.sendTraceTag(537155717,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync session is not yet active, skipping.")}R2c(){this.pyb||(this.pyb=!0,this.ea.EL(this.a1))}Xnc(){this.HD(this.cKd);this.HD(this.NYa);this.NYa=this.cKd=null}HD(G){G&&
!G.isCompleted&&this.$.pa.ta.uxb(G.TC)}static XNi(G,da){if(!G||!G.length)return[];if(!da||!da.length){var $a=Array(G.length);for(var Sb=0;Sb<G.length;++Sb)$a[Sb]=G[Sb].IfmtIndex;return $a}$a=new ve.a;for(var Mc of G)$a.ga(Mc.IfmtIndex,new $c(Mc));G=new Wb.a;for(Sb of da)Mc=$a.gj(Sb.IfmtIndex),{value:da}=Mc,Mc.returnValue&&da.data.FormatString===Sb.FormatString||G.add(Sb.IfmtIndex);return G.toArray()}};Be.x5d="isim0";Be.Gsd="isim1";Be.HGd="isim2";Be.H4f="isim3";Be.IQf=100;Be.uoe=1E3;Be.U4d=3E5;Be.k9h=
.001;Be.o9h=.1;Be.n9h=.2;Be.m9h=.001;Be.l9h=50;Be=de=Object(oc.__decorate)([Object(Wc.d)(Qc.wd),Object(oc.__param)(0,Object(Qc.Lb)())],Be);Object(ka.a)(Be,"InstantaneousSupportInformationManager",pa.a,[559,2]);var nf;let Tf=nf=class{constructor(G,da){this.fWd=!1;this.ol=()=>{this.UZg()};this.$=G;this.$.ea.vob&&!nf.DRb&&(da&&!da.Yvb||this.n$k(),nf.sNf?wa.ULS.sendTraceTag(537155461,0,50,"LineageTeachingCalloutTriggerManager will not trigger WYWA waterline check as it was already checked in session"):
da&&!da.Yvb||this.v$k());wa.ULS.sendTraceTag(537155460,0,50,"LineageTeachingCalloutTriggerManager is initialized.")}dispose(){this.xfe();this.$=null;wa.ULS.sendTraceTag(537155459,0,50,"LineageTeachingCalloutTriggerManager is disposed.")}disable(){nf.DRb||(nf.DRb=!0,wa.ULS.sendTraceTag(578557781,0,50,"LineageTeachingCalloutTriggerManager.Disable as the pane was opened."));this.xfe()}v$k(){this.$.isAnonymousUser()||ec.j(this.$.pa.ta,G=>{this.$?(G=G.Result,wa.ULS.sendTraceTag(578557780,0,50,`CheckLineageWywaChanges service call succeeded, hasnewchanges = ${G}.`),
nf.sNf=!0,G&&this.zZg(0)):wa.ULS.sendTraceTag(537155458,0,50,"LineageTeachingCalloutTriggerManager.VerifyWaterlineTrigger ignoring server response as class is disposed.")},()=>{wa.ULS.sendTraceTag(537155457,0,10,"CheckLineageWywaChanges service call failed.")},null,null)}n$k(){this.UZg()||(this.$.ea.Xy(this.ol),this.fWd=!0)}UZg(){return this.$.ea&&this.$.ea.Cq&&this.$.ea.Cq.ShouldTriggerLineageCalloutOnMerge?(wa.ULS.sendTraceTag(578557778,0,50,"LineageTeachingCalloutTriggerManager.TriggerLineageCalloutOnMerge"),
this.zZg(1),!0):!1}zZg(G){nf.DRb?wa.ULS.sendTraceTag(537155456,0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout Will not trigger dialog as it was already shown in session"):(nf.DRb=!0,wa.ULS.sendTraceTag(578557776,0,50,`LineageTeachingCalloutTriggerManager.TriggerCallout triggering callout due to reason ${G}.`),this.xfe(),xb.EwaSettings.Ra(418)&&(G=new Tc.a(-847286761,Bd.a.eh,this.$.Rh,0,vc.a.b7),this.$.Ma.dh(G,{["CalloutName"]:4})))}xfe(){this.fWd&&(this.fWd=!1,this.$.ea.pA(this.ol))}};
Tf.DRb=!1;Tf.sNf=!1;Tf=nf=Object(oc.__decorate)([Object(Wc.d)(Qc.Gd),Object(oc.__param)(0,Object(Qc.Lb)()),Object(oc.__param)(1,Object(Nc.j)())],Tf);Object(ka.a)(Tf,"LineageTeachingCalloutTriggerManager",null,[557,2]);let Xf=class{constructor(G){this.W7d=da=>{this.LDg(da.detail.viewportScenarioContext,"eventHandler")};G.j_e(this.W7d,(new AbortController).signal)}LDg(G,da){try{wa.ULS.sendTraceTag(1851881062,1,15,`NavigationFailHandler.onNavigationFailed: from ${da}, context = ${this.Qhf(G)}`)}catch($a){wa.ULS.sendTraceTag(507590041,
1,15,`NavigationFailHandler.onNavigationFailed: from ${da}, exception = ${$a.message}`)}}Qhf(G){const da=G.targetRange;return JSON.stringify({name:G.name,targetRange:null===da||void 0===da?void 0:da.toString(),requiredViewportStateIdStateId:G.J3b})}};Xf=Object(oc.__decorate)([Object(Wc.d)(Qc.Sd),Object(oc.__param)(0,Object(Qc.Cg)())],Xf);Object(ka.a)(Xf,"NavigationFailHandler",null,[]);class zg{}zg.Vuj=3;zg.connected=0;Object(ka.a)(zg,"ConnectionStateConstants",null,[]);class $f{constructor(G,da,
$a){var Sb;this.type=0;this.startTime=null;this.blockedOperationsCount=this.durationMs=0;this.blockedActions=null;this.blockedUserOperationsWhileToastShown=this.durationUntilToastShownMs=0;this.toastRaiser=null;this.wasUserActiveOnPIEnd=this.wasUserActiveOnPIStart=this.hasTabbedOut=this.isToastShown=!1;this.durationUntilUserInactive=-1;this.isTaskPaneCollapsed=this.isTaskPaneShown=this.isDialogShown=!1;this.feg=(sd,Od)=>{this.blockedOperationsCount++;sd=`${Od.componentName}_${Od.actionName}_${Od.details})`;
this.blockedActions[sd]=this.blockedActions[sd]?this.blockedActions[sd]+1:1;this.isToastShown&&this.blockedUserOperationsWhileToastShown++};this.f9d=sd=>{this.durationUntilUserInactive=sc.getElapsedSeconds(this.startTime,wd.a.Tg.Wh);sd.Nge(this.f9d)};this.mP=()=>{this.hasTabbedOut=!0};this.Poa=(sd,Od)=>{Od.Jqg!==this.type||this.isToastShown||(this.durationUntilToastShownMs=xd.a(wd.a.Tg,this.startTime),this.toastRaiser=Od.toastRaiser,this.isToastShown=!0)};this.startTime=G;this.durationUntilToastShownMs=
0;this.blockedActions={};this.isToastShown=$a;if(null===(Sb=da.ea)||void 0===Sb?0:Sb.ql)this.wasUserActiveOnPIStart=da.ea.ql.Yu;this.fq(da);this.isDialogShown=0<da.ih.h1;let Mc=null;Fd.a.ut()?void Wc.a.resolve(Qc.We,{va:1}).then(sd=>{Mc=sd}):Mc=da.ka.Ug(183);this.isTaskPaneShown=!!Mc&&Mc.isVisible&&!Mc.isCollapsed;this.isTaskPaneCollapsed=!!Mc&&Mc.isVisible&&Mc.isCollapsed}vLg(){this.durationMs=xd.a(wd.a.Tg,this.startTime)}g8d(G){var da;this.vLg();ua.a(G).f3b(this.feg);ua.a(G).Bm.TSc(this.Poa);xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",
!1)?void Wc.a.resolve(Qc.Ab).then($a=>{$a.p5a(this.mP)}):G.ka.Lh(291,$a=>{$a.p5a(this.mP)});if(null===(da=G.ea)||void 0===da?0:da.ql)G.ea.ql.Nge(this.f9d),this.wasUserActiveOnPIEnd=G.ea.ql.Yu}fq(G){ua.a(G).Fkc(this.feg);this.isToastShown?this.toastRaiser="Immediate":ua.a(G).Bm.bnd(this.Poa);xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void Wc.a.resolve(Qc.Ab).then(da=>{this.hasTabbedOut=da.tn;da.t9(this.mP)}):G.ka.Lh(291,da=>{this.hasTabbedOut=
da.tn;da.t9(this.mP)});this.wasUserActiveOnPIStart&&G.ea.ql.F1e(this.f9d)}}Object(ka.a)($f,"PartialInteractivityData",null,[]);var Ng=a(1193);class pg extends $f{constructor(G,da,$a,Sb,Mc,sd){super(G,da,Sb);this.swappedOffline=this.swappedByOffline=!1;this.lastFailedRequestToOnlineTimeGapSec=this.longestDurationBetweenFailedRequestsSec=this.averageDurationBetweenFailedRequestsSec=0;this.errorDataDuringConnectivityIssuesMode=this.disconnectionSource=null;this.failedRequests=[];this.triggeringRequest=
null;this.type=4;this.swappedOffline=$a;this.disconnectionSource=Enum.toString(Ng.a,Mc);this.triggeringRequest=sd}vMj(G,da){this.swappedByOffline=da;this.g8d(G)}Qzk(G){this.errorDataDuringConnectivityIssuesMode=G}vck(G){10>this.failedRequests.length&&(G=G+"_"+sc.getElapsedSeconds(this.startTime,wd.a.Tg.Wh).toString(),this.failedRequests.push(G))}}Object(ka.a)(pg,"ConnectivityIssuesData",$f,[]);var Ug=a(169),Og=a(141),bh=a(140);class mh{}mh.Kei="DuringWork";mh.connectivityIssues="ConnectivityIssues";
mh.offline="Offline";Object(ka.a)(mh,"UnavailabilityTypes",null,[]);var Tg=a(61);class Vg{constructor(G){this.sIc=this.data=null;this.bEd=0;this.Nef=null;this.wfg=(da,$a)=>{$a.tT?(this.data=new pg(wd.a.Tg.Wh,this.$,5===$a.Gqa,0!==$a.Gqa,this.$.Ql.disconnectionSource,this.Nef),this.sIc=this.$.Ql.W2f,this.bEd=1,this.$.pa.Ql.pBh(this.Ay),Ug.a(this.$).vmd(this.KHg)):(this.data.vMj(this.$,5===$a.Gqa),this.$.pa.Ql.HCg(this.Ay),this.data.lastFailedRequestToOnlineTimeGapSec=sc.getElapsedSeconds(this.sIc,
wd.a.Tg.Wh),xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_7pzab_ConnectivityIssues")?Tg.b().c5b(557682689,0,50,mh.connectivityIssues,this.data.durationMs,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",Nd.a.li(this.data)):wa.ULS.sendTraceTag(557682689,0,50,`ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: ${Nd.a.li(this.data)}`),this.data&&this.data.isToastShown&&
nb.Health.instance.recordQosError(Og.a.eUh,[bh.a.kJc],!0,!1,!1,!1,null),Ug.a(this.$).Xfe(this.KHg),this.data=null)};this.KHg=(da,$a)=>{this.data.Qzk($a.wO)};this.Ay=(da,$a)=>{this.data.vck($a.context.methodName);da=wd.a.Tg.Wh;$a=sc.getElapsedSeconds(this.sIc,da);this.sIc=da;$a>this.data.longestDurationBetweenFailedRequestsSec&&(this.data.longestDurationBetweenFailedRequestsSec=$a);this.bEd++;this.data.averageDurationBetweenFailedRequestsSec=this.eOh($a)};this.tfg=(da,$a)=>{this.Nef=$a.VZk};this.$=
G;ua.a(this.$).Bm.v0e(this.wfg);this.$.Ql.u0e(this.tfg)}dispose(){this.$&&(ua.a(this.$).Bm.FBg(this.wfg),this.$.Ql&&this.$.Ql.EBg(this.tfg));this.data&&this.$.pa.Ql.HCg(this.Ay);this.$=null}eOh(G){const da=this.bEd-1;return(this.data.averageDurationBetweenFailedRequestsSec*(da-1)+G)/da}}Object(ka.a)(Vg,"ConnectivityIssuesTelemetryManager",null,[2]);var nh=a(1375),wh=a(1192),oh=a(1191);class gh{constructor(G){this.AGg=null;this.tZd=this.o3d=this.xZb=this.yZb=0;this.hpe=!1;this.hvd=this.m7a=this.oYc=
this.Ipb=null;this.tvd=0;this.Rvk=()=>{if(12E4>this.$.ea.ql.Rwb)for(const da of this.oYc)da.runTest();else this.bse("UserInactive")};this.Fnk=da=>{da=Sys.Serialization.JavaScriptSerializer.serialize(da);wa.ULS.sendTraceTag(388821830,0,50,da)};this.Qmk=da=>{if(da){var $a=this.hvd[da.testIteration.toString()];$a?$a.push(da):($a=[da],this.hvd[da.testIteration.toString()]=$a);if($a.length===this.AGg.length){$a=Sys.Serialization.JavaScriptSerializer.serialize($a);if(this.$&&this.$.Ql){if(da.EstimatedLatency=
this.$.Ql.Q6e,this.$.Ql.Q6e>this.$.lI.ExcelRountripThresholdMs){wa.ULS.sendTraceTag(570712144,0,50,`Periodic ping tests results when network is slow: ${$a}, consequtive slow ping iteration #: ${this.tvd++}`);return}}else wa.ULS.sendTraceTag(537155209,0,50,"EwaControl/ConnectivityObserver is null when conducting slow connection speed tests");wa.ULS.sendTraceTag(570712142,0,50,`Periodic ping tests results: ${$a}`);this.tvd=1}}};this.Yo=(da,$a)=>{da=$a.context.methodName;if(da===Ae.a.yQb||da===Ae.a.hJa)this.xZb++,
da=Date.now(),this.eIk(da)&&(this.xZb=0,this.tZd=da,this.tRk())};this.Ooa=()=>{this.Gre("OnThrottledUserActivity")};this.mP=()=>{this.bse("OnDocumentHidden")};this.VI=()=>{this.Gre("OnDocumentUnhidden")};this.$=G;if(this.ipe=this.xSh())this.AGg=[oh.a.r3c],this.tvd=1,this.hvd={},this.$.ea.ql.jFa(this.Ooa),xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void Wc.a.resolve(Qc.Ab).then(da=>{da.t9(this.mP);da.t3(this.VI)}):this.$.ka.Lh(291,da=>
{da.t9(this.mP);da.t3(this.VI)})}dispose(){this.$&&(this.hpe&&this.$.pa&&0<this.Ipb.count&&this.$.pa.MK(this.Yo),this.ipe&&(this.bse("Dispose"),this.$.ea.ql.HNa(this.Ooa)))}Z8i(){xb.EwaSettings.Ra(199)&&this.L5j();this.ipe&&this.M5j()}B9i(){this.xZb=this.yZb;this.tZd=0;var G={};if(!this.Ipb){this.Ipb=new Wb.a;const da=wh.a.ZGd(this.Fnk,"InitSampleMeasurement",this.$);for(const $a of da)G[$a.EPd]=$a.baseUrl,this.Ipb.add($a)}G=Sys.Serialization.JavaScriptSerializer.serialize(G);wa.ULS.sendTraceTag(537155210,
0,50,`Init Network measurement: numberOfRequestToWaitPerNetworkMeasurement: ${this.yZb}, numberOfRequestFromTheLastNetworkMeasurement: ${this.xZb}, testParams: ${G} `);0<this.Ipb.count&&this.$.pa.iI(this.Yo)}tRk(){for(const G of this.Ipb)G.runTest()}Gre(G){this.m7a&&this.m7a.wt||(wa.ULS.sendTraceTag(537155208,0,50,`NetworkMeasurement.StartConnectionSpeedTest: starting ping tests. caller: ${G}`),this.m7a=Fg.a.instance.jO(this.Rvk,5E3,Mb.a.nPk),this.m7a.E5())}bse(G){this.m7a&&this.m7a.wt&&(wa.ULS.sendTraceTag(537155207,
0,50,`NetworkMeasurement.StopConnectionSpeedTest: stopping ping tests. caller: ${G}`),this.m7a.cancel())}eIk(G){return this.xZb>=this.yZb&&G-this.tZd>this.o3d}xSh(){return gh.oGg(this.$.ua.SlowNetworkMeasurementsSamplePercentage)}L5j(){this.yZb=this.$.ua.NumberOfRequestToWaitPerNetworkMeasurement;this.o3d=1E3*this.$.ua.MinTimeBetweenNetworkMeasurementInSec;const G=this.$.ua.NetworkMeasurementsSamplePercentage;0<this.yZb&&0<this.o3d&&(this.hpe=gh.oGg(G))&&this.B9i()}M5j(){if(!this.oYc){this.oYc=new Wb.a;
const G=wh.a.ZGd(this.Qmk,"PrepareAndInitSlowNetworkTests.ConnectionSpeedTest",this.$,[oh.a.r3c]);for(const da of G)this.oYc.add(da);this.$.ea.ql.Yu&&this.Gre("PrepareAndInitSlowNetworkTests")}}static oGg(G){return 100*Math.random()<G}}Object(ka.a)(gh,"NetworkMeasurement",null,[2]);var lh=a(40),Sh=a(155),ih=a(1016);class di{constructor(G){this._count=0;this.sessionID=this.allOfflinePartialInteractivitiesDataInSession=null;this.allOfflinePartialInteractivitiesDataInSession=[];this.sessionID=G}get count(){return this._count}get h4(){return this.allOfflinePartialInteractivitiesDataInSession[this.allOfflinePartialInteractivitiesDataInSession.length-
1]}I3k(){this.h4&&this.h4.vLg()}rvh(G){this.allOfflinePartialInteractivitiesDataInSession.push(G);this._count++}}Object(ka.a)(di,"OfflinePartialInteractivitiesDataForLog",null,[]);class Ra extends $f{constructor(G,da,$a){super(G,da,$a);this.timeFromLastOffline=0;this._errorDataDuringOfflineMode=null;this.timeFromLastOffline=-1;this.type=5}IDk(G){this.timeFromLastOffline=G}Rzk(G){this._errorDataDuringOfflineMode=G}}Object(ka.a)(Ra,"OfflinePartialInteractivityData",$f,[]);class Tb{constructor(G,da){this.O2a=
this.h4=null;this.Bbe=-1;this.sOb=null;this.Q2f=gf.Task.delay(0);this.Dqb=($a,Sb)=>{Sb.tT?this.hUj(Sb.Gqa):this.iUj()};this.Poa=($a,Sb)=>{5===Sb.Jqg&&this.Bib()};this.LHg=($a,Sb)=>{this.h4.Rzk(Sb.wO)};this.Bib=()=>{this.O2a.I3k();this.etk(Tb.t$d,Sys.Serialization.JavaScriptSerializer.serialize(this.O2a))};this.snk=$a=>{if($a=$a.result)this.p6g=!0,wa.ULS.sendTraceTag(576811915,0,50,`OfflineModeTelemetryManager.ReportOfflinePartialInteractivityDataFromIDB: Previous session's offline partial interactivy data: ${$a}`)};
this.Dgk=()=>{this.p6g&&(this.$?lh.TaskExtensions.Ua(this.indexedDB.bzd(Tb.t$d),()=>{wa.ULS.sendTraceTag(537155204,0,50,"OfflineModeTelemetryManager.RemoveDataFromIDB: Previous session's offline partial interactivy data successfuly removed from IDB.")},this.$.xa):wa.ULS.sendTraceTag(537155203,0,10,"OfflineModeTelemetryManager.RemoveDataFromIDB: EwaControl is null when attempting to remove offline mode data stored in IDB."))};this.S2a=()=>{if(this.O2a&&0<this.O2a.count){const $a=Sys.Serialization.JavaScriptSerializer.serialize(this.O2a);
wa.ULS.sendTraceTag(560791644,0,50,`OfflineModeTelemetryManager.OnBeforeUnload: This session's offline partial interactivy data: ${$a}`)}};this.$=G;this.indexedDB=da;this.p6g=!1;this.indexedDB.jl()&&(this.indexedDB.initialize(Tb.rlb,Tb.slb),this.Kmk(),this.O2a=new di(this.$.ua.UserSessionId),ua.a(this.$).Bm.Tmd(this.Dqb));this.Ht=Sh.a.instance.WT();this.Ht.Aa("beforeunload",this.S2a)}dispose(){this.$&&ua.a(this.$)&&ua.a(this.$).Bm.sge(this.Dqb);Ia.a.Ng(this.sOb);this.$=this.sOb=null}hUj(G){this.h4=
new Ra(wd.a.Tg.Wh,this.$,0!==G);this.h4.IDk(-1!==this.Bbe?window.performance.now()-this.Bbe:-1);this.O2a.rvh(this.h4);ua.a(this.$).Bm.bnd(this.Poa);this.Bib();this.sOb=Fg.a.instance.jO(this.Bib,Tb.lwi,Mb.a.Bib);Ug.a(this.$).vmd(this.LHg)}iUj(){this.h4.g8d(this.$);this.Bib();Ia.a.Ng(this.sOb);this.sOb=null;this.Bbe=window.performance.now();ua.a(this.$).Bm.TSc(this.Poa);Ug.a(this.$).Xfe(this.LHg);this.Rmk()}etk(G,da){this.$?this.Q2f=lh.TaskExtensions.Ua(this.Q2f,()=>{this.indexedDB.W5a(new ih.a(G,da))},
this.$.xa):wa.ULS.sendTraceTag(537155205,0,15,"OfflineModeTelemetryManager.SaveToIndexedDBSequential: EwaControl is null when attempting to write to IDB")}Kmk(){const G=this.$.xa;lh.TaskExtensions.Ua(lh.TaskExtensions.Ua(this.indexedDB.MYa(Tb.t$d),this.snk,G),this.Dgk,G)}Rmk(){if(this.h4){const G=Sys.Serialization.JavaScriptSerializer.serialize(this.h4);xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_71qb3_Offline")?Tg.b().c5b(560791645,0,50,mh.offline,this.h4.durationMs,
"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",G):wa.ULS.sendTraceTag(560791645,0,50,`OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: ${G}`)}this.h4&&this.h4.isToastShown&&nb.Health.instance.recordQosError(Og.a.p8k,[bh.a.kJc],!0,!1,!1,!1,null)}}Tb.rlb="NetworkAvailability";Tb.slb="NetworkAvailabilityData";Tb.t$d="partialInteractivityData";Tb.lwi=3E3;Object(ka.a)(Tb,
"OfflineModeTelemetryManager",null,[2]);var Dc=a(1391);const Yc=G=>{G.isSuccess||(G=Sys.Serialization.JavaScriptSerializer.serialize(G),wa.ULS.sendTraceTag(509669840,0,10,G))};class Ad{constructor(G,da){this.Lya=this.t4d=this.bdg=null;this.$=G;xb.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&wf.a.hm||(this.bdg=new Tb(G,da));xb.EwaSettings.Ra(199)&&(this.t4d=new gh(this.$),this.t4d.Z8i());xb.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&
wf.a.hm||(this.Lya=new nh.NetworkConnectionHealthChecker(this.$));this.$Xh=new Vg(this.$);xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.1CdnDarkTestEnabled",!1)&&(G=this.$,da=xb.EwaSettings.getStringFeatureGate("Microsoft.Office.Excel.1CdnDarkTestTargetUrl",""),""!==da&&(new Dc.a(G,"1CDN",da,Yc,"runOneCdnNetworkTest")).runTest())}dispose(){Ia.a.Ng(this.bdg);Ia.a.Ng(this.t4d);Ia.a.Ng(this.Lya);Ia.a.Ng(this.$Xh);this.$=null}}Object(ka.a)(Ad,"NetworkConnectionTelemetryManager",null,[2]);
class he extends $f{constructor(G,da,$a,Sb){super(G,da,$a);this.wasInteruptedByOfflineMode=!1;this.type=Sb;this.wasInteruptedByOfflineMode=!1}Dqb(){this.wasInteruptedByOfflineMode=!0}}Object(ka.a)(he,"SilentReopenData",$f,[]);class re{constructor(G){this.yia=null;this.zng=(da,$a)=>{this.xng($a,3)};this.Ejg=(da,$a)=>{this.xng($a,2)};this.$=G;this.Bm=ua.a(this.$).Bm;this.Bm.V0e(this.Ejg);this.Bm.SAh(this.zng)}dispose(){this.Bm.cCg(this.Ejg);this.Bm.dlk(this.zng);this.yia=this.Bm=this.$=null}xng(G,da){G.tT?
this.yia=new he(wd.a.Tg.Wh,this.$,0!==G.Gqa,da):(5===G.Gqa&&(this.yia.wasInteruptedByOfflineMode=!0),3!==G.Gqa&&2!==G.Gqa||wa.ULS.sendTraceTag(537155202,0,10,"SilentReopenPartialInteractivityTelemetryManager.OnSilentReopen: BackToWork/DuringWork partial interactivity has been swapped to DuringWork/BackToWork."),this.yia.g8d(this.$),2===da?xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_8dtae_B2W")?Tg.b().d5b(571289604,0,50,mh.offline,this.yia.durationMs,this.yia):wa.ULS.sendTraceTag(571289604,
0,50,Nd.a.li(this.yia)):xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_6w9lg_DuringWork")?Tg.b().d5b(542782150,0,50,mh.Kei,this.yia.durationMs,this.yia):wa.ULS.sendTraceTag(542782150,0,50,Nd.a.li(this.yia)),this.yia=null)}}Object(ka.a)(re,"SilentReopenPartialInteractivityTelemetryManager",null,[2]);let Me=class extends pa.a{constructor(G,da,$a){$a=void 0===$a?!0:$a;super();this.$ba=this.Opc=this.P2a=this.YAa=this.f7a=null;this.cbg=0;this.XRc=this.Wsb=this.Xsb=!1;this.ebg=
this.documentVisibilityObserver=null;this.yDa=!1;this.wQd=this.Hia=0;this.sVb=!1;this.YSg=0;this.Yoe=!1;this.lca=null;this.qkg=()=>{wa.ULS.sendTraceTag(537155219,0,50,"NetworkConnectionStateManager.OnNetworkDownEvent: Network down.");this.eLc(1,!1)};this.VI=()=>{this.xxa||this.OXb?window.setTimeout(()=>{this.vue()},this.cbg):this.vue();this.documentVisibilityObserver.FNa(this.VI);this.sVb=!1};this.yl=()=>{wa.ULS.sendTraceTag(537155218,0,50,`NetworkConnectionStateManager.OnEditEnded: Edit ended. IsInOfflineMode:${this.OXb}, IsInDuringWorkSilentReopenMode:${this.ZJc&&
!this.yDa}`);this.OXb&&this.xYe();this.ZJc&&!this.yDa&&this.sYe();fc.f(this.$).cellTextEditBox.Zw(this.yl);this.Xsb=this.Wsb=!1};this.skg=()=>{wa.ULS.sendTraceTag(537155213,0,50,"NetworkConnectionStateManager.OnNetworkResumedEvent: network was resumed.");this.eLc(1,!0);this.Wsb&&!this.Xsb&&fc.f(this.$).cellTextEditBox.Zw(this.yl);this.Wsb=!1};this.Ooa=(Sb,Mc)=>{this.wQd=this.Hia;this.Hia=Mc.r_c};this.yng=()=>{this.$&&(this.XRc||(Yb.a(this.$).d5(Ka.a.GMa).oyh(this.Dkg),this.$.nr(this.xj),this.XRc=
!0),this.yDa=this.Mej(),this.eLc(2,!1))};this.Dkg=()=>{var Sb=Yb.a(this.$).Dp;const Mc=Sb.lFh();Sb=Sb.EB.ij.errors.map(sd=>sd.MessageIdName);wa.ULS.sendTraceTag(545842889,0,50,`NetworkConnectionStateManager.OnOpenWebMethodErrorUserAlertExecuting: IsStateUnrecoverable:${Mc}, IsB2W:${this.yDa}, Errors: ${Nd.a.li(Sb)}`);Mc&&(this.f7a?(this.yDa=!1,this.bkf(),this.B0c()):this.YAa&&(this.ckf(),this.B0c()))};this.xj=()=>{this.$?(wa.ULS.sendTraceTag(541193955,0,50,"NetworkConnectionStateManager.OnWorkbookOpened: Workbook opened."),
this.yDa=!1,this.$ba&&this.$ba.wt&&(Ia.a.Ng(this.$ba),this.$ba=null),this.lca&&this.lca.wt&&(Ia.a.Ng(this.lca),this.lca=null),this.eLc(2,!0),this.B0c()):wa.ULS.sendTraceTag(537155212,0,10,"NetworkConnectionStateManager.OnWorkbookOpened: bug monitoring: EwaControl is null.")};this.ufg=()=>{this.N$f(!0)};this.vfg=()=>{this.N$f(!1)};this.phc=zg.Vuj;this.ovd=zg.connected;this.$=G;this.Ql=G.pa.Ql;$a&&(this.ebg=new Ad(G,da));xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",
!1)?void Wc.a.resolve(Qc.Ab).then(Sb=>{this.documentVisibilityObserver=Sb}):this.$.ka.Lh(291,Sb=>{this.documentVisibilityObserver=Sb});this.cbg=this.$.ua.ExcelNetworkCheckAfterTabActivationDelayMs;this.Ql.a1e(this.qkg);this.Ql.gGb(this.skg);this.Ql.u0e(this.ufg);this.Ql.Uxh(this.vfg);new re(this.$,this);this.Z6f=this.$.ua.LongInactivityTimePeriodSeconds;this.$.ea.qGb(this.yng);this.$.ea.ql.jFa(this.Ooa);this.YSg=this.$.ua.SilentReopenDuringWorkDelayMs}get thj(){return this.yDa}get OXb(){return!(this.phc&
1)}get ZJc(){return!(this.phc&2)}get xxa(){return!!(this.ovd&2)}dispose(){this.Ql&&(this.Ql.hCg(this.qkg),this.Ql.e3b(this.skg),this.Ql.EBg(this.ufg),this.Ql.Cik(this.vfg));this.sVb&&this.documentVisibilityObserver&&(this.documentVisibilityObserver.FNa(this.VI),this.sVb=!1);this.$&&(this.XRc&&this.B0c(),this.$.ea&&(this.$.ea.XSc(this.yng),this.$.ea.ql&&this.$.ea.ql.HNa(this.Ooa)));this.lca&&(this.lca.dispose(),this.lca=null);Ia.a.Ng(this.ebg);this.$=null;super.dispose()}XBj(){this.Yoe=!0}sYe(){this.YAa||
(this.YAa=ua.a(this.$).Bm.VEa(3,"NetworkConnectionStateManager.ActivateDuringWorkSilentReopenPartialInteractivity"))}Mej(){if(this.Yoe)return this.Yoe=!1,!0;const G=this.Hia>this.Z6f||this.wQd>this.Z6f&&10>this.Hia;wa.ULS.sendTraceTag(537155223,0,50,`NetworkConnectionStateManager.IsBackToWorkSilentReopen: Inactivity duration: Time from last activity:${this.Hia}, Time gap between last two activities: ${this.wQd}. return value:${G}`);return G}Hnk(){this.lca=Fg.a.instance.create(()=>{nb.Health.instance.recordQosError(Og.a.sPk,
[bh.a.kJc],!0,!0,!1,!1,null)},6E3,"ReportLongSilentReopenBackToWorkVeto",void 0,!0)}Dsh(){this.YAa||this.$ba?wa.ULS.sendTraceTag(542782155,0,10,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Trying to activate during-work partial interactivity when we are already in this partial interactivity or there is a running timer that's going to do it soon."):this.$ba=Fg.a.instance.create(()=>{this.$?this.YAa?wa.ULS.sendTraceTag(537155221,0,15,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Tried to activate SilentReopenDuringWork PI when there is already an DuringWorkSilentReopen partial interactivity object"):
fc.f(this.$).isEditing?(this.Wsb||(fc.f(this.$).cellTextEditBox.Wx(this.yl),wa.ULS.sendTraceTag(541893722,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Registered OnEditEnded while during-work silent reopen")),this.Xsb=!0,wa.ULS.sendTraceTag(537155220,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Need to init during-work silent reopen partial interactivity but the user is during a cell edit. Registered to OnEditEnded event.")):this.sYe():
wa.ULS.sendTraceTag(537155222,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: EwaControl is null")},this.YSg,Mb.a.iOk,void 0,!0)}N$f(G){this.ovd=this.s9e(2,G,!0);this.f2e()}eLc(G,da){this.phc=this.s9e(G,da,!1);this.f2e()}s9e(G,da,$a){$a=$a?this.ovd:this.phc;return da?$a|G:$a&~G}vue(){const G=!!this.P2a,da=!!this.f7a,$a=!!this.YAa,Sb=!!this.Opc;this.OXb&&!G?this.Csh():!this.OXb&&G&&this.J8h();!this.ZJc||da||$a?this.ZJc||(da?this.bkf():($a||this.$ba&&this.$ba.wt)&&this.ckf()):
this.yDa?this.Bsh():this.$ba||this.Dsh();this.xxa&&!Sb?this.DYg(!0):!this.xxa&&Sb&&this.DYg(!1)}Csh(){this.$?this.P2a?wa.ULS.sendTraceTag(537155215,0,15,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Tried to activate offline PI when there is already an offline partial interactivity object"):fc.f(this.$).isEditing?(this.Xsb||(fc.f(this.$).cellTextEditBox.Wx(this.yl),wa.ULS.sendTraceTag(537155217,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Registered OnEditEnded during offline mode")),
this.Wsb=!0,wa.ULS.sendTraceTag(537155216,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Turned offline while user is editing a cell, registered to OnEditEnded event.")):this.xYe():wa.ULS.sendTraceTag(537155214,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: EwaControl is null")}xYe(){this.P2a||(this.P2a=ua.a(this.$).Bm.VEa(5,"NetworkConnecStateManager.ActivateOfflinePartialInteractivity"))}J8h(){this.P2a&&(Ia.a.Ng(this.P2a),this.P2a=
null)}bkf(){this.f7a&&(Ia.a.Ng(this.f7a),this.f7a=null);this.lca&&this.lca.wt&&this.lca.cancel();this.lca=null}ckf(){this.YAa&&(Ia.a.Ng(this.YAa),this.YAa=null);this.$ba&&(Ia.a.Ng(this.$ba),this.$ba=null);this.Xsb&&!this.Wsb&&fc.f(this.$).cellTextEditBox.Zw(this.yl);this.Xsb=!1}Bsh(){this.f7a||(this.f7a=ua.a(this.$).Bm.VEa(2,"NetworkConnectionStateManager.ActivateLongInactivitySilentReopenPartialInteractivity",void 0,ha.a.instance.ia(2190)));this.Hnk()}DYg(G){G?(this.Opc=ua.a(this.$).Bm.VEa(4,"NetworkConnectionStateManager.ConnectivityIssues"),
this.Z8j()):(Ia.a.Ng(this.Opc),this.Opc=null)}Z8j(){if(this.$&&this.$.pa){const G=this.$.pa.ta.Jh();ec.J(this.$.pa.ta,null,null,null,G)}}B0c(){Yb.a(this.$).d5(Ka.a.GMa).Jx(this.Dkg);this.$.Pr(this.xj);this.XRc=!1}f2e(){this.documentVisibilityObserver||wa.ULS.sendTraceTag(537155211,0,15,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: Document visibility observer is null while it shouldn't be.");this.documentVisibilityObserver&&this.documentVisibilityObserver.tn?this.sVb||
(this.documentVisibilityObserver.t3(this.VI),this.sVb=!0,wa.ULS.sendTraceTag(541193954,0,50,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: tabbed out user, will update the partial interactivity state when the user will be back.")):this.vue()}};Me=Object(oc.__decorate)([Object(Wc.d)(Qc.Td),Object(oc.__param)(0,Object(Qc.Lb)()),Object(oc.__param)(1,Object(Qc.qd)())],Me);Object(ka.a)(Me,"NetworkConnectionStateManager",pa.a,[558,2]);var Ve=a(740),Hf=a(682),Qf=a(180),ia=a(308);
class Xb{constructor(G){this.b2a=this.R1d=this.f2a=this.kKc=0;this.K1d=this.o8f=null;this.ONc=da=>{"pen"!==da.pointerType||this.f2a||(this.f2a=Math.floor(this.BLb()/1E3),this.f2a<=this.kKc&&(this.f2a=this.kKc),this.R1d=0)};this.Noa=()=>{this.NMf()};this.pRb=(da,$a)=>{0!==$a.newState&&this.NMf()};this.uyj=()=>{0<this.b2a&&this.SJg(this.b2a);this.b2a=0};G?(this.uKc=G,this.BLb=Date.now,this.B4h(),this.efk()):wa.ULS.sendTraceTag(520955213,209,10,"Can not initialize PenMinutesManager because TaskManager is null")}aCk(){this.o8f=
"Office.Excel.Online.Data.Activity.PenMinutes"}efk(){window.document.body.addEventListener("pointerenter",this.ONc);window.document.body.addEventListener("pointerleave",this.Noa);Object(Hf.a)().execute(G=>{G.m1e(this.pRb)})}NMf(){const G=Math.ceil(this.BLb()/1E3);this.f2a&&G>this.kKc&&(this.R1d=G,this.b2a+=this.R1d-this.f2a);this.kKc=G;this.f2a=0}B4h(){this.K1d=new Eb.a(4,2,6E4,this.uyj);this.uKc.Ol(this.K1d)}SJg(G){const da=new ia.a;da.name=this.o8f;const $a=[];(G=id.a.Rl("PenInputSec",G.toString(),
3))&&Array.add($a,G);da.dataFields=$a;Qf.a.sendActivityEvent(da)}dispose(){0<this.b2a&&this.SJg(this.b2a);this.uKc.wx(this.K1d)}}Object(ka.a)(Xb,"PenMinutesManager",null,[605]);var Vc=a(278);class ud{constructor(){this.cfd=this.Mh=null}get name(){return"Common.App.PenMinutesManager"}ao(G){this.Mh=G;const da=Za.AFrameworkApplication.pp;this.Mh.register(605,"Common.App.PenMinutesManager.IPenMinutesManager").hi().mi(()=>new Xb(da))}init(){this.cfd=Sf.a.instance.resolve("Common.App.PenMinutesManager.IPenMinutesManager")}dispose(){this.cfd&&
this.cfd.dispose()}static main(){Vc.a.instance.Lo(new ud)}}Object(ka.a)(ud,"PenMinutesManagerPackage",null,[12,13]);Object(Wc.b)(Qc.re,{yk:"singleton"})(()=>{Type.registerNamespace("Common.App.PenMinutesManager");ud.main();const G=Sf.a.instance.resolve("Common.App.PenMinutesManager.IPenMinutesManager");G.aCk();return G});var xe=a(142);let fe=class{constructor(G){G.k5(da=>{void da.F$(1).then(()=>{const $a=document.createElement("div"),Sb=Object(fc.f)(G).Ym;appChrome.renderProactiveSuggestionDebugPane($a,
Sb,xe.a.Lx)})});void Wc.a.resolve(Qc.Ye,{va:1})}};fe=Object(oc.__decorate)([Object(Wc.d)(Qc.Pe),Object(oc.__param)(0,Object(Qc.Lb)())],fe);Object(ka.a)(fe,"ProactiveSuggestionDebugToolsManager",null,[]);let Te=class extends pa.a{constructor(){super()}mve(G,da){wa.ULS.sendTraceTag(537154185,0,50,`ProactiveSuggestionManager.TriggerProactiveSuggestion: proactive suggestion was triggered. Range: ${G}, TriggerType: ${da}`);if(xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",
!1))switch(da){case 0:this.raiseEvent("pssort",void 0,G);break;case 1:this.raiseEvent("psfilter",void 0,G);break;case 2:this.raiseEvent("pscrttbl",void 0,G)}}};Te=Object(oc.__decorate)([Object(Wc.d)(Qc.Qe)],Te);Object(ka.a)(Te,"ProactiveSuggestionManager",pa.a,[549]);var Bf=a(1406),Cf=a(100),Lf=a(181);class df{constructor(){this.onResizeMiddleContainer=this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=
this.onClose=this.onOpen=this.middleContainer=null}}Object(ka.a)(df,"TaskPaneGroupAppProps",null,[]);class T{constructor(){this.type="ExcelLegacyTaskPaneWacInfraProps";this.isSharedRuntime=!1;this.feedbackTaskPaneProps=this.getContent=null}}Object(ka.a)(T,"ExcelLegacyTaskPaneWacInfraProps",null,[]);var Ga=a(51),hb=a(41),jc=a(333);Object(Wc.b)(Qc.We,{yk:"singleton"})(G=>No(function*(){const da=yield Wc.a.resolve(Qc.Lb,G);return Zc.Aa(da)}));class Zc extends pa.a{constructor(G,da){super();this.isVisible=
!1;this.Qkf=500;this.c6b=[];this.xjf=this.M7c=null;this.e7d=()=>{this.PEg()};this.WZc=new Set;this.WZc.add("FieldListTaskPane");this.WZc.add("PivotTableSettingsTaskPane");this.WZc.add("SlicerSettingsTaskPane");this.fh=da;wb.a(this.$).Eq(this);this.l8b=G;Za.AFrameworkApplication.ra.$d.Fk||(this.l8b.style.bottom=this.$.wj&4?Hg.HelperMethods.ti(this.$.bPa):"0");this.Gvc={};this.m8b={};this.rDe=new Set;this.lte=Sh.a.instance.Ek(this.Pi);this.lte.Aa("focusin",this.e7d);this.kbj()}get $(){return this.fh}get kjc(){return this.rDe}get NWa(){return this.M7c}get isCollapsed(){return!this.NWa}dispose(){wb.a(this.$).FH(this);
const G=this.Gvc;for(const da in G)({key:da,value:G[da]}).value();this.m8b=this.rDe=this.Gvc=null;this.lte.sO();this.l8b=this.lte=null;super.dispose()}gjb(G,da,$a,Sb,Mc,sd,Od,se,Ye,hf,ag,Jg,tg,Xg,hi,xj,zi){Ye=void 0===Ye?Zc.luj:Ye;hf=void 0===hf?Zc.kuj:hf;ag=void 0===ag?null:ag;Jg=void 0===Jg?null:Jg;tg=void 0===tg?!1:tg;Xg=void 0===Xg?!1:Xg;hi=void 0===hi?null:hi;xj=void 0===xj?!1:xj;const Gi=Object(Bb.a)(new T,{getContent:()=>G});Gi.isSharedRuntime=tg;return Object(Bb.a)(new Bf.a,{hideHeader:Xg,
contentProps:Gi,title:da,titleTag:hi,width:$a,location:2,onOpen:Mc,onClose:sd,onShow:Od,onHide:se,iconUrl:ag,iconId:Jg,enableResize:Sb,minResizeWidth:Ye,maxResizeWidth:hf,showResizeChatButton:xj,onCloseButtonTabKeyDown:Ai=>{xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8039664_TaskpaneCloseShiftTab")&&(Ai.shiftKey&&Ai.keyCode===Cf.a.mG&&!Sb?void Lf.a.Go().then(ak=>{1>=ak.selectors.getTabbedTaskPaneCount()&&zi(Ai);return null}):Ai.keyCode!==Cf.a.mG||Ai.shiftKey||zi(Ai))}})}hS(G,da){xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8098320_SDXPreloadFix")&&
this.c6b.indexOf(G)&&(this.c6b[G]=!0);void Lf.a.Go().then($a=>{this.kjc.has(G)?$a.setSelectedTaskPane(G):$a.showTaskPane(G,da);return null})}Exd(G,da){this.c6b[G]=!1;void Lf.a.Go().then($a=>{$a.initializeHiddenSharedRuntimeTaskPane(G,da);const Sb=this.$.domElement;Sb.addEventListener("scroll",function sd(){0!=Sb.scrollLeft&&(Sb.scrollLeft=0,Sb.removeEventListener("scroll",sd))})})}updateTaskPane(G,da){xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8098320_SDXPreloadFix")&&this.c6b.indexOf(G)&&!this.c6b[G]||
void Lf.a.Go().then($a=>{$a.updateTaskPane(G,da);return null})}setSelectedTaskPane(G){void Lf.a.Go().then(da=>{da.setSelectedTaskPane(G);return null})}hideTaskPane(G){void Lf.a.Go().then(da=>{da.hideTaskPane(G,Zc.EUk);return null})}get Pi(){return this.l8b}get Co(){return this.isVisible}get Hk(){return ic.a.nte}zp(G,da){return da?!1:(this.mJg(),!0)}Yp(G){return Oa.DOMElementExtensions.Cn(this.Pi,G)}gs(){this.$.frame.tm.fv(this.Hk)}Xt(){}focusResizeHandle(){void Lf.a.Go().then(G=>{G.focusResizeHandle();
return null})}focusTabbedTaskPaneArea(){void Lf.a.Go().then(G=>{G.focusTabbedTaskPaneArea();return null})}kbj(){Lf.a.Go().then(G=>{const da=new df;da.onOpen=$a=>{this.isVisible=!0;this.kjc.add($a)};da.onClose=$a=>{this.isVisible=0<G.selectors.getTabbedTaskPaneCount();wa.ULS.sendTraceTag(537014371,0,50,`Closing of ${$a} TaskPane`);this.isVisible||this.hyf();delete this.m8b[$a];this.kjc.delete($a);this.npa()};da.onShow=($a,Sb)=>{this.M7c=$a;this.PEg();1!==Sb&&window.requestAnimationFrame(()=>{window.setTimeout(()=>
{this.Zrk()},0)});this.npa()};da.onHide=($a,Sb,Mc)=>{this.M7c=null;Mc&&1!==Sb&&this.hyf();this.npa()};da.setFocusCallback=($a,Sb)=>{Sb&&(this.m8b[$a]=Sb)};da.onResizeStart=()=>{};da.onResizeEnd=()=>{this.npa();wa.ULS.sendTraceTag(537014369,0,50,`Resizing of ${this.NWa} TaskPane`)};G.renderTaskPaneGroups(null,this.l8b,da);return null})}fPh(){xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8426131_gridLayoutCleanup")&&gf.Task.delay(this.Qkf).continueWith(()=>{this.$.Eok()})}hyf(){fc.f(this.$).setFocus()}npa(){Za.AFrameworkApplication.ra.$d.Fk?
xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GridAdjustmentPostTakePaneTrigger",!1)&&(gf.Task.delay(this.Qkf).continueWith(()=>{this.$.npa(jc.a.qwa("ResetContentAreaMargin"))}),wa.ULS.sendTraceTag(507609505,0,50,"TaskPane.onContentAreaResize")):this.fPh()}Zrk(){if(this.m8b[this.NWa]){const G=this.m8b[this.NWa];G&&G(null,null)}else this.WZc.has(this.NWa)||this.mJg()}mJg(){Lf.a.Go().then(G=>{if(!xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8215527_InconsistentTaskPaneBorderFix")&&1<
G.selectors.getTabbedTaskPaneCount())G.focusTabbedTaskPaneArea();else{const da=Oa.DOMElementExtensions.fE(this.Pi.querySelectorAll(Oa.DOMElementExtensions.zI));da?da.focus():xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8215527_InconsistentTaskPaneBorderFix")&&1<G.selectors.getTabbedTaskPaneCount()&&G.focusTabbedTaskPaneArea()}return null})}PEg(){this.$.domElement.scrollLeft=0;wf.a.Una&&window.requestAnimationFrame(()=>{this.$.domElement.scrollLeft=0;window.setTimeout(()=>{this.$.domElement.scrollLeft=
0},0)})}get UZc(){return this.l8b}Nqc(G,da,$a,Sb,Mc){let sd=G.Ug(da);sd||(sd=hb.a(Ga.a,$a,G,da),sd.SetScriptLoadFlavor(Mc));Sb&&sd.l0e(Sb);const Od=""+da;let se=null;const Ye=()=>{sd.create();se()};this.Gvc[Od]=se=()=>{sd.Yfe(Ye);delete this.Gvc[Od]};sd.xmd(Ye)}static Aa(G){const da=Zc.AMh(G.$h,G.isChromeRtl);Zc.MGh(G,da);return new Zc(da,G)}static AMh(G,da){const $a=document.createElement("div");$a.id=G+vc.a.ote;Za.AFrameworkApplication.ra.$d.Fk?$a.classList.add(yc.a.ial):($a.classList.add(da?yc.a.kal:
yc.a.jal),Za.AFrameworkApplication.ra.$d.Fk&&$a.classList.add(yc.a.Tsb));return $a}static MGh(G,da){G.isMobileMode&&da.setAttribute("aria-hidden","true");if(Za.AFrameworkApplication.ra.$d.Fk){let $a;($a=document.getElementById("FarPaneRegion"))?$a.appendChild(da):wa.ULS.shipAssertTag(509097620,11,!1,`FarPaneRegion is not found, regionComposerRoot found=${!!document.getElementById("regionComposerRoot")}`)}else document.getElementById(G.$h+vc.a.Xoc).insertBefore(da,G.aPa)}}Zc.luj=300;Zc.kuj=950;Zc.EUk=
2;Object(ka.a)(Zc,"ReactTaskPaneManager",pa.a,[547,59,2]);var kd=a(59),qd=a(44),ae;let ne=ae=class{constructor(){this.M5e=null;this.oWj=da=>{wa.ULS.sendTraceTag(508421248,0,50,`DMS call to get SDX list succeeds with status ${da.data.httpStatus}.`);this.UMf(da.data.responseData)};this.nWj=da=>{200<=da.data.httpStatus&&300>da.data.httpStatus?(wa.ULS.sendTraceTag(508421219,0,50,`DMS call to get SDX list succeeds with status ${da.data.httpStatus}.`),this.UMf(da.data.responseData)):wa.ULS.sendTraceTag(508421218,
0,15,`DMS call to get SDX list fails with status ${da.data.httpStatus}.`)};const G=xb.EwaSettings.getStringFeatureGate("Microsoft.Office.ExcelOnline.SdxManifestPrefetchAssetIds","");""!==G&&(this.M5e=G.split(";"),this.F5j())}F5j(){const G=Gb.a.create().toString();wa.ULS.sendTraceTag(508421250,0,50,`Start calling DMS to retrieve the list of SDXs to prefetch (dmsActivityId = ${G}).`);Za.AFrameworkApplication.$i.Ou(kd.a.current.jS.SdxDmsUrl,2,ae.M5h(),ae.N5h(G),!1,4,this.oWj,this.nWj,null)}Vgi(){return xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.OEP.UseSdx1CdnUrl",
!1)||kd.a.current.jS.ForceUseSdx1Cdn}UMf(G){try{const da=qd.b(G).Packages,$a=this.Vgi()?kd.a.current.jS.Sdx1CdnUrl:kd.a.current.jS.SdxCdnUrl;for(const Sb of da)if(this.M5e.includes(Sb.AssetId)){const Mc=String.format($a,Sb.AssetId,Sb.FFN,Sb.Version,"en-us");kd.a.Wrb(Mc,!1,null,!0)}window.prefetchedDmsResponse=G}catch(da){wa.ULS.sendTraceTag(508421249,0,15,`Failed to parse DMS response: "${G.substring(0,40)}...".`)}}static M5h(){const G=Object(Hc.a)(String,Za.AFrameworkApplication.Nh.AudienceGroup)||
"";return qd.c({["Context"]:{["Hosts"]:["Workbook"],["ReactNativeVersion"]:"0.0.0.0",["Channel"]:"DevMain",["Capabilities"]:[{["Name"]:"addincommands",["Version"]:"1.1"},{["Name"]:"bindingevents",["Version"]:"1.1"},{["Name"]:"biplatvisualrichapi",["Version"]:"1.8"},{["Name"]:"customfunctions",["Version"]:"1.9"},{["Name"]:"customfunctionsruntime",["Version"]:"1.2"},{["Name"]:"compressedfile",["Version"]:"1.1"},{["Name"]:"DataFromPicture",["Version"]:"1.1"},{["Name"]:"pivotfilters",["Version"]:"1.2"},
{["Name"]:"pdffile",["Version"]:"1.1"},{["Name"]:"dialogapi",["Version"]:"1.2"},{["Name"]:"dialogorigin",["Version"]:"1.2"},{["Name"]:"documentevents",["Version"]:"1.1"},{["Name"]:"excelapi",["Version"]:"1.12"},{["Name"]:"excelapionline",["Version"]:"1.1"},{["Name"]:"excelapiundo",["Version"]:"1.4"},{["Name"]:"firstpartyauthentication",["Version"]:"1.1"},{["Name"]:"identityapi",["Version"]:"1.3"},{["Name"]:"matrixbindings",["Version"]:"1.1"},{["Name"]:"matrixcoercion",["Version"]:"1.1"},{["Name"]:"numberformatting",
["Version"]:"1.2"},{["Name"]:"pivot",["Version"]:"1.5"},{["Name"]:"richapiruntime",["Version"]:"1.2"},{["Name"]:"richapiruntimeflag",["Version"]:"1.2"},{["Name"]:"selection",["Version"]:"1.1"},{["Name"]:"settings",["Version"]:"1.1"},{["Name"]:"sharedruntime",["Version"]:"1.1"},{["Name"]:"tablebindings",["Version"]:"1.1"},{["Name"]:"tablecoercion",["Version"]:"1.1"},{["Name"]:"tablestyle",["Version"]:"1.1"},{["Name"]:"textbindings",["Version"]:"1.1"},{["Name"]:"textcoercion",["Version"]:"1.1"},{["Name"]:"file",
["Version"]:"1.1"},{["Name"]:"webauth",["Version"]:"1.1"}],["Ring"]:"Automation"===G?"Dogfood":G,["Platform"]:"Web",["Locales"]:[Za.AFrameworkApplication.uiCulture],["ClientId"]:Za.AFrameworkApplication.fa.Xa("LoggableUserId")},["SyncId"]:0})}static N5h(G){return{["Content-Type"]:"application/json",["DMSActivityId"]:G}}};ne=ae=Object(oc.__decorate)([Object(Wc.d)(Qc.nf)],ne);Object(ka.a)(ne,"SdxManifestPrefetcher",null,[]);var Pd=a(221);class Vd extends rb.a{constructor(G,da,$a,Sb,Mc){Mc=void 0===
Mc?null:Mc;super();this.FGb=null;this.IYf=!1;this.VI=()=>{this.kTb&&wa.ULS.sendTraceTag(537153858,0,50,`ActionAggregator<${this.dYb}>.OnDocumentUnhidden: Start. IsActionOngoing: ${this.u_a}, AggregatedActionParams not null: ${this.kTb}`);this.HRd()};this.nsh=G;this.osh=da;this.documentVisibilityObserver=$a;this.dYb=Sb;this.WV=Mc;$a&&this.documentVisibilityObserver.t3(this.VI)}get u_a(){return this.IYf}get kTb(){return!!this.FGb}krg(G){wa.ULS.sendTraceTag(537153864,0,50,`ActionAggregator<${this.dYb}>.PerformThrottledAction: Start. IsActionOngoing: ${this.u_a}, AggregatedActionParams not null: ${this.kTb}`);
this.FGb=this.osh.w2e(G,this.FGb);this.HRd()}dispose(){this.documentVisibilityObserver&&this.documentVisibilityObserver.FNa(this.VI);super.dispose()}MMg(G){this.IYf=G}cvi(){wa.ULS.sendTraceTag(537153862,0,50,`ActionAggregator<${this.dYb}>.FinishedCallback: Start. IsActionOngoing: ${this.u_a}, AggregatedActionParams not null: ${this.kTb}`);this.MMg(!1);this.HRd()}HRd(){if(!this.B6b()){var G=this.FGb;this.FGb=null;this.MMg(!0);wa.ULS.sendTraceTag(537153857,0,50,`ActionAggregator<${this.dYb}>.InternalPerformAction: Calling PerformAction.`);
lh.TaskExtensions.Ua(this.nsh.grg(G),()=>{this.cvi()},Pd.a.none,0,this.WV)}}B6b(){return!this.kTb||this.u_a?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.tn?(wa.ULS.sendTraceTag(593376846,0,50,`ActionAggregator<${this.dYb}>.ShouldThrottle: Not Calling PerformAction as document is hidden.`),!0):!1}}Object(ka.a)(Vd,"ActionAggregator",rb.a,[633,2]);var Je=a(154),Ge=a(17),sf=a(52);class Mf extends pa.a{constructor(G){super();this.HF=this.jM=null;this.g0a=!1;this.CB=null;this.GGk=
wf.a.hm;this.mjg=da=>{const $a=da.La.keyCode;return $a===Cf.a.fu?this.jOj():$a===Cf.a.mG&&da.La.shiftKey?this.tri(this.jM):!1};this.kpg=da=>{if(!this.g0a||da.La.keyCode!==Cf.a.zZ)return!1;Mf.mPf();gf.Task.delay(1).RA(()=>{this.HF.focus();return!0},0,this.xa);return!0};this.fZj=()=>{document.activeElement&&document.activeElement.id===this.HF.id||(Mf.mPf(),gf.Task.delay(1).RA(()=>{this.HF.focus();return!0},0,this.xa))};this.Xgg=()=>{this.rZg(this.HF)};this.ljg=da=>{da.stopPropagation();da.preventDefault();
this.g0a&&(this.g0a=!1)};this.$=G;(G=this.$.ea.th)&&wa.ULS.sendTraceTag(39350791,0,50,`EmbedViewFocusControl: PermissionSet = ${G.nGa}; InWebPart = '${G.inWebPart?"Classic":"Non Classic"}', InEmbedView = '${G.inEmbedView?"True (+Modern)":"False (not Modern)"}'`);G&&(G.inWebPart||G.inEmbedView)?wa.ULS.sendTraceTag(537153856,0,15,`EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '${G.inWebPart?"Classic":"Non Classic"}', InEmbedView = '${G.inEmbedView?
"True (+Modern)":"False (not Modern)"}'`):(this.m2h(),this.k3h(),Je.a.instance.ya(Ge.a.zi,this.$.domElement,this.kpg));this.$.ka.ph(238,this)}gzh(G){this.addHandler("KBIS",G)}Gjk(G){this.removeHandler("KBIS",G)}dispose(){this.jM&&sf.a.removeHandler(this.jM,Ge.a.focus,this.Xgg);this.CB&&this.CB.detach("focus");this.HF&&(sf.a.removeHandler(this.HF,Ge.a.focus,this.ljg),sf.a.removeHandler(this.HF,Ge.a.blur,Mf.onBlur),Je.a.instance.Na(Ge.a.zi,this.HF,this.mjg));Je.a.instance.Na(Ge.a.zi,this.$.domElement,
this.kpg);this.CB=this.HF=this.jM=this.$=null;super.dispose()}m2h(){this.GGk?(this.jM=document.documentElement,this.CB=Sh.a.instance.WT(document.parentWindow),this.CB.Aa("focus",this.fZj)):(this.jM=Mf.mhf(),document.body.insertBefore(this.jM,document.body.childNodes[0]),sf.a.addHandler(this.jM,Ge.a.focus,this.Xgg))}k3h(){this.HF=Mf.mhf();this.HF.id=vc.a.bpf;this.HF.setAttribute(vc.a.RC,ha.a.instance.ia(863));document.body.appendChild(this.HF);sf.a.addHandler(this.HF,Ge.a.focus,this.ljg);sf.a.addHandler(this.HF,
Ge.a.blur,Mf.onBlur);Je.a.instance.ya(Ge.a.zi,this.HF,this.mjg)}tri(G){this.rZg(G);return!1}jOj(){this.g0a=!0;fc.f(this.$).focus();fc.f(this.$).ha.gMf();this.raiseEvent("KBIS");return!0}rZg(G){this.g0a?this.g0a=!1:(this.g0a=!0,G&&G.focus())}static mhf(){const G=document.createElement("div");G.tabIndex=0;return G}static mPf(){document.body.classList.add(yc.a.zrf)}static onBlur(){document.body.classList.remove(yc.a.zrf)}}Object(ka.a)(Mf,"EmbedViewFocusControl",pa.a,[632,2]);var Df=a(71),Of=a(603);class ig extends pa.a{constructor(G,
da){super();this.$3b=this.aJd=this.JPb=this.KZ=null;this.Tec=!1;this.uGe=null;this.vxa=this.Mce=!1;this.bQj=($a,Sb,Mc)=>{wa.ULS.sendTraceTag(25264350,0,10,"Call to GetRichValueFieldListContextList failed in: "+Mc);this.$3b&&this.$3b.stop();this.KZ=null;this.raiseEvent("GetFieldInfoListContextOperationFailed")};this.cQj=$a=>{pb.a($a)||(this.$3b&&this.$3b.stop(),this.Tec=!1,(this.KZ=$a.Result)&&0<this.KZ.length&&wa.ULS.sendTraceTag(25264351,0,50,`Retrieved ${this.KZ.length} rich value field list context for autocomplete`),
this.$$a=!0,this.ZQc())};this.$$a=!1;this.fh=G;this.ldc=-1;this.Cj=da;this.Mce=xb.EwaSettings.isChangeGateEnabled("OfficeVSO:6395797_raiseFieldInfoLoadedEventOnEmptyResults");this.vxa=xb.EwaSettings.vxa()}zmd(G){this.addHandler("FieldInfoListContextLoaded",G)}Zfe(G){this.removeHandler("FieldInfoListContextLoaded",G)}Eyh(G){this.addHandler("GetFieldInfoListContextOperationFailed",G)}hjk(G){this.removeHandler("GetFieldInfoListContextOperationFailed",G)}get TTd(){return this.$$a}get Uvj(){return this.Tec}get szf(){return this.ldc}get Txd(){return this.uGe}get $(){return this.fh}get xx(){return this.KZ}get jJi(){return!!this.JPb}dispose(){this.fh=
null;this.MTc();super.dispose()}Hjb(G,da,$a,Sb){Sb=void 0===Sb?null:Sb;if(G){this.ksd();this.Unc();var Mc=null,sd=!1;if(!Sb&&(()=>{let Od=this.I_k(G,da,$a);({prb:sd,xx:Mc}=Od);return Od})().returnValue)if(this.Mce||this.DLg(Mc),this.Tec=!0,this.KZ=Mc,this.Mce){if(!sd){this.$$a=!0;this.ZQc();return}}else if(this.KZ&&0<this.KZ.length&&(this.$$a=!0,this.ZQc()),!sd)return;this.J2g(G,Sb,da,$a,!1)}}J2g(G,da,$a,Sb,Mc){if(this.$.ea.Ph){this.$.qh&&(this.$3b=this.$.qh.vi("WebServiceCall","GetRichValueFieldInfoListContext"));
this.JPb=null;var sd=this.$.pa.ta.Jh(),Od=this.$.pa.ta,se=this.cQj,Ye=this.bQj;const hf=Od.Za(1,null);hf.selectedRange=G;hf.richValueKeyPath=da;hf.singleColumn=$a;hf.searchForRange=Sb;hf.calculateMajorityDataType=Mc;this.JPb=ec.h(Od,"GetRichValueFieldListContextList",hf,se,Ye,null,sd,4)}else this.KZ=null}MTc(){this.KZ=null;this.$$a=!1;this.ksd();this.Unc();this.JPb=null;this.ldc=-1}ksd(){ig.LIb(this.JPb)}Unc(){ig.LIb(this.aJd)}ZQc(){this.raiseEvent("FieldInfoListContextLoaded")}my(G){G=Pe.G(G);--G.left;
--G.right;return this.Cj.my(G)}IYa(G){G.FirstColumn=G.FirstColumn;G.LastColumn=G.LastColumn;G.FirstRow=G.FirstRow;G.LastRow=G.LastRow;this.Unc();this.aJd=null;return mc.a(this.$.userOperationManager,(da,$a,Sb)=>le.k(this.$.pa.ta,G,Ac.c(da,Mc=>{this.kQj(Mc)}),Ac.b($a,$a,Mc=>{this.jQj(Mc)}),Sb,null),da=>new Sa.a(264,0,da,80),null)}jQj(G){G=dc.a.Qj(G.data);wa.ULS.sendTraceTag(525336847,0,10,`FieldInfoManager.OnGetFullTableRangeFailure - Webservice call failed with Errors: ${lb.a.Kh(G)}`)}kQj(G){if(pb.a(G))-315732528!==
G.Errors[0].MessageId&&wa.ULS.sendTraceTag(525336846,0,10,`FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call failed with Unexpected error : ${lb.a.Kh(G.Errors)}`);else if(G&&G.Result){G=G.Result;var da=G.HasHeaderRow;da=new Of.AutofilterRange(G.TableRange.FirstRow+(da?1:0)+1,G.TableRange.FirstColumn+1,G.TableRange.LastRow+1,G.TableRange.LastColumn+1,null,null,null,0,da);this.ldc=G.TableRange.FirstColumn;(G=this.Mug(!1,!0,da))||wa.ULS.sendTraceTag(525336844,0,50,"FieldInfoManager.OnGetFullTableRangeSuccess - fieldInfoListContextList is null");
this.DLg(G)}else wa.ULS.sendTraceTag(525336845,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call returned no result")}I_k(G,da,$a){let Sb,Mc;Mc=null;Sb=!1;if(G.SheetName!==this.$.ea.na.sheetName)return{returnValue:!1,prb:Sb,IYa:!1,xx:Mc};let sd;this.ldc=-1;if($a){sd=this.my(G);if(!sd||!sd.Swa)return{returnValue:!1,prb:Sb,IYa:!1,xx:Mc};var Od=this.vxa?(Od=fc.f(this.$).Yg.gIf(sd))&&0<Od.size:(Od=fc.f(this.$).Yg.hIf(sd))&&0<Od.count;this.uGe=sd;if(xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5167298_ObtainFullRangeOfTableForPopulatingInsertDataDropdownCorrectly")&&
Od)return--G.FirstColumn,--G.LastColumn,this.aJd=this.IYa(G),{returnValue:!0,prb:Sb,IYa:!0,xx:Mc};sd.top+=1;sd.right=Pe.G(G).right-1}else sd=new Of.AutofilterRange(G.FirstRow+1,G.FirstColumn+1,G.LastRow+1,G.LastColumn+1,null,null,null,0,!1);if(sd.top>sd.bottom||sd.left>sd.right)return{returnValue:!0,prb:Sb,IYa:!1,xx:Mc};G=fc.f(this.$);var se=G.Pg.width,Ye=G.Pg.height;Od=G.view.visibleArea;se=new Df.a(Od.x-se,Od.y-Ye,Od.width+se,Od.height+Ye);Ye=G.ml(sd);if(!Od||!Ye||!G.NGc(sd))return{returnValue:!1,
prb:Sb,IYa:!1,xx:Mc};se.contains(Ye)||(Sb=!0);Mc=this.Mug(da,$a,sd);return{returnValue:!0,prb:Sb,IYa:!1,xx:Mc}}DLg(G){G&&wa.ULS.sendTraceTag(25264348,0,50,`Retrieved ${G.length} rich value field contexts from block cache`);this.Tec=!0;(this.KZ=G)&&0<this.KZ.length&&(this.$$a=!0,this.ZQc())}Mug(G,da,$a){let Sb;Sb=null;const Mc=$a.clone();if(da)for(let sd=$a.right,Od=0;sd>=$a.left;--sd){if(Mc.left=sd,Mc.right=sd,da=this.FDf(Mc,!0,$a.left)){Sb||(Sb=[]);Sb[Od]=da;if(G)break;++Od}}else if(G=this.FDf(Mc,
!1))Sb=[],Sb[0]=G;return Sb}FDf(G,da,$a){$a=void 0===$a?0:$a;var Sb=null;let Mc=[];if(this.vxa){var sd=fc.f(this.$).Yg.gIf(G);if(!sd||0>=sd.size)return Sb;Mc=Array(sd.size);let se=0;sd.forEach(Ye=>{const hf={};hf.Name=Ye.Value;hf.RefersToDotFunction=Ye.RefersToDotFunction;Mc[se]=hf;++se})}else{var Od=fc.f(this.$).Yg.hIf(G);if(!Od||0>=Od.count)return Sb;Mc=Array(Od.count);Sb=0;for(sd of Od.values)Od={},Od.Name=sd,Mc[Sb]=Od,++Sb}sd="";Od=-1;0<G.top&&da&&(G=new ce.Range(G.top-1,G.left,G.top-1,G.left,
!1,!1),null!=fc.f(this.$).kh(G)&&null!=fc.f(this.$).kh(G).originalText&&(sd=fc.f(this.$).kh(G).originalText),Od=G.left-$a);Sb={};Sb.ColumnName=sd;Sb.ColumnIndex=Od;Sb.FieldInfoDataList=Mc;return Sb}static LIb(G){G&&Za.AFrameworkApplication.$i.HD(G.TC)}}Object(ka.a)(ig,"FieldInfoManager",pa.a,[566,2]);class Ag extends ig{constructor(G,da,$a,Sb){super(G,da);this.uhb=null;this.Qgg=()=>{this.Zfe(this.Qgg);if(this.xx&&this.xx.length&&this.contextMenuManager){var Mc=this.contextMenuManager.lyc("autoFilterRichFieldList"),
sd=window.document.getElementById(this.uhb);Mc.Yba(null,sd,this,null,!0)}};this.eeh=$a;this.contextMenuManager=Sb}get KQ(){return this.eeh}xJi(G,da){this.uhb=da;wa.ULS.sendTraceTag(537153825,0,100,`FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col (${G.FirstRow}, ${G.FirstColumn}, ${G.LastRow}, ${G.LastColumn})`);this.J2g(G,null,!0,!1,!0)}}Object(ka.a)(Ag,"FilterInfoManager",ig,[565,566,2]);var ng=a(1070),xg=a(1194);class Pf{}Pf.Tli=
"ewa-sharedUi-launchButton";Pf.Wli="ewa-sharedUi-launchButtonWithText";Pf.Uli="ewa-sharedUi-launchButtonClick";Pf.Xli="ewa-sharedUi-launchButtonWithTextClick";Pf.Vli="ewa-sharedUi-launchButtonText";Object(ka.a)(Pf,"CssClassNames",null,[]);a(595);var ca=a(302),cb=a(286),tc=a(327),Kc=a(74),Xd=a(323);class qe extends ta.a{constructor(G,da,$a,Sb,Mc,sd,Od,se,Ye,hf){super(document.createElement("div"));this.E2f=null;this.Lqe=!1;this.zoom=this.ji=this.u8b=this.c7a=null;this.CY=()=>{this.raiseEvent("OnObjectButtonMouseOver")};
this.BY=()=>{this.raiseEvent("OnObjectButtonMouseOut")};this.cOk=()=>{this.AYe()};this.fj=ag=>{this.raiseEvent(this.Y0b,ag);this.Nrb();return!0};this.MNj=ag=>{100<xd.a(wd.a.Tg,this.E2f)&&this.bOd(new Sys.UI.Point(Math.round(ag.clientX),Math.round(ag.clientY)))};this.yY=ag=>{Kc.g(ag.La,!1);return!1};this.zoom=hf;this.j$=this.Xk.sWa();this.set_visible(!1);this.uHc=Mc;this.Y0b=sd;this.KLc=G;this.Uoc=da;this.ji=Ye;this.uHc&&(this.c7a=Fg.a.instance.create(this.cOk,3E4,"OnObjectButton.ShyTimerFired",!1,
!1));G&&this.domElement.classList.add(G);this.iVa=document.createElement("div");this.domElement.appendChild(this.iVa);$a&&this.iVa.classList.add($a);this.zwe(Sb);Od&&(this.u8b=document.createElement("div"),this.domElement.appendChild(this.u8b),this.u8b.classList.add(se),this.u8b.innerText=Od,this.domElement.style.padding="3px",ca.a.instance.ya(Ge.a.Zi,this.domElement,this.yY));this.qeb=new tc.a(this.domElement,7);cb.a.instance.ya(Ge.a.click,this.domElement,this.fj);xb.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&
ca.a.instance.ya(Ge.a.Zi,this.domElement,this.yY);G=ag=>{Kc.g(ag)};this.Wi.Aa("mouseup",G);this.Wi.Aa("click",G);this.Wi.Aa("dblclick",G)}s9(G){this.addHandler(this.Y0b,G)}Tha(G){this.get_events().removeHandler(this.Y0b,G)}Azh(G){this.addHandler("OnObjectButtonMouseOver",G)}Xjk(G){this.get_events().removeHandler("OnObjectButtonMouseOver",G)}zzh(G){this.addHandler("OnObjectButtonMouseOut",G)}Wjk(G){this.get_events().removeHandler("OnObjectButtonMouseOut",G)}zwe(G){G&&this.ji.hr(this.iVa,G)}S0c(G){this.iVa&&
G&&this.iVa.setAttribute("title",G)}h3k(G,da,$a){var Sb=16,Mc=16;Sb=void 0===Sb?0:Sb;Mc=void 0===Mc?0:Mc;this.ji.eO(this.iVa);G?G.lna(da,16,16,this.iVa,Sb,Mc,void 0,$a):wa.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")}i3k(G,da){G&&(this.u8b.innerText=G);this.domElement.title=da}dispose(){this.get_isInitialized()&&(this.hide(),this.Wi.sO(),Ia.a.Ni([this.j$,this.qeb]),cb.a.instance.Na(Ge.a.click,this.domElement,this.fj),ca.a.instance.Na(Ge.a.Zi,
this.domElement,this.yY),this.c7a&&this.c7a.dispose(),super.dispose())}L3b(){this.Uoc&&this.domElement.classList.remove(this.Uoc);this.KLc&&this.domElement.classList.add(this.KLc)}Nrb(){this.KLc&&this.domElement.classList.remove(this.KLc);this.Uoc&&this.domElement.classList.add(this.Uoc);this.Lhb()}Lhb(){this.uHc&&(this.c7a.cancel(),this.$Ug(),this.setOpacity(1));this.set_visible(!0)}Ft(G,da,$a,Sb,Mc){Mc=void 0===Mc?!1:Mc;G=this.zoom.zoomManager.Pn(G);da=this.zoom.zoomManager.Pn(da);this.zoom.zoomManager.rWc(this.domElement);
this.domElement.style.top=Hg.HelperMethods.ti(da);this.domElement.style.left=this.domElement.style.right="";da=G;Mc&&(da=G-this.domElement.offsetWidth);Xd.c(this.domElement.style,$a,Hg.HelperMethods.ti(da));this.set_visible(!0);this.setOpacity(1);this.uHc&&(this.Lqe=!1,this.dRk(),this.c7a.qA())}hide(){this.L3b();this.set_visible(!1);this.uHc&&(this.$Ug(),this.c7a.cancel())}nBd(){this.Wi.Aa("mouseover",this.CY,!0);this.Wi.Aa("mouseout",this.BY,!0)}dRk(){this.j$.zv("mousemove")||this.j$.Aa("mousemove",
this.MNj)}$Ug(){this.j$.zv("mousemove")&&this.j$.detach("mousemove")}bOd(G){if(this.domElement.parentNode){var da=Sys.UI.DomElement.getBounds(this.domElement);const $a=new Sys.UI.Point(Math.round(da.x+da.width),Math.round(da.y+da.height));da=Math.abs($a.x-G.x);G=Math.abs($a.y-G.y);G=da>G?da:G;this.Lqe?this.setOpacity(qe.IOh(G)):100>=G&&this.AYe()}}AYe(){this.Lqe=!0;this.c7a.cancel()}setOpacity(G){wf.a.setOpacity(this.domElement,G);this.E2f=wd.a.Tg.Wh}static IOh(G){return 100>=G?1:250<=G?0:.01*(100-
(G-100)/150*100)}}Object(ka.a)(qe,"OnObjectButton",ta.a,[595,292,2]);var rf=a(959);const Af=Pf.Vli;class gg extends rb.a{constructor(G,da,$a,Sb,Mc,sd,Od,se,Ye,hf){hf=void 0===hf?"":hf;super();this.ZJa=null;this.PPf=!1;this.ji=this.iLc=this.jLc=null;this.buttons={};this.erf={};this.zoom=Ye;this.$=G;this.svgIconProvider=da;this.SLj=$a;this.lQd=Sb;this.kQd=Mc;this.altText=sd;this.Y0b=Od;this.ji=se;this.buttonText=hf}get zoomManager(){return this.zoom.zoomManager}get iE(){return this.zoomManager.nFa(Ae.a.dUj)}get TIb(){return Ae.a.cUj}get buttonWidth(){return this.zoomManager.nFa(Ae.a.eUj)}dispose(){this.Cci();
this.$=null;super.dispose()}getButton(G,da){return this.cwa(G,void 0===da?!0:da)}cwa(G,da){const $a=G.toString();$a in this.buttons||this.m3h(G,void 0===da?!0:da);return this.buttons[$a]}Ft(G,da,$a,Sb,Mc,sd){Mc=void 0===Mc?!0:Mc;sd=void 0===sd?!1:sd;this.hide();if(this.$.ea.isNamedObjectViewMode&&Lc.i(this.$.na)){var Od=fc.f(this.$).dZ.domElement;const se=G+this.buttonWidth-Od.scrollWidth;Od=da+this.buttonWidth-Od.scrollHeight;G=0<se?G-se:G;da=0<Od?da-Od:da}this.cwa(Sb,Mc).Ft(G,da,$a,this.$,sd)}hide(){const G=
this.buttons;for(const da in G)G[da].hide()}nBd(G,da){!this.PPf&&(da=this.buttons[da.toString()])&&(this.jLc=($a,Sb)=>{G(Sb,!0)},da.Azh(this.jLc),this.iLc=($a,Sb)=>{G(Sb,!1)},da.zzh(this.iLc),this.PPf=!0,da.nBd())}m3h(G,da){this.ZJa=String.format(this.lQd===yc.a.Xuc?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',kb.a.Xq(this.lQd),kb.a.Xq(this.kQd),"{0}");var $a=String.format(this.ZJa,
kb.a.Xq(this.altText));da=new qe(""===this.buttonText?Pf.Tli:Pf.Wli,""===this.buttonText?Pf.Uli:Pf.Xli,yc.a.S3,$a,da,this.Y0b,this.buttonText,Af,this.ji,this.zoom);$a=(Sb,Mc)=>{this.SLj(Mc,G)};da.s9($a);this.buttons[G.toString()]=da;this.erf[G.toString()]=$a;$a=fc.f(this.$).Zk(G);$a.domElement.insertBefore(da.domElement,$a.domElement.firstChild)}Cci(){for(const G of rf.a(this.buttons)){const da=this.buttons[G];da.Tha(this.erf[G]);Ia.a.Ng(da);delete this.buttons[G];this.jLc&&da.Xjk(this.jLc);this.iLc&&
da.Wjk(this.iLc)}}domElement(G){return this.cwa(G).domElement}Lhb(G){this.cwa(G).Lhb()}R9b(G,da,$a){$a=void 0===$a?!0:$a;this.ZJa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',kb.a.Xq(this.lQd),kb.a.Xq(this.kQd),"{0}");G=String.format(this.ZJa,kb.a.Xq(G));this.cwa(da,$a).zwe(G)}H8a(G,da,$a){this.cwa($a,!1).i3k(G,da)}G2g(){var G=void 0===G?!1:G;this.ZJa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',
"{0}",kb.a.Xq(this.kQd),"{1}");const da=String.format(this.ZJa,void 0,kb.a.Xq(void 0));this.cwa(void 0,G).zwe(da)}r1c(G,da,$a){this.cwa($a,!1).h3k(this.svgIconProvider,G,da)}S0c(G,da){this.cwa(da,!1).S0c(G)}}Object(ka.a)(gg,"OnObjectLaunchButton",rb.a,[564,2]);var mg=a(105);class og extends mg.a{constructor(G,da){super(G);this.tXb=null;this.kci=()=>{this.display()};this.l8i=Math.max(1,da)}dispose(){Ia.a.Ng(this.tXb);this.tXb=null;super.dispose()}v7a(){Ia.a.Ng(this.tXb);this.tXb=Fg.a.instance.create(this.kci,
this.l8i,Mb.a.Zvj)}A7a(){Ia.a.Ng(this.tXb);this.hide()}}Object(ka.a)(og,"LoadingIndicatorBehavior",mg.a,[591,2]);class ph extends og{constructor(G,da,$a,Sb){super(G,da);this.sXb=null;this.Ggh=$a;this.k5i=Sb;this.Ouh()}dispose(){this.sXb=null;super.dispose()}display(){this.Ggh(this.sXb)}hide(){this.k5i(this.sXb)}Ouh(){this.sXb=document.createElement("div");this.domElement.appendChild(this.sXb)}}Object(ka.a)(ph,"ShimmerLoadingIndicatorBehavior",og,[]);var Yg=a(57);class Qh extends og{constructor(G,
da,$a,Sb,Mc,sd){Sb=void 0===Sb?null:Sb;Mc=void 0===Mc?null:Mc;sd=void 0===sd?0:sd;super(G,da);this.elb=this.S1a=null;this.elb=$a;this.NCc=Sb||kd.a.current.uu(103);this.C4f=sd;this.Yxd=Mc;this.Nuh()}dispose(){this.S1a=null;super.dispose()}display(){Oa.DOMElementExtensions.setVisible(this.S1a,!0)}hide(){Oa.DOMElementExtensions.setVisible(this.S1a,!1)}Nuh(){this.S1a=document.createElement("div");this.S1a.classList.add(Yg.a.lli);const G=document.createElement("div");G.classList.add(Yg.a.mli);this.Yxd&&
""!=this.Yxd&&G.classList.add(this.Yxd);const da=0===this.C4f?"":ha.a.instance.ia(this.C4f),$a=String.format('<div class="'+Yg.a.nli+'">{0}</div>',da);this.NCc?this.elb.hr(G,`<img src="${this.NCc}" alt="${da}" title="${da}"/>`+$a):this.elb.hr(G,$a);this.S1a.appendChild(G);this.domElement.appendChild(this.S1a)}}Object(ka.a)(Qh,"SpinnerLoadingIndicatorBehavior",og,[]);Object(Wc.b)(Qc.Cf)(G=>No(function*(){const [da,$a]=yield Promise.all([Wc.a.resolve(Qc.kd,{va:G.va}),Wc.a.resolve(Qc.Lg)]);return new Lh(da,
$a)}));class Lh{constructor(G,da){this.elb=G;this.zoom=da}axd(G,da,$a){return new ng.a(G,da,$a)}Tqc(G,da,$a,Sb,Mc,sd,Od,se,Ye,hf){return new xg.a(G,da,$a,Sb,Mc,sd,Od,se,Ye,hf)}YKb(G,da,$a,Sb,Mc){return new Qh(G,da,this.elb,$a,Sb,void 0===Mc?0:Mc)}VKd(G){return G.ka.Ug(238)||new Mf(G)}NKb(G,da,$a,Sb,Mc,sd,Od,se){return new gg(G,da,$a,Sb,Mc,sd,Od,this.elb,this.zoom,void 0===se?"":se)}Hwd(G,da){return new ig(G,da)}j2h(G,da,$a,Sb){return new Ag(G,da,$a,Sb)}mgf(G,da,$a,Sb){return new Vd(G,da,$a,Sb)}}Object(ka.a)(Lh,
"SharedUIControlsFactory",null,[542]);var Xh=a(471);let xh=class{constructor(G,da,$a){var Sb,Mc;this.$=G;this.da=da;this.iN=$a;this.z5d=3;this.Gcg=100;this.Li=()=>{this.iN.u5a({abortReason:"workbookClosed"})};$a.u5a({success:!1,entriesCount:this.exb,abortReason:"notStarted",sheetCount:null===(Mc=null===(Sb=this.$.sa)||void 0===Sb?void 0:Sb.items)||void 0===Mc?void 0:Mc.length});this.ike();this.$.Lp(this.Li)}ike(){window.requestIdleCallback?window.requestIdleCallback(()=>this.Ssg()):jd.e(()=>{this.Ssg()},
this.$.xa,100)}Ssg(){if(this.LGk()){var G=this.$.sa.items,da=this.$.Kt.activeItemIndex;0>da&&(wa.ULS.sendTraceTag(507635023,0,50,"SheetProcessedDataProvider.prefetchSheetProcessedData: active item index is unknown, using 0 instead..."),da=0);var $a=this.RHh;if(0===G.length||$a===G.length)wa.ULS.sendTraceTag(507635022,0,15,`SheetProcessedDataProvider.prefetchSheetProcessedData: there are ${$a}/${G.length} available spds, nothing to prefetch.`),this.iN.u5a({success:!0,entriesCount:this.exb});else{wa.ULS.sendTraceTag(507635021,
0,50,`SheetProcessedDataProvider.prefetchSheetProcessedData: there are ${$a}/${G.length} available spds, searching for unavailable SPD to prefetch...`);$a=da-1;da+=1;for(var Sb;0<=$a||da<G.length;){if(0<=$a){var Mc=G[$a];if(u(Mc)){Sb=Mc.sheetName;break}--$a}if(da<G.length){Mc=G[da];if(u(Mc)){Sb=Mc.sheetName;break}da+=1}}null==Sb?(this.iN.u5a({success:!0,entriesCount:this.exb}),wa.ULS.sendTraceTag(507635020,1,50,"SheetProcessedDataProvider.prefetchSheetProcessedData: done prefetching.")):this.da.hok(Sb).then(()=>
{this.ike()}).catch(sd=>{--this.z5d;const Od=Xh.a.isExpectedError(sd);wa.ULS.sendTraceTag(507635019,0,50,`SheetProcessedDataProvider.prefetchSheetProcessedData: unable to prefetch SPD, error='${sd.message}', isExpected=${Od}. Remaining attempts=${this.z5d}...`);0<this.z5d?this.ike():this.iN.u5a({success:!1,entriesCount:this.exb,abortReason:"failedAttemptsLimit"})})}}}LGk(){let G=!0,da;--this.Gcg;0>this.Gcg&&(da="iterationLimit",G=!1);this.Pii&&(da="maxEntriesExceeded",G=!1);G||(this.iN.u5a({success:!1,
entriesCount:this.exb,abortReason:da}),wa.ULS.sendTraceTag(507635018,0,50,`SheetProcessedDataProvider.shouldAttemptPrefetch: unable to prefetch all SPDs, reason=${da}`));return G}get Pii(){return 1E3<=this.exb}get exb(){var G=this.$.sa.items;let da=0;for(const $a of G)G=$a.sheetProcessedData,Object(xc.d)(G)&&(da+=G.value.M2a);return da}get RHh(){let G=0;const da=this.$.sa.items;for(const $a of da)G+=Object(xc.d)($a.sheetProcessedData)?1:0;return G}};xh=Object(oc.__decorate)([Object(Wc.d)(Qc.If),Object(oc.__param)(0,
Object(Qc.Lb)()),Object(oc.__param)(1,Object(Qc.dd)()),Object(oc.__param)(2,Object(Qc.Dg)())],xh);Object(ka.a)(xh,"SheetProcessedDataPrefetcher",null,[]);var qh=a(242),Zh=a(128),$h=a(593);class hh extends pa.a{constructor(G,da,$a,Sb){super();this.value=null;this.$=Sb;this.XYd=G;this.YE=da;this.qlh=$a}kyh(G){this.addHandler("EnabledStateChanged",G)}get isEnabled(){return this.YE}set isEnabled(G){G!==this.YE&&(this.YE=G,Fd.a.eo(this.$)&&appChrome.api.dispatch(appChrome.actions.toggleButton("Toggle"+
this.XYd.replace(" ","")+"Button",G)),this.raiseEvent("EnabledStateChanged"))}get isVisible(){return this.isEnabled&&!!this.value}get so(){return this.value?String.format(ha.a.instance.$g(79),this.XYd,this.value):this.XYd}get XJc(){return this.qlh}}Object(ka.a)(hh,"StatusBarAggregateControl",pa.a,[593]);class Gh extends pa.a{constructor(G){super();this.controls=new Qa.a(!1);this.GDe=null;this.Hce=()=>{this.raiseEvent("AggregatesChanged")};this.$=G;this.Aka(0,415,"Average",!0);this.Aka(1,416,"Count",
!0);this.Aka(2,417,"NumericalCount",!1);this.Aka(3,418,"Minimum",!1);this.Aka(4,419,"Maximum",!1);this.Aka(5,420,"Sum",!0)}jxh(G){this.addHandler("AggregatesChanged",G)}$hk(G){this.removeHandler("AggregatesChanged",G)}get ndb(){return this.GDe||Gh.gpf}set ndb(G){var da;G=G||Gh.gpf;if(G!==this.ndb)if(this.xOa(0,G.Average),this.xOa(1,G.Count),this.xOa(2,G.NumericalCount),this.xOa(3,G.Minimum),this.xOa(4,G.Maximum),this.xOa(5,G.Sum),this.GDe=G,Fd.a.eo(this.$))if(xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8624907_movingStatusBarAggregatesToDispatch")){const $a=
[];null===(da=this.controls)||void 0===da?void 0:da.forEach(Sb=>{const Mc=Sb.value;Sb.key.startsWith("Query")&&($a.push(appChrome.actions.updateControlHiddenState(Sb.key,!Mc.isVisible)),$a.push(appChrome.actions.setControlLabel(Sb.key,Mc.so)))});0<$a.length&&appChrome.api.dispatch($a)}else this.Hce();else this.Hce()}dispose(){Ia.a.Ni(this.controls.values);this.controls.clear();super.dispose()}GIa(G){return this.controls.getItem(G)}Ith(G,...da){G=this.GIa(G.toString());for(const $a of da)this.controls.add($a,
G)}Aka(G,da,$a,Sb){da=new hh(ha.a.instance.Ba(da),Sb,$a,this.$);da.kyh(this.Hce);this.controls.add(G.toString(),da)}xOa(G,da){this.GIa(G.toString()).value=da}static get gpf(){Gh.aDa||(Gh.aDa={},Gh.aDa.Average=Gh.aDa.Count=Gh.aDa.NumericalCount=Gh.aDa.Minimum=Gh.aDa.Sum=null);return Gh.aDa}}Gh.aDa=null;Object(ka.a)(Gh,"StatusBarAggregateControlCollection",pa.a,[]);var Mh=a(391),Bi=a(4),$i=a(209),Hi;const zh=[{odb:0,name:"Average",e8a:-1015637685,pdb:1,Oib:!0},{odb:1,name:"Count",e8a:1957769939,pdb:3,
Oib:!1},{odb:2,name:"NumericalCount",e8a:-1292677035,pdb:2,Oib:!1},{odb:3,name:"Minimum",e8a:405783320,pdb:5,Oib:!0},{odb:4,name:"Maximum",e8a:1210824414,pdb:4,Oib:!0},{odb:5,name:"Sum",e8a:1265371067,pdb:9,Oib:!0}];let rj=Hi=class{constructor(G,da){this.statusBarManager=void 0===da?null:da;this.Bxc=this.O0c=this.P0c=this.N0c=null;this.fob=new Qa.a(!0);this.tXg=0;this.U_g=$a=>{const Sb=this.ha.qa.activeCell.clone(),Mc=Pe.d(this.ha.qa.selectedRanges);var sd=this.$.na;const Od=null===sd||void 0===sd?
void 0:sd.sheetId,se=null===sd||void 0===sd?void 0:sd.hash,Ye=this.$.ea.gk,hf=this.$.ea.pD;sd=this.$.listSeparator;const ag=Pe.j(Pe.K(Mc),sd,this.$,!1),Jg=`=${this.Ej.config.localeInfo.getWorksheetFuncName(485)}({0}${sd}5${sd}{1})`;Promise.all(zh.map(tg=>this.Ej.evalFormula(String.format(Jg,tg.pdb,ag),Sb,void 0,tg.Oib?excelOnlineCalc.calc.evalFormulaFormatAggregate():excelOnlineCalc.calc.evalFormulaFormatKnown(0)))).then(tg=>{var Xg;const hi=this.ha.qa.selectedRanges,xj=this.ha.qa.activeCell,zi=null===
(Xg=this.$.na)||void 0===Xg?void 0:Xg.sheetId;if(Pe.W(Mc,hi)&&Sb.equals(xj)&&Od===zi){Xg=[];for(var Gi of tg.entries()){[,tg]=Gi;if(void 0===(null===tg||void 0===tg?void 0:tg.formatted)||!excelOnlineCalc.util.isSuccess(tg.formatted)||!excelOnlineCalc.util.isSuccess(tg.value)){this.hke();return}tg=this.Ej.MM.renderValue(tg.formatted.value,excelOnlineCalc.numfmt.renderInfiniteWidth);if(!excelOnlineCalc.util.isSuccess(tg)){this.hke();return}tg=excelOnlineCalc.numfmt.renderedValueToString(tg.value);Xg.push(tg)}Gi=
{};for(var Ai of zh)Gi[Ai.name]="";Ai=Xg[1];tg=Xg[2];if(1<+Ai&&(Gi.Count=Ai,0<+tg))for(const ak of zh.entries()){const [mj,Ek]=ak;Gi[Ek.name]=Xg[mj]}this.X5b(Gi);this.ZUk(Gi,Ai,Ye,hf,Mc,Sb,Od,se,$a)}}).catch(tg=>{wa.ULS.sendTraceTag(537151266,0,10,`TryToCalculateAggregatesUsingCalc: in catch, reason: ${JSON.stringify(tg)}`);this.hke()})};this.tj=()=>{this.x1g()};this.onBlockCacheItemChanged=($a,Sb)=>{$a=Sb.Ti.hash;Sb=Sb.Ti.block;const Mc=Sb.gfa;if(Sb.state&4&&Mc&&Mc!==this.fob.getItem($a)){this.fob.add($a,
Mc);var sd=($a=Sb.el)?fc.e($a.getRowNumbers(),$a.getColumnNumbers()):null;qh.a.any(this.ha.qa.selectedRanges,Od=>Od.yi(sd))&&this.x1g()}};this.Ww=($a,Sb)=>{this.fob.remove(Sb.Ti.hash)};this.xj=()=>{this.$.ka.Lh(29,$a=>{this.statusBarManager=$a;$a.DL(this);wa.ULS.sendTraceTag(537151265,0,50,"StatusBarAggregateManager.OnWorkbookOpened: after AddFeatureRootUser")})};this.Oi=($a,Sb)=>{!$a.Ph&&dg.b(Sb)&&this.statusBarManager&&(this.statusBarManager.$I(this),this.statusBarManager=null,wa.ULS.sendTraceTag(537151264,
0,50,"StatusBarAggregateManager.OnSessionIdChanged: after RemoveFeatureRootUser"))};this.GVk=()=>{let $a;const Sb=this.ha.qa.selectedRanges;(()=>{let Mc=this.R_k(Sb);({Jnc:$a}=Mc);return Mc})().returnValue?this.X5b($a):this.aEg()};this.aEg=()=>{var $a;const Sb=Pe.d(this.ha.qa.selectedRanges),Mc=this.ha.qa.activeCell.clone(),sd=null===($a=this.$.na)||void 0===$a?void 0:$a.sheetId;this.S8f(Mc,Sb,Od=>{var se;const Ye=this.ha.qa.selectedRanges,hf=this.ha.qa.activeCell,ag=null===(se=this.$.na)||void 0===
se?void 0:se.sheetId;Pe.W(Sb,Ye)&&Mc.equals(hf)&&sd===ag&&this.X5b(Od.Result)})};this.initData(G);G.Ma.zka(this);this.Y2e=xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AlwaysTestCalcResult",!1);this.$=G;this.da=fc.f(this.$);this.ola=Za.AFrameworkApplication.$i;this.Bp=wd.a.Tg;this.oFa=new Gh(this.$);this.$.ea.uq(this.Oi);this.$.nr(this.xj);this.ha.Cw(this.tj);this.ha.add_activeCellChanged(this.tj);this.za.Vy(this.onBlockCacheItemChanged);this.za.wT(this.Ww);for(const $a of zh)this.PDk($a.odb,
$a.name,$a.e8a);this.statusBarManager&&this.statusBarManager.DL(this);void Wc.a.resolve(Qc.E,{va:1}).then($a=>this.Ej=$a);void Wc.a.hj(Qc.wd).then($a=>this.instantaneousSupportInformationManager=$a)}Xx(G){this.oFa.jxh(G)}Jx(G){this.oFa.$hk(G)}get ndb(){return this.oFa.ndb}X5b(G){this.oFa.ndb=G}get za(){return this.da.za}get ha(){return this.da.ha}dispose(){this.$&&(this.$.ea.pq(this.Oi),this.$.Pr(this.xj),this.ha.$w(this.tj),this.ha.remove_activeCellChanged(this.tj),this.za.Fy(this.onBlockCacheItemChanged),
this.za.rV(this.Ww),this.C$e());this.statusBarManager&&(this.statusBarManager.$I(this),this.statusBarManager=null);Ia.a.Ni([this.N0c,this.P0c,this.O0c,this.oFa]);this.$=this.oFa=this.O0c=this.P0c=this.N0c=null;this.fob&&(this.fob.clear(),this.fob=null)}hy(G,da){return this.GIa(G)&&this.BHf(G,da)?!0:!1}BHf(G,da){const $a=this.GIa(G);if(!$a)return!1;const Sb=$a.so;if(G.endsWith("Label"))da.Visible=$a.isVisible,Fd.a.eo(this.$)?da.LabelText=Sb:da.Value=Sb;else if(G.endsWith("Button"))da.LabelText=Sb,
da.On=$a.isEnabled,Zh.FocusManager.instance().xr($h.AFrame.o1);else return!1;return!0}Yq(){return!0}Bi(){return!1}executeCommand(G,da){G=this.GIa(da.command);if(!G)return $i.a(da.command);G.isEnabled=!G.isEnabled;this.Ywj(G.XJc,G.isEnabled);return gf.Task.Va(!0)}ni(G,da){return!!this.GIa(da.command)}Ji(){return!1}S8f(G,da,$a){var Sb=this.$;this.C$e();if(this.$.ea.Ph){var Mc=Sb.pa.ta;G=Pe.p(G,Sb);da=Pe.s(da,Sb);Sb=Mc.Za(1,null);Sb.activeCell=G;Sb.selectedRanges=da;this.Bxc=ec.h(Mc,"GetStatusBarAggregates",
Sb,$a,null,null,null,0)}}R_k(G){let da,$a=Hi.T_g(G);({Jnc:da}=$a);return{returnValue:$a.returnValue||this.hFh(G)&&this.eFh(G),Jnc:da}}ZUk(G,da,$a,Sb,Mc,sd,Od,se,Ye){const hf=this.Y2e?1:.05,ag=this.Y2e?1E3:20;if(Ye||!(this.tXg>ag||Math.random()>hf))this.tXg++,this.S8f(sd,Mc,Jg=>{var tg,Xg,hi,xj;if(!pb.a(Jg)){var zi=this.ha.qa.selectedRanges,Gi=this.ha.qa.activeCell,Ai=null===(tg=this.$.na)||void 0===tg?void 0:tg.sheetId;tg=Jg.StateId;if(Pe.W(Mc,zi)&&sd.equals(Gi)&&Od===Ai&&$a===this.$.ea.gk&&Sb===
this.$.ea.pD&&$a===tg){var ak=Jg.Result;tg={};const Al={};Ai=!0;for(var mj of zh){var Ek=ak[mj.name],rl=G[mj.name];const Bl=Ek===rl;tg[mj.name]=Bl;Al[mj.name]=[Ek.length,rl.length];Ai&&(Ai=Bl)}({category:Gi}=this.instantaneousSupportInformationManager?this.instantaneousSupportInformationManager.L_k(null!==(xj=null===(hi=null===(Xg=this.da.kh(Gi))||void 0===Xg?void 0:Xg.cell)||void 0===hi?void 0:hi.Vn)&&void 0!==xj?xj:0):{category:"uninitialized"});Xg=zi.length;zi=Pe.b(zi);hi=this.da.QNf()||this.da.PNf();
mj=this.da.Pg;xj=mj.C0b;mj=bd.c(sd,mj.Hm,mj.Sm,this.da.rowsPerBlock,this.da.columnsPerBlock,this.da.mj);mj=mj.X+"_"+mj.Y+"_"+mj.PaneType;ak=ak.Count;Ek=G.Count;rl=this.da.Yg.Azc(Mc);Jg=`StatusBarAggregateManager.testCalcResult: allCorrect: ${Ai}, ${JSON.stringify(tg)}, numberFormatCategory: ${Gi}, resLength(server,calc): ${JSON.stringify(Al)}, stateId: ${$a}, latestSuccessfulStateId: ${Sb}, prevSheetId: ${Od}, prevSheetHash: ${se}, numOfRanges: ${Xg}, numOfCells: ${zi}, prevActiveCell: ${sd}, prevSelectedRanges: ${Mc.join(";")}, sheetHasHidden: ${hi}, panesState: ${xj}, blockPositionString: ${mj}, ReportCalcState: ${Jg.ReportCalcState}, CalcComplete: ${Jg.CalcComplete}, serverCount: ${ak}, calcCount: ${Ek}, calcCountUnfiltered: ${da}, enumeratorCount: ${rl}, forceTestResult: ${Ye}`;
wa.ULS.sendTraceTag(520426510,0,50,Jg);Ai||Ye||window.setTimeout(()=>{this.U_g(!0)},100)}}})}hFh(G){const da=this.da.Hp;return!!da&&qh.a.all(G,$a=>da.contains($a))&&qh.a.all(G,$a=>!this.da.mj.Pxa($a))}eFh(G){if(500<Pe.b(G))return!1;const da=this.Bp.qk;G=this.da.Lea("StatusBarAggregateManager.AreAllCellsEmpty",G);try{for(let $a=0;G.$$mn();$a++)if(G.$$cu().UP||!($a%25)&&100<xd.c(this.Bp,da))return!1}finally{G&&G.dispose()}return!0}GIa(G){return this.oFa.GIa(G)}PDk(G,da,$a){this.oFa.Ith(G,"Query"+da+
"Label","Query"+da+"Button",$a.toString())}x1g(){var G;if(this.$.wj&4&&!this.da.isEditing&&!this.da.Pp){var da;(()=>{let $a=Hi.T_g(this.ha.qa.selectedRanges);({Jnc:da}=$a);return $a})().returnValue?this.X5b(da):(this.X5b(null),(null===(G=this.Ej)||void 0===G?0:G.jEc)?this.Etk():this.N0c=gc.AsyncMethodContext.$B(this.GVk,500,Mb.a.JRk,this.N0c))}}Etk(){this.O0c=gc.AsyncMethodContext.$B(()=>this.U_g(!1),10,Mb.a.KRk,this.O0c)}hke(){this.P0c=gc.AsyncMethodContext.$B(this.aEg,500,Mb.a.IRk,this.P0c)}C$e(){this.Bxc&&
(this.ola.HD(this.Bxc.TC),this.Bxc=null)}Ywj(G,da){const $a={};$a.a=this.$.ua.UserSessionId;$a.b=G;$a.c=da;Tg.b().tl(29,$a)}initData(G){const da=Mh.a.Nda;for(const $a of zh)da($a.e8a,Fd.a.eo(G)?Bi.a.vk|8192:Bi.a.vk,0,0)}static T_g(G){return{returnValue:1===G.length&&G[0].isSingle,Jnc:null}}};rj=Hi=Object(oc.__decorate)([Object(Wc.d)(Qc.dg),Object(oc.__param)(0,Object(Qc.Lb)()),Object(oc.__param)(1,Object(Nc.l)())],rj);Object(ka.a)(rj,"StatusBarAggregateManager",null,[544,2,161,162,39]);var Hj=a(523),
Ii=a(932),Cg=a(225);class Wf{constructor(){this.Aqh=new Wb.a;this.Bqh=new Wb.a}get X7a(){return this.Aqh}get MXg(){return this.Bqh}get Ly(){return this.vVk}ywh(G,da){this.X7a.add(G);this.MXg.add(da)}zwh(G,da){this.vVk={v3d:G,e2d:da}}}Object(ka.a)(Wf,"ThemeInfoCache",null,[]);var sj=a(43);let ii=class{constructor(G){this.X7a=this.qZ=null;this.BFc=!1;this.Ote=null;this.TKc=new Set;this.Kwb=this.Mbd=!1;this.NNb=0;this.pRj=da=>{this.BFc=!1;if(!da||pb.a(da))wa.ULS.sendTraceTag(556656004,0,15,`ThemesManager: The obtained result has errors, [Error: ${da?
lb.a.Kh(da.Errors):"(no result)"}]`),this.HFg();else if(this.NNb=0,da=da.Result){null!==this.qZ&&this.XWh(da);this.qZ=new Wf;this.X7a=da.ThemeColors;this.Ote=[];for(var $a=0;10>$a;$a++)this.Ote.push(Ii.a.YIa(Cg.a.mM(this.X7a[$a])));for($a=0;6>$a;$a++)for(let Sb=0;10>Sb;Sb++){const Mc=rc.a.Wha(rc.a.c2(this.X7a[10*$a+Sb])),sd=Ii.a.YNi($a,Sb,this.Ote[Sb],this.X7a[Sb]);this.qZ.ywh(Mc,sd)}this.qZ.zwh(da.MinorFont,da.MajorFont);this.Kwb=!1;Fd.a.nl()&&Hj.a.Ovj([da.MajorFont,da.MinorFont]);xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NewDefaultTemplate",
!1)&&xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NewOfficeDefaultThemeSurvey",!1)&&"Aptos Narrow"===da.MinorFont&&(da=sj.a.instance.Tfa(new Date),27E4>da?window.setTimeout(()=>{this.$.ei(-569754003,-1,0,null)},27E4-da):this.$.ei(-569754003,-1,0,null));this.Mbd=!1;this.wpa()}else wa.ULS.sendTraceTag(556656003,0,10,"ThemesManager: The obtained ThemeInfo is null")};this.oRj=()=>{this.BFc=!1;this.HFg()};this.HFg=()=>{3>this.NNb?(this.NNb++,wa.ULS.sendTraceTag(509669709,0,50,`ThemesManager::retryFetchThemeInfo - Retry fetchThemeInfo API count = ${this.NNb}`),
this.WHa(null,!0)):(this.NNb=0,wa.ULS.sendTraceTag(509669708,0,15,"ThemesManager::retryFetchThemeInfo - Maximum retry count for fetchThemeInfo API has reached."))};this.F_b=()=>{this.qZ&&(wa.ULS.sendTraceTag(537150473,0,50,"ThemesManager: OnReloadCache"),this.Kwb=!0,this.WHa(null,!0))};this.Oi=(da,$a)=>{this.qZ&&(wa.ULS.sendTraceTag(537150472,0,50,"ThemesManager: OnSessionIdChanged"),$a.rM&&(this.Mbd=!0))};this.xj=(da,$a)=>{!$a.Hl||xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8650736_SilentReloadEditModeOnlyMFP")&&
!Hg.HelperMethods.vXc(this.$)||this.WHa(null,!0)};this.NM=()=>{this.TKc.clear()};this.$=G;this.$.ea.NN(this.F_b);this.$.ea.uq(this.Oi);this.$.Ma.fGb(this.NM);xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8557769_fetchThemeInfoViewToEdit")&&this.$.nr(this.xj)}dispose(){var G,da,$a,Sb,Mc,sd,Od;xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8557769_fetchThemeInfoViewToEdit")&&(null===(da=null===(G=this.$)||void 0===G?void 0:G.ea)||void 0===da?void 0:da.wP(this.F_b),null===(Sb=null===($a=this.$)||void 0===
$a?void 0:$a.ea)||void 0===Sb?void 0:Sb.pq(this.Oi),null===(sd=null===(Mc=this.$)||void 0===Mc?void 0:Mc.Ma)||void 0===sd?void 0:sd.c3b(this.NM),null===(Od=this.$)||void 0===Od?void 0:Od.Pr(this.xj))}get Lwb(){return!this.qZ||this.Kwb?null:this.qZ.X7a}get LXg(){return!this.qZ||this.Kwb?null:this.qZ.MXg}get Ly(){return!this.qZ||this.Kwb?null:this.qZ.Ly}get k0f(){return this.Mbd}WHa(G,da){if(this.$.isEditMode||(void 0===da?0:da))if(!this.qZ||this.k0f||this.Kwb)if(G&&""!==G&&this.TKc.add(G),!this.BFc){this.BFc=
!0;G=this.$.pa.ta;da=this.pRj;var $a=this.oRj;const Sb=G.Za(1,null);ec.h(G,"GetThemeInfo",Sb,da,$a,null,null,4)}}getThemeColor(G){let da,$a=-1;da=-1;if(!this.Lwb)return wa.ULS.sendTraceTag(537150475,0,10,"ThemesManager: ThemeColorsList is null"),{returnValue:!1,themeIndex:-1,sPa:da};for(let Sb=0;Sb<this.Lwb.count;Sb++)if(G===this.Lwb.ma(Sb)){$a=Sb;break}if(-1!==$a)return da=Math.floor($a/10),{returnValue:!0,themeIndex:$a%10,sPa:da};wa.ULS.sendTraceTag(537150474,0,10,"ThemesManager: Couldn't find theme color in cache.");
return{returnValue:!1,themeIndex:-1,sPa:da}}wpa(){for(const G of this.TKc)this.$.frame.wA(G);this.TKc.clear()}XWh(G){const da=this.qZ.Ly.e2d;this.qZ.Ly.v3d===G.MinorFont&&da===G.MajorFont||wa.ULS.sendTraceTag(512230155,0,50,"ThemesManager.compareThemeInfoCache: Theme Fonts are updated")}};ii=Object(oc.__decorate)([Object(Wc.d)(Qc.og),Object(oc.__param)(0,Object(Qc.Lb)())],ii);Object(ka.a)(ii,"ThemesManager",null,[543,2]);var aj=a(1010);class rh{static aEi(G){try{return caches.open(rh.QEe).then(da=>
da.match(G))}catch(da){return Promise.reject(null)}}static BIa(G,da){try{return rh.aEi(G).then($a=>$a&&Number.parseInvariant($a.headers.get("cachedTime"))>Date.now()-da?Promise.resolve($a.text().toLocaleString()):Promise.reject("Not found")).catch(()=>Promise.reject("Cache returned undefined"))}catch($a){return Promise.reject(null)}}static store(G,da){try{return caches.open(rh.QEe).then($a=>{$a.put(G,da).then(()=>!0);return!1}).catch(()=>Promise.resolve(!1))}catch($a){return Promise.resolve(!0)}}static dSk(G,
da){const $a={};$a.body=da;const Sb={};Sb.cachedTime=Date.now().toString();$a.headers=Sb;da=new Response(da,$a);rh.store(G,da).then(()=>!0)}}rh.QEe="ConsentState";Object(ka.a)(rh,"CacheManager",null,[]);class Ji{constructor(){this.message=null;this.httpStatusCode=0}}Object(ka.a)(Ji,"HttpRequstToPromiseRejectData",null,[]);var Dh=a(72),Ld=a(386);class ze{constructor(G){this.c9=G}p6(G,da,$a,Sb,Mc,sd){Qf.a.sendTelemetryEvent(Object.assign(new Ld.a,{name:"Office.Online."+G,dataFields:[Object.assign(new Dh.a,
{name:"EventMessage",string:da}),Object.assign(new Dh.a,{name:"FormFactor",string:this.c9.formFactor}),Object.assign(new Dh.a,{name:"CorrelationId",string:this.c9.correlationId}),Object.assign(new Dh.a,{name:"AccountType",string:this.c9.accountType}),Object.assign(new Dh.a,{name:"OSVersion",string:this.c9.osVersion}),Object.assign(new Dh.a,{name:"AppId",string:this.c9.appId}),Object.assign(new Dh.a,{name:"ConsentSurface",string:"AppStart"}),Object.assign(new Dh.a,{name:"ConsentLanguage",string:this.c9.consentLanguage}),
Object.assign(new Dh.a,{name:"EventCode",string:$a}),Object.assign(new Dh.a,{name:"Region",string:this.c9.region}),Object.assign(new Dh.a,{name:"ModelType",string:Sb}),Object.assign(new Dh.a,{name:"ModelId",string:Mc}),Object.assign(new Dh.a,{name:"Platform",string:this.c9.os}),Object.assign(new Dh.a,{name:"ReConsentReason",string:""}),Object.assign(new Dh.a,{name:"ConsentType",string:sd})]}))}}Object(ka.a)(ze,"TelemetryLogger",null,[]);var Bj=a(237);class Ah{constructor(G,da,$a){this.Cfh="https://consent.config.office.com/consentcheckin/v1.0/consents";
this.Ga=G;this.vn=da;this.NEa=$a;this.WZ=new ze($a)}uWa(G,da){return new Promise(($a,Sb)=>{const Mc=this.Ga.vj("UCNoticeCheckinCallTimeoutMs",5E3);let sd=this.Ga.Xa("UCNoticeCheckinStateUrl");sd&&sd.length||(sd=this.Cfh);this.vn.Tda(sd,1,null,this.SPb(G),null,!1,0,Od=>{try{if(void 0===Od||null===Od||void 0===Od.data||null===Od.data||void 0===Od.data.responseData||null===Od.data.responseData){this.WZ.p6("UnifiedConsent.ConsentGetFailed","CheckInApi : Invalid response","711",null,null,null);const Ye=
String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}","UnifiedConsent.ConsentGetFailed");Sb(this.jR(Ye,Od))}else if(Od.data.httpStatus!==Bj.a.jN){this.WZ.p6("UnifiedConsent.ConsentGetFailed","CheckInApi : HTTP failure",Od.data.httpStatus.toString(),null,null,null);const Ye=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",
Od.data.httpStatus,"UnifiedConsent.ConsentGetFailed");Sb(this.jR(Ye,Od))}else{var se=da(Od.data.responseData);if(se)$a(se);else{this.WZ.p6("UnifiedConsent.ConsentGetFailed","CheckInApi : Consent values are empty","712",null,null,null);const Ye=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}","UnifiedConsent.ConsentGetFailed");Sb(this.jR(Ye,Od))}}}catch(Ye){this.WZ.p6("UnifiedConsent.ConsentGetFailed","CheckInApi : Unexpected failure",
"713",null,null,null),se=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",Ye,"UnifiedConsent.ConsentGetFailed"),Sb(this.jR(se,Od))}},Od=>{this.WZ.p6("UnifiedConsent.ConsentGetFailed","CheckInApi : Error in service call ",Od.data.httpStatus.toString(),null,null,null);const se=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, request - {1}",Od.data.httpStatus,"UnifiedConsent.ConsentGetFailed");
Sb(this.jR(se,Od))},null,void 0,void 0,2500,Mc)})}jR(G,da){const $a=new Ji;$a.message=G;$a.httpStatusCode=da&&da.data?da.data.httpStatus:-1;return $a}SPb(G){const da={};da["Accept-Language"]=this.NEa.consentLanguage;da.consentsurface="AppStart";da.platform="Web";da.formfactor=wf.a.D0?"Mobile":"Desktop";da["x-Cid"]=this.NEa.correlationId;da.Authorization="Bearer "+G;return da}}Object(ka.a)(Ah,"HttpRequestToPromiseUtility",null,[]);var Hh=a(133);class Ki{constructor(){this.accountType="MSA";this.modelType=
null;this.appEnv=0;this.emailId=this.deviceId=this.consentLanguage=this.appVersion=this.appId=this.appName=null;this.formFactor="Unknown";this.token=this.region=this.osVersion=this.os=null;this.useCache=!1;this.correlationId=this.userId=null;this.isDarkMode=!1}}Object(ka.a)(Ki,"WebSdkAdapterProps",null,[]);class Rh{constructor(G,da,$a,Sb){this.oKe=this.vra=this.jda=this.W8=null;this.h1j=Mc=>{if(void 0===Mc||null===Mc)return this.WZ.p6(Rh.mSa,"Checkin response undefined or null","705",this.W8,this.jda,
this.vra),null;try{const {hz:sd}=qd.d(Mc);return sd}catch(sd){this.WZ.p6(Rh.mSa,"Checkin response parse error : "+sd.message,"706",this.W8,this.jda,this.vra)}return null};this.D9a=Sb;this.Ga=G;this.aeh=$a;this.vn=da;this.NEa=this.getDimensions();this.WZ=new ze(this.NEa)}VQg(){"MSA"===(this.Ga.Xa("HostAuthType")||"").toUpperCase()&&rh.BIa(this.NEa.userId,this.Ga.vj("UCNoticeCheckinCacheTimeMs",862E5)).then(()=>{this.WZ.p6(Rh.mSa,"CacheFound","701",this.W8,this.jda,this.vra);return{}}).catch(()=>{this.aeh.execute(G=>
{G.JD("Consent",Rh.eqh).then(da=>{da.IsSuccess?(this.WZ.p6(Rh.mSa,"CheckInTokenSuccess","702",this.W8,this.jda,this.vra),this.SFi(da.Token).then($a=>{this.WNi($a);this.W8&&""!==this.W8&&G.JD("Consent",Rh.gqh).then(Sb=>{Sb.IsSuccess?(this.WZ.p6(Rh.mSa,"WebTokenSuccess","703",this.W8,this.jda,this.vra),this.AMk(Sb,this.W8)):this.WZ.p6(Rh.mSa,"WebTokenFailed : "+Sb.ErrorMessage,Sb.ErrorCode,this.W8,this.jda,this.vra);return{}});return{}})):this.WZ.p6(Rh.mSa,"CheckInTokenFailed : "+da.ErrorMessage,da.ErrorCode,
this.W8,this.jda,this.vra);return{}})})})}SFi(G){this.oKe=new Ah(this.Ga,this.vn,this.NEa);return this.oKe.uWa(G,this.h1j).then(da=>Promise.resolve(da),da=>Promise.reject("Error while getting result"+da))}WNi(G){for(const da of G.consentValues)if(da.needConsent&&!da.maxPromptsReached){this.jda=da.id;this.vra=da.consentType;this.W8=da.modelType;return}rh.dSk(this.NEa.userId,qd.c(G))}AMk(G,da){if(Hh.a("showConsentNotice")){const $a=document.createElement("div");document.body.appendChild($a);appChrome.api.showConsentNotice(this.JHi(G.Token,
da),$a)}else this.WZ.p6(Rh.Skh,"1JS : ShowConsentNotice API not found","704",this.W8,this.jda,this.vra)}JHi(G,da){const $a=this.NEa;$a.token=G;$a.modelType=da;return $a}getDimensions(){const G=this.QQd(this.Ga.Xa("SessionStartInfoJson"));return Object.assign(new Ki,{emailId:this.Ga.Xa("UserPrincipalName"),userId:this.Ga.Xa("LoggableUserId"),accountType:"AAD"===(this.Ga.Xa("HostAuthType")||"").toUpperCase()?"AAD":"MSA",appId:this.Ga.Xa("OfficeApplicationId"),appVersion:this.Ga.Xa("appVersion"),appName:"Application"in
G?G.Application:"",appEnv:this.D9a,consentLanguage:this.Ga.Xa("UICulture")||"en-US",formFactor:wf.a.D0?"Mobile":"Desktop",os:"Os"in G?G.Os:"",osVersion:"OsVersion"in G?G.OsVersion:"",region:this.Ga.Xa("region"),correlationId:Gb.a.create().toString(),isDarkMode:this.Ga.la("DarkModeIsOn"),useCache:!0})}QQd(G){let da={};try{da=qd.b(G)}catch($a){}return da}}Rh.gqh="https://consentservice.microsoft.com/web";Rh.eqh="https://consentservice.microsoft.com/checkin";Rh.Skh="UnifiedConsent.ConsentGetFailed";
Rh.mSa="UnifiedConsent.AuthTokenStatus";Object(ka.a)(Rh,"ConsentNoticeManager",null,[654]);class Cj{constructor(){this.Mh=null}get name(){return"Common.App.ConsentNoticeDialog"}ao(G){this.Mh=G;G.register(Rh,"Common.App.ConsentNoticeDialog.ConsentNoticeManager").as("Common.App.ConsentNoticeDialog.IConsentNoticeManager").hi().mi(()=>new Rh(Za.AFrameworkApplication.fa,Za.AFrameworkApplication.$i,Object(aj.a)(),Za.AFrameworkApplication.uva))}init(){Sf.a.instance.resolve("Common.App.ConsentNoticeDialog.IConsentNoticeManager")}dispose(){}static main(){Vc.a.instance.Lo(new Cj)}}
Object(ka.a)(Cj,"ConsentNoticeDialogPackage",null,[12,13]);let Li=class{constructor(){Type.registerNamespace("Common.App.ConsentNoticeDialog");Cj.main();Sf.a.instance.Qi("Common.App.ConsentNoticeDialog.IConsentNoticeManager").execute(G=>G.VQg())}};Li=Object(oc.__decorate)([Object(Wc.d)(Qc.ug)],Li);Object(ka.a)(Li,"UnifiedConsentAdapter",null,[]);var Eh=a(918);class Ih{constructor(G,da){this.viewportScenarioContext=G;this.zqa=da}dispose(){var G;null===(G=this.zqa)||void 0===G?void 0:G.FBa("dispose")}Moa(G){var da;
null===(da=this.zqa)||void 0===da?void 0:da.FBa("navigationStart",G)}cV(){var G;null===(G=this.zqa)||void 0===G?void 0:G.FBa("scrollEnd")}mdg(G){var da;null===(da=this.zqa)||void 0===da?void 0:da.FBa("activeItemChanged",G)}apg(){var G;null===(G=this.zqa)||void 0===G?void 0:G.FBa("viewportReachedRequiredStateId")}}Object(ka.a)(Ih,"ViewportObservedScenario",null,[]);var qi=a(683);const Si={navigationStart:"navigationStarted",scrollEnd:"unexpected",viewportReachedRequiredStateId:"unexpected",activeItemChanged:"unexpected",
zoomOrSizeChange:"idle",dispose:"disposed"},dj={idle:Si,navigationStarted:{navigationStart:"abortNavigationAndStartNew",scrollEnd:"scrollEnded",viewportReachedRequiredStateId:"navigationStarted",activeItemChanged:"abortNavigationAndStartActiveItemChange",zoomOrSizeChange:"navigationStarted",dispose:"disposed"},scrollEnded:{navigationStart:"abortNavigationAndStartNew",scrollEnd:"unexpected",viewportReachedRequiredStateId:"navigationEnd",activeItemChanged:"abortNavigationAndStartActiveItemChange",zoomOrSizeChange:"scrollEnded",
dispose:"disposed"},navigationEnd:Si,abortNavigationAndStartNew:Si,abortNavigationAndStartActiveItemChange:Si,unexpected:Si,disposed:{navigationStart:"disposed",scrollEnd:"disposed",viewportReachedRequiredStateId:"disposed",activeItemChanged:"disposed",zoomOrSizeChange:"disposed",dispose:"disposed"}},ri={navigationStart:"unexpected",scrollEnd:"unexpected",viewportReachedRequiredStateId:"unexpected",activeItemChanged:"activeItemChangeStarted",zoomOrSizeChange:"idle",dispose:"disposed"},Ig={idle:ri,
activeItemChangeStarted:{navigationStart:"duringActiveItemChange",scrollEnd:"unexpected",viewportReachedRequiredStateId:"navigationEnd",activeItemChanged:"abortNavigationAndStartActiveItemChange",zoomOrSizeChange:"activeItemChangeStarted",dispose:"disposed"},duringActiveItemChange:{navigationStart:"abortNavigationAndStartNew",scrollEnd:"duringActiveItemChange",viewportReachedRequiredStateId:"navigationEnd",activeItemChanged:"abortNavigationAndStartActiveItemChange",zoomOrSizeChange:"duringActiveItemChange",
dispose:"disposed"},navigationEnd:ri,abortNavigationAndStartNew:ri,abortNavigationAndStartActiveItemChange:ri,unexpected:ri,disposed:{navigationStart:"disposed",scrollEnd:"disposed",viewportReachedRequiredStateId:"disposed",activeItemChanged:"disposed",zoomOrSizeChange:"disposed",dispose:"disposed"}},Fh=new Ih({name:"ViewportObserverState.idle"});class si{constructor(G){var {Moa:da,A_b:$a,V7d:Sb}=G;this.ghi=()=>{const Mc=this.SA.viewportScenarioContext;this.SA.dispose();this.SA=Fh;this.A_b(Mc)};this.Urh=
Mc=>{this.cYe(Mc);this.SA=new Ih(Mc,new qi.a("idle",dj,this.ZP));this.SA.Moa(Mc)};this.Trh=Mc=>{this.cYe(Mc);this.SA=new Ih(Mc,new qi.a("idle",Ig,this.ZP));this.SA.mdg(Mc)};this.cYe=Mc=>{this.V7d(Mc);this.SA.dispose()};this.SA=Fh;this.Moa=da;this.A_b=$a;this.V7d=Sb;this.ZP={abortNavigationAndStartNew:this.Urh,abortNavigationAndStartActiveItemChange:this.Trh,navigationEnd:this.ghi}}dispose(){this.SA.dispose();this.SA=Fh}get SA(){return this.agh}set SA(G){G!==Fh&&this.Moa(G.viewportScenarioContext);
this.agh=G}get rmb(){return this.SA===Fh}rmg(G){this.rmb&&(this.SA=new Ih(G,new qi.a("idle",dj,this.ZP)));this.SA.Moa(G)}onActiveItemChanging(G){this.rmb&&(this.SA=new Ih(G,new qi.a("idle",Ig,this.ZP)));this.SA.mdg(G)}hOc(G){this.SA.cV();this.U0f(G)&&this.SA.apg();return this.SA.viewportScenarioContext}x6(G){this.U0f(G)&&this.SA.apg()}U0f(G){return void 0!==this.SA.viewportScenarioContext.J3b&&G>=this.SA.viewportScenarioContext.J3b}}Object(ka.a)(si,"ViewportObserverState",null,[]);class Yh{constructor(G){this.da=
G}Ilj(G){if(!G)return!0;G.s_();return!this.da.Pg.aWd(G)&&this.da.xaa(G,!1)}}Object(ka.a)(Yh,"NavigationResultValidator",null,[]);let ti=class{constructor(G){this.da=G;this.qF=v();this.jkg=(da,$a)=>{this.nyb.rmg(this.Xld($a))};this.rlg=(da,$a)=>{this.nyb.rmg(this.Xld($a))};this.X2a=()=>{};this.onActiveItemChanging=()=>{this.nyb.onActiveItemChanging(this.Xld({name:"GridView.OnActiveItemChanged"}))};this.Rp=()=>{};this.hOc=()=>{const da=this.nyb.hOc(this.da.fra);this.qF.dispatchEvent("ScrollEnd",{viewportScenarioContext:da})};
this.x6=(da,$a)=>{$a.I_a&&this.nyb.x6($a.fra)};this.A_b=da=>{n(da)||"zoom"===da.name||this.mGj.Ilj(da.targetRange)||this.w$j(da);this.lwg(da,"complete")};this.x$j=da=>{this.qF.dispatchEvent("NavigationStart",{viewportScenarioContext:da})};this.v$j=da=>{this.lwg(da,"aborted")};xb.EwaSettings.q1a()?(wa.ULS.sendTraceTag(507606538,0,50,"ViewportObserver.ctor: flight is on"),this.mGj=new Yh(G),this.nyb=new si({Moa:this.x$j,A_b:this.A_b,V7d:this.v$j}),G.qmd(this.X2a),G.$.hI(this.Rp),G.$.Kt.QW(this.onActiveItemChanging),
G.Gmd(this.x6),G.view.$0e(this.jkg),G.view.mAh(this.rlg),G.view.s1e(this.hOc)):wa.ULS.sendTraceTag(507606539,0,50,"ViewportObserver.ctor: flight is off")}k_e(G,da){xb.EwaSettings.q1a()&&this.qF.addEventListener("NavigationStart",G,{signal:da})}j_e(G,da){xb.EwaSettings.q1a()&&this.qF.addEventListener("NavigationFail",G,{signal:da})}Wvh(G,da){xb.EwaSettings.q1a()&&this.qF.addEventListener("ScrollEnd",G,{signal:da,once:!0})}i_e(G,da,$a){xb.EwaSettings.q1a()&&this.qF.addEventListener("NavigationEnd",
G,{signal:da,once:$a})}dispose(){xb.EwaSettings.q1a()&&(this.da.Ufe(this.X2a),this.da.$.LK(this.Rp),this.da.$.Kt.hn(this.onActiveItemChanging),this.da.fge(this.x6),this.da.view.gCg(this.jkg),this.da.view.xkk(this.rlg),this.da.view.rCg(this.hOc),this.nyb.dispose())}w$j(G){this.qF.dispatchEvent("NavigationFail",{viewportScenarioContext:G})}lwg(G,da){this.qF.dispatchEvent("NavigationEnd",{viewportScenarioContext:G,navigationEndReason:da})}Xld(G){return void 0!==G.J3b?G:Object.assign({},G,{J3b:this.da.$.ea.gk})}};
ti=Object(oc.__decorate)([Object(Wc.d)(Qc.Cg),Object(oc.__param)(0,Object(Qc.dd)())],ti);Object(ka.a)(ti,"ViewportObserver",null,[]);class ni{constructor(){this.defaultRate=this.defaultCount=this.total=0;this.defaultCountByReason={"ActivateItem-with-SheetCtor":0,"ActivateItem-with-BootFromCache":0,"ActivateItem-with-OpenWorkbook":0,"ActivateItem-with-HttpError":0,"ActivateItem-with-InternalServerError":0,"ActivateItem-with-OnLoadOnDemandOccurred":0,"ActivateItem-with-PartialResult":0,NewSheet:0,NullActiveItem:0,
NotReceivedFromOpenWorkbook:0,PartialResult:0};this.prefetchInfo={success:!1,entriesCount:0,abortReason:void 0,maxEntries:void 0}}get reportName(){return"SPD"}}Object(ka.a)(ni,"SheetProcessedDataSessionEndsReport",null,[85]);class nj{constructor(){this.maxUsedRow=this.maxUsedColumn=0;this.isRowMaxPixelExceeded=!1}get reportName(){return"Viewport"}}Object(ka.a)(nj,"ViewportSessionEndsReport",null,[85]);class Ti{constructor(){this.hitCount=this.total=0;this.missCountByReason={};this.firstScrollSheetMissCount=
this.sheetOnBootMissCount=0}}Object(ka.a)(Ti,"BlockCacheAccessesTelemetry",null,[]);class ei{constructor(){this.sessionBoot=new Ti;this.postSessionBoot=new Ti;this.duringScroll=new Ti;this.blockCacheSize=this.numOfUsedPrefetchedBlocks=this.numOfPrefetchedBlocks=this.accessedBlocksDistinctCount=0}get reportName(){return"BlockCacheAccess"}}Object(ka.a)(ei,"BlockCacheAccessSessionEndsReport",null,[85]);class fi{constructor(){this.distinctCount=this.count=0;this.skeletonBlocksCounter={}}get reportName(){return"SkeletonCounter"}}
Object(ka.a)(fi,"SkeletonCounterSessionEndsReport",null,[85]);var fg=a(156);class uh extends pa.a{constructor(){super();this.k1b=[];this.YIj()}dispose(){var G;null===(G=this.mrg)||void 0===G?void 0:G.disconnect();super.dispose()}wzh(G){this.addHandler(uh.w3d,G)}Ujk(G){this.removeHandler(uh.w3d,G)}a6k(G){this.k1b.push({HOc:G,timestamp:performance.now()})}YIj(){var G;if(null===(G=PerformanceObserver.supportedEntryTypes)||void 0===G?0:G.includes("long-animation-frame"))try{this.mrg=new PerformanceObserver(da=>
{for(const $a of da.getEntries())this.pai($a)}),this.mrg.observe({type:"long-animation-frame"})}catch(da){wa.ULS.sendTraceTag(507799641,345,10,`observeLongAnimationFrame: observe({ type: "long-animation-frame" }) failed with: ${da}`)}}pai(G){const da=[],$a=G.startTime;G=$a+G.duration;let Sb=0;for(let Mc=0;Mc<this.k1b.length;++Mc){const sd=this.k1b[Mc],Od=sd.timestamp;if(Od>=$a&&Od<=G){da.push({Uzj:$a,Tzj:G,HOc:sd.HOc});Sb=Mc+1;break}if(Od>$a){Sb=Mc;break}}this.k1b=this.k1b.slice(Sb);0<da.length&&
this.raiseEvent(uh.w3d,{sEj:da})}}uh.w3d="mbdek";Object(ka.a)(uh,"ScrollMissingBlocksDetector",pa.a,[2]);var Jh=a(716);class sh{constructor(G,da,$a,Sb,Mc,sd,Od,se){this.At=sd;this.context=Od;this.j8=se;this.tqb=xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8720834_OnMarkAddedRefactor");this.Yrh=xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8731957_NavLatAbortWhenMarkLimitIsReached");this.sj=!1;this.gra=new AbortController;this.y2d=()=>{this.mark("scroll-end")};this.DTj=Ye=>{this.Pba(Ye)};this.da=
G;this.scenario=Sb;this.CRf=da;this.Ile=Mc;this.ETj=$a;this.mark("start",void 0,null===Od||void 0===Od?void 0:Od.timestamp);this.x6=(Ye,hf)=>{hf.I_a&&(Ye=hf.fra,this.AFa(Ye)?this.m2a(hf.timestamp):-1===Ye?this.mark("skeleton-blocks",void 0,hf.timestamp):0<=Ye&&this.mark("stale-blocks",new Jh.a(Ye),hf.timestamp))};this.da.Gmd(this.x6)}get MFc(){return!this.sj}get p0d(){return 50}dispose(){this.sj=!0;this.da.fge(this.x6)}nGj(){var G,da;null===(G=this.j8)||void 0===G?void 0:G.Wvh(this.y2d,this.gra.signal);
null===(da=this.j8)||void 0===da?void 0:da.i_e(this.DTj,this.gra.signal,!0)}AFa(G){return G>=this.CRf}bZ(G,da,$a){var Sb;this.mark("end",void 0,$a);this.log(G,da);this.rxe(G);null===(Sb=this.ETj)||void 0===Sb?void 0:Sb.call(this);this.At.c2c&&!this.At.OUb&&(G=this.At.markers,da=G[G.length-1],wa.ULS.shipAssertTag(507557020,0,!!da,"NavigationOperationLatencyTelemetry.scenarioEndLegacy: endMark is undefined!"),this.At.measure({from:G[0],b2:da,Y2d:this.scenario}))}mark(G,da,$a){this.Yrh?this.MFc&&!this.At.OUb&&
(G=this.At.mark(G,this.scenario,da,$a),this.At.OUb?this.bZ("aborted","markersMaxLengthReached"):this.tqb&&G&&this.sqb(G,da)):(G=this.At.mark(G,this.scenario,da,$a),this.sqb(G,da))}sqb(G){this.tqb&&this.At.c2c&&performance.mark(G.name,{startTime:G.timestamp})}log(G,da){G=JSON.stringify(this.TYa(G,da));this.j8?wa.ULS.sendTraceTag(507570122,0,50,`NavigationOperationLatencyTelemetry.log: ${G}`):wa.ULS.sendTraceTag(356298771,0,this.p0d,`NavigationOperationLatencyTelemetry.log: ${G}`)}TYa(G,da){return{scenario:this.scenario,
endReason:G,endDetails:da,initialStateId:this.CRf,duration:this.At.duration.toFixed(4),skeletonDuration:this.At.skeletonDuration.toFixed(4),staleDuration:this.At.staleDuration.toFixed(4),isMarkersMaxLengthReached:this.At.OUb}}m2a(G){this.bZ("complete",void 0,G)}Pba(G){const da=G.detail.navigationEndReason;G=G.detail.viewportScenarioContext;wa.ULS.shipAssertTag(507570121,0,this.MFc,`NavigationOperationLatencyTelemetry.scenraioEnd: scenario already ended, logging twice, name=${G.name}, endReason=${da}, requiredViewportStateId=${G.J3b}`);
this.bZ(da);this.dispose()}}Object(ka.a)(sh,"NavigationOperationLatencyTelemetry",null,[612]);class Nh{constructor(G,da,$a){this.name=G;this.timestamp=da;this.context=$a}toJSON(){return{n:this.name,t:this.timestamp.toFixed(4),c:this.context}}}Object(ka.a)(Nh,"NavigationMark",null,[]);class oi{constructor(G){G=void 0===G?!1:G;this.markers=[];this.c2c=xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8720834_OnMarkAddedRefactor")&&xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8697299_NavLatPerfMeasureV2")&&
!G&&!!performance.measure}get OUb(){return this.markers.length>=oi.cCj}get duration(){return this.endTime-this.startTime}get skeletonDuration(){return this.markers.reduce((G,da,$a)=>{$a=this.markers[$a-1];return"skeleton-blocks"===(null===$a||void 0===$a?void 0:$a.name)?G+(da.timestamp-$a.timestamp):G},0)}get staleDuration(){return this.markers.reduce((G,da,$a)=>{$a=this.markers[$a-1];return"stale-blocks"===(null===$a||void 0===$a?void 0:$a.name)?G+(da.timestamp-$a.timestamp):G},0)}get startTime(){return this.markers[0].timestamp}get endTime(){return this.markers[this.markers.length-
1].timestamp}mark(G,da,$a,Sb){if(!this.OUb)return this.Oo(G,$a,Sb)}Jkb(G){return void 0!==this.IEd(G)}measure(G){var {from:da,b2:$a,Y2d:Sb}=G,Mc;G=Object(Eh.e)(da)?this.IEd(da):da;const sd=Object(Eh.e)($a)?this.IEd($a):$a;if(G&&sd){if(this.c2c){var Od=null===(Mc=performance.measure(null!==Sb&&void 0!==Sb?Sb:`${G.name}->${sd.name}`,G.name,sd.name))||void 0===Mc?void 0:Mc.duration;void 0===Od&&wa.ULS.sendTraceTag(507536290,0,15,"NavigationLatencyTracker.measure: performance.measure returned undefined!")}return null!==
Od&&void 0!==Od?Od:sd.timestamp-G.timestamp}}Oo(G,da,$a){G=this.markers.push(new Nh(G,null!==$a&&void 0!==$a?$a:performance.now(),da));return this.markers[G-1]}IEd(G){for(let da=this.markers.length-1;0<=da;da--)if(this.markers[da].name===G)return this.markers[da]}}oi.cCj=50;Object(ka.a)(oi,"NavigationLatencyTracker",null,[]);class gi extends oi{constructor(){super(...arguments);this.NKa=!1;this.Zqa=[];this.Yhd=this.Fdd=this.Zhd=0}get skeletonDuration(){return this.Zhd}get missingBlocksDuration(){return this.Fdd}get skeletonAndMissingBlocksDuration(){return this.Yhd}W6h(){let G=
!1,da=void 0;for(let $a=0;$a<this.markers.length;$a++){const Sb=this.markers[$a];switch(Sb.name){case "missing-blocks-start":G?(this.Zqa.push(new Nh("skeleton-and-missing-blocks-start",Sb.timestamp)),G=!1):this.Zqa.push(Sb);break;case "missing-blocks-end":"missing-blocks-start"===(null===da||void 0===da?void 0:da.name)&&this.Zqa.push(Sb);break;case "only-missing-blocks-end":"only-missing-blocks-start"===(null===da||void 0===da?void 0:da.name)&&this.Zqa.push(Sb);break;case "skeleton-blocks":G||(G=
!0,this.Zqa.push(Sb));break;default:Sb.name!==(null===da||void 0===da?void 0:da.name)&&(G=!1,this.Zqa.push(Sb))}"start"!==Sb.name&&"scroll-end"!==Sb.name&&(da=Sb)}return this.Zqa}TOh(){let G=this.Zqa[0];for(let da=1;da<this.Zqa.length;++da){const $a=this.Zqa[da];if("start"!==$a.name&&"scroll-end"!==$a.name){switch(G.name){case "missing-blocks-start":case "only-missing-blocks-start":this.Fdd+=$a.timestamp-G.timestamp;break;case "skeleton-and-missing-blocks-start":this.Yhd+=$a.timestamp-G.timestamp;
break;case "skeleton-blocks":this.Zhd+=$a.timestamp-G.timestamp}G=$a}}}Oo(G,da,$a){$a=null!==$a&&void 0!==$a?$a:performance.now();G=new Nh(G,$a,da);this.markers.splice(this.LLi($a),0,G);return G}LLi(G){for(let da=this.markers.length-1;0<=da;da--)if(this.markers[da].timestamp<=G)return da+1;return 0}}Object(ka.a)(gi,"ScrollLatencyTracker",oi,[]);class Ui extends sh{constructor(G,da,$a,Sb,Mc,sd){super(G,da,$a,"scroll",Sb,new gi(!!sd),Mc,sd);this.EYb=new uh;this.BV={BRf:0,ARf:0,Bke:0,qke:0,ske:0,xke:0};
this.y2d=()=>{if(!this.NKa){this.mark("scroll-end");this.NKa=!0;var Od=this.da.view,se=Od.Xka.y-this.BV.BRf;0<se?this.BV.qke=se:0>se&&(this.BV.Bke=Math.abs(se));Od=Od.Xka.x-this.BV.ARf;0<Od?this.BV.xke=Od:0>Od&&(this.BV.ske=Math.abs(Od))}};this.nlg=(Od,se)=>{for(const Ye of se.sEj)Od=Ye.HOc?"only-missing-blocks-end":"missing-blocks-end",this.mark(Ye.HOc?"only-missing-blocks-start":"missing-blocks-start",void 0,Ye.Uzj),this.mark(Od,void 0,Ye.Tzj)};this.mlg=(Od,se)=>{this.EYb.a6k(se.JYf)};this.da.hAh(this.mlg);
this.EYb.wzh(this.nlg);G=this.da.view;this.BV.BRf=G.Xka.y;this.BV.ARf=G.Xka.x}get NKa(){return this.At.NKa}set NKa(G){this.At.NKa=G}dispose(){this.Mci();super.dispose()}m2a(G){this.NKa?this.bZ("complete",void 0,G):this.mark("content")}TYa(G,da){const $a=this.At.W6h();this.At.TOh();return Object.assign({},super.TYa(G,da),{missingBlocksDuration:this.At.missingBlocksDuration.toFixed(4),skeletonAndMissingBlocksDuration:this.At.skeletonAndMissingBlocksDuration.toFixed(4),userExperienceMarks:$a})}Mci(){var G,
da;this.da.ukk(this.mlg);null===(G=this.EYb)||void 0===G?void 0:G.Ujk(this.nlg);null===(da=this.EYb)||void 0===da?void 0:da.dispose();this.EYb=void 0}rxe(){const G=this.Ile.ScrollLatency;G.duration+=this.At.duration;G.skeletonDuration+=this.At.skeletonDuration;G.skeletonAndMissingBlocksDuration+=this.At.skeletonAndMissingBlocksDuration;G.missingBlocksDuration+=this.At.missingBlocksDuration;this.BV.Bke>G.maxScrollDistance.maxScrollUpDistancePx&&(G.maxScrollDistance.maxScrollUpDistancePx=this.BV.Bke);
this.BV.qke>G.maxScrollDistance.maxScrollDownDistancePx&&(G.maxScrollDistance.maxScrollDownDistancePx=this.BV.qke);this.BV.ske>G.maxScrollDistance.maxScrollLeftDistancePx&&(G.maxScrollDistance.maxScrollLeftDistancePx=this.BV.ske);this.BV.xke>G.maxScrollDistance.maxScrollRightDistancePx&&(G.maxScrollDistance.maxScrollRightDistancePx=this.BV.xke)}}Object(ka.a)(Ui,"ScrollOperationLatencyTelemetry",sh,[]);class ui{constructor(G){var {eua:da,logicToGotoDuration:$a,gotoDuration:Sb}=G;this.eua=da;this.logicToGotoDuration=
$a;this.gotoDuration=Sb}toJSON(){return{logic:this.eua.toFixed(4),endOfLogicToGoto:this.logicToGotoDuration.toFixed(4),"goto":this.gotoDuration.toFixed(4)}}}Object(ka.a)(ui,"GotoDurationInformation",null,[]);class Mi extends oi{get iLf(){if(xb.EwaSettings.C0()||xb.EwaSettings.vga()){if(!this.Jkb("end"))return wa.ULS.sendTraceTag(507574408,0,10,"GotoLatencyTracker.gotoOperationDuration: operation hasn't ended yet!"),new ui({eua:0,logicToGotoDuration:0,gotoDuration:0});if(this.Jkb("web-method-error")){var G=
this.measure({from:"start",b2:"web-method-error"}),da=this.measure({from:"web-method-error",b2:"end"});return new ui({eua:G,logicToGotoDuration:0,gotoDuration:da})}if(this.Jkb("business-logic-success")&&this.Jkb("goto-start")){G=this.measure({from:"start",b2:"business-logic-success"});da=this.measure({from:"business-logic-success",b2:"goto-start"});const $a=this.measure({from:"goto-start",b2:"end"});return new ui({eua:G,logicToGotoDuration:da,gotoDuration:$a})}if(this.Jkb("business-logic-success"))return G=
this.measure({from:"start",b2:"business-logic-success"}),da=this.measure({from:"business-logic-success",b2:"end"}),new ui({eua:G,logicToGotoDuration:0,gotoDuration:da});if(this.Jkb("goto-start"))return G=this.measure({from:"start",b2:"goto-start"}),da=this.measure({from:"goto-start",b2:"end"}),new ui({eua:0,logicToGotoDuration:G,gotoDuration:da});G=this.measure({from:"start",b2:"end"});return new ui({eua:0,logicToGotoDuration:0,gotoDuration:G})}}YMh(){return 0<=this.markers.findIndex(G=>Object(Eh.b)(G.name))}}
Object(ka.a)(Mi,"GotoLatencyTracker",oi,[]);class ej extends sh{constructor(G,da,$a,Sb,Mc,sd,Od){super(G,da,$a,Sb,Mc,new Mi(!!Od),sd,Od);this.xub=!1;this.K8d=()=>{this.AFa(this.da.fra)&&this.m2a()}}get p0d(){return 20}dispose(){this.xub&&(this.da.ha.Gba(this.K8d),this.xub=!1);super.dispose()}mark(G,da,$a){xb.EwaSettings.lFc()&&Object(Eh.b)(G)&&this.At.YMh()?this.bZ("aborted","MultipleBusinessLogicMarks"):(this.tqb||"business-logic-success"!==G||(wa.ULS.shipAssertTag(507570067,0,!this.xub,"SetFocusOnGotoOperationLatencyTelemetry.mark: selectionEndedBlockingRegistered is true"),
this.da.ha.v9(this.K8d),this.xub=!0),super.mark(G,da,$a))}sqb(G,da){this.tqb&&(super.sqb(G,da),"business-logic-success"===G.name&&(wa.ULS.shipAssertTag(507556764,0,!this.xub,"SetFocusOnGotoOperationLatencyTelemetry.onMarkAdded: selectionEndedBlockingRegistered is true"),this.da.ha.v9(this.K8d),this.xub=!0))}TYa(G,da){return Object.assign({},super.TYa(G,da),{gotoOperationDuration:this.At.iLf,marks:this.At.markers})}rxe(G){if(!xb.EwaSettings.lFc()||"complete"===G)if(xb.EwaSettings.C0||xb.EwaSettings.vga()){const da=
this.Ile.gotoScenarioLatency[this.scenario];da&&(da.count++,G=this.At.iLf,da.operationLogicDuration+=G.eua,da.logicToGotoDuration+=G.logicToGotoDuration,da.gotoDuration+=G.gotoDuration,da.duration+=this.At.duration,da.skeletonDuration+=this.At.skeletonDuration)}}}Object(ka.a)(ej,"GotoOperationLatencyTelemetry",sh,[]);class vi extends sh{constructor(G,da,$a,Sb,Mc,sd,Od){super(G,da,$a,Sb,Mc,new oi(!!Od),sd,Od);this.k3c=1;this.rmb=!1;this.m3i=()=>{const se=performance.now()-this.At.startTime;wa.ULS.sendTraceTag(507511395,
0,15,`ZoomOperationLatencyTelemetry.handleTimeout: timeout occurred after ${se}ms!`);this.x_c=void 0;this.bZ("aborted","timeout")};this.brb=this.da.kW;if(this.T_c=xb.EwaSettings.aWb())this.x_c=window.setTimeout(this.m3i,1E4)}get p0d(){return 20}get B7g(){return this.Lpa>this.brb?"zoom-in":"zoom-out"}dispose(){this.x_c&&(window.clearTimeout(this.x_c),this.x_c=void 0);super.dispose()}mark(G,da,$a){super.mark(G,da,$a);this.tqb||"zoom-level-set"!==G||(this.Lpa=null===da||void 0===da?void 0:da.kW,this.AFa(this.da.fra)&&
this.m2a($a))}sqb(G,da){if(this.tqb){super.sqb(G,da);if(this.At.c2c){var $a=this.At.markers;($a=$a[$a.length-2])&&G&&this.At.measure({from:$a,b2:G})}this.T_c?"zoom-level-set"===G.name?(this.Lpa=null===da||void 0===da?void 0:da.kW,wa.ULS.shipAssertTag(507543945,0,!!this.Lpa,`ZoomOperationLatencyTelemetry.onMarkAdded: zoomLevel is ${this.Lpa}!`)):"rezoom"===G.name?(this.rmb=!1,this.k3c++):"zoom-idle"===G.name&&(this.rmb=!0,this.AFa(this.da.fra)&&this.bZ("complete",void 0,G.timestamp)):"zoom-level-set"===
G.name&&(this.Lpa=null===da||void 0===da?void 0:da.kW,this.AFa(this.da.fra)&&this.m2a())}}AFa(G){return super.AFa(G)&&this.Lpa?this.Lpa===this.da.W$k:!1}m2a(G){this.T_c?(wa.ULS.shipAssertTag(507511424,0,!!this.Lpa,`ZoomOperationLatencyTelemetry.markWhenAllTheBlocksInViewportAreUpdated: zoom level not set! requiredZoomLevel=${this.Lpa}`),this.mark("zoom-blocks-updated",void 0,G),this.rmb&&this.bZ("complete",void 0,G)):super.m2a()}TYa(G,da){G=Object.assign({},super.TYa(G,da),{zoomType:this.B7g,caller:this.context.caller,
delayed:this.context.Tkf,isAnimation:1<this.k3c,zoomCount:this.k3c});this.T_c&&((da=this.At.measure({from:"start",b2:"zoom-blocks-updated",Y2d:"zoomDuration"}))&&(G.duration=da.toFixed(4)),da=1<this.k3c?this.At.measure({from:"rezoom",b2:"zoom-blocks-updated",Y2d:"lastRezoomDuration"}):void 0,G.lastRezoomDuration=da);return G}rxe(G){xb.EwaSettings.lFc()&&"complete"!==G||!this.Lpa||!(G=this.Ile.zoomScenarioLatency[this.B7g])||(G.count++,G.duration+=this.At.duration,G.skeletonDuration+=this.At.skeletonDuration,
G.staleDuration+=this.At.staleDuration)}}Object(ka.a)(vi,"ZoomOperationLatencyTelemetry",sh,[]);class wi{constructor(){this.maxScrollLeftDistancePx=this.maxScrollRightDistancePx=this.maxScrollDownDistancePx=this.maxScrollUpDistancePx=0}get reportName(){return"MaxScrollDistance"}}Object(ka.a)(wi,"MaxScrollDistanceSessionEndsReport",null,[]);class xi{constructor(){var G;this.missingBlocksDuration=this.skeletonAndMissingBlocksDuration=this.skeletonDuration=this.duration=0;this.isMissingBlocksSupported=
null===(G=PerformanceObserver.supportedEntryTypes)||void 0===G?void 0:G.includes("long-animation-frame");this.isScrollEndEventSupportedByBrowser=Hg.HelperMethods.isScrollEndEventSupportedByBrowser;this.maxScrollDistance=new wi}get reportName(){return"scrollOperationLatency"}}Object(ka.a)(xi,"ScrollOperationLatencySessionEndsReport",null,[]);class Vi{constructor(){this.skeletonDuration=this.gotoDuration=this.logicToGotoDuration=this.operationLogicDuration=this.duration=this.count=0}}Object(ka.a)(Vi,
"E2EOperationLatencySessionEndsReport",null,[]);class Ni{constructor(){this.staleDuration=this.skeletonDuration=this.duration=this.count=0}}Object(ka.a)(Ni,"ZoomOperationLatencySessionEndsReport",null,[]);class fj{constructor(){this.ScrollLatency=new xi;this.gotoScenarioLatency={[Eh.a.findNext]:new Vi,[Eh.a.gotoDialog]:new Vi};this.zoomScenarioLatency={["zoom-in"]:new Ni,["zoom-out"]:new Ni}}get reportName(){return"NavigationOperationsLatency"}}Object(ka.a)(fj,"NavigationOperationsLatencySessionEndsReport",
null,[85]);class tj{constructor(G,da,$a){this.da=G;this.j8=da;this.IVc=$a;this.gra=new AbortController;this.jkc=xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8704121_AddZoomNavContext");this.Moa=Sb=>{this.fRk(Sb.detail.viewportScenarioContext)};this.j8.k_e(this.Moa,this.gra.signal)}dispose(){this.gra.abort()}fRk(G){wa.ULS.shipAssertTag(507570112,0,void 0===this.vgb||!this.vgb.MFc,"ViewportOperationTelemetryManager.startNewScenario: expecting no running operation, but operation is still running");
if(this.jkc)if(n(G))this.vgb=new Ui(this.da,this.da.$.ea.pD,void 0,this.IVc,G,this.j8);else if(Object(Eh.c)(G.name))this.vgb=new ej(this.da,this.da.$.ea.pD,void 0,G.name,this.IVc,G,this.j8);else{wa.ULS.sendTraceTag(507549210,0,10,`ViewportOperationTelemetryManager.startNewScenario: unhandled scenario ${G.name}!`);return}else n(G)?this.vgb=new Ui(this.da,this.da.$.ea.pD,void 0,this.IVc,void 0,this.j8):this.vgb=new ej(this.da,this.da.$.ea.pD,void 0,G.name,this.IVc,void 0,this.j8);this.vgb.nGj()}}Object(ka.a)(tj,
"ViewportOperationTelemetryManager",null,[]);class ai{constructor(){this.docId=this.host=this.applicationMode=this.browserVersion=this.browser=""}get reportName(){return"SessionInfo"}}Object(ka.a)(ai,"SessionInfoSessionEndsReport",null,[85]);let bi=class{constructor(G,da,$a){this.$=G;this.da=da;this.j8=$a;this.gra=new AbortController;this.jVf=Hg.HelperMethods.IUb&&xb.EwaSettings.ghj();this.pnk=2E3;this.KXd=xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackingScrollAnimation",!1);this.jkc=
xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8704121_AddZoomNavContext");this.zTc=null;this.FVb=!1;this.Moa=Sb=>{Sb=Sb.detail.viewportScenarioContext;n(Sb)&&this.U7d(null,Sb)};this.U7d=(Sb,Mc)=>{this.KM?this.bZc("gotoOperationInProgress"):(!this.FVb&&this.KXd&&(this.FVb=fg.b(this.$).startTrackAnimation(Mc.event,"viewport_scroll")),this.L5h(Mc))};this.cV=()=>{this.bZc("scrollEnd");this.$.ea.Ul&&!this.KM&&this.DV&&(this.DV.y2d(),this.DV.AFa(this.da.fra)&&this.DV.bZ("complete"))};this.qmg=()=>{this.DV.dispose();
this.DV=void 0};this.Y7d=()=>{var Sb;null===(Sb=this.KM)||void 0===Sb?void 0:Sb.dispose();this.KM=void 0};this.xj=()=>{this.z_e()};this.onViewportChange=()=>{this.zTc=gc.AsyncMethodContext.$B(()=>{this.the()},this.pnk,Mb.a.the,this.zTc)};this.x6=(Sb,Mc)=>{-1===Mc.NK&&Mc.I_a&&this.r6k(Mc.hashCode)};this.t5h();this.z_e();this.v9i();this.$.nr(this.xj);this.jVf&&this.da.sGb(this.onViewportChange);xb.EwaSettings.kYd()&&(this.V$k=new tj(this.da,$a,this.iGj));xb.EwaSettings.jYd()?(xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MeasureOldBrowsersImpactOnInteractivity",
!1),this.j8.k_e(this.Moa,this.gra.signal)):Hg.HelperMethods.isScrollEndEventSupportedByBrowser&&this.da.view.$0e(this.U7d);this.da.view.s1e(this.cV);this.da.Gmd(this.x6)}dispose(){this.$.Pr(this.xj);xb.EwaSettings.jYd()?this.gra.abort():Hg.HelperMethods.isScrollEndEventSupportedByBrowser&&this.da.view.gCg(this.U7d);this.da.view.rCg(this.cV);xb.EwaSettings.kYd()&&this.V$k.dispose();this.jVf&&this.da.o3b(this.onViewportChange);Ia.a.Ni([this.zTc,this.DV,this.KM]);this.zTc=null;this.da.fge(this.x6);this.KM=
this.DV=this.da=this.$=null;this.FVb=!1}get s$b(){return this.cAa.viewport}get MOg(){return this.cAa.sheetProcessedData}get Iqd(){return this.cAa.RIh}get sOk(){return this.cAa.rOk}get $Yb(){return this.cAa.jGj}get iGj(){return this.cAa.kGj}get qoj(){return!!this.DV}Nnk(G){if(this.da.mj.isValid){if(this.s$b.maxUsedRow<G.bottom){this.s$b.maxUsedRow=G.bottom;const da=this.da.Fwa();this.s$b.isRowMaxPixelExceeded=!!da&&this.da.Eya(da.Sj,!0)}this.s$b.maxUsedColumn<G.right&&(this.s$b.maxUsedColumn=G.right)}}QDg(G){var da=
this.MOg;da.total+=1;const $a=Object(xc.e)(G);da.defaultCount+=$a?1:0;da.defaultRate=da.defaultCount/da.total;$a&&(da.defaultCountByReason[G.Mgb]+=1);da=Object(xc.d)(G);da||(wa.ULS.sendTraceTag(507574417,0,10,`ViewportTelemetryManager.reportSheetProcessedDataAccess: spd miss, reason=${G.reason}`),wa.ULS.shipAssertTag(507574416,0,!!G.reason,`ViewportTelemetryManager.reportSheetProcessedDataAccess: spd.reason is ${G.reason}!`));wa.ULS.shipAssertTag(507574415,0,null==this.$.na||null!=this.$.na.sheetProcessedData,
`SheetProcessedDataProvider.getActiveSheetProcessedData: invalid SPD availability state! activeItem=${this.$.na?"not null":"null"}, isHit=${da}`)}u5a(G){var {success:da,entriesCount:$a,abortReason:Sb,maxEntries:Mc,sheetCount:sd}=G;G=this.MOg;null!=da&&(G.prefetchInfo.success=da);null!=$a&&(G.prefetchInfo.entriesCount=$a);if(null!=Sb){const Od=G.prefetchInfo.abortReason;"workbookClosed"!==Sb||"notScheduled"!==Od&&"notStarted"!==Od?"workbookClosed"!==Sb&&(G.prefetchInfo.abortReason=Sb):G.prefetchInfo.abortReason=
`${Od}-workbookClosed`}null!=Mc&&(G.prefetchInfo.maxEntries=Mc);null!=sd&&(G.prefetchInfo.sheetCount=sd);wa.ULS.sendTraceTag(507574414,0,50,`ViewportTelemetryManager.reportSheetProcessedDataPrefetch: success=${da}, entriesCount=${$a}, abortReason=${Sb}, maxEntries=${Mc}`)}lhe(G,da,$a){var Sb,Mc;const sd=null!==(Mc=null===(Sb=this.$.na)||void 0===Sb?void 0:Sb.hash)&&void 0!==Mc?Mc:"";!this.LOg&&sd&&(this.LOg=sd);Sb=this.Iqd;this.$.ea.Ul?(this.qoj&&(!this.uxf&&sd&&(this.uxf=sd),this.wwe(Sb.duringScroll,
G,$a)),this.wwe(Sb.postSessionBoot,G,$a)):this.wwe(Sb.sessionBoot,G,$a);Sb.accessedBlocksDistinctCount+="WasNeverCached"===$a?1:0;Sb.numOfUsedPrefetchedBlocks+=da?1:0}znk(){this.Iqd.numOfPrefetchedBlocks+=1}xJa(G,da){if(this.$.ea.Ul)switch(G){case Eh.a.switchSheet:case Eh.a.insertSheet:case Eh.a.findNext:case Eh.a.gotoDialog:this.qkd(G);this.bZc("switchSheet|insertSheet|findNext");this.jkc&&wa.ULS.shipAssertTag(507549212,0,!da||Object(Eh.c)(da.name),`ViewportTelemetryManager.gotoNavigationStart: scenario=${G} got an invalid context = ${null===
da||void 0===da?void 0:da.name}!`);this.KM=new ej(this.da,this.$.ea.pD,this.Y7d,G,this.$Yb,da);break;case "zoom":this.qkd(G);this.jkc&&wa.ULS.shipAssertTag(507549211,0,"zoom"===da.name,`ViewportTelemetryManager.gotoNavigationStart: scenario=${G} got an invalid context = ${null===da||void 0===da?void 0:da.name}!`);this.KM=new vi(this.da,this.$.ea.pD,this.Y7d,G,this.$Yb,da);break;default:wa.ULS.shipAssertTag(507574413,0,!1,`ViewportTelemetryManager.navigationStart: Unexpected scenario name: ${G}`)}}lra(G){var da;
const $a=!!this.DV,Sb="zoom"===(null===(da=this.KM)||void 0===da?void 0:da.scenario);da=this.KM&&"zoom"!==this.KM.scenario;($a||da)&&this.qkd("zoom");Sb?this.KM.mark("rezoom"):this.KM=new vi(this.da,this.$.ea.pD,this.Y7d,"zoom",this.$Yb,G);return this.KM}oY(G,da){this.KM?Object(Eh.d)(this.KM.scenario,G)&&this.KM.mark(G,da):wa.ULS.sendTraceTag(507574412,0,50,`ViewportTelemetryManager.navigationMark: Marking ${G} for an invalid / non-existing scenario`)}Pba(G){var da;if(xb.EwaSettings.C0()||xb.EwaSettings.vga())switch(G){case Eh.a.findNext:case Eh.a.gotoDialog:null===
(da=this.KM)||void 0===da?void 0:da.bZ("complete");break;default:wa.ULS.shipAssertTag(507574411,0,!1,`ViewportTelemetryManager.scenarioEnd: Unexpected scenario name: ${G}`)}}wwe(G,da,$a){var Sb,Mc,sd;G.total+=1;G.hitCount+=da?1:0;da||(da=null!==(Mc=null===(Sb=this.$.na)||void 0===Sb?void 0:Sb.hash)&&void 0!==Mc?Mc:"",G.sheetOnBootMissCount+=da===this.LOg?1:0,G.firstScrollSheetMissCount+=da===this.uxf?1:0,G.missCountByReason[$a]=(null!==(sd=G.missCountByReason[$a])&&void 0!==sd?sd:0)+1)}L5h(G){this.DV?
this.DV.NKa&&(this.DV.bZ("aborted"),this.bZc("aborted"),this.DV=new Ui(this.da,this.$.ea.pD,this.qmg,this.$Yb,G)):this.DV=new Ui(this.da,this.$.ea.pD,this.qmg,this.$Yb,G)}bZc(G){this.KXd&&this.FVb&&(wa.ULS.sendTraceTag(507574410,0,50,`ViewportTelemetryManager.stopTrackAnimationIfRunning: reason: ${G}`),fg.b(this.$).stopTrackAnimation("viewport_scroll"));this.FVb=!1}t5h(){this.cAa={viewport:new nj,sheetProcessedData:new ni,RIh:this.Q0h(),rOk:new fi,jGj:new fj,yrl:xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8741920_SessionInfoReport")?
this.V5h():void 0,kGj:xb.EwaSettings.kYd()?new fj:void 0}}Q0h(){const G=new ei;G.blockCacheSize=this.da.za.tnc;return G}V5h(){var G,da,$a=this.$.ua;const Sb=new ai,{browser:Mc,version:sd,returnValue:Od}=Hg.HelperMethods.zYc($a.BrowserNameAndVersion);Od&&(Sb.browser=Mc,Sb.browserVersion=sd);Sb.host=$a.HostName;Sb.docId=$a.DocumentHostInfo.ServerDocId;$a=qd.b(Za.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());Sb.applicationMode=null!==(da=$a&&(null===(G=$a.ApplicationModeExtended)||
void 0===G?void 0:G.toString()))&&void 0!==da?da:"";return Sb}z_e(){this.$.ka.Lh(276,G=>{for(const da in this.cAa)this.cAa[da]&&G.r3(this.cAa[da])})}v9i(){this.E9i()}E9i(){this.u5a({success:!1,entriesCount:0,abortReason:"notScheduled",maxEntries:1E3})}the(){const G=this.da.uSh();0<G.size&&wa.ULS.sendTraceTag(507574409,0,50,`ViewportTelemetryManager.reportMissingBlocks: found ${G.size} missing blocks ${JSON.stringify(Array.from(G))}`)}r6k(G){let da=!1;const $a=this.sOk;$a.skeletonBlocksCounter[G]?
$a.skeletonBlocksCounter[G]+=1:($a.skeletonBlocksCounter[G]=1,da=!0);$a.count+=1;da&&($a.distinctCount+=1)}qkd(G){var da,$a,Sb,Mc;xb.EwaSettings.lFc()?(null===(da=this.KM)||void 0===da?void 0:da.bZ("aborted",`abortedBy:${G}`),null===($a=this.DV)||void 0===$a?void 0:$a.bZ("aborted",`abortedBy:${G}`)):(null===(Sb=this.KM)||void 0===Sb?void 0:Sb.bZ("aborted"),null===(Mc=this.DV)||void 0===Mc?void 0:Mc.bZ("aborted"))}};bi=Object(oc.__decorate)([Object(Wc.d)(Qc.Dg),Object(oc.__param)(0,Object(Qc.Lb)()),
Object(oc.__param)(1,Object(Qc.dd)()),Object(oc.__param)(2,Object(Qc.Cg)())],bi);Object(ka.a)(bi,"ViewportTelemetryManager",null,[541]);let ji=class extends pa.a{constructor(){super()}J1e(G){this.addHandler("ZCIEK",G)}ICg(G){this.removeHandler("ZCIEK",G)}Dnd(G){this.addHandler("ZCUIK",G)}Rge(G){this.removeHandler("ZCUIK",G)}kak(){this.raiseEvent("ZCIEK")}jak(){this.raiseEvent("ZCUIK")}lak(){this.raiseEvent("ZCEK")}};ji=Object(oc.__decorate)([Object(Wc.d)(Qc.Jg)],ji);Object(ka.a)(ji,"ZoomEventManager",
pa.a,[540]);var Wi=a(632),Ij=a(55),Ef=a(162),Ci=a(150),kf=a(111),uj=a(347),Zg=a(151),oj=a(423);class Xi{constructor(G,da){this.ulb=this.gDc=0;this.joc=null;this.fWf=!1;this.$=G;this.zoomManager=da;this.fWf=G.ZHc}rjj(){return fc.f(this.$).isEditing?(wa.ULS.sendTraceTag(537149795,0,50,"PinchToZoomAdapter.IsGesturePossible A cell is being edited -> don't allow pinch"),!1):this.$.ih.GF?(wa.ULS.sendTraceTag(537149794,0,50,"PinchToZoomAdapter.IsGesturePossible A modal dialog is opened -> don't allow pinch"),
!1):!0}DPj(G){this.joc=new Sys.UI.Point(Math.round(G.rIa.center.x),Math.round(G.rIa.center.y));this.gDc=this.zoomManager.zoom;this.ulb=G.rIa.scale;const da={["InitialZoom"]:this.gDc,["Location"]:"canvas",["InputMethod"]:G.oh};Zg.b(this.$).lj(Ci.a.V2j,da);wa.ULS.sendTraceTag(537149793,0,50,`PinchToZoomAdapter.OnGestureStart starting gesture. center (${this.joc.x},${this.joc.y}), initial zoom ${this.gDc}, initial scale ${this.ulb}`);this.cpb(G,"onGestureStart");return!0}CPj(G){if(!this.ulb)return wa.ULS.shipAssertTag(537149792,
0,!1,"PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be 0"),this.cpb(G,"OnGestureEvent"),!0;if(!isFinite(this.ulb))return wa.ULS.sendTraceTag(537149791,0,15,`PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be infinite. initialPinchScale=${this.ulb}`),this.cpb(G,"OnGestureEvent"),!0;const da=G.rIa.scale/this.ulb*this.gDc;this.zoomManager.y7g(da,this.joc);wa.ULS.sendTraceTag(537149790,0,50,`PinchToZoomAdapter.OnGestureEvent processing gesture. New zoom ${da}. Current scale ${G.rIa.scale}`);
this.cpb(G,"OnGestureEvent");return!0}BPj(G){this.zoomManager.z7g();wa.ULS.sendTraceTag(537149789,0,50,"PinchToZoomAdapter.OnGestureEnd end of gesture");this.cpb(G,"OnGestureEnd")}APj(G){wa.ULS.sendTraceTag(537149788,0,50,"PinchToZoomAdapter.OnGestureCancel gesture canceled");this.cpb(G,"OnGestureCancel")}cpb(G,da){var $a,Sb,Mc;this.fWf&&(wa.ULS.sendTraceTag(536990857,0,50,`PinchToZoomAdapter.markGestureEventAsHandled - Invoked from ${da},        eventArgs non-null: ${isNullOrUndefined(G)}, gestureData non-null: ${isNullOrUndefined(null===
G||void 0===G?void 0:G.rIa)},        srcEvent non-null: ${isNullOrUndefined(null===($a=null===G||void 0===G?void 0:G.rIa)||void 0===$a?void 0:$a.srcEvent)}`),null===(Mc=null===(Sb=null===G||void 0===G?void 0:G.rIa)||void 0===Sb?void 0:Sb.srcEvent)||void 0===Mc?void 0:Mc.preventDefault())}}Object(ka.a)(Xi,"PinchToZoomAdapter",null,[561]);var Yi=a(960),Di=a(115);class $g extends pa.a{constructor(G,da){super();this.statusBarManager=null;this.dzf=!1;this.zoomManager=da;this.$=G;this.$.ka.Lh(29,$a=>{this.statusBarManager=
$a;$a.DL(this)})}Xx(G){this.addHandler("Zoom",G)}Jx(G){this.removeHandler("Zoom",G)}Ev(){const G=Fd.a.Jnb(this.$)?"QueryZoomComboBoxValue":"QueryZoomStatus";this.Yq(G)&&this.raiseEvent("Zoom")}hy(G,da){switch(G){case "QueryZoomStatus":return this.d2i(da);case "QueryZoomComboBoxValue":return this.c2i(da);default:return!1}}Yq(G){switch(G){case "QueryZoomStatus":return Fd.a.m8(this.$);case "QueryZoomComboBoxValue":return Fd.a.Jnb(this.$)&&Fd.a.m8(this.$);default:return!1}}dispose(){this.statusBarManager&&
(this.statusBarManager.$I(this),this.statusBarManager=null);this.$=null;super.dispose()}IKf(G){G=this.OYi(G);if(!G)return null;G=G.getElementsByClassName("cui-ctl-mediumlabel");return 1!==G.length?(wa.ULS.shipAssertTag(537149764,0,!1,"ZoomStatusBarManager.GetZoomUIElement Cannot find zoom label element"),null):G[0]}c2i(G){if(!this.$)return!1;const da=Di.a().wyb;G[Yi.a.Value]=da;return!0}d2i(G){if(!this.$)return!1;const da=this.zoomManager.wyb;let $a=!1;if(Fd.a.eo(this.$))Lb.a.equals(appChrome.selectors.getControlLabel(Bg.a.zoomStatusBarMenuOpen),
da,!1)||($a=!0);else{const Sb=this.IKf("HandleQueryZoomStatusCommand");Sb?Lb.a.equals(G.LabelText.toString(),da,!1)||(Sb.innerText="",$a=!0):$a=!0}$a&&this.hBk(G,da);return!0}hBk(G,da){G.LabelText=da;Fd.a.eo(this.$)&&(G.Visible=!0)}OYi(G){var da=Oa.DOMElementExtensions.getElementById(this.$.domElement,"m_excelWebRenderer_ewaCtl_zoomLevel-Medium14");if(!da)return da=(da=this.$.ea.th)?da.inEmbedView:!1,wf.a.Gx||da||wa.ULS.sendTraceTag(537149763,0,15,`ZoomStatusBarManager.GetZoomBaseElement Cannot find zoom label. Called from ${G}`),
null;this.dzf||(this.dzf=!0,wa.ULS.sendTraceTag(537149762,0,50,`ZoomManager.GetZoomBaseElement - Zoom label was found first time. Called from ${G}`));return da}}Object(ka.a)($g,"ZoomStatusBarManager",pa.a,[2,161,162]);var vj=a(68),yj=a(239);let bj=class extends Wi.a{constructor(G,da){super(G,vj.rb);this.xyb=this.eLa=this.TWb=null;this.YWb=-1;this.eWf=!1;this.tj=()=>{this.YWb=-1};this.aCj=Object(yj.a)($a=>{$a.MFc&&$a.mark("zoom-idle")},200);wa.ULS.sendTraceTag(537149785,0,50,"AppZoom feature is Enabled.");
this.yyb=new $g(G,this);this.W2j()&&(wa.ULS.sendTraceTag(537149784,0,50,"ZoomManager.ZoomManager Attaching pinch to zoom events"),this.vGh());this.xyb=da}dispose(){this.yyb&&(Ia.a.Ng(this.yyb),this.yyb=null);this.xyb&&(this.xyb=null);this.eWf&&this.Mai();super.dispose()}y7g(G,da){G=this.YXa(G);if(fc.f(this.$).rtl){const $a=Math.round(Oa.DOMElementExtensions.getBounds(this.$.ll).width*this.zoom);this.TWb=new Sys.UI.Point($a-da.x,da.y)}else this.TWb=da;this.z6a(G,!1,"ZoomWithPinch")}U$b(){return!0}T$b(G,
da,$a){var Sb=wf.a.isMac?.07:.15;G=this.zoom+(G?Sb:-Sb);G=this.YXa(G);fc.f(this.$).rtl?(Sb=Math.round(Oa.DOMElementExtensions.getBounds(this.$.ll).width*this.zoom),this.eLa=new Sys.UI.Point(Sb-da.x,da.y)):this.eLa=da;da=this.zoom;this.z6a(G,!0,"ZoomWithMouse",$a);$a={["InitialZoom"]:da,["FinalZoom"]:G,["Location"]:"canvas"};Zg.b(this.$).lj(Ci.a.mcl,$a)}z7g(){this.TWb=null}n3c(G,da){this.z6a(this.YXa(G),!1,da?"ZoomWithDropDownFromRibbon":"ZoomWithDropDown")}A7g(G){isNaN(G)?wa.ULS.sendTraceTag(537149783,
0,15,"ZoomManager.ZoomToSelectionForFollowAlongInExcelLive: Invalid zoom value was provided"):this.z6a(this.YXa(G),!1,"ZoomToLevelInExcelLive")}o3c(G,da){this.z6a(this.YXa(G),!0,da?"ZoomWithShortcuts":"ZoomWithButtons")}tIf(G,da){const $a=fc.f(this.$).rtl,[Sb,Mc]=this.$Kd($a),[sd,Od]=this.TMd(G,Mc);return this.eLa?(G=this.EKd(this.eLa,G,da,Mc,Sb,"ZoomWithMouse"),this.eLa=null,G):this.TWb?this.EKd(this.TWb,G,da,Mc,Sb,"ZoomWithPinch"):fc.f(this.$).ha.$e.isFloatingObjectSelected?this.lcl(G,da,Mc,Sb,
sd,Od,fc.f(this.$).rtl):this.ncl(G,da,Mc,Sb,sd,Od,fc.f(this.$).rtl)}UIg(G,da,$a){if(G){wa.ULS.sendTraceTag(537149782,0,50,`Zoom To: (${G.x} ${G.y}) (new top-left) from zoom:${da} to zoom:${$a}`);G=new Ij.a(G.x,G.y);$a=fc.f(this.$).rtl;[,$a]=this.$Kd($a);const [Sb,Mc]=this.TMd(da,$a);fc.f(this.$).o2e(G,Sb,Mc,{name:"ApplicationZoom"})}else wa.ULS.sendTraceTag(537149781,0,50,`Zooming top-left: from zoom:${da} to zoom:${$a}`)}zoomFitToScreen(){const G=this.zoom;var da=fc.f(this.$).rtl;const [$a,Sb]=this.$Kd(da),
[Mc,sd]=this.TMd(G,Sb);var Od=fc.f(this.$).ha.$e.isFloatingObjectSelected;(da=Od?this.UDf(this.$qb,Mc,sd,!1):this.AIf(this.$qb,Sb,$a,Mc,sd,da,!1))?(da=Math.min(Mc/(da.width+100),sd/(da.height+100)),da=this.Jvi(da),this.z6a(da,!0,"ZoomWithFitToScreen"),Od?fc.f(this.$).ha.$e.EVa(fc.f(this.$).ha.$e.yh,!1):(Od=Pe.w(fc.f(this.$).ha.qa.activeRange,this.$),fc.f(this.$).To(Od,null,null,null,3,"ZoomManager.ZoomFitToScreen")),this.YWb=G,this.eWf||this.sGh()):wa.ULS.sendTraceTag(537149780,0,15,`ZoomManager.ZoomFitToScreen: Bounds found to be null with FloatingObjectSelected: ${Od}`)}zoomFitToScreenUndo(){this.z6a(this.YWb,
!1,"ZoomWithFitToScreen")}ype(){return-1!==this.YWb}sGh(){const G=fc.f(this.$);G&&(G.ha.Cw(this.tj),G.KN(this.tj))}Mai(){const G=fc.f(this.$);G&&(G.ha.$w(this.tj),G.vP(this.tj))}Jvi(G){G=Math.min(G,Ae.a.mDj);G=Math.max(G,Ae.a.iEj);return Math.round(100*G)/100}z6a(G,da,$a,Sb){if(this.l3c()){var Mc=fc.f(this.$).view.visibleArea.toString();G=this.YXa(G);var sd=Lc.d(this.$.sa.na);sd||(sd=Wi.a.Mbg);fc.f(this.$).nk.KP(5,uj.a.j3c,$a);var Od;if(xb.EwaSettings.pWb()){const se=Wc.a.Zg(Qc.Dg);xb.EwaSettings.aWb()?
Od=null===se||void 0===se?void 0:se.lra({name:"zoom",caller:$a,Tkf:da,timestamp:Sb}):null===se||void 0===se?void 0:se.xJa("zoom",{name:"zoom",caller:$a,Tkf:da,timestamp:Sb})}fc.f(this.$).nk.V0(uj.a.j3c,this.$.ea.gk);wa.ULS.sendTraceTag(537149779,0,50,`ZoomManager.SetNewZoomLevel Setting zoom ${G} to sheet ${sd} origin ${$a} prevZoom ${this.zoom}`);this.jEk(sd,G);this.xyb.lak();this.vZk($a,Od);this.IZk(da);this.YWb=-1;oj.b(this.$,$a);G=fc.f(this.$).view.visibleArea.toString();wa.ULS.sendTraceTag(537149778,
0,50,`ZoomManager.SetNewZoomLevel OldGridVisibleArea: ${Mc}, NewGridVisibleArea: ${G}, IsShyRibbonActive: ${this.$.a6}`);Od&&this.aCj(Od)}}TFi(G){return(G=Hg.HelperMethods.cH(this.$.ll,this.$.domElement,G))?G:new Sys.UI.Point(0,0)}$Kd(G){const da=this.TFi(G);G=this.nLi(da,G);return[da,G]}TMd(G,da){const $a=Oa.DOMElementExtensions.getBounds(this.$.ll);return[Math.round(($a.width-da.x)*G),Math.round(($a.height-da.y)*G)]}nLi(G,da){da=Hg.HelperMethods.cH(fc.f(this.$).domElement,this.$.domElement,da);
return da?(G=new Sys.UI.Point(Math.round(da.x-G.x),Math.round(da.y-G.y)),G):new Sys.UI.Point(0,0)}ncl(G,da,$a,Sb,Mc,sd,Od){return(Od=this.AIf(G,$a,Sb,Mc,sd,Od))?this.mHf(Od,G,da,$a,Sb,Mc,sd):null}AIf(G,da,$a,Sb,Mc,sd,Od){Od=void 0===Od?!0:Od;var se=Pe.J(fc.f(this.$).ha.qa.selectedRanges);if(Od&&(se=se.pk(Pe.J(fc.f(this.$).EAc())),!se))return wa.ULS.sendTraceTag(537149777,0,50,"ZoomManager.GetSelectedRangeBounds No range inside the viewport is selected."),null;const Ye=fc.f(this.$).kh(se.topLeft);
se=fc.f(this.$).kh(se.bottomRight);if(!Ye||!se)return wa.ULS.sendTraceTag(537149776,0,15,"ZoomManager.GetSelectedRangeBounds Cannot get cells for top-left or bottom-right of the selected range. Will zoom top-left"),null;G=Ye.cell.gH===se.cell.gH&&Ye.cell.oK===se.cell.oK?this.EEi(G,se,da,$a,Sb,sd):this.jXi(G,Ye,se,da,$a,Sb,sd);return G?Od?this.Cxf(G,Sb,Mc):G:(wa.ULS.sendTraceTag(537149775,0,15,"ZoomManager.GetSelectedRangeBounds got null bounds"),null)}Cxf(G,da,$a){if(0>G.x||G.x>da)G.x=0;if(0>G.y||
G.y>$a)G.y=0;G.x+G.width>da&&(G.width=da-G.x);G.y+G.height>$a&&(G.height=$a-G.y);return G}jXi(G,da,$a,Sb,Mc,sd,Od){da=fc.f(this.$).getCellBounds(da.cell);if(!da)return null;const se=fc.f(this.$).getCellBounds($a.cell);if(!se)return null;let Ye=Mc.x;Od&&(Ye=0,da.x=Math.round(sd/G)-da.x-Math.round(da.width),se.x=Math.round(sd/G)-se.x-Math.round(se.width));G=new Sys.UI.Bounds(Math.round((da.x-Sb.x)*G)-Ye,Math.round((da.y-Sb.y)*G-Mc.y),Math.round((se.x+se.width-da.x)*G),Math.round((se.y+se.height-da.y)*
G));$a=$a.cell.getRange();wa.ULS.sendTraceTag(537149774,0,50,`ZoomManager.GetTwoCellsBoundsWithZoom - a range with more than 1 cell was selected. Will zoom to range: (t:${$a.top}, b:${$a.bottom}, r:${$a.right}, l:${$a.left}) in bounds (${G.x}, ${G.y}, ${G.width}, ${G.height})`);return G}EEi(G,da,$a,Sb,Mc,sd){const Od=fc.f(this.$).getCellBounds(da.cell);if(!Od)return null;let se=Sb.x;sd&&(se=0,Od.x=Math.round(Mc/G)-Od.x-Math.round(Od.width));G=new Sys.UI.Bounds(Math.round((Od.x-$a.x)*G)-se,Math.round((Od.y-
$a.y)*G-Sb.y),Math.round(Od.width*G),Math.round(Od.height*G));da=da.cell.getRange();wa.ULS.sendTraceTag(537149773,0,50,`ZoomManager.GetCellBoundsWithZoom - single cell was selected. Will zoom to cell: (t:${da.top}, l:${da.left}) in bounds (${G.x}, ${G.y}, ${G.width}, ${G.height})`);return G}lcl(G,da,$a,Sb,Mc,sd){const Od=this.UDf(G,Mc,sd);return Od?this.mHf(Od,G,da,$a,Sb,Mc,sd):null}mHf(G,da,$a,Sb,Mc,sd,Od){G=new Sys.UI.Point(this.THf(sd,G.x,G.width),this.THf(Od,G.y,G.height));return this.EKd(G,da,
$a,Sb,Mc)}THf(G,da,$a){return G===$a?(wa.ULS.sendTraceTag(537149772,0,50,"ZoomManager.GetRelativePointCoordinate returning size/2 since the bounds are the same as the grid bounds"),G/2):G*da/(G-$a)}UDf(G,da,$a,Sb){Sb=void 0===Sb?!0:Sb;const Mc=fc.f(this.$).ha.$e.yh.domElement;var sd=Hg.HelperMethods.cH(Mc,fc.f(this.$).domElement,fc.f(this.$).rtl);if(!sd)return wa.ULS.sendTraceTag(537149771,0,50,"ZoomManager.GetFloatingObjectBounds got null for floatingObjectPointOnGrid"),null;const Od=fc.f(this.$).sJa();
sd=new Sys.UI.Point(Math.round((sd.x-Od.topLeft.x)*G),Math.round((sd.y-Od.topLeft.y)*G));G=new Sys.UI.Bounds(sd.x,sd.y,Math.round(Mc.offsetWidth*G),Math.round(Mc.offsetHeight*G));return Sb?this.Cxf(G,da,$a):G}jcg(){this.yyb.Ev()}hIj(G){"ZoomToLevelInExcelLive"===G?this.xyb.kak():this.xyb.jak()}EKd(G,da,$a,Sb,Mc,sd){sd=void 0===sd?"":sd;var Od=fc.f(this.$).rtl?0:Mc.x;Mc="ZoomWithPinch"===sd||"ZoomWithMouse"===sd?new Sys.UI.Point(G.x-Od-Math.round(Sb.x*da),G.y-Mc.y-Math.round(Sb.y*da)):G;Mc=new Sys.UI.Point(Math.round(Mc.x/
da),Math.round(Mc.y/da));wa.ULS.shipAssertTag(537149770,0,!!da,"Original zoom level must be different than 0");Od=$a/da;Mc=new Sys.UI.Point(Math.round(Mc.x*(1-1/Od)),Math.round(Mc.y*(1-1/Od)));"ZoomWithMouse"===sd||"ZoomWithPinch"===sd?(Mc.x+=Math.round((Sb.x-fc.f(this.$).ps)*(Od-1)),Mc.y+=Math.round((Sb.y-fc.f(this.$).XB)*(Od-1))):(Od=Math.round(Sb.x*($a-da)),0<Od&&Mc.x>Od&&(Mc.x+=Od),da=Math.round(Sb.y*($a-da)),0<da&&Mc.y>da&&(Mc.y+=da));"ZoomWithMouse"===sd&&(G.x||(Mc.x=0),G.y||(Mc.y=0));G=fc.f(this.$).sJa();
return new Sys.UI.Point(Mc.x+G.topLeft.x,Mc.y+G.topLeft.y)}vGh(){const G=[];Sf.a.instance.Qi("Common.IGestureInputManager").execute(da=>{0===da.HKi()&&da.qek(document.body,new Xi(this.$,this),G)})}W2j(){return this.l3c()&&(wf.a.Av&&wf.a.kKa(67)||this.$.ZHc)}jEk(G,da){oj.a(this.$)?this.sne(G,da,this.Oze,Ae.a.ntg):this.sne(G,da,this.zoomPerSheetId,this.$qb)}sne(G,da,$a,Sb){$a.remove(G);da!==Sb&&$a.add(G,da)}vZk(G,da){const $a=xb.EwaSettings.pWb()?Wc.a.Zg(Qc.Dg):void 0;xb.EwaSettings.aWb()?null===da||
void 0===da?void 0:da.mark("zoom-immediate-start"):null===$a||void 0===$a?void 0:$a.oY("zoom-immediate-start");this.oNg();this.$.npa(jc.a.qwa("TriggerImmediateZoomOperations"));this.w7k();this.hIj(G);xb.EwaSettings.aWb()?null===da||void 0===da?void 0:da.mark("zoom-immediate-end"):null===$a||void 0===$a?void 0:$a.oY("zoom-immediate-end")}w7k(){this.wWd()?this.$.jm():this.yyb.Ev();const G=this.yyb.IKf("UpdateZoomStatusBar");G&&(G.innerText=this.wyb)}wWd(){const G=Ef.a(this.$);return G?G.ns.rA===(Fd.a.GKa(this.$)?
vc.a.D4a:this.$.$h+vc.a.pje):!1}IZk(G){fc.f(this.$).icl(G);this.iCh()}iCh(){const G=kf.a(this.$);if(G)for(const da of fc.f(this.$).za.Zz()){if(!da){wa.ULS.sendTraceTag(537149768,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - cacheItem is null");continue}if(!da.Fp)continue;const $a=da.Qo;if($a)for(let Sb=0;Sb<$a.count;Sb++)if(2===$a.Tm(Sb).type){const Mc=G.ky($a.Tm(Sb).an());Mc?(Mc.Sqa(!1),wa.ULS.sendTraceTag(537149766,0,50,`ZoomManager.AdjustSlicersToZoom - Slicer zoomed to zoom ${this.zoom}`)):
wa.ULS.sendTraceTag(537149767,0,50,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - control is null")}}else wa.ULS.sendTraceTag(537149769,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - floatingObjectManager is null")}};bj=Object(oc.__decorate)([Object(Wc.d)(Qc.Kg),Object(oc.__param)(0,Object(Qc.Lb)()),Object(oc.__param)(1,Object(Qc.Jg)())],bj);Object(ka.a)(bj,"ZoomManager",Wi.a,[]);var gj=a(934),th=a(907),Th=a(1071);let Oh=class extends pa.a{constructor(G){var da;super();this.r$=
this.Vib=this.statusBarManager=null;this.PCc=this.xVb=!1;this.hpg=()=>{var $a=screen.height;$a-=this.ExcelFullScreenCalloutSettings.Qfl*$a;window.innerHeight>=$a&&!this.xVb?(this.xVb=!0,this.Ev()):this.xVb&&window.innerHeight<$a&&(this.xVb=!1,this.Ev())};this.j7d=()=>{this.Ev();Th.a.Bxa||(wa.ULS.sendTraceTag(507566092,0,50,"FullScreenStatuBarManager.OnFullScreenChangeEventHandler:  exit fullscreen mode"),this.PCc=!1)};this.$=G;this.$.Ma.zka(this);this.$.ka.Lh(29,$a=>{this.statusBarManager=$a;$a.DL(this)});
this.ExcelFullScreenCalloutSettings=JSON.parse(Za.AFrameworkApplication.fa.Xa("ExcelFullScreenCalloutSettings"));this.ZDj=6E4*(null===(da=this.ExcelFullScreenCalloutSettings)||void 0===da?NaN:da.Ecl);this.r$=document.getElementById("MainApp");this.Vib=this.j7d;$addHandler(this.r$,Th.a.BGd,this.Vib);$addHandler(window,Ge.a.resize,this.hpg);xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ToggleFullScreenRibbon",!1)&&this.LLk()}Xx(G){this.addHandler("FullScreenChangedEventKey",G)}Jx(G){this.removeHandler("FullScreenChangedEventKey",
G)}Ev(){this.Yq("QueryFullScreen")&&(xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ToggleFullScreenRibbon",!1)&&this.wWd()&&this.$.jm(),this.raiseEvent("FullScreenChangedEventKey"))}hy(G,da){switch(G){case "QueryFullScreen":return da[gj.a.On]=Th.a.Bxa,da[th.a.customTooltip]=Th.a.Bxa?ha.a.instance.ia(2409):ha.a.instance.ia(2408),xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8740765_TogglingOfFullScreenIcons")&&(da[th.a.IconSet]=Th.a.Bxa?{"default":"FullScreenMinimize_16"}:{"default":"FullScreenMaximize_16"}),
!0;default:return!1}}Yq(){return Fd.a.lUd()?!0:!1}dispose(){this.statusBarManager&&(this.statusBarManager.$I(this),this.statusBarManager=null);$removeHandler(this.r$,Th.a.BGd,this.Vib);$removeHandler(window,Ge.a.resize,this.hpg);this.r$=this.$=null;super.dispose()}ni(G,da){switch(da.command){case -1912752143:return!0;default:return!1}}Bi(G,da){switch(da){case -1912752143:return this.xVb&&!this.PCc?!0:!1;default:return!1}}Ji(){return!1}executeCommand(G,da){switch(da.command){case -1912752143:return this.kXk(),
this.Ev(),gf.Task.Va(!0);default:return $i.a(da.command)}}kXk(){Th.a.Bxa?(Th.a.exitFullscreen(),this.PCc=!1):(wa.ULS.sendTraceTag(507533057,0,15,`FullScreenStatuBarManager.OnFullScreenChangeEventHandler:  enter fullscreen mode, winow height: ${window.innerHeight}, ribbon mode: ${appChrome.selectors.getRibbonMode()}`),Th.a.requestFullscreen(this.r$),this.PCc=!0)}LLk(){setTimeout(()=>{(window.innerHeight<=this.ExcelFullScreenCalloutSettings.Sel||screen.height/window.innerHeight<this.ExcelFullScreenCalloutSettings.Rel)&&
this.MLk()},this.ZDj)}wWd(){const G=Ef.a(this.$);return G?G.ns.rA===(Fd.a.GKa(this.$)?vc.a.D4a:this.$.$h+vc.a.pje):!1}MLk(){const G=new Tc.a(-847286761,Bd.a.eh,this.$.Rh,0,null);this.$.Ma.dh(G,{["InputMethod"]:Bd.a.eh,CalloutName:23})}};Oh=Object(oc.__decorate)([Object(Wc.d)(Qc.Qc),Object(oc.__param)(0,Object(Qc.Lb)())],Oh);Object(ka.a)(Oh,"FullScreenStatusBarManager",pa.a,[2,162,39]);const pi=()=>Sf.a.instance.resolve("Common.App.InProductMessaging.InProductMessagingUIManager");var kh=a(281),cj=
a(135),wj=a(455);class Ei extends wj.a{constructor(G){super(G)}get sKb(){return!1}createElement(){const G=document.createElement("link");G.setAttribute("rel","stylesheet");G.setAttribute("type","text/css");G.setAttribute("href",this.zD);return G}Twd(){return null}aSc(){this.element.setAttribute("href","");this.element.setAttribute("href",this.bJ.zD)}}Object(ka.a)(Ei,"CssResource",wj.a,[]);var Oi=a(525),Zi=a(290);class Ph{constructor(){this.mgc=this.adc=null}kvj(){this.adc||(wa.ULS.sendTraceTag(21030598,
324,50,"InProductMessagingDependenciesLoad usage"),this.adc=gf.Task.WAA(Ph.qvj(),Ph.fvj()),this.adc.continueWith(G=>{wa.ULS.sendTraceTag(21030599,324,10,"{0}",kb.a.VId(G.exception))},5));return this.adc}mvj(){if(!this.mgc)try{wa.ULS.sendTraceTag(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage"),this.mgc=gf.Task.WAA(Ph.yBd(Zi.a.create(Za.AFrameworkApplication.fa.Xa("DimeUrl"),null,null))),this.mgc.continueWith(G=>{wa.ULS.sendTraceTag(39978391,324,10,"{0}",kb.a.VId(G.exception))},
5)}catch(G){wa.ULS.sendTraceTag(594874951,324,10,"{0}",kb.a.VId(G))}return this.mgc}static qvj(){var G=Ph.yAc("inproductmessaging.js");G=Zi.a.create(G,null,null);return Ph.yBd(G)}static fvj(){var G=Ph.yAc("inproductmessaging.css");G=new Ei(G);return Ph.yBd(G)}static yAc(G){return cj.a.QJb(String.format("ipm/{0}",G))}static yBd(G){Oi.a.sva(G);return G.Bob}}Object(ka.a)(Ph,"DependencyDownloader",null,[597]);class Pi{}Pi.V_j="inProductMessagingOverlayDiv";Pi.u3j="PlayButtonImage";Pi.Amk="ReplayButtonImage";
Object(ka.a)(Pi,"Constants",null,[]);class L{constructor(){this.dVe=this.oPe=this.hEe=!0;this.Bmk=this.v3j=null;this.wFj=!1;this.locale=null;this.h0g={}}get L6e(){return this.hEe}set L6e(G){this.hEe=G}get M$f(){return this.oPe}set M$f(G){this.oPe=G}get ERg(){return this.dVe}set ERg(G){(this.dVe=G)&&this.gCk()}gCk(){this.$_e(Pi.u3j,this.v3j);this.$_e(Pi.Amk,this.Bmk)}$_e(G,da){da&&(this.h0g[G]=da)}}Object(ka.a)(L,"FirstRunExperienceUISettings",null,[596]);class qa{constructor(){this.completed=this.hgk=
!1}}Object(ka.a)(qa,"FirstRunExperienceViewData",null,[594]);var Va=a(211),Fb=a(134);class bc{constructor(G,da,$a){this.zvi=(Sb,Mc,sd,Od,se)=>{2===sd&&this.Odc.xtj(se);return 32};this.qbi=(Sb,Mc,sd,Od,se)=>{2===sd&&this.Odc.rtj(se);return 32};this.G7i=(Sb,Mc,sd)=>2===sd?this.Odc.F3d():32;this.F7i=(Sb,Mc,sd)=>2===sd?this.Odc.C3d():32;this.$c=G;this.vm=da;this.Odc=$a}ko(){this.$c.Vk(vb.a.Bvi,Fb.a.frame,this.zvi,64);this.$c.Hh(vb.a.sxf,Fb.a.frame,this.G7i);this.$c.Hh(vb.a.rxf,Fb.a.frame,this.F7i);this.$c.Hh(vb.a.pbi,
Fb.a.frame,this.qbi);this.$c.Hh(vb.a.zDg,Fb.a.frame,Va.ActionManager.gm);this.$c.Hh(vb.a.bnk,Fb.a.frame,Va.ActionManager.gm);this.$c.Hh(vb.a.cnk,Fb.a.frame,Va.ActionManager.gm);this.vm&&this.vm.AB()}}Object(ka.a)(bc,"InProductMessagingActor",null,[]);class Ic{constructor(){this.Rzg=this.iFg=this.XWg=this.dJc=this.instance=null}}Object(ka.a)(Ic,"DimeExperienceUISettings",null,[]);var td=a(530);class Hd{constructor(G,da,$a,Sb,Mc){this.axc=!1;this.bMb=null;this.$c=G;this.xTa=da;this.Ogc=$a;this.mW=Sb;
this.t5c=Mc}aaj(G){Hh.b("getHeaderApi")?(G.kqj()&&appChrome.getHeaderApi().then(da=>{da.updateAnonymousStatus(!0);return null}),G.isFeatureEnabled("MsoPremiumBadge",!0).then(da=>{const $a=G.isFreemiumUpsellEnabled();$a&&(appChrome.getHeaderApi().then(Sb=>{Sb.updatePremiumStatus(da,$a);return null}),G.S4a("MsoPremiumBadge",Sb=>{appChrome.getHeaderApi().then(Mc=>{Mc.updatePremiumStatus(Sb.isEnabled,$a);return null})}));return null})):wa.ULS.sendTraceTag(593859840,324,10,"getHeaderApi not available")}xtj(G){this.Ogc.kvj().continueWith(()=>
{this.xTa.QNk(G)})}rtj(G){let da="gopremium",$a=null,Sb=()=>{};G?(G.experience&&""!==Object(Hc.a)(String,G.experience)&&(da=Object(Hc.a)(String,G.experience)),G.onTaskComplete&&(Sb=G.onTaskComplete),G.campaignId&&""!==Object(Hc.a)(String,G.campaignId)&&($a=Object(Hc.a)(String,G.campaignId))):wa.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");this.i3f(da,Sb,$a)}i3f(G,da,$a){$a=void 0===$a?null:$a;if(this.axc&&this.bMb){const Sb={};Sb.experience=G||"gopremium";Sb.campaignId=
$a||td.b(this.mW,this.t5c,Object(Hc.a)(String,Sb.experience),!0);this.$c.Gk(vb.a.zDg,2);wa.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+Sb.experience);try{const Mc=Object.assign(new Ic,{instance:this.bMb,dJc:Sb,XWg:da||(()=>{}),iFg:sd=>{wa.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+sd.status)},Rzg:()=>{wa.ULS.sendTraceTag(51675406,324,10,"Dime launch error");this.axc=!1;this.bMb=null}});this.xTa.JLk(Mc)}catch(Mc){wa.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+
Mc.message),this.axc=!1,this.bMb=null,this.$c.Xj(vb.a.bxc,2,{["experience"]:Sb.experience})}}else wa.ULS.sendTraceTag(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),this.$c.Xj(vb.a.bxc,2,{["experience"]:G})}K_d(){this.Ogc.mvj().continueWith(()=>{try{var G=kb.a.Rr(Za.AFrameworkApplication.uiCulture);const Sb=td.c(this.mW);if(Sb){var da={};da.partnerId=Sb;da.language=G;da.sessionId=Za.AFrameworkApplication.userSessionId;da.authHint=Za.AFrameworkApplication.fa.Xa("UserPrincipalName");
var $a=Za.AFrameworkApplication.fa.Xa("Puid")||"";""!==$a&&(G={},G.puid=$a,da.userInfo=G);this.bMb=new Dime(da);this.axc=!0;wa.ULS.sendTraceTag(592721856,324,50,"Dime initialized")}else wa.ULS.sendTraceTag(51675409,324,15,"App not supported")}catch(Sb){wa.ULS.sendTraceTag(51675410,324,10,"FreemiumUpsellDialogDependencies failed: "+Sb.message)}},3)}F3d(){return this.xTa.F3d()}C3d(){return this.xTa.C3d()}}Object(ka.a)(Hd,"InProductMessagingUIManager",null,[592]);class pe{constructor(){this.JWe=0;this.xab=
Array(5);this.xab[0]=10;this.xab[1]=15;this.xab[2]=50;this.xab[3]=100;this.xab[4]=200}Init(G){this.JWe=G}SendTrace(G,da){wa.ULS.sendTraceTag(34182235,this.JWe,this.xab[G],"{0}",da)}}Object(ka.a)(pe,"DefaultNetworkingManager",null,[611]);var Ke=a(324);class uf{constructor(G){this.Ei=G}QNk(G){G&&(InProductMessaging.Networking.NetworkingMgr=new pe,InProductMessaging.Networking.NetworkingMgr.Init(387),InProductMessaging.Init(G.ERg,G.M$f,G.L6e,G.wFj,G.locale,Object(Jc.a)(this,this.ENj,"onDismissFirstRunExperience"),
G.h0g),this.w6a(Pi.V_j,!0))}JLk(G){if(G&&G.instance&&G.dJc){let da=document.getElementById("wacDimeContainer");da||(da=document.createElement("div"),da.id="wacDimeContainer",document.body.appendChild(da));Za.AFrameworkApplication.fa.la("DimeFocusManagerIsEnabled")&&this.w6a("wacDimeContainer",!1);G.dJc.parentElementId="wacDimeContainer";G.instance.launch(G.dJc,G.XWg).then($a=>{this.L2b();document.body.removeChild(da);G.iFg($a)}).catch($a=>{this.L2b();document.body.removeChild(da);G.Rzg($a)})}else throw Error.argument("DimeExperienceUISettings");
}w6a(G,da){if(this.Ei&&G&&(G=document.getElementById(G),this.P$i(G),G=this.Ei.l0("InProductMessagingFocusId"))){const $a=this.Ei.currentScope;$a&&"InProductMessagingFocusId"===$a.name||this.Ei.tba("InProductMessagingFocusId",!1);da&&this.Vxg(G.scope)}}P$i(G){var da=!1;da=void 0===da?!0:da;const $a=this.Ei.Lq("InProductMessagingFocusId");$a.parent=$h.AFrame.z3;const Sb=new Ke.DOMFocusListing(()=>G);Sb.E2b=da;Sb.ox(3);Sb.ox(2);Sb.ox(4);da=this.Ei.dVa(()=>G,$a,Sb);da.dSc();da.Zga=!0;da.Pfb=!0}Vxg(G){G.zB(Zh.FocusManager.instance().yda);
G.zB(Zh.FocusManager.instance().zda);G.bindAction(Zh.FocusManager.instance().yda,vb.a.sxf);G.bindAction(Zh.FocusManager.instance().zda,vb.a.rxf)}L2b(){this.Ei&&(this.Ei.cpa("InProductMessagingFocusId"),this.Ei.i5a("InProductMessagingFocusId"))}ENj(G,da){this.L2b();G=Object.assign(new qa,{completed:G,hgk:da});Za.AFrameworkApplication.jh.Xj(vb.a.yvi,2,G)}F3d(){const G=document.activeElement,da=this.Ei.i0();return G&&da&&da.fo&&G===da.fo.HF?(da.fo.lG(G),da.LYb()?32:8):4}C3d(){const G=document.activeElement,
da=this.Ei.i0();return G&&da&&da.fo&&G===da.fo.jM?(da.fo.lG(G),da.vpb()?32:8):4}}Object(ka.a)(uf,"InProductMessagingUIWrapper",null,[590]);class zf{constructor(){this.Mh=null}get name(){return"Common.App.InProductMessaging"}ao(G){G.register(Ph,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").hi().mi(()=>new Ph);G.register(uf,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").hi().mi(()=>
new uf(Zh.FocusManager.instance()));G.register(Hd,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").hi().mi(()=>new Hd(Za.AFrameworkApplication.jh,Sf.a.instance.resolve("Common.IInProductMessagingUIWrapper"),Sf.a.instance.resolve("Common.App.InProductMessaging.IDependencyDownloader"),Za.AFrameworkApplication.ra.$d.Om,Za.AFrameworkApplication.ra.$d.aMa));G.register(bc,"Common.App.InProductMessaging.InProductMessagingActor").hi().mi(()=>new bc(Za.AFrameworkApplication.jh,
Za.AFrameworkApplication.ra,Sf.a.instance.resolve("Common.IInProductMessagingUIManager")));G.register(L,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").hi().mi(()=>new L);G.register(qa,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").hi().mi(()=>new qa);this.Mh=G}init(){Sf.a.instance.resolve("Common.App.InProductMessaging.InProductMessagingActor").ko();Za.AFrameworkApplication.fa.ty(()=>{Za.AFrameworkApplication.ra.$d.jw&&
Vh.a.get_instance().Fm(15,()=>{Object(kh.a)().execute(G=>{pi().aaj(G)})});Za.AFrameworkApplication.fa.la("FreemiumUpsellShowDialogIsEnabled")&&td.a()&&!wf.a.Lna&&1!==Za.AFrameworkApplication.ra.$d.Om&&Object(kh.a)().execute(G=>{G.isFeatureEnabled("MsoPremiumBadge",!0).then(da=>{!da&&G.isFreemiumUpsellEnabled()&&pi().K_d();return null})})})}dispose(){}static main(){Vc.a.instance.Lo(new zf)}}Object(ka.a)(zf,"InProductMessagingPackage",null,[12,13]);var bg=a(645);class kg{constructor(G,da,$a,Sb,Mc){this.aZa=
sd=>{let Od=!1,se=null;try{if(0<sd.data.responseData.length){const Ye=Object(Hc.a)(Object,qd.a(sd.data.responseData)),hf=Ye?Ye[this.ZE.zod]:null;hf&&(se=Object(Hc.a)(Object,qd.a(hf.toString())))}Od=!0}catch(Ye){this.ywa(null)}Od&&this.fBb&&this.fBb(sd.data,se)};this.ywa=sd=>{this.bBb&&this.bBb(sd?sd.data:null)};this.i5j=sd=>{this.QRe&&this.QRe(sd?sd.data:null)};this.Eza=sd=>{this.rDb&&this.rDb(sd?sd.data:null)};this.ZE=G;this.fBb=da;this.bBb=$a;this.QRe=void 0===Sb?null:Sb;this.rDb=void 0===Mc?null:
Mc}zDd(G){const da=new Sys.StringBuilder(this.ZE.g4b);da.append("RoamingServiceHandler.ashx?action=");da.append("getFirstRunExperienceSettings");da.append("&");da.append(this.oLd(G));da.append("&");da.append(Za.AFrameworkApplication.qo);Za.AFrameworkApplication.$i.Ou(da.toString(),1,null,null,!0,2,this.aZa,this.ywa,null)}svc(G){var da=new Sys.StringBuilder(this.ZE.g4b);da.append("RoamingServiceHandler.ashx?action=");da.append("saveFirstRunExperienceSettings");da.append("&");da.append(Za.AFrameworkApplication.qo);
da=da.toString();G=qd.c(G);Za.AFrameworkApplication.$i.Ou(da,2,G,null,!0,4,this.i5j,this.Eza,null)}oLd(G){const da=new Sys.StringBuilder("requestedsettings=");for(let $a=0;$a<G.count;$a++)da.append(G.ma($a)),$a<G.count-1&&da.append(";");return da.toString()}}Object(ka.a)(kg,"FirstRunExperienceRequestHandler",null,[]);var ug=a(247);class Gg{constructor(){this.VAb=this.bdc=this.ZE=null;this.aZa=(G,da)=>{G=G?+G.V9-+G.VO:-1;G>this.ZE.mGg?wa.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",
G,this.ZE.mGg):da?this.nKk(da)?(wa.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.ZE.D$f),this.eqe()):(this.Qzd(!1),wa.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(wa.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.eqe())};this.ywa=G=>
{this.Qzd(!1);wa.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",G?G.httpStatus:-1)};this.Eza=G=>{wa.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",G?G.httpStatus:-1)};this.MOj=G=>{if(G){var da=G.detail;G=G.type;var $a=this.ZE&&this.ZE.campaignId?this.ZE.campaignId.split("-")[0]:null;if("FRELaunchedEvent"===G||$a&&da&&da.id&&-1!==da.id.indexOf($a)){if("FRELaunchedEvent"===
G||da&&da.success)wa.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.MHg(this.ZE.currentVersion);window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.VAb,!0),window.removeEventListener("FRELaunchedEvent",this.VAb,!0))}}}}dqe(G){G?(this.ZE=G,this.mlj()&&(wa.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),G=new Wb.a,G.add(this.ZE.zod),this.bdc=new kg(this.ZE,
this.aZa,this.ywa,null,this.Eza),this.bdc.zDd(G)),(this.ZE.tnb||Za.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.eqe()):wa.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}mlj(){try{if(this.ZE.tnb)return!0;if(!Za.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||Za.AFrameworkApplication.fa.la("IsAnonymousUser"))return!1;if(this.ZE.Vgj||this.ZE.xnb||Za.AFrameworkApplication.fa.la("IsO365ConsumerHost"))return!0;
const G=Za.AFrameworkApplication.fa.Xa("FlightId");return-1!==(G?G.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(G){wa.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",G?G.toString():null)}return!1}MHg(G){const da={},$a={};$a.FREDisplayedDate=(new Date).toUTCString();$a.VersionDisplayed=G;$a.RemindMeLater=!1;da[this.ZE.zod]=qd.c($a);wa.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.bdc&&this.bdc.svc(da)}eqe(){this.Qzd(!0);
var G=Object(bg.b)();G?this.lRg(G):(wa.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),Za.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((G=Object(bg.a)())?G.execute(da=>{this.lRg(da)}):wa.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}lRg(G){if(G){var da=this.ZE.Mvi;da&&gb.a.UU(da);wa.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",
da);G.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.VAb=this.MOj,window.addEventListener("FGWebSurfaceEvent",this.VAb,!0),window.addEventListener("FRELaunchedEvent",this.VAb,!0)):(wa.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.MHg(this.ZE.currentVersion))}else wa.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}nKk(G){if("RemindMeLater"in G&&"FREDisplayedDate"in G){if("true"===G.RemindMeLater.toString()&&
(+new Date-+new Date(G.FREDisplayedDate.toString()))/36E5>this.ZE.D$f)return!0}else if(Za.AFrameworkApplication.fa.la("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in G&&G.VersionDisplayed<this.ZE.currentVersion)return wa.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}Qzd(G){Za.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&ug.a.dispatch("FREDecisionEvent",
{["show"]:G})}}Object(ka.a)(Gg,"FirstRunExperienceLauncher",null,[563]);class ah{constructor(){this.Mh=null}get name(){return"Common.App.FirstRunExperienceLauncher"}ao(G){this.Mh=G;this.Mh.register(563,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").hi().mi(()=>new Gg)}init(){}dispose(){}static main(){Vc.a.instance.Lo(new ah)}}Object(ka.a)(ah,"FirstRunExperienceLauncherPackage",null,[12,13]);var Qg=a(9);class Uh extends Yf.a{constructor(G){super();this.$=G;this.Bl()}create(){const G=
Object(hg.a)(this.$.ka,311,()=>new Rg(this.$));this.Yj(G)}static Aa(G){G.ka.ph(312,new Uh(G))}}Object(ka.a)(Uh,"FirstRunExperienceManagerFactory",Yf.a,[]);var vh=a(613),X=a(669);class jb extends vh.a{constructor(G){super(1);this.Vra=!1;this.Beg=()=>{this.refresh()};this.Ceg=()=>{this.refresh()};this.da=fc.f(G);this.da.sh.nv(this.Ceg);this.da.sh.Wx(this.Beg);this.refresh()}get TR(){return this.XKc(this.Vra)}zne(G){this.Vra!==G&&(this.Vra=G,this.Q1b())}get name(){return X.a.cellEdit}dispose(){this.da.sh.ev(this.Ceg);
this.da.sh.Zw(this.Beg);this.da=null;super.dispose()}Q1b(){this.Wce(this.Vra)}refresh(){this.zne(!this.da.isEditing)}}Object(ka.a)(jb,"CellEditSafeStatePublisher",vh.a,[]);class Pb{constructor(G,da){this.handler=null;this.uce=G;this.TR=da}}Object(ka.a)(Pb,"SafeStatePublisherState",null,[]);var ed=a(718);const zd=G=>G?`${G.Current} / ${G.Pending} @${G.SuspensionStartTimestamp}`:null,be=G=>(null===G||void 0===G?void 0:G.SuspensionStartTimestamp)&&G.Pending>G.Current;class we extends pa.a{constructor(G,
da){super();this.O2f=null;this.CIc=!1;this.u_b=($a,Sb)=>{3===Sb.p$f&&this.CIc&&wa.ULS.sendTraceTag(520480204,0,15,"ClientStateMonitor.onMergeDidntOccur: Aborted merge occurred after another aborted merge.");this.CIc=!0;this.U1b()};this.S5a=new Wb.a;this.ppb=G;this.yza=da;if(this.WTb=xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",!1))this.yza.Scb(this.pMa.bind(this)),this.ppb.X0e(this.u_b)}get m2k(){return this.S5a.toArray().filter(G=>0!=G.TR).map(G=>G.uce.name)}Lkc(G){this.addHandler(we.R5a,
G)}VSc(G){this.removeHandler(we.R5a,G)}zNa(G,da){const $a=new Pb(G,da);this.S5a.add($a);da=(Sb,Mc)=>{$a.TR=Mc.TR;this.U1b()};G.Lkc(da);$a.handler=da;this.U1b()}iwe(G){let da=null;for(const $a of this.S5a)if($a.uce===G){this.p1g($a);da=$a;break}da&&(this.S5a.remove(da),this.U1b())}dispose(){for(const G of this.S5a)this.p1g(G);this.S5a.clear();this.WTb&&(this.yza.ktb(this.pMa.bind(this)),this.ppb.dCg(this.u_b));super.dispose()}Cxc(){const G=Qi.Cxc(this.S5a.toArray().map(da=>da.TR));return this.CIc&&
1===G?2:G}p1g(G){G.uce.VSc(G.handler)}U1b(){const G=this.Cxc();G!==this.O2f&&(this.raiseEvent(we.R5a,new ed.a(G)),this.O2f=G)}pMa(G,da){G=da.yoa;(da=!be(G))||(da=this.Lsj,da=(null===G||void 0===G?void 0:G.SuspensionStartTimestamp)!==(null===da||void 0===da?void 0:da.SuspensionStartTimestamp));da&&(this.CIc=!1);this.Lsj=G;this.U1b()}}we.R5a="SSC";Object(ka.a)(we,"ClientStateMonitor",pa.a,[]);class ef extends vh.a{constructor(G,da){da=void 0===da?null:da;super(1);this.Vra=!1;this.y6=()=>{this.refresh()};
this.Jfg=()=>{this.refresh()};this.$=G;this.sKe=da||Yb.a(G).d5(Ka.a.idle);Yb.a(G).smd(this.Jfg);this.ilb.Xx(this.y6);this.refresh()}get TR(){return this.XKc(this.Vra)}zne(G){G!==this.Vra&&(this.Vra=G,this.Q1b())}get name(){return X.a.ilb}get ilb(){return this.sKe}dispose(){Yb.a(this.$).BSc(this.Jfg);this.ilb.Jx(this.y6);this.sKe=null;super.dispose()}Q1b(){this.Wce(this.Vra)}refresh(){this.zne(1===this.ilb.aE||Yb.a(this.$).Dp===this.ilb)}}Object(ka.a)(ef,"IdleActivitySafeStatePublisher",vh.a,[]);class vf extends rb.a{constructor(){super()}Bi(){return!1}executeCommand(){return gf.Task.Va(!0)}ni(G,
da){return 1905775613===da.command}Ji(){return!1}}Object(ka.a)(vf,"ToggleMergeSuspensionSafeState",rb.a,[39]);class Jf extends pa.a{constructor(G,da){super();this.statusBarManager=null;this.J4d=!1;this.pMa=($a,Sb)=>{$a=`${Sb.yoa.Current===Sb.yoa.Pending?"\u26ad":"\u26ae"}${Sb.yoa.Current}`;Lb.a.equals(this.CLc,$a,!1)||(this.CLc=$a,this.Ev())};this.r3a=($a,Sb)=>{$a=0==Sb.TR;this.J4d!==$a&&(this.J4d=$a,this.Ev())};this.mergeSuspensionManager=da;this.mergeSuspensionManager.yza.Scb(this.pMa);this.CLc=
"";Mh.a.Nda(1905775613,Bi.a.di,0,1);this.Ma=G.Ma;this.M8b=new vf;G.ka.Lh(29,$a=>{this.mergeSuspensionManager&&(this.statusBarManager=$a,$a.DL(this),this.mergeSuspensionManager.rua.Lkc(this.r3a))});this.Ma.zka(this.M8b)}Xx(G){this.addHandler(Jf.i3d,G)}Jx(G){this.removeHandler(Jf.i3d,G)}Ev(){this.raiseEvent(Jf.i3d)}Yq(G){return G===Jf.X8j&&!!this.mergeSuspensionManager}hy(G,da){if(!this.Yq(G))return!1;this.mergeSuspensionManager&&(da.LabelText=this.CLc,da.On=this.J4d);return!0}dispose(){this.M8b&&(this.Ma.ctb(this.M8b),
this.M8b.dispose(),this.M8b=null);this.mergeSuspensionManager&&(this.mergeSuspensionManager.yza.ktb(this.pMa),this.mergeSuspensionManager.rua.VSc(this.r3a),this.mergeSuspensionManager=null);this.statusBarManager&&(this.statusBarManager.$I(this),this.statusBarManager=null);this.CLc=null;super.dispose()}}Jf.i3d="MSMSC";Jf.X8j="QueryMergeSuspensionStatus";Object(ka.a)(Jf,"MergeSuspensionIndicatorManager",pa.a,[161,162,2]);var yg=a(1057);class Pg extends Sys.EventArgs{constructor(G){super();this.AKa=
G}}Object(ka.a)(Pg,"TogglePendingMergeBlockedByClientEventArgs",Sys.EventArgs,[]);class Wg{}Object(ka.a)(Wg,"SuspensionState",null,[]);class ch extends Wg{constructor(G){super();this.M2e=!1;this.M2e=G}}Object(ka.a)(ch,"ReadyForPendingMergeState",Wg,[]);const yh=new Wg,A=new Wg,ja=new ch(!1),Ua=new ch(!0);var ac=a(1056);class Ec extends ac.a{constructor(G,da,$a){super(G);this.eDh=da;this.KOk=$a}}Object(ka.a)(Ec,"ReadyForPendingMergesUpdatedEventArgs",ac.a,[]);class gd extends pa.a{constructor(G,da,
$a){super();this.pMa=(Sb,Mc)=>{Sb=this.getState();const sd=this.Saa;this.Saa=Mc.yoa;Mc=this.getState();this.vyj(Sb,Mc,sd);this.raiseEvent(gd.e3d);this.fxf(Sb,Mc)};this.r3a=(Sb,Mc)=>{Sb=this.getState();this.TR=Mc.TR;Mc=this.getState();this.fxf(Sb,Mc)};this.u_b=(Sb,Mc)=>{4===Mc.p$f&&(wa.ULS.sendTraceTag(520480203,0,50,"MergeSuspensionStateHandler.onMergeDidntOccur: Retry DoPendingMerge after bailout. Current merge counter: {0}, Response merge counter: {1}",zd(this.Saa),zd(Mc.Saa)),this.wwg(this.getState(),
!0))};this.WTb=xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",!1);this.rua=G;this.rua.Lkc(this.r3a);this.yza=da;this.yza.Scb(this.pMa);this.ppb=$a;this.ppb.X0e(this.u_b);this.Saa=Object(Bb.a)(new yg.a,{Pending:0,Current:0,SuspensionStartTimestamp:null});this.TR=this.$8i()}$8i(){return Object(Kb.a)(we,this.rua)?Object(Hc.a)(we,this.rua).Cxc():1}Okc(G){this.addHandler(gd.wue,G)}YSc(G){this.removeHandler(gd.wue,G)}nAh(G){this.addHandler(gd.Ide,G)}ykk(G){this.removeHandler(gd.Ide,
G)}vzh(G){this.addHandler(gd.e3d,G)}Tjk(G){this.removeHandler(gd.e3d,G)}aak(){this.Tce(this.getState()===A)}dispose(){this.rua.VSc(this.r3a);this.rua=null;this.yza.ktb(this.pMa);this.yza=null;this.ppb.dCg(this.u_b);this.ppb=null;super.dispose()}vKd(){return Object(Bb.a)(new yg.a,{Current:this.Saa.Current,Pending:this.Saa.Pending,SuspensionStartTimestamp:this.Saa.SuspensionStartTimestamp})}getState(){return be(this.Saa)?0==this.TR?Ua:this.WTb&&1==this.TR?ja:A:yh}fxf(G,da){G!==da&&(da===A?this.Tce(!0):
G===A&&this.Tce(!1));this.wwg(da)}wwg(G,da){G instanceof ch&&this.raiseEvent(gd.Ide,new Ec(this.Saa,G.M2e||!this.WTb,void 0===da?!1:da))}vyj(G,da,$a){G===yh&&da!==yh?(G=da===A,da=da===ja,wa.ULS.sendTraceTag(252760283,0,50,`MergeSuspensionStateHandler.LogPendingMergesStatusChanged: Pending changes exist. IsBlocking: ${da} publisher: ${da||G?this.rua.m2k.join(","):""} counter: ${zd(this.Saa)} isBlockingAllMerges: ${G}`)):G!==yh&&da===yh&&wa.ULS.sendTraceTag(252760284,0,50,`MergeSuspensionStateHandler.LogPendingMergesStatusChanged: No pending changes. counter: ${zd($a)}`)}Tce(G){this.raiseEvent(gd.wue,
new Pg(G))}}gd.wue="TPMBBC";gd.Ide="RFPMU";gd.e3d="MCC";Object(ka.a)(gd,"MergeSuspensionStateHandler",pa.a,[]);class ad extends pa.a{constructor(G){super();this.hda=null;this.BIc=0;this.xYb=(da,$a)=>{(null===$a||void 0===$a?0:$a.yoa)&&this.j3a($a.yoa,ad.pze)};this.OVc=()=>{this.UEg();this.kwg(this.hda,ad.Mok)};this.V6d=(da,$a)=>{$a.committed&&this.hda.SuspensionStartTimestamp&&wa.ULS.sendTraceTag(17318084,0,50,`PendingMergeMonitor.OnEditCellEnded: committed with counter ${zd(this.hda)}`)};this.UEg();
this.$=G;this.$.ea.uq(this.OVc);this.$.ea.NN(this.OVc);fc.f(this.$).sh.Wx(this.V6d);this.$.ka.Lh(292,da=>{da.Scb(this.xYb);wa.ULS.sendTraceTag(588276809,0,50,"PendingMergeMonitor initialized")})}Scb(G){this.addHandler("MCU",G)}ktb(G){this.removeHandler("MCU",G)}get Saa(){return this.hda}j3a(G,da){da=void 0===da?"":da;const $a=this.hda.Current<G.Current||this.hda.Pending<G.Pending;if(G.SuspensionStartTimestamp&&this.BIc!==G.SuspensionStartTimestamp){if(this.BIc>G.SuspensionStartTimestamp){$a&&wa.ULS.sendTraceTag(553736149,
0,50,`PendingMergeMonitor.OnMergeCounterReceivedFromServer: skipping a higher stale counter received via ${da}. S: ${ad.wYb(G)}, C: ${ad.wYb(this.hda)}`);return}$a||wa.ULS.sendTraceTag(553736148,0,50,`PendingMergeMonitor.OnMergeCounterReceivedFromServer: recovering from a potentially stale counter. S: ${ad.wYb(G)}, C: ${ad.wYb(this.hda)}`)}else if(!$a)return;this.hda=G;this.kwg(G,da)}dispose(){this.$.ea.pq(this.OVc);this.$.ea.wP(this.OVc);fc.f(this.$).sh.Zw(this.V6d);const G=this.$.ka.Ug(292);G&&
G.ktb(this.xYb);super.dispose()}kwg(G,da){da=void 0===da?"":da;be(G)&&G.SuspensionStartTimestamp>this.BIc&&(wa.ULS.sendTraceTag(537155416,0,50,`PendingMergeMonitor.RaiseMergeCounterUpdated: Merge suspension requested. MergeCounter: ${zd(G)}, Origin: ${da}`),this.BIc=G.SuspensionStartTimestamp);this.raiseEvent("MCU",new ac.a(G))}UEg(){wa.ULS.sendTraceTag(588276808,0,50,`PendingMergeMonitor.ResetMergeCounter : Last counter was ${ad.wYb(this.hda)}`);this.hda=Object(Bb.a)(new yg.a,{Pending:0,Current:0,
SuspensionStartTimestamp:null})}static wYb(G){return G?`(${G.Current}/${G.Pending} @${G.SuspensionStartTimestamp})`:"null"}}ad.pze="PMM.RTC";ad.Ptc="PMM.EwaResult";ad.Mok="PMM.resetMergeCounter";Object(ka.a)(ad,"PendingMergeMonitor",pa.a,[]);class Jd{}Object(ka.a)(Jd,"ClientRevisions",null,[]);const De=(G,da,$a,Sb,Mc,sd,Od)=>{Od=G.Za(1,void 0===Od?null:Od);Od.suspensionStartTimestamp=da;return ec.h(G,"KeepBlockingPendingMerges",Od,$a,Sb,Mc,sd,0)};class Xe extends pa.a{constructor(G,da,$a,Sb){super();
this.bXa=null;this.yWb=0;this.zWb=this.Onb=null;this.Glg=(Mc,sd)=>{this.bXa.UGh(sd.yoa,sd.eDh,sd.KOk)};this.$_b=(Mc,sd)=>{sd.AKa?this.XQk():this.ZYc()};this.Jjg=()=>{this.yWb=0};this.OJg=()=>{const Mc=this.eha.vKd();De(this.ta,null!=Mc.SuspensionStartTimestamp?Mc.SuspensionStartTimestamp:0,null,()=>{this.ASj(Mc)},null,null,this.ta.Jh())};this.oQa=(Mc,sd)=>{if(sd){sd.GGb.MergeCount=this.eha.vKd();const {min:Od,max:se}=fc.f(this.$).cEj();xb.EwaSettings.isChangeGateEnabled("OfficeVSO:5524817_LogOnMergeRaceCondition2")?
sd.GGb.ClientRevisions=Object(Bb.a)(new Jd,{Min:Od,Max:se,MaxFromBlockCache:fc.f(this.$).za.N9f}):sd.GGb.ClientRevisions=Object(Bb.a)(new Jd,{Min:Od,Max:se})}};this.$=G;this.Mdb=$a;this.eha=da;this.eha.nAh(this.Glg);this.eha.Okc(this.$_b);this.eha.vzh(this.Jjg);this.$.pa.tGb(this.oQa);this.ta=this.$.pa.ta;this.bie=this.$.ua.MergeSuspensionRequestThrottlingTimeInMs;this.esj=this.$.ua.KeepBlockingPendingMergesRequestIntervalMs;this.bXa=Sb;wa.ULS.sendTraceTag(588276807,0,50,"RequestController initialized")}dispose(){this.$.pa.p3b(this.oQa);
this.ZYc();this.eha.ykk(this.Glg);this.eha.YSc(this.$_b);this.eha.Tjk(this.Jjg);this.eha=null;super.dispose()}XQk(){this.ZYc();if(this.Olf()){const G=this.eha.vKd();wa.ULS.sendTraceTag(537155414,0,50,`RequestController.StartKeepBlockingPendingMergesTimer: Prevented starting StartKeepBlockingPendingMergesTimer because of repeated failure in counter ${zd(G)} fail count: ${this.yWb}`)}else this.zWb=this.Mdb.create(this.OJg,this.bie,Mb.a.zWb),this.Onb=this.Mdb.jO(this.OJg,this.esj,Mb.a.Onb)}ZYc(){this.Onb&&
(this.zWb.cancel(),this.Onb.cancel(),this.Onb=this.zWb=null)}ASj(G){let da;da=" fail count: "+this.yWb;this.yWb++;this.Olf()&&this.ZYc();wa.ULS.sendTraceTag(542229773,0,10,`RequestController.OnKeepBlockingPendingMergesRequestFailed: request failed ${zd(G)}${da}`)}Olf(){return this.yWb>Xe.FCj}}Xe.FCj=5;Object(ka.a)(Xe,"RequestController",pa.a,[]);class lf extends Sys.EventArgs{constructor(G,da){super();this.p$f=G;this.Saa=da}}Object(ka.a)(lf,"MergeDidntOccurEventArgs",Sys.EventArgs,[]);class mf extends pa.a{get u_a(){return 0<
this.n9d}constructor(G,da,$a,Sb,Mc){$a=void 0===$a?null:$a;Sb=void 0===Sb?null:Sb;Mc=void 0===Mc?null:Mc;super();this.AIc=null;this.n9d=0;this.documentVisibilityObserver=null;this.$1f=!1;this.VKc=null;this.ta=G;this.bie=da.ua.MergeSuspensionRequestThrottlingTimeInMs;const sd=da.ua.GetRangeContentPrefetchDelayForMergeInMs;this.AD=()=>{da.qIg(sd)};this.Bp=$a||wd.a.Tg;this.M4g=0;this.WV=Sb;this.jOa=Mc;xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",
!1)?void Wc.a.resolve(Qc.Ab).then(Od=>{this.documentVisibilityObserver=Od}):da.ka.Lh(291,Od=>{this.documentVisibilityObserver=Od})}X0e(G){this.addHandler(mf.f3d,G)}dCg(G){this.removeHandler(mf.f3d,G)}get isDocumentHidden(){return!!this.documentVisibilityObserver&&this.documentVisibilityObserver.tn}UGh(G,da,$a){this.B6b(G,da,void 0===$a?!1:$a)?(new ma.a).setResult(!0):(da=this.p2j(G,da),this.AIc=G,this.n9d++,da.continueWith(()=>{this.INj()},0,Pd.a.none,this.WV))}p2j(G,da){this.M4g=this.Bp.ara;this.$1f=
da;wa.ULS.sendTraceTag(554767493,0,50,`DoPendingMergeSender.performDoPendingMergeInternal: Sending DoPendingMerge ${G.Current} / ${G.Pending} @${G.SuspensionStartTimestamp}. allowSelectionAdjustment: ${da}`);this.isDocumentHidden||this.AD();return this.Xvk(da,G)}B6b(G,da,$a){$a=void 0===$a?!1:$a;if(this.jOa&&!da&&!this.jOa.ppj())return wa.ULS.sendTraceTag(523317956,0,50,"DoPendingMergeSender.shouldThrottle: We can't retrieve selection and selection adjustments are disallowed."),!0;if(!this.AIc||G.SuspensionStartTimestamp>
this.AIc.SuspensionStartTimestamp)return this.u_a&&wa.ULS.sendTraceTag(523551556,0,50,`DoPendingMergeSender.shouldThrottle: Allowing request for new suspension while previous is ongoing, new counter: ${G.Current} / ${G.Pending} @${G.SuspensionStartTimestamp}`),!1;if(this.u_a)return!0;if($a)return!1;$a=this.AIc;const Sb=this.Bp.ara-this.M4g<this.bie;da=this.$1f===da;return(G||$a?G&&$a?G.Current===$a.Current&&G.Pending===$a.Pending&&G.SuspensionStartTimestamp===$a.SuspensionStartTimestamp:!1:!0)&&Sb&&
da}Xvk(G,da){const $a=this.ta.Jh(),Sb=()=>{wa.ULS.sendTraceTag(588276806,0,10,`DoPendingMergeSender.sendDoPendingMergeRequest: request failed ${da.Current} / ${da.Pending} @${da.SuspensionStartTimestamp}`)};return this.jOa?this.jOa.dsk(this.THi(G,Sb,$a)):this.M9e(null,!0,void 0,Sb,$a)}THi(G,da,$a){return(Sb,Mc,sd)=>{let Od=void 0;wa.ULS.shipAssertTag(523317955,0,null!=Sb||G,"!allowSelectionAdjustment requires a non-null initialViewportState.");Od=this.JNj.bind(this);Mc&&(Od=Ac.c.call(null,se=>{const Ye=
se.Result;let hf=null===Ye||void 0===Ye?void 0:Ye.AdjustedViewportState;3===(null===Ye||void 0===Ye?void 0:Ye.MergeResultState)&&(hf=void 0);Mc(hf,se.StateId)},Od));sd&&(da=Ac.b.call(null,sd,da));return this.M9e(Sb,G,Od,da,$a)}}M9e(G,da,$a,Sb,Mc){var sd=this.ta;Mc=sd.Za(1,void 0===Mc?null:Mc);Mc.viewportState=G;Mc.allowViewAdjustment=da;return ec.h(sd,"DoPendingMerge",Mc,$a,Sb,null,null,0)}JNj(G){var da=G.Result;void 0!=da&&(da=da.MergeResultState,2!==da&&(this.VKc=[da,G.MergeCount]))}t$j(G,da){this.raiseEvent(mf.f3d,
new lf(G,da))}INj(){this.n9d--;if(this.VKc){const G=this.VKc;this.VKc=null;this.t$j(...G)}}}mf.f3d="MDO";Object(ka.a)(mf,"DoPendingMergeSender",pa.a,[609,610]);class Rf{constructor(G){this.divergenceOnResponse=this.adjustedDidntChangeWithDivergence=this.editBoxDivergence=this.differentSheetAdjust=this.parallel=this.errors=this.nonContinuous=this.divergenceOnViewportReady=this.adjusted=this.adjustedDidntChange=0;this.C7i=void 0===G?!1:G}get reportName(){return this.C7i?"SelectionAdjustInHiddenDocument":
"SelectionAdjust"}}Object(ka.a)(Rf,"SelectionAdjustSessionEndsReport",null,[85]);class sg{constructor(G,da,$a,Sb,Mc,sd){this.fh=G;this.$P=da;this.nka=$a;this.jTa=Sb;this.pDe=Mc;this.yW=sd}get activeCell(){return this.$P}get selectedRanges(){return this.nka}get qy(){let G=!1;if(null===this.yW||void 0===this.yW)G=!0;else if(this.yW>=this.selectedRanges.length||!this.selectedRanges[this.yW].contains(this.activeCell))wa.ULS.sendTraceTag(521200010,0,50,`SelectionState.indexOfActiveRange: the index of the adjusted active range has changed. indexOfActiveRange: ${this.yW}, selectedRangesLength: ${this.selectedRanges.length}`),
G=!0;G&&(this.yW=this.EOh());return this.yW}get activeRange(){return 0>this.qy?this.activeCell:this.selectedRanges[this.qy]}get sheetName(){return this.jTa}get activeItemName(){return this.pDe}get D$g(){return 1===this.selectedRanges.length}W5g(G){const da=this.selectedRanges.map($a=>this.E_k($a,this.pDe));for(const $a of da)if($a)for(const Sb of $a)if(Sb.Fp&&Sb.jk.Revision<G)return!1;return!0}UWk(){var G;return{SheetName:this.sheetName,ActiveCell:null===(G=this.activeCell)||void 0===G?void 0:G.toString(),
TopLeft:void 0,SelectedRanges:Pe.s(this.selectedRanges,this.fh)}}toString(){var G,da;return`active cell: ${null!==(da=null===(G=this.activeCell)||void 0===G?void 0:G.toString())&&void 0!==da?da:"null"} selection: ${this.selectedRanges.map($a=>{var Sb;return null!==(Sb=null===$a||void 0===$a?void 0:$a.toString())&&void 0!==Sb?Sb:"null"}).join(",")}`}equals(G){return G?this.activeCell.equals(G.activeCell)&&Pe.W(this.selectedRanges,G.selectedRanges)&&this.sheetName===G.sheetName:!1}EOh(){for(const G of this.selectedRanges.entries()){const [da,
$a]=G;if(null===$a||void 0===$a?0:$a.contains(this.activeCell))return da}return-1}E_k(G,da){var $a;const Sb=fc.f(this.fh).za.yIa(G,da);Sb||wa.ULS.sendTraceTag(522803340,0,50,`SelectionState.tryGetBlockCacheItemsFromRange: no items found. range: ${null!==($a=null===G||void 0===G?void 0:G.toString())&&void 0!==$a?$a:"null"} ; activeItemNameIsDefined: ${!!da}`);return Sb}}Object(ka.a)(sg,"SelectionState",null,[]);var wg=a(202),Mg=a(923);class Sg{constructor(G){this.RYc=0;this.HQ=this.TO=null;this.HDe=
new Rf;this.IDe=new Rf(!0);this.GR=0;this.bVk=!1;this.hEj=1E4;this.xj=()=>{this.Cif()};this.Xo=()=>{this.Ipd(!0,!1)};this.cqb=()=>{this.Ipd(!1,!1)};this.$=G;this.da=fc.f(this.$);this.da.za.Uy(this.Xo);this.da.za.Vy(this.cqb);this.da.za.n0e(this.cqb);this.da.za.Cka(this.cqb);this.$.nr(this.xj);this.Cif()}dsk(G){let da=null,$a=null;const Sb=()=>{this.RJj()};this.DTf()?(this.c_.parallel++,wa.ULS.sendTraceTag(526390086,0,15,`SelectionAdjustManager.runRequestWithSelectionAdjust: Skipping parallel request. Current adjustedSelection is defined : ${!!this.HQ}`)):
(da=(Mc,sd)=>{this.SJj(Mc,sd)},$a=this.mCk());return null===G||void 0===G?void 0:G($a,da,Sb)}ppj(){return!this.DTf()&&this.G$().D$g}mCk(){var G;wa.ULS.shipAssertTag(525135961,0,0===this.GR,"SelectionAdjustManager.setPreRequestState: unexpected state");this.HQ&&(this.c_.errors++,wa.ULS.sendTraceTag(526960090,0,10,`SelectionAdjustManager.setPreRequestState: About to ignore a defined Adjusted selection: ${this.HQ.toString()}`));this.HQ=null;this.TO=this.G$();let da=null;const $a=null===(G=this.TO)||
void 0===G?void 0:G.UWk();$a&&(da={ActiveSheetName:this.TO.sheetName,SheetViewportStateChanges:[$a]});this.GR=1;return da}RJj(){wa.ULS.shipAssertTag(525135960,0,1===this.GR,"SelectionAdjustManager.onAdjustedRequestFailed: unexpected state");this.c_.errors++;this.GR=2;this.ux()}SJj(G,da){try{wa.ULS.shipAssertTag(525135959,0,1===this.GR,"SelectionAdjustManager.onAdjustedSelectionReady: unexpected state"),this.RYc=da,da=2,this.TO?G?(this.HQ=this.rGk(G))?(da=7,this.TO.equals(this.HQ)?this.TO.equals(this.G$())?
(this.c_.adjustedDidntChange++,da=4):(this.c_.adjustedDidntChangeWithDivergence++,da=5):this.TO.sheetName!=this.HQ.sheetName?(this.c_.differentSheetAdjust++,da=10):this.TO.equals(this.G$())||(this.c_.divergenceOnResponse++,da=6,this.tDg())):this.c_.errors++:(this.c_.errors++,wa.ULS.sendTraceTag(537155412,0,15,`SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted returned null, initialSelection: ${this.TO.toString()}`)):(this.c_.errors++,wa.ULS.sendTraceTag(537155413,0,10,`SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted selection results returned when not waiting for them, adjusted:  ActiveCell: ${null===
G||void 0===G?void 0:G.ActiveCell}`)),this.GR=da}catch($a){this.GR=12,wa.ULS.sendTraceTag(525135958,0,10,`SelectionAdjustManager.OnAdjustedSelectionReady: caught Exception ${$a}`)}finally{7!=this.GR?this.ux():this.Ipd(!1,!0)}}dispose(){this.da.za.Ix(this.Xo);this.da.za.Fy(this.cqb);this.da.za.vBg(this.cqb);this.da.za.l5a(this.cqb);this.$.Pr(this.xj)}DTf(){return 1===this.GR||7===this.GR}rGk(G){let da;if(!(()=>{let sd=Pe.ib(G.ActiveCell,this.$.sa);({range:da}=sd);return sd})().returnValue)return wa.ULS.sendTraceTag(537155411,
0,10,`SelectionAdjustManager.sheetViewportStateToSelectionState: Unable to extract active cell ${G.ActiveCell}`),null;let $a=[];const Sb=this.$.na,Mc=!!Sb&&2===Sb.iG;if(G.SelectedRanges)$a=Pe.h(G.SelectedRanges.Ranges);else if(!Mc)return wa.ULS.sendTraceTag(522826913,0,10,`SelectionAdjustManager.sheetViewportStateToSelectionState: SelectedRanges is null, active sheet exists: ${!!Sb}`),null;return new sg(this.$,da,$a,G.SheetName,this.TO.activeItemName,this.TO.qy)}G$(){const G=this.$.na;if((null===
G||void 0===G?0:G.activeCell)&&G.selectedRanges&&G.sheetName)return new sg(this.$,G.activeCell,G.selectedRanges,G.sheetName,this.$.activeItemName,G.qy);wa.ULS.sendTraceTag(525135957,0,15,`SelectionAdjustManager.getCurrentSelection: invalid activeItem. activeItem null: ${!G}, activeCell null: ${!(null===G||void 0===G?0:G.activeCell)}, selectedRanges null: ${!(null===G||void 0===G?0:G.selectedRanges)}, sheetName null: ${!(null===G||void 0===G?0:G.sheetName)}`);return null}Cif(){this.$.ka.Lh(276,()=>
{const G=wg.a(this.$);G.r3(this.HDe);G.r3(this.IDe)})}Ipd(G,da){var $a;if(this.tnj(G))if(8===this.GR)wa.ULS.sendTraceTag(523106438,0,15,"SelectionAdjustManager.attemptAdjustSelection: skipping as was already adjusted");else{da&&wa.ULS.sendTraceTag(524039250,0,50,"SelectionAdjustManager.attemptAdjustSelection: viewport ready on response");try{wa.ULS.shipAssertTag(525135956,0,7===this.GR,"SelectionAdjustManager.attemptAdjustSelection: unexpected state"),this.TO.equals(this.G$())?(null===($a=this.da)||
void 0===$a?0:$a.isEditing)?(this.c_.editBoxDivergence++,this.GR=11):(G=0,G=this.HQ.qy,-1==G?(this.c_.errors++,wa.ULS.sendTraceTag(522826912,0,10,"SelectionAdjustManager.attemptAdjustSelection: invalid indexOfActiveRange")):(this.c_.adjusted++,this.GR=8,this.da.ha.DP(this.HQ.selectedRanges,G,this.HQ.activeCell,0,void 0,"SelectionAdjust"))):(this.c_.divergenceOnViewportReady++,this.tDg(),this.GR=9)}catch(Sb){this.GR=12,wa.ULS.sendTraceTag(525135955,0,10,`SelectionAdjustManager.attemptAdjustSelection: caught Exception ${Sb}`)}finally{this.ux()}}}tnj(G){if(!this.HQ)return!1;
if(!this.TO)return wa.ULS.sendTraceTag(537155409,0,10,`SelectionAdjustManager.attemptAdjustSelection: initialSelection is null while adjustedSelection isn't null, adjustedSelection: ${this.HQ.toString()}`),!1;if(fc.f(this.$).za.N9f<this.RYc)return!1;if(G||this.bVk)wa.ULS.sendTraceTag(528590295,0,15,"SelectionAdjustManager.attemptAdjustSelection: got to blockCacheConsistent while pending for selection adjust");else if(!this.TO.W5g(this.RYc)||!this.HQ.W5g(this.RYc))return!1;return!0}ux(){this.TO=this.HQ=
null;this.GR=0}tDg(){const G=this.G$();wa.ULS.sendTraceTag(537155408,0,50,`SelectionAdjustManager.ReportDivergence: initial: ${this.TO.toString()} current: ${G?G.toString():""} adjusted: ${this.HQ.toString()} sheetSameBetweenInitialAndAdjusted: ${this.TO.sheetName===this.HQ.sheetName} sheetSameBetweenInitialAndCurrent: ${this.TO.sheetName===(G?G.sheetName:null)}`)}get c_(){return Mg.a.tM(this.hEj)?this.IDe:this.HDe}}Object(ka.a)(Sg,"SelectionAdjustManager",null,[608,2]);class Qi extends rb.a{constructor(G,
da,$a){$a=void 0===$a?null:$a;super();this.$Qa=this.UCc=this.jlb=this.Xeb=null;this.$=G;this.Wab=new ad(G);this.jOa=new Sg(this.$);this.bXa=new mf(this.$.pa.ta,this.$,void 0,void 0,this.jOa);this.A9i(G,$a);this.hsa=new gd(this.$Qa,this.Wab,this.bXa);this.Xhe=new Xe(G,this.hsa,da,this.bXa);xb.EwaSettings.Ra(230)&&(this.UCc=new Jf(G,this));wa.ULS.sendTraceTag(588276810,0,50,"MergeSuspensionManager created")}Okc(G){this.hsa.Okc(G)}YSc(G){this.hsa&&this.hsa.YSc(G)}get rua(){return this.$Qa}get yza(){return this.Wab}get eha(){return this.hsa}zNa(G,
da){this.$Qa.zNa(G,da)}iwe(G){this.$Qa.iwe(G)}j3a(G,da){this.Wab.j3a(G,void 0===da?"":da)}dispose(){this.UCc&&(this.UCc.dispose(),this.UCc=null);this.jOa&&this.jOa.dispose();this.bXa.dispose();this.Xhe&&(this.Xhe.dispose(),this.Xhe=null);this.hsa&&(this.hsa.dispose(),this.hsa=null);this.Wab.dispose();this.Wab=null;this.$Qa.dispose();this.$Qa=null;this.Xeb&&(this.Xeb.dispose(),this.Xeb=null);this.jlb&&(this.jlb.dispose(),this.jlb=null);this.$=null;super.dispose()}Q1b(){this.hsa.aak()}static Cxc(G){let da=
0;for(const $a of G){if(2==$a)return 2;1==$a&&(da=1)}return da}A9i(G,da){this.$Qa=new we(this.bXa,this.Wab);da?Object(Kb.a)(ef,da)?this.zNa(da,Object(Hc.a)(ef,da).TR):Object(Kb.a)(jb,da)?this.zNa(da,Object(Hc.a)(jb,da).TR):this.zNa(da,0):(this.Xeb=new jb(G),this.jlb=new ef(G),this.zNa(this.Xeb,this.Xeb.TR),this.zNa(this.jlb,this.jlb.TR))}}Object(ka.a)(Qi,"MergeSuspensionManager",rb.a,[587,2]);class ci extends Yf.a{constructor(G){super();this.Xi=G;this.Bl()}create(){wa.ULS.sendTraceTag(537155419,0,
50,"MergeSuspensionFactory.Create");this.Yj(this.Xi.ka.Ug(343)||this.Xi.ka.ph(343,new Qi(this.Xi,Fg.a.instance)))}static Aa(G){wa.ULS.sendTraceTag(537155418,0,50,"MergeSuspensionFactory.Attach");G.ka.ph(344,new ci(G))}}Object(ka.a)(ci,"MergeSuspensionFactory",Yf.a,[]);class hj{constructor(G){this.Yvb=!0;hj.Wej()?this.Yvb=!1:hj.uUf()?(wa.ULS.sendTraceTag(526434368,0,50,`LineageCatchUpExperimentManager is running in hybrid mode. TUI exhausted: ${!G}`),this.Yvb=G):this.Yvb=!1}ymb(){return!this.Yvb}static uUf(){return!xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DisableLineageTUI",
!1)}static Wej(){return xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BlueDot",!1)}}Object(ka.a)(hj,"LineageCatchUpExperimentManager",null,[583]);class nk extends Yf.a{constructor(G){super();this.$=G;this.Bl()}create(){hj.uUf()?lh.TaskExtensions.Ua(Object(Ze.d)(Wc.a.resolve(Qc.Dd,{va:this.hh})),G=>{lh.TaskExtensions.Ua(G.result.cJk(),da=>{this.fhf(da.result)},this.$.xa,3)},this.$.xa,3):this.fhf(!0)}fhf(G){this.Yj(this.$.ka.Ug(458)||this.$.ka.ph(458,new hj(G)))}static Aa(G){G.ka.ph(459,
new nk(G))}}Object(ka.a)(nk,"LineageCatchUpExperimentManagerFactory",Yf.a,[]);class bk extends Yf.a{constructor(G){super();this.$=G;this.Bl()}create(){this.Ldk(()=>Zc.Aa(this.$))}static Aa(G){G.ka.ph(50,new bk(G))}Ldk(G){G=Object(hg.a)(this.$.ka,183,G);this.Yj(G)}}Object(ka.a)(bk,"TaskPaneManagerFactory",Yf.a,[]);const Bh=()=>Sf.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),Xk=()=>Sf.a.instance.resolve("Common.App.Rename.IRenameFlyoutActor");var Fk=a(526),Yk=a(678),Tj=a(592),Dj=a(187);
class Gk{constructor(G,da,$a){this.LRg=this.MRg=this.NRg=!1;this.vSg=!G&&!da;this.wSg=!G&&!$a;this.vSg||this.wSg||(this.NRg=!G,this.MRg=!da,this.LRg=!$a)}}Object(ka.a)(Gk,"RenameDisabledDialogInfo",null,[]);var Vf=a(23);class ok extends Dj.a{constructor(G,da,$a,Sb,Mc){super();this.Ite=[];this.wBb=new Gk(G,da,$a);this.XEb=Sb;this.NBb=Mc;this.Lk="RenameDisabledDialog";this.Bh=0;this.Yh(1,Object(Vf.a)("DialogClose"));this.GDk();this.Plk()}GDk(){if(this.wBb.vSg){let G;G=this.XEb?this.NBb?Object(Vf.a)("RenameFileRenameReadOnlyRecommended"):
Object(Vf.a)("RenameFileRenameNotEveryoneSupportsRename"):Object(Vf.a)("RenameFileRenameDisabledCoauthFull");this.uSg(G)}else this.wBb.wSg?this.uSg(Object(Vf.a)("RenameFileRenameDisabledPermissionFull")):this.Muh();this.kta(this.Ite)}uSg(G){Array.add(this.Ite,G)}Muh(){const G=[];this.wBb.NRg||Array.add(G,Object(Vf.a)("RenameFileRenameDisabledSignIn"));this.wBb.MRg||Array.add(G,Object(Vf.a)("RenameFileRenameDisabledPermission"));this.wBb.LRg||Array.add(G,Object(Vf.a)("RenameFileRenameDisabledCoauth"));
0<G.length&&Array.add(this.Ite,G)}}Object(ka.a)(ok,"ReactRenameDisabledDialogBase",Dj.a,[]);class Hk extends ok{constructor(G,da,$a,Sb,Mc){super(G,da,$a,Sb,Mc)}Plk(){this.qpb(Object(Vf.a)("RenameFileRenameDisabledTitle"),null,null,null,null,null)}}Object(ka.a)(Hk,"RenameDisabledDialog",ok,[]);class ck{constructor(G,da){this.tSa=0;this.vla=($a,Sb,Mc,sd,Od)=>{if(1===Mc)return this.$c.Gk(vb.a.renameFile,1);$a=kb.a.kz(this.Fra.ov);Od=(0,Od.getNewDocumentTitle)();Od.length>this.tSa&&(Od=Od.substr(0,this.tSa));
if(32!==this.$c.Xj(vb.a.renameFile,2,Od))return this.g8($a),8;this.g8(Od);return 32};this.$c=G;this.Fra=da}initialize(G){if(!this.$c||!this.Fra)return!1;this.tSa=G;this.ko();return!0}ko(){this.$c.Hh(vb.a.vla,Fb.a.frame,this.vla)}g8(G){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(G))}static bKd(){return new ck(Za.AFrameworkApplication.jh,Za.AFrameworkApplication.Qt)}}Object(ka.a)(ck,"ReactRenameUIHandler",null,[620]);const Ik=()=>Sf.a.instance.Qi("Common.App.Header.HeaderEventSource");
var Jj=a(109),Zk=a(601),pk=a(843),ij=a(475),Uj=a(60);class dk{constructor(G,da,$a,Sb,Mc,sd,Od,se,Ye,hf,ag,Jg){this._initialized=!1;this._element=null;this.tSa=0;this.ihd=this.Y$c=!1;this.$c=G;this.R5c=da;this.Rk=$a;this.BJ=Sb;this.Fra=Mc;this.UTe=sd;this.hhc=Od;this.O6c=se;this.Oja=Ye;this.aMe=hf;this.dab=ag;this.Xad=Jg}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(G,da,$a){if(!(this.$c&&this.Fra&&this.UTe&&this.hhc&&this.O6c&&da)||0>=G)return!1;this._element=
da;this._element.title=$a;this._element.setAttribute(ij.a.Oj,ij.a.fF);this._element.setAttribute("Unselectable","on");this.tSa=G;this.wE();return this._initialized=!0}wE(){this.R5c&&(this.R5c.ya(Ge.a.blur,this._element,Object(Jc.a)(this,this.onBlur,"onBlur")),this.R5c.ya(Ge.a.paste,this._element,Object(Jc.a)(this,this.onPaste,"onPaste")));this.Rk.ya(Ge.a.zi,this._element,Object(Jc.a)(this,this.onKeyDown,"onKeyDown"));this.BJ.ya(Ge.a.Zi,this._element,Object(Jc.a)(this,this.onPointerDown,"onPointerDown"));
this.BJ.ya(Ge.a.jo,this._element,Object(Jc.a)(this,this.io,"onPointerUp"))}onBlur(){this.isActive&&!this.Y$c&&(this.aMe||this.O6c(this._element),this.Qdf(),this.Eyd(!1));return this.Y$c=!1}onPaste(){wa.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(G){return this.isActive?this.ESj(G):this.FSj(G)}ESj(G){let da=!1;switch(G.La.keyCode){case Sys.UI.Key.enter:this.Qdf();this.Eyd(this.dab||this.Xad);da=!0;break;case Sys.UI.Key.tab:this.aMe&&this.O6c(this._element);
break;case Sys.UI.Key.esc:this.Vie(),this.Eyd(this.dab||this.Xad),da=!0}return da}FSj(G){let da=!1;switch(G.La.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.d_g(this.Xad),this.isActive&&this.hhc(this._element),da=!0}return da}onPointerDown(){this.isActive||(this.d_g(!1),this.isActive&&(this._element.focus(),this.hhc(this._element),this.ihd=!0));return!1}io(){return this.ihd?(this.hhc(this._element),this.ihd=!1,!0):!1}Umb(){return 32===this.$c.Gk(vb.a.renameFile,1)}Qdf(){const G=kb.a.kz(this.Fra.ov);
let da=this._element.innerText.trim();da.length>this.tSa&&(da=da.substr(0,this.tSa));da!==G&&""!==da?32!==this.$c.Xj(vb.a.renameFile,2,da)?this.Vie():this.g8(da):this.Vie()}Vie(){this.g8(kb.a.kz(this.Fra.ov))}g8(G){this._initialized&&(this._element.innerText=G,this.UTe())}d_g(G){this.Umb()?this.isActive||(G&&(this.Y$c=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(ij.a.Oj,ij.a.opd),this._element.style.width=
"auto",Sys.UI.DomElement.addCssClass(this._element,Jj.a.qof),this.Oja&&this.Oja.execute(da=>{da.ywg(!0)}),G&&this._element.focus(),wa.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.$c.Gk(vb.a.Xvb,2)}Eyd(G){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(ij.a.Oj,ij.a.fF);Sys.UI.DomElement.removeCssClass(this._element,Jj.a.qof);this.Oja&&this.Oja.execute(da=>{da.ywg(!1)});G&&(this._element.blur(),this._element.focus())}static dJ(){Zk.a.dJ(Za.AFrameworkApplication.isRtl)}static bKd(){return new dk(Za.AFrameworkApplication.jh,
pk.a.instance,Je.a.instance,ca.a.instance,Za.AFrameworkApplication.Qt,dk.dJ,Uj.a.fvk,Uj.a.UTh,Ik(),wf.a.Fga,wf.a.Un,wf.a.hm)}}Object(ka.a)(dk,"RenameUIHandler",null,[620]);class zj{static get instance(){return Za.AFrameworkApplication.ra.$d.jw?zj.Wa||(zj.Wa=ck.bKd()):zj.Wa||(zj.Wa=dk.bKd())}}zj.Wa=null;Object(ka.a)(zj,"RenameUIHandlerFactory",null,[]);var Jk=a(201);class $k{constructor(){this.DGj=this.xGj=this.D7h=null}}Object(ka.a)($k,"RenameMruEntryProperties",null,[]);var Ri=a(763),Oj;(function(G){G[G.unknown=
-1]="unknown";G[G.success=0]="success";G[G.crl=1]="renameInvalidFileName";G[G.brl=2]="renameInCoauthNotSupported";G[G.drl=3]="renameNotSupportedInViewMode";G[G.Kql=4]="permissionDenied";G[G.wrl=5]="serverCommunicationFailure";G[G.til=6]="fileNameTooLong"})(Oj||(Oj={}));Object(ka.b)("CommonOperationResult",Oj);class al{constructor(G,da){this.fileNameCandidate=G;this.disableFailedActionDialog=void 0===da?!1:da}}Object(ka.a)(al,"RenameActionData",null,[]);class jj{constructor(G,da,$a,Sb,Mc,sd,Od,se,
Ye,hf,ag,Jg){this.TSb=()=>zj.instance.initialize(Za.AFrameworkApplication.$vc,Za.AFrameworkApplication.eXa,Za.AFrameworkApplication.Tge||Object(Vf.a)("RenameFileTooltip"))?32:8;this.Xvb=()=>{const tg=this.i8k(),Xg=this.prh();wa.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",this.yab,Xg,tg,this.XEb);new Hk(this.yab,!Xg,!tg,this.XEb,this.NBb());return 32};
this.renameFile=(tg,Xg,hi,xj,zi)=>{if(1===hi)return this.Umb();if(!Za.AFrameworkApplication.uvc)return 8;if(8===this.Umb())return this.Wp.Gk(vb.a.Xvb,2),8;this.aia&&this.aia.j1c(!1);wa.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");tg=!1;zi instanceof al&&(tg=zi.disableFailedActionDialog,zi=zi.fileNameCandidate);Za.AFrameworkApplication.uvc(zi,Object(Jc.a)(this,this.G_b,"onRenameFileSuccess"),tg?this.yKj:this.wVj);Za.AFrameworkApplication.Blk=!0;return 32};this.yKj=tg=>{wa.ULS.sendTraceTag(507655632,
203,15,"OnAutoRenameFileFailure: {0}",{["Result"]:null!==tg&&void 0!==tg?tg:-1});this.aia&&this.aia.j1c(!0)};this.wVj=tg=>{wa.ULS.sendTraceTag(507655631,203,15,"OnRenameFileFailure: {0}",{["Result"]:null!==tg&&void 0!==tg?tg:-1});const Xg=new Dj.a;Xg.Bh=0;switch(tg){case 1:wa.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");Xg.XAa(Object(Vf.a)("RenameFileInvalidNameTitle"),Object(Vf.a)("RenameFileInvalidName"),null);break;case 6:wa.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");
Xg.XAa(Object(Vf.a)("RenameFileInvalidNameTitle"),Object(Vf.a)("RenameFileNameTooLong"),null);break;default:wa.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:null!==tg&&void 0!==tg?tg:-1}),Xg.XAa(Object(Vf.a)("RenameFileGenericErrorTitle"),Object(Vf.a)("RenameFileGenericError"),null)}Za.AFrameworkApplication.BI().execute(hi=>{hi.sendMessage(Jb.a.nti,{["FailureMessage"]:Oj[tg]})});this.xFg();this.aia&&this.aia.j1c(!0)};this.ydk=(tg,Xg,hi)=>{if(1===hi)return this.Umb();if(!Za.AFrameworkApplication.JXa)return 8;
Za.AFrameworkApplication.JXa(Object(Jc.a)(this,this.ZNc,"onRefreshFilenameSuccess"),Object(Jc.a)(this,this.YNc,"onRefreshFilenameFailure"),!1);return 32};this.nLc=(tg,Xg,hi,xj,zi)=>{if(1===hi)return Za.AFrameworkApplication.fa.la("UiHostSupportsMoveToFolder")?this.Umb():8;if(2===hi){if(!Za.AFrameworkApplication.LJg)return nb.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),8;if(!zi)return nb.Health.instance.recordKpiFailure("MoveToFolder",
"Null actiondata",!1,!1,null),8;if(zi[Xa.a.zgj])if(zi[Xa.a.e4g])if(tg=zi[Xa.a.e4g].toLowerCase(),Xg=Za.AFrameworkApplication.fa.la("UiHostSupportsDocRebootFeatures"),hi=Za.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),Xg&&Za.AFrameworkApplication.NU&&hi){const Gi={};Gi[Xa.a.H4a]="1";Gi[Xa.a.documentUrl]=tg;Gi[Xa.a.reason]=Ri.a.saveAs;nb.Health.instance.recordKpiSuccess("MoveToFolder",null);Za.AFrameworkApplication.BI().execute(Ai=>{Ai.sendMessage(Jb.a.t4,
Gi)})}else if(!Za.AFrameworkApplication.NU&&hi)nb.Health.instance.recordKpiSuccess("MoveToFolder",null),Uj.a.dm(tg,Uj.a.q2(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return nb.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else nb.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else Za.AFrameworkApplication.JXa(Object(Jc.a)(this,this.ZNc,"onRefreshFilenameSuccess"),Object(Jc.a)(this,this.YNc,"onRefreshFilenameFailure"),
!1),Za.AFrameworkApplication.LJg(),nb.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32};this.oMe=G;this.$c=da;this.Y6c=$a;this.ZH=Sb;this.yab=Mc;this.prh=sd;this.XEb=Od;this.aXe=se;this.Knh=Ye;this.NBb=hf;this.Ga=ag;this.Jnh=Jg;this.aTa=new Tj.a(()=>this.vTi())}ko(){Za.AFrameworkApplication.ra&&Za.AFrameworkApplication.ra.$d.jw||this.Wp.Hh(vb.a.TSb,Fb.a.frame,this.TSb);this.Wp.Hh(vb.a.Xvb,Fb.a.frame,this.Xvb);this.Wp.Hh(vb.a.renameFile,Fb.a.frame,this.renameFile);this.Wp.Vk(vb.a.awc,
Fb.a.frame,this.ydk,64);this.Wp.Vk(vb.a.nLc,Fb.a.frame,this.nLc,64);this.Wp.Hh(vb.a.x2a,Fb.a.frame,Object(Jc.a)(this,this.x2a,"moveToFolder"));(Za.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||Za.AFrameworkApplication.ra&&(Za.AFrameworkApplication.fa.la("PostMessageEmbedded")||Za.AFrameworkApplication.fa.la("IsJsApi"))&&Za.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",!0))&&Za.AFrameworkApplication.BI().execute(G=>
{G.Tq(Jb.a.cag);G.Ip(Jb.a.cag,jj.Ybk);G.Tq(Jb.a.sEd);G.Ip(Jb.a.sEd,jj.Wbk)})}Umb(){return 0===this.Jnh.UHf()?32:8}i8k(){return this.pI?this.XEb?this.pI.pnf:this.pI.bPb:!0}vTi(){return this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIconsWithStrings",!1)?Sf.a.instance.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"):null}G_b(G,da){G?0!==G.OperationResult?this.eMf(G.OperationResult):(this.vwk(da,G.NewName),this.T2k(G,Object(Jc.a)(Za.AFrameworkApplication.ra.$d,
Za.AFrameworkApplication.ra.$d.e3g,"updateOpenInClientDocumentUrl")),Za.AFrameworkApplication.fa.la("DocumentNameInJewelInfoMenuIsEnabled")&&Za.AFrameworkApplication.ra.AB(),this.Knh.w1g()):this.eMf(5);this.aia&&this.aia.j1c(!0)}vwk(G,da){const $a={};$a[Xa.a.oti]=da;G.sendMessage(Jb.a.sEd,$a)}T2k(G,da){this.f3k(G);Za.AFrameworkApplication.Ssc=G.DirectInvokeDavUrl;da=da(G.EditDocInClientUrl);const $a=new $k;$a.DGj=this.ZH.ov;$a.D7h=da;$a.xGj=G.EditDocInClientUrl;this.Wp.Xj(vb.a.renameMostRecentlyUsedFileEntry,
2,$a)}eMf(G){switch(G){case 1:G=new Dj.a,G.Bh=0,G.QV(Object(Vf.a)("RenameFileInvalidNameTitle"),Object(Vf.a)("RenameFileInvalidName"),null),this.xFg()}}f3k(G){this.ZH.ov=jj.gEh(this.ZH.ov,G.NewName);G.BreadcrumbFolderName&&(this.ZH.breadcrumbFolderName=G.BreadcrumbFolderName);G.BreadcrumbFolderUrl&&(this.ZH.breadcrumbFolderUrl=G.BreadcrumbFolderUrl);this.aXe(G.NewName)}x2a(G,da,$a,Sb,Mc){if(1===$a)return Za.AFrameworkApplication.fa.la("UiHostSupportsMoveToFolder")?32:8;if(2===$a){const sd={};G=Za.AFrameworkApplication.NU;
da=Za.AFrameworkApplication.fa.la("UiHostSupportsDocRebootFeatures");G=(!G||G&&da)&&Za.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);sd[Xa.a.lTk]=G;Mc&&Mc.MoveButtonClickedTime&&(sd[Xa.a.WEj]=Mc.MoveButtonClickedTime.getTime());Za.AFrameworkApplication.fa.la("DarkModeSupportInMoveFilePickerEnabled")&&(G={},Object(Hh.a)("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(G[Xa.a.yrg]="Dark"),sd[Xa.a.wrg]=G);Za.AFrameworkApplication.BI().execute(Od=>
{Od.sendMessage(Jb.a.x2a,sd)});if(Mc&&Mc.MoveButtonClickedTime){if(G=Jk.a.ey())Mc=(new Date).getTime()-Mc.MoveButtonClickedTime.getTime(),G.set("MovePostDuration",Mc.toString());nb.Health.instance.recordKpiUsage("MoveToFolder",Db.b.FailureBased,"smartfio",G)}return 32}return 8}bKk(G,da){return G&&da?G!==this.ZH.breadcrumbFolderName||da!==this.ZH.breadcrumbFolderUrl:!1}ZNc(G,da){G&&(G.NewName!==kb.a.kz(this.ZH.ov)||this.bKk(G.BreadcrumbFolderName,G.BreadcrumbFolderUrl))&&this.G_b(G,da)}YNc(){}xFg(){this.aXe(kb.a.kz(this.ZH.ov))}get Wp(){return this.$c.value}get aia(){return this.aTa.value}get pI(){return this.Y6c.value}static get instance(){return jj.Wa||
(jj.Wa=jj.bwa())}static bwa(){return new jj(Za.AFrameworkApplication.HKa,new Tj.a(()=>Za.AFrameworkApplication.jh),new Tj.a(()=>Za.AFrameworkApplication.pI),Za.AFrameworkApplication.Qt,Za.AFrameworkApplication.limitedEdit,()=>Za.AFrameworkApplication.userCanRename,Za.AFrameworkApplication.$Sc,Object(Jc.a)(zj.instance,zj.instance.g8,"updateTitle"),Bh(),()=>Za.AFrameworkApplication.isReadOnlyRecommended,Za.AFrameworkApplication.fa,Sf.a.instance.resolve("Common.IRenameProps"))}static gEh(G,da){G=kb.a.H$(G);
return da+G}static Ybk(G){const da=G.Values[Xa.a.Blj];wa.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",da);da?Za.AFrameworkApplication.jh.Xj(vb.a.nLc,2,G.Values):nb.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static Wbk(G){Za.AFrameworkApplication.jh.Xj(vb.a.renameFile,2,G.Values.NewName)}}jj.Wa=null;Object(ka.a)(jj,"RenameActor",null,[]);a(673);class Vj{}Object(ka.a)(Vj,"ActivityEventName",null,[]);class ki{}ki.compatMode=
"CompatMode";Object(ka.a)(ki,"ActivityEventReason",null,[]);class Wj{constructor(G,da){this.$c=G;this.h$a=da}ko(){this.$c.Hh(vb.a.Aqe,Fb.a.frame,Object(Jc.a)(this,this.jNk,"showRenameDialogAction"))}jNk(G,da,$a){G=32;if(1===$a)return Hb.SessionStatusManager.instance.Fkb||Za.AFrameworkApplication.Cga?8:32;2===$a&&(32!==this.$c.Gk(vb.a.renameFile,1)?(this.$c.Gk(vb.a.Xvb,2),G=8):32===this.$c.Gk(vb.a.W6b,1)?this.$c.Gk(vb.a.W6b,2):this.h$a.value.create().Rpe());return G}}Object(ka.a)(Wj,"RenameDialogActor",
null,[616]);var Kk=a(236);class Lj{constructor(G,da,$a){this.dialog=null;this.$c=G;this.ZH=da;this.Ucc=$a}ASi(){const G={};G.nameInputProps={["type"]:"AppInputProps",["id"]:Lj.iAd,["label"]:Object(Vf.a)("RenameDialogLabel"),["value"]:kb.a.kz(this.ZH.ov),["maxLength"]:this.Ucc};return G}Rpe(){const G={["id"]:"RenameDialog",["bodyControls"]:this.ASi()};this.dialog=new Kk.a(!1,!1,!0);this.dialog.Bh=1;this.dialog.Lk="RenameDialog";this.dialog.initializeAndShow(Object(Vf.a)("RenameDialogTitle"),Object(Jc.a)(this,
this.Alk,"renameDialogHandler"),G)}Alk(G,da){da&&1===G&&da[Lj.iAd]&&(G=kb.a.kz(this.ZH.ov),da=(da[Lj.iAd]||"").trim(),da!==G&&""!==da&&this.$c.Xj(vb.a.renameFile,2,da))}}Lj.iAd="txtDocumentName";Object(ka.a)(Lj,"RenameDialog",null,[621]);class qk{constructor(G){this.Fra=null;this.Ucc=0;this.$c=G;this._initialized=!1}initialize(G,da){this.Fra=G;this.Ucc=da;this._initialized=!0}create(){return this._initialized?new Lj(this.$c,this.Fra,this.Ucc):null}}Object(ka.a)(qk,"RenameDialogFactory",null,[615]);
var Pj=a(99);class pj{constructor(G,da){this.$c=G;this.Ei=da}ko(){this.$c.Hh(vb.a.W6b,Fb.a.frame,Object(Jc.a)(this,this.kNk,"showRenameFlyoutAction"))}NPh(){return Hh.d("setDocumentTitleFlyoutOpened")&&Za.AFrameworkApplication.ra.$d.jw}kNk(G,da,$a){if(1===$a)return this.NPh()?32:8;Za.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DocumentInlineRenameEnabled",!1)?appChrome.getHeaderApi().then(Sb=>{Sb.focusDocumentTitle()}):appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));
return 32}hwh(){pj.Voj&&Za.AFrameworkApplication.yKa&&Pj.TaskManager.instance.Ol(new Eb.a(5,1,5E3,()=>{32===this.$c.Gk(vb.a.W6b,1)&&this.Ei&&this.Ei.currentScope.name===$h.AFrame.G_&&(ld.a("RenameFloatieShownOnNewDocumentLoad",!0),this.$c.Gk(vb.a.W6b,2))}))}static get Voj(){pj.uec&&null!=pj.uec||(gb.a.dB("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),pj.uec=Za.AFrameworkApplication.fa?Za.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",
!1):!1);return pj.uec}}pj.uec=null;Object(ka.a)(pj,"RenameFlyoutActor",null,[614]);class ek{constructor(G,da,$a,Sb,Mc){this.Y6c=Mc;this.pMe=$a;this.oMe=Sb;this.srh=G;this.NBb=da}get pI(){return this.Y6c.value}UHf(){if(!this.oMe())return 5;if(this.NBb())return 1;if(this.pI){if(this.pMe&&!this.pI.pnf)return 3;if(!this.pMe&&!this.pI.bPb)return 4}return this.srh()?0:2}}Object(ka.a)(ek,"RenameProps",null,[613]);var bl=a(106);class Mj{constructor(G,da,$a,Sb,Mc,sd){this.YE=!1;this.Bcd=new bl.a;this.o$a=
da;this.rW=$a;this.dfh=Sb;this.Ga=Mc;this.GVe=sd}enable(){this.YE||(this.w1g(),this.Sre(),this.YE=!0)}generateKey(G,da,$a){return String.format("{0}/{1}/{2}",$a,G,da)}xMi(){const G=kb.a.kz(this.o$a().ov);return this.generateKey(this.o$a().breadcrumbFolderName,this.o$a().breadcrumbFolderUrl,G)}yMi(G,da,$a){return G&&da?this.generateKey(G,da,$a):$a}lbi(G,da,$a){return G&&G!==this.o$a().breadcrumbFolderName||da&&da!==this.o$a().breadcrumbFolderUrl?!0:$a!==kb.a.kz(this.o$a().ov)}w1g(){const G=this.xMi();
this.Bcd.ga(G,new Date)}N$d(G){this.lIk(G)&&this.nYe(G)}lIk(G){const da=this.dfh();return da?this.GVe&&this.GVe.JUb||!da.XVf||!Za.AFrameworkApplication.JXa?(this.dVg(G),this.YE=!1):!0:!1}Dng(G,da,$a,Sb){const Mc=this.lbi(G,da,$a),sd=this.yMi(G,da,$a);G=(()=>this.Bcd.gj(sd))().returnValue;Mc&&!G&&(this.fMf(Sb),wa.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.x0d));Mc||this.Bcd.ga(sd,this.rW())}}Object(ka.a)(Mj,"ARenamedFileChecker",null,[589]);class fk extends Mj{constructor(G,
da,$a,Sb,Mc,sd,Od,se){super(G,da,$a,Sb,Mc,sd);this.WMf=(Ye,hf)=>{hf&&hf.gZb&&hf.BJj&&(hf.dnb("BreadcrumbDocName")||hf.dnb("BreadcrumbFolderName")||hf.dnb("BreadcrumbFolderUrl")||hf.dnb("DirectInvokeDAVUrl")||hf.dnb("EditDocInClientUrl"))&&(wa.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.x0d),this.N$d(hf))};this.JSe=Mc;this.Inh=Od;this.Xih=se}get x0d(){return"RenamedFileCheckerUsingSettingsRefresh"}Sre(){this.JSe.Zmd(this.WMf)}dVg(){this.JSe.kCg(this.WMf)}nYe(G){if(G&&G.gZb){const da=
G.gZb;this.Dng(da.Xa("BreadcrumbFolderName"),da.Xa("BreadcrumbFolderUrl"),da.Xa("BreadcrumbDocName"),G)}}fMf(G){const da={OperationResult:0,classId:1};G=G.gZb;da.BreadcrumbFolderName=G.Xa("BreadcrumbFolderName");da.BreadcrumbFolderUrl=G.Xa("BreadcrumbFolderUrl");da.DirectInvokeDavUrl=G.Xa("DirectInvokeDAVUrl");da.EditDocInClientUrl=G.Xa("EditDocInClientUrl");G=G.Xa("BreadcrumbDocName");da.NewName=Za.AFrameworkApplication.jHa?G:kb.a.kz(G);this.Xih.execute($a=>{this.ydj(da,$a)})}ydj(G,da){this.Inh().G_b(G,
da)}}Object(ka.a)(fk,"RenamedFileCheckerUsingSettingsRefresh",Mj,[]);class Lk extends Mj{constructor(G,da,$a,Sb,Mc,sd,Od,se,Ye,hf){super(G,$a,Sb,Mc,sd,Ye);this.IDb=this.Qic=null;this.Rmh=da;this.$c=Od;this.$j=se;hf&&hf.execute(ag=>{this.Sfk(ag)})}get x0d(){return"RenamedFileCheckerUsingTask"}Sfk(G){this.Qic=G;this.Qic.m1e(Object(Jc.a)(this,this.pRb,"handleVisibilityChange"))}pRb(G,da){!this.YE||0!==da.newState&&1!==da.newState||this.IDb||(this.Sre(),this.N$d(this.IDb))}Sre(){this.IDb=new Eb.a(3,2,
this.Rmh(),Object(Jc.a)(this,this.N$d,"performRenameFileCheckTick"),89);this.$j.Ol(this.IDb)}dVg(G){this.$j.wx(G)}nYe(G){this.Qic&&2===this.Qic.bhl?this.Zgk(G):Za.AFrameworkApplication.JXa(Object(Jc.a)(this,this.ZNc,"onRefreshFilenameSuccess"),Object(Jc.a)(this,this.YNc,"onRefreshFilenameFailure"),!0)}Zgk(G){this.$j.wx(G);this.IDb=null}ZNc(G){G&&this.Dng(G.BreadcrumbFolderName,G.BreadcrumbFolderUrl,G.NewName,null)}fMf(){this.$c.Gk(vb.a.awc,2)}YNc(){}}Object(ka.a)(Lk,"RenamedFileCheckerUsingTask",
Mj,[]);class Xj{constructor(){this.Ga=this.Mh=null;this.CK=()=>{const G=Za.AFrameworkApplication.ra.$d.jw;Za.AFrameworkApplication.HKa()&&zj.instance.initialize(Za.AFrameworkApplication.$vc,G?null:Za.AFrameworkApplication.eXa,G?null:Za.AFrameworkApplication.Tge||Object(Vf.a)("RenameFileTooltip"))&&(this.Mh.register(ek,"Common.App.Rename.RenameProps").as("Common.IRenameProps").mi(()=>new ek(()=>Za.AFrameworkApplication.userCanRename,()=>Za.AFrameworkApplication.isReadOnlyRecommended,Za.AFrameworkApplication.$Sc,
Za.AFrameworkApplication.HKa,new Tj.a(()=>Za.AFrameworkApplication.pI))).hi(),jj.instance.ko(),this.Ga.la("RenameDialogIsEnabled")&&(Sf.a.instance.resolve("Common.App.Rename.RenameDialogFactory").initialize(Za.AFrameworkApplication.Qt,Za.AFrameworkApplication.$vc),Sf.a.instance.resolve("Common.App.Rename.IRenameDialogActor").ko()),Xk().ko(),Za.AFrameworkApplication.$Sc&&Bh().enable(),Xk().hwh())}}get name(){return"Common.App.RenameFile"}ao(G){this.Mh=G;this.Ga=Za.AFrameworkApplication.fa;this.Mh.register(Wj,
"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").mi(()=>new Wj(Za.AFrameworkApplication.jh,Sf.a.instance.R3b("Common.App.Rename.RenameDialogFactory"))).hi();this.Mh.register(qk,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").mi(()=>new qk(Za.AFrameworkApplication.jh)).hi();this.Mh.register(589,"Common.App.Rename.IRenamedFileChecker").mi(()=>this.r5h()).hi();this.Mh.register(pj,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").mi(()=>
new pj(Za.AFrameworkApplication.jh,Zh.FocusManager.instance())).hi()}r5h(){if(this.Ga.la("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const G=Object(Yk.b)();if(G&&G.BZf)return new fk(()=>G.vj("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>Za.AFrameworkApplication.Qt,()=>new Date,()=>Za.AFrameworkApplication.pI,G,Sf.a.instance.mo("Common.ISessionStatus"),()=>jj.instance,Object(Fk.a)())}return new Lk(()=>this.Ga.vj("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.Ga.vj("RenamedFileCheckerPingIntervalInMs",
12E4),()=>Za.AFrameworkApplication.Qt,()=>new Date,()=>Za.AFrameworkApplication.pI,Za.AFrameworkApplication.fa,Za.AFrameworkApplication.jh,Za.AFrameworkApplication.pp,Sf.a.instance.mo("Common.ISessionStatus"),Object(Hf.a)())}init(){this.Ga.ty(this.CK)}dispose(){}}Object(ka.a)(Xj,"PackageManager",null,[12,13]);var Nj=a(79),Mk=a(255);class rk extends Yf.a{constructor(G){super();this.EGa=this.renameFileManager=null;this.$=G;this.Bl()}create(){if(!this.EGa){const G=Mk.a.ogb(Tg.b(),this.xa,"Task","IRenameFileManager");
this.EGa=G.task;const da=Qc.id.Ha()?Object(Ze.d)(Wc.a.resolve(Qc.id,{va:this.hh})):Nj.GetServiceTaskFactory.create(this.$.ka,137,this.xa,this.hh),$a=Object(Ze.d)(Wc.a.resolve(Qc.ab,{va:this.hh}));lh.TaskExtensions.Ua(lh.TaskExtensions.Ln([$a,da],this.xa),()=>{const Sb=new hd(this.$,da.result);this.$.ka.ph(120,Sb);G.setResult(Sb)},this.xa,3)}this.EGa.continueWith(G=>{this.Yj(G.result)})}dispose(){Ia.a.Ng(this.renameFileManager);this.$=this.renameFileManager=null;super.dispose()}static Aa(G){G.ka.ph(119,
new rk(G))}}Object(ka.a)(rk,"RenameFileManagerServiceFactory",Yf.a,[]);var cl=a(1058);class dl extends Yf.a{constructor(){super();this.Bl()}create(){this.Yj(new cl.a)}}Object(ka.a)(dl,"CommonUIJsServiceFactory",Yf.a,[]);var sl=a(1170),el=a(1156);class Yj{}Object(ka.a)(Yj,"LokiTokenResult",null,[]);class gk{constructor(G){this.Efc=G}nKd(){const G=this.oNi();return G?gk.YUb?new Promise((da,$a)=>{this.Efc.continueWith(()=>{this.Efc.Sn||this.Efc.om?$a(Error.create("Error downloading auth library")):this.Efc.result.JD("Loki",
G).then(Sb=>{Sb=Za.AFrameworkApplication.fa.la("ForceLokiFallbackToACLPTokenIsEnabled")?this.rNi():Sb.IsSuccess&&Sb.Token?Object.assign(new Yj,{isSuccess:!0,token:Sb.Token,errorMessage:null}):Object.assign(new Yj,{isSuccess:!1,token:null,errorMessage:JSON.stringify(Sb)});da(Sb);return Sb})})}):Promise.resolve(Object.assign(new Yj,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new Yj,{isSuccess:!1,token:null,
errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",el.a.dBf())}))}rNi(){const G=Za.AFrameworkApplication.fa.Xa("LokiUserDataSignature")||"";return Object.assign(new Yj,{isSuccess:!0,token:G,errorMessage:null})}oNi(){let G=null;const da=el.a.Gxc();2===da?G=Za.AFrameworkApplication.fa.Xa("LokiAADAppId"):1===da&&(G=Za.AFrameworkApplication.fa.Xa("LokiMSAAppId"));return G}static get YUb(){return Za.AFrameworkApplication.fa.la("IsO365CommercialHost")||Za.AFrameworkApplication.fa.la("IsO365ConsumerHost")}}
Object(ka.a)(gk,"LokiTokenManager",null,[585]);var tl=a(599);class sk{get name(){return"Common.App.LivePersonaUtils"}init(){Object(sl.a)()}dispose(){}ao(G){G.register(gk,"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").hi().mi(()=>new gk(tl.a.hv(Object(aj.a)())))}static main(){Vc.a.instance.Lo(new sk)}}Object(ka.a)(sk,"LivePersonaUtilsPackage",null,[12,13]);const tk=()=>Sf.a.instance.Qi("Common.App.HostNotification.EditNotificationEventSource");class uk{constructor(G){this.Dsa=
this.vsa=this.kka=this.uda=null;this.q$c=this.nAb=this.m8c=this.r$c=this.tNe=this.qG=this.fT=!1;this.ggd=this.LNe=null;this.BNe=0;this.Ga=this.Mec=null;this.Wca=G;this.RE=3;this.FBb=this.hSa=!0}initialize(G,da,$a){this.uda=this.FLd(G,da);this.kka=Object(Vf.a)("SavingStatus");this.vsa=Object(Vf.a)("ReadOnlyStatus");this.Dsa=Object(Vf.a)("ReviewModeStatus");this.Wca&&this.Wca.execute(Sb=>{Sb.Umd(Object(Jc.a)(this,this.Q9b,"updateToSavingStatus"))});this.qG=!0;this.Ga=$a;this.m8c=this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIcons",
!1);this.nAb=this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIconsWithStrings",!1);return!0}Wqa(G,da){this.fT=G;this.RE=da;this.i2(this.hSa)}i2(G){!this.hSa&&G&&(this.Mec=new Date);this.hSa=G;this.q$c=!1;G=null;3===this.RE&&(G=this.hSa?this.uda:this.kka);this.nAb&&this.r$c&&(this.uda=Object(Vf.a)("SavedStatus"));this.zmf(G)}j1c(G){!this.FBb&&G&&(this.Mec=new Date);this.FBb=G;this.q$c=!1;G=null;3===this.RE&&(G=this.FBb?this.uda:this.kka);this.zmf(G)}FLd(G,da){return G?
String.format(Object(Vf.a)("SavedToStatus"),Object(Vf.a)("OneDriveName")):da&&da.length?String.format(Object(Vf.a)("SavedToStatus"),da):Object(Vf.a)("SavedStatus")}Q9b(){this.i2(!1)}ZFf(){switch(this.RE){case 1:return this.vsa;case 2:return this.Dsa;default:return null}}getMode(){if(3!==this.RE)switch(this.RE){case 1:return"ReadOnly";case 2:return"ReviewOnly";default:return null}return this.q$c?"FailedToSave":this.hSa&&this.FBb?"Saved":"Saving"}lhj(G){return this.tNe===this.fT&&this.BNe===this.RE&&
this.LNe===G}Pzd(G){appChrome.getHeaderApi().then(da=>{da.updateDocumentTitleStatus(this.fT,G,this.ZFf(),this.Mec,this.hSa&&this.FBb,this.m8c||this.nAb?da.getHeaderSaveStatusIconProps(this.getMode(),!1):null);"Saved"===this.getMode()&&this.nAb&&(this.Xgd&&(window.clearTimeout(this.Xgd),this.Xgd=null),this.STe&&(window.clearTimeout(this.STe),this.STe=null),this.Xgd=window.setTimeout(()=>{da.updateDocumentTitleStatus(this.fT,G,this.ZFf(),this.Mec,this.hSa,this.m8c||this.nAb?da.getHeaderSaveStatusIconProps(this.getMode(),
!0):null)},500));this.r$c=!0;return null});this.ggd=null}zmf(G){this.qG&&Hh.c()&&!this.lhj(G)&&(!this.r$c&&this.Ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.Pzd(G):Uj.a.G3b()?(this.ggd&&wa.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.ggd=window.requestIdleCallback(()=>{this.Pzd(G)})):window.requestAnimationFrame(()=>{this.Pzd(G)}),this.tNe=this.fT,this.LNe=G,this.BNe=this.RE)}}Object(ka.a)(uk,
"ReactSaveStatusUIHandler",null,[607]);class Nk{constructor(G,da){this.fw=null;this.uda=Object(Vf.a)("SavedStatus");this.kka=Object(Vf.a)("SavingStatus");this.vsa=Object(Vf.a)("ReadOnlyStatus");this.Dsa=Object(Vf.a)("ReviewModeStatus");this.Edc=da;this.Wca=G;this.RE=3;this.qEa=!0}wE(){this.Wca&&this.Wca.execute(G=>{G.Umd(Object(Jc.a)(this,this.Q9b,"updateToSavingStatus"))});this.Edc.execute(G=>{this.fw=G})}Wqa(G,da){this.RE=da;3===da?this.i2(this.qEa):2===da?this.Jve(this.Dsa):this.Jve(this.vsa)}Q9b(){this.i2(!1)}i2(G){this.qEa=
G;this.Jve(this.qEa?this.uda:this.kka)}Jve(G){this.fw&&this.fw.sendMessage(Jb.a.J0k,this.lYh(G))}lYh(G){const da={};da.StatusText=G;return da}}Object(ka.a)(Nk,"SaveStatusPostMessageHandler",null,[607]);var ul=a(130),fl=a(67);class vk{constructor(G,da,$a,Sb){this.Dsa=this.vsa=this.kka=this.uda=null;this.sSa=0;this.EN=this.Wgd=this.IQa=this.u5c=this.uTa=null;this.Pj=G;this.Oja=da;this.Wca=$a;this.tq=Sb;this.DLe=!0;this.fT=!1;this.RE=3;this.qEa=!0}initialize(G,da){if(!this.Pj)return!1;this.uda=this.FLd(G,
da);this.kka=Object(Vf.a)("SavingStatus");this.vsa=Object(Vf.a)("ReadOnlyStatus");this.Dsa=Object(Vf.a)("ReviewModeStatus");this.wE();return!0}FLd(G,da){return G?String.format(Object(Vf.a)("SavedToStatus"),Object(Vf.a)("OneDriveName")):da&&da.length?String.format(Object(Vf.a)("SavedToStatus"),da):Object(Vf.a)("SavedStatus")}wE(){this.Oja&&this.Oja.execute(G=>{G.Zzh(Object(Jc.a)(this,this.Jif,"createStatusAndModeElements"));G.Szh(Object(Jc.a)(this,this.TLk,"showHideSaveStatusElement"));G.bYk&&this.Jif(null,
null)});this.Wca&&this.Wca.execute(G=>{G.Umd(Object(Jc.a)(this,this.Q9b,"updateToSavingStatus"))})}ME(){this.EN&&this.Pj&&this.Pj.VP(this.EN)}TLk(G,da){this.Wqa("true"===da,this.RE)}Wqa(G,da){this.fT=G;this.RE=da;this.u5c&&(this.u5c.style.display=this.fT||3===this.RE||!this.uTa?"none":"");this.IQa&&(this.IQa.style.display=this.fT||3===this.RE?"none":"",this.IQa.innerText=1===this.RE?this.vsa:this.Dsa,this.IQa.title=1===this.RE?Object(Vf.a)("ReadOnlyStatusTooltip"):Object(Vf.a)("ReviewModeStatusTooltip"));
this.Wgd&&(this.Wgd.style.display=this.fT||1===this.RE||!this.uTa&&!this.IQa?"none":"");this.EN&&(this.EN.style.display=this.fT||1===this.RE?"none":"",this.i2(this.qEa),this.EN.title=Object(Vf.a)("SaveStatusTooltip"))}Jif(G,da){G=document.getElementById(Jj.a.wOf);da&&da.Wal||!G||""===this.uda||""===this.kka||""===this.vsa||""===this.Dsa||(this.uTa=document.getElementById(Jj.a.Zmc),this.u5c=Jj.a.yGa(G,"BreadcrumbAppModeDash","-",null,!1),this.IQa=Jj.a.yGa(G,"BreadcrumbAppModeStatus",1===this.RE?this.vsa:
this.Dsa,null,!1),this.j2g(this.IQa),this.Wgd=Jj.a.yGa(G,"BreadcrumbSaveStatusDash","-",null,!1),this.EN=Jj.a.yGa(G,"BreadcrumbSaveStatus",this.uda,null,!1),this.j2g(this.EN),this.Wqa(this.fT,this.RE))}Q9b(){this.i2(!1)}i2(G){this.qEa=G;this.w6k(this.qEa?this.uda:this.kka)}w6k(G){!this.EN||3!==this.RE&&2!==this.RE||(this.DLe&&!this.qEa?(this.sSa=this.EN.offsetWidth<this.sSa?this.sSa:this.EN.offsetWidth,this.S2k(this.kka),this.DLe=!1):this.EN.innerText=G)}j2g(G){G.style.direction=this.tq?"rtl":"ltr";
G.style.width="auto";G.style.textAlign=this.tq?"right":"left";G.style.display=this.fT?"none":"";G.setAttribute("Unselectable","on")}S2k(G){this.EN&&(this.EN.style.width="",this.EN.innerText=G,this.sSa=this.EN.offsetWidth<this.sSa?this.sSa:this.EN.offsetWidth,G=ul.a.vF(this.EN),this.EN.style.width=this.sSa-fl.a.OM(G.paddingLeft)-fl.a.OM(G.paddingRight)+1+"px")}}Object(ka.a)(vk,"SaveStatusUIHandler",null,[607]);var li=a(108);class Ok{constructor(){this.Ygd=this.Tfd=this.aTa=this.Mh=null;this.CK=()=>
{const G=Za.AFrameworkApplication.fa,da=!!Za.AFrameworkApplication.ra.$d&&4===Za.AFrameworkApplication.ra.$d.Om;if(G.la("WordEditorAutoSaveImprovementIsEnabled")||G.la("PptEditorSaveStatusInHeaderEnabled")||da&&G.la("SimplifiedReactRibbonUxIsEnabled")||G.la("ExcelSaveStatusInHeaderEnabled")||G.la("VisioSaveStatusInHeaderEnabled"))Za.AFrameworkApplication.fa.la("PostMessageEmbedded")&&Za.AFrameworkApplication.hideHeaderEmbedded?(this.Ygd=Sf.a.instance.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&
this.Ygd.wE():Za.AFrameworkApplication.ra.$d.T_f||Za.AFrameworkApplication.hideHeader||(Za.AFrameworkApplication.ra.$d.jw?(this.Tfd=Sf.a.instance.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.Tfd.initialize(G.la("IsSkyDrive"),G.Xa("HostNameToIncludeInSavedStatus"),Za.AFrameworkApplication.fa):(this.aTa=Sf.a.instance.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.aTa.initialize(G.la("IsSkyDrive"),G.Xa("HostNameToIncludeInSavedStatus")))}}get name(){return"Common.App.SaveStatus"}ao(G){this.Mh=
G;Za.AFrameworkApplication.fa.la("PostMessageEmbedded")&&Za.AFrameworkApplication.hideHeaderEmbedded?this.Mh.register(Nk,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").hi().mi(()=>new Nk(tk(),Object(Fk.a)())):Za.AFrameworkApplication.ra.$d.T_f||(Za.AFrameworkApplication.ra.$d.jw?this.Mh.register(uk,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").hi().mi(()=>new uk(tk())):this.Mh.register(vk,
"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").hi().mi(()=>new vk(li.EventHandlerManager.instance,Ik(),tk(),Za.AFrameworkApplication.isRtl)))}init(){Za.AFrameworkApplication.fa.ty(this.CK)}dispose(){this.aTa&&this.aTa.ME()}}Object(ka.a)(Ok,"PackageManager",null,[12,13]);class wk{constructor(G,da){this.RTe=this.Gad=!1;this.BMa=($a,Sb)=>{(null===Sb||void 0===Sb?0:Sb.fM)&&lb.a.DFh([Sb.fM])&&(this.v4b=!0)};this.Dt=()=>{this.v4b=!1};this.Oi=($a,Sb)=>{dg.b(Sb)&&
this.Wqa(!0);this.v4b=!1};this.xj=()=>{this.z0=this.$.z0;this.Wqa()};this.nmg=()=>{this.i2()};this.tlg=()=>{this.z0=this.$.z0};this.q6d=()=>{fc.f(this.$).za.Ix(this.q6d);this.z0=this.$.z0};this.aia=da;this.$=G;this.$.userOperationManager.px(this.tlg);this.$.nr(this.xj);this.$.ea.CAh(this.nmg);this.$.ea.uq(this.Oi);this.$.Dkc(this.BMa);this.$.ea.NN(this.Dt);this.Wqa()}get Psj(){return this.$.ea?this.$.ea.R2f:!1}get z0(){return this.Gad}set z0(G){G?this.Gad=!0:fc.f(this.$)&&fc.f(this.$).za&&(fc.f(this.$).za.H5()?
this.Gad=!1:fc.f(this.$).za.Uy(this.q6d));this.i2()}get v4b(){return this.RTe}set v4b(G){this.RTe=G;this.i2()}dispose(){this.$&&(this.$.Pr(this.xj),this.$.RSc(this.BMa),this.$.userOperationManager&&this.$.userOperationManager.Hv(this.tlg),this.$.ea&&(this.$.ea.Nkk(this.nmg),this.$.ea.pq(this.Oi),this.$.ea.wP(this.Dt)),fc.f(this.$)&&fc.f(this.$).za&&fc.f(this.$).za.Ix(this.q6d))}Wqa(G){G=!this.$.isEditMode||(void 0===G?!1:G);this.aia.Wqa(G,this.$.isEditMode?3:1);this.i2()}i2(){this.$.isEditMode&&this.aia.i2(!this.z0&&
!this.Psj&&!this.v4b)}}Object(ka.a)(wk,"SaveStatusManager",null,[2]);class yi extends Yf.a{constructor(G){super();this.Xi=G;this.Bl()}create(){const G=Sf.a.instance;G.Qi("Common.App.SaveStatus.ISaveStatusUIHandler").execute(da=>{const $a=new wk(this.Xi,da);G.register(wk,"Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager").hi().mi(()=>$a);da=Object(hg.a)(this.Xi.ka,300,()=>G.resolve("Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager"));this.Yj(da)})}static Aa(G){G.ka.ph(299,
new yi(G))}}Object(ka.a)(yi,"SaveStatusFactory",Yf.a,[]);var xk=a(1357),vl=a(586),wl=a(657),gl=a(482),yk=a(424),xl=a(1172);class Pk{$4h(G,da){if(G&&!(1>G.length)&&da){var $a=Object.assign(new yk.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.p2h(G,$a.ControlList);da.push($a)}}p2h(G,da){const $a=Object.assign(new wl.a,{ExternalId:"ContextCoauthors",LabelText:Object(Vf.a)("PresenceMenuSectionTitle"),Menu:Object.assign(new gl.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,
MenuSectionList:[]})});Array.add(da,$a);da=Object.assign(new yk.a,{Title:"",ControlList:[]});Array.add($a.Menu.MenuSectionList,da);this.E4h(G,da.ControlList)}E4h(G,da){for(let $a=0;$a<G.length;$a++){const Sb=Object.assign(new xl.a,{ExternalId:String.format("CoauthorPersona_{0}",$a),Command:"336231556",DisplayName:G[$a].userName,LabelText:G[$a].userName,ImageBackColor:G[$a].color,PersonaId:G[$a].email,IsAnonymous:G[$a].isAnonymous});Array.add(da,Sb)}}}Object(ka.a)(Pk,"PresenceContextMenuSectionBuilder",
null,[588]);var yl=a(1173),hl=a(650);class zk{constructor(G,da,$a,Sb){this.KEe=this.Mca=this.iq=this.sN=this.oja=null;this.pHh=()=>{this.Nhc.y6e()};this.YC=Mc=>{1===Mc?(hl.a.Eha(),this.showDialog(Object(Vf.a)("AuthenticationLostSigninInProgressMessage")),Za.AFrameworkApplication.jh.Gk(vb.a.h_d,2)):(this.S6a(),Za.AFrameworkApplication.jh.Gk(vb.a.L$e,2))};this.XMh=()=>{this.Kbi();Za.AFrameworkApplication.jh.Gk(vb.a.K$e,2)};this.Nhc=G;this.cph=Sb;this.Nhc.E_a&&(this.iq=new Eb.a(3,2,5E3,this.pHh,2),Za.AFrameworkApplication.pp.Ol(this.iq),
this.ko(da,$a));this.Nhc.XFb(()=>{this.Odg()});this.Nhc.Mcb(()=>{this.Pdg()})}get businessBar(){return this.Mca||(this.Mca=Object(yl.a)())}get N8e(){return this.KEe||(this.KEe=Sf.a.instance.mo("CommonUI.IBusinessBarEntryFactory"))}ko(G,da){const $a=Za.AFrameworkApplication.jh;$a.Vk(vb.a.authenticationLost,Fb.a.frame,G,96);$a.Vk(vb.a.z6e,Fb.a.frame,da,96);$a.Hh(vb.a.K$e,Fb.a.frame,Va.ActionManager.cAd);$a.Hh(vb.a.L$e,Fb.a.frame,Va.ActionManager.cAd);$a.Hh(vb.a.h_d,Fb.a.frame,Va.ActionManager.cAd)}Odg(){this.showDialog(Object(Vf.a)("AuthenticationLostMessage"));
Za.AFrameworkApplication.jh.Gk(vb.a.authenticationLost,2)}Pdg(){this.LUk();Za.AFrameworkApplication.jh.Gk(vb.a.z6e,2)}LUk(){this.sN&&(this.sN.hide(),this.sN.dispose(),this.sN=null);this.oja&&this.businessBar&&(Za.AFrameworkApplication.Il||this.businessBar.removeEntry(this.oja),this.oja.dispose(),this.oja=null)}showDialog(G){Ia.a.Ng(this.sN);this.sN=new Dj.a;this.cph||(this.sN.hC=!1,this.sN.Bh=0);this.sN.Yh(1,Object(Vf.a)("SignIn"));this.sN.QV(Object(Vf.a)("DefaultDialogTitle"),G,this.YC)}S6a(){this.businessBar&&
this.N8e&&(this.oja=this.N8e.create(Object(Vf.a)("AuthenticationLostTitle"),Object(Vf.a)("AuthenticationLostMessage"),null),this.oja.closeable=!0,this.oja.addButton(Object(Vf.a)("SignIn"),zk.UMh,""),this.oja.iX=this.XMh,this.businessBar.eF(this.oja,!1))}Kbi(){this.iq&&(Za.AFrameworkApplication.pp.wx(this.iq),this.iq=null)}dispose(){this.iq=this.sN=this.oja=null}static UMh(){hl.a.Eha();Za.AFrameworkApplication.jh.Gk(vb.a.h_d,2)}}Object(ka.a)(zk,"SignOutResponseUI",null,[2]);class Ej{get name(){return"Common.App.UI"}ao(G){G.register(Pk,
"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").hi()}init(){}dispose(){Ia.a.Ng(Ej.wda);Ej.wda=null}static main(){Vc.a.instance.Lo(new Ej)}}Ej.wda=null;Object(ka.a)(Ej,"CommonAppUIPackage",null,[12,13]);var Fj=a(186),il=a(706);class jl extends il.a{constructor(){super()}dispose(){Fj.WacAirSpace.fSd()&&Fj.WacAirSpace.B_c()}animate(G,da,$a,Sb,Mc){da&&Fj.WacAirSpace.hZ(G.element,da);Fj.WacAirSpace.animate(G,Sb,Mc);$a&&Fj.WacAirSpace.qgk(G.element,
$a)}}Object(ka.a)(jl,"AnimationManager",il.a,[2]);var Qk=a(120);class hk extends Yf.a{constructor(G){super();this.$=G;this.Bl()}create(){Za.AFrameworkApplication.fa.la("RefreshAccessTokenSilently")?this.Yj(this.e2h()):this.Yj(this.$.ka.Ug(38)||this.$.ka.ph(38,new He(this.$)))}e2h(){var G=this.$.ka.Ug(38);if(G)return G;G=new sb(Za.AFrameworkApplication.pp,Za.AFrameworkApplication.BI(),new nc);return this.$.ka.ph(38,new Td(this.$,G))}static Aa(G){G.ka.ph(39,new hk(G))}}Object(ka.a)(hk,"AccessTokenExpirationManagerFactory",
Yf.a,[]);var zl=a(1174),ik;(function(G){G[G.generalException=0]="generalException";G[G.invalidArgument=1]="invalidArgument";G[G.Qbg=2]="notAllowed";G[G.wlc=3]="apiNotAvailable";G[G.k2k=4]="unresolvedPendingRequest";G[G.timeout=5]="timeout";G[G.xld=6]="adalTimeout";G[G.$xe=7]="userNotSignedIn";G[G.$xb=8]="userAborted";G[G.$Sg=9]="silentSignInFailed";G[G.Alb=10]="invalidResourceUrl";G[G.FDc=11]="invalidGrant";G[G.Kef=12]="connectionLost";G[G.Yoc=13]="clientError";G[G.serverError=14]="serverError"})(ik||
(ik={}));Object(ka.b)("ErrorCodes",ik);a(1410);class jk{constructor(G,da){this.requestCallback=this.requestParameters=null;this.requestParameters=G;this.requestCallback=da}}Object(ka.a)(jk,"OutstandingRequest",null,[]);class mi{}mi.dHj="AADSTS50058";mi.Alb="AADSTS50001";mi.YGj="AADSTS65001";mi.rHj="AADSTS70011";mi.$xb="13002";mi.O4j="Popup Window is null";mi.N4j="Popup Window closed";mi.xld="Token renewal operation failed due to timeout";mi.EXk="tokenRevoked";Object(ka.a)(mi,"WopiHostErrorType",null,
[]);var Zj=a(596),kl=a(665),Kj=a(1409);class Aj{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(ka.a)(Aj,"WopiIdentityInfo",null,[350]);class kj{constructor(G,da,$a){this.expiration=this.authority=this.accessToken=null;this.accessToken=G;this.authority=da;this.expiration=$a}}Object(ka.a)(kj,"WopiIdentityToken",null,[348]);class kk{constructor(G){this._initialized=!1;this.lVj=da=>{let $a=null;try{const Mc=da.Values[Xa.a.zre],sd=da.Values[Xa.a.oQk],
Od=da.Values[Xa.a.aUg],se=da.Values[Xa.a.wQk];let Ye=null,hf=null;const ag=this.grb[Mc];if("undefined"!==typeof ag&&ag){var Sb=[];Array.add(Sb,Object.assign(new Dh.a,{name:Xa.a.yre,string:ag.requestParameters.correlationId}));Qf.a.sendTelemetryEvent(Object.assign(new Ld.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:Sb}));$a=ag.requestCallback;delete this.grb[Mc];"undefined"!==typeof sd&&sd&&sd.length?hf=new kj(sd,Od,se):Ye=ik[this.MBj(da)];Sb="getAccessToken_"+
Mc;Sb in this.dZc&&(this.dZc[Sb].stop(),delete this.dZc[Sb]);$a(hf,Ye)}else wa.ULS.sendTraceTag(37856066,344,10,qd.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:Mc}))}catch(Mc){da=da.Values[Xa.a.zre],da in this.grb&&delete this.grb[da],this.GJc(),wa.ULS.sendTraceTag(37856067,344,10,qd.c({["error"]:Mc.message,["stack"]:Mc.stack})),$a&&$a(null,"generalException")}};this.grb={};this.dZc={};this.mZ=Za.AFrameworkApplication.ra.cL;this.IPd=G}uXa(G){this._initialized||(G.Tq(Jb.a.usg),
G.Ip(Jb.a.usg,this.lVj),this._initialized=!0)}getAccessToken(G,da,$a){$a=void 0===$a?null:$a;this.UU(G,da);return new Promise((Sb,Mc)=>{if(this.eSd(da))if(da in this.grb)Mc("unresolvedPendingRequest");else{var sd=window.setTimeout(()=>{wa.ULS.sendTraceTag(37856032,344,10,qd.c({["error"]:"Request timeout.",["callerId"]:da}));Mc("timeout")},12E4);this.iHd(G,da,$a,(Od,se)=>{window.clearTimeout(sd);Od?Sb(Od):(wa.ULS.sendTraceTag(37856033,369,15,qd.c({["error"]:ik[se]})),Mc(se))})}else wa.ULS.sendTraceTag(37856034,
344,10,qd.c({["error"]:"Caller is not allowed."})),Mc("notAllowed")})}getPrimaryIdentityInfo(G){return new Promise((da,$a)=>{this.eSd(G)?this.hRi((Sb,Mc)=>{Sb?da(Sb):(wa.ULS.sendTraceTag(37856064,369,10,qd.c({["error"]:Mc.toString()})),$a(Mc))}):(wa.ULS.sendTraceTag(37856065,344,10,qd.c({["error"]:"Caller is not allowed."})),$a("notAllowed"))})}getAuthContext(G){return new Promise((da,$a)=>{const Sb=this.getAuthContextSync(G);Sb?da(Sb):$a("notAllowed")})}getAuthContextSync(G){if(this.eSd(G)){const da=
new Kj.a;da.upn=Za.AFrameworkApplication.fa.Xa("UserPrincipalName");da.userId=Za.AFrameworkApplication.fa.Xa("LoggableUserId");da.authority=Za.AFrameworkApplication.fa.Xa("HostAuthAuthority");da.tenantId=Za.AFrameworkApplication.fa.Xa("TenantId");da.isAnonymous=Za.AFrameworkApplication.fa.la("IsAnonymousUser");da.supportsAuthToken=this.A6i(G);G=Za.AFrameworkApplication.fa.Xa("HostAuthType");da.authorityType="aad"===G.toLowerCase()?2:"msa"===G.toLowerCase()?1:0;return da}wa.ULS.sendTraceTag(40751647,
344,10,qd.c({["error"]:"Caller is not allowed."}));return null}A6i(G){const da=Zj.a.cSb,$a=Za.AFrameworkApplication.fa.Xa(Za.AFrameworkApplication.vZ);return"teams"===(null===$a||void 0===$a?void 0:$a.toLowerCase())||wf.a.PKa?da&&Zj.a.eXg?Array.contains(Zj.a.eXg,G.toLowerCase()):!1:da}iHd(G,da,$a,Sb){var Mc=[];Array.add(Mc,Object.assign(new Dh.a,{name:"CallerId",string:da}));Array.add(Mc,Object.assign(new Dh.a,{name:Xa.a.yre,string:G.correlationId}));Qf.a.sendTelemetryEvent(Object.assign(new Ld.a,
{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:Mc}));Mc=kl.a.create().toString();const sd="getAccessToken_"+Mc,Od=this.mZ.vi("ComponentAttach",sd);this.dZc[sd]=Od;const se={};se[Xa.a.zre]=Mc;se[Xa.a.tQk]=G.resource;se[Xa.a.uQk]=G.scope;se[Xa.a.aUg]=Za.AFrameworkApplication.fa.Xa("HostAuthType");se[Xa.a.xQk]=Za.AFrameworkApplication.fa.Xa("UserPrincipalName");se[Xa.a.vQk]=G.silentLogin;se[Xa.a.qQk]=G.options;se[Xa.a.yre]=G.correlationId;se[Xa.a.rQk]=da;$a&&(se[Xa.a.addinName]=
$a.AddinName,se[Xa.a.pQk]=$a.AddinTrustId);this.IPd.execute(Ye=>{this.uXa(Ye);Ye.sendMessage(Jb.a.getAuthToken,se)});this.grb[Mc]=new jk(G,Sb)}hRi(G){const da=Za.AFrameworkApplication.fa.Xa("UserName"),$a=Za.AFrameworkApplication.fa.Xa("UserPrincipalName"),Sb=Za.AFrameworkApplication.fa.Xa("LoggableUserIdSpace"),Mc=new Aj;Mc.email=$a;Mc.displayName=da;switch(Sb){case "OrgIdPuid":Mc.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":Mc.authority="MicrosoftAccount";break;default:Mc.authority=
Sb}G(Mc,null)}eSd(G){var da=Za.AFrameworkApplication.lZi();G=G.toLowerCase();for(const $a of da)if(G===$a.toLowerCase())return!0;da=Zj.a.yod;for(const $a in da)if(G===da[$a].toLowerCase())return!0;return!1}MBj(G){G=G.Values[Xa.a.sQk];this.GJc();wa.ULS.sendTraceTag(39068821,344,50,qd.c({["error"]:G}));return G?-1<G.indexOf(mi.dHj)?9:-1<G.indexOf(mi.O4j)||-1<G.indexOf(mi.N4j)?12:-1<G.indexOf(mi.Alb)?10:-1<G.indexOf(mi.$xb)?8:-1<G.indexOf(mi.rHj)||-1<G.indexOf(mi.YGj)||G===mi.EXk?11:-1<G.indexOf(mi.xld)?
6:0:13}UU(G,da){G=this.idk(G.resource);wa.ULS.sendTraceTag(39921882,344,50,qd.c({["callerId"]:da,["resource"]:G}))}GJc(){wa.ULS.sendTraceTag(39068822,344,50,qd.c({["userAgent"]:window.navigator.userAgent}))}idk(G){return(G?G:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(ka.a)(kk,"WopiIdentityManager",null,[339]);class Rk{constructor(){this.Mh=null;this.CK=()=>{try{Sf.a.instance.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(G){wa.ULS.sendTraceTag(571074327,
383,10,"Failed to initialize WopiIdentityPackage with exception: "+G)}}}get name(){return"Common.App.WopiIdentity"}ao(G){this.Mh=G;G.register(kk,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").hi().mi(()=>new kk(Object(Fk.a)()))}init(){Za.AFrameworkApplication.fa&&Za.AFrameworkApplication.fa.ty(this.CK)}dispose(){}static main(){Vc.a.instance.Lo(new Rk)}}Object(ka.a)(Rk,"WopiIdentityPackage",null,[12,13]);const ll=()=>Sf.a.instance.resolve("Common.App.FloatPane.IFloatPaneActor");
class Sk{constructor(G,da,$a){this.kTa=null;this.J6b=()=>{this.kTa=null;wa.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.TIe.display()};this.BLk=(Sb,Mc,sd,Od,se)=>Sb!==vb.a.J6b?2:1===sd?32:2===sd&&se?(wa.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",se),se?this.Fzg():(this.kTa?(wa.ULS.sendTraceTag(23674914,207,50,"Hide float pane via removing show task!"),this.$j.wx(this.kTa)):(wa.ULS.sendTraceTag(23674915,
207,50,"Hide float pane immediately!"),this.TIe.remove(null)),this.kTa=null),32):8;this.$j=G;this.$c=da;this.TIe=$a.create()}Fzg(){this.kTa?wa.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(wa.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),this.kTa=new Eb.a(2,1,3E4,this.J6b,67),this.$j.Ol(this.kTa))}R4a(){this.$c.Hh(vb.a.J6b,Fb.a.frame,this.BLk)}}Object(ka.a)(Sk,"FloatPaneActor",null,[582]);var Tk=a(168);class lk{constructor(G,
da,$a,Sb,Mc){this.Qcd=this.oBb=this.Jgc=this.wsa=this.SZ=this.TE=this.h6c=this.AW=this.dDb=this.nCb=this.oCb=this.w9c=null;this.YSj=()=>{const sd=this.Ga.vj("O365AdPaneShowingDuration",60);this.Hqc();this.AW.style.display="block";this.AW.style.height=this.SZ.height+"px";this.oBb=new Eb.a(2,1,1E3*sd,Object(Jc.a)(this,this.hide,"hide"),67);this.$j.Ol(this.oBb);this.GAg()};this.XSj=()=>{wa.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");this.GAg();this.SZ=
null};this.Jlg=()=>{wa.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1};this.onClose=()=>{this.oBb&&this.$j.wx(this.oBb);this.hide();return!0};this.$j=da;this.Ga=G;this.gu=$a;this.Mh=Mc;this.mW=Sb}Hqc(){this.AW=document.createElement("div");this.AW.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeIn");this.AW.style.width=this.SZ.width+"px";(this.Qcd=this.lPi(this.mW))?(this.wsa=document.createElement("a"),this.wsa.setAttribute(ij.a.Oj,
ij.a.Yy),this.gu.ya(Ge.a.click,this.wsa,this.Jlg),this.wsa.href=this.Qcd,this.wsa.target="_blank",this.wsa.appendChild(this.SZ),this.AW.appendChild(this.wsa)):this.AW.appendChild(this.SZ);this.TE=document.createElement("a");this.TE.setAttribute(ij.a.Oj,ij.a.fF);this.TE.className="StandardButton WACFloatPaneCloseButton";this.TE.title=Object(Vf.a)("Close");this.TE.tabIndex=-1;this.h6c=Tk.a(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",!0,null);this.h6c.setAttribute(ij.a.Oj,
ij.a.Yy);this.TE.appendChild(this.h6c);this.gu.ya(Ge.a.click,this.TE,this.onClose);this.AW.appendChild(this.TE);this.dDb.appendChild(this.AW)}ELi(G){const da=this.Ga.la("O365PromotionHasStarted");switch(G){case 2:return cj.a.kGa(String.format("adppt{0}.png",da?"sale":""));case 1:return cj.a.kGa(String.format("adxls{0}.png",da?"sale":""));case 3:return cj.a.kGa(String.format("addoc{0}.png",da?"sale":""))}return null}lPi(G){const da=this.Ga.Xa("O365AdPaneRedirectedURL");switch(G){case 1:return String.format(da,
"Excel");case 2:return String.format(da,"PowerPoint");case 3:return String.format(da,"Word")}return null}hide(G){this.oBb=null;this.AW&&!this.Jgc&&((void 0===G?0:G)?wa.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):wa.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),this.AW.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.AW.style.height="0px",this.Jgc=new Eb.a(2,1,1E3,Object(Jc.a)(this,this.remove,"remove"),67),
this.$j.Ol(this.Jgc))}remove(){this.AW&&this.dDb&&(this.wsa&&this.gu.Na(Ge.a.click,this.wsa,this.Jlg),this.gu.Na(Ge.a.click,this.TE,this.onClose),this.dDb.removeChild(this.AW),this.AW=null);this.Jgc=null}display(){if(this.w9c=Sf.a.instance.mo("Common.IFloatPaneContainer"))if(this.dDb=this.w9c.container){var G=this.ELi(this.mW);G?(wa.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",G),this.SZ=document.createElement("img"),this.SZ.className="WACFloatPaneImage",this.oCb=this.YSj,
sf.a.addHandler(this.SZ,Ge.a.load,this.oCb),this.nCb=this.XSj,sf.a.addHandler(this.SZ,Ge.a.error,this.nCb),this.SZ.src=G):wa.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else wa.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else wa.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}GAg(){this.oCb&&this.SZ&&sf.a.removeHandler(this.SZ,Ge.a.load,this.oCb);
this.oCb=null;this.nCb&&this.SZ&&sf.a.removeHandler(this.SZ,Ge.a.error,this.nCb);this.nCb=null}dispose(){this.hide()}}Object(ka.a)(lk,"FloatPane",null,[603]);class Ak{constructor(G,da,$a,Sb,Mc){this.$j=da;this.Ga=G;this.gu=$a;this.Mh=Mc;this.mW=Sb}create(){return new lk(this.Ga,this.$j,this.gu,this.mW,this.Mh)}}Object(ka.a)(Ak,"FloatPaneFactory",null,[581]);class Bk{constructor(){this.Mh=null}get name(){return"Common.App.FloatPane"}get gWf(){return Za.AFrameworkApplication.fa.la("O365AdvertisementIsEnabled")&&
Za.AFrameworkApplication.fa.la("IsShowAdvertisementPaneEnabled")}init(){this.gWf&&(wa.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),ll().Fzg(),wa.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),ll().R4a())}ao(G){this.Mh=G;this.gWf&&(this.Mh.register(Ak,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").mi(()=>new Ak(Za.AFrameworkApplication.fa,Za.AFrameworkApplication.pp,cb.a.instance,Za.AFrameworkApplication.ra.$d.Om,
this.Mh)).hi(),this.Mh.register(Sk,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").mi(()=>new Sk(Za.AFrameworkApplication.pp,Za.AFrameworkApplication.jh,Sf.a.instance.resolve("Common.App.FloatPane.IFloatPaneFactory"))).hi())}dispose(){}static main(){Vc.a.instance.Lo(new Bk)}}Object(ka.a)(Bk,"FloatPanePackage",null,[12,13]);var ml=a(1011);class Uk{constructor(G,da){this.GAb=null;this.a4k=($a,Sb,Mc,sd,Od)=>{if(1===Mc)return 32;Od[ml.a.Value]=this.GAb;Od[th.a.so]=this.GAb;
Od[ml.a.Visible]=!0;return 32};this.$c=G;this.Ga=da}ko(){(this.GAb=this.Ga.Xa("StatusBarEnvironmentNameToUse"))&&""!==this.GAb&&this.$c.Vk(vb.a.svg,Fb.a.frame,this.a4k,96)}}Object(ka.a)(Uk,"DisplayEnvironmentName",null,[]);class Fi{constructor(){this.Mh=null}get name(){return"Common.App.DisplayEnvironmentName"}ao(G){this.Mh=G;this.Mh.register(Uk,"Common.App.DisplayEnvironmentName.DisplayEnvironmentName").hi().mi(()=>new Uk(Za.AFrameworkApplication.jh,Za.AFrameworkApplication.fa))}init(){Sf.a.instance.resolve("Common.App.DisplayEnvironmentName.DisplayEnvironmentName").ko()}dispose(){}static main(){Vc.a.instance.Lo(new Fi)}}
Object(ka.a)(Fi,"DisplayEnvironmentNamePackage",null,[12,13]);var nl=a(229),mk=a(176);class Ck extends nl.a{constructor(G){super();this.WI=()=>{this.k_a()};this.xY=()=>{this.k_a()};this.$=G}dispose(){this.$&&mk.a(this.$)&&(mk.a(this.$).q5a(this.xY),this.$.ea.GH(this.WI));this.$=null;super.dispose()}Xdi(){Za.AFrameworkApplication.HKa()&&!this.k_a()&&(mk.a(this.$).hFa(this.xY),this.$.ea.JJ(this.WI))}k_a(){return this.$.isEditMode&&(Za.AFrameworkApplication.eXa||Eg.a.Al.jw)?(mk.a(this.$).q5a(this.xY),
lh.TaskExtensions.Ua(Nj.GetServiceTaskFactory.create(this.$.ka,119,this.xa,1),G=>{G.result.initialize()},this.xa,3),!0):!1}static main(){Qg.a.Qg(G=>{Qc.df.Ha()||(new Ck(G)).Xdi()})}}Object(ka.a)(Ck,"FileOpSliceDownloaderBootStraper",nl.a,[]);var Qj=a(95),ol=a(524);class Vk{constructor(G){this.X4=null;this.M6f=new Set;this.W_f=!1;this.Oaa=(da,$a)=>{if(!this.M6f.has(da)){var Sb=[];if($a){const Mc=fc.f(this.$).Yg.sl($a,!1);if(!Mc){1!==$a.top||1!==$a.left||this.W_f||(Sb.push(id.a.Rl("IsTableOnA1","false",
1)),ld.a("MsFormsTableUsage",void 0,void 0,Sb),this.W_f=!0);return}if(1!==Mc.usedRange.top||1!==Mc.usedRange.left)return}$a=Tg.b().kp(da);Sb.push(id.a.Rl("Command",$a,2));ld.a("MsFormsTableUsage",void 0,void 0,Sb);this.M6f.add(da)}};this.$we=(da,$a)=>{if(!this.$.ea.sn.get(61)||Qj.j(this.$.Bk))Qj.j(this.$.Bk)&&$a&&$a.item.name===this.X4.lU&&this.K6e();else if(this.$.sa.yq(this.X4.EOb)){const Sb={};Sb.SheetName=this.X4.EOb;Sb.NamedObjectName=this.X4.EOb;Sb.FirstColumn=0;Sb.FirstRow=0;Sb.LastColumn=
0;Sb.LastRow=2;const Mc=Od=>{if(!Qj.j(this.$.Bk)){if(null===Od||void 0===Od?0:Od.Result)this.$.workbookContext.MsFormId=Od.Result[0][0],this.X4.lU=Od.Result[1][0],Od=Od.Result[2][0],this.JV(!!this.$.workbookContext.MsFormId&&this.Kqj(Od),1024),this.K6e();Qj.c(this.$.Bk)&&($a?wa.ULS.sendTraceTag(537155357,0,50,`Created MsForm successfully, Form Id:${kb.a.jF(this.$.workbookContext.MsFormId).toString()}`):wa.ULS.sendTraceTag(537155356,0,50,`Reopening workbook that is connected to MsForm, Form Id:${kb.a.jF(this.$.workbookContext.MsFormId).toString()}`));
Qj.c(this.$.Bk)&&!$a&&wa.ULS.sendTraceTag(537155355,0,50,`reopening workbook that is connected to MsForm, Form Id:${kb.a.jF(this.$.workbookContext.MsFormId).toString()}`);!Qj.c(this.$.Bk)&&$a||this.JV(!0,2048)}},sd=this.$.pa.ta.Jh();this.$.userOperationManager.vO(new Sa.a(159,0,(Od,se,Ye)=>ec.s(this.$.pa.Z0,Sb,!1,Ac.c(Od,Mc),se,Ye,null,sd),16))}else $a||this.JV(!0,2048)};this.yTj=(da,$a)=>{$a&&$a.item.name===this.X4.EOb&&(this.JV(!1,1024),this.JV(!0,2048))};this.$=G}T_k(){this.X4=ol.a.current;this.$we(null,
null);this.$.sa.tta(this.$we);this.$.sa.u3(this.yTj)}dispose(){this.$.sa.Yza(this.$we)}Kqj(G){if(!G)return!0;const da=RegExp("-","g"),$a=this.$.workbookContext.MsFormDocUrl.toLowerCase();return $a.includes(G.toLowerCase())||$a.includes(G.toLowerCase().replace(da,""))?!0:!1}K6e(){Qj.c(this.$.Bk)&&this.X4.lU&&this.$.sa.na&&this.$.sa.na.name!==this.X4.lU&&this.$.sa.yq(this.X4.lU)&&this.$.sa.getItemByName(this.X4.lU).activate({scenario:"msForm"})}JV(G,da){this.$.workbookContext.Options=Hg.HelperMethods.jZ(G,
this.$.workbookContext.Options,da)}}Object(ka.a)(Vk,"MsFormInfoUpdatingService",null,[579,2]);class lj extends Yf.a{constructor(G){super();this.msFormInfoUpdatingService=null;this.$=G;this.Bl()}create(){this.Yj(Object(hg.a)(this.$.ka,237,()=>this.msFormInfoUpdatingService||(this.msFormInfoUpdatingService=new Vk(this.$))));this.msFormInfoUpdatingService.T_k()}static Aa(G){G.ka.ph(236,new lj(G))}}Object(ka.a)(lj,"MsFormInfoUpdatingServiceFactory",Yf.a,[]);var pl=a(1411),Wk=a(1060);class Gj{}Gj.QVk=
864E5;Gj.tBh=3;Gj.CJj=144E5;Object(ka.a)(Gj,"AddinConstantsNum",null,[]);var qj=a(908),ql=a(1012),Rj=a(980);class vg{constructor(G,da,$a,Sb){this.fa=(Sb=void 0===Sb?null:Sb)?Sb:Za.AFrameworkApplication.fa;this.kad=2;this.g_a=G;this.qrh=da;this.qh=$a}get cxa(){return this.kad}get j8k(){return this.qrh}cje(G){if(this.fa.la("AgaveSupportsLiveIdSpoofing")){var da=(new Date).getTime();this.g_a(G,this.cxa,{["ak0"]:da})}else if(Rj.a.KIk(G)){da=String.format(Za.AFrameworkApplication.ra.$d.Y0+"AddinServiceHandler.ashx?action={0}&app={1}&lc={2}&{3}",
"laststoreupdate",Za.AFrameworkApplication.ra.$d.Om,this.j8k,Za.AFrameworkApplication.qo);const $a=Za.AFrameworkApplication.$i;let Sb=null;this.qh&&(Sb=this.qh.vi("ComponentAttach",ql.a[G]+Wk.a[this.cxa]));$a.Ou(da,1,null,null,!0,4,Mc=>{this.ZYj(G,Mc.data.responseData);Sb&&Sb.stop()},Mc=>{wa.ULS.sendTraceTag(17438153,220,50,"GetLastUpdate request failed with {0}.",Mc.data.httpStatus);this.Iqb(G,1,"request failed");Sb&&Sb.stop()},null)}else Rj.a.lNf(G)?(da=Rj.a.CAf(G),this.g_a(G,this.cxa,{["ak0"]:da})):
this.fa.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&(this.kM?this.Iqb(G,1,"no local timestamp"):this.g_a(G,this.cxa,null))}ZYj(G,da){if(da&&""!==da)if(da=Sys.Net.XMLDOM(da)){Rj.a.IPa(qj.a.Q1e,((new Date).getTime()+Gj.CJj).toString(),G);let $a=da.getElementsByTagName("update");$a&&$a.length||($a=da.getElementsByTagName("o:update"));$a&&0<$a.length?(da=Date.parse($a[0].firstChild.nodeValue),Rj.a.CAf(G)<da||Rj.a.lNf(G)?this.g_a(G,this.cxa,{["ak0"]:da}):this.Iqb(G,1,"outdate timestamp in reponse")):
this.Iqb(G,2,"no timestamp in response")}else this.Iqb(G,1,"response data is invalid");else this.Iqb(G,1,"no responseData")}Iqb(G,da,$a){this.kM&&this.g_a(G,this.cxa,{["AddinServiceUserState"]:da,["DiagnosticInfo"]:$a})}get kM(){return this.fa.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&this.fa.isChangeGateEnabled("OfficeVSO:8335739_FlyoutInitializerFixEnabled")}}Object(ka.a)(vg,"AddinCommandsAnonymousAPIInitializer",null,[628]);class Sj{constructor(G,da,$a){this.kad=
$a;this.g_a=G;this.oo=da}get cxa(){return this.kad}cje(G){let da=null;this.oo&&(da=this.oo.vi("ComponentAttach",ql.a[G]+Wk.a[this.cxa]));if(null==this.rpe(G)?0:this.rpe(G)){const $a=(new Date).getTime()-Gj.tBh*Gj.QVk;this.g_a(G,this.cxa,{["ak0"]:$a})}da&&da.stop()}}Object(ka.a)(Sj,"AddinCommandsInitializerBase",null,[628]);class Dk extends Sj{constructor(G,da){super(G,da,5)}rpe(){return!0}}Object(ka.a)(Dk,"AddinCommandsInitializer",Sj,[]);class H extends Sj{constructor(G,da){super(G,da,1)}rpe(G){try{const da=
qj.a.PDf()+G;return Boolean.parse(this.cEi(da)||"false")}catch(da){wa.ULS.sendTraceTag(17306844,220,50,"LocalStorage is not allowed, {0}.",da.toString())}return null}cEi(G){const da=localStorage;return void 0!==da&&null!==da?da.getItem(G):null}}Object(ka.a)(H,"AddinCommandsLocalCacheInitializer",Sj,[]);var va=a(646);class ub{constructor(G,da){da=void 0===da?null:da;this.qh=G;this.fa=da?da:Za.AFrameworkApplication.fa}get appUILocale(){return va.a.qU(Za.AFrameworkApplication.lcid).name}c$i(){const G=
this.FHd();if(G)if(this.fa.la("OcpsIsEnabled"))Object(kh.a)().execute(da=>{da.isFeatureEnabled("ConnectedServices",!0).then($a=>{for(const Sb of G){if(!$a&&0===Sb.key){this.kM&&this.KZg(0,Sb.value,{["AddinServiceUserState"]:3,["DiagnosticInfo"]:"connected services is off"});continue}const Mc=this.Zzf(Sb.value);Mc&&Mc.cje(Sb.key)}return null})});else for(const da of G){const $a=this.Zzf(da.value);$a&&$a.cje(da.key)}}dje(G,da,$a){$a&&$a[qj.a.jUa]?($a[qj.a.w9]=G,$a[qj.a.v3]=da,this.Xbe(vb.a.Mpa,$a),
Rj.a.IPa(qj.a.jUa,$a[qj.a.jUa].toString(),G)):this.kM?this.KZg(G,da,$a):this.fa.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&0===G&&($a={},$a[qj.a.w9]=G,$a[qj.a.v3]=da,this.Xbe(vb.a.YF,$a))}Zzf(G){let da=null;switch(G){case 1:da=new H(Object(Jc.a)(this,this.dje,"retrieveAddinFlagCompleted"),this.qh);break;case 2:da=new vg(Object(Jc.a)(this,this.dje,"retrieveAddinFlagCompleted"),this.appUILocale,this.qh,this.fa);break;case 5:da=new Dk(Object(Jc.a)(this,this.dje,"retrieveAddinFlagCompleted"),
this.qh)}return da}KZg(G,da,$a){0===G&&$a&&$a[qj.a.Zkc]&&($a[qj.a.w9]=G,$a[qj.a.v3]=da,wa.ULS.sendTraceTag(508829835,220,50,"AddinServiceUserState: {0}, addinCommandsInitFlagInfo: {1}",$a[qj.a.Zkc].toString(),JSON.stringify($a)),this.Xbe(vb.a.YF,$a))}get kM(){return this.fa.isChangeGateEnabled("OfficeVSO:8332926_AddinDetailsServiceSupportEnabled")&&this.fa.isChangeGateEnabled("OfficeVSO:8335739_FlyoutInitializerFixEnabled")}}Object(ka.a)(ub,"AddinCommandsInitializerHost",null,[]);var kc=a(956),Oc=
a(288),pd=a(388);let Sd;class Wd extends Dj.a{constructor(G,da){super();this.tFe=Za.AFrameworkApplication.fa.la("IsNewStringEnabled")?CommonUiStrings.AppsforOfficeDeveloperModeCheckboxLabel:CommonUIStrings.l_AppsforOfficeDeveloperModeCheckboxLabel;this.lIe=Za.AFrameworkApplication.fa.la("IsNewStringEnabled")?CommonUiStrings.AppsforOfficeDeveloperModeHelpUrlText:CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrlText;this.mIe=Za.AFrameworkApplication.fa.la("IsNewStringEnabled")?CommonUiStrings.AppsforOfficeDeveloperModeHelpUrl:
CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrl;this.ZCb=!1;this.GHb=()=>{this.hide();this.ZCb&&B(this.Uca)};this.DLj=()=>{kc.a.instance.getItem("optedIntoAddinDeveloperMode")?(kc.a.instance.removeItem("optedIntoAddinDeveloperMode"),this.ZCb=!1):(kc.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.ZCb=!0)};this.Uca=G;Sd=da}showDialog(G,da){try{this.Lk=void 0===this.Lk||null===this.Lk?Oc.a.V1b(pd.a.Gca).toString():this.Lk,this.show({["type"]:"StandardDialogProps",["id"]:this.Lk,["dialogIcon"]:3,
["headerText"]:G,["titleText"]:da,["resultHandler"]:this.GHb,["messageAreaLink"]:this.o5h(),["permanentDismissCheckbox"]:this.k5h(),["renderMicrosoftLogoInHeader"]:!1})}catch($a){this.I3c(G,da)}}o5h(){return{["type"]:"AppLinkProps",["id"]:"WACDialogExtraLink",["text"]:this.lIe,["handler"]:{["href"]:this.mIe,["target"]:"_blank"},["onExecute"]:null}}k5h(){return{["type"]:"AppCheckboxProps",["id"]:"WACDialogOptInCheckbox",["label"]:this.tFe,["onExecute"]:this.DLj}}I3c(G,da){const $a=new Kk.a(!1,!1,!1);
$a.Bh=1;$a.Lk=Oc.a.V1b(pd.a.Gca).toString();$a.Po=String.format(this.g5(),da,this.mIe,this.lIe,this.tFe);$a.initializeAndShow(G,this.cah,{optInCheckbox:!1})}cah(G,da){1==G&&da.optInCheckbox&&(kc.a.instance.getItem("optedIntoAddinDeveloperMode")?(kc.a.instance.removeItem("optedIntoAddinDeveloperMode"),this.ZCb=!1):(kc.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.ZCb=!0,B(this.Uca)))}g5(){return"<div style='height:100px;width:400px;border:none;'><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>"}}
Object(ka.a)(Wd,"AppsForOfficeDeveloperModeOptInDialog",Dj.a,[]);var ee=a(427);class je extends ub{constructor(G){super(G.qh);this.Uca=this.iAb=null;this.MDa=new Ce.a;this.Aee=da=>{1===da&&this.Uca&&this.nzg()};this.$=G;pl.a.aSb=pl.a.Quf}get appUILocale(){return this.$.ua.UICultureTag}E_g(){this.c$i();this.k0k()}FHd(){const G=new ee.a;this.$.ea.sn.get(27)&&(G.ga(0,2),""!==Za.AFrameworkApplication.fa.Xa("HostInstallAddIns")&&G.ga(16,5));this.$.ea.sn.get(33)&&G.ga(1,1);xb.EwaSettings.Ra(52)&&G.ga(8,
1);this.$.Tj.get(35)&&G.ga(10,5);return G}Xbe(G,da){this.Shi(()=>{const $a=new Tc.a(G,0,this.$.Rh,0,null);this.$.Ma.dh($a,da)})}Shi(G){(da=>{da=this.$.ka.Ug(da);return!!da&&hb.d(da)})(198)?this.$.ka.Lh(198,da=>{G(da)}):G(null)}k0k(){this.Uca=Za.AFrameworkApplication.fa.Xa("DevAddinManifestFileUrl");this.iAb=Za.AFrameworkApplication.fa.Xa("DevAddinManifestGuid");var G=Za.AFrameworkApplication.fa.Xa("IsDevAddinTest");if(this.Uca&&this.iAb&&G){G="true"===G;var da=this.MDa.getItem("optedIntoAddinDeveloperMode");
const $a=this.MDa.getItem(this.iAb);da||G&&Za.AFrameworkApplication.fa.la("SuppressDeveloperAddinDialogs")?!Za.AFrameworkApplication.disableWholeAppsForOfficeFeature&&($a||G&&Za.AFrameworkApplication.fa.la("SuppressDeveloperAddinDialogs"))?this.nzg():(G=new Dj.a,G.Bh=4,Za.AFrameworkApplication.fa.la("IsNewStringEnabled")?(da=CommonUiStrings.AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUiStrings.AppsForOfficeDeveloperManifestUrl,this.Uca)+CommonUiStrings.AppsforOfficeLoadManifestUrl,
G.QV(CommonUiStrings.AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,da,this.Aee)):(da=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,this.Uca)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl,G.QV(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,da,this.Aee))):(G=new Wd(this.Uca,this.Aee),G.Bh=0,Za.AFrameworkApplication.fa.la("IsNewStringEnabled")?G.showDialog(CommonUiStrings.AppsforOfficeNotOptedIntoAddinDeveloperModeTitle,
CommonUiStrings.AppsforOfficeNotOptedIntoAddinDeveloperModeMessage):G.showDialog(CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeTitle,CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeMessage))}}nzg(){if(Qc.vb.Ha())void Wc.a.resolve(Qc.vb,{va:1}).then(G=>{G.wl.validateAndCacheNewDevAddinManifest(this.Uca);this.MDa.setItem(this.iAb,"true")});else{const G=Nj.GetServiceTaskFactory.create(this.$.ka,106,this.$.xa,1);lh.TaskExtensions.Ua(G,()=>{G.result.wl.validateAndCacheNewDevAddinManifest(this.Uca);
this.MDa.setItem(this.iAb,"true")},this.$.xa,3)}}}Object(ka.a)(je,"AddinCommandsInitService",ub,[580]);class Ue extends Yf.a{constructor(G){super();this.addinCommandsInitService=null;this.Oi=()=>{wa.ULS.sendTraceTag(537170701,0,50,`AddinCommandsInitServiceFactory.OnSessionIdChanged: isSessionActive ${this.$.ea.Ph}, isEditMode ${this.$.isEditMode} , showCommandUI [${!!(this.$.wj&16384)}] `);this.addinCommandsInitService.E_g();this.$.ea.pq(this.Oi)};this.$=G;this.Bl()}create(){this.$.ka.Lh(53,()=>{this.Yj(Object(hg.a)(this.$.ka,
202,()=>this.addinCommandsInitService||(this.addinCommandsInitService=new je(this.$))));this.$.ea.Ph?(wa.ULS.sendTraceTag(537170702,0,50,`AddinCommandsInitServiceFactory.Create: calling TryInitializeAddinCommands, isEditMode: [${this.$.isEditMode}], showCommandUI [${!!(this.$.wj&16384)}] `),this.addinCommandsInitService.E_g()):this.$.ea.uq(this.Oi)})}static Aa(G){G.ka.ph(201,new Ue(G))}}Object(ka.a)(Ue,"AddinCommandsInitServiceFactory",Yf.a,[]);Type.registerNamespace("Common.App.InProductMessaging");
zf.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");ah.main();(()=>{Qg.a.Qg(()=>{Qg.a.Qg(G=>{Qc.jc.Ha()||Uh.Aa(G)})})})();(()=>{Qg.a.Qg(()=>{Qc.pd.Ha()||Qg.a.Qg(qg.Aa)})})();Qg.a.Qg(ci.Aa);(()=>{Qg.a.Qg(G=>{nk.Aa(G)})})();(()=>{Qg.a.Qg(G=>{Fd.a.ut()||bk.Aa(G)})})();Type.registerNamespace("Common.App.Rename");Vc.a.instance.Lo(new Xj,7);(()=>{Qg.a.Qg(G=>{Qc.df.Ha()||rk.Aa(G)})})();xb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveRequireFromSlices",!1)||a(629);
(()=>{Qg.a.Qg(G=>{G.ka.ph(203,new dl)})})();Type.registerNamespace("Common.App.LivePersonaUtils");sk.main();Type.registerNamespace("Common.App.SaveStatus");Vc.a.instance.Lo(new Ok);(()=>{Qg.a.Qg(G=>{Qc.Gb.Ha()||Object(xk.a)();yi.Aa(G)})})();vl.a.gw('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}');
Type.registerNamespace("CAUI");Ej.main();Qk.a.Ax.ph(141,new jl);xb.EwaSettings.isChangeGateEnabled("OfficeVSO:8719582_RemoveVarsFromSlices")||a(1408);(()=>{Qg.a.Qg(G=>{Qc.a.Ha()||hk.Aa(G)})})();Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=zl.a;Type.registerNamespace("Common.App.WopiIdentity");Rk.main();Type.registerNamespace("Common.App.FloatPane");Bk.main();Type.registerNamespace("Common.App.DisplayEnvironmentName");Fi.main();
Ck.main();Qg.a.Qg(lj.Aa);Qg.a.Qg(Ue.Aa);String(z);String(C);String(D);String(J);String(oe);String(Kd);String(W);String(N);String(vd);String(M);String(Re);String(Q);String(R);String(O);String(U);String(K);String(F);String(I);String(P);String(Y);String(ea);String(Ba);String(Fa);String(Ve);String(za);String(xa);String(fa);String(V);String(ba);String(la);String(Ta);String(Ea);String(sa);String(Ya);String(bb);String(ra);String(Da);String(oa);String(Ha);window.___1708742503481_closurehack=z;window.___1708742503481_closurehack=
C;window.___1708742503481_closurehack=D;window.___1708742503481_closurehack=J;window.___1708742503481_closurehack=oe;window.___1708742503481_closurehack=Kd;window.___1708742503481_closurehack=W;window.___1708742503481_closurehack=N;window.___1708742503481_closurehack=vd;window.___1708742503481_closurehack=M;window.___1708742503481_closurehack=Re;window.___1708742503481_closurehack=Q;window.___1708742503481_closurehack=R;window.___1708742503481_closurehack=O;window.___1708742503481_closurehack=U;window.___1708742503481_closurehack=
K;window.___1708742503482_closurehack=F;window.___1708742503482_closurehack=I;window.___1708742503482_closurehack=P;window.___1708742503482_closurehack=Y;window.___1708742503482_closurehack=ea;window.___1708742503482_closurehack=Ba;window.___1708742503482_closurehack=Fa;window.___1708742503482_closurehack=Ve;window.___1708742503482_closurehack=za;window.___1708742503482_closurehack=xa;window.___1708742503482_closurehack=fa;window.___1708742503482_closurehack=V;window.___1708742503482_closurehack=
ba;window.___1708742503482_closurehack=la;window.___1708742503482_closurehack=Ta;window.___1708742503482_closurehack=Ea;window.___1708742503482_closurehack=sa;window.___1708742503482_closurehack=Ya;window.___1708742503482_closurehack=bb;window.___1708742503482_closurehack=ra;window.___1708742503482_closurehack=Da;window.___1708742503482_closurehack=oa;window.___1708742503482_closurehack=Ha},1150:function(y,x,a){a.r(x);a.d(x,"CalcHelper",function(){return l});y=a(0);var c=a(14),b=a(242),f;(function(u){u[u.paren=
0]="paren";u[u.lead=1]="lead";u[u.intern=2]="intern";u[u.trail=3]="trail";u[u.undefined=4]="undefined"})(f||(f={}));Object(y.b)("CurrencyFormatOption",f);var r;(function(u){u[u.none=-1]="none";u[u.mdy=0]="mdy";u[u.dmy=1]="dmy";u[u.ymd=2]="ymd";u[u.myd=3]="myd";u[u.dym=4]="dym";u[u.ydm=5]="ydm"})(r||(r={}));Object(y.b)("DateOrderOption",r);class d{constructor(u,n){({CalcHelper:u}=a(1150));n&&(n.hk||c.ULS.shipAssertTag(537169942,0,!1,"LocaleHolder constructor - locale information is not available"));
this.jlh=u.Lhf(n,u.qhf(n.$va));this.klh=excelOnlineCalc.calc.localeInfoFromData(this.localeData)}get localeInfo(){return this.klh}get localeData(){return this.jlh}}Object(y.a)(d,"LocaleHolder",null,[]);var k=a(1186),t=a(59),m=a(1),e=a(27),w=a(124);class l{constructor(u,n){this.$=u;(this.cA=n)||c.ULS.shipAssertTag(537170070,0,!1,"CalcHelper constructor - IInstantaneousSupportInformationManager is not available");n=m.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")?m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelOnlineCalcWP5",
!1)?t.a.current.uu(79):t.a.current.uu(77):t.a.current.uu(78);this.logger=new k.a;this.documentLoc=excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.hwj=new d(u,this.cA);excelOnlineCalc.config.initCalc(this.logger,this.cA?v=>this.cA.isFeatureEnabled(v):()=>!1,n);this.yJ=excelOnlineCalc.config.calcConfig(this.hwj.localeInfo)}get config(){return this.yJ}K7h(){if(m.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")){if(!this.$.sa)return c.ULS.shipAssertTag(537170069,
0,!1,"CalcHelper.CurrentSheetIndex() - this.ewaControl.Sheets is null"),0;const u=this.$.sa.na;return u?u.index:(c.ULS.shipAssertTag(537170068,0,!1,"CalcHelper.CurrentSheetIndex() - sheet is null"),0)}return this.$.sa.na.index}createParser(){const u={};u.config=this.config;return excelOnlineCalc.parse.createParser(u)}createAnalyzer(){const u={};u.config=this.config;return excelOnlineCalc.analyze.createAnalyzer(u)}createNumberFormatter(){const u=excelOnlineCalc.numfmt.createFormatGlobals(this.config,
(n,v)=>excelOnlineCalc.calc.getTime(this.config,n,v,"Estimation"));return excelOnlineCalc.numfmt.createNumberFormatter(u)}X5h(u,n,v,B){if(!B)return{range:{row:n,col:v},sheet:{document:this.documentLoc,index:u}};n=excelOnlineCalc.location.gridCell(n,v);u=excelOnlineCalc.location.sheetIndex(this.documentLoc,u);return excelOnlineCalc.location.sheetGridCell(u,n)}static Lhf(u,n){n=void 0===n?null:n;const v=u.b2h(),B=u.hk.TrueValueString,z=u.hk.FalseValueString,C=u.hk.DecimalSeparator.toString(),D=u.hk.ListSeparator.toString(),
J=u.hk.ColumnSeparator.toString(),W=u.hk.RowSeparator.toString(),N=u.hk.ThousandsDataArray,M=u.hk.ThousandSeparator.toString(),Q=u.hk.Lcid,R=u.hk.Country,O=u.hk.DigitsNumber,U=u.hk.ExpSeparatedBySpace,K=u.hk.FractionSeparator.toString(),F=u.hk.PercentSeparatedBySpace,I=e.a.$nc(Enum.toString(f,u.hk.CurrencyFormat)),P=u.hk.CurrencySymbolLead,Y=u.hk.CurrencySeparatedBySpace,ea=u.hk.CurrencySymbolString,Ba=u.hk.DigitsCurrency,Fa=-1===u.hk.DateOrder?"MDY":w.e(Enum.toString(r,u.hk.DateOrder)),za=u.hk.DateSeparator.toString(),
xa=u.hk.DateAlternativeSeparator.toString(),fa=u.hk.Year4Digits,V=u.hk.Month2Digits,ba=u.hk.Day2Digits,la=u.hk.LongDateFormat,Ta=u.hk.TimeSeparator.toString(),Ea=u.hk.TimeAltSeparator,sa=u.hk.Hour2Digits,Ya=u.hk.Use24HourClock,bb=u.hk.AmPmSeparatedBySpace,ra=[u.hk.AmString,u.hk.PmString],Da=u.hk.DayNameShortArray,oa=u.hk.DayNameLongArray,Ha=u.hk.MonthNameShortArray,ka=u.hk.MonthNameLongArray,wa=u.hk.PictureSpecialArray,Za=b.a.map(("\x00"+u.hk.PictureSingleString).split(""),Ka=>"\x00"===Ka?null:Ka),
ab=u.hk.PictureColorArray,db=u.hk.PictureDbnumArray,mb=u.hk.RowLetter.toString(),Ia=u.hk.ColumnLetter.toString(),pa=u.hk.LeftBrace.toString(),lb=u.hk.RightBrace.toString(),ha=u.hk.LeftBracket.toString(),ua=u.hk.RightBracket.toString(),fb=l.ZUi(u.hk);return excelOnlineCalc.calc.localeData(n,v,B,z,mb,Ia,pa,lb,ha,ua,C,D,J,W,N,M,Q,R,O,U,K,F,I,P,Y,ea,Ba,Fa,za,xa,fa,V,ba,la,Ta,Ea,sa,Ya,bb,ra,Da,oa,Ha,ka,wa,Za,ab,db,fb,u.hk.SysDateFormatString,u.hk.SysTimeFormatString)}static qhf(u){const n=[];if(!u)return n;
for(const v of u)u=null,v.IsDynamicUdf||(u=excelOnlineCalc.calc.worksheetFunctionName(v.FunctionIndexInServer,v.NameUI)),u&&n.push(u);return n}static ZUi(u){const n=Array(6);n[1]="#"+u.AllStructRefString;n[3]="#"+u.HeadersStructRefString;n[2]="#"+u.DataStructRefString;n[4]="#"+u.TotalsStructRefString;n[5]="#"+u.ThisRowStructRefString;return n}}Object(y.a)(l,"CalcHelper",null,[])},1175:function(y,x,a){a.d(x,"a",function(){return r});y=a(0);var c=a(14),b=a(60),f=a(81);a=a(896);class r extends a.a{constructor(d,
k){super(d,k);c.ULS.sendTraceTag(537170201,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");this.title="";this.message=r.m_message;this.fga=!0}get linkText(){return r.k8f}AY(d){super.AY(d);b.a.openWindow(4,f.a.Vyc(r.j8f))}rD(d){super.rD(d);r.A1d&&r.A1d(null)}static initialize(d,k,t,m){c.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");r.m_message=d;r.k8f=k;r.j8f=t;r.A1d=m}}r.m_message=null;r.k8f=null;r.j8f=null;r.A1d=null;Object(y.a)(r,
"WacGdprNoticeBusinessBarEntry",a.a,[])},1176:function(y,x,a){a.d(x,"a",function(){return"ewa-bb"});a.d(x,"b",function(){return"ewa-bb-content"});a.d(x,"c",function(){return"ewa-bb-entry"});a.d(x,"d",function(){return"ewa-bb-entry-body"});a.d(x,"e",function(){return"ewa-bb-entry-button"});a.d(x,"f",function(){return"ewa-bb-entry-button-holder"});a.d(x,"g",function(){return"ewa-bb-entry-close"});a.d(x,"h",function(){return"ewa-bb-entry-icon"});a.d(x,"i",function(){return"ewa-bb-entry-link"});a.d(x,
"j",function(){return"ewa-bb-entry-message"});a.d(x,"k",function(){return"ewa-bb-entry-title"});a.d(x,"l",function(){return"ewa-bb-icon"});a.d(x,"m",function(){return"ewa-bb-react"})},1177:function(y,x,a){a.d(x,"a",function(){return c});y=a(0);a=a(896);class c extends a.a{constructor(b,f){super(b,f);this.Bx=!0;this.title=c.Ica;this.message=c.Hca}get actionButton(){return c.p8}ar(b){super.ar(b);(b=c.t2)&&b(null)}static initialize(b,f,r,d){c.Ica=b;c.Hca=f;c.p8=r;c.t2=d}}c.Ica=null;c.Hca=null;c.p8=null;
c.t2=null;Object(y.a)(c,"AutomaticSensitivityLabelBusinessBarEntry",a.a,[])},1178:function(y,x,a){a.d(x,"a",function(){return c});y=a(0);a=a(896);class c extends a.a{constructor(b,f){super(b,f);this.Bx=!0;this.title=c.Ica;this.message=c.Hca}get actionButton(){return c.p8}ar(b){super.ar(b);(b=c.t2)&&b(null)}static initialize(b,f,r,d){c.Ica=b;c.Hca=f;c.p8=r;c.t2=d}}c.Ica=null;c.Hca=null;c.p8=null;c.t2=null;Object(y.a)(c,"RecommendedSensitivityLabelBusinessBarEntry",a.a,[])},1179:function(y,x,a){a.d(x,
"a",function(){return d});y=a(0);x=a(1013);var c=a(1),b=a(1062),f=a(1063),r=a(14);class d extends x.a{constructor(k,t,m){super(k,t,m);d.p8&&d.t2&&(this.Bx=!0);this.title=d.Ica;this.message=d.Hca;this.fga=c.EwaSettings.isChangeGateEnabled("OfficeVSO:8683561_DataCleansingNewBusinessBarStrings")?Object(b.c)():!1}get actionButton(){return d.p8}static initialize(k,t,m,e,w){d.Ica=k;d.Hca=t;d.p8=m;d.t2=e;d.l4c=w}ar(k){super.ar(k);d.t2&&d.t2(null)}rD(k){super.rD(k);d.l4c&&d.l4c(null)}AY(k){super.AY(k);r.ULS.sendTraceTag(507561158,
0,50,"DataCleansingBusinessBarEntry.onLinkClick was triggered.");Object(f.b)(this.businessBar.$)}}d.Ica=null;d.Hca=null;d.p8=null;d.t2=null;d.l4c=null;Object(y.a)(d,"DataCleansingBusinessBarEntry",x.a,[])},1180:function(y,x,a){a.d(x,"a",function(){return c});y=a(0);a=a(896);class c extends a.a{constructor(b,f){super(b,f);this.Bx=!0;this.title=c.Ica;this.message=c.Hca}get actionButton(){return c.p8}ar(b){super.ar(b);(b=c.t2)&&b(null)}static initialize(b,f,r,d){c.Ica=b;c.Hca=f;c.p8=r;c.t2=d}}c.Ica=
null;c.Hca=null;c.p8=null;c.t2=null;Object(y.a)(c,"MandatorySensitivityLabelBusinessBarEntry",a.a,[])},1181:function(y,x,a){a.d(x,"a",function(){return c});y=a(0);a=a(896);class c extends a.a{constructor(b,f){super(b,f);this.Bx=!0;this.title=c.m_title;this.message=c.m_message}get actionButton(){return c.Tob}ar(b){super.ar(b);c.zLa&&c.zLa(null)}static initialize(b,f,r,d){c.m_title=b;c.m_message=f;c.Tob=r;c.zLa=d}}c.m_title=null;c.m_message=null;c.Tob=null;c.zLa=null;Object(y.a)(c,"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",
a.a,[])},1182:function(y,x,a){a.d(x,"a",function(){return c});y=a(0);a=a(896);class c extends a.a{constructor(b,f){super(b,f);c.Tob&&c.zLa&&(this.Bx=!0);this.title=c.m_title;this.message=c.m_message}get actionButton(){return c.Tob}ar(b){super.ar(b);c.zLa&&c.zLa(null)}static initialize(b,f,r,d){c.m_title=b;c.m_message=f;c.Tob=r;c.zLa=d}}c.m_title=null;c.m_message=null;c.Tob=null;c.zLa=null;Object(y.a)(c,"SensitivityApplicationSetLabelErrorBusinessBarEntry",a.a,[])},1188:function(y,x,a){a.d(x,"a",function(){return c});
const c=b=>{const f=Array(b.length);for(let r=0,d=b.length;r<d;r++)f[r]=b[r].cloneNode(!0);return f}},1191:function(y,x,a){a.d(x,"a",function(){return c});y=a(0);class c{}c.r3c="b-ring_Apc_Trans";c.q8g="cdn_static_resource_ewa_image";Object(y.a)(c,"ResourceHosts",null,[])},1192:function(y,x,a){a.d(x,"a",function(){return f});y=a(0);var c=a(65),b=a(1391);class f{static ZGd(r,d,k,t){t=void 0===t?null:t;f.zLc||(f.zLc=Array.isArray(c.a.Gp(k.ua.NetworkMeasurementUrlList))?c.a.Gp(k.ua.NetworkMeasurementUrlList):
null);const m=[];for(let e=0;e<f.zLc.length;e++){const w=f.zLc[e];let l=w.key;l||(l=w.Key);if(t&&!t.includes(l))continue;let u=w.value;u||(u=w.Value);l&&u&&m.push(new b.a(k,l,u,r,d))}return m}}f.zLc=null;Object(y.a)(f,"NetworkConnectionHelpers",null,[])},1347:function(y,x,a){a.r(x);a.d(x,"BusinessBarControl",function(){return Gb});y=a(0);var c=a(14),b=a(100),f=a(154),r=a(17),d=a(96),k=a(85),t=a(31),m=a(34),e=a(16);x=a(263);var w=a(1176),l=a(7),u=a(301),n=a(1177),v=a(896),B=a(1370),z=a(1013);class C extends z.a{constructor(Xa,
Jb,qb){super(Xa,Jb,qb)}rD(Xa){super.rD(Xa)}}Object(y.a)(C,"EditAttemptReadOnlyBusinessBarEntry",z.a,[]);var D=a(47);class J extends v.a{constructor(Xa,Jb,qb,Db){super(Xa,Jb);this.error=qb;this.options=Db;this.error&&this.options&2&&(this.message=this.error.Description);this.error&&this.options&1&&(this.title=this.error.Caption);this.Bx=!(Db&4)}ar(Xa){super.ar(Xa);this.error.Appearance&=-33;D.a(this.businessBar.$).CD([this.error])}}Object(y.a)(J,"ErrorBusinessBarEntry",v.a,[]);var W=a(86);class N extends J{constructor(Xa,
Jb,qb,Db,gb){super(Xa,Jb,qb,Db);this.command=gb;this.r5=!0}v6(Xa){super.v6(Xa);this.businessBar.$.Ma.dh(new W.a(this.command,Xa,this.businessBar.$.Rh,10,null))}}Object(y.a)(N,"ErrorAndCommandBusinessBarEntry",J,[]);var M=a(12);class Q{constructor(Xa,Jb,qb,Db,gb,ya,Aa,sb,nc,Bb,uc){this.Pcd=this.gT=this.lja=this.CZ=0;this.Geh=Xa;this.JWk=Jb;this.sQ=qb;this.Zih=Aa;this.kBb=t.a.jF(nc);this.ehh=nc;this.LEe=sb;this.$ih=Bb;uc&&(this.Pcd=uc);0!==Db&&(this.CZ=Db);0!==gb&&(this.lja=gb);0!==ya&&(this.gT=ya)}get lJc(){return 0===
this.Pcd?"":Q.ia(this.Pcd)}get title(){return Q.ia(this.JWk)}get message(){return Q.ia(this.sQ)}get messageId(){return this.sQ}get iconName(){return this.$ih}get RFa(){return this.Geh}get actionButton(){return Q.ia(this.CZ)}get vUa(){return Q.ia(this.lja)}get link(){return Q.ia(this.gT)}get Dx(){return this.Zih}get businessBarType(){return this.LEe}get hash(){return this.kBb}get alt(){const {BusinessBarControl:Xa}=a(1347);switch(this.Dx){case Xa.vva:return Q.ia(26);case Xa.IC:return Q.ia(25);case Xa.xp:return Q.ia(24);
default:return Q.ia(0)}}get GHa(){return this.ehh}set businessBarType(Xa){this.LEe=Xa}static ia(Xa){return M.a.instance.ia(Xa)}}Object(y.a)(Q,"EwaBusinessBarEntry",null,[]);class R extends Q{constructor(Xa,Jb,qb,Db,gb,ya,Aa,sb,nc){super(Xa,0,Jb,qb,Db,gb,ya,Aa,sb,nc)}get title(){return""}}Object(y.a)(R,"EwaNoTitleBusinessBarEntry",Q,[]);var O=a(74),U=a(1),K=a(69);class F extends v.a{constructor(Xa,Jb){super(Xa,Jb);this.r5=this.Bx=!0;this.fga=this.eij=U.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.WebWorkbookLinkNewTaskPaneEnabled",
!1)}ar(Xa){super.ar(Xa);this.set_visible(!1);this.businessBar.$.xP();this.businessBar.$.Ma.dh(new W.a(1038998010,Xa,this.businessBar.$.Rh,10,null))}v6(Xa){super.v6(Xa);this.businessBar.$.Ma.dh(new W.a(-722953877,Xa,this.businessBar.$.Rh,10,null))}AY(Xa){super.AY(Xa);Xa=new W.a(-859308420,K.a.eh,this.businessBar.$.Rh,12,null);this.businessBar.$.Ma.dh(Xa,{[K.a.Wk]:"AssetID="+l.a.Evf,["InputMethod"]:K.a.eh,[K.a.Ai]:l.a.CI,["ShouldCanvasTakeFocus"]:!0})}rD(Xa){this.businessBar.removeEntry(55);O.g(Xa)}}
Object(y.a)(F,"ExternalLinksEnableContentBusinessBarEntry",v.a,[]);class I extends v.a{constructor(Xa,Jb){super(Xa,Jb);this.Bx=!0;this.r5=!1}ar(Xa){super.ar(Xa);this.businessBar.$.Ma.dh(new W.a(-722953877,Xa,this.businessBar.$.Rh,10,null))}rD(Xa){this.businessBar.removeEntry(5);O.g(Xa)}}Object(y.a)(I,"ExternalLinksShowErrorBusinessBarEntry",v.a,[]);var P=a(13);class Y extends v.a{constructor(Xa,Jb,qb){super(Xa,Jb);this.LZa=qb;this.Bx=!0}ar(Xa){super.ar(Xa);P.HelperMethods.i1(this.businessBar.$.fL,
this.LZa,this.businessBar.$.gN)}}Object(y.a)(Y,"HelpButtonBusinessBarEntry",v.a,[]);class ea extends v.a{constructor(Xa,Jb,qb){super(Xa,Jb);this.LZa=qb;this.fga=!0}AY(Xa){super.AY(Xa);P.HelperMethods.i1(this.businessBar.$.fL,this.LZa,this.businessBar.$.gN)}}Object(y.a)(ea,"HelpTextBusinessBarEntry",v.a,[]);class Ba extends v.a{constructor(Xa,Jb,qb,Db){super(Xa,Jb);this.LZa=qb;this.command=Db;this.fga=!0;this.Bx=1461300262!==Db}ar(Xa){super.ar(Xa);this.businessBar.$.Ma.dh(new W.a(this.command,Xa,this.businessBar.$.Rh,
10,null))}AY(Xa){super.AY(Xa);const Jb=new W.a(-859308420,Xa,this.businessBar.$.Rh,12,null);this.businessBar.$.Ma.dh(Jb,{[K.a.Wk]:"HelpID="+this.LZa,["InputMethod"]:Xa,[K.a.Ai]:l.a.CI,[l.a.Fia]:!0})}}Object(y.a)(Ba,"HelpTextTaskPaneAndCommandBusinessBarEntry",v.a,[]);class Fa extends v.a{constructor(Xa,Jb){super(Xa,Jb);this.r5=this.Bx=!0}ar(Xa){super.ar(Xa);this.set_visible(!1);this.businessBar.$.xP();this.businessBar.$.Ma.dh(new W.a(-1081442996,Xa,this.businessBar.$.Rh,10,null))}v6(Xa){super.v6(Xa);
this.businessBar.$.Ma.dh(new W.a(1702917262,Xa,this.businessBar.$.Rh,10,null))}rD(Xa){this.businessBar.removeEntry(59);O.g(Xa)}}Object(y.a)(Fa,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",v.a,[]);var za=a(1180);class xa extends v.a{constructor(Xa,Jb){super(Xa,Jb);(this.policyManager=Xa.$.ka.Ug(274))?(this.message=this.policyManager.RPc,this.title=this.policyManager.title,this.fga=!0):c.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered.")}get linkText(){return this.policyManager.linkText}AY(Xa){super.AY(Xa);
(Xa=this.policyManager.USj)&&Xa(null)}}Object(y.a)(xa,"PolicyBusinessBarEntry",v.a,[]);var fa=a(1178),V=a(1182),ba=a(1181);a(644);var la=a(103),Ta=a(28);class Ea extends v.a{constructor(Xa,Jb){super(Xa,Jb);this.Bx=!0;this.title=""}ar(Xa){super.ar(Xa);la.c(Ta.a.vGj);window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank")}}Object(y.a)(Ea,"UnsupportedBrowserBusinessBarEntry",v.a,[]);var sa=a(1175),Ya=a(139),bb=a(1152),ra=a(1064),Da=a(1359),oa=a(23);class Ha{constructor(){this.q5c=
new Da.a;this.o5c=new Da.a;this.n5c=new Da.a;this.tKh(this.q5c);this.sKh(this.o5c);this.rKh(this.n5c);this.T$c=new Da.a;this.S$c=new Da.a;this.R$c=new Da.a;this.TMh(this.T$c);this.SMh(this.S$c);this.RMh(this.R$c);this.L6c=new Da.a;this.NKh(this.L6c);this.WTa(this.L6c);this.WTa(this.n5c);this.WTa(this.o5c);this.WTa(this.q5c);this.WTa(this.S$c);this.WTa(this.T$c);this.WTa(this.R$c)}zVi(Xa,Jb){switch(Xa){case 1:return this.pZi(Jb);case 2:return this.xCi(Jb)}return ra.a.Gpe?this.L6c:null}tKh(Xa){Xa.add("Headline",
Object(oa.a)("WildFireWordBizBarHeadline"));Xa.add("UseAppButton",Object(oa.a)("WildFireBizBarUseAppButtonText"));Xa.add("CallToAction",Object(oa.a)("WildFireWordBizBarAndroidCallToAction"))}sKh(Xa){Xa.add("Headline",Object(oa.a)("WildFirePPTBizBarHeadline"));Xa.add("UseAppButton",Object(oa.a)("WildFireBizBarUseAppButtonText"));Xa.add("CallToAction",Object(oa.a)("WildFirePPTBizBarAndroidCallToAction"))}rKh(Xa){Xa.add("Headline",Object(oa.a)("WildFireExcelBizBarHeadline"));Xa.add("UseAppButton",Object(oa.a)("WildFireBizBarUseAppButtonText"));
Xa.add("CallToAction",Object(oa.a)("WildFireExcelBizBarAndroidCallToAction"))}TMh(Xa){Xa.add("Headline",Object(oa.a)("WildFireWordBizBarHeadline"));Xa.add("UseAppButton",Object(oa.a)("WildFireBizBarUseAppButtonText"));Xa.add("InstallButton",Object(oa.a)("WildFireBizBarInstallButtonText"));Xa.add("OpenAppButton",Object(oa.a)("WildFireBizBarOpenAppButtonText"));Xa.add("CallToAction",Object(oa.a)("WildFireWordBizBarIPadCallToAction"));Xa.add("OverlayBig","Get the Word app");Xa.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");
Xa.add("OverlaySmallSplit1","Discover Word");Xa.add("OverlaySmallSplit2","designed for the iPad.");Xa.add("SkipButton","Skip for now")}NKh(Xa){Xa.add("Headline","Get the Office Online extension for Chrome");Xa.add("UseAppButton","Get the extension");Xa.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}SMh(Xa){Xa.add("Headline",Object(oa.a)("WildFirePPTBizBarHeadline"));Xa.add("UseAppButton",Object(oa.a)("WildFireBizBarUseAppButtonText"));Xa.add("InstallButton",
Object(oa.a)("WildFireBizBarInstallButtonText"));Xa.add("OpenAppButton",Object(oa.a)("WildFireBizBarOpenAppButtonText"));Xa.add("CallToAction",Object(oa.a)("WildFirePPTBizBarIPadCallToAction"));Xa.add("OverlayBig","Get the PowerPoint app");Xa.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");Xa.add("OverlaySmallSplit1","Discover PowerPoint");Xa.add("OverlaySmallSplit2","designed for the iPad.");Xa.add("SkipButton","Skip for now")}RMh(Xa){Xa.add("Headline",
Object(oa.a)("WildFireExcelBizBarHeadline"));Xa.add("UseAppButton",Object(oa.a)("WildFireBizBarUseAppButtonText"));Xa.add("InstallButton",Object(oa.a)("WildFireBizBarInstallButtonText"));Xa.add("OpenAppButton",Object(oa.a)("WildFireBizBarOpenAppButtonText"));Xa.add("CallToAction",Object(oa.a)("WildFireExcelBizBarIPadCallToAction"))}WTa(Xa){Xa.add("Corporation","Microsoft Corporation")}pZi(Xa){switch(Xa){case 3:return this.T$c;case 2:return this.S$c;case 1:return this.R$c}return null}xCi(Xa){switch(Xa){case 3:return this.q5c;
case 2:return this.o5c;case 1:return this.n5c}return null}static get instance(){Ha.Wa||(Ha.Wa=new Ha);return Ha.Wa}}Ha.Wa=null;Object(y.a)(Ha,"WildFireStringFactory",null,[]);var ka=a(6),wa=a(60);class Za{constructor(Xa,Jb,qb,Db,gb,ya){this.Eed=null;this._id=Xa;this.rfd=Jb;this.sih=void 0===gb?null:gb;this.GBb=Db;this.UDb=void 0===ya?null:ya;this.HQa=null;this.ecb=qb;this.xEb=Ha.instance.zVi(Jb,Xa)}Kgf(){this.HQa=new bb.a(this.title,this.message,null);this.HQa.addButton(this.W8e,Object(Ya.a)(this,
this.oeg,"onButtonOneClick"),"");this.ecb&&this.HQa.Yvh(this.$8e,Object(Ya.a)(this,this.reg,"onButtonTwoClick"));this.HQa.iX=Object(Ya.a)(this,this.qmf,"dismissBar");this.HQa.image=3;this.HQa.id=16;this.HQa.closeable=!0}get title(){return this.xEb.ma("Headline")}get message(){return this.xEb.ma("CallToAction")}get b8k(){return this.ecb}get W8e(){return this.ecb?this.xEb.ma("InstallButton"):this.xEb.ma("UseAppButton")}get $8e(){return this.ecb?this.xEb.ma("OpenAppButton"):""}oeg(){this.ecb?this.pcj():
this.S7k()}reg(){this.ecb&&this.CZj()}get openUrl(){this.Eed||(this.Eed=this.sih());return this.Eed}pcj(){c.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.GBb&&this.UDb&&this.UDb();ra.a.Byg(this._id,this.rfd)}CZj(){this.openUrl&&(c.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.GBb&&this.UDb&&this.UDb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(ra.a.O3e(this._id),this.openUrl,0,!1))}S7k(){ra.a.Gpe?this.ZMh():(c.ULS.sendTraceTag(17109255,
306,50,"AppBusinessBarNav"),ra.a.kne("BizBarClicked"),1!==this.rfd&&2!==this.rfd||ra.a.kUh(this.openUrl,this.GBb,this._id,this.UDb))}ZMh(){this.GBb?c.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):c.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");wa.a.V4(ka.AFrameworkApplication.fa.appSettings.WildFireChromeExtensionUrl.toString())}Pbi(){this.GBb?c.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):c.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");ra.a.kne(ra.a.TSh)}qmf(){ra.a.Gpe?
this.Pbi():(ra.a.kne(ra.a.mBf(this._id)),c.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static i7h(){const Xa=ka.AFrameworkApplication.ra.$d,Jb=new Za(Xa.Om,ra.a.FKf(),8<m.a.gSb,1===Xa.aMa,()=>Xa.QA,Xa.Csk());c.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return Jb}}Object(y.a)(Za,"WildFireBusinessBar",null,[]);class ab extends v.a{constructor(Xa,Jb){super(Xa,Jb);this.qQa=Za.i7h();this.Bx=!0;this.r5=this.qQa.b8k;this.title=this.qQa.title;this.message=this.qQa.message}get actionButton(){return this.qQa.W8e}get vUa(){return this.qQa.$8e}ar(Xa){super.ar(Xa);
this.qQa.oeg(null)}v6(Xa){super.v6(Xa);this.qQa.reg(null)}rD(Xa){super.rD(Xa);this.qQa.qmf(null)}}Object(y.a)(ab,"WildFireMobileAppBusinessBarEntry",v.a,[]);var db=a(279),mb=a(27),Ia=a(205),pa=a(169),lb=a(43),ha=a(2),ua=a(188),fb=a(1183),Ka=a(72),La=a(150),ib=a(5),Yb=a(97);class Wc extends v.a{constructor(Xa,Jb,qb,Db){super(Xa,Jb);this.BK=Yb.a.Zg(ib.ge);c.ULS.shipAssertTag(512276321,0,!!this.BK);this.id=ua.a.create();this.$=qb;this.title=M.a.instance.ia(2282);this.message="";this.ase=M.a.instance.ia(2278);
this.T5g=M.a.instance.ia(2279);this.Q5g=M.a.instance.ia(2280);this.Sef=M.a.instance.ia(2281);this.update(Db)}update(Xa){this.scriptLink=Xa.scriptLink;this.runStatus=Xa.runStatus;this.buttonText=Xa.buttonText||"";this.Cwj(Xa.clickId);this.zok();"preparing"===this.runStatus?(this.CAa(0),this.message=String.format(M.a.instance.$g(208),this.buttonText),this.Bx=!0,this.TEa=this.ase,this.DJb=this.$sa=this.Lqb):"running"===this.runStatus?(this.CAa(0),this.message=String.format(M.a.instance.$g(207),this.buttonText),
this.Bx=!0,this.TEa=this.ase,this.DJb=this.$sa=this.Lqb):"succeeded"===this.runStatus?(this.CAa(0),this.message=String.format(M.a.instance.$g(210),this.buttonText),"true"===Xa.hasLogs?(this.Bx=!0,this.TEa=this.Q5g,this.$sa=this.Vog,this.r5=!0,this.god=this.T5g,this.hod=this.Wog):(this.Bx=!0,this.TEa=this.T5g,this.$sa=this.Wog)):"runFailed"===this.runStatus?(this.CAa(1),this.message=String.format(M.a.instance.$g(209),this.buttonText),this.glb=Gb.vva,"true"===Xa.hasLogs?(this.Bx=!0,this.TEa=this.Q5g,
this.$sa=this.Vog,"false"===Xa.isOwner&&(this.r5=!0,this.god=this.Sef,this.hod=this.xfg)):"false"===Xa.isOwner&&(this.Bx=!0,this.TEa=this.Sef,this.$sa=this.xfg)):"fetchFailed"===this.runStatus?(this.CAa(1),this.glb=Gb.vva,this.message=M.a.instance.ia(2284)):"canceled"===this.runStatus?(this.CAa(0),this.glb=Gb.IC,this.message=String.format(M.a.instance.$g(212),this.buttonText)):"alreadyRunning"===this.runStatus?(this.CAa(5),this.glb=Gb.IC,this.message=String.format(M.a.instance.$g(211),this.buttonText),
this.Bx=!0,this.TEa=this.ase,this.DJb=this.$sa=this.Lqb):"initializing"===this.runStatus&&(this.CAa(0),this.glb=Gb.xp,this.message=M.a.instance.ia(2283))}get Dx(){return this.glb}get actionButton(){return this.TEa}get vUa(){return this.god}ar(Xa){super.ar(Xa);this.$sa&&this.$sa()}v6(Xa){super.v6(Xa);this.vUa&&this.hod()}rD(Xa){super.rD(Xa);this.DJb&&this.DJb()}zok(){this.message="";this.glb=Gb.xp;this.Bx=!1;this.TEa="";this.$sa=void 0;this.r5=!1;this.god="";this.hod=void 0;this.hideCloseButton=!1;
this.DJb=void 0}Lqb(){const Xa=ua.a.create().toString();this.BK.E_i(Xa);this.FJc(-2186799,Xa)}Vog(){const Xa=ua.a.create().toString();this.BK.D_i(Xa);this.FJc(1036446140,Xa)}Wog(){const Xa=ua.a.create();if(this.scriptLink){const Jb=new fb.b(this.scriptLink);this.BK.XMf(this.id.toString(),JSON.stringify(Jb),Xa)}this.FJc(-585097204,Xa.toString())}xfg(){const Xa=ua.a.create().toString();this.BK.C_i(Xa);this.FJc(-639858579,Xa)}Cwj(Xa){const Jb=[];Jb.push(Object(ha.a)(new Ka.a,{name:"id",string:this.id.toString()}));
Jb.push(Object(ha.a)(new Ka.a,{name:"hasScriptLink",bool:!!this.scriptLink}));Jb.push(Object(ha.a)(new Ka.a,{name:"runStatus",string:this.runStatus}));Jb.push(Object(ha.a)(new Ka.a,{name:"clickId",string:Xa}));Jb.push(Object(ha.a)(new Ka.a,{name:"hasButtonText",bool:!!this.buttonText&&""!==this.buttonText}));la.a(La.a.jJj,void 0,void 0,Jb)}FJc(Xa,Jb){const qb=[];qb.push(Object(ha.a)(new Ka.a,{name:"id",string:this.id.toString()}));qb.push(Object(ha.a)(new Ka.a,{name:"hasScriptLink",bool:!!this.scriptLink}));
qb.push(Object(ha.a)(new Ka.a,{name:"runStatus",string:this.runStatus}));qb.push(Object(ha.a)(new Ka.a,{name:"clickId",string:Jb}));la.d(Xa,void 0,void 0,void 0,void 0,void 0,qb)}}Object(y.a)(Wc,"OfficeScriptsRunStatusBusinessBarEntry",v.a,[]);var Qc=a(58);class Wb extends z.a{constructor(Xa,Jb,qb,Db,gb,ya){super(Xa,Jb,qb);Qc.a.instance.create(()=>{this.showCallout(Jb,Db)},gb,ya,!0,!0)}showCallout(Xa,Jb){if(this.businessBar&&this.businessBar.N5(Xa.RFa)&&this.F2e()){Xa=new W.a(-847286761,0,this.businessBar.$.Rh,
0,null);var qb={};qb.CalloutName=Jb;U.EwaSettings.isChangeGateEnabled("OfficeVSO:6947554_RetrieveBusinessBarButtonElementChange")?qb.Target=this.yma():qb.Target=U.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.domElement.getElementsByTagName("button")[0]:this.CZ.domElement;this.businessBar.$.Ma.dh(Xa,qb)}}F2e(){return!0}}Object(y.a)(Wb,"CalloutBusinessBarEntry",z.a,[]);class Jc extends Wb{constructor(Xa,Jb,qb,Db,gb,ya){super(Xa,Jb,qb,Db,gb,ya)}F2e(){if(!U.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",
!0))return!0;if(!this.businessBar)return!1;const Xa=Yb.a.Zg(ib.ke);return Xa&&Xa.JUc?!1:!0}}Object(y.a)(Jc,"OptimizeWorkbookCalloutBusinessBarEntry",Wb,[]);var ma=a(19),Hc=a(125),Kb=a(42),pc=a(123);class $b extends v.a{constructor(Xa,Jb,qb){super(Xa,Jb);this.update(qb)}update(Xa){this.title=Xa.title?Xa.title:"";this.message=Xa.message?Xa.message:"";const Jb=this.ZZh(Xa.businessBarType);this.CAa(Jb);this.hideCloseButton=!!Xa.hideCloseButton;if(U.EwaSettings.isChangeGateEnabled("OfficeVSO:7958899_LogMsFormsDataSyncBizBarShown")){const qb=
[];qb.push(Hc.a.Rl("Reason",Xa.reason,2));qb.push(Hc.a.Rl("Type",Jb.toString(),2));la.a("MsFormsDataSyncBizBarShown",void 0,void 0,qb)}U.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormsDataSyncFGSurveyEnabled",!1)&&Kb.a.instance.Qi("Common.ISystemInitiatedFeedback").execute(qb=>{ka.AFrameworkApplication.pp.Ol(new pc.a(5,1,2E4,()=>{qb.logActivity("ExcelFormsDataSync",null)}))})}ZZh(Xa){switch(Xa){case "error":return 1;case "blocked":return 2;case "severeWarning":return 3;case "success":return 4;
case "warning":return 5;default:return 0}}}Object(y.a)($b,"MsFormsDataSyncStatusBusinessBarEntry",v.a,[]);class Ib extends v.a{constructor(Xa,Jb,qb,Db){super(Xa,Jb);this.r5=this.Bx=!0;this.Z6j=qb;this.iDh=Db}ar(Xa){super.ar(Xa);this.businessBar.$.Ma.dh(new W.a(this.Z6j,Xa,this.businessBar.$.Rh,10,null))}v6(Xa){super.ar(Xa);this.businessBar.$.Ma.dh(new W.a(this.iDh,Xa,this.businessBar.$.Rh,10,null))}}Object(y.a)(Ib,"DualCommandActionsBusinessBarEntry",v.a,[]);var Zb=a(1179),Eb=a(428),ob=a(152);class Na extends v.a{constructor(Xa,
Jb){super(Xa,Jb);this.Bx=!0}ar(Xa){super.ar(Xa);void Yb.a.resolve(ib.qb,{va:1}).then(Jb=>{U.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConfirmActiveContent",!1)?Jb.fvg(()=>{this.businessBar.$.Ma.dh(new W.a(-1995709983,Xa,this.businessBar.$.Rh,10,null))}):(Jb.fvg(),this.businessBar.$.Ma.dh(new W.a(-1995709983,Xa,this.businessBar.$.Rh,10,null)),this.businessBar.removeEntry(74))})}}Object(y.a)(Na,"ExternalConnectionsEnableContentRefreshOnOpenBusinessBarEntry",v.a,[]);var nb=a(1062);class Hb extends v.a{constructor(Xa,
Jb){super(Xa,Jb);this.LZa="6d24cece-a038-468a-8176-8b6568ca9be2";this.Bx=this.fga=!0}ar(Xa){super.ar(Xa);this.set_visible(!1);this.businessBar.$.xP();this.businessBar.$.Ma.dh(new W.a(-1193102612,Xa,this.businessBar.$.Rh,10,null))}AY(Xa){super.AY(Xa);const Jb=new W.a(-859308420,K.a.eh,this.businessBar.$.Rh,12,null);this.businessBar.$.Ma.dh(Jb,{[K.a.Wk]:"HelpID="+this.LZa,["InputMethod"]:Xa,[K.a.Ai]:l.a.CI,[l.a.Fia]:!0})}rD(Xa){this.businessBar.set_visible(!1);O.g(Xa)}}Object(y.a)(Hb,"AutoRefreshDisabledBusinessBarEntry",
v.a,[]);class na extends v.a{constructor(Xa,Jb,qb){super(Xa,Jb);this.update(qb)}update(Xa){const Jb=Xa.entryToAdd;this.title=Jb.title;this.message=Jb.message;this.kIb=Jb.kIb;this.Bx=!0;this.rD=qb=>{super.rD(qb);Jb.iX(null)}}get actionButton(){return this.kIb.text}ar(Xa){super.ar(Xa);(Xa=this.kIb.handler)&&Xa(null);this.kIb.$bi&&this.rD(null)}}Object(y.a)(na,"SharedBusinessBarEntry",v.a,[]);class Gb extends x.a{constructor(Xa,Jb){super(Jb);this.pyf=e.DOMElementExtensions.zI+",div";this.f4=Array(76);
this.jLe=this.Mu=!1;this.A6=qb=>{if(qb.La.keyCode===b.a.mG){var Db=this.Pi.querySelectorAll(this.pyf);const gb=e.DOMElementExtensions.fE(Db);Db=e.DOMElementExtensions.K$(Db);return e.DOMElementExtensions.u6a(qb.La,gb,Db)}return!1};this.fh=Xa;this.set_visible(!1);f.a.instance.ya(r.a.zi,this.Pi,this.A6);u.a(Xa).Eq(this)}get Hk(){return db.a.Brd}get Pi(){return this.domElement}get Co(){return this.get_visible()}get $(){return this.fh}zp(Xa,Jb){U.EwaSettings.isChangeGateEnabled("OfficeVSO:7627987_BizBarA11yFocusFix")?
Jb||e.DOMElementExtensions.setFocus(e.DOMElementExtensions.fE(this.Pi.querySelectorAll(this.pyf))):Jb||e.DOMElementExtensions.setFocus(this.domElement.firstChild);return!Jb}Yp(Xa){return e.DOMElementExtensions.Cn(this.Pi,Xa)}gs(){}Xt(){}dispose(){this.Mu||(f.a.instance.Na(r.a.zi,this.Pi,this.A6),d.a.Ni(this.f4),this.f4=Array(76),this.fh=null,super.dispose(),this.Mu=!0)}N5(Xa){if(!this.get_visible())return!1;Xa=this.f4[Xa];return!!Xa&&Xa.isVisible}MHd(Xa){return this.N5(Xa)?this.f4[Xa].yma():null}dO(Xa){return!!this.f4[Xa]}Ixb(Xa,
Jb){if(Xa=this.f4[Xa])Xa.update(Jb),Xa.g3k()}eF(Xa,Jb,qb,Db){qb=void 0===qb?null:qb;Db=void 0===Db?null:Db;Object(ob.c)(()=>{this.euh(Xa,Jb,qb,Db)},this.fh.xa)}euh(Xa,Jb,qb,Db){qb=void 0===qb?null:qb;Db=void 0===Db?null:Db;let gb=!1;if(!this.jLe){var ya=U.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?`${w.a} ${w.m}`:w.a;this.addCssClass(ya);this.jLe=!0}if(this.dO(Xa))qb=this.f4[Xa].get_visible();else{this.set_visible(!0);ya=Gb.NKf(this.$)[Xa];this.f4[Xa]=this.mX(Xa,
Jb,qb,Db);qb=!1;gb=!0;Db="";let Aa=0;Jb&&(Db=Jb.MessageIdName,Aa=Jb.MessageId);const sb=ya.GHa,nc=lb.a.instance.Tfa(new Date);c.ULS.sendTraceTag(537170258,0,50,`BusinessBarControl.AddEntry of type: ${Xa}, time from app interactive: ${nc}`);U.EwaSettings.isChangeGateEnabled("OfficeVSO:7232357_AvoidBsqmReportingForSuccessBizBars")&&4===ya.businessBarType||pa.a(this.$).nhe(ya.hash,Db,Aa,k.a.v0c,!0,1,Jb,sb)}qb||!B.BusinessBarManager.GAc().includes(Xa)&&!gb||(this.f4[Xa].set_visible(!0),this.$.xP())}removeEntry(Xa){return this.Ogk(Xa)}dfe(){d.a.Ni(this.f4);
this.f4=Array(76);this.set_visible(!1)}Ogk(Xa){if(!this.dO(Xa))return!1;d.a.Ng(this.f4[Xa]);this.f4[Xa]=null;this.domElement.hasChildNodes()||this.set_visible(!1);this.$.xP();return!0}mX(Xa,Jb,qb,Db){qb=void 0===qb?null:qb;Db=void 0===Db?null:Db;const gb=Gb.NKf(this.$)[Xa],ya=!!(this.$.wj&64),Aa=this.$.Zmb();switch(Xa){case 23:Xa=Aa?new z.a(this,gb,617689800):new v.a(this,gb);break;case 2:case 4:case 25:case 26:case 36:case 35:Xa=new v.a(this,gb);break;case 12:case 29:case 30:case 31:case 32:case 57:Xa=
ya?new z.a(this,gb,-8805455):new v.a(this,gb);break;case 34:Xa=ya?new Ib(this,gb,-8805455,-104572626):new v.a(this,gb);break;case 22:Xa=new C(this,gb,-8805455);break;case 46:case 45:Xa=ya?new N(this,gb,Jb,0,-8805455):new J(this,gb,Jb,0);break;case 11:case 43:case 7:case 0:case 1:case 3:case 33:Xa=new J(this,gb,Jb,0);break;case 19:Xa=new v.a(this,gb);break;case 47:Xa=new J(this,gb,Jb,0);break;case 6:case 14:Xa=new Y(this,gb,Jb.HelpTopicId);break;case 67:case 65:Xa=new ea(this,gb,Jb.HelpTopicId);break;
case 73:Xa=new ea(this,gb,Eb.a.Fsg);break;case 72:Xa=new C(this,gb,-1698025133);break;case 37:Xa=new ea(this,gb,l.a.l8h);break;case 38:Xa=new v.a(this,gb);break;case 71:Xa=new v.a(this,gb);break;case 68:Xa=new C(this,gb,924877417);break;case 16:Xa=new v.a(this,gb);Xa.title=t.a.Xq(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);Xa.message=t.a.Xq(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);break;case 18:Xa=new z.a(this,gb,-1762562205);Xa.hideCloseButton=!0;break;case 20:Xa=
new ab(this,gb);break;case 21:case 56:Xa=new v.a(this,gb);break;case 28:Xa=new v.a(this,gb);break;case 24:Xa=new Ea(this,gb);break;case 27:Xa=new xa(this,gb);break;case 39:Xa=new sa.a(this,gb);break;case 40:Xa=new n.a(this,gb);break;case 41:Xa=new fa.a(this,gb);break;case 42:Xa=new za.a(this,gb);break;case 48:Xa=new v.a(this,gb);break;case 49:Xa=new v.a(this,gb);break;case 50:Xa=new v.a(this,gb);break;case 51:Xa=new v.a(this,gb);break;case 52:Xa=new v.a(this,gb);break;case 53:Xa=new ba.a(this,gb);
break;case 54:Xa=new V.a(this,gb);break;case 55:Xa=new F(this,gb);break;case 5:Xa=new I(this,gb);break;case 58:Xa=new z.a(this,gb,-1753056834);Jb?(Jb=Jb.Directive,mb.a.qz(Jb)||"&nbsp;"===Jb||(Xa.message=Jb)):qb&&(Xa.message=qb);break;case 59:Xa=new Fa(this,gb);break;case 60:Xa=new v.a(this,gb);break;case 63:Xa=new ea(this,gb,l.a.jIj);break;case 61:Xa=new Ba(this,gb,l.a.cIh,-8805455);break;case 44:Xa=new Hb(this,gb);break;case 66:Xa=new Ba(this,gb,l.a.tbk,1461300262);break;case 62:Xa=new Jc(this,gb,
515196233,13,3E5,"OptimizeWorkbookManager.ShowBusinessBarTeachingCallout");Xa.message=qb;break;case 70:Xa=new Zb.a(this,gb,-1190551534);break;case 64:Xa=new Wc(this,gb,this.$,Db);break;case 69:Xa=new $b(this,gb,Db);break;case 74:Xa=new Na(this,gb);break;case 75:Xa=new na(this,gb,Db);break;default:Xa=new J(this,gb,Jb,7)}Xa.Kgf();return Xa}static NKf(Xa){const Jb=Xa.Zmb();Xa=Ia.a.Fxa()?261:260;const qb=U.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.WebWorkbookLinkNewTaskPaneEnabled",!1);
return Gb.M8e||(Gb.M8e=[new Q(0,276,277,278,0,0,Gb.vva,1,"BB_UnableToRefreshLock"),new Q(1,276,277,278,0,0,Gb.vva,1,"BB_UnableToRefreshLockExpected"),new Q(2,268,269,0,0,0,Gb.IC,5,"BB_WorkbookAlmostTooLarge"),new Q(3,270,271,272,0,0,Gb.vva,1,"BB_WorkbookTooLarge"),new Q(4,259,Xa,0,0,0,Gb.IC,5,"BB_ExternalWorkbookLinksDisabled"),new Q(5,263,262,264,0,0,Gb.vva,5,"BB_ExternalWorkbookLinksShowError","Warning_MessageBar_16"),new Q(6,265,266,267,0,0,Gb.xp,0,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),
new Q(7,251,252,253,0,0,Gb.xp,5,"BB_UnsupportedFeatures"),new Q(8,0,0,0,0,0,Gb.xp,0,"BB_CollabDataAndDataStringsLocaleMismatch"),new Q(9,0,0,0,0,0,Gb.xp,0,"BB_CollabDataStringsLocaleMismatch"),new Q(10,0,0,0,0,0,Gb.xp,0,"BB_CollabDataLocaleMismatch"),new Q(11,279,280,281,0,0,Gb.vva,1,"BB_LastGenericStatusError"),new Q(12,282,283,284,0,0,Gb.IC,5,"BB_ScratchPadWarning"),new Q(13,285,286,287,0,0,Gb.vva,1,"BB_AuthenticationLost"),new Q(14,288,289,290,0,0,Gb.IC,5,"BB_OdfCompatibilityIssues"),new Q(15,
0,575,0,0,0,Gb.IC,5,"BB_PivotChartInteractivityMissingWarning"),new Q(16,0,0,0,0,0,Gb.xp,2,"BB_WorkbookIsIrmProtected"),new Q(17,0,0,0,0,0,Gb.xp,0,"BB_BIFeatureNotAvailable"),new Q(18,291,292,287,0,0,Gb.IC,5,"BB_AnonymousCreateMode"),new Q(19,254,255,0,0,0,Gb.IC,5,"BB_UnsupportedInteractiveReportEditing"),new Q(20,0,0,0,0,0,Gb.xp,0,"BB_MobileAppCampaignBizBar"),new Q(21,297,298,0,0,0,Gb.xp,0,"BB_TransientServerCommunicationFailures"),new Q(22,1643,1654,1655,0,0,Gb.xp,5,"BB_EditAttemptInReadOnly"),
new Q(23,1643,Jb?2348:1654,Jb?2349:0,0,0,Gb.xp,5,"BB_EditAttemptInReadOnlyNoEditPermissions"),new Q(24,0,P.HelperMethods.B2k(),1632,0,0,Gb.xp,3,"BB_UnsupportedBrowser"),new Q(25,300,301,0,0,0,Gb.xp,2,"BB_ReadOnlyPermissions"),new Q(26,302,303,0,0,0,Gb.xp,2,"BB_DocumentIsIrmProtectedWarning"),new Q(27,0,0,0,0,0,Gb.IC,5,"BB_PolicyWarningMessage"),new Q(28,1285,299,0,0,0,Gb.xp,0,"BB_WorkingOnIt"),new Q(29,1643,1641,1642,0,0,Gb.xp,2,"BB_PasswordProtectedWorkbookLockedForEdit"),new Q(30,1656,1657,1658,
0,0,Gb.xp,5,"BB_WorkbookIsReadOnlyRecommended"),new Q(31,1643,1659,1660,0,0,Gb.xp,5,"BB_WorkbookHasPasswordToModify"),new Q(32,1643,1661,1664,0,0,Gb.xp,3,"BB_LegacySharedWorkbookEditWarning"),new Q(33,1651,1662,253,0,0,Gb.xp,5,"BB_LegacyConnectionsWarning"),new Q(34,1643,1960,1961,1962,0,Gb.xp,0,"BB_TooManyLoadBlockingFloatingObjects"),new Q(35,1652,1653,0,0,0,Gb.xp,2,"BB_GroupedSlicers"),new Q(36,313,314,0,0,0,Gb.IC,5,"BB_ThirdPartyAddinDisabled"),new Q(37,1789,1790,0,0,1791,Gb.xp,5,"BB_FinanceLinkedEntityDisclaimerBar"),
new Q(38,1818,1819,0,0,0,Gb.IC,5,"BB_WolframDeprecationAlertBar"),new Q(39,0,0,0,0,0,Gb.xp,0,"BB_WacGdprNotice"),new Q(40,0,0,0,0,0,Gb.xp,0,"BB_AutomaticSensitivityLabel"),new Q(41,0,0,0,0,0,Gb.xp,0,"BB_RecommendedSensitivityLabel"),new Q(42,0,0,0,0,0,Gb.xp,0,"BB_MandatorySensitivityLabel"),new Q(43,315,316,317,0,0,Gb.xp,0,"BB_LocalStorageDisabled"),new Q(44,632,633,0,0,1319,Gb.xp,0,"BB_AutoRefreshDisabled"),new Q(45,1014,1012,1016,1314,0,Gb.xp,4,"BB_CorruptedFileRepaired"),new Q(46,1015,1013,1016,
1314,0,Gb.xp,5,"CorruptedOdsFileRepaired"),new Q(47,273,274,275,0,0,Gb.IC,5,"BB_MinorVersionLimitReached"),new Q(48,304,305,0,0,0,Gb.IC,5,"BB_SensitivityApplicationGenericError"),new Q(49,306,308,0,0,0,Gb.IC,5,"BB_SensitivityApplicationTooLargeFileError"),new Q(50,307,308,0,0,0,Gb.IC,5,"BB_SensitivityApplicationLabelNotSupportedError"),new Q(51,309,310,0,0,0,Gb.IC,5,"BB_SensitivityApplicationLabelDisabledError"),new Q(52,311,312,0,0,0,Gb.IC,5,"BB_SensitivityApplicationMandatoryConflictError"),new Q(53,
0,0,0,0,0,Gb.IC,5,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new Q(54,0,0,0,0,0,Gb.IC,5,"BB_SensitivityApplicationSetLabelError"),new Q(55,qb?2470:2119,qb?2468:2120,qb?2469:2121,2124,qb?2467:0,Gb.xp,5,"BB_ExternalWorkbookLinksPromptEnableContent","Warning_MessageBar_16",qb?2512:0),new Q(56,297,298,0,0,0,Gb.xp,0,"BB_NetworkDown"),new Q(57,318,319,320,0,0,Gb.xp,2,"BB_DefaultToViewDueToCogs"),new Q(58,1815,1816,1817,0,0,Gb.xp,1,"BB_RefreshLinkedEntityErrorBar"),new Q(59,1792,1793,1794,
1795,0,Gb.xp,1,"BB_LinkedEntitiesUntrustedImagesDisabled"),new R(60,250,0,0,0,Gb.xp,5,"BB_CanvasHealth"),new Q(61,1017,1018,1314,0,1019,Gb.xp,5,"BB_MismatchedFileFormatConverted"),new Q(62,2238,0,2240,0,0,Gb.xp,5,"BB_OptimizeWorkbook"),new Q(63,321,322,0,0,323,Gb.xp,0,"BB_NovModePostDepreciation"),new Q(64,0,0,0,0,0,Gb.xp,0,"BB_OfficeScriptsRunning"),new Q(65,2214,2215,0,0,2217,Gb.xp,0,"BB_PowerQueryRefreshDataSourceNotSupported"),new Q(66,324,325,0,0,326,Gb.xp,5,"BB_ReadOnlyPivotTable"),new Q(67,
2214,2216,0,0,2217,Gb.xp,0,"BB_PowerQueryRefreshHostNotSupported"),new Q(68,1057,m.a.uGc?1059:1058,1056,0,0,Gb.xp,4,"BB_RefreshPageAfterEnablingTheExtension"),new Q(69,0,0,0,0,0,Gb.xp,0,"BB_MsFormsDataSyncStatus"),new Q(70,0,0,0,0,U.EwaSettings.isChangeGateEnabled("OfficeVSO:8683561_DataCleansingNewBusinessBarStrings")?2485:0,Gb.IC,5,"BB_DataCleansingSuggestions",U.EwaSettings.isChangeGateEnabled("OfficeVSO:8721279_DataCleansingBusinessBarIcon")?Object(nb.a)():void 0),new R(71,2324,0,0,0,Gb.xp,4,
"BB_EditInMiniWAC","EditExcel_16"),new Q(72,2326,2327,2325,0,0,Gb.IC,5,"BB_PowerQueryUnsupportedTeams"),new Q(73,2326,2328,0,0,2217,Gb.IC,5,"BB_PowerQueryEnableThirdPartyCookies"),new Q(74,2487,2488,2489,0,0,Gb.IC,5,"BB_ExternalConnectionsEnableContentRefreshOnOpen"),new Q(75,0,0,0,0,0,Gb.IC,5,"BB_ApplicationNotification")])}}Gb.vva=ma.a.oli;Gb.IC=ma.a.qli;Gb.xp=ma.a.pli;Gb.M8e=null;Object(y.a)(Gb,"BusinessBarControl",x.a,[59])},1365:function(y,x,a){a.d(x,"a",function(){return za});y=a(0);var c=a(2),
b=a(14),f=a(34),r=a(96),d=a(17),k=a(158),t=a(353);x=a(80);var m=a(10),e=a(87),w=a(5),l=a(97),u=a(527);class n{constructor(xa,fa){this.helpId=this.helpText=this.imageAltText=this.urlValue=this.longDescription=this.convertToDomainName=this.cardViewManager=null;this.$=fa;this.parentElement=xa}J0h(){const xa=this.K0h();u.a(this.$,243,242,0,fa=>{this.cardViewManager=fa;fa.eLk(this.parentElement,xa)})}QOf(){this.cardViewManager&&this.cardViewManager.Wkb(-1,-1,this.parentElement)}K0h(){const xa={layoutId:"AutoDetectTooltip"};
xa.description=this.longDescription;xa.convertToDomainName=this.convertToDomainName;xa.longDescription=this.longDescription;xa.urlValue=this.urlValue;xa.imageAltText=this.imageAltText;xa.helpText=this.helpText;xa.helpId=this.helpId;return xa}}Object(y.a)(n,"AutoDetectCardManager",null,[]);var v=a(68),B=a(241),z=a(31),C=a(286),D=a(19),J=a(59);class W extends x.a{constructor(xa,fa,V){super();this.fj=ba=>{if(ba.Qh.id===this.gXa.firstChild.id){ba=this.F6e;const la={};la.Id=ba.AHb;this.Ls.Ovd(la,!0,ba);
this.gXa.removeChild(this.gXa.firstChild);return!0}return!1};this.F6e=xa;this.Ls=fa;this.gXa=document.createElement("div");this.gXa.className="clip16x16";this.ZJa=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',z.a.Xq("autodetectid"+this.F6e.left),D.a.VCd,J.a.$m(11));V.hr(this.gXa,this.ZJa);xa=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");C.a.instance.ya(d.a.click,xa,this.fj)}get domElement(){return this.gXa}dispose(){if(this.gXa){const xa=
document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");C.a.instance.Na(d.a.click,xa,this.fj)}super.dispose()}static get aNh(){return"clip16x16"}}Object(y.a)(W,"AutoDetectColumnHeaderButton",x.a,[]);var N=a(1),M=a(1188),Q=a(13),R=a(24),O=a(227);class U extends x.a{constructor(xa,fa,V){super();this.ji=null;this.$=xa;this.da=R.f(xa);this.Ls=fa;this.ji=V;this.Bud=new O.a}dispose(){super.dispose()}gci(xa){for(const fa of this.da.T3)for(const V of fa){const ba=V,la=ba.iD,Ta=M.a(ba.Rwa);this.Fth(xa,
Ta,la);ba.YLg(Ta)}}Fth(xa,fa,V){if(fa.length){var ba=V.length;V[ba-1]<xa.left||(V=Q.HelperMethods.KJ(new B.a(V),0,ba,xa.left,Q.HelperMethods.$R),0>V||!(fa=fa[V]))||(this.da.rtl?fa.classList.add(v.ob):fa.classList.add(v.nb),this.Bud.Vg(xa.left)||this.Bud.add(xa.left,new W(xa,this.Ls,this.ji)),xa=this.Bud.ma(xa.left).domElement,!fa.getElementsByClassName(W.aNh).length&&this.VPk(fa)&&fa.appendChild(xa))}}VPk(xa){const fa=parseInt(xa.style.width,10);var V=document.querySelector(".ewrch-col-cellsel")?
"bold":"normal";V=U.t2h(V);xa=gridRenderer.CanvasRendererGlobals.measureTextWidth(this.ji.tTi(xa.firstChild.innerHTML),V,!0,N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1));return 18.4<fa-(fa/2+xa/2)?!0:!1}static t2h(xa){return`${"normal"} ${"normal"} ${xa} ${"10pt"}/${"normal"} ${'"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif'}`}}Object(y.a)(U,"AutoDetectColumnHeaderManager",x.a,[]);var K=a(491),F=a(26),I=a(77),P=a(161),Y=a(16),ea=a(12),Ba=a(103),Fa=a(72);
class za extends x.a{constructor(xa,fa,V,ba,la){super();this.isMac=f.a.isMac;this.ucb=-1;this.lrc=null;this.JGa=-1;this.G1a=this.hIc=this.Gqe=this.aLa=this.G6e=!1;this.D3=null;this.Am=()=>{this.iKa&&this.da&&this.T1()};this.Li=()=>{this.jD()};this.fj=()=>{this.kWa();R.f(this.$).zp(!0,!1)};this.nMa=(Ea,sa)=>{sa?(this.E1g(this.lrc),this.kSg()):(Ea=[29],this.da.rh.zq(Ea),this.da.rh.Vs(null,Ea),this.D3&&this.D3.QOf())};this.Rp=()=>{this.Hmb()&&this.nq.hide();1===this.da.ha.wk&&this.T1()};this.oE=()=>
{const Ea=this.da.ha.wk;this.da.ha.qa.activeCell&&1===Ea&&this.T1()};this.onKeyUp=Ea=>this.cJc?this.aLa?!1:17===Ea.La.keyCode&&this.Gqe?(this.G1a?(this.kSg(),this.Etb()):this.SLg(),!0):!1:this.aLa=!1;this.onKeyDown=Ea=>{if(!this.cJc)return this.aLa=!1;this.Gqe=!1;this.aLa=Ea.ctrlKey;switch(Ea.La.keyCode){case 27:return this.G1a?(this.nMa(null,!1),this.Etb()):this.D3&&(this.D3.QOf(),this.SLg()),!0;case 13:if(this.G1a)return this.G1a=!1,this.kWa(),!0;break;case 17:return this.Gqe=!0}return!1};const {AutoDetectActionButton:Ta}=
a(1414);this.$=xa;this.BHb=N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AutoDetectRichTooltip",!1);fa||b.ULS.sendTraceTag(537166983,0,15,"AutoDetectManager: SVG icons are enabled, but svgIconProvider is null");this.Ls=ba;ba.b1b();this.nq=new Ta(xa,fa,this.fj,V,"");this.tHh=new U(this.$,ba,la);this.da=R.f(this.$);this.da.ha.VW(this.Am);this.da.sh.aGb(this.Am);this.da.Mz(this.oE);xa.Lp(this.Li);xa.hI(this.Rp);this.gridBlockManager=Object(k.a)(7,this.da.za);this.oD=xa.frame.PH;this.T1()}get Pi(){return this.nq.domElement(1)}get cJc(){const xa=
this.nq.domElement(za.Yia);return xa?Y.DOMElementExtensions.isVisible(xa):!1}get iKa(){return this.$.isEditMode&&N.EwaSettings.Ra(128)&&N.EwaSettings.Ra(131)&&(new P.a(this.$.sa)).Dn?!1:-1!==this.JGa}dispose(){this.da&&this.da.ha.UY(this.Am);if(this.$){const xa=this.$;xa.Au(this.Li);xa.LK(this.Rp);R.f(xa).xE(this.oE)}r.a.Ng(this.nq);this.oD=this.$=this.da=this.nq=null;super.dispose()}jD(){this.nMa(null,!1);this.ucb=-1;this.nq.hide();this.j1k();this.G1a=!1}Etb(){this.nq.getButton(za.Yia).L3b();this.G1a=
!1}SLg(){this.nq.getButton(za.Yia).Nrb();this.E1g(this.lrc);this.G1a=!0;N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)?void l.a.hj(w.l).then(xa=>{xa.xba(ea.a.instance.ia(1751))}):this.$.ka.Lh(211,xa=>{xa.xba(ea.a.instance.ia(1751))})}onAutoDetectUIShown(){if(this.iKa&&-1!==this.ucb)this.Ls.onAutoDetectUIShown()}uHh(xa){var fa=new F.Range(1===xa.top?1:xa.top-1,xa.left,xa.bottom,xa.right,!0,!1);fa=this.da.getRangeInformation(fa);for(const V of fa)if(Object(t.a)(K.AutoDetectRange,
V)&&this.oEc(xa,!1,V))return!0;return!1}kWa(){if(this.iKa&&-1!==this.ucb){this.nq.getButton(za.Yia).Nrb();var xa={};xa.Id=this.JGa;xa.StringId=null;this.Ls.Ovd(xa,!0,this.lrc);b.ULS.sendTraceTag(594612633,0,50,"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)");xa=[Object(c.a)(new Fa.a,{name:"Domain",int64:this.JGa})];Ba.a("AssistedAutoConvertMenuConvertClicked",void 0,void 0,xa);this.JGa=-1}}TDi(){let xa=ea.a.instance.ia(1747);if(-1!==this.JGa){xa+=" ";try{xa+=this.Ls.GWb(this.JGa.toString())}catch(fa){b.ULS.sendTraceTag(537166982,
0,10,`AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain ${this.JGa}`)}}xa+=" ";return xa=this.BHb?xa+ea.a.instance.ia(1750):xa+ea.a.instance.ia(this.isMac?1749:1748)}kSg(){this.BHb&&(this.D3||(this.D3=new n(this.Pi,this.$),this.D3.convertToDomainName=ea.a.instance.ia(1752),this.D3.urlValue="https://support.content.office.net/en-us/media/758743e7-a2ca-42db-9f43-a45b05b1b077.png",this.D3.imageAltText=ea.a.instance.ia(1754),this.D3.helpId="HID_DataTypes_Wolfram",this.D3.helpText=
ea.a.instance.ia(1753)),this.D3.longDescription=this.Ls.Hue(this.ucb.toString()),this.D3.J0h())}oEc(xa,fa,V){if((new F.Range(V.top,V.left,V.bottom===m.a.gl?V.bottom:V.bottom+1,V.right,!0,!1)).yi(xa)){if(fa){if(V&&V.AHb!==this.ucb){this.ucb=V.AHb;xa=V.AHb.toString();fa=this.BHb?"":this.Ls.Hue(xa);const ba=this.Ls.V6i(xa);this.nq.Vxb(this.Ls.GWb(xa),fa,ba,za.Yia)}this.JGa=V.AHb;this.lrc=V}return!0}return!1}T1(){if(this.Ls){var xa=this.da.ha.wk;if(this.gridBlockManager&&this.gridBlockManager.rOd){var fa=
this.da.ha.qa.activeCell,V=!this.gridBlockManager.yx(fa),ba=this.da.getRangeInformation(this.da.Hp);for(const la of ba)if(Object(t.a)(K.AutoDetectRange,la))switch(ba=la,ba.bTh){case 3:if(this.oEc(fa,!0,ba)){if(1!==xa||V){this.jD();return}b.ULS.sendTraceTag(537166981,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.Jee();this.nq.oqa(fa,this.nMa);this.G6e||(this.G6e=!0,this.onAutoDetectUIShown());return}break;case 2:case 1:(N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.LoadClassifier",
!1)||N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.PasteClassifier",!1))&&this.tHh.gci(ba);break;default:b.ULS.sendTraceTag(537166980,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}}this.jD()}}E1g(xa){const fa=[29];this.da.rh.Vs(xa,fa);this.da.rh.rw(fa)}Hmb(){return this.$.ea.isNamedObjectViewMode&&I.f(this.$.na)}Jee(){this.BHb&&!this.hIc&&this.oD&&(this.oD.yD(d.a.zi,this.$.domElement,this.onKeyDown,!0),this.oD.yD(d.a.Rj,this.$.domElement,
this.onKeyUp,!0),this.hIc=!0)}j1k(){this.BHb&&this.hIc&&this.oD&&(this.oD.KD(d.a.zi,this.$.domElement,this.onKeyDown,!0),this.oD.KD(d.a.Rj,this.$.domElement,this.onKeyUp,!0),this.hIc=!1)}static get Yia(){return 1}static jGi(xa){return ea.a.instance.ia(1808)+e.a.space+xa}}Object(y.a)(za,"AutoDetectManager",x.a,[])},1370:function(y,x,a){a.r(x);a.d(x,"BusinessBarManager",function(){return I});y=a(179);x=a(0);var c=a(14),b=a(6),f=a(96),r=a(34),d=a(38),k=a(80),t;(function(P){P[P.unableToRefreshLock=0]=
"unableToRefreshLock";P[P.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";P[P.workbookAlmostTooLarge=2]="workbookAlmostTooLarge";P[P.workbookTooLarge=3]="workbookTooLarge";P[P.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";P[P.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";P[P.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";P[P.unsupportedFeatures=7]="unsupportedFeatures";P[P.collabDataAndDataStringsLocaleMismatch=
8]="collabDataAndDataStringsLocaleMismatch";P[P.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";P[P.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";P[P.lastGenericStatusError=11]="lastGenericStatusError";P[P.scratchPadWarning=12]="scratchPadWarning";P[P.authenticationLost=13]="authenticationLost";P[P.odfCompatibilityIssues=14]="odfCompatibilityIssues";P[P.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";P[P.workbookIsIrmProtected=16]="workbookIsIrmProtected";
P[P.biFeatureNotAvailable=17]="biFeatureNotAvailable";P[P.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";P[P.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";P[P.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";P[P.transientServerCommunicationFailures=21]="transientServerCommunicationFailures";P[P.editAttemptInReadOnly=22]="editAttemptInReadOnly";P[P.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";P[P.unsupportedBrowser=
24]="unsupportedBrowser";P[P.readOnlyPermissions=25]="readOnlyPermissions";P[P.documentIsIrmProtectedWarning=26]="documentIsIrmProtectedWarning";P[P.policyWarningMessage=27]="policyWarningMessage";P[P.workingOnIt=28]="workingOnIt";P[P.passwordProtectedWorkbookLockedForEdit=29]="passwordProtectedWorkbookLockedForEdit";P[P.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";P[P.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";P[P.legacySharedWorkbookEditWarningBB=32]="legacySharedWorkbookEditWarningBB";
P[P.legacyConnectionsBB=33]="legacyConnectionsBB";P[P.tooManyLoadBlockingFloatingObjectsBB=34]="tooManyLoadBlockingFloatingObjectsBB";P[P.groupedSlicersBB=35]="groupedSlicersBB";P[P.thirdPartyAddinDisabled=36]="thirdPartyAddinDisabled";P[P.financeLinkedEntityDisclaimerBar=37]="financeLinkedEntityDisclaimerBar";P[P.wolframDeprecationAlertBar=38]="wolframDeprecationAlertBar";P[P.wacGdprNotice=39]="wacGdprNotice";P[P.automaticSensitivityLabel=40]="automaticSensitivityLabel";P[P.recommendedSensitivityLabel=
41]="recommendedSensitivityLabel";P[P.mandatorySensitivityLabel=42]="mandatorySensitivityLabel";P[P.localStorageDisabled=43]="localStorageDisabled";P[P.autoRefreshDisabled=44]="autoRefreshDisabled";P[P.corruptedFileRepaired=45]="corruptedFileRepaired";P[P.corruptedOdsFileRepaired=46]="corruptedOdsFileRepaired";P[P.minorVersionLimitReached=47]="minorVersionLimitReached";P[P.sensitivityApplicationGenericError=48]="sensitivityApplicationGenericError";P[P.sensitivityApplicationTooLargeFileError=49]="sensitivityApplicationTooLargeFileError";
P[P.sensitivityApplicationLabelNotSupportedError=50]="sensitivityApplicationLabelNotSupportedError";P[P.sensitivityApplicationLabelDisabledError=51]="sensitivityApplicationLabelDisabledError";P[P.sensitivityApplicationMandatoryConflictError=52]="sensitivityApplicationMandatoryConflictError";P[P.sensitivityApplicationMinorVersionLimitReachedError=53]="sensitivityApplicationMinorVersionLimitReachedError";P[P.sensitivityApplicationSetLabelError=54]="sensitivityApplicationSetLabelError";P[P.promptEnableExternalLinks=
55]="promptEnableExternalLinks";P[P.networkDown=56]="networkDown";P[P.defaultToViewDueToCogs=57]="defaultToViewDueToCogs";P[P.refreshLinkedEntityErrorBar=58]="refreshLinkedEntityErrorBar";P[P.promptEnableLinkedEntitiesUntrustedImages=59]="promptEnableLinkedEntitiesUntrustedImages";P[P.canvasHealth=60]="canvasHealth";P[P.mismatchedFileFormatConverted=61]="mismatchedFileFormatConverted";P[P.optimizeWorkbook=62]="optimizeWorkbook";P[P.novModePostDepreciation=63]="novModePostDepreciation";P[P.officeScriptsRunning=
64]="officeScriptsRunning";P[P.powerQueryRefreshDataSourceNotSupported=65]="powerQueryRefreshDataSourceNotSupported";P[P.readOnlyPivotTable=66]="readOnlyPivotTable";P[P.powerQueryRefreshHostNotSupported=67]="powerQueryRefreshHostNotSupported";P[P.refreshPageAfterEnablingTheExtension=68]="refreshPageAfterEnablingTheExtension";P[P.msFormsDataSyncStatus=69]="msFormsDataSyncStatus";P[P.dataCleansingSuggestions=70]="dataCleansingSuggestions";P[P.editInMiniWAC=71]="editInMiniWAC";P[P.powerQueryUnsupportedTeams=
72]="powerQueryUnsupportedTeams";P[P.powerQueryEnableThirdPartyCookies=73]="powerQueryEnableThirdPartyCookies";P[P.externalConnectionsEnableContentRefreshOnOpen=74]="externalConnectionsEnableContentRefreshOnOpen";P[P.applicationNotification=75]="applicationNotification";P[P.count=76]="count"})(t||(t={}));Object(x.b)("EwaBusinessBarEntryType",t);var m=a(7),e=a(1177);class w extends Sys.EventArgs{constructor(P,Y,ea){ea=void 0===ea?null:ea;super();this.RFa=P;this.Xzd=Y;this.data=ea}}Object(x.a)(w,"BusinessBarEntryDisplayChangedEventArgs",
Sys.EventArgs,[]);var l=a(1180),u=a(1178),n=a(1182);a(1181);var v=a(1175),B=a(546),z=a(40),C=a(764),D=a(35),J=a(1),W=a(24),N=a(70),M=a(75),Q=a(1064),R=a(97),O=a(5),U=a(1179),K=a(93),F;let I=F=class extends k.a{constructor(P,Y){Y=void 0===Y?!P.ina:Y;super();this.Og=new d.a;this.n_=null;this.B8c=[];this.kMc=()=>{this.$.pa.E_a?this.removeEntry(13):this.xm(13,null)};this.Yo=(ea,Ba)=>{for(let Fa=0,za=F.GAc().length;Fa<za;Fa++)ea=F.GAc()[Fa],this.removeEntry(ea);Ba.context&&0<Ba.context.communicationErrorRetryCount&&
(c.ULS.sendTraceTag(537170240,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),this.removeEntry(21));this.Fmk()};this.Ay=(ea,Ba)=>{var Fa;ea=this.Sti(Ba.errors);let za=[];for(let fa=0,V=ea.length;fa<V;++fa){const ba=ea[fa];if(1===ba.Type&&ba.Appearance&32)za=this.C2i(ba,za);else if(Ba.xxk){c.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");
var xa=(null===(Fa=Ba.context)||void 0===Fa?0:Fa.stopwatch)?Ba.context.stopwatch.ii:-1;5E3>xa?c.ULS.sendTraceTag(537170208,0,50,`OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = ${xa}ms).`):b.AFrameworkApplication.kpj()||this.Pwh(ba,Ba.context.methodName)}xa=[...F.GAc()];for(let la=0,Ta=za.length;la<Ta;++la){const Ea=za[la];this.xm(Ea,ba);Array.remove(xa,Ea)}for(let la=0,Ta=xa.length;la<Ta;++la)this.removeEntry(xa[la])}};
this.Oi=(ea,Ba)=>{this.Li(ea,Ba)};this.Li=()=>{const ea=this.$.ea;ea.Ph||ea.Hl()||(this.dfe(),this.B8c.length=0)};this.xj=(ea,Ba)=>{this.$.ea.Hl()&&!Ba.W5||this.dRf(Ba.W5)};this.f0b=()=>{const ea=this.$.userOperationManager.tAc();ea&&ea.operation.flags&1&&this.sRg()};this.eig=()=>{this.sRg()};this.ol=()=>{this.Uaf();this.GRg()};this.WI=()=>{if(this.$.Tna&&this.$.ea.Hl()&&this.$.ea.Ph)if(this.$.ea.isEditMode)this.removeEntry(45),this.removeEntry(12),this.removeEntry(29),this.removeEntry(30),this.removeEntry(31),
this.removeEntry(32),this.removeEntry(34),this.removeEntry(22),this.removeEntry(57);else{const ea=O.Tb.Ha()?R.a.Zg(O.Tb):this.$.ka.Ug(331);ea&&ea.V_||this.removeEntry(55);this.removeEntry(5)}};this.$=P;this.qdb=Y;a(1412);this.kGh();b.AFrameworkApplication.$i&&b.AFrameworkApplication.$i.PFb(this);this.vcb=Array(76);for(let ea=0;76>ea;ea++)this.vcb[ea]=null;this.Bp=C.EcmaDateClock.instance;this.Z1f=this.Bp.Wh.getTime();Y&&(Y=P.pa,Y.WW(this.Ay),Y.iI(this.Yo),Y.XFb(this.kMc),Y.Mcb(this.kMc),P.ea.uq(this.Oi),
P.ea.Xy(this.ol),P.nr(this.xj),P.Lp(this.Li),P.ea.JJ(this.WI),P.userOperationManager.px(this.f0b),J.EwaSettings.Ra(158)&&P.ea.sn.get(45)&&b.AFrameworkApplication.fa.la("SupportsPolicies")||this.JMf(),this.dRf(N.c(P)))}JMf(){D.a.rx(this.$.ea.oP)&&this.Ay(this,new B.a(this.$.ea.oP,null,!1,-1,-1,-1,-1,"",-1,"",-1))}wxh(P){this.Og.addHandler("bBarAttachedOrDetached",P)}get gBd(){return this.B8c}get domElement(){return this.n_?this.n_.domElement:null}dispose(){if(this.$){const P=this.$,Y=P.pa;Y.VY(this.Ay);
Y.MK(this.Yo);Y.wSc(this.kMc);Y.X2b(this.kMc);P.ea.pq(this.Oi);P.ea.pA(this.ol);P.Pr(this.xj);P.Au(this.Li);P.ea.GH(this.WI);P.userOperationManager.Hv(this.f0b);W.f(P).sh.ev(this.eig)}f.a.Ng(this.n_);this.$=this.n_=null;super.dispose()}efj(P){switch(P){case 4:case 5:case 11:case 55:case 59:case 7:case 37:case 38:case 71:return!0;default:return!1}}cwh(P){switch(P.id){case 16:break;default:return}this.xm(75,null,null,null,{entryToAdd:P})}xm(P,Y,ea,Ba,Fa){ea=void 0===ea?null:ea;Ba=void 0===Ba?null:Ba;
Fa=void 0===Fa?null:Fa;if(!this.$.isMobileMode||this.efj(P))this.qdb&&!this.dO(P)&&(this.vcb[P]=this.Bp.ara,this.n_.eF(P,Y,Ba,Fa),this.Og.raiseEvent("bBarAttachedOrDetached",new w(P,!0,ea))),Y&&32===Y.Appearance&&M.a(this.$).ij.uoa(Y)}rRg(P,Y,ea,Ba){c.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");v.a.initialize(P,Y,ea,Ba);this.xm(39,null)}BKk(P,Y,ea,Ba){e.a.initialize(P,Y,ea,Ba);this.xm(40,null)}hNk(P,Y,ea,Ba){u.a.initialize(P,Y,ea,Ba);this.xm(41,null)}fLk(P,Y,ea,Ba,
Fa){U.a.initialize(P,Y,ea,Ba,Fa);this.xm(70,null)}qMk(P,Y,ea,Ba){l.a.initialize(P,Y,ea,Ba);this.xm(42,null)}rNk(P,Y,ea,Ba){n.a.initialize(P,Y,ea,Ba);this.xm(54,null)}removeEntry(P){this.qdb&&(J.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170251,0,50,`Removing entry from BB: ${Enum.toString(t,P)}`),this.vcb[P]=null,this.n_.removeEntry(P)&&this.Og.raiseEvent("bBarAttachedOrDetached",new w(P,!1)))}N5(P){return this.qdb?this.n_.N5(P):!1}dO(P){return this.qdb?
this.n_.dO(P):!1}Hpb(){c.ULS.sendTraceTag(537170248,0,50,"Network disconnect notification received from the app")}cZb(){c.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");this.removeEntry(21)}kGh(){const {BusinessBarControl:P}=a(1347);if(this.qdb&&!this.n_){W.f(this.$).sh.nv(this.eig);var Y=document.getElementById(this.$.$h+m.a.O8e);this.n_=new P(this.$,Y)}}dfe(){this.qdb&&this.n_.dfe()}Fmk(){if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){const Y=
this.Bp.ara;if(3E5<=Y-this.Z1f){this.Z1f=Y;for(let ea=0;76>ea;ea++){var P=this.vcb[ea];if(P&&(P=Y-P,3E5<=P)){const Ba=Enum.toString(t,ea);c.ULS.sendTraceTag(537170241,0,50,`${"OnWebMethodSuccess"}: entry [${Ba}] was activated but not turned off for ${P} Millis`)}}}}}Sti(P){const Y=[];for(const ea of P)switch(ea.MessageId){case -113742550:const Ba=[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941];(this.$.ea.isNamedObjectViewMode||D.a.Qn(P,Ba))&&Y.push(-113742550)}return D.a.mS(P,
Y)}C2i(P,Y){switch(P.MessageId){case 2113407564:const ea=D.a.veb([1821390342,-943219229,-502303485,1437034227]);for(let Ba=0;Ba<ea.length;Ba++)ea[Ba].HelpTopicId=P.HelpTopicId,ea[Ba].HelpDescription=P.HelpDescription,this.B8c.push(ea[Ba])}switch(P.MessageId){case -395951567:this.xm(6,P);break;case 1643490758:this.xm(4,P);break;case -907264831:this.xm(5,P);break;case 757111532:case 2113407564:this.xm(7,P);break;case 2010656511:this.xm(15,P);break;case 1321660996:this.$.Tjf=!0;this.xm(8,P);break;case 526339737:this.$.Tjf=
!0;this.xm(9,P);break;case -407088521:this.xm(10,P);break;case 1756116017:this.xm(14,P);break;case -1703455218:this.xm(17,P);break;case 1393475740:this.xm(25,P);break;case -949523941:this.xm(26,P);break;case 1779381952:Y.push(44);break;case 1421575100:this.xm(45,P);break;case 613676060:this.xm(46,P);break;case 1233668252:this.xm(61,P);break;case 1911608588:P=!!(this.$.wj&64);!this.$.ea.Hl()&&P&&Y.push(29);break;case 1544494907:break;case -655555355:Y.push(this.CXd()?1:0);break;case -1221382671:Y.push(2);
break;case 1662282929:Y.push(3);break;case 104919273:this.$.ea.Hl()||Y.push(30);break;case -689453604:P=!!(this.$.wj&64);this.$.ea.ZNf=!0;!this.$.ea.Hl()&&P&&Y.push(31);break;case 157762400:this.$.ea.VFc=!0;!this.$.ea.Hl()&&this.$.wj&64&&!this.$.isEditMode&&Y.push(32);break;case -1125398042:!this.$.ea.Hl()&&this.$.wj&64&&!this.$.isEditMode&&Y.push(34);break;case -73730134:!this.$.ea.Hl()&&this.$.wj&64&&Y.push(33);break;case -293349236:Y.push(65);break;case 1580811823:Y.push(67);break;case -37299333:break;
case 136737622:Y.push(47);break;case -1780327030:this.xm(55,P);break;case -113742550:this.xm(57,P);break;case -260312420:this.$.ea.Hl()||Y.push(66);break;case 784737213:this.$.ea.Hl()||Y.push(70);break;case -156954846:this.xm(74,P);break;default:this.xm(11,P)}return Y}T9i(){if(b.AFrameworkApplication.fa.la("WildFireExcelBizBar")&&!Q.a.$kj(Q.a.mBf(1))&&(r.a.hw||r.a.Un))if(J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",!1))void R.a.resolve(O.ab,{va:1}).then(()=>
this.xm(20,null));else{const P=Object(K.d)(R.a.resolve(O.ab,{va:1}));z.TaskExtensions.Ua(P,()=>{this.xm(20,null)},this.xa,3)}}d9i(P){P||3!==this.$.workbookContext.WorkbookNovType||this.xm(63,null)}get A2k(){return b.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UnsupportedBrowserVersionSoftBlockIsEnabled",!1)}Q9i(){this.A2k&&r.a.qqj&&this.xm(24,null)}dRf(P){(!P&&!this.$.printingEnabled||this.$.Tj.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&
(c.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),this.xm(16,null));this.T9i();this.Uaf();this.GRg();this.d9i(P);this.Q9i()}Uaf(){this.$.workbookContext.Options&32768&&this.zLk()}zLk(){this.vcb[37]||this.xm(37,null)}aOk(){this.vcb[38]||this.xm(38,null)}GRg(){this.$.workbookContext.Options&524288&&this.xm(59,null)}zqe(P,Y){this.xm(58,P,null,Y)}Vjc(P,Y){var ea=null,Ba=null;ea=void 0===ea?null:ea;Ba=void 0===Ba?null:Ba;Y=void 0===Y?null:Y;this.n_.dO(P)?
this.n_.Ixb(P,Y):this.xm(P,null,ea,Ba,Y)}sRg(){this.$.wj&8&&this.xm(12,null)}CXd(){const P=O.a.Ha()?R.a.Zg(O.a):this.$.ka.Ug(38);return P?P.yue:!1}Pwh(P,Y){if(!this.dO(21)&&-1387426400!==P.MessageId){c.ULS.sendTraceTag(537170204,0,50,"BusinessBar: raising the transient communication failures notification.");const ea={};ea.FailedMethod=Y;this.xm(21,P,ea)}}static GAc(){return F.D2e||(F.D2e=[0,1,2,3,44])}MHd(P){return this.n_.MHd(P)}};I.D2e=null;I=F=Object(y.__decorate)([Object(R.d)(O.C),Object(y.__param)(0,
Object(O.Lb)())],I);Object(x.a)(I,"BusinessBarManager",k.a,[639,2,155])},1375:function(y,x,a){a.r(x);a.d(x,"NetworkConnectionHealthChecker",function(){return v});y=a(0);var c=a(2),b=a(14),f=a(483),r=a(35),d=a(13),k=a(264);class t{constructor(){this.scenario=null;this.timeElapsed=0;this.isNewSession=!1;this.rawData=null}}Object(y.a)(t,"ConnectionErrorLogInfo",null,[]);var m=a(1191),e=a(1192);class w{constructor(B){this.NPd=[m.a.q8g,m.a.r3c];this.mt=(z,C)=>{this.ZY[C]=z;this.n4i()&&this.xnk("OnNetworkDownImmediatePing"===
z.caller)};this.Lya=B;this.$=B.$;this.ZY={}}etj(){const B=e.a.ZGd(this.mt,"OnNetworkDownImmediatePing",this.$,this.NPd);for(const z of B)z.runTest()}n4i(){for(const B of this.NPd)if(void 0===this.ZY[B]||null===this.ZY[B])return!1;return!0}xnk(B){const z=this.$.Ql.Iga;B&&this.mSk(z);for(var C of this.NPd)this.ZY[C]=Sys.Serialization.JavaScriptSerializer.serialize(this.ZY[C]);B=Date.now();C=this.Lya.zMd(v.bZb).returnValue;const D=this.Lya.zMd(v.g5b).returnValue;this.ZY.isOfflineMode=z;this.ZY.networkDownBBAge=
-1===C?C:B-C;this.ZY.transientServerCommunicationFailuresBBAge=-1===D?D:B-D;this.Lya.businessBar?(this.ZY.isNetworkDownBBShown=this.Lya.businessBar.dO(56).toString(),this.ZY.isServerErrorBBShown=this.Lya.businessBar.dO(21).toString()):(this.ZY.isNetworkDownBBShown="unknown",this.ZY.isServerErrorBBShown="unknown");b.ULS.sendTraceTag(537155224,0,50,`ConnectionHealthTestsRunner.ReportPingResults: ${Sys.Serialization.JavaScriptSerializer.serialize(this.ZY)}`)}mSk(B){const {NetworkConnectionHealthChecker:z}=
a(1375),C={};for(const D of Object.keys(this.ZY)){const J=this.ZY[D];C[J.testName]=J.isSuccess}C.isOfflineMode=B;this.Lya.ose(z.nvd,Sys.Serialization.JavaScriptSerializer.serialize(C))}}Object(y.a)(w,"ConnectionHealthTestsRunner",null,[]);var l=a(97),u=a(5),n=a(1);class v{constructor(B){this.businessBar=this.aob=null;this.Bn=n.EwaSettings.Bn("NetworkConnectionHealthChecker");this.NKj=(z,C)=>{C.Xzd?this.PKj(C):this.OKj(C)};this.Yo=(z,C)=>{z=C.context.methodName;this.aob&&z===this.aob&&(b.ULS.sendTraceTag(537155230,
0,50,`NetworkConnectionHealthChecker.OnWebMethodSuccess: Failed web method "${this.aob}" has now succeeded. Querying local storage for BB showings.`),this.Job(v.g5b,!0),this.aob=null);this.c6f(!1);this.Mpc=!1};this.Ay=(z,C)=>{r.a.Qn(C.errors,[-1387426400])&&!this.Mpc&&(this.Mpc=!0,this.HPg()&&window.performance.mark(v.adg),(new w(this)).etj())};this.DXb=()=>{this.c6f(!0);this.Job(v.bZb,!1);this.Job(v.g5b,!1)};this.qMa=()=>{this.Job(v.bZb,!0)};this.$=B;this.pa=this.$.pa;this.localStorage=new k.a;this.Mpc=
!1;this.Bn?this.$.ea.Bw(this.DXb):n.EwaSettings.fl()?this.$.ea.Jq(this.DXb):this.$.ea.Uq(this.DXb);this.pa.Ql.gGb(this.qMa);this.pa.iI(this.Yo);void l.a.hj(u.C).then(z=>{const C=this;return No(function*(){C.businessBar=z;z.wxh(C.NKj)})});this.pa.WW(this.Ay)}dispose(){this.$&&(this.$.ea&&(this.Bn?this.$.ea.qB(this.DXb):n.EwaSettings.fl()||this.$.ea.dv(this.DXb)),this.pa&&(this.pa.Ql.e3b(this.qMa),this.pa.VY(this.Ay),this.pa.MK(this.Yo)))}PKj(B){const z={};z.Timestamp=Date.now().toString();switch(B.RFa){case 21:this.aob=
B.data.FailedMethod;z.FailedMethod=this.aob;this.ose(v.g5b,JSON.stringify(z));break;case 56:this.ose(v.bZb,JSON.stringify(z))}}OKj(B){switch(B.RFa){case 21:this.Job(v.g5b,!0);break;case 56:this.Job(v.bZb,!0)}}ose(B,z){try{this.localStorage.jl()&&this.localStorage.setItem(B,z)}catch(C){b.ULS.sendTraceTag(537155231,0,15,`NetworkConnectionHealthChecker.StoreDataInLocalStorage: Failed to set item to local storage. reason: ${C.message||"Unknown"}`)}}zMd(B){if(this.localStorage.jl()&&(B=this.localStorage.WIa(B))&&
"null"!==B){var z=JSON.parse(B);B=parseInt(z.Timestamp,10);z=Sys.Serialization.JavaScriptSerializer.serialize(z);return{returnValue:B,rawData:z}}return{returnValue:-1,rawData:null}}c6f(B){if(this.localStorage.jl()){const z=this.localStorage.WIa(v.nvd);if(z&&"null"!==z){let C=-1;this.Mpc&&(C=this.fIi(v.adg,v.sJj));b.ULS.sendTraceTag(537155229,0,50,`NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: Ping Results: ${Sys.Serialization.JavaScriptSerializer.serialize(z)}, Period offline: ${C}, New session: ${B}`);
this.localStorage.removeItem(v.nvd)}}}fIi(B,z){if(!this.HPg())return-1;window.performance.measure(z,B);B=window.performance.getEntriesByName(z);return B.length&&B[B.length-1]?B[B.length-1].duration:(b.ULS.sendTraceTag(537155228,0,10,`NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: measure name ${z} returned no measures.`),-1)}Job(B,z){try{let C;const D=(()=>{let J=this.zMd(B);({rawData:C}=J);return J})().returnValue;if(-1!==D){const J=Object(c.a)(new t,{timeElapsed:Date.now()-D,scenario:B,
isNewSession:!z,rawData:C});b.ULS.sendTraceTag(537155227,0,50,`NetworkConnectionHealthChecker.LogNetworkIssueBBShown: ${JSON.stringify(J)}`)}this.localStorage.removeItem(B)}catch(C){b.ULS.sendTraceTag(537155226,0,15,`NetworkConnectionHealthChecker.LogNetworkIssueBBShown: Failed to get item from local storage. reason: ${C.message||"Unknown"}`)}}HPg(){return d.HelperMethods.drd&&f.a.aVa}}v.bZb="NetworkDownBBShown";v.g5b="ServerCommunicationFailureBBShown";v.nvd="ConnectionHealthPingRsults";v.adg="offMoStMa";
v.sJj="offMoDuMea";Object(y.a)(v,"NetworkConnectionHealthChecker",null,[2])},1391:function(y,x,a){a.d(x,"a",function(){return d});y=a(0);var c=a(14),b=a(284);class f{constructor(k,t){this.testName=null;this.startTimeMs=0;this.isSuccess=!1;this.caller=this.errorStatusCode=this.errorMessage=null;this.reqTotalDurationMs=0;this.browserResourceTiming=null;this.testIteration=0;this.testName=k;this.caller=t;this.reset()}reset(){this.isSuccess=!1;this.startTimeMs=-1;this.errorStatusCode=this.errorMessage=
"";this.reqTotalDurationMs=-1;this.browserResourceTiming=null}}Object(y.a)(f,"NetworkTestResult",null,[]);var r=a(681);class d{constructor(k,t,m,e,w){this.url="";this.olb=!1;this.PP=-1;this.testIteration=0;this.baseUrl=m;this.kfg=e;this.EPd=t;this.result=new f(t,w)}runTest(){try{if(this.olb)return c.ULS.sendTraceTag(537155206,0,50,`NetworkTestReq.RunTest: a test for the host ${this.EPd} is already mid way, not starting a new one.`),!1;this.reset();this.olb=!0;this.result.startTimeMs=Date.now();const k=
new b.QueryStringBuilder(this.baseUrl);k.Sda("tid",this.result.startTimeMs.toString());this.url=k.toString();this.Pvk();this.testIteration++;this.result.testIteration=this.testIteration;return!0}catch(k){return this.bOb("Exeption: "+k.message),!1}}reset(){this.url="";this.result.reset();this.olb=!1;this.PP=-1}clearTimeout(){-1!==this.PP&&(window.clearTimeout(this.PP),this.PP=-1)}Pvk(){try{const k=new XMLHttpRequest;k.onreadystatechange=()=>{4===k.readyState&&(200===k.status?this.bvi():this.bOb(`Error when downloading resource. status code: ${k.status}, status text: ${k.statusText}`,
k.status.toString()))};k.onerror=()=>{this.bOb(`Client error when attempting to download resource. status code: ${k.status}, response: ${k.statusText}`)};this.PP=window.setTimeout(()=>{this.PP=-1;this.bOb("Request timeout")},1E4);k.open("GET",this.url,!0);k.send(null)}catch(k){this.bOb("Exeption: "+k.message)}}bvi(){this.olb&&(this.result.reqTotalDurationMs=Date.now()-this.result.startTimeMs,this.clearTimeout(),this.result.browserResourceTiming=r.a(this.url),this.result.isSuccess=!0,this.zpc())}bOb(k,
t){t=void 0===t?null:t;this.olb&&(this.clearTimeout(),this.result.errorMessage=k,this.result.isSuccess=!1,this.result.errorStatusCode=t,this.zpc())}zpc(){this.olb=!1;this.kfg&&this.kfg(this.result,this.EPd)}}Object(y.a)(d,"NetworkTestReq",null,[])},1408:function(y,x,a){function c(ba,la,Ta,Ea,sa,Ya){this.ID=ba;this.type=la;this.Ebl=Ta;this.Sbl=Ea;this.Fbl=sa;this.Tbl=Ya}function b(ba,la){this.value=ba;this.contextId=la}function f(ba,la,Ta,Ea,sa,Ya,bb,ra){this.type=ba;this.l4=la;this.startTime=null==
Ta||void 0==Ta.value?new b(Ta,null):Ta;this.endTime=null==Ea||void 0==Ea.value?new b(Ea,null):Ea;this.bca=null==sa||void 0==sa.value?new b(sa,null):sa;this.rXa=null==Ya||void 0==Ya.value?new b(Ya,null):Ya;this.Tzg=bb;this.operationType=ra}function r(){}function d(ba,la){this.ID=ba;this.Q1f=la}function k(){this.r2=[];this.lvb=this.ovb=null;this.Lba=5E3;this.pvb=0;this.Ipc=[];this.sgb=-1;this.Dte=0}function t(){this.Index=0;this.Data=[];this.aac=!1}function m(ba,la,Ta,Ea,sa,Ya){this.G3c(ba,la,Ta,Ea,
sa,Ya)}function e(ba,la,Ta,Ea,sa,Ya){this.G3c(ba,la,Ta,Ea,sa,Ya)}function w(){this.zza=[];this.tl=[];this.tdb=[];this.Gob=this.Y3a=this.xUa=0;this.duration=this.startTime=null;this.t5d=0;this.vhb={};this.Wdb=-1;this.bgb=0;this.ipb=this.spb=-1}function l(ba,la,Ta,Ea){D(Ea)&&(Ea="relative"==ba.style.position);var sa=0;switch(la){case 1:sa=Ta?parseInt(Ea?ba.style.marginRight.replace("px",""):ba.style.right.replace("px","")):parseInt(Ea?ba.style.marginLeft.replace("px",""):ba.style.left.replace("px",
""));break;case 2:sa=parseInt(Ea?ba.style.marginTop.replace("px",""):ba.style.top.replace("px",""));break;case 3:sa=parseInt(ba.style.height.replace("px",""));break;case 4:sa=parseInt(ba.style.width.replace("px",""));break;case 5:sa=W(ba);break;case 6:sa=parseInt(ba.scrollTop);break;case 7:sa=parseInt(ba.scrollLeft);break;case 8:sa=M(ba)}return sa}function u(ba){return ba*ba*ba}function n(ba){return 3*ba*ba*(1-ba)}function v(ba){return 3*ba*(1-ba)*(1-ba)}function B(ba){return(1-ba)*(1-ba)*(1-ba)}
function z(ba,la,Ta,Ea,sa){return 0*B(sa)+la*v(sa)+Ea*n(sa)+1*u(sa)}function C(ba){return"object"==typeof ba&&ba instanceof Array}function D(ba){return null==ba||void 0==ba}function J(ba,la){null!=document.body.style.opacity?ba.style.opacity=la:ba.style.filter=1==la?"":"alpha(opacity="+String(100*la)+")"}function W(ba){if(null!=document.body.style.opacity)return ba=ba.style.opacity,null!=ba&&""!=ba?parseFloat(ba):1;ba=ba.style.filter;return null!=ba&&""!=ba?parseInt(ba.replace("alpha(opacity=","").replace(")",
""))/100:1}function N(ba,la){la="rotate("+la+"deg)";null!=document.body.style.msTransform?ba.style.msTransform=la:null!=document.body.style.webkitTransform?ba.style.webkitTransform=la:null!=document.body.style.M3d?ba.style.M3d=la:null!=document.body.style.A5d?ba.style.A5d=la:null!=document.body.style.transform&&(ba.style.transform=la)}function M(ba){if(null!=document.body.style.msTransform)var la=ba.style.msTransform;else null!=document.body.style.webkitTransform?la=ba.style.webkitTransform:null!=
document.body.style.M3d?la=ba.style.M3d:null!=document.body.style.A5d?la=ba.style.A5d:null!=document.body.style.transform&&(la=ba.style.transform);if(!la)return 0;la=la.replace("rotate(","");la=la.replace("deg)","");return parseFloat(la)}a.r(x);a.d(x,"WacAnimation",function(){return Q});a.d(x,"WacCurve",function(){return c});a.d(x,"WacCurveType",function(){return R});a.d(x,"WacCurveID",function(){return O});a.d(x,"g_AnimationCurves",function(){return U});a.d(x,"WacIntWrapper",function(){return b});
a.d(x,"WacKeyFrame",function(){return f});a.d(x,"g_numAnimationAttributes",function(){return K});a.d(x,"AnimRelativeTo",function(){return F});a.d(x,"WacKeyframeType",function(){return I});a.d(x,"g_AnimationContextVariables",function(){return P});a.d(x,"WacAnimation_ContextVariableManager",function(){return r});a.d(x,"WacAnim",function(){return d});a.d(x,"g_WacAnimations",function(){return Y});a.d(x,"g_WacAnimationEngine",function(){return ea});a.d(x,"g_WacAnimationLogging",function(){return Ba});
a.d(x,"g_WacAnimationThrottleFPS",function(){return Fa});a.d(x,"g_WacAnimationThrottleNumInstance",function(){return za});a.d(x,"WacAnimationEngine",function(){return k});a.d(x,"g_WacRadix",function(){return xa});a.d(x,"WacAnimation_State",function(){return t});a.d(x,"WacAnimation_Object",function(){return m});a.d(x,"WacAnimationUnit",function(){return e});a.d(x,"WacAnimationTelemetry",function(){return w});a.d(x,"g_WacAnimationTelemetry",function(){return fa});a.d(x,"g_LastAnimationData",function(){return V});
a.d(x,"GetCurrentAttributeCssValue",function(){return l});a.d(x,"Bezier1",function(){return u});a.d(x,"Bezier2",function(){return n});a.d(x,"Bezier3",function(){return v});a.d(x,"Bezier4",function(){return B});a.d(x,"CalculateBezier",function(){return z});a.d(x,"IsArrayCheck",function(){return C});a.d(x,"IsNullOrUndef",function(){return D});a.d(x,"SetCssOpacity",function(){return J});a.d(x,"GetCssOpacity",function(){return W});a.d(x,"SetCssRotation",function(){return N});a.d(x,"GetCssRotation",function(){return M});
var Q={},R={Instant:0,hac:1,Linear:2,lL:3},O={Instant:0,hac:1,Linear:2,zs:3,KBe:4,TBe:5,dBe:6,eBe:7,eac:8,fBe:9,r9a:10,PAe:11,OAe:12,NAe:13,QAe:14,RAe:15,SAe:16,TAe:17,UAe:18,sBe:19,HBe:20,lBe:21},U=Array(22);U[O.Instant]=new c(O.Instant,R.Instant,0,0,0,0);U[O.hac]=new c(O.hac,R.hac,0,0,0,0);U[O.Linear]=new c(O.Linear,R.Linear,0,0,0,0);U[O.zs]=new c(O.zs,R.lL,0,0,0,1);U[O.KBe]=new c(O.KBe,R.lL,1,0,1,1);U[O.TBe]=new c(O.TBe,R.lL,0,0,.42,1);U[O.dBe]=new c(O.dBe,R.lL,.83,0,1,1);U[O.eBe]=new c(O.eBe,
R.lL,0,0,.58,1);U[O.eac]=new c(O.eac,R.lL,.42,0,.58,1);U[O.fBe]=new c(O.fBe,R.lL,.1,.25,.75,.9);U[O.r9a]=new c(O.r9a,R.lL,.1,.9,.2,1);U[O.PAe]=new c(O.PAe,R.lL,.1,.9,.2,1);U[O.OAe]=new c(O.OAe,R.lL,.9,.1,.2,1);U[O.NAe]=new c(O.NAe,R.lL,.4,0,0,1);U[O.QAe]=new c(O.QAe,R.lL,.13,.21,.1,.7);U[O.RAe]=new c(O.RAe,R.lL,.02,.33,.38,.77);U[O.SAe]=new c(O.SAe,R.lL,.57,.17,.95,.75);U[O.TAe]=new c(O.TAe,R.lL,0,.19,.07,.72);U[O.UAe]=new c(O.UAe,R.lL,0,0,.95,.37);U[O.sBe]=new c(O.sBe,R.lL,.66,0,.34,1);U[O.HBe]=
new c(O.HBe,R.lL,.8,0,.2,1);U[O.lBe]=new c(O.lBe,R.lL,.8,0,.2,1);f.prototype={type:0,l4:0,startTime:new b(0,null),endTime:new b(0,null),bca:new b(0,null),rXa:new b(0,null),Tzg:0,operationType:0};var K=8;Q.Nj={o8:1,kN:2,Height:3,Width:4,Opacity:5,Z3c:6,Y3c:7,Hfl:8};var F={Initial:0,Cl:1,Absolute:2},I={Zs:0,Add:1};Q.Eyb={$$b:0};var P=Array(1);P[Q.Eyb.$$b]=new b(0,Q.Eyb.$$b);Q.Wcl=r;r.prototype={};r.prototype.SetContextVariable=function(ba,la){P[Q.Eyb[ba]].value=la};Q.ID={aAe:0,iAe:1,kAe:2,mAe:3,lAe:4,
jAe:5,fAe:6,hAe:7,dAe:8,gAe:9,eAe:10,bAe:11,pAe:12,Zze:13,oAe:14,$ze:15,nAe:16,tAe:17,vAe:18,sAe:19,uAe:20,rAe:21,BBe:22,DBe:23,zBe:24,CBe:25,ABe:26,GBe:27,NBe:28,aCe:29,cCe:30,bCe:31,dCe:32,MBe:33,cAe:34,qAe:35,wBe:36,YAe:37,XAe:38,CCe:39,DCe:40,BCe:41};var Y=Array(42);Y[Q.ID.aAe]=new d(Q.ID.aAe,[new f(Q.Nj.Opacity,O.Instant,0,0,null,1,F.Cl,I.Zs)]);Y[Q.ID.iAe]=new d(Q.ID.iAe,[new f(Q.Nj.Opacity,O.Linear,0,0,null,0,F.Absolute,I.Zs),new f(Q.Nj.Opacity,O.Linear,0,50,null,1,F.Cl,I.Zs)]);Y[Q.ID.kAe]=
new d(Q.ID.kAe,[new f(Q.Nj.o8,O.zs,0,167,null,0,F.Cl,I.Add),new f(Q.Nj.kN,O.zs,0,167,null,0,F.Cl,I.Add)]);Y[Q.ID.mAe]=new d(Q.ID.mAe,[new f(Q.Nj.Height,O.zs,0,167,null,0,F.Cl,I.Add),new f(Q.Nj.Width,O.zs,0,167,null,0,F.Cl,I.Add)]);Y[Q.ID.lAe]=new d(Q.ID.lAe,[new f(Q.Nj.Opacity,O.Linear,0,0,null,0,F.Absolute,I.Zs),new f(Q.Nj.Opacity,O.Linear,0,167,null,1,F.Cl,I.Zs)]);Y[Q.ID.jAe]=new d(Q.ID.jAe,[new f(Q.Nj.Opacity,O.Linear,0,167,null,0,F.Cl,I.Zs)]);Y[Q.ID.fAe]=new d(Q.ID.fAe,[new f(Q.Nj.o8,O.zs,0,100,
null,0,F.Cl,I.Add),new f(Q.Nj.kN,O.zs,0,100,null,0,F.Cl,I.Add)]);Y[Q.ID.hAe]=new d(Q.ID.hAe,[new f(Q.Nj.Height,O.zs,0,100,null,0,F.Cl,I.Add),new f(Q.Nj.Width,O.zs,0,100,null,0,F.Cl,I.Add)]);Y[Q.ID.dAe]=new d(Q.ID.dAe,[new f(Q.Nj.Opacity,O.Linear,0,100,null,1,F.Cl,I.Zs)]);Y[Q.ID.gAe]=new d(Q.ID.gAe,[new f(Q.Nj.Opacity,O.Linear,0,0,null,0,F.Absolute,I.Zs),new f(Q.Nj.Opacity,O.Linear,0,100,null,1,F.Cl,I.Zs)]);Y[Q.ID.eAe]=new d(Q.ID.eAe,[new f(Q.Nj.Opacity,O.Linear,0,100,null,0,F.Cl,I.Zs)]);Y[Q.ID.bAe]=
new d(Q.ID.bAe,[new f(Q.Nj.o8,O.zs,0,267,null,0,F.Cl,I.Add),new f(Q.Nj.kN,O.zs,0,267,null,0,F.Cl,I.Add)]);Y[Q.ID.pAe]=new d(Q.ID.pAe,[new f(Q.Nj.Height,O.zs,0,267,null,0,F.Cl,I.Add),new f(Q.Nj.Width,O.zs,0,267,null,0,F.Cl,I.Add)]);Y[Q.ID.Zze]=new d(Q.ID.Zze,[new f(Q.Nj.Opacity,O.Linear,0,267,null,1,F.Cl,I.Zs)]);Y[Q.ID.oAe]=new d(Q.ID.oAe,[new f(Q.Nj.Opacity,O.Linear,0,0,null,0,F.Absolute,I.Zs),new f(Q.Nj.Opacity,O.Linear,0,267,null,1,F.Cl,I.Zs)]);Y[Q.ID.$ze]=new d(Q.ID.$ze,[new f(Q.Nj.Opacity,O.Linear,
0,267,null,0,F.Cl,I.Zs)]);Y[Q.ID.nAe]=new d(Q.ID.nAe,[new f(Q.Nj.Z3c,O.zs,0,267,null,0,F.Cl,I.Add),new f(Q.Nj.Y3c,O.zs,0,267,null,0,F.Cl,I.Add)]);Y[Q.ID.tAe]=new d(Q.ID.tAe,[new f(Q.Nj.o8,O.zs,0,750,null,0,F.Cl,I.Add),new f(Q.Nj.kN,O.zs,0,750,null,0,F.Cl,I.Add)]);Y[Q.ID.vAe]=new d(Q.ID.vAe,[new f(Q.Nj.Height,O.zs,0,750,null,0,F.Cl,I.Add),new f(Q.Nj.Width,O.zs,0,750,null,0,F.Cl,I.Add)]);Y[Q.ID.sAe]=new d(Q.ID.sAe,[new f(Q.Nj.Opacity,O.Linear,0,750,null,1,F.Cl,I.Zs)]);Y[Q.ID.uAe]=new d(Q.ID.uAe,[new f(Q.Nj.Opacity,
O.Linear,0,0,null,0,F.Absolute,I.Zs),new f(Q.Nj.Opacity,O.Linear,0,750,null,1,F.Cl,I.Zs)]);Y[Q.ID.rAe]=new d(Q.ID.rAe,[new f(Q.Nj.Z3c,O.zs,0,1E3,null,0,F.Cl,I.Add),new f(Q.Nj.Y3c,O.zs,0,1E3,null,0,F.Cl,I.Add)]);Y[Q.ID.BBe]=new d(Q.ID.BBe,[new f(Q.Nj.o8,O.zs,0,367,null,0,F.Cl,I.Add),new f(Q.Nj.kN,O.zs,0,367,null,0,F.Cl,I.Add)]);Y[Q.ID.DBe]=new d(Q.ID.DBe,[new f(Q.Nj.Height,O.zs,0,367,null,0,F.Cl,I.Add),new f(Q.Nj.Width,O.zs,0,367,null,0,F.Cl,I.Add)]);Y[Q.ID.zBe]=new d(Q.ID.zBe,[new f(Q.Nj.Opacity,
O.Linear,0,367,null,1,F.Cl,I.Zs)]);Y[Q.ID.CBe]=new d(Q.ID.CBe,[new f(Q.Nj.Opacity,O.Linear,0,0,null,0,F.Absolute,I.Zs),new f(Q.Nj.Opacity,O.Linear,0,367,null,1,F.Cl,I.Zs)]);Y[Q.ID.ABe]=new d(Q.ID.ABe,[new f(Q.Nj.Opacity,O.Linear,0,367,null,0,F.Cl,I.Zs)]);Y[Q.ID.GBe]=new d(Q.ID.GBe,[new f(Q.Nj.Z3c,O.Linear,0,P[Q.Eyb.$$b],null,0,F.Cl,I.Add),new f(Q.Nj.Y3c,O.Linear,0,P[Q.Eyb.$$b],null,0,F.Cl,I.Add)]);Y[Q.ID.NBe]=new d(Q.ID.NBe,[new f(Q.Nj.Opacity,O.Linear,0,0,null,1,F.Cl,I.Zs),new f(Q.Nj.Opacity,O.Linear,
0,50,null,0,F.Cl,I.Zs)]);Y[Q.ID.aCe]=new d(Q.ID.aCe,[new f(Q.Nj.o8,O.zs,0,433,null,0,F.Cl,I.Add),new f(Q.Nj.kN,O.zs,0,433,null,0,F.Cl,I.Add)]);Y[Q.ID.cCe]=new d(Q.ID.cCe,[new f(Q.Nj.Opacity,O.Linear,0,0,null,0,F.Absolute,I.Zs),new f(Q.Nj.Opacity,O.Linear,0,50,null,1,F.Cl,I.Zs),new f(Q.Nj.kN,O.zs,0,0,null,40,F.Cl,I.Add),new f(Q.Nj.kN,O.zs,0,100,null,0,F.Cl,I.Add)]);Y[Q.ID.bCe]=new d(Q.ID.bCe,[new f(Q.Nj.kN,O.Instant,0,0,null,32,F.Cl,I.Add),new f(Q.Nj.kN,O.Instant,0,100,null,32,F.Cl,I.Add),new f(Q.Nj.kN,
O.zs,101,350,null,0,F.Cl,I.Add),new f(Q.Nj.Height,O.Instant,0,0,null,0,F.Absolute,I.Add),new f(Q.Nj.Height,O.Instant,0,100,null,0,F.Absolute,I.Add),new f(Q.Nj.Height,O.zs,101,350,null,0,F.Cl,I.Add),new f(Q.Nj.Opacity,O.Instant,0,0,null,0,F.Absolute,I.Zs),new f(Q.Nj.Opacity,O.Instant,0,100,null,1,F.Cl,I.Zs)]);Y[Q.ID.dCe]=new d(Q.ID.dCe,[new f(Q.Nj.kN,O.zs,0,267,null,32,F.Cl,I.Add),new f(Q.Nj.Height,O.zs,0,267,null,0,F.Absolute,I.Add),new f(Q.Nj.Opacity,O.Linear,0,0,null,1,F.Initial,I.Zs),new f(Q.Nj.Opacity,
O.Linear,0,267,null,0,F.Absolute,I.Zs)]);Y[Q.ID.MBe]=new d(Q.ID.MBe,[new f(Q.Nj.Opacity,O.Linear,0,0,null,0,F.Absolute,I.Zs),new f(Q.Nj.Opacity,O.Linear,0,100,null,0,F.Absolute,I.Zs),new f(Q.Nj.Opacity,O.Linear,101,267,null,1,F.Cl,I.Zs)]);Y[Q.ID.cAe]=new d(Q.ID.cAe,[new f(Q.Nj.o8,O.r9a,0,300,null,0,F.Cl,I.Add),new f(Q.Nj.kN,O.r9a,0,300,null,0,F.Cl,I.Add)]);Y[Q.ID.qAe]=new d(Q.ID.qAe,[new f(Q.Nj.Height,O.r9a,0,300,null,0,F.Cl,I.Add),new f(Q.Nj.Width,O.r9a,0,300,null,0,F.Cl,I.Add)]);Y[Q.ID.wBe]=new d(Q.ID.wBe,
[new f(Q.Nj.o8,O.eac,0,750,null,0,F.Cl,I.Add),new f(Q.Nj.kN,O.eac,0,750,null,0,F.Cl,I.Add)]);Y[Q.ID.YAe]=new d(Q.ID.YAe,[new f(Q.Nj.Opacity,O.Linear,0,0,null,0,F.Absolute,I.Zs),new f(Q.Nj.Opacity,O.Linear,0,200,null,0,F.Absolute,I.Zs),new f(Q.Nj.Opacity,O.zs,201,500,null,1,F.Cl,I.Zs)]);Y[Q.ID.XAe]=new d(Q.ID.XAe,[new f(Q.Nj.o8,O.Linear,0,0,null,0,F.Absolute,I.Add),new f(Q.Nj.kN,O.Linear,0,0,null,0,F.Absolute,I.Add),new f(Q.Nj.o8,O.Linear,0,200,null,0,F.Absolute,I.Add),new f(Q.Nj.kN,O.Linear,0,200,
null,0,F.Absolute,I.Add),new f(Q.Nj.o8,O.zs,201,267,null,0,F.Cl,I.Add),new f(Q.Nj.kN,O.zs,201,267,null,0,F.Cl,I.Add)]);Y[Q.ID.CCe]=new d(Q.ID.CCe,[new f(Q.Nj.o8,O.zs,0,267,null,0,F.Cl,I.Add),new f(Q.Nj.kN,O.zs,0,267,null,0,F.Cl,I.Add)]);Y[Q.ID.DCe]=new d(Q.ID.DCe,[new f(Q.Nj.Opacity,O.Linear,0,0,null,0,F.Absolute,I.Zs),new f(Q.Nj.Opacity,O.Linear,0,267,null,1,F.Cl,I.Zs)]);Y[Q.ID.BCe]=new d(Q.ID.BCe,[new f(Q.Nj.Opacity,O.Linear,0,267,null,0,F.Cl,I.Zs)]);var ea=null,Ba=-1!=window.location.search.indexOf("AnimationLogging=1"),
Fa=0,za=3;window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(ba){window.setTimeout(ba,16)}}();Q.State=t;Q.Object=m;k.prototype={r2:[],ovb:null,lvb:null,Lba:5E3,pvb:0,Ipc:[],sgb:-1,Dte:0};k.prototype.vBe=function(){ea.VBe()};k.prototype.K$g=function(){ea.VBe();ea.XBe()};k.prototype.Zah=function(){null==this.ovb&&null==this.lvb&&0==this.pvb&&
(this.ovb=window.requestAnimationFrame(k.prototype.vBe),ea.UBe(),this.pvb=0,fa.Start())};k.prototype.XBe=function(){fa.abh();ea.WBe();null!=this.ovb&&(this.ovb=null);this.pvb=0;this.Ipc=[];this.r2=[]};k.prototype.a4c=function(ba){this.r2[this.pvb++]=ba};k.prototype.b4c=function(ba){for(var la=0;la<this.r2.length;la++)this.r2[la]==ba&&(this.wah(ba),this.r2[la]=null)};k.prototype.VBe=function(){var ba=!1,la=null;ea.WBe();for(var Ta=0;Ta<this.r2.length;Ta++)null!=this.r2[Ta]&&(D(la)&&(la=this.r2[Ta].currentTime),
this.sgb=Ta,this.r2[Ta].$ah(),ba=!0);this.sgb=-1;ba&&!D(la)&&fa.$7g(new Date-la);ba?(ea.UBe(),window.requestAnimationFrame(k.prototype.vBe)):this.XBe()};k.prototype.HAe=function(ba,la){if(null==ba.id||""==ba.id){var Ta="tempAnimID_"+String(this.Dte);this.Dte++;ba.id=Ta}ba=ba.id+"_"+String(la);Ta=this.Ipc[ba];if(D(Ta)||Ta==this.sgb||null==this.r2[Ta])this.Ipc[ba]=this.sgb;else if(ba=this.r2[Ta],ba.l4.SetAttribute(la,null),null!=ba.w$){la=this.r2[this.sgb];var Ea=ba.w$,sa=ba.extraData,Ya=la.w$,bb=la.extraData;
la.w$=null==Ya?function(){Ea(sa)}:function(){Ea(sa);Ya(bb)};la.extraData=null;ba.w$=null}};k.prototype.wah=function(ba){if(C(ba.element))for(var la=ba.element.length,Ta=0;Ta<la;Ta++){var Ea=ba.element[Ta];0==Ea.id.indexOf("tempAnimID_")&&null==Ea.id}else Ea=ba.element,0==Ea.id.indexOf("tempAnimID_")&&null==Ea.id};k.prototype.WBe=function(){null!=this.lvb&&(window.clearTimeout(this.lvb),this.lvb=null)};k.prototype.UBe=function(){this.lvb=window.setTimeout(k.prototype.K$g,this.Lba)};var xa=10;t.prototype=
{Index:0,Data:[],aac:!1};t.prototype.SetAttribute=function(ba,la){var Ta=this.oBe(ba);-1==Ta?(Ta=this.Data.length,this.Index+=ba*Math.pow(xa,Ta),this.Data[Ta]=la):this.Data[Ta]=la};t.prototype.yQa=function(ba){ba=this.oBe(ba);return-1==ba?null:this.Data[ba]};t.prototype.oBe=function(ba){for(var la=0,Ta=this.Index;0!=Ta;){if(Ta%xa==ba)return la;Ta=Math.floor(Ta/xa);la++}return-1};t.prototype.SetAnimateRight=function(ba){this.aac=ba};m.prototype={rod:-1,delay:0,element:null,UNb:null,w$:null,extraData:null,
Jdb:null,vQf:0,m9e:null};m.prototype.G3c=function(ba,la,Ta,Ea,sa,Ya){if(D(Ta))throw"Argument Error: element cannot be null.";if(C(Ta)&&!C(Ea)||!C(Ta)&&C(Ea))throw"Argument Error: element and finalState counts do not match";this.rod=ba;this.delay=la;this.element=Ta;this.UNb=Ea;this.w$=sa;this.extraData=Ya;this.Jdb=[];this.vQf=0;this.m9e=P};m.prototype.WS=function(ba){return null==ba.contextId?ba.value:this.m9e[ba.contextId].value};m.prototype.RunAnimation=function(){if(-1!=this.rod&&null!=this.element){this.g$g();
for(var ba=this.Jdb.length,la=0;la<ba;la++)this.Jdb[la].a4c()}};m.prototype.g$g=function(){for(var ba=Y[this.rod],la=null,Ta=ba.Q1f.length,Ea,sa=0;sa<Ta;sa++){var Ya=ba.Q1f[sa],bb=this.a$g(Ya),ra;if(null!=bb)if(bb.bca.SetAttribute(Ya.type,this.WS(Ya.bca)),bb.l4.SetAttribute(Ya.type,Ya.l4),C(this.element)){var Da=this.element.length;for(ra=0;ra<Da;ra++)if(Ea=this.fac(Ya,ra),D(Ea)){bb.l4.SetAttribute(Ya.type,null);break}else bb.V7[ra].SetAttribute(Ya.type,Ea)}else Ea=this.fac(Ya,-1),D(Ea)?bb.l4.SetAttribute(Ya.type,
null):bb.V7.SetAttribute(Ya.type,Ea);else{bb=new e(this.element,this.WS(Ya.startTime)+this.delay,this.WS(Ya.endTime)-this.WS(Ya.startTime),null,null,this.UNb.aac);bb.bca.SetAttribute(Ya.type,this.WS(Ya.bca));bb.l4.SetAttribute(Ya.type,Ya.l4);if(C(this.element))for(Da=this.element.length,ra=0;ra<Da;ra++)if(null==bb.V7&&(bb.V7=Array(this.element.length)),null==bb.V7[ra]&&(bb.V7[ra]=new t),Ea=this.fac(Ya,ra),D(Ea)){bb.l4.SetAttribute(Ya.type,null);break}else bb.V7[ra].SetAttribute(Ya.type,Ea);else null==
bb.V7&&(bb.V7=new t),Ea=this.fac(Ya,-1),D(Ea)?bb.l4.SetAttribute(Ya.type,null):bb.V7.SetAttribute(Ya.type,Ea);if(null==la||la.delay+la.duration<=bb.delay+bb.duration)la=bb;this.Jdb[this.vQf++]=bb}}null!=la&&(la.w$=this.w$,la.extraData=this.extraData)};m.prototype.a$g=function(ba){for(var la=this.Jdb.length,Ta=0;Ta<la;Ta++){var Ea=this.Jdb[Ta];if(Ea.delay==this.WS(ba.startTime)+this.delay&&Ea.duration==this.WS(ba.endTime)-this.WS(ba.startTime))return Ea}return null};m.prototype.fac=function(ba,la){var Ta=
null;if(!D(this.WS(ba.rXa)))switch(ba.Tzg){case 0:Ta=C(this.element)?this.element[la]:this.element;Ta=null==this.WS(ba.bca)?l(Ta,ba.type,this.UNb.aac):this.WS(ba.bca);Ta=0==ba.operationType?this.WS(ba.rXa)*Ta:this.WS(ba.rXa)+Ta;break;case 1:la=(C(this.element)?this.UNb[la]:this.UNb).yQa(ba.type);D(la)||(Ta=0==ba.operationType?this.WS(ba.rXa)*la:this.WS(ba.rXa)+la);break;case 2:Ta=this.WS(ba.rXa)}return Ta};e.prototype={element:null,delay:0,duration:0,bca:null,X3a:null,V7:null,l4:null,w$:null,extraData:null,
startTime:null,YDd:!1,NGb:!1,b5a:!1};e.prototype.G3c=function(ba,la,Ta,Ea,sa,Ya){this.element=ba;this.delay=la;this.duration=Ta;this.w$=Ea;this.extraData=sa;this.bca=new t;this.V7=this.X3a=null;this.l4=new t;this.startTime=null;this.YDd=!1;this.NGb=Ya;this.b5a=!1};e.prototype.a4c=function(){null==ea&&(ea=new k);null==ea.ovb&&ea.Zah();"relative"==this.element.style.position&&(this.b5a=!0);this.startTime=new Date;this.currentTime=new Date;ea.a4c(this)};e.prototype.b4c=function(){ea.b4c(this)};e.prototype.$ah=
function(){this.currentTime=new Date;var ba=Number(this.currentTime)-Number(this.startTime);if(!(ba<this.delay)){ba-=this.delay;for(var la=!0,Ta=!this.YDd,Ea=K,sa=1;sa<=Ea;sa++){var Ya=this.l4.yQa(sa);if(!D(Ya))if(Ya=this.lah(ba,this.duration,Ya),C(this.element))for(var bb=this.element.length,ra=0;ra<bb;ra++){var Da=this.element[ra];var oa=this.bca.yQa(sa);var Ha=this.V7[ra];Ha=Ha.yQa(sa);D(oa)&&(null==this.X3a&&(this.X3a=Array(this.element.length)),D(this.X3a[ra])&&(this.X3a[ra]=new t),oa=this.X3a[ra].yQa(sa),
D(oa)&&(oa=l(Da,sa,this.NGb,this.b5a),this.X3a[ra].SetAttribute(sa,oa)));oa+=Ya*(Ha-oa);ba>=this.duration||1<Ya?oa=Ha:la=!1;Ta&&ea.HAe(Da,sa);this.SBe(sa,Da,oa)}else oa=this.bca.yQa(sa),Ha=this.V7,Ha=Ha.yQa(sa),D(oa)&&(oa=l(this.element,sa,this.NGb,this.b5a),this.bca.SetAttribute(sa,oa)),oa+=Ya*(Ha-oa),ba>=this.duration||1<Ya?oa=Ha:la=!1,Ta&&ea.HAe(this.element,sa),this.SBe(sa,this.element,oa)}this.YDd=!0;la&&(this.b4c(),null!=this.w$&&(fa.ora("calling fnishfunc"),this.w$(this.extraData)))}};e.prototype.lah=
function(ba,la,Ta){var Ea=0;Ta=U[Ta];switch(Ta.type){case 0:Ea=1;break;case 1:Ea=ba<la?0:1;break;case 2:Ea=ba/la;break;case 3:Ea=z(Ta.Ebl,Ta.Sbl,Ta.Fbl,Ta.Tbl,ba/la)}return Ea};e.prototype.SBe=function(ba,la,Ta){fa.vhb[la.id]=!0;switch(ba){case 1:this.dbh(la,Ta);break;case 2:this.ibh(la,Ta);break;case 3:this.cbh(la,Ta);break;case 4:this.jbh(la,Ta);break;case 5:this.ebh(la,Ta);break;case 6:this.hbh(la,Ta);break;case 7:this.gbh(la,Ta);break;case 8:this.fbh(la,Ta)}};e.prototype.dbh=function(ba,la){this.NGb?
this.b5a?ba.style.marginRight=String(la)+"px":ba.style.right=String(la)+"px":this.b5a?ba.style.marginLeft=String(la)+"px":ba.style.left=String(la)+"px";Ba&&fa.ora("element: "+ba.id+", "+(this.NGb?"right":"left")+": "+String(la)+", timestamp: "+String(Number(new Date)))};e.prototype.ibh=function(ba,la){this.b5a?ba.style.marginTop=String(la)+"px":ba.style.top=String(la)+"px";Ba&&fa.ora("element: "+ba.id+", top: "+String(ba.style.top)+", timestamp: "+String(Number(new Date)))};e.prototype.cbh=function(ba,
la){ba.style.height=String(la)+"px";Ba&&fa.ora("element: "+ba.id+", height: "+String(ba.style.height)+", timestamp: "+String(Number(new Date)))};e.prototype.jbh=function(ba,la){ba.style.width=String(la)+"px";Ba&&fa.ora("element: "+ba.id+", width: "+String(ba.style.width)+", timestamp: "+String(Number(new Date)))};e.prototype.ebh=function(ba,la){J(ba,la);Ba&&fa.ora("element: "+ba.id+", opacity: "+String(la)+", timestamp: "+String(Number(new Date)))};e.prototype.hbh=function(ba,la){ba.scrollTop=la;
Ba&&fa.ora("element: "+ba.id+", scrollTop: "+la+", timestamp: "+String(Number(new Date)))};e.prototype.gbh=function(ba,la){ba.scrollLeft=la;Ba&&fa.ora("element: "+ba.id+", scrollLeft: "+la+", timestamp: "+String(Number(new Date)))};e.prototype.fbh=function(ba,la){N(ba,la);Ba&&fa.ora("element: "+ba.id+", rotateZ: "+la+", timestamp: "+String(Number(new Date)))};w.prototype={zza:null,tl:null,j3e:5,tdb:null,xUa:0,Y3a:0,Gob:0,startTime:null,duration:null,t5d:0,vhb:null,Wdb:-1,bgb:0,spb:-1,ipb:-1};w.prototype.Start=
function(){this.startTime=new Date;this.Gob=this.Y3a=0;this.vhb={}};w.prototype.abh=function(){this.duration=Number(new Date)-Number(this.startTime);this.t5d=ea.pvb;this.Q8g();this.Gob=this.Y3a=0};w.prototype.$7g=function(ba){this.zza[this.Y3a++]=ba};w.prototype.ora=function(ba){this.tl[this.Gob++]=ba};w.prototype.R8g=function(){var ba=0,la=Number.MAX_VALUE,Ta=Number.MIN_VALUE,Ea=0,sa=0,Ya="",bb="",ra=new Date,Da="",oa=this.duration;D(oa)&&(oa=Number(ra)-Number(this.startTime));if(Ba&&0<this.Gob)for(var Ha=
this.Gob,ka=0;ka<Ha;ka++)0!=ka&&(Ya+="<br/>"),Ya+=this.tl[ka];if(0<this.Y3a){ba=this.Y3a;for(ka=0;ka<ba;ka++)this.zza[ka]<la&&(la=this.zza[ka]),this.zza[ka]>Ta&&(Ta=this.zza[ka]),Ea+=this.zza[ka],0!=ka&&(bb+=", "),bb+=this.zza[ka];1<ba&&(Ea/=ba-1);Ea=Math.round(100*Ea)/100;for(ka=0;ka<ba;ka++)Ha=this.zza[ka]-Ea,Ha*=Ha,sa+=Ha;1<ba&&(sa/=ba-1);sa=Math.sqrt(sa);sa=Math.round(100*sa)/100;ba=this.Y3a/oa*1E3;ba=Math.round(ba)}for(var wa in this.vhb)Da+=wa,Da+=",";if(-1==this.spb||ba<this.spb)this.spb=ba;
if(-1==this.ipb||ba>this.ipb)this.ipb=ba;0==this.bgb?(this.bgb++,this.Wdb=ba):(ka=this.Wdb*this.bgb,this.bgb++,this.Wdb=(ka+ba)/this.bgb);ka=Array(12);ka[0]=oa;ka[1]=ba;ka[2]=la;ka[3]=Ta;ka[4]=Ea;ka[5]=sa;ka[6]=bb;ka[7]=Ya;ka[8]=this.t5d;ka[9]=Number(this.startTime);ka[10]=Number(ra);ka[11]=Da;return ka};w.prototype.Q8g=function(){var ba=this.R8g();V=ba;this.bbh(ba)};w.prototype.bbh=function(ba){this.tdb[this.xUa]=ba;this.xUa++;this.xUa%=this.j3e};w.prototype.GetRecentAnimationStats=function(){for(var ba=
[],la=0,Ta=fa.xUa;Ta<fa.j3e;Ta++)null!=fa.tdb[Ta]&&(ba[la]=fa.tdb[Ta],la++);for(Ta=0;Ta<fa.xUa;Ta++)null!=fa.tdb[Ta]&&(ba[la]=fa.tdb[Ta],la++);return ba};w.prototype.GetAnimationSqmStats=function(){var ba=[];ba[0]=0>fa.Wdb?0:fa.Wdb;ba[1]=0>fa.spb?0:fa.spb;ba[2]=0>fa.ipb?0:fa.ipb;return ba};var fa=new w,V=null;Q.Telemetry=fa},1412:function(y,x,a){x=a(476);a=a(1413);a=a.kv?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);x(a,{insert:"head",AC:!1});y.exports=a.oH||{}},1413:function(y,x,a){x=a(477)(!1);
x.push([y.i,".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb.ewa-bb-react{background-color:#f5f5f5}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:700}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-button-holder,.ewa-bb-entry-link,.ewa-bb-entry-message,.ewa-bb-entry-title{vertical-align:middle}.ewa-nov2-ltr .ewa-bb-entry-close,.ewa-root-ltr .ewa-bb-entry-close{right:2px}.ewa-nov2-ltr .ewa-bb-content,.ewa-root-ltr .ewa-bb-content{margin-right:26px}.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-nov2-ltr .ewa-bb-entry-link,.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-root-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-nov2-rtl .ewa-bb-entry-close,.ewa-root-rtl .ewa-bb-entry-close{left:2px}.ewa-nov2-rtl .ewa-bb-content,.ewa-root-rtl .ewa-bb-content{margin-left:26px}.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-nov2-rtl .ewa-bb-entry-link,.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-root-rtl .ewa-bb-entry-link{margin-right:8px}",
""]);y.exports=x},1414:function(y,x,a){a.r(x);a.d(x,"AutoDetectActionButton",function(){return d});y=a(0);x=a(80);var c=a(1365),b=a(59),f=a(12),r=a(24);class d extends x.a{constructor(k,t,m,e,w){super();this.$=k;this.NL=e.NKb(k,t,m,"",b.a.$m(11),w,"AutoDetectPointerDown",f.a.instance.ia(1808)+"...")}get iE(){return this.NL.iE}dispose(){this.NL.dispose();this.$=null;super.dispose()}domElement(k){return this.NL.domElement(k)}getButton(k){return this.NL.getButton(k,!1)}Vxb(k,t,m,e){this.NL.H8a(c.a.jGi(k),
t,e);this.NL.r1c(m,t,e)}oqa(k,t){const m=r.f(this.$),e=m.Pg.ro(k);k=m.ml(k,e);const w=m.Zk(e).vr;if(k&&0<=k.x&&0<=k.y&&w.width>k.width+160){let l=k.bottomRight.x+this.iE,u=k.topLeft.y+this.iE,n=!1;l+160>w.bottomRight.x&&(l=k.topLeft.x-this.iE,n=!0);if(u<w.topLeft.y+this.iE){if(m.Pg.j8a){this.hide();return}u=w.topLeft.y+this.iE}this.NL.nBd(t,e);this.Ft(l,u,m.rtl,e,n)}else this.hide()}Ft(k,t,m,e,w){this.NL.Ft(k,t,m,e,!1,w)}hide(){this.NL.hide()}}Object(y.a)(d,"AutoDetectActionButton",x.a,[])},896:function(y,
x,a){a.d(x,"a",function(){return Q});y=a(0);var c=a(2),b=a(14),f=a(96),r=a(286),d=a(17),k=a(154),t=a(181),m=a(6),e=a(100);x=a(263);var w=a(1176),l=a(19),u=a(7),n=a(363),v=a(59),B=a(16),z=a(74),C=a(12),D=a(24),J=a(98),W=a(1061),N=a(1),M=a(152);class Q extends x.a{constructor(R,O){super(document.createElement("div"));this.O3f=this.V2e=this.oYe=this.cpc=this.joa=this.lja=this.CZ=this.oI=null;this.fga=this.r5=this.Bx=this.hideCloseButton=!1;this.XLj=U=>{this.rD(U)};this.cMj=U=>{13===U.keyCode&&this.rD(U)};
this.U5d=U=>{this.ar(U.oh);return!0};this.$5d=U=>{this.v6(U.oh);return!0};this.pNc=U=>{this.AY(U.oh?U.oh:0);return!0};this.YLj=U=>{this.rD(U.La);return!0};this.sah=U=>{U=void 0===U?null:U;this.ar(U.inputMethod?U.inputMethod:0);return!0};this.tah=U=>{U=void 0===U?null:U;this.v6(U.inputMethod?U.inputMethod:0);return!0};this.Mca=R;this.Wz=O;this.iqd=O.RFa.toString();this.title=O.title;this.message=O.message;this.set_visibilityMode(1)}get RFa(){return this.Wz.RFa}get businessBar(){return this.Mca}get actionButton(){return this.Wz?
this.Wz.actionButton:""}get vUa(){return this.Wz?this.Wz.vUa:""}get linkText(){return this.Wz?this.Wz.link:""}get lJc(){return this.Wz?this.Wz.lJc:""}get Dx(){return this.Wz?this.Wz.Dx:""}get alt(){return this.Wz?this.Wz.alt:""}CAa(R){this.Wz.businessBarType=R}dispose(){f.a.Ni([this.cpc,this.CZ,this.lja]);this.Bx&&this.CZ&&(r.a.instance.Na(d.a.click,this.CZ.domElement,this.U5d),k.a.instance.h2(this.domElement,this.oYe));this.r5&&this.lja&&(r.a.instance.Na(d.a.click,this.lja.domElement,this.$5d),k.a.instance.h2(this.domElement,
this.V2e));this.fga&&this.joa&&(r.a.instance.Na(d.a.click,this.joa,this.pNc),k.a.instance.h2(this.domElement,this.O3f));this.joa=this.oI=this.Mca=this.lja=this.CZ=null;super.dispose()}update(){}g3k(){this.fif(!0)}Kgf(){this.fif(!1)}i5h(){const R=this.businessBar.$.qh.Vl("DOMUpdate","ReactBusinessBar");R.start();this.message=J.a.zm(this.message);this.title=J.a.zm(this.title);t.a.wKd().then(O=>{O.initializeMessageBarInStore();const U=Object(c.a)(new W.a,{messageTitle:this.title,message:this.message,
isMultiline:!1,messageBarType:this.Wz.businessBarType,dismissButtonAriaLabel:C.a.instance.ia(10),closeable:N.EwaSettings.isChangeGateEnabled("OfficeVSO:8549880_BizBarCloseIconChange")?!this.hideCloseButton:void 0});this.hideCloseButton||(U.onDismiss=this.YLj);this.fga&&(U.linkProps=Object.assign({},{["type"]:"AppLinkProps",["text"]:this.linkText,["onExecute"]:this.pNc},N.EwaSettings.isChangeGateEnabled("OfficeVSO:8717551_AriaLabelForBusinessBarLinks")&&0<this.lJc.length?{["aria-label"]:this.lJc}:
{}));this.Bx&&(U.firstActionButtonProps={["type"]:"AppButtonProps",["label"]:this.actionButton,["onExecute"]:this.sah});this.r5&&(U.secondActionButtonProps={["type"]:"AppButtonProps",["label"]:this.vUa,["onExecute"]:this.tah});N.EwaSettings.isChangeGateEnabled("OfficeVSO:7445369_IconFunctionalityReactBizBars")&&this.Wz.iconName&&(U.messageBarIconProps={["iconName"]:this.Wz.iconName});O.createNewMessageBarWithCallback(this.domElement,U,()=>{m.AFrameworkApplication.fa.la("Fluent2StyleIsEnabled")&&(this.domElement.classList.add("VNextBusinessBarEntry"),
this.domElement.classList.add("WACBusinessBarEntry"));this.domElement.classList.add("ReactBusinessBarEntry");Object(M.d)(()=>{var K,F;return null===(F=null===(K=this.businessBar)||void 0===K?void 0:K.domElement)||void 0===F?void 0:F.appendChild(this.domElement)});R.stop();b.ULS.sendTraceTag(509657951,0,50,`React Business Bar created for ${this.Wz.GHa} in: ${R.ii} milliSeconds.`)});return null},O=>{b.ULS.sendTraceTag(524075914,0,10,`React BusinessBar for ${this.Wz.GHa} could not be initialized. ${O}`);
return null})}r4h(R){const O=this.businessBar.$.qh.Vl("DOMUpdate","LegacyBusinessBar");O.start();R||(this.domElement.tabIndex=0,this.businessBar.domElement.appendChild(this.domElement));var U=this.businessBar.$.$h;R=U+"ewaBusinessBarEntryBody"+this.iqd;const K=U+"ewaBusinessBarEntryTitle"+this.iqd;var F=U+"ewaBusinessBarEntryIcon"+this.iqd;this.domElement.className=w.c;B.DOMElementExtensions.eO(this.domElement);U=document.createElement("div");U.className=w.d;U.id=R;var I=document.createElement("div");
I.className=w.b;var P=document.createElement("a");P.className=w.l;P.title=this.alt;var Y=document.createElement("span");Y.classList.add(l.a.bud);Y.classList.add(w.h);Y.id=F;this.Dx.length&&(F=document.createElement("img"),F.classList.add(this.Dx),F.src=v.a.$m(0),Y.appendChild(F));P.appendChild(Y);I.appendChild(P);P=document.createElement("span");P.classList.add(w.k);P.id=K;P.innerText=J.a.zm(this.title);I.appendChild(P);P=document.createElement("span");P.classList.add(w.j);P.id="message";P.innerText=
J.a.zm(this.message);I.appendChild(P);P=document.createElement("a");P.id="link";P.href="#";P.className=w.i;P.innerText=J.a.zm(this.linkText);I.appendChild(P);P=document.createElement("span");P.classList.add(w.f);Y=document.createElement("button");Y.type="button";Y.id="action";Y.className=w.e;Y.innerText=J.a.zm(this.actionButton);P.appendChild(Y);I.appendChild(P);P=document.createElement("span");P.classList.add(w.f);Y=document.createElement("button");Y.type="button";Y.id="altAction";Y.className=w.e;
Y.innerText=J.a.zm(this.vUa);P.appendChild(Y);I.appendChild(P);U.appendChild(I);I=document.createElement("a");I.className=w.g;I.tabIndex=0;I.setAttribute("role","button");P=document.createElement("span");P.id="close";P.classList.add(l.a.S3);Y=document.createElement("img");Y.classList.add(l.a.WCd);Y.src=v.a.$m(13);Y.alt=C.a.instance.ia(793);Y.title=C.a.instance.ia(793);Y.setAttribute("role","button");P.appendChild(Y);I.appendChild(P);U.appendChild(I);this.domElement.appendChild(U);B.DOMElementExtensions.UK(this.domElement,
u.a.Kta,K,R);this.joa=$get("link",this.domElement);B.DOMElementExtensions.setVisible(this.joa,this.fga);this.fga&&(r.a.instance.ya(d.a.click,this.joa,this.pNc),this.O3f=k.a.instance.r1(this.joa,this.pNc,e.a.fu,e.a.bCa));this.CZ=new n.a(B.DOMElementExtensions.getElementById(this.domElement,"action"));this.CZ.isVisible=this.Bx;this.lja=new n.a(B.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.lja.isVisible=this.r5;this.Bx&&(r.a.instance.ya(d.a.click,this.CZ.domElement,this.U5d),
this.oYe=k.a.instance.r1(this.CZ.domElement,this.U5d,e.a.fu,e.a.bCa),this.r5&&(r.a.instance.ya(d.a.click,this.lja.domElement,this.$5d),this.V2e=k.a.instance.r1(this.CZ.domElement,this.$5d,e.a.fu,e.a.bCa)));this.oI=$get("close",this.domElement);this.cpc=this.Xk.Ek(this.oI);this.cpc.Aa("click",this.XLj);this.cpc.Aa("keydown",this.cMj);B.DOMElementExtensions.setVisible(this.oI,!this.hideCloseButton);O.stop();b.ULS.sendTraceTag(508387361,0,50,`Legacy Business Bar created for ${this.Wz.GHa} in: ${O.ii} milliSeconds.`)}fif(R){N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",
!1)?this.i5h():this.r4h(R)}ar(){b.ULS.sendTraceTag(21517968,0,50,`BusinessBar [${this.Wz.hash}]: BusinessBarEntry.OnActionClick() for EntryName ${this.Wz.GHa}`);D.f(this.businessBar.$).Cz(!0)}v6(){b.ULS.sendTraceTag(537170257,0,50,`BusinessBar [${this.Wz.hash}]: BusinessBarEntry.OnAltActionClick() for EntryName ${this.Wz.GHa}`);D.f(this.businessBar.$).Cz(!0)}AY(){b.ULS.sendTraceTag(537170256,0,50,`BusinessBar [${this.Wz.hash}]: BusinessBarEntry.OnLinkClick() for EntryName ${this.Wz.GHa}`);D.f(this.businessBar.$).Cz(!0)}rD(R){b.ULS.sendTraceTag(21517971,
0,50,`BusinessBar [${this.Wz.hash}]: BusinessBarEntry.OnCloseClick() for EntryName ${this.Wz.GHa}`);this.set_visible(!1);this.businessBar.removeEntry(this.RFa);z.g(R)}yma(){return N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.domElement.getElementsByTagName("button")[0]:this.CZ.domElement}}Object(y.a)(Q,"BusinessBarEntry",x.a,[])},952:function(y,x,a){a.r(x);a.d(x,"ConvertToLinkedEntityManager",function(){return Jb});y=a(179);x=a(0);var c=a(14),b=a(96),f=a(242),
r=a(6),d=a(31),k=a(984),t=a(143),m=a(42),e=a(38),w=a(19),l=a(7),u=a(162),n=a(1365),v=a(1146),B=a(188),z=a(646),C=a(388),D=a(62);const J=(qb,Db,gb,ya,Aa,sb,nc,Bb,uc,Pc,wd)=>{wd=qb.Za(1,void 0===wd?null:wd);wd.selectedRanges=Db;wd.isChangeObject=gb;wd.isFloodgateEnabled=ya;wd.isStarterData=Aa;wd.starterDataDomainId=sb;return D.h(qb,"GetDataSelectorPaneData",wd,nc,Bb,uc,Pc,4)};var W=a(139),N=a(924),M=a(1058);class Q{}Q.P6i="EnrichmentContentFrame";Q.width=320;Object(x.a)(Q,"EnrichmentConstants",null,
[]);class R{constructor(qb){this.messageType=0;this.messageType=qb}}Object(x.a)(R,"EnrichmentResponseMessage",null,[]);class O extends R{constructor(qb,Db){super(qb);this.messageContent=null;this.messageContent=Db}}Object(x.a)(O,"EnrichmentResponseMessageWithContent",R,[]);class U extends O{constructor(qb,Db,gb){super(qb,Db);this.telemetryJson=null;this.telemetryJson=gb}}Object(x.a)(U,"EnrichmentResponseMessageWithContentAndTelemetryData",O,[]);var K=a(593),F=a(17),I=a(128),P=a(52),Y=a(100),ea=a(154),
Ba=a(44),Fa=a(81),za=a(34),xa=a(134),fa=a(890),V=a(28),ba=a(23);class la{constructor(qb,Db,gb,ya,Aa){this.TE=this.Bs=this.JKe=this.HKe=this.XE=this.ND=null;this.qG=!1;this.ejg=sb=>{sb=sb.La.keyCode;return sb===Sys.UI.Key.enter||sb===Sys.UI.Key.space?(this.epc(),!0):!1};this.Big=()=>{};this.fNc=()=>{};this.Cig=sb=>{sb=sb.rawEvent;if(!this.XE||-1!==this.XE.src.indexOf(sb.origin)){try{var nc=Ba.a(sb.data)}catch(Bb){return}if(!fa.c(nc.messageType))switch(nc.messageType){case 2:this.aQc(new U(1,Ba.c(this.HKe),
this.JKe));break;case 1:this.aQc(new O(0,this.oCi()));break;case 3:this.ND&&this.ND.selectEntity(nc.messageContent);break;case 5:this.ND&&this.ND.MYb(nc.messageContent);break;case 8:this.ND&&(nc=Ba.a(nc.messageContent),0<nc.DomainId?this.ND.Fke(nc.Query,nc.TelemetryJson,nc.DomainId,nc.DomainIdString):this.ND.searchEntity(nc.Query,nc.TelemetryJson));break;case 6:this.ND&&this.ND.cancelSearch();break;case 11:nc=Ba.a(nc.messageContent);nc=la.Sqc("keydown","f6",Y.a.pac,!0,!1,nc,!0,!1);this.XE&&this.XE.dispatchEvent(nc);
break;case 12:if(Ba.a(nc.messageContent).keyCode===Y.a.zZ&&(nc=la.Sqc("keydown","esc",Y.a.zZ,!0,!1,!1,!1,!1),this.XE&&(this.XE.dispatchEvent(nc),this.hide(),this.ND)))this.ND.onPaneClosed();break;case 13:this.ND&&this.ND.L4b(nc.messageContent);break;case 14:this.ND&&this.ND.Vvb(nc.messageContent);break;case 15:this.ND&&this.ND.Y6b(nc.messageContent);break;case 16:this.ND&&(nc=Ba.a(nc.messageContent),this.ND.n_a(nc.DomainId,nc.DomainIdString))}}};this.gu=qb;this.Rk=Db;this.Eja=gb;this.Ei=ya;this.$c=
Aa;this.cDa=ea.a.ny(Y.a.bQa,0)}get Avb(){return!0}get bNb(){return r.AFrameworkApplication.fa.Xa("EnrichmentPaneUrl")}dispose(){this.Avb&&this.TE&&(this.gu.Na(F.a.click,this.TE,Object(W.a)(this,this.$ya,"onClosePaneClick")),this.Rk.Na(F.a.Rj,this.TE,this.ejg));this.TE=null;this.XE&&(this.T1k(),this.XE.parentNode.removeChild(this.XE),this.XE=null);this.Ei.Lq("EnrichmentPaneId").zB(this.cDa)}show(qb,Db,gb){this.ND=qb;this.qG||(this.Bs=this.Hqc(),this.zje.appendChild(this.Bs),this.Gek(),this.$c.Hh(V.a.Bcf,
xa.a.frame,Object(W.a)(this,this.m0i,"handleEscapeKeyAction")),this.Gne(),this.qG=!0);this.XE.src=this.bNb&&this.bNb.length?this.bNb+"?culture="+Db.market+"&appName="+Db.applicationName+"&themeId="+Db.themeId+"&featuresBitMask="+Db.featuresBitMask:la.qcg;this.HKe=Db;this.JKe=gb;this.showInternal()}l1c(qb,Db){qb=new U(2,qb,Db);this.aQc(qb)}Gne(){const qb=this.Ei.Lq("EnrichmentPaneId");qb.parent=K.AFrame.Zob;this.gu.Mjc("EnrichmentPaneId",this.Bs);qb.bindAction(this.cDa,V.a.Bcf)}OLg(){if(this.XE){I.FocusManager.KBa(this.XE.contentWindow);
const qb=new U(4,null,null);this.aQc(qb)}}$ya(){this.epc();return!0}epc(){this.hide();if(this.ND)this.ND.onPaneClosed()}Hqc(){const qb=N.a("div","EnrichmentPaneId","EnrichmentPane");this.Avb&&qb.appendChild(this.I2h());this.eaj(qb);return qb}I2h(){const qb=N.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),Db=N.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle");Db.innerText=Object(ba.a)("EnrichmentPaneTitle");Db.title=Object(ba.a)("EnrichmentPaneTitle");const gb=M.a.Sg("CloseEnrichmentPane",
"EnrichmentPaneCloseButton",Object(ba.a)("Close"),"ClosePaneGlyph_16x16x32",!1);this.gu.ya(F.a.click,gb,Object(W.a)(this,this.$ya,"onClosePaneClick"));this.Rk.ya(F.a.Rj,gb,this.ejg);qb.appendChild(Db);qb.appendChild(gb);this.TE=gb;return qb}eaj(qb){this.XE=N.b("iframe","","EnrichmentFrame");qb.appendChild(this.XE);this.XE.id=Q.P6i;this.XE.setAttribute("role","presentation")}Gek(){P.a.addHandler(this.XE,"load",this.Big);P.a.addHandler(this.XE,"error",this.fNc);$addHandler(window,"message",this.Cig)}T1k(){P.a.removeHandler(this.XE,
"load",this.Big);P.a.removeHandler(this.XE,"error",this.fNc);$removeHandler(window,"message",this.Cig)}K8h(){this.XE.src=la.qcg}hide(){this.hideInternal();this.K8h()}m0i(qb,Db,gb){if(1!==gb&&(this.hide(),this.ND))this.ND.onPaneClosed();return 32}oCi(){return Ba.c([2,1,3,5,8,6])}aQc(qb){qb=Ba.c(qb);this.XE.contentWindow.postMessage(qb,Fa.a.getOrigin(this.bNb))}static Sqc(qb,Db,gb,ya,Aa,sb,nc,Bb){za.a.IU?(sb=String.format("{0} {1} {2}",sb?"Shift":"",nc?"Control":"",Bb?"Alt":""),sb.trim(),gb=document.createEvent("KeyboardEvent"),
gb.initKeyboardEvent(qb,ya,Aa,window.self,Db,0,sb,!1,"en-US")):(Db={},Db.keyCode=gb,Db.ctrlKey=nc,Db.shiftKey=sb,Db.altKey=Bb,Db.bubbles=ya,Db.cancelable=Aa,gb=new KeyboardEvent(qb,Db));return gb}}la.qcg="about:blank";Object(x.a)(la,"EnrichmentPane",null,[675,2]);var Ta=a(1);class Ea extends la{constructor(qb){super(r.AFrameworkApplication.ra.kJ,r.AFrameworkApplication.ra.PH,r.AFrameworkApplication.ra.uBa,r.AFrameworkApplication.ra.tm,r.AFrameworkApplication.jh);this.taskPane=qb;this.taskPane.Izh(this.OLg)}get zje(){return this.taskPane.Pi}showInternal(){this.taskPane.isVisible||
this.taskPane.DE(!0)}hideInternal(){this.taskPane.DE(!1)}get Avb(){return!Ta.EwaSettings.isChangeGateEnabled("OfficeVSO:8207038_EnrichmentTaskPaneHeaderFix")}dispose(){this.taskPane&&(this.taskPane.bkk(this.OLg),this.taskPane=null);super.dispose()}}Object(x.a)(Ea,"EnrichmentTaskPaneWrapper",la,[]);class sa{constructor(qb){this.$H=null;this.Kra=qb}mtj(qb,Db){this.$H=qb;this.Kra&&this.Kra.show(this,Db,null)}l1c(qb,Db){this.Kra&&this.Kra.l1c(qb,Db)}lPd(){this.Kra&&this.Kra.hide()}dispose(){this.Kra&&
(this.Kra.dispose(),this.Kra=null)}selectEntity(qb){return this.$H?this.$H.selectEntity(qb):!1}searchEntity(qb,Db){this.$H&&this.$H.searchEntity(qb,Db)}Fke(qb,Db,gb,ya){this.$H&&this.$H.Fke(qb,Db,gb,ya)}MYb(qb){return this.$H?this.$H.MYb(qb):!1}onPaneClosed(){if(this.$H)this.$H.onPaneClosed()}cancelSearch(){this.$H&&this.$H.cancelSearch()}L4b(qb){this.$H&&this.$H.L4b(qb)}Vvb(qb){this.$H&&this.$H.Vvb(qb)}Y6b(qb){this.$H&&this.$H.Y6b(qb)}n_a(qb,Db){this.$H&&this.$H.n_a(qb,Db)}}Object(x.a)(sa,"EnrichmentManager",
null,[674,2]);class Ya extends sa{constructor(qb){super(qb)}dispose(){super.dispose()}}Object(x.a)(Ya,"ExcelEnrichmentManager",sa,[]);var bb=a(12);class ra{constructor(qb){this.campaignId=this.commentQuestion=null;this.isZeroBased=!1;this.ratingValuesAscending=this.ratingQuestion=this.aditionalDataRequested=null;this.showPrompt=this.showEmailRequest=!1;this.surveyType=0;this.title=null;this.campaignId=qb;this.commentQuestion=bb.a.instance.$g(199);this.isZeroBased=!1;this.aditionalDataRequested=["EmailAddress"];
this.ratingQuestion=bb.a.instance.$g(195);this.ratingValuesAscending=[bb.a.instance.$g(196),bb.a.instance.$g(197),bb.a.instance.$g(198)];this.showPrompt=!1;this.showEmailRequest=!0;this.surveyType=4;this.title=bb.a.instance.$g(194)}}Object(x.a)(ra,"FloodgateSurvey",null,[]);var Da=a(26),oa=a(69),Ha=a(481),ka=a(45),wa=a(419),Za=a(212),ab=a(86),db=a(35),mb=a(262),Ia=a(24);class pa{constructor(){this.market=this.appCorrelationId=this.sessionId=this.anid=this.applicationVersion=this.applicationName=null;
this.featuresBitMask=this.themeId=0;this.disambiguationJson=this.uiLanguage=null}}Object(x.a)(pa,"EnrichmentMessageContentAppProperties",null,[]);class lb{constructor(qb,Db,gb,ya,Aa){this.gHa=this.lmf=!1;this.wub=this.zxa=!0;this.l0b=this.v6b=!1;this.ewb=null;this.gPc=0;this.oE=()=>{(this.wub||this.gHa)&&2!==this.gPc&&(this.l0b||this.g_d(!1))};this.Oi=()=>{c.ULS.sendTraceTag(537166944,0,15,"Session ID changed while ambiguous linked entities are present")};this.OMj=sb=>{db.a.Jk(sb.Errors)?(sb=db.a.Kh(sb.Errors),
sb.includes("OperationSucceededWithAlert")?c.ULS.sendTraceTag(537166942,0,50,"Convert to Linked Entity failed with an alert"):c.ULS.sendTraceTag(36975687,0,10,`Failed to Convert to Linked Entity. errors: ${sb}`)):sb.Result&&(this.$.ea.pq(this.Oi),this.$.ea.uq(this.Oi),sb=sb.Result,this.ewb=sb.SkydanceFeatureBitmask,this.K3d(sb),this.v6b=!0)};this.Am=()=>{(this.wub||this.gHa)&&this.g_d(!1)};this.YMc=(sb,nc)=>{db.a.Jk(sb.Errors)?c.ULS.sendTraceTag(36975688,0,10,`Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: ${db.a.Kh(sb.Errors)}`):
sb.Result&&(sb=sb.Result,sb.DisambiguationJson?(this.v6b=!1,this.UMg(nc),this.ewb=sb.SkydanceFeatureBitmask,nc=sb.DisambiguationJson,c.ULS.sendTraceTag(537166940,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.l0b=!1,this.p3f(nc)):c.ULS.sendTraceTag(537166941,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null"))};this.XPj=(sb,nc)=>{db.a.Jk(sb.Errors)?(nc=db.a.Kh(sb.Errors),c.ULS.sendTraceTag(36975689,
0,10,`Failed to retrieve disambiguation data for search. errors: ${nc}`)):sb.Result&&(sb=sb.Result,sb.DisambiguationJson?(this.UMg(nc),this.ewb=sb.SkydanceFeatureBitmask,nc=sb.DisambiguationJson,c.ULS.sendTraceTag(537166938,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.l0b=!0,this.p3f(nc)):c.ULS.sendTraceTag(537166939,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null"))};
this.xTj=sb=>{db.a.Jk(sb.Errors)?(sb=db.a.Kh(sb.Errors),c.ULS.sendTraceTag(36975690,0,10,`Failed to move to the next ambiguous Linked Entity. errors: ${sb}`),this.wub=!0):sb.Result&&(sb=sb.Result,this.ewb=sb.SkydanceFeatureBitmask,this.K3d(sb),this.v6b=!0)};this.vWj=sb=>{if(db.a.Jk(sb.Errors)){const nc=db.a.Kh(sb.Errors);c.ULS.sendTraceTag(36975691,0,10,`Failed to select Linked Entity for Disambiguation.. errors: ${nc}`)}sb.Result?(this.K3d(sb.Result),this.v6b=!0):this.hGa()};this.Img=sb=>{db.a.Jk(sb.Errors)?
(sb=db.a.Kh(sb.Errors),c.ULS.sendTraceTag(36975692,0,15,`Failed to retrieve data for searching in Disambiguation Pane.  Error id names: ${sb}`)):sb.Result?this.ruc.l1c(sb.Result,null):(c.ULS.sendTraceTag(537166927,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),this.hGa())};this.mSj=sb=>{db.a.Jk(sb.Errors)?(sb=db.a.Kh(sb.Errors),c.ULS.sendTraceTag(537166926,0,15,`Failed to insert starter data table. Error id names: ${sb}`)):this.hGa()};
this.$=qb;this.da=Ia.f(this.$);this.da.ha.VW(this.Am);this.da.Mz(this.oE);this.Bqf=ya;this.Ls=Aa;qb=new Ea(Db);this.ruc=new Ya(qb);m.a.instance.Qi("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(sb=>{sb.isFeatureEnabled("mso_sendASmile",!0).then(nc=>{this.zxa=nc;return null})})}dispose(){this.$&&(this.da.ha.UY(this.Am),this.da.xE(this.oE))}selectEntity(qb){const Db=ka.p(this.da.ha.qa.activeCell,this.$),gb=()=>new Ha.a;wa.a(this.$.userOperationManager,(ya,Aa,sb)=>{var nc=this.$.pa.ta;
ya=mb.c(ya,this.vWj);const Bb=nc.Za(9,null);Bb.activeCell=Db;Bb.selectionIndex=qb;return D.h(nc,"SelectLinkedEntityForDisambiguation",Bb,ya,Aa,sb,null,4)},ya=>new Za.a(109,0,ya,void 0,gb),null);return!0}searchEntity(qb,Db,gb,ya,Aa){gb=void 0===gb?!1:gb;ya=void 0===ya?0:ya;Aa=void 0===Aa?null:Aa;c.ULS.sendTraceTag(38846755,0,50,`ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: ${Db}`);const sb=ka.p(this.da.ha.qa.activeCell,this.$);wa.a(this.$.userOperationManager,
(nc,Bb,uc)=>{var Pc=this.$.pa.ta,wd=this.zxa,Md=gb,Nd=ya,ec=Aa;nc=mb.c(nc,this.Img);const gc=Pc.Za(1,null);gc.searchCell=sb;gc.searchQuery=qb;gc.isFloodgateEnabled=wd;gc.isStarterData=Md;gc.starterDataDomainId=Nd;gc.starterDataDomainIdString=ec;return D.h(Pc,"LinkedEntitySearch",gc,nc,Bb,uc,null,4)},nc=>new Za.a(110,0,nc,16),null)}MYb(qb){const Db=ka.p(this.da.ha.qa.activeCell,this.$);this.wub=!1;wa.a(this.$.userOperationManager,(gb,ya,Aa)=>{var sb=this.$.pa.ta;gb=mb.c(gb,this.xTj);const nc=sb.Za(1,
null);nc.activeCell=Db;nc.isBackward=qb;return D.h(sb,"MoveToNextAmbiguousLinkedEntity",nc,gb,ya,Aa,null,4)},gb=>new Za.a(111,0,gb,16),null);return!0}onPaneClosed(){this.gHa=!1;this.lmf=!0;this.gPc=0;this.l0b=!1}cancelSearch(){const qb=this.$ke();qb&&wa.a(this.$.userOperationManager,(Db,gb,ya)=>{var Aa=this.$.pa.ta;Db=mb.c(Db,this.Img);const sb=Aa.Za(9,null);sb.activeCell=qb;return D.h(Aa,"CancelSearchLinkedEntity",sb,Db,gb,ya,null,4)},Db=>new Za.a(112,0,Db,16),null)}L4b(qb){c.ULS.sendTraceTag(537166977,
0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane");this.hGa();if(qb&&qb.length)if(qb=JSON.parse(qb))if(null==qb.domainId)c.ULS.sendTraceTag(537166946,0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");else{var Db={};Db.Id=qb.domainId;Db.StringId=qb.stringId;this.Ls.convertToLinkedEntity(Db)}else c.ULS.sendTraceTag(537166947,0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");else c.ULS.sendTraceTag(537166976,
0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane")}Vvb(qb){const Db=new ab.a(-859308420,oa.a.eh,this.$.Rh,9,null);this.$.Ma.dh(Db,{[oa.a.Wk]:"HelpID="+qb,["InputMethod"]:oa.a.eh,["ShouldCanvasTakeFocus"]:!0,[oa.a.Ai]:l.a.CI})}Y6b(qb){v.a.$vb(new ra(qb))}n_a(qb,Db){const gb=this.$ke();gb&&wa.a(this.$.userOperationManager,(ya,Aa,sb)=>{var nc=this.$.pa.ta;ya=mb.c(ya,this.mSj);const Bb=nc.Za(1,null);Bb.cell=gb;Bb.starterDataDomainId=qb;Bb.starterDataDomainIdString=Db;return D.h(nc,
"InsertStarterDataTable",Bb,ya,Aa,sb,null,4)},ya=>new Za.a(259,0,ya,1),null)}g_d(qb){this.launchOrCloseDisambiguationPane(qb)}launchDisambiguationPaneForSearch(){c.ULS.sendTraceTag(36975685,0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted");const qb=this.xvk();qb&&wa.a(this.$.userOperationManager,(Db,gb,ya)=>J(this.$.pa.ta,qb,!0,this.zxa,!1,null,mb.c(Db,this.XPj),gb,ya,1),Db=>new Za.a(114,0,Db,16),null)}launchLinkedEntityDataTypeSelectorPane(qb,
Db){wa.a(this.$.userOperationManager,(gb,ya,Aa)=>{var sb=this.$.pa.ta;gb=mb.c(gb,this.YMc);const nc=sb.Za(1,null);nc.selectedRanges=qb;nc.letyDomainId=Db;return D.h(sb,"GetDataTypeSelectorData",nc,gb,ya,Aa,2,4)},gb=>new Za.a(233,0,gb,16),null)}gtj(qb,Db){qb&&wa.a(this.$.userOperationManager,(gb,ya,Aa)=>J(this.$.pa.ta,qb,!1,!1,!0,Db,mb.c(gb,this.YMc),ya,Aa,2),gb=>new Za.a(257,0,gb,16),null)}UMg(qb){qb&&(this.gPc=qb)}p3f(qb){var Db=new ab.a(-90814711,oa.a.eh,0,10,null);this.$.Ma.dh(Db,null);this.gHa?
this.ruc.l1c(qb,null):(Db=3,null!=this.ewb?Db=this.ewb:c.ULS.shipAssertTag(537166937,0,!1,"SkydanceFeatureBitmask was not set"),(qb=this.GIi(qb,Db))||c.ULS.sendTraceTag(537166936,0,15,"LaunchOrUpdateDisambiguationPane: null appProperties"),this.Bqf||c.ULS.sendTraceTag(537166935,0,15,"LaunchOrUpdateDisambiguationPane: null entitymanager"),this.ruc.mtj(this.Bqf,qb),this.gHa=!0)}hGa(){this.gHa&&(c.ULS.sendTraceTag(537166934,0,100,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),this.ruc.lPd(),
this.gHa=!1,this.gPc=0,this.l0b=!1)}K3d(qb){var Db=qb.Row+1;qb=qb.Column+1;0>Db||0>qb?(c.ULS.sendTraceTag(537166933,0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane"),this.hGa(),this.$.ea.pq(this.Oi)):(Db=new Da.Range(Db,qb,Db,qb,!0,!1),this.da.ha.updateSelection(Db,Db,60),this.wub=!0)}GIi(qb,Db){const gb=new pa;gb.applicationVersion=r.AFrameworkApplication.buildVersion;gb.applicationName="ExcelWac";gb.anid="00000000-0000-0000-0000-000000000000";
gb.sessionId=r.AFrameworkApplication.userSessionId;gb.appCorrelationId=B.a.create().toString();var ya=z.a.qU(r.AFrameworkApplication.lcid);ya=ya?ya.name:null;gb.uiLanguage=ya;gb.market=this.pyc(ya);gb.themeId=0;gb.disambiguationJson=qb;Db<=C.a.Gca?gb.featuresBitMask=Db:c.ULS.sendTraceTag(537166932,0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties");return gb}pyc(qb){qb=qb.split("-");return qb[qb.length-1]}launchOrCloseDisambiguationPane(qb){const Db=this.da.ha.qa.activeCell;
if(this.$ke()&&Db)if(this.da.Yg.mTb(Db)){if((!this.lmf||qb||this.v6b)&&!this.da.isEditing){qb&&(this.wub=!0);var gb=ka.r(Db,this.$);wa.a(this.$.userOperationManager,(ya,Aa,sb)=>J(this.$.pa.ta,gb,!1,this.zxa,!1,null,mb.c(ya,this.YMc),Aa,sb,1),ya=>new Za.a(114,0,ya,16),null)}}else this.hGa();else this.hGa()}vdk(){if(this.gHa){var qb=this.da.ha.qa.activeCell;if(qb){var Db=ka.r(qb,this.$);wa.a(this.$.userOperationManager,(gb,ya,Aa)=>J(this.$.pa.ta,Db,!1,this.zxa,!1,null,mb.c(gb,this.YMc),ya,Aa,1),gb=>
new Za.a(114,0,gb,16),null)}else this.hGa()}}$ke(){const qb=this.da.ha.qa;return qb.aya()?ka.p(qb.activeCell,this.$):null}xvk(){const qb=this.da.ha.qa;return qb.aya()?ka.r(qb.activeCell,this.$):null}}Object(x.a)(lb,"ConvertToLinkedEntityDisambiguationPane",null,[2]);var ha=a(2),ua=a(285),fb=a(1187),Ka=a(59),La=a(902);class ib{constructor(qb,Db,gb){this.R3f=2;this.Q3f="Size64by48";this.$=qb;this.Ya=Db;this.Ls=gb}cAi(qb,Db){var {ConvertToLinkedEntityManager:gb}=a(952);this.D4k();Db=this.Ya.Vv(Db).ML();
let ya=0,Aa=0,sb=!1;for(var nc of qb.Categories){const Bb=this.NAi(nc,ya);Bb&&(Aa===gb.wob&&(sb=!0),Db.MenuSectionList.push(Bb),++ya);++Aa}sb&&ya<=gb.S3f&&Db.MenuSectionList.splice(gb.wob,1);gb=this.Ya.Oh().gnc();nc=Ka.a.$m(11);for(const Bb of qb.LongButtons)this.Ls.yJk(Bb)&&this.Uvh(gb,Bb,nc);0<gb.ControlList.length&&Db.MenuSectionList.push(gb);return Db}Uvh(qb,Db,gb){if(Db){var ya="Data.ConvertToLinkedEntityMenuItem_"+Db.Name,Aa=this.Ls.v4(Db.DomainId);Aa&&(Db=Object(ha.a)(new ua.a,{Id:ya,ExternalId:ya,
Command:"-1662108744",LabelText:Db.Name,Alt:Db.SuperTip,Visible:!0,MenuItemId:a(952).ConvertToLinkedEntityManager.jhb(Db.DomainId),Image16by16:gb,Image16by16Class:this.n7i(Aa.FontLocator)}),qb.ControlList.push(Db))}}GAi(qb,Db){return Object(ha.a)(new fb.a,{Id:a(952).ConvertToLinkedEntityManager.gof+qb.toString(),ExternalId:a(952).ConvertToLinkedEntityManager.gof+qb.toString(),MenuItemId:a(952).ConvertToLinkedEntityManager.IAd+qb.toString(),Command:"-1203788282",QueryCommand:"QueryLinkedEntityGalleryButtons",
Icon:this.lQf(Db.FontLocator),LabelText:Db.Name,PreviewIconStyle:{["root"]:{["width"]:24,["min-width"]:24,["height"]:24}},Alt:this.CId(Db)})}vHh(qb){switch(qb){case "Animal":return La.a.rDh;case "Apple":return La.a.zEh;case "Atom":return La.a.hGh;case "Beaker":return La.a.nIh;case "Bridge":return La.a.WJh;case "Cat":return La.a.KQh;case "City":return La.a.ZSh;case "Constellation":return La.a.dYh;case "Dog":return La.a.Odi;case "Finance":return La.a.eIh;case "GradCap":return La.a.IZi;case "HumanAnatomy":return La.a.M6i;
case "LocationPointer":return La.a.kwj;case "Map":return La.a.ZZj;case "MedicineNeedle":return La.a.tDj;case "Mountain":return La.a.QEj;case "Movie":return La.a.hFj;case "Music":return La.a.vFj;case "OuterSpace":return La.a.K_j;case "Planet":return La.a.t3j;case "Satellite":return La.a.wsk;case "WolframGeneric":return La.a.qrk;default:return La.a.a_h}}n7i(qb){if("PowerBIRibbon"!==qb)return w.a.VCd;switch(qb){case "AnimalRibbon":return w.a.kni;case "AppleRibbon":return w.a.lni;case "AtomRibbon":return w.a.mni;
case "BeakerRibbon":return w.a.nni;case "BridgeRibbon":return w.a.oni;case "CenterMapRibbon":return w.a.pni;case "CityRibbon":return w.a.qni;case "CurrencyRibbon":return w.a.rni;case "ExerciseRibbon":return w.a.sni;case "FinanceRibbon":return w.a.xtf;case "FirstAidRibbon":return w.a.tni;case "GlobeLightningRibbon":return w.a.uni;case "GradCapRibbon":return w.a.vni;case "HumanAnatomyRibbon":return w.a.wni;case "LeafRibbon":return w.a.xni;case "LocationPointerRibbon":return w.a.zni;case "MapRibbon":return w.a.vtf;
case "MountainRibbon":return w.a.Ani;case "MovieRibbon":return w.a.Bni;case "MusicRibbon":return w.a.Cni;case "NotablePeopleRibbon":return w.a.Dni;case "OuterSpaceRibbon":return w.a.Eni;case "PartlySunnyWeatherRibbon":return w.a.Fni;case "PowerBIRibbon":return w.a.wtf;case "SatelliteRibbon":return w.a.Gni;case "WolframGenericRibbon":return w.a.yni;case "YogaRibbon":return w.a.Ini;default:return w.a.utf}}lQf(qb){switch(qb){case "AnimalRibbon":return"AnimalExcelDataTypes_24";case "AppleRibbon":return"AppleExcelDataTypes_24";
case "AtomRibbon":return"AtomExcelDataTypes_24";case "BeakerRibbon":return"BeakerExcelDataTypes_24";case "BridgeRibbon":return"BridgeExcelDataTypes_24";case "CenterMapRibbon":return"CenterMapExcelDataTypes_24";case "CityRibbon":return"CityExcelDataTypes_24";case "CurrencyRibbon":return"CurrencyExcelDataTypes_24";case "ExerciseRibbon":return"ExerciseExcelDataTypes_24";case "FinanceRibbon":return"Bank_32";case "FirstAidRibbon":return"FirstAidExcelDataTypes_24";case "GlobeLightningRibbon":return"GlobeLightning_24";
case "GradCapRibbon":return"GradCapExcelDataTypes_24";case "HumanAnatomyRibbon":return"HumanAnatomyExcelDataTypes_24";case "LeafRibbon":return"LeafExcelDataTypes_24";case "LocationPointerRibbon":return"LocationPointerExcelDataTypes_24";case "MapRibbon":return"OpenMap_24";case "MountainRibbon":return"MountainExcelDataTypes_24";case "MovieRibbon":return"MovieExcelDataTypes_24";case "MusicRibbon":return"MusicExcelDataTypes_24";case "NotablePeopleRibbon":return"NotablePeopleExcelDataTypes_24";case "OuterSpaceRibbon":return"OuterSpaceExcelDataTypes_24";
case "PartlySunnyWeatherRibbon":return"PartlySunnyWeatherExcelDataTypes_24";case "PowerBIRibbon":return"DataProtectionExcelDataTypes_24";case "SatelliteRibbon":return"SatelliteExcelDataTypes_24";case "WolframGenericRibbon":return"Lightning_24";case "YogaRibbon":return"YogaExcelDataTypes_24";default:return"ConvertToEntity_20"}}NAi(qb,Db){Db=this.Ya.$L("ConvertToLinkedEntitySection_"+Db,this.R3f,this.Q3f);var gb=!1;for(var ya of qb.DomainIds){const Aa=this.Ls.v4(ya);if(!Aa||Aa.DomainBlocked||!Aa.ShowInRibbon)continue;
gb=Aa.Name;const sb=a(952).ConvertToLinkedEntityManager.jhb(ya);Db.QC("Data.ConvertToLinkedEntityMenuItem_"+sb,-1203788282,"QueryLinkedEntityGalleryIcon",void 0,sb,this.lQf(Aa.FontLocator),void 0,void 0,this.CId(Aa),gb);gb=!0}if(!gb)return null;ya=Db.fnc(!0);Db=this.Ya.Oh();Db.title=qb.Name;qb=Db.gnc();qb.ControlList.push(ya);return qb}D4k(){this.R3f=5;this.Q3f="Size112by64"}CId(qb){return qb.RibbonTooltipHeader?qb.RibbonTooltipHeader+"\n\n"+qb.RibbonTooltip:qb.RibbonTooltip}}Object(x.a)(ib,"ConvertToLinkedEntityMenuRenderer",
null,[651]);var Yb=a(65),Wc=a(355),Qc=a(122),Wb=a(103),Jc=a(72);class ma{constructor(qb,Db){this.KOd=this.LOd=!1;this.p3a=gb=>{c.ULS.sendTraceTag(537166680,0,50,"OnReadRoamingStringSuccess called.");this.LOd=!0;if(db.a.Jk(gb.Errors))c.ULS.sendTraceTag(537166679,0,10,`OnReadRoamingStringSuccess encountered an error. Errors: ${db.a.Kh(gb.Errors)}`);else{var ya=0,Aa=[],sb=!1;try{if(!gb.Result)return;const nc=gb.Result;if(!nc){c.ULS.sendTraceTag(537166678,0,50,"OnReadRoamingStringSuccess - Received an empty roamingXml.");
return}Aa=this.t1j(nc);if(!Aa||!Aa.length)return;ya=Aa.length;this.KDj(Aa);this.WNa.KEg();c.ULS.sendTraceTag(537166677,0,50,`OnReadRoamingStringSuccess MruCount:${this.WNa.Nsb.length}`);if(Ta.EwaSettings.isChangeGateEnabled("OfficeVSO:5199912_LinkedEntityMruWolfram")){for(const Bb of this.WNa.Nsb)if(1===(Bb.Id&1048320)>>8){sb=!0;break}c.ULS.sendTraceTag(537166676,0,50,`OnReadRoamingStringSuccess MruWolframAvailable:${sb}`)}}finally{c.ULS.sendTraceTag(537166675,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${ya} data types.`),
gb=[],gb.push(Object(ha.a)(new Jc.a,{name:"MruCount",int64:ya})),gb.push(Object(ha.a)(new Jc.a,{name:"MruWolframAvailable",bool:sb})),Wb.a("ReadRecentlyUsedLinkedDataTypes",void 0,void 0,gb)}this.KOd&&(this.i7g(this.WNa.Nsb),this.KOd=!1)}};this.z3a=gb=>{c.ULS.sendTraceTag(537166674,0,50,"OnWriteRoamingStringSuccess called.");db.a.Jk(gb.Errors)?c.ULS.sendTraceTag(537166673,0,10,`OnWriteRoamingStringSuccess encountered an error. Errors: ${db.a.Kh(gb.Errors)}`):gb.Result&&(gb.Result||c.ULS.sendTraceTag(537166672,
0,15,"OnWriteRoamingStringSuccess - Failed to write to the roaming service."))};this.I_b=(gb,ya,Aa)=>{gb=Qc.a.Qj(gb.data);c.ULS.sendTraceTag(537166671,0,10,`OnRoamingOperationFailure: Encountered errors for ${Aa}. Errors: ${db.a.Kh(gb)}.`)};this.$=qb;this.WNa=Db}mSi(){!this.LOd&&this.$.ea.Ph&&(c.ULS.sendTraceTag(537166691,0,50,"GetRecentlyUsedLinkedDataTypesFromRoamingService - Invoking the GetRecentlyUsedDataTypes operation."),Wc.C(this.$.pa.ta,0,this.p3a,this.I_b,null,null))}i7g(qb){qb&&qb.length?
this.LOd?(qb=this.oxk(qb))?(c.ULS.sendTraceTag(537166688,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Invoking the WriteRecentlyUsedDataTypes operation."),Wc.J(this.$.pa.ta,0,qb,this.z3a,this.I_b,null,null)):c.ULS.sendTraceTag(537166689,0,15,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Created an empty serialized string."):this.KOd=!0:c.ULS.sendTraceTag(537166690,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Tried writing an empty list of data types.")}oxk(qb){if(!qb||
!qb.length)return c.ULS.sendTraceTag(537166687,0,15,"SerializeRecentlyUsedLinkedDataTypes - Received an empty list of data types."),null;var Db=[];for(const gb of qb)qb={},qb.Id=gb.Id,gb.StringId&&(qb.StringId=gb.StringId),Db.push(qb);Db="<DataTypes>"+Yb.a.li(Db)+"</DataTypes>";return 1906<Db.length?(c.ULS.sendTraceTag(537166686,0,15,"SerializeRecentlyUsedLinkedDataTypes - Exceeded the MaxSize for ridExcelRecentlyUsedLinkedDataTypes."),null):Db}t1j(qb){if(!qb)return c.ULS.sendTraceTag(537166685,0,
15,"ParseRecentlyUsedLinkedDataTypes - Received an empty roamingXml."),null;if(!qb.startsWith("<DataTypes>")||!qb.endsWith("</DataTypes>"))return c.ULS.sendTraceTag(537166684,0,15,"ParseRecentlyUsedLinkedDataTypes - Received a string without a prefix/postfix."),null;qb=qb.substring(11,qb.length-12);if(!qb)return c.ULS.sendTraceTag(537166683,0,15,"ParseRecentlyUsedLinkedDataTypes - Created an empty substring."),null;let Db=[];try{Db=Yb.a.Gp(qb)}catch(gb){return c.ULS.sendTraceTag(537166682,0,10,`ParseRecentlyUsedLinkedDataTypes - Encountered an exception. Message: ${gb.message}`),
null}c.ULS.sendTraceTag(537166681,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${Db.length} data types.`);return Db}KDj(qb){const Db=this.WNa.Nsb,gb=this.WNa.dck;if(Db.length!==gb){for(let ya=0;ya<qb.length&&Db.length<gb;++ya){const Aa=qb[ya];this.WNa.v4(Aa)&&!Db.includes(Aa)&&Db.push(Aa)}this.WNa.Nsb=Db}}}Object(x.a)(ma,"LinkedDataTypeRoamingHandler",null,[]);var Hc=a(63),Kb=a(79),pc=a(152),$b=a(40),Ib=a(58),Zb=a(32),Eb=a(252),ob=a(27),Na=a(106),nb=a(93),Hb=a(97),na=a(5),Gb=a(765),Xa;let Jb=Xa=
class extends e.a{constructor(qb,Db,gb,ya,Aa,sb,nc){super();this.J_f=this.jXd=this.sYd=this.NVd=this.MVd=this.JGc=null;this.oZb=this.nOd=0;this.rya=null;this.vSd=!1;this.AGd=this.cw=this.wje=null;this.fB=0;this.NQ=null;this.DZa=8;this.esd=this.P3f=this.cWf=this.crb=!1;this.QMa=this.vAf=this.Iwf=null;this.eqd=0;this.HHh=5;this.umc=3E4;this.vZg=!1;this.Pta=null;this.qHa=Array(5);this.t1g=this.qwe=!1;this.iGg=this.G_d=0;this.ji=this.UOe=null;this.JSg=!0;this.Oi=(Bb,uc)=>{uc.Ph&&!uc.KVb&&this.showUntrustedImageBusinessBarIfNecessary()};
this.YQj=Bb=>{if(Bb.Result){var uc=Bb.Result;if(uc&&uc.length){c.ULS.sendTraceTag(537166922,0,50,`OnGetRichDataClassificationLabelsSuccess: Received ${uc.length} labels`);var Pc=Kb.GetServiceTaskFactory.Bj(this.$.ka,274,275,0);$b.TaskExtensions.Ua(Pc,()=>{Pc.result.Rpd(uc,2)||c.ULS.sendTraceTag(537166921,0,10,"OnGetRichDataClassificationLabelsSuccess - Failed to apply the policy label.")},this.$.xa,3)}}else c.ULS.sendTraceTag(537166923,0,50,"OnGetRichDataClassificationLabelsSuccess: Received no result")};
this.ol=()=>{this.s_k();this.k1i(this.$.ea.Cq.LinkedEntityAsyncRefreshStateId);this.z2i(this.$.ea.Cq.RichDataClassificationLabelStateId)};this.eOj=()=>{this.qwe=!0;this.cw&&this.cw.vdk()};this.oQj=Bb=>{if(Bb&&!Eb.a(Bb))try{Bb.Result.HasUntrustedImageUrl&&(this.businessBar.xm(59,null),this.t1g=!0)}catch(uc){c.ULS.sendTraceTag(574718945,0,10,`ConvertToLinkedEntityManager.OnGetHasUntrustedImageUrlsFromServerSuccess: GetHasUntrustedImageUrls encountered exception ${uc}.`)}};this.n3f=()=>{if(!this.P3f&&
this.STb()&&!this.xTd())if(Wb.a("DataTabActive"),Hc.a.Al.cY)if(document.querySelector("#ConvertToLinkedEntityGallery-previewExpandButton")){var Bb=this.Fqc();if(Bb){var uc={};uc.InputMethod=oa.a.eh;uc.CalloutName=8;uc.Target="[data-unique-id=Ribbon-ConvertToLinkedEntityGallery-previewExpandButton]";this.$.Ma.dh(Bb,uc);this.P3f=!0}else c.ULS.sendTraceTag(537166880,0,10,"RibbonCommandInfo is null for LinkedEntityGalleryCallout")}else c.ULS.sendTraceTag(537166881,0,10,"Could not locate anchor for the LinkedEntityGalleryCallout");
else c.ULS.sendTraceTag(537166882,0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityGalleryCallout() - Attempted to launch linked entity gallery callout but callout not enabled")};this.PMj=Bb=>{db.a.Jk(Bb.Errors)||this.raiseEvent("LinkedEntityConverted")};this.yXj=()=>{Ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)?void Hb.a.hj(na.l).then(Bb=>{Bb.readText(bb.a.instance.ia(1813))}):this.$.ka.Lh(211,Bb=>{Bb.readText(bb.a.instance.ia(1813))})};this.xj=
(Bb,uc)=>{c.ULS.sendTraceTag(537166867,0,50,"ConvertToLinkedEntityManager.OnWorkbookOpened called");uc.W5?c.ULS.sendTraceTag(537166865,0,15,"ConvertToLinkedEntityManager.OnWorkbookOpened called while rendering cached content"):(this.$.isEditMode?this.cbf():this.Lok(),this.qwe&&this.Bpf())};this.yQj=Bb=>{this.Koc();if(Bb.Result){var uc=Bb.Result;Bb=uc.DomainDataArray;if(this.rya=uc.Ribbon){var Pc={};Pc.Name=bb.a.instance.ia(1803);Pc.DomainIds=this.RU;this.rya.Categories.splice(Xa.wob,0,Pc)}0<uc.MaximumCellsToConvert&&
(this.UOe=uc.MaximumCellsToConvert);this.fB=2;uc=!1;if(Bb){c.ULS.sendTraceTag(39949271,0,50,`OnGetLinkedEntityServiceDomainsSuccess: Received ${Bb.length} domains`);this.J1a||(this.J1a=[]);Pc=bb.a.instance.ia(1800);const wd=bb.a.instance.ia(1802);for(const Md of Bb)Md.DomainId?(this.J1a.push(Md),Md.DomainBlocked?(Bb=!!Md.DomainId.StringId,c.ULS.sendTraceTag(537166861,0,50,`Domain: ${Bb?Md.DomainId.Id.toString():Md.Name} is telemetry only, do not show in menu (Has String ID: ${Bb})`)):(this.u4.ga(Xa.jhb(Md.DomainId),
Md),Md.Name===Pc||268435456===Md.DomainId.Id?this.Iwf=Md.DomainId.Id.toString():Md.Name===wd||536870912===Md.DomainId.Id?this.vAf=Md.DomainId.Id.toString():268435712===Md.DomainId.Id&&Md.ShowInRibbon&&(this.esd=!0),uc=!0)):c.ULS.sendTraceTag(537166862,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.")}uc||(this.J1a=null);this.h2g();this.wje.mSi();this.vZg||(this.o_k(),this.vZg=!0)}else this.J1a=null,this.fB=3,-1<this.DZa&&window.setTimeout(()=>{this.b1b()},100*(8-this.DZa)),c.ULS.sendTraceTag(537166863,
0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");this.qee();this.Ihf();this.esd&&this.OXf&&pc.e(this.n3f,this.$.xa,500)};this.xQj=Bb=>{Bb=Qc.a.Qj(Bb.data);c.ULS.sendTraceTag(34415007,0,15,`OnGetLinkedEntityServiceDomainsFailure [Errors: ${db.a.Kh(Bb)}].`);this.J1a=null;this.fB=3;this.crb=!0;this.qee()};this.onContentReady=()=>{this.V_g()&&this.da.xE(this.onContentReady);this.JSg&&this.$.workbookContext.Options&1048576&&(this.businessBar.aOk(),this.JSg=!1)};this.Rp=()=>{this.Koc()};
this.VSj=Bb=>{if(Eb.a(Bb)){if(Ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",!1))void Hb.a.resolve(na.C,{va:0}).then(Pc=>{let wd=null;if(null===Bb||void 0===Bb?0:Bb.Errors)wd=Bb.Errors[0];Pc.zqe(wd,null)});else{const Pc=Object(nb.d)(Hb.a.resolve(na.C,{va:0}));$b.TaskExtensions.Ua(Pc,()=>{let wd=null;if(null===Bb||void 0===Bb?0:Bb.Errors)wd=Bb.Errors[0];Pc.result.zqe(wd,null)},this.$.xa,3)}c.ULS.sendTraceTag(537166800,0,15,`ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: ${db.a.Kh(Bb.Errors)}].`);
const uc=db.a.mS(Bb.Errors,[-1100324317,-2133389873],"ConvertToLinkedEntityManager:OnLinkedEntityTryAutoRefreshSuccessCore");this.$.ea.Yw(uc)}};this.Zrd=()=>{c.ULS.sendTraceTag(537166796,0,50,`ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a ${this.umc} millisecond interval`);this.cTf("Periodic auto-refresh check",this.YKj,this.XKj)};this.YKj=Bb=>{Eb.a(Bb)?(c.ULS.sendTraceTag(537166795,0,15,`ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: ${db.a.Kh(Bb.Errors)}].`),
++this.eqd):this.eqd=0;b.a.Ng(this.QMa);this.eqd>=this.HHh?(c.ULS.sendTraceTag(537166794,0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh"),this.QMa=null):(c.ULS.sendTraceTag(537166793,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext"),this.QMa=Ib.a.instance.create(this.Zrd,this.umc,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck"))};
this.XKj=Bb=>{Bb=Qc.a.Qj(Bb.data);f.a.qm(Bb)?c.ULS.sendTraceTag(537166791,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):c.ULS.sendTraceTag(537166792,0,15,`OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: ${db.a.Kh(Bb)}].`);b.a.Ng(this.QMa);this.QMa=Ib.a.instance.create(this.Zrd,this.umc,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")};this.aUj=Bb=>{Bb=!!Bb.Result&&Bb.Result;c.ULS.sendTraceTag(537166790,
0,50,`OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = ${Bb.toString()}`);Bb?(c.ULS.sendTraceTag(537166789,0,50,`OnNotifyFeatureLicensingStatusSuccess- successful handshake duration = ${Zb.a.Tg.qk.m-this.nOd} ms, retry count = ${this.oZb}`),this.b1b()):this.LYc()};this.$Tj=()=>{c.ULS.sendTraceTag(537166788,0,15,"OnNotifyFeatureLicensingStatusFailed");this.LYc()};this.aQj=Bb=>{Bb.Result?(Bb=Bb.Result)?(this.Ife(),this.businessBar.zqe(null,Bb)):c.ULS.sendTraceTag(537166725,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result"):
c.ULS.sendTraceTag(537166726,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result")};this.$=qb;this.businessBar=sb;this.svgIconProvider=gb;this.ji=nc;this.J1a=[];this.RU=[];this.da=Ia.f(this.$);this.uBc=-1;this.clj=Ta.EwaSettings.isChangeGateEnabled("OfficeVSO:4294127_LongButtonVisibleWhenAnyDomainOverrideShowsInRibbon");this.OXf=Ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityGalleryTeachUIEnabled",!1);this.u4=new Na.a;this.npb=new ib(qb,Db,this);ya&&
(this.cw=new lb(qb,ya,Aa,this,this));this.$.nr(this.xj);u.a(this.$)&&u.a(this.$).Yyk(this);this.cbf();this.$.ea.Xy(this.ol);Ta.EwaSettings.Ra(123)&&Ta.EwaSettings.Ra(131)&&(this.V_g()||this.da.Mz(this.onContentReady));this.$.hI(this.Rp);this.$.ea.uq(this.Oi);this.showUntrustedImageBusinessBarIfNecessary();this.wje=new ma(this.$,this)}dispose(){this.$.ea.pA(this.ol);this.$.ea.pq(this.Oi);!this.Pta&&Ta.EwaSettings.Ra(123)&&Ta.EwaSettings.Ra(131)&&this.da.xE(this.onContentReady);this.cw&&this.cw.dispose();
this.$.LK(this.Rp);this.$.Pr(this.xj);b.a.Ng(this.QMa)}mzh(qb){this.addHandler("LinkedEntityConverted",qb)}Mjk(qb){this.removeHandler("LinkedEntityConverted",qb)}get dck(){return 5}get Nsb(){return this.RU}set Nsb(qb){this.RU=qb}selectEntity(qb){return this.cw?this.cw.selectEntity(qb):!1}searchEntity(qb,Db){this.cw&&this.cw.searchEntity(qb,Db)}Fke(qb,Db,gb,ya){this.cw&&this.cw.searchEntity(qb,Db,!0,gb,ya)}MYb(qb){return this.cw?this.cw.MYb(qb):!1}onPaneClosed(){if(this.cw)this.cw.onPaneClosed()}cancelSearch(){this.cw&&
this.cw.cancelSearch()}L4b(qb){this.cw&&this.cw.L4b(qb)}Vvb(qb){this.cw&&this.cw.Vvb(qb)}Y6b(qb){this.cw&&this.cw.Y6b(qb)}n_a(qb,Db){this.cw&&this.cw.n_a(qb,Db)}z2i(qb){if(this.$.isEditMode&&this.iGg!==qb&&r.AFrameworkApplication.fa.la("SupportsPolicies")){this.iGg=qb;c.ULS.sendTraceTag(537166925,0,50,"HandleRichDataClassificationLabelStateIdChanged - Getting rich data classification labels");qb=this.$.pa.ta;var Db=this.YQj;const gb=qb.Za(1,null);D.h(qb,"GetRichDataClassificationLabels",gb,Db,null,
null,null,4)}}Bpf(){this.$.userOperationManager.enqueueOperation(new Za.a(589,0,(qb,Db,gb)=>{var ya=this.$.pa.ta;qb=mb.c(qb,this.eOj);const Aa=ya.Za(1,null);return D.h(ya,"LinkedEntitiesEnableUntrustedImages",Aa,qb,Db,gb,null,0)},80),null)}showUntrustedImageBusinessBarIfNecessary(){this.qwe||this.t1g||!this.$.ea.Ph||this.iwk()}iwk(){this.$.userOperationManager.enqueueOperation(new Za.a(588,0,(qb,Db,gb)=>{var ya=this.$.pa.ta;qb=mb.c(qb,this.oQj);const Aa=ya.Za(1,null);return D.h(ya,"GetHasUntrustedImageUrls",
Aa,qb,Db,gb,null,4)},80),null)}get nYb(){return this.qHa.length}get pDj(){return this.UOe}b_h(qb){(qb=this.Tdi(qb))?this.convertToLinkedEntity(qb):c.ULS.sendTraceTag(537166920,0,10,"Could not convert key into domain ID")}convertToLinkedEntity(qb){c.ULS.sendTraceTag(34415004,0,50,`ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: ${qb.Id}].`);if(this.da){var Db=this.da.ha.qa.Ui,gb=Db.pk(this.da.c5);this.vSd&&this.Hwh(qb);if(gb){gb=this.da.Yg.FKa(gb);if(!this.yNf(qb)&&
this.dZf(qb.Id)){c.ULS.sendTraceTag(537166918,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data");if(Hc.a.Al.cY){Db=this.PHd();if(!Db){c.ULS.sendTraceTag(537166917,0,50,"CalloutAnchorElement is null for blankCellConvert");return}gb=this.Fqc();if(!gb){c.ULS.sendTraceTag(537166916,0,50,"RibbonCommandInfo is null for blankCellConvert");return}var ya={["InputMethod"]:oa.a.eh,CalloutName:3};ya.Target=Db;ya.RibbonButtonLabel=Ta.EwaSettings.isChangeGateEnabled("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?
this.WFg(qb):this.GWb(qb.Id.toString());ya.ExampleEntities=this.Euf(qb);this.$.Ma.dh(gb,ya);return}c.ULS.sendTraceTag(537166915,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(this.dZf(qb.Id)&&!qb.StringId)this.launchLinkedEntityDataTypeSelectorPane(Xa.jhb(qb));else{if(gb){c.ULS.sendTraceTag(537166914,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range");
if(Ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LaunchStarterDataForBlankCell",!1)&&this.uTk(qb)){Db=ka.s(this.da.ha.qa.selectedRanges,this.$);this.cw.gtj(Db,qb);return}if(Hc.a.Al.cY){Db=this.PHd();if(!Db){c.ULS.sendTraceTag(537166913,0,50,"CalloutAnchorElement is null for blankCellConvert");return}gb=this.Fqc();if(!gb){c.ULS.sendTraceTag(537166912,0,50,"RibbonCommandInfo is null for blankCellConvert");return}ya={["InputMethod"]:oa.a.eh,CalloutName:2};ya.Target=Db;ya.RibbonButtonLabel=
this.WFg(qb);ya.ExampleEntities=this.Euf(qb);ya.BlankCellResourceId=this.PIh(qb);ya.HasBlankCellWalkthrough=this.D3i(qb);ya.ServiceDomain=qb.Id;this.$.Ma.dh(gb,ya);return}c.ULS.sendTraceTag(537166883,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}this.Ovd(qb,!1,Db)}}}else c.ULS.shipAssertTag(537166919,0,!1,"grid view should not be null")}convertToLinkedEntityFromAutoDetect(){this.Pta&&this.Pta.kWa()}onAutoDetectUIShown(){wa.a(this.$.userOperationManager,
(qb,Db,gb)=>{var ya=this.$.pa.ta;const Aa=ya.Za(1,null);return D.h(ya,"OnAutoDetectUIShown",Aa,qb,Db,gb,null,4)},qb=>new Za.a(230,0,qb,80),null)}Ovd(qb,Db,gb){const ya=ka.r(gb,this.$),Aa=()=>new Ha.a;wa.a(this.$.userOperationManager,(sb,nc,Bb)=>{var uc=this.$.pa.ta;sb=mb.c(sb,this.PMj,this.yXj,this.cw.OMj);const Pc=uc.Za(1,null);Pc.selectedRanges=ya;Pc.domainId=qb;Pc.autodetect=Db;return D.h(uc,"ConvertToLinkedEntity",Pc,sb,nc,Bb,null,4)},sb=>new Za.a(115,0,sb,void 0,Aa),null)}Hwh(qb){if(this.vSd){var Db=
{};Db.Id=qb.Id;qb.StringId&&(Db.StringId=qb.StringId);if(!(0<this.RU.length&&this.RU[0].Id===Db.Id&&this.RU[0].StringId===Db.StringId)){qb=!1;this.RU.splice(0,0,Db);for(let gb=1;gb<this.RU.length;++gb)if(this.RU[gb].Id===Db.Id&&this.RU[gb].StringId===Db.StringId){this.RU.splice(gb,1);qb=!0;break}for(;5<this.RU.length;)this.RU.splice(this.RU.length-1,1);this.rya.Categories[Xa.wob].DomainIds=this.RU;this.KEg();qb||this.wje.i7g(this.RU)}}}convertLinkedEntityToText(){c.ULS.sendTraceTag(34719501,0,50,
"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted");if(this.da){var qb=ka.r(this.da.ha.qa.Ui,this.$);wa.a(this.$.userOperationManager,(Db,gb,ya)=>{var Aa=this.$.pa.ta;const sb=Aa.Za(1,null);sb.selectedRanges=qb;return D.h(Aa,"ConvertLinkedEntityToText",sb,Db,gb,ya,null,4)},Db=>new Za.a(116,0,Db),null)}else c.ULS.shipAssertTag(537166879,0,!1,"grid view should not be null")}refreshLinkedEntitiesInRange(){c.ULS.sendTraceTag(537166878,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange() - refresh attempted");
if(Ia.f(this.$)){this.$.isEditMode||c.ULS.sendTraceTag(537166876,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange(): Refreshing selection during view mode");this.Ife();var qb=ka.s(this.da.ha.qa.selectedRanges,this.$);wa.a(this.$.userOperationManager,(Db,gb,ya)=>{var Aa=this.$.pa.ta;const sb=Aa.Za(1,null);sb.selectedRanges=qb;return D.h(Aa,"RefreshLinkedEntitiesInRange",sb,Db,gb,ya,null,4)},Db=>new Za.a(248,0,Db),null)}else c.ULS.shipAssertTag(537166877,0,!1,"grid view should not be null")}yJk(qb){qb=
this.v4(qb.DomainId);if(!qb||qb.DomainBlocked||!qb.HasCuratedData)return!1;if(this.clj){for(const Db of this.u4)if(Db.value.DomainId.Id===qb.DomainId.Id&&Db.value.ShowInRibbon)return!0;return!1}return qb.ShowInRibbon}QHk(qb){return 2!==this.fB||!this.qHa[qb]}launchDisambiguationPaneForSearch(){this.cw&&this.cw.launchDisambiguationPaneForSearch()}Ji(qb,Db,gb){if("PopulateConvertToLinkedEntityMenu"!==Db)return!1;this.AGd=gb.MenuId;if(0===this.fB||3===this.fB)return this.$3j(),!0;if(!this.rya)return c.ULS.sendTraceTag(537166873,
0,10,"PopulateMenu: Encountered null ribbon section info"),!1;if(!this.u4)return c.ULS.sendTraceTag(537166872,0,10,"PopulateMenu: Encountered null domain collection"),!1;this.NQ=this.NQ||this.npb.cAi(this.rya,gb.MenuId);gb.MenuItems=this.NQ;return this.vSd=!0}$3j(){-1===this.uBc&&(this.b1b(),this.uBc=window.setInterval(()=>{this.b1b()},2E3))}b1b(){if(this.$.ea.Ph&&2!==this.fB){this.DZa--;c.ULS.sendTraceTag(537166870,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted.");
this.fB=1;var qb=this.$.pa.ta,Db=this.yQj,gb=this.xQj;const ya=qb.Za(1,null);D.h(qb,"GetLinkedEntityMetadata",ya,Db,gb,null,null,4)}}xTd(){return this.$.isEditMode&&2!==this.fB&&(0<=this.DZa||!this.crb)}exe(qb){r.AFrameworkApplication.Il?c.ULS.sendTraceTag(537166869,0,50,"UpdatePreviewGalleryVisibility bailed out on shutting down."):u.a(this.$)?(this.m5k(),qb&&this.$.jm()):c.ULS.sendTraceTag(537166868,0,50,"UpdatePreviewGalleryVisibility bailed out on null RibbonManager.")}Lok(){this.oZb=0;this.DZa=
8;this.crb=!1;this.fB=this.uBc=0;this.J1a=this.rya=null;this.Koc();for(let qb=0;qb<this.nYb;++qb)this.qHa[qb]=null;this.STb()&&this.exe(!0)}Koc(){this.NQ=null}STb(){const qb=l.a.Hsb,Db=u.a(this.$);return!!Db&&Db.ns.rA===qb}h2g(){if(this.rya){let gb=0;var qb=-1,Db=-1;let ya=0,Aa=0,sb=0,nc=0;const Bb=[null,null,null,null,null];for(const uc of this.rya.Categories){let Pc=!1;for(const wd of uc.DomainIds){const Md=this.v4(wd);Md&&!Md.DomainBlocked&&Md.ShowInRibbon&&(gb<this.nYb?(this.qHa[gb]=wd,Aa===Xa.wob&&
(-1===qb&&(qb=gb),Db=gb,nc=Db-qb+1),++gb):gb===this.nYb&&ya<nc&&Aa!==Xa.wob&&(Bb[ya]=wd,++ya),Pc=!0)}Pc&&++sb;++Aa}if(-1<qb&&sb<=Xa.S3f){for(;Db>=qb;--Db)this.qHa.splice(Db,1);for(qb=0;qb<nc;++qb)this.qHa.splice(gb+qb,0,Bb[qb])}for(;gb<this.nYb;)this.qHa[gb]=null,++gb}}V_g(){const qb=Ia.f(this.$).za,Db=this.da.ha.wk;if(qb&&qb.rOd&&1===Db&&this.da.ha.qa.activeCell){if(Ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",!1))void Hb.a.resolve(na.Cf,{va:1}).then(gb=>
{this.Pta=new n.a(this.$,this.svgIconProvider,gb,this,this.ji)});else{const gb=Object(nb.d)(Hb.a.resolve(na.Cf,{va:1}));$b.TaskExtensions.Ua(gb,()=>{this.Pta=new n.a(this.$,this.svgIconProvider,gb.result,this,this.ji)},this.$.xa,3)}return!0}return!1}jtj(){this.cw&&this.cw.g_d(!0)}launchLinkedEntityDataTypeSelectorPane(qb){if(this.cw)if(qb=this.mAd(qb))if(qb.DomainId.StringId)c.ULS.sendTraceTag(537166855,0,10,"Domain with a string ID used when launching Data Type Selector pane");else{var Db=ka.s(this.da.ha.qa.selectedRanges,
this.$);this.cw.launchLinkedEntityDataTypeSelectorPane(Db,qb.DomainId.Id)}else c.ULS.sendTraceTag(537166856,0,10,"Unknown domain used when launching Data Type Selector pane")}iYh(qb){const Db=this.m7i(qb),gb=d.a.Xq(this.GWb(qb));qb=d.a.Xq(this.Hue(qb));return Xa.Jzi(Db,Ka.a.$m(11),gb,qb)}Hue(qb){try{return this.vnf(parseInt(qb,10)).Description}catch(Db){}return bb.a.instance.ia(1797)}GWb(qb){try{return this.vnf(parseInt(qb,10)).Name}catch(Db){}return bb.a.instance.ia(1783)}WFg(qb){try{return this.v4(qb).Name}catch(Db){}return this.GWb(qb.Id.toString())}PIh(qb){try{return this.v4(qb).BlankCellResourceId}catch(Db){}return null}D3i(qb){try{return this.v4(qb).HasBlankCellWalkthrough}catch(Db){}return!1}yNf(qb){try{const Db=
Xa.jhb(qb);if(this.u4.Vg(Db))return this.u4.ma(Db).HasCuratedData}catch(Db){}return!1}uTk(qb){try{return this.v4(qb).SupportsStarterData}catch(Db){}return!1}dZf(qb){return 268435968===qb}PHd(){return 2===u.a(this.$).rS?"[data-unique-id=LinkedEntity_MLR]":"[data-unique-id=LinkedEntity]"}Fqc(){return new ab.a(-847286761,oa.a.eh,this.$.Rh,0,l.a.b7)}Ihf(){if(this.STb()&&!this.xTd()&&!this.cWf&&Ta.EwaSettings.Ra(387)&&this.yNf({Id:268435968,StringId:null}))if(c.ULS.sendTraceTag(537166819,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - tried to launch first org data teaching callout"),
Hc.a.Al.cY){const gb=this.PHd();if(gb){var qb=this.Fqc();if(qb){var Db={["InputMethod"]:oa.a.eh,CalloutName:6};Db.Target=gb;Db.ShouldCanvasTakeFocus=!0;this.$.Ma.dh(qb,Db);this.cWf=!0}else c.ULS.sendTraceTag(537166817,0,10,"RibbonCommandInfo is null for firstOrgData")}else c.ULS.sendTraceTag(537166818,0,10,"CalloutAnchorElement is null for firstOrgData")}else c.ULS.sendTraceTag(537166816,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - Attempted to launch firstOrgData callout, teaching callout not enabled")}V6i(qb){qb=
this.mAd(qb);return qb?this.npb.vHh(qb.SubdomainFontLocator):(c.ULS.sendTraceTag(537166815,0,10,"ConvertToLinkedEntityManager.IconFromDomainFontLocator: Requested domain that doesn't exist in collection"),null)}oEc(qb){return this.Pta?this.Pta.uHh(qb):!1}ZCi(){return this.Pta?this.Pta.TDi():""}iIi(qb,Db){const gb=this.WQf(qb);if(0>gb)c.ULS.sendTraceTag(537166813,0,10,`Unexpected menuItemKey for dynamic preview gallery button: ${qb}`);else if(qb=(qb=this.wnf(qb))?this.v4(qb):null)Db[k.a.GalleryButtonProps]=
this.npb.GAi(gb,qb),Db[k.a.Alt]=this.npb.CId(qb)}KEg(){this.h2g();this.STb()&&this.exe(!0);this.Koc()}m7i(qb){return qb===this.Iwf?w.a.xtf:qb===this.vAf?w.a.vtf:w.a.utf}Euf(qb){try{return this.v4(qb).ExampleEntities}catch(Db){}return bb.a.instance.ia(1805)}qee(){(0>this.DZa||this.crb)&&c.ULS.sendTraceTag(537166811,0,15,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(2===this.fB||0>this.DZa||this.crb)&&window.clearInterval(this.uBc);this.xTd()?this.AGd&&this.$.frame.wA(this.AGd):
this.exe(this.STb())}Fh(qb){return this.$.$h+qb}m5k(){var qb=!0;const Db=Array(this.nYb),gb=u.a(this.$)?u.a(this.$).ns:null;if(gb){for(let ya=0;ya<Db.length;++ya)this.QHk(ya)?Db[ya]=!0:qb=Db[ya]=!1;gb.jNg(["ConvertToLinkedEntityGallery"],qb);if(!qb)for(qb=0;qb<Db.length;++qb)Db[qb]&&gb.jNg([this.hIi(qb)],!0)}else c.ULS.sendTraceTag(537166809,0,15,"UpdateLinkedEntityGalleryButtonsVisibility: ribbonUser should not be null")}v4(qb){const Db=Xa.jhb(qb);if(this.u4.Vg(Db))return this.u4.ma(Db);c.ULS.sendTraceTag(592729218,
0,15,`No domain data for domain ID ${qb.Id} (Has String ID: ${!!qb.StringId})`);return null}hIi(qb){return"ConvertToLinkedEntityPreview"+qb.toString()}Ywe(){t.a.get_instance().Fm(10,()=>{this.Ihf();this.esd&&this.OXf&&pc.e(this.n3f,this.$.xa,500)})}iBc(qb,Db){switch(qb){case "QueryLinkedEntityGalleryButtons":if(!Db[k.a.InnerHTML]){qb=Db[oa.a.Ai].toString();const gb=ob.a.equals(qb,bb.a.instance.ia(1800),!0)||ob.a.equals(qb,bb.a.instance.ia(1801),!0),ya=ob.a.equals(qb,bb.a.instance.ia(1802),!0);gb||
ya||this.iIi(qb,Db)}break;case "QueryLinkedEntityMenuGalleryButtons":Db[k.a.InnerHTML]||(Db[k.a.InnerHTML]=this.iYh(Db[oa.a.Ai]))}return Db}Tdi(qb){var Db=this.wnf(qb);if(Db)return Db;if(Db=this.mAd(qb))return Db.DomainId;c.ULS.sendTraceTag(537166805,0,10,`Could not convert key into domain: ${qb}`);return null}vnf(qb){const Db={};Db.Id=qb;return this.v4(Db)}mAd(qb){return this.u4.Vg(qb)?this.u4.ma(qb):null}WQf(qb){if(!qb.startsWith(Xa.IAd))return-1;const Db=parseInt(qb.substr(Xa.IAd.length),10);return isNaN(Db)?
(c.ULS.sendTraceTag(537166802,0,10,`Unexpected index in preview gallery button key: ${qb}`),-1):Db}wnf(qb){qb=this.WQf(qb);return 0>qb?null:this.qHa[qb]}cTf(qb,Db,gb){if(this.u4&&this.u4.count){c.ULS.sendTraceTag(537166801,0,50,`ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. (${qb})`);var ya=this.$.pa.ta.Jh();this.$.ea.Ph&&(qb=this.$.pa.ta,Db=mb.c(this.VSj,Db),ya=qb.Za(1,void 0===ya?null:ya),D.h(qb,"LinkedEntityTryAutoRefresh",ya,Db,gb,null,null,0))}}o_k(){this.cTf("Auto-refresh on load",
null,null)}s_k(){this.u4&&this.u4.count&&(this.QMa?c.ULS.sendTraceTag(537166799,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one"):this.$.ea.Cq.HasAutoRefreshableLinkedEntityDomainsEver?(c.ULS.sendTraceTag(537166797,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context"),this.QMa=Ib.a.instance.create(this.Zrd,
this.umc,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")):c.ULS.sendTraceTag(537166798,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created"))}LYc(){if(this.$.ea.Ph&&null!=this.JGc&&null!=this.MVd&&null!=this.NVd&&null!=this.sYd&&null!=this.jXd)if(++this.oZb,12>=this.oZb){1===this.oZb&&(this.nOd=Zb.a.Tg.qk.m,c.ULS.sendTraceTag(537166752,0,50,"StartLinkedEntityDelayedHandshake - starting handshake."));
const qb=this.$.pa.ta.Jh();Wc.z(this.$.pa.ta,this.tuj,this.uuj(),this.aUj,this.$Tj,null,qb)}else c.ULS.sendTraceTag(537166751,0,15,`StartLinkedEntityDelayedHandshake - Retry count expired - failed handshake duration ${Zb.a.Tg.qk.m-this.nOd} ms`),this.crb=!0,this.qee()}cbf(){if(this.$.isEditMode)if(null!=this.JGc)this.LYc();else{var qb=Zb.a.Tg.qk.m,Db=[];m.a.instance.Qi("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(gb=>{gb.isFeatureEnabled("ExcelPowerBiPro",!1).then(ya=>
{c.ULS.sendTraceTag(537166747,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPro"} takes ${Zb.a.Tg.qk.m-qb} Millisecond.`);c.ULS.sendTraceTag(537166746,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPro"}] isEnabled=[${ya}]`);return this.JGc=ya}).then(()=>{Db.push(gb.isFeatureEnabled("ExcelWolframAlpha",!1).then(ya=>{c.ULS.sendTraceTag(590960588,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelWolframAlpha"} takes ${Zb.a.Tg.qk.m-qb} Millisecond.`);
c.ULS.sendTraceTag(537166743,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelWolframAlpha"}] isEnabled=[${ya}]`);return this.sYd=ya}))}).then(()=>{Db.push(gb.isFeatureEnabled("ExcelDisableStockGeographyDataTypes",!1).then(ya=>{c.ULS.sendTraceTag(537166741,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelDisableStockGeographyDataTypes"} takes ${Zb.a.Tg.qk.m-qb} Millisecond.`);c.ULS.sendTraceTag(537166740,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelDisableStockGeographyDataTypes"}] isEnabled=[${ya}]`);
const Aa=[Object(ha.a)(new Jc.a,{name:"IsRestrictedByLicense",bool:ya})];Wb.a("SatoriStockGeographyLicensingRestrictions",void 0,void 0,Aa);this.J_f=ya&&Ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StockGeographyLicensingCheck",!1);return ya}))}).then(()=>{Db.push(gb.isFeatureEnabled("StockHistory",!1).then(ya=>{c.ULS.sendTraceTag(537166739,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"StockHistory"} takes ${Zb.a.Tg.qk.m-qb} Millisecond.`);c.ULS.sendTraceTag(537166738,0,50,
`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"StockHistory"}] isEnabled=[${ya}]`);return this.jXd=ya}))}).then(()=>{Db.push(gb.isFeatureEnabled("ExcelPowerBiFree",!1).then(ya=>{c.ULS.sendTraceTag(537166736,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiFree"} takes ${Zb.a.Tg.qk.m-qb} Millisecond.`);c.ULS.sendTraceTag(537166735,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiFree"}] isEnabled=[${ya}]`);return this.MVd=ya}))}).then(()=>{Db.push(gb.isFeatureEnabled("ExcelPowerBiPremiumPerUser",
!1).then(ya=>{c.ULS.sendTraceTag(537166734,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPremiumPerUser"} takes ${Zb.a.Tg.qk.m-qb} Millisecond.`);c.ULS.sendTraceTag(537166733,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPremiumPerUser"}] isEnabled=[${ya}]`);return this.NVd=ya}))}).then(()=>{Promise.all(Db).then(()=>{this.LYc()})})})}}get tuj(){return"ExcelPowerBiPro ExcelWolframAlpha StockHistory ExcelPowerBiFree ExcelPowerBiPremiumPerUser ExcelDisableStockGeographyDataTypes".split(" ")}uuj(){return[this.JGc,
this.sYd,this.jXd,this.MVd,this.NVd,this.J_f]}Ife(){this.businessBar&&this.businessBar.N5(58)&&this.businessBar.removeEntry(58)}k1i(qb){if(this.G_d!==qb&&this.businessBar)if(this.G_d=qb){qb=this.$.pa.ta;var Db=this.aQj;const gb=qb.Za(1,null);D.h(qb,"GetErrorMessageForLinkedDataTypeRefresh",gb,Db,null,null,null,4)}else this.Ife()}static Jzi(qb,Db,gb,ya){qb=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"></span>',qb,Db,ya);gb=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}</p></div>',
gb);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}</div>',qb,gb)}static jhb(qb){return qb.StringId?qb.Id.toString()+"."+qb.StringId:qb.Id.toString()}};Jb.gof="ConvertToLinkedEntityPreview";Jb.IAd="PreviewGalleryButtonIndex.";Jb.wob=0;Jb.S3f=2;Jb=Xa=Object(y.__decorate)([Object(Hb.d)(na.fb),Object(y.__param)(0,Object(na.Lb)()),Object(y.__param)(1,Object(na["if"])()),Object(y.__param)(2,Object(Gb.m)()),Object(y.__param)(3,Object(na.Jb)()),Object(y.__param)(4,
Object(na.We)()),Object(y.__param)(5,Object(na.C)()),Object(y.__param)(6,Object(na.kd)())],Jb);Object(x.a)(Jb,"ConvertToLinkedEntityManager",e.a,[636,637,2,638])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.pi.js.map/5ead8162c9ca11b7b833451609e52d3f/EwaTS.pi.js.map