'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[57],{864:function(y,x,a){a.r(x);y={};a.r(y);a.d(y,"RecoveryUIController",function(){return J});x=a(179);var c=a(0),b=a(2),f=a(14),r=a(154),d=a(1533),k=a(17),t=a(155),m=a(7),e=a(58),w=a(32),l=a(24),u=a(1),n=a(45),v=a(40),B=a(79),z=a(5),C=a(97),D=a(156);let J=class{constructor(W,N){this.recoveryUI=null;this.mH=!1;this.l3g=()=>{this.recoveryUI&&(this.Uye=w.a.Tg.qk.m,this.hide(),e.a.instance.create(()=>{this.$5k()},
250,"RecoveryUI.UpdatePositionOnVisibleAreaChanged",void 0,!0))};this.umf=M=>{10===M&&this.gva()};this.Vbi=()=>{if(this.recoveryUI){const M=document.getElementById(this.recoveryUI.GId());M&&m.a.pr===M.getAttribute(m.a.Pka)&&M.click();this.documentHidden=!0;this.gva()}};this.vmf=()=>{this.gva()};this.wmf=()=>{this.gva()};this.onKeyUp=M=>{if(this.recoveryUI){if(this.aLa)return!1;if(17===M.La.keyCode&&this.xvc){M=document.getElementById(this.recoveryUI.GId());if(!M)return f.ULS.shipAssertTag(537154070,
0,!1,"RecoveryUIController.OnKeyUp: recoveryUIElement is null."),!1;const Q=M.getAttribute(m.a.Pka)||"";if(m.a.RB===Q)return M.click(),!0}}return!1};this.onKeyDown=M=>{if(this.recoveryUI){this.xvc=!1;this.aLa=M.ctrlKey;M=M.La.keyCode;if(27===M)return this.gva(),(M=this.$.ka.Ug(254))&&M.ux("RecoveryUIController.onKeyDown",!0,!0).catch(()=>{}),!0;if(17===M)return this.xvc=!0}return!1};this.bS=(M,Q)=>{this.KWb=M=Q.Ah;if(u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",
!0)){switch(M.command){case -1027730316:case -1059615499:if(Q.properties&&Q.properties.launcherId===this.BFf())return;break;case -847286761:if(Q.properties&&(13===Q.properties.CalloutName||18===Q.properties.CalloutName))return;break;case 974713501:return}this.gva()}else 974713501!==M.command&&(-1027730316!==M.command&&-1059615499!==M.command?this.gva():(Q=Q.properties)&&Q.launcherId!==this.BFf()&&this.gva())};this.$=W;this.iRc=N;this.oD=r.a.instance;this.Ht=t.a.instance.WT();this.IIc=this.KWb=this.$Yd=
null;this.aLa=this.xvc=this.Ysc=this.aCc=!1;this.Uye=0;this.documentHidden=!1;this.grid=l.f(this.$);this.pasteRange=null;this.mH=u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackAsyncContextMenu",!1)}dispose(){this.S0g();this.Y0g();this.IIc=this.$Yd=this.recoveryUI=this.Ht=this.oD=this.iRc=this.$=null;this.Uye=0}Dqd(W){this.recoveryUI=W;this.$Yd=W.QBh;this.IIc=W.$ck}gva(){this.recoveryUI&&(this.pasteRange=n.Q(this.recoveryUI.qvf),this.oVj(this.pasteRange),this.hide(),this.S0g(),this.recoveryUI=
null)}oVj(W){z.jg.Ha()?void C.a.resolve(z.jg,{va:1}).then(N=>{N.TZg(this.KWb,this.documentHidden,W);this.KWb=null;this.documentHidden=!1}):v.TaskExtensions.Ua(B.GetServiceTaskFactory.Bj(this.$.ka,534,535,1),N=>{N.result.TZg(this.KWb,this.documentHidden,W);this.KWb=null;this.documentHidden=!1},this.$.xa,3)}xUj(W){z.jg.Ha()?void C.a.resolve(z.jg,{va:1}).then(N=>{N.SZg(W)}):v.TaskExtensions.Ua(B.GetServiceTaskFactory.Bj(this.$.ka,534,535,1),N=>{N.result.SZg(W)},this.$.xa,3)}zZf(){var W;return!!this.recoveryUI&&
(null===(W=this.iRc)||void 0===W?void 0:W.hUb)}yqe(W,N){const M=n.Q(this.recoveryUI.qvf);this.xUj(M);this.recoveryUI?this.show(W,N):f.ULS.shipAssertTag(537154072,0,!1,"RecoveryUIController.ShowRecoveryUI: recoveryUI is null.")}BFf(){return this.recoveryUI?this.recoveryUI.u3f:null}show(W,N){const M=this.recoveryUI.QHi();M?(N&&this.mH&&D.b(this.$).ix(N.rawEvent,"context_menu_show_recovery_floatie",null,["floatie"]),this.iRc.showFloatie(Object(b.a)(new d.a,{x:M.x,y:M.y}),this.recoveryUI.HIa(),W),this.fq()):
f.ULS.sendTraceTag(537154071,0,100,"RecoveryUIController.Show: point is null.")}hide(){this.zZf()&&this.iRc.xI();this.Y0g()}fq(){if(!this.Ysc){var W=l.f(this.$);W.view.Wy(this.l3g);W.fp.nv(this.vmf);this.Ht.Aa("blur",this.Vbi);this.$.Ma.Ocb(this.bS);this.$.sa.Qm(this.wmf);(W=z.Ob.Ha()?C.a.Zg(z.Ob):this.$.ka.Ug(65))&&W.Gea&&W.Gea.registerForCommentEvents(this.umf);this.Ysc=!0}this.aCc||(this.oD.yD(k.a.zi,this.$.domElement,this.onKeyDown,!0),this.oD.yD(k.a.Rj,this.$.domElement,this.onKeyUp,!0),this.aCc=
!0)}S0g(){if(this.Ysc){var W=l.f(this.$);W.view.Kx(this.l3g);W.fp.ev(this.vmf);this.Ht.detach("blur");this.$.Ma.n5a(this.bS);this.$.sa.hn(this.wmf);(W=z.Ob.Ha()?C.a.Zg(z.Ob):this.$.ka.Ug(65))&&W.Gea&&W.Gea.unregisterForCommentEvents(this.umf);this.Ysc=!1}}Y0g(){this.aCc&&(this.oD.KD(k.a.zi,this.$.domElement,this.onKeyDown,!0),this.oD.KD(k.a.Rj,this.$.domElement,this.onKeyUp,!0),this.aCc=this.aLa=this.xvc=!1)}$5k(){this.recoveryUI&&250<=w.a.Tg.qk.m-this.Uye&&this.show(-1)}};J=Object(x.__decorate)([Object(C.d)(z.Ze),
Object(x.__param)(0,Object(z.Lb)()),Object(x.__param)(1,Object(z.Ue)())],J);Object(c.a)(J,"RecoveryUIController",null,[47,2]);String(y);window.___1708742503503_closurehack=y}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.rui.js.map/4dae72c196be75deecd43ff13b24f20f/EwaTS.rui.js.map