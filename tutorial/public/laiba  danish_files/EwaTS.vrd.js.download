'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[48],{1144:function(y,x,a){a.r(x);a.d(x,"FormulaBar",function(){return Eb});y=a(0);var c=a(14),b=a(100),f=a(6),r=a(154),d=a(17),k=a(96),t=a(884),m=a(34),e=a(409),w=a(101),l=a(19),u=a(7),n=a(301),v=a(722),B=a(720),z=a(553),C=a(176),D=a(150);x=a(80);var J=a(105);class W extends J.a{constructor(ob,Na,nb,Hb,na,Gb){super(ob);this.CY=()=>{this.domElement.disabled||(this.rpc.className=this.csc+" "+this.U$f)};this.BY=()=>
{this.domElement.disabled||(this.rpc.className=this.csc+" "+this.SEj)};this.Vjg=Xa=>{if(!this.domElement.disabled){const Jb=Xa.keyCode;if("mousedown"===Xa.type||13===Jb||32===Jb)this.rpc.className=this.csc+" "+this.H6j}};this.Wjg=()=>{this.domElement.disabled||(this.rpc.className=this.csc+" "+this.U$f)};this.csc=nb;this.U$f=Hb;this.SEj=na;this.H6j=Gb;this.Wi.Aa("mouseover",this.CY);this.Wi.Aa("mouseout",this.BY);this.Wi.Aa("focus",this.CY);this.Wi.Aa("blur",this.BY);this.Wi.Aa("mousedown",this.Vjg);
this.Wi.Aa("keydown",this.Vjg);this.Wi.Aa("mouseup",this.Wjg);this.Wi.Aa("keyup",this.Wjg);this.rpc=Na}}Object(y.a)(W,"PseudoClassBehavior",J.a,[]);var N=a(16);class M extends x.a{constructor(ob){super();this.instances=[];this.$=ob}dispose(){k.a.Ni(this.instances);this.instances.length=0;this.$=null;super.dispose()}rmc(ob,Na,nb,Hb,na){const Gb=N.DOMElementExtensions.getElementById(this.$.domElement,this.$.$h+ob);ob=ob===Na?Gb:N.DOMElementExtensions.getElementById(this.$.domElement,this.$.$h+Na);if(!Gb)return null;
nb=new W(Gb,ob,nb,Hb,"",na);this.instances.push(nb);return nb}}M.gNh="ewa-menu-btn-hover";M.iNh="ewa-menu-btn-pressed";Object(y.a)(M,"InitializePseudoClasses",x.a,[]);var Q=a(25),R=a(279),O=a(204),U=a(161),K=a(40),F=a(24);class I{constructor(ob,Na){this.$=ob;this.Gi=Na;n.a(this.$).Eq(this)}get Pi(){return this.Gi.$b.Ll}get Co(){return F.f(this.$).isEditing&&F.f(this.$).fA}get Hk(){return R.a.Ryf}zp(ob,Na){Na||N.DOMElementExtensions.setFocus(this.Pi);return!Na}Yp(ob){return N.DOMElementExtensions.Cn(this.Pi,
ob)}gs(){}Xt(){}dispose(){n.a(this.$).FH(this)}}Object(y.a)(I,"FormulaBarFocusManager",null,[59,2]);var P=a(286),Y=a(302),ea=a(59),Ba=a(86),Fa=a(902),za=a(168),xa=a(1);class fa extends x.a{constructor(ob=null,Na,nb,Hb=null){super();this.h4a=this.hlb=this.Xib=this.NQc=null;this.CGd=Q.a.dA()?16:13;this.DGd=Q.a.dA()?16:13;this.ohg=()=>{const na=new Ba.a(753860909,2,this.$.Rh,2,null);this.$.Ma.dh(na);return!0};this.phg=na=>na.La.keyCode===b.a.fu?(na=new Ba.a(753860909,1,this.$.Rh,2,null),this.$.Ma.dh(na),
!0):!1;this.qhg=()=>{this.da.isEditing&&this.da.fp.$b.Smc();return!1};this.$=nb;this.da=F.f(nb);this.Fq=Na;this.svgIconProvider=Hb;Q.a.dA()?this.Xib=N.DOMElementExtensions.getElementById(this.$.domElement,this.$.$h+u.a.IOb):(this.Cyi=Na.ia(1035),this.NQc=ob.rmc(u.a.IOb,u.a.IOb,l.a.zzf+" "+l.a.K_,l.a.JZi,""),this.Xib=this.NQc.domElement);this.T8i(this.Xib)}T8i(ob){xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8026743_insertFunctionButtonTooltipEnabled")&&(ob.role="button",ob.title=this.Fq.ia(1035));
this.hlb=this.svgIconProvider?this.svgIconProvider.lna(Fa.a.Byi,this.CGd,this.DGd,ob,void 0,void 0,void 0,this.Fq.ia(1035)):za.b(this.DGd,this.CGd,l.a.Lmi,ea.a.$m(0),null,null,!0,this.Fq.ia(1035));ob.appendChild(this.hlb);P.a.instance.ya(d.a.click,ob,this.ohg);r.a.instance.ya(d.a.zi,ob,this.phg);Y.a.instance.ya(d.a.Zi,ob,this.qhg)}dispose(){this.x8a(this.Xib);this.Xib=null;Q.a.dA()||(k.a.Ng(this.NQc),this.NQc=null);N.DOMElementExtensions.Km(this.hlb);this.h4a=this.hlb=null;super.dispose()}x8a(ob){ob&&
(P.a.instance.Na(d.a.click,ob,this.ohg),r.a.instance.Na(d.a.zi,ob,this.phg),Y.a.instance.Na(d.a.Zi,ob,this.qhg))}y4k(ob){!this.h4a&&this.svgIconProvider&&(this.h4a=this.svgIconProvider.lna(Fa.a.Hyi,this.CGd,this.DGd,this.Xib,void 0,void 0,void 0,this.Cyi))&&this.h4a.classList.add("ewa-fb-function-button-img");this.hlb&&this.h4a&&(N.DOMElementExtensions.setVisible(this.hlb,!ob),N.DOMElementExtensions.setVisible(this.h4a,ob))}}Object(y.a)(fa,"FormulaBarFunctionControl",x.a,[]);var V=a(325),ba=a(193),
la=a(52),Ta=a(10),Ea=a(172),sa=a(155),Ya=a(13);const bb=Q.a.dA()?1:2;class ra{constructor(ob){this.nHa=this.expandButton=this.mIa=this.E9c=this.D9c=this.C9c=null;this.iHc=this.DTd=this.naa=!1;this.n9e=this.fFg=0;this.kCb=Q.a.dA()?16:0;this.YSe=0;this.Zwc=Q.a.dA()?24:Ea.c;this.wga=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8550405_ValuePreviewDismissOnScroll");this.MMc=Na=>{this.mvf();Na.La.rawEvent.preventDefault();return!0};this.IMc=Na=>{this.DTd=!0;this.fFg=Na.clientPoint.y;document.body.classList.add(l.a.Brf);
this.naa||(this.z5a=0);this.nhb.Aa("mousemove",this.ggg,!0);this.nhb.Aa("touchmove",this.ggg);this.nhb.Aa("mouseup",this.T6d);this.nhb.Aa("touchend",this.T6d);this.nhb.Aa("mouseleave",this.T6d);return!0};this.T6d=()=>{this.DTd=!1;this.z5a=Q.a.dA()?this.naa?this.mIa.clientHeight-this.Zwc:0:this.jy.clientHeight-this.Zwc;document.body.classList.remove(l.a.Brf);this.nhb.sO();c.ULS.sendTraceTag(575426571,0,50,`FormulaBarResizeControl.OnDragHandlerResizeEnd formula bar drag resized to: ${this.jy.clientHeight} pixel`)};
this.ggg=Na=>{this.DTd?(Na=Ya.HelperMethods.rPb(Na).y,Na=this.mGf(this.z5a+Math.min(Na,this.$.domElement.clientHeight-75)-this.fFg),this.naa=Na>=this.lineHeight,N.DOMElementExtensions.toggleCssClass(this.jy,l.a.Crf,this.naa),Na=this.Zwc+Math.round(Math.max(Na-bb,0)),(Q.a.dA()?this.mIa.clientHeight:this.jy.clientHeight)!==Na&&(this.jy.style.height=Na+"px",this.$.y5a())):c.ULS.shipAssertTag(537161935,0,!1,"FormulaBarResizeControl.OnDragHandlerResize: reached OnDragHandlerResize with isDuringResize false")};
this.EY=Na=>{this.naa&&(this.hYa=Math.round((Math.round(this.hYa/this.lineHeight)+(0<Na.eCa?1:-1))*this.lineHeight));Na.La.preventDefault();return!1};this.cV=()=>{this.Xok();this.iHc&&(V.a.instance.Na(d.a.VR,document.body,this.cV),V.a.instance.Na(d.a.MLa,document.body,this.cV),ba.a.instance.Na(d.a.Ok,document.body,this.cV),this.iHc=!1);return!1};this.onActiveCellChanged=()=>{this.hYa=0};this.pmg=Na=>{this.iHc||(V.a.instance.ya(d.a.VR,document.body,this.cV),V.a.instance.ya(d.a.MLa,document.body,this.cV),
ba.a.instance.ya(d.a.Ok,document.body,this.cV),this.iHc=!0);Na.preventDefault()};this.onScroll=Na=>nb=>{Na.onScroll();this.pmg(nb)};this.UXj=Na=>{this.hYa=this.n9e;Na.preventDefault()};this.$=ob;this.nhb=sa.a.instance.sWa(document.body.ownerDocument)}get lineHeight(){return this.kCb?this.kCb:Ta.a.Tyf}set lineHeight(ob){this.kCb=ob}get jy(){const {FormulaBar:ob}=a(1144);this.C9c||(this.C9c=ob.fEf(this.$));return this.C9c}get $wc(){this.D9c||(this.D9c=document.getElementById(u.a.JOb));return this.D9c}get Z4(){this.E9c||
(this.E9c=document.getElementById(u.a.JOb+"_"+u.a.Nte));return this.E9c}get hYa(){return this.Z4.scrollTop}set hYa(ob){this.n9e=ob;this.Z4.scrollTop!==ob&&(this.Z4.scrollTop=ob)}get wxi(){return 2*this.lineHeight-bb}get z5a(){return this.YSe}set z5a(ob){this.YSe=ob}mvf(){this.naa=!this.naa;N.DOMElementExtensions.toggleCssClass(this.jy,l.a.Crf,this.naa);this.naa&&!this.z5a&&(this.z5a=this.wxi);this.jy.style.height=this.Zwc+(this.naa?this.z5a:0)+"px";this.expandButton.setAttribute(u.a.RC,this.naa?"Collapse the formula bar":
"Expand the formula bar");this.$.y5a();c.ULS.sendTraceTag(575426572,0,50,`FormulaBarResizeControl.OnExpandButtonClick formula bar ${this.naa?"expanded":"collapsed"}`)}B6h(ob){this.mIa=document.createElement("div");this.mIa.id=this.$.$h+u.a.iGd;this.mIa.className=l.a.Rki;this.expandButton=ra.w2h(this.$.$h,ob);this.mIa.appendChild(this.expandButton);this.nHa=ra.W1h(this.$.$h);this.mIa.appendChild(this.nHa);return this.mIa}sfk(){V.a.instance.ya(d.a.yy,this.expandButton,this.MMc);ba.a.instance.ya(d.a.um,
this.expandButton,this.MMc);V.a.instance.ya(d.a.yy,this.nHa,this.IMc);ba.a.instance.ya(d.a.um,this.nHa,this.IMc)}vfk(ob){V.a.instance.ya(d.a.IM,this.$wc,this.EY);la.a.addHandler(this.Z4,d.a.scroll,this.wga?this.onScroll(ob):this.pmg);Q.a.dA()&&la.a.addHandler(this.Z4,d.a.scrollEnd,this.cV);la.a.addHandler(this.Z4,d.a.focus,this.UXj);F.f(this.$).ha.add_activeCellChanged(this.onActiveCellChanged)}c2k(){void 0!==this.expandButton&&null!==this.expandButton&&(V.a.instance.Na(d.a.yy,this.expandButton,this.MMc),
ba.a.instance.Na(d.a.um,this.expandButton,this.MMc));void 0!==this.nHa&&null!==this.nHa&&(V.a.instance.Na(d.a.yy,this.nHa,this.IMc),ba.a.instance.Na(d.a.um,this.nHa,this.IMc));void 0!==this.$wc&&null!==this.$wc&&V.a.instance.Na(d.a.IM,this.$wc,this.EY);F.f(this.$).ha.remove_activeCellChanged(this.onActiveCellChanged)}Xok(){this.hYa=Math.round(this.mGf(this.hYa))}mGf(ob){return Math.round(ob/this.lineHeight)*this.lineHeight}static w2h(ob,Na){const nb=document.createElement("a");nb.id=ob+u.a.zxi;nb.classList.add(l.a.Hki);
N.DOMElementExtensions.UK(nb,u.a.fF);nb.setAttribute(u.a.RC,"Expand the formula bar");Na.lna(Fa.a.AWh,12,12,nb,Q.a.dA()?20:null,Q.a.dA()?20:null).classList.add(l.a.Iki);return nb}static W1h(ob){const Na=document.createElement("div");Na.id=ob+u.a.xxi;Na.className=l.a.Gki;return Na}}Object(y.a)(ra,"FormulaBarResizeControl",null,[]);J=a(263);var Da=a(45),oa=a(676),Ha=a(189),ka=a(111),wa=a(47),Za=a(1334);class ab{}ab.disabled="disabled";ab.zQk="stale";ab.A6j="presentationMode";ab.viewMode="viewMode";
Object(y.a)(ab,"NameBoxStateUpdateKey",null,[]);var db=a(160),mb=a(185);class Ia extends J.a{constructor(ob,Na){super(document.createElement("div"));this.Kl=null;this.Mte="";this.HZk=()=>{this.$.Ma.mRb("PopulateNameBoxMenu",{menuId:"NameBox"})};this.s7d=()=>{this.EV(this.da.ha.HHf())};this.aq=(nb,Hb)=>{this.spa(nb,Hb);this.o5b(nb,Hb)};this.o5b=()=>{let nb=Za.c(this.$,this.da);oa.c(nb,!0)||(this.Kl&&(nb=this.$.Gh.getItemByName(this.Kl))&&nb.deactivate(),this.EV(this.da.ha.qa.activeCell.toString()))};
this.LZb=(nb,Hb)=>{var na,Gb,Xa,Jb,qb;!(nb=Hb.na)||xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8137505_AvoidViewportJumpWhenScrollingNamedObject")&&(null===(na=Hb.mB)||void 0===na?void 0:na.name)===(null===nb||void 0===nb?void 0:nb.name)&&(null===(Gb=Hb.mB)||void 0===Gb?void 0:Gb.usedRange.top)===(null===nb||void 0===nb?void 0:nb.usedRange.top)&&(null===(Xa=Hb.mB)||void 0===Xa?void 0:Xa.usedRange.bottom)===(null===nb||void 0===nb?void 0:nb.usedRange.bottom)&&(null===(Jb=Hb.mB)||void 0===Jb?void 0:
Jb.usedRange.left)===(null===nb||void 0===nb?void 0:nb.usedRange.left)&&(null===(qb=Hb.mB)||void 0===qb?void 0:qb.usedRange.right)===(null===nb||void 0===nb?void 0:nb.usedRange.right)||(na=nb.usedRange,2===nb.type&&(na=Ha.a(nb)),Gb=this.da.ha.qa.Gn,Xa=this.da.inRangePicker||this.da.Pp,Jb=!1,2===nb.type&&Gb&&!Xa&&(Gb=this.da.ha.qa.activeRange,Jb=nb.sheetName===this.$.sa.na.name&&!!Gb&&Gb.top===na.top&&Gb.left===na.left&&Gb.bottom===na.bottom&&Gb.right===na.right),na=Da.w(na,this.$),na.NamedObjectName=
nb.name,na.SheetName=nb.sheetName,this.da.To(na,null,null,null,60,"EditableNamedObjectsDropdownList.OnActiveNamedObjectChanged",0,!0,!0,null,Hb.disableAutoFocusOnGrid),Hb=oa.a(nb.name),this.EV(Hb.name,Hb.fullName))};this.xu=()=>{const nb=Za.b(this.da);null!=nb&&this.EV(nb.name)};this.chg=(nb,Hb)=>{this.s7d(nb,Hb)};this.h0b=()=>{this.Vsc(!0)};this.g0b=()=>{this.Vsc(!1)};this.Xw=()=>{xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableNameBoxInViewMode",!1)?this.v4k(!this.$.isEditMode):
this.Vsc(!this.$.isEditMode)};this.Sjg=()=>{wa.a(this.$).sP(db.a.Axi,mb.a.fj)};this.FY=(nb,Hb)=>{this.BMg(Hb.tT)};this.onKeyDown=nb=>nb.La.keyCode===b.a.bQa?(this.da.focus(),!0):!1;this.spa=()=>{this.F1c({[ab.zQk]:!0})};this.$=ob;this.da=F.f(ob);this.qKh(Na);ob=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8628473_NameboxSetTextSyncOnInit");this.EV(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8634130_StartNameBoxWithNamedObject")?this.da.ha.GHf():this.da.ha.qa.activeCell.toString(),"",ob);this.Vsc(!xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableNameBoxInViewMode",
!1)&&!this.$.isEditMode);this.BMg(wa.a(this.$).Ex());this.fq();r.a.instance.ya(d.a.zi,this.domElement,this.onKeyDown.bind(this))}get text(){return xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8654931_readNameBoxTextFromReact")?appChrome.getNameBoxText():this.Mte}dispose(){this.$&&(this.$.ih.GCg(this.h0b.bind(this)),this.$.ih.FCg(this.g0b.bind(this)),this.$.ea.TY(this.Xw.bind(this)),ka.a(this.$).FSc(this.chg.bind(this)),ka.a(this.$).Dge(this.xu.bind(this)),wa.a(this.$).Bm.$za(this.FY.bind(this)),
this.$.Gh&&(this.$.Gh.hn(this.LZb.bind(this)),this.$.Gh.JSc(this.o5b.bind(this)),this.$.Gh.JSc(this.Fyg.bind(this)),this.$.Gh.Eba(this.spa.bind(this)),this.$.Gh.Yza(this.spa.bind(this)),this.$.Gh.Zza(this.spa.bind(this)),this.$.Gh.b3b(this.spa.bind(this))),this.$.sa&&this.$.sa.hn(this.aq.bind(this)));if(this.da){const ob=this.da.ha;ob.Gba(this.o5b.bind(this));ob.Fba(this.s7d.bind(this));ob.$e.sV(this.xu.bind(this))}super.dispose()}u4k(ob){this.F1c({[ab.A6j]:ob})}v4k(ob){this.F1c({[ab.viewMode]:ob})}qKh(ob){const Na=
document.getElementById(this.$.$h+u.a.Uyf);void 0!==Na&&null!==Na&&ob.removeChild(Na);appChrome.renderNameBoxUI(this.domElement,this.HZk.bind(this));ob.insertBefore(this.domElement,ob.firstChild)}fq(){this.$.ih.I1e(this.h0b.bind(this));this.$.ih.H1e(this.g0b.bind(this));this.$.ea.UW(this.Xw.bind(this));const ob=this.da.ha;this.$.Gh.Qm(this.LZb.bind(this));this.$.sa.Qm(this.aq.bind(this));ob.v9(this.o5b.bind(this));ob.u9(this.s7d.bind(this));ob.$e.MN(this.xu.bind(this));ka.a(this.$).mnd(this.xu.bind(this));
ka.a(this.$).skc(this.chg.bind(this));wa.a(this.$).Bm.wta(this.FY.bind(this));this.$.Gh.wkc(this.o5b.bind(this));this.$.Gh.wkc(this.Fyg.bind(this));this.$.Gh.u3(this.spa.bind(this));this.$.Gh.tta(this.spa.bind(this));this.$.Gh.uta(this.spa.bind(this));this.$.Gh.Rcb(this.spa.bind(this))}BMg(ob){ob?this.domElement.addEventListener("pointerdown",this.Sjg):this.domElement.removeEventListener("pointerdown",this.Sjg);this.tXk(ob)}tXk(ob){for(let Na=0;Na<this.domElement.children.length;Na++)this.domElement.children[Na].style.pointerEvents=
ob?"none":""}EV(ob,Na="",nb=!1){this.Mte=ob;this.Kl=""!==Na?Na:this.Kl;appChrome.setNamedObjectOrActiveCellRange(Na,ob,nb)}Vsc(ob){this.F1c({[ab.disabled]:ob})}Fyg(ob,Na){Za.a(this.$,!0);this.spa(ob,Na)}F1c(ob){appChrome.updateNameBoxState(ob)}}Object(y.a)(Ia,"NameBox",J.a,[2]);var pa=a(156),lb=a(152);const ha=l.a.fdg+" "+l.a.K_,ua=l.a.O$e+" "+l.a.K_;class fb extends x.a{constructor(ob=null,Na,nb,Hb){super();this.IIb=this.HZb=this.JIb=this.IZb=this.lF=this.QF=null;this.zR=this.RGc=!1;this.Bzg=()=>
{this.da.XT.nv(this.en);this.da.XT.Wx(this.yl);this.RGc=!0};this.en=()=>{this.KYg(!0)};this.yl=()=>{this.KYg(!1)};this.Bkg=Gb=>this.rMc(!0,`OkCancelEditControl.OnOkClick: ${Gb.oh}`,Ya.HelperMethods.$z(Gb));this.Ckg=Gb=>this.rMc(!0,`OkCancelEditControl.OnOkKeyDown: ${Gb.oh}`);this.teg=Gb=>this.rMc(!1,`OkCancelEditControl.OnCancelClick: ${Gb.oh}`,Ya.HelperMethods.$z(Gb));this.weg=Gb=>this.rMc(!1,`OkCancelEditControl.OnCancelKeyDown: ${Gb.oh}`);this.WI=()=>{this.sXk(!this.$.isEditMode)};this.onPointerDown=
()=>{this.da.isEditing&&(this.da.fp.$b.tR=!0);return!1};const {FormulaBar:na}=a(1144);this.$=nb;this.da=F.f(nb);this.zR=Q.a.zR();Hb?(this.IZb=Hb.kZa(Fa.a.qbf,16),this.JIb=Hb.kZa(Fa.a.q$h,16),Q.a.dA()||(this.HZb=Hb.kZa(Fa.a.RSh,16),this.IIb=Hb.kZa(Fa.a.r$h,16),this.IZb.style.display="none",this.JIb.style.display="none")):(this.IZb=za.b(16,16,l.a.Bmi,ea.a.$m(1),null,null,!0,Na.ia(1041)),this.JIb=za.b(16,16,l.a.Fmi,ea.a.$m(1),null,null,!0,Na.ia(1042)));Q.a.dA()?(this.QF=N.DOMElementExtensions.getElementById(this.$.domElement,
this.$.$h+na.bMc),this.lF=N.DOMElementExtensions.getElementById(this.$.domElement,this.$.$h+na.Snc)):(this.R5d=ob.rmc(na.bMc,na.bMc,ha,"",""),this.QF=this.R5d.domElement,this.osd=ob.rmc(na.Snc,na.Snc,ua,"",""),this.lF=this.osd.domElement);this.QF.appendChild(this.IZb);this.lF.appendChild(this.JIb);Q.a.dA()?xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8486552_FormulaBarFluentCellEdit")?requestAnimationFrame(()=>{this.QF&&this.lF&&(this.QF.classList.add(l.a.bX),this.lF.classList.add(l.a.bX),N.DOMElementExtensions.toggleCssClass(this.QF,
l.a.OHa,!this.$.isEditMode),N.DOMElementExtensions.toggleCssClass(this.lF,l.a.OHa,!this.$.isEditMode))}):(this.QF.classList.add(l.a.bX),this.lF.classList.add(l.a.bX),N.DOMElementExtensions.toggleCssClass(this.QF,l.a.OHa,!this.$.isEditMode),N.DOMElementExtensions.toggleCssClass(this.lF,l.a.OHa,!this.$.isEditMode)):(this.QF.appendChild(this.HZb),this.lF.appendChild(this.IIb));this.da.cellTextEditBox.nv(this.en);this.da.cellTextEditBox.Wx(this.yl);Q.a.dA()&&nb.ea.JJ(this.WI);P.a.instance.ya(d.a.click,
this.QF,this.Bkg);r.a.instance.ya(d.a.zi,this.QF,this.Ckg);Y.a.instance.ya(d.a.Zi,this.QF,this.onPointerDown);P.a.instance.ya(d.a.click,this.lF,this.teg);r.a.instance.ya(d.a.zi,this.lF,this.weg);Y.a.instance.ya(d.a.Zi,this.lF,this.onPointerDown);this.zR&&this.da.dyh(this.Bzg)}dispose(){this.da&&this.da.cellTextEditBox&&(this.da.cellTextEditBox.ev(this.en),this.da.cellTextEditBox.Zw(this.yl));this.da&&this.zR&&(this.da.Lik(this.Bzg),this.RGc&&(this.da.XT.ev(this.en),this.da.XT.Zw(this.yl),this.RGc=
!1));this.QF&&(P.a.instance.Na(d.a.click,this.QF,this.Bkg),r.a.instance.Na(d.a.zi,this.QF,this.Ckg),Y.a.instance.Na(d.a.Zi,this.QF,this.onPointerDown),this.QF=null);this.lF&&(P.a.instance.Na(d.a.click,this.lF,this.teg),r.a.instance.Na(d.a.zi,this.lF,this.weg),Y.a.instance.Na(d.a.Zi,this.lF,this.onPointerDown),this.lF=null);Q.a.dA()||(k.a.Ng(this.R5d),this.R5d=null,k.a.Ng(this.osd),this.osd=null);Q.a.dA()&&this.$&&this.$.ea.GH(this.WI);Q.a.dA()||(N.DOMElementExtensions.Km(this.IIb),this.IIb=null,N.DOMElementExtensions.Km(this.HZb),
this.HZb=null);super.dispose()}sXk(ob){Object(lb.c)(()=>{this.QF&&this.lF&&(N.DOMElementExtensions.toggleCssClass(this.QF,l.a.OHa,ob),N.DOMElementExtensions.toggleCssClass(this.lF,l.a.OHa,ob))},this.$.xa)}rMc(ob,Na,nb=null){const Hb=this.da.fp;if(nb){const na=this.da.fA?"formulaBar_end_edit_ok_cancel_btn":"cell_text_end_edit_ok_cancel_btn";let Gb;Gb=[Object(pa.a)(this.da.cellTextEditBox.$b.oPa)];pa.b(this.$).ix(nb.rawEvent,na,Gb)}this.RGc&&this.da.XT.pO?this.da.XT.endEdit(ob,Na,0):Hb.endEdit(ob,Na,
0);this.da.focus();return!0}KYg(ob){if(Q.a.dA())xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8486552_FormulaBarFluentCellEdit")?requestAnimationFrame(()=>{var Na,nb,Hb,na;ob?(null===(Na=this.QF)||void 0===Na?void 0:Na.classList.remove(l.a.bX),null===(nb=this.lF)||void 0===nb?void 0:nb.classList.remove(l.a.bX)):(null===(Hb=this.QF)||void 0===Hb?void 0:Hb.classList.add(l.a.bX),null===(na=this.lF)||void 0===na?void 0:na.classList.add(l.a.bX))}):ob?(this.QF.classList.remove(l.a.bX),this.lF.classList.remove(l.a.bX)):
(this.QF.classList.add(l.a.bX),this.lF.classList.add(l.a.bX));else{const Na=ob?"block":"none",nb=ob?"none":"block";this.IZb.style.display=Na;this.JIb.style.display=Na;this.HZb.style.display=nb;this.IIb.style.display=nb}}}Object(y.a)(fb,"OkCancelEditControl",x.a,[]);var Ka=a(327),La=a(335),ib=a(74),Yb=a(209),Wc=a(12),Qc=a(323),Wb=a(230),Jc=a(326),ma=a(151),Hc=a(169),Kb=a(43),pc=a(425),$b=a(239),Ib=a(163),Zb=a(377);class Eb extends e.a{constructor(ob,Na,nb=null){super(F.f(ob));this.aBa=Na;this.eJe=
this.sF=this.clearContentNotifier=this.nameBox=this.jy=this.TXg=null;this.fze=!1;this.Z4=null;this.MEc=this.q9e=this.ABc=!1;this.wga=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8550405_ValuePreviewDismissOnScroll");this.pmj=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8614675_partialInteractivityFormulaBar");this.IZf=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8704306_RemoveRegionHeightAfterFormulaBarVisible");this.en=()=>{this.fze=!1;this.gne();this.MEc&&this.L8b(!this.BWf)};this.yl=()=>{this.gne();
this.MEc&&this.L8b(!1)};this.L8b=Hb=>{Eb.Zva&&this.q9e!==Hb&&(Q.a.dA()?Object(lb.c)(()=>{Eb.Zva&&(N.DOMElementExtensions.toggleCssClass(Eb.Zva,l.a.OHa,Hb),N.DOMElementExtensions.toggleCssClass(Eb.Zva,l.a.bX,Hb))},this.$.xa):N.DOMElementExtensions.toggleCssClass(Eb.Zva,l.a.bX,Hb),this.q9e=Hb)};this.Wng=()=>{this.isEditing||this.$b.disabled||this.startEdit(!0,!1,null)};this.Fv=()=>{this.DOa()};this.FY=(Hb,na)=>{this.DOa();Eb.Zva&&(na.tT?this.pmj?this.L8b(!0):Eb.Zva.classList.add(l.a.bX):this.Pnd())};
this.lA=(Hb,na)=>{Hb=this.grid;this.fze=!0;this.isEditing?(this.EUb||(na.QEc||this.f2(null),this.raiseEvent(e.a.QIb,na)),this.EUb||Hb.cellTextEditBox.$b.isCursorAttached()&&!this.$b.isCursorAttached()&&Hb.cellTextEditBox.$b.clearCursorFormatLocation()):Hb.isEditing&&this.DOa()};this.onBlockCacheItemChanged=(Hb,na)=>{(Hb=this.grid.ha.qa.activeCell)&&(na=this.grid.hL(na.Ti.hash))&&Hb.yi(na.jj)&&this.DOa()};this.h8d=(Hb,na)=>{-185374993===na.command&&this.DOa()};this.onActiveItemChanged=()=>{this.DOa();
K.TaskExtensions.Ua(O.a(this.$.ka),()=>{this.VLg()},this.xa,11)};this.xY=()=>{this.VLg();Q.a.i0a()?this.aBa.e0k(this.oKi()):(Kb.a.instance.w1(u.a.Y4,Zb.a.t8b),Kb.a.instance.x1(u.a.Y4,Zb.a.t8b));Kb.a.instance.Iba(u.a.Y4,Zb.a.Y8e)};this.onKeyDown=Hb=>{if(Hb.La.keyCode===b.a.mG){var na=this.PIa();const Gb=N.DOMElementExtensions.fE(na);na=N.DOMElementExtensions.K$(na);return N.DOMElementExtensions.u6a(Hb.La,Gb,na)}return!1};this.WI=()=>{this.Pnd()};this.Maj=()=>{this.jy?(this.nameBox=new Ia(this.$,this.jy),
this.qnk()):this.MDg()};nb||c.ULS.sendTraceTag(509223749,0,50,"FormulaBar.ctor: SVGIconProvider must always exist.");Q.a.i0a()&&(Na||c.ULS.sendTraceTag(507609984,0,10,"FormulaBar.ctor: SkeletonManager must always exist."));this.eJe=new ra(ob);this.initialize(this.Ame(ob,nb));this.gYa.sfk();!this.IZf&&f.AFrameworkApplication.ra.$d.Fk&&(Na=document.getElementById("AdditionalBarsRegion"))&&(Na.style.height="");this.iTd=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5160311_CrossBookCrossSheetDataBookPickerOverlay");
this.LL=new Ka.a(this.jy,1);this.Wij=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6148798_FormulaBarCrossSessionPicker");this.nDc=new M(ob);this.nDc.rmc(u.a.IYg,u.a.IYg,u.a.pXk+" cui-TabRowRight",M.gNh,M.iNh);this.Syf=new fa(this.nDc,Wc.a.instance,ob,nb);this.zJj=new fb(Q.a.dA()?void 0:this.nDc,Wc.a.instance,ob,nb);this.TXg=$b.b(()=>{this.CNg()},1,this.$.xa,"FormulaBar.setTextBoxForActiveItem",!0);ob.sa.Qm(this.onActiveItemChanged);nb=this.grid;nb.cellTextEditBox.nv(this.en);nb.cellTextEditBox.Wx(this.yl);
nb.cellTextEditBox.fUa(this.lA);nb.KN(this.Fv);nb.za.Vy(this.onBlockCacheItemChanged);nb.za.Cka(this.onBlockCacheItemChanged);nb.Gkc(this.h8d);wa.a(ob).Bm.wta(this.FY);ob.ea.JJ(this.WI);ka.a(ob).mnd(this.Fv);xa.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&ob.ka.Lh(313,Hb=>{this.clearContentNotifier=Hb;this.clearContentNotifier.mmd(this.lA)});r.a.instance.ya(d.a.zi,this.Pi,this.onKeyDown);nb=this.$b.style;Qc.c(nb,ob.isChromeRtl,"0px");nb.textAlign=this.VTf?
"right":"left";this.isVisible=!1;this.iTd&&(this.$b.isVisible=!1);nb=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8654712_PopulateFBTextBoxBeforeCommandUIAttach");nb||(C.a(this.$).hFa(this.xY),this.$.ea.txa&&(c.ULS.sendTraceTag(537161948,0,50,"FormulaBar: CommandUI already generated when registering to: OnCommandUIAttachCompleted"),this.xY(null,null)));xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8605252_FormulaBarInitStateFix")?this.CNg():this.DOa();this.Pnd();this.$b.PPg=!0;this.waj();n.a(ob).Eq(this);
this.$b.J0e(this.Wng);this.EUb=!1;this.sF=new I(this.$,this);this.L9i();nb&&this.csk();this.$b.qea(()=>{Kb.a.instance.Iba(u.a.Y4,Zb.a.wXg);this.toggleEditingEvents(!1)});this.MEc=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8106214_disableFunctionButtonV2")}set text(ob){this.isEditing?this.$b.setPlainText(ob):super.text=ob}get isEditing(){return super.isEditing}set isEditing(ob){super.isEditing=ob;this.toggleEditingEvents(ob)}get BWf(){return this.OCc||0>=this.text.length}get X7b(){return!0}get formattedText(){return this.$b.getFormattedText()}set formattedText(ob){this.$b.setFormattedText(ob)}get aUb(){return this.isEditing}get isVisible(){return N.DOMElementExtensions.isVisible(this.jy)}set isVisible(ob){this.iTd?
N.DOMElementExtensions.setVisible(this.jy,ob):(N.DOMElementExtensions.setVisible(this.jy,ob),this.$b.isVisible=ob)}get Pi(){return this.jy}get Co(){return this.isVisible}get Hk(){return R.a.hGd}get gYa(){return this.eJe}zp(ob,Na){ob=!1;Na||(ob=this.Jwi());return ob}dispose(){const ob=this.$;if(ob){ob.sa.hn(this.onActiveItemChanged);var Na=this.grid;Na.cellTextEditBox.ev(this.en);Na.cellTextEditBox.Zw(this.yl);Na.cellTextEditBox.m5a(this.lA);Na.vP(this.Fv);Na.za.Fy(this.onBlockCacheItemChanged);Na.za.l5a(this.onBlockCacheItemChanged);
wa.a(this.$).Bm.$za(this.FY);ob.ea.GH(this.WI);ka.a(ob).Dge(this.Fv);Na=C.a(this.$);r.a.instance.Na(d.a.zi,this.Pi,this.onKeyDown);this.gYa.c2k();Na&&Na.q5a(this.xY);n.a(ob).FH(this);xa.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&(this.clearContentNotifier&&this.clearContentNotifier.ySc(this.lA),ob.ka.Ula(313))}this.$b&&this.$b.QBg(this.Wng);k.a.Ni([this.LL,this.Syf,this.zJj,this.nDc,this.nameBox]);k.a.Ng(this.sF);this.jy&&(N.DOMElementExtensions.eO(this.jy),
this.jy.className="");c.ULS.sendTraceTag(537161946,0,50,"FormulaBar.Dispose: setting this.formulaBarElement to null");this.jy=null;super.dispose()}endEdit(ob,Na,nb,Hb=null){this.$b.addEventLogRecord("FormulaBar.EndEdit",{["Commit"]:ob,["Caller"]:Na});this.ywb(!1);if(this.isEditing){var na=null;Hb&&(na=this.$.shortcutKeyManager.dD(Hb));var Gb=this.grid.sh;this.isEditing=!1;this.WN(!0);this.rnb()&&this.grid.wI&&this.grid.wI.Qib&&this.grid.wI.Eub(u.a.xSb);if(ob){var Xa=new v.a(this.grid.ha.qa.activeCell,
Gb.text,Gb.text,!1,this.grid.$.sa.na);this.Svg(Xa);null!==Xa&&(Gb.text=Xa.newValue)}else this.$b.setPlainText(this.text);Xa=new B.a(this.grid.ha.qa.activeCell,Gb.text,ob,Hb);this.Jce(Xa);Gb.endEdit(ob,`${Na}->FormulaBar.EndEdit`,nb,Hb);this.V_f(na)||Gb.$b.focus();this.$b.N7b("FormulaBar.EndEdit")}else this.$b.N7b("FormulaBar.EndEdit",{["IsEditing"]:"false"})}xma(ob,Na,nb,Hb=!0,na=!0){super.xma(ob,Na,nb,Hb,na);this.grid.sh.xma(ob,Na,nb,Hb,na)}Gtg(ob){const Na=this.grid.sh,nb=this.$b.selection;nb.length&&
Na.xma(nb.index,nb.length,ob,!1,!1)}Yp(ob){return N.DOMElementExtensions.Cn(this.jy,ob)}gs(){f.AFrameworkApplication.ra.tm.fv(this.Hk)}Xt(){}x2g(ob){this.nameBox.u4k(ob);this.Syf.y4k(ob)}yxe(){if(this.Z4){var ob=Object(Ib.g)(this.text);this.ABc!==ob&&(this.DNg(ob),this.ABc=ob)}}e6d(){this.$b.addEventLogRecord("FormulaBar.OnAutoCompleteCommandHandled");const ob=this.grid.sh;ob.isEditing&&this.isEditing&&(ob.formattedText=this.formattedText,ob.setCaretPosition(this.$b.caretPosition))}X_b(ob){this.$b.disabled||
(this.grid.cellTextEditBox.$b.tR=!0,this.isEditing||this.startEdit(!1,!0,ob),this.nua())}Mqb(){this.SY&&(this.EW=this.$b.caretPosition,this.Z2=this.$b.Xpa.length);this.f2(null);this.eAa();this.Y_g()}nza(ob){var Na=this.$.shortcutKeyManager.dD(ob);const nb=this.EUb;1872288872===Na||125627505===Na||267796030===Na?super.nza(ob):nb?ib.g(ob):this.isEditing&&this.grid.sh.isEditing&&(Na=this.grid.sh,Na.formattedText=this.formattedText,Na.setCaretPosition(this.$b.caretPosition),this.i1c(),0===this.$b.selection.length&&
this.f2(null,null),this.Wij&&this.inRangePicker&&this.Hre(),super.nza(ob))}tj(ob,Na){this.isEditing&&super.tj(ob,Na)}iB(ob,Na){this.isEditing&&super.iB(ob,Na)}csk(){this.$.ea.txa?(c.ULS.sendTraceTag(507585433,0,50,"FormulaBar: CommandUI already generated when registering to: OnCommandUIAttachCompleted"),this.xY(null,null)):C.a(this.$).hFa(this.xY)}L9i(){const ob=this.grid.kh(void 0);ob?(this.ABc=ob.iC||Object(Ib.g)(ob.text),this.DNg(this.ABc)):c.ULS.sendTraceTag(509720320,0,50,"FormulaBar.initTextElementStyles: failed to get active cell")}DNg(ob){N.DOMElementExtensions.toggleCssClass(this.Z4,
l.a.sCd,ob)}Ame(ob,Na){this.jy=Eb.fEf(ob);this.jy.classList.add(l.a.Lki);this.jy.classList.add(l.a.Nki);Q.a.dA()&&this.jy.classList.add(l.a.Jki);const nb=this.gYa.B6h(Na);Na=Eb.Fxd();nb.appendChild(Na);Eb.Zva=Eb.C2h(ob.$h);const Hb=Eb.v2h(),na=Eb.j4h(ob.$h),Gb=Eb.i4h(ob.$h),Xa=Eb.W0h(ob.$h);Gb.tabIndex=-1;Xa.tabIndex=-1;na.appendChild(Xa);na.appendChild(Gb);na.appendChild(Eb.Zva);Hb.appendChild(na);Hb.appendChild(nb);ob=Eb.N3h(ob.$h);this.jy.appendChild(ob);this.jy.appendChild(Hb);const Jb=new Jc.a(Na,
!0,!1);this.Z4=Na;this.gYa.lineHeight=Jb.pKi();Jb.qea(()=>{pc.c(Jb.Ll,t.a.ariaLabel,"formula bar")});Jb.qea(()=>{this.gYa.vfk(this.wga?{onScroll:()=>this.Lce()}:{})});Jb.isVisible=!1;return Jb}u3a(ob){this.bRc(ob);super.u3a(ob);ma.b(this.$).lj(D.a.Hxi,{["Location"]:"canvas"});m.a.Un&&window.focus();const Na=this.$.shortcutKeyManager.dD(ob);this.O6j(ob,Na);this.$b.disabled||this.isEditing||this.startEdit(!0,!1,ob);let nb;nb={};nb.wasEditing=this.isEditing;nb.formulaBar=!0;let Hb=this.mq(ob,Na);!Hb&&
Yb.d(Na,this.Gmb,!0)&&(Hb=this.V_f(Na)?!0:this.grid.ha.mq(ob,Na,nb));Hb||Hc.a(this.$).V0d(ob,0,7)}startEdit(ob,Na,nb){const Hb=this.grid;if(!this.isEditing||!Hb.isEditing){this.$b.N7b("FormulaBar.StartEdit");this.$b.addEventLogRecord("FormulaBar.StartEdit",{["SetCaretPositionToEnd"]:ob,["IsOnMouseDown"]:Na});ma.b(Hb.$).lj(D.a.Gxi,{["Location"]:"canvas"});this.isEditing=this.EUb=!0;Hb.oB&&Hb.oB.UVc(this);Hb.cellTextEditBox.WN(!1);Hb.cellTextEditBox.lie();this.YMg(!1);var na=()=>{var Gb=Hb.$.sa.na;
const Xa=Hb.kh(null);Gb=new z.a(Xa,Gb,void 0,void 0,void 0,this.WJd(Xa));this.Kce(Gb);this.A5b(Hb.cellTextEditBox.$b.rO);Gb=()=>{if(this.isEditing&&Hb.isEditing){Hb.isEditing&&Hb.cellTextEditBox.$b.detachCursorFormat();if(!this.f2(null)){const qb=Hb.cellTextEditBox.formattedText;var Jb=this.$b.caretPosition;const Db=qb.Text.length;Jb=this.$b.text.length!==Db?Db:Jb;this.formattedText=qb;this.$b.caretPosition=Jb}this.EUb=!1;this.$b.clearHistory()}else this.isEditing=!1};xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePostTaskHelperInFormulaBarStartEdit",
!1)?void Object(lb.b)(Gb):setTimeout(Gb,0);Hb.cellTextEditBox.NEg()};if(Hb.isEditing)Hb.eM=1,na();else if(this.$b.tR=!0,K.TaskExtensions.Ua(Hb.startEdit(!1,1,nb,!1,void 0,Na,1),Gb=>{Gb.result?(Hb.isEditing||(this.$b.addErrorLogRecord("FormulaBar.StartEdit","tag_cnkc7"),c.ULS.sendTraceTag(37003425,0,10,"FormulaBar.StartEdit: grid.IsEditing is false after calling grid.StartEdit. Stack=")),this.isEditing&&Hb.isEditing?(Hb.cellTextEditBox.$b.tR=!0,Gb=Hb.kh(null),this.$b.oyf(Number.NaN,this.WJd(Gb)),ob&&
this.$b.setCaretPositionToEnd(),na()):this.isEditing=!1):this.isEditing=!1},this.xa,11),this.$b.tR=!1,Na=Hb.kh(null),null===Na||void 0===Na?0:Na.MUd)this.$b.addEventLogRecord("FormulaBar.StartEditStripOutLegacyArrayCurlyBraces"),this.text=Ya.HelperMethods.yVg(this.text)}}QNd(ob){super.QNd(ob);this.MEc&&this.grid&&this.grid.isEditing&&2===ob&&this.L8b(!this.BWf)}onActiveCellChanged(ob,Na){super.onActiveCellChanged(ob,Na);this.gne()}I6a(ob){xa.EwaSettings.isChangeGateEnabled("OfficeVSO:7549189_logsForNullTextboxInvestigation")&&
c.ULS.sendTraceTag(509445518,0,50,`FormulaBar.set_textBox: Setting the text box for the formula bar, textBox defined: ${!!ob}`);super.I6a(ob)}gne(){const ob=this.grid;ob.isEditing&&2===ob.eM||this.DOa()}Am(){var ob=this.grid;this.isEditing&&ob.isEditing&&(ob=ob.sh,ob.text=this.text,ob.setCaretPosition(this.$b.caretPosition),this.inRangePicker&&this.$b.focus())}DOa(){this.TXg()}CNg(){if(this.$b){var ob=this.grid;this.$b.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal",{["IsEditing"]:this.isEditing,
["TextBox.Initialized"]:this.$b.initialized,["Grid.IsEditing"]:ob.isEditing});if(!this.isEditing){var Na=wa.a(this.$).Ex();this.jy.disabled=Na||!this.$.isEditMode;var nb=(Na=this.$.e4===ob)&&1===ob.ha.wk;this.$b.initialized&&(this.$b.disabled=this.jy.disabled||Na&&!nb);Na=new Wb.a(this.$b.style);var Hb=!1;if(nb)if(ob.isEditing)this.$b.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["ActiveCellContents"]:"CellTextEditBox.Text"}),nb=ob.cellTextEditBox.text;else{Hb=
ob.kh(null);nb=new U.a(this.$.sa);if(!Hb||!nb.OVb(Hb.range,ob))return;ob=nb.Dn;nb=Hb.tn;var na=Hb.formulaBarText;const Gb=Hb.text;this.$b.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["sheetProtection.IsLocked"]:ob,["activeCell.IsHidden"]:nb,["activeCell.FormulaBarText"]:!!na,["activeCell.Text"]:!!Gb});nb=ob&&nb?"":na||Gb;Hb=Hb.qRg}else nb="",na=ob.ha.$e.yh,na=(null===na||void 0===na?0:na.floatingObject)?na.floatingObject.nh:null,64===ob.ha.wk&&na&&na.IsShapeFormulaPresent&&
((ob=(ob=na.ShapeText)?ob.substring(ob.indexOf("\nFormula:")+9,ob.indexOf(";FormulaVal:")):null)?(this.$b.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["ActiveCellContents"]:"ShapeFormula"}),nb="="+ob):c.ULS.sendTraceTag(537161938,0,15,"FormulaBar.setTextBoxForActiveItemInternal: IsShapeFormulaPresent is true but formula not found in shapeText"));this.YMg(Hb);this.Vdc=this.Wrd();Na.LH.direction=this.xna?w.a.rtl:w.a.Pob;Na.LH.textAlign=this.xna?w.a.right:w.a.left;
xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaBarFluentStylingEnabled",!1)&&N.DOMElementExtensions.toggleCssClass(this.Z4,l.a.rCd,this.xna);Na.Zda();this.text=nb}}}oKi(){return{formulaBarText:this.text,K5:this.K5(),unb:this.xna}}VLg(){var ob=this.$.e4;if(this.iTd){var Na=!!this.grid.XT&&this.grid.XT.pO;this.isVisible=ob=!!ob&&this.$.jGd&&!this.$.ea.th.inEmbedView;Na||(this.$b.isVisible=ob)}else this.isVisible=!!ob&&this.$.jGd&&!this.$.ea.th.inEmbedView;this.IZf&&f.AFrameworkApplication.ra.$d.Fk&&
(Na=document.getElementById("AdditionalBarsRegion"))&&(Na.style.height="");xa.EwaSettings.isChangeGateEnabled("OfficeVSO:8728441_moveHideSkeleton")&&Q.a.i0a()?this.aBa.NO(u.a.cwb):this.$.OO(u.a.cwb);Q.a.i0a()&&this.aBa.N1k();this.$.xP()}YMg(ob){N.DOMElementExtensions.toggleCssClass(this.$b.domElement,l.a.Mki,ob)}PIa(){return this.jy.querySelectorAll(N.DOMElementExtensions.zI+", div[tabindex]")}fE(){return N.DOMElementExtensions.fE(this.PIa())}Jwi(){const ob=this.fE();return ob?(N.DOMElementExtensions.setFocus(ob),
!0):!1}O6j(ob,Na){Na=-287251124===Na||-1925065947===Na||1764140053===Na;La.a.vnb()&&Na&&ob.preventDefault()}Pnd(){this.L8b(!this.$.isEditMode);Q.a.dA()&&Object(lb.c)(()=>{this.Z4&&N.DOMElementExtensions.toggleCssClass(this.Z4,l.a.OHa,!this.$.isEditMode)},this.$.xa)}A5b(ob){this.$b.rO=ob}toggleEditingEvents(ob){this.$b.toggleEditingEvents(ob)}waj(){this.jy?this.Maj():this.MDg()}qnk(){Q.a.i0a()?this.aBa.f0k(this.uOi()):(Kb.a.instance.w1(u.a.Y4,Zb.a.Bpb),Kb.a.instance.x1(u.a.Y4,Zb.a.Bpb));Kb.a.instance.Iba(u.a.Y4,
Zb.a.Bpb)}uOi(){return{UYb:this.nameBox.text}}MDg(){c.ULS.sendTraceTag(537161947,0,50,"FormulaBar.ctor: this.formulaBarElement is null (probably after dispose)")}V_f(ob){return!this.fze&&(125627505===ob||706199415===ob)}get text(){return super.text}static fEf(ob){return document.getElementById(ob.$h+u.a.Fgb)}static v2h(){const ob=document.createElement("div");ob.className=l.a.Fki;ob.classList.add(l.a.K_);return ob}static j4h(ob){const Na=document.createElement("div");Na.id=ob+Eb.yJj;Na.className=
l.a.xJj;Na.classList.add(l.a.K_);return Na}static Fxd(){const ob=La.a.vnb(),Na=document.createElement(ob?"div":"textarea");Na.className=l.a.Oki;Q.a.nYf()&&Na.classList.add(l.a.Qki);Na.classList.add(l.a.Pki);Na.classList.add(l.a.uHj);!Q.a.dA()||window.CSS&&window.CSS.supports&&window.CSS.supports("scrollbar-gutter","stable")||Na.classList.add(l.a.$Gj);ob?Na.id=u.a.JOb:(Na.cols=20,Na.rows=2);return Na}static C2h(ob){const Na=document.createElement("div");Na.id=ob+u.a.IOb;Na.className=l.a.zzf;N.DOMElementExtensions.UK(Na,
u.a.fF);Na.setAttribute(u.a.RC,"insert function");Na.tabIndex=0;Na.classList.add(l.a.K_);return Na}static i4h(ob){const Na=document.createElement("div");Na.id=ob+Eb.bMc;Na.className=l.a.fdg;N.DOMElementExtensions.UK(Na,u.a.fF);Na.setAttribute(u.a.RC,"commit edit");Na.tabIndex=0;Na.classList.add(l.a.K_);return Na}static W0h(ob){const Na=document.createElement("div");Na.id=ob+Eb.Snc;Na.className=l.a.O$e;N.DOMElementExtensions.UK(Na,u.a.fF);Na.setAttribute(u.a.RC,"cancel edit");Na.tabIndex=0;Na.classList.add(l.a.K_);
return Na}static N3h(ob){const Na=document.createElement("div");Na.id=ob+u.a.Uyf;Na.className=l.a.Kki;return Na}}Eb.yJj="okCancelButtonContainer";Eb.bMc="okboxButton";Eb.Snc="cancelboxButton";Eb.Zva=null;Object(y.a)(Eb,"FormulaBar",e.a,[59])},1334:function(y,x,a){a.d(x,"d",function(){return t});a.d(x,"c",function(){return m});a.d(x,"b",function(){return e});a.d(x,"a",function(){return w});var c=a(27),b=a(676),f=a(1335),r=a(140),d=a(141),k=a(659);const t=u=>255<u.length||!l(u)||c.a.aL(u,"_xl")?!1:
!0,m=(u,n)=>{var v=n.ha;n=v.qa.Gn;v=v.qa.activeRange;return u.sa.na&&n?b.b(u.Gh,v,u.sa.na.name):null},e=u=>{let n=null;u=u.ha.$e;u.isFloatingObjectSelected&&(n=u.yh.floatingObject);return n},w=(u,n=!0)=>{const v=f.a.getInstance(u),B=v.JOi();B&&!u.Gh.yq(B)&&k.a(d.a.wVh,[r.a.Bag],!0,!0,!1,!1,null);v.stop(n)},l=u=>{if(!u.length)return!1;for(let n=0;n<u.length;n++){const v=u.charAt(n),B=u.charCodeAt(n);if(!n){if("\\"!==v&&"_"!==v&&!c.a.isLetter(B))return!1}else if("_"!==v&&"."!==v&&!c.a.JXf(B)&&!c.a.isNumeral(B))return!1}return!0}},
1335:function(y,x,a){y=a(0);var c=a(14);class b{constructor(f){this.start=r=>{this.inProgress?c.ULS.sendTraceTag(528053384,0,50,"NameBoxTelemetry: Received start when an instance of this stopwatch was already ongoing"):(this.np.start(),this.inProgress=!0,this.xbg=r)};this.stop=(r=!0)=>{this.inProgress&&(this.np.stop(),r&&c.ULS.sendTraceTag(528053383,0,50,`{"CreateNamedRange_UserPerspective": ${this.np.ii}}`),this.inProgress=!1,this.xbg=void 0)};this.JOi=()=>this.xbg;this.np=f.qh.Vl("UserAction","CreateNamedObjectTimer");
this.inProgress=!1}}b.getInstance=f=>{void 0===b.instance&&(b.instance=new b(f));return b.instance};x.a=b;Object(y.a)(b,"NameBoxTelemetry",null,[])},1470:function(y,x,a){x=a(476);a=a(1471);a=a.kv?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);x(a,{insert:"head",AC:!1});y.exports=a.oH||{}},1471:function(y,x,a){x=a(477)(!1);x.push([y.i,'.ewa-fb{height:20px;background-color:#fff;color:#444;overflow:hidden;padding:10px 8px;position:relative;margin:auto}.grid-visual-refresh .ewa-fb{height:32px;overflow:hidden;padding:0;background-color:#f5f5f5}.ewa-fb-placeholder{color:#bbb}.ewa-root-ltr .ewa-fb{padding-right:4px}.ewa-root-rtl .ewa-fb{padding-left:4px}.ewa-fb-presence-cover,.ewa-fb-text-box{display:inline-block;margin:0 0 0 1px;padding:0;height:18px;width:100%;z-index:101}.ewa-fb-presence-cover{opacity:.2;position:absolute;margin:1px 10px 0 10px}.ewa-fb-text-box,.ewa-fb-text-box-monospace-experiment,.ewa-fb-text-box-new-theme{overflow:hidden;border:1px solid #e6e7e8;outline:0;resize:none;position:relative;flex-grow:1;white-space:pre}.ewa-fb-text-box:focus-within{outline:1px auto}.grid-visual-refresh .ewa-fb-text-box{background-color:#fff;height:18px;line-height:22px;margin:0;top:4px;width:auto;position:relative;padding:2px}.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#fff;height:18px;line-height:18px;margin:0;top:4px;width:auto;position:relative;padding:2px}.ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{height:18px;overflow:hidden;margin-top:1px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{height:100%;width:calc(100% - 4px);scrollbar-width:thin;scrollbar-color:#b1b0b0 #fff}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-button:start{background-color:#fff;height:18px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-button:end{background-color:#fff;height:4px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-thumb{border-radius:10px;background-color:#b1b0b0}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar{width:6px}.ewa-fb-extended .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{overflow-y:auto;overflow-x:hidden}.grid-visual-refresh .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{line-height:inherit;height:inherit}.grid-visual-refresh .ewa-fb-text-box.ie .ewa-rteTextElement>.ewa-rteLine{line-height:inherit}.ewa-fb-text-box.ql-container{pointer-events:none}.ewa-fb-text-box .ewa-rteTextElement{pointer-events:all}.ewa-root-ltr .ewa-fb-presence-cover,.ewa-root-ltr .ewa-fb-text-box{left:33px}.ewa-root-ltr .grid-visual-refresh .ewa-fb-text-box{right:4px;left:38px}.ewa-root-rtl .ewa-fb-text-box .ewa-root-rtl .ewa-fb-presence-cover{right:33px}.ewa-root-rtl .grid-visual-refresh .ewa-fb-text-box{right:38px;left:4px}.ewa-fb .functionbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101}.green-fill-paths:hover path{fill:#107C41}.grid-visual-refresh .ewa-fb .functionbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-root-ltr .grid-visual-refresh .ewa-fb .functionbox{margin-right:3px}.ewa-root-rtl .grid-visual-refresh .ewa-fb .functionbox{margin-left:3px}.ewa-fb-presence-cover-internal{height:100%}.ewa-root-ltr .ewa-fb-presence-cover-internal{margin-right:50px}.ewa-root-rtl .ewa-fb-presence-cover-internal{margin-left:50px}.ewa-fb .functionbox .clip13x13{margin:2px 8px 1px 8px}.grid-visual-refresh .ewa-fb .functionbox .clip13x13{margin-top:4px;margin-bottom:4px}.ewa-fb .functionbox:hover .ewaboot_formulabar13{margin-top:-13px}.ewa-root-ltr .ewa-fb.drop-down{padding-left:3px}.ewa-root-rtl .ewa-fb.drop-down{padding-right:3px}.ewa-fb .ok-cancel-buttons-container{position:relative;z-index:101;display:none;flex-flow:row}.ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{display:flex;order:1;height:22px;border:1px solid #e6e7e8;top:4px}.ewa-root-rtl .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{margin-left:3px}.ewa-root-ltr .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{margin-right:3px}.grid-visual-refresh .ewa-fb .ok-cancel-buttons-container{position:relative}.ewa-fb .okbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101;margin:0 2px 0 2px;display:flex;justify-content:center;align-items:center}.grid-visual-refresh .ewa-fb .okbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-fb .cancelbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101;display:flex;justify-content:center;align-items:center}.grid-visual-refresh .ewa-fb .cancelbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-fb-nb{display:flex;flex-flow:row}.grid-visual-refresh .ewa-fb-nb{background-color:#f5f5f5;height:32px}.ewa-fb-nb .ewa-fb.drop-down{flex:1 1 auto}.grid-visual-refresh .ewa-fb-nb .ewa-fb.drop-down{right:0;height:32px;display:flex;flex-flow:row}.ewa-fb-name-box-placeholder{position:relative;width:118px;float:left;display:block;overflow:hidden;height:20px;background-color:#fff;padding:2px;align-self:center;margin:0 0 0 4px}.ewa-root-rtl .ewa-fb-name-box-placeholder{float:right;margin:0 4px 0 0}.button-disabled{pointer-events:none;background-color:#f0f0f0!important}.ewa-fb-extended .ewa-fb-expand-button-img{transform:rotate(180deg)}.ewa-fb-expand-button-container{padding-top:3px;position:absolute;z-index:102}.ewa-root-ltr .ewa-fb-expand-button-container{padding-right:7px;right:0}.ewa-root-rtl .ewa-fb-expand-button-container{padding-left:7px;left:0}.ewa-fb-text-div-container{width:100%;position:relative}.ewa-fb-refactor .ewa-fb-text-div-container{order:2}body.ewa-fb-drag-resize *{cursor:inherit!important}body.ewa-fb-drag-resize{cursor:ns-resize}.ewa-fb-drag-handler{position:absolute;height:6px;width:100%;cursor:ns-resize;z-index:102;bottom:0}.grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new{height:calc(100% - 8px);box-sizing:border-box;width:100%}.grid-visual-refresh .ewa-fb-refactor.ewa-fb-nb .ewa-fb.drop-down{height:inherit}.grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{height:auto;overflow:hidden;white-space:pre-wrap}.ewa-root-ltr .grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-right:20px}.ewa-root-rtl .grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-left:20px}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .functionbox{top:0;order:2;border:none;margin:0}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .okbox{top:0;margin:0;border:none;order:1}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .cancelbox{top:0;border:none;order:0}.ewr-presentMode-on .ewa-fb{color:#f3f2f1}.ewr-presentMode-on.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-on.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#3c3c3c;border:1px solid #3c3c3c;border-radius:2px}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#292827!important;border:1px solid #292827!important}.ewr-presentMode-on.grid-visual-refresh .ewa-fb,.ewr-presentMode-on.grid-visual-refresh .ewa-fb-nb{background-color:#323130}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-nb{background-color:#000!important}.ewr-presentMode-on.grid-visual-refresh .ewa-fb .functionbox{background-color:#323130;border:1px solid #323130}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .functionbox{background-color:#000!important;border:1px solid #000!important}.ewr-presentMode-on .green-fill-paths:hover path{fill:#37a660}.ewr-presentMode-on .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{border:none}.ewr-presentMode-on .ewa-fb .okbox,.ewr-presentMode-on.grid-visual-refresh .ewa-fb .okbox{background-color:#3c3c3c;border:1px solid #3c3c3c;border-top-right-radius:2px;border-bottom-right-radius:2px}.ewr-presentMode-on.ewr-namedsheetview .ewa-fb .okbox,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .okbox{background-color:#292827!important;border:1px solid #292827!important}.ewr-presentMode-on .ewa-fb .cancelbox,.ewr-presentMode-on.grid-visual-refresh .ewa-fb .cancelbox{background-color:#3c3c3c;border:1px solid #3c3c3c;border-top-left-radius:2px;border-bottom-left-radius:2px}.ewr-presentMode-on.ewr-namedsheetview .ewa-fb .cancelbox,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .cancelbox{background-color:#292827!important;border:1px solid #292827!important}.ewr-presentMode-on .ewa-fb-expand-button-img{fill:#e1dfdd}.ewr-presentMode-on .ql-editor ::selection{background-color:#605e5c}.ewr-presentMode-on .functionbox.button-disabled{background-color:#323130!important}.ewr-presentMode-on .ewa-fb-function-button-img{fill:#e1dfdd}.ewr-presentMode-on .functionbox.button-disabled .ewa-fb-function-button-img{fill:#8a8886!important}.ewr-presentMode-transition .ewa-fb .cancelbox,.ewr-presentMode-transition .ewa-fb .okbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .cancelbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .functionbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .okbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-fb,.ewr-presentMode-transition .functionbox.button-disabled,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-nb{transition:background-color .4s linear,color .4s linear}.ewa-fb-nb.ewa-fb-refactor.ewa-fb-fluent{height:24px;background-color:#F5F5F5;color:#444;overflow:hidden;padding:4px 8px;position:relative;margin:0;gap:8px;flex-flow:row}.ewa-fb-fluent .ewa-fb.drop-down{flex-flow:row;gap:8px;padding-left:0;padding-right:0}.ewa-fb-fluent .ewa-fb.drop-down .ok-cancel-buttons-container{display:flex;width:66px;border:1px solid #D1D1D1;border-radius:4px;flex-flow:row;top:0;margin:0}.ewa-fb-fluent .functionbox{display:flex;align-items:center;justify-content:center}.ewa-root-ltr .ewa-fb-fluent .functionbox{border-top-right-radius:4px;border-bottom-right-radius:4px}.ewa-root-rtl .ewa-fb-fluent .functionbox{border-top-left-radius:4px;border-bottom-left-radius:4px}.ewa-root-ltr .ewa-fb-fluent .cancelbox{border-top-left-radius:4px;border-bottom-left-radius:4px}.ewa-root-rtl .ewa-fb-fluent .cancelbox{border-top-right-radius:4px;border-bottom-right-radius:4px}.ewa-fb-fluent .cancelbox:hover,.ewa-fb-fluent .ewa-fb-expand-button-container:hover,.ewa-fb-fluent .functionbox:hover,.ewa-fb-fluent .okbox:hover{background-color:#F5F5F5}.ewa-fb-fluent .cancelbox:focus,.ewa-fb-fluent .ewa-fb-expand-button-container:focus,.ewa-fb-fluent .functionbox:focus,.ewa-fb-fluent .okbox:focus{background-color:#E0E0E0}.ewa-fb-fluent .cancelbox.button-disabled,.ewa-fb-fluent .functionbox.button-disabled,.ewa-fb-fluent .okbox.button-disabled{pointer-events:none;background-color:#FFF!important}.ewa-fb-fluent .cancelbox.button-disabled path,.ewa-fb-fluent .functionbox.button-disabled path,.ewa-fb-fluent .okbox.button-disabled path{fill:#BDBDBD}.ewa-fb-fluent .ewa-fb-text-div-container{display:flex;border-radius:4px;flex-flow:column}.ewa-fb-fluent .ewa-fb-expand-button-container{order:1;height:20px;width:20px;border-radius:4px;flex-grow:0;padding:0}.ewa-root-ltr .ewa-fb-fluent .ewa-fb-expand-button-container{margin:2px 4px 0 0}.ewa-root-rtl .ewa-fb-fluent .ewa-fb-expand-button-container{margin:2px 0 0 4px}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new{border:1px solid #D1D1D1;border-radius:4px;top:0;line-height:16px;padding:3px 0 5px 0;color:#242424}.ewa-root-ltr .ewa-fb-refactor.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-right:10px}.ewa-root-ltr .ewa-fb-refactor.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new.not-ie.no-scrollbar-gutter-support .ewa-rteTextElement>.ewa-rteLine{padding-right:10px}.ewa-root-rtl .ewa-fb-refactor.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-left:12px}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement>.ewa-rteLine{cursor:text}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{height:calc(100% - 4px);width:calc(100% - 22px);margin-top:2px;cursor:default}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-thumb{border-radius:4px;background-color:grey;background-clip:padding-box}.ewa-root-ltr .ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{padding:0 4px 0 8px}.ewa-root-rtl .ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{padding:0 4px 0 14px}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new:focus-within{outline:0;border:1px solid #D1D1D1;border-bottom-style:none}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new:focus-within::after{box-sizing:border-box;content:"";position:absolute;left:-1px;bottom:-1px;right:-1px;height:4px;border-bottom-left-radius:4px;border-bottom-right-radius:4px;border-bottom:3px solid #107c41;clip-path:inset(calc(100%-3px) 0 0)}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new.ewa-fb-disabled{border:1px solid #D1D1D1;border-radius:4px;background-color:#F5F5F5}.ewa-fb-fluent .cancelbox.button-disabled.ewa-fb-disabled,.ewa-fb-fluent .functionbox.button-disabled.ewa-fb-disabled,.ewa-fb-fluent .okbox.button-disabled.ewa-fb-disabled{background-color:#F5F5F5!important}.ewa-root-ltr .ewa-fb-rtl .ewa-rteLine{padding-right:20px!important}.ewa-fb-fluent .ql-editor ::selection{background:#616161;color:#FFF}.skel-fb-namebox-wrapper{height:24px;width:124px;line-height:22px;padding:0 16px 0 0;border-color:#d1d1d1;position:relative;background-color:#fff;border-width:1px;border-style:solid;overflow:hidden;white-space:nowrap;box-sizing:border-box;border-radius:4px}.skel-fb-namebox-wrapper.skel-legacy-namebox{border-radius:0;line-height:16px;border-color:#e1dfdd;margin:4px}.skel-fb-namebox-button{position:absolute;border:none;padding:0;background-color:transparent;color:#797775;min-width:16px;right:-1px;display:flex;height:24px;justify-content:center;align-items:center}.skel-fb-namebox-rtl{left:-1px;right:auto}.skel-fb-namebox-icon{display:flex;width:12px;fill:#252423;align-items:center;justify-content:center}.skel-legacy-namebox .skel-fb-namebox-icon{font-size:12px;margin:0;height:8px;line-height:8px;text-align:center;flex-shrink:0;display:flex;width:8px;align-items:center}.skel-fb-namebox-disabled{background-color:#f5f5f5}.skel-fb-namebox-disabled .skel-fb-namebox-span{color:#c8c6c4}.skel-fb-namebox-disabled .skel-svg-disabled{fill:#939393}.skel-fb-namebox-disabled svg{opacity:.4}.skel-fb-namebox-span{color:#252423;float:left;margin-right:4px;height:16px;line-height:16px;background-color:transparent;box-sizing:border-box;width:100px;border-style:none;outline:0;text-overflow:ellipsis;font-size:12px;padding:4px}.skel-fb-namebox-span.skel-fb-namebox-v9{font-family:"Aptos Narrow","Segoe UI","Segoe UI Web (West European)","Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;font-size:11pt;line-height:15px}',
""]);y.exports=x},855:function(y,x,a){a.r(x);y={};a.r(y);a.d(y,"FormulaBarCommandHandler",function(){return sa});var c=a(179);x=a(0);a(208);var b=a(14),f=a(147),r=a(593),d=a(77),k=a(150),t=a(137),m=a(10),e=a(26),w=a(45),l=a(676),u=a(122),n=a(265),v;(function(ab){ab[ab.NONE=0]="NONE";ab[ab.FLOATING_OBJECTS=1]="FLOATING_OBJECTS";ab[ab.PRINT_AREA=2]="PRINT_AREA";ab[ab.DISCONTINUOUS_RANGES=3]="DISCONTINUOUS_RANGES";ab[ab.ILLEGAL_SHEET_SCOPE=4]="ILLEGAL_SHEET_SCOPE";ab[ab.INVALID_NAME=5]="INVALID_NAME";
ab[ab.EMPTY_RANGE=6]="EMPTY_RANGE";ab[ab.GENERIC_ERROR=7]="GENERIC_ERROR";ab[ab.VIEW_MODE=8]="VIEW_MODE"})(v||(v={}));Object(x.b)("NameBoxInvalidOperation",v);var B=a(35),z=a(27),C=a(12),D=a(140),J=a(141),W=a(659),N=a(106);class M extends n.a{constructor(ab,db){super(ab,db);this.Mv()}get ki(){return"NameBoxErrorDialog"}Mv(){super.Mv();const ab=this.error.Caption,db=this.LIi(this.error),mb=this.KIi(this.error);this.Bh=0;this.kta(mb);this.Io(ab,db,2,this.X1)}LIi(ab){return z.a.equals(ab.MessageIdName,
M.I0c,!0)?String.format(ab.Description):z.a.equals(ab.MessageIdName,M.fTb,!0)?"":ab.Description}KIi(ab){const db=[];z.a.equals(ab.MessageIdName,M.fTb,!0)&&(ab=String.format(C.a.instance.ia(2253)),db.push(...ab.split("-").map(mb=>mb.trim())));return db}static SU(ab,db=null){if(ab.MessageIdName===M.fTb)b.ULS.sendTraceTag(528053385,0,50,ab.Caption);else{let mb=ab.Caption;ab.MessageIdName===M.I0c&&(mb=`Unsupported Operation: ${v[db]}`);ab=new N.a;ab.ga("errorCaption",mb);W.a(J.a.Gri,[D.a.Bag],!0,!0,!1,
!1,ab)}}static Yi(ab){switch(ab){case 3:case 1:case 2:return B.a.Yi(1,0,2254,2255,0,-1280789630,M.I0c);case 5:case 4:return B.a.Yi(1,0,2252,2253,0,875859818,M.fTb);case 8:case 7:return B.a.Yi(1,0,0,1,0,424201999,M.fTb);case 6:return B.a.Yi(1,0,2256,2257,0,-1280789630,M.I0c);default:throw Error.invalidOperation("Error should not be created if there is no valid NameBoxInvalidOperation");}}}M.I0c="NameBoxUnsupportedOperation";M.fTb="NameBoxInvalidName";Object(x.a)(M,"NameBoxErrorDialog",n.a,[]);const Q=
(ab,db,mb,Ia,pa,lb,ha)=>{a:switch(ha){case 2:ha="Table";break a;case 3:ha=z.a.YMb(db,"Print_Area")?"Print Area":"Named Range";break a;default:ha="Unknown"}return{key:ab,name:db,sheetName:mb,topLeft:Ia,bottomRight:pa,location:lb,type:ha}};var R=a(1334),O=a(1),U=a(24),K=a(151),F=a(1335);class I{constructor(ab,db){this.printArea="Print_Area";this.Frk="R";this.HVh="C";this.yFj="Value";this.$=ab;this.da=U.f(this.$);this.QLa=db;this.zFj=F.a.getInstance(this.$)}o4j(){var ab=this.$.Gh.items,db=this.$.na.name;
const mb={};for(var Ia of ab){ab=l.a(Ia.name);var pa=ab.tvb;if(d.h(Ia)&&(!pa||z.a.equals(ab.scope,db,!1))){var lb=ab.name in mb;if(!lb||lb&&pa)mb[ab.name]={["namedObjectDetails"]:ab,["namedObjectItem"]:Ia}}}db=[];for(const ha in mb)ab=mb[ha],Ia=ab.namedObjectItem,ab=ab.namedObjectDetails,pa=`${Ia.sheetName}!${Ia.usedRange.topLeft.xF(!1)}:${Ia.usedRange.bottomRight.xF(!1)}`,lb=Ia.type,db.push(Q(Ia.name,ab.name,Ia.sheetName,Ia.usedRange.topLeft.xF(!1),Ia.usedRange.bottomRight.xF(!1),pa,lb));db.sort((ha,
ua)=>ha.name.localeCompare(ua.name));this.QLa.p4j(db);R.a(this.$,!1);this.KDg(db.length)}w1i(ab){ab=l.a(ab[this.yFj].toString());const db=ab.name,mb=ab.scope.length?ab.scope:null;var Ia=this.JSh(ab);this.qvk(ab)||(this.Xwj(ab),0!==Ia?(this.QLa.Bmf(this.$,Ia),this.QFg()):R.d(db)?(Ia=w.s(U.f(this.$).ha.qa.selectedRanges,this.$),this.QLa.O3h(this.$,db,Ia,mb,I.NJj,I.MJj),this.zFj.start(ab.name)):(this.QLa.Bmf(this.$,5),this.QFg()))}GFd(){this.QLa.GFd()}qvk(ab){const db=ab.fullName,mb=ab.name,Ia=ab.scope;
let pa,lb,ha=!1;!({sheetName:pa,range:lb}=w.ib(db,this.$.sa)).returnValue||!lb.nD&&O.EwaSettings.isChangeGateEnabled("OfficeVSO:4653651_CheckIsValidRangeInNamedObjectDropDown")?z.a.equals(mb,this.Frk,!0)?(this.rvk(Ia),this.t5a(2)):z.a.equals(mb,this.HVh,!0)?(this.ivk(Ia),this.t5a(2)):this.$.Gh.yq(db)?(this.iJg(db),this.t5a(ab.tvb?1:0)):this.$.Gh.yq(mb)?(this.iJg(mb),this.t5a(0)):ha=!0:(this.lvk(pa,lb),this.t5a(3));return!ha}lvk(ab,db){ab=ab||this.$.sa.na.name;var mb=l.b(this.$.Gh,db,ab);l.c(mb)||
(mb=w.w(db,this.$),mb.SheetName=ab,U.f(this.$).To(mb,db.topLeft,null,null,60,"NameBoxCommandHandler.SelectNamedObjectByRange"),this.da.focus())}rvk(ab=null){const db=this.da.ha.qa.activeCell;this.zaf(ab)&&(ab=new e.Range(db.top,0,db.bottom,m.a.Qk,!0,!1),this.da.ha.DP([ab],0,ab,0))}ivk(ab=null){const db=this.da.ha.qa.activeCell;this.zaf(ab)&&(ab=new e.Range(0,db.left,m.a.gl,db.right,!0,!1),this.da.ha.DP([ab],0,ab,0))}zaf(ab){return ab?(ab=this.$.sa.getItemByName(ab),(null===ab||void 0===ab?0:ab.visible)?
(ab.activate({scenario:"namedObject"}),!0):!1):!0}iJg(ab){ab=this.$.Gh.getItemByName(ab);l.c(ab);this.da.focus()}JSh(ab){return this.$.isEditMode?this.Hij()?1:z.a.equals(ab.name,this.printArea,!0)?2:this.Obi()?3:this.i7i(ab)?4:this.Jhj()?6:0:8}QFg(){var ab=R.b(this.da);null!=ab?this.QLa.Ysd("",ab.name):(ab=R.c(this.$,this.da))?this.QLa.Ysd(ab.name,ab.name):this.QLa.Ysd("",this.da.ha.qa.activeCell.toString())}Hij(){return!!this.da.ha.$e.activeFloatingObjectControlId}Obi(){return 1<this.da.ha.qa.selectedRanges.length}i7i(ab){return ab.tvb&&
!this.$.LU(ab.scope)}Jhj(){return this.da.Yg.FKa(this.da.ha.qa.selectedRanges[0])}static NJj(ab){return db=>{B.a.Jk(db.Errors)&&(M.SU(db.Errors[0]),new M(ab,db.Errors[0]),F.a.getInstance(ab).stop(!1))}}static MJj(ab){return db=>{(db=u.a.Qj(db.data))&&0<db.length?(M.SU(db[0]),new M(ab,db[0])):(M.SU(M.Yi(7)),new M(ab,M.Yi(7)));F.a.getInstance(ab).stop(!1)}}Xwj(ab){const db=null!=R.c(this.$,this.da);ab.tvb?this.t5a(db?7:6):this.t5a(db?5:4)}t5a(ab){K.b(this.$).lj(k.a.JSk,{type:ab.toString()},null,!0)}KDg(ab){K.b(this.$).lj(k.a.ksg,
{cfl:ab},null,!0)}}Object(x.a)(I,"NameBoxCommandHandler",null,[]);var P=a(419),Y=a(212),ea=a(62);const Ba=(ab,db,mb,Ia,pa,lb,ha,ua,fb,Ka,La=null)=>{La=ab.Za(9,La);La.name=db;La.selectedRanges=mb;La.sheetName=Ia;La.formula=pa;La.comment=lb;return ea.h(ab,"AddDefinedName",La,ha,ua,fb,Ka,0)};var Fa=a(262),za=a(133),xa;(function(ab){ab[ab.EMPTY_RANGE=0]="EMPTY_RANGE";ab[ab.RANGE_CREATED=1]="RANGE_CREATED"})(xa||(xa={}));Object(x.b)("NameBoxStatusCalloutType",xa);class fa{jci(){this.Kif();appChrome.renderNameBoxStatusCallout(fa.UYc,
xa.EMPTY_RANGE)}pci(ab,db){this.Kif();const mb=Object(w.E)(db.Ranges[0]);appChrome.renderNameBoxStatusCallout(fa.UYc,xa.RANGE_CREATED,ab,db.SheetName,`${mb.topLeft.toString()}:${mb.bottomRight.toString()}`)}Kif(){null==fa.UYc&&(fa.UYc=document.createElement("div"))}p4j(ab){za.c()&&appChrome.populateNameBoxMenu(ab)}O3h(ab,db,mb,Ia,pa,lb){const ha=()=>this.pci(db,mb);P.a(ab.userOperationManager,(ua,fb,Ka)=>Ba(ab.pa.ta,db,mb,Ia,"","",Fa.c(ua,pa(ab),O.EwaSettings.isChangeGateEnabled("OfficeVSO:8156986_AddsNameBoxStatusCallout")?
ha:void 0),Fa.b(fb,lb(ab)),Ka,ab),ua=>new Y.a(1020,0,ua),null)}Bmf(ab,db){M.SU(M.Yi(db),db);8!==db&&(O.EwaSettings.isChangeGateEnabled("OfficeVSO:8156986_AddsNameBoxStatusCallout")&&6===db?this.jci():new M(ab,M.Yi(db)))}GFd(){appChrome.updateNameBoxState({["focus"]:!0})}Ysd(ab,db){appChrome.setNamedObjectOrActiveCellRange(ab,db)}}fa.UYc=null;Object(x.a)(fa,"NamedObjectsService",null,[250]);var V=a(209),ba=a(66),la=a(7),Ta=a(5),Ea=a(97);let sa=class{constructor(ab,db){this.$=ab;this.da=U.f(this.$);
this.Ya=db;this.X3d=new I(ab,new fa)}Bi(){return!1}executeCommand(ab,db,mb){db=db.command;ab=null;switch(db){case 1726517890:this.X3d.w1i(mb);break;case 2045896573:mb=t.a(this.$);(null===mb||void 0===mb?0:mb.gYa)?mb.gYa.mvf():b.ULS.sendTraceTag(537161936,0,15,"FormulaBarCommandHandler.ExecuteCommand: FormulaBarResizeControl is null when trying to expand the formula bar");break;case -1003645154:this.X3d.GFd();break;case -1790328692:mb=t.a(this.$);db=!this.$.oUb;mb.isVisible=db;mb.$b.isVisible=db;this.$.oUb=
db;this.$.jm();try{f.a.hG(la.a.yWf,db.toString(),r.AFrame.OBa)}catch(Ia){b.ULS.sendTraceTag(509216780,0,15,`Failed setting ExcelIsFormulaBarOn cookie with error message: ${Ia.message}`)}break;default:ab=V.a(db)}return ab||ba.Task.Va(!0)}ni(ab,db,mb){ab=!1;switch(db.command){case 1726517890:ab=!!mb;break;case -1003645154:case 2045896573:ab=!0;break;case -1790328692:ab=O.EwaSettings.isChangeGateEnabled("OfficeVSO:8235335_DisplaySettings")}return ab}Ji(ab,db){if("PopulateNameBoxMenu"!==db)return!1;ab=
this.$.qh.vi("UserAction","PopulateNameBoxMenuTimer");this.X3d.o4j();ab.stop();return!0}KDg(ab){ab={["NamedObjectsCount"]:ab};K.b(this.$).lj(k.a.ksg,ab,null,!0)}};sa=Object(c.__decorate)([Object(Ea.d)(Ta.Ec),Object(c.__param)(0,Object(Ta.Lb)()),Object(c.__param)(1,Object(Ta["if"])())],sa);Object(x.a)(sa,"FormulaBarCommandHandler",null,[39]);var Ya=a(9);c=a(420);var bb=a(79),ra=a(40),Da=a(1144),oa=a(43),Ha=a(901),ka=a(25),wa=a(93);class Za extends c.a{constructor(ab){super();this.$=ab;this.Bl()}create(){oa.a.instance.NBa(la.a.Y4);
const ab=bb.GetServiceTaskFactory.Bj(this.$.ka,388,387,this.hh),db=ka.a.i0a()?Object(wa.d)(Ea.a.resolve(Ta.Of)):ba.Task.Va(null);ra.TaskExtensions.Ua(ra.TaskExtensions.Ln([ab,db],this.xa),()=>{this.Yj(Object(Ha.a)(this.$.ka,172,()=>new Da.FormulaBar(this.$,db.result,ab.result)))},this.$.xa,3)}}Object(x.a)(Za,"FormulaBarFactory",c.a,[]);(()=>{Ya.a.Qg(ab=>{O.EwaSettings.isChangeGateEnabled("OfficeVSO:8704628_importFBLessAsCoreCss")||a(1470);ab.ka.ph(186,new Za(ab))})})();String(y);window.___1708742503552_closurehack=
y}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.vrd.js.map/90538d57a17f706c0970b126ad9236d5/EwaTS.vrd.js.map