var clipboardPlatform=function(e){var t={};function r(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(a,o,function(t){return e[t]}.bind(null,o));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=44)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=t.initStopwatchFactory=t.ConsoleLogger=t.NulLogger=t.perfWatch=t.browserSupport=t.LogCategory=t.TraceLevel=t.ULS=t.utils=t.replaceChildren=t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=t.getNewGuid=void 0;var a=r(6);t.utils=a;var o=r(4);Object.defineProperty(t,"ULS",{enumerable:!0,get:function(){return o.ULS}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return o.TraceLevel}}),Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return o.LogCategory}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return o.NulLogger}}),Object.defineProperty(t,"ConsoleLogger",{enumerable:!0,get:function(){return o.ConsoleLogger}});var n=r(8);t.browserSupport=n;var i=r(9);t.perfWatch=i;var s=r(11);Object.defineProperty(t,"initStopwatchFactory",{enumerable:!0,get:function(){return s.initStopwatchFactory}});var c=r(12);Object.defineProperty(t,"TelemetryCollector",{enumerable:!0,get:function(){return c.TelemetryCollector}});var l=r(13);Object.defineProperty(t,"getNewGuid",{enumerable:!0,get:function(){return l.getNewGuid}});var d=r(14);Object.defineProperty(t,"TextAreaVirtualKeyboardPolicy",{enumerable:!0,get:function(){return d.TextAreaVirtualKeyboardPolicy}}),Object.defineProperty(t,"TextAreaInputMode",{enumerable:!0,get:function(){return d.TextAreaInputMode}});var u=r(15);Object.defineProperty(t,"replaceChildren",{enumerable:!0,get:function(){return u.replaceChildren}})},function(e,t,r){"use strict";r.d(t,"kc",(function(){return s})),r.d(t,"Eb",(function(){return c})),r.d(t,"Hb",(function(){return C})),r.d(t,"Ib",(function(){return v})),r.d(t,"Nb",(function(){return E})),r.d(t,"a",(function(){return L})),r.d(t,"D",(function(){return T})),r.d(t,"B",(function(){return _})),r.d(t,"t",(function(){return I})),r.d(t,"u",(function(){return O})),r.d(t,"M",(function(){return A})),r.d(t,"A",(function(){return P})),r.d(t,"K",(function(){return j})),r.d(t,"N",(function(){return x})),r.d(t,"L",(function(){return D})),r.d(t,"b",(function(){return W})),r.d(t,"m",(function(){return k})),r.d(t,"H",(function(){return R})),r.d(t,"c",(function(){return U})),r.d(t,"e",(function(){return F})),r.d(t,"J",(function(){return N})),r.d(t,"ec",(function(){return J})),r.d(t,"Db",(function(){return G})),r.d(t,"Mb",(function(){return q})),r.d(t,"Jb",(function(){return X})),r.d(t,"Lb",(function(){return Y})),r.d(t,"Kb",(function(){return Q})),r.d(t,"Gb",(function(){return $})),r.d(t,"Ab",(function(){return Z})),r.d(t,"jb",(function(){return m})),r.d(t,"Zb",(function(){return b})),r.d(t,"Yb",(function(){return h})),r.d(t,"Wb",(function(){return y})),r.d(t,"Xb",(function(){return S})),r.d(t,"i",(function(){return l})),r.d(t,"j",(function(){return te})),r.d(t,"p",(function(){return re})),r.d(t,"E",(function(){return ae})),r.d(t,"k",(function(){return oe})),r.d(t,"q",(function(){return ne})),r.d(t,"F",(function(){return ie})),r.d(t,"P",(function(){return se})),r.d(t,"hb",(function(){return ce})),r.d(t,"ib",(function(){return le})),r.d(t,"jc",(function(){return de})),r.d(t,"Cb",(function(){return ue})),r.d(t,"fc",(function(){return pe})),r.d(t,"gc",(function(){return ge})),r.d(t,"Ub",(function(){return fe})),r.d(t,"Vb",(function(){return me})),r.d(t,"Rb",(function(){return be})),r.d(t,"Tb",(function(){return he})),r.d(t,"Sb",(function(){return ye})),r.d(t,"Qb",(function(){return Se})),r.d(t,"qb",(function(){return Ce})),r.d(t,"sb",(function(){return _e})),r.d(t,"ob",(function(){return Ie})),r.d(t,"nb",(function(){return Oe})),r.d(t,"R",(function(){return Ae})),r.d(t,"mb",(function(){return Pe})),r.d(t,"lb",(function(){return je})),r.d(t,"pb",(function(){return xe})),r.d(t,"tb",(function(){return De})),r.d(t,"g",(function(){return Ee})),r.d(t,"r",(function(){return we})),r.d(t,"f",(function(){return d})),r.d(t,"n",(function(){return u})),r.d(t,"I",(function(){return p})),r.d(t,"d",(function(){return g})),r.d(t,"s",(function(){return Le})),r.d(t,"xb",(function(){return Ze})),r.d(t,"oc",(function(){return et})),r.d(t,"C",(function(){return it})),r.d(t,"ic",(function(){return st})),r.d(t,"bb",(function(){return ct})),r.d(t,"U",(function(){return lt})),r.d(t,"kb",(function(){return dt})),r.d(t,"S",(function(){return pt})),r.d(t,"z",(function(){return gt})),r.d(t,"Pb",(function(){return ft})),r.d(t,"mc",(function(){return mt})),r.d(t,"T",(function(){return bt})),r.d(t,"nc",(function(){return ht})),r.d(t,"h",(function(){return St})),r.d(t,"V",(function(){return vt})),r.d(t,"W",(function(){return _t})),r.d(t,"X",(function(){return yt})),r.d(t,"ab",(function(){return Ot})),r.d(t,"cb",(function(){return At})),r.d(t,"Fb",(function(){return Pt})),r.d(t,"lc",(function(){return jt})),r.d(t,"bc",(function(){return xt})),r.d(t,"yb",(function(){return Dt})),r.d(t,"O",(function(){return Mt})),r.d(t,"fb",(function(){return Rt})),r.d(t,"db",(function(){return Ut})),r.d(t,"gb",(function(){return Nt})),r.d(t,"eb",(function(){return Jt})),r.d(t,"v",(function(){return Ht})),r.d(t,"Ob",(function(){return Vt})),r.d(t,"ub",(function(){return Gt})),r.d(t,"vb",(function(){return Bt})),r.d(t,"wb",(function(){return Kt})),r.d(t,"l",(function(){return Xt})),r.d(t,"G",(function(){return Yt})),r.d(t,"o",(function(){return qt})),r.d(t,"rb",(function(){return Qt})),r.d(t,"Q",(function(){return $t})),r.d(t,"zb",(function(){return Ke})),r.d(t,"Z",(function(){return tr})),r.d(t,"x",(function(){return rr})),r.d(t,"Y",(function(){return Zt})),r.d(t,"w",(function(){return er})),r.d(t,"y",(function(){return ar})),r.d(t,"ac",(function(){return We})),r.d(t,"cc",(function(){return Re})),r.d(t,"dc",(function(){return ke})),r.d(t,"Bb",(function(){return o})),r.d(t,"hc",(function(){return a}));var a={};r.r(a),r.d(a,"sharedClipboardSettingsVariableName",(function(){return Ue})),r.d(a,"defaultPromiseTimeoutInMinutes",(function(){return Je})),r.d(a,"getSharedClipboardSettings",(function(){return ze})),r.d(a,"initializeSharedClipboardSettingsFromWindow",(function(){return He})),r.d(a,"initializeSharedClipboardSettings",(function(){return Ve})),r.d(a,"createEmptySharedClipboardSettings",(function(){return Be}));var o={};r.r(o),r.d(o,"divTagName",(function(){return lr})),r.d(o,"preTagName",(function(){return dr})),r.d(o,"tableTagName",(function(){return ur})),r.d(o,"trTagName",(function(){return pr})),r.d(o,"tdTagName",(function(){return gr})),r.d(o,"ccpTimestampHtmlCustomAttributeName",(function(){return Cr})),r.d(o,"minCcpTimestampHtmlCustomAttributeValue",(function(){return vr})),r.d(o,"ensureOneLFPerNewLine",(function(){return Er})),r.d(o,"trimToLength",(function(){return wr})),r.d(o,"createTextHtmlFromTextPlain",(function(){return Lr})),r.d(o,"createHtmlItemFromTextPlain",(function(){return Tr})),r.d(o,"createPlainTextFromHtml",(function(){return _r})),r.d(o,"isContainsTimestampWrapper",(function(){return Or})),r.d(o,"addClipboardWrapperForEdge",(function(){return Ar})),r.d(o,"getFragmentFromTextHtml",(function(){return Pr})),r.d(o,"getCcpTimestampHtmlCustomAttributeFromWrappingTag",(function(){return jr})),r.d(o,"getExternalSource",(function(){return xr})),r.d(o,"encodeAngleBrackets",(function(){return Dr})),r.d(o,"wrapContentWithTagAndAttributes",(function(){return Mr}));var n,i=r(0);function s(){return n}function c(e){if(!e)throw new Error("The 'logger' argument is missing");n=i.ULS.getFromExternalLogger(e)}var l,d,u,p,g,f=r(2),m="",b=" ",h=".",y="1",S="1";function C(e,t){return v(e,[t])}function v(e,t){if(!function(e){if(!e||"object"!=typeof e||!("reason"in e))return!1;if(!function(e){if(!e&&0!==e)return!1;var t=Number(e);if(isNaN(t)||t.toString()!==e.toString())return!1;return!0}(e.reason))return!1;return!0}(e))return!1;if(!t||!Array.isArray(t)||t.length<1)return!1;var r=e.reason;return t.indexOf(r)>=0}function E(e){if(e&&"object"==typeof e){if(w(e.reason))return!0;if(e.innerError&&"string"==typeof e.innerError)try{if(w(JSON.parse(e.innerError).reason))return!0}catch(e){}}if("string"==typeof e)try{if(w(JSON.parse(e).reason))return!0}catch(e){}return!1}function w(e){return e===d.LocalStorageInitilizationInaccessible}!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.FullAccessClipboardAndInMemory=3]="FullAccessClipboardAndInMemory",e[e.InMemory=4]="InMemory",e[e.LocalStorage=5]="LocalStorage",e[e.SystemClipboardAndLocalStorage=6]="SystemClipboardAndLocalStorage",e[e.SystemClipboardAndInMemory=7]="SystemClipboardAndInMemory",e[e.AsyncSystemClipboard=8]="AsyncSystemClipboard",e[e.AsyncSystemClipboardAndLocalStorage=9]="AsyncSystemClipboardAndLocalStorage"}(l||(l={})),function(e){e[e.UnsupportedClipboardStrategyType=0]="UnsupportedClipboardStrategyType",e[e.UnsupportedClipboardStorageType=1]="UnsupportedClipboardStorageType",e[e.ClipboardIsInaccessible=2]="ClipboardIsInaccessible",e[e.SetClipboardItems=3]="SetClipboardItems",e[e.GetClipboardItems=5]="GetClipboardItems",e[e.NoGetOperationResultMessage=7]="NoGetOperationResultMessage",e[e.NoSetOperationResultMessage=8]="NoSetOperationResultMessage",e[e.ClearClipboardItems=9]="ClearClipboardItems",e[e.MissingBrowserExtensionCapability=10]="MissingBrowserExtensionCapability",e[e.NoBrowserExtensionsInConfiguration=11]="NoBrowserExtensionsInConfiguration",e[e.NoAvailableBrowserExtensions=12]="NoAvailableBrowserExtensions",e[e.UnavailableBrowserExtension=13]="UnavailableBrowserExtension",e[e.NoBrowserExtensionWithGetClipboardDataCommand=14]="NoBrowserExtensionWithGetClipboardDataCommand",e[e.SelectClipboardStrategy=15]="SelectClipboardStrategy",e[e.IframeInitialization=16]="IframeInitialization",e[e.UnsupportedOperationCode=26]="UnsupportedOperationCode",e[e.RejectingPendingPastePromiseDueToNewPasteOperation=27]="RejectingPendingPastePromiseDueToNewPasteOperation",e[e.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation=28]="RejectingPendingCutCopyPromiseDueToNewCutCopyOperation",e[e.RejectingBlockedSyncCutCopyPromise=29]="RejectingBlockedSyncCutCopyPromise",e[e.IframeInitializationTimeout=30]="IframeInitializationTimeout",e[e.ClipboardStrategyNotInitialized=33]="ClipboardStrategyNotInitialized",e[e.UnexpectedClipboardTextHtmlContentLength=34]="UnexpectedClipboardTextHtmlContentLength",e[e.InvalidClipboardStrategyType=35]="InvalidClipboardStrategyType",e[e.CreateWindowRPCServer=36]="CreateWindowRPCServer",e[e.RefreshMetadata=37]="RefreshMetadata",e[e.DeserializedMetadata=38]="DeserializedMetadata",e[e.SerializedMetadata=39]="SerializedMetadata",e[e.LocalStorageInitilizationInaccessible=40]="LocalStorageInitilizationInaccessible",e[e.LocalStorageInitilizationNoKey=41]="LocalStorageInitilizationNoKey",e[e.IframeProxyGeneralError=42]="IframeProxyGeneralError",e[e.IframeProxyEmptyResultMessage=43]="IframeProxyEmptyResultMessage"}(d||(d={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.CopyFlowHandlerNotFound=1]="CopyFlowHandlerNotFound",e[e.FetchCopyFlowHandlerFailed=2]="FetchCopyFlowHandlerFailed",e[e.FetchSourceItemFailed=3]="FetchSourceItemFailed",e[e.BeforeSerializeFailed=4]="BeforeSerializeFailed",e[e.SerializeFailed=5]="SerializeFailed",e[e.SerializeResultNotValid=6]="SerializeResultNotValid",e[e.AsyncSerializeFailed=7]="AsyncSerializeFailed",e[e.SaveToTheClipboardFailed=8]="SaveToTheClipboardFailed",e[e.InspectClipboardFailed=9]="InspectClipboardFailed",e[e.ClipboardIsInaccessible=10]="ClipboardIsInaccessible",e[e.SuccessiveCutCopyOverridingPendingCutCopy=11]="SuccessiveCutCopyOverridingPendingCutCopy",e[e.BlockedSynchronousCutCopy=12]="BlockedSynchronousCutCopy",e[e.CopyOperationCancelled=13]="CopyOperationCancelled",e[e.UnknownCopyErrorType=14]="UnknownCopyErrorType"}(u||(u={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.PasteFlowHandlerNotFound=1]="PasteFlowHandlerNotFound",e[e.FetchPasteFlowHandlerFailed=2]="FetchPasteFlowHandlerFailed",e[e.FailedToReadFromClipboard=3]="FailedToReadFromClipboard",e[e.InspectClipboardFailed=4]="InspectClipboardFailed",e[e.ReadFromClipboardReturnNullOrUndefined=5]="ReadFromClipboardReturnNullOrUndefined",e[e.ClipboardIsEmpty=6]="ClipboardIsEmpty",e[e.DeserializeOperationFailed=7]="DeserializeOperationFailed",e[e.ClipboardIsInaccessible=8]="ClipboardIsInaccessible",e[e.SuccessivePasteOverridingPendingPaste=9]="SuccessivePasteOverridingPendingPaste",e[e.FileReaderResultIsEmpty=10]="FileReaderResultIsEmpty",e[e.FileReaderFailed=11]="FileReaderFailed",e[e.UnknownPasteError=12]="UnknownPasteError",e[e.DeferredPasteRejectedBecauseOtherCopyCompleted=13]="DeferredPasteRejectedBecauseOtherCopyCompleted",e[e.DeferredPasteRejectedBecauseOtherCopyStarted=14]="DeferredPasteRejectedBecauseOtherCopyStarted",e[e.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext=15]="DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext"}(p||(p={})),function(e){e[e.FailedToClearClipboard=0]="FailedToClearClipboard"}(g||(g={}));var L=function(e){function t(r,a,o){var n=this,c=t.augmentParameterValue(r);if((n=e.call(this,c)||this).name=t.augmentParameterValue(a),n.errorName=n.name,n.name?s().ULS.traceTag(596456211,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Error '".concat(n.name,"': ").concat(c)):s().ULS.traceTag(596456212,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Error message: ".concat(c)),o){n.innerError=o;var l=n.innerError.message;l||(l=n.innerError.name);var d=t.augmentParameterValue(l);d.length>0&&s().ULS.traceTag(596456213,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Inner error message: ".concat(d))}return n.stack||(n.stack=(new Error).stack),n}return Object(f.__extends)(t,e),t.augmentParameterValue=function(e){return e&&"string"==typeof e?e.trim():m},t}(Error),T=function(e){function t(t,r){return e.call(this,t,"NoValidKeyError",r)||this}return Object(f.__extends)(t,e),t}(L),_=function(e){function t(r,a,o){var n=this,i=L.augmentParameterValue(a),s=t.getDefaultMessage(i),c=L.augmentParameterValue(r);return 0===c.length&&(c=s),(n=e.call(this,c,"MissingArgumentError",o)||this).name=i,n}return Object(f.__extends)(t,e),t.getDefaultMessage=function(e){var t="Missing argument";return e.length>0&&(t="Missing argument: '".concat(e,"'")),t},t}(L),I=function(e){function t(r,a,o,n){var i=this,s=L.augmentParameterValue(a),c=o;c||(c=m);var l=t.getDefaultMessage(s,c),d=L.augmentParameterValue(r);return 0===r.length&&(d=l),(i=e.call(this,d,"InvalidArgumentError",n)||this).name=s,i.value=c,i}return Object(f.__extends)(t,e),t.getDefaultMessage=function(e,t){return e.length>0?"Invalid '".concat(e,"' argument: '").concat(t,"'"):"Invalid argument"},t}(L),O=function(e){function t(t,r){return e.call(this,t,"InvalidOperationError",r)||this}return Object(f.__extends)(t,e),t}(L),A=function(e){function t(t,r){return e.call(this,t,"UnsupportedError",r)||this}return Object(f.__extends)(t,e),t}(L),P=function(e){function t(t,r,a,o,n){return e.call(this,"".concat(t,". Data version: ").concat(r,", Infra version: ").concat(a,", blockMismatchDataVersion: ").concat(o),"MismatchVersionError",n)||this}return Object(f.__extends)(t,e),t}(L),j=function(e){function t(t,r,a,o){return e.call(this,"".concat(t,". Duration in clipboard (ms) : ").concat(r,", TTL (ms): ").concat(a),"TTLClipboardDataError",o)||this}return Object(f.__extends)(t,e),t}(L),x=function(e){function t(t,r,a,o){return e.call(this,"".concat(t,". Data User Hash : ").concat(r,", infra User Hash: ").concat(a),"UserHashMismatchError",o)||this}return Object(f.__extends)(t,e),t}(L),D=function(e){function t(t,r){return e.call(this,t,"UnexpectedError",r)||this}return Object(f.__extends)(t,e),t}(L);function M(e,t){return function(e,t){return void 0!==e&&"number"==typeof e&&e>=0&&e<Object.keys(t).length/2}(e,t)?t[e]:m}var W=function(e){function t(t,r,a,o,n){var i=e.call(this,r||"reason=".concat(t),a,o)||this;return i.reason=t,n&&(i.errorName=n),i}return Object(f.__extends)(t,e),t}(L),k=function(e){function t(t,r,a){return e.call(this,t,r,"CopyError",a,M(t,u))||this}return Object(f.__extends)(t,e),t}(W),R=function(e){function t(t,r,a){return e.call(this,t,r,"PasteError",a,M(t,p))||this}return Object(f.__extends)(t,e),t}(W),U=function(e){function t(t,r,a){return e.call(this,t,r,"CancelError",a,M(t,g))||this}return Object(f.__extends)(t,e),t}(W),F=function(e){function t(t,r,a){return e.call(this,t,r,"ClipboardPlatformError",a,M(t,d))||this}return Object(f.__extends)(t,e),t}(W),N=function(e){function t(t,r,a){return e.call(this,t,r,"SharedClipboardError",a,M(t,d))||this}return Object(f.__extends)(t,e),t}(W);function J(e){if(e&&Array.isArray(e)&&0!==e.length){var t=0,r=void 0;if(e.forEach((function(e){if(t+=1,e)try{e()}catch(e){s().ULS.traceTag(596456216,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: callback action #".concat(t," threw an exception: ").concat(e.message)),r||(r=new O(e.message,e))}else s().ULS.traceTag(596456215,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: callback action #".concat(t," is empty"))})),r)throw r}else s().ULS.traceTag(596456214,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: no actions to execute")}function z(){return H}var H={userAgent:function(){return window&&window.navigator?window.navigator.userAgent:m},appVersion:function(){return window&&window.navigator?window.navigator.appVersion:m}},V={};function G(){V={}}var B=new RegExp("(\\bTrident/| MSIE )"),K=new RegExp("\\bEdge/(\\d+\\.\\d+)\\b");function q(){if(void 0===V.isIEProperty){V.isIEProperty=!1;var e=z();if(e&&e.userAgent&&"function"==typeof e.userAgent){var t=e.userAgent();if(t){var r=t.match(B);r&&2===r.length&&(V.isIEProperty=!0)}}}return V.isIEProperty}function X(){if(void 0===V.isEdgeProperty){V.isEdgeProperty=!1,V.isEdgeWithTextHtmlClipboardSupportProperty=!1,V.isEdgeVersionWithTextHtmlWrapperSupportProperty=!1;var e=z();if(e&&e.appVersion&&"function"==typeof e.appVersion){var t=e.appVersion();if(t){var r=t.match(K);if(r&&2===r.length){V.isEdgeProperty=!0;var a=Number(r[1]);isNaN(a)||(a>=16.16299&&(V.isEdgeWithTextHtmlClipboardSupportProperty=!0),a>=17.17123&&(V.isEdgeVersionWithTextHtmlWrapperSupportProperty=!0))}}}}return V.isEdgeProperty}function Y(){return X()&&V.isEdgeWithTextHtmlClipboardSupportProperty}function Q(){return X()&&V.isEdgeVersionWithTextHtmlWrapperSupportProperty}function $(){var e=z(),t=!1;if(e&&e.userAgent){var r=e.userAgent();r&&r.indexOf("Edg/")>=0&&(t=!0)}return t}function Z(){return ee}var ee={postMessage:function(e,t,r,a){e.postMessage(t,r,a)}},te="copy",re="cut",ae="paste",oe="copy",ne="cut",ie="paste",se=function(e,t,r,a){return void 0===a&&(a=!1),e.addEventListener(t,r,a),function(){e.removeEventListener(t,r,a)}},ce="text/plain",le="Text",de="text/html",ue="image/png",pe="data/shadow-workbook",ge="web data/shadow-workbook",fe="metadata/is-last-copy-was-external",me="metadata/is-last-copy-was-external-XLO-source",be="metadata/chrome-extension-id",he="metadata/ccp-infra-version",ye="copyId",Se="metadata/additional-signature-data-attributes";function Ce(){return{items:{}}}var ve,Ee,we,Le,Te=(ve={items:{}},{getData:function(){return ve},getItem:function(e){},setItem:function(e,t){throw new O("Cannot set an item with clipboard data format '".concat(e,"' in an immutable empty clipboard (content is ").concat(t&&t.length>0?"not ":m,"empty)"))},hasDeferredItem:function(e){return!1},getDeferredItem:function(e){},get:function(){return Me(void 0)}});function _e(){return Te}function Ie(e){return e&&e.items?Object.keys(e.items).length:0}function Oe(e){return Ie(e&&e.getData())}function Ae(e){void 0===e&&(e=void 0);var t=e;t||(t={items:{}});var r=function(e){return Pe(t,e)};return{getItem:r,setItem:function(e,r){!function(e,t,r){if(!e)throw new _(m,"clipboardItemsData");if(!e.items)throw new I(m,"clipboardItemsData.items");e.items[t]=r}(t,e,r)},hasDeferredItem:function(e){var t=r(e);return t&&t.length>0},getDeferredItem:function(e){return Promise.resolve(r(e))},getData:function(){return t},get:function(){return Me(t)}}}function Pe(e,t){if(!e)throw new _(m,"clipboardItemsData");if(!e.items)throw new I(m,"clipboardItemsData.items");return e.items[t]}function je(e,t){if(!e||0===e.length||!t||!t.trim())return m;var r=void 0;return e.forEach((function(e){e.clipboardDataFormat===t&&(r=e.data)})),r||m}function xe(e){return je(e,ce)}function De(e){var t=[];return e&&(t=e.get()),0===t.length&&t.push({clipboardDataFormat:ce,data:m}),t}function Me(e){var t=[];if(0===Ie(e))return t;for(var r in e.items){var a=Pe(e,r);a||(a=m);var o={clipboardDataFormat:r,data:a,deferred:!1};t.push(o)}return t}!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.InMemory=2]="InMemory",e[e.LocalStorage=3]="LocalStorage",e[e.AsyncSystemClipboard=4]="AsyncSystemClipboard"}(Ee||(Ee={})),function(e){e[e.None=0]="None",e[e.Cut=1]="Cut",e[e.Copy=2]="Copy",e[e.Paste=4]="Paste",e[e.Values=16]="Values",e[e.Formatting=32]="Formatting",e[e.Formulas=64]="Formulas",e[e.DragDropCells=128]="DragDropCells",e[e.DragDropNoErrMsg=256]="DragDropNoErrMsg",e[e.Transpose=512]="Transpose",e[e.Link=1024]="Link",e[e.PictureInCell=2048]="PictureInCell",e[e.ColumnWidths=4096]="ColumnWidths",e[e.PasteValues=20]="PasteValues",e[e.PasteFormatting=36]="PasteFormatting",e[e.PasteFormulas=68]="PasteFormulas",e[e.PasteTranspose=516]="PasteTranspose",e[e.PasteLink=1028]="PasteLink",e[e.PastePictureInCell=2052]="PastePictureInCell",e[e.PasteWithColumnWidths=4100]="PasteWithColumnWidths"}(we||(we={})),function(e){e[e.NoError=0]="NoError",e[e.LocalStorageInaccessible=1]="LocalStorageInaccessible"}(Le||(Le={}));var We="BulsEndpointUrl",ke="WacCluster",Re="usid",Ue="sharedClipboardSettings",Fe=Be(),Ne=!1,Je=2;function ze(){if(!Ne)throw new O("First initialize the settings via initializeSharedClipboardSettingsFromWindow() or initializeSharedClipboardSettings()");return Fe}function He(){Ne=!1,function(){if(!window||!(Ue in window))return Fe=Be(),void(Ne=!0);var e=window[Ue];if(!e||"object"!=typeof e)return Fe=Be(),void(Ne=!0);Ge(e)}()}function Ve(e){Ne=!1,Ge(e)}function Ge(e){if(!e)throw new _(m,"sharedClipboardSettingsCandidate");var t=Be();if("number"!=typeof e.sharedClipboardSchemaVersion||isNaN(e.sharedClipboardSchemaVersion)||(t.sharedClipboardSchemaVersion=e.sharedClipboardSchemaVersion),"number"!=typeof e.sharedClipboardExpirationInMinutes||isNaN(e.sharedClipboardExpirationInMinutes)||(t.sharedClipboardExpirationInMinutes=e.sharedClipboardExpirationInMinutes),"number"!=typeof e.clipboardPromiseTimeoutInMinutes||isNaN(e.clipboardPromiseTimeoutInMinutes)||(t.clipboardPromiseTimeoutInMinutes=e.clipboardPromiseTimeoutInMinutes),"string"==typeof e.remoteLoggerPath&&e.remoteLoggerPath&&e.remoteLoggerPath.trim()&&(t.remoteLoggerPath=e.remoteLoggerPath),"number"!=typeof e.whitelistOriginComponents||1!==e.whitelistOriginComponents)return Fe=t,void(Ne=!0);if("string"!=typeof e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp.trim())return s().ULS.traceTag(596124181,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApp should be a non empty string"),Fe=t,void(Ne=!0);t.sharedClipboardHostingApp=e.sharedClipboardHostingApp.trim();var r=t.sharedClipboardHostingApp,a=r.indexOf("-");a>=0&&(r=r.substr(a+1));try{t.sharedClipboardHostingApps=e.sharedClipboardHostingApps?JSON.parse(e.sharedClipboardHostingApps):void 0}catch(t){s().ULS.traceTag(579737680,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps JSON parsing failed. String : "+e.sharedClipboardHostingApps)}if(!t.sharedClipboardHostingApps||!Array.isArray(t.sharedClipboardHostingApps)||0===t.sharedClipboardHostingApps.length||t.sharedClipboardHostingApps.some((function(e){return!e||!e.trim()})))return s().ULS.traceTag(596124182,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps should be a JSON string representing an array with at list one app"),t.sharedClipboardHostingApp=m,t.sharedClipboardHostingApps=[],Fe=t,void(Ne=!0);try{t.sharedClipboardHostingEnvironments=e.sharedClipboardHostingEnvironments?JSON.parse(e.sharedClipboardHostingEnvironments):void 0}catch(t){s().ULS.traceTag(579737681,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments JSON parsing failed. String : "+e.sharedClipboardHostingEnvironments)}if(!t.sharedClipboardHostingEnvironments||!Array.isArray(t.sharedClipboardHostingEnvironments)||0===t.sharedClipboardHostingEnvironments.length||t.sharedClipboardHostingEnvironments.some((function(e){return!e||!e.trim()})))return s().ULS.traceTag(596124183,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments should be a JSON string representing an array with at list one environment"),t.sharedClipboardHostingApp=m,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],Fe=t,void(Ne=!0);if(t.sharedClipboardHostingApps.indexOf(t.sharedClipboardHostingApp)<0){if(t.sharedClipboardHostingApp===r)return s().ULS.traceTag(596124184,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '".concat(t.sharedClipboardHostingApp,"' should be listed in sharedClipboardHostingApps")),t.sharedClipboardHostingApp=m,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],Fe=t,void(Ne=!0);if(t.sharedClipboardHostingApps.indexOf(r)<0)return s().ULS.traceTag(596124185,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '".concat(t.sharedClipboardHostingApp,"' or '").concat(r,"' should be listed in sharedClipboardHostingApps")),t.sharedClipboardHostingApp=m,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],Fe=t,void(Ne=!0)}t.whitelistOriginComponents=!0,Fe=t,Ne=!0}function Be(){return{whitelistOriginComponents:!1,sharedClipboardHostingApp:m,sharedClipboardHostingApps:[],sharedClipboardHostingEnvironments:[],sharedClipboardSchemaVersion:1,sharedClipboardExpirationInMinutes:3600,clipboardPromiseTimeoutInMinutes:Je,remoteLoggerPath:m}}function Ke(){var e=m;return window&&window.location&&window.location.origin?(e=window.location.origin)||(e=m):(s().ULS.traceTag(595932950,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"windowLocation.getWindowLocation: is window exist: ".concat(!!window,". is window.location exist: ").concat(window&&!!window.location,". is window.location.origin exist ").concat(window&&window.location&&!!window.location.origin,". is window.location.protocol exist ").concat(window&&window.location&&!!window.location.protocol,". is window.location.hostname exist ").concat(window&&window.location&&!!window.location.hostname,". is window.location.port exist ").concat(window&&window.location&&!!window.location.port)),window&&window.location&&window.location.protocol&&window.location.hostname&&(e=window.location.protocol+"//"+window.location.hostname,window.location.origin=e)),{origin:e}}var qe,Xe,Ye=new RegExp("^\\d+$"),Qe=!1;function $e(e){if(!e)throw new _(m,"origin");var t=e.trim().toLowerCase(),r=m,a=t.split("://",3);if(!a||0===a.length||!a[0]||"http"!==a[0]&&"https"!==a[0])throw new I("Missing protocol","origin",e);if(1===a.length)throw new I("Missing domain","origin",e);if(a.length>2)throw new I("'".concat("://","' should appear once"),"origin",e);var o=a[1];if(!o)throw new I("Missing domain","origin",e);if(r=a[0]+"://",!(a=(o=o.trim()).trim().split("/",3))||0===a.length||!a[0]||!a[0].trim())throw new I("Missing domain","origin",e);if(a.length>2)throw new I("The last part of the origin should be the domain","origin",e);if(2===a.length&&a[1])throw new I("The last part of the origin should be the domain","origin",e);if(!(a=o.split(":",3))||0===a.length||!a[0]||!a[0].trim())throw new I("Missing domain","origin",e);if(a.length>2||2===a.length&&(!a[1]||!a[1].trim()))throw new I("The last part of the origin should be the domain and an optional port number","origin",e);if(r+=o=a[0].trim(),2===a.length){var n=a[1].trim(),c=Ye.exec(n);if(!c||1!==c.length)throw new I("Invalid port number","origin",e);var l=Number(n);if(isNaN(l))throw new I("Invalid port number","origin",e);r+=":"+n}return s().ULS.traceTag(596452423,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"getValidatedOrigin: origin = '".concat(e,"'; validated origin = '").concat(r,"'")),r}function Ze(e){ot();var t=$e(e),r=t.split("://");if(!r||2!==r.length||!r[0]||!r[1])throw new I("Invalid origin","parentOrigin",e);var a=ze(),o=m;if(a.whitelistOriginComponents){var n=r[0]+"://";if(!(r=r[1].split("."))||r.length<2||!r[0])throw new I("Invalid origin","parentOrigin",e);r.splice(0,1,a.sharedClipboardHostingApp),o=n+r.join(".")}else o=t;return s().ULS.traceTag(596452424,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"getSharedClipboardValidatedOrigin: app's origin = '".concat(e,"'; Shared Clipboard iframe origin = '").concat(o,"' components=").concat(JSON.stringify(r))),o}function et(e){ot();var t=$e(e),r=$e(Ke().origin);if(t===r)return t;if(!ze().whitelistOriginComponents)throw new O("validateOriginForReceivedMessage: Caller origin '".concat(e,"' doesn't match the current window's origin '").concat(r,"'"));var a=tt(t),o=tt(r);if(a.protocol!==o.protocol)throw new O("validateRemoteWindowOrigin: Caller origin's protocol '".concat(a.protocol,"' doesn't match the current window origin's protocol '").concat(o.protocol,"'"));if(a.environment!==o.environment)throw new O("validateRemoteWindowOrigin: Caller origin's environment '".concat(a.environment,"' doesn't match the current window origin's environment '").concat(o.environment,"'"));return t}function tt(e){ot();var t=e.split("://",2),r=t[0],a=rt(t[1]),o={protocol:r};if(o.environment=at(e,a,Xe),a.length<=o.environment.length+1)throw new I("Missing app component","origin",e);if("."!==a.charAt(o.environment.length))throw new I("Missing a domain separator after the environment component","origin",e);var n=a.substr(o.environment.length+".".length);if(o.app=at(e,n,qe),o.app.length<n.length&&"-"!==n.charAt(o.app.length))throw new I("When the Office Online app name is not the domain prefix, '".concat("-","' should precede it"),"origin",e);return o}function rt(e){if(!e)throw new _(m,"stringToReverse");for(var t=e.length,r=m,a=t-1;a>=0;a-=1)r+=e.charAt(a);return r}function at(e,t,r){if(!t)throw new _(m,"reversedValidatedHostname");if(!r)throw new _(m,"reversedStringsToLengthMap");var a=t.length,o=Object.keys(r).filter((function(e){var o=r[e];return o<=a&&t.substr(0,o)===e}));if(o&&o.length>0)return rt(o[0]);throw new I("Invalid origin","validatedOrigin",e)}function ot(){if(!Qe){var e=ze();e.whitelistOriginComponents&&(qe=nt(e.sharedClipboardHostingApps),Xe=nt(e.sharedClipboardHostingEnvironments),Qe=!0)}}function nt(e){var t={};return e&&Array.isArray(e)&&0!==e.length?(e.forEach((function(e){t[rt(e)]=e.length})),t):t}var it=1;function st(e,t){return null==e||e===it||null==t||e!==t}function ct(){return ut()}function lt(){return ut()}function dt(e){if(!e)throw new _(m,"id");var t=e.trim().toLowerCase();if(0===t.length)throw new I(m,"id");return t}function ut(){return(Math.random()+1).toString(36).substring(7)}function pt(e,t,r,a,o){var n={id:e,operationCode:t,destination:r,userHash:a,clipboardItemsData:o};return mt(n),n}var gt=function(){function e(){}return e.localStorageData="localStorage/data",e.localStorageMetadata="localStorage/metadata",e.initIframe="initIframe",e}();function ft(e){return"get"===e||"set"===e||"init"===e}var mt=function(e){if(!e)throw new _(m,"clipboardOperationMessage");if(!e.id||0===e.id.trim().length)throw new _(m,"id");if(!e.operationCode)throw new _(m,"operationCode");if(!e.destination)throw new _(m,"destination");if(!ft(e.operationCode))throw new I(m,"operationCode",e.operationCode);if("set"!==e.operationCode&&e.clipboardItemsData)throw new I("'".concat(e.operationCode,"' expects no clipboard items"),"clipboardItemsData")};function bt(e,t,r,a,o){var n={id:e,operationCode:t,failed:r,error:a,clipboardItemsData:o};return ht(n),n}var ht=function(e){if(!e)throw new _(m,"clipboardOperationResultMessage");for(var t=!1,r=0,a=["failed","error","clipboardItemsData","operationCode","id","userHash"];r<a.length;r++){var o=a[r];if(e.hasOwnProperty(o)){t=!0;break}}if(!t)throw new T("clipboardOperationResultMessage has no valid key");if(!e.id||0===e.id.trim().length)throw s().ULS.traceTag(553747865,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Missing argument 'id'. keys: ".concat(JSON.stringify(Object.keys(e)),", isConstructorObject: ").concat(e.constructor===Object,", operationCode: ").concat(e.operationCode,", id: ").concat(e.id,", failed: ").concat(e.failed,", error: ").concat(e.error,".")),new _(m,"id");if(!e.operationCode)throw new _(m,"operationCode");if("getresult"!==e.operationCode&&"setresult"!==e.operationCode&&"initresult"!==e.operationCode&&"unknownresult"!==e.operationCode&&"getMetadata_longPollingresult"!==e.operationCode)throw new I(m,"operationCode",e.operationCode);if(e.failed){if(!e.error)throw new I("A failed '".concat(e.operationCode,"' operation expects a non-empty error argument"),"error");if(e.clipboardItemsData)throw new I("A failed '".concat(e.operationCode,"' operation does not expect a clipboardItemsData argument"),"clipboardItemsData")}else{if(e.error)throw new I("'".concat(e.operationCode,"' expects an empty error argument"),"error");if("unknownresult"===e.operationCode)throw new I("'".concat(e.operationCode,"' can only be used with a failure message"),"operationCode")}if("getresult"===e.operationCode||"getMetadata_longPollingresult"===e.operationCode){if(!e.failed&&!e.clipboardItemsData)throw new I("'".concat(e.operationCode,"' expects a clipboardItems argument"),"clipboardItemsData")}else if(e.clipboardItemsData)throw new I("'".concat(e.operationCode,"' expects no clipboardItemsData argument"),"clipboardItemsData")};function yt(e){if(!e||0===e.trim().length)throw new I(m,"className",e);return function(){var t=!1;function r(t){return"".concat(e,":").concat(t,": already disposed")}return{dispose:function(){t=!0},logIfDisposed:function(e){return t&&s().ULS.traceTag(596456217,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,r(e)),t},throwIfDisposed:function(e){if(t)throw new O(r(e))}}}()}var St=function(){function e(e,t,r){this.clipboardStrategyType=e,this.clipboardCapabilities=t,this.clipboardDataProcessor=r,this.disposableImplementationExtension=yt("".concat(e))}return e.prototype.initialize=function(e){var t=this;return e.then((function(e){return t.clipboardStorage=e,s().ULS.traceTag(596453007,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Clipboard strategy type '".concat(t.clipboardStrategyType,"' was initialized.")),Promise.resolve(t)}),(function(e){return s().ULS.traceTag(596453008,i.LogCategory.msoulscat_ES_EWAJS,E(e)?i.TraceLevel.Info:i.TraceLevel.Error,"Failed to initialize clipboard strategy type '".concat(t.clipboardStrategyType,"'. Error: ").concat(i.utils.getStringifiedError(e))),Promise.reject(e)}))},e.prototype.set=function(e,t){try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.clipboardStorage){return s().ULS.shipAssertTag(596121485,i.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.set: this.clipboardStorage should be defined"),Promise.reject(new F(d.ClipboardStrategyNotInitialized))}return this.clipboardDataProcessor&&this.clipboardDataProcessor.preSetProcess(e),this.clipboardStorage.set(e,t)}catch(e){return Promise.reject(new F(d.SetClipboardItems,"Failed in (clipboard ".concat(this.clipboardStrategyType,").set"),e))}},e.prototype.get=function(e){var t=this;try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.clipboardStorage){return s().ULS.shipAssertTag(596121486,i.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.get: this.clipboardStorage should be defined"),Promise.reject(new F(d.ClipboardStrategyNotInitialized))}return this.clipboardStorage.get(e).then((function(e){return t.clipboardDataProcessor&&t.clipboardDataProcessor.postGetProcess(e),Promise.resolve(e)})).catch((function(t){throw s().ULS.traceTag(507848131,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"ClipboardStrategyBase.get - Failed to get clipboard items. Command id: ".concat(e.id,", Error: ").concat(i.utils.getStringifiedError(t))),t}))}catch(e){return Promise.reject(new F(d.GetClipboardItems,"Failed in (clipboard ".concat(this.clipboardStrategyType,").get"),e))}},e.prototype.onSystemClipboardChangedExternally=function(e){try{return this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),this.clipboardStorage?this.clipboardCapabilities.systemClipboard?Promise.resolve():this.clipboardStorage.set(_e(),e):(s().ULS.shipAssertTag(595882508,i.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.onSystemClipboardChangedExternally: this.clipboardStorage should be defined"),Promise.reject(new F(d.ClipboardStrategyNotInitialized)))}catch(e){return Promise.reject(new F(d.ClearClipboardItems,"Failed in (clipboard ".concat(this.clipboardStrategyType,").onSystemClipboardChangedExternally"),e))}},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.clipboardStorage&&this.clipboardStorage.dispose(),this.disposableImplementationExtension.dispose())},e}(),Ct=!!window.performance&&!!window.performance.now&&!!window.performance.timing;function vt(e){var t=e;return t&&0!==t.trim().length||(t=ct()),new Tt(t)}function Et(){return Ct?window.performance.now():Date.now()}function wt(e){return Ct?new Date(e+window.performance.timing.navigationStart):new Date(e)}function Lt(e,t,r){if(!r)throw new _(m,"creationTimestamp");return"".concat(e?"Fulfilled":"Still unfulfilled"," after ").concat(e?t?t-r:"?":Et()-r,"ms")}var Tt=function(){function e(t){var r=this;this.isFulfilled=!1,this.fulfillmentTimestamp=void 0,this.rejected=!1,this.id=dt(t),e.sequenceId+=1,this.sequenceId=e.sequenceId,this.creationTimestamp=Et(),s().ULS.traceTag(596456225,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: creating deferred promise #".concat(this.sequenceId," with id '").concat(this.id,"' on ").concat(wt(this.creationTimestamp))),this.promise=new Promise((function(e,t){s().ULS.traceTag(596456226,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: registering callback for promise #".concat(r.sequenceId," with id '").concat(r.id,"' on ").concat(wt(Et()))),r.internalResolve=e,r.internalReject=t}))}return e.prototype.fulfilled=function(){return this.isFulfilled},e.prototype.resolve=function(e){this.markAsFulfilled("resolve"),this.internalResolve?this.internalResolve(e):s().ULS.traceTag(596456257,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise - resolve: the resolve for deferred promise #".concat(this.sequenceId," with id '").concat(this.id,"' is not tracked with a callback"))},e.prototype.reject=function(e){this.markAsFulfilled("reject"),this.internalReject?this.internalReject(e):s().ULS.traceTag(596456260,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise - reject: the reject for deferred promise #".concat(this.sequenceId," with id '").concat(this.id,"' is not tracked with a callback"))},e.prototype.markAsFulfilled=function(e){this.fulfillmentCheck(e)||(this.isFulfilled=!0,this.rejected="resolve"!==e,this.fulfillmentTimestamp=Et(),s().ULS.traceTag(596456261,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: marking promise #".concat(this.sequenceId," with id '").concat(this.id,"' as fulfilled (").concat(this.rejected?"rejected":"resolved","). ").concat(Lt(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp))))},e.prototype.fulfillmentCheck=function(e){return s().ULS.traceTag(596456258,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: asked to ".concat(e," deferred promise #").concat(this.sequenceId," with id '").concat(this.id,"'")),this.isFulfilled&&s().ULS.traceTag(596456259,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise: cannot ".concat(e," deferred promise #").concat(this.sequenceId," with id '").concat(this.id,"' since it was ").concat(this.rejected?"rejected":"resolved"," already on ").concat(wt(this.fulfillmentTimestamp),". ").concat(Lt(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp))),this.isFulfilled},e.sequenceId=0,e}();function _t(){return new It}var It=function(){function e(){this.deferredResultMessagePromiseCache={}}return e.prototype.getDeferredPromise=function(e){var t=dt(e);return this.deferredResultMessagePromiseCache[t]},e.prototype.getPromise=function(e){var t=this.getDeferredPromise(e);if(t)return s().ULS.traceTag(596456218,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: found a deferred promise with id '".concat(e,"'.")),t.promise;s().ULS.traceTag(596456219,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: there is no deferred promise with id '".concat(e,"'."))},e.prototype.addNewPromise=function(e){var t=vt(e);if(this.getDeferredPromise(t.id))throw new I("A deferred promise already exists in the cache for the specified id","id",t.id);var r=dt(t.id);return this.deferredResultMessagePromiseCache[r]=t,s().ULS.traceTag(596456220,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: added a new deferred promise with id '".concat(t.id,"'.")),t},e.prototype.getLength=function(){var e=0;for(var t in this.deferredResultMessagePromiseCache)e+=1;return e},e.prototype.delete=function(e){if(this.getDeferredPromise(e)){var t=dt(e);delete this.deferredResultMessagePromiseCache[t],s().ULS.traceTag(596456222,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: deleted id '".concat(e,"'."))}else s().ULS.traceTag(596456221,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: no need to delete an item with id '".concat(e,"' since this id is not associated with an existing deferred promise."))},e.prototype.clear=function(){if(s().ULS.traceTag(596456223,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: clearing ".concat(this.getLength()," items from the cache")),this.deferredResultMessagePromiseCache)for(var e in this.deferredResultMessagePromiseCache){var t=this.deferredResultMessagePromiseCache[e];if(t)try{t.reject()}catch(t){s().ULS.traceTag(596456224,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise cache: clear failed to reject promise id '".concat(e,"' with this exception: ").concat(t.message,". Ignoring."))}}this.deferredResultMessagePromiseCache={}},e}();function Ot(e){if(!e)throw new _(m,"validator");return{deserialize:function(t){return function(e,t){if(!e)throw new _(m,"incomingMessage");if(!t)throw new _(m,"validator");if(0===e.length)throw new I("An empty message is invalid","incomingMessage");var r,a=e.trim();if(0===a.length)throw new I("A message cannot contain only spaces","incomingMessage");try{r=JSON.parse(a)}catch(t){throw new I("Deserialization failed","incomingMessage","Contains ".concat(e.length.toString()," characters"),t)}if(!r)throw new I("Deserialization returned nothing","incomingMessage");return t(r),r}(t,e)}}}function At(e){if(!e)throw new _(m,"validator");return{serialize:function(t){return function(e,t){if(!e)throw new _(m,"outgoingMessage");if(!t)throw new _(m,"validator");return t(e),function(e){var t;try{t=JSON.stringify(e)}catch(t){throw new I("Serialization failed","outgoingMessage","".concat(Object.keys(e).length," properties"),t)}return s().ULS.traceTag(596452375,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"The length of the serialized message is ".concat(t.length)),t}(e)}(t,e)}}}var Pt="initmessageid",jt="unknownmessageid",xt="CreatorOrigin";function Dt(e){if(!e)throw new _(m,"remoteWindow");if(!("window"in e)||!e.window)throw new _(m,"remoteWindow.window");if(!("windowOrigin"in e)||!e.windowOrigin)throw new _(m,"remoteWindow.windowOrigin");var t=et(e.windowOrigin);return{window:e.window,windowOrigin:t}}var Mt=function(){function e(e,t,r,a){this.serializer=e,this.deserializer=t,this.remoteWindow=r,this.remoteWindow=r,this._disposableImplementationExtension=yt(a)}return Object.defineProperty(e.prototype,"disposableImplementationExtension",{get:function(){return this._disposableImplementationExtension},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){var e=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(J([function(){e.sender&&e.sender.dispose()},function(){e.receiver&&e.receiver.dispose()}]),this.disposableImplementationExtension.dispose())},e.prototype.postMessage=function(e){if(this.disposableImplementationExtension.throwIfDisposed("postMessage"),!e)throw new _(m,"outgoingMessage");if(!this.sender){var t="WindowRPCBase::postMessage - this.sender should be defined";throw s().ULS.shipAssertTag(596121484,i.LogCategory.msoulscat_ES_EWAJS,!1,t),new O(t)}this.sender.postMessage(e)},e}();function Wt(){return kt}var kt={addEventListener:function(e,t){return window.addEventListener(e,t)},removeEventListener:function(e,t){return window.removeEventListener(e,t)}};function Rt(e,t,r){return new Ft(e,t,r)}function Ut(e,t,r){return new Ft(e,t,r)}var Ft=function(){function e(e,t,r){var a=this;if(this.deserializer=e,this.handler=t,this.windowMessageHandler=function(e){return a.onMessageReceived(e)},!e)throw new _(m,"deserializer");if(!t)throw new _(m,"handler");if(!r)throw new _(m,"windowRPC");this.disposableImplementationExtension=yt("WindowRPCReceiverInternal"),this.remoteWindow=Dt(r.remoteWindow),Wt().addEventListener("message",this.windowMessageHandler)}return e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(Wt().removeEventListener("message",this.windowMessageHandler),this.disposableImplementationExtension.dispose())},e.prototype.shouldFilterMessageEvent=function(e){try{if(!e.origin||!e.source)return s().ULS.traceTag(596452370,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Window RPC Receiver: ignoring messages from unspecified window sources."),!0;if(e.source===window)return s().ULS.traceTag(596452371,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from this window to itself."),!0;if(this.remoteWindow.window&&e.source!==this.remoteWindow.window)return s().ULS.traceTag(596452372,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from windows other than the assigned remote window."),!0;if(e.origin.toLowerCase()!==this.remoteWindow.windowOrigin)return s().ULS.traceTag(596452373,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from windows with an origin that differs from remote window origin."),!0}catch(e){return!0}return!1},e.prototype.onMessageReceived=function(e){if(!this.shouldFilterMessageEvent(e)){var t=void 0;try{t=this.deserializer.deserialize(e.data)}catch(e){s().ULS.traceTag(596452374,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Window RPC Receiver: unable to deserialize incoming message. ".concat(i.utils.getStringifiedError(e)));try{this.handler.handleDeserializationError(e)}catch(e){s().ULS.traceTag(596452184,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to handle deserialization error. ".concat(i.utils.getStringifiedError(e)))}return}if(t)try{this.handler.handleMessage(t).catch((function(e){s().ULS.traceTag(595985880,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to process incoming message. ".concat(i.utils.getStringifiedError(e)))}))}catch(e){s().ULS.traceTag(596452186,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to process incoming message. ".concat(i.utils.getStringifiedError(e)))}else s().ULS.traceTag(596452185,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: the incoming message is empty")}},e}();function Nt(e,t){return new zt(e,t)}function Jt(e,t){return new zt(e,t)}var zt=function(){function e(e,t,r){if(void 0===r&&(r=!1),this.serializer=e,this.delayedQueueEnabled=r,!e)throw new _(m,"serializer");if(!t)throw new _(m,"windowRPC");this.disposableImplementationExtension=yt("WindowRPCSenderInternal"),this.remoteWindow=Dt(t.remoteWindow)}return e.prototype.postMessage=function(e){if(!e)throw new _(m,"outgoingMessage");if(!this.remoteWindow.window)throw new O("Configure the remote window");if(!this.remoteWindow.window.postMessage)throw new O("The remote window does not support postMessage");var t=this.serializer.serialize(e);Z().postMessage(this.remoteWindow.window,t,this.remoteWindow.windowOrigin)},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},e}(),Ht="_LocalStorageChangedFlag";function Vt(){try{return localStorage.setItem("XLO_CCP","1"),"1"===localStorage.getItem("XLO_CCP")}catch(e){return!1}}function Gt(e){return"OfficeOnlineCCP_Data_"+e}function Bt(e){return"OfficeOnlineCCP_Metadata_"+e}function Kt(e){return Bt(e)+Ht}var qt,Xt=function(){this.copyStatus=qt.Started,this.isTimestampStoredInSystemClipboard=!1,this.isAsyncSerializeFailed=!1,this.succeededPopulatingSystemClipboardSync=void 0,this.succeededPopulatingSystemClipboardAsync=void 0,this.isFullSheetCopy=!1},Yt=function(){function e(){this.startTime=i.perfWatch.timeStamp()}return e.prototype.profilingMessage=function(e){var t=i.perfWatch.timeStamp()-this.startTime;return"onPasteProfiling: ".concat(e,", pasteId: ").concat(this.id,", timeMS: ").concat(t.toFixed())},e}();function Qt(){return{}}function $t(e){var t=void 0;return e&&e.lastCopy&&(t=Object(f.__assign)({},e.lastCopy)),{lastCopy:t}}function Zt(e){try{s().ULS.traceTag(595716237,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Attempting to create clipboard storage type '".concat(Ee.LocalStorage,"'"));var t=new er(e);return Promise.resolve(t)}catch(e){return Promise.reject(e)}}!function(e){e[e.Started=1]="Started",e[e.SynchronousPhaseCompleted=2]="SynchronousPhaseCompleted",e[e.Completed=3]="Completed"}(qt||(qt={}));var er=function(){function e(e){this.localStorageKey=e;try{if(!localStorage)throw new Error("LocalStorageClipboardStorage.ctor: localStorage == null")}catch(e){throw new F(d.LocalStorageInitilizationInaccessible,"LocalStorageClipboardStorage.ctor: failed access to localStorage",e)}if(!e)throw new F(d.LocalStorageInitilizationNoKey,"LocalStorageClipboardStorage.ctor: localStorageKey must be defined");this.clipboardStorageType=Ee.LocalStorage,this.disposableImplementationExtension=yt("LocalStorageClipboardStorage")}return e.prototype.get=function(e){this.disposableImplementationExtension.throwIfDisposed("get"),s().ULS.traceTag(595716238,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"localStorageClipboardStorage.get: commandParameters.id='".concat(e?e.id:m,"'"));var t=localStorage.getItem(this.localStorageKey);if(!t)return Promise.resolve(_e());try{var r=JSON.parse(t);if(!r||0===Ie(r))return Promise.resolve(_e());var a=Ae(r);return Promise.resolve(a)}catch(e){return Promise.resolve(_e())}},e.prototype.set=function(e,t){this.disposableImplementationExtension.throwIfDisposed("set"),s().ULS.traceTag(595716239,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"localStorageClipboardStorage.set: item count=".concat(Oe(e),"'; commandParameters.id='").concat(t?t.id:m,"'")),0===Oe(e)?localStorage.removeItem(this.localStorageKey):localStorage.setItem(this.localStorageKey,JSON.stringify(e.getData()));var r="".concat(this.localStorageKey+Ht),a=ct();return s().ULS.traceTag(595654546,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"localStorageClipboardStorage.set: set local storage value. eventFalgKey = ".concat(r,". eventFlagValue = ").concat(a)),localStorage.setItem(r,a),Promise.resolve()},e.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[ce,de,"data/shadow-workbook"]},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},e}();function tr(e){return s().ULS.traceTag(595716236,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Attempting to create clipboard strategy type '".concat(l.LocalStorage,"' with localStorageKey: '").concat(e,"'")),(new rr).initialize(Zt(e))}var rr=function(e){function t(t){return e.call(this,l.LocalStorage,{browserStorage:!0,systemClipboard:!1,inMemory:!1},t)||this}return Object(f.__extends)(t,e),t}(St),ar=function(){function e(e,t,r){this.localStorageKeyToWatch=e,this.clipboardStrategy=t,this.listener=r,this.maxTimeToWaitInMilliseconds=2e3,this.lastLocalStorageValue=null,window.addEventListener("storage",this.onStorageChanged.bind(this)),this.raiseMetadataChangedEvent()}return e.prototype.onStorageChanged=function(e){var t=this;s().ULS.shipAssertTag(595716249,i.LogCategory.msoulscat_ES_EWAJS,null!=e,"e should not be null"),s().ULS.traceTag(595716288,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.onStorageChanged:got storage change event. e.key = ".concat(e.key,". localStorageKeyToWatch = ").concat(this.localStorageKeyToWatch,". lastLocalStorageValue = ").concat(this.lastLocalStorageValue)),e.key===this.localStorageKeyToWatch&&(this.raiseMetadataChangedEvent(),s().ULS.traceTag(595716289,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.onStorageChanged: raised metadata change event. lastLocalStorageValue = ".concat(this.lastLocalStorageValue)),this.isLocalStorageValueChanged()||this.waitForLocalStorageValueToChange(this.maxTimeToWaitInMilliseconds).then((function(){t.raiseMetadataChangedEvent()}),(function(){s().ULS.traceTag(595716295,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"LocalStorageKeyChangeTracker.onStorageChanged: got rejected promise.")})))},e.prototype.raiseMetadataChangedEvent=function(){var e=this;return s().ULS.traceTag(595715525,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: starting raiseMetadataChangedEvent. lastLocalStorageValue = ".concat(this.lastLocalStorageValue)),this.clipboardStrategy.get({userHash:0}).then((function(t){e.listener(t),s().ULS.traceTag(595716232,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: sent message. lastLocalStorageValue = ".concat(e.lastLocalStorageValue))}),(function(e){s().ULS.traceTag(595716233,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: failed to get metadata from clipboardStorage")}))},e.prototype.isLocalStorageValueChanged=function(){var e=localStorage.getItem(this.localStorageKeyToWatch),t=this.lastLocalStorageValue!==e;return s().ULS.traceTag(595715526,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.isLocalStorageValueChanged: lastLocalStorageValue = ".concat(this.lastLocalStorageValue,". currentLocalStorageValue = ").concat(e)),this.lastLocalStorageValue=e,t},e.prototype.waitForLocalStorageValueToChange=function(e){var t=this;if(s().ULS.traceTag(595715527,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: start waitForLocalStorageValueToChange. lastLocalStorageValue = ".concat(this.lastLocalStorageValue)),this.isLocalStorageValueChanged())return s().ULS.traceTag(595715528,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving because value was changed. lastLocalStorageValue = ".concat(this.lastLocalStorageValue)),Promise.resolve();var r=vt(),a=new Date,o=setInterval((function(){var n=(new Date).getTime()-a.getTime();s().ULS.traceTag(595715529,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: call by setInterval. startTime = ".concat(a,". elapseTime = ").concat(n,". lastLocalStorageValue = ").concat(t.lastLocalStorageValue)),t.isLocalStorageValueChanged()?(clearInterval(o),s().ULS.traceTag(595716234,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving. startTime = ".concat(a,". elapseTime = ").concat(n,". lastLocalStorageValue = ").concat(t.lastLocalStorageValue)),r.resolve()):n>e&&(clearInterval(o),s().ULS.traceTag(595716235,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: rejecting. startTime = ".concat(a,". elapseTime = ").concat(n,". lastLocalStorageValue = ").concat(t.lastLocalStorageValue)),r.reject())}),200);return r.promise},e}(),or="\n",nr=new RegExp("(".concat(or).concat("\r",")|(").concat("\r").concat(or,")|(").concat("\r",")"),"g"),ir=new RegExp("(".concat("\t",")"),"g"),sr=new RegExp("<","g"),cr=new RegExp(">","g"),lr="div",dr="pre",ur="table",pr="tr",gr="td",fr="\x3c!--EndFragment--\x3e",mr="\x3c!--StartFragment--\x3e".length,br=fr.length,hr="Version:0.9".concat(or,"StartHTML:0000000").concat(100).concat(or,"EndHTML:{EndHTML0}").concat(or,"StartFragment:0000000").concat(134).concat(or,"EndFragment:{EndFragm}").concat(or,"<html>").concat(or,"<body>").concat(or).concat("\x3c!--StartFragment--\x3e").concat(or),yr="".concat(fr).concat(or,"</body>").concat(or,"</html>"),Sr="</html>".length,Cr="data-ccp-timestamp",vr=0;function Er(e){return e?e.replace(nr,or):e}function wr(e){return e?e.length<=10240?e:e.substr(0,10240):m}function Lr(e){var t,r=Dr(e),a=function(e){return e?e.replace(nr,"</".concat(gr,"></").concat(pr,"><").concat(pr,"><").concat(gr,">")):e}((t=r)?t.replace(ir,"</".concat(gr,"><").concat(gr,">")):t);return"<".concat(ur,"><").concat(pr,"><").concat(gr,">").concat(a,"</").concat(gr,"></").concat(pr,"></").concat(ur,">")}function Tr(e,t,r){if(r!==vr&&!r)throw new _(m,"timestamp");if(isNaN(r))throw new I(m,"timestamp",r.toString());return Ar(function(e,t,r){return"<".concat(e," ").concat(Cr,"='").concat(r,"'>").concat(t,"</").concat(e,">")}(e,Lr(t),r))}function _r(e){var t=[],r=e.getElementsByTagName("tr");if(r.length>0){var a=Ir(r[0]);t.push(a);for(var o=1;o<r.length;o+=1){t.push("\r"),t.push(or);var n=Ir(r[o]);t.push(n)}}return t.join("")}function Ir(e){var t=[],r=e.getElementsByTagName("td");if(r.length>0){t.push(r[0].innerText);for(var a=1;a<r.length;a+=1)t.push("\t"),t.push(r[a].innerText)}return t.join("")}function Or(e){return!!(e&&e.firstChild&&e.firstElementChild)&&!!e.firstElementChild.getAttribute(Cr)}function Ar(e){if(!X()||Q())return e;var t="0000000000".length,r=hr.length+e.length+yr.length,a=(r-yr.length).toString();if(a.length<t&&(a="0000000000".substr(0,t-a.length)+a),a.length!==t){var o="addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Fragment xml comment is ".concat(a.length," but it should be ").concat(t);throw s().ULS.shipAssertTag(596128536,i.LogCategory.msoulscat_ES_EWAJS,!1,o),new F(d.UnexpectedClipboardTextHtmlContentLength,o)}var n=(r-Sr).toString();if(n.length<t&&(n="0000000000".substr(0,t-n.length)+n),n.length!==t){o="addClipboardWrapperForEdge: the string representation of the opening bracket position of the End Html tag is ".concat(n.length," but it should be ").concat(t);throw s().ULS.shipAssertTag(596128537,i.LogCategory.msoulscat_ES_EWAJS,!1,o),new F(d.UnexpectedClipboardTextHtmlContentLength,o)}var c=hr.replace("{EndHTML0}",n).replace("{EndFragm}",a)+e+yr;return s().ULS.shipAssertTag(596128538,i.LogCategory.msoulscat_ES_EWAJS,c.length===r,"addClipboardWrapperForEdge: The resulting text/html payload length of ".concat(c.length," differs from the expected length of ").concat(r)),c}function Pr(e){if(!e)return m;if(!e.trim())return e;var t=e.indexOf("\x3c!--StartFragment--\x3e"),r=e.indexOf(fr);if(t<0||r<0||t>r)return e;var a=t+mr,o=r-a,n=e.indexOf("\x3c!--StartFragment--\x3e",a),i=e.indexOf(fr,r+br);return n>=0||i>=0?e:e.substr(a,o)}function jr(e){var t=function(e,t){if(!e||!e.trim())return;if(!t||!t.trim())throw new _(m,"attributeName");var r=new RegExp("".concat(t,"=['\"](\\d+)['\"]"),"i").exec(e);if(!r||r.length<2)return;return r[1]}(e,Cr);if(t&&t.trim()){var r=Number(t);if((r||r===vr)&&!isNaN(r))return r}}function xr(e){if(e&&e.trim()){var t=(new DOMParser).parseFromString(e,"text/html"),r=function(e){for(var t=e.getElementsByTagName("meta"),r=0;r<t.length;r+=1){var a=t[r];if("ProgId"===a.getAttribute("name")){var o=a.getAttribute("content");if(null!==o){if(o.length>64)return void s().ULS.shipAssertTag(595683460,i.LogCategory.msoulscat_ES_EWAJS,!1,"ProgID longer than 64 characters");if(o.startsWith("Word"))return"Word Desktop";if(o.startsWith("Excel"))return"Excel Desktop";if(o.startsWith("PowerPoint"))return"PowerPoint Desktop";if(o.startsWith("OneNote"))return"OneNote Desktop";s().ULS.traceTag(595683457,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"htmlClipboardItem.getOfficeDesktopOrigin: unrecognized ProgId content")}return}}return}(t);if(void 0!==r)return r;var a=function(e){if(null===e||null===e.body||null===e.body.children||0===e.body.children.length)return;var t=e.body.children[0];if(null!=t&&null!=t.classList)for(var r=0;r<t.classList.length;r+=1){var a=t.classList[r];if(a.startsWith("SCXO"))return"OneNote Online";if(a.startsWith("SCXP"))return"PowerPoint Online";if(a.startsWith("SCXW"))return"Word Online"}return}(t);return void 0!==a?a:function(e){if(null===e)return!1;var t=e.getElementsByTagName("b");if(0===t.length)return!1;var r=t[0];if(null!=r&&null!=r.id&&null!=r.id.startsWith&&r.id.startsWith("docs-internal-guid-"))return!0;return!1}(t)?"Google Docs":void 0}}function Dr(e){return e?e.replace(sr,"&lt;").replace(cr,"&gt;"):m}function Mr(e,t,r){var a="";return r&&(a=Object.keys(r).reduce((function(e,t){return t?"".concat(e," ").concat(t,"='").concat(r[t],"'"):e}),"")),"<".concat(t).concat(a,">").concat(e,"</").concat(t,">")}},function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return n})),r.d(t,"__rest",(function(){return i})),r.d(t,"__decorate",(function(){return s})),r.d(t,"__param",(function(){return c})),r.d(t,"__esDecorate",(function(){return l})),r.d(t,"__runInitializers",(function(){return d})),r.d(t,"__propKey",(function(){return u})),r.d(t,"__setFunctionName",(function(){return p})),r.d(t,"__metadata",(function(){return g})),r.d(t,"__awaiter",(function(){return f})),r.d(t,"__generator",(function(){return m})),r.d(t,"__createBinding",(function(){return b})),r.d(t,"__exportStar",(function(){return h})),r.d(t,"__values",(function(){return y})),r.d(t,"__read",(function(){return S})),r.d(t,"__spread",(function(){return C})),r.d(t,"__spreadArrays",(function(){return v})),r.d(t,"__spreadArray",(function(){return E})),r.d(t,"__await",(function(){return w})),r.d(t,"__asyncGenerator",(function(){return L})),r.d(t,"__asyncDelegator",(function(){return T})),r.d(t,"__asyncValues",(function(){return _})),r.d(t,"__makeTemplateObject",(function(){return I})),r.d(t,"__importStar",(function(){return A})),r.d(t,"__importDefault",(function(){return P})),r.d(t,"__classPrivateFieldGet",(function(){return j})),r.d(t,"__classPrivateFieldSet",(function(){return x})),r.d(t,"__classPrivateFieldIn",(function(){return D}));var a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var n=function(){return(n=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function i(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(r[a[o]]=e[a[o]])}return r}function s(e,t,r,a){var o,n=arguments.length,i=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,a);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(n<3?o(i):n>3?o(t,r,i):o(t,r))||i);return n>3&&i&&Object.defineProperty(t,r,i),i}function c(e,t){return function(r,a){t(r,a,e)}}function l(e,t,r,a,o,n){function i(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,c=a.kind,l="getter"===c?"get":"setter"===c?"set":"value",d=!t&&e?a.static?e:e.prototype:null,u=t||(d?Object.getOwnPropertyDescriptor(d,a.name):{}),p=!1,g=r.length-1;g>=0;g--){var f={};for(var m in a)f[m]="access"===m?{}:a[m];for(var m in a.access)f.access[m]=a.access[m];f.addInitializer=function(e){if(p)throw new TypeError("Cannot add initializers after decoration has completed");n.push(i(e||null))};var b=(0,r[g])("accessor"===c?{get:u.get,set:u.set}:u[l],f);if("accessor"===c){if(void 0===b)continue;if(null===b||"object"!=typeof b)throw new TypeError("Object expected");(s=i(b.get))&&(u.get=s),(s=i(b.set))&&(u.set=s),(s=i(b.init))&&o.push(s)}else(s=i(b))&&("field"===c?o.push(s):u[l]=s)}d&&Object.defineProperty(d,a.name,u),p=!0}function d(e,t,r){for(var a=arguments.length>2,o=0;o<t.length;o++)r=a?t[o].call(e,r):t[o].call(e);return a?r:void 0}function u(e){return"symbol"==typeof e?e:"".concat(e)}function p(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function g(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,r,a){return new(r||(r=Promise))((function(o,n){function i(e){try{c(a.next(e))}catch(e){n(e)}}function s(e){try{c(a.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,s)}c((a=a.apply(e,t||[])).next())}))}function m(e,t){var r,a,o,n,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;n&&(n=0,s[0]&&(i=0)),i;)try{if(r=1,a&&(o=2&s[0]?a.return:s[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,s[1])).done)return o;switch(a=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,a=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],a=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}var b=Object.create?function(e,t,r,a){void 0===a&&(a=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,a,o)}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]};function h(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||b(t,e,r)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],a=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function S(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var a,o,n=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(a=n.next()).done;)i.push(a.value)}catch(e){o={error:e}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return i}function C(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(S(arguments[t]));return e}function v(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var a=Array(e),o=0;for(t=0;t<r;t++)for(var n=arguments[t],i=0,s=n.length;i<s;i++,o++)a[o]=n[i];return a}function E(e,t,r){if(r||2===arguments.length)for(var a,o=0,n=t.length;o<n;o++)!a&&o in t||(a||(a=Array.prototype.slice.call(t,0,o)),a[o]=t[o]);return e.concat(a||Array.prototype.slice.call(t))}function w(e){return this instanceof w?(this.v=e,this):new w(e)}function L(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a,o=r.apply(e,t||[]),n=[];return a={},i("next"),i("throw"),i("return"),a[Symbol.asyncIterator]=function(){return this},a;function i(e){o[e]&&(a[e]=function(t){return new Promise((function(r,a){n.push([e,t,r,a])>1||s(e,t)}))})}function s(e,t){try{(r=o[e](t)).value instanceof w?Promise.resolve(r.value.v).then(c,l):d(n[0][2],r)}catch(e){d(n[0][3],e)}var r}function c(e){s("next",e)}function l(e){s("throw",e)}function d(e,t){e(t),n.shift(),n.length&&s(n[0][0],n[0][1])}}function T(e){var t,r;return t={},a("next"),a("throw",(function(e){throw e})),a("return"),t[Symbol.iterator]=function(){return this},t;function a(a,o){t[a]=e[a]?function(t){return(r=!r)?{value:w(e[a](t)),done:!1}:o?o(t):t}:o}}function _(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},a("next"),a("throw"),a("return"),t[Symbol.asyncIterator]=function(){return this},t);function a(r){t[r]=e[r]&&function(t){return new Promise((function(a,o){(function(e,t,r,a){Promise.resolve(a).then((function(t){e({value:t,done:r})}),t)})(a,o,(t=e[r](t)).done,t.value)}))}}}function I(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var O=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function A(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&b(t,e,r);return O(t,e),t}function P(e){return e&&e.__esModule?e:{default:e}}function j(e,t,r,a){if("a"===r&&!a)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?a:"a"===r?a.call(e):a?a.value:t.get(e)}function x(e,t,r,a,o){if("m"===a)throw new TypeError("Private method is not writable");if("a"===a&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===a?o.call(e,r):o?o.value=r:t.set(e,r),r}function D(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},,function(e,t,r){"use strict";var a,o;Object.defineProperty(t,"__esModule",{value:!0}),t.NulLogger=t.ConsoleLogger=t.ULS=t.LogCategory=t.TraceLevel=void 0,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(a||(t.TraceLevel=a={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(o||(t.LogCategory=o={})),t.ULS={getFromExternalLogger:function(e){var t=e;return{ULS:{trace:function(e,r,a){return t.traceTag(0,e,r,a)},traceTag:function(e,r,a,o){return t.traceTag(e,r,a,o)},debugTrace:function(e,r,a){return t.debugTraceTag(0,e,r,a)},debugTraceTag:function(e,r,a,o){return t.debugTraceTag(e,r,a,o)},assert:function(e,r,a){return t.assertTag(0,e,r,a)},assertTag:function(e,r,a,o){return t.assertTag(e,r,a,o)},shipAssert:function(e,r,a){return t.shipAssertTag(0,e,r,a)},shipAssertTag:function(e,r,a,o){return t.shipAssertTag(e,r,a,o)},dnmTrace:function(e,r,a){return t.dnmTraceTag(0,e,r,a)},dnmTraceTag:function(e,r,a,o){return t.dnmTraceTag(e,r,a,o)}}}}};var n=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,a){console.assert(r,"shipAssertTag:",e,t,a)},e.prototype.assertTag=function(e,t,r,a){console.assert(r,"assertTag",e,t,a)},e.prototype.traceTag=function(e,t,r,a){console.log("traceTag",e,a,t,r)},e.prototype.dnmTraceTag=function(e,t,r,a){console.log("dnmTraceTag",e,a,t,r)},e.prototype.debugTraceTag=function(e,t,r,a){console.log("debugTraceTag",e,a,t,r)},e}();t.ConsoleLogger=n;var i=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e.prototype.dnmTraceTag=function(){},e}();t.NulLogger=i},,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calcHashCode=t.decodeHtml=t.getQueryParameterByName=t.chainFallbackPromises=t.retry=t.getPerfWatchMarkName=t.getStringifiedError=t.defaultToJSONResultWhenStringifyFails=t.forEachPromise=void 0,t.forEachPromise=function(e,t,r){return e.reduce((function(e,a){return e.then((function(){return r&&r.stop?Promise.resolve(void 0):t(a,r)}))}),Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(t,r){void 0===r&&(r=0);if(r<0||r>5)return t;if(null==t||"object"!=typeof t)return t;var a={};Object.getOwnPropertyNames(t).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(a[e]=t[e])}));var o=Object.getPrototypeOf(t);o&&"object"==typeof o&&Object.keys(o).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(a[e]=t[e])}));var n={};return Object.keys(a).forEach((function(t){n[t]=e(a[t],r+1)})),n}(e))}catch(e){return t.defaultToJSONResultWhenStringifyFails}};var a=new RegExp("".concat("\\W","+"),"g");t.getPerfWatchMarkName=function(e){if(!e)return"";var t=e.trim().substring(0,200).trim().replace(a,"_").substring(0,80);return t&&t.length>0&&"_"===t.substr(t.length-1,1)&&(t=t.substr(0,t.length-1)),t&&t.length>0&&"_"===t.substr(0,1)&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got ".concat(t)));for(var r=Promise.reject(),a=function(t){r=r.catch((function(r){return e(t,r)}))},o=1;o<=t;o+=1)a(o);return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();for(var r=t(e[0]),a=function(a){var o=e[a];r=r.catch((function(){return t(o)}))},o=1;o<e.length;o+=1)a(o);return r},t.getQueryParameterByName=function(e,t){var r=new RegExp("[?&]".concat(t,"(=([^&#]*)|&|#|$)")).exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;for(var t=5381,r=t,a=e.length,o=0;o<a&&(t=4294967295&((t<<5)+t^e.charCodeAt(o)),o!==a-1);o+=2)r=4294967295&((r<<5)+r^e.charCodeAt(o+1));var n=t+35685*r+(23896*r<<16)&4294967295;return n<0&&(n+=4294967296),n}},,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promises=void 0;var a={};t.promises=function(){return void 0===a.promises&&(a.promises="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&"function"==typeof Promise.resolve(0).then),a.promises}},function(e,t,r){"use strict";function a(){var e="undefined"!=typeof self?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}function o(e,t,r){e[t]=a()-r}Object.defineProperty(t,"__esModule",{value:!0}),t.timeStamp=t.failure=t.success=t.end=t.mark=t.start=void 0,t.start=function(e){var t=a(),r=e,n=t,i={},s=function(e,t,a){return function(e,t,r,a,n,i){o(e,"end",r);var s={sessionName:t,result:a?"success":"failure",message:i,marks:e},c=JSON.stringify(s);n(c)}(i,r,n,e,t,a)};return i.start=0,{mark:function(e){return function(e){return o(i,e,n)}(e)},end:function(e){return s(!0,e)},success:function(e,t){return s(!0,e,t)},failure:function(e,t){return s(!1,e,t)}}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(2);a.__exportStar(r(17),t),a.__exportStar(r(30),t),a.__exportStar(r(18),t),a.__exportStar(r(31),t),a.__exportStar(r(32),t),a.__exportStar(r(33),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatchFactory=void 0;var a=function(){return Date.now()};t.initStopwatchFactory=function(e,t){return void 0===t&&(t=1),"undefined"!=typeof self&&self.performance&&self.performance.now&&(a=function(){return self.performance.now()}),function(r){var o=a(),n=r;return{reset:function(e){null!=e&&(n=e),o=a()},stop:function(r){var i=a()-o,s=JSON.stringify({Target:n,Duration:i.toFixed(t),StopInfo:r});e(s)}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=void 0;var a=function(){function e(){this.counters={},this.timers={},this.events={}}return e.prototype.getJsonForLogging=function(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"},e.prototype.addEvent=function(e,t){null!=e&&null!=t&&(this.events[e]=t)},e.prototype.clearEvents=function(){this.events={}},e.prototype.getEventsLoggableString=function(){return JSON.stringify(this.events)},e.prototype.incrementCounter=function(e){null!=e&&(this.counters.hasOwnProperty(e)?this.counters[e]+=1:this.counters[e]=1)},e.prototype.getCountersLoggableString=function(){return JSON.stringify(this.counters)},e.prototype.clearCounters=function(){this.counters={}},e.prototype.startTimer=function(e){null!=e&&(this.timers[e]={name:e,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})},e.prototype.endTimer=function(e){null!=e&&this.timers.hasOwnProperty(e)&&(this.timers[e].endTime=Date.now(),this.timers[e].isRunning=!1,this.timers[e].duration=this.timers[e].endTime-this.timers[e].startTime)},e.prototype.getTimerDuration=function(e){return null==e?"-1":this.timers.hasOwnProperty(e)&&void 0!==this.timers[e].duration?this.timers[e].duration:"-1"},e.prototype.getTimersLoggableString=function(){return JSON.stringify(this.timers)},e}();t.TelemetryCollector=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=void 0,t.getNewGuid=function(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},r="undefined"!=typeof self?self:window,a=r.crypto||r.msCrypto;if(a){t.crypto=!0;try{return a.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: ".concat(JSON.stringify(e)))}}var o=!1,n=r.performance;try{n&&n.now&&n.now()!==1/0&&(o=!0)}catch(e){t.exceptions.push("perfNow: ".concat(JSON.stringify(e)))}for(var i=0;i<e.length;i+=1){try{if(o){t.perfNow=!0;var s=Math.floor(100*n.now())%10;(s<0||s>9)&&(s=0);for(var c=0;c<s;c+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: ".concat(JSON.stringify(e)))}e[i]=Math.floor(16*Math.random())}return t}(e),r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var a=15&e[r];return r+=1,("x"===t?a:3&a|8).toString(16)})),t]}},function(e,t,r){"use strict";var a,o;Object.defineProperty(t,"__esModule",{value:!0}),t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=void 0,function(e){e.Auto="auto",e.Manual="manual"}(a||(t.TextAreaVirtualKeyboardPolicy=a={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(o||(t.TextAreaInputMode=o={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isReplaceChildrenSupported=t.replaceChildren=void 0;t.replaceChildren=function(e){if(e)if((0,t.isReplaceChildrenSupported)(e))e.replaceChildren();else for(;e.lastChild;)e.removeChild(e.lastChild)};t.isReplaceChildrenSupported=function(e){return!!e.replaceChildren}},function(e,t,r){
/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */
e.exports=function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,r){return(t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,r)}function r(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function a(e,o,n){return(a=r()?Reflect.construct:function(e,r,a){var o=[null];o.push.apply(o,r);var n=new(Function.bind.apply(e,o));return a&&t(n,a.prototype),n}).apply(null,arguments)}function o(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var i=Object.hasOwnProperty,s=Object.setPrototypeOf,c=Object.isFrozen,l=Object.getPrototypeOf,d=Object.getOwnPropertyDescriptor,u=Object.freeze,p=Object.seal,g=Object.create,f="undefined"!=typeof Reflect&&Reflect,m=f.apply,b=f.construct;m||(m=function(e,t,r){return e.apply(t,r)}),u||(u=function(e){return e}),p||(p=function(e){return e}),b||(b=function(e,t){return a(e,o(t))});var h,y=A(Array.prototype.forEach),S=A(Array.prototype.pop),C=A(Array.prototype.push),v=A(String.prototype.toLowerCase),E=A(String.prototype.toString),w=A(String.prototype.match),L=A(String.prototype.replace),T=A(String.prototype.indexOf),_=A(String.prototype.trim),I=A(RegExp.prototype.test),O=(h=TypeError,function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return b(h,t)});function A(e){return function(t){for(var r=arguments.length,a=new Array(r>1?r-1:0),o=1;o<r;o++)a[o-1]=arguments[o];return m(e,t,a)}}function P(e,t,r){var a;r=null!==(a=r)&&void 0!==a?a:v,s&&s(e,null);for(var o=t.length;o--;){var n=t[o];if("string"==typeof n){var i=r(n);i!==n&&(c(t)||(t[o]=i),n=i)}e[n]=!0}return e}function j(e){var t,r=g(null);for(t in e)!0===m(i,e,[t])&&(r[t]=e[t]);return r}function x(e,t){for(;null!==e;){var r=d(e,t);if(r){if(r.get)return A(r.get);if("function"==typeof r.value)return A(r.value)}e=l(e)}return function(e){return console.warn("fallback value for",e),null}}var D=u(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),M=u(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),W=u(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),k=u(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),R=u(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),U=u(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),F=u(["#text"]),N=u(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),J=u(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),z=u(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),H=u(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),V=p(/\{\{[\w\W]*|[\w\W]*\}\}/gm),G=p(/<%[\w\W]*|[\w\W]*%>/gm),B=p(/\${[\w\W]*}/gm),K=p(/^data-[\-\w.\u00B7-\uFFFF]/),q=p(/^aria-[\-\w]+$/),X=p(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Y=p(/^(?:\w+script|data):/i),Q=p(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),$=p(/^html$/i),Z=function(){return"undefined"==typeof window?null:window},ee=function(t,r){if("object"!==e(t)||"function"!=typeof t.createPolicy)return null;var a=null;r.currentScript&&r.currentScript.hasAttribute("data-tt-policy-suffix")&&(a=r.currentScript.getAttribute("data-tt-policy-suffix"));var o="dompurify"+(a?"#"+a:"");try{return t.createPolicy(o,{createHTML:function(e){return e},createScriptURL:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+o+" could not be created."),null}};return function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z(),a=function(e){return t(e)};if(a.version="2.4.7",a.removed=[],!r||!r.document||9!==r.document.nodeType)return a.isSupported=!1,a;var n=r.document,i=r.document,s=r.DocumentFragment,c=r.HTMLTemplateElement,l=r.Node,d=r.Element,p=r.NodeFilter,g=r.NamedNodeMap,f=void 0===g?r.NamedNodeMap||r.MozNamedAttrMap:g,m=r.HTMLFormElement,b=r.DOMParser,h=r.trustedTypes,A=d.prototype,te=x(A,"cloneNode"),re=x(A,"nextSibling"),ae=x(A,"childNodes"),oe=x(A,"parentNode");if("function"==typeof c){var ne=i.createElement("template");ne.content&&ne.content.ownerDocument&&(i=ne.content.ownerDocument)}var ie=ee(h,n),se=ie?ie.createHTML(""):"",ce=i,le=ce.implementation,de=ce.createNodeIterator,ue=ce.createDocumentFragment,pe=ce.getElementsByTagName,ge=n.importNode,fe={};try{fe=j(i).documentMode?i.documentMode:{}}catch(e){}var me={};a.isSupported="function"==typeof oe&&le&&void 0!==le.createHTMLDocument&&9!==fe;var be,he,ye=V,Se=G,Ce=B,ve=K,Ee=q,we=Y,Le=Q,Te=X,_e=null,Ie=P({},[].concat(o(D),o(M),o(W),o(R),o(F))),Oe=null,Ae=P({},[].concat(o(N),o(J),o(z),o(H))),Pe=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),je=null,xe=null,De=!0,Me=!0,We=!1,ke=!0,Re=!1,Ue=!1,Fe=!1,Ne=!1,Je=!1,ze=!1,He=!1,Ve=!0,Ge=!1,Be="user-content-",Ke=!0,qe=!1,Xe={},Ye=null,Qe=P({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),$e=null,Ze=P({},["audio","video","img","source","image","track"]),et=null,tt=P({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),rt="http://www.w3.org/1998/Math/MathML",at="http://www.w3.org/2000/svg",ot="http://www.w3.org/1999/xhtml",nt=ot,it=!1,st=null,ct=P({},[rt,at,ot],E),lt=["application/xhtml+xml","text/html"],dt="text/html",ut=null,pt=i.createElement("form"),gt=function(e){return e instanceof RegExp||e instanceof Function},ft=function(t){ut&&ut===t||(t&&"object"===e(t)||(t={}),t=j(t),be=be=-1===lt.indexOf(t.PARSER_MEDIA_TYPE)?dt:t.PARSER_MEDIA_TYPE,he="application/xhtml+xml"===be?E:v,_e="ALLOWED_TAGS"in t?P({},t.ALLOWED_TAGS,he):Ie,Oe="ALLOWED_ATTR"in t?P({},t.ALLOWED_ATTR,he):Ae,st="ALLOWED_NAMESPACES"in t?P({},t.ALLOWED_NAMESPACES,E):ct,et="ADD_URI_SAFE_ATTR"in t?P(j(tt),t.ADD_URI_SAFE_ATTR,he):tt,$e="ADD_DATA_URI_TAGS"in t?P(j(Ze),t.ADD_DATA_URI_TAGS,he):Ze,Ye="FORBID_CONTENTS"in t?P({},t.FORBID_CONTENTS,he):Qe,je="FORBID_TAGS"in t?P({},t.FORBID_TAGS,he):{},xe="FORBID_ATTR"in t?P({},t.FORBID_ATTR,he):{},Xe="USE_PROFILES"in t&&t.USE_PROFILES,De=!1!==t.ALLOW_ARIA_ATTR,Me=!1!==t.ALLOW_DATA_ATTR,We=t.ALLOW_UNKNOWN_PROTOCOLS||!1,ke=!1!==t.ALLOW_SELF_CLOSE_IN_ATTR,Re=t.SAFE_FOR_TEMPLATES||!1,Ue=t.WHOLE_DOCUMENT||!1,Je=t.RETURN_DOM||!1,ze=t.RETURN_DOM_FRAGMENT||!1,He=t.RETURN_TRUSTED_TYPE||!1,Ne=t.FORCE_BODY||!1,Ve=!1!==t.SANITIZE_DOM,Ge=t.SANITIZE_NAMED_PROPS||!1,Ke=!1!==t.KEEP_CONTENT,qe=t.IN_PLACE||!1,Te=t.ALLOWED_URI_REGEXP||Te,nt=t.NAMESPACE||ot,Pe=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&gt(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Pe.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&gt(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Pe.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Pe.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Re&&(Me=!1),ze&&(Je=!0),Xe&&(_e=P({},o(F)),Oe=[],!0===Xe.html&&(P(_e,D),P(Oe,N)),!0===Xe.svg&&(P(_e,M),P(Oe,J),P(Oe,H)),!0===Xe.svgFilters&&(P(_e,W),P(Oe,J),P(Oe,H)),!0===Xe.mathMl&&(P(_e,R),P(Oe,z),P(Oe,H))),t.ADD_TAGS&&(_e===Ie&&(_e=j(_e)),P(_e,t.ADD_TAGS,he)),t.ADD_ATTR&&(Oe===Ae&&(Oe=j(Oe)),P(Oe,t.ADD_ATTR,he)),t.ADD_URI_SAFE_ATTR&&P(et,t.ADD_URI_SAFE_ATTR,he),t.FORBID_CONTENTS&&(Ye===Qe&&(Ye=j(Ye)),P(Ye,t.FORBID_CONTENTS,he)),Ke&&(_e["#text"]=!0),Ue&&P(_e,["html","head","body"]),_e.table&&(P(_e,["tbody"]),delete je.tbody),u&&u(t),ut=t)},mt=P({},["mi","mo","mn","ms","mtext"]),bt=P({},["foreignobject","desc","title","annotation-xml"]),ht=P({},["title","style","font","a","script"]),yt=P({},M);P(yt,W),P(yt,k);var St=P({},R);P(St,U);var Ct=function(e){var t=oe(e);t&&t.tagName||(t={namespaceURI:nt,tagName:"template"});var r=v(e.tagName),a=v(t.tagName);return!!st[e.namespaceURI]&&(e.namespaceURI===at?t.namespaceURI===ot?"svg"===r:t.namespaceURI===rt?"svg"===r&&("annotation-xml"===a||mt[a]):Boolean(yt[r]):e.namespaceURI===rt?t.namespaceURI===ot?"math"===r:t.namespaceURI===at?"math"===r&&bt[a]:Boolean(St[r]):e.namespaceURI===ot?!(t.namespaceURI===at&&!bt[a])&&!(t.namespaceURI===rt&&!mt[a])&&!St[r]&&(ht[r]||!yt[r]):!("application/xhtml+xml"!==be||!st[e.namespaceURI]))},vt=function(e){C(a.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=se}catch(t){e.remove()}}},Et=function(e,t){try{C(a.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){C(a.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!Oe[e])if(Je||ze)try{vt(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},wt=function(e){var t,r;if(Ne)e="<remove></remove>"+e;else{var a=w(e,/^[\r\n\t ]+/);r=a&&a[0]}"application/xhtml+xml"===be&&nt===ot&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var o=ie?ie.createHTML(e):e;if(nt===ot)try{t=(new b).parseFromString(o,be)}catch(e){}if(!t||!t.documentElement){t=le.createDocument(nt,"template",null);try{t.documentElement.innerHTML=it?se:o}catch(e){}}var n=t.body||t.documentElement;return e&&r&&n.insertBefore(i.createTextNode(r),n.childNodes[0]||null),nt===ot?pe.call(t,Ue?"html":"body")[0]:Ue?t.documentElement:n},Lt=function(e){return de.call(e.ownerDocument||e,e,p.SHOW_ELEMENT|p.SHOW_COMMENT|p.SHOW_TEXT,null,!1)},Tt=function(e){return e instanceof m&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof f)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},_t=function(t){return"object"===e(l)?t instanceof l:t&&"object"===e(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},It=function(e,t,r){me[e]&&y(me[e],(function(e){e.call(a,t,r,ut)}))},Ot=function(e){var t;if(It("beforeSanitizeElements",e,null),Tt(e))return vt(e),!0;if(I(/[\u0080-\uFFFF]/,e.nodeName))return vt(e),!0;var r=he(e.nodeName);if(It("uponSanitizeElement",e,{tagName:r,allowedTags:_e}),e.hasChildNodes()&&!_t(e.firstElementChild)&&(!_t(e.content)||!_t(e.content.firstElementChild))&&I(/<[/\w]/g,e.innerHTML)&&I(/<[/\w]/g,e.textContent))return vt(e),!0;if("select"===r&&I(/<template/i,e.innerHTML))return vt(e),!0;if(!_e[r]||je[r]){if(!je[r]&&Pt(r)){if(Pe.tagNameCheck instanceof RegExp&&I(Pe.tagNameCheck,r))return!1;if(Pe.tagNameCheck instanceof Function&&Pe.tagNameCheck(r))return!1}if(Ke&&!Ye[r]){var o=oe(e)||e.parentNode,n=ae(e)||e.childNodes;if(n&&o)for(var i=n.length-1;i>=0;--i)o.insertBefore(te(n[i],!0),re(e))}return vt(e),!0}return e instanceof d&&!Ct(e)?(vt(e),!0):"noscript"!==r&&"noembed"!==r&&"noframes"!==r||!I(/<\/no(script|embed|frames)/i,e.innerHTML)?(Re&&3===e.nodeType&&(t=e.textContent,t=L(t,ye," "),t=L(t,Se," "),t=L(t,Ce," "),e.textContent!==t&&(C(a.removed,{element:e.cloneNode()}),e.textContent=t)),It("afterSanitizeElements",e,null),!1):(vt(e),!0)},At=function(e,t,r){if(Ve&&("id"===t||"name"===t)&&(r in i||r in pt))return!1;if(Me&&!xe[t]&&I(ve,t));else if(De&&I(Ee,t));else if(!Oe[t]||xe[t]){if(!(Pt(e)&&(Pe.tagNameCheck instanceof RegExp&&I(Pe.tagNameCheck,e)||Pe.tagNameCheck instanceof Function&&Pe.tagNameCheck(e))&&(Pe.attributeNameCheck instanceof RegExp&&I(Pe.attributeNameCheck,t)||Pe.attributeNameCheck instanceof Function&&Pe.attributeNameCheck(t))||"is"===t&&Pe.allowCustomizedBuiltInElements&&(Pe.tagNameCheck instanceof RegExp&&I(Pe.tagNameCheck,r)||Pe.tagNameCheck instanceof Function&&Pe.tagNameCheck(r))))return!1}else if(et[t]);else if(I(Te,L(r,Le,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==T(r,"data:")||!$e[e])if(We&&!I(we,L(r,Le,"")));else if(r)return!1;return!0},Pt=function(e){return e.indexOf("-")>0},jt=function(t){var r,o,n,i;It("beforeSanitizeAttributes",t,null);var s=t.attributes;if(s){var c={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Oe};for(i=s.length;i--;){var l=r=s[i],d=l.name,u=l.namespaceURI;if(o="value"===d?r.value:_(r.value),n=he(d),c.attrName=n,c.attrValue=o,c.keepAttr=!0,c.forceKeepAttr=void 0,It("uponSanitizeAttribute",t,c),o=c.attrValue,!c.forceKeepAttr&&(Et(d,t),c.keepAttr))if(ke||!I(/\/>/i,o)){Re&&(o=L(o,ye," "),o=L(o,Se," "),o=L(o,Ce," "));var p=he(t.nodeName);if(At(p,n,o)){if(!Ge||"id"!==n&&"name"!==n||(Et(d,t),o=Be+o),ie&&"object"===e(h)&&"function"==typeof h.getAttributeType)if(u);else switch(h.getAttributeType(p,n)){case"TrustedHTML":o=ie.createHTML(o);break;case"TrustedScriptURL":o=ie.createScriptURL(o)}try{u?t.setAttributeNS(u,d,o):t.setAttribute(d,o),S(a.removed)}catch(e){}}}else Et(d,t)}It("afterSanitizeAttributes",t,null)}},xt=function e(t){var r,a=Lt(t);for(It("beforeSanitizeShadowDOM",t,null);r=a.nextNode();)It("uponSanitizeShadowNode",r,null),Ot(r)||(r.content instanceof s&&e(r.content),jt(r));It("afterSanitizeShadowDOM",t,null)};return a.sanitize=function(t){var o,i,c,d,u,p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((it=!t)&&(t="\x3c!--\x3e"),"string"!=typeof t&&!_t(t)){if("function"!=typeof t.toString)throw O("toString is not a function");if("string"!=typeof(t=t.toString()))throw O("dirty is not a string, aborting")}if(!a.isSupported){if("object"===e(r.toStaticHTML)||"function"==typeof r.toStaticHTML){if("string"==typeof t)return r.toStaticHTML(t);if(_t(t))return r.toStaticHTML(t.outerHTML)}return t}if(Fe||ft(p),a.removed=[],"string"==typeof t&&(qe=!1),qe){if(t.nodeName){var g=he(t.nodeName);if(!_e[g]||je[g])throw O("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof l)1===(i=(o=wt("\x3c!----\x3e")).ownerDocument.importNode(t,!0)).nodeType&&"BODY"===i.nodeName||"HTML"===i.nodeName?o=i:o.appendChild(i);else{if(!Je&&!Re&&!Ue&&-1===t.indexOf("<"))return ie&&He?ie.createHTML(t):t;if(!(o=wt(t)))return Je?null:He?se:""}o&&Ne&&vt(o.firstChild);for(var f=Lt(qe?t:o);c=f.nextNode();)3===c.nodeType&&c===d||Ot(c)||(c.content instanceof s&&xt(c.content),jt(c),d=c);if(d=null,qe)return t;if(Je){if(ze)for(u=ue.call(o.ownerDocument);o.firstChild;)u.appendChild(o.firstChild);else u=o;return(Oe.shadowroot||Oe.shadowrootmod)&&(u=ge.call(n,u,!0)),u}var m=Ue?o.outerHTML:o.innerHTML;return Ue&&_e["!doctype"]&&o.ownerDocument&&o.ownerDocument.doctype&&o.ownerDocument.doctype.name&&I($,o.ownerDocument.doctype.name)&&(m="<!DOCTYPE "+o.ownerDocument.doctype.name+">\n"+m),Re&&(m=L(m,ye," "),m=L(m,Se," "),m=L(m,Ce," ")),ie&&He?ie.createHTML(m):m},a.setConfig=function(e){ft(e),Fe=!0},a.clearConfig=function(){ut=null,Fe=!1},a.isValidAttribute=function(e,t,r){ut||ft({});var a=he(e),o=he(t);return At(a,o,r)},a.addHook=function(e,t){"function"==typeof t&&(me[e]=me[e]||[],C(me[e],t))},a.removeHook=function(e){if(me[e])return S(me[e])},a.removeHooks=function(e){me[e]&&(me[e]=[])},a.removeAllHooks=function(){me={}},a}()}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var a=r(19),o={};function n(){return void 0===a.globalThis.__get_feature_gate_dictionary_variable?o:a.globalThis.__get_feature_gate_dictionary_variable()}function i(e,t){var r;return null!==(r=n()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=n,t.getStringFeatureGate=i,t.getBooleanFeatureGate=function(e,t){var r,a=null===(r=i(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===a||"false"!==a&&t},t.getNumberFeatureGate=function(e,t){var r,a=null===(r=i(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===a)return t;if("infinity"===a||"+infinity"===a)return 1/0;if("-infinity"===a)return-1/0;var o=parseFloat(a);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){var r,a=null===(r=i(e))||void 0===r?void 0:r.trim();if(void 0===a)return t;var o=parseInt(a,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){var t=a.globalThis.__get_feature_gate_dictionary_variable;return a.globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var a=r(19);function o(){return void 0===a.globalThis.__get_change_gate_dictionary_variable?{}:a.globalThis.__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=o,t.isChangeGateEnabled=function(e){var t;return null===(t=o()[e])||void 0===t||t},t.setChangeGateDictionaryGetter=function(e){var t=a.globalThis.__get_change_gate_dictionary_variable;return a.globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var a=r(27);t.globalThis=a},,,,,,,,function(e,t,r){"use strict";e.exports=r(28)()?globalThis:r(29)},function(e,t,r){"use strict";e.exports=function(){return"object"==typeof globalThis&&(!!globalThis&&globalThis.Array===Array)}},function(e,t){var r=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var a=r(17);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,a.getBooleanFeatureGate)(t,r);case"number":return(0,a.getNumberFeatureGate)(t,r);case"string":return(0,a.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var a=r(18);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,a.isChangeGateEnabled)(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var a=r(2),o=r(18);function n(e){var t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((function(){var r=void 0!==t?t():{};return a.__assign(a.__assign({},r),e)})),t}t.overrideChangeGates=n,t.overrideTypedChangeGates=function(e,t){return n(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var a=r(2),o=r(17);function n(e){for(var t,r,n={},i=0,s=Object.keys(e);i<s.length;i++){var c=s[i];n[c]=null===(t=e[c])||void 0===t?void 0:t.toString()}var l=null!==(r=(0,o.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,o.setFeatureGateDictionaryGetter)((function(){return a.__assign(a.__assign({},l()),n)})),l}t.overrideFeatureGates=n,t.overrideTypedFeatureGates=function(e,t){return n(t)}},,,,,,,,,,,function(e,t,r){"use strict";r.r(t),r.d(t,"createClipboardItems",(function(){return o.R})),r.d(t,"getClipboardPlatformEnvironment",(function(){return Ze})),r.d(t,"setClipboardPlatformFeatureGateManager",(function(){return et}));var a,o=r(1),n=r(0);function i(e){Object(o.kc)().ULS.shipAssertTag(595944468,n.LogCategory.msoulscat_ES_EWAJS,!!e,"ClipboardPlatformSettings.setClipboardPlatformSettings: expect clipboardPlatformSettings to be defined."),a=e}var s,c=r(2),l=r(10);var d,u={serializeMetadata:function(e){if(!e)return"{}";try{var t={},r=function(e){if(!e)return;try{if(!e.id)throw new o.e(o.f.SerializedMetadata,"MetadataSerializer.serializeCopyContext: copyContext.id is not defined");if(!e.sessionId)throw new o.e(o.f.SerializedMetadata,"MetadataSerializer.serializeCopyContext: copyContext.sessionId is not defined");if(void 0===e.copyStatus)throw new o.e(o.f.SerializedMetadata,"MetadataSerializer.serializeCopyContext: copyContext.copyStatus is not defined");return{id:e.id,sessionId:e.sessionId,sourceItem:s.serializeSourceItem(e.sourceItem),commandParameters:s.serializeCommandParameters(e.commandParameters),copyStatus:e.copyStatus,isTimestampStoredInSystemClipboard:e.isTimestampStoredInSystemClipboard,isAsyncSerializeFailed:e.isAsyncSerializeFailed,asyncClipboardItemsKeys:e.asyncClipboardItemsKeys,syncClipboardItemsKeys:e.syncClipboardItemsKeys,isFullSheetCopy:e.isFullSheetCopy}}catch(e){return void Object(o.kc)().ULS.traceTag(595945243,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataSerializer.serializeCopyContext: failed to serialized copyContext: ".concat(n.utils.getStringifiedError(e)))}}(e.lastCopy);return r&&(t.copyContext=r),JSON.stringify(t)}catch(e){return Object(o.kc)().ULS.traceTag(595945242,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataSerializer.serializeMetadata: failed to serialized metadata: ".concat(n.utils.getStringifiedError(e))),"{}"}},deserializeMetadata:function(e){if(!e)return Object(o.rb)();try{var t=JSON.parse(e),r={};return t.copyContext&&(r.lastCopy=function(e){if(!e)return;try{if(!e.id)throw new o.e(o.f.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.id is not defined");if(!e.sessionId)throw new o.e(o.f.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.sessionId is not defined");if(!e.copyStatus)throw new o.e(o.f.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.copyStatus is not defined");if(!e.sourceItem)throw new o.e(o.f.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.sourceItem is not defined");if(!e.commandParameters)throw new o.e(o.f.DeserializedMetadata,"MetadataSerializer.deserializeCopyContext: copyContextSerializationData.commandParameters is not defined");var t=new o.l;return t.id=e.id,t.sessionId=e.sessionId,t.copyStatus=e.copyStatus,t.isTimestampStoredInSystemClipboard=e.isTimestampStoredInSystemClipboard,t.isAsyncSerializeFailed=e.isAsyncSerializeFailed,t.sourceItem=s.deserializeSourceItem(e.sourceItem),t.commandParameters=s.deserializeCommandParameters(e.commandParameters),t.asyncClipboardItemsKeys=e.asyncClipboardItemsKeys,t.syncClipboardItemsKeys=e.syncClipboardItemsKeys,t.isFullSheetCopy=e.isFullSheetCopy,t}catch(e){return void Object(o.kc)().ULS.traceTag(595945245,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataSerializer.deserializeMetadata: failed to deserialized copyContext with error: ".concat(n.utils.getStringifiedError(e),"."))}}(t.copyContext)),r}catch(e){Object(o.kc)().ULS.traceTag(595945244,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataSerializer.deserializeMetadata: failed to deserialized metadata with error: ".concat(n.utils.getStringifiedError(e)))}return Object(o.rb)()}};function p(e,t,r){return Object(o.kc)().ULS.shipAssertTag(595945246,n.LogCategory.msoulscat_ES_EWAJS,!!e,"MetadataManager.createMetadataManager: expected clipboardStrategy to be defined."),Object(o.kc)().ULS.shipAssertTag(595945247,n.LogCategory.msoulscat_ES_EWAJS,!!e,"MetadataManager.createMetadataManager: expected metadataSerializationHelper to be defined."),d=e,g=function(e){return s=e,u}(t),(f=r)&&f.setOnMetadataChangedListener(S),y}var g,f,m,b=Object(o.rb)(),h={},y={getCachedMetadata:function(){return Object(o.kc)().ULS.traceTag(595730648,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.getCachedMetadata: get cached metadata with value: ".concat(w(b))),Object(o.Q)(b)},updateMetadata:function(e){Object(o.kc)().ULS.traceTag(595730652,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.updateMetadata: start update metadata with metadata : ".concat(w(e)));var t=Object(c.__assign)(Object(c.__assign)({},b),e),r=Object(o.R)();r.setItem("metadata",g.serializeMetadata(t)),Object(o.kc)().ULS.traceTag(595730653,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.updateMetadata: schedule metadata with value: ".concat(w(t))),v(r,t)},clear:function(){Object(o.kc)().ULS.traceTag(595730654,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.clear: start clear metadata");var e=Object(o.rb)();v(Object(o.R)(),e)},addMetadataChangeListener:function(e,t){e||Object(o.kc)().ULS.traceTag(595936158,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataManager.addMetadataChangeListener: expected listenerId to be define");t||Object(o.kc)().ULS.traceTag(595936159,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataManager.addMetadataChangeListener: expected listener to be define");h[e]&&Object(o.kc)().ULS.traceTag(595936160,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataManager.addMetadataChangeListener: listener with same listenerId(".concat(e," already exist."));h[e]=t},removeMetadataChangeListener:function(e){e||Object(o.kc)().ULS.traceTag(595936161,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataManager.addMetadataChangeListener: expected listenerId to be define");h[e]?delete h[e]:Object(o.kc)().ULS.traceTag(595936162,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataManager.removeMetadataChangeListener: can't find listener with listenerId = ".concat(e,"."))},getMetadataSyncPromise:function(){if(!m||!Object(l.isChangeGateEnabled)("OfficeVSO:2594435_ArtCCPWaitForCopyToComplete"))return Object(o.kc)().ULS.traceTag(595937173,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.getMetadataSyncPromise: metadata is sync, return resolved promise."),Promise.resolve(Object(o.Q)(b));return Object(o.kc)().ULS.traceTag(595937174,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.getMetadataSyncPromise: metadata not sync, return deferred promise."),m.deferredPromise.promise.then((function(e){return Object(o.kc)().ULS.traceTag(595937175,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.getMetadataSyncPromise: sync promise resolved."),e}))},isMetadataSync:function(){return!m}};function S(e){try{if(e&&0!==Object(o.nb)(e)){var t=e.getItem("metadata");b=g.deserializeMetadata(t),Object(o.kc)().ULS.traceTag(595730650,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.onMetadataChanged: set cached metadata with value ".concat(w(b)))}else Object(o.kc)().ULS.traceTag(595730649,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.onMetadataChanged: set empty cached metadata because clipboardItems were not found"),b=Object(o.rb)()}catch(e){Object(o.kc)().ULS.traceTag(595945248,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataManager.onMetadataChanged: failed to parse metadata string with error: ".concat(n.utils.getStringifiedError(e))),b=Object(o.rb)()}C(Object(o.Q)(b))}function C(e){for(var t in Object(o.kc)().ULS.traceTag(595730651,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.updateListenerForMetadataChanged: update listeners with metadata : ".concat(w(e))),h){var r=h[t];r&&r(e)}}function v(e,t){var r=Object(o.bb)();m?m.metadataSyncMessageId=r:(m={metadataSyncMessageId:r,deferredPromise:Object(o.V)()},Object(o.kc)().ULS.traceTag(595937176,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.scheduleMetadataUpdate: _syncMetadata created. ".concat(m.metadataSyncMessageId))),Object(o.kc)().ULS.traceTag(595937177,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.scheduleMetadataUpdate: set metadata request was sent with message id ".concat(r,".")),setTimeout((function(){d.set(e,{}).then((function(){b=t,Object(o.kc)().ULS.traceTag(595937178,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.scheduleMetadataUpdate: set metadata successfully. messageId=".concat(r,". _syncMetadata.metadataSyncMessageId = ").concat(m&&m.metadataSyncMessageId,". newMetadata = ").concat(w(t))),E(r)}),(function(e){Object(o.kc)().ULS.traceTag(595945250,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"MetadataManager.updateMetadata: failed to update metadata store with error: ".concat(n.utils.getStringifiedError(e))),E(r)}))}),0)}function E(e){if(Object(o.kc)().ULS.traceTag(595730655,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.notifyMetadataSyncIfNeeded: start notifyMetadataSyncIfNeeded with messageId: ".concat(e)),m&&m.metadataSyncMessageId===e){var t=m;m=void 0;var r=Object(o.Q)(b);Object(o.kc)().ULS.traceTag(595730656,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"MetadataManager.notifyMetadataSyncIfNeeded: resolve with metadata: ".concat(w(r))),C(r),t.deferredPromise.resolve(r)}}function w(e){return e?e.lastCopy?"copyContext.id=".concat(e.lastCopy.id):"copy context is null":"metadata is null"}var L=function(){function e(e,t,r){this.ttlInMs=t,this.blockMismatchDataVersion=r,e?this.userHash=n.utils.calcHashCode(e):(this.userHash=1565411791,Object(o.kc)().ULS.traceTag(595903939,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"userId not exist!. Use default ID"))}return e.prototype.wrapTextWithDataSignature=function(e,t,r,a,n){void 0===a&&(a="null");var i,s={ccp_infra_version:3,ccp_infra_timestamp:r,ccp_infra_user_hash:this.userHash,ccp_infra_copy_id:a};return(i=null!==n&&0!==Object.keys(n).length?Object(c.__assign)(Object(c.__assign)({},s),n):s)[o.Bb.ccpTimestampHtmlCustomAttributeName]=r,o.Bb.wrapContentWithTagAndAttributes(e,t,i)},e.prototype.ensureDataSignatureInHtmlItem=function(e){if(0!==Object(o.nb)(e)){var t=Object(o.tb)(e),r=Object(o.lb)(t,o.jc),a=Object(o.lb)(t,o.Sb),n=Object(o.lb)(t,o.Qb),i=null;if(n!==o.jb&&(i=JSON.parse(n)),r){if(void 0!==this.getRegExIntValue(r,"ccp_infra_version=['|\"](\\d+)['|\"]"))return;e.setItem(o.jc,this.wrapTextWithDataSignature(r,o.Bb.divTagName,Date.now(),a,i))}else{var s=Object(o.pb)(t),c=o.Bb.createTextHtmlFromTextPlain(s),l=this.wrapTextWithDataSignature(c,o.Bb.preTagName,Date.now(),a,i);e.setItem(o.jc,o.Bb.addClipboardWrapperForEdge(l))}}},e.prototype.extractSignatureData=function(e){if(Object(o.ob)(e)>0){var t=Object(o.mb)(e,o.jc),r=this.getRegExIntValue(t,"ccp_infra_version=['|\"](\\d+)['|\"]");if(void 0===r)return this.parsePreSignatureData(t);if(this.blockMismatchDataVersion&&3!==r)throw Object(o.kc)().ULS.traceTag(595902983,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"clipboardDataManager.extractSignatureData: block mismatch version. dataVer = ".concat(r,", CCPInfraVersion = ").concat(3)),new o.A("ClipboardDataManagerImpl.extractSignatureData",r,3,this.blockMismatchDataVersion);return r<3?(Object(o.kc)().ULS.traceTag(595902986,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.extractSignatureData: got data with older version then app version: dataVer = ".concat(r,", CCPInfraVersion = ").concat(3,". Converting to the data")),this.parseOldSignatureData(t)):(r>3&&Object(o.kc)().ULS.traceTag(595900176,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.extractSignatureData: got data with newer version then app version: dataVer = ".concat(r,", CCPInfraVersion = ").concat(3,". ( It's OK - Should be forward compatibility)")),this.parseCurrentVersionSignatureData(t))}},e.prototype.parseCurrentVersionSignatureData=function(e){var t=this.getRegExIntValue(e,"\\s+ccp_infra_timestamp=['|\"](\\d+)['|\"]"),r=this.getRegExIntValue(e,"\\s+ccp_infra_user_hash=['|\"](\\d+)['|\"]");if(void 0!==t&&void 0!==r){var a=this.getRegExStringValue(e,"\\s+ccp_infra_copy_id=['|\"]([\\w-]+)['|\"]");return a&&Object(o.kc)().ULS.traceTag(595183181,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.parseCurrentVersionSignatureData: copy ID of legacy paste cross session : ".concat(a)),{ccp_infra_version:3,ccp_infra_timestamp:t,ccp_infra_user_hash:r,ccp_infra_copy_id:a||""}}Object(o.kc)().ULS.traceTag(595902985,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Error,"clipboardDataManager.extractSignatureData: Failed to extract SignatureData. textHtmlItem: ".concat(e))},e.prototype.parseOldSignatureData=function(e){return this.parseCurrentVersionSignatureData(e)},e.prototype.parsePreSignatureData=function(e){var t=o.Bb.getCcpTimestampHtmlCustomAttributeFromWrappingTag(e);if(Object(o.kc)().ULS.traceTag(595723668,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.parsePreSignatureData: dataTimeStamp=".concat(t)),t){if(this.blockMismatchDataVersion)throw Object(o.kc)().ULS.traceTag(595899270,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"clipboardDataManager.parsePreSignatureData: block mismatch version. block pre signature data"),new o.A("ClipboardDataManagerImpl.extractSignatureData",NaN,3,this.blockMismatchDataVersion);var r={ccp_infra_version:3,ccp_infra_timestamp:t,ccp_infra_user_hash:0};return Object(o.kc)().ULS.traceTag(595723669,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.parsePreSignatureData"),r}},e.prototype.validateTTL=function(e){if(e&&this.ttlInMs){var t=Date.now()-e.ccp_infra_timestamp;if(t>this.ttlInMs)throw Object(o.kc)().ULS.traceTag(595899858,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"Time elapsed (".concat(t," ms) from setting Clipboard (").concat(e.ccp_infra_timestamp,") is greater then TTL (").concat(this.ttlInMs," ms) - return error")),new o.K("clipboardDataManager.validateTTL validation failed",t,this.ttlInMs)}},e.prototype.validateUserHash=function(e){if(e&&e.ccp_infra_user_hash!==this.userHash)throw Object(o.kc)().ULS.traceTag(595723670,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"clipboardDataManager.validateUserHash: user hash mismatch detected. throw error"),new o.N("clipboardDataManager.validateUserHash validation failed",e?e.ccp_infra_user_hash:0,this.userHash)},e.prototype.setMetaDataVersionItem=function(e){if(0!==Object(o.nb)(e)){var t={ccp_infra_version:3};e.setItem(o.Tb,JSON.stringify(t))}},e.prototype.validateMetaDataVersionItem=function(e){if(e&&Object(o.nb)(e)>0){var t=Object(o.mb)(e.getData(),o.Tb),r=void 0;try{r=JSON.parse(t)}catch(e){if(!this.blockMismatchDataVersion)return;throw Object(o.kc)().ULS.traceTag(595899272,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"clipboardDataManager.validateMetaDataVersionItem: failed parse SignatureMetaData. error = ".concat(e)),new o.L("ClipboardDataManagerImpl.validateMetaDataVersionItem: failed parse SignatureMetaData. SignatureMetaData text = ".concat(t))}if(this.blockMismatchDataVersion&&3!==r.ccp_infra_version)throw Object(o.kc)().ULS.traceTag(595899203,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"clipboardDataManager.validateMetaDataVersionItem: block mismatch version. dataVer = ".concat(r.ccp_infra_version,", CCPInfraVersion = ").concat(3)),new o.A("ClipboardDataManagerImpl.validateMetaDataVersionItem",r.ccp_infra_version,3,this.blockMismatchDataVersion)}},e.prototype.createClipboardDataProcessor=function(e){var t=this;Object(o.kc)().ULS.traceTag(595723671,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.createClipboardDataProcessor: get called. validateUserHash=".concat(e));return{preSetProcess:this.ensureDataSignatureInHtmlItem.bind(this),postGetProcess:function(r){if(Object(o.kc)().ULS.traceTag(595723672,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.createClipboardDataProcessor.postGet: get called. validateUserHash=".concat(e)),r){var a=t.extractSignatureData(r.getData());Object(o.kc)().ULS.traceTag(595723673,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.createClipboardDataProcessor.postGet: clipboardItems not empty. validateUserHash=".concat(e)),a&&r.setItem(o.Sb,a.ccp_infra_copy_id),t.validateTTL(a),e&&(Object(o.kc)().ULS.traceTag(595723674,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.createClipboardDataProcessor.postGet: going to validate user hash. validateUserHash=".concat(e)),t.validateUserHash(a))}}.bind(this)}},e.prototype.createDualClipboardDataProcessor=function(e){var t=this;Object(o.kc)().ULS.traceTag(595723675,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.createDualClipboardDataProcessor: get called.");return{preSetProcess:this.ensureDataSignatureInHtmlItem.bind(this),postGetProcess:function(e){Object(o.kc)().ULS.traceTag(595723676,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardDataManager.createDualClipboardDataProcessor.postGet: get called."),e&&e.clipboardItemsData&&(e.signatureData=t.extractSignatureData(e.clipboardItemsData),e.signatureData&&(e.clipboardItemsData.items[o.Sb]=e.signatureData.ccp_infra_copy_id),t.validateTTL(e.signatureData))}.bind(this),validateUserHash:e?this.validateUserHash.bind(this):function(){}}},e.prototype.createClipboardMetaDataProcessor=function(){return{preSetProcess:this.setMetaDataVersionItem.bind(this),postGetProcess:this.validateMetaDataVersionItem.bind(this)}},e.prototype.getRegExStringValue=function(e,t){var r=new RegExp(t,"g").exec(e);if(r&&r.length&&r.length>1)return r[1]},e.prototype.getRegExIntValue=function(e,t){var r=this.getRegExStringValue(e,t);if(r){var a=Number(r);return isNaN(a)?void 0:a}},e}();var T=function(e){function t(t,r,a){var o=e.call(this,t,r,a,"WindowRPCClientInternal")||this;return o.pushMessageListeners={},o}return Object(c.__extends)(t,e),t.prototype.init=function(e){return this.deferredResultMessagePromiseCache=Object(o.W)(),this.sender=Object(o.eb)(this.serializer,this),this.receiver=Object(o.db)(this.deserializer,this,this),this.postInitMessage(e).catch((function(e){return Object(o.kc)().ULS.traceTag(596129250,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Init failure or timeout. Error: ".concat(n.utils.getStringifiedError(e))),Object(o.Hb)(e,o.f.IframeInitializationTimeout)?Promise.reject(e):Promise.reject(new o.e(o.f.IframeInitialization,"failed to init the Shared Clipboard",e))}))},t.prototype.registerPushMessageListener=function(e,t){this.pushMessageListeners[e]=t},t.prototype.postInitMessage=function(e){var t=Object(o.S)(o.Fb,"init",o.z.initIframe);if(!this.deferredResultMessagePromiseCache){var r="RPC Client - postInitMessage: this.deferredResultMessagePromiseCache should be defined";return Object(o.kc)().ULS.shipAssertTag(596121487,n.LogCategory.msoulscat_ES_EWAJS,!1,r),Promise.reject(new o.u(r))}var a=this.postMessage(t),i=this.deferredResultMessagePromiseCache.getDeferredPromise(t.id),s=Date.now();return setTimeout((function(){if(i&&!i.fulfilled()){var e=Date.now(),t="initialization started on ".concat(new Date(s)," and timed out on ").concat(new Date(e)," after ").concat(e-s," ms");Object(o.kc)().ULS.traceTag(596129251,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Error,t),i.reject(new o.e(o.f.IframeInitializationTimeout,t))}}),e),a},t.prototype.postMessage=function(t){try{if(!t)throw new o.B(o.jb,"outgoingMessage");if(Object(o.kc)().ULS.shipAssertTag(596452175,n.LogCategory.msoulscat_ES_EWAJS,!!t.id,"postMessage: outgoingMessage.id must be defined"),e.prototype.postMessage.call(this,t),!this.deferredResultMessagePromiseCache){var r="RPC Client - postMessage: this.deferredResultMessagePromiseCache should be defined";throw Object(o.kc)().ULS.shipAssertTag(596121488,n.LogCategory.msoulscat_ES_EWAJS,!1,r),new o.u(r)}return this.deferredResultMessagePromiseCache.addNewPromise(t.id).promise}catch(e){return Promise.reject(new o.u("Unable to post message for operation '".concat(t?t.operationCode:void 0,"'"),e))}},t.prototype.handleMessage=function(e){Object(o.kc)().ULS.traceTag(596452376,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"RPC Client - handleMessage: incomingMessage.id='".concat(e&&e.id,"'; incomingMessage.operationCode='").concat(e&&e.operationCode,"'; incomingMessage.failed='").concat(e&&e.failed,"'; incomingMessage.error='").concat(e&&e.error,"'; incomingMessage.clipboardItems.length=").concat(Object(o.ob)(e&&e.clipboardItemsData)));var t=this.pushMessageListeners[e.operationCode];if(t)return t(e.clipboardItemsData),Promise.resolve();if(!this.deferredResultMessagePromiseCache){var r="RPC Client - handleMessage: this.deferredResultMessagePromiseCache should be defined";return Object(o.kc)().ULS.shipAssertTag(596121489,n.LogCategory.msoulscat_ES_EWAJS,!1,r),Promise.reject(new o.u(r))}var a="initresult"===e.operationCode?o.Fb:e.id,i=this.deferredResultMessagePromiseCache.getDeferredPromise(a);return i?(this.deferredResultMessagePromiseCache.delete(a),e.failed?i.reject(e.error):i.resolve(e),Promise.resolve()):(Object(o.kc)().ULS.traceTag(596452377,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,a===e.id?"RPC Client - handleMessage: no deferred promise with id '".concat(e.id,"'; dropping this result."):"RPC Client - handleMessage: no deferred promise with id '".concat(a,"' for message id '").concat(e.id,"'; dropping this result.")),Promise.resolve())},t.prototype.handleDeserializationError=function(e){return!e||"NoValidKeyError"!==e.errorName||this.deferredResultMessagePromiseCache&&0!==this.deferredResultMessagePromiseCache.getLength()?(Object(o.kc)().ULS.traceTag(596452379,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"RPC Client - handleDeserializationError. There are ".concat(this.deferredResultMessagePromiseCache?this.deferredResultMessagePromiseCache.getLength():0," deferred promise(s) in the cache. Error: ").concat(n.utils.getStringifiedError(e))),Promise.resolve()):(Object(o.kc)().ULS.traceTag(542687372,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"RPC Client - handleDeserializationError. Error: ".concat(n.utils.getStringifiedError(e))),Promise.resolve())},t.prototype.dispose=function(){var t=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(Object(o.ec)([function(){t.deferredResultMessagePromiseCache&&t.deferredResultMessagePromiseCache.clear()}]),e.prototype.dispose.call(this))},t}(o.O),_=[],I={initialized:!1,origin:o.jb,src:o.jb,deferredPromise:void 0},O=void 0;function A(){return I}function P(){var e=document.createElement("iframe");return e.style.display="none",e.id="clipboard",Object(o.kc)().ULS.shipAssertTag(595952726,n.LogCategory.msoulscat_ES_EWAJS,!O,"createIframe: the last shared clipboard iframe's onload event listener should have been removed. Removing it and registering a new event listener."),x(),O=Object(o.P)(e,"load",(function(e){return function(e){Object(o.kc)().ULS.traceTag(595952727,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"CCP iframe onload event: Entering"),x();var t=A().deferredPromise;if(!t)return void Object(o.kc)().ULS.shipAssertTag(595952728,n.LogCategory.msoulscat_ES_EWAJS,!1,"CCP iframe onload event: the CCP iframe does not have a matching deferred promise to notify subscribers when the iframe loaded");var r=t.id;try{A().deferredPromise=void 0;var a=e.target;if(!a){var i="CCP iframe onload event: the CCP iframe should exist when its onload event is called. Rejecting deferred promise id '".concat(r,"'");return Object(o.kc)().ULS.shipAssertTag(595952729,n.LogCategory.msoulscat_ES_EWAJS,!1,i),void t.reject(new o.u(i))}if(!a.contentWindow){i="CCP iframe onload event: the contentWindow of the CCP iframe does not exist. Rejecting deferred promise id '".concat(r,"'");return Object(o.kc)().ULS.shipAssertTag(595952730,n.LogCategory.msoulscat_ES_EWAJS,!1,i),void t.reject(new o.u(i))}Object(o.kc)().ULS.traceTag(595952732,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"CCP iframe onload event: resolving deferred promise id '".concat(r,"' with the iframe")),t.resolve(a)}catch(e){i="iframeOnLoad: an error has occurred: [".concat(n.utils.getStringifiedError(e),"]. Rejecting deferred promise id '").concat(r,"'");Object(o.kc)().ULS.traceTag(595952733,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,i),t.reject(new o.u(i,e))}}(e)})),e.src=A().src,e}function j(e){var t=A().origin,r=t;"/"!==t.charAt(t.length-1)&&(r+="/"),r+="clipboard/shared.aspx",e&&(r+="?".concat(encodeURIComponent(o.bc),"=").concat(encodeURIComponent(e)));var i=[];_.forEach((function(e){Object(l.isChangeGateEnabled)(e)||i.push({key:e,value:"1"})}));var s=function(){if(!a)throw new o.u("ClipboardPlatformSettings is not ready. Call ClipboardPlatformEnvironment.init(...).");return a}();s&&(s.sessionId&&i.push({key:o.cc,value:s.sessionId}),s.bulsEndpointUrl&&i.push({key:o.ac,value:s.bulsEndpointUrl}));var c=Object(n.getNewGuid)(),d=c[0],u=c[1];return Object(o.kc)().ULS.traceTag(595722560,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getValidatedIframeSrc.getValidatedIframeSrc: Generate correlation if for loading the shared clipboard frame. CorrelationId: ".concat(d," newGuidLogging: ").concat(u)),i.push({key:"corrid",value:d}),i.push({key:"NoAuth",value:"true"}),i.length>0&&i.forEach((function(e){r+=function(e){if(e.indexOf("?")>=0)return"&";return"?"}(r),r+="".concat(encodeURIComponent(e.key),"=").concat(encodeURIComponent(e.value))})),r}function x(){if(O){try{O()}catch(e){}O=void 0}}var D=void 0;function M(){if(!D)return Promise.reject("state in undefined, please make sure to call initialize first");var e=function(){if(!A().initialized)throw new o.u("getIframe: the initialize function should be called beforehand");var e=document.getElementsByTagName("iframe");if(e&&0!==e.length){Object(o.kc)().ULS.traceTag(595952723,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getIframe: found ".concat(e.length," iframes"));for(var t=0;t<e.length;t+=1){var r=e[t];if(r&&r.id&&"clipboard"===r.id)return r}Object(o.kc)().ULS.traceTag(595952724,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getIframe: the CCP iframe does not exist")}else Object(o.kc)().ULS.traceTag(595952722,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getIframe: found no iframes")}();e&&(Object(o.kc)().ULS.traceTag(596448770,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"ensureIframeWindow: The CCP iframe exists. Removing the iframe and re-adding it. iframe.src ".concat(void 0!==e.src&&void 0!==D.src&&e.src.toLowerCase()===D.src.toLowerCase()?"===":"!=="," src; deferredPromise ").concat(void 0===D.deferredPromise?"does not exist":"exists","; The iframe's content window ").concat(void 0===e.contentWindow?"does not exist":"exists",".")),function(e){if(!e)throw new o.B(o.jb,"iframe");Object(o.kc)().ULS.traceTag(595952725,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"removeIframe: removing the CCP iframe"),x(),e.parentNode&&e.parentNode.removeChild(e)}(e),e=void 0);var t=D.deferredPromise,r=t?t.id:o.jb;if(t){x(),D.deferredPromise=void 0;var a="ensureIframeWindow: the CCP iframe does not exist and the deferred promise of its content window should not exist as well. Rejecting deferred promise id '".concat(r,"' and creating a new one");Object(o.kc)().ULS.shipAssertTag(596453587,n.LogCategory.msoulscat_ES_EWAJS,!1,a),t.reject(new o.u(a)),t=void 0}D.deferredPromise=Object(o.V)(Object(o.bb)()),r=(t=D.deferredPromise).id;try{e=P(),document.getElementsByTagName("body")[0].appendChild(e)}catch(e){a="ensureIframeWindow: unable to create and/or add a CCP iframe. Dropping tentative deferred promise id '".concat(r,"'");return Object(o.kc)().ULS.traceTag(596453588,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Error,a),D.deferredPromise=void 0,x(),Promise.reject(new o.u(a,e))}return t&&!t.fulfilled()?t.promise:(x(),e.contentWindow?(D.deferredPromise=void 0,Promise.resolve(e)):(Object(o.kc)().ULS.shipAssertTag(596453589,n.LogCategory.msoulscat_ES_EWAJS,!1,"ensureIframeWindow: the iframe's content window should exist. Deferred promise id = '".concat(r,"'")),Promise.reject(new o.u("ensureIframeWindow: the iframe's content window should exist. Deferred promise id = '".concat(r,"'")))))}var W,k;function R(){if(k)return k.promise;k=Object(o.V)(Object(o.bb)());try{var e=function(e){return D||(D=A()),D.initialized||(D.origin=Object(o.xb)(e),D.src=j(e),D.initialized=!0),D.origin}(Object(o.zb)().origin);W=function(e,t){return new T(Object(o.cb)(o.mc),Object(o.ab)(o.nc),{window:t,windowOrigin:e})}(e,void 0),n.utils.retry((function(e,t){return function(e,t){if(!W){var r="clipboardIframeLoader::initializeIframe - windowRPCClient should be defined";return Object(o.kc)().ULS.shipAssertTag(595947544,n.LogCategory.msoulscat_ES_EWAJS,!1,r),Promise.reject(new o.u(r))}var a=n.perfWatch.start("Iframe_initialize_".concat(e));n.perfWatch.mark(a,"start"),W.remoteWindow.window=void 0;var i=function(r){var i=Object(o.Hb)(r,o.f.IframeInitializationTimeout)?" due to a timeout of approx. ".concat(t," ms"):o.jb;n.perfWatch.mark(a,"finish_error"),n.perfWatch.failure(a,(function(e){return Object(o.kc)().ULS.traceTag(596452419,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,e)}),"Attempt #".concat(e," failed to initialize an iframe ").concat(i,". ").concat(e<3?"Retrying...":"No more retries!",". Error: ").concat(n.utils.getStringifiedError(r)))},s=Object(o.V)();return M().then((function(r){if(n.perfWatch.mark(a,"iframe_loaded"),n.perfWatch.mark(a,"iframe_waiting_for_idb_init"),!W){var s="clipboardIframeLoader::initializeIframe - windowRPCClient should be defined";Object(o.kc)().ULS.shipAssertTag(595947545,n.LogCategory.msoulscat_ES_EWAJS,!1,s);var c=new o.u(s);return i(c),Promise.reject(c)}if(!r.contentWindow){s="clipboardIframeLoader::initializeIframe - remoteWindow.contentWindow should be defined";Object(o.kc)().ULS.shipAssertTag(595903557,n.LogCategory.msoulscat_ES_EWAJS,!1,s);c=new o.u(s);return i(c),Promise.reject(c)}return W.remoteWindow.window=r.contentWindow,W.init(t).then((function(){return n.perfWatch.mark(a,"iframe_idb_init_complete"),n.perfWatch.mark(a,"finish"),n.perfWatch.success(a,(function(e){return Object(o.kc)().ULS.traceTag(596452418,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,e)}),"Attempt #".concat(e," initialized iframe")),Promise.resolve()}))})).then((function(){s.resolve()}),(function(e){i(e),s.reject(e)})),s.promise}(e,2e4+(Object(o.Hb)(t,o.f.IframeInitializationTimeout)?5e3:0)*(e-1))}),3).then((function(){k.resolve(W)}),(function(e){k.reject(e)}))}catch(e){k.reject(e)}return k.promise}var U=function(){function e(){this.initialized=!1}return e.prototype.innerInitialize=function(){var e=this;return R().then((function(t){return e.initialized=!0,e.windowRPCClient=t,e}))},e.prototype.registerPushMessageListener=function(e,t){this.windowRPCClient&&this.windowRPCClient.registerPushMessageListener(e,t)},e.prototype.postMessage=function(e,t){if(!this.initialized)return Promise.reject(new o.e(o.f.IframeInitialization));var r=n.perfWatch.start("BaseIframeProxy_".concat(t));n.perfWatch.mark(r,"start");var a=function(e){return n.perfWatch.mark(r,"finish_error"),n.perfWatch.failure(r,(function(e){return Object(o.kc)().ULS.traceTag(596452188,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,e)}),"Failed in BaseIframeProxy.postMessage. Error: ".concat(n.utils.getStringifiedError(e))),Promise.reject(new o.e(o.f.IframeProxyGeneralError,"Failed in BaseIframeProxy.postMessage",e))};if(!this.windowRPCClient){var i="BaseIframeProxy.postMessage - this.windowRPCClient should be defined";return Object(o.kc)().ULS.shipAssertTag(595944461,n.LogCategory.msoulscat_ES_EWAJS,!1,i),a(new o.u(i))}return this.windowRPCClient.postMessage(e).then((function(e){return Object(o.kc)().ULS.shipAssertTag(595944462,n.LogCategory.msoulscat_ES_EWAJS,!!e,"BaseIframeProxy.postMessage: postMessage must have returned a result message"),e?e.failed?Promise.reject(new o.e(o.f.IframeProxyGeneralError,"BaseIframeProxy.postMessage: the operation failed. Error: ".concat(e.error))):(n.perfWatch.mark(r,"finish"),n.perfWatch.success(r,(function(e){return Object(o.kc)().ULS.traceTag(596452187,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,e)})),Promise.resolve(e)):Promise.reject(new o.e(o.f.IframeProxyEmptyResultMessage,"BaseIframeProxy.postMessage: postMessage succeeded but returned nothing"))})).catch((function(e){return a(e)}))},e}(),F=function(){function e(e){this.localStorageKey=e}return e.prototype.initialize=function(e){var t=this;return new o.y(this.localStorageKey,e,(function(e){t._onMetadataChangedListener&&t._onMetadataChangedListener(e)})),Promise.resolve()},e.prototype.setOnMetadataChangedListener=function(e){Object(o.kc)().ULS.traceTag(595716297,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"LocalStorageKeyTrackerMetadataWatcher.setOnMetadataChangedListener: start setOnMetadataChangedListener"),Object(o.kc)().ULS.shipAssertTag(595716298,n.LogCategory.msoulscat_ES_EWAJS,!!e,"LocalStorageKeyTrackerMetadataWatcher.setOnMetadataChangedListener: expect listener to be defined."),this._onMetadataChangedListener=e},e}(),N=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c.__extends)(t,e),t.prototype.initialize=function(t){var r=this;return e.prototype.innerInitialize.call(this).then((function(){r.registerPushMessageListener("getMetadata_longPollingresult",(function(e){r._onMetadataChangedListener&&r._onMetadataChangedListener(Object(o.R)(e))}))}))},t.prototype.setOnMetadataChangedListener=function(e){Object(o.kc)().ULS.traceTag(595730647,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"LongPollingMetadataWatcher.setOnMetadataChangedListener: start setOnMetadataChangedListener"),Object(o.kc)().ULS.shipAssertTag(595944466,n.LogCategory.msoulscat_ES_EWAJS,!!e,"LongPollingMetadataWatcher.setOnMetadataChangedListener: expect listener to be defined."),this._onMetadataChangedListener=e},t}(U),J=function(e){function t(t){return e.call(this,o.i.SystemClipboard,{browserStorage:!1,systemClipboard:!0,inMemory:!1},t)||this}return Object(c.__extends)(t,e),t}(o.h),z=!0;function H(){return z}function V(){z=!1}var G=!0;function B(){return G}function K(){G=!1}function q(){var e=void 0;try{e=window.clipboardData}catch(e){Object(o.kc)().ULS.traceTag(595985225,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"ieSystemClipboard.getDataTransfer: An error occurred when attempting to access window.clipboardData. Error: ".concat(n.utils.getStringifiedError(e)))}return e}function X(){if(Object(o.kc)().ULS.shipAssertTag(596455701,n.LogCategory.msoulscat_ES_EWAJS,Object(o.Mb)(),"The browser must be IE"),!Object(o.Mb)())throw new o.u("The browser must be IE")}function Y(e){return!!e}function Q(e){if(e){var t=void 0;try{t=e.clipboardData}catch(e){throw Object(o.kc)().ULS.traceTag(595985224,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"systemClipboard.getDataTransfer: An error occurred when attempting to access rawEvent.clipboardData. Error: ".concat(n.utils.getStringifiedError(e))),e}return t}Object(o.kc)().ULS.traceTag(596456320,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"A clipboard event parameter is missing")}function $(e,t,r,a){var i=!1;try{var s=Q(r);if(!s||!Y(s))return Object(o.kc)().ULS.traceTag(596456264,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"setData - programmatic ".concat(o.j," and ").concat(o.p," is broken. There is no valid data transfer object. clipboardDataFormat = '").concat(e,"'")),!1;!1===(i=s.setData(e,t))&&Object(o.kc)().ULS.traceTag(596456265,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"setData returned false for '".concat(e,"'."))}catch(t){Object(o.kc)().ULS.traceTag(596456266,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"setData with '".concat(e,"' threw an exception: ").concat(n.utils.getStringifiedError(t)))}return void 0===i&&(i=!0),i}function Z(e,t,r,a){if(X(),!a&&!H()&&!B())return Object(o.kc)().ULS.traceTag(596456269,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"setData - programmatic ".concat(o.j," and ").concat(o.p," clipboard access is not supported. rawEvent is empty = ").concat(!!r)),!1;var i=q();if(!i||!Y(i))return Object(o.kc)().ULS.traceTag(596456270,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"setData - ".concat(o.j," and ").concat(o.p," is broken. There is no valid global data transfer object. Do not try again to fetch it. clipboardDataFormat = '").concat(e,"'")),a||(Object(o.kc)().ULS.shipAssertTag(596456271,n.LogCategory.msoulscat_ES_EWAJS,H()&&B(),"setData - programmatic ".concat(o.j," and ").concat(o.p," is broken because the global data transfer object was previously available and now it's not available. isBeforeFirstProgrammaticAccess = '").concat(H(),"'. isProgrammaticAccessSupported = '").concat(B(),"'. clipboardDataFormat = '").concat(e,"'")),V(),K()),!1;var s,c=e;c===o.hb&&(c=o.ib);try{!1===(s=i.setData(c,t))&&Object(o.kc)().ULS.traceTag(596456272,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"setData returned false for '".concat(c,"'."))}catch(e){Object(o.kc)().ULS.traceTag(596456273,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"setData with '".concat(c,"' threw an exception: ").concat(e.message))}return!a&&H()&&(V(),!1===s&&K()),void 0===s&&(s=!0),s}function ee(){return H()&&Z(o.hb,o.jb,void 0,!1),!!B()||(Object(o.kc)().ULS.traceTag(596456274,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand - programmatic clipboard access is not allowed for '".concat(o.j,"' and '").concat(o.p,"'.")),!1)}var te={execCommandCopy:function(){var e;try{e=document.execCommand(o.j,!1,null)}catch(e){Object(o.kc)().ULS.traceTag(596456262,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand('".concat(o.j,"') threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}return void 0===e&&(e=!0),e},execCommandCut:function(){var e;try{e=document.execCommand(o.p,!1,null)}catch(e){Object(o.kc)().ULS.traceTag(596456263,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand('".concat(o.p,"') threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}return void 0===e&&(e=!0),e},setData:$,defaultClipboardDataFormat:o.hb},re={execCommandCopy:function(){if(X(),!ee())return!1;try{document.execCommand(o.j,!1,null)}catch(e){Object(o.kc)().ULS.traceTag(596456267,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand('".concat(o.j,"') threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}return!0},execCommandCut:function(){if(X(),!ee())return!1;try{document.execCommand(o.p,!1,null)}catch(e){Object(o.kc)().ULS.traceTag(596456268,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand('".concat(o.p,"') threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}return!0},setData:Z,defaultClipboardDataFormat:o.ib},ae=void 0;function oe(e,t,r,a){return ne().setData(e,t,r,a)}function ne(){return void 0===ae&&(ae=te),ae}Object(o.Mb)()&&(ae=re);var ie=void 0,se={};function ce(){if(void 0===ie&&(ie=!1,"chrome"in window)){var e=window.chrome;e&&("runtime"in e&&e.runtime?"sendMessage"in e.runtime&&e.runtime.sendMessage?ie=!0:Object(o.kc)().ULS.traceTag(596455703,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"chrome.runtime.sendMessage is not available"):Object(o.kc)().ULS.traceTag(596455704,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"chrome.runtime is not available"))}return ie}function le(){if(!ce())return Promise.reject(new o.e(o.f.MissingBrowserExtensionCapability));var e=function(){for(var e in se){if(se[e].includes("getClipboardData"))return e}return null}();if(!e)return Promise.reject(new o.e(o.f.NoBrowserExtensionWithGetClipboardDataCommand));var t={command:"getClipboardData"};return function(e,t){return new Promise((function(r,a){var i=!0;window.chrome.runtime.sendMessage(e,t,void 0,(function(t){var n=window.chrome.runtime.lastError;if(!t||"object"!=typeof t||Array.isArray(t)||n){i=!1;var s=o.jb;n&&"message"in n&&"string"==typeof n.message&&(s=n.message),a(new o.e(o.f.UnavailableBrowserExtension,"chromeSystemClipboard - '".concat("getClipboardData","': browser extension '").concat(e,"' is not available. Error: ").concat(s)))}else{i=!1;var c=t,l=c.html,d=c.img,u=c.text,p=function(e,t,r){var a=!!e,o=!!t,n=!!r,i=e.includes("<img src="),s=o&&a&&i;return o&&!n||s}(l,d,u);r({text:u,html:p?d:l})}})),setTimeout((function(){i&&(Object(o.kc)().ULS.traceTag(589947076,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"chromeSystemClipboard - getPasteWithExtensionPromise reject the promise after timeout. chromeExtenstionsInfo: '".concat(se,"'")),a(new o.e(o.f.UnavailableBrowserExtension,"chromeSystemClipboard - '".concat("getClipboardData","': browser extension '").concat(e,"' is not available. Timeout after : ").concat(2e3," ms"))))}),2e3)}))}(e,t).then((function(t){if(!t)return Promise.reject(new o.e(o.f.NoAvailableBrowserExtensions));Object(o.kc)().ULS.traceTag(589947075,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"chromeSystemClipboard - paste by browser extension '".concat(e,"'"));var r=Object(o.R)();return r.setItem(o.hb,t.text),r.setItem(o.jc,t.html),r.setItem(o.Rb,e),r}))}function de(e){if(!e||!e.items)return Promise.reject(new o.H(o.I.ClipboardIsInaccessible,"getImageDataUrlFromClipboardData: clipboardData is undefined=".concat(!e," clipboardData.items is undefined=").concat(!e.items)));for(var t=0;t<e.items.length;t+=1){var r=e.items[t].type&&e.items[t].type.startsWith("image");if(r||Object(o.kc)().ULS.traceTag(528859143,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Non-image type read from System Clipboard. File Type is "+e.items[t].type),"file"===e.items[t].kind&&r)return ue(e.items[t].getAsFile())}return Promise.resolve(o.jb)}function ue(e){var t=n.perfWatch.start("ImageFile_Read_From_Clipboard"),r=e?e.size:-1,a=Object(o.V)(),i=new FileReader;return i.onload=function(){i.result?(n.perfWatch.success(t,(function(e){return Object(o.kc)().ULS.traceTag(595911452,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,pe(e,r))})),a.resolve(i.result.toString())):(n.perfWatch.failure(t,(function(e){return Object(o.kc)().ULS.traceTag(595911453,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,pe(e,r))})),a.reject(new o.H(o.I.FileReaderResultIsEmpty,"getImageDataUrlFromClipboardData: FileReader result is null or undefined")))},i.onerror=function(){n.perfWatch.failure(t,(function(e){return Object(o.kc)().ULS.traceTag(595911454,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,pe(e,r))})),a.reject(new o.H(o.I.FileReaderFailed,"getImageDataUrlFromClipboardData: FileReader failed"))},n.perfWatch.mark(t,"Starting_readAsDataURL"),i.readAsDataURL(e),a.promise}function pe(e,t){var r=JSON.parse(e);return r.filesize=t,JSON.stringify(r)}function ge(e,t,r){if(X(),!r&&!H()&&!B())return Object(o.kc)().ULS.traceTag(596456327,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getData - programmatic ".concat(o.E," clipboard access is not supported. rawEvent is empty = ").concat(!!t)),Promise.resolve(o.jb);var a=q();if(!a||!Y(a))return Object(o.kc)().ULS.traceTag(596456328,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"getData - ".concat(o.E," is broken. There is no valid global data transfer object. Do not try again to fetch it. clipboardDataFormat = '").concat(e,"'")),r||(Object(o.kc)().ULS.shipAssertTag(596456329,n.LogCategory.msoulscat_ES_EWAJS,H()&&B(),"getData - programmatic ".concat(o.E," is broken because the global data transfer object was previously available and now it's not available. isBeforeFirstProgrammaticAccess = '").concat(H(),"'. isProgrammaticAccessSupported = '").concat(B(),"'. clipboardDataFormat = '").concat(e,"'")),V(),K()),Promise.resolve(o.jb);var i=e;i===o.hb&&(i=o.ib);var s=o.jb;try{(s=a.getData(i))||(s=o.jb),Object(o.kc)().ULS.traceTag(596456330,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getData('".concat(i,"') returned ").concat(s.length," characters"))}catch(e){Object(o.kc)().ULS.traceTag(596456331,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getData with '".concat(i,"' threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}if(!r&&H()&&(V(),s===o.jb)){if($(e,o.Zb,void 0))return ge(e,void 0,!1).then((function(t){return t===o.jb?K():$(e,o.jb,void 0),Promise.resolve(s)}));K()}return Promise.resolve(s)}var fe={init:function(){},execCommandPaste:function(){var e;try{e=document.execCommand(o.E,!1,null)}catch(e){Object(o.kc)().ULS.traceTag(596456322,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand('".concat(o.E,"') threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}return void 0===e&&(e=!0),e},getData:function(e,t,r){var a=o.jb;try{var i=Q(t);if(!i||!Y(i))return Promise.resolve(a);if(e===o.Cb)return de(i);(a=i.getData(e))||(a=o.jb),Object(o.kc)().ULS.traceTag(596456323,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"getData('".concat(e,"') returned ").concat(a.length," characters"))}catch(t){Object(o.kc)().ULS.traceTag(596456324,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"getData with '".concat(e,"' threw an exception. This is a browser bug. Ignoring. Exception:: ").concat(n.utils.getStringifiedError(t)))}return Promise.resolve(a)},browserExtensionPaste:function(){return Promise.reject(new o.e(o.f.NoBrowserExtensionsInConfiguration))}},me={init:function(){},execCommandPaste:function(){if(X(),H()&&ge(o.hb,void 0,!1),!B())return Object(o.kc)().ULS.traceTag(596456325,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand - programmatic clipboard '".concat(o.E,"' access is not allowed in this session.")),!1;try{document.execCommand(o.E,!1,null)}catch(e){Object(o.kc)().ULS.traceTag(596456326,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"document.execCommand('".concat(o.E,"') threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}return!0},getData:ge,browserExtensionPaste:function(){return Promise.reject(new o.e(o.f.NoBrowserExtensionsInConfiguration))}},be={init:function(){!function(){var e=Ze().getChromeExtensionIds();if(0!==e.length){var t={command:"getAvailableCommands"};e.forEach((function(e){window.chrome.runtime.sendMessage(e,t,void 0,(function(t){var r=window.chrome.runtime.lastError;if(t&&Array.isArray(t)&&0!==t.length&&!r)se[e]=t;else{var a=o.jb;r&&"message"in r&&"string"==typeof r.message&&(a=r.message),Object(o.kc)().ULS.traceTag(589947074,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"chromeSystemClipboard - '".concat("getAvailableCommands","': browser extension '").concat(e,"' is not available. Error: ").concat(a))}}))}))}}()},execCommandPaste:function(){var e=!1;try{void 0===(e=document.execCommand(o.E,!1,null))&&(e=!0)}catch(e){Object(o.kc)().ULS.traceTag(596455698,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Chrome: document.execCommand('".concat(o.E,"') threw an exception. This is a browser bug. Ignoring. Exception: ").concat(e.message))}return e},getData:function(e,t,r){var a=o.jb;try{var i=Q(t);if(!i||!Y(i))return Promise.resolve(a);if(e===o.Cb)return de(i);(a=i.getData(e))||(a=o.jb),Object(o.kc)().ULS.traceTag(596455699,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Chrome: getData('".concat(e,"') returned ").concat(a.length," characters"))}catch(t){Object(o.kc)().ULS.traceTag(596455700,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"Chrome: getData with '".concat(e,"' threw an exception. This is a browser bug. Ignoring. Exception:: ").concat(n.utils.getStringifiedError(t)))}return Promise.resolve(a)},browserExtensionPaste:function(){return le()}},he=void 0;function ye(){return void 0===he&&(he=ce()?be:fe),he}Object(o.Mb)()&&(he=me);var Se,Ce=r(16),ve=function(e,t){if(we(e))e.replaceChildren(t);else{for(;e.firstChild;)e.removeChild(e.firstChild);Ee(e,t)}},Ee=function(e,t){if(Le(e))e.append(t);else if("string"==typeof t){var r=document.createTextNode(t);e.appendChild(r)}else e.appendChild(t)},we=function(e){return!!e.replaceChildren},Le=function(e){return!!e.append};function Te(){var e=document.getSelection();if(e&&e.getRangeAt&&"function"==typeof e.getRangeAt&&!(e.rangeCount<1))return e.getRangeAt(0)}function _e(e,t,r){void 0===r&&(r=void 0),Object(o.kc)().ULS.shipAssertTag(596444114,n.LogCategory.msoulscat_ES_EWAJS,!1===t&&!r||!0===t&&(!!r||r===o.jb),"enableClipboardEvents: useTextHtmlContentCandidate = '".concat(t,"', textHtmlContentCandidate is ").concat(r||r===o.jb?o.jb:"not ","provided"));var a=document.activeElement&&document.activeElement.id;a||Object(o.kc)().ULS.traceTag(595719625,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"hiddenContentEditableDiv.enableClipboardEvents: activeElementIdToRestore must to be define");var i=function(e,t){var r=Ae();r&&r.tagName&&"div"!==r.tagName.toLowerCase()&&(r.parentElement&&r.parentElement.removeChild(r),r=void 0);r||(r=function(){var e=document.createElement("div");return function(e){e.id="ccpContentEditable",e.contentEditable="true",xe()&&(e.contentEditable="false");e.spellcheck=!1,e.setAttribute("autocomplete","off"),e.setAttribute("autocorrect","off"),e.setAttribute("autocapitalize","off"),e.setAttribute("aria-hidden","true"),e.tabIndex=-1,e.style.display="inline-block",e.style.position="absolute",e.style.fontSize="10",e.style.height="0px",e.style.width="0px",e.style.top="0px",e.style.left="0px",e.style.zIndex="-100",e.style.overflow="hidden",e.onmousemove=function(){e.onmousemove=null,Object(o.kc)().ULS.assertTag(595957699,n.LogCategory.msoulscat_ES_EWAJS,!1,"contentEditableElement.onmousemove: Mouse move event is not expected on element '".concat("ccpContentEditable","'. it should be covered by other elements"))}}(e),document.body.appendChild(e),e}());if(Object(o.Mb)()){var a=t;e?a||(a=o.jb):a=je().outerHTML,r.innerHTML=Ce.sanitize(a)}else ve(r,e?null!=t?t:o.jb:je());return r}(t,r);a&&a===i.id&&(a=void 0),i.focus();var s=document.getSelection();if(s){s.removeAllRanges();var c=document.createRange();c.selectNodeContents(i),s.addRange(c)}return e&&Ie(!0),a}function Ie(e){if(xe()){var t=Ae();t&&(t.contentEditable=e?"true":"false")}}function Oe(){var e=Ae();if(!e)return!1;try{var t=e.clientLeft+e.scrollWidth/2,r=e.clientTop+e.scrollTop/2,a=document.elementFromPoint(t,r);return!!a&&(a.id===e.id||!!a.parentElement&&a.parentElement.id===e.id)}catch(e){return Object(o.kc)().ULS.traceTag(595957534,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"isContentEditableElementVisibleToUser: hit test failed with error: ".concat(n.utils.getStringifiedError(e))),!1}}function Ae(){return document.getElementById("ccpContentEditable")}function Pe(){var e=Ae();e&&(Object(o.Mb)()?e.innerHTML=Ce.sanitize(je().outerHTML):ve(e,je()))}function je(){var e=document.createElement("span");return e.innerText=o.Yb,e}function xe(){return!Object(o.Mb)()}var De=function(e,t){return void 0===t&&(t=!1),Se?Se.getBooleanFeatureGate(e,t):t};var Me=function(){function e(e){this.lastDeferredCutCopyPromise=void 0,this.removeLastCutCopyEventListenerCallback=void 0,this.lastDeferredPastePromise=void 0,this.selectedRangeToRestore=void 0,this.removeLastPasteEventListenerCallback=void 0,this.activeElementIdToRestore=void 0,this.skipFilesIfPlainTextExists=e,this.clipboardStorageType=o.g.SystemClipboard,this.disposableImplementationExtension=Object(o.X)("SystemClipboardStorage"),ye().init()}return e.prototype.get=function(e){var t=this;if(this.disposableImplementationExtension.throwIfDisposed("get"),Object(o.kc)().ULS.traceTag(596449096,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.get: isKeyboardEvent = '".concat(e.isKeyboardEvent,"'")),e.skipSystemClipboardAccess){Object(o.kc)().ULS.traceTag(596124883,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.get: Skipping system clipboard access");var r=Object(o.P)(document,o.F,(function(e){return t.skipSystemClipboardPasteHandler(e,r)}),!0);return this.removeLastPasteEventListenerCallback=r,Promise.resolve(Object(o.sb)())}if(this.lastDeferredPastePromise&&!this.lastDeferredPastePromise.fulfilled()){var a=this.lastDeferredPastePromise,i="There exists a pending deferred promise with id '".concat(a.id,"', representing an active ").concat(o.E," event. Scheduling a rejection to execute after the current operation.");Object(o.kc)().ULS.traceTag(596455680,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,i),window.setTimeout((function(){a.reject(new o.e(o.f.RejectingPendingPastePromiseDueToNewPasteOperation,i))}),0)}this.clearPasteCallbackConfiguration(this.lastDeferredPastePromise,!0,!1);var s=Object(o.V)();this.lastDeferredPastePromise=s;var c=s.id,d=Object(o.P)(document,o.F,(function(r){return t.pasteHandler(r,s,e.isKeyboardEvent,d)}),!0);this.removeLastPasteEventListenerCallback=d,this.selectedRangeToRestore=Te(),this.activeElementIdToRestore=_e(!0,!1);try{var u=!1;if(e.isKeyboardEvent||(u=ye().execCommandPaste()),e.isKeyboardEvent);else if(!u)return this.clearPasteCallbackConfiguration(s,!0,!0),e.isAsyncSystemClipboardEnabled&&De("Microsoft.Office.Excel.EnableAsyncClipboardApiWithExtensionRemoval",!1)?Promise.reject(new o.e(o.f.ClipboardIsInaccessible,"Reject the Promise if not keyboard event in SystemClipboardStorage.get. Deferred promise id = '".concat(c,"'"))):ye().browserExtensionPaste().then((function(r){return Object(l.isChangeGateEnabled)("OfficeVSO:8362261_IsChromiumExtPasteTelemetryEnabled")&&(e.isChromiumExtension=!0),e.clearSystemClipboard&&t.clearSystemClipboard(),r}),(function(r){return!(e.isAsyncSystemClipboardEnabled&&Object(l.isChangeGateEnabled)("OfficeVSO:8708189_IsAsyncClipboardApiCutPasteFixEnabled"))&&e.clearSystemClipboard&&t.clearSystemClipboard(),Promise.reject(new o.e(o.f.ClipboardIsInaccessible,"document.execCommand(".concat(o.E,") failed in SystemClipboard.get. Deferred promise id = '").concat(c,"'"),r))}))}catch(e){return this.clearPasteCallbackConfiguration(s,!0,!1),Promise.reject(new o.e(o.f.GetClipboardItems,"Failed in SystemClipboard.get. Deferred promise id = '".concat(c,"'"),e))}return s.promise.then((function(r){return e.clearSystemClipboard&&t.clearSystemClipboard(),r}),(function(r){return e.clearSystemClipboard&&t.clearSystemClipboard(),Object(o.Hb)(r,o.f.RejectingPendingPastePromiseDueToNewPasteOperation)?Promise.reject(r):Promise.reject(new o.e(o.f.GetClipboardItems,"Failed in SystemClipboard.get. Deferred promise id = '".concat(c,"'"),r))}))},e.prototype.set=function(t,r){var a=this;if(this.disposableImplementationExtension.throwIfDisposed("set"),Object(o.kc)().ULS.traceTag(596449097,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.set: isKeyboardEvent = '".concat(r.isKeyboardEvent,"'; cutCopyPasteFlags = '").concat(r.commandType,"'")),Object(o.kc)().ULS.shipAssertTag(595932513,n.LogCategory.msoulscat_ES_EWAJS,!r.skipSystemClipboardAccess,"SystemClipboardStorage.set: skipSystemClipboardAccess shouldn't be used using set of SystemClipboardStorage as we have to set the timestamp metadata in the html in order to support last copy item scenario. "),Object(o.Mb)()&&!r.isKeyboardEvent){if(r.silentClipboardAccessFailures&&H())return Object(o.kc)().ULS.traceTag(596455681,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Aborting attempt to store content in the clipboard since silentClipboardAccessFailures is on and the user did not select Allow access in IE's clipboard access dialog"),Promise.resolve();if(!H()&&!B())return Object(o.kc)().ULS.traceTag(596455682,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Aborting attempt to store content in the clipboard since the user selected Dont Allow in IE's clipboard access dialog. Use the active selection."),Promise.resolve()}if(this.lastDeferredCutCopyPromise&&!this.lastDeferredCutCopyPromise.fulfilled()){var i=this.lastDeferredCutCopyPromise,s="There exists a pending deferred promise with id '".concat(i.id,"', representing an active ").concat(o.p,"/").concat(o.j," event. Scheduling a rejection to execute after the current operation.");Object(o.kc)().ULS.traceTag(596455683,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,s),window.setTimeout((function(){i.reject(new o.e(r.isKeyboardEvent?o.f.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation:o.f.RejectingBlockedSyncCutCopyPromise,s))}),0)}this.clearCutCopyCallbackConfiguration(this.lastDeferredCutCopyPromise,!0,!1);var c=Object(o.V)();this.lastDeferredCutCopyPromise=c;var l=c.id;try{var d=Object(o.tb)(t),u=e.getClipboardCutCopyEventType(r.commandType),p=Object(o.P)(document,u,(function(e){r.isTimestampStoredInSystemClipboard=!0,a.cutCopyHandler(e,c,d,r.isKeyboardEvent,r.commandType,p)}));this.removeLastCutCopyEventListenerCallback=p;var g=o.jb;Object(o.Mb)()&&(g=Object(o.lb)(d,o.jc)),this.selectedRangeToRestore=Te(),this.activeElementIdToRestore=_e(!1,!!g,g);var f=!1;if(Object(o.Mb)()&&r.isKeyboardEvent||(f=r.commandType===o.r.Cut?ne().execCommandCut():ne().execCommandCopy()),r.isKeyboardEvent);else if(!f)return this.clearCutCopyCallbackConfiguration(c,!0,!0),!Object(o.Mb)()||H()||B()||(Object(o.kc)().ULS.traceTag(596455684,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Aborting attempt to store content in the clipboard since the user selected Dont Allow in IE's clipboard access dialog. Use the active selection. Deferred promise id = '".concat(l,"'")),c.resolve()),Promise.resolve()}catch(e){return this.clearCutCopyCallbackConfiguration(c,!0,!1),Promise.reject(new o.e(o.f.SetClipboardItems,"Failed in SystemClipboard.set. Deferred promise id = '".concat(l,"'"),e))}return c.promise.catch((function(e){return e&&Object(o.Ib)(e,[o.f.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation,o.f.RejectingBlockedSyncCutCopyPromise])?Promise.reject(e):Promise.reject(new o.e(o.f.SetClipboardItems,"Failed in SystemClipboard.set. Deferred promise id = '".concat(l,"'"),e))}))},e.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[o.hb,o.jc,o.Cb]},e.prototype.cutCopyHandler=function(e,t,r,a,i,s){var c=this;try{if(Object(o.kc)().ULS.traceTag(596449098,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.cutCopyHandler: isKeyboardEvent = '".concat(a,"'; cutCopyPasteFlags = '").concat(i,"'; bubbles = '").concat(e.bubbles,"'; eventPhase = '").concat(e.eventPhase,"'")),s(),this.removeLastCutCopyEventListenerCallback===s&&(this.removeLastCutCopyEventListenerCallback=void 0),this.disposableImplementationExtension.logIfDisposed("cutCopyHandler"))return;if(Object(o.kc)().ULS.shipAssertTag(596455686,n.LogCategory.msoulscat_ES_EWAJS,!!t,"SystemClipboardStorage.cutCopyHandler: the deferred promise parameter is missing. isKeyboardEvent = '".concat(a,"'; cutCopyPasteFlags = '").concat(i,"'")),!t)return;if(Object(o.kc)().ULS.traceTag(596455687,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.cutCopyHandler: isKeyboardEvent = '".concat(a,"'; cutCopyPasteFlags = '").concat(i,"'; deferred promise id = '").concat(t.id,"'")),Object(o.kc)().ULS.shipAssertTag(596455688,n.LogCategory.msoulscat_ES_EWAJS,!t.fulfilled(),"SystemClipboardStorage.cutCopyHandler: deferred promise '".concat(t.id,"' is already fulfilled. isKeyboardEvent = '").concat(a,"'; cutCopyPasteFlags = '").concat(i,"'")),t.fulfilled())return;var l=function(){t.resolve(),c.clearCutCopyCallbackConfiguration(t,!1,!1)},d=Object(o.lb)(r,o.jc);if(d&&Object(o.Mb)())window.setTimeout(l,0);else{d&&oe(o.jc,d,e,a);var u=Object(o.pb)(r);oe(ne().defaultClipboardDataFormat,u,e,a),e.preventDefault(),l()}}catch(e){this.clearCutCopyCallbackConfiguration(t,!1,!1),Object(o.kc)().ULS.traceTag(596455689,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"SystemClipboardStorage.cutCopyHandler callback with deferred promise id '".concat(t?t.id:o.jb,"' (fulfilled = '").concat(t?t.fulfilled():o.jb,"') failed with this exception: ").concat(e&&e.message?e.message:"NA",". Call stack: ").concat(e.stack?e.stack:"NA")),t&&t.reject(new o.e(o.f.SetClipboardItems,"Failed in SystemClipboard.set > cutCopyHandler callback. Deferred promise id = '".concat(t.id,"'. Error: ").concat(e&&e.message?e.message:"NA"),e))}},e.prototype.pasteHandler=function(e,t,r,a){var i=this,s=!0;try{if(Object(o.kc)().ULS.traceTag(596449099,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.pasteHandler: isKeyboardEvent = '".concat(r,"'; eventPhase='").concat(e.eventPhase,"'")),e.preventDefault(),a(),this.removeLastPasteEventListenerCallback===a&&(this.removeLastPasteEventListenerCallback=void 0),this.disposableImplementationExtension.logIfDisposed("pasteHandler"))return;if(Object(o.kc)().ULS.shipAssertTag(596455690,n.LogCategory.msoulscat_ES_EWAJS,!!t,"SystemClipboardStorage.pasteHandler: the deferred promise parameter is missing. isKeyboardEvent = '".concat(r,"'")),!t)return;if(Object(o.kc)().ULS.traceTag(596455691,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.pasteHandler: isKeyboardEvent = '".concat(r,"'; deferred promise id = '").concat(t.id,"'")),Object(o.kc)().ULS.shipAssertTag(596455692,n.LogCategory.msoulscat_ES_EWAJS,!t.fulfilled(),"SystemClipboardStorage.pasteHandler: deferred promise '".concat(t.id,"' is already fulfilled. isKeyboardEvent = '").concat(r,"'")),t.fulfilled())return;var c=Object(o.R)(),l=this.getSupportedDataFormats(),d=this.readDataFormats(l,e,r,c);Promise.all(d).then((function(){e.stopPropagation(),s=!1,Object(o.Mb)()?window.setTimeout((function(){var e,r=document.getElementById("ccpContentEditable");if(r&&r.firstChild&&"IMG"===r.firstChild.nodeName){var a=r.firstChild;a&&a.src&&a.src.indexOf("base64")>-1?c.setItem(o.Cb,a.src):Object(o.kc)().ULS.traceTag(595907107,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.pasteHandler: IE has provided the IMG HTML rather than the image blob, which is unsupported.")}else c.setItem(o.jc,(e=Ae(),Object(o.kc)().ULS.shipAssertTag(596444113,n.LogCategory.msoulscat_ES_EWAJS,!!e,"getTextHtmlContent: the content editable element does not exist"),e?Ce.sanitize(e.innerHTML):o.jb)),o.Bb.isContainsTimestampWrapper(r)&&c.setItem(o.hb,o.Bb.createPlainTextFromHtml(r));Pe(),t.resolve(c),i.clearPasteCallbackConfiguration(t,!1,!1)}),0):(Pe(),t.resolve(c),i.clearPasteCallbackConfiguration(t,!1,!1))}))}catch(r){Pe();try{s&&e.stopPropagation()}catch(e){Object(o.kc)().ULS.traceTag(595985030,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Error,"SystemClipboardStorage.pasteHandler: failed when performing stopPropagation/preventDefault on the raw event. Failed with an exception: ".concat(n.utils.getStringifiedError(e)))}this.clearPasteCallbackConfiguration(t,!1,!1),Object(o.kc)().ULS.traceTag(596455693,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"SystemClipboardStorage.pasteHandler callback with deferred promise id '".concat(t?t.id:o.jb,"' (fulfilled = '").concat(t?t.fulfilled():o.jb,"') failed with an exception: ").concat(r&&r.message?r.message:"NA",". Call stack: ").concat(r.stack?r.stack:"NA")),t&&t.reject(new o.e(o.f.GetClipboardItems,"Failed in SystemClipboard.get > pasteHandler callback. Deferred promise id = '".concat(t.id,"'. Error: ").concat(r&&r.message?r.message:"NA"),r))}},e.prototype.isFileFormat=function(e){return e===o.Cb},e.prototype.isPlainTextEmpty=function(e){var t=e.getItem("text/plain");return!t||0===t.length},e.prototype.readDataFormats=function(e,t,r,a){var i=this;if(!this.skipFilesIfPlainTextExists||!r&&Object(o.Gb)())return this.readDataFormatsInternal(e,t,r,a);var s=e.filter((function(e){return i.isFileFormat(e)}));if(0===s.length)return this.readDataFormatsInternal(e,t,r,a);var c=e.filter((function(e){return!i.isFileFormat(e)})),l=this.readDataFormatsInternal(c,t,r,a);return[Promise.all(l).then((function(){if(!i.isPlainTextEmpty(a))return Object(o.kc)().ULS.traceTag(595653317,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.readDataFormats: skip files loading because clipboard contains plain text"),Promise.resolve();var e=i.readDataFormatsInternal(s,t,r,a);return Promise.all(e)}))]},e.prototype.readDataFormatsInternal=function(e,t,r,a){var i=[];return e.forEach((function(e){i.push(function(e,t,r){return ye().getData(e,t,r)}(e,t,r).then((function(t){Object(o.kc)().ULS.traceTag(541646989,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.readDataFormatsInternal: Read "+e+" from clipboard"),a.setItem(e,t)})).catch((function(t){Object(o.kc)().ULS.traceTag(595653318,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Error,"SystemClipboardStorage.readDataFormatsInternal: Failed to get data of type [".concat(e,"]. Error [").concat(n.utils.getStringifiedError(t),"]"))})))})),i},e.prototype.skipSystemClipboardPasteHandler=function(e,t){try{t(),e.stopPropagation(),e.preventDefault()}catch(e){Object(o.kc)().ULS.traceTag(595993058,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"SystemClipboardStorage.skipSystemClipboardPasteHandler: failed with an exception: ".concat(e&&e.message?e.message:"NA",". Call stack: ").concat(e.stack?e.stack:"NA"))}this.removeLastPasteEventListenerCallback===t&&(this.removeLastPasteEventListenerCallback=void 0)},e.prototype.hasPlainText=function(e){return!!e&&Object.keys(e.getData().items).indexOf(o.hb)>-1},e.prototype.dispose=function(){var e=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(Object(o.ec)([function(){e.lastDeferredCutCopyPromise&&!e.lastDeferredCutCopyPromise.fulfilled()&&(e.lastDeferredCutCopyPromise.reject(),e.lastDeferredCutCopyPromise=void 0,e.removeLastCutCopyEventListenerCallback&&(e.removeLastCutCopyEventListenerCallback(),e.removeLastCutCopyEventListenerCallback=void 0))},function(){e.lastDeferredPastePromise&&!e.lastDeferredPastePromise.fulfilled()&&(e.lastDeferredPastePromise.reject(),e.lastDeferredPastePromise=void 0,e.removeLastPasteEventListenerCallback&&(e.removeLastPasteEventListenerCallback(),e.removeLastPasteEventListenerCallback=void 0))}]),this.disposableImplementationExtension.dispose())},e.getClipboardCutCopyEventType=function(e){if(!e)return o.k;if(e===o.r.Copy)return o.k;if(e===o.r.Cut)return o.q;throw new o.t(o.jb,"cutCopyPasteFlags",e.toString())},e.prototype.restoreFocusToPreviouslyActiveElement=function(){if(this.activeElementIdToRestore){var e=document.getElementById(this.activeElementIdToRestore);e&&e.focus(),this.activeElementIdToRestore=void 0}},e.prototype.restoreSelection=function(){this.selectedRangeToRestore&&(!function(e){if(void 0===e&&(e=void 0),e){var t=document.getSelection();t&&t.removeAllRanges&&"function"==typeof t.removeAllRanges&&t.addRange&&"function"==typeof t.addRange&&(t.removeAllRanges(),t.addRange(e))}}(this.selectedRangeToRestore),this.selectedRangeToRestore=void 0)},e.prototype.clearCutCopyCallbackConfiguration=function(e,t,r){this.restoreFocusToPreviouslyActiveElement(),this.restoreSelection(),Object(o.kc)().ULS.shipAssertTag(595957697,n.LogCategory.msoulscat_ES_EWAJS,!Oe(),"SystemClipboardStorage.set: ccpContentEditable is visible to the user during a copy/cut operation, but it should not be visible."),(e===this.lastDeferredCutCopyPromise||e&&this.lastDeferredCutCopyPromise&&e.id===this.lastDeferredCutCopyPromise.id)&&(this.lastDeferredCutCopyPromise=void 0),t&&this.removeLastCutCopyEventListenerCallback&&(r||Object(o.kc)().ULS.traceTag(596449290,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"SystemClipboardStorage.set: the ".concat(o.p,"/").concat(o.j," event listener was not called. Calling removeLastCutCopyEventListenerCallback()")),this.removeLastCutCopyEventListenerCallback(),this.removeLastCutCopyEventListenerCallback=void 0)},e.prototype.clearPasteCallbackConfiguration=function(e,t,r){this.restoreFocusToPreviouslyActiveElement(),this.restoreSelection(),Ie(!1),Object(o.kc)().ULS.shipAssertTag(595957698,n.LogCategory.msoulscat_ES_EWAJS,!Oe(),"SystemClipboardStorage.clearPasteCallbackConfiguration: ccpContentEditable is visible to the user during a paste operation, but it should not be visible"),(e===this.lastDeferredPastePromise||e&&this.lastDeferredPastePromise&&e.id===this.lastDeferredPastePromise.id)&&(this.lastDeferredPastePromise=void 0),t&&this.removeLastPasteEventListenerCallback&&(r||Object(o.kc)().ULS.traceTag(596449291,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"SystemClipboardStorage.get: the ".concat(o.E," event listener was not called. Calling removeLastPasteEventListenerCallback()")),this.removeLastPasteEventListenerCallback(),this.removeLastPasteEventListenerCallback=void 0)},e.prototype.clearSystemClipboard=function(){var e=Object(o.sb)(),t={isKeyboardEvent:!1,commandType:o.r.Copy};this.set(e,t).then((function(){Object(o.kc)().ULS.traceTag(595935906,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.clearSystemClipboard: clear system clipboard succeed")}),(function(){Object(o.kc)().ULS.traceTag(595935907,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"SystemClipboardStorage.clearSystemClipboard: clear system clipboard failed")}))},e}(),We=function(e){function t(t){return e.call(this,o.i.InMemory,{browserStorage:!1,systemClipboard:!1,inMemory:!0},t)||this}return Object(c.__extends)(t,e),t}(o.h),ke=function(){function e(){this.clipboardStorageType=o.g.InMemory,this.disposableImplementationExtension=Object(o.X)("InMemoryClipboardStorage")}return e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.inMemoryClipboardItems=void 0,this.disposableImplementationExtension.dispose())},e.prototype.get=function(e){return this.disposableImplementationExtension.throwIfDisposed("get"),this.inMemoryClipboardItems?Promise.resolve(this.inMemoryClipboardItems):Promise.resolve(Object(o.sb)())},e.prototype.set=function(e,t){return this.disposableImplementationExtension.throwIfDisposed("set"),this.inMemoryClipboardItems=e,Promise.resolve()},e.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[o.hb,o.jc,"data/shadow-workbook"]},e}(),Re=function(e){function t(t){return e.call(this,o.i.LocalStorage,{browserStorage:!0,systemClipboard:!1,inMemory:!1},t)||this}return Object(c.__extends)(t,e),t}(o.h),Ue=function(){function e(e,t,r,a){this.clipboardStrategyType=e,this.clipboardCapabilities=t,this._fullAccessClipboardStrategyType=r,this.dualClipboardDataProcessor=a,this.initialized=!1,this.clipboardStrategyType=e,this.clipboardCapabilities=t,this.disposableImplementationExtension=Object(o.X)("".concat(e))}return e.prototype.initialize=function(e,t){var r=this;return this.initialized=!1,this.systemClipboardStrategy=void 0,this.fullAccessClipboardStrategy=void 0,e.then((function(e){return r.systemClipboardStrategy=e,t.then((function(e){return r.fullAccessClipboardStrategy=e,r.initialized=!0,Promise.resolve(r)}))}))},e.prototype.set=function(e,t){var r=this;try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.initialized||!this.systemClipboardStrategy)return Promise.reject(new o.e(o.f.ClipboardStrategyNotInitialized));var a={systemClipboardOperationResult:Object(o.T)(o.Yb,"setresult",!1),fullAccessClipboardOperationResult:Object(o.T)(o.Yb,"setresult",!1)};return this.dualClipboardDataProcessor&&this.dualClipboardDataProcessor.preSetProcess(e),this.systemClipboardStrategy.set(e,t).then((function(){return Promise.resolve(a)}),(function(e){return a.systemClipboardOperationResult.failed=!0,a.systemClipboardOperationResult.clipboardOperationResultError=e,Object(o.Ib)(e,[o.f.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation,o.f.RejectingBlockedSyncCutCopyPromise])?Promise.reject(e):Promise.resolve(a)})).then((function(a){return r.fullAccessClipboardStrategy?r.fullAccessClipboardStrategy.set(e,t).then((function(){return Promise.resolve(a)}),(function(e){return Object(o.kc)().ULS.traceTag(595933078,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"Failed to save to fullAccessClipboardStrategy. clipboardStrategyType: '".concat(r.fullAccessClipboardStrategy&&r.fullAccessClipboardStrategy.clipboardStrategyType,"', Command Id: '").concat(t.id?t.id:o.jb,"', Error: ").concat(n.utils.getStringifiedError(e))),a.fullAccessClipboardOperationResult.failed=!0,a.fullAccessClipboardOperationResult.clipboardOperationResultError=e,Promise.resolve(a)})):(a.fullAccessClipboardOperationResult.failed=!0,Promise.resolve(a))})).then((function(e){if(e.systemClipboardOperationResult.failed&&e.fullAccessClipboardOperationResult.failed){var t=e.systemClipboardOperationResult.clipboardOperationResultError;return t||(t=e.fullAccessClipboardOperationResult.clipboardOperationResultError),t?Promise.reject(t):Promise.reject(new o.e(o.f.SetClipboardItems,o.jb))}return Promise.resolve()}))}catch(e){return Promise.reject(new o.e(o.f.SetClipboardItems,"Failed in system clipboard.set",e))}},e.prototype.get=function(e){var t=this;try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.initialized||!this.systemClipboardStrategy)return Promise.reject(new o.e(o.f.ClipboardStrategyNotInitialized));var r={systemClipboardOperationResult:Object(o.T)(o.Yb,"getresult",!1,void 0,Object(o.qb)()),fullAccessClipboardOperationResult:Object(o.T)(o.Yb,"getresult",!1,void 0,Object(o.qb)())};return this.systemClipboardStrategy.get(e).then((function(e){return r.systemClipboardOperationResult.clipboardItemsData=e.getData(),t.dualClipboardDataProcessor&&t.dualClipboardDataProcessor.postGetProcess(r.systemClipboardOperationResult),Promise.resolve(r)})).catch((function(a){return Object(o.kc)().ULS.traceTag(507904974,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"Failed to get data from systemClipboardStrategy. clipboardStrategyType: '".concat(t.systemClipboardStrategy&&t.systemClipboardStrategy.clipboardStrategyType,"', Command Id: '").concat(e.id?e.id:o.jb,"', Error: ").concat(n.utils.getStringifiedError(a))),r.systemClipboardOperationResult.failed=!0,r.systemClipboardOperationResult.clipboardOperationResultError=a,Object(o.Hb)(a,o.f.RejectingPendingPastePromiseDueToNewPasteOperation)?Promise.reject(a):Promise.resolve(r)})).then((function(r){return t.fullAccessClipboardStrategy?t.fullAccessClipboardStrategy.get(e).then((function(e){return r.fullAccessClipboardOperationResult.clipboardItemsData=e.getData(),t.dualClipboardDataProcessor&&t.dualClipboardDataProcessor.postGetProcess(r.fullAccessClipboardOperationResult),Promise.resolve(r)})).catch((function(a){return Object(o.kc)().ULS.traceTag(595933079,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"Failed to get from fullAccessClipboardStrategy. clipboardStrategyType: '".concat(t.fullAccessClipboardStrategy&&t.fullAccessClipboardStrategy.clipboardStrategyType,"', Command Id: '").concat(e.id?e.id:o.jb,"', Error: ").concat(n.utils.getStringifiedError(a))),r.fullAccessClipboardOperationResult.failed=!0,r.fullAccessClipboardOperationResult.clipboardOperationResultError=a,Promise.resolve(r)})):(r.fullAccessClipboardOperationResult.failed=!0,Promise.resolve(r))})).then((function(r){if(r.systemClipboardOperationResult.failed||e.skipSystemClipboardAccess){if(r.fullAccessClipboardOperationResult.failed){var a=r.systemClipboardOperationResult.clipboardOperationResultError;return a||(a=r.fullAccessClipboardOperationResult.clipboardOperationResultError),a?Promise.reject(a):Promise.reject(new o.e(o.f.GetClipboardItems,o.jb))}return 0===Object(o.ob)(r.fullAccessClipboardOperationResult.clipboardItemsData)?Promise.reject(r.systemClipboardOperationResult.clipboardOperationResultError):t.validateAndReturnFullAccessData(r)}return r.fullAccessClipboardOperationResult.failed?Promise.resolve(Object(o.R)(r.systemClipboardOperationResult.clipboardItemsData)):function(){if(Object(o.Jb)()&&!Object(o.Lb)())return!0;return!1}()?t.pasteSourceReconciliationBasedOnlyOnTextPlain(r):t.pasteSourceReconciliation(r,e)}))}catch(e){return Promise.reject(new o.e(o.f.GetClipboardItems,"Failed in system clipboard.get",e))}},e.prototype.onSystemClipboardChangedExternally=function(e){try{return this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),this.initialized?this.fullAccessClipboardStrategy?this.fullAccessClipboardStrategy.onSystemClipboardChangedExternally(e):(Object(o.kc)().ULS.shipAssertTag(595882509,n.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.onSystemClipboardChangedExternally: this.fullAccessClipboardStrategy should be defined"),Promise.reject(new o.e(o.f.ClipboardStrategyNotInitialized))):Promise.reject(new o.e(o.f.ClipboardStrategyNotInitialized))}catch(e){return Promise.reject(new o.e(o.f.ClearClipboardItems,"Failed in (clipboard ".concat(this.clipboardStrategyType,").onSystemClipboardChangedExternally"),e))}},e.prototype.dispose=function(){var e=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(Object(o.ec)([function(){e.systemClipboardStrategy&&e.systemClipboardStrategy.dispose()},function(){e.fullAccessClipboardStrategy&&e.fullAccessClipboardStrategy.dispose()}]),this.disposableImplementationExtension.dispose())},e.prototype.pasteSourceReconciliation=function(e,t){var r=void 0;e.systemClipboardOperationResult.signatureData&&(r=e.systemClipboardOperationResult.signatureData.ccp_infra_timestamp);var a=void 0;return e.fullAccessClipboardOperationResult.signatureData&&(a=e.fullAccessClipboardOperationResult.signatureData.ccp_infra_timestamp),Object(o.kc)().ULS.traceTag(595719624,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"systemClipboardAndFullAccessClipboardStrategy.pasteSourceReconciliation: ccpTimestampInSystemClipboard=".concat(r," ccpTimestampInFullAccessClipboard=").concat(a)),r?r>(a||0)?(Fe(e.systemClipboardOperationResult.clipboardItemsData,!0),Promise.resolve(Object(o.R)(e.systemClipboardOperationResult.clipboardItemsData))):Promise.resolve(Object(o.R)(e.fullAccessClipboardOperationResult.clipboardItemsData)):t.isTimestampStoredInSystemClipboard?Ne(e)?Promise.resolve(Object(o.R)(e.fullAccessClipboardOperationResult.clipboardItemsData)):Je(e)?this.validateAndReturnFullAccessData(e):(Fe(e.systemClipboardOperationResult.clipboardItemsData,!1),Promise.resolve(Object(o.R)(e.systemClipboardOperationResult.clipboardItemsData))):this.validateAndReturnFullAccessData(e)},e.prototype.validateAndReturnFullAccessData=function(e){return this.dualClipboardDataProcessor&&this.dualClipboardDataProcessor.validateUserHash(e.fullAccessClipboardOperationResult.signatureData),Promise.resolve(Object(o.R)(e.fullAccessClipboardOperationResult.clipboardItemsData))},e.prototype.pasteSourceReconciliationBasedOnlyOnTextPlain=function(e){return 0===Object(o.ob)(e.systemClipboardOperationResult.clipboardItemsData)||0===Object(o.ob)(e.fullAccessClipboardOperationResult.clipboardItemsData)?Promise.resolve(Object(o.R)(e.systemClipboardOperationResult.clipboardItemsData)):Ne(e)?Promise.resolve(Object(o.R)(e.fullAccessClipboardOperationResult.clipboardItemsData)):Je(e)?this.validateAndReturnFullAccessData(e):(e.systemClipboardOperationResult.clipboardItemsData.items[o.Ub]=o.Wb,Promise.resolve(Object(o.R)(e.systemClipboardOperationResult.clipboardItemsData)))},e}();function Fe(e,t){e.items[o.Ub]=o.Wb,t&&(e.items[o.Vb]=o.Xb)}function Ne(e){var t=e.systemClipboardOperationResult.clipboardItemsData.items[o.hb],r=o.Bb.ensureOneLFPerNewLine(o.Bb.trimToLength(t)),a=e.fullAccessClipboardOperationResult.clipboardItemsData.items[o.hb];return!!a&&r===o.Bb.ensureOneLFPerNewLine(o.Bb.trimToLength(a))}function Je(e){var t=e.systemClipboardOperationResult.clipboardItemsData.items[o.hb];return o.Bb.ensureOneLFPerNewLine(o.Bb.trimToLength(t))===Ze().getCopyToClipboardLatencyMessage()}var ze=function(e){function t(t){return e.call(this,o.i.SystemClipboardAndLocalStorage,{browserStorage:!0,systemClipboard:!0,inMemory:!1},o.i.LocalStorage,t)||this}return Object(c.__extends)(t,e),t}(Ue),He=function(e){function t(t){return e.call(this,o.i.SystemClipboardAndInMemory,{browserStorage:!1,systemClipboard:!0,inMemory:!0},o.i.InMemory,t)||this}return Object(c.__extends)(t,e),t}(Ue),Ve=function(e){function t(t){return e.call(this,o.g.LocalStorage,t)||this}return Object(c.__extends)(t,e),t}(function(e){function t(t,r){var a=e.call(this)||this;if(a.messageDestination=r,!r)throw new o.B(o.jb,"messageDestination");return a.clipboardStorageType=t,a.disposableImplementationExtension=Object(o.X)(r),a}return Object(c.__extends)(t,e),t.prototype.initialize=function(){var e=this;return this.innerInitialize().then((function(){return e}))},t.prototype.get=function(e){this.disposableImplementationExtension.throwIfDisposed("get"),Object(o.kc)().ULS.traceTag(595947538,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"ClipboardStorageIframeProxy.get: isKeyboardEvent = ".concat(e.isKeyboardEvent,"; silentClipboardAccessFailures = ").concat(e.silentClipboardAccessFailures||!1));var t=Object(o.S)(Object(o.bb)(),"get",this.messageDestination,e.userHash);return this.postMessage(t,"get").then((function(e){return e.clipboardItemsData?Promise.resolve(Object(o.R)(e.clipboardItemsData)):Promise.resolve(Object(o.sb)())}))},t.prototype.set=function(e,t){var r;return this.disposableImplementationExtension.throwIfDisposed("set"),Object(o.kc)().ULS.traceTag(595947541,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"ClipboardStorageIframeProxy.set: isKeyboardEvent = ".concat(t.isKeyboardEvent,"; silentClipboardAccessFailures = ").concat(t.silentClipboardAccessFailures||!1)),r=Object(o.nb)(e)>0?Object(o.S)(Object(o.bb)(),"set",this.messageDestination,t.userHash,e.getData()):Object(o.S)(Object(o.bb)(),"set",this.messageDestination),this.postMessage(r,"set").then((function(){}))},t.prototype.clearClipboardNecessary=function(e,t){return Object(o.ic)(e,t)},t.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[o.hb,o.jc,"data/shadow-workbook"]},t.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},t}(U)),Ge=function(e){function t(t){return e.call(this,o.i.AsyncSystemClipboard,{browserStorage:!1,systemClipboard:!0,inMemory:!1},t)||this}return Object(c.__extends)(t,e),t}(o.h),Be=function(){function e(){this.initialClipboardPermissionState=null,this.isActionPerformedOnPermissionPrompt=!1,this.webCustomFormatPrefix="web ",this.emptyClipboardReadErrorName="DataError",this.emptyClipboardReadErrorMessage="No valid data on clipboard.",this.clipboardPermissionDeniedErrorMessage="AsyncSystemClipboardStorage - Clipboard permission is denied",this.clipboardIsInaccessibleError=new o.e(o.f.ClipboardIsInaccessible,this.clipboardPermissionDeniedErrorMessage),this.clipboardStorageType=o.g.AsyncSystemClipboard,this.disposableImplementationExtension=Object(o.X)("AsyncSystemClipboardStorage")}return e.prototype.get=function(e){var t;return Object(c.__awaiter)(this,void 0,void 0,(function(){var r,a,i,s,l,d,u,p,g,f,m,b,h,y,S,C,v,E,w,L=this;return Object(c.__generator)(this,(function(c){switch(c.label){case 0:if(this.disposableImplementationExtension.throwIfDisposed("get"),e.isAsyncClipboardAPI=!0,r=window.performance.now(),a=De("Microsoft.Office.Excel.EnableAsyncClipboardApiReadSW",!1),e.skipSystemClipboardAccess)return[2,Promise.resolve(Object(o.sb)())];i=this.getSupportedDataFormats(),s=Object(o.R)(),c.label=1;case 1:c.trys.push([1,17,18,21]),l={name:"clipboard-read",allowWithoutGesture:!1},c.label=2;case 2:return c.trys.push([2,4,,5]),[4,null===(t=navigator.permissions)||void 0===t?void 0:t.query(l)];case 3:if(d=c.sent(),Object(o.kc)().ULS.traceTag(507626376,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"AsyncSystemClipboardStorage.get - Clipboard read permission state: ".concat(null==d?void 0:d.state,". Command id: ").concat(e.id)),this.initialClipboardPermissionState=null==d?void 0:d.state,"denied"===(null==d?void 0:d.state))throw this.clipboardIsInaccessibleError;return"prompt"===(null==d?void 0:d.state)&&(this.isActionPerformedOnPermissionPrompt=!1,d.onchange=function(){L.isActionPerformedOnPermissionPrompt=!0,"denied"===(null==d?void 0:d.state)?Object(o.kc)().ULS.traceTag(507626375,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"AsyncSystemClipboardStorage.get - Clipboard read permission is denied from prompt. Command id: ".concat(e.id)):"granted"===(null==d?void 0:d.state)&&Object(o.kc)().ULS.traceTag(507626374,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"AsyncSystemClipboardStorage.get - Clipboard read permission is granted from prompt. Command id: ".concat(e.id))}),[3,5];case 4:if((u=c.sent())===this.clipboardIsInaccessibleError)throw u;return Object(o.kc)().ULS.traceTag(508651269,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,'AsyncSystemClipboardStorage.get: Failed to query "clipboard-read" permission. Command id: '.concat(e.id,", Error: ").concat(n.utils.getStringifiedError(u))),[3,5];case 5:return[4,navigator.clipboard.read({unsanitized:[o.jc]})];case 6:if(!(p=c.sent())||p.length<1)return[2,s];g=0,f=p,c.label=7;case 7:if(!(g<f.length))return[3,16];m=f[g],b=0,h=m.types,c.label=8;case 8:return b<h.length?(y=h[b],i.includes(y)?[4,m.getType(y)]:[3,14]):[3,15];case 9:return S=c.sent(),C=void 0,y!==o.Cb?[3,11]:[4,(T=S,ue(T))];case 10:return C=c.sent(),[3,13];case 11:return[4,S.text()];case 12:C=c.sent(),c.label=13;case 13:v=window.performance.now()-r,Object(o.kc)().ULS.traceTag(508703873,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"AsyncSystemClipboardStorage.get: Read successful. DataFormat: '".concat(y,"', TimeInMs: ").concat(v,", Command id: ").concat(e.id)),(E=y.startsWith(this.webCustomFormatPrefix))&&a?s.setItem(y.replace(this.webCustomFormatPrefix,""),C):E||s.setItem(y,C),c.label=14;case 14:return b++,[3,8];case 15:return g++,[3,7];case 16:return[3,21];case 17:if(w=c.sent(),"prompt"!==this.initialClipboardPermissionState||this.isActionPerformedOnPermissionPrompt||Object(o.kc)().ULS.traceTag(507626373,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"AsyncSystemClipboardStorage.get - Clipboard read permission prompt is closed without any action. Command id: ".concat(e.id)),w.name===this.emptyClipboardReadErrorName&&w.message===this.emptyClipboardReadErrorMessage)return Object(o.kc)().ULS.traceTag(508352130,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"AsyncSystemClipboardStorage.readDataFormats: System clipboard is empty. Command id: ".concat(e.id,", Error: ").concat(n.utils.getStringifiedError(w))),[2,s];throw Object(o.kc)().ULS.traceTag(508843077,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"AsyncSystemClipboardStorage.get: Failed to read data formats from system clipboard. Command id: ".concat(e.id,", Error: ").concat(n.utils.getStringifiedError(w))),new o.e(o.f.ClipboardIsInaccessible,"AsyncSystemClipboardStorage.get - Clipboard permission is denied or failed to read. Command id: ".concat(e.id),w);case 18:return e.clearSystemClipboard?[4,this.clearSystemClipboard()]:[3,20];case 19:c.sent(),c.label=20;case 20:return[7];case 21:return[2,s]}var T}))}))},e.prototype.set=function(e,t){var r;return Object(c.__awaiter)(this,void 0,void 0,(function(){var a,i,s,l,d,u,p,g,f,m,b,h,y,S,C,v,E,w=this;return Object(c.__generator)(this,(function(c){switch(c.label){case 0:this.disposableImplementationExtension.throwIfDisposed("set"),t.isAsyncClipboardAPI=!0,a=window.performance.now(),i=De("Microsoft.Office.Excel.EnableAsyncClipboardApiWriteSW",!1),s=this.getSupportedDataFormats(),c.label=1;case 1:c.trys.push([1,7,,8]),l={name:"clipboard-write",allowWithoutGesture:!1},c.label=2;case 2:return c.trys.push([2,4,,5]),[4,null===(r=navigator.permissions)||void 0===r?void 0:r.query(l)];case 3:if(d=c.sent(),Object(o.kc)().ULS.traceTag(507626372,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"AsyncSystemClipboardStorage.set - Clipboard write permission state: ".concat(null==d?void 0:d.state,". Command id: ").concat(t.id)),this.initialClipboardPermissionState=null==d?void 0:d.state,"denied"===(null==d?void 0:d.state))throw this.clipboardIsInaccessibleError;return"prompt"===(null==d?void 0:d.state)&&(this.isActionPerformedOnPermissionPrompt=!1,d.onchange=function(){w.isActionPerformedOnPermissionPrompt=!0,"denied"===(null==d?void 0:d.state)?Object(o.kc)().ULS.traceTag(507626371,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"AsyncSystemClipboardStorage.set - Clipboard write permission is denied from prompt. Command id: ".concat(t.id)):"granted"===(null==d?void 0:d.state)&&Object(o.kc)().ULS.traceTag(507626370,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"AsyncSystemClipboardStorage.set - Clipboard write permission is granted from prompt. Command id: ".concat(t.id))}),[3,5];case 4:if((u=c.sent())===this.clipboardIsInaccessibleError)throw u;return Object(o.kc)().ULS.traceTag(508651268,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,'AsyncSystemClipboardStorage.set: Failed to query "clipboard-write" permission. Command id: '.concat(t.id,", Error: ").concat(n.utils.getStringifiedError(u))),[3,5];case 5:if(!(p=Object(o.tb)(e))||p.length<1)return[2];for(g={},f=0,m=p;f<m.length;f++)b=m[f],s.includes(b.clipboardDataFormat)&&(h=Object(o.lb)(p,b.clipboardDataFormat),y=new Blob([h],{type:b.clipboardDataFormat}),(S=s.includes("".concat(this.webCustomFormatPrefix).concat(b.clipboardDataFormat)))&&i?g["".concat(this.webCustomFormatPrefix).concat(b.clipboardDataFormat)]=y:S||(g[b.clipboardDataFormat]=y));return C=new ClipboardItem(g,{unsanitized:[o.jc]}),[4,navigator.clipboard.write([C])];case 6:return c.sent(),v=window.performance.now()-a,Object(o.kc)().ULS.traceTag(508703872,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"AsyncSystemClipboardStorage.set: Write successful. Command id: ".concat(t.id,", TimeInMs: ").concat(v)),t.isTimestampStoredInSystemClipboard=!0,[3,8];case 7:throw E=c.sent(),"prompt"!==this.initialClipboardPermissionState||this.isActionPerformedOnPermissionPrompt||Object(o.kc)().ULS.traceTag(507626369,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"AsyncSystemClipboardStorage.set - Clipboard write permission prompt is closed without any action. Command id: ".concat(t.id)),Object(o.kc)().ULS.traceTag(508843076,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"AsyncSystemClipboardStorage.set: Failed to write data formats to system clipboard. Command id: ".concat(t.id,", Error: ").concat(n.utils.getStringifiedError(E))),new o.e(o.f.ClipboardIsInaccessible,"AsyncSystemClipboardStorage.set - Clipboard permission is denied or failed to write. Command id: ".concat(t.id),E);case 8:return[2]}}))}))},e.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[o.hb,o.jc,o.Cb,o.fc,o.gc]},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},e.prototype.clearSystemClipboard=function(){return Object(c.__awaiter)(this,void 0,void 0,(function(){return Object(c.__generator)(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,navigator.clipboard.writeText("")];case 1:return e.sent(),Object(o.kc)().ULS.traceTag(508703843,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"AsyncSystemClipboardStorage.clearSystemClipboard: Clipboard cleared"),[3,3];case 2:return e.sent(),Object(o.kc)().ULS.traceTag(508703842,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"AsyncSystemClipboardStorage.clearSystemClipboard: Failed to clear system clipboard."),[3,3];case 3:return[2]}}))}))},e}(),Ke=function(e){function t(t){return e.call(this,o.i.AsyncSystemClipboardAndLocalStorage,{browserStorage:!0,systemClipboard:!0,inMemory:!1},o.i.LocalStorage,t)||this}return Object(c.__extends)(t,e),t}(Ue),qe=function(){function e(){this.initialized=!1,this.clipboardStorageType=o.g.AsyncSystemClipboard,this.disposableImplementationExtension=Object(o.X)("CombinedSystemClipboardStorage")}return e.prototype.initialize=function(e,t){return Object(c.__awaiter)(this,void 0,void 0,(function(){var r,a,o;return Object(c.__generator)(this,(function(n){switch(n.label){case 0:return this.initialized=!1,[4,Promise.all([e,t])];case 1:return r=n.sent(),a=r[0],o=r[1],this.systemClipboardStorage=a,this.asyncSystemClipboardStorage=o,this.initialized=!0,[2,this]}}))}))},e.prototype.get=function(e){return Object(c.__awaiter)(this,void 0,void 0,(function(){var t,r,a;return Object(c.__generator)(this,(function(i){switch(i.label){case 0:if(this.disposableImplementationExtension.throwIfDisposed("get"),t=window.performance.now(),!this.initialized||!this.asyncSystemClipboardStorage||!this.systemClipboardStorage)throw new o.e(o.f.ClipboardStrategyNotInitialized);i.label=1;case 1:return i.trys.push([1,3,8,9]),[4,this.systemClipboardStorage.get(e)];case 2:return[2,i.sent()];case 3:r=i.sent(),Object(o.kc)().ULS.traceTag(508154642,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"CombinedSystemClipboardStorage.get - systemClipboardStorage get failed. Command id: ".concat(e.id,", Error: ").concat(n.utils.getStringifiedError(r))),i.label=4;case 4:return i.trys.push([4,6,,7]),[4,this.asyncSystemClipboardStorage.get(e)];case 5:return[2,i.sent()];case 6:throw a=i.sent(),Object(o.kc)().ULS.traceTag(507904976,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"CombinedSystemClipboardStorage.get - asyncSystemClipboardStorage get failed. Command id: ".concat(e.id,", Error: ").concat(n.utils.getStringifiedError(a))),new o.e(o.f.ClipboardIsInaccessible,"CombinedSystemClipboardStorage.get - Clipboard permission is denied or failed to read",a);case 7:return[3,9];case 8:return Object(o.kc)().ULS.traceTag(508154640,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"CombinedSystemClipboardStorage.get | System clipboard total read time: ".concat(window.performance.now()-t," ms, Command id: ").concat(e.id)),[7];case 9:return[2]}}))}))},e.prototype.set=function(e,t){return Object(c.__awaiter)(this,void 0,void 0,(function(){var r,a,i;return Object(c.__generator)(this,(function(s){switch(s.label){case 0:if(this.disposableImplementationExtension.throwIfDisposed("set"),r=window.performance.now(),!this.initialized||!this.asyncSystemClipboardStorage||!this.systemClipboardStorage)throw new o.e(o.f.ClipboardStrategyNotInitialized);s.label=1;case 1:return s.trys.push([1,3,8,9]),[4,this.systemClipboardStorage.set(e,t)];case 2:return s.sent(),[2];case 3:a=s.sent(),Object(o.kc)().ULS.traceTag(508154638,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"CombinedSystemClipboardStorage.set - systemClipboardStorage set failed. Command id: ".concat(t.id,", Error: ").concat(n.utils.getStringifiedError(a))),s.label=4;case 4:return s.trys.push([4,6,,7]),[4,this.asyncSystemClipboardStorage.set(e,t)];case 5:return s.sent(),[2];case 6:throw i=s.sent(),Object(o.kc)().ULS.traceTag(507904975,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"CombinedSystemClipboardStorage.set - asyncSystemClipboardStorage set failed. Command id: ".concat(t.id,", Error: ").concat(n.utils.getStringifiedError(i))),new o.e(o.f.ClipboardIsInaccessible,"CombinedSystemClipboardStorage.set - Clipboard permission is denied or failed to write",i);case 7:return[3,9];case 8:return Object(o.kc)().ULS.traceTag(508154637,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"CombinedSystemClipboardStorage.set - System clipboard total write time: ".concat(window.performance.now()-r," ms, Command id: ").concat(t.id)),[7];case 9:return[2]}}))}))},e.prototype.getSupportedDataFormats=function(){var e,t,r,a;return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),Object(c.__spreadArray)(Object(c.__spreadArray)([],null!==(t=null===(e=this.systemClipboardStorage)||void 0===e?void 0:e.getSupportedDataFormats())&&void 0!==t?t:[],!0),null!==(a=null===(r=this.asyncSystemClipboardStorage)||void 0===r?void 0:r.getSupportedDataFormats())&&void 0!==a?a:[],!0).reduce((function(e,t){return-1===e.indexOf(t)&&e.push(t),e}),[])},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},e}();function Xe(e){return new Me(e)}function Ye(){return new Be}function Qe(e,t,r,a,s,c){var l=function(e,t,r){return new L(e,t,r)}(r,a,s);return function(e,t,r,a){var s=o.s.NoError;return n.utils.chainFallbackPromises(e,(function(e){return function(e,t,r,a){Object(o.kc)().ULS.traceTag(595716231,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardPlatformEnvironmentFactory.createClipboardEnvironmentComponentsByType: Attempting to create clipboard strategy type '".concat(e.clipboardStrategyType,"'"));var s=function(){return function(){switch(e.clipboardStrategyType){case o.i.SystemClipboard:case o.i.SystemClipboardAndInMemory:return e;case o.i.SystemClipboardAndLocalStorage:case o.i.AsyncSystemClipboardAndLocalStorage:return e.systemClipboardStrategyParameters;default:throw new o.L("createClipboardEnvironmentComponentsByType: getSystemClipboardParameters couldn't be used for ".concat(e.clipboardStrategyType))}}().skipFilesIfPlainTextExists},c=function(){switch(e.clipboardStrategyType){case o.i.LocalStorage:return e;case o.i.SystemClipboardAndLocalStorage:case o.i.AsyncSystemClipboardAndLocalStorage:return e.localStorageStrategyParameters;default:throw new o.L("createClipboardEnvironmentComponentsByType: getLocalStorageParameters couldn't be used for ".concat(e.clipboardStrategyType))}},l=function(e){return r.createClipboardDataProcessor(e)},d=function(){return r.createClipboardMetaDataProcessor()},u=function(e){return r.createDualClipboardDataProcessor(e)},g=function(){return new N},f=function(e){return function(e){return new F(e)}(e)},m=function(){var e=c();return e.useSharedClipboardIframe?g():f(Object(o.wb)(e.sharedClipboardSchemaVersion))},b=function(){var e;return e=De("Microsoft.Office.Excel.EnableAsyncClipboardApiByDefault",!1)?Promise.resolve(Ye()):Promise.resolve((new qe).initialize(Promise.resolve(Xe(s())),Promise.resolve(Ye()))),(new Ge).initialize(e)},h=function(){return(new J).initialize(Promise.resolve(Xe(s())))},y=function(e){return function(e){return new We(e)}(e).initialize(Promise.resolve(new ke))},S=function(e,t){var r,n,s=c();return s.useSharedClipboardIframe?(function(e){var t={};e.wacCluster&&(t.wacCluster=e.wacCluster.trim()),e.sessionId&&(t.sessionId=e.sessionId),a&&(t.bulsEndpointUrl=a);var r=e.sharedClipboardOverrideOrigin?1:0;o.hc.initializeSharedClipboardSettings({sharedClipboardHostingApp:e.sharedClipboardHostingApp,sharedClipboardHostingApps:e.sharedClipboardHostingApps,sharedClipboardHostingEnvironments:e.sharedClipboardHostingEnvironments,sharedClipboardSchemaVersion:e.sharedClipboardSchemaVersion,sharedClipboardExpirationInMinutes:e.sharedClipboardExpirationInMinutes,clipboardPromiseTimeoutInMinutes:e.sharedClipboardExpirationInMinutes,whitelistOriginComponents:r}),i(t)}(s),function(e){return new Re(e)}(t).initialize((r=e?o.z.localStorageMetadata:o.z.localStorageData,new Ve(r)).initialize())):function(e){return new o.x(e)}(t).initialize(Promise.resolve((n=e?Object(o.vb)(s.sharedClipboardSchemaVersion):Object(o.ub)(s.sharedClipboardSchemaVersion),new o.w(n))))},C=function(e,r,a){return Promise.all([e,r]).then((function(e){var r=e[0];return function(e,r){return(r?r.initialize(e):Promise.resolve(void 0)).then((function(){return p(e,t,r)}))}(e[1],a).then((function(e){return{dataClipboardStrategy:r,metadataManager:e}}))}))};try{switch(e.clipboardStrategyType){case o.i.SystemClipboard:return C(h(),y(d()));case o.i.InMemory:return C(y(l(!1)),y(d()));case o.i.LocalStorage:return C(S(!1,l(!0)),S(!0,d()),m());case o.i.AsyncSystemClipboardAndLocalStorage:return C((v=u(!0),new Ke(v)).initialize(b(),S(!1)),S(!0,d()),m());case o.i.SystemClipboardAndLocalStorage:return C(function(){return(e=u(!0),new ze(e)).initialize(h(),S(!1));var e}(),S(!0,d()),m());case o.i.SystemClipboardAndInMemory:return C(function(){return(e=u(!1),new He(e)).initialize(h(),y());var e}(),y(d()))}return Promise.reject(new o.e(o.f.UnsupportedClipboardStrategyType,"Clipboard strategy type '".concat(e.clipboardStrategyType,"' is not supported")))}catch(t){return Promise.reject(new o.e(o.f.UnsupportedClipboardStrategyType,"failed to create clipboardStrategyType: '".concat(e.clipboardStrategyType,"' with error: ").concat(n.utils.getStringifiedError(t))))}var v}(e,t,r,a).then((function(t){return Object(o.kc)().ULS.traceTag(595716294,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"clipboardPlatformEnvironmentFactory.createClipboardEnvironmentComponentsByType: Clipboard strategy type '".concat(e.clipboardStrategyType,"' was created.")),t.infraInitializationError=s,t})).catch((function(t){var r;(r=Object(o.Nb)(t))&&(s=o.s.LocalStorageInaccessible);var a="clipboardPlatformEnvironmentFactory.createClipboardEnvironmentComponentsByType: selectClipboardStrategy: failed to create clipboard strategy type '".concat(e.clipboardStrategyType,"'. Error: ").concat(n.utils.getStringifiedError(t));return Object(o.kc)().ULS.traceTag(595716230,n.LogCategory.msoulscat_ES_EWAJS,r?n.TraceLevel.Info:n.TraceLevel.Error,a),Promise.reject(new o.e(o.f.SelectClipboardStrategy,a,t))}))}))}(e,t,l,c).then((function(e){return{dataClipboardStrategy:e.dataClipboardStrategy,clipboardDataManager:l,metadataManager:e.metadataManager,infraInitializationError:e.infraInitializationError}}))}var $e=function(){function e(){}return e.setFeatureGateManager=function(e){Se=e},e}();function Ze(){return at}function et(e){$e.setFeatureGateManager(e)}var tt;!function(e){e[e.NotInitialized=0]="NotInitialized",e[e.StateReady=1]="StateReady",e[e.InitializationSucceed=2]="InitializationSucceed"}(tt||(tt={}));var rt={initializationStatus:tt.NotInitialized,stateInitialized:!1,clipboardStrategy:void 0,chromeExtensionIds:[],clipboardPromiseTimeoutInMinutes:o.hc.defaultPromiseTimeoutInMinutes,copyToClipboardLatencyMessage:"Retrieving data. Wait a few seconds and try to cut or copy again.",metadataManager:void 0,clipboardDataManager:void 0,initializationError:o.s.NoError},at={init:function(e,t,r,a,i,s,c,l,d,u,p,g,f,m,b,h,y,S){if(rt.lastClipboardPlatformEnvironmentInitializationInfo)return Promise.resolve(rt.lastClipboardPlatformEnvironmentInitializationInfo);if(Object(o.Eb)(e),!t||!Array.isArray(t))return Promise.reject(new o.B(o.jb,"chromeExtensionIds"));Object(o.kc)().ULS.traceTag(596455702,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"ClipboardPlatformEnvironment.init: chromeExtensionIds = '".concat(JSON.stringify(t),"'")),rt.chromeExtensionIds=it(t),u&&(rt.copyToClipboardLatencyMessage=u);"number"!=typeof d||isNaN(d)||(rt.clipboardPromiseTimeoutInMinutes=d);return rt.initializationStatus=tt.StateReady,Qe(f,g,m,b,h,S).then((function(e){return rt.clipboardDataManager=e.clipboardDataManager,rt.metadataManager=e.metadataManager,rt.clipboardStrategy=e.dataClipboardStrategy,rt.initializationError=e.infraInitializationError,rt.initializationStatus=tt.InitializationSucceed,rt.lastClipboardPlatformEnvironmentInitializationInfo={clipboardStrategiesToInitialize:f,dataClipboardCapabilities:rt.clipboardStrategy&&rt.clipboardStrategy.clipboardCapabilities,dataClipboardStrategyType:rt.clipboardStrategy&&rt.clipboardStrategy.clipboardStrategyType,infraInitializationError:rt.initializationError},rt.lastClipboardPlatformEnvironmentInitializationInfo}))},getClipboardStrategy:function(){if(ot(),!rt.clipboardStrategy)throw new o.u("A clipboard strategy has not been selected. Call selectClipboardStrategy.");return rt.clipboardStrategy},getChromeExtensionIds:function(){return nt(),rt.chromeExtensionIds},getClipboardPromiseTimeoutInMinutes:function(){return nt(),rt.clipboardPromiseTimeoutInMinutes},getCopyToClipboardLatencyMessage:function(){return nt(),rt.copyToClipboardLatencyMessage},getMetadataManager:function(){return ot(),rt.metadataManager},getClipboardDataManager:function(){return ot(),rt.clipboardDataManager},getInitializationError:function(){return ot(),rt.initializationError}};function ot(){if(rt.initializationStatus!==tt.InitializationSucceed)throw new o.u("ClipboardPlatformEnvironment is not initialized. Call init(...).")}function nt(){if(rt.initializationStatus<tt.StateReady)throw new o.u("ClipboardPlatformEnvironment state is not ready. Call init(...).")}function it(e){var t=[];if(!e)return t;for(var r=0,a=e;r<a.length;r++){var o=a[r];o&&"string"==typeof o&&o.trim().length>0&&t.push(o)}return t}}]);
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/clipboardPlatform.min.js.map/0513473edfcf7332a8add9feb7841df4/clipboardPlatform.min.js.map