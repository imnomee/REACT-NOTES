var formulaAssistance=(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[18],{1972:function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),t.DefinedNameInfoType=void 0,function(e){e[e.Invalid=-1]="Invalid",e[e.Table=0]="Table",e[e.NamedRange=1]="NamedRange"}(o||(t.DefinedNameInfoType=o={}))},1973:function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),t.MajorityDataType=void 0,function(e){e[e.Text=0]="Text",e[e.Number=1]="Number",e[e.Date=2]="Date",e[e.Max=3]="Max"}(o||(t.MajorityDataType=o={}))},1974:function(e,t,n){"use strict";var o,r,a,i,l,c;Object.defineProperty(t,"__esModule",{value:!0}),t.RepairItemPartType=t.CodeActionKind=t.DiagnosticTag=t.DiagnosticSeverity=t.SuggestionKind=t.CompletionItemKind=void 0,function(e){e[e.Function=3]="Function",e[e.Enum=13]="Enum",e[e.NamedRange=100]="NamedRange",e[e.TableHeader=101]="TableHeader",e[e.LetVariable=102]="LetVariable",e[e.RichEntity=103]="RichEntity",e[e.Lambda=104]="Lambda",e[e.CustomFunction=105]="CustomFunction",e[e.Table=106]="Table",e[e.TableSpecialStructRef=107]="TableSpecialStructRef",e[e.RichEntityEmptyCellRef=108]="RichEntityEmptyCellRef",e[e.RangeRef=109]="RangeRef"}(o||(t.CompletionItemKind=o={})),function(e){e[e.Simple=0]="Simple",e[e.Smart=1]="Smart"}(r||(t.SuggestionKind=r={})),function(e){e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Information=3]="Information",e[e.Hint=4]="Hint"}(a||(t.DiagnosticSeverity=a={})),function(e){e[e.Unnecessary=1]="Unnecessary",e[e.Deprecated=2]="Deprecated"}(i||(t.DiagnosticTag=i={})),function(e){e[e.Empty=0]="Empty",e[e.QuickFix=1]="QuickFix",e[e.Refactor=2]="Refactor",e[e.RefactorExtract=3]="RefactorExtract",e[e.RefactorInline=4]="RefactorInline",e[e.RefactorRewrite=5]="RefactorRewrite",e[e.Source=6]="Source",e[e.SourceOrganizeImports=7]="SourceOrganizeImports",e[e.SourceFixAll=8]="SourceFixAll"}(l||(t.CodeActionKind=l={})),function(e){e[e.None=0]="None",e[e.Added=1]="Added",e[e.Removed=2]="Removed",e[e.Replaced=3]="Replaced"}(c||(t.RepairItemPartType=c={}))},1975:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1976:function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),t.IncompatibilityType=void 0,function(e){e[e.GMove=0]="GMove"}(o||(t.IncompatibilityType=o={}))},1977:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1978:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1979:function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),t.Rounding=void 0,function(e){e[e.RoundSec=0]="RoundSec",e[e.Round10ths=1]="Round10ths",e[e.Round100ths=2]="Round100ths",e[e.Round1000ths=3]="Round1000ths"}(o||(t.Rounding=o={}))},1980:function(e,t,n){"use strict";var o,r,a,i,l,c,s,u,d,m,p,g,f,b;Object.defineProperty(t,"__esModule",{value:!0}),t.TableOrientation=t.RecognizedTablesMetadataState=t.ColumnFormulaSuggestionUpdateKind=t.SchedulerFeature=t.GotoCtrlClickResultKind=t.ValuePreviewResultKind=t.PositionKind=t.HighlightKind=t.PerCharacterExperimentResultKind=t.PluginAttachGroup=t.PluginGroup=t.PluginFactoryName=t.MessageType=t.EditorMessageType=void 0,function(e){e[e.FunctionMessage=0]="FunctionMessage"}(o||(t.EditorMessageType=o={})),function(e){e[e.Insert=0]="Insert",e[e.Delete=1]="Delete",e[e.Replace=2]="Replace"}(r||(t.MessageType=r={})),function(e){e[e.TestPlugin=0]="TestPlugin",e[e.AutocompletePlugin=1]="AutocompletePlugin",e[e.DragPlugin=2]="DragPlugin",e[e.ConfigTestPlugin=3]="ConfigTestPlugin",e[e.ArgumentAssistancePlugin=4]="ArgumentAssistancePlugin",e[e.FeatureGateTestPlugin=5]="FeatureGateTestPlugin",e[e.DNMTraceTagTestPlugin=7]="DNMTraceTagTestPlugin",e[e.ParenthesesCouplingPlugin=8]="ParenthesesCouplingPlugin",e[e.AutocompleteFunctionPlugin=9]="AutocompleteFunctionPlugin",e[e.AutocompleteLetPlugin=10]="AutocompleteLetPlugin",e[e.AutocompleteRichValuePlugin=11]="AutocompleteRichValuePlugin",e[e.AutocompleteNamedObjectsPlugin=12]="AutocompleteNamedObjectsPlugin",e[e.AutocompleteTableHeadersPlugin=13]="AutocompleteTableHeadersPlugin",e[e.ColoredReferencesPlugin=14]="ColoredReferencesPlugin",e[e.ValuePreviewPlugin=15]="ValuePreviewPlugin",e[e.AutocompleteRangeSuggestionPlugin=16]="AutocompleteRangeSuggestionPlugin",e[e.SyntaxErrorsPlugin=17]="SyntaxErrorsPlugin",e[e.GotoCtrlClickPlugin=18]="GotoCtrlClickPlugin",e[e.AutocompleteEnumPlugin=19]="AutocompleteEnumPlugin",e[e.FormulaByExamplePlugin=20]="FormulaByExamplePlugin",e[e.SetCellPrefetchPlugin=21]="SetCellPrefetchPlugin",e[e.FormulaTranspilerPlugin=22]="FormulaTranspilerPlugin",e[e.FormulaCollectionPlugin=1004]="FormulaCollectionPlugin",e[e.ParserPerformanceMeasurements=1005]="ParserPerformanceMeasurements",e[e.FormulaRepairShadowEvalPlugin=1007]="FormulaRepairShadowEvalPlugin",e[e.PythonAutocompletePlugin=1008]="PythonAutocompletePlugin",e[e.AutocompleteWrapperPlugin=1009]="AutocompleteWrapperPlugin",e[e.AutocompleteBinaryModelExperimentPlugin=1010]="AutocompleteBinaryModelExperimentPlugin",e[e.ChangeGateTestPlugin=2e3]="ChangeGateTestPlugin",e[e.SlowTestPlugin=2001]="SlowTestPlugin",e[e.EvalOnCloneTestPlugin=2002]="EvalOnCloneTestPlugin",e[e.EvalFormulaTestPlugin=2003]="EvalFormulaTestPlugin",e[e.PythonTestPlugin=2004]="PythonTestPlugin",e[e.ChatGPTPlugin=2005]="ChatGPTPlugin",e[e.EventsTestPlugin=2006]="EventsTestPlugin"}(a||(t.PluginFactoryName=a={})),function(e){e[e.Excel=0]="Excel",e[e.Python=1]="Python"}(i||(t.PluginGroup=i={})),function(e){e[e.Core=0]="Core",e[e.Python=1]="Python",e[e.SmartSuggestionsAutoComplete=2]="SmartSuggestionsAutoComplete"}(l||(t.PluginAttachGroup=l={})),function(e){e[e.AutocompleteWrapperPluginResult=0]="AutocompleteWrapperPluginResult"}(c||(t.PerCharacterExperimentResultKind=c={})),function(e){e[e.CellRef=0]="CellRef",e[e.StructRef=1]="StructRef",e[e.NamedRange=2]="NamedRange",e[e.Parentheses=3]="Parentheses"}(s||(t.HighlightKind=s={})),function(e){e[e.Absolute=0]="Absolute",e[e.Relative=1]="Relative"}(u||(t.PositionKind=u={})),function(e){e[e.Failure=0]="Failure",e[e.Success=1]="Success",e[e.Unavailable=2]="Unavailable"}(d||(t.ValuePreviewResultKind=d={})),function(e){e[e.ReferenceFound=0]="ReferenceFound",e[e.NoReferenceFound=1]="NoReferenceFound",e[e.Failure=2]="Failure",e[e.RangeResolutionFailure=3]="RangeResolutionFailure"}(m||(t.GotoCtrlClickResultKind=m={})),function(e){e[e.ArgumentAssistance=0]="ArgumentAssistance",e[e.SimpleAutoComplete=1]="SimpleAutoComplete",e[e.SmartSuggestionsAutoComplete=2]="SmartSuggestionsAutoComplete",e[e.ValuePreview=3]="ValuePreview",e[e.ColoredReferences=4]="ColoredReferences",e[e.ParenthesisCoupling=5]="ParenthesisCoupling",e[e.SyntaxErrors=6]="SyntaxErrors",e[e.GotoCtrlClick=7]="GotoCtrlClick",e[e.EnumAutoComplete=8]="EnumAutoComplete"}(p||(t.SchedulerFeature=p={})),function(e){e[e.Accept=0]="Accept",e[e.Decline=1]="Decline",e[e.Ignore=2]="Ignore"}(g||(t.ColumnFormulaSuggestionUpdateKind=g={})),function(e){e[e.Valid=2]="Valid",e[e.Invalid=4]="Invalid",e[e.All=6]="All"}(f||(t.RecognizedTablesMetadataState=f={})),function(e){e[e.none=0]="none",e[e.rowMajor=1]="rowMajor",e[e.columnMajor=2]="columnMajor"}(b||(t.TableOrientation=b={}))},1981:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1982:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1983:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n(3).__exportStar(n(1984),t)},1984:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},2002:function(e,t,n){"use strict";n.r(t),n.d(t,"FormulaAssistanceUIFactoryGlobal",(function(){return On}));var o=n(1),r=n(369),a=n(60),i=n(16),l="aa-callout",c="aa-header",s=n(3),u=n(1322),d=n(26),m=n.n(d),p=n(5),g=n(144),f=n(15),b=n(98),h=Object(s.__assign)(Object(s.__assign)({},p.b.fadeIn100),{animationTimingFunction:p.c.easeFunction1}),v="0.467s cubic-bezier(0.5, 0, 0, 1)",x=300,y=415,E=500,C={animation:"none","will-change":"transform",left:"0px !important /* @noflip */",right:"auto !important /* @noflip */",top:"var(--top) !important",bottom:"var(--bottom) !important",maxWidth:"var(--max-width) !important",maxHeight:"var(--max-height) !important"},S={root:Object(s.__assign)({borderRadius:4},h),calloutMain:{borderRadius:4}},_={root:{color:Object(b.a)().primary,fontSize:p.k.size12,fontWeight:p.l.semibold,lineHeight:p.k.size16,userSelect:"none",selectors:{"&:active, &:hover, &:active:hover, &:focus":{color:Object(b.a)().primary}}}},P={scrollbarWidth:"thin",scrollbarColor:"#808080 #FFF","-ms-scrollbar-base-color":"#808080","-ms-scrollbar-track-color":"#FFF",selectors:{"::-webkit-scrollbar":{width:14},"::-webkit-scrollbar-thumb":{borderRadius:20,backgroundColor:g.a.gray110,border:"solid 4px transparent",backgroundClip:"content-box"},"::-webkit-scrollbar-thumb:hover":{backgroundColor:g.a.gray120},"::-webkit-scrollbar-button:vertical":{height:4}}},O={container:{height:"100%"},root:{height:"100%",maxWidth:"max-content",boxSizing:"border-box"}},k=5,R=7,w=20,A=20,j=340,T=Object(i.c)((function(e){return Object(p.db)({cardPart:{padding:"".concat(k,"px ").concat(R,"px")},expandedCardPart:{padding:"".concat(k,"px ").concat(R,"px"),minWidth:e?void 0:"".concat(j-2*R,"px")},focusTrapCallout:{height:"100%"},root:{display:"flex",width:"min-content",maxHeight:"100%",cursor:"default",flexDirection:"column"},collapsedCard:{width:"max-content",maxWidth:"".concat(E,"px"),minWidth:e?"".concat(j,"px"):"0px",direction:"ltr",flexShrink:0,transition:e?void 0:"min-width ".concat("0s cubic-bezier(0.5, 0, 0, 1) 0.467s"),selectors:{":after":I(e)}},expandedCard:Object(s.__assign)(Object(s.__assign)({overflowY:"auto",maxWidth:e?"".concat(E,"px"):"0px",transition:e?"max-height ".concat(v):"max-height ".concat(v,", max-width ").concat("0s cubic-bezier(0.5, 0, 0, 1) 0.467s")},P),{":before":I(!e)})})})),F=Object(p.db)(S,{calloutMain:{overflow:"hidden"}}),I=function(e){return{content:'""',position:"relative",display:e?"block":"none",margin:"0px ".concat(R,"px 0px ").concat(R,"px"),height:1,backgroundColor:g.a.gray40}},D=Object(i.c)((function(){var e;return{root:{height:w,width:A,top:2,borderRadius:2,selectors:(e={},e[":hover, :focus"]=Object(s.__assign)({},f.o),e)},icon:{height:16,width:16}}})),N=Object(i.c)((function(){return Object(p.db)(D(),{icon:{transition:"transform .2s",transform:"var(".concat("--collapse-icon-transform",")")},flexContainer:{marginLeft:1}})})),M=n(2475),z=n(70),W=n(69),H=n(153);function B(e){var t=Object(o.useRef)(0),n=Object(o.useState)(null),r=n[0],a=n[1];return Object(o.useEffect)((function(){var n=-1,o=function(){var r=document.getElementById(e);r?(a(r),t.current>=10&&z.a.sendTraceTag(508842627,W.a.msoulscat_ES_EWAJS,H.a.Warning,"useElementById found #".concat(e," ")+"in ".concat(t.current," frames."))):t.current<40?(t.current++,n=requestAnimationFrame(o)):z.a.sendTraceTag(509634701,W.a.msoulscat_ES_EWAJS,H.a.Error,"useElementById couldn't find #".concat(e," ")+"in less than ".concat(t.current," frames."))};return o(),function(){return cancelAnimationFrame(n)}}),[e,40]),r}function G(e,t,n){return e<t?t:e>n?n:e}function K(e){var t=e.x,n=e.y,o=e.maxWidth,r=e.maxHeight,a=e.renderDown,i=a?"0px":"auto",l=a?"auto":"-100vh",c=a?"".concat(Math.round(n),"px"):"calc(".concat(Math.round(n),"px - 100vh)");return{transform:"translate(".concat(Math.round(t),"px, ").concat(c,")"),"--top":i,"--bottom":l,"--max-width":"".concat(o,"px"),"--max-height":"".concat(r,"px")}}function L(e,t,n,o,r,a,i){var l={top:8,left:8,right:window.innerWidth-8,bottom:window.innerHeight-8},c={top:G(i.top,l.top,l.bottom),left:G(i.left,l.left,l.right),right:G(i.right,l.left,l.right),bottom:G(i.bottom,l.top,l.bottom)},s={top:G(e.top,c.top,c.bottom),left:G(e.left,c.left,c.right),right:G(e.right,c.left,c.right),bottom:G(e.bottom,c.top,c.bottom)},u=c.right-c.left,d=function(e,t,n,o,r,a){if(o){var i=a.bottom-t,l=e-a.top,c=(r?i:l)>=n,s=c?r:!r,u=a.bottom-a.top;return!c&&n>i&&n>l&&(s=i>=l),{availableVerticalSpace:u,shouldRenderDown:s}}var d=e-a.top,m=a.bottom-t,p=n<=d,g=n<=m,f=0,b=r;r&&g?f=m:!r&&p?f=d:(b=m>=d,f=Math.max(m,d));return{availableVerticalSpace:f,shouldRenderDown:b}}(s.top,s.bottom,n,r,a,c),m=d.availableVerticalSpace,p=d.shouldRenderDown,g=Math.min(y,m),f=Math.min(E,u),b=G(s.left,c.left,c.right-Math.min(o,f)),h=0;if(r&&a!==p){var v=s.top;h=p?v-t:v+t}else h=p?s.bottom:s.top;var x=h;return r&&(x=G(h,p?c.top:Math.min(c.bottom,c.top+t),p?Math.max(c.top,c.bottom-t):c.bottom)),{x:b,y:x,maxWidth:f,maxHeight:g,renderDown:p}}var V,U,J,Q=o.forwardRef((function(e,t){var n=e.hidden,i=e.setComponentApi,c=e.onLayoutChange,d=e.getTargetAndBounds,p=e.renderCompactCard,g=e.renderExpandedCard,f=e.onIsExpandedChange,b=e.isExpanded,h=e.collapsedId,y=Object(s.__rest)(e,["hidden","setComponentApi","onLayoutChange","getTargetAndBounds","renderCompactCard","renderExpandedCard","onIsExpandedChange","isExpanded","collapsedId"]),E=B(l),C=o.useState(b),S=C[0],_=C[1],P=o.useRef(null),O=o.useRef(null),k=o.useRef(null),R=o.useRef(null),w=o.useRef(S),A=o.useRef(-1),I=o.useRef(-1),D=o.useCallback((function(e){if(void 0===e&&(e=!1),!n&&E){var t=P.current,o=k.current,r=t.scrollHeight+o.scrollHeight,a=t.scrollWidth,i=d(),l=i.target,s=i.bounds,u=i.isFloating,m=i.renderDown,p=S?r:t.clientHeight,g=u?r:Math.max(r,x),f=!1;if(u)(A.current!==l.top||I.current!==l.left)&&((f=!m&&!e)&&(l.top-=p,l.bottom=l.top),A.current=l.top,I.current=l.left);var b=L(l,p,g,a,u,m||f,s);c(b);var h=S!==w.current,y=b.renderDown===m&&b.y!==l.top,C=h&&y;w.current=S;var _=K(b);if(C){E.style.transition="transform ".concat(v);var O=function(){E.style.transition="",E.ontransitionend=null,E.ontransitioncancel=null};E.ontransitionend=O,E.ontransitioncancel=O}for(var R=0,T=Object.entries(_);R<T.length;R++){var F=T[R],D=F[0],N=F[1];E.style.setProperty(D,N)}var M=b.maxWidth<j;E.style.minWidth=S?"".concat(M?b.maxWidth:j,"px"):"0px";var z=S&&b.maxHeight<r;o.style.overflow=z?"hidden auto":"hidden";var W=S===b.renderDown;t.style.setProperty("--collapse-icon-transform",W?"scaleY(-1)":"")}}),[d,n,S,c,E]);o.useEffect((function(){if(E){var e=k.current,t=S?e.scrollHeight:0;e.style.maxHeight="".concat(t,"px")}})),o.useEffect((function(){E&&D(!0)})),o.useEffect((function(){i({updatePosition:D})}),[i,D]);var z=T(S),W=S?ExcelRibbonStrings.FormulaArgumentAssistanceCollapse:ExcelRibbonStrings.FormulaArgumentAssistanceExpand;return o.createElement(u.a,Object(s.__assign)({onKeyDownCapture:function(e){var t,n,o=null!==(t=e.keyCode)&&void 0!==t?t:e.which;!S||o!==a.a.up&&o!==a.a.down||null===(n=k.current)||void 0===n||n.scrollBy({top:o===a.a.up?-100:100,left:0,behavior:"smooth"})},isBeakVisible:!1,styles:F,hidden:n,focusTrapProps:{className:z.focusTrapCallout,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,disableFirstFocus:!0}},y),o.createElement("div",{ref:t,className:z.root},o.createElement("div",{id:h,className:z.collapsedCard,ref:P},o.createElement(r.a,{className:z.cardPart,horizontal:!0,horizontalAlign:"space-between",reversed:!0},o.createElement(M.a,{id:"toggleCardStateButtonId","data-testid":"toggleCardStateButtonId",iconProps:{iconName:m.a.CommonControlChevronDown_16},ariaLabel:W,customTooltip:W,onClick:function(e){var t=!S;_(t),null==f||f(t)},styles:N()}),o.createElement("div",{ref:O},p()))),o.createElement("div",{className:z.expandedCard,ref:k,onPointerDown:function(e){e.preventDefault()}},o.createElement("div",{className:z.expandedCardPart,ref:R},g(S)))))})),Y=n(2045),X=n(341),Z=n(1101),q={root:C},$=Object(i.c)((function(e){return{display:"block",content:"attr(".concat(e,")"),fontSize:p.k.size12,fontWeight:p.l.semibold,height:0,overflow:"hidden",visibility:"hidden"}})),ee={label:{root:{fontSize:p.k.size12,fontWeight:p.l.semibold,lineHeight:p.k.size16,paddingBottom:4,paddingTop:0}},formula:{root:{color:g.a.gray180,fontSize:p.k.size12,fontWeight:p.l.semibold,lineHeight:p.k.size16,selectors:(V={},V[p.m]={color:"WindowText"},V)}},text:{root:{color:g.a.gray180,fontSize:p.k.size12,lineHeight:p.k.size16,selectors:(U={},U[p.m]={color:"WindowText"},U)}},param:{root:{color:Object(b.a)().shade20,fontSize:p.k.size12,fontWeight:p.l.semibold,lineHeight:p.k.size16,selectors:(J={},J[p.m]={color:"Highlight"},J)}},parametersContainer:{display:"grid",gridTemplateColumns:"auto 1fr",gridGap:1,color:g.a.gray180,fontSize:p.k.size12,lineHeight:p.k.size16},expandedCardPart:{root:{paddingTop:4}}},te=Object(i.c)((function(e){var t,n;return e?Object(p.db)({root:{selectors:(n={},n[p.m]={border:"2px solid Highlight"},n)}}):Object(p.db)({root:{cursor:"pointer",opacity:.5,selectors:(t={},t[p.m]={opacity:1},t)}})})),ne=Object(i.c)((function(e){var t={":after":$("formula-text")};return e?Object(p.db)({root:t}):Object(p.db)({root:Object(s.__assign)(Object(s.__assign)({},t),{textAlign:"unset",borderBottom:"0px","&:active, &:hover, &:active:hover, &:focus":{color:g.a.gray180}})})})),oe={root:{direction:"ltr"}},re=Object(i.c)((function(e){var t;return Object(p.db)({param:Object(s.__assign)({backgroundColor:ae(e),padding:"2px 5px 4px 5px",transition:"background-color 150ms linear",cursor:"default"},e?f.o:{}),paramName:{fontWeight:e?p.l.semibold:p.l.regular,":after":$("param-name")}},{param:{selectors:(t={},t[p.m]={transition:"none",border:"1px solid WindowText"},t)}})})),ae=function(e){return e?"rgb(202, 234, 216, 0.6)":"rgb(245, 245, 245)"},ie=function(e){var t=e.description;return o.createElement(r.a,null,o.createElement(X.a,{styles:ee.label},ExcelRibbonStrings.FormulaArgumentAssistanceDescription),o.createElement(Z.a,{styles:ee.text},t))},le=function(e){var t=e.functionName,n=e.params,r=e.selected,a=e.functionNameStyle,i=e.textStyle,l=e.selectedStyle,c=e.listSeparator,s=e.styles,u=e.onClick;return o.createElement(Z.a,{styles:Object(p.db)(oe,i,s),onClick:u},o.createElement(Z.a,{styles:a},t),o.createElement(o.Fragment,null,"(",n.length>0&&n.map((function(e,t){var n=t===r?l:i;return o.createElement(o.Fragment,{key:t},o.createElement(Z.a,{styles:n},e))})).reduce((function(e,t){return[e,"".concat(c," "),t]})),")"))},ce=function(e){var t=e.functionName,n=e.parameters,a=e.listSeparator,i=e.description;return n?o.createElement(r.a,null,o.createElement(X.a,{styles:ee.label},ExcelRibbonStrings.FormulaArgumentAssistanceExample),o.createElement(le,{functionName:"=".concat(t),params:n.params,selected:n.activeParam,functionNameStyle:ee.text,textStyle:ee.text,selectedStyle:ee.param,listSeparator:a}),i&&o.createElement(Z.a,{styles:ee.text},i)):null},se=function(e){var t=e.parameters,n=e.descriptions;return o.createElement(o.Fragment,null,t.params&&t.params.length>0&&o.createElement("div",{style:ee.parametersContainer},t.params.map((function(e,r){var a=r===t.activeParam,i=re(a);return o.createElement(o.Fragment,{key:r},o.createElement("div",{className:[i.param,i.paramName].join(" "),"param-name":e},e),o.createElement("div",{className:i.param},n[r]))}))))},ue=n(1262),de=function(e){var t=e.functionName,n=e.signatures,a=e.activeSignature,i=e.listSeparator,l=e.onFormulaClick;return o.createElement(r.a,{"data-testid":"functionSignatureId"},n.map((function(e,n){var r=n===a,c=e.signatureParams.params,s="".concat(t,"(").concat(c.join("".concat(i," ")),")");return r?o.createElement("div",{className:ne(r).root,"formula-text":s,id:"aa_function_".concat(n),key:n},o.createElement(le,{functionName:t,params:c,selected:e.signatureParams.activeParam,functionNameStyle:ee.formula,textStyle:ee.text,selectedStyle:ee.param,listSeparator:i,styles:te(r)})):o.createElement(ue.a,{styles:ne(r),key:n,onClick:l(n),"formula-text":s,id:"aa_function_".concat(n),"data-testid":"functionLinkSignatureId"},o.createElement(le,{functionName:t,params:c,selected:e.signatureParams.activeParam,functionNameStyle:ee.formula,textStyle:ee.text,selectedStyle:ee.param,listSeparator:i,styles:te(r)}))})))},me=function(e){var t=e.disabled,n=e.onClick,r=Object(s.__rest)(e,["disabled","onClick"]);return o.createElement(ue.a,{"data-testid":"feedbackId",disabled:t,styles:Object(p.db)(_,r.styles),onClick:n},ExcelRibbonStrings.FormulaAuthoringGiveFeedback)},pe=o.createContext({isFeedbackAllowed:!1}),ge=function(e){var t=e.functionName,n=e.isExpanded,a=e.onHelpClick,i=e.onFeedback,l=o.useContext(pe).isFeedbackAllowed;return o.createElement(r.a,{horizontal:!0,horizontalAlign:"space-between"},o.createElement(ue.a,{"data-testid":"learnMoreLinkId",disabled:!n,styles:_,onClick:a},"".concat(ExcelRibbonStrings.FormulaArgumentAssistanceLearnMore," ").concat(t)),l&&o.createElement(me,{disabled:!n,onClick:i}))},fe=n(21),be=o.forwardRef((function(e,t){var n=e.setComponentApi,i=e.onLayoutChange,s=e.getTargetAndBounds,u=e.functionRenderingInfo,d=e.callbacks,m=e.isExpanded,p=e.hidden,g=u,f=g.functionName,b=g.functionDescription,h=g.signatures,v=g.activeSignature,x=g.listSeparator,y=o.useState(null!=v?v:0),E=y[0],C=y[1],S=h[E],_=function(e){return function(t){C(e)}},P=function(e){var t;null===(t=null==d?void 0:d.onHelpLink)||void 0===t||t.call(d)},O=function(e){var t;null===(t=null==d?void 0:d.onFeedback)||void 0===t||t.call(d,u)};return o.createElement(Y.a,null,o.createElement(Q,{getTargetAndBounds:s,setComponentApi:n,onLayoutChange:i,renderCompactCard:function(){return o.createElement(de,{functionName:f,signatures:h,activeSignature:E,listSeparator:x,onFormulaClick:_})},renderExpandedCard:function(e){return o.createElement(r.a,{styles:ee.expandedCardPart,tokens:{childrenGap:12}},o.createElement(ie,{description:b}),o.createElement(ce,{functionName:f,parameters:S.exampleParams,listSeparator:x,description:S.exampleDescription}),o.createElement(se,{parameters:S.descriptionParams,descriptions:S.descriptions}),o.createElement(ge,{functionName:f,isExpanded:e,onHelpClick:P,onFeedback:O}))},isExpanded:m,onIsExpandedChange:null==d?void 0:d.onIsExpandedChange,onDismiss:function(e){var t,n;he()&&(null===(t=null==e?void 0:e.nativeEvent)||void 0===t?void 0:t.keyCode)===a.a.escape&&(null===(n=null==d?void 0:d.onDismissClick)||void 0===n||n.call(d))},ref:t,key:m.toString(),styles:q,hidden:p,id:l,collapsedId:c,layerProps:{eventBubblingEnabled:!0}}))})),he=Object(i.c)((function(){return Object(fe.isChangeGateEnabled)("OfficeVSO:8745608_FormulaAssistanceDismiss")})),ve="ac-callout",xe=n(502),ye=n(699),Ee=n(311),Ce=n(1159),Se=n(784),_e=n(891),Pe=n(1326),Oe=n(120),ke=n(20),Re=n(219),we=Oe.b.getInstance().getTheme(),Ae=Object(p.X)(0,p.t),je=12,Te=2,Fe=4,Ie=8,De=4,Ne=4,Me=6,ze=16,We=1,He=4,Be=28,Ge=2,Ke="center",Le=4,Ve=2,Ue=16,Je=8,Qe=4,Ye=340,Xe=240,Ze=4,qe=6,$e=4,et=8,tt=Ye-2*Le-Ue-Je-Qe-Ze-et-3*$e,nt=Ye-2*je-Ue-2*Qe-qe-et-2*$e,ot=Ye-2*Le-Ue-Je-Qe-Ze,rt=Ye-2*je-Ue-2*Qe-qe,at={height:"100%",display:"flex",flexDirection:"column",width:"inherit"},it={display:"flex",minHeight:"0px",flexDirection:"column"},lt={root:C},ct="svg > path.OfficeIconColors_HighContrast:not([class*='OfficeIconColors_m'])",st=Object(i.c)((function(){var e,t;return Object(p.eb)({"&:hover":(e={},e[p.m]=(t={},t[ct]={fill:"HighlightText"},t),e),"&:focus":{outline:"-webkit-focus-ring-color auto 1px"}})})),ut=Object(i.c)((function(e,t){var n,o,r=ft(),a=bt();return Object(p.db)(Object(Pe.b)(we),{linkContent:Object(s.__assign)({color:a?ke.a.colorNeutralForeground1:g.a.gray180,minHeight:Be,padding:r?void 0:"0px ".concat(je,"px 0px ").concat(je,"px"),cursor:"pointer",userSelect:"none",backgroundColor:e?a?ke.a.colorNeutralBackground1Hover:"#F5F5F5":"",borderRadius:r?De:void 0,"&:hover":Object(s.__assign)({backgroundColor:a?ke.a.colorNeutralBackground1Selected:"#F0F0F0"},f.o)},e?f.o:{}),icon:{alignSelf:Ke,width:Ue,height:Ue,margin:r?"0px ".concat(Qe,"px 0px ").concat(Je,"px"):"0px ".concat(Qe,"px"),selectors:(n={},n[Ae]={fontSize:"",width:""},n[p.m]={selectors:(o={},o[ct]={fill:e?"HighlightText":""},o)},n)},label:{font:"12px Segoe UI",lineHeight:p.k.size16,flexGrow:"",overflow:t?"hidden":"",textOverflow:t?"elipsis":"",alignSelf:Ke,margin:"0px 0px 0px ".concat(r?Ze:qe,"px"),display:t?"-webkit-box":void 0,whiteSpace:t?"normal":void 0,wordBreak:t?"break-all":void 0,WebkitLineClamp:t?"1":void 0,WebkitBoxOrient:t?"vertical":void 0},secondaryText:Object(s.__assign)({color:a?ke.a.colorNeutralForeground2:g.a.gray130,fontSize:p.k.size10,lineHeight:p.k.size12,textAlign:"left",whiteSpace:"normal",padding:"2px 0px 2px 8px",alignSelf:Ke,overflow:t?"hidden":void 0,overflowWrap:t?"break-word":void 0},gt(e))})})),dt=Object(i.c)((function(e,t,n,o,r){var a,i,l,c=ft(),u=t?c?We+Me+Ne:We+2*He:0,d=c?Te+Ie*(Ge+Be)+u:Fe+Ie*Be+u,m=c?d-(Te+n*(Ge+Be)+u):d-(Fe+n*Be+u);return Object(p.db)(O,{root:{width:e?void 0:Ye,minWidth:e?Xe:void 0,maxWidth:e?Ye:void 0,paddingTop:c?Te:Fe,borderRadius:c?De:void 0},subComponentStyles:{menuItem:{item:{selectors:(a={},a[" [role='menuitem']"]={margin:c?"".concat(Ve,"px ").concat(Le,"px 0px ").concat(Le,"px"):void 0},a)},divider:{height:We,margin:c?"".concat(Me,"px ").concat(ze,"px ").concat(Ne,"px ").concat(ze,"px"):He,borderRadius:c?"0.5px":void 0,selectors:(i={},i[p.m]={backgroundColor:"WindowText"},i)}}},simpleSection:Object(s.__assign)(Object(s.__assign)({maxHeight:m,overflowY:"auto",overflowX:r?"hidden":void 0},P),{selectors:Object(s.__assign)((l={},l[" [role='menuitem']"]={marginRight:c&&m<o*(Ge+Be)?"0px !important":void 0},l),P.selectors)})})})),mt=Object(i.c)((function(){var e=ft();return{footer:{root:{padding:e?"".concat(Ve,"px ").concat(Le,"px ").concat(Le,"px ").concat(Le,"px"):"".concat(Le,"px ").concat(je,"px 8px ").concat(je,"px")}},feedback:{root:{float:"right",fontSize:p.k.size10,lineHeight:p.k.size14,margin:e?"".concat(Ve,"px 12px ").concat(Ve,"px 0px"):void 0}}}})),pt=function(e){switch(e.kind){case Re.CompletionItemKind.Function:return e.type===Re.SuggestionKind.Simple?m.a.FormulaBar_16:m.a.Intelligence_16;case Re.CompletionItemKind.Enum:return m.a.NameManager_16;case Re.CompletionItemKind.RichEntity:return m.a.Tag_16;case Re.CompletionItemKind.LetVariable:return m.a.FormulaLet_16;case Re.CompletionItemKind.NamedRange:return m.a.NameRange_16;case Re.CompletionItemKind.Table:return m.a.Table_16;case Re.CompletionItemKind.TableHeader:return m.a.SelectColumn_16;case Re.CompletionItemKind.RichEntityEmptyCellRef:return m.a.AbsoluteReference_16;default:return""}},gt=function(e){var t;return{selectors:(t={},t[p.m]={color:e?"HighlightText":"WindowText"},t)}},ft=Object(i.c)((function(){return Object(fe.isChangeGateEnabled)("OfficeVSO:7982656_isFluentvNextChangesEnabled")})),bt=Object(i.c)((function(){return Object(fe.isChangeGateEnabled)("OfficeVSO:8137695_isFluentvNextColorChangesEnabled")})),ht=function(e){var t=e.onFeedback,n=o.useContext(pe).isFeedbackAllowed;return o.createElement(r.a,{styles:mt().footer,tokens:{childrenGap:8}},n&&o.createElement("div",null,o.createElement(me,{styles:mt().feedback,disabled:!1,onClick:t})))},vt=n(1119);function xt(e,t,n,o){if(!t)return 0;var r=yt(t,o);if(!e)return Math.min(r,n);var a=yt(e,o);if(r+a>=n){z.a.sendTraceTag(508303310,W.a.msoulscat_ES_EWAJS,H.a.Info,"sharedUtils.atLeastThirdOfAvailableWidth: The needed width is bigger than the available limit,\n      targetWidth: ".concat(r,", additionalTextWidth:  ").concat(a,"."));var i=n/3;if(r>i){r=i;var l=2*i-a;l>0&&(r+=l)}}return r}var yt=function(e,t){void 0===t&&(t="12px Segoe UI");var n=document.createElement("canvas").getContext("2d");return n.font=t,n.measureText(e).width};function Et(e){return null!=e}function Ct(e){return null==e}var St,_t,Pt=o.forwardRef((function(e,t){var n,r=e.setComponentApi,i=e.onLayoutChange,l=e.getTargetAndBounds,c=e.completionItems,u=e.callbacks,d=e.activeItemIndex,m=e.hidden,f=e.disableItemReadout,b=o.useRef(null);o.useLayoutEffect((function(){b.current&&b.current.scrollIntoView({block:"nearest"})}));var h=o.useMemo((function(){return Object(_e.a)(c)}),[c]),v=o.useMemo((function(){return h.reduce((function(e,t){return e[t.type]=!0,e}),{})}),[h]),y=v[Re.SuggestionKind.Smart],E=y&&!v[Re.SuggestionKind.Simple],C=y&&v[Re.SuggestionKind.Simple],S=dt(E,C,h.filter((function(e){return e.type===Re.SuggestionKind.Smart})).length,h.filter((function(e){return e.type===Re.SuggestionKind.Simple})).length,wt()),_=function(e){return function(t){var n;e!==d&&(null===(n=null==u?void 0:u.onCompletionItemSelected)||void 0===n||n.call(u,h[e],e)),t.target.offsetHeight<t.target.scrollHeight&&t.target.setAttribute("title",h[e].label)}},P=function(e){return function(t){var n;t.preventDefault(),null===(n=null==u?void 0:u.onCompletionItemCommitted)||void 0===n||n.call(u,h[e])}},O=function(e){return function(t){var n;t.nativeEvent.keyCode===a.a.enter&&(t.preventDefault(),null===(n=null==u?void 0:u.onCompletionItemCommitted)||void 0===n||n.call(u,h[e]))}},k=function(e){return function(t){var n,o;e!==d&&(t.stopPropagation(),null===(n=null==u?void 0:u.onCompletionItemSelected)||void 0===n||n.call(u,h[e],e),null===(o=t.currentTarget)||void 0===o||o.focus())}},R=o.useCallback((function(e,n){var r=Object(s.__assign)(Object(s.__assign)({},e),{items:null==e?void 0:e.items.filter((function(e){return"smart-section"===e.key}))}),a=Object(s.__assign)(Object(s.__assign)({},e),{items:null==e?void 0:e.items.filter((function(e){return"simple-section"===e.key}))}),i={style:at},l={style:it};return o.createElement(vt.a,null,o.createElement("div",Object(s.__assign)({},i,{ref:t}),o.createElement(ye.a,Object(s.__assign)({disabled:m},l),n(r),o.createElement("div",{className:S.simpleSection},n(a))),o.createElement(ht,{onFeedback:function(e){var t;null===(t=null==u?void 0:u.onFeedback)||void 0===t||t.call(u)}})))}),[u,S.simpleSection,t,m]),w=o.useCallback((function(e,t){return function(n,r){var a,i=kt(n.item.text,t),l=Rt(e,n.item.text,t);return o.createElement(o.Fragment,null,r.renderItemIcon(n),o.createElement("span",{id:e?"ac_selected_function":void 0,className:n.classNames.label,style:wt()?(a=l,{width:a,minWidth:a}):void 0},n.item.text),t&&A(t,i),e&&r.renderSecondaryText(n))}}),[]),A=function(e,t){return o.createElement(o.Fragment,null,o.createElement("span",{style:{margin:ft()?"2px ".concat($e,"px"):"2px 0px 2px ".concat($e,"px"),width:et,color:bt()?ke.a.colorNeutralForeground2:g.a.gray130,fontSize:p.k.size12}},"="),o.createElement("span",{style:(n=t,{display:"-webkit-box",whiteSpace:"normal",wordBreak:"break-all",width:n,minWidth:n,margin:ft()?"2px ".concat($e,"px 2px 0px"):"2px 0px 2px ".concat($e,"px"),color:bt()?ke.a.colorNeutralForeground2:g.a.gray130,WebkitLineClamp:1,WebkitBoxOrient:"vertical",textOverflow:"elipsis",overflow:"hidden",font:"12px Segoe UI"})},e));var n},j=h.map((function(e,t){var n,r;return{key:e.label+e.kind,text:e.label,secondaryText:e.detail,iconProps:{iconName:pt(e)},onRender:(r=t,function(e,t){var n=r===d,a=h[r].type===Re.SuggestionKind.Smart,i=n&&!E;return o.createElement("div",{role:"menuitem",className:st(),"data-testid":"menuItemId".concat(r),onMouseMove:_(r),onMouseDown:P(r),onKeyDown:O(r),onFocus:k(r),ref:n?b:void 0,"data-is-focusable":!0,tabIndex:n?0:-1,"aria-label":f?" ":void 0},o.createElement(xe.a,{classNames:ut(i,!!wt()||a),hasIcons:!0,index:r,item:e}))}),onRenderContent:w(e.type===Re.SuggestionKind.Simple&&t===d||jt()&&e.kind===Re.CompletionItemKind.Enum,null!==(n=e.evaluation)&&void 0!==n?n:void 0),data:e.type}})),T={key:"smart-section",itemType:Ee.a.Section,sectionProps:{items:j.filter((function(e){return e.data===Re.SuggestionKind.Smart})),bottomDivider:C}},F={key:"simple-section",itemType:Ee.a.Section,sectionProps:{items:j.filter((function(e){return e.data===Re.SuggestionKind.Simple})),bottomDivider:!1}},I=null!==(n=null==u?void 0:u.onRestoreFocus)&&void 0!==n?n:void 0,D=[T,F],N=B(ve),M=o.useCallback((function(){if(!m&&N){var e=l(),t=e.target,n=e.bounds,o=e.isFloating,r=e.renderDown,a=N.clientHeight,c=N.clientWidth,s=L(t,a,o||E?a:Math.max(a,x),c,o,r||E,n);i(s);for(var u=K(s),d=0,p=Object.entries(u);d<p.length;d++){var g=p[d],f=g[0],b=g[1];N.style.setProperty(f,b)}}}),[l,m,i,E,N]);return o.useEffect((function(){r({updatePosition:M})}),[r,M]),o.useEffect((function(){N&&M()})),o.createElement(Ce.a,{items:D,styles:S,onRenderMenuList:R,isBeakVisible:!1,shouldFocusOnMount:!1,hidden:m,calloutProps:{id:ve,styles:lt,layerProps:{eventBubblingEnabled:!0}},focusZoneAs:Ot,focusZoneProps:{disabled:m},onDismiss:function(e){var t,n;(null===(t=null==e?void 0:e.nativeEvent)||void 0===t?void 0:t.keyCode)===a.a.escape&&(null===(n=null==u?void 0:u.onDismiss)||void 0===n||n.call(u))},onRestoreFocus:I})})),Ot=function(e){return o.createElement(Se.a,{disableFirstFocus:!0,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,className:e.className},e.children)},kt=function(e,t){if(void 0!==e&&void 0!==t)return xt(e,t,At()?tt:nt)},Rt=function(e,t,n){if(void 0!==t&&void 0===n){var o=At()?ot:rt;if(!e)return o;var r=yt(t);return r<=2/3*o?r:2/3*o}},wt=Object(i.c)((function(){return Object(fe.isChangeGateEnabled)("OfficeVSO:7921247_fixAutoCompleteOverFlowBug")})),At=Object(i.c)((function(){return Object(fe.isChangeGateEnabled)("OfficeVSO:7982656_isFluentvNextChangesEnabled")})),jt=Object(i.c)((function(){return Object(fe.isChangeGateEnabled)("OfficeVSO:8593118_AutoCompleteEnumDescriptions")})),Tt="formulaRepair-callout",Ft=n(2470),It=n(88),Dt=Oe.b.getInstance().getTheme(),Nt=Dt.palette,Mt={root:{margin:"0 8px",padding:0,height:5,":before":{backgroundColor:Nt.neutralQuaternaryAlt}}},zt=Object(i.c)((function(){var e;return Object(p.eb)({"&:hover":(e={},e[p.m]={},e),"&:focus":{outline:"-webkit-focus-ring-color auto 1px"}})})),Wt=Object(i.c)((function(){return Object(p.db)(Object(Pe.b)(Dt),{linkContent:{color:Nt.neutralDark,minHeight:24,cursor:"pointer",userSelect:"none","&:hover":Object(s.__assign)({},f.o)}})})),Ht=Object(i.c)((function(e){return Object(p.eb)({justifyContent:"space-between",display:"flex",width:"100%",padding:"2px 5px",margin:"0px 4px",borderRadius:4,backgroundColor:e?Nt.neutralLighterAlt:Nt.white,"&:hover":{backgroundColor:Nt.neutralLighter}})})),Bt=Object(i.c)((function(){return Object(p.db)(O,{root:{maxWidth:340,minWidth:240},list:Object(s.__assign)({maxHeight:72,overflowY:"auto"},P)})})),Gt={root:{root:{padding:"8px ".concat(12,"px 3px ").concat(12,"px")}},title:{root:{fontSize:p.k.size12,fontWeight:p.l.semibold,lineHeight:p.k.size12,color:Nt.neutralDark,padding:0}},description:{root:{color:Nt.neutralSecondary,fontSize:p.k.size12,lineHeight:p.k.size16,fontWeight:p.l.regular,selectors:(St={},St[p.m]={color:"WindowText"},St)}}},Kt={root:{padding:"0px ".concat(12,"px 5px ").concat(12,"px")}},Lt=Object(i.c)((function(){return Object(p.eb)({fontSize:p.k.size12,borderBottom:"1px solid transparent",padding:"0px 3px",height:"24px",":hover":{backgroundColor:Nt.neutralLighterAlt,color:Nt.black,border:"1px solid "+Nt.neutralLighter}})})),Vt={root:{width:12,marginLeft:0}},Ut={root:{backgroundColor:"rgb(210, 224, 244)",borderRadius:"2px"}},Jt={root:{font:"12px consolas"}},Qt={lineHeight:p.k.size16,flexGrow:"",alignSelf:"center",padding:"".concat(2,"px 0px"),margin:"0px 0px 0px 0px",overflow:"hidden",textOverflow:"ellipsis","-webkit-line-clamp":"2","-webkit-box-orient":"vertical",display:"-webkit-box","white-space":"normal","word-break":"break-all",flex:1},Yt=Object(i.c)((function(e){return e===Re.RepairItemPartType.None?Jt:Object(p.db)(Jt,Ut)})),Xt={padding:"0px",paddingLeft:"".concat(5,"px"),overflow:"hidden",textOverflow:"ellipsis",font:"12px consolas",alignSelf:"center"},Zt=Object(i.c)((function(e){return Object(p.eb)({padding:"0px",width:"".concat(e,"px"),overflow:"hidden",textOverflow:"ellipsis",fontSize:"12px"})})),qt=n(638),$t=n(785),en=function(e){var t=e.onIgnore,n=e.onFeedback,a=e.onApply,i=o.useContext(pe).isFeedbackAllowed,l=Object(o.useMemo)((function(){return Object(fe.isChangeGateEnabled)("OfficeVSO:8232494_formulaRepairCardUIAdditions")}),[]);return o.createElement(r.a,{styles:Kt,horizontal:!0,horizontalAlign:"space-between"},l?o.createElement(r.a,{horizontal:!0,horizontalAlign:"start"},Et(a)&&o.createElement(qt.a,{className:Lt(),text:ExcelRibbonStrings.Apply,onClick:a,iconProps:{iconName:m.a.Checkmark_16,styles:Vt}}),o.createElement(qt.a,{className:Lt(),text:ExcelRibbonStrings.FormulaAuthoringIgnore,onClick:t,iconProps:{iconName:m.a.DeleteHover_16,styles:Vt}})):o.createElement($t.a,{styles:{root:{fontSize:p.k.size12,borderBottom:"1px solid transparent",padding:0}},text:ExcelRibbonStrings.FormulaAuthoringIgnore,onClick:t}),i&&o.createElement(me,{disabled:!1,onClick:n}))},tn=function(e,t){return o.createElement(r.a,{styles:Gt.root,tokens:{childrenGap:2}},o.createElement(Z.a,{styles:Gt.title},e),o.createElement(Z.a,{styles:Gt.description},t))},nn=function(e){var t=e.title,n=e.description,o=e.repairs,r=null!=t?t:ExcelRibbonStrings.FormulaRepairDefaultTitle,a=null!=n?n:1===o?ExcelRibbonStrings.FormulaRepairDefaultDescriptionSingle:ExcelRibbonStrings.FormulaRepairDefaultDescriptionMultiple.replace("{0}",o.toString());return tn(r,a)},on=function(e){var t=e.item,n=e.repairParts,r=e.isChecked,a=Object(o.useMemo)((function(){return xt(t.text,t.secondaryText,311,"12px consolas")}),[t.text,t.secondaryText]),i=Object(s.__assign)(Object(s.__assign)({},Xt),{width:"".concat(a,"px")}),l=n.filter(Et);return o.createElement("div",{className:Ht(r)},o.createElement("div",{style:Qt},l.map((function(e){var n,r;return o.createElement(Z.a,{key:e.location.start,styles:Yt(e.type),style:{color:null!==(n=e.color)&&void 0!==n?n:void 0}},null===(r=t.text)||void 0===r?void 0:r.substring(e.location.start,e.location.end))}))),t.secondaryText&&o.createElement(Z.a,{style:i},t.secondaryText))},rn=function(e){var t=e.diagnostics,n=e.description,a=e.repairs,i=e.callbacks,l=Object(s.__rest)(e,["diagnostics","description","repairs","callbacks"]),c=Bt(),u=void 0!==(null==i?void 0:i.getItemHighlights),d=Object(o.useMemo)((function(){return Object(fe.isChangeGateEnabled)("OfficeVSO:8232494_formulaRepairCardUIAdditions")}),[]),m=o.useMemo((function(){return Object(_e.a)(a)}),[a]),p=m.length>1,g=function(e,t){var n=Object(o.useState)(0),r=n[0],a=n[1],i=Object(o.useState)(),l=i[0],c=i[1],s=Object(o.useRef)([]).current,u=Object(o.useCallback)((function(n,o){var r,a;Ct(s[n])&&(s[n]=null==t?void 0:t(e[n])),null===(r=s[n])||void 0===r||r.highlightRanges(o),c(null===(a=s[n])||void 0===a?void 0:a.coloredParts)}),[t,s,e]);Object(o.useEffect)((function(){return u(0,!0),function(){return u(0,!1)}}),[u]);return[r,function(e){e!==r&&(u(r,!1),u(e,!0),a(e))},l]}(m,null==i?void 0:i.getItemHighlights),f=g[0],b=g[1],h=g[2],v=function(e){return function(t){var n;"Enter"===t.nativeEvent.key&&(t.preventDefault(),null===(n=null==i?void 0:i.onCommit)||void 0===n||n.call(i,e))}},x=function(e,t){return function(n,r){var a,l=function(){return b(t)};return o.createElement("div",{role:"menuitem",className:zt(),"data-is-focusable":!0,onPointerDown:(a=e,function(e){var t;e.preventDefault(),null===(t=null==i?void 0:i.onCommit)||void 0===t||t.call(i,a)}),onKeyDown:v(e),onMouseEnter:l,onFocus:l},o.createElement(xe.a,{classNames:Wt(),hasIcons:!1,index:t,item:n}))}},y=function(e){return o.createElement(on,Object(s.__assign)({},e,{isChecked:p&&f===e.index,repairParts:f===e.index&&Et(h)?h:m[e.index].repairedFormulaParts}))},E=o.useCallback((function(){var e,t=m[p?f:0];t?null===(e=null==i?void 0:i.onCommit)||void 0===e||e.call(i,t):z.a.sendTraceTag(508179275,W.a.msoulscat_ES_EWAJS,H.a.Error,"FormulaRepairCard: onApply: repair is undefined")}),[i,m,f,p]),C=o.useCallback((function(e,a){var l=Object(s.__assign)(Object(s.__assign)({},e),{items:null==e?void 0:e.items});return o.createElement("div",{ref:null==i?void 0:i.onRender},o.createElement(r.a,{tokens:{childrenGap:4}},o.createElement(nn,{title:t,description:n,repairs:m.length}),a(l),d&&o.createElement(Ft.a,{styles:Mt}),o.createElement(en,{onFeedback:function(e){var t;null===(t=null==i?void 0:i.onFeedback)||void 0===t||t.call(i)},onIgnore:function(e){var t;null===(t=null==i?void 0:i.onIgnore)||void 0===t||t.call(i)},onApply:d?E:void 0})))}),[n,t,m,i,d,E]),_=m.map((function(e,t){return{key:e.text,text:e.text,secondaryText:ln(e.formulaValue)?void 0:" = ".concat(e.formulaValue),onRender:x(e,t),onRenderContent:u?y:(n=e,function(e,t){var r,a,i;return e.item.secondaryText&&(a=kt(e.item.text,e.item.secondaryText),i=Zt(a)),o.createElement("div",{style:{justifyContent:"space-between",display:"flex",width:"100%"}},o.createElement("div",{style:Qt},null===(r=n.repairedFormulaParts)||void 0===r?void 0:r.map((function(t){var n,r=Yt(t.type);return o.createElement(o.Fragment,{key:t.location.start},o.createElement(Z.a,{styles:r},null===(n=e.item.text)||void 0===n?void 0:n.substring(t.location.start,t.location.end)))}))),e.item.secondaryText&&t.renderSecondaryText(Object(s.__assign)(Object(s.__assign)({},e),{classNames:Object(s.__assign)(Object(s.__assign)({},e.classNames),{secondaryText:"".concat(e.classNames.secondaryText," ").concat(i)})})))})};var n}));return o.createElement(Ce.a,{items:_,styles:c,onRenderMenuList:C,isBeakVisible:!1,shouldFocusOnMount:!1,calloutProps:{id:Tt,styles:S,layerProps:{eventBubblingEnabled:!0},onPointerDown:function(e){e.preventDefault()}},gapSpace:4,onDismiss:function(){var e;null===(e=null==i?void 0:i.onDismiss)||void 0===e||e.call(i)},target:l.target,directionalHint:"below"===l.renderLocation?It.a.bottomLeftEdge:It.a.rightTopEdge,onRestoreFocus:an})},an=function(){},ln=function(e){return null==e||0===e.length},cn=n(105),sn=n(53),un=n(1384),dn=n(1150),mn=n(223),pn=n(2084),gn=n(390),fn={root:{direction:"ltr"},subText:{overflow:"hidden",whiteSpace:"pre",textOverflow:"ellipsis",fontFamily:'Consolas, "Courier New", monospace'}},bn=o.memo((function(e){var t,n=e.isLoaded,r=e.value,a=e.textColor,i=Object(s.__rest)(e,["isLoaded","value","textColor"]);return n?(t=r||void 0,Et(a)&&(t=o.createElement("span",{style:{color:a}},t))):t=o.createElement(pn.a,{type:"AppSpinnerProps",id:"ValuePreviewSpinner",appColors:Object(b.a)(),spinnerSize:gn.a.small}),o.createElement(mn.a,null,(function(e){return o.createElement(dn.a,Object(s.__assign)({},i,{calloutProps:{styles:Object(un.a)(e),beakWidth:10},content:t,styles:fn,directionalHint:It.a.topCenter}))}))})),hn=function(){return tn(ExcelRibbonStrings.FormulaRepairDefaultTitle,ExcelRibbonStrings.FormulaSyntaxErrorIndicationDescription)},vn=function(e){var t=Object(s.__rest)(e,[]);return o.createElement(u.a,{isBeakVisible:!1,id:Tt,styles:S,layerProps:{eventBubblingEnabled:!0},onPointerDown:function(e){e.preventDefault()},onDismiss:function(){var e;null===(e=null==t?void 0:t.onDismiss)||void 0===e||e.call(t)},target:t.target,gapSpace:4,directionalHint:It.a.rightTopEdge,focusTrapProps:{isClickableOutsideFocusTrap:!0,disableFirstFocus:!0,forceFocusInsideTrap:!1}},o.createElement("div",{ref:null==t?void 0:t.onRender},o.createElement(r.a,{tokens:{childrenGap:8}},o.createElement(hn,null),o.createElement(en,{onFeedback:function(e){var n;null===(n=null==t?void 0:t.onFeedback)||void 0===n||n.call(t)},onIgnore:function(e){var n;null===(n=null==t?void 0:t.onIgnore)||void 0===n||n.call(t)}}))))},xn=n(2478),yn=Oe.b.getInstance().getTheme(),En=Object(i.c)((function(){return Object(p.eb)({backgroundColor:yn.palette.white,border:"1px solid",borderColor:yn.palette.neutralQuaternary,borderRadius:"2px",boxShadow:"0px 2px 2px rgba(0, 0, 0, 0.1)",height:"28px",width:"28px"})})),Cn={root:{width:"100%",height:"100%"}},Sn=function(e){var t=e.onClick,n=e.target;return o.createElement(Y.a,null,o.createElement(xn.a,{target:n,directionalHint:It.a.rightCenter,offsetFromTarget:5,className:En()},o.createElement(M.a,{onClick:t,id:"formula-repair-icon",customTooltip:ExcelRibbonStrings.FormulaRepairAvailable,ariaLabel:ExcelRibbonStrings.FormulaRepairAvailable,tooltipDirection:It.a.topCenter,iconProps:{iconName:m.a.SearchTools_16},styles:Cn})))};!function(e){e[e.ArgumentAssistanceCard=0]="ArgumentAssistanceCard",e[e.AutoCompleteMenu=1]="AutoCompleteMenu",e[e.ValuePreview=2]="ValuePreview"}(_t||(_t={}));var _n=function(){function e(e){this.context={isFeedbackAllowed:!1},this.componentApis={},this.componentRefs={},this.lastGetTargetAndBounds=null,this.lastProps=new Map,this.position={x:0,y:0,renderDown:!0},this.useFixedPosition=!1,e&&(this.context=Object(s.__assign)(Object(s.__assign)({},this.context),e))}return e.prototype.onLayoutChange=function(e){var t=e.x,n=e.y,o=e.renderDown;this.position.x=t,this.position.y=n,this.position.renderDown=o},e.prototype.getTargetAndBounds=function(e){if(void 0===e&&(e=!1),this.useFixedPosition&&!e){var t=this.position,n=t.x,o=t.y,r=t.renderDown;return{target:{top:o,left:n,right:n,bottom:o},bounds:{top:0,left:0,right:innerWidth,bottom:innerHeight},isFloating:!0,renderDown:r}}Ct(this.lastGetTargetAndBounds)&&z.a.sendTraceTag(512313119,W.a.msoulscat_ES_EWAJS,H.a.Error,"FormulaAssistanceUIControl.getTargetAndBounds: "+"this.lastGetTargetAndBounds is ".concat(this.lastGetTargetAndBounds,"."));var a=this.lastGetTargetAndBounds();if(Ct(a)||Ct(a.target)||Ct(a.bounds)){var i=JSON.stringify(a);z.a.sendTraceTag(512313118,W.a.msoulscat_ES_EWAJS,H.a.Error,"FormulaAssistanceUIControl.getTargetAndBounds: "+"this.lastGetTargetAndBounds() returned: ".concat(i,"."))}return{target:a.target,bounds:a.bounds,isFloating:!1,renderDown:this.position.renderDown}},e.prototype.renderControl=function(e,t,n,r){var a=this;if(t&&n){this.lastGetTargetAndBounds=r,this.componentRefs[e]||(this.componentRefs[e]=o.createRef());var i,l={type:e,rendered:!0,ref:this.componentRefs[e],getTargetAndBounds:this.getTargetAndBounds.bind(this),onLayoutChange:this.onLayoutChange.bind(this),setComponentApi:function(t){a.componentApis[e]=t}};switch(e){case _t.ArgumentAssistanceCard:i=o.createElement(be,Object(s.__assign)({},l,n));break;case _t.AutoCompleteMenu:i=o.createElement(Pt,Object(s.__assign)({},l,n,{disableItemReadout:!0}))}z.a.shipAssertTag(520926812,W.a.msoulscat_ES_EWAJS,Et(i),"FormulaAssistanceUIControl.renderControl: "+"control is ".concat(i," because the type '").concat(e,"' is unknown.")),sn.render(o.createElement(pe.Provider,{value:this.context},i),t),this.lastProps.set(t,Object(s.__assign)(Object(s.__assign)({},l),n))}},e.prototype.renderArgumentAssistanceCard=function(e,t,n){this.renderControl(_t.ArgumentAssistanceCard,e,t,n)},e.prototype.renderAutoCompleteMenu=function(e,t,n){this.renderControl(_t.AutoCompleteMenu,e,t,n)},e.prototype.renderValuePreview=function(e,t,n){e&&t&&n&&sn.render(o.createElement(bn,Object(s.__assign)({},n,{targetElement:t})),e)},e.prototype.renderFormulaRepair=function(e,t,n){e&&t&&n&&sn.render(o.createElement(pe.Provider,{value:this.context},o.createElement(rn,Object(s.__assign)({},n,{target:t}))),e)},e.prototype.renderFormulaRepairIcon=function(e,t,n){e&&t&&n&&sn.render(o.createElement(pe.Provider,{value:this.context},o.createElement(Sn,{onClick:n,target:t})),e)},e.prototype.renderSyntaxErrorIndication=function(e,t,n){e&&t&&n&&sn.render(o.createElement(pe.Provider,{value:this.context},o.createElement(vn,Object(s.__assign)({},n,{target:t}))),e)},e.prototype.dismiss=function(e){if(e)if(this.lastProps.has(e)){var t=this.lastProps.get(e);if(t&&t.rendered){t.rendered=!1;var n=null;switch(t.type){case _t.AutoCompleteMenu:n=o.createElement(Pt,Object(s.__assign)({},t,{hidden:!0}));break;case _t.ArgumentAssistanceCard:n=o.createElement(be,Object(s.__assign)({},t,{hidden:!0}))}n&&sn.render(o.createElement(pe.Provider,{value:this.context},n),e)}}else sn.unmountComponentAtNode(e)},e.prototype.focus=function(e){var t=this.getRootElement(e);return this.focusElement(t)},e.prototype.focusElement=function(e){return!!e&&Object(cn.c)(e)},e.prototype.getRootElement=function(e){var t;return(null===(t=this.componentRefs[e])||void 0===t?void 0:t.current)||null},e.prototype.getCalloutElement=function(e){switch(e){case _t.ArgumentAssistanceCard:return document.getElementById(l);default:return null}},e.prototype.getDraggableElement=function(e){switch(e){case _t.ArgumentAssistanceCard:return document.getElementById(c);default:return null}},e.prototype.updatePosition=function(e){var t;null===(t=this.componentApis[e])||void 0===t||t.updatePosition()},e.prototype.updateContext=function(e){this.context=Object(s.__assign)(Object(s.__assign)({},this.context),e)},e.prototype.getPosition=function(){return this.position},e.prototype.setFixedPosition=function(e){this.useFixedPosition=Et(e),e&&(this.position.x=e.x,this.position.y=e.y,this.position.renderDown=e.renderDown)},e}(),Pn=n(532),On=new(function(){function e(){}return e.prototype.create=function(e){return Pn.a.registerUiSlice20Icons(),new _n(e)},e}())},219:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(3);o.__exportStar(n(1972),t),o.__exportStar(n(1973),t),o.__exportStar(n(1974),t),o.__exportStar(n(1975),t),o.__exportStar(n(1976),t),o.__exportStar(n(1977),t),o.__exportStar(n(1978),t),o.__exportStar(n(1979),t),o.__exportStar(n(1980),t),o.__exportStar(n(1981),t),o.__exportStar(n(1982),t),o.__exportStar(n(1983),t)}},[[2002,2,0,1]]]);
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/formulaAssistance.min.js.map/28eada4f651af75ad718d9da2973c47b/formulaAssistance.min.js.map