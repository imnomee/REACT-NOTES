'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{226:function(y,x,a){a.r(x);var c={};a.r(c);a.d(c,"BIExploreCommandHandler",function(){return N});var b={};a.r(b);a.d(b,"BIExploreManager",function(){return qb});var f={};a.r(f);a.d(f,"DataRefreshCommandHandler",function(){return gb});var r={};a.r(r);a.d(r,"DataRefreshManager",function(){return He});var d={};a.r(d);a.d(d,"DeletePivotTableWebMethodActivity",function(){return id});var k={};a.r(k);a.d(k,"FieldListCommandHandler",
function(){return Fd});var t={};a.r(t);a.d(t,"FieldListRequestStateManager",function(){return dc});var m={};a.r(m);a.d(m,"FieldManagerPane",function(){return rc});var e={};a.r(e);a.d(e,"InsertPivotTableCommandHandler",function(){return ce});var w={};a.r(w);a.d(w,"InsertSlicerCommandHandler",function(){return ie});var l={};a.r(l);a.d(l,"OfferPowerBiTrialActivity",function(){return Ca});var u={};a.r(u);a.d(u,"PivotCommandHandler",function(){return af});var n={};a.r(n);a.d(n,"PivotTableSettingsPaneManager",
function(){return Ab});var v={};a.r(v);a.d(v,"PowerQueryManager",function(){return Uf});var B={};a.r(B);a.d(B,"PowerQueryPaneCommandHandler",function(){return Cd});var z={};a.r(z);a.d(z,"PowerQueryUIFlowManager",function(){return aa});var C=a(0),D=a(97),J=a(5),W=a(66);Object(D.b)(J.v)(ta=>No(function*(){const wb=yield D.a.resolve(J.w,ta);yield wb.xSk;return new N(wb)}));class N{constructor(ta){this.JHb=ta}Bi(ta,wb){if(1529658657===wb&&(8===ta||!this.JHb.zoj))return!0;1247109494!==wb&&-498523270!==
wb||this.JHb.jD();return!1}executeCommand(ta,wb){this.JHb.LIk?this.JHb.ouk(3===wb.method):this.JHb.jD();return W.Task.Va(!0)}ni(ta,wb){return 1529658657===wb.command}Ji(){return!1}}Object(C.a)(N,"BIExploreCommandHandler",null,[39]);var M=a(179),Q=a(14),R=a(586),O=a(96),U=a(158),K=a(353),F=a(80),I=a(55),P=a(301),Y=a(302),ea=a(17),Ba=a(963),Fa=a(57);class za{}za.Nji="ewa-bix-ltr";za.Oji="ewa-bix-rtl";za.Rji="ewa-bix-titlebar";za.Pji="ewa-bix-subtitle";za.Qji="ewa-bix-title";za.qrf="ewa-bix-close";za.S3=
"clip16x16";za.Gji="ewa-bix-body";za.Lji="ewa-bix-drilldetails";za.Iji="ewa-bix-DrillButton";za.Mji="ewa-bix-hover";za.Jji="ewa-bix-DrillLabel1";za.Kji="ewa-bix-DrillLabel2";za.Sji="ewa-bixfl";za.rrf="ewa-bixfl-NoFocus";za.Vji="ewa-bixfl-ItemSelected";za.Tji="ewa-bixfl-Icon";za.Uji="ewa-bixfl-Item";za.Hji="ewa-bix-calloutBackground";za.Quc="ewa-ipad";Object(C.a)(za,"CssClassNames",null,[]);var xa=a(19),fa=a(7),V=a(62),ba=a(31),la=a(263),Ta=a(16),Ea=a(74),sa=a(12),Ya=a(24),bb=a(217);class ra extends la.a{constructor(ta,
wb,ic,Oa,Cb,yc){super(wb);this.yAd=["bix-drill-action-down","bix-drill-action-up","bix-drill-action-to"];this.rrc=-1;this.iIa=this.EMb=this.DMb=this.FMb=null;this.fj=Nc=>{const Id=this.domElement;let ke=Nc.target;for(;ke!==Id;){if(ke.id.startsWith("bix-drill-action")){this.drillTo(this.rrc,ke.id);Ea.g(Nc);break}ke=ke.parentNode}};this.Qmg=(Nc,Id)=>{Nc=-1===this.rrc;const ke=Id.R5i;this.rrc=ke;let Ie=null;ke===this.n7e.HierarchyId?(this.tLg(!1),this.drillUp||this.drillDown?(this.uLg(!0),Ta.DOMElementExtensions.setVisible(this.domElement,
!0),Ie=this.DMb||this.FMb):Ta.DOMElementExtensions.setVisible(this.domElement,!1)):(this.uLg(!1),Ie=this.EMb,ra.yzk(Ie,Id.caption,sa.a.instance.ia(1195)),this.tLg(!0),Ta.DOMElementExtensions.setVisible(this.domElement,!0));Nc||this.LLg(Ie)};this.$=ta;this.fG=ic;this.n7e=Oa.Context;ta=Oa.DrillContext;this.drillUp=ta.DrillUp;this.drillDown=ta.DrillDown;this.sPd=Cb;this.sT=yc;Cb.Vzh(this.Qmg);this.V1h()}dispose(){this.sPd&&this.sPd.hkk(this.Qmg);this.yAd=this.FMb=this.DMb=this.EMb=this.iIa=this.sT=this.drillUp=
this.drillDown=this.n7e=this.fG=this.sT=this.sPd=this.$=null;super.dispose()}focus(){this.setFocus(!0)}hasFocus(){var ta=Ta.DOMElementExtensions.Yz(this.domElement);if(!ta)return!1;ta=ta.id;return!!ta&&ta.startsWith("bix-drill-action")}onKeyDown(ta){const wb=ta.keyCode;ta=ta.shiftKey;if(this.hasFocus()){let ic=!1;13===wb?(this.drillTo(this.rrc,this.iIa.id),ic=!0):9===wb&&((ic=this.moveFocus(!ta))||this.Nkf());return ic}return 9===wb?this.setInitialFocus(!ta):!1}setFocus(ta){return this.hasFocus()?
this.moveFocus(ta):this.setInitialFocus(ta)}V1h(){Ta.DOMElementExtensions.UK(this.domElement,fa.a.cmc,null,null);let ta;let wb;if(this.drillDown){ta=sa.a.instance.ia(1197);var ic=this.drillDown.Caption;wb=String.format("{0} ({1})",ta,ic?ba.a.dlb(ic):"");ic=ic?ba.a.Xq(ic):"";this.domElement.appendChild(this.vwd("bix-drill-action-down",wb,"bixdddl_1",ta,"bixdddl_2",ic))}this.drillUp&&(ta=sa.a.instance.ia(1196),ic=this.drillUp.Caption,wb=String.format("{0} ({1})",ta,ic?ba.a.dlb(ic):""),ic=ic?ba.a.Xq(ic):
"",this.domElement.appendChild(this.vwd("bix-drill-action-up",wb,"bixddul_1",ta,"bixddul_2",ic)));this.domElement.appendChild(this.vwd("bix-drill-action-to","","bixddtl_1",sa.a.instance.ia(1195),"bixddtl_2",""));this.FMb=this.getElementById("bix-drill-action-up");this.DMb=this.getElementById("bix-drill-action-down");this.EMb=this.getElementById("bix-drill-action-to");this.Wi.Aa("click",this.fj);this.domElement.setAttribute(fa.a.dea,"");Ta.DOMElementExtensions.setVisible(this.domElement,!1)}vwd(ta,
wb,ic,Oa,Cb,yc){const Nc=document.createElement("button");Nc.id=ta;Nc.classList.add(za.Iji);Nc.tabIndex=-1;Nc.title=wb;Nc.style.display=bb.a.none;Nc.onkeyup=()=>!1;Nc.onkeypress=()=>!1;Nc.setAttribute(fa.a.Oj,fa.a.kpd);Nc.setAttribute(fa.a.zT,ic+" "+Cb);ta=document.createElement("div");ta.id=ic;ta.classList.add(za.Jji);ta.textContent=Oa;ic=document.createElement("div");ic.id=Cb;ic.classList.add(za.Kji);ic.textContent=yc;Nc.appendChild(ta);Nc.appendChild(ic);return Nc}drillTo(ta,wb){let ic;switch(wb){case "bix-drill-action-up":ic=
this.drillUp.Id;break;case "bix-drill-action-down":ic=this.drillDown.Id;break;case "bix-drill-action-to":ic=1;break;default:return}Ya.f(this.$).Cz(!0);this.sT.pWh((Oa,Cb,yc)=>{var Nc=this.fG,Id=this.$.pa.ta,ke=Nc.confirmationRequiredForDataOps,Ie=ic;Nc=V.M(Id,Nc.sB,Nc.externalSourceIndex,this.fG.l1);Nc.requiresConfirmation=ke;Nc.hierarchyId=ta;Nc.levelId=Ie;return V.h(Id,"BixDrill",Nc,Oa,Cb,yc,null,0)})}moveFocus(ta){let wb=0;if(this.iIa)switch(this.iIa.id){case "bix-drill-action-down":wb=0;break;
case "bix-drill-action-up":wb=1;break;case "bix-drill-action-to":wb=2}return this.GMg(ta?wb+1:wb-1,ta)}Nkf(){const ta=this.iIa;ta&&(ta.blur(),this.domElement.setAttribute(fa.a.dea,""));this.iIa=null}tLg(ta){this.EMb&&Ta.DOMElementExtensions.setVisible(this.EMb,ta)}uLg(ta){this.FMb&&Ta.DOMElementExtensions.setVisible(this.FMb,ta);this.DMb&&Ta.DOMElementExtensions.setVisible(this.DMb,ta)}LLg(ta){ta!==this.iIa&&this.Nkf();if(!ta)return!1;ta.tabIndex=0;Ta.DOMElementExtensions.setFocus(ta);this.domElement.setAttribute(fa.a.dea,
ta.id);this.iIa=ta;return!0}setInitialFocus(ta){return this.GMg(ta?0:this.yAd.length-1,ta)}GMg(ta,wb){const ic=this.yAd;for(;0<=ta&&ta<ic.length;){const Oa=Ta.DOMElementExtensions.getElementById(this.domElement,ic[ta]);if(Oa&&Ta.DOMElementExtensions.isVisible(Oa))return this.LLg(Oa);ta=wb?ta+1:ta-1}return!1}static yzk(ta,wb,ic){ic=String.format("{0} ({1})",ic,wb);ta.setAttribute("title",ic);ta.lastChild.innerText=wb}}Object(C.a)(ra,"BixDrillDetails",la.a,[]);var Da=a(286),oa=a(34),Ha=a(39),ka=a(241),
wa=a(59),Za=a(195);const ab=za.Uji,db=za.Vji;class mb{constructor(ta,wb,ic,Oa,Cb){this._element=null;this.P8=this.visible=!0;this.fieldListSelector=ta;this.C6c=wb.Name||"";this.clientId=wb.ClientId;this.fSa=wb.IsCollapsible;this.parentId=wb.ClientParentId;this.Smh=wb.PivotCacheIndex;this.type=wb.TypeTag;this.H4g=wb.UserRank;this.H6i=ic;this.jjf=Oa;this.v7h=Cb;this.fieldListSelector.Cwh(this.clientId,this);this.children=[];wb.Children.forEach(yc=>{this.children.push(new mb(ta,yc,ic,Oa,Cb))})}get caption(){return this.C6c}get element(){return this._element||
(this._element=this.fieldListSelector.getElementById(mb.Xrb+this.clientId))}get d4i(){return-1!==this.parentId}get isCollapsed(){return this.P8}get isCollapsible(){return this.fSa}get isVisible(){return this.visible}get Arg(){return this.Smh}dispose(){this.children&&(O.a.Ni(this.children),this.children=null);this._element=null}edf(){for(const ta of this.children)ta.visible=!1,ta.fSa&&(ta.P8=!0,ta.QNg(),0<ta.children.length&&ta.edf())}Z3e(ta,wb){this.visible=!ta;var ic=11*ta,Oa=document.createElement("div");
if(this.fSa){this.P8=!0;Oa.id=this.IIa(mb.Usg);Oa.classList.add(za.Tji);Oa.setAttribute(Za.a.style,this.ZEf(ic+4));ic=document.createElement("div");ic.classList.add(xa.a.S3);var Cb=document.createElement("img");Cb.id=this.IIa(mb.Qae);Cb.classList.add(this.jjf);Cb.setAttribute(fa.a.Oj,fa.a.Yy);Cb.src=wa.a.$m(9);ic.appendChild(Cb);Oa.appendChild(ic)}else Oa.setAttribute(Za.a.style,this.ZEf(ic+23));ic=document.createElement("span");ic.id=this.IIa(mb.Wsg);ic.textContent=this.C6c;Cb=document.createElement("div");
Cb.id=this.IIa(mb.Xrb);Cb.classList.add(ab);Cb.tabIndex=-1;Cb.title=this.C6c;Cb.setAttribute(fa.a.Oj,fa.a.ppd);Cb.setAttribute(fa.a.BT,this.IIa(mb.Wsg));Cb.setAttribute(fa.a.Qka,"false");Cb.setAttribute(fa.a.s5e,ta+1);this.fSa&&(Cb.setAttribute(fa.a.Pka,"false"),Cb.setAttribute(fa.a.emc,this.IIa(mb.Vsg)));const yc=document.createElement("table");yc.setAttribute(Za.a.cellSpacing,0);yc.setAttribute(Za.a.cellPadding,0);yc.setAttribute(fa.a.Oj,fa.a.Yy);const Nc=document.createElement("tr"),Id=document.createElement("td");
Id.setAttribute(Za.a.style,"width: 8px");Id.appendChild(Oa);Oa=document.createElement("td");Oa.appendChild(ic);Nc.appendChild(Id);Nc.appendChild(Oa);yc.appendChild(Nc);Cb.appendChild(yc);wb.appendChild(Cb);if(this.fSa){++ta;const ke=document.createElement("div");ke.id=this.IIa(mb.Vsg);ke.setAttribute(fa.a.Oj,fa.a.IUa);ke.style.display=fa.a.JLc;this.children.forEach(Ie=>{Ie.Z3e(ta,ke)});wb.appendChild(ke)}}msc(){this.element.blur();this.element.tabIndex=-1}wri(){this.children.forEach(ta=>{ta.visible=
!0})}YCf(ta,wb){const ic=this.children;for(const Oa of ic)if(!Oa.fSa&&5===Oa.type&&Oa.H4g>wb&&(ta=Oa,wb=Oa.H4g,3===wb))return{returnValue:ta,Q2d:wb};for(const Oa of ic)if(Oa.fSa&&({Q2d:wb,returnValue:ta}=Oa.YCf(ta,wb),3===wb))break;return{returnValue:ta,Q2d:wb}}fTi(){let ta=this;for(;-1!==ta.parentId;)ta=this.fieldListSelector.dKd(ta.parentId);return ta}IEc(ta){let wb=this;for(;-1!==wb.parentId;){if(ta.clientId===wb.parentId)return!0;wb=this.fieldListSelector.dKd(wb.parentId)}return!1}setFocus(){this.element.tabIndex=
0;Ta.DOMElementExtensions.setFocus(this.element)}QNg(){const ta=Ta.DOMElementExtensions.getElementById(this.element,this.IIa(mb.Qae));if(ta){var wb=this.element.nextSibling;Ta.DOMElementExtensions.zBa(ta,this.P8,this.jjf,this.v7h);this.element.setAttribute(fa.a.Pka,this.P8?fa.a.RB:fa.a.pr);Ta.DOMElementExtensions.setVisible(wb,!this.P8)}}aEk(){const ta=this.fieldListSelector.domElement.querySelectorAll(`.${db}`);for(let wb=0;wb<ta.length;wb++){const ic=ta[wb];ic.classList.remove(db);ic.setAttribute(fa.a.Qka,
"false")}this.element.classList.add(db);this._element.setAttribute(fa.a.Qka,"true")}K8b(){(this.P8=!this.P8)?this.edf():this.wri();this.QNg()}IIa(ta){return ta+this.clientId}ZEf(ta){return String.format(this.H6i,ta.toString())}}mb.Usg="bixflec_";mb.Qae="bixfleci_";mb.Xrb="bixfli_";mb.Wsg="bixflil_";mb.Vsg="bixflg_";Object(C.a)(mb,"BixFieldListItem",null,[2]);class Ia extends Sys.EventArgs{constructor(ta,wb){super();this.R5i=ta;this.caption=wb}}Object(C.a)(Ia,"BixHierarchySelectionChangedEventArgs",
Sys.EventArgs,[]);var pa=a(13);class lb extends la.a{constructor(ta,wb,ic,Oa,Cb){super(wb);this.wud=0;this.FLa=new Ha.a(!1);this.gVc=-1;this.QS=this.zX=this.oJg=null;this.fj=Ie=>{Ie.Qh&&this.GQc(Ie.Qh);return!0};this.XI=Ie=>{Ie.button===Sys.UI.MouseButton.leftButton&&Ie.target&&(this.GQc(Ie.target),Ea.g(Ie))};this.onDoubleClick=Ie=>{if(Ie.button===Sys.UI.MouseButton.leftButton&&Ie.target){var Le;if(0!==(()=>{let Kf=this.cxf(Ie.target);({Xic:Le}=Kf);return Kf})().returnValue){Ea.g(Ie);var wf=this.lFf(Le);
wf&&wf.isCollapsible&&this.K8b(wf)}}};(this.touchMode=Cb)?Da.a.instance.ya(ea.a.click,this.domElement,this.fj):(this.Wi.Aa("mousedown",this.XI),this.Wi.Aa("dblclick",this.onDoubleClick));this.aTg=!oa.a.joj&&!Cb;let yc;ta.isChromeRtl?(yc="padding-right:{0}px;",this.wud=39):(yc="padding-left:{0}px;",this.wud=37);const Nc=new ka.a(Oa.ExcludeHierarchies);Nc.Rka.sort((Ie,Le)=>Ie-Le);let Id=-1,ke=null;if(ta=(()=>{let Ie=this.qRf(ic.FieldListItems,Nc,Id,ke,Oa.Context);({XWb:Id,Kl:ke}=Ie);return Ie})().returnValue)1===
ta.length&&(ta=[...ta[0].Children],ta.forEach(Ie=>{Ie.ClientParentId=-1})),ta.length&&(this.fieldListItems=[],ta.forEach(Ie=>{this.fieldListItems.push(new mb(this,Ie,yc,xa.a.Jmi,xa.a.Kmi))}),ke||(ke=lb.sui(ta,Oa.Context.DimensionCaption)||ta[0]),this.Kl=this.dKd(ke.ClientId),this.T2h())}Vzh(ta){this.get_events().addHandler("SelectionChanged",ta)}hkk(ta){this.get_events().removeHandler("SelectionChanged",ta)}get Aoj(){return!!this.fieldListItems}dispose(){this.touchMode&&(Da.a.instance.Na(ea.a.click,
this.domElement,this.fj),this.touchMode=!1);this.QS=null;this.fieldListItems&&(O.a.Ni(this.fieldListItems),this.fieldListItems=null);this.FLa=null;super.dispose()}focus(){this.setFocus(!0)}Cwh(ta,wb){this.FLa.add(ta.toString(),wb)}dKd(ta){ta=ta.toString();return this.FLa.Vg(ta)?this.FLa.getItem(ta):null}hasFocus(){var ta=Ta.DOMElementExtensions.Yz(this.QS);return ta?(ta=ta.id)&&ta.startsWith(mb.Xrb)&&this.zX?!0:!1:!1}onKeyDown(ta){ta=ta.keyCode;if(this.hasFocus()){var wb=!1;38===ta||40===ta?(this.moveFocus(40===
ta),wb=!0):37===ta||39===ta?(ta=ta===this.wud,wb=this.zX,wb.isCollapsible&&wb.isCollapsed!==ta?this.K8b(wb):ta&&wb.d4i&&this.moveFocus(!1),wb=!0):13===ta||32===ta?((ta=this.zX)&&this.select(ta),wb=!0):9===ta&&this.Okf(!0);return wb}return 9===ta?this.zX?this.M5b(this.zX):this.setInitialFocus(!0):!1}lyk(){this.QS.setAttribute(fa.a.p5e,"bix-drilldetails")}setFocus(ta){return this.QS.firstChild?this.hasFocus()?this.moveFocus(ta):this.zX?this.M5b(this.zX):this.setInitialFocus(ta):!1}start(){this.Kl&&
(this.select(this.Kl.fTi()),this.zX&&this.scroll(this.zX,!0))}T2h(){this.QS=this.domElement;this.fieldListItems.forEach(ta=>{ta.Z3e(0,this.QS)});Ta.DOMElementExtensions.UK(this.QS,fa.a.qpd,null,null,null);this.QS.setAttribute(fa.a.RC,sa.a.instance.ia(1198));this.QS.classList.add(xa.a.YG);this.QS.style.position="relative"}pMi(ta){for(;ta&&ta!==this.QS;){const wb=ta.id;if(wb&&wb.startsWith(mb.Xrb))return ta;ta=ta.parentNode}return null}qRf(ta,wb,ic,Oa,Cb){const yc=ic;if(!ta||!ta.length)return{returnValue:null,
XWb:ic,Kl:Oa};let Nc=0;for(let Id=0,ke=ta.length;Id<ke;Id++){const Ie=ta[Id];if(lb.Ekj(wb,Ie))ta[Id]=null,++Nc;else{Ie.ClientParentId=yc;Ie.ClientId=++ic;if(Ie.IsCollapsible&&(Ie.Children=(()=>{let Le=this.qRf(Ie.Children,wb,ic,Oa,Cb);({XWb:ic,Kl:Oa}=Le);return Le})().returnValue,!Ie.Children)){ta[Id]=null;++Nc;continue}5!==Ie.TypeTag&&3!==Ie.TypeTag||Ie.PivotCacheIndex!==Cb.HierarchyId||(Ie.UserRank=3,Oa=Ie)}}return Nc?Nc===ta.length?{returnValue:null,XWb:ic,Kl:Oa}:{returnValue:lb.ohk(ta),XWb:ic,
Kl:Oa}:{returnValue:ta,XWb:ic,Kl:Oa}}Okf(ta){const wb=this.zX;wb&&(wb.msc(),this.QS.setAttribute(fa.a.dea,""));this.msc();ta||(this.zX=null)}msc(){this.aTg&&this.QS.classList.add(za.rrf)}moveFocus(ta){let wb=this.zX;if(!wb)return this.setInitialFocus(ta);const ic=this.FLa.values,Oa=ic.length;let Cb=Array.indexOf(ic,wb);for(Cb=ta?++Cb:--Cb;0<=Cb&&Cb<Oa;){wb=ic[Cb];if(wb.isVisible)return this.M5b(wb),this.scroll(wb,ta),!0;Cb=ta?++Cb:--Cb}return!1}scroll(ta,wb){var ic=ta.element;ta=ic.offsetHeight;ic=
ic.offsetTop;const Oa=this.QS,Cb=Oa.scrollTop,yc=(Math.floor(Oa.clientHeight/ta)-3)*ta;let Nc=Oa.scrollTop;wb?ic>Cb+ta+yc&&(Nc=ic-(ta+yc)):ic<Cb+ta&&(Nc=ic-ta);Oa.scrollTop=Nc}setInitialFocus(ta){const wb=this.FLa.count;let ic=ta?0:wb-1;for(;0<=ic&&ic<wb;){const Oa=this.FLa.Tm(ic);if(Oa.isVisible)return this.M5b(Oa),this.scroll(Oa,!0),!0;ic=ta?++ic:--ic}return!1}M5b(ta){this.zX&&ta!==this.zX&&this.Okf(!1);if(!ta)return!1;this.QS.setAttribute(fa.a.dea,ta.element.id);this.zX=ta;-1!==this.gVc&&(ta.setFocus(),
this.aTg&&this.QS.classList.remove(za.rrf));return!0}cxf(ta){for(;ta&&ta!==this.QS;){const wb=ta.id;if(wb.startsWith(mb.Xrb))return{returnValue:1,Xic:ta};if(wb.startsWith(mb.Usg)||wb.startsWith(mb.Qae))return{returnValue:2,Xic:ta};ta=ta.parentNode}return{returnValue:0,Xic:null}}lFf(ta){if(!ta.id||!ta.id.startsWith(mb.Xrb)&&(ta=this.pMi(ta),!ta))return null;ta=ta.id.split("_")[1];return Ha.a.gj(this.FLa.eB,ta)}GQc(ta){let wb;const ic=(()=>{let Cb=this.cxf(ta);({Xic:wb}=Cb);return Cb})().returnValue;
if(0!==ic){var Oa=this.lFf(wb);if(Oa)switch(ic){case 2:this.K8b(Oa);break;case 1:this.select(Oa)}}}select(ta){if(ta){ta.aEk();this.M5b(ta);if(ta.isCollapsible){let wb=-1;({Q2d:wb,returnValue:ta}=ta.YCf(null,wb));if(!ta)return}this.Kl=ta;this.gVc!==ta.Arg&&(this.gVc=ta.Arg,this.oJg=ta.caption,this.raiseEvent("SelectionChanged",new Ia(this.gVc,this.oJg)),this.hasFocus()||this.msc())}}K8b(ta){ta.K8b();ta.isCollapsed&&this.Kl&&this.Kl.IEc(ta)&&this.select(ta);this.scroll(ta,!ta.isCollapsed)}static sui(ta,
wb){for(const ic of ta)if(11===ic.TypeTag&&ic.Name===wb)return ic;return null}static Ekj(ta,wb){switch(wb.TypeTag){case 5:case 3:break;default:return!1}return 0<=pa.HelperMethods.KJ(ta,0,ta.XIa(),wb.PivotCacheIndex,(ic,Oa)=>ic-Oa)}static ohk(ta){let wb=null;for(let ic=0;ic<ta.length;ic++)ta[ic]&&(wb||(wb=[]),wb.push(ta[ic]));return wb}}Object(C.a)(lb,"BixFieldListSelector",la.a,[506]);var ha=a(79),ua=a(40),fb=a(243),Ka=a(58),La=a(54),ib=a(252),Yb=a(262),Wc=a(78),Qc=a(98),Wb=a(93);class Jc extends Ba.a{constructor(ta,
wb,ic,Oa){super(ta,sa.a.instance.ia(1192),!0,4);this.fieldListSelector=this.E3=this.R1a=this.OL=this.n7c=this.cma=null;this.iLe=!1;this.fQj=(yc,Nc)=>{if(this.domElement&&(this.R1a.A7a(),!ib.a(yc))){const Id=yc.Result;Id&&this.xRk(Id,Nc);super.bba(yc,null,"")}};this.yMk=()=>{this.NHb.textContent=sa.a.instance.ia(1194);const yc=this.Mqa.querySelector("."+za.qrf);yc.tabIndex=-1;Ta.DOMElementExtensions.setFocus(yc)};this.bqb=()=>{this.close(1);return!0};this.domElement.id=ta.domElement.id+"_BIExploreCallout";
this.fG=wb;this.targetElement=ic;this.pFg=!1;this.domElement.classList.remove(this.rtl?Fa.a.mCd:Fa.a.lCd);this.domElement.classList.remove(xa.a.$C);this.domElement.classList.add(this.rtl?za.Oji:za.Nji);(this.touchMode=Oa)||this.domElement.classList.add(za.Mji);this.Mqa.className=za.Rji;this.Mqa.style.backgroundImage="";this.vBa.className=za.Qji;this.oI.parentNode.className=za.qrf;ta=this.dj;ta.className="";wb=document.createElement("div");wb.id="bix-subtitle";wb.classList.add(za.Pji);wb.textContent=
Qc.a.zm(this.fG.G6i);ic=document.createElement("div");ic.classList.add(za.Gji);Oa=document.createElement("div");Oa.id="bix-fieldlistselector";Oa.classList.add(za.Sji);const Cb=document.createElement("div");Cb.id="bix-drilldetails";Cb.classList.add(za.Lji);ic.appendChild(Oa);ic.appendChild(Cb);ta.appendChild(wb);ta.appendChild(ic);this.NHb=ta.lastChild;this.ePd()}get ki(){return"BIExploreCallout"}get Oej(){return this.iLe}get Ifb(){return 6}get oJ(){return 561}vlj(ta){ta=document.getElementById(ta);
return Ta.DOMElementExtensions.isVisible(ta)?(this.cma.setFocus(!0),!0):!1}pWh(ta){this.n7c=ta;Ya.f(this.$).Cz(!0);this.iLe=!0;this.close(2)}dispose(){O.a.Ni([this.OL,this.R1a,this.cma,this.fieldListSelector]);this.fG=this.cma=this.fieldListSelector=this.R1a=this.OL=null;this.eSc();this.n7c=this.targetElement=this.NHb=null;super.dispose()}xUk(){this.setFocus()}close(ta){this.eSc();super.close(ta)}us(ta){ta=void 0===ta?!1:ta;const wb=Object(Wb.d)(D.a.resolve(J.Cf,{va:0}));ua.TaskExtensions.Ua(wb,ic=>
{this.pFg||(this.R1a=ic.result.YKb(this.dj,500,null,null,736),this.R1a.v7a())},this.$.xa);return ua.TaskExtensions.ts(ua.TaskExtensions.Ua(Object(Wb.d)(D.a.resolve(J.F,{va:0})),ic=>{this.OL=ic.result;this.OL.init(this.domElement,this.targetElement,document.body,this.$.na.displayRtl);this.OL.xvd=8;this.OL.pod=!0;this.OL.Trb=Jc.fZi();this.zld();this.OL.CE()},this.xa,3),()=>fb.a.prototype.us.call(this,ta),this.xa,3,Wc.a.current)}UN(){return this.n7c}web(){return(ta,wb,ic)=>{var Oa=this.$.pa.ta;ta=this.tjb(ta);
wb=this.zYa(wb);const Cb=V.M(Oa,this.fG.sB,this.fG.externalSourceIndex,this.fG.l1);return V.h(Oa,"GetBixAnalysis",Cb,ta,wb,ic,null,4)}}onShow(){this.OL.Rje();super.onShow()}bba(ta){const wb=ta.Result;if(ta.Errors&&!ta.Errors.length&&wb&&-1===wb.Context.HierarchyId)this.pFg=!0,this.R1a&&this.R1a.A7a(),Ka.a.instance.create(this.yMk,1,La.a.FIh,!0,!0),super.bba(ta,null,"");else{var ic=Oa=>{Oa.rA=0;this.s_a(169,(Cb,yc,Nc)=>{var Id=this.$.pa.ta,ke=Oa.bR,Ie=Oa.$4a,Le=Oa.rA;Cb=Yb.c(Cb,this.fQj);const wf=
V.M(Id,Oa.sB,Oa.externalSourceIndex,Oa.m4h());wf.type=4;wf.version=ke;wf.relatedGroup=Ie;wf.selectedTab=Le;return V.h(Id,"GetPivotFieldListData",wf,Cb,yc,Nc,wb,4)},16)};J.ac.Ha()?void D.a.resolve(J.ac,{va:0}).then(Oa=>{Oa=Oa.create();ic(Oa)}):ua.TaskExtensions.Ua(ha.GetServiceTaskFactory.create(this.$.ka,110,this.xa,0),Oa=>{ic(Oa.result)},this.xa,3)}}onKeyDown(ta){let wb=this.ZAf();if(ta.altKey&&85===ta.keyCode)this.close(1),Ea.g(ta);else if(117===ta.keyCode&&ta.ctrlKey)this.close(1),Ea.g(ta);else if(0===
wb)if(13===ta.keyCode)this.close(1);else super.onKeyDown(ta);else{let ic=!1;for(let Oa=0;3>Oa&&!ic;Oa++)2===wb?(ic=this.fieldListSelector.onKeyDown(ta))||(wb=1):1===wb&&((ic=this.cma.onKeyDown(ta))||(wb=2));if(ic)Ea.g(ta);else super.onKeyDown(ta)}}setFocus(){(this.cma||this.fieldListSelector)&&this.aGh(this.ZAf())}aGh(ta){let wb=!1;for(let ic=0;2>ic&&!wb;ic++)1===ta&&this.cma?(wb=this.cma.setFocus(!0))||(ta=2):2===ta&&this.fieldListSelector&&((wb=this.fieldListSelector.setFocus(!0))||(ta=1))}ZAf(){if(!this.fieldListSelector||
!this.cma)return 0;const ta=this.fieldListSelector.hasFocus(),wb=this.cma.hasFocus();return!ta&&!wb||wb?1:2}xRk(ta,wb){let ic=this.getElementById("bix-fieldlistselector");this.fieldListSelector=new lb(this.$,ic,ta,wb,this.touchMode);this.fieldListSelector.Aoj?(this.NHb.setAttribute(fa.a.Hdb,"true"),ic=this.getElementById("bix-drilldetails"),this.cma=new ra(this.$,ic,this.fG,wb,this.fieldListSelector,this),this.fieldListSelector.lyk(),this.fieldListSelector.start(),this.setFocus(),this.NHb.setAttribute(fa.a.Hdb,
"false")):(this.fieldListSelector.dispose(),this.fieldListSelector=null,this.NHb.textContent=sa.a.instance.ia(1194))}zld(){const ta=this.E3=document.createElement("div");ta.classList.add(za.Hji);Y.a.instance.ya(ea.a.Zi,ta,this.bqb);this.domElement.ownerDocument.body.appendChild(ta)}eSc(){this.E3&&(Y.a.instance.Na(ea.a.Zi,this.E3,this.bqb),Ta.DOMElementExtensions.Km(this.E3),this.E3=null)}static fZi(){return Jc.Trb||(Jc.Trb=[0,1,4,5])}}Jc.Trb=null;Object(C.a)(Jc,"BIExploreCallout",Ba.a,[484,485]);
var ma=a(902);class Hc extends F.a{constructor(ta,wb,ic,Oa){super();this.$=ta;this.svgIconProvider=Oa;this.Tta=ic.NKb(ta,Oa,wb,xa.a.Xuc,wa.a.$m(9),sa.a.instance.ia(1193),"BIXPointerDown");this.oxa=!1}get iE(){return this.Tta.iE}get TIb(){return this.Tta.TIb}get Xoj(){return this.oxa}dispose(){this.Tta.dispose();this.$=null;this.oxa=!1;super.dispose()}getButton(ta){return this.Tta.getButton(ta)}CMk(ta,wb,ic,Oa){this.Ft(ta+this.TIb,wb+this.TIb,ic,Oa,"Chart")}DMk(){var ta=Ya.f(this.$).ha.qa.activeCell;
const wb=Ya.f(this.$).Pg.ro(ta);(ta=Ya.f(this.$).ml(ta,wb))&&0<=ta.x&&0<=ta.y?this.Ft(ta.bottomRight.x+this.iE,ta.bottomRight.y+this.iE,Ya.f(this.$).rtl,wb,"Grid"):this.hide()}Ft(ta,wb,ic,Oa,Cb){Q.ULS.sendTraceTag(507834647,0,20,`BIExplorer lunch button shown on ${Cb}`);this.Tta.Ft(ta,wb,ic,Oa);this.oxa=!0;this.Tta.r1c(ma.a.Z2j,sa.a.instance.ia(1193),1)}hide(){this.Tta.hide();this.oxa=!1}domElement(ta){return this.Tta.domElement(ta)}Lhb(ta){this.Tta.Lhb(ta);this.oxa=!0}}Object(C.a)(Hc,"BIExploreLaunchButton",
F.a,[]);var Kb=a(45);class pc{constructor(ta){this.Hzb=!1;this.IRa=0;this.tEa=this.ofd=this.nfd=this.rBb=null;this.$=ta;this.reset()}get confirmationRequiredForDataOps(){return this.Hzb}get externalSourceIndex(){return this.IRa}get G6i(){return this.rBb}get y0(){return!!this.l1}get nTd(){return!!this.sB}get l1(){return this.nfd}get pivotTableName(){return this.ofd}get sB(){return this.tEa}reset(){this.rBb="";this.tEa=this.ofd=this.nfd=null}dCk(ta,wb){this.reset();this.Hzb=wb.confirmationRequiredForDataOps;
this.IRa=wb.externalSourceIndex;this.ofd=wb.pivotTableName;this.tEa=Kb.p(ta,this.$);ta.yi(wb.zE)||ta.yi(wb.Pz)?(wb=Ya.f(this.$).kh(ta),this.rBb=ba.a.Xq(wb.text)):(ta=ta.top-wb.top,wb.Eje&&wb.Eje.length>ta&&(this.rBb=wb.Eje[ta]))}Gyk(ta,wb,ic){this.reset();this.IRa=wb.ExternalSourceIndex;this.Hzb=!!(wb.Attributes&64);this.rBb=ba.a.Xq(ic.ValueString);this.nfd={};this.l1.ChartId=ta;this.l1.AnchorValue2=-1;switch(ic.Type){case 1:case 2:0<=ic.CategoryIndex?(this.l1.AnchorType=2,this.l1.AnchorValue1=ic.CategoryIndex):
(this.l1.AnchorType=1,this.l1.AnchorValue1=ic.SeriesIndex);break;default:0>ic.CategoryIndex&&0<=ic.SeriesIndex?(this.l1.AnchorType=1,this.l1.AnchorValue1=ic.SeriesIndex):(this.l1.AnchorType=3,this.l1.AnchorValue1=ic.SeriesIndex,this.l1.AnchorValue2=ic.CategoryIndex)}this.tEa={};this.$.Mq(this.sB);this.sB.FirstRow=-1;this.sB.FirstColumn=-1}}Object(C.a)(pc,"BixSelectionContext",null,[]);var $b=a(654),Ib=a(228),Zb=a(77),Eb=a(391),ob=a(279),Na=a(905),nb=a(4),Hb=a(595),na=a(1),Gb=a(765),Xa=a(239),Jb;let qb=
Jb=class extends F.a{constructor(ta,wb,ic,Oa,Cb){super();this.ELb=this.callout=this.da=null;this.YMj=yc=>{if(yc.isLoaded){this.state=1;yc=this.$;const Nc=na.EwaSettings.G5()?this.da:Ya.f(yc);this.OGh(Nc);yc.Lp(this.Li);yc.hI(this.Rp);Nc.Mz(this.oE);Hb.a(yc).Mz(this.SZb);yc.userOperationManager.px(this.Qog);na.EwaSettings.G5()||(Eb.a.Nda(1529658657,nb.a.PA,0,1),yc.Ma.zka(this));na.EwaSettings.G5()&&this.j8j()}else this.dispose()};this.vha=(yc,Nc)=>{this.jD();this.ELb(yc,Nc)};this.L8d=(yc,Nc)=>{this.allow&&
0===Nc.W$&&(yc=this.da.ha.wk,1===yc?(this.hud(),this.T1()):2!==yc||this.fG.y0||(this.fG.reset(),this.jD()))};this.en=()=>{this.jD()};this.Li=()=>{this.jD()};this.fj=(yc,Nc)=>{this.callout||this.showCallout(3===yc.oh,Nc)};this.r6d=()=>{this.callout.ENa(this.r6d);this.callout=null;this.nq.hide()};this.Rp=()=>{this.callout?this.jD():this.Hmb()&&this.nq.hide()};this.SZb=()=>{3===this.state&&(this.state=1)};this.oE=()=>{3===this.state&&this.kpf()};this.Qog=(yc,Nc)=>{(yc=Nc.Wl?Nc.Wl.operation:null)&&yc.flags&
4&&(this.allow&&0===Nc.By?(this.state=3,this.jD()):3===this.state&&1===Nc.By&&(Nc=yc.Uj?yc.Uj.Errors:null)&&0<Nc.length&&this.kpf())};this.kpf=()=>{this.state=1;this.T1()};this.$=ta;this.da=wb;this.state=2;this.NG=Oa;this.fG=new pc(ta);this.nq=new Hc(ta,this.fj,ic,Cb);P.a(this.$).Eq(this);R.a.KQf(ta.domElement.ownerDocument,wa.a.current.uu(95),this.YMj);na.EwaSettings.G5()&&(this.Tph=new Promise(yc=>this.j8j=yc));this.ELb=Xa.a(this.L8d,100)}dispose(){this.da&&(this.da.rh.qtb(this.vha),this.da.sh&&
this.da.sh.ev(this.en));if(this.$){const ta=this.$;ta.userOperationManager.Hv(this.Qog);ta.Au(this.Li);ta.LK(this.Rp);Ya.f(ta).xE(this.oE);Hb.a(ta).xE(this.SZb)}O.a.Ng(this.nq);this.fG=this.$=this.da=this.callout=this.nq=null;super.dispose()}get xSk(){return this.Tph}get Pi(){return this.callout?this.callout.domElement:null}get Co(){return!!this.callout}get LIk(){return!this.callout}get Hk(){return ob.a.Cqd}get Skj(){var ta;return!(null===(ta=this.nq)||void 0===ta||!ta.Xoj)}get yFf(){Q.ULS.shipAssertTag(537170304,
8,!Ya.f(this.$).Pg.Uo,"GetLaunchMonocleButton is not supported in freeze pane");return Object(U.a)(Sys.UI.Control,this.nq.getButton(1))}get dGf(){return this.callout}get zoj(){return this.fG.nTd}get allow(){return this.$.Tj.get(6)&&1===this.state&&this.$.th.aea(135200)}mcf(){this.showCallout(!1)}Bi(ta,wb){if(1529658657===wb&&(8===ta||!this.fG.nTd))return!0;1247109494!==wb&&-498523270!==wb||this.jD();return!1}executeCommand(ta,wb){this.callout?this.jD():(this.scrollIntoView(),this.showCallout(3===
wb.method));return W.Task.Va(!0)}ni(ta,wb){return 1529658657===wb.command}Ji(){return!1}jD(){this.hud();this.Skj&&this.nq.hide()}ouk(ta){var wb=void 0===wb?1:wb;this.scrollIntoView();this.showCallout(ta,wb)}zp(ta,wb){this.callout&&!wb&&this.callout.xUk();return!wb}Yp(ta){return Ta.DOMElementExtensions.Cn(this.Pi,ta)}gs(){}Xt(){}yug(ta,wb,ic,Oa,Cb){this.fG.reset();if(this.allow&&!Zb.e(this.$.na))if(ic&&ic.Attributes&512&&Oa&&wb){const yc=this.$.LW;this.hud();this.fG.Gyk(wb,ic,Oa);this.Hmb()?(wb=Hb.a(this.$).domElement,
ic=Ta.DOMElementExtensions.getLocation(wb),Oa=Math.abs(wb.scrollLeft),this.$.isChromeRtl&&(Sys.Browser.agent===Sys.Browser.Safari&&(Oa=wb.scrollWidth-wb.offsetWidth-Oa),Oa*=-1),ta=new I.a(ta.x-ic.x+Oa,ta.y-ic.y+wb.scrollTop),yc&&(ta.x=wb.offsetWidth-ta.x)):(wb=this.da.Zk(Cb).view.Xm,ta=Na.a.Ny(wb,this.da.Zk(Cb).domElement,new Sys.UI.Point(Math.round(ta.x),Math.round(ta.y)),yc));this.nq.CMk(ta.x,ta.y,yc,Cb)}else this.jD()}T1(){this.bJk()?this.nq.DMk():this.nq.hide()}showCallout(ta,wb){wb=void 0===
wb?1:wb;const ic=Oa=>{Oa&&this.fG.nTd&&(this.callout=new Jc(this.$,this.fG,this.nq.domElement(wb),ta),this.callout.initialize(),this.nq.Lhb(wb),this.callout.Uda(this.r6d),this.callout.us());this.nq.getButton(1).L3b()};void D.a.resolve(J.qb,{va:1}).then(Oa=>{Oa.UL(this.fG.confirmationRequiredForDataOps,ic)})}scrollIntoView(){var ta=this.da.ha;if(1===ta.wk){ta=ta.qa.activeCell;const wb=this.da.view.visibleArea,ic=this.da.ml(ta);wb&&ic&&!wb.contains(ic)&&this.da.gD(ta,3,"BIExploreManager.ScrollIntoView")}}OGh(ta){ta&&
(na.EwaSettings.G5()||(this.da=ta),this.da.rh.Vcb(this.vha),this.da.sh.nv(this.en))}bJk(){this.fG.reset();if(!this.allow||this.da.ha.$e.yh)return!1;const ta=this.NG.CQb();if(na.EwaSettings.kSd())return $b.a(this.da,ta);if(Object(K.a)(Ib.PivotTableRange,ta)&&ta.supportsBIExplore){const Oa=this.da.ha.qa.activeCell,Cb=this.da.kh(Oa);if(Oa&&Cb&&this.da.ha.qa.H0){var wb=Oa.left-ta.left,ic=Oa.top-ta.top;if(!(ta.odf&1<<wb||ta.FGg&1<<ic||ta.ndf&1<<wb||ta.EGg&1<<ic||Cb.hasAutoFilter)&&(wb=Oa.yi(ta.zE)||Oa.yi(ta.Pz),
ic=!1,ta.zE&&ta.Pz?ic=Oa.top<ta.zE.top&&Oa.left<ta.Pz.left||Oa.top<ta.Pz.top:ta.Pz&&(ic=Oa.top<ta.Pz.top),!wb&&!ic&&0<Cb.text.length||wb&&(0<Cb.text.length||Cb.BKa||Cb.M0a)))return this.fG.dCk(Oa,ta),!0}}return!1}hud(){this.nq.getButton(1).L3b();this.callout&&!this.callout.Oej&&(this.callout.ENa(this.r6d),this.callout.TJ(),this.callout=null)}Hmb(){return this.$.ea.isNamedObjectViewMode&&Zb.f(this.$.na)}static Aa(ta,wb,ic,Oa){$b.b(ta)||ta.ka.ph(2,new Jb(ta,null,wb,ic,Oa))}};qb=Jb=Object(M.__decorate)([Object(D.d)(J.w),
Object(M.__param)(0,Object(J.Lb)()),Object(M.__param)(1,Object(J.dd)()),Object(M.__param)(2,Object(J.Cf)()),Object(M.__param)(3,Object(J.qb)()),Object(M.__param)(4,Object(Gb.m)())],qb);Object(C.a)(qb,"BIExploreManager",F.a,[39,449,59,2]);var Db=a(209);let gb=class{constructor(ta,wb){this.NG=ta;this.im=wb}Bi(){return!1}executeCommand(ta,wb,ic,Oa){switch(wb.command){case -1193102612:this.NG.hee(!1,!1,wb,"m_excelWebRenderer_ewaCtl_DataSourceDirtinessButton"===ic.SourceControlId);this.im.odk();break;
case 2054778433:this.NG.refreshSelected(wb,Oa);break;case -1995709983:this.im.pdk();this.NG.hee(!1,!0,wb,!1);break;default:return Db.a(wb.command)}return ua.TaskExtensions.sq()}ni(ta,wb){switch(wb.command){case 2054778433:case -1193102612:return!0;case -1995709983:return na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableContentRefreshOnOpen",!1)}return!1}Ji(){return!1}};gb=Object(M.__decorate)([Object(D.d)(J.pb),Object(M.__param)(0,Object(J.qb)()),Object(M.__param)(1,Object(J.De)())],
gb);Object(C.a)(gb,"DataRefreshCommandHandler",null,[39]);var ya=a(6),Aa=a(761),sb=a(38),nc=a(1329),Bb=a(428),uc=a(481);class Pc{constructor(ta,wb){this.pivotTableName=this.pivotTableId=null;this.pivotTableId=ta;this.pivotTableName=wb}}Object(C.a)(Pc,"MacroRecorderPivotTableRefreshedPayload",null,[65]);var wd=a(450);class Md extends wd.a{constructor(ta,wb,ic,Oa,Cb,yc){Cb=void 0===Cb?wd.a.Tyd:Cb;super(ta,wb,ic,Oa,Cb,void 0===yc?null:yc)}get IMa(){return 4}get n4b(){return!!(this.flags&64)}}Object(C.a)(Md,
"DepartableRefreshWebMethodOperation",wd.a,[]);var Nd=a(122);const ec=(ta,wb,ic,Oa,Cb,yc,Nc,Id,ke,Ie,Le)=>{const wf=Ie?"RefreshAllDirtyDataSourcesPft":na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableContentRefreshOnOpen",!1)?"RefreshAllPftNew":"RefreshAllPft";Le=ta.Za(1,Le);const Kf=Le.context;Kf.RequestId=Oa;Kf.CompleteResponseTimeout=Cb;Le.periodic=wb;Le.pftToken=yc;"RefreshAllPftNew"===wf&&(Le.refreshOnOpen=ic);return V.h(ta,wf,Le,Nc,Id,ke,Ie,wb?8:0)},gc=(ta,wb,ic,Oa,Cb,yc,Nc,
Id,ke,Ie)=>{const Le=ke?"RefreshAllDirtyDataSources":na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableContentRefreshOnOpen",!1)?"RefreshAllNew":"RefreshAll";Ie=ta.Za(1,Ie);const wf=Ie.context;wf.RequestId=Oa;wf.CompleteResponseTimeout=Cb;Ie.periodic=wb;"RefreshAllNew"===Le&&(Ie.refreshOnOpen=ic);return V.h(ta,Le,Ie,yc,Nc,Id,ke,wb?8:0)};var Mb=a(356),sc=a(35),xd=a(47),xb=a(355),Lb=a(212),Rc=a(419),nd=a(596),$d;const Td=nd.a.pWa.Application;let He=$d=class extends F.a{constructor(ta,
wb){super();this.DPc=null;this.ERc=!1;this.mNa=null;this.oee=!1;this.Og=new sb.a;this.PL=null;this.Dnh=new Map;this.U3a=new Map;this.Dgc=[];this.rE=(Oa,Cb)=>{2===Cb.By?this.U3a.clear():1===Cb.By&&this.U3a&&this.U3a.forEach((yc,Nc)=>{Cb.Wl==yc&&this.U3a.delete(Nc)})};this.evf=Oa=>{const Cb=this;return No(function*(){const yc=na.EwaSettings.isChangeGateEnabled("OfficeVSO:8724577_oauthManagerAsService")?Cb.RIj:yield D.a.resolve(J.be,{va:0});try{const Nc=yield Cb.qQi(yc);Oa(Nc)}catch(Nc){Q.ULS.sendTraceTag(508913882,
0,10,`DataRefreshManager.RefreshConnection: failed to get PFT token ${Nc}`)}})};this.qQi=Oa=>No(function*(){try{const Cb=yield Oa.JD("Core",Td);if(Cb.IsSuccess)return Q.ULS.sendTraceTag(508913881,0,20,"DataRefreshManager.getPftTokenAsync: successfully fetch token."),Cb.Token;Q.ULS.sendTraceTag(508913880,0,15,`DataRefreshManager.getPftTokenAsync: failed to get token. Error code: ${Cb.ErrorCode}, Error message : ${Cb.ErrorMessage}`)}catch(Cb){Q.ULS.sendTraceTag(508913879,0,15,"DataRefreshManager.getPftTokenAsync: got rejected promise, use fallback value")}return null});
this.hPh=()=>{this.Qme(0);this.hee(!0,!1,null,!1)};this.Qkg=Oa=>{Oa.RequestId||(this.a4a=null,this.$.ea.Yw(Oa.Errors))};this.Rkg=Oa=>{this.a4a=null;Oa=Nd.a.Qj(Oa.data);this.$.ea.Yw(Oa)};this.XNc=Oa=>{this.Llg(Oa);(Oa.DepartableWebMethodOperationCompleted||Oa.Errors&&0<Oa.Errors.length)&&this.Og.raiseEvent("refreshAllCompleted",Oa,this)};this.$Qj=Oa=>{Oa&&!ib.a(Oa)&&(!(Oa=Oa.Result)||1>Oa.length||(this.PL&&this.PL.cancel(),this.PL=new Aa.a,this.e_g(Oa,0,this.PL.token)))};this.ZQj=Oa=>{Q.ULS.sendTraceTag(537163298,
306,50,"DataRefreshManager::OnGetSensitivityLabelsFailedCallback");Oa=Nd.a.Qj(Oa.data);this.$.ea.Yw(Oa)};this.tj=()=>{this.LRd()};this.onActiveItemPanesChanged=()=>{na.EwaSettings.isChangeGateEnabled("OfficeVSO:6013906_MarkRefreshRangeInvalidWhenCurrentSheetIsChanged")&&this.LRd()};this.PZb=(Oa,Cb)=>{const yc=Cb.Ti.block;var Nc=yc.Fj.PeriodicRefreshExpiryInSeconds;void 0!==Nc&&this.XMg(Nc);Nc=Ya.f(this.$);5===yc.state&&Oa===Nc.za&&((Oa=(Oa=Nc.hL(Cb.Ti.hash))?Oa.jj:null)&&!Oa.yi(Nc.ha.qa.activeCell)||
this.LRd())};this.Oi=()=>{this.$.ea.Ph||this.clear()};this.$=ta;this.O$d=-1;this.a4a=null;ta=Ya.f(this.$);const ic=ta.ha;ic.u9(this.tj);ic.eUa(this.tj);ta.za.Cka(this.PZb);this.$.sa.eFa(this.onActiveItemPanesChanged);this.$.Gh.eFa(this.onActiveItemPanesChanged);this.$.userOperationManager.px(this.rE);this.W5e(ta.za);this.W5e(Hb.a(this.$).za);this.$.ea.uq(this.Oi);this.RIj=wb;wb=this.$.ua.StartupDelayMultiplierForLabelsOnRefreshOnOpen*this.$.ua.TimeToWaitForApplyingSensitivityLabels;Q.ULS.sendTraceTag(537163332,
306,50,`DataRefreshManager async call to UpdateSensitivityLabels after ${wb} ms.`);Ka.a.instance.create(()=>{this.qxe()},wb,La.a.i8h,!0,!0)}rxh(ta){this.Og.addHandler("beforeSingleRefreshStarted",ta)}eik(ta){this.Og.removeHandler("beforeSingleRefreshStarted",ta)}B1e(ta){this.Og.addHandler("singleRefreshCompleted",ta)}yCg(ta){this.Og.removeHandler("singleRefreshCompleted",ta)}get uee(){return this.Dgc}get Hyg(){return this.Dnh}get confirmationRequired(){return this.$.th.refreshConfirmationRequired}dispose(){if(this.$){const ta=
Ya.f(this.$),wb=ta.ha;wb.Fba(this.tj);wb.CNa(this.tj);this.$.Gh.DNa(this.onActiveItemPanesChanged);this.$.sa.DNa(this.onActiveItemPanesChanged);this.$.userOperationManager.Hv(this.rE);ta.za.Fy(this.PZb);ta.za.l5a(this.PZb);Hb.a(this.$).za.Fy(this.PZb);this.$.ea&&this.$.ea.pq(this.Oi)}this.clear();O.a.Ni([this.DPc,this.Og]);this.$=this.Og=null;super.dispose()}i0k(ta,wb,ic,Oa){this.$.ea.Ph&&this.$.userOperationManager.enqueueOperation(new Lb.a(604,0,(Cb,yc,Nc)=>xb.g(this.$.pa.ta,ta,wb,ic,Yb.c(Cb,Id=>
{Id=Id.Result;null===Id||""===Id.DataConnectionName||-1===Id.ExternalSourceIndex?this.pqe():this.FRc(Id.DataConnectionName,Id.ExternalSourceIndex,Oa)}),Yb.b(yc,Id=>{Q.ULS.sendTraceTag(509696077,306,15,"DataRefreshManager::onGetConnectionNameFailure");this.pqe();Id=Nd.a.Qj(Id.data);this.$.ea.Yw(Id)}),Nc,null,null),80,()=>new uc.a),null)}FRc(ta,wb,ic){if(this.$.ea.Ph){var Oa=Cb=>{var yc=null;if(this.mNa&&Object(K.a)(Ib.PivotTableRange,this.mNa)){const Nc=this.mNa;yc=()=>new Pc(Nc.apa,Nc.pivotTableName)}yc=
this.$.userOperationManager.enqueueOperation(new Md(50,0,(Nc,Id,ke,Ie)=>{var Le=this.$.pa.ta.Jh();Le.FlightHolder=this.$.ua.FlightHolder;null==Nc&&this.Hyg.set(ta,Le.ClientRequestId);var wf=this.$.pa.ta;Id=Yb.c(this.rSi(ta),Id);Le=wf.Za(1,Le);const Kf=Le.context;Kf.RequestId=Nc;Kf.CompleteResponseTimeout=2E3;Le.connectionName=ta;Le.externalSourceIndex=wb;Le.userAadToken=Cb;return V.h(wf,"Refresh",Le,Id,ke,Ie,null,0)},68,250,yc),ic);this.U3a.set(ta,yc);this.gXj(ta)};this.DKj(ta);na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",
!1)||na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefreshPFTAsDefault",!1)?void this.evf(Oa):Oa(null)}}fvg(ta){ta=void 0===ta?null:ta;na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConfirmActiveContent",!1)?this.gNg(!0,ta):(this.$.th.refreshConfirmationRequired=!1,this.ERc=!0)}UL(ta,wb){var ic=void 0===ic?null:ic;if(this.confirmationRequired&&ta)if(this.ERc)wb(!0);else{ic=ic||$d.HBj;ta=sc.a.Yi(12,1,0,0,0,1243883867,"ConfirmDataRefresh");ta.Caption=
sa.a.instance.Ba(7);ta.Description=ic;ta.HelpDescription=sa.a.instance.ia(1319);ta.HelpTopicId=nc.a.Eef;const Oa=new Mb.a(this.$,ta);Oa.Uda(()=>{this.gNg(2===Oa.returnValue,wb)})}else wb(!0)}CQb(){if(!this.oee){const ta=Ya.f(this.$).Yg.JHf();ta&&(this.mNa=ta);this.oee=!0}return this.mNa}qxe(){var ta=this.$.pa.ta.Jh(),wb=this.$.pa.ta,ic=this.$Qj,Oa=this.ZQj;ta=wb.Za(1,ta);V.h(wb,"GetSensitivityLabelsForPowerBIDatasets",ta,ic,Oa,null,null,4)}t_k(ta){return this.U3a.has(ta)?(this.$.userOperationManager.cva(this.U3a.get(ta)),
!0):!1}hNg(){this.$.th.refreshConfirmationRequired=!1;this.ERc=!0;this.lAg()}gNg(ta,wb){wb=void 0===wb?null:wb;if(ta){var ic=[],Oa=this.$.pa.ta.Jh(),Cb=yc=>{yc.Errors&&0<yc.Errors.length||(wb&&wb(!0),this.hNg())};Rc.a(this.$.userOperationManager,(yc,Nc,Id)=>V.G(this.$.pa.ta,ic,!0,1243883867,!0,Yb.c(yc,Cb),Nc,Id,null,Oa),yc=>new Lb.a(1005,0,yc),null)}}static yYh(ta){if(na.EwaSettings.Ra(123)){var wb=ta.th;if(!wb||wb.inEmbedView||wb.inWebPart||wb.inViewerFromWebPart)return!1;ta=Ya.f(ta);wb=ta.ha.qa.selectedRanges;
for(let ic=0;ic<wb.length;ic++)if(ta.Yg.PGc(wb[ic]))return!0}return!1}pqe(){const ta=sc.a.Yi(1,0,0,1503,0,-853845742,"ErrorConnectingToDataSource");xd.a(this.$).CD([ta])}hee(ta,wb,ic,Oa){if(this.$.ea.Ph){this.lAg();if(0<this.$.workbookContext.LegacyConnections.length){const yc=sc.a.Yi(32,2,1649,1662,0,-73730134,"BB_LegacyConnectionsWarning");yc.HelpDescription=sa.a.instance.ia(1644);yc.HelpTopicId=Bb.a.cuj;if(na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",
!1))void D.a.resolve(J.C,{va:0}).then(Nc=>{Nc&&Nc.xm(33,yc)});else{const Nc=Object(Wb.d)(D.a.resolve(J.C,{va:0}));ua.TaskExtensions.Ua(Nc,()=>{const Id=Nc.result;Id&&Id.xm(33,yc)},this.$.xa,3)}}var Cb=yc=>{if(ta){const Nc=this.$.pa.ta.Jh();this.a4a=ec(this.$.pa.ta,!0,!1,null,0,yc,Yb.c(this.Qkg,this.XNc),this.Rkg,null,null,Nc)}else this.$.userOperationManager.enqueueOperation(new Md(51,0,(Nc,Id,ke,Ie)=>{const Le=this.$.pa.ta.Jh();Le.FlightHolder=this.$.ua.FlightHolder;let wf=null;Oa&&(wf={});return ec(this.$.pa.ta,
!1,wb,Nc,2E3,yc,Yb.c(this.XNc,Id),ke,Ie,wf,Le)},68,250,()=>new uc.a),ic)};na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ADTokenForPowerBI",!1)?void this.evf(Cb):ta?(Cb=this.$.pa.ta.Jh(),this.a4a=gc(this.$.pa.ta,!0,!1,null,0,Yb.c(this.Qkg,this.XNc),this.Rkg,null,null,Cb)):this.$.userOperationManager.enqueueOperation(new Md(51,0,(yc,Nc,Id,ke)=>{const Ie=this.$.pa.ta.Jh();Ie.FlightHolder=this.$.ua.FlightHolder;let Le=null;Oa&&(Le={});return gc(this.$.pa.ta,!1,wb,yc,2E3,Yb.c(this.XNc,Nc),
Id,ke,Le,Ie)},68,250,()=>new uc.a),ic)}}refreshSelected(ta,wb){if(this.$.ea.Ph&&Zb.i(this.$.na)&&!this.BTb()){var ic=this.CQb();if(!$d.yYh(this.$)||ic&&Object(K.a)(Ib.PivotTableRange,ic))ic?this.FRc(this.mNa.connectionName,this.mNa.externalSourceIndex,ta):Ya.f(this.$).ha.qa.WRd()?this.i0k(this.$.sa.na.sheetName,this.$.sa.na.activeCell.top-1,this.$.sa.na.activeCell.left-1,ta):this.pqe();else{let Oa;ta=Object(Wb.d)(D.a.resolve(J.fb,{va:wb.Ufa()}));ua.TaskExtensions.Ua(ta,Cb=>{(Oa=Cb.result)&&Oa.refreshLinkedEntitiesInRange()},
this.$.xa,3)}}}clear(){this.Qme(0);this.ERc=!1;this.O$d=-1;$d.ldd=null;this.a4a&&(ya.AFrameworkApplication.$i.HD(this.a4a.TC),this.a4a=null)}static CZf(){var ta=!1,wb=Ya.f(void 0).ha;2===wb.wk&&(ta=wb.$e.yh,wb=(null===ta||void 0===ta?0:ta.floatingObject)?ta.floatingObject.Ki:null,ta=ta.eG&&!!wb&&!!(wb.Attributes&4));return ta}BTb(){return 2===Ya.f(this.$).ha.wk}LRd(){this.oee=!1;this.mNa=null}Qme(ta){let wb=0<ta;!wb||this.$.ea.Ph&&this.$.th.allowPeriodicDataRefresh||(wb=!1);O.a.Ng(this.DPc);this.DPc=
null;wb&&(this.DPc=Ka.a.instance.jO(this.hPh,ta,La.a.g8h))}Llg(ta){ta.RequestId||(this.Og.raiseEvent("refreshCompleted",ta,this),this.qxe())}rSi(ta){return wb=>{var ic;this.Llg(wb);wb&&(wb.DepartableWebMethodOperationCompleted||wb.Errors&&0<wb.Errors.length)&&(Array.remove(this.Dgc,ta),wb.Result=null!==(ic=wb.Result)&&void 0!==ic?ic:{},wb.Result.ConnectionName=ta,this.Og.raiseEvent("singleRefreshCompleted",wb,this))}}DKj(ta){this.Og.raiseEvent("beforeSingleRefreshStarted",ta,this)}gXj(ta){this.Dgc.includes(ta)||
this.Dgc.push(ta);this.Og.raiseEvent("singleRefreshStarted",ta,this)}e_g(ta,wb,ic){const Oa=ha.GetServiceTaskFactory.Bj(this.$.ka,274,275,0);let Cb=!1;ic.sM?Q.ULS.sendTraceTag(537163297,306,50,"DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: Task was cancelled."):ua.TaskExtensions.Ua(Oa,()=>{if((()=>{let Nc=Oa.result.Spd(ta,Cb);({fmb:Cb}=Nc);return Nc})().returnValue)Q.ULS.sendTraceTag(537163293,306,50,`DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: Completed successfully on the ${wb} attempt.`);
else if(Cb&&3>wb)if(ic.sM)Q.ULS.sendTraceTag(537163296,306,50,"DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: Task was cancelled before waiting.");else{var yc=this.$.ua.TimeToWaitForApplyingSensitivityLabels;Q.ULS.sendTraceTag(537163295,306,100,`DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: retry async call to AutoApplyOrRecommendPowerBILabel after ${yc} ms on the ${yc} attempt.`);Ka.a.instance.create(()=>{this.e_g(ta,wb+1,ic)},yc,La.a.h8h,!0,!0)}else Q.ULS.sendTraceTag(537163294,
306,50,`DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: No Sensitivity Labels applied on the ${wb} attempt.  Not scheduling anymore retries.`)},ic,3)}W5e(ta){ta.Vy(this.PZb);ta=ta.B2j;0<ta&&this.XMg(ta)}XMg(ta){const wb=this.$.ea.gk;wb>this.O$d&&(this.O$d=wb,this.Qme(1E3*ta))}lAg(){if(na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UsePromisesInsteadOfTasks",!1))void D.a.resolve(J.C,{va:0}).then(ta=>{ta&&ta.N5(58)&&ta.removeEntry(58);ta&&ta.N5(74)&&ta.removeEntry(74)});else{const ta=
Object(Wb.d)(D.a.resolve(J.C,{va:0}));ua.TaskExtensions.Ua(ta,()=>{const wb=ta.result;wb&&wb.N5(58)&&wb.removeEntry(58);wb&&wb.N5(74)&&wb.removeEntry(74)},this.$.xa,3)}}static get HBj(){return $d.ldd||($d.ldd=sa.a.instance.Ba(8)+"<br /><br />"+sa.a.instance.Ba(10))}};He.ldd=null;He=$d=Object(M.__decorate)([Object(D.d)(J.qb),Object(M.__param)(0,Object(J.Lb)()),Object(M.__param)(1,Object(J.be)())],He);Object(C.a)(He,"DataRefreshManager",F.a,[448]);var oc=a(8),ld=a(372);let id=class extends ld.a{constructor(){super(oc.a.pivotTableCantDelete,
oc.a.idle,oc.a.Ydb);this.sNj=()=>{this.Tw()}}initialize(ta){super.initialize(ta)}execute(ta){const wb=Object(U.a)(10,ta.sk);Q.ULS.sendTraceTag(508359449,0,50,"DeletePivotTableWebMethodActivity.Execute: flushing operations queue.");const ic=wb.userOperationManager.operationCount;0<ic&&Q.ULS.sendTraceTag(508359448,0,15,`DeletePivotTableWebMethodActivity.onDeletePivotTableComplete: there are still operations in queue. operations count is [${ic}]`);wb.userOperationManager.b0("DeletePivotTableWebMethodActivity.Execute");
const Oa=Kb.p(Ya.f(wb).ha.qa.activeCell,wb);this.Eqa(ta,this.sNj,(Cb,yc,Nc)=>V.g(wb.pa.ta,"PerformPivotTableOperation",Oa,19,Cb,yc,Nc,ta,wb.pa.ta.Jh()),wb.pa.ta);return super.execute(ta)}};id=Object(M.__decorate)([Object(D.d)(J.yb)],id);Object(C.a)(id,"DeletePivotTableWebMethodActivity",ld.a,[]);var fc=a(95),vc=a(684),Tc=a(161),Bd=a(32);let Fd=class{constructor(ta,wb){wb||Q.ULS.sendTraceTag(537162718,0,15,"FieldManagerPane is null on FieldListCommandHandler creation");this.$=ta;this.fieldManagerPane=
wb;this.Hsh=ta.sa}Bi(ta,wb){return(2140436015===wb||-1006032470===wb)&&!(new Tc.a(this.Hsh)).Hj(8192)}executeCommand(ta,wb,ic,Oa){ta=wb.command;Oa=Oa.Ufa();switch(ta){case 2140436015:case -1006032470:this.fieldManagerPane&&(this.fieldManagerPane.O6b(!fc.g(this.$.Bk),wb,!1),Q.ULS.sendTraceTag(537162717,0,50,`${2140436015===ta?"Show":"Hide"} Field List`));break;case 589118293:case -1687560254:return this.rtc(!0,!1,Oa);case 1176256599:return this.rtc(!1,!1,Oa);case -1751201991:return this.rtc(!0,!0,
Oa);case -232434744:return this.rtc(!1,!0,Oa);default:return Db.a(ta)}return W.Task.Va(!0)}ni(ta,wb){ta=!1;switch(wb.command){case 2140436015:case -1006032470:ta=!0;break;case 589118293:case -1687560254:case 1176256599:case -1751201991:case -232434744:ta=!0}return ta}Ji(){return!1}rtc(ta,wb,ic){const Oa=Bd.a.Tg.Wh,Cb=Ya.f(this.$).ha.qa.activeCell;ic=Object(Wb.d)(D.a.resolve(J.Cf,{va:ic}));return ua.TaskExtensions.Ua(ic,()=>{const yc=Nc=>{if(Nc){Ya.f(this.$).Cz(!0);const Id=Kb.p(Cb,this.$);this.$.enqueueOperation(-867563466,
(ke,Ie,Le)=>V.K(this.$.pa.ta,Id,0,!1,!1,!1,ta,wb,ke,Ie,Le,null,null),Oa,0,6,161,()=>new vc.a(Id,wb))}};void D.a.resolve(J.qb,{va:1}).then(Nc=>{Nc.UL(!1,yc)})},this.$.xa,3)}static XKb(ta,wb,ic){const Oa={};ta.Mq(Oa);Oa.FirstRow=wb;Oa.FirstColumn=ic;return Oa}};Fd=Object(M.__decorate)([Object(D.d)(J.Xb),Object(M.__param)(0,Object(J.Lb)()),Object(M.__param)(1,Object(J.bc)())],Fd);Object(C.a)(Fd,"FieldListCommandHandler",null,[39]);class le{constructor(ta,wb,ic){this.Rxa=this.HVd=this.Qxa=this.CGc=!1;
this.anchorType=-1;this.confirmationRequiredForDataOps=!1;this.chartId=this.pivotTableName=null;this.LSe=-1;this.nUe=1;this.IRa=this.yIe=this.xIe=-1;this.tEa=null;if(ta&&(this.rA=wb,this.Qxa=this.CGc=!1,ta.na)){var Oa=Ya.f(ta),Cb=wb=null;if(Zb.f(ta.na))ic=Hb.a(ta),ic.Ki&&ic.Ki.Attributes&4&&(this.chartId=ic.chartId,wb=ic.Ki);else if(Zb.i(ta.na)){const yc=Oa.ha.$e.yh;yc?(ic=yc.floatingObject)&&0===ic.type&&ic.Ki&&ic.Ki.Attributes&4&&(this.chartId=yc.floatingObject.id,wb=ic.Ki):Oa.ha.qa.activeCell&&
(ic=ic.CQb(),Object(K.a)(Ib.PivotTableRange,ic)&&(Cb=ic))}wb?(this.Qxa=!0,this.HVd=!!(wb.Attributes&256),this.anchorType=7,this.Rxa=!!(wb.Attributes&128),this.confirmationRequiredForDataOps=!!(wb.Attributes&64),this.IRa=wb.ExternalSourceIndex,this.bR=wb.FieldListVersion,this.sX=wb.FieldWellVersion,wb=this.tEa={},ta.Mq(wb),wb.FirstColumn=wb.FirstRow=-1):Cb&&(this.CGc=!0,this.HVd=Cb.isActionable,this.anchorType=0,this.Rxa=Cb.isOlap,this.confirmationRequiredForDataOps=Cb.confirmationRequiredForDataOps,
this.IRa=Cb.externalSourceIndex,this.bR=Cb.Usi,this.sX=Cb.Zsi,this.pivotTableName=Cb.pivotTableName,this.tEa=Kb.p(Cb,ta))}}get $4a(){return this.LSe}set $4a(ta){this.LSe=ta}get rA(){return this.nUe}set rA(ta){this.nUe=ta}get bR(){return this.xIe}set bR(ta){this.xIe=ta}get sX(){return this.yIe}set sX(ta){this.yIe=ta}get Sxa(){return this.Qxa||this.CGc}get Bmj(){return this.Sxa&&!this.HVd}get externalSourceIndex(){return this.IRa}get sB(){return this.tEa}get sheetName(){return this.sB?this.sB.SheetName:
null}get ALb(){return this.chartId+"_"+this.pivotTableName+"_"+this.bR+"_"+this.sX}m4h(){const ta={};ta.AnchorType=this.anchorType;7===this.anchorType&&(ta.ChartId=this.chartId);ta.AnchorValue1=ta.AnchorValue2=-1;return ta}static ggb(){return new le(null,-1,null)}static create(ta,wb,ic){return new le(ta,wb,ic)}static WVb(ta,wb){return ta.Sxa!==wb.Sxa||ta.anchorType!==wb.anchorType||ta.chartId!==wb.chartId||ta.pivotTableName!==wb.pivotTableName||!!ta.sB&&!!wb.sB&&ta.sB.SheetName!==wb.sB.SheetName}static OXd(ta,
wb){return le.WVb(ta,wb)||ta.$4a!==wb.$4a||ta.rA!==wb.rA}}Object(C.a)(le,"FieldListRequestState",null,[471]);let dc=class{constructor(ta,wb){this.$=ta;this.NG=wb}create(ta){return new le(this.$,void 0===ta?-1:ta,this.NG)}ggb(){return new le(null,-1,null)}WVb(ta,wb){return ta.Sxa!==wb.Sxa||ta.anchorType!==wb.anchorType||ta.chartId!==wb.chartId||ta.pivotTableName!==wb.pivotTableName||!!ta.sB&&!!wb.sB&&ta.sB.SheetName!==wb.sB.SheetName}OXd(ta,wb){return this.WVb(ta,wb)||ta.$4a!==wb.$4a||ta.rA!==wb.rA}};
dc=Object(M.__decorate)([Object(D.d)(J.ac),Object(M.__param)(0,Object(J.Lb)()),Object(M.__param)(1,Object(J.qb)())],dc);Object(C.a)(dc,"FieldListRequestStateManager",null,[]);var Uc=a(154);class kb{constructor(){this.qN=0;this.request=null;this.aw=!0}get correlationId(){return this.qN}lbg(){return this.qN=this.correlationId+1}}Object(C.a)(kb,"DataRequestInfo",null,[]);var rb=a(26),cc=a(670),mc=a(647);class Sa{}Object(C.a)(Sa,"CssClassNames",null,[]);var pb=a(27);const Ac=(ta,wb,ic)=>{if(ta)for(let Oa=
0,Cb=ta.length;Oa<Cb;Oa++){const yc=ta[Oa];yc.ClientId=ic++;yc.ClientParentId=wb;ic=Ac(yc.Children,yc.ClientId,ic)}return ic},yd=(ta,wb,ic,Oa)=>{for(const Cb of ta){if(Cb.PivotCacheIndex===wb&&(Cb.TypeTag===ic||0===ic))return Cb;if(Oa&&(ta=yd(Cb.Children,wb,ic,Oa)))return ta}return null},vb=(ta,wb,ic)=>{if(ta)for(let Cb=0,yc=ta.length;Cb<yc;Cb++){var Oa=ta[Cb];if(Oa.ClientId===wb||ic&&(Oa=vb(Oa.Children,wb,ic)))return Oa}return null};var Sc=a(2),hd=a(181),qc=a(1406),Lc=a(25);class bd{constructor(ta,
wb){this.$=ta;this.fieldManagerPane=wb}FS(ta){Lc.a.ut()?void D.a.resolve(J.We,{va:0}).then(wb=>wb.hS("FieldListTaskPane",this.pt(ta,-1,null,null,!1,-1,!1,0,-1,!1,null))):hd.a.Go().then(wb=>{wb.showTaskPane("FieldListTaskPane",this.pt(ta,-1,null,null,!1,-1,!1,0,-1,!1,null));return null})}gL(ta,wb,ic,Oa,Cb,yc,Nc,Id,ke,Ie,Le){Lc.a.ut()?void D.a.resolve(J.We,{va:0}).then(wf=>wf.updateTaskPane("FieldListTaskPane",this.pt(ta,wb,ic,Oa,Cb,yc,Nc,Id,ke,Ie,Le))):hd.a.Go().then(wf=>{wf.updateTaskPane("FieldListTaskPane",
this.pt(ta,wb,ic,Oa,Cb,yc,Nc,Id,ke,Ie,Le));return null})}gOa(){Lc.a.ut()?void D.a.resolve(J.We,{va:0}).then(ta=>ta.setSelectedTaskPane("FieldListTaskPane")):hd.a.Go().then(ta=>{ta.setSelectedTaskPane("FieldListTaskPane");return null})}zU(){Lc.a.ut()?void D.a.resolve(J.We,{va:0}).then(ta=>ta.hideTaskPane("FieldListTaskPane")):hd.a.Go().then(ta=>{ta.hideTaskPane("FieldListTaskPane",2);return null})}pt(ta,wb,ic,Oa,Cb,yc,Nc,Id,ke,Ie,Le){ta={type:"FieldListTaskPaneProps",fieldListItems:ic,fieldWellsItems:Oa,
dataUpdateType:wb,isDataModel:Cb,selectedTab:yc,isSortAscending:Nc,focusResetType:Id,focusResetId:ke,isRichPivotFieldList:Ie,fieldListSearchInfo:Le,isOlap:this.fieldManagerPane.Rxa,isPivotChart:this.fieldManagerPane.Qxa,fieldListSizePercentage:this.fieldManagerPane.Lak,onFieldExpandCollapse:this.fieldManagerPane.Iak,onExpandCollapseAll:this.fieldManagerPane.Hak,onFieldCheckedChanged:this.fieldManagerPane.Qak,onFieldListItemMenuClickV2:this.fieldManagerPane.Jak,onSortOrderChanged:this.fieldManagerPane.Cak,
onSaveFieldListSizePercentage:this.fieldManagerPane.$ak,onSearchInputChanged:this.fieldManagerPane.Kak,onSelectedTabChanged:wf=>{this.fieldManagerPane.Dak(wf)},onFieldMove:(wf,Kf,cg,Bg)=>{this.fieldManagerPane.Tak(wf,Kf,cg,Bg)},onFieldWellItemMenuClickV2:(wf,Kf,cg,Bg)=>{this.fieldManagerPane.Mak(wf,Kf,cg,Bg)}};return Object(Sc.a)(new qc.a,{contentProps:ta,onOpen:()=>{this.fieldManagerPane.cVj()},onClose:()=>{this.fieldManagerPane.aVj()},onManualClose:()=>{this.fieldManagerPane.bVj()},title:this.fieldManagerPane.Qxa?
sa.a.instance.ia(1183):sa.a.instance.ia(1182),width:400,enableResize:!0,minResizeWidth:400,maxResizeWidth:950})}}Object(C.a)(bd,"FieldListReactTaskPane",null,[472]);class jd{constructor(ta,wb,ic){this.cachedItemIndex=this.cachedSourceAxis=0;this.cachedItemName=null;this.cachedSourceAxis=ta;this.cachedItemIndex=wb;this.cachedItemName=ic}}Object(C.a)(jd,"MacroRecorderPivotTablePivotedAdditionalInformation",null,[]);class Yd{constructor(ta,wb,ic,Oa){this.activeCell=this.additionalInformation=this.pivotData=
this.pivotName=null;this.pivotName=ta;this.pivotData=wb;this.additionalInformation=ic;this.activeCell=Oa}getActiveCell(){return this.activeCell}}Object(C.a)(Yd,"MacroRecorderPivotTablePivotedPayload",null,[65]);var te=a(197),oe=a(86),Kd=a(111),Ee=a(75);Object(D.b)(J.bc,{yk:"singleton"})(ta=>No(function*(){var wb=yield D.a.resolve(J.Lb,ta);const [ic,Oa,Cb]=yield Promise.all([D.a.resolve(J.We,ta),D.a.resolve(J.qb,ta),D.a.resolve(J.ac,ta)]);wb=rc.c6e(wb,ic,Oa,Cb);null===wb||void 0===wb?void 0:wb.Mkg();
return wb}));class rc extends la.a{constructor(ta,wb,ic,Oa,Cb){var yc;super(ta);this.iwf=300;this.Z_=new kb;this.$_=new kb;this.xzd={};this.YHa=this.Wq=this.Vq=null;this.iIb=this.knc=this.Owc=!1;this.currentState=J.ac.Ha()?null:le.ggb();this.THb=this.zUa=null;this.$na=0;this.pme=this.HUd=!1;this.XHa=null;this.RYf=this.Oq=!1;this.KUh=this.oxg=this.tde=null;this.qNa=-1;this.a7=[];this.$1b=!1;this.C4a=null;this.Z1b=this.lxg=this.ude=!1;this.Y1b="";this.B4a=null;this.Mha=0;this.Lha="";this.rde=!1;this.jxg=
null;this.tq=!1;this.oZ=0;this.Qak=(Nc,Id)=>{this.Wq&&this.Jga&&(Nc=vb(this.Wq.FieldListItems,Nc,!0))&&(Q.ULS.sendTraceTag(554317778,0,50,"React Field List: check/uncheck a field."),this.rrj(Nc,Id))};this.Iak=Nc=>{this.Wq&&(Nc=vb(this.Wq.FieldListItems,Nc,!0))&&Nc.IsCollapsible&&(5===Nc.TypeTag&&Nc.IsCollapsed&&!Nc.Children.length?(this.a7.length=0,this.a7.push(Nc),this.IDd()):(Nc.IsCollapsed=!Nc.IsCollapsed,this.Oq&&this.ixc(0,-1,!1,!1,!1,!1)))};this.Hak=Nc=>{this.Wq&&(Q.ULS.sendTraceTag(554317777,
0,50,"React Field List: expand/collapse all fields."),0<this.a7.length&&(this.a7.length=0),this.gxg(this.Wq.FieldListItems,Nc)?this.IDd():this.Oq&&this.ixc(0,-1,!1,!1,!1,!1))};this.Jak=(Nc,Id,ke)=>{if(this.Wq){var Ie=document.getElementById(Id);if(Ie){var Le=vb(this.Wq.FieldListItems,Nc,!0);if(Le){Nc={};Nc.domElement=Ie;Nc.fieldItem=Le;Nc.versionkey=this.ALb;Nc.isChart=!!this.chartId;Nc.isPpm=this.Wq.IsPpm;Nc.isOlap=this.currentState.Rxa;Nc.supportsImplicitMeasures=this.Wq.SupportsImplicitMeasures;
Nc.isKeyboardInput=ke;this.C4a=Id;Id=new oe.a(330754562,0,this.$.Rh,30,null);var wf;this.$1b=!te.a(wf=this.$.Ma.dh(Id,Nc))&&(6!==wf.status||wf.result)}}}};this.Cak=Nc=>{Q.ULS.sendTraceTag(554317775,0,50,"React Field List: change field list sort order.");const Id=rc.TKb(this.currentState);this.$.userOperationManager.enqueueOperation(new Lb.a(251,0,(ke,Ie,Le)=>{var wf=this.$.pa.ta;const Kf=V.M(wf,this.currentState.sB,this.currentState.externalSourceIndex,Id);Kf.isAscending=Nc;return V.h(wf,"ChangePivotFieldListSortOrder",
Kf,ke,Ie,Le,null,0)}),null)};this.$ak=Nc=>{this.wSe=Nc};this.Kak=Nc=>{Nc!==this.Lha&&(Q.ULS.sendTraceTag(537162715,0,50,"React Field List: change search input."),this.Lha=Nc,this.ixc(0,-1,!1,!0,!1,!1))};this.xlg=()=>{if(this.$1b&&this.C4a){const Nc=document.getElementById(this.C4a);Nc&&Nc.classList.add("fieldItemMenuOpen")}};this.wlg=()=>{if(this.$1b&&this.C4a){const Nc=document.getElementById(this.C4a);Nc&&(Nc.classList.remove("fieldItemMenuOpen"),Nc.classList.contains("fieldItemOnHover")||Nc.classList.contains("fieldItemOnFocus")||
(Nc.style.visibility="hidden"))}this.$1b=!1;this.C4a=null};this.$ya=()=>{this.mme(!0,null);this.hideTaskPane();return!0};this.Wka=()=>{if(this.$)if(Ee.a(this.$).H_a&&this.isVisible&&this.currentState.Sxa&&this.$.ea.Ph){if(this.Z_.aw&&!this.Z_.request){var Nc=this.Z_;var Id=this.$.pa.ta;var ke=this.currentState.bR,Ie=this.currentState.$4a,Le=this.currentState.rA,wf=this.dQj,Kf=this.eQj,cg=this.Z_.lbg();const Bg=V.M(Id,this.currentState.sB,this.currentState.externalSourceIndex,rc.TKb(this.currentState));
Bg.type=1;Bg.version=ke;Bg.relatedGroup=Ie;Bg.selectedTab=Le;Id=V.h(Id,"GetPivotFieldListData",Bg,wf,Kf,null,cg,4);Nc.request=Id}this.$_.aw&&!this.$_.request&&(Nc=this.$_,Id=this.$.pa.ta,ke=this.currentState.sX,Ie=this.gQj,Le=this.hQj,wf=this.$_.lbg(),Kf=V.M(Id,this.currentState.sB,this.currentState.externalSourceIndex,rc.TKb(this.currentState)),Kf.type=1,Kf.version=ke,Id=V.h(Id,"GetPivotFieldManagerData",Kf,Ie,Le,null,wf,4),Nc.request=Id)}else rc.P9(this.Z_),rc.P9(this.$_)};this.dQj=(Nc,Id)=>{this.gtg(Nc,
Id,this.Z_)&&(Nc=Nc.Result)&&(this.currentState.bR=Nc.FieldListVersion,this.Z_.aw=!1,this.s2g(Nc));this.NG.qxe();this.refresh()};this.eQj=Nc=>{this.Pfg(Nc,this.Z_)};this.gQj=(Nc,Id)=>{this.gtg(Nc,Id,this.$_)&&(Nc=Nc.Result)&&(this.currentState.sX=Nc.FieldWellVersion,this.$_.aw=!1,this.g2g(Nc));this.refresh()};this.hQj=Nc=>{this.Pfg(Nc,this.$_)};this.kKj=Nc=>{if(sc.a.Jk(Nc.Errors)){this.iIb=!1;this.zUa=null;for(let ke=0,Ie=Nc.Errors.length;ke<Ie;++ke)if(1244452614===Nc.Errors[ke].MessageId){if(na.EwaSettings.isChangeGateEnabled("OfficeVSO:4354463_UpdateSelectionAfterApplyPivot")){Nc=
Ya.f(this.$);var Id=Nc.Yg.Lw(Nc.ha.qa.activeCell);Id&&(Id=rb.Range.gi(Id.DGg+1,Id.left),Id=Kb.w(Id,this.$),Nc.To(Id,null,null,null,3,"FieldManagerPane.OnApplyPivotSuccess"))}this.currentState.bR=-1;this.currentState.sX=-1;this.refresh();break}}this.Owc=!0};this.sOj=Nc=>{this.knc=!1;if(!sc.a.Jk(Nc.Errors)){if(0<this.a7.length)for(Nc=0;Nc<this.a7.length;++Nc)this.a7[Nc].IsCollapsed=!1;this.currentState.bR=-1;this.refresh()}};this.Yya=()=>{const Nc=Ya.f(this.$).ha;Nc.$e.eVd&&Nc.wk&470||Ya.f(this.$).inRangePicker||
Ya.f(this.$).Pp||this.l2b(!0,!0)};this.ol=()=>{this.refresh();this.$.ea.Cq.FieldListForceOnTop&&this.O6b(!1,null,!0)};this.RMc=()=>{this.l2b(!0,!0)};this.xj=()=>{this.l2b(!0,!1)};this.aq=(Nc,Id)=>{Nc=Zb.e(Id.mB)||Zb.e(Id.na);this.l2b(!0,Nc)};this.pC=(Nc,Id)=>{for(const ke of Id.y7k)this.t2g(ke);this.HUd&&(this.HUd=!1);this.l2b(!1,!0)};this.Yhg=(Nc,Id)=>{Ya.f(this.$).ex||this.t2g(Id.Ti.hash)};this.Eeg=()=>{this.refresh()};this.Oi=()=>{this.wV()};this.Dt=()=>{this.wV()};this.Ung=()=>{this.refresh()};
this.mpg=()=>{this.Wka()};J.ac.Ha()&&(this.currentState=Cb.ggb());this.NG=Oa;this.$=wb;this.Bk=wb.Bk;this.taskPaneManager=ic;this.mib=Cb;this.yta(this.Ung);this.Tnj=na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotFieldList",!1);this.wSe=.5;this.XHa=new bd(this.$,this);this.$.Ma.uzh(this.xlg);this.$.Ma.fGb(this.wlg);this.iwf=400;pb.a.equals("rtl",ta.dir,!0)&&(this.tq=!0);this.Ysi=[4,2,1,8];this.$.nr(this.xj);
ta=Ya.f(this.$);ta.za.Vy(this.Yhg);ta.r9(this.pC);Hb.a(this.$).za.Vy(this.Eeg);ta.ha.add_activeCellChanged(this.Yya);ta.KN(this.Yya);ta.ha.$e.uyh(this.RMc);null===(yc=Kd.a(this.$))||void 0===yc?void 0:yc.mnd(this.RMc);this.$.sa.Qm(this.aq);this.$.ea.Xy(this.ol);this.$.ea.uq(this.Oi);this.$.ea.NN(this.Dt);Ee.a(this.$).smd(this.mpg);P.a(this.$).Eq(this);this.refresh()}yta(ta){this.addHandler(rc.Yvc,ta)}aAa(ta){this.removeHandler(rc.Yvc,ta)}I0e(ta){this.addHandler(rc.hwf,ta)}PBg(ta){this.removeHandler(rc.hwf,
ta)}H0e(ta){this.addHandler(rc.gwf,ta)}OBg(ta){this.removeHandler(rc.gwf,ta)}get pivotName(){return this.currentState.pivotTableName}get chartId(){return this.currentState.chartId}get sB(){return this.currentState.sB}get Rxa(){return this.currentState.Rxa}get Qxa(){return this.currentState.Qxa}get confirmationRequiredForDataOps(){return this.currentState.confirmationRequiredForDataOps}get externalSourceIndex(){return this.currentState.externalSourceIndex}get bR(){return this.currentState.bR}get sX(){return this.currentState.sX}get ALb(){return this.currentState.ALb}get isRtl(){return this.tq}get Soe(){return this.JGb}get Jga(){return!(!this.isVisible||
this.Z_.aw||this.$_.aw||this.knc||this.iIb)}get parentElement(){return this.$.domElement}get Pi(){return this.domElement}get isVisible(){return super.isVisible}set isVisible(ta){ta=this.qlc&&ta;!ta||this.THb||this.RYf||this.e$i();ta!==super.isVisible&&(super.isVisible=ta,this.raiseEvent(rc.Yvc));this.Yyg(null,ta)}get Co(){return this.isVisible}get Hk(){return ob.a.Wsi}get U7a(){return 1}get Dx(){return xa.a.Qni}get kP(){return this.iwf}get isResizable(){return!0}get titleText(){return sa.a.instance.ia(1182)}get Lak(){return this.wSe}get jJ(){return this.taskPaneManager.gjb(this.Pi,
this.titleText,this.kP,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.kP)}get JGb(){return this.$.th.aea(36896)&&this.qlc}get qlc(){const ta=new Tc.a(this.$.sa);return this.$.isEditMode&&ta.Hj(8192)||!ta.Dn}get a8h(){return(this.pivotName||"")+(this.chartId||"")}DE(){}EU(){return this.JGb&&!fc.g(this.Bk)}L5(){const ta=J.ac.Ha()?this.mib.create(this.qNa):le.create(this.$,this.qNa,this.NG);return ta.Sxa&&!ta.Bmj&&!fc.g(this.Bk)}fmd(ta,
wb){(ta=yd(this.Wq.FieldListItems,ta,this.currentState.Rxa?5:17,!0))&&ta.CanDrag&&this.dU(ta,wb,0,null,null)}dU(ta,wb,ic,Oa,Cb){let yc;if(Oa&&!pb.a.equals(Oa,this.ALb,!1))alert(sa.a.instance.Ba(18));else{Oa=this.eBf(ta.PivotCacheIndex,ta.PivotTableIndex);var Nc=Oa.axis,{pos:Id,Drg:ke}=Oa;-1!==ta.PivotTableIndex?yc=Nc:(Id=yc=0,ke=ta.PivotCacheIndex);if(0===yc){if(7===ta.TypeTag&&(ta=0<=ta.ClientParentId?vb(this.Wq.FieldListItems,ta.ClientParentId,!0):null,!ta))return;Id=0;ke=ta.PivotCacheIndex}if(yc!==
wb||0===wb||Id!==ic&&Id!==ic-1){var Ie=new jd(Nc,ta.PivotCacheIndex,ta.Name);this.NG.UL(this.currentState.confirmationRequiredForDataOps,Le=>{Le&&this.applyPivot(this.currentState,yc,Id,ta.TypeTag,ke,wb,ic,Cb,Ya.f(this.$),Ie,ta)})}}}Tak(ta,wb,ic,Oa){if(this.Wq&&this.Vq){var Cb=null;switch(wb){case 0:Cb=vb(this.Wq.FieldListItems,ta,!0);break;case 1:Cb=vb(this.Vq.RowAxis,ta,!1);break;case 2:Cb=vb(this.Vq.ColumnAxis,ta,!1);break;case 4:Cb=vb(this.Vq.FilterAxis,ta,!1);break;case 8:Cb=vb(this.Vq.DataAxis,
ta,!1)}Cb&&(Q.ULS.sendTraceTag(554317779,0,50,"React Field List: drag and drop a field."),this.dU(Cb,ic,Oa,null,null))}}gxg(ta,wb){let ic;ic=!1;for(let Oa=0;Oa<ta.length;Oa++){const Cb=ta[Oa];wb&&Cb.IsCollapsible&&5===Cb.TypeTag&&Cb.IsCollapsed&&!Cb.Children.length?(this.a7.push(Cb),ic=!0):wb&&Cb.IsCollapsible&&Cb.IsCollapsed?Cb.IsCollapsed=!1:wb||!Cb.IsCollapsible||Cb.IsCollapsed||(Cb.IsCollapsed=!0);Cb.IsCollapsible&&Cb.Children&&0<Cb.Children.length&&this.gxg(Cb.Children,wb)&&(ic=!0)}return ic}ixc(ta,
wb,ic,Oa,Cb,yc){if(this.Wq){var Nc=!1,Id=!1,ke=!1,Ie=null;Id=null;var Le=ta;Oa&&0<this.a7.length&&(this.a7.length=0);({CRb:Id,ZGa:ke,isRichPivotFieldList:Nc,returnValue:Ie}=this.aHd(this.Wq.FieldListItems,Oa,!1));ke?this.knc||this.IDd():(Id={needSearchReset:yc,needSearchRestore:!yc&&Cb,searchRestoreValue:!yc&&Cb?this.Lha:"",searchWithNoMatch:""!==this.Lha&&!Id},Id.searchWithNoMatch&&Oa&&ua.TaskExtensions.Ua(na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",
!1)?Object(Wb.d)(D.a.resolve(J.l,{va:0})):ha.GetServiceTaskFactory.Bj(this.$.ka,211,212,0),wf=>{wf.result.readText(sa.a.instance.ia(778))},this.$.xa,3),""!==this.Lha&&2===ta&&(Id.searchWithNoMatch?Le=1:ic&&Ie&&0<Ie.length&&(wb=Ie[0].id)),this.XHa.gL(this.THb,0,Ie,null,this.Wq.IsPpm,this.Wq.SelectedTab,this.Wq.IsSortAscending,Le,wb,Nc,Id))}}Dak(ta){Q.ULS.sendTraceTag(554317776,0,50,"React Field List: change All/Active tab.");this.qNa=ta;this.$Tk()}Mak(ta,wb,ic,Oa){if(this.Vq){var Cb=document.getElementById(ic);
if(Cb){var yc=null,Nc=-1;switch(wb){case 4:yc=vb(this.Vq.FilterAxis,ta,!1);Nc=this.Vq.FilterAxis.length;break;case 2:yc=vb(this.Vq.ColumnAxis,ta,!1);Nc=this.Vq.ColumnAxis.length;break;case 1:yc=vb(this.Vq.RowAxis,ta,!1);Nc=this.Vq.RowAxis.length;break;case 8:yc=vb(this.Vq.DataAxis,ta,!1),Nc=this.Vq.DataAxis.length}if(yc){var Id={};this.currentState.Qxa?(Id.AnchorType=8,Id.ChartId=this.currentState.chartId):Id.AnchorType=9;Id.AnchorValue1=yc.PivotTableIndex;Id.AnchorValue2=yc.PivotCacheIndex;var {axis:ke,
pos:Ie}=this.eBf(yc.PivotCacheIndex,yc.PivotTableIndex);ta=new oe.a(-1453503574,0,this.$.Rh,30,null);wb={};wb.domElement=Cb;wb.fieldItem=yc;wb.zoneCount=Nc;wb.sourceAxis=ke;wb.sourceAxisPos=Ie;wb.optionalPivotMenuAnchorParameter=Id;wb.isOlap=this.currentState.Rxa;wb.isPpm=this.Wq.IsPpm;wb.versionkey=this.ALb;wb.isKeyboardInput=Oa;wb.cell=this.currentState.sB;wb.externalSourceIndex=this.externalSourceIndex;Oa=!1;na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&
this.currentState.Rxa&&!this.Wq.IsPpm&&this.Wq.SupportsImplicitMeasures&&(yc=yd(this.Wq.FieldListItems,yc.PivotCacheIndex,5,!0),Oa=!!yc&&!yc.IsCollapsible);wb.fieldItemsupportsImplicitMeasures=Oa;this.C4a=ic;var Le;this.$1b=!te.a(Le=this.$.Ma.dh(ta,wb))&&(6!==Le.status||Le.result)}}}}hxg(ta,wb){ta&&ua.TaskExtensions.Ua(ha.GetServiceTaskFactory.Bj(this.$.ka,103,104,0),ic=>{var Oa=ic.result;const Cb=Ya.f(this.$),yc=Kb.w(rb.Range.gi(1,1),this.$).SheetName;ic=Oa.X8a(Cb);let Nc,Id,ke,Ie;ic?(Oa=ic.Lj,Nc=
Oa.jj.top,Id=Oa.jj.left,ke=ic.VS.x,Ie=ic.VS.y):(Nc=Id=1,ic=Oa.rJa(Cb),ke=ic.x,Ie=ic.y);this.$.userOperationManager.enqueueOperation(new Lb.a(203,0,(Le,wf,Kf)=>xb.x(this.$.pa.ta,yc,this.pivotName,ta.PivotCacheIndex,wb,Nc,Id,ke,Ie,Le,wf,Kf,null),void 0,()=>new cc.a(yc,this.pivotName,ta.PivotCacheIndex,wb)),null)},this.$.xa,8)}dispose(){var ta;if(this.$){this.$.Pr(this.xj);this.$.Ma.Sjk(this.xlg);this.$.Ma.c3b(this.wlg);this.a7.length=0;const wb=Ya.f(this.$);wb&&(wb.u1(this.pC),wb.vP(this.Yya),wb.ha&&
(wb.ha.remove_activeCellChanged(this.Yya),wb.ha.$e.Yik(this.RMc)),wb.za&&wb.za.Fy(this.Yhg));null===(ta=Kd.a(this.$))||void 0===ta?void 0:ta.Dge(this.RMc);ta=Hb.a(this.$);(null===ta||void 0===ta?0:ta.za)&&ta.za.Fy(this.Eeg);this.$.sa&&this.$.sa.hn(this.aq);if(ta=this.$.ea)ta.pA(this.ol),ta.pq(this.Oi),ta.wP(this.Dt);Ee.a(this.$)&&Ee.a(this.$).BSc(this.mpg)}this.taskPaneManager&&this.aAa(this.Ung);this.tde&&(Da.a.instance.Na(ea.a.click,this.tde,this.$ya),Uc.a.instance.h2(this.tde,this.KUh));this.hideTaskPane();
this.taskPaneManager=this.$=this.XHa=null;super.dispose()}zp(ta,wb){if(!wb){ta=Ta.DOMElementExtensions.fE(this.domElement.querySelectorAll(Ta.DOMElementExtensions.zI));if(!ta)return!1;Ta.DOMElementExtensions.setFocus(ta)}return!wb}Yp(ta){return Ta.DOMElementExtensions.Cn(this.Pi,ta)}gs(){}Xt(){}$Tk(){this.refresh()}rrj(ta,wb){ta&&ta.CanDrag&&this.dU(ta,wb?-1:0,-1,null,null)}Mkg(){this.EU()&&this.L5()&&(this.isVisible=!0)}cVj(){this.ude=!0;this.refresh()}aVj(){this.hideTaskPane()}bVj(){this.mme(!0,
null);this.hideTaskPane()}e$i(){this.RYf=this.Oq=!0;this.XHa.FS(this.THb)}showTaskPane(){this.isVisible=!0;""!==this.Lha&&(this.rde=!0);this.Oq?this.XHa.gOa():(this.Oq=!0,this.XHa.FS(this.THb))}hideTaskPane(){this.isVisible=this.ude=this.Oq=!1;this.XHa.zU()}O6b(ta,wb,ic){this.mme(ta,wb);this.HUd=ic;this.pme=!ta&&!!wb||ic;ta?this.hideTaskPane():this.showTaskPane()}IDd(){this.NG.UL(this.currentState.confirmationRequiredForDataOps,ta=>{ta&&this.expandPivotFieldListLevels(this.currentState)})}s2g(ta){if(this.Wq=
ta)this.currentState.bR=this.Wq.FieldListVersion,this.$na=Ac(this.Wq.FieldListItems,-1,this.$na);if(this.Wq)if(this.Oq){this.qNa=this.currentState.rA=this.Wq.SelectedTab;this.zvj();ta=-1;var wb=0,ic=!1;this.pme?(this.Wq.FieldListItems&&0<this.Wq.FieldListItems.length&&(ta=this.Wq.FieldListItems[0].ClientId,wb=2,ic=!0),this.pme=!1):this.Owc&&0===this.Mha&&(this.B4a||this.Z1b?this.Wq.FieldListItems&&0<this.Wq.FieldListItems.length&&(ta=this.Z1b?this.Wq.FieldListItems[0].ClientId:this.B4a.ClientId,wb=
2,ic=this.Z1b):this.lxg&&(ta=this.Wq.FieldListItems[0].ClientId,wb=1),this.Joc());var Oa=!1;this.jxg!==this.Wq.PivotXluid&&(this.jxg=this.Wq.PivotXluid,Oa=!0,this.Lha="");this.ixc(wb,ta,ic,!1,!Oa&&this.rde&&""!==this.Lha,Oa);this.rde=!1}else this.Joc()}Joc(){this.Mha=0;this.B4a=null;this.Y1b="";this.Owc=this.Z1b=this.lxg=!1}uJk(ta){return 7===ta.TypeTag?!1:ta.ShowFilterArrow||ta.ShowCheckBox}trj(ta){return ta.IsCollapsible&&(!ta.IsCollapsed||2===ta.Image)&&!!ta.Children&&0<ta.Children.length}CRb(ta,
wb){const ic=wb.length;return 2<ic&&'"'===wb.charAt(0)&&'"'===wb.charAt(ic-1)?pb.a.contains(ta,wb.substring(1,ic-1),!0):pb.a.Sfb(wb,"*")||pb.a.Sfb(wb,"?")?(wb=wb.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&"),wb="^"+pb.a.ytb(pb.a.ytb(wb,"\\\\?",".",!0),"\\\\*",".*",!0)+"$",0<=ta.search(new RegExp(wb,"i"))):pb.a.contains(ta,wb,!0)}aHd(ta,wb,ic){let Oa,Cb,yc,Nc;Oa=Nc=yc=Cb=!1;const Id=[];for(let Ie=0;Ie<ta.length;Ie++){const Le=ta[Ie];let wf=!1,Kf=!1,cg=!1,Bg,dh=[];if(""===this.Lha){if(this.trj(Le)){var ke=
void 0;({CRb:Kf,ZGa:Bg,iOf:ke,isRichPivotFieldList:wf,returnValue:dh}=this.aHd(Le.Children,wb,!1));Le.ShowCheckBox||(Le.IsChecked=ke)}}else 2!==Le.Image&&this.CRb(Le.Name,this.Lha)&&(Oa=cg=!0,wb&&Le.IsCollapsible&&Le.IsCollapsed&&(5!==Le.TypeTag||Le.Children.length?Le.IsCollapsed=!1:(this.a7.push(Le),Cb=!0))),wb&&ic&&Le.IsCollapsible&&Le.IsCollapsed&&(5!==Le.TypeTag||Le.Children.length?Le.IsCollapsed=!1:(this.a7.push(Le),Cb=!0)),Le.IsCollapsible&&Le.Children&&0<Le.Children.length&&({CRb:Kf,ZGa:Bg,
iOf:ke,isRichPivotFieldList:wf,returnValue:dh}=this.aHd(Le.Children,wb,cg||ic),Le.ShowCheckBox||(Le.IsChecked=ke),Kf&&(Oa=!0,wb&&(Le.IsCollapsed=!1)),Bg&&(Cb=!0));this.Tnj&&(wf||66===Le.TypeTag)&&(Nc=!0);Le.IsChecked&&(yc=!0);(""===this.Lha||cg||Kf||ic)&&Id.push({id:Le.ClientId,name:Le.Name,type:Le.TypeTag,isCollapsible:Le.IsCollapsible,showCheckBox:Le.ShowCheckBox,isMoreFields:2===Le.Image,canDrag:Le.CanDrag&&7!==Le.TypeTag,showSeparator:Le.ShowSeparator,showMenu:this.uJk(Le),isCollapsed:Le.IsCollapsed,
isChecked:Le.IsChecked,isBolded:Le.IsBolded,children:dh})}return{returnValue:Id,CRb:Oa,ZGa:Cb,iOf:yc,isRichPivotFieldList:Nc}}pxc(ta){const wb=Array(ta.length);for(let ic=0;ic<ta.length;ic++){const Oa=ta[ic];wb[ic]={id:Oa.ClientId,name:Oa.Name}}return wb}Ssk(){this.THg(this.Wq.FieldListItems,"")}zvj(){this.n4f(this.Wq.FieldListItems,"")}Xvc(ta,wb){return ta.Name+"_"+ta.UniqueName+"_"+ta.TypeTag+"_"+(wb||this.a8h)}THg(ta,wb){if(ta)for(let ic=0,Oa=ta.length;ic<Oa;ic++){const Cb=ta[ic];let yc="";if(Cb.IsCollapsible||
Cb.Children)yc=this.Xvc(Cb,wb),Cb.IsCollapsible&&(this.xzd[yc]=!!Cb.IsCollapsed),Cb.Children&&this.THg(Cb.Children,yc);this.B4a&&Cb.ClientId===this.B4a.ClientId&&(this.Y1b=yc||this.Xvc(Cb,wb))}}n4f(ta,wb){if(ta)for(let ic=0,Oa=ta.length;ic<Oa;ic++){const Cb=ta[ic];let yc="";if(Cb.IsCollapsible||Cb.Children)yc=this.Xvc(Cb,wb),Cb.IsCollapsible&&yc in this.xzd&&(Cb.IsCollapsed=Ha.a.Em(this.xzd,yc)),Cb.Children&&this.n4f(Cb.Children,yc);this.Y1b&&pb.a.equals(this.Y1b,yc||this.Xvc(Cb,wb),!1)&&(this.B4a=
Cb,this.Y1b="")}}g2g(ta){if(this.Vq=ta)this.currentState.sX=this.Vq.FieldWellVersion,this.$na=Ac(this.Vq.FilterAxis,-1,this.$na),this.$na=Ac(this.Vq.ColumnAxis,-1,this.$na),this.$na=Ac(this.Vq.RowAxis,-1,this.$na),this.$na=Ac(this.Vq.DataAxis,-1,this.$na);this.YHa?this.YHa.length=0:this.YHa=[];if(this.Vq)if(this.YHa.push(this.Vq.FilterAxis),this.YHa.push(this.Vq.ColumnAxis),this.YHa.push(this.Vq.RowAxis),this.YHa.push(this.Vq.DataAxis),this.Oq){ta=-1;var wb=0;if(this.Owc&&0!==this.Mha){switch(this.Mha){case 1:0<
this.Vq.RowAxis.length&&(ta=this.Vq.RowAxis[0].ClientId,wb=3);break;case 2:0<this.Vq.ColumnAxis.length&&(ta=this.Vq.ColumnAxis[0].ClientId,wb=3);break;case 4:0<this.Vq.FilterAxis.length&&(ta=this.Vq.FilterAxis[0].ClientId,wb=3);break;case 8:0<this.Vq.DataAxis.length&&(ta=this.Vq.DataAxis[0].ClientId,wb=3)}this.Joc()}var ic={filtersWellItems:this.pxc(this.Vq.FilterAxis),columnsWellItems:this.pxc(this.Vq.ColumnAxis),rowsWellItems:this.pxc(this.Vq.RowAxis),valuesWellItems:this.pxc(this.Vq.DataAxis)};
this.XHa.gL(this.THb,1,null,ic,!1,-1,!1,wb,ta,!1,null)}else this.Joc()}X3k(){this.oxg&&(this.oxg.innerText=this.currentState.Qxa?sa.a.instance.ia(1183):this.titleText)}refresh(){if(this.ude){var ta=J.ac.Ha()?this.mib.create(this.qNa):le.create(this.$,this.qNa,this.NG);this.Yyg(ta)}}Yyg(ta,wb){wb=void 0===wb?!1:wb;if(this.isVisible){ta=ta||(J.ac.Ha()?this.mib.create(this.qNa):le.create(this.$,this.qNa,this.NG));const ic=this.currentState;this.Wq&&this.Ssk();this.currentState=ta;if((J.ac.Ha()?this.mib.OXd(ic,
ta):le.OXd(ic,ta))||wb){if(this.iIb=!1,this.Z_.aw=ta.Sxa,rc.P9(this.Z_),(J.ac.Ha()?this.mib.WVb(ic,ta):le.WVb(ic,ta))||wb)this.$_.aw=ta.Sxa,rc.P9(this.$_),this.s2g(null),this.g2g(null),this.X3k()}else ic.bR<ta.bR?(this.Z_.aw=!0,rc.P9(this.Z_)):this.currentState.bR=ic.bR,ic.sX<ta.sX?(this.iIb=!1,this.$_.aw=!0,rc.P9(this.$_)):this.currentState.sX=ic.sX}Ka.a.instance.create(this.Wka,0,La.a.Vsi,!0,!0)}mme(ta,wb){this.applyPivotFieldManagerHiddenState(ta,wb);this.Bk=pa.HelperMethods.jZ(ta,this.Bk,4);this.refresh();
this.raiseEvent(rc.Yvc);this.$.jm()}applyPivotFieldManagerHiddenState(ta,wb){this.$.userOperationManager.enqueueOperation(new Lb.a(144,0,(ic,Oa,Cb)=>{const yc=Kb.p(Ya.f(this.$).ha.qa.activeCell,this.$);var Nc=this.$.pa.ta;const Id=Nc.Za(9);Id.hidden=ta;Id.activeCell=yc;return V.h(Nc,"ApplyPivotFieldManagerHiddenStateV2",Id,ic,Oa,Cb,null,0)},16),wb)}gtg(ta,wb,ic){ic.aw=!1;if(!ic.request||wb!==ic.correlationId)return!1;ic.request=null;return sc.a.Jk(ta.Errors)?(this.$.ea.Yw(ta.Errors),!1):!0}Pfg(ta,
wb){const ic=Nd.a.Qj(ta.data);this.$.ea.Yw(ic);wb.request=null;10!==ta.data.status&&(wb.aw=!1);this.Wka()}applyPivot(ta,wb,ic,Oa,Cb,yc,Nc,Id,ke,Ie,Le){0<ke.getRangeInformation(ke.ha.qa.activeCell).length?this.iIb=!0:(this.Z_.aw=!0,this.$_.aw=!0);ta.CGc&&(this.zUa=ta.pivotTableName);const wf=rc.TKb(ta),Kf={FieldListType:1};Kf.FieldListVersion=ta.bR;Kf.FieldWellVersion=ta.sX;Kf.SourceAxis=wb;Kf.SourceAxisPosition=ic;Kf.ItemType=Oa;Kf.ItemIndex=Cb;Kf.DestinationAxis=yc;Kf.DestinationAxisPosition=Nc;
this.o6k(Le,wb,yc);wb=new Lb.a(145,0,(cg,Bg,dh)=>{var Sf=this.$.pa.ta;cg=Yb.c(cg,this.kKj);const eh=V.M(Sf,ta.sB,ta.externalSourceIndex,wf);eh.pivotFieldApplyData=Kf;return V.h(Sf,"ApplyPivot",eh,cg,Bg,dh,null,0)},4,()=>new Yd(this.pivotName,Kf,Ie,ta.sB));this.$.userOperationManager.enqueueOperation(wb,Id)}o6k(ta,wb,ic){if(this.Wq&&this.Vq)if(0===wb)this.Mha=0,this.B4a=ta;else if(0!==ic)this.Mha=ic;else switch(this.Mha=0,this.Z1b=!0,wb){case 1:1<this.Vq.RowAxis.length&&(this.Mha=1);break;case 2:1<
this.Vq.ColumnAxis.length&&(this.Mha=2);break;case 4:1<this.Vq.FilterAxis.length&&(this.Mha=4);break;case 8:1<this.Vq.DataAxis.length&&(this.Mha=8)}}expandPivotFieldListLevels(ta){const wb=rc.TKb(ta);this.knc=!0;this.$.userOperationManager.enqueueOperation(new Lb.a(146,0,(ic,Oa,Cb)=>{var yc=this.$.pa.ta;ic=Yb.c(ic,this.sOj);const Nc=V.M(yc,ta.sB,ta.externalSourceIndex,wb);Nc.type=1;return V.h(yc,"ExpandPivotFieldListLevels",Nc,ic,Oa,Cb,null,0)}),null)}eBf(ta,wb){var ic;for(let Cb=rc.p7g;Cb<=rc.q7g;Cb++){const yc=
this.YHa[Cb];for(ic=yc.length-1;0<=ic;ic--){var Oa=yc[ic];if(Oa.PivotCacheIndex===ta&&(-1===wb||Oa.PivotTableIndex===wb))return ta=this.tQi(Cb),Oa=Oa.PivotTableIndex,{returnValue:!0,axis:ta,pos:ic,Drg:Oa}}}return{returnValue:!1,axis:0,pos:-1,Drg:-1}}drj(ta){return ta>=rc.p7g&&ta<=rc.q7g}clear(){this.currentState=J.ac.Ha()?this.mib.ggb():le.ggb();this.refresh()}tQi(ta){return this.drj(ta)?this.Ysi[ta]:0}l2b(ta,wb){ta&&(this.zUa=null);this.refresh();wb&&(!this.Oq&&this.L5()&&this.EU()?this.showTaskPane():
!this.Oq||this.EU()&&this.L5()||this.hideTaskPane())}IBi(){var ta=Ya.f(this.$);let wb=null;ta=ta.getRangeInformation(ta.ha.qa.activeCell);for(let ic=0,Oa=ta.length;ic<Oa;++ic){const Cb=ta[ic];if(Object(K.a)(Ib.PivotTableRange,Cb)){wb=Cb.pivotTableName;break}}return wb}t2g(ta){const wb=Ya.f(this.$);var ic=wb.za.zn(ta);if(ic){if(this.zUa){ta=ic.ranges;if(!ta)return;for(ic=ta.length-1;0<=ic;--ic){var Oa=ta[ic];if(Object(K.a)(Ib.PivotTableRange,Oa)&&pb.a.equals(Oa.pivotTableName,this.zUa,!1)){ta=this.IBi();
ta&&pb.a.equals(ta,this.zUa,!1)||(ta=Kb.w(Oa.topLeft,this.$),wb.To(ta,null,null,null,0,"FieldManagerPane.UpdateFieldsPaneStatus"));this.zUa=null;break}}}Ya.f(this.$).ex||this.refresh()}else Q.ULS.sendTraceTag(537162690,0,15,`Block ${ta} was removd from BlockManager`)}wV(){this.clear()}static c6e(ta,wb,ic,Oa){let Cb=mc.a(ta);if(!Cb){const yc=document.getElementById(ta.$h+fa.a.Xsi);yc?Cb=J.bc.Ha()?new rc(yc,ta,wb,ic,Oa):ta.ka.ph(16,new rc(yc,ta,wb,ic,Oa)):Q.ULS.sendTraceTag(537162688,0,15,"FieldManagerPane creation fails: FieldManagerPaneDiv is null.")}return Cb}static TKb(ta){const wb=
{};wb.AnchorType=ta.anchorType;7===ta.anchorType&&(wb.ChartId=ta.chartId,wb.AnchorValue1=wb.AnchorValue2=-1);return wb}static P9(ta){ta.request&&(ya.AFrameworkApplication.$i.HD(ta.request.TC),ta.request=null)}}rc.Yvc="fieldListPaneVisibilityChanged";rc.hwf="FieldListPaneChanging";rc.gwf="FieldListPaneChanged";rc.p7g=0;rc.q7g=3;Object(C.a)(rc,"FieldManagerPane",la.a,[446,447,2,224,59]);var fd=a(182),Ed=a(42);class Rd{constructor(){this.wsc=this.sourceRange=this.tqa=null}}Object(C.a)(Rd,"SelectedRangeForPivot",
null,[]);var Fe=a(843),Ae=a(208),We=a(422),ve=a(236),Ze=a(175);class Oe{static get Po(){return ve.a.UA(Oe.hcj,Ze.a.ia(66),Ze.a.ia(67),Ze.a.ia(68),Ze.a.ia(69),Ze.a.ia(70),Ze.a.ia(71),Ze.a.ia(72))}}Oe.hcj="<div class='DataSourceDiv' id='DataSourceDiv'> <div class='WACDialogRow' id='dataAnalyzeTitle'> <label id='dataChoice' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='sourceRadio'> <label id='sourceSelectLabel' class='WACDialogLabel' >{1}</label> </div> <div class='ewa-insertpt-dlg-sourceRange WACDialogRowNoBreak' id='sourceRangeText'> <label id='tableOrRange' class='ewa-insertpt-dlg-label' for='SourceRange' >{2}</label> <input type='text' id='sourceRange' class='WACDialogInput ewa-insertpt-dlg-input' aria-describedby=\"dataChoice . sourceSelectLabel\" maxlength=\"1024\" spellcheck=\"false\" autocomplete=\"off\" autocomplete=\"off\"/> </div> </div> <div class='PivotDestinationDiv' id='PivotDestinationDiv'> <div class='WACDialogRow' id='destinationTitle'> <label id='destinationLabel' class='WACDialogLabel' >{3}</label> </div> <div class='WACDialogRowNoBreak' id='destinationPickNewWorksheet'> <input type='radio' id='newWorksheet' name='destinationRadio' class='WACDialogRadio ewa-insertpt-label' alt='{4}' aria-describedby=destinationLabel title='{4}'></input> <label id='newWorksheetLabel' class='WACDialogLabel' for='newWorksheet' >{4}</label> </div> <div class='WACDialogRowNoBreak' id='destinationPickExistingWorksheet'> <input type='radio' id='existingWorksheet' name='destinationRadio' class='WACDialogRadio ewa-insertpt-label' alt='{5}' aria-describedby=destinationLabel title='{5}'></input> <label id='existingWorksheetLabel' class='WACDialogLabel' for='existingWorksheet' >{5}</label> <div class='WACDialogRowNoBreak' id='destinationRangeText'> <label id='Location' class='ewa-insertpt-dlg-label' for='DestinationRange' >{6}</label> <input type='text' id='destinationRange' class='WACDialogInput ewa-insertpt-dlg-input' maxlength=\"1024\" spellcheck=\"false\" autocomplete=\"off\" autocomplete=\"off\"/> </div> </div>";
Object(C.a)(Oe,"InsertPivotTableDialogHtml",null,[]);var Nf=a(162);class Zf{constructor(ta,wb){this.nic=ta;this.unh=wb;this.VQc=null}get $b(){return this.nic}get zsb(){return this.unh}bindAction(ta){this.zsb&&ta&&(this.VQc=ta,this.zsb.Jxh(this.VQc))}$0k(){this.zsb&&this.VQc&&this.zsb.sik(this.VQc)}isValid(){return!!this.zsb&&!!this.$b}}Object(C.a)(Zf,"TextBoxRadioButtonPair",null,[515]);var Rb=a(1114),Vb=a(326);class Cc{constructor(ta,wb){this.title=ta;this.Po=wb}}Object(C.a)(Cc,"DialogData",null,
[]);const rg=(ta,wb,ic,Oa,Cb,yc,Nc,Id)=>{Id=ta.Za(1,void 0===Id?null:Id);Id.sheetRange=wb;Id.activeCell=ic;return V.h(ta,"GetExpandedRangeForPivotTable",Id,Oa,Cb,yc,Nc,0)},yf=(ta,wb,ic,Oa,Cb,yc,Nc,Id,ke)=>{ke=ta.Za(41,void 0===ke?null:ke);ke.activeCell=wb;ke.newRange=ic;ke.isDataSource=Oa;return V.h(ta,"ChangePivotLocation",ke,Cb,yc,Nc,Id,0)},jg=(ta,wb,ic,Oa,Cb,yc,Nc)=>{Nc=ta.Za(1,void 0===Nc?null:Nc);Nc.activeCell=wb;return V.h(ta,"GetDataSourceRangeForPivotTable",Nc,ic,Oa,Cb,yc,0)};class If{constructor(ta,
wb){this.destinationRange=this.sourceRange=null;this.sourceRange=ta;this.destinationRange=wb}}Object(C.a)(If,"MacroRecorderPivotTableCreatedPayload",null,[65]);var cf=a(436),Nb=a(189),Bc=a(267);class Ob extends cf.a{constructor(ta){super(ta)}ckb(ta){let wb,ic=(()=>{let Cb=super.ckb(ta);({zHc:wb}=Cb);return Cb})().returnValue;if(!ic){var Oa=Object(U.a)(Bc.a,this.$.Gh);Oa&&Oa.yq(ta)&&(ic=(Oa=Oa.getItemByName(ta))&&1!==Oa.type?2===Oa.type?Nb.a(Oa):Oa.usedRange:null,wb=2===Oa.type)}return{returnValue:ic,
zHc:wb}}}Object(C.a)(Ob,"PivotTableRangeHighlightPolicy",cf.a,[]);class zc extends We.a{constructor(ta,wb){super(ta,new Ob(ta));this.Jte=this.destinationRange=this.lma=this.ULa=this.s7a=null;this.gPa=!1;this.YD=0;this.llf="";this.sSf=(ic,Oa)=>{this.hide();if(1===ic){let Cb=ic="";2!==this.YD&&(ic=zc.o$d(Oa[zc.wYc],this.$.sa),this.QPk(ic,this.$)&&Q.ULS.sendTraceTag(537155781,0,50,"InsertPivotTableDialog.InsertPivotTableDialogHandler - Source does not have enough entries"));1!==this.YD&&Oa[zc.EDd]&&
(Cb=zc.o$d(Oa[zc.vsc],this.$.sa));2===this.YD&&Cb===this.llf||this.wbj(ic,Cb)}else this.R6b(!0),Q.ULS.sendTraceTag(537155780,0,50,"InsertPivotTableDialog.InsertPivotTableDialogHandler - cancel was clicked.")};this.lA=()=>{this.o9b()};this.DMc=()=>{this.destinationRange.disabled=!this.lma.checked;this.o9b();return!1};this.Ufg=()=>{this.o9b();return!1};this.Fng=()=>{this.o9b();return!1};this.D7d=ic=>{if(ib.a(ic))this.R6b(!0),Q.ULS.sendTraceTag(537155742,0,50,"InsertPivotTableDialog.OnInsertPivotTableDone - failed.");
else{Q.ULS.sendTraceTag(537155743,0,50,"InsertPivotTableDialog.OnInsertPivotTableDone - success.");const Oa=ic.Result;if(Oa){if(ic=this.$.sa.getItemByName(Oa.SheetName))ic.activate({scenario:"pivotTable"}),this.da.To(Oa,null,null,null,3,"InsertPivotTableDialog.OnInsertPivotTableDone"),this.R6b(!0),0===this.YD&&this.Wzk(),ic=fa.a.jRc,ic!==Nf.a(this.$).ns.rA&&(Nf.a(this.$).z4a(2),Nf.a(this.$).ns.activateRibbonTab(ic))}else this.R6b(!0)}};this.da=Ya.f(this.$);this.v0=Fe.a.instance;this.aI=!1;-1128516639===
wb?(this.YD=1,Q.ULS.sendTraceTag(537155785,0,50,"InsertPivotTableDialog.InsertPivotTableDialog - for PivotTable Operation Change data Source")):-63037693===wb?(this.YD=2,Q.ULS.sendTraceTag(537155784,0,50,"InsertPivotTableDialog.InsertPivotTableDialog - for PivotTable Operation Move PivotTable")):Q.ULS.sendTraceTag(537155783,0,50,"InsertPivotTableDialog.InsertPivotTableDialog")}dispose(){Q.ULS.sendTraceTag(537155782,0,50,"InsertPivotTableDialog.Dispose");this.E0c();super.dispose()}get ki(){return"InsertPivotTableDialog"}get OIb(){return!0}get naf(){return!0}get laf(){return!0}yYa(){return new Ae.a([zc.wYc,
zc.vsc])}tai(){let ta=!1;2!==this.YD&&(ta=zc.vai(this.s7a.value));ta||1===this.YD||(ta=zc.uai(this.lma.checked,this.destinationRange.value));return ta}get aV(){return()=>{let ta=this.destinationRange.value;1!==this.YD&&this.destinationRange.disabled&&(ta="");this.sSf(1,zc.aFf(this.s7a.value,ta))}}WCc(ta){Q.ULS.sendTraceTag(537155779,0,50,"InsertPivotTableDialog.InitAndShow");const wb=this.DId();this.Po=wb.Po;var ic="";2!==this.YD&&(ic=zc.o$d(ta.tqa,this.$.sa));ic=zc.aFf(ic,ta.wsc);1!==this.YD&&2===
this.YD&&(this.llf=ta.wsc);this.R6b(!1);this.initializeAndShow(wb.title,this.sSf,ic);this.yse();this.gAk();this.o9b();Q.ULS.sendTraceTag(537155778,0,50,"InsertPivotTableDialog.InitAndShow completed.")}QPk(ta,wb){wb=(new Ob(wb)).ckb(ta);({zHc:ta}=wb);wb=wb.returnValue;return!!wb&&wb.Daa&&!ta}o9b(){this.reb.disabled=this.tai()}yse(){this.v0.ya(ea.a.change,this.ULa,this.DMc);this.v0.ya(ea.a.change,this.lma,this.DMc);this.v0.ya(ea.a.Rj,this.s7a,this.Fng);this.v0.ya(ea.a.Rj,this.destinationRange,this.Ufg);
this.Gxh(this.lA);this.gPa=!0}E0c(){this.gPa&&(this.v0.Na(ea.a.change,this.ULa,this.DMc),this.v0.Na(ea.a.change,this.lma,this.DMc),this.v0.Na(ea.a.Rj,this.s7a,this.Fng),this.v0.Na(ea.a.Rj,this.destinationRange,this.Ufg),this.qik(this.lA),this.gPa=!1)}gAk(){2===this.YD?this.destinationRange.focus():this.s7a.focus()}KVg(){const ta=new Vb.a(this.destinationRange),wb=new Rb.a(this.lma,!1);this.Jte=new Zf(ta,wb);this.Ase(this.Jte)}l1g(){this.mwe(this.Jte)}DI(){super.DI();Q.ULS.sendTraceTag(537155777,0,
50,"InsertPivotTableDialog.InitializeDialogElements");this.s7a=document.getElementById(zc.wYc);this.ULa=document.getElementById(zc.vbg);this.lma=document.getElementById(zc.EDd);this.destinationRange=document.getElementById(zc.vsc);switch(this.YD){case 0:case 2:this.destinationRange.value?zc.BNg(this.lma,this.ULa):(this.destinationRange.disabled=!0,zc.BNg(this.ULa,this.lma));fc.l(this.$.Bk)&&(this.ULa.checked=!1,this.ULa.disabled=!0,this.destinationRange.value="",this.lma.checked=!0);if(2===this.YD){this.s7a.disabled=
!0;var ta=document.getElementById(zc.j8h);ta.style.visibility="hidden";ta.style.display="none"}break;case 1:this.destinationRange.disabled=!0,this.ULa.disabled=!0,this.lma.disabled=!0,ta=document.getElementById(zc.Y2j),ta.style.visibility="hidden",ta.style.display="none"}}wbj(ta,wb){Q.ULS.sendTraceTag(537155744,0,50,"InsertPivotTableDialog.InitiateInsertPivotTableOperation");const ic=this.$.pa.ta;let Oa=1;const Cb=ic.Jh(),yc=Kb.p(Ya.f(this.$).ha.qa.activeCell,this.$);let Nc=null,Id=null;switch(this.YD){case 0:Oa=
132;Nc=(ke,Ie,Le)=>{ke=Yb.c(ke,this.D7d);const wf=ic.Za(41,void 0===Cb?null:Cb);wf.sheetRange=ta;wf.destinationRange=wb;return V.h(ic,"InsertPivotTable",wf,ke,Ie,Le,null,0)};Id=()=>new If(ta,wb);break;case 2:Oa=219;Nc=(ke,Ie,Le)=>yf(ic,yc,wb,!1,Yb.c(ke,this.D7d),Ie,Le,null,Cb);break;case 1:Oa=219,Nc=(ke,Ie,Le)=>yf(ic,yc,ta,!0,Yb.c(ke,this.D7d),Ie,Le,null,Cb)}Rc.a(this.$.userOperationManager,Nc,ke=>new Lb.a(Oa,0,ke,void 0,Id),null)}DId(){let ta=0;switch(this.YD){case 0:ta=65;break;case 1:ta=2157;break;
case 2:ta=2153}return new Cc(sa.a.instance.ia(ta),Oe.Po)}Wzk(){const ta=J.bc.Ha()?D.a.Zg(J.bc):this.$.ka.Ug(16);ta&&ta.O6b(!1,null,!0)}R6b(ta){Lc.a.ut()?D.a.Zg(J.We):this.$.ka.Ug(183);ta&&this.da.Um&&this.da.Um.Mx(fa.a.Q$)}set OIb(ta){super.OIb=ta}set aV(ta){super.aV=ta}static aFf(ta,wb){const ic=!wb;return{[zc.wYc]:ta,[zc.vsc]:wb,[zc.vbg]:ic,[zc.EDd]:!ic}}static BNg(ta,wb){ta.tabIndex=zc.Uwi;wb.tabIndex=zc.gHj}static o$d(ta,wb){let ic,Oa;ta=ta.startsWith("=")?ta.substring(1,ta.length):ta;let Cb=
Kb.ib(ta,wb);({sheetName:ic,range:Oa}=Cb);Cb.returnValue&&Oa&&(ic||(ic=wb.na.name),ta=Kb.y(Oa,ic,!1,!0));return ta}static vai(ta){return pb.a.qz(ta)}static uai(ta,wb){return ta&&pb.a.qz(wb)}}zc.jpf="";zc.Uwi=0;zc.gHj=-1;zc.wYc="sourceRange";zc.vsc="destinationRange";zc.vbg="newWorksheet";zc.EDd="existingWorksheet";zc.j8h="DataSourceDiv";zc.Y2j="PivotDestinationDiv";Object(C.a)(zc,"InsertPivotTableDialog",We.a,[]);var od;let ce=od=class{constructor(ta){this.$Pd=!1;this.ydb=null;this.$=ta;this.da=Ya.f(ta);
Ed.a.instance.Qi("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(wb=>{this.ydb=wb;wb.isFeatureEnabled(od.rQf,!1).then(ic=>this.$Pd=ic);wb.S4a(od.rQf,ic=>{this.$Pd=ic.isEnabled})})}Bi(){return!1}executeCommand(ta,wb,ic){var Oa;ta=ua.TaskExtensions.sq();const Cb=wb.command;let yc;const Nc=new fd.a;wb=this.da.ha.qa;switch(Cb){case 2137617149:ta=null!==(Oa=ic.agl)&&void 0!==Oa?Oa:wb.selectedRanges;this.TRi(ta,Nc);if(Lc.a.gXf(this.$)&&this.$Pd){const Ie=new fd.a;Nc.task.RA(Le=>
{ic.SourceSelection=te.b(Le)&&Le.result&&Le.result.tqa?Le.result.tqa:"";return this.$.ei(-1444574190,0,0,ic).continueWith(wf=>{te.b(wf)&&wf.result||(yc=new zc(this.$,Cb),yc.WCc(Le.result));Ie.setResult(!0)})});ta=Ie.task}else yc=new zc(this.$,Cb),ta=Nc.task.continueWith(()=>{yc.WCc(Nc.task.result)});break;case -1128516639:const Id=this.$.pa.ta.Jh(),ke=Kb.p(wb.activeCell,this.$);Oa=new Lb.a(554,0,(Ie,Le,wf)=>jg(this.$.pa.ta,ke,Yb.c(Ie,Kf=>{this.Fhg(Kf,Nc,!1)}),Yb.b(Le,()=>{od.Ehg(Nc,this.$)}),wf,null,
Id),88);Oa.COa(()=>!0);this.$.userOperationManager.enqueueOperation(Oa,null);yc=new zc(this.$,Cb);ta=Nc.task.continueWith(()=>{yc.WCc(Nc.task.result)});break;case -63037693:Oa=new Rd;if(wb=this.da.Yg.Lw(wb.activeCell))wb=rb.Range.gi(wb.DGg+1,wb.left),Oa.wsc=Kb.i(wb,this.$,!0,void 0,!0);Nc.setResult(Oa);yc=new zc(this.$,Cb);ta=Nc.task.continueWith(()=>{yc.WCc(Nc.task.result)})}return ta}Fhg(ta,wb,ic){const Oa=ta.Result,Cb=new Rd;if(ic||Oa){const yc=this.da.ha.qa.Gn;ib.a(ta)?yc&&(Cb.tqa=this.da.ha.CIf(!0)):
(Cb.tqa=Oa,yc&&ic&&this.Ggi()&&!this.da.Yg.sl(this.da.ha.qa.Ui)&&(Cb.wsc=this.da.ha.vxc(!0,!0)))}else if(ta=this.da.Yg.Lw(this.da.ha.qa.activeCell))Cb.tqa=ta.dataSource;wb.setResult(Cb)}Ggi(){var ta=this.da.ha.qa.activeCell;ta=new rb.Range(ta.top,ta.left,ta.top+1,ta.left+1,!1,!1);ta=this.da.ot("InsertPivotTableCommandHandler.EmptySquareAdjToActiveCell",ta);try{for(ta.$$rst();ta.$$mn();)if(ta.$$cu().text)return!1}finally{ta&&ta.dispose()}return!0}TRi(ta,wb){if(1!==ta.length)wb.setResult(Object(Sc.a)(new Rd,
{tqa:""}));else{ta=ta[0];const ic=this.da.Yg.sl(ta);if(ic)wb.setResult(Object(Sc.a)(new Rd,{tqa:ic.name,sourceRange:ic.usedRange}));else{const Oa=this.$.pa.ta.Jh(),Cb=Kb.p(ta,this.$),yc=Kb.w(ta,this.$);ta=new Lb.a(511,0,(Nc,Id,ke)=>rg(this.$.pa.ta,yc,Cb,Yb.c(Nc,Ie=>{this.Fhg(Ie,wb,!0)}),Yb.b(Id,()=>{od.Ehg(wb,this.$)}),ke,null,Oa),88);ta.COa(()=>!0);this.$.userOperationManager.enqueueOperation(ta,null)}}}ni(ta,wb){ta=!1;switch(wb.command){case -1128516639:case -63037693:case 2137617149:ta=!0}return ta}Ji(){return!1}static Ehg(ta,
wb){Q.ULS.sendTraceTag(537155786,0,50,"OnGetExpandedRangeForPivotTableFailedCallback: Failure. failing over to the selected range.");Ya.f(wb).ha.qa.Gn?ta.setResult(Object(Sc.a)(new Rd,{tqa:Ya.f(wb).ha.Vua})):ta.setResult(Object(Sc.a)(new Rd,{tqa:""}))}};ce.rQf="ExcelIdeas";ce=od=Object(M.__decorate)([Object(D.d)(J.ud),Object(M.__param)(0,Object(J.Lb)()),Object(M.__param)(1,Object(J.Gf)())],ce);Object(C.a)(ce,"InsertPivotTableCommandHandler",null,[39]);var Qb=a(421);class Xc extends Qb.a{constructor(ta,
wb,ic){super(ta);this.t7b=null;this.isPivot=!1;this.xRd=(Oa,Cb)=>{1===Oa?(Oa=Cb.indices,Q.ULS.sendTraceTag(537155741,0,50,`InsertSlicerDialog.ClickedOK: User clicked OK, inserting ${Oa.length} Slicers`),0<Oa.length&&this.ozd(Oa,0)):Q.ULS.sendTraceTag(537155740,0,50,"InsertSlicerDialog.Dismissed: User dismissed the dialog")};this.Ohg=Oa=>{this.t7b=Oa.Result;Oa={["id"]:this.ki,["singleDimFields"]:this.t7b};this.initializeAndShow(sa.a.instance.ia(2154),this.xRd,Oa)};this.da=Ya.f(ta);this.qa=this.da.ha.qa;
this.ha=Ya.f(ta).ha;this.tableName=wb;this.sheetName=ic;this.isPivot=Ya.f(ta).Yg.Lw(this.ha.qa.activeCell)?!0:!1;Q.ULS.sendTraceTag(543511326,0,50,"InsertSlicerDialog.Constructor: User Opened Insert Slicer Dialog");this.xbj()}get ki(){return"InsertSlicerDialog"}ozd(ta,wb){ua.TaskExtensions.Ua(ha.GetServiceTaskFactory.Bj(this.$.ka,103,104,0),ic=>{var Oa=ic.result,Cb=Ya.f(this.$),yc=Oa.X8a(Cb);if(yc){var Nc=yc.Lj;ic=Nc.jj.top;Nc=Nc.jj.left;Oa=yc.VS.x;yc=yc.VS.y}else ic=Nc=1,yc=Oa.rJa(Cb),Oa=yc.x,yc=
yc.y;Cb=0;for(const Id of ta)this.icj(parseInt(Id,10),wb,ic,Nc,Oa+Cb,yc+Cb),Cb+=22},this.$.xa,8)}icj(ta,wb,ic,Oa,Cb,yc){const Nc=new Lb.a(203,0,(Id,ke,Ie)=>{const Le=this.$.pa.ta.Jh();return this.isPivot?xb.x(this.$.pa.ta,this.sheetName,this.tableName,ta,wb,ic,Oa,Cb,yc,Id,ke,Ie,Le):xb.y(this.$.pa.ta,this.sheetName,this.tableName,ta,wb,ic,Oa,Cb,yc,Id,ke,Ie,Le)},void 0,()=>new cc.a(this.sheetName,this.tableName,ta,wb));this.$.userOperationManager.enqueueOperation(Nc,null)}xbj(){const ta=new Lb.a(596,
0,(wb,ic,Oa)=>{const Cb=this.$.pa.ta.Jh();return this.isPivot?xb.l(this.$.pa.ta,this.tableName,this.sheetName,Yb.c(wb,this.Ohg),ic,Oa,Cb):xb.m(this.$.pa.ta,this.tableName,this.sheetName,Yb.c(wb,this.Ohg),ic,Oa,Cb)},16);this.$.userOperationManager.enqueueOperation(ta,null)}}Object(C.a)(Xc,"InsertSlicerDialog",Qb.a,[]);class md extends Qb.a{constructor(ta,wb,ic){super(ta);this.t7b=null;this.xRd=(Oa,Cb)=>{1===Oa?(Oa=Cb.indices,Q.ULS.sendTraceTag(507650643,0,50,`InsertTimeSlicerDialog.ClickedOK: User clicked OK, inserting ${Oa.length} TimeSlicers`),
0<Oa.length&&this.ozd(Oa,1)):Q.ULS.sendTraceTag(507650642,0,50,"InsertTimeSlicerDialog.Dismissed: User dismissed the dialog")};this.sQj=Oa=>{this.t7b=Oa.Result;Oa={["id"]:this.ki,["singleDimFields"]:this.t7b};this.initializeAndShow(sa.a.instance.ia(2463),this.xRd,Oa)};this.pivotTableName=wb;this.sheetName=ic;Q.ULS.sendTraceTag(0,0,50,"InsertTimeSlicerDialog.Constructor: User Opened Insert Timeline Slicer Dialog");this.ybj()}get ki(){return"InsertTimeSlicerDialog"}ozd(ta,wb){ua.TaskExtensions.Ua(ha.GetServiceTaskFactory.Bj(this.$.ka,
103,104,0),ic=>{var Oa=ic.result,Cb=Ya.f(this.$),yc=Oa.X8a(Cb);if(yc){var Nc=yc.Lj;ic=Nc.jj.top;Nc=Nc.jj.left;Oa=yc.VS.x;yc=yc.VS.y}else ic=Nc=1,yc=Oa.rJa(Cb),Oa=yc.x,yc=yc.y;Cb=0;for(const Id of ta)this.mcj(parseInt(Id,10),wb,ic,Nc,Oa+Cb,yc+Cb),Cb+=22},this.$.xa,8)}mcj(ta,wb,ic,Oa,Cb,yc){const Nc=new Lb.a(203,0,(Id,ke,Ie)=>{const Le=this.$.pa.ta.Jh();return xb.x(this.$.pa.ta,this.sheetName,this.pivotTableName,ta,wb,ic,Oa,Cb,yc,Id,ke,Ie,Le)},void 0,()=>new cc.a(this.sheetName,this.pivotTableName,
ta,wb));this.$.userOperationManager.enqueueOperation(Nc,null)}ybj(){const ta=new Lb.a(596,0,(wb,ic,Oa)=>{const Cb=this.$.pa.ta.Jh();return xb.n(this.$.pa.ta,this.pivotTableName,this.sheetName,Yb.c(wb,this.sQj),ic,Oa,Cb)},16);this.$.userOperationManager.enqueueOperation(ta,null)}}Object(C.a)(md,"InsertTimeSlicerDialog",Qb.a,[]);let ie=class{constructor(ta){this.activeCell=this.Dh=null;this.$=ta;this.ha=Ya.f(this.$).ha}Bi(){return!1}executeCommand(ta,wb){ta=ua.TaskExtensions.sq();wb=wb.command;this.activeCell=
this.ha.qa.activeCell;switch(wb){case -100176241:case -1924368815:this.Dh=Ya.f(this.$).Yg.Lw(this.activeCell);var ic=Ya.f(this.$).Yg.sl(this.activeCell,!1);if(null!=ic&&na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableSlicerInsertion",!1)){if(!(this.Dh&&this.Dh.isOlap||!this.Dh&&!Ya.f(this.$).ha.qa.FI())){wb=this.Dh?this.Dh.pivotTableName:null;var Oa=this.$.sa.na.sheetName;ic=ic?ic.name:null;null==wb?new Xc(this.$,ic,Oa):new Xc(this.$,wb,Oa)}}else this.Dh&&!this.Dh.isOlap&&new Xc(this.$,
this.Dh.pivotTableName,this.$.sa.na.sheetName);break;case -817408114:this.Dh=Ya.f(this.$).Yg.Lw(this.activeCell);if(!this.Dh||this.Dh.isOlap||!na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TimelineSlicers",!1))break;new md(this.$,this.Dh.pivotTableName,this.$.sa.na.sheetName);break;case -1949853173:wb=Ya.f(this.$).Yg.sl(this.activeCell,!1),null!=wb&&na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableSlicerInsertion",!1)&&new Xc(this.$,wb?wb.name:null,this.$.sa.na.sheetName)}return ta}ni(ta,
wb){ta=!1;switch(wb.command){case -100176241:ta=!0;break;case -1924368815:ta=!0;break;case -817408114:ta=!0;break;case -1949853173:ta=!0}return ta}Ji(){return!1}};ie=Object(M.__decorate)([Object(D.d)(J.vd),Object(M.__param)(0,Object(J.Lb)())],ie);Object(C.a)(ie,"InsertSlicerCommandHandler",null,[39]);var me=a(126),Pe=a(1330),gf=a(238),tf=a(92),Qe;let Ca=Qe=class extends me.a{constructor(ta,wb){ta=void 0===ta?oc.a.Kre:ta;wb=void 0===wb?oc.a.Vaa:wb;super(ta,wb)}execute(ta){const wb=Object(U.a)(10,ta.sk),
ic=wa.a.current.jS;ta.activityState[tf.a.MW]=tf.a.Fpb;ta.activityState[tf.a.Jda]=Qe.Y1h(wb,ic.OfferPowerBiTrialUrl,ic.OfferPowerBiTrialCompleteSignUpParameter);ta.activityState[tf.a.mld]=!0;wb.ms.gI("PowerBiTrial");return 3}static Y1h(ta,wb,ic){ta=new Sys.StringBuilder(ta.isEditMode?ta.workbookContext.FullDocumentInfo.HostEditUrl:ta.workbookContext.FullDocumentInfo.HostViewUrl);gf.a.Dr(ta,Pe.a.e9j,"1");ta=encodeURIComponent(ta.toString());return`${wb}&${"ru"}=${ic}${encodeURIComponent(`?${"returnUrl"}=${ta}`)}`}};
Ca=Qe=Object(M.__decorate)([Object(D.d)(J.ce)],Ca);Object(C.a)(Ca,"OfferPowerBiTrialActivity",me.a,[]);var yb=a(1381),wc=a(1209),dd=a(69),vd=a(65),Zd=a(687);const Re=(ta,wb,ic,Oa,Cb,yc,Nc,Id,ke,Ie)=>{Ie=ta.Za(41,void 0===Ie?null:Ie);Ie.activeCell=wb;Ie.option=ic;Ie.userInputText=Oa;Ie.userInputInt=Cb;return V.h(ta,"PivotTableSettingsPaneOperations",Ie,yc,Nc,Id,ke,0)};class ff{constructor(ta,wb,ic,Oa,Cb){this.pivotTableName=this.activeCell=null;this.opType=0;this.userInputText=null;this.userInputInt=
0;this.activeCell=ta;this.pivotTableName=wb;this.opType=ic;this.userInputText=Oa;this.userInputInt=Cb}getActiveCell(){return this.activeCell}}Object(C.a)(ff,"MacroRecorderPivotTableSettingsPaneOperationsPayload",null,[65]);let af=class{constructor(ta){this.activeCell=this.Dh=null;this.ZWj=wb=>{ib.a(wb)||(wb=this.$.sa.getItemByName(wb.Result.toString()),(null===wb||void 0===wb?0:wb.name)&&wb.activate({scenario:"pivotTable"}),wb=document.querySelector(".ewa-stb-tabs .tab-active"),this.SZk(wb))};this.KQj=
wb=>{wb&&!sc.a.Jk(wb.Errors)&&this.i_d(wb.Result)};this.JQj=()=>{};this.MQj=wb=>{wb&&!sc.a.Jk(wb.Errors)&&this.j_d(wb.Result)};this.LQj=()=>{};this.IQj=(wb,ic)=>{wb&&!sc.a.Jk(wb.Errors)&&this.f_d(wb.Result,ic)};this.HQj=()=>{};this.$=ta;this.ha=Ya.f(this.$).ha}Bi(){return!1}executeCommand(ta,wb,ic){ta=ua.TaskExtensions.sq();const Oa=wb.command,Cb=this.$.pa.ta;let yc=null,Nc=1;const Id=this.$.pa.ta.Jh();this.activeCell=Kb.p(this.ha.qa.activeCell,this.$);this.Dh=Ya.f(this.$).Yg.Lw(this.ha.qa.activeCell);
switch(Oa){case 498319061:Q.ULS.sendTraceTag(537154699,0,50,"PivotCommand.ExecuteCommand: PivotTableShowExpandButton is triggered");if(!this.Dh)return ta;yc=(ke,Ie,Le)=>{var wf=this.activeCell,Kf=!this.Dh.showDrillIndicators;const cg=Cb.Za(41,void 0===Id?null:Id);cg.activeCell=wf;cg.showDrillInIndicator=Kf;return V.h(Cb,"PivotTableShowExpandButton",cg,ke,Ie,Le,null,0)};Nc=218;break;case 1529441790:ua.TaskExtensions.Ua(Object(Wb.d)(D.a.resolve(J.Ae,{va:0})),ke=>{(ke=ke.result)&&ke.SLk()},this.$.xa,
3);break;case -1556797033:this.Dh&&this.eLd(this.KQj,this.JQj);break;case -1611233597:this.Dh&&this.eLd(this.MQj,this.LQj);break;case 786260386:this.Dh&&(ic=Number.parseInvariant(ic.MenuItemId),this.eLd(this.IQj,this.HQj,ic));break;case 1771091375:this.showDetails();break;case 1359615388:this.fXk();break;default:ta=Db.a(Oa)}yc&&(ta=Rc.a(this.$.userOperationManager,yc,ke=>new Lb.a(Nc,0,ke,void 0,null),wb));return ta}ni(ta,wb){ta=!1;switch(wb.command){case 498319061:case 1529441790:case -1556797033:case 786260386:case -1611233597:ta=
!0;break;case 1771091375:ta=!0;break;case 1359615388:ta=!0}return ta}Ji(){return!1}dispose(){this.$=null}fXk(){const ta=this.Dh.autoRefresh?0:1;this.$.userOperationManager.enqueueOperation(new Lb.a(225,0,(wb,ic,Oa)=>Re(this.$.pa.ta,this.activeCell,22,"",ta,wb,ic,Oa,null),64,()=>new ff(this.activeCell,this.Dh.pivotTableName,22,"",ta)),null)}showDetails(){Rc.a(this.$.userOperationManager,(ta,wb,ic)=>{var Oa=this.$.pa.ta,Cb=this.activeCell;ta=Yb.c(ta,this.ZWj);const yc=Oa.Za(41,null);yc.activeCell=Cb;
return V.h(Oa,"PivotTableShowDetails",yc,ta,wb,ic,null,0)},ta=>new Lb.a(262,0,ta,void 0,null),null)}SZk(ta){const wb=Ed.a.instance.Qi("Common.ISystemInitiatedFeedback");wb&&ta?(wb.execute(ic=>{ic.logActivity("TeachingUIForShowDetails",null)}),Q.ULS.sendTraceTag(523613786,0,50,"TeachingUIForShowDetails triggered an LPP activity")):Q.ULS.sendTraceTag(523613787,0,15,"TeachingUIForShowDetails failed to get a sifFuture")}eLd(ta,wb,ic){ic=void 0===ic?0:ic;this.$.userOperationManager.enqueueOperation(new Lb.a(1016,
0,(Oa,Cb,yc)=>V.r(this.$.pa.ta,this.activeCell,this.Dh.externalSourceIndex,this.Dh.pivotTableName,this.$.domElement.id,this.$.isChromeRtl,this.$.workbookContext.NovMode,Yb.c(Oa,ta),Yb.b(Cb,wb),yc,0!==ic?ic:null,null,!0),16),null)}i_d(ta){if(this.YXd(ta))if(this.ZXd(ta)){var wb=ta.PivotFields[0];if(this.TXd(wb)){var ic={};ic.FieldId=wb.IdString;ic.Location=this.activeCell;ic.DataSourceIndex=this.Dh.externalSourceIndex;ic.SelectedFieldIndex=wb.SortByValueIndex;var Oa=wb.DisplayString;Oa.length>yb.i&&
(Oa=Oa.substring(0,yb.i)+"...");ic.ColumnName=ba.a.Xq(Oa);ic.SortAscend=wb.IsSortedAscending&&wb.IsSortedByValue;ta=Object(Sc.a)(new Zd.a,{pivotName:this.Dh.pivotTableName,z7b:ic,WGa:this.kwa(ta.PivotDataItems,!1),XGa:this.kwa(ta.PivotDataItems,!0)});this.$.ei(-1681601147,dd.a.eh,0,{["launchSortByValueDialogCommandData"]:ta})}else this.lp(154,"AutoFilterSortByValueIncorrectSelection")}else this.lp(750,"SortByValueNoDataFields")}j_d(ta){if(this.YXd(ta))if(this.ZXd(ta)){var wb=ta.PivotFields[0];if(this.TXd(wb)){var ic=
{};ic.FilterType=yb.e;ic.AdvancedFilter=ta.AdvancedFiltering;ic.Location=this.activeCell;ic.DataSourceIndex=this.Dh.externalSourceIndex;ic.MaxCount=yb.a;ic.Title=wb.DisplayString;ic.IsPivotFilter=!0;ic.FieldId=wb.IdString;ic.AnchorType=0;(wb=wb.FilterParameter)?(ic.Count=0<wb.FilterValue?wb.FilterValue.toString():"",ic.Top=wb.IsTopFilter,ic.Type=wb.FilterType,ic.SelectedFieldIndex=yb.g(ta.PivotDataFields,wb.DataFieldId)):(ic.Count=yb.b,ic.Top=!0,ic.Type=1,ic.SelectedFieldIndex=yb.j);wb=new oe.a(856841605,
dd.a.eh,this.$.Rh,0,null);var Oa={};Oa.Top10FilterParameters=ic;Oa.PivotName=this.Dh.pivotTableName;Oa.DataFieldIds=this.kwa(ta.PivotDataFields,!1);Oa.DataFieldNames=this.kwa(ta.PivotDataFields,!0);ta={};ta[dd.a.Wk]=vd.a.li(Oa);this.$.Ma.dh(wb,ta)}}else this.lp(246,"ValueFilterNoDataFields")}YXd(ta){return 1===ta.PivotFields.length}ZXd(ta){return 0<ta.PivotDataFields.length&&0<ta.PivotDataItems.length}TXd(ta){return!ta.IsDataField&&!ta.IsFieldInPageFilterArea}f_d(ta,wb){if(this.YXd(ta))if(wc.e(wb)&&
!this.ZXd(ta))this.lp(246,"ValueFilterNoDataFields");else{var ic=ta.PivotFields[0];if(this.TXd(ic)){var Oa=this.wui(ic.PivotFilterParameters,wb),Cb={};Cb.ActiveCompareType=this.R7h(wb);Cb.ShowDataFields=wc.e(wb);Cb.FilterType=this.zJi(wb);Cb.ValueTypeText=wc.b(wb);Cb.Location=this.activeCell;Cb.ColumnName=ic.DisplayString;Cb.IsPivotFilter=!0;Cb.IsTimeSlicer=!1;Cb.NonNumericCaptionFilteringEnabled=ic.IsNonnumericCaptionFilteringEnabled;Cb.FieldId=ic.IdString;Cb.AnchorType=0;Cb.ControlGroupOrder=yb.h();
Cb.ShowWholeDays=ic.IsDateField&&!wc.e(wb);Cb.EnabledWholeDays=ic.IsEnabledWholeDays;Cb.WholeDays=ic.IsWholeDays;Cb.MemberProperties=!1;Cb.SelectedFieldIndex=yb.j;Oa&&(wc.e(wb)||ic.IsDataField?(Cb.Value1=Oa.FilterValue1.toString(),Cb.Value2=Oa.FilterValue2.toString(),wc.e(wb)&&(Cb.SelectedFieldIndex=yb.g(ta.PivotDataFields,Oa.DataFieldId))):(Cb.Value1=Oa.FilterString1,Cb.Value2=Oa.FilterString2));wb=new oe.a(-2042011094,dd.a.eh,this.$.Rh,0,null);Oa={};Oa.CustomFilterParameters=Cb;Oa.FieldId=ic.IdString;
Oa.PivotName=this.Dh.pivotTableName;Oa.DataFieldIds=this.kwa(ta.PivotDataFields,!1);Oa.DataFieldNames=this.kwa(ta.PivotDataFields,!0);ta={};ta[dd.a.Wk]=vd.a.li(Oa);this.$.Ma.dh(wb,ta)}}}kwa(ta,wb){const ic=[];for(let Oa=0;Oa<ta.length;++Oa)wb?ic.push(ta[Oa].DisplayString):ic.push(ta[Oa].IdString);return ic}R7h(ta){switch(ta){case 4:case 18:case 26:return 0;case 5:case 19:case 62:return 1;case 6:return 2;case 7:return 3;case 8:return 4;case 9:return 5;case 10:return 6;case 11:return 7;case 12:case 20:case 28:return 8;
case 13:case 21:case 64:return 9;case 14:case 22:case 27:return 10;case 15:case 23:case 63:return 11;case 16:case 24:case 29:return 12;case 17:case 25:case 65:return 13}return 14}zJi(ta){return wc.b(ta)?yb.c:wc.e(ta)?yb.f:wc.c(ta)?yb.d:""}wui(ta,wb){for(let ic=0;ic<ta.length;++ic)if(ta[ic].FilterType===wb)return ta[ic];return null}lp(ta,wb){ta=sc.a.Yi(1,0,0,ta,0,0,wb);xd.a(this.$).lp(ta)}};af=Object(M.__decorate)([Object(D.d)(J.ve),Object(M.__param)(0,Object(J.Lb)()),Object(M.__param)(1,Object(J.Gf)()),
Object(M.__param)(2,Object(J.Ve)())],af);Object(C.a)(af,"PivotCommandHandler",null,[39,2]);class xf{constructor(){this.Erg=0;this.Frg=null}}Object(C.a)(xf,"PivotTableSettingsPaneOperationsUserContext",null,[]);class eg{constructor(ta,wb){this.$=ta;this.Jrb=wb}FS(){Lc.a.ut()?void D.a.resolve(J.We,{va:0}).then(ta=>ta.hS("PivotTableSettingsTaskPane",this.pt(null,!1,!1,!1,null,!1,!1))):hd.a.Go().then(ta=>{ta.showTaskPane("PivotTableSettingsTaskPane",this.pt(null,!1,!1,!1,null,!1,!1));return null})}gL(ta,
wb,ic,Oa,Cb,yc,Nc){Lc.a.ut()?void D.a.resolve(J.We,{va:0}).then(Id=>Id.updateTaskPane("PivotTableSettingsTaskPane",this.pt(ta,wb,ic,Oa,Cb,yc,Nc))):hd.a.Go().then(Id=>{Id.updateTaskPane("PivotTableSettingsTaskPane",this.pt(ta,wb,ic,Oa,Cb,yc,Nc));return null})}zU(){Lc.a.ut()?void D.a.resolve(J.We,{va:0}).then(ta=>ta.hideTaskPane("PivotTableSettingsTaskPane")):hd.a.Go().then(ta=>{ta.hideTaskPane("PivotTableSettingsTaskPane",2);return null})}pt(ta,wb,ic,Oa,Cb,yc,Nc){ta={type:"PivotTableSettingsTaskPaneProps",
settingsInfo:ta,isRangeChanged:wb,isNativePivotTable:ic,expandAllByDefault:!0,hasLessThanTwoRowFields:Oa,sectionCollapseStates:this.Jrb.sectionCollapseStates,needFocusOnFirstElement:yc,isDataSourceExternal:Nc,onSaveSectionCollapseState:(Id,ke)=>{this.Jrb.onSaveSectionCollapseState(Id,ke)},onSettingChange:(Id,ke,Ie)=>{this.Jrb.EUj(Id,ke,Ie,Cb)}};return Object(Sc.a)(new qc.a,{contentProps:ta,onOpen:()=>{this.Jrb.sha()},onClose:()=>{this.Jrb.qE()},onManualClose:()=>{this.Jrb.f8d()},title:sa.a.instance.ia(1078),
width:320,enableResize:!0,minResizeWidth:320,maxResizeWidth:900})}}Object(C.a)(eg,"PivotTableSettingsReactTaskPane",null,[473]);let Ab=class{constructor(ta){this.W0b=null;this.Oq=!1;this.ipa="";this.bNa=!1;this.ytg=0;this.AWa=this.aNa=this.jrc=this.xtg=null;this.$Q=this.F2a=!1;this.FUj=(wb,ic)=>{if(ib.a(wb)){const Oa=wb.Errors[0].Description;wb=wb.Errors[0].MessageId;const Cb=ic.Erg;ic=ic.Frg;let yc=this.XYa();if(!yc||ic!==yc.apa)if(this.aNa&&ic===this.aNa.apa)yc=this.aNa;else{Q.ULS.sendTraceTag(537154689,
0,50,`OnPivotTableSettingsChanged Cannot Find PivotTable for opType: ${Cb}`);return}switch(Cb){case 1:yc.pivotTableName=this.ipa;break;case 2:yc.rwGrandTotalOn=this.bNa;break;case 3:yc.colGrandTotalOn=this.bNa;break;case 12:yc.errorString=this.ipa;break;case 13:yc.nullString=this.ipa;break;case 14:yc.saveSourceDataWithFile=this.bNa;break;case 15:yc.refreshOnLoad=this.bNa;break;case 16:yc.altText=this.ipa;break;case 17:yc.altTextSummary=this.ipa;break;case 20:yc.indentIncrement=this.ytg}Q.ULS.sendTraceTag(537154688,
0,50,`OnPivotTableSettingsChangedSuccessCallback encounters error ${wb} ${Oa} for opType: ${Cb}`);this.updateTaskPane(this.XYa())}};this.Yya=()=>{const wb=this.da.inRangePicker||this.da.Pp||!!(this.ha.wk&470);this.EU()&&!wb&&this.t3k();this.Xxb()};this.pC=()=>{this.EU()&&(this.AWa=this.XYa());this.Xxb()};this.kA=()=>{na.EwaSettings.isChangeGateEnabled("OfficeVSO:8334012_HideSettingsPaneinViewing")&&this.Xxb()};this.$=ta;this.da=Ya.f(this.$);this.Eaj(ta);this.ha=this.da.ha;this.ha.add_activeCellChanged(this.Yya);
this.da.KN(this.Yya);this.da.r9(this.pC);this.GW=Array(6);for(ta=0;ta<this.GW.length;ta++)this.GW[ta]=!1;this.$.ea.JJ(this.kA)}get sectionCollapseStates(){return this.GW}get JGb(){return this.$.th.aea(4128)&&this.qlc}get qlc(){const ta=new Tc.a(this.$.sa);return this.$.isEditMode&&ta.Hj(8192)||!ta.Dn}SLk(){this.Oq?(this.$Q=!1,this.hideTaskPane(!0)):(this.$Q=!0,this.showTaskPane(!0));this.$.jm()}onSaveSectionCollapseState(ta,wb){this.GW&&0<=ta&&ta<this.GW.length&&(this.GW[ta]=wb)}EUj(ta,wb,ic,Oa){let Cb=
this.jrc,yc=this.AWa;if(!yc||Oa!==yc.apa)if(this.aNa&&Oa===this.aNa.apa)yc=this.aNa,Cb=this.xtg;else{Q.ULS.sendTraceTag(537154690,0,50,`OnPivotTableSettingsChanged Cannot Find PivotTable for opType: ${ta}`);return}switch(ta){case 1:this.ipa=yc.pivotTableName;wb=255<wb.length?wb.substring(0,255):wb;yc.pivotTableName=wb;break;case 2:this.bNa=yc.rwGrandTotalOn;yc.rwGrandTotalOn=!!ic;break;case 3:this.bNa=yc.colGrandTotalOn;yc.colGrandTotalOn=!!ic;break;case 6:yc.autoFormatOnUpdate=!!ic;break;case 7:yc.showDrillIndicators=
!!ic;break;case 8:yc.showItemsWithNoDataOnRw=!!ic;break;case 9:yc.showItemsWithNoDataOnCol=!!ic;break;case 10:yc.displayErrorString=!!ic;break;case 11:yc.displayNullString=!!ic;break;case 12:this.ipa=yc.errorString;yc.errorString=wb;break;case 13:this.ipa=yc.nullString;yc.nullString=wb;break;case 14:this.bNa=yc.saveSourceDataWithFile;yc.saveSourceDataWithFile=!!ic;break;case 15:this.bNa=yc.refreshOnLoad;yc.refreshOnLoad=!!ic;break;case 16:this.ipa=yc.altText;yc.altText=wb;break;case 17:this.ipa=yc.altTextSummary;
yc.altTextSummary=wb;break;case 20:this.ytg=yc.indentIncrement,yc.indentIncrement=ic}Q.ULS.sendTraceTag(595125196,0,50,`OnPivotTableSettingsChanged for opType: ${ta}`);this.$.userOperationManager.enqueueOperation(new Lb.a(225,0,(Nc,Id,ke)=>{const Ie=new xf;Ie.Erg=ta;Ie.Frg=Oa;return Re(this.$.pa.ta,Cb,ta,wb,ic,Yb.c(Nc,this.FUj),Id,ke,Ie)},64,()=>new ff(Cb,yc.pivotTableName,ta,wb,ic)),null)}Eaj(ta){this.W0b=new eg(ta,this)}dispose(){this.ha.remove_activeCellChanged(this.Yya);this.da.vP(this.Yya);this.da.u1(this.pC);
this.da=this.ha=null;this.$.ea.GH(this.kA);this.$=null;this.hideTaskPane();this.GW=this.W0b=null}sha(){this.jrc=Kb.p(this.ha.qa.activeCell,this.$);this.AWa=this.XYa();this.updateTaskPane(this.XYa())}qE(){this.hideTaskPane()}f8d(){this.$Q=!1;this.hideTaskPane(!0);this.$.jm()}EU(){return na.EwaSettings.isChangeGateEnabled("OfficeVSO:8334012_HideSettingsPaneinViewing")?this.JGb&&this.$Q&&this.$.isEditMode:this.JGb&&this.$Q}L5(){const ta=Ya.f(this.$).Yg.Lw(this.ha.qa.activeCell);return!(this.ha.wk&470)&&
!!ta&&!ta.ynb(!0)&&this.$Q}showTaskPane(ta){if(void 0===ta?0:ta)this.F2a=!0,Q.ULS.sendTraceTag(537154659,0,50,"PivotTable settings pane is opened by the user.");this.Oq=!0;this.W0b.FS()}updateTaskPane(ta,wb){wb=void 0===wb?!1:wb;if(this.Oq&&ta&&!ta.ynb(!0)){var ic={pivotTableName:ta.bde,colGrandTotalOn:ta.colGrandTotalOn,rwGrandTotalOn:ta.rwGrandTotalOn,indentIncrement:ta.indentIncrement,autoFormatOnUpdate:ta.autoFormatOnUpdate,showDrillIndicators:ta.showDrillIndicators,showItemsWithNoDataOnRw:ta.showItemsWithNoDataOnRw,
showItemsWithNoDataOnCol:ta.showItemsWithNoDataOnCol,displayErrorString:ta.displayErrorString,errorString:ta.errorString,displayNullString:ta.displayNullString,nullString:ta.nullString,saveSourceDataWithFile:ta.saveSourceDataWithFile,refreshOnLoad:ta.refreshOnLoad,autoRefresh:ta.autoRefresh,altText:ta.altText,altTextSummary:ta.altTextSummary,slicerConnections:this.WOk(ta.slicerConnections)};this.W0b.gL(ic,wb,!ta.isOlap,!ta.AV||2>ta.AV.length,ta.apa,this.F2a,!ta.dataSource||!ta.dataSource.length);
this.F2a=!1}}hideTaskPane(ta){ta=void 0===ta?!1:ta;this.Oq=!1;this.W0b.zU();ta&&Q.ULS.sendTraceTag(537154658,0,50,"PivotTable settings pane is closed by the user.")}WOk(ta){const wb=new Ae.a;if(ta)for(let ic=0;ic<ta.length;ic++){const Oa=ta[ic];wb.add({enabled:Oa.Enabled||!1,name:Oa.Name,caption:Oa.Caption,sheet:Oa.WorksheetName})}return wb.toArray()}XYa(){return this.da.Yg.Lw(this.ha.qa.activeCell)}Xxb(){this.EU()&&this.L5()?this.Oq?this.AWa!==this.aNa&&this.AWa&&this.updateTaskPane(this.XYa(),!0):
this.showTaskPane():this.Oq&&this.hideTaskPane()}t3k(){this.xtg=this.jrc;this.aNa=this.AWa;this.jrc=Kb.p(this.ha.qa.activeCell,this.$);this.AWa=this.XYa()}};Ab=Object(M.__decorate)([Object(D.d)(J.Ae),Object(M.__param)(0,Object(J.Lb)())],Ab);Object(C.a)(Ab,"PivotTableSettingsPaneManager",null,[445,2]);var xc=a(187);const eb=(ta,wb,ic,Oa,Cb,yc,Nc,Id)=>{Id=ta.Za(1,void 0===Id?null:Id);Id.groupOperation=wb;Id.groupOperationPayload=ic;return V.h(ta,"EditPowerQueryGroup",Id,Oa,Cb,yc,Nc,0)},Ub=(ta,wb,ic,
Oa,Cb,yc,Nc,Id)=>{Id=ta.Za(1,void 0===Id?null:Id);Id.queryAction=wb;Id.queryActionPayload=ic;return V.h(ta,"PowerQueryQueryAction",Id,Oa,Cb,yc,Nc,0)},Fc=(ta,wb,ic,Oa,Cb,yc)=>{yc=ta.Za(1,void 0===yc?null:yc);return V.h(ta,"ReadPowerQueryRoaming",yc,wb,ic,Oa,Cb,4)},rd=(ta,wb,ic,Oa,Cb,yc,Nc,Id)=>{Id=ta.Za(1,void 0===Id?null:Id);Id.powerQueryDataSourceConnections=wb;Id.operationType=ic;return V.h(ta,"WritePowerQueryRoaming",Id,Oa,Cb,yc,Nc,4)},Gd=(ta,wb,ic,Oa,Cb,yc,Nc)=>{Nc=ta.Za(33,void 0===Nc?null:Nc);
Nc.queryName=wb;return V.h(ta,"PowerQueryDuplicateQuery",Nc,ic,Oa,Cb,yc,0)},ue=(ta,wb,ic,Oa,Cb,yc,Nc)=>{Nc=ta.Za(33,void 0===Nc?null:Nc);Nc.setQueryPropertiesPayload=wb;return V.h(ta,"PowerQuerySetQueryProperties",Nc,ic,Oa,Cb,yc,0)},Ce=(ta,wb,ic,Oa,Cb,yc,Nc)=>{Nc=ta.Za(1,void 0===Nc?null:Nc);Nc.mashup=wb;return V.h(ta,"GetPowerQueryDocumentInspection",Nc,ic,Oa,Cb,yc,0)},Se=(ta,wb,ic,Oa,Cb,yc)=>{yc=ta.Za(33,void 0===yc?null:yc);return V.h(ta,"powerQueryGetPendingEvaluations",yc,wb,ic,Oa,Cb,0)},of=
(ta,wb,ic,Oa,Cb,yc,Nc,Id)=>{Id=ta.Za(33,void 0===Id?null:Id);Id.evaluationId=wb;Id.aadToken=ic;return V.h(ta,"powerQueryCustomEvaluation",Id,Oa,Cb,yc,Nc,0)};var jf=a(668);class bf{}Object(C.a)(bf,"PowerQueryRoamingDataSourceConnection",null,[]);class pf{static sZh(ta){return{kind:ta.K,path:ta.P,authenticationKind:pf.Dgi,connectionName:ta.ID,provider:pf.provider,privacyGroup:null}}static uff(ta){return ta?ta.map(pf.sZh):[]}static Dff(ta){const wb=new bf;wb.K=ta.kind;wb.P=ta.path;wb.ID=ta.connectionName;
wb.V=null;return wb}static JZh(ta){return ta.map(pf.Dff)}static yff(ta){return ta.map(pf.yZh)}static Eff(ta){return ta.map(pf.KZh)}static PZh(ta){return ta.map(wb=>pf.Fff(wb,void 0))}static LZh(ta){const wb=[];null===ta||void 0===ta?void 0:ta.forEach(ic=>wb.push(pf.MZh(ic)));return wb}static Fff(ta,wb){var ic;const Oa={name:ta.Name,rowsLoaded:ta.RowsLoaded,lastRefresh:ta.LastRefresh,fillObjectType:ta.FillObjectType,loadedToDataModel:ta.LoadedToDataModel,queryError:ta.QueryError,nestingDepth:0,rowsWithError:ta.RowsWithError,
groupKey:""===ta.GroupID?void 0:ta.GroupID,currentRunningOperation:null!==(ic=ta.CurrentRunningOperation)&&void 0!==ic?ic:-1,inRefresh:!1,refreshEnabled:!1,runTimeId:null,formula:ta.Formula};na.EwaSettings.isChangeGateEnabled("OfficeVSO:8207354_PowerQueryGettingQueryDescriptionEnabled")&&(Oa.description=ta.Description,Oa.propertiesControls=pf.Z4h(ta,wb));return Oa}static MZh(ta){const wb={};wb.Name=ta.name;wb.Description=ta.description;wb.FillObjectType=ta.fillObjectType;wb.LoadedToDataModel=ta.loadedToDataModel;
wb.GroupID=ta.groupKey;wb.Formula=ta.formula;return wb}static Z4h(ta,wb){const ic={isRefreshOnRefreshAllEnabled:void 0,isRefreshOnOpenEnabled:void 0,intervalInMinutes:void 0,isBackgroundRefreshEnabled:void 0,isFastDataLoadEnabled:void 0,isIntervalRefreshEnabled:void 0,isRemoveDataEnabled:void 0,shouldDisableBackgroundRefreshCheckbox:void 0,shouldDisableRemoveDataCheckbox:void 0};if(wb=null===wb||void 0===wb?void 0:wb.values.find(Oa=>Oa.QueryName===ta.Name))ic.isRefreshOnRefreshAllEnabled=wb.AllowRefreshAll,
ic.isRefreshOnOpenEnabled=wb.RefreshOnOpen;return ic}static yZh(ta){return{key:ta.Id,name:ta.Name,order:ta.Order,parentKey:ta.ParentId,data:ta.Description,count:0,startIndex:0,children:null,level:0,isDeleting:!1}}static KZh(ta){return{Id:ta.key,Name:ta.name,Order:ta.order,ParentId:ta.parentKey,Description:ta.data,IsDeleting:!1,HasParent:ta.parentKey!==pf.Cei}}}pf.provider="DmtsPowerBi";pf.Dgi="";pf.Cei="{00000000-0000-0000-0000-000000000000}";Object(C.a)(pf,"PowerQueryObjectsConverterUtil",null,[]);
const Ud=nd.a.pWa.Application;var Ff;(function(ta){ta[ta.none=0]="none";ta[ta.teamsDisallowedApp=1]="teamsDisallowedApp";ta[ta.thirdPartyCookiesDisabled=2]="thirdPartyCookiesDisabled";ta[ta.hostNotSupported=3]="hostNotSupported"})(Ff||(Ff={}));Object(C.b)("powerQueryOAuthErrorType",Ff);let Uf=class{constructor(ta,wb,ic){this.stateId=0;this.fhb=void 0;this.Npc=this.Juc=0;this.k9f=this.xLb=!1;this.vJe=null;this.ubd=!1;this.G9c=null;this.a0f=this.l0f=!1;this.B9f=50;this.H9f=80;this.Y8j=RegExp("(.*?)\\s?\\((\\d+)\\)$");
this.IRc=(Oa,Cb)=>{this.iSd(!0)&&this.Wyg(Oa,Cb)};this.Wyg=(Oa,Cb)=>{(Cb||this.QGc(Oa))&&this.QPh(Oa)&&this.BH.Vg(Oa)&&(Oa=this.BH.getItem(Oa),this.NG.FRc(Oa.ConnectionName,Oa.ExternalSourceIndex,null))};this.kTh=()=>{Q.ULS.sendTraceTag(508826700,0,20,"PowerQueryManager:ClearAllCredentials started");Fc(this.$.pa.ta,Oa=>{this.RKk(Oa.Result)},()=>{Q.ULS.sendTraceTag(508826699,0,10,"PowerQueryManager:ClearAllCredentials read roaming Failed")},null,null)};this.RKk=Oa=>{Q.ULS.sendTraceTag(508826698,0,
50,`PowerQueryManager:showClearAllCredentialsConfirmationDialog connections: ${null===Oa||void 0===Oa?void 0:Oa.length}`);Oa&&0!==Oa.length?this.SKk(Oa):this.TKk()};this.TKk=()=>{const Oa=new xc.a;Oa.Bh=0;Oa.Io(sa.a.instance.ia(2337),sa.a.instance.ia(2338),3)};this.SKk=Oa=>{const Cb=[],yc=[];for(let Nc=0;Nc<Oa.length;Nc++){if(4===Nc){yc.push(sa.a.instance.ia(2340));break}const Id=Oa[Nc];yc.push(`${Id.K} - ${Id.P.length>this.B9f?`${Id.P.substring(0,this.B9f-1)}...`:Id.P}`)}Cb.push(yc);Oa=new xc.a;
Oa.Bh=11;Oa.Yh(1,sa.a.instance.ia(2290));Oa.Yh(2,sa.a.instance.ia(5));Oa.kta(Cb,null);Oa.Io(sa.a.instance.ia(2337),sa.a.instance.ia(2339),1,Nc=>{1===Nc&&this.jTh()})};this.jTh=()=>{rd(this.$.pa.ta,[],0,()=>{Q.ULS.sendTraceTag(508826697,0,50,"PowerQueryManager:clearAllCredentialFromRoaming succeeded")},()=>{Q.ULS.sendTraceTag(508826696,0,10,"PowerQueryManager:clearAllCredentialFromRoaming Failed")},null,null)};this.handleQueryGroupOperation=(Oa,Cb)=>{const yc=this.groups.find(Nc=>Nc.Id===Cb.Id);2===
Oa?this.$_i(Cb,yc):(this.Sqf(Oa,Cb,yc,null),this.lUg(Oa,Cb))};this.vEf=Oa=>{const Cb=[];this.queries.forEach(yc=>{yc.GroupID===Oa.Id&&Cb.push(yc)});this.groups.forEach(yc=>{yc.ParentId===Oa.Id&&Cb.push(...this.vEf(yc))});return Cb};this.$_i=(Oa,Cb)=>{const yc=this.vEf(Cb);if(this.I9k(yc)){var Nc=()=>{this.Sqf(2,Oa,Cb,yc);this.lUg(2,Oa)};0===yc.length?Nc():this.iKf(sa.a.instance.ia(2385),sa.a.instance.ia(2384),Nc)}};this.I9k=Oa=>{Oa=Oa.filter(Cb=>Cb.LoadedToDataModel);if(0<Oa.length){const Cb=Oa.map(yc=>
`"${yc.Name}"`).join(", ");this.gLk(String.format(sa.a.instance.$g(1===Oa.length?225:226),Cb));return!1}return!0};this.gLk=Oa=>{const Cb=new xc.a;Cb.Bh=0;Cb.Io(sa.a.instance.ia(2385),Oa,1)};this.lUg=(Oa,Cb)=>{this.$.userOperationManager.enqueueOperation(new Lb.a(1023,0,(yc,Nc,Id)=>eb(this.$.pa.ta,Oa,Cb,Yb.c(ke=>{0<ke.Errors.length&&this.u$()},yc),Yb.b(()=>{this.u$()},Nc),Id,null),4),null)};this.DPh=Oa=>{const Cb=Oa.Queries.map(yc=>yc.Name).filter(yc=>this.queries.some(Nc=>Nc.Name===yc));if(0<Cb.length){Oa=
Oa.Queries.map(yc=>yc.Formula);for(const yc of Cb)if(Oa.some(Nc=>-1!==Nc.indexOf(yc)))return!1}return!0};this.OMk=()=>{const Oa=sc.a.Yi(1,1,2442,2443,0,-4784504,"powerQueryPasteReferencedQueriesRenamedFailed");new Mb.a(this.$,Oa)};this.o9i=()=>{if(na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryUiImprovement",!1))void appChrome.initPowerQueryMashupClientDiv(this.ljb,this.Xve,this.$.ua.UICultureTag,this.$.ua.UserSessionId,this.$.ua.PowerQueryHostContextType,this.$.ua.PowerQueryEndpointUrl,
this.showFeedbackDialogCallback).then(()=>{this.k9f=!0;this.$.jm()});else{const Oa=document.createElement("div");Oa.id=this.$.$h+"PowerQueryMashupClientId";this.$.Gw.appendChild(Oa);appChrome.initPowerQueryMashupClient(Oa,this.ljb,this.$.ua.UICultureTag,this.$.ua.UserSessionId,this.$.ua.PowerQueryHostContextType,this.$.ua.PowerQueryEndpointUrl).finally(()=>{this.$.Gw.removeChild(Oa)})}};this.pLd=Oa=>this.queries.find(Cb=>Cb.Name===Oa);this.slg=(Oa,Cb)=>{Oa=this.pLd(2===Oa?Cb.ExtraData:Cb.Name);this.x2d(Oa,
-1)};this.x2d=(Oa,Cb)=>{Oa&&(Oa.CurrentRunningOperation=Cb)};this.setQueryProperties=Oa=>{this.$.userOperationManager.enqueueOperation(new Lb.a(1038,0,(Cb,yc,Nc)=>ue(this.$.pa.ta,Oa,Yb.c(Id=>{Id.Errors&&0<Id.Errors.length?Q.ULS.sendTraceTag(507511826,0,10,"PowerQueryManager.setQueryProperties: SetQueryProperties operation failed"):Q.ULS.sendTraceTag(507511825,0,50,"PowerQueryManager.setQueryProperties: SetQueryProperties operation succeeded")},Cb),Yb.b(()=>{Q.ULS.sendTraceTag(507511824,0,10,"PowerQueryManager.setQueryProperties: SetQueryProperties operation failed")},
yc),Nc,null),4),null)};this.Xve=Oa=>{const Cb=pf.Dff(Oa);rd(this.$.pa.ta,[Cb],1,yc=>{!yc||0<yc.Errors.length?Q.ULS.sendTraceTag(508130690,0,10,`PowerQueryMnanager:unlinkEvaluationConnection: success callback failure: ${yc.Result}`):Q.ULS.sendTraceTag(508130689,0,10,`PowerQueryMnanager:unlinkEvaluationConnection: Successfully removed connection with Kind: ${Cb.K}`)},()=>{Q.ULS.sendTraceTag(508130688,0,10,`PowerQueryMnanager:unlinkEvaluationConnection: Remove Connection failed,
        Kind: ${Cb.K}`)},null,null)};this.Wti=Oa=>{var Cb;return null===(Cb=this.BH.getItem(Oa.Name))||void 0===Cb?void 0:Cb.AllowRefreshAll};this.Xti=Oa=>{Oa=this.BH.getItem(Oa.Name);return(null===Oa||void 0===Oa?void 0:Oa.AllowRefreshAll)&&(null===Oa||void 0===Oa?void 0:Oa.RefreshOnOpen)};this.ol=()=>{const Oa=this.$.ea.Cq.PowerQueryStateId,Cb=this.$.ea.Cq.PowerQueryEvaluationStateId,yc=this.$.ea.Cq.ConnectionsStateId;Q.ULS.sendTraceTag(537154444,0,50,`PowerQueryManager.OnWorkbookMetadataChanged: powerQueryStateId: ${Oa}, this.stateId: ${this.stateId}. powerQueryEvaluationStateId: ${Cb}, this.EvaluationStateId: ${this.Juc}. connectionsStateId: ${yc}, this.connectionsStateId: ${this.Npc}`);
if(Oa>this.stateId){const Nc=this.formulas;this.u$().continueWith(Id=>{Id.result?(this.stateId=Oa,na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryDocumentInspectionMicrosoft.Office.Excel.PowerQueryDocumentInspection",!1)&&(Nc!==this.formulas?this.lEd(this.stateId):this.fhb=this.stateId)):Q.ULS.sendTraceTag(537154443,0,15,"PowerQueryManager.OnWorkbookMetadataChanged failed to update the local state")})}yc>this.Npc&&this.mEd().continueWith(Nc=>{Nc.result?this.Npc=yc:Q.ULS.sendTraceTag(509371268,
0,15,"PowerQueryManager.OnWorkbookMetadataChanged failed to update the local legacy connections state")});na.EwaSettings.isChangeGateEnabled("OfficeVSO:8732625_PowerQueryManagerAddEvaluationStateIdFlag")&&Cb>this.Juc&&void this.Psi().then(Nc=>{Nc||Q.ULS.sendTraceTag(507511823,0,10,"PowerQueryManager.OnWorkbookMetadataChanged failed to update the Evaluation local state");this.Juc=Cb})};this.Dt=()=>{this.u$();this.mEd()};this.X2g=Oa=>{if(Oa&&!ib.a(Oa)){const yc=Oa.Result;if(yc.Queries){var Cb=this.queries.filter(Nc=>
-1!==Nc.CurrentRunningOperation);this.wsb.clear();for(const Nc of yc.Queries)try{const Id=Cb.find(ke=>ke.Name===Nc.Name);Id&&(Nc.CurrentRunningOperation=Id.CurrentRunningOperation);this.wsb.add(Nc.Name,Nc)}catch(Id){Q.ULS.sendTraceTag(523534750,0,10,"PowerQueryManager.OnGetQueriesSuccess: more than one query with the same name in queryInfo.")}}this.vJe=yc.QueryGroups;Q.ULS.sendTraceTag(537154441,0,50,`PowerQueryManager.OnGetQueriesSuccess: no. queries: ${this.queries?this.queries.length.toString():
"null"}`);if(yc.PowerQueryConnectionsInfo){this.BH.clear();Cb=[];for(const Nc of yc.PowerQueryConnectionsInfo)try{this.BH.add(Nc.QueryName,Nc)}catch(Id){Q.ULS.sendTraceTag(523534749,0,10,"PowerQueryManager.OnGetQueriesSuccess: same query with more than one connection."),Cb.push(Nc.QueryName)}Cb.forEach(Nc=>{this.BH.remove(Nc)})}this.G9c=yc.Formulas;this.xLb||(this.xLb=!0,this.Og.raiseEvent("onDataFirstLoadedKey",Oa))}};this.U2g=Oa=>{if(Oa&&!ib.a(Oa)){Oa=Oa.Result;if(Oa.LegacyConnections){this.t_d.clear();
for(const Cb of Oa.LegacyConnections)try{this.t_d.add(Cb.Name,Cb)}catch(yc){Q.ULS.sendTraceTag(509696094,0,10,"PowerQueryManager.OnGetLegacyConnectionsSuccess: more than one legacy connection with the same name in LegacyConnections.")}}Q.ULS.sendTraceTag(509696093,0,50,`PowerQueryManager.OnGetLegacyConnectionsSuccess: Legacy connections: ${this.oLa?this.oLa.length.toString():"null"}`)}};this.$Mc=()=>{Q.ULS.sendTraceTag(537154439,0,15,"PowerQueryManager.OnGetQueriesFailure")};this.Phg=()=>{Q.ULS.sendTraceTag(509696092,
0,15,"PowerQueryManager.OnGetLegacyConnectionsFailure")};this.c0b=Oa=>{this.Og.raiseEvent("OnUpdatePowerQueryDataKeySucceeded",Oa);this.jee(this.queries,Cb=>Cb.IsPendingRefresh)};this.Fog=Oa=>{this.Og.raiseEvent("OnUpdatePowerQueryDataFailed",Oa)};this.Hog=Oa=>{this.Og.raiseEvent("OnUpdatePowerQueryLegacyConnectionsSucceeded",Oa)};this.Gog=Oa=>{this.Og.raiseEvent("OnUpdatePowerQueryLegacyConnectionsFailed",Oa)};this.E_b=(Oa,Cb)=>{if(Cb&&Cb.Result&&!(Cb.Errors&&0<Cb.Errors.length)&&Cb.Result.PowerQueryRefreshChallengeResult){if(!Cb.Result.ConnectionName)throw Error.argumentNull;
this.$.Ma.dh(new oe.a(-1496653501,0,this.$.Rh,8,null),{["kind"]:Cb.Result.PowerQueryRefreshChallengeResult.Kind,["path"]:Cb.Result.PowerQueryRefreshChallengeResult.Path,["queryName"]:this.HRi(Cb.Result.ConnectionName)})}};this.showFeedbackDialogCallback=()=>{Q.ULS.sendTraceTag(507790038,0,20,"PowerQuery.showFeedbackDialogCallback: opening send feedback dialog callback.");this.$.ei(802602464,0,8,{[fa.a.zO]:"PowerQueryFlow"})};this.cBf=(Oa,Cb,yc)=>{Q.ULS.sendTraceTag(520734801,0,50,`PowerQueryManager:GetToken: Token requested for PQO service, ignoreTelemetry ${yc}`);
try{return this.zZb.JD(Oa,null!==Cb&&void 0!==Cb?Cb:this.$.ua.PowerQueryAudienceUri).then(Nc=>{if(Nc.IsSuccess)return Q.ULS.sendTraceTag(520734800,0,20,`PowerQueryManager.getAuthToken: ignoreTelemetry ${yc}, successfully fetched token.`),Nc.Token;Q.ULS.sendTraceTag(520734799,0,15,`PowerQueryManager.getAuthToken: failed to get token. ignoreTelemetry: ${yc}, Error code: ${Nc.ErrorCode}, Error message: ${Nc.ErrorMessage}`);this.l0f="Cookies Disabled"===Nc.ErrorCode;this.a0f="TeamsDisallowedApp"===Nc.ErrorCode;
return Promise.resolve(null)},()=>{Q.ULS.sendTraceTag(520734798,0,15,`PowerQueryManager.getAuthToken: got rejected promise, use fallback value, ignoreTelemetry: ${yc}`);return Promise.resolve(null)})}catch(Nc){return Q.ULS.sendTraceTag(520734797,0,10,`PowerQueryManager.getAuthToken: Exception thrown when fetching token, Exception: ${Nc}, ignoreTelemetry: ${yc}`),Promise.resolve(null)}};this.ljb=(Oa,Cb)=>this.cBf("PowerQueryWeb",Oa,Cb);this.BMk=()=>{const Oa=new xc.a;Oa.Bh=11;Oa.Yh(1,sa.a.instance.ia(2325));
Oa.Yh(2,sa.a.instance.ia(4));Oa.Io(sa.a.instance.ia(2329),sa.a.instance.ia(2331),1,Cb=>{1===Cb&&this.$.Ma.dh(new oe.a(-1698025133,0,this.$.Rh,8,null))})};this.KNk=()=>{const Oa=sc.a.Yi(1,1,2330,2332,0,0,"powerQueryRefreshHostNotSupported");Oa.HelpDescription=sa.a.instance.ia(1319);Oa.HelpTopicId=Bb.a.Fsg;new Mb.a(this.$,Oa)};this.HNk=()=>{void D.a.resolve(J.C,{va:0}).then(Oa=>{Oa.xm(72,null)})};this.$Kk=()=>{void D.a.resolve(J.C,{va:0}).then(Oa=>{Oa.xm(73,null)})};this.$=ta;this.zZb=wb;this.NG=ic;
this.wsb=new Ha.a(!1);this.Mfd=new Map;this.t_d=new Ha.a(!1);this.pSe=new Ha.a(!1);this.Og=new sb.a;this.$.ea.Xy(this.ol);this.$.ea.NN(this.Dt);this.$.ea.Cq&&(this.stateId=this.$.ea.Cq.PowerQueryStateId,this.Juc=this.$.ea.Cq.PowerQueryEvaluationStateId,this.Npc=this.$.ea.Cq.ConnectionsStateId);na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1)?(this.NG.B1e(this.E_b),void this.QTf().then(Oa=>{this.u$().continueWith(Cb=>{na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryDocumentInspection",
!1)&&Cb.result&&this.lEd(this.stateId)});Oa&&this.$.k5(Cb=>{void Cb.F$(1).then(this.o9i)})})):(na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefreshPFTAsDefault",!1)&&void this.QTf(),this.u$().continueWith(Oa=>{na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryDocumentInspection",!1)&&Oa.result&&this.lEd(this.stateId)}));Ed.a.instance.Qi("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Oa=>{Oa.isFeatureEnabled("ExcelPowerQuery",
!1).then(Cb=>{this.ubd=Cb;return null})})}get isPowerQueryEditEnabled(){return this.ubd}get Imj(){return this.ubd&&this.xLb&&this.gac(!0)===Ff.none&&!fc.l(this.$.Bk)&&!this.queries.find(ta=>-1!==ta.CurrentRunningOperation)&&this.eZf()}get Jmj(){return this.gac(!0)===Ff.none&&this.eZf()}get queries(){const ta=this.wsb.values;return na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryDeleteQueryGroup",!1)?null===ta||void 0===ta?void 0:ta.filter(wb=>1!==wb.CurrentRunningOperation):
ta}get groups(){return this.vJe}get oLa(){return this.t_d.values}get formulas(){return this.G9c}get BH(){return this.pSe}get Idk(){const ta=[];this.pSe.forEach(wb=>{this.NG.uee.includes(wb.value.ConnectionName)&&ta.push(wb.key)});return ta}fBh(ta){this.Og.addHandler("OnUpdatePowerQueryDataKeySucceeded",ta)}qlk(ta){this.Og.removeHandler("OnUpdatePowerQueryDataKeySucceeded",ta)}gBh(ta){this.Og.addHandler("OnUpdatePowerQueryLegacyConnectionsSucceeded",ta)}rlk(ta){this.Og.removeHandler("OnUpdatePowerQueryLegacyConnectionsSucceeded",
ta)}QGc(ta){if(this.wsb.Vg(ta)){const wb=this.wsb.getItem(ta);if(!this.BH.Vg(ta)||wb.LoadedToDataModel)return!1;if(wb.IsPendingRefresh||1!==wb.FillObjectType)return!0}else Q.ULS.sendTraceTag(537154446,0,10,"Query not present in the queryNameToQueryInfo dictionary");return!1}lEd(ta){this.$.userOperationManager.enqueueOperation(new Lb.a(1042,0,(wb,ic,Oa)=>Ce(this.$.pa.ta,this.G9c,Yb.c(Cb=>{Cb&&Cb.Result&&(void 0===this.fhb||this.fhb<ta)&&(Cb=Cb.Result,this.Mfd.clear(),Cb.forEach(yc=>{this.Mfd[yc.QueryName]=
yc}),this.fhb=ta,this.Og.raiseEvent("OnUpdatePowerQueryDocumentInspectionSucceeded",this.Mfd))},wb),Yb.b(Cb=>{Q.ULS.sendTraceTag(507511817,0,10,"PowerQueryManager.fetchAndUpdatePowerQueryDocumentInspection: powerQueryDocumentInspect operation failed");this.fhb<ta&&(this.fhb=ta);this.Og.raiseEvent("OnUpdatePowerQueryDocumentInspectionFailed",Cb.data)},ic),Oa,null),16),null)}H1i(ta){const wb=this;return No(function*(){if(0!==ta.length){var ic=yield wb.QQi();for(const Oa of ta)wb.$.userOperationManager.enqueueOperation(new Lb.a(1043,
0,(Cb,yc,Nc)=>of(wb.$.pa.ta,Oa,ic,Yb.c(Id=>{Id.Errors&&0<Id.Errors.length?Q.ULS.sendTraceTag(507844416,0,10,`PowerQueryManager.powerQueryCustomEvaluation: powerQueryCustomEvaluation operation failed ${Id.Errors}`):Q.ULS.sendTraceTag(507844387,0,50,"PowerQueryManager.powerQueryCustomEvaluation: powerQueryCustomEvaluation operation succeeded")},Cb),Yb.b(()=>{Q.ULS.sendTraceTag(507844386,0,10,"PowerQueryManager.powerQueryCustomEvaluation: powerQueryCustomEvaluation operation failed")},yc),Nc,null),80),
null)}})}Psi(){let ta=new Promise(null);this.$.userOperationManager.enqueueOperation(new Lb.a(1043,0,(wb,ic,Oa)=>Se(this.$.pa.ta,Yb.c(Cb=>{Cb.Errors||void this.H1i(Cb.Result)},()=>{ta=Promise.resolve(!0)}),Yb.b(()=>{ta=Promise.resolve(!1)},ic),Oa,null),80),null);return ta}u$(){const ta=new fd.a;na.EwaSettings.isChangeGateEnabled("OfficeVSO:7597823_PowerQueryManagerSendProxyRequests")?jf.d(this.$.pa.ta,Yb.c(this.X2g,this.c0b,()=>{ta.setResult(!0)}),Yb.b(this.$Mc,this.Fog,()=>{ta.setResult(!0)}),null,
null):this.$.userOperationManager.enqueueOperation(new Lb.a(587,0,(wb,ic,Oa)=>jf.d(this.$.pa.ta,Yb.c(wb,this.X2g,this.c0b,()=>{ta.setResult(!0)}),Yb.b(ic,this.$Mc,this.Fog,()=>{ta.setResult(!0)}),Oa,null),80,()=>new uc.a),null);return ta.task}mEd(){const ta=new fd.a;na.EwaSettings.isChangeGateEnabled("OfficeVSO:7597823_PowerQueryManagerSendProxyRequests")?jf.b(this.$.pa.ta,Yb.c(this.U2g,this.Hog,()=>{ta.setResult(!0)}),Yb.b(this.Phg,this.Gog,()=>{ta.setResult(!0)}),null,null):this.$.userOperationManager.enqueueOperation(new Lb.a(603,
0,(wb,ic,Oa)=>jf.b(this.$.pa.ta,Yb.c(wb,this.U2g,this.Hog,()=>{ta.setResult(!0)}),Yb.b(ic,this.Phg,this.Gog,()=>{ta.setResult(!0)}),Oa,null),80,()=>new uc.a),null);return ta.task}G$e(ta){if(this.BH.Vg(ta)){ta=this.BH.getItem(ta).ConnectionName;const wb=this.NG.Hyg;if(wb&&wb.has(ta))Q.ULS.sendTraceTag(525342226,0,50,"PowerQueryManager.cancelRefreshQuery: sending cancellation request"),ta=wb.get(ta),V.i(this.$.pa.ta,ta,null,null,null);else if(!this.NG.t_k(ta))return Q.ULS.sendTraceTag(525342225,0,15,
"PowerQueryManager.cancelRefreshQuery: cannot find canceled connection on running requests map"),!1}return!0}eZf(){return na.EwaSettings.isChangeGateEnabled("OfficeVSO:8570095_PowerQueryDisableRibbonCommandOnClientLoading")?this.k9f:!0}f0i(ta){this.$.userOperationManager.enqueueOperation(new Lb.a(1034,0,(wb,ic,Oa)=>Gd(this.$.pa.ta,ta,Yb.c(Cb=>{Cb.Errors&&0<Cb.Errors.length&&this.u$();Cb&&Cb.Result&&this.wYe(Cb.Result)},wb),Yb.b(()=>{this.u$()},ic),Oa,null),4),null)}O1i(ta){this.DPh(ta)?this.$.userOperationManager.enqueueOperation(new Lb.a(1040,
0,(wb,ic,Oa)=>{var Cb=this.$.pa.ta;const yc=Cb.Za(33,null);yc.pastePayload=ta;return V.h(Cb,"PowerQueryPaste",yc,wb,ic,Oa,null,0)},4),null):(Q.ULS.sendTraceTag(507806221,0,15,"PowerQueryManager.handlePowerQueryPaste: conflict queries has formula referenced to it."),this.OMk())}Sqf(ta,wb,ic,Oa){if(ic){switch(ta){case 3:this.fji(wb,ic);break;case 2:this.aji(wb,Oa);break;case 4:this.dji(wb,ic);break;default:return}this.c0b(void 0,void 0,void 0)}else Q.ULS.sendTraceTag(509752481,0,10,"PowerQueryManager.estimateGroupOperation: Group not found")}fji(ta,
wb){wb.Name=ta.Name}aji(ta,wb){null===wb||void 0===wb?void 0:wb.forEach(ic=>{this.x2d(ic,1)});wb=this.groups.findIndex(ic=>ic.Id===ta.Id);-1===wb?Q.ULS.sendTraceTag(509752480,0,10,"PowerQueryManager.estimateDeleteGroup: Group index not found"):this.groups.splice(wb,1)}dji(ta,wb){const ic=ta.ParentId?ta.ParentId:"{00000000-0000-0000-0000-000000000000}";let Oa=-1;this.groups.forEach(Cb=>{Cb.ParentId===ic&&Cb.Order>Oa&&(Oa=Cb.Order)});wb.ParentId=ic;wb.Order=Oa+1}handleQueryAction(ta,wb){var ic=()=>
{this.eji(ta,wb);this.nRk(ta,wb)};4===ta?(this.bji(wb.Name),ic=D.a.resolve(J.Gf,{va:1}),void ic.then(()=>{this.f0i(wb.Name)})):1===ta?this.iKf(sa.a.instance.ia(2289),String.format(sa.a.instance.$g(215),wb.Name),ic):ic()}iKf(ta,wb,ic){const Oa=new xc.a;Oa.Bh=11;Oa.Yh(1,sa.a.instance.ia(2290));Oa.Yh(2,sa.a.instance.ia(5));Oa.Io(ta,wb,1,Cb=>{1===Cb&&ic()})}nRk(ta,wb){this.$.userOperationManager.enqueueOperation(new Lb.a(1023,0,(ic,Oa,Cb)=>Ub(this.$.pa.ta,ta,wb,Yb.c(yc=>{4===ta&&yc&&yc.Result&&this.wYe(yc.Result);
this.slg(ta,wb);0<yc.Errors.length&&this.u$()},ic),Yb.b(()=>{this.slg(ta,wb);this.u$()},Oa),Cb,null),68),null)}eji(ta,wb){const ic=this.pLd(wb.Name);this.x2d(ic,ta);2===ta&&this.gji(ic,wb);this.c0b(void 0,void 0,void 0)}gji(ta,wb){ta.Name=wb.ExtraData;ta.LoadedToDataModel||((ta=this.BH.getItem(wb.Name))?(ta.ConnectionName="Query - "+wb.ExtraData,ta.QueryName=wb.ExtraData,this.BH.remove(wb.Name),this.BH.add(wb.ExtraData,ta)):Q.ULS.sendTraceTag(512492568,0,10,"PowerQueryManager.estimateRenameQuery: Connection info not found"))}bji(ta){const wb=
this.pLd(ta),ic={};ic.Name=this.tAi(ta);ic.Description=wb.Description;ic.FillObjectType=1;ic.LastRefresh=wb.LastRefresh;ic.LoadedToDataModel=wb.LoadedToDataModel;ic.GroupID=wb.GroupID;ic.QueryError=wb.QueryError;this.queries.push(ic);this.c0b(void 0,void 0,void 0)}tAi(ta){for(var wb=ta.slice(0,this.H9f).trim();!this.anj(wb);){let ic=2;ta=wb;const Oa=wb.match(this.Y8j);Oa&&0<=Oa.length&&(ta=Oa[1],ic=parseInt(Oa[2],10)+1);isNaN(ic)||ic===Number.MAX_SAFE_INTEGER||(wb="("+ic.toString()+")",wb=ta.slice(0,
this.H9f-wb.length)+" "+wb)}return wb}anj(ta){return this.queries.every(wb=>wb.Name!==ta)}wYe(ta){(ta=this.$.sa.getItemByName(ta))?ta.activate({scenario:"powerQuery"}):Q.ULS.sendTraceTag(508630468,0,15,"PowerQueryManager.activateLoadedQuerySheet: Cannot find new loaded to query sheet.")}Ji(){return!1}Bi(){return!1}dispose(){O.a.Ni([this.Og]);na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1)&&this.NG.yCg(this.E_b);this.$.ea.pA(this.ol);this.$.ea.wP(this.Dt);
this.$=null}XPh(){return this.iSd(!1)}gac(ta){return this.mJk()?Ff.hostNotSupported:!ta&&this.a0f?Ff.teamsDisallowedApp:this.l0f?Ff.thirdPartyCookiesDisabled:Ff.none}isk(ta){if(this.xLb)ta();else{const wb=()=>{ta();this.Kik(wb)};this.cyh(wb)}}cyh(ta){this.Og.addHandler("onDataFirstLoadedKey",ta)}Kik(ta){this.Og.removeHandler("onDataFirstLoadedKey",ta)}QTf(){const ta=this;return No(function*(){if(!na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1)&&!na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefreshPFTAsDefault",
!1))return!0;yield ta.ljb(void 0,!0);const wb=ta.gac(!1);Q.ULS.sendTraceTag(508834757,0,50,`PowerQueryManager.isAuthenticatedPowerQuerySupportedBB, oAuthErrorType: ${wb}}`);switch(wb){case Ff.hostNotSupported:return!1;case Ff.thirdPartyCookiesDisabled:return ta.$Kk(),!1;case Ff.teamsDisallowedApp:return ta.HNk(),!1;case Ff.none:return!0;default:return Q.ULS.sendTraceTag(508839681,0,10,`PowerQueryManager.isAuthenticatedPowerQuerySupportedBB, unexpected error type: oAuthErrorType ${wb}}`),!1}})}iSd(ta){if(!na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",
!1))return!0;const wb=this.gac(ta);Q.ULS.sendTraceTag(508834756,0,50,`PowerQueryManager.isAuthenticatedPowerQuerySupportedDialog, oAuthErrorType: ${wb}, isTeamsSupported: ${ta}`);switch(wb){case Ff.hostNotSupported:return this.gRg(1580811823),!1;case Ff.thirdPartyCookiesDisabled:return this.KNk(),!1;case Ff.teamsDisallowedApp:return this.BMk(),!1;case Ff.none:return!0;default:return Q.ULS.sendTraceTag(508839680,0,10,`PowerQueryManager.isAuthenticatedPowerQuerySupported, unexpected error type: oAuthErrorType ${wb}, isTeamsSupported ${ta}`),
!1}}mJk(){return!this.$.ua.DocumentHostInfo.AADUserObjectId&&0!==pb.a.compare(this.$.ua.DocumentHostInfo.HostTier,"TestHost",!0)}gRg(ta,wb){switch(ta){case -1543585732:ta=this.KAe(ta,"PowerQueryRefreshProtectedSheetFailed");ta.Description=String.format(sa.a.instance.Ba(709),wb,sa.a.instance.ia(2212));break;case 165156185:ta=this.KAe(ta,"PowerQueryRefreshSheetViewFailed");ta.Description=String.format(sa.a.instance.Ba(709),wb,sa.a.instance.ia(2213));break;case 1580811823:ta=sc.a.Yi(1,1,2211,2216,0,
ta,"PowerQueryRefreshHostNotSupported");ta.HelpDescription=sa.a.instance.ia(1319);ta.HelpTopicId=Bb.a.Ddk;break;default:Q.ULS.sendTraceTag(529069344,0,10,`PowerQueryManager.showEwaErrorDialog: unhandled error id ${ta}`);return}new Mb.a(this.$,ta)}KAe(ta,wb){return sc.a.Yi(1,2,2211,0,0,ta,wb)}QPh(ta){var wb=this.wsb.getItem(ta);return wb?(wb=this.OIi(wb))?(this.gRg(wb,ta),!1):!0:(Q.ULS.sendTraceTag(529069343,0,10,"PowerQueryManager.getErrorMessageIdForQueryRefresh: Query not in the queryNameToQueryInfo dictionary"),
!1)}OIi(ta){if((ta=this.uUi(ta))&&ta.Dn)return-1543585732;if(ta&&ta.Kj.Ow)return 165156185}uUi(ta){let wb=void 0,ic=void 0;if(3===ta.FillObjectType||2===ta.FillObjectType)wb=ta.FillObjectName.split("!")[0];else if(0==ta.FillObjectType){if(!ta.FillObjectName)return Q.ULS.sendTraceTag(523534751,0,15,"PowerQueryManager.getSheetFromLoadDestination: FillObjectName is undefined for Query loaded to table."),ic;(ta=this.$.Gh.getItemByName(ta.FillObjectName))?wb=ta.sheetName:Q.ULS.sendTraceTag(527743194,0,
15,"PowerQueryManager.getSheetFromLoadDestination: cannot find namedObject for query")}wb&&(ic=this.$.sa.getItemByName(wb));return ic}odk(){this.bwf(this.Wti)}pdk(){this.bwf(this.Xti)}bwf(ta){this.xLb?this.jee(this.queries,ta):this.u$().continueWith(wb=>{wb.result?this.jee(this.queries,ta):Q.ULS.sendTraceTag(537154445,0,10,"PowerQueryManager.RefreshAllQueries failed to fetch queries")})}jee(ta,wb){ta=ta.filter(wb);0<ta.length&&this.iSd(!0)&&ta.forEach(ic=>this.Wyg(ic.Name))}HRi(ta){var wb;for(const ic of this.queries)if((null===
(wb=this.BH.getItem(ic.Name))||void 0===wb?void 0:wb.ConnectionName)===ta)return ic.Name;return null}QQi(){return this.cBf("Core",Ud,!1)}};Uf=Object(M.__decorate)([Object(D.d)(J.De),Object(M.__param)(0,Object(J.Lb)()),Object(M.__param)(1,Object(J.be)()),Object(M.__param)(2,Object(J.qb)())],Uf);Object(C.a)(Uf,"PowerQueryManager",null,[444,2]);var Gf;(function(ta){ta[ta.null=-1]="null";ta[ta.table=0]="table";ta[ta.connectionOnly=1]="connectionOnly";ta[ta.pivotTable=2]="pivotTable";ta[ta.pivotChart=
3]="pivotChart"})(Gf||(Gf={}));Object(C.b)("FillObjectType",Gf);var lg=a(242);class Pa{constructor(ta,wb,ic){this.u_d=this.FNd=this.jNa=null;this.Jyg=0;this.onCancelQueryRefresh=Oa=>{this.im.G$e(Oa)&&this.fse([Oa])};this.handleQueryGroupOperation=(Oa,Cb)=>{const yc={};yc.Id=Cb.id;yc.Name=Cb.name;yc.Description=Cb.description;yc.ParentId=Cb.parentId;const Nc=this.jOi(Oa,Cb);Nc?(Oa=sc.a.Yi(1,0,751,0,0,698690962,"PowerQueryMoveToTopLevelFailedWithNameConflict"),Oa.Description=String.format(sa.a.instance.$g(219),
Cb.name,Nc),new Mb.a(this.$,Oa)):this.im.handleQueryGroupOperation(Oa,yc)};this.onEditQuery=Oa=>{this.$.Ma.dh(new oe.a(-2080757377,0,this.$.Rh,8,null),{["queryName"]:Oa})};this.onPowerQueryPaste=(Oa,Cb,yc)=>{Oa=this.PQi(Oa,Cb,yc);this.im.O1i(Oa)};this.showClipboardAccessPermissionDialog=()=>{const Oa=sc.a.Yi(1,2,2490,2491,0,0,"AllowClipboardAccessPermission");new Mb.a(this.$,Oa)};this.handleQueryAction=(Oa,Cb)=>{const yc={};yc.Name=Cb.name;yc.ExtraData=Cb.extraData;yc.Formulas=this.im.formulas;this.im.handleQueryAction(Oa,
yc)};this.jOi=(Oa,Cb)=>{var yc;let Nc=void 0;na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryMoveToTopLevelErrorDialog",!1)&&4===Oa&&null===Cb.parentId&&(Nc=null===(yc=this.FNd.find(Id=>"{00000000-0000-0000-0000-000000000000}"===Id.parentKey&&Id.name.toLowerCase()===Cb.name.toLowerCase()))||void 0===yc?void 0:yc.name);return Nc};this.PQi=(Oa,Cb,yc)=>{const Nc={};Nc.PasteParentGroupKey=Oa;Nc.Queries=pf.LZh(Cb);Nc.QueryGroups=pf.Eff(yc);return Nc};this.$=ta;this.Hae=ic;this.isVisible=
!1;this.KRc=new Ha.a(!0);this.see={};this.im=wb}gOa(){Lc.a.ut()?void D.a.resolve(J.We,{va:0}).then(ta=>ta.setSelectedTaskPane("PowerQueryTaskPane")):hd.a.Go().then(ta=>{ta.setSelectedTaskPane("PowerQueryTaskPane");return null})}FS(){this.isVisible=!0;Lc.a.ut()?void D.a.resolve(J.We,{va:0}).then(ta=>ta.hS("PowerQueryTaskPane",this.zKb())):hd.a.Go().then(ta=>{ta.showTaskPane("PowerQueryTaskPane",this.zKb());return null})}gL(ta,wb,ic,Oa,Cb){wb=void 0===wb?null:wb;Oa=void 0===Oa?null:Oa;Cb=void 0===Cb?
null:Cb;if(this.isVisible){var yc=this.zKb(ta,wb,ic,Oa,Cb);Lc.a.ut()?void D.a.resolve(J.We,{va:0}).then(Nc=>Nc.updateTaskPane("PowerQueryTaskPane",yc||this.zKb(ta,wb,ic,Oa,Cb))):hd.a.Go().then(Nc=>{Nc.updateTaskPane("PowerQueryTaskPane",yc||this.zKb(ta,wb,ic,Oa,Cb));return null})}else this.M3g(ta,wb,ic,Oa)}zU(){this.isVisible=!1;Lc.a.ut()?void D.a.resolve(J.We,{va:0}).then(ta=>ta.hideTaskPane("PowerQueryTaskPane")):hd.a.Go().then(ta=>{ta.hideTaskPane("PowerQueryTaskPane",2);return null})}tUg(ta){if(!lg.a.qm(ta)){for(const wb of this.jNa)ta.includes(wb.name)&&
(this.KRc.add(wb.name,wb),this.see[wb.name]=++this.Jyg,Q.ULS.sendTraceTag(537154401,0,50,`Refresh started for query #: ${this.Jyg}`));this.gL(this.im.queries,this.im.groups,this.im.BH,this.im.oLa)}}fse(ta){if(!lg.a.qm(ta)){for(const wb of this.jNa)ta.includes(wb.name)&&(wb.name in this.see&&Q.ULS.sendTraceTag(537154400,0,50,`Refresh stoped for query #: ${this.see[wb.name]}`),this.KRc.remove(wb.name));this.gL(this.im.queries,this.im.groups,this.im.BH,this.im.oLa)}}M3g(ta,wb,ic,Oa){ta=void 0===ta?null:
ta;wb=void 0===wb?null:wb;ic=void 0===ic?null:ic;Oa=void 0===Oa?null:Oa;ta&&(this.jNa=[],null===ta||void 0===ta?void 0:ta.forEach(Cb=>this.jNa.push(pf.Fff(Cb,ic))));Oa&&(this.u_d=[],null===Oa||void 0===Oa?void 0:Oa.forEach(Cb=>this.u_d.push(this.n1h(Cb))));wb&&(this.FNd=pf.yff(wb));this.i6j()}zKb(ta,wb,ic,Oa,Cb){Cb=void 0===Cb?null:Cb;this.M3g(void 0===ta?null:ta,void 0===wb?null:wb,void 0===ic?null:ic,void 0===Oa?null:Oa);ta={onQuerySelected:this.Hae.onQuerySelected,onQueryRefresh:this.im.IRc,onCancelQueryRefresh:this.onCancelQueryRefresh,
handleQueryGroupOperation:this.handleQueryGroupOperation,handleQueryAction:this.handleQueryAction,onSetQueryProperties:this.im.setQueryProperties,onClearAllCredentials:this.im.kTh,onEditQuery:this.onEditQuery,onPowerQueryPaste:this.onPowerQueryPaste,showClipboardAccessPermissionDialog:this.showClipboardAccessPermissionDialog};const yc={"Microsoft.Office.Excel.PowerQueryTaskPaneRenameQuery":!0,"Microsoft.Office.Excel.PowerQueryTaskPaneDeleteQuery":!0,"Microsoft.Office.Excel.PowerQueryTaskPaneDuplicateQuery":na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryTaskPaneDuplicateQuery",
!1),"Microsoft.Office.Excel.PowerQueryClearAllCredentialTaskPane":na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryClearAllCredentialTaskPane",!1),"Microsoft.Office.Excel.PowerQueryAuthenticateRefresh":na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1),"Microsoft.Office.Excel.PowerQueryCopyPaste":na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryCopyPaste",!1),"Microsoft.Office.Excel.PowerQueryDeleteQueryGroup":!0,
"Microsoft.Office.Excel.PowerQueryTaskPaneQueryProperties":na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryTaskPaneQueryProperties",!1),"Microsoft.Office.Excel.PowerQueryImport":na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryImport",!1),"Microsoft.Office.Excel.PowerQueryCopy":na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryCopy",!1),"Microsoft.Office.Excel.PowerQueryPaste":na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryPaste",
!1),isAADDocumentHost:!!this.$.ua.DocumentHostInfo.AADUserObjectId||!pb.a.compare(this.$.ua.DocumentHostInfo.HostTier,"TestHost",!0),isPowerQueryEditEnabled:this.im.isPowerQueryEditEnabled,isPowerQueryTaskPaneConnectionActionsEnabled:!1,isDocumentStructureLocked:fc.l(this.$.Bk),isTooltipEnabled:!0};Cb={type:"PowerQueryTaskPaneProps",callbacks:ta,queries:this.jNa,groups:this.FNd,connections:this.u_d,selectedQueryKey:Cb,getBooleanProperty:Nc=>{var Id;return null!==(Id=yc[null!==Nc&&void 0!==Nc?Nc:""])&&
void 0!==Id?Id:!1},isAADDocumentHost:yc.isAADDocumentHost,isPowerQueryEditEnabled:yc.isPowerQueryEditEnabled,isPowerQueryTaskPaneConnectionActionsEnabled:yc.isPowerQueryTaskPaneConnectionActionsEnabled,isDocumentStructureLocked:yc.isDocumentStructureLocked,isTooltipEnabled:yc.isTooltipEnabled};return Object(Sc.a)(new qc.a,{contentProps:Cb,onOpen:()=>{this.Hae.sha()},onClose:()=>{this.Hae.qE()},width:320,title:sa.a.instance.ia(2288)})}i6j(){if(this.jNa)for(let wb=0;wb<this.jNa.length;wb++){var ta=
!1;const ic=this.jNa[wb],Oa=this.KRc.getItem(ic.name);null!=Oa&&(ta=new Date(ic.lastRefresh),(ta=(new Date(Oa.lastRefresh)).getTime()===ta.getTime())||this.KRc.remove(Oa.name));ic.inRefresh=ta;ic.refreshEnabled=this.im.BH.Vg(ic.name)}}n1h(ta){return{name:ta.Name,description:ta.Description,fillObjectType:ta.FillObjectType,loadedToDataModel:ta.LoadedToDataModel,inRefresh:ta.InRefresh,refreshEnabled:ta.RefreshEnabled}}}Object(C.a)(Pa,"PowerQueryReactTaskPane",null,[548]);class lc{constructor(ta,wb){this.epa=
this.VZc=null;this.ePc=this.Oq=!1;this.hjc=null;this.onQuerySelected=ic=>{for(var Oa of this.im.queries)if(Oa.FillObjectName&&Oa.Name===ic){3!==Oa.FillObjectType&&2!==Oa.FillObjectType||pb.a.contains(Oa.FillObjectName,"!",!0)||Q.ULS.sendTraceTag(537154438,0,15,`PowerQueryPaneManager.OnQuerySelected: Selection Query of type : ${Gf[Oa.FillObjectType]} and no ! on FillObjectName`);3===Oa.FillObjectType?(ic=Oa.PivotChartSheetRange,ic.SheetName=Oa.FillObjectName.split("!")[0],Oa=Oa.FillObjectName.split("!")[1],
Ya.f(this.$).ha.$e.FVa(ic,Oa,0).continueWith(Cb=>{Cb.result||Q.ULS.sendTraceTag(537154437,0,15,"PowerQueryPaneManager.OnQuerySelected: Selection of PivotChart Failed")})):(Oa=2===Oa.FillObjectType?Oa.FillObjectName.split("!")[1]:Oa.FillObjectName,(Oa=this.$.Gh.getItemByName(Oa))&&Oa.activate({disableAutoFocusOnGrid:!0,scenario:"powerQuery"}));break}};this.onCancelQueryRefresh=ic=>{this.im.G$e(ic)&&this.epa.fse([ic])};this.onQueryRefresh=ic=>{this.im.IRc(ic)};this.BZf=ic=>this.im.BH.Vg(ic);this.Shg=
()=>{this.UQj()};this.Qhg=()=>{this.vQj()};this.onActiveItemChanged=(ic,Oa)=>{Oa.na&&2===Oa.na.type&&this.fte.Vg(Oa.na.name)&&this.updateTaskPane(this.fte.getItem(Oa.na.name))};this.Olg=(ic,Oa)=>{ic=[];for(const Cb of this.im.BH.values)if(Oa===Cb.ConnectionName){const yc=Cb.QueryName;if(this.im.QGc(yc)){ic.push(yc);break}}this.epa.tUg(ic)};this.E_b=(ic,Oa)=>{if(Oa&&Oa.Result){ic=Oa.Result.ConnectionName;Oa=[];for(const Cb of this.im.BH.values)if(ic===Cb.ConnectionName){const yc=Cb.QueryName;if(this.im.QGc(yc)){Oa.push(yc);
break}}this.epa.fse(Oa)}};this.$=ta;this.im=wb;this.fte=new Ha.a(!0);this.jUk=new Ha.a(!0);this.Gaj(ta);void D.a.resolve(J.qb,{va:1}).then(ic=>{ic.B1e(this.E_b);ic.rxh(this.Olg)});this.im.fBh(this.Shg);this.im.gBh(this.Qhg);Q.ULS.sendTraceTag(542228699,0,15,"PowerQueryPaneManager.ShowPowerQueryTaskPane()")}TMk(ta){this.hjc=ta;this.showTaskPane()}Gaj(ta){this.epa=new Pa(ta,this.im,this)}dispose(){void D.a.resolve(J.qb,{va:1}).then(ta=>{ta.yCg(this.E_b);ta.eik(this.Olg)});this.im.qlk(this.Shg);this.im.rlk(this.Qhg);
this.$=null;this.hideTaskPane();this.epa=null}sha(){this.im.u$();this.im.mEd();this.$.Gh.Qm(this.onActiveItemChanged)}qE(){this.Oq=!1}handleQueryGroupOperation(ta,wb){Rc.a(this.$.userOperationManager,(ic,Oa,Cb)=>eb(this.$.pa.ta,ta,wb,ic,Oa,Cb,null),ic=>new Lb.a(1021,0,ic),null)}showTaskPane(){this.Oq?this.epa.gOa():(this.VZc=this.$.qh.vi("UserAction","PowerQueryTaskPaneInitialLoadTime"),this.Oq=!0,this.epa.FS())}updateTaskPane(ta){let wb=ta;this.hjc&&this.im.queries.find(Oa=>{Oa.Name===this.hjc&&
(wb=Oa.Name,this.hjc=null)});this.epa.gL(this.im.queries,this.im.groups,this.im.BH,this.im.oLa,wb);this.VZc&&(this.VZc.stop(),this.VZc=null);for(ta=0;ta<this.im.queries.length;ta++){var ic=this.im.queries[ta];0===ic.FillObjectType&&this.fte.add(ic.FillObjectName,ic.Name);ic.LastRefresh||Q.ULS.sendTraceTag(537154436,0,15,"PowerQueryPaneManager.UpdateTaskPane: Invalid date for last refreshed.")}ta=this.im.oLa;for(ic=0;ic<ta.length;ic++){const Oa=ta[ic];0===Oa.FillObjectType&&this.jUk.add(Oa.FillObjectName,
Oa.Name)}}hideTaskPane(){this.Oq=!1;this.epa.zU()}UQj(){this.updateTaskPane(null);this.ePc||(void D.a.resolve(J.qb,{va:1}).then(ta=>{this.fkg(ta.uee)}),this.ePc=!0)}vQj(){this.updateTaskPane(null);this.ePc||(void D.a.resolve(J.qb,{va:1}).then(ta=>{this.fkg(ta.uee)}),this.ePc=!0)}fkg(ta){const wb=[];for(const ic of ta)for(const Oa of this.im.BH.values)if(ic===Oa.ConnectionName&&(ta=Oa.QueryName,this.im.QGc(ta))){wb.push(ta);break}this.epa.tUg(wb)}}Object(C.a)(lc,"PowerQueryPaneManager",null,[534]);
var Gc;let Cd=Gc=class{constructor(ta,wb){this.dQc=null;this.$=ta;this.r5j=wb}Ji(){return!1}Bi(){return!1}executeCommand(ta,wb,ic){this.dQc||(this.dQc=new lc(this.$,this.r5j));ta=ua.TaskExtensions.sq();return 1156885807===wb.command?(this.dQc.TMk(null===ic||void 0===ic?void 0:ic[Gc.selectedQueryKey]),ta):Db.a(wb.command)}dispose(){this.$=this.dQc=null}ni(ta,wb){return 1156885807===wb.command}};Cd.selectedQueryKey="selectedQuery";Cd=Gc=Object(M.__decorate)([Object(D.d)(J.Ee),Object(M.__param)(0,Object(J.Lb)()),
Object(M.__param)(1,Object(J.De)())],Cd);Object(C.a)(Cd,"PowerQueryPaneCommandHandler",null,[39,2]);class Qd extends Qb.a{constructor(ta,wb,ic,Oa,Cb){super(ta);this.jwi=(yc,Nc)=>{this.hide();this.Y3b(yc,Nc)};Q.ULS.sendTraceTag(512267668,0,50,"PowerQueryReactFlowDialog.PowerQueryReactFlowDialog");this.Tu=wb;this.Tu.id=this.ki;0===this.Tu.flowProps.flowId&&Q.ULS.shipAssertTag(508609296,0,!!ic&&!!Oa,"PowerQueryReactFlowDialog.PowerQueryReactFlowDialog - ResolveChallengeFlow requires onCommitCallback and onCancelCallback");
this.s6d=Oa;this.H6d=ic;this.Y3b=Cb}get ki(){return"PowerQueryFlowDialog"}Im(){Q.ULS.sendTraceTag(509613450,0,50,`PowerQueryReactFlowDialog.initializeAndShowDialog started. FlowID: ${this.Tu.flowProps.flowId}`);this.initializeAndShow("",this.jwi,this.Tu)}}Object(C.a)(Qd,"PowerQueryReactFlowDialog",Qb.a,[]);var ge=a(751);class ye{constructor(ta,wb,ic,Oa,Cb,yc,Nc){this.$=ta;this.ehg=wb;this.authTokenAsyncCallback=ic;this.showFeedbackDialogCallback=Oa;this.zog=Cb;this.H6d=yc;this.s6d=Nc}get kBe(){return this.flowId}get aba(){return ta=>
{var wb;null===(wb=this.s6d)||void 0===wb?void 0:wb.call(this,ta);this.ehg()}}DKb(){return new Qd(this.$,this.Vzc(),this.H6d,this.s6d,this.bIf(this.flowId))}gqe(){this.$.k5(ta=>{void ta.F$(1).then(()=>{void appChrome.startPowerQueryFlow(this.Vzc(),this.authTokenAsyncCallback,this.zog,this.bIf(this.flowId),this.showFeedbackDialogCallback)})})}dispose(){this.authTokenAsyncCallback=this.$=null}kLd(){return{isModal:!0,locale:this.$.ua.UICultureTag,sessionId:this.$.ua.UserSessionId,hostContextType:this.$.ua.PowerQueryHostContextType,
powerQueryEndpointUrl:this.$.ua.PowerQueryEndpointUrl,authTokenAsyncCallback:this.authTokenAsyncCallback,onUnlinkConnection:this.zog}}bIf(ta){return(wb,ic)=>{var Oa;switch(wb){case 0:this.aba();break;case 1:null===(Oa=this.H6d)||void 0===Oa?void 0:Oa.call(this,ic);break;case 2:this.ehg()}Q.ULS.sendTraceTag(508171527,0,20,`PowerQueryReactFlowDialogBuilder.resultHandler committed with action button: ${ge.a[wb]}, flowId: ${ta}`)}}}ye.w4a="queryName";Object(C.a)(ye,"PowerQueryReactFlowDialogBuilderBase",
null,[]);class $e extends ye{constructor(ta,wb,ic,Oa,Cb,yc,Nc){super(ta,wb,ic,Oa,void 0,Cb,void 0);this.zpk={["height"]:500,["width"]:580,["unit"]:"px"};this.flowId=0;this.kind=yc;this.path=Nc}Vzc(){const ta=this.kLd();ta.bodyProps=this.zpk;ta.flowProps={flowId:this.flowId,resourceKind:this.kind,resourcePath:this.path};return ta}}$e.kya="kind";$e.qPc="path";$e.XXh="connectionName";Object(C.a)($e,"PowerQueryResolveChallengeReactFlowDialogBuilder",ye,[]);class qf extends ye{constructor(ta,wb,ic,Oa,
Cb,yc){super(ta,wb,ic,Oa,Cb);this.rBj={["height"]:50,["width"]:50,["unit"]:"%"};this.flowId=1;this.connectionOverrides=yc}Vzc(){const ta=this.kLd();ta.bodyProps=this.rBj;ta.flowProps={flowId:this.flowId,connectionOverrides:this.connectionOverrides};return ta}}Object(C.a)(qf,"PowerQueryManageConnectionsReactFlowDialogBuilder",ye,[]);var h=a(188);class Z{static createSession(ta,wb,ic,Oa,Cb,yc){ta=Z.c5h(ta,yc,Oa);return new Z(ta.queries,pf.yff(wb),pf.uff(Cb),ic,ta.activeQueryId)}get Queries(){return this.queries}get Groups(){return this.groups}get a9g(){return this.ZXh}get X$g(){return this.mashupDocument}get Z7g(){return this.activeQueryId}uIi(ta,
wb,ic,Oa){const Cb=[],yc=[],Nc=[],Id=[];this.queries.forEach(Ie=>{const Le=ta.find(wf=>wf.runTimeId===Ie.runTimeId);Le?(Le.name!==Ie.name&&yc.push({OldQueryName:Ie.name,NewQueryName:Le.name}),Le.groupKey!==Ie.groupKey&&Nc.push({QueryName:Le.name,NewGroupId:Le.groupKey})):Cb.push(Ie.name)});ta.forEach(Ie=>{this.queries.find(Le=>Le.runTimeId===Ie.runTimeId)||Id.push({QueryName:Ie.name,NewGroupId:Ie.groupKey})});const ke={};ke.DeletedQueries=Cb;ke.AddedQueries=Id;ke.RenamedQueries=yc;ke.GroupChangedQueries=
Nc;ke.Groups=pf.Eff(wb);ke.Connections=pf.JZh(Oa);ke.Mashup=ic;return ke}constructor(ta,wb,ic,Oa,Cb){this.queries=ta;this.groups=wb;this.ZXh=ic;this.mashupDocument=Oa;this.activeQueryId=Cb}static c5h(ta,wb,ic){ta=pf.PZh(ta);let Oa=void 0;ta.forEach(Cb=>{Cb.runTimeId=h.a.create().toString();Cb.inRefresh=ic.includes(Cb.name);Cb.name===wb&&(Oa=Cb.runTimeId)});return{queries:ta,activeQueryId:Oa}}}Object(C.a)(Z,"PowerQueryEditSession",null,[]);class E extends ye{constructor(ta,wb,ic,Oa,Cb,yc,Nc,Id,ke,
Ie,Le,wf,Kf){super(wb,ic,Oa,Cb,yc,Nc,Id);this.efi={["height"]:90,["width"]:90,["unit"]:"%"};this.Ajf="CurrentWorkbook";this.EDh="Anonymous";this.r7j="Private";this.Upk="XLO_RestUrl";this.qbl="XLO_WorkbookSessionId";this.cVh="XLO_ClusterId";this.HFj="XLO_NamedRangeEnabled";this.sessionKey="session";this.Q0k="usid";this.bVh="cluster";this.Zzk(ta);this.queries=ke;this.groups=Ie;this.mashupDocument=Le;this.activeQueryId=Kf;this.connectionOverrides=wf}Vzc(){const ta=this.kLd();ta.bodyProps=this.efi;ta.flowProps=
2===this.flowId?this.sIi():this.IKi();return ta}sIi(){return{flowId:this.kBe,editingSessionMetadata:this.qDf(),activeQueryId:this.activeQueryId}}IKi(){return{flowId:this.kBe,editingSessionMetadata:this.qDf()}}qDf(){return{queries:this.queries,queryGroups:this.groups,mashupDocument:this.mashupDocument,connectionOverrides:this.RIi()}}RIi(){this.connectionOverrides.push(this.C1h());return this.connectionOverrides}C1h(){const ta={kind:this.Ajf,path:this.Ajf,authenticationKind:this.EDh,privacyGroup:this.r7j,
credentialDetails:new Map};ta.credentialDetails.set(this.Upk,this.$.ua.RestActionUrl);ta.credentialDetails.set(this.qbl,this.KYi());ta.credentialDetails.set(this.cVh,this.$.ua.MachineCluster);ta.credentialDetails.set(this.HFj,na.EwaSettings.isChangeGateEnabled("OfficeVSO:8642573_PowerQueryCurrentWorkbookNamedRange").toString());return ta}KYi(){const ta=new URLSearchParams;ta.append(this.bVh,this.$.ua.MachineCluster);ta.append(this.sessionKey,this.$.ea.sessionId);ta.append(this.Q0k,h.a.create().toString());
return ta.toString()}Zzk(ta){switch(ta){case -2080757377:this.flowId=2;break;case -1771748809:this.flowId=3;break;default:throw Error("PowerQueryGetAndTransformReactFlowDialogBuilder.setFlowId - Invalid ribbon command");}}}Object(C.a)(E,"PowerQueryGetAndTransformReactFlowDialogBuilder",ye,[]);let aa=class{constructor(ta,wb){this.qFd=()=>{this.oFc=!1;this.Jre()};this.rRk=ic=>{ic&&(Q.ULS.sendTraceTag(509613448,0,50,`PowerQueryUIFlowManager:ResolveChallenge: starting resolve challenge flow.
         Kind: ${ic[$e.kya]}`),ic=new $e(this.$,this.qFd,this.im.ljb,this.im.showFeedbackDialogCallback,this.JFi(ic[$e.w4a]),ic[$e.kya],ic[$e.qPc]),na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryUiImprovement",!1)?ic.gqe():ic.DKb().Im())};this.$Qk=()=>{Q.ULS.sendTraceTag(508601607,0,50,"PowerQueryUIFlowManager:ManageConnections: starting manage connections flow.");Fc(this.$.pa.ta,this.oMk,()=>{Q.ULS.sendTraceTag(508429978,0,10,"PowerQueryUIFlowManager:getDataSourceConnectionsFromRoaming manage connection read roaming Failed")},
null,null)};this.TQk=(ic,Oa)=>{Q.ULS.sendTraceTag(508421188,0,50,`PowerQueryUIFlowManager:GetAndTransform: starting GetAndTransform query flow: ${Oa}.`);Fc(this.$.pa.ta,this.HUi(ic,Oa),()=>{Q.ULS.sendTraceTag(508421187,0,10,`PowerQueryUIFlowManager:getDataSourceConnectionsFromRoaming GetAndTransform flow: ${Oa} ,read roaming Failed`)},null,null)};this.oMk=ic=>{Q.ULS.sendTraceTag(508429977,0,50,"PowerQueryUIFlowManager:ManageConnections: Read roaming succeeded.");ic=pf.uff(ic.Result);ic=new qf(this.$,
this.qFd,this.im.ljb,this.im.showFeedbackDialogCallback,this.im.Xve,ic);na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryUiImprovement",!1)?ic.gqe():ic.DKb().Im()};this.wCi=ic=>{if(ic){var Oa=this.dpa.uIi(ic.queries,ic.queryGroups,ic.mashupDocument,ic.connectionOverrides);this.dpa=null;var Cb=()=>{if(Oa&&Oa.AddedQueries&&0<Oa.AddedQueries.length){const yc=new oe.a(1156885807,dd.a.eh,this.$.Rh,0,fa.a.Hsb);this.$.Ma.dh(yc,{[Cd.selectedQueryKey]:Oa.AddedQueries[0].QueryName})}};
this.$.userOperationManager.enqueueOperation(new Lb.a(1041,0,(yc,Nc,Id)=>{var ke=this.$.pa.ta;yc=Yb.c(yc,Cb);const Ie=ke.Za(33,null);Ie.editingSessionDiff=Oa;return V.h(ke,"PowerQueryImport",Ie,yc,Nc,Id,null,0)},4),null)}else Q.ULS.sendTraceTag(507605655,0,10,"getAndTransformFlowCommitCallback: props is null or undefined")};this.vCi=()=>{this.dpa=null};this.$=ta;this.im=wb;this.tma=[];this.oFc=!1;this.S3b=new Ha.a(!1);this.dpa=null}Ji(){return!1}Bi(){return!1}executeCommand(ta,wb,ic){Q.ULS.sendTraceTag(508162324,
0,20,`PowerQueryUIFlowManager: handling ribbon command: ${wb.command}}`);ta=ua.TaskExtensions.sq();switch(wb.command){case -1496653501:return this.f_g(ic)||(Array.enqueue(this.tma,{vo:wb.command,props:ic}),this.Jre()),ta;case 1452434397:case -2080757377:case -1771748809:return Array.enqueue(this.tma,{vo:wb.command,props:ic}),this.Jre(),ta;default:return Db.a(wb.command)}}dispose(){this.dpa=this.S3b=this.tma=this.$=this.im=null}ni(ta,wb){switch(wb.command){case -1496653501:case 1452434397:case -2080757377:case -1771748809:return this.im.XPh()?
-1496653501===wb.command?!0:void 0===this.tma.find(ic=>ic.vo===wb.command):!1;default:return!1}}Jre(){const ta=this.J_k();if(ta)switch(Q.ULS.sendTraceTag(508121948,0,50,`PowerQueryUIFlowManager:startFlow: starting flow.
         flowId: ${ta.vo}`),ta.vo){case -1496653501:this.rRk(ta.props);break;case 1452434397:this.$Qk();break;case -2080757377:case -1771748809:this.TQk(ta.props,ta.vo);break;default:Q.ULS.sendTraceTag(508121947,0,10,`PowerQueryUIFlowManager:startFlow unexpected ribbonCommand: ${ta.vo}`)}}J_k(){return!this.oFc&&0<this.tma.length?(this.oFc=!0,Array.dequeue(this.tma)):null}HUi(ta,wb){return ic=>{Q.ULS.sendTraceTag(508421186,0,50,`PowerQueryUIFlowManager:GetAndTransform flow: ${wb}, Read roaming succeeded.`);
this.im.isk(()=>{this.dpa=Z.createSession(this.im.queries,this.im.groups,this.im.formulas,this.im.Idk,ic.Result,ta[E.w4a]);const Oa=new E(wb,this.$,this.qFd,this.im.ljb,this.im.showFeedbackDialogCallback,this.im.Xve,this.wCi,this.vCi,this.dpa.Queries,this.dpa.Groups,this.dpa.X$g,this.dpa.a9g,this.dpa.Z7g);na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryUiImprovement",!1)?Oa.gqe():Oa.DKb().Im()})}}p_k(){for(let ta=this.tma.length-1;0<=ta;ta--){const wb=this.tma[ta];-1496653501===
wb.vo&&this.f_g(wb.props)&&Q.ULS.sendTraceTag(508121946,0,50,`PowerQueryUIFlowManager:ResolveChallenge: auto resolve challenge succeeded.
           Kind: ${wb.props[$e.kya]}`)}}f_g(ta){var wb=this.Fqg(ta);wb=this.S3b.getItem(wb);if(!wb||Array.contains(wb,ta[$e.w4a]))return Q.ULS.sendTraceTag(508121945,0,50,`PowerQueryUIFlowManager:ResolveChallenge: try auto resolve challenge failed.
         isCached: ${!!wb},
         prevResolved: ${Array.contains(wb,ta[$e.w4a])}`),!1;const ic=this.tma.findIndex(Oa=>-1496653501===Oa.vo&&Oa.props===ta);Array.removeAt(this.tma,ic);this.oFc=!1;Array.add(wb,ta[$e.w4a]);this.im.IRc(ta[$e.w4a]);return!0}s6k(ta){var wb=this.Fqg(ta);const ic=ta[$e.w4a];this.S3b.Vg(wb)?(wb=this.S3b.getItem(wb),wb.includes(ic)||Array.add(wb,ic)):this.S3b.add(wb,[ic]);Q.ULS.sendTraceTag(509613446,0,50,`PowerQueryUIFlowManager:ResolveChallenge: Cache updated with Kind: ${ta[$e.kya]}`)}Fqg(ta){return ta[$e.kya].concat("_",
ta[$e.qPc])}JFi(ta){return wb=>{const ic=this;return No(function*(){if(wb){var Oa=[];wb.forEach(Cb=>{Oa.push({K:Cb[$e.kya],P:Cb[$e.qPc],ID:Cb[$e.XXh],V:null})});rd(ic.$.pa.ta,Oa,2,Cb=>{!Cb||0<Cb.Errors.length?Q.ULS.sendTraceTag(509743360,0,10,`PowerQueryUIFlowManager:ResolveChallenge: success callback failure: ${Cb.Result}`):(1<wb.length&&Q.ULS.sendTraceTag(509649952,0,10,"PowerQueryUIFlowManager:ResolveChallenge: commit result array contains more than one result"),ic.im.IRc(ta,!0),Q.ULS.sendTraceTag(509613445,
0,20,`PowerQueryUIFlowManager:ResolveChallenge: Write Roaming succeeded, challenge resolved.
          Kind: ${wb[0][$e.kya]}`),ic.s6k({kind:wb[0][$e.kya],path:wb[0][$e.qPc],queryName:ta}),ic.p_k())},()=>{Q.ULS.sendTraceTag(509743330,0,10,`PowerQueryUIFlowManager:ResolveChallenge: Write Roaming failed,
          Kind: ${wb[0][$e.kya]}`)},null,null)}else Q.ULS.sendTraceTag(509691530,0,10,"PowerQueryUIFlowManager:ResolveChallenge: commit result null")})}}};aa=Object(M.__decorate)([Object(D.d)(J.Fe),Object(M.__param)(0,Object(J.Lb)()),Object(M.__param)(1,Object(J.De)())],aa);Object(C.a)(aa,"PowerQueryUIFlowManager",null,[39,2]);var Ja=a(9),tb=a(894);class S extends tb.a{constructor(ta){super(ta)}Qs(){ua.TaskExtensions.Ua(ha.GetServiceTaskFactory.Bj(this.$.ka,16,74,this.hh),ta=>{this.cr([new Fd(this.$,
ta.result)])},this.xa,3)}static Aa(ta){tb.a.sx(75,new S(ta))}}Object(C.a)(S,"FieldListCommandHandlerFactory",tb.a,[]);var Wa=a(420);class zb extends Wa.a{constructor(ta){super();this.$=ta;this.Bl()}create(){void D.a.resolve(J.qb,{va:1}).then(ta=>{ta=le.create(this.$,-1,ta);this.Yj(ta)})}dispose(){this.$=null;super.dispose()}static Aa(ta){ta.ka.ph(110,new zb(ta))}}Object(C.a)(zb,"FieldListRequestStateFactory",Wa.a,[]);var hc=a(480);class cd extends Wa.a{constructor(ta){super();this.$=ta;this.Bl()}create(){const ta=
hc.a(this.$),wb=Object(Wb.d)(D.a.resolve(J.qb,{va:this.hh})),ic=Object(Wb.d)(D.a.resolve(J.ac,{va:this.hh}));ua.TaskExtensions.Ua(ua.TaskExtensions.Ln([ta,wb,ic],this.xa),()=>{const Oa=rc.c6e(this.$,ta.result,wb.result,ic.result);Oa&&Oa.Mkg();this.Yj(Oa)},this.xa,3)}dispose(){this.$=null;super.dispose()}static Aa(ta){ta.ka.ph(74,new cd(ta))}}Object(C.a)(cd,"FieldManagerTaskPaneFactory",Wa.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.InsertPivotTable");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PivotCommand");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PowerQuery");Type.registerNamespace("_Ewa");R.a.gw(".ewa-insertpt-dlg-input{position:relative;width:50%;padding-left:3px}.ewa-insertpt-dlg-label{margin-left:50px;margin-right:5px}.ewa-insertpt-label{vertical-align:text-top}.ewa-insertpt-dlg-sourceRange{white-space:nowrap}");R.a.gw('.ewa-ptsp-pane{background:#edebe9;height:100%;display:flex;flex-direction:column;overflow:hidden}.ewa-ptsp-header{position:relative;overflow:hidden;padding:16px;background:#edebe9}.ewa-ptsp-title{position:relative;display:inline-block;text-overflow:ellipsis;overflow:hidden;height:22px;font-weight:normal;font-size:16px;color:#252423;font-family:"Segoe UI Semibold","Segoe UI Web Semibold","Arial Semibold","Verdana Semibold","sans-serif Semibold";background:#edebe9}.ewa-ptsp-body{background:#edebe9;padding:0 16px;height:100%;display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;overflow-y:auto;overflow-x:hidden}.ewa-ptsp-close-button{display:inline-block;padding:1px;font-size:16px}.ewa-filterconnections-dlg-hr{margin:8px -14px 0 -14px;border:none;height:1.5px;background-color:#e1e1e1}.ewa-filterconnections-dlg-table{border-spacing:1px}.ewa-filterconnections-dlg-table thead tr{display:block;cursor:default;pointer-events:none}.ewa-filterconnections-dlg-table tbody{border:1px solid #e1e1e1;display:block;max-height:120px;overflow-y:auto}.ewa-filterconnections-dlg-table td{text-align:left;width:100px}.ewa-filterconnections-dlg-table tbody tr{display:block}.ewa-filterconnections-dlg-level{width:20px}.ewa-filterconnections-dlg-column{width:100px}');
R.a.gw('.ewa-pqtp-pane{height:100%;display:flex;flex-direction:column;overflow:hidden;background-color:#f5f5f5}.ewa-pqtp-header{position:relative;overflow:hidden;padding:16px}.ewa-pqtp-title{height:22px;display:inline-block;color:#252423;font-size:16px;font-family:"Segoe UI Semibold","Segoe UI Web",Arial,Verdana,sans-serif}.ewa-pqtp-body{height:100%;display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;overflow-x:hidden;overflow-y:auto}.ewa-pqtp-close-button{height:22px;width:22px;color:#252423;display:inline-block}.ewa-pqtp-close-button .clip16x16{top:2px;left:2px}');
(()=>{Ja.a.Qg(ta=>{if(!na.EwaSettings.kSd()){const wb=Object(Wb.d)(D.a.resolve(J.Cf,{va:1})),ic=Object(Wb.d)(D.a.resolve(J.qb,{va:1})),Oa=Object(Wb.d)(D.a.resolve(Gb.m,{va:1}));ua.TaskExtensions.Ua(ua.TaskExtensions.Ln([wb,ic,Oa],ta.xa),()=>{const Cb=wb.result,yc=ic.result,Nc=Oa.result;na.EwaSettings.G5()?void D.a.resolve(J.w):qb.Aa(ta,Cb,yc,Nc)},ta.xa)}})})();(()=>{Ja.a.Qg(ta=>{J.ac.Ha()||(cd.Aa(ta),zb.Aa(ta),S.Aa(ta))})})();String(c);String(b);String(f);String(r);String(d);String(k);String(t);String(m);
String(e);String(w);String(l);String(u);String(n);String(v);String(B);String(z);window.___1708742503361_closurehack=c;window.___1708742503361_closurehack=b;window.___1708742503361_closurehack=f;window.___1708742503361_closurehack=r;window.___1708742503361_closurehack=d;window.___1708742503361_closurehack=k;window.___1708742503361_closurehack=t;window.___1708742503361_closurehack=m;window.___1708742503361_closurehack=e;window.___1708742503361_closurehack=w;window.___1708742503361_closurehack=l;window.___1708742503361_closurehack=
u;window.___1708742503361_closurehack=n;window.___1708742503361_closurehack=v;window.___1708742503361_closurehack=B;window.___1708742503361_closurehack=z}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.bi.js.map/c0cd44cd6170dfc87974b817e4611ba1/EwaTS.bi.js.map