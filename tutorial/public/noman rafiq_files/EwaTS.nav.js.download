'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[14],{1460:function(y,x,a){x=a(476);a=a(1461);a=a.kv?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);x(a,{insert:"head",AC:!1});y.exports=a.oH||{}},1461:function(y,x,a){x=a(477)(!1);x.push([y.i,".FindDialog .ewa-dlg-body-sectionlabel{margin-bottom:5px}.FindDialog .ewa-dlg-body-fullLine{width:350px}.FindDialog input[type=text]{width:350px}.FindDialog .ReplaceResultLabel{color:#2db932}.FindDialog .ReplaceResultLabelForFindAll{width:358px;height:auto;background:#dff6dd;border-radius:0}.FindDialog .FindUserAlertLabel{color:#d90000;margin-top:16px}.FindDialog .FindUserAlertLabelForFindAll{background:#fde7e9;border-radius:0;height:auto;width:358px}.FindDialog .FindUserInfoLabelForFindAll{border-radius:0;height:auto;width:358px}.FindDialog .FindUserAlertLabelForFindAllWrapper{padding-top:10px;padding-bottom:10px;display:inline-flex}.ewa-dlg-elements-container-ltr .FindDialog .FindUserAlertLabelForFindAllWrapper{padding-left:7px}.ewa-dlg-elements-container-rtl .FindDialog .FindUserAlertLabelForFindAllWrapper{padding-right:7px}.FindDialog .Collapsed{visibility:hidden;height:0}.ewa-dlg-elements-container-ltr .FindDialog .ChevronDivIdRotated{transform:rotate(90deg) scale(1.2)}.ewa-dlg-elements-container-rtl .FindDialog .ChevronDivIdRotated{transform:rotate(270deg) scale(1.2)}.FindDialog .ChevronStart{transform:rotate(180deg) scale(1.2)}.FindDialog .AdvancedOptionsContainer{display:flex;justify-content:space-between}.FindDialog .CollapsedAdvancedOptionsContainer{height:1px}.FindDialog .SearchOptionsContainer{display:flex;align-items:center;margin-bottom:8px;margin-top:8px}.FindDialog .SearchOptionsLabel{margin-top:0;margin-bottom:0;font-size:14px;cursor:pointer;padding-top:1px;padding-bottom:1px}.ewa-dlg-elements-container-ltr .FindDialog .SearchOptionsLabel{margin-left:7px}.ewa-dlg-elements-container-rtl .FindDialog .SearchOptionsLabel{margin-right:7px}.FindDialog .AdvancedOptionsDropdowns{display:flex;justify-content:space-between}.FindDialog .DropdownWithLabel{flex:0 0 50%}.ewa-dlg-elements-container-ltr .FindDialog .DropdownWithLabel{margin-right:2px}.ewa-dlg-elements-container-rtl .FindDialog .DropdownWithLabel{margin-left:2px}.FindDialog .FindAllTableHeader{width:358px;height:28px;background:#e9f5ee;display:block;font-size:12px;color:#252423}.FindDialog .FindAllTableHeader tr{width:inherit;height:inherit;margin:0;padding:0}.FindDialog .FindAllTableHeader th{border-bottom:1px solid #fff;padding-top:5px;padding-bottom:0;margin:0;height:auto}.ewa-dlg-elements-container-ltr .FindDialog .FindAllTableHeader th{text-align:left;padding-left:8px;border-right:1px solid #fff}.ewa-dlg-elements-container-rtl .FindDialog .FindAllTableHeader th{text-align:right;padding-right:8px;border-left:1px solid #fff}.FindDialog .FindAllTableBody{display:block;overflow-y:auto;overflow-x:hidden;height:auto;max-height:168px;width:358px}.FindDialog .FindAllRow:hover{background-color:#f3f3f3}.FindDialog .FindAllRow{width:358px;height:28px;background:#faf9f8;border-bottom:1px solid #fff}.FindDialog .FindAllTableData{font-size:12px;color:#252423;padding-top:5px}.ewa-dlg-elements-container-ltr .FindDialog .FindAllTableData{padding-left:8px;border-right:1px solid #fff}.ewa-dlg-elements-container-rtl .FindDialog .FindAllTableData{padding-right:8px;border-left:1px solid #fff}.FindDialog .FindAllTableDataSheetName{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:67px}.FindDialog .FindAllTableDataCell{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:54px}.FindDialog .FindAllTableDataValue{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:182px}.FindDialog ::-webkit-scrollbar{width:8px;height:auto}.FindDialog ::-webkit-scrollbar-track{background:#faf9f9;border-radius:10px}.FindDialog ::-webkit-scrollbar-thumb{background:#c6c6c6;height:30px;width:8px;border-radius:4px}.ewa-dlg-buttonarea.FindDialog{display:flex;flex-wrap:wrap;justify-content:flex-end;max-width:358px}.FindDialog .ewa-dlg-button{max-width:79px}",
""]);y.exports=x},1462:function(y,x,a){x=a(476);a=a(1463);a=a.kv?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);x(a,{insert:"head",AC:!1});y.exports=a.oH||{}},1463:function(y,x,a){x=a(477)(!1);x.push([y.i,'.ewa-stp-pane{height:100%;display:flex;flex-direction:column;overflow:hidden;background:#edebe9}.ewa-stp-header{position:relative;overflow:hidden;padding:16px;background:#edebe9}.ewa-stp-body{height:100%;display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;overflow-y:auto;overflow-x:hidden;background:#edebe9}.ewa-stp-title{height:22px;font-weight:400;position:relative!important;max-width:230px;display:inline-block;text-overflow:ellipsis;overflow:hidden;font-size:16px;font-family:"Segoe UI Semibold","Segoe UI Web Semibold","Arial Semibold","Verdana Semibold","sans-serif Semibold";background:#edebe9;color:#252423}.ewa-stp-close-button{margin:auto;margin-right:0;margin-top:3px}',
""]);y.exports=x},394:function(y,x,a){a.r(x);var c={};a.r(c);a.d(c,"CtrlArrowCommandHandler",function(){return xa});var b={};a.r(b);a.d(b,"FindCommandHandler",function(){return Wc});var f={};a.r(f);a.d(f,"GotoCommandHandler",function(){return Kb});var r={};a.r(r);a.d(r,"ShareSectionCommandHandler",function(){return Nd});var d={};a.r(d);a.d(d,"SmartSelectionCommandHandler",function(){return xd});var k={};a.r(k);a.d(k,"SpellCheckCommandHandler",function(){return Tc});var t={};a.r(t);a.d(t,"ViewportHelpers",
function(){return Bd});var m={};a.r(m);a.d(m,"FindOperationsCache",function(){return Fd});var e=a(179),w=a(0),l=a(14),u=a(688);class n{constructor(dc,Uc,kb,rb,cc){this.originCell=this.originRange=null;this.direction=0;this.edgeCell=null;this.shouldExtend=!1;this.originCell=dc;this.originRange=Uc;this.direction=kb;this.edgeCell=rb;this.shouldExtend=cc}getEdgeCell(){return this.edgeCell}}Object(w.a)(n,"MacroRecorderMoveToEdgePayload",null,[65]);var v=a(45),B=a(419),z=a(212),C=a(10),D=a(26),J=a(24);
const W=(dc,Uc,kb,rb)=>{var cc=Q(dc.direction);if(dc.extend&&!Uc.isSingle){const mc=Uc.JX(cc)===kb.JX(cc);let Sa=cc;2===cc?Sa=1:4===cc&&(Sa=3);mc?kb.eqa(Sa,Uc.sQb(cc)):kb.eqa(Sa,Uc.JX(cc));kb=kb.topLeft}Uc=J.f(rb).kh(kb);if(null===Uc||void 0===Uc?0:Uc.kH)switch(cc=Uc.range.JX(cc),dc.direction){case 1:case 3:kb.top=cc;break;case 4:case 2:kb.left=cc}return v.p(kb,rb)},N=(dc,Uc,kb)=>{var rb=v.F(dc);switch(Uc){case 1:rb.top=1;break;case 3:rb.bottom=C.a.gl;break;case 4:rb.left=1;break;case 2:rb.right=
C.a.Qk}dc=null;rb=kb.ot("CtrlArrowCommandHandler.TryGetEdgeCellLocally",rb,3===Uc||1===Uc?2:1,2===Uc||3===Uc);try{if(!rb.$$mn())return null;let cc=rb.$$cu();if(cc.text){if(!rb.$$mn())return null;cc=rb.$$cu();if(cc.text)for(;rb.$$mn();){if(!rb.$$cu().text){dc=cc.range;break}cc=rb.$$cu()}else for(;rb.$$mn();)if(cc=rb.$$cu(),cc.text){dc=cc.range;break}}else for(;rb.$$mn();)if(cc=rb.$$cu(),cc.text){dc=cc.range;break}const mc=cc.cell.zF.Kq;if(dc)return v.w(dc,kb.$);if(!rb.$$cu()&&cc&&(1===Uc&&!mc.Y||4===
Uc&&!mc.X))return v.w(cc.range,kb.$)}finally{rb&&rb.dispose()}return null},M=dc=>{switch(dc){case 1:return 16;case 3:return 32;case 4:return 4;case 2:return 8;default:return l.ULS.shipAssertTag(537163588,0,!1,"CtrlArrowCommandHandler.GotoRangePositioningFromDirection: unknown direction"),60}},Q=dc=>{let Uc=0;switch(dc){case 1:Uc=1;break;case 3:Uc=2;break;case 4:Uc=3;break;case 2:Uc=4}return Uc};var R=a(62);const O=(dc,Uc,kb,rb,cc,mc,Sa,pb)=>{pb=dc.Za(1,void 0===pb?null:pb);pb.activeCell=Uc;pb.direction=
kb;return R.h(dc,"GetEdgeCell",pb,rb,cc,mc,Sa,4)};var U=a(35),K=a(209),F=a(262),I=a(66),P=a(427);class Y{constructor(dc,Uc){this.Fgh=dc;this.S8c=Uc}get direction(){return this.Fgh}get extend(){return this.S8c}Gxf(){return 2===this.direction?new Y(4,this.extend):4===this.direction?new Y(2,this.extend):this}}Object(w.a)(Y,"CtrlArrowCommandParams",null,[]);var ea=a(97),Ba=a(5),Fa;let za,xa=Fa=class{constructor(dc){this.$=dc}Bi(){return!1}executeCommand(dc,Uc){dc=Uc.command;if(!Fa.Lxd.Vg(dc))return K.a(dc);
let kb=Fa.Lxd.ma(dc);const rb=J.f(this.$);dc=rb.ha;rb.rtl&&(kb=kb.Gxf());const cc=rb.isEditing||rb.Pp,mc=cc?dc.rangePicker.nHd(!0):dc.qa.activeRange,Sa=cc?dc.rangePicker.activeCell:dc.qa.activeCell,pb=W(kb,mc,Sa.clone(),this.$);let Ac=N(pb,kb.direction,rb);const yd=v.w(mc,this.$),vb=()=>new n(pb,yd,kb.direction,Ac,kb.extend);if(Ac)return l.ULS.sendTraceTag(537163593,0,50,"CtrlArrowCommandHandler.ExecuteCommand: GetEdgeCell succeeded in client side"),this.NLf(Ac,kb,mc.clone(),Sa.clone(),rb),this.$.hwg(new u.a(119,
vb())),I.Task.Va(!0);const Sc=hd=>{Ac=hd.Result};return B.a(this.$.userOperationManager,(hd,qc,Lc)=>O(this.$.pa.ta,pb,kb.direction,F.c(Sc,hd,bd=>{this.G0i(bd,kb,mc.clone(),Sa.clone(),rb)}),qc,Lc,null),hd=>new z.a(119,0,hd,16,vb),Uc)}ni(dc,Uc){return Fa.Lxd.Vg(Uc.command)}Ji(){return!1}G0i(dc,Uc,kb,rb,cc){!U.a.rx(dc.Errors)&&dc.Result&&(dc=dc.Result,l.ULS.sendTraceTag(537163592,0,50,"CtrlArrowCommandHandler.HandleGetEdgeCellSuccess"),this.NLf(dc,Uc,kb,rb,cc))}NLf(dc,Uc,kb,rb,cc){var mc=v.G(dc);if(Uc.extend){Uc=
Uc.direction;dc=J.f(this.$);cc=null;if(!kb.isSingle){var Sa=Q(Uc);if(rb.JX(Sa)===kb.JX(Sa))switch(cc=rb.clone(),Uc){case 1:case 3:cc.Nri(kb);break;case 4:case 2:cc.zvf(kb)}}cc||(cc=kb);cc.union(mc);dc.ha.Du=0;dc.ha.updateSelection(cc,null,0,3);Sa=!cc.isRow&&(2===Uc||4===Uc);const pb=!cc.fk&&(1===Uc||3===Uc);if((kb.isSingle||!(1!==Uc&&3!==Uc||rb.top!==kb.top&&rb.bottom!==kb.bottom)||!(4!==Uc&&2!==Uc||rb.left!==kb.left&&rb.right!==kb.right))&&(Sa||pb)){kb=cc;l.ULS.shipAssertTag(537163590,0,kb.contains(rb),
"CtrlArrowCommandHandler.GetOppositeEdgeCellOfActiveRange: the active range doesn't contain the active cell");kb.isSingle?rb=kb:(Uc=0,rb.top===kb.top?Uc=1:rb.bottom===kb.bottom&&(Uc=2),Sa=0,rb.left===kb.left?Sa=3:rb.right===kb.right&&(Sa=4),rb=D.Range.gi(0===Uc?rb.top:kb.sQb(Uc),0===Sa?rb.left:kb.sQb(Sa)));if(cc.fk||cc.isRow)rb=mc;dc.gD(rb,60,"CtrlArrowCommandHandler.ExtendToEdge",!0)}}else mc=M(Uc.direction),Fa.fFj(dc,cc,mc)}static fFj(dc,Uc,kb){let rb;switch(Uc.ha.Du){case 1:rb=3;break;case 2:rb=
1;break;default:rb=0}Uc.To(dc,null,null,null,kb,"CtrlArrowCommandHandler.MoveToEdge",rb)}};xa.Lxd=(za=new P.a,za.add(-1297307319,new Y(3,!0)),za.add(105288353,new Y(1,!0)),za.add(-403586027,new Y(4,!0)),za.add(784916030,new Y(2,!0)),za.add(1713663844,new Y(3,!1)),za.add(542791952,new Y(1,!1)),za.add(-2012742350,new Y(4,!1)),za.add(1324884057,new Y(2,!1)),za);xa=Fa=Object(e.__decorate)([Object(ea.d)(Ba.jb),Object(e.__param)(0,Object(Ba.Lb)())],xa);Object(w.a)(xa,"CtrlArrowCommandHandler",null,[39]);
var fa=a(40);class V{constructor(){this.tIc=!1;this.N2f=this.uIc=null;this.sZd=this.rZd=!1;this.A1a=null}}Object(w.a)(V,"FindDialogState",null,[555]);var ba=a(12),la=a(77);class Ta{constructor(dc,Uc){this.selectedRanges=this.findData=null;this.findData=dc;this.selectedRanges=Uc}owa(){return this.findData}}Object(w.a)(Ta,"MacroRecorderFindAllPayload",null,[65]);class Ea extends Ta{constructor(dc,Uc,kb){super(dc,Uc);this.activeCell=null;this.activeCell=kb}getActiveCell(){return this.activeCell}}Object(w.a)(Ea,
"MacroRecorderFindCellPayload",Ta,[]);var sa=a(527);const Ya=(dc,Uc,kb,rb,cc,mc,Sa,pb,Ac,yd)=>{const vb=dc.Za(1);vb.findData=Uc;vb.replaceWith=cc;vb.activeCell=kb;vb.selectedRanges=rb;vb.isSingle=mc;return R.h(dc,"ReplaceAll",vb,Sa,pb,Ac,yd,0)};var bb=a(16),ra=a(252),Da=a(1),oa=a(27),Ha=a(194),ka=a(387),wa=a(47),Za=a(961);class ab{constructor(dc,Uc,kb,rb,cc){this.selectedRanges=this.activeCell=this.replaceWith=this.findData=null;this.isSingle=!1;this.findData=dc;this.replaceWith=Uc;this.activeCell=
kb;this.selectedRanges=rb;this.isSingle=cc}owa(){return this.findData}getActiveCell(){return this.activeCell}}Object(w.a)(ab,"MacroRecorderReplaceAllPayload",null,[65]);var db=a(161),mb=a(98),Ia=a(151),pa=a(150),lb=a(918),ha=a(93),ua=a(79);class fb{constructor(dc,Uc,kb,rb){this.findData=dc;this.stateID=Uc;this.uga=kb;this.activeCell=rb;performance.now()}equals(dc){if(!dc)return!1;const Uc=JSON.stringify(this.findData,this.filter),kb=JSON.stringify(dc.findData,this.filter);return!(this.stateID!==dc.stateID||
this.uga!==dc.uga||!this.activeCell.equals(dc.activeCell)||Uc!==kb)}filter(dc,Uc){if("IsNamedObject"!==dc&&"SearchUp"!==dc&&"ReplaceWholeWordOnly"!==dc&&"SearchStrings"!==dc&&"operationTimestamp"!==dc)return Uc}}Object(w.a)(fb,"FindDataParameters",null,[]);var Ka;(function(dc){dc.Info="Info";dc.Error="Error";dc.Success="Success";dc.Warning="Warning"})(Ka||(Ka={}));Object(w.b)("UserMessageType",Ka);class La{}Object(w.a)(La,"FindResultData",null,[]);class ib extends Za.a{constructor(dc,Uc,kb,rb,cc,
mc){super(dc);this.iN=cc;this.WXa=mc;this.findWithinSelection="Selection";this.findWithinSheet="Sheet";this.findWithinWorkbook="Workbook";this.sHj=mb.a.zm(ba.a.instance.ia(51));this.qqk=mb.a.zm(ba.a.instance.ia(31));this.kui=mb.a.zm(ba.a.instance.$g(97));this.jui=mb.a.zm(ba.a.instance.$g(98));this.emk=mb.a.zm(ba.a.instance.$g(100));this.fmk=mb.a.zm(ba.a.instance.$g(96));this.kDg=mb.a.zm(ba.a.instance.Ba(23));this.uQh=mb.a.zm(ba.a.instance.Ba(22));this.dmk=mb.a.zm(ba.a.instance.ia(63));this.tmk=mb.a.zm(ba.a.instance.ia(64));
this.EEd=mb.a.zm(ba.a.instance.ia(53));this.NWb=this.lZd=null;this.GEd=(Sa,pb)=>{this.findText=pb.findText;this.s5a=pb.replaceText;this.jra=pb.withinOption;this.lCa=pb.matchCase;this.mCa=pb.matchEntireCell;this.SearchUp=pb.searchUp;this.Nrd();0==Sa&&(this.$.ih.D0a=!1,this.$.ih.GF=!1,this.XY(0,"Cancel"),Ia.b(this.$).ZUg("FindAndReplaceDialogCorrelation"))};this.rui=(Sa,pb,Ac,yd)=>{this.findText=pb.findText;this.s5a=pb.replaceText;this.jra=pb.withinOption;this.lCa=pb.matchCase;this.mCa=pb.matchEntireCell;
this.SearchUp=pb.searchUp;this.Yzk=Ac;this.Nrd();if(1==Sa)if(this.operation=1891435765,this.Lic=149,Ha.a.current.cZ="Find Next",this.XY(1,"Find Next"),this.uTc(pa.a.findNext),Da.EwaSettings.raa()){const {Owf:vb,oui:Sc,qwc:hd}=this.KPi(this.uga());vb?hd&&this.DZi(hd):(Da.EwaSettings.C0()&&this.iN.xJa(lb.a.findNext),this.WXa.set(Sc,void 0),this.NDc(Ac,yd,Sc))}else Da.EwaSettings.C0()&&this.iN.xJa(lb.a.findNext),this.NDc(Ac,yd);else 2==Sa?(this.operation=788780084,this.Lic=205,this.XY(2,"Find all"),
this.uTc(pa.a.findAll),Da.EwaSettings.raa()?(Sa=this.khf(this.uga()),this.NDc(Ac,yd,Sa)):this.NDc(Ac,yd)):3==Sa?(this.dHa(!0),this.operation=1059985902,this.XY(3,"Replace"),this.uTc(pa.a.umk),this.yVj(Ac,yd)):(this.dHa(!0),this.XY(4,"Replace all"),this.uTc(pa.a.replaceAll),this.y6g(!1,Ac,yd),Ac=this.hji(),l.ULS.sendTraceTag(509620555,0,50,`FindAndReplaceDialog EstimateReplaceAll count = ${Ac}`))};this.GOj=Sa=>{this.jvk(Sa.Cell)};this.t7k=Sa=>{this.RNg=Sa;this.n1c(this)};this.N$i=Sa=>{this.setFocusCallback=
Sa};this.$Wb=()=>{this.$.ea.gk!==C.a.kk&&this.$.ea.Ph&&this.sij()&&this.Yzk(this.qqk,Ka.Info)};this.n1c=()=>{const Sa=ib.ZTd(this.$);Sa&&(this.jra=this.findWithinSelection);null!=this.RNg&&this.RNg(Sa);this.aD.A1a||(this.aD.A1a=this.findWithinSelection);Sa||this.aD.A1a!==this.findWithinSelection||(this.aD.A1a=this.findWithinSheet);this.jra||(this.jra=this.aD.A1a)};this.aD=kb;this.PD=J.f(this.$);this.Ah=rb;this.operation=1461300262;this.Lic=205;this.IEe=null;this.Bh=13;this.Yh(1,ba.a.instance.ia(41));
this.Yh(2,ba.a.instance.ia(27));this.Yh(3,ba.a.instance.ia(60));this.Yh(4,ba.a.instance.ia(61));this.fq();this.lCa=this.aD.rZd;this.mCa=this.aD.sZd;this.SearchUp=this.aD.tIc;this.findText=void 0!=Uc?Uc:this.aD.uIc;this.s5a=this.aD.N2f;this.n1c(this);this.jra=this.aD.A1a;this.keb={["withinOption"]:this.jra,["findText"]:this.findText,["matchCase"]:this.lCa,["matchEntireCell"]:this.mCa,["replaceText"]:this.s5a,["searchUp"]:this.SearchUp,["isFindTab"]:1540292897===rb.command||1891435765===rb.command||
788780084===rb.command?!0:!1,["isEditMode"]:this.$.isEditMode,["disableAllButtons"]:!1};this.Tu={["id"]:this.ki,["updateWithinOptions"]:this.t7k,["initializeFocusCallback"]:this.N$i,["onFindAllRowResultClick"]:this.GOj,["findDialogResultHandler"]:this.rui,["isModal"]:!1,["bodyProps"]:this.keb};this.$.ih.D0a=!0;this.initializeAndShow(this.EEd,this.GEd,this.Tu);this.$.ea&&this.$.ea.EL(this.$Wb);Ia.b(this.$).nUg("FindAndReplaceDialogCorrelation")}static getInstance(dc,Uc,kb,rb,cc,mc){return this.Wa||
(this.Wa=new this(dc,Uc,kb,rb,cc,mc))}BDk(dc){this.Rub();const Uc=Object.assign({},this.keb);Uc.isFindTab=1540292897==dc||1891435765==dc||788780084==dc;this.Tu.bodyProps=Uc;this.NPa(this.EEd,this.dZa(this.GEd),this.Tu)}TJ(){this.$.ih.D0a=!1;this.$.ih.GF=!1;this.ih.q3b(this);this.dispose()}get ki(){return"FindAndReplaceDialog"}get da(){return this.PD}dispose(){this.$o();this.da.rh.Vs(null,ib.nwc);this.$.ea&&this.$.ea.TM(this.$Wb);this.$.ih.D0a=!1;ib.Wa=null;Da.EwaSettings.isChangeGateEnabled("OfficeVSO:8511408_showSharedCustomDialogCrashTelemetry")&&
l.ULS.sendTraceTag(507835858,0,50,"FindAndReplaceDialog.dispose: FindAndReplaceDialog is disposed");super.dispose()}setFocus(){this.setFocusCallback?this.setFocusCallback():l.ULS.sendTraceTag(523245012,0,50,"FindAndReplaceDialog.setFocus: setFocusCallback not initialized")}uTc(dc){const Uc={["FindWithinValue"]:this.jra,["MatchCase"]:this.lCa,["MatchEntireCell"]:this.mCa,["FindDirection"]:this.SearchUp?"Up":"Down",["NumberOfSelectedRanges"]:this.da.ha.qa.aS,["Location"]:"dialog"};Ia.b(this.$).lj(dc,
Uc,null,!0)}hji(){if((new db.a(this.$.sa)).Dn)return 0;const dc=this.findText,Uc=this.s5a,kb=!this.lCa;var rb=this.uga();let cc=0,mc=0,Sa=0;rb=this.da.ot("FindAndReplaceDialog.EstimateReplaceAll",rb?this.da.ha.qa.Ui:v.g());try{for(;rb.$$mn();){const pb=this.da.kh(rb.mu.getRange());let Ac=!1;Sa++;cc+=(()=>{let yd=this.Uqf(pb,dc,Uc,kb,this.mCa);({estimated:Ac}=yd);return yd})().returnValue;Ac&&(mc+=mc)}}finally{rb&&rb.dispose()}l.ULS.sendTraceTag(509620554,0,50,`EstimateReplaceAll, We could have replaced - ${cc}, but we only replaced ${mc} out of ${Sa} cells. ${mc/
cc*100}% estimation success. ${100*(cc-mc)/Sa}% noticeable estimation failure`);return mc}dHa(dc){const Uc=Object.assign({},this.keb);Uc.disableAllButtons=dc;this.Tu.bodyProps=Uc;this.NPa(this.EEd,this.dZa(this.GEd),this.Tu)}yVj(dc,Uc){this.Nrd();const kb=this.owa();this.lZd=kb;l.ULS.sendTraceTag(523882654,0,50,`FindAndReplace Dialog 'Replace' was clicked, MatchCase: ${kb.MatchCase}, MatchEntireCell: ${kb.MatchEntireCell}, , SearchAllSheets: ${kb.SearchAllSheets}.`);const rb=this.findText,cc=this.s5a,
mc=this.da.kh(this.da.ha.qa.activeCell);if(mc){var Sa=!1,pb=(()=>{let Ac=this.Uqf(mc,rb,cc,!this.lCa,this.mCa);({qOa:Sa}=Ac);return Ac})().returnValue;pb||Sa?this.y6g(!0,dc,Uc):(l.ULS.sendTraceTag(523882652,0,50,`FindAndReplace Dialog - current cell does not contain the requested value to replace, finding next cell, MatchCase: ${kb.MatchCase}, MatchEntireCell: ${kb.MatchEntireCell}, , SearchAllSheets: ${kb.SearchAllSheets}.`),dc(this.Rnd(this.tmk,pb,!0),Ka.Error),this.dHa(!1))}else l.ULS.sendTraceTag(523882653,
0,50,"FindAndReplace - failed getting current active cell."),this.dHa(!1)}y6g(dc,Uc,kb){if(this.da){var rb=this.uga()?this.da.ha.qa.Ui:this.da.ha.qa.activeCell,cc=v.p(this.da.ha.qa.activeCell,this.$),mc=v.r(rb,this.$),Sa=this.$.pa.ta,pb=this.owa();this.lZd=pb;var Ac=this.s5a;l.ULS.sendTraceTag(523882650,0,50,`WebServiceReplaceAll, isSingle: ${dc}, MatchCase: ${pb.MatchCase}, MatchEntireCell: ${pb.MatchEntireCell}, , SearchAllSheets: ${pb.SearchAllSheets}.`);var yd=()=>new ab(pb,Ac,cc,mc,dc);B.a(this.$.userOperationManager,
(vb,Sc,hd)=>this.zdj(Sa,pb,cc,mc,Ac,dc,vb,Sc,hd,Uc,kb),vb=>new z.a(148,0,vb,void 0,yd),this.Ah)}else this.dHa(!1)}Uqf(dc,Uc,kb,rb,cc){let mc,Sa;var pb=0;Sa=mc=!1;if((new db.a(this.$.sa)).Dn)return{returnValue:0,estimated:mc,qOa:Sa};if(!dc)return l.ULS.sendTraceTag(523882649,0,50,"EstimateReplaceSingleCell - currentCell == null"),{returnValue:0,estimated:mc,qOa:Sa};if(!oa.a.qm(dc.text)){if(dc.iC)return l.ULS.sendTraceTag(523882648,0,50,"EstimateReplaceSingleCell - cell has a formula so we can not estimate"),
Da.EwaSettings.isChangeGateEnabled("OfficeVSO:4230178_ServerRoundTripIfFormula")&&(Sa=!0),{returnValue:0,estimated:mc,qOa:Sa};if(Da.EwaSettings.isChangeGateEnabled("OfficeVSO:4230178_NoReplaceInCellWithRichValue")&&0!==dc.cell.VNa)return l.ULS.sendTraceTag(523882647,0,50,"EstimateReplaceSingleCell - Replace in cells containing RichValues is not supported"),{returnValue:0,estimated:mc,qOa:!0};pb=dc.rxb;if(cc){if(oa.a.equals(pb,Uc,rb))return dc.text=kb,l.ULS.sendTraceTag(523882646,0,50,"EstimateReplaceSingleCell - matchEntireCell, the replace string is equal to the source string, we estimated the result without formatting (could flicker)"),
{returnValue:1,estimated:!0,qOa:Sa};l.ULS.sendTraceTag(523882645,0,50,"EstimateReplaceSingleCell - matchEntireCell, the replace string is not equal to the source string, we should not replace (this could be counted as a good guess or no replacement)");return{returnValue:0,estimated:mc,qOa:Sa}}pb=oa.a.Vef(pb,Uc,rb);cc=oa.a.Vef(dc.text,Uc,rb);if(ib.sSk(Uc))return{returnValue:0,estimated:mc,qOa:!0};pb===cc?(Uc=oa.a.ytb(dc.text,Uc,kb,rb),dc.text=Uc,l.ULS.sendTraceTag(523882644,0,50,"EstimateReplaceSingleCell - estimation with formatting"),
mc=!0):0<pb&&(l.ULS.sendTraceTag(523882643,0,50,"EstimateReplaceSingleCell - replacement will happen, but we did not estimate because we do not handle with the formatting (bad guess/no guess)"),mc=!1)}return{returnValue:pb,estimated:mc,qOa:Sa}}zdj(dc,Uc,kb,rb,cc,mc,Sa,pb,Ac,yd,vb){return Ya(dc,Uc,kb,rb,cc,mc,F.c(Sa,(Sc,hd)=>{this.xVj(Sc,hd,yd,vb)}),pb,Ac,mc)}xVj(dc,Uc,kb,rb){rb([],"");let cc=!1;if(!ra.a(dc)){let Sa="";var mc=dc.Result;dc=mc.ReplacedCount;mc=mc.SkippedReplacementsCount;0<mc&&(l.ULS.sendTraceTag(523882642,
0,50,`Invoke Replace, SkippedReplacementCount = ${mc}`),Sa=String.format(this.emk,dc.toString(),mc.toString()));mc||(Sa=String.format(this.fmk,dc.toString()));Uc&&0<dc?(cc=!0,this.findNext(kb,rb)):dc||mc?(Uc=this.Rnd(Sa,dc,Uc),kb(Uc,Uc===Sa?Ka.Success:Ka.Error)):kb(this.Rnd(this.dmk,dc,Uc),Ka.Error)}cc||this.dHa(!1)}findNext(dc,Uc){const kb=this.owa(),rb=this.uga();let cc;Da.EwaSettings.raa()&&(cc=new fb(kb,this.$.ea.pD,rb,ib.getActiveCell(this.$)));l.ULS.sendTraceTag(523882641,0,50,"FindNext, MatchCase: {1}, MatchEntireCell: {2}, , SearchAllSheets: {3}.",
kb.MatchCase,kb.MatchEntireCell,kb.SearchAllSheets);let mc=null;const Sa=yd=>{yd.Result&&ib.Rgg(yd,this.$,this,void 0,dc,Uc);this.dHa(!1)},pb=()=>{Uc([],"");this.dHa(!1);if(Da.EwaSettings.C0()){const yd=ea.a.Zg(Ba.Dg);null===yd||void 0===yd?void 0:yd.oY("web-method-error");null===yd||void 0===yd?void 0:yd.Pba(lb.a.findNext)}},Ac=(()=>{let yd=ib.fJd(this.$,kb,cc,rb,!1,this,!0,dc,Uc,Sa,pb);({nt:mc}=yd);return yd})().returnValue;B.a(this.$.userOperationManager,Ac,yd=>new z.a(147,0,yd,16,mc),this.Ah)}fq(){this.da&&
this.da.ha&&this.da.ha.VW(this.n1c)}$o(){this.da&&this.da.ha&&this.da.ha.UY(this.n1c)}sij(){return!!bb.DOMElementExtensions.getElementById(this.dj,"findAndReplaceScrollablePane")}NDc(dc,Uc,kb){let rb;if(!Da.EwaSettings.raa()){rb=this.owa();if(!rb){l.ULS.sendTraceTag(523882640,0,10,"cannot get find data, cannot call find cell operation");return}if(this.NWb){const mc=oa.a.equals(rb.SearchString,this.NWb.SearchString,!1)&&rb.MatchCase===this.NWb.MatchCase&&rb.MatchEntireCell===this.NWb.MatchEntireCell;
l.ULS.sendTraceTag(523882639,0,50,`FindNext - is find data changed between clicks? sameData=${mc}, stateId=${this.$.ea.gk}`)}this.NWb=rb}const cc=()=>{this.operation=1891435765;this.Lic=147};this.r_a(this.oJ,(()=>{let mc=ib.fJd(this.$,rb,kb,this.uga(),788780084===this.operation,this,!1,dc,Uc,cc);({nt:this.IEe}=mc);return mc})().returnValue,18,Da.EwaSettings.isChangeGateEnabled("OfficeVSO:8127880_FixingFindAndReplaceBlockingOps")?!1:this.Ega,!1)}get oJ(){return this.Lic}nt(){return this.IEe}uga(){return ib.ZTd(this.$)&&
oa.a.equals(this.jra,this.findWithinSelection,!1)}Nrd(){this.aD.uIc=this.findText;this.aD.tIc=this.SearchUp;this.aD.rZd=this.lCa;this.aD.sZd=this.mCa;this.aD.A1a=this.jra;this.aD.N2f=this.s5a}jvk(dc){const Uc=v.F(dc);if(dc=this.$.sa.getItemByName(dc.SheetName))dc=v.n(Uc,dc),this.da.To(dc,Uc,null,null,60,"FindDialog.SelectFindAllRowResult",void 0,void 0,void 0,void 0,!0)}owa(){const dc={};if(!this.$)return l.ULS.sendTraceTag(523882638,0,15,"FindAndReplaceDialog:EwaControl is null when trying to get find data"),
null;var Uc=ib.getActiveCell(this.$);Uc=Uc?v.p(Uc,this.$):null;!Uc||oa.a.qm(Uc.SheetName)?l.ULS.sendTraceTag(523882637,0,15,"could not find sheet name, Sheets/ActiveItem is null."):dc.SheetName=Uc.SheetName;dc.SearchString=this.findText;dc.MatchCase=this.lCa;dc.MatchEntireCell=this.mCa;dc.SearchAllSheets=!this.uga()&&this.jra===this.findWithinWorkbook;dc.SearchUp=this.SearchUp;dc.ExcludeFormulaResult=!1;return dc}static fJd(dc,Uc,kb,rb,cc,mc,Sa,pb,Ac,yd,vb,Sc){pb=void 0===pb?null:pb;Ac=void 0===Ac?
null:Ac;yd=void 0===yd?null:yd;vb=void 0===vb?null:vb;Sc=void 0===Sc?!1:Sc;const hd=Da.EwaSettings.raa()?kb.findData:Uc;Uc=Da.EwaSettings.raa()?kb.uga:rb;rb=J.f(dc);const qc=ib.getActiveCell(dc),Lc=v.p(qc,dc),bd=(Uc=Uc&&!!rb&&ib.ZTd(dc))?v.r(rb.ha.qa.Ui,dc):v.r(qc,dc);Da.EwaSettings.raa()&&Sa||(Uc=cc?Yd=>{ib.HOj(Yd,dc,mc,Ac)}:Yd=>{ib.Rgg(Yd,dc,mc,kb,pb,Ac)},yd=yd?Sc?F.c(Uc,yd):F.c(yd,Uc):Uc);let jd=vb;Da.EwaSettings.C0()&&Da.EwaSettings.raa()&&!Sa&&(Sa=cc?void 0:()=>{ib.IOj()},jd=jd?Sc?F.b(Sa,jd):
F.b(jd,Sa):Sa);oa.a.qm(hd.SheetName)&&(hd.SheetName=Lc.SheetName);return{returnValue:(Yd,te,oe)=>{if(cc){var Kd=dc.pa.ta;Yd=F.c(Yd,yd);te=jd?F.b(te,jd):te;var Ee=Kd.Za(1);Ee.findData=hd;Ee.selectedRanges=bd;oe=R.h(Kd,"FindAllV2",Ee,Yd,te,oe,dc,0)}else Kd=dc.pa.ta,Yd=F.c(Yd,yd),te=jd?F.b(te,jd):te,Ee=Kd.Za(1),Ee.findData=hd,Ee.activeCell=Lc,Ee.selectedRanges=bd,oe=R.h(Kd,"FindCellV2",Ee,Yd,te,oe,dc,0);return oe},nt:cc?()=>new Ta(hd,bd):()=>new Ea(hd,bd,Lc)}}static ZTd(dc){dc=J.f(dc).ha.qa;return dc.Gn&&
!dc.aya()}static IOj(){if(Da.EwaSettings.C0()){const dc=ea.a.Zg(Ba.Dg);null===dc||void 0===dc?void 0:dc.oY("web-method-error");null===dc||void 0===dc?void 0:dc.Pba(lb.a.findNext)}}static HOj(dc,Uc,kb,rb){Da.EwaSettings.isChangeGateEnabled("OfficeVSO:8511408_showSharedCustomDialogCrashTelemetry")&&l.ULS.sendTraceTag(507835857,0,50,"FindAndReplaceDialog.onFindAllWebMethodSuccess: FindAndReplaceDialog onFindAllWebMethodSuccess called.");if(ra.a(dc))l.ULS.shipAssertTag(523882634,0,!1,"FindAndReplaceDialog.OnFindAllWebMethodSuccess: EwaResult contains NonStatusMessages.");
else if(dc=dc.Result)if(dc.Results)if(dc.Results.length){const cc=Math.min(dc.Results.length,1E3);ib.k2h(dc,cc,kb,1E3<dc.Results.length,rb);ib.Y5i(dc,cc,Uc)}else rb(null,null);else l.ULS.shipAssertTag(523882632,0,!1,"FindAndReplaceDialog.OnFindAllWebMethodSuccess: findAllResult.Results is null");else l.ULS.shipAssertTag(523882633,0,!1,"FindAndReplaceDialog.OnFindAllWebMethodSuccess: findAllResult is null")}static Rgg(dc,Uc,kb,rb,cc,mc){Da.EwaSettings.isChangeGateEnabled("OfficeVSO:8511408_showSharedCustomDialogCrashTelemetry")&&
l.ULS.sendTraceTag(507835856,0,50,"FindAndReplaceDialog.onFindCellWebMethodSuccess: FindAndReplaceDialog onFindCellWebMethodSuccess called.");ra.a(dc)?(Ha.a.current.oJb("FindEndedWithErrors"),Da.EwaSettings.C0()&&Da.EwaSettings.raa()&&(Uc=ea.a.Zg(Ba.Dg),null===Uc||void 0===Uc?void 0:Uc.oY("web-method-error"),null===Uc||void 0===Uc?void 0:Uc.Pba(lb.a.findNext))):(dc=dc.Result)&&dc.SheetRange?(Da.EwaSettings.raa()&&rb&&kb&&kb.WXa.exists(rb)&&kb.WXa.set(rb,dc),(kb=J.f(Uc))&&ib.gLf(Uc,kb,dc)):(ib.x0i(kb,
Uc,cc,mc),Da.EwaSettings.raa()&&rb&&kb&&kb.WXa.delete(rb),Da.EwaSettings.C0()&&(Uc=ea.a.Zg(Ba.Dg),null===Uc||void 0===Uc?void 0:Uc.oY("business-logic-success"),null===Uc||void 0===Uc?void 0:Uc.Pba(lb.a.findNext)))}khf(dc){const Uc=this.owa();if(Uc)return new fb(Uc,this.$.ea.pD,dc,ib.getActiveCell(this.$))}KPi(dc){dc=this.khf(dc);const {czf:Uc,qwc:kb}=this.WXa.search(dc);return Uc?(l.ULS.sendTraceTag(507562189,0,20,`FindAndReplaceDialog.currentFindIdenticalToPreviousFind: FindNext - duplicate FindNext request - stateId:${dc.stateID}, findResults exist:${!!kb}`),
{Owf:!0,qwc:kb}):{Owf:!1,oui:dc}}DZi(dc){Da.EwaSettings.C0()&&this.iN.xJa(lb.a.findNext);ib.gLf(this.$,this.da,dc)}static gLf(dc,Uc,kb){var rb;const cc=v.G(kb.SheetRange),mc=kb.FoundInRichValue;Da.EwaSettings.C0()&&(null===(rb=ea.a.Zg(Ba.Dg))||void 0===rb?void 0:rb.oY("business-logic-success"));Uc.ha.qa.Gn&&Uc.ha.qa.Ui.contains(cc)?Uc.To(v.w(Uc.ha.qa.Ui,dc),cc,null,null,60,"FindDialog.OnFindCellWebMethodSuccess.CellWithinCurrentSelection",void 0,void 0,void 0,cc,!0):Uc.To(kb.SheetRange,cc,null,null,
60,"FindDialog.OnFindCellWebMethodSuccess.CellOutsideCurrentSelection",void 0,void 0,void 0,void 0,!0);Uc.za.Aaa(1,dc.na)&&Ha.a.current.Pba("FindEnded");oa.a.equals(dc.na.sheetName,kb.SheetRange.SheetName,!0)&&ib.Z5i(cc,dc);mc&&cc&&(l.ULS.sendTraceTag(523882630,0,50,"FindAndReplaceDialog.gotoFoundCell: FoundInRichValue"),sa.a(dc,243,242,0,Sa=>{Sa.G6b(cc.top,cc.left,1,!1,!1)}))}static Y5i(dc,Uc,kb){if(Uc){var rb=Array(Uc);for(let cc=0;cc<Uc;cc++){const mc=dc.Results[cc].SheetCell;l.ULS.shipAssertTag(523882629,
0,!!mc,"FindAndReplaceDialog.highlightFindAllResults: cell is null");const Sa=kb.sa.getItemByName(mc.SheetName);Sa&&(rb[cc]=new ka.a(v.F(mc),la.d(Sa)))}J.f(kb).rh.BP(rb,ib.nwc,!0)}}static Z5i(dc,Uc){J.f(Uc).rh.Vs(dc,ib.nwc);J.f(Uc).rh.rw(ib.nwc);Da.EwaSettings.isChangeGateEnabled("OfficeVSO:8440558_FindandReplaceA11yFix")&&dc&&fa.TaskExtensions.Ua(Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)?Object(ha.d)(ea.a.resolve(Ba.l,{va:0})):ua.GetServiceTaskFactory.Bj(Uc.ka,
211,212,0),kb=>{kb=kb.result;kb.setEnabled(!0);kb.readText(dc.xF(!1))},Uc.xa,3)}static x0i(dc,Uc,kb,rb){dc?1891435765===dc.operation&&(rb([],""),kb(dc.sHj,Ka.Error),l.ULS.sendTraceTag(523882627,0,50,"FindAndReplaceDialog - Find Next ExcelServerMessageId.NoOccurrencesFound from find dialog")):(dc=U.a.Yi(1,2,0,51,0,-1736450117,"NoOccurrencesFound"),wa.a(Uc).CD([dc]),l.ULS.sendTraceTag(523882628,0,50,"FindAndReplaceDialog - Find Next ExcelServerMessageId.NoOccurrencesFound from shortcut keys"))}static k2h(dc,
Uc,kb,rb,cc){kb=rb?String.format(kb.jui,1E3):String.format(kb.kui,Uc);rb=[];for(let mc=0;mc<Uc;mc++){const Sa=dc.Results[mc].SheetCell,pb=dc.Results[mc].Value,Ac=Sa.SheetName,yd=v.F(Sa).xF(!1);rb.push({Cell:Sa,Value:pb,SheetName:Ac,CellRange:yd})}cc(rb,kb)}Rnd(dc,Uc,kb){const rb=new db.a(this.$.sa);if(!kb&&this.lZd.SearchAllSheets){if(rb.Bej)return dc+this.kDg}else if(rb.Dn)return Uc?dc+this.kDg:this.uQh;return dc}static sSk(dc){return dc.includes("*")||dc.includes("?")||dc.includes("~")}static getActiveCell(dc){return(dc=
J.f(dc))?dc.ha.qa.activeCell:D.Range.gi(1,1)}}ib.nwc=[25];Object(w.a)(ib,"FindAndReplaceDialog",Za.a,[554]);var Yb=a(156);let Wc=class{constructor(dc,Uc,kb){this.iN=Uc;this.WXa=kb;this.Aui=[25];this.y2b=!1;this.jPd=()=>{this.y2b&&(this.da.rh.zq(this.Aui),this.da.ha.$w(this.jPd),this.y2b=!1)};this.$=dc;this.da=J.f(dc);this.Lhh=new V}get aD(){return this.Lhh}dispose(){this.da&&this.y2b&&(this.da.ha.$w(this.jPd),this.y2b=!1)}Bi(dc,Uc){return(1059985902===Uc||658167298===Uc)&&!this.$.isEditMode}ni(dc,
Uc){if(dc=1===dc)switch(Uc.command){case 1059985902:case 658167298:case 1891435765:case 788780084:case 1540292897:case -1389126153:case 892787342:break;default:dc=!1}return dc}Ji(){return!1}executeCommand(dc,Uc,kb){dc=Uc.command;return this.y0i(1891435765===dc||788780084===dc||658167298===dc,-1389126153===dc,Uc,kb)}y0i(dc,Uc,kb,rb){let cc=fa.TaskExtensions.sq();this.aD.tIc=Uc;if(dc||1540292897===kb.command){this.da.$6a(!0);let mc;1540292897===kb.command&&(mc=rb.CommandValueId);this.lui=ib.getInstance(this.$,
mc,this.aD,kb,this.iN,this.WXa);Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TrackAsyncDialogFindAndReplace",!1)&&Yb.b(this.$).ix(rb.event.rawEvent?rb.event.rawEvent:rb.event,"dialog-find-and-replace",null,["dialog"]);this.lui.BDk(kb.command)}else if(this.aD.uIc){Da.EwaSettings.isChangeGateEnabled("OfficeVSO:8511408_showSharedCustomDialogCrashTelemetry")&&l.ULS.sendTraceTag(507835859,0,50,"FindCommandHandler.handleFindCommand: Find/Replace triggered by some shortcut key.");
const mc={};mc.SheetName=this.$.sa.na.sheetName;mc.SearchString=this.aD.uIc;mc.SearchUp=Uc;mc.MatchCase=this.aD.rZd;mc.MatchEntireCell=this.aD.sZd;mc.SearchAllSheets=!1;mc.ExcludeFormulaResult=!1;const Sa=788780084===kb.command;let pb=null,Ac;Da.EwaSettings.raa()&&(Ac=new fb(mc,this.$.ea.pD,!1,ib.getActiveCell(this.$)),Da.EwaSettings.C0()&&!Sa&&this.iN.xJa(lb.a.findNext));const yd=()=>{this.da.ha.Cw(this.jPd);this.y2b=!0};dc=(()=>{let vb=ib.fJd(this.$,mc,Ac,this.aD.tIc,Sa,null,!1,null,null,yd,void 0,
!0);({nt:pb}=vb);return vb})().returnValue;cc=B.a(this.$.userOperationManager,dc,vb=>new z.a(Sa?205:149,0,vb,16,pb),kb)}return cc}};Wc=Object(e.__decorate)([Object(ea.d)(Ba.hc),Object(e.__param)(0,Object(Ba.Lb)()),Object(e.__param)(1,Object(Ba.Dg)()),Object(e.__param)(2,Object(Ba.ic)())],Wc);Object(w.a)(Wc,"FindCommandHandler",null,[39]);var Qc=a(242),Wb=a(353),Jc=a(61),ma=a(75);class Hc extends Za.a{constructor(dc,Uc,kb){super(dc);this.iN=kb;this.i8=this.Iwa=this.sheetNames=null;this.$Qb=!1;this.m$k=
(rb,cc,mc)=>{""===rb&&(rb="A1");Hc.o2f=this.Iwa=rb;const Sa=this.$.listSeparator;rb=this.Iwa.split(Sa);this.Rhk(rb);this.dwh(rb,cc);this.Iwa=rb.join(Sa.toString());Da.EwaSettings.vga()?this.i8.BVf(rb)?rb=!0:(cc=this.i8.Dqg(rb,"gotoDialog"),this.i8.TYf(cc)?rb=!0:(this.iN.xJa(lb.a.gotoDialog),this.$Qb=!0,cc=this.i8.H_g(rb,"gotoDialog"),(rb=this.i8.nmj(cc))&&this.iN.oY("business-logic-success")),this.i8.UYf(cc)&&this.i8.jLf(cc)):rb=this.i8.W_g(rb,"gotoDialog");if(rb)return l.ULS.sendTraceTag(537159573,
0,50,"GotoDialog.VerifyInputIsValid: parsed range(s) locally. Does contain list separator: "+this.wvd(this.Iwa)),this.She(!0),!0;l.ULS.sendTraceTag(537159572,0,50,"GotoDialog.VerifyInputIsValid: could not parse range(s) locally, calling webservice instead. Does contain list separator: "+this.wvd(this.Iwa));this.r_a(562,this.KKi(this.$,this.Iwa,mc),18,Da.EwaSettings.isChangeGateEnabled("OfficeVSO:8127875_FixingGoToBlockingOps")?!0:this.Ega,!1);return!1};this.yZi=rb=>{l.ULS.sendTraceTag(537159571,0,
50,`GotoDialog.GoToDialogHandler pressing on: ${1===rb?"Ok":"Cancel"}`);if(Da.EwaSettings.vga()){const cc=ea.a.Zg(Ba.Dg);0===rb&&this.$Qb&&(this.$Qb=!1,null===cc||void 0===cc?void 0:cc.oY("business-logic-success"),null===cc||void 0===cc?void 0:cc.Pba(lb.a.gotoDialog))}};this.fS=()=>{this.She(!1);if(Da.EwaSettings.vga()){this.$Qb=!1;const rb=ea.a.Zg(Ba.Dg);null===rb||void 0===rb?void 0:rb.oY("web-method-error");null===rb||void 0===rb?void 0:rb.Pba(lb.a.gotoDialog)}};this.Bh=1;this.i8=Uc;dc={[Hc.fy]:this.ki,
["initialRange"]:Hc.o2f||"",["verifyInputIsValid"]:this.m$k};if(this.x_f=!this.$.ea.isNamedObjectViewMode)dc.isSheetDropdownEnabled=!0,dc.activeSheetName=this.$.sa.na.name,this.sheetNames=this.gkb(),dc.sheets=this.sheetNames;this.initializeAndShow(ba.a.instance.ia(76),this.yZi,dc)}get ki(){return"GotoDialog"}KKi(dc,Uc,kb){return(rb,cc,mc)=>{const Sa=J.f(dc),pb=dc.pa.ta.Jh();return dc.sa.na?R.x(dc.pa.ta,Uc,dc.sa.na.name,this.cfb(rb,this.uAf(kb)),F.b(cc,this.fS),mc,Sa,pb):R.w(dc.pa.ta,Uc,-1,this.cfb(rb,
this.uAf(kb)),F.b(cc,this.fS),mc,Sa,pb)}}uAf(dc){return(Uc,kb)=>{let rb=!1;const cc=!ra.a(Uc);this.She(cc);l.ULS.sendTraceTag(537159570,0,50,`GotoDialog.OnWebMethodSuccess: ${cc?"Succeeded":"Failed"} to parse range(s) on server. Does contain list separator: ${this.wvd(this.Iwa)}`);let mc;Da.EwaSettings.vga()&&(this.$Qb=!1,mc=ea.a.Zg(Ba.Dg));if(cc)l.ULS.shipAssertTag(537159569,0,Object(Wb.a)(167,kb),"GotoDialog.OnWebMethodSuccess: the userContext is null or not an IGridView."),Da.EwaSettings.vga()&&
(null===mc||void 0===mc?void 0:mc.oY("business-logic-success")),Uc=Uc.Result,Uc=v.m(Uc.Ranges[0],Uc.SheetName),kb.To(Uc,null,null,null,3,"GotoDialog.OnWebMethodSuccess");else if(Da.EwaSettings.vga()&&(null===mc||void 0===mc?void 0:mc.oY("web-method-error"),null===mc||void 0===mc?void 0:mc.Pba(lb.a.gotoDialog)),ra.b(Uc,-1876101953)||ra.b(Uc,1145860328))ma.a(this.$).ij.CL([-1876101953,1145860328]),rb=!0;else{l.ULS.sendTraceTag(537159568,0,10,"GotoDialog.OnWebMethodSuccess: result contains non-status messages");
this.hide();return}dc(rb)}}wvd(dc){return oa.a.contains(dc,this.$.listSeparator.toString(),!0)}She(dc){const Uc=this.$,kb={};kb.c=Uc.ea.isNamedObjectViewMode;kb.b=dc;kb.a=Uc.ua.UserSessionId;Jc.b().tl(35,kb)}Rhk(dc){for(let Uc=0;Uc<dc.length;Uc++)dc[Uc]=dc[Uc].trim()}dwh(dc,Uc){if(this.x_f&&Uc!==this.$.sa.na.name&&!Qc.a.any(dc,kb=>oa.a.contains(kb,"!",!0)))for(let kb=0;kb<dc.length;kb++)dc[kb]=`'${Uc}'!${dc[kb]}`}gkb(){const dc=this.$.sa.items,Uc=[];for(const kb of dc)kb.visible&&!la.e(kb)&&Uc.push(kb.sheetName);
return Uc}}Hc.o2f=null;Object(w.a)(Hc,"GotoDialog",Za.a,[]);let Kb=class{constructor(dc,Uc,kb){this.iN=kb;this.$=dc;this.i8=Uc}Bi(){return!1}Ji(){return!1}ni(dc,Uc){return-1361691601===Uc.command}executeCommand(){J.f(this.$).$6a(!0);new Hc(this.$,this.i8,this.iN);return I.Task.Va(!0)}};Kb=Object(e.__decorate)([Object(ea.d)(Ba.Sc),Object(e.__param)(0,Object(Ba.Lb)()),Object(e.__param)(1,Object(Ba.Bg)()),Object(e.__param)(2,Object(Ba.Dg)())],Kb);Object(w.a)(Kb,"GotoCommandHandler",null,[39]);var pc=
a(96),$b=a(304),Ib=a(39),Zb=a(111),Eb=a(214);class ob{constructor(dc,Uc,kb,rb,cc){this.KLe=this.cUd=!1;this.d7d=mc=>{this.dl&&this.dl.fm&&mc.Hq===this.dl.Hq&&(this.dl.fm.paneType!==this.Gue&&this.Bz&&(this.pPd(),this.Cqe()),this.Bz.I8a(this.floatingObjectId))};this.$=dc;this.da=J.f(dc);this.$e=this.da.ha.$e;this.Bz=Uc;this.floatingObjectId=kb;this.floatingObjectType=cc;this.sharedSheetRange=rb;this.floatingObjectManager=Zb.a(dc);this.dl=null}get xUd(){return this.KLe}get contentType(){return 0}dispose(){this.dl&&
this.dl.n3b(this.d7d);this.da.ha.iqa.Q2b(this);this.X6a(!1);this.Bz.ftb(this.floatingObjectId);this.To();this.dl=this.floatingObjectManager=null}rkb(){this.$e.FVa(this.sharedSheetRange,this.floatingObjectId,this.floatingObjectType).continueWith(dc=>{dc.result||l.ULS.sendTraceTag(537153821,0,15,`FloatingObjectSharingHighlight.GotoFoAndShowHighlights: Selection of shared FO Failed with FOId = ${this.floatingObjectId}`);this.da.ha.iqa.L_e(this);this.vui()})}pPd(){this.dl&&(this.dl.n3b(this.d7d),this.cUd=
!1);this.X6a(!1);this.Bz.ftb(this.floatingObjectId);this.dl=null}Cqe(){this.fsg();this.dl&&(this.X6a(!0),this.QKb(!1))}ePf(){}tSg(){}To(){return this.dl?this.$e.EVa(this.dl):!1}Eue(){const dc=this.Bz.mZa(this.floatingObjectId);return dc?dc.isFocused:!1}i6b(){if(!this.dl||this.$e.NIc!=this.dl)return!1;const dc=this.Bz.mZa(this.floatingObjectId);return!dc||dc.isFocused?!1:dc.focus()}Yp(dc){if(!this.dl||this.$e.NIc!=this.dl)return!1;const Uc=this.Bz.mZa(this.floatingObjectId);return Uc&&Uc.isFocused?
Uc.Yp(dc):!1}vui(){this.fsg();this.dl?(this.To(),this.X6a(!0),this.QKb(!0),l.ULS.sendTraceTag(537153819,0,50,`FloatingObjectSharingHighlight.GotoFoAndShowHighlights: Successfully highlighted shared FO with FOId = ${this.floatingObjectId}`)):l.ULS.sendTraceTag(537153820,0,10,`FloatingObjectSharingHighlight.GotoFoAndShowHighlights: Unable to find floating object control of FO with FOId = ${this.floatingObjectId}`)}fsg(){this.floatingObjectManager&&(this.dl=this.floatingObjectManager.ky(Eb.a.vI(this.floatingObjectType,
this.floatingObjectId)))}X6a(dc){this.dl&&this.dl.a1c&&(this.dl.a1c(dc),this.KLe=dc)}QKb(dc){if(this.dl){this.Gue=this.dl.fm.paneType;var Uc=this.dl.get_element();this.Gue&&Uc?(this.Bz.QKb(this.Gue,Uc,this.floatingObjectId,this.contentType,dc),this.cUd||(this.dl.Rkc(this.d7d),this.cUd=!0)):l.ULS.sendTraceTag(523765015,0,10,"FloatingObjectSharingHighlight.createOrUpdateToolTip: Unable to find FO container pane or FO control outer element.")}else l.ULS.sendTraceTag(523765016,0,10,"FloatingObjectSharingHighlight.createOrUpdateToolTip: Missing floating object control.")}}
Object(w.a)(ob,"FloatingObjectSharingHighlight",null,[576,2]);var Na=a(38),nb=a(183),Hb=a(54),na=a(155),Gb=a(426);class Xa extends Sys.EventArgs{constructor(dc){super();this.LAa=dc}}Object(w.a)(Xa,"ShareSectionEventArgs",Sys.EventArgs,[]);var Jb=a(902),qb=a(7);class Db extends Na.a{constructor(dc,Uc,kb,rb,cc,mc,Sa,pb,Ac){super();this.Xk=na.a.instance;this.FHc=this.xDa=this.eec=!1;this.RP=this.Oqa=this.hx=this.Kia=null;this.P6b=0;this.h8a=this.CBa=null;this.CYb=100;this.eN=this.fN=!1;this.CY=()=>{this.uA.disabled||
this.pqa()};this.BY=()=>{this.uA.disabled||this.L7()};this.onFocus=()=>{this.hx.disabled||(this.pqa(),this.eec=!0)};this.onBlur=()=>{this.hx.disabled||this.xDa||this.L7()};this.aMj=()=>{this.RP.disabled||this.hide(!0)};this.bMj=()=>{this.RP.disabled||(this.pqa(),this.xDa=this.eec=!0)};this.$Lj=()=>{this.RP.disabled||(this.xDa=!1)};this.mq=yd=>{switch(yd.keyCode){case 13:this.xDa?this.hide(!0):this.L7();this.da.focus();yd.stopPropagation();yd.preventDefault();break;case 27:this.L7();this.da.focus();
break;case 9:this.xDa?(this.xDa=!1,this.hx.focus()):(this.xDa=!0,this.RP.focus()),yd.stopPropagation(),yd.preventDefault()}};this.L7=()=>{this.CYb=Math.max(this.CYb,this.hx.offsetWidth);window.clearInterval(this.P6b);bb.DOMElementExtensions.toggleCssClass(this.Kia,"ewr-shareSection-tooltip-hidden",!1);bb.DOMElementExtensions.toggleCssClass(this.RP,"ewr-shareSection-tooltip-hidden",!0);bb.DOMElementExtensions.toggleCssClass(this.Oqa,"ewr-shareSection-tooltip-toggle-maxWidth0",!0);this.raiseEvent("collapseTooltipEvent",
new Xa(this.Iue));this.xDa=this.eec=this.FHc=!1};this.fN=Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UpdateHighlightWithCssTransform",!1);this.eN=Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UpdateHighlightWithCssTransformChange",!1);this.da=dc;this.svgIconProvider=kb;this.paneType=Uc;this.JAa=rb;this.uA=mc;this.Iue=cc;this.Yk=Sa;this.qR=Ac;this.I6h(pb)}Nxh(dc){this.addHandler("collapseTooltipEvent",dc)}wik(dc){this.removeHandler("collapseTooltipEvent",dc)}ryh(dc){this.addHandler("expandTooltipEvent",
dc)}Vik(dc){this.removeHandler("expandTooltipEvent",dc)}Myh(dc){this.addHandler("hideToolTipEvent",dc)}mjk(dc){this.removeHandler("hideToolTipEvent",dc)}get isFocused(){return this.eec&&this.FHc}dispose(){window.clearInterval(this.P6b);this.Xea();super.dispose()}hide(dc){window.clearInterval(this.P6b);bb.DOMElementExtensions.toggleCssClass(this.uA,"ewr-shareSection-tooltip-hidden",!0);l.ULS.sendTraceTag(525144271,0,50,"ShareTooltipControl.Hide: Hiding tooltip and highlight");dc&&(this.raiseEvent("hideToolTipEvent",
new Xa(this.Iue)),this.da.$.ei(876400478,0,8,null),l.ULS.sendTraceTag(524931738,0,50,"ShareTooltipControl.hide: FPS survey got triggered."))}show(dc){bb.DOMElementExtensions.toggleCssClass(this.uA,"ewr-shareSection-tooltip-hidden",!1);dc?this.L7():this.pqa()}I8a(){if(this.Yk&&0!==this.paneType){var dc=this.OWi(this.Yk,this.paneType);dc&&(this.fN||this.eN?(this.da.rtl&&(dc.x*=-1),this.uA.style.transform=`translate3d(${dc.x}px, ${dc.y}px, 0px)`):bb.DOMElementExtensions.updatePosition(this.uA,dc.x,dc.y,
!0,this.da.rtl))}else l.ULS.sendTraceTag(524079517,0,10,`ShareTooltipControl.updateTooltipPosition: Either highlight div is null or pane type is none for sharing type ${this.JAa}.`)}FRh(){0!=this.JAa&&(bb.DOMElementExtensions.cfe(this.hx),this.da.rtl?(this.hx.appendChild(this.Kia),this.hx.appendChild(this.RP),this.hx.appendChild(this.Oqa),this.uA.dir="rtl"):(this.hx.appendChild(this.Oqa),this.hx.appendChild(this.RP),this.hx.appendChild(this.Kia),this.uA.dir="ltr"))}focus(){this.hx.focus();return!0}Yp(dc){return this.isFocused&&
bb.DOMElementExtensions.Cn(this.hx,dc)}QJf(){switch(this.JAa){case 0:return ba.a.instance.ia(2265);case 1:return ba.a.instance.ia(2266);case 2:return ba.a.instance.ia(2267);default:return""}}I6h(dc){const Uc=Date.now();window.requestAnimationFrame(()=>{this.uA.className=0===this.JAa?"ewr-shareSection-floatingoject-tooltip-container":"ewr-shareSection-tooltip-container";this.hx=document.createElement("div");this.hx.className="ewr-shareSection-tooltip-flyout";this.hx.tabIndex=0;this.hx.setAttribute(qb.a.RC,
this.QJf());this.uA.appendChild(this.hx);this.Oqa=document.createElement("div");this.Oqa.className="ewr-shareSection-tooltip-textContainer";var kb=document.createElement("span");kb.innerText=this.QJf();kb.className="ewr-shareSection-tooltip-text";this.Oqa.appendChild(kb);this.RP=document.createElement("div");this.RP.className="ewr-shareSection-tooltip-close-icon";this.RP.tabIndex=0;this.RP.setAttribute(qb.a.RC,ba.a.instance.ia(986));this.svgIconProvider.lna(Jb.a.wFk,16,16,this.RP,20,20);this.Kia=
document.createElement("div");this.Kia.className="ewr-shareSection-tooltip-icon";this.svgIconProvider.lna(Jb.a.xFk,20,20,this.Kia,20,20);bb.DOMElementExtensions.toggleCssClass(this.Kia,"ewr-shareSection-tooltip-hidden",!0);this.da.rtl?(this.hx.appendChild(this.Kia),this.hx.appendChild(this.RP),this.hx.appendChild(this.Oqa),this.uA.dir="rtl"):(this.hx.appendChild(this.Oqa),this.hx.appendChild(this.RP),this.hx.appendChild(this.Kia),this.uA.dir="ltr");this.L7();this.I8a();this.lu();this.FHc=!0;dc&&(this.pqa(),
this.P6b=window.setInterval(this.L7,1E4));kb=Date.now();l.ULS.sendTraceTag(524931737,0,50,`ShareTooltipControl.createTooltip: successfully highlighted and created tooltip for shareSectionContentType = ${this.JAa}, duration= ${kb-Uc}`)})}lu(){this.hx&&(this.CBa=this.Xk.Ek(this.hx),this.CBa.Aa("mouseover",this.CY),this.CBa.Aa("mouseout",this.BY),this.CBa.Aa("focus",this.onFocus),this.CBa.Aa("blur",this.onBlur),this.CBa.Aa("keydown",this.mq));this.RP&&(this.h8a=this.Xk.Ek(this.RP),this.h8a.Aa("click",
this.aMj),this.h8a.Aa("focus",this.bMj),this.h8a.Aa("blur",this.$Lj))}Xea(){this.CBa&&this.CBa.sO();this.h8a&&this.h8a.sO();bb.DOMElementExtensions.cfe(this.uA);bb.DOMElementExtensions.Km(this.uA);this.Kia=this.RP=this.Oqa=this.hx=this.uA=this.Yk=this.h8a=this.CBa=null}pqa(){window.clearInterval(this.P6b);bb.DOMElementExtensions.toggleCssClass(this.Kia,"ewr-shareSection-tooltip-hidden",!0);bb.DOMElementExtensions.toggleCssClass(this.RP,"ewr-shareSection-tooltip-hidden",!1);bb.DOMElementExtensions.toggleCssClass(this.Oqa,
"ewr-shareSection-tooltip-toggle-maxWidth0",!1);this.o4k();this.raiseEvent("expandTooltipEvent",new Xa(this.Iue));this.FHc=!0}OWi(dc,Uc){let kb=parseInt(dc.style.left,10);var rb=parseInt(dc.style.right,10);let cc=parseInt(dc.style.top,10);if((this.fN||this.eN)&&this.qR){var mc=this.qR.dib?this.qR.dib:this.da.rh.wYa(this.qR.range,Uc,!0);mc&&(kb=rb=this.da.rh.CGb(this.qR,mc.x),cc=mc.y+this.da.rh.OIa(this.qR,!1))}if(!rb&&this.da.rtl&&0===this.JAa){rb=dc.offsetWidth;mc=this.da.Zk(Uc).domElement.offsetWidth;
let Sa=kb;dc.parentNode&&(Sa+=dc.parentNode.offsetLeft);rb=mc-rb-Sa}return this.UJd(new Sys.UI.Point(this.da.rtl?rb:kb,cc),Uc,dc)}UJd(dc,Uc,kb){var rb=this.da.Zk(Uc).vr;Uc=Gb.a.KO(Uc,rb.topLeft);rb=kb.offsetWidth;kb=kb.offsetHeight;let cc=0;this.hx&&bb.DOMElementExtensions.iub(this.hx,"ewr-shareSection-tooltip-toggle-leftAndRight")&&(cc=20);return new Sys.UI.Point(Math.min(Math.max(Uc.x,dc.x-10),dc.x+rb)+cc,Math.min(Math.max(Uc.y,dc.y-10),dc.y+kb))}o4k(){const dc=this.da.Zk(this.paneType).vr,Uc=Gb.a.KO(this.paneType,
dc.topLeft);this.CYb=Math.max(this.CYb,this.hx.offsetWidth);let kb=parseInt(this.uA.style.left,10);this.da.rtl&&(kb=parseInt(this.uA.style.right,10));kb+this.CYb>Uc.x+dc.width?bb.DOMElementExtensions.toggleCssClass(this.hx,"ewr-shareSection-tooltip-toggle-leftAndRight",!0):bb.DOMElementExtensions.toggleCssClass(this.hx,"ewr-shareSection-tooltip-toggle-leftAndRight",!1);this.I8a()}}Object(w.a)(Db,"ShareToolTipControl",Na.a,[601,2]);class gb extends Na.a{constructor(dc,Uc){super();this.SWc=null;this.pia=
{};this.XBa=null;this.axb=[];this.nP=()=>{if(this.$.na&&la.d(this.$.na)===this.SWc){const kb=this.pia;for(const rb in kb)this.I8a(rb)}};this.onActiveItemChanged=(kb,rb)=>{if(rb&&rb.na&&rb.mB){kb=this.pia;for(const cc in kb){kb=this.mZa(cc);if(!kb)break;if(la.d(rb.na)!==this.SWc){kb.hide(!1);break}if(la.d(rb.na)!==la.d(rb.mB)){kb.show(!0);break}kb.FRh()}}};this.mog=(kb,rb)=>{rb&&this.raiseEvent("collapseSharingTooltip",rb)};this.nog=(kb,rb)=>{rb&&this.raiseEvent("expandSharingTooltip",rb)};this.oog=
(kb,rb)=>{rb&&this.raiseEvent("closeSharingTooltip",rb)};this.$=dc;this.svgIconProvider=Uc;this.da=J.f(dc);dc.na&&(this.SWc=la.d(dc.na));this.iGh()}Kxh(dc){this.addHandler("closeSharingTooltip",dc)}tik(dc){this.removeHandler("closeSharingTooltip",dc)}Mxh(dc){this.addHandler("collapseSharingTooltip",dc)}vik(dc){this.removeHandler("collapseSharingTooltip",dc)}qyh(dc){this.addHandler("expandSharingTooltip",dc)}Uik(dc){this.removeHandler("expandSharingTooltip",dc)}dispose(){this.aai();this.TUh();pc.a.Ng(this.XBa);
this.XBa=null;super.dispose()}QKb(dc,Uc,kb,rb,cc,mc){if(0!==dc&&Uc){var Sa=Ib.a.gj(this.pia,kb);if(!Sa){const pb=document.createElement("div");Sa=new Db(this.da,dc,this.svgIconProvider,rb,kb,pb,Uc,cc,mc);this.pia[kb]=Sa;Sa.Nxh(this.mog);Sa.ryh(this.nog);Sa.Myh(this.oog);window.requestAnimationFrame(()=>{const Ac=this.da.Zk(dc).domElement;Ac.insertBefore(pb,Ac.firstChild)})}la.d(this.$.na)!==this.SWc?Sa.hide(!1):this.I8a(kb)}}ftb(dc){const Uc=Ib.a.gj(this.pia,dc);Uc&&(delete this.pia[dc],Uc.dispose())}I8a(dc){Ib.a.gj(this.pia,
dc)&&(0>this.axb.indexOf(dc)&&this.axb.push(dc),this.XBa=nb.AsyncMethodContext.$B(this.updatePosition.bind(this),100,Hb.a.vFk,this.XBa))}mZa(dc){return Ib.a.gj(this.pia,dc)}updatePosition(){this.axb&&0<this.axb.length&&(this.axb.forEach(dc=>{(dc=Ib.a.gj(this.pia,dc))&&dc.I8a()}),this.axb.length=0)}iGh(){this.$&&this.$.sa.Qm(this.onActiveItemChanged);this.da&&(this.da.za.wT(this.nP),this.da.za.Vy(this.nP),this.da.view.Wy(this.nP))}aai(){this.$&&this.$.sa.hn(this.onActiveItemChanged);this.da&&(this.da.za.rV(this.nP),
this.da.za.Fy(this.nP),this.da.view.Kx(this.nP))}TUh(){const dc=this.pia;for(const kb in dc){var Uc=dc[kb];Uc.wik(this.mog);Uc.Vik(this.nog);Uc.mjk(this.oog);Uc.dispose()}this.raiseEvent("closeSharingTooltip");this.pia=null}}Object(w.a)(gb,"ShareToolTipControlsManager",Na.a,[577,2]);const ya=[47];class Aa{constructor(dc,Uc,kb,rb,cc){this.Ika=[1,3,2,4];this.MWd=this.oHc=!1;this.ovf=!0;this.eH={};this.x7d=()=>{this.Vif()};this.$=dc;this.da=J.f(dc);this.Bz=Uc;this.LAa=kb;this.sharedSheetRange=rb;this.JAa=
cc;this.sheetRange=new ka.a(v.G(rb),la.d(dc.sa.na));this.Nyj()}get xUd(){return this.MWd}get contentType(){return this.JAa}dispose(){this.da&&this.da.ha&&this.da.ha.iqa.Q2b(this);this.X6a(!1);this.ftb();this.To();this.eH=null}rkb(){this.da.oPd();this.To()&&(this.da.ha.iqa.L_e(this),this.X6a(!0))}pPd(){this.WRb();this.ftb()}Cqe(){this.wRg(!1)}ePf(){this.ZRg(!1)}tSg(){this.ZRg(!0)}To(){this.da.To(this.sharedSheetRange,null,null,null,60,"SharingHighlight.GotoRangeAndShowHighlight");return!0}Eue(){const dc=
this.Bz.mZa(this.LAa);return dc?dc.isFocused:!1}i6b(){if(!this.i_f())return!1;const dc=this.Bz.mZa(this.LAa);return!dc||dc.isFocused?!1:dc.focus()}Yp(dc){if(!this.i_f())return!1;const Uc=this.Bz.mZa(this.LAa);return Uc&&Uc.isFocused?Uc.Yp(dc):!1}ZRg(dc){for(const Uc in this.eH)bb.DOMElementExtensions.toggleCssClass(this.eH[Uc],"ewr-shareSection-tooltip-toggle-opacity",dc)}Nyj(){if(this.sharedSheetRange&&1==this.contentType){const dc=this.sharedSheetRange.LastRow-this.sharedSheetRange.FirstRow,Uc=
this.sharedSheetRange.LastColumn-this.sharedSheetRange.FirstColumn;Uc&&dc&&l.ULS.sendTraceTag(525144270,0,50,`SharingHighlight.logRangeSize: Shared Range contains cells = ${dc*Uc}.`)}}X6a(dc){this.sheetRange?dc?(this.da.rh.Tub(this.sheetRange,ya),this.wRg(!0)):this.WRb():l.ULS.sendTraceTag(537153814,0,10,"SharingHighlight.ShowOrHideSharingHighlight: Shared Range is null.")}wRg(dc){this.oHc||(this.da.rh.v1e(this.x7d),this.oHc=!0);this.da.rh.rw(ya,null,null,!0,!0);this.MWd=!0;this.ovf=dc;this.Vif();
dc&&this.To()}WRb(){this.da.rh.zq(ya);this.da.rh.Ege(this.x7d);this.MWd=this.oHc=!1}Vif(){if(this.sheetRange){var dc=J.f(this.$).Pg.ro(this.sheetRange.range.topLeft),Uc=this.da.rh.rU(47,dc);dc&&Uc.Yk&&bb.DOMElementExtensions.isVisible(Uc.Yk)&&(this.Bz.QKb(dc,Uc.Yk,this.LAa,this.JAa,this.ovf,Uc),this.t4j(),this.da.rh.Ege(this.x7d),this.oHc=!1)}}t4j(){if(this.eH){var dc=Date.now();for(let kb=0;kb<this.Ika.length;kb++){this.eH[this.Ika[kb].toString()]&&(bb.DOMElementExtensions.Km(this.eH[this.Ika[kb].toString()]),
this.eH[this.Ika[kb].toString()]=null);var Uc=this.da.Pg.$Vd(this.sheetRange.range,this.Ika[kb]);const rb=this.da.rh.rU(47,this.Ika[kb]).Yk;if(!Uc||!rb)break;Uc=document.createElement("div");Uc.className="ewr-shareSection-highlightDiv-overlay";rb.appendChild(Uc);this.eH[this.Ika[kb].toString()]=Uc}dc=Date.now()-dc;l.ULS.sendTraceTag(523765014,0,50,`SharingHighlight.populateOverlayDivElements: Successfully added overlay for shared Range/Table in durationInMS = ${dc}.`)}}ftb(){if(this.Bz){this.Bz.ftb(this.LAa);
const dc=this.eH;for(const Uc in dc)bb.DOMElementExtensions.Km(dc[Uc]);this.eH={}}}i_f(){if(!this.da.ha.qa.Gn)return!1;let dc=this.da.ha.qa.activeRange;this.da.ha.qa.aya()&&(dc=this.da.ha.qa.activeCell);return dc.equals(v.G(this.sharedSheetRange))?!0:!1}}Object(w.a)(Aa,"SharingHighlight",null,[576,2]);var sb=a(1284);class nc extends sb.a{constructor(){super();this.LastColumn=this.LastRow=0}}Object(w.a)(nc,"SharedSheetRange",sb.a,[]);var Bb=a(25),uc=a(162);const Pc=qb.a.D4a;class wd{constructor(dc,
Uc){this.FYh=ba.a.instance.ia(2268);this.floatingObjectManager=null;this.Ow=!1;this.ES={};this.PVa=[];this.Cva=this.shb=!1;this.PAd=0;this.V5=!1;this.DXc=null;this.LVb=this.nTb=this.ITb=!1;this.jib=0;this.Mw=Da.EwaSettings.Bn("ShareSectionGotoAndHighlightManager");this.g_b=(kb,rb)=>{rb.control&&rb.control.floatingObject&&0===rb.control.floatingObject.type&&this.fCc(rb.control.floatingObject.id,!1)};this.ahg=(kb,rb)=>{rb.control&&rb.control.floatingObject&&!rb.control.floatingObject.type&&this.fCc(rb.control.floatingObject.id,
!0)};this.jza=(kb,rb)=>{rb.item&&this.LV&&rb.item.name===this.LV.name&&(l.ULS.sendTraceTag(524038161,0,50,"ShareSectionGotoAndHighlightManager.onNamedSheetViewModeChanged: Closing all highlight due to named sheet view mode."),this.mgk())};this.yl=()=>{this.ES&&0<Object.keys(this.ES).length&&(this.PAd++,2==this.PAd&&(this.FZg(),this.shb=!1))};this.FZg=()=>{this.da.sh.Zw(this.yl);this.Cva&&window.clearInterval(this.jib);this.da.$.ei(876400478,0,8,null);l.ULS.sendTraceTag(524931740,0,50,"ShareSectionGotoAndHighlightManager.triggerFPS: FPS survey got triggered.")};
this.onActiveItemPanesChanged=(kb,rb)=>{if(rb&&(kb=rb.iha,!(this.LVb&&kb||!this.LVb&&!kb)&&this.w_f())){this.V5=!0;this.LVb=!!kb;for(const cc in this.ES)this.fCc(cc,!1)}};this.pC=()=>{this.DXc=nb.AsyncMethodContext.$B(this.yak.bind(this),100,Hb.a.uFk,this.DXc)};this.qZa=()=>{for(const kb in this.ES){const rb=Ib.a.gj(this.ES,kb);rb&&this.cLf(rb)}this.ITb&&this.ea&&(Da.EwaSettings.fl()||this.ea.dv(this.qZa),this.ITb=!1);this.nTb&&this.ea&&(this.ea.qB(this.qZa),this.nTb=!1)};this.$eg=(kb,rb)=>{rb&&this.Q2b(rb.LAa)};
this.afg=(kb,rb)=>{rb&&(kb=Ib.a.gj(this.ES,rb.LAa))&&kb.ePf()};this.Kgg=(kb,rb)=>{rb&&(kb=Ib.a.gj(this.ES,rb.LAa))&&kb.tSg()};this.$=dc;this.da=J.f(dc);this.PAd=0;this.Cva=this.shb=!1;this.Bz=new gb(dc,Uc);this.floatingObjectManager=Zb.a(dc);this.ea=dc.ea;if(this.LV=dc.na)this.LVb=!!this.LV.wz;this.lu()}dispose(){this.Cva&&window.clearInterval(this.jib);this.Xea();const dc=this.ES;for(const Uc in dc)dc[Uc].dispose();this.Bz&&this.Bz.dispose();this.Bz=this.ES=null;pc.a.Ng(this.DXc);this.DXc=null;this.PVa.length=
0}AZi(){this.rkb(0)||0!=this.PVa.length||l.ULS.sendTraceTag(537153818,0,10,"ShareSectionGotoAndHighlightManager.GotoAndHighlightChart: Shared chart not found.")}BZi(){this.rkb(1)||0!=this.PVa.length||l.ULS.sendTraceTag(537153817,0,10,"ShareSectionGotoAndHighlightManager.GotoAndHighlightRange: Shared sheet range not found.")}CZi(){this.rkb(2)||0!=this.PVa.length||l.ULS.sendTraceTag(537153816,0,10,"ShareSectionGotoAndHighlightManager.GotoAndHighlightRange: Shared table not found.")}HZi(){this.XSd(this.$.workbookContext)||
l.ULS.sendTraceTag(512356422,0,10,"ShareSectionGotoAndHighlightManager.gotoSheet: Shared sheet not found.")}EZi(){this.XSd(this.$.workbookContext)?Pc!==uc.a(this.$).ns.rA&&Da.EwaSettings.isChangeGateEnabled("OfficeVSO:8501332_ShareExcelNamedSheetView")&&uc.a(this.$).ns.activateRibbonTab(Pc):l.ULS.sendTraceTag(508376321,0,10,"ShareSectionGotoAndHighlightManager.gotoNamedSheetView: Shared named sheet view not found.");this.Ow=!0}lu(){this.Bz&&(this.Bz.Kxh(this.$eg),this.Bz.Mxh(this.afg),this.Bz.qyh(this.Kgg));
this.floatingObjectManager&&(this.floatingObjectManager.skc(this.g_b),this.floatingObjectManager.rkc(this.ahg));this.LV&&this.LV.Kj&&this.LV.Kj.Tcb(this.jza);this.$&&this.$.sa&&this.$.sa.eFa(this.onActiveItemPanesChanged);this.da&&this.da.r9(this.pC)}Xea(){this.Bz&&(this.Bz.tik(this.$eg),this.Bz.vik(this.afg),this.Bz.Uik(this.Kgg));this.floatingObjectManager&&(this.floatingObjectManager.FSc(this.g_b),this.floatingObjectManager.ESc(this.ahg));this.LV&&this.LV.Kj&&this.LV.Kj.d3b(this.jza);this.$&&this.$.sa&&
this.$.sa.DNa(this.onActiveItemPanesChanged);this.da&&this.da.u1(this.pC);this.da&&this.da.sh&&this.shb&&(this.da.sh.Zw(this.yl),this.shb=!1);this.ITb&&this.ea&&!Da.EwaSettings.fl()&&this.ea.dv(this.qZa);this.nTb&&this.ea&&this.ea.qB(this.qZa);this.$.LPg=!1;l.ULS.sendTraceTag(508367327,0,50,"ShareSectionGotoAndHighlightManager.detachEvents: Setting the ewaControl shouldPassNavigationIdInOpenWorkbookRequest as false.")}w_f(){return this.$.na&&this.LV&&la.d(this.$.na)===la.d(this.LV)}yak(){if(this.w_f()){if(this.V5)for(const dc in this.ES)this.fCc(dc,
!0);this.V5=!1}}fCc(dc,Uc){(dc=Ib.a.gj(this.ES,dc))&&(Uc?dc.Cqe():dc.pPd())}XSd(dc){if(dc.NavigationContentFound)return!0;this.qLk(this.FYh);return!1}qLk(dc){dc=$b.a.IA.AK.mX(dc,!1);dc.image=Bb.a.Rmb()?2:0;$b.a.IA.AK.eF(dc)}rkb(dc){var Uc;const kb=this.$.workbookContext;if(!this.XSd(kb))return!1;dc=this.NPi(kb,dc);if(!dc)return!1;(null===(Uc=this.ea)||void 0===Uc?0:Uc.Ul)&&this.cLf(dc);this.Mw?!this.nTb&&this.ea&&(this.ea.Bw(this.qZa),this.nTb=!0):!this.ITb&&this.ea&&(Da.EwaSettings.fl()?this.$.ea.Jq(this.qZa):
this.ea.Uq(this.qZa),this.ITb=!0);return!0}NPi(dc,Uc){const kb=this.fkb(dc);dc=this.sUi(dc,Uc,kb);if(!dc)return l.ULS.sendTraceTag(537153815,0,10,`ShareSectionGotoAndHighlightManager.GetOrCreateSharingHighlight: Invalid shareSectionContentType = ${Uc}.`),null;if(0<=this.PVa.indexOf(dc))return l.ULS.sendTraceTag(522314690,0,50,"ShareSectionGotoAndHighlightManager.GetOrCreateSharingHighlight: Highlight already closed by user."),null;let rb=Ib.a.gj(this.ES,dc);rb||(rb=0===Uc?new ob(this.$,this.Bz,dc,
kb,0):new Aa(this.$,this.Bz,dc,kb,Uc),this.ES[dc]=rb);return rb}fkb(dc){const Uc=new nc;Uc.SheetName=this.$.na.name;Uc.FirstRow=dc.NavigationSharedSectionSharedRange.FirstRow;Uc.FirstColumn=dc.NavigationSharedSectionSharedRange.FirstColumn;Uc.LastRow=dc.NavigationSharedSectionSharedRange.LastRow;Uc.LastColumn=dc.NavigationSharedSectionSharedRange.LastColumn;return Uc}sUi(dc,Uc,kb){switch(Uc){case 0:return this.WDf(dc);case 2:return dc.NavigationSharedSectionXluid;case 1:return kb.toString();default:return null}}WDf(dc){dc=
dc.NavigationSharedSectionXluid;return`${dc.length}.${dc.toUpperCase()}`}cLf(dc){this.$&&!this.LV&&(this.LV=this.$.na);this.LV&&(this.LVb=this.LV.wz?!0:!1);this.shb||(this.da.sh.Wx(this.yl),this.shb=!0);this.Cva||(this.jib=window.setInterval(this.FZg,6E4),this.Cva=!0);l.ULS.sendTraceTag(524931739,0,50,`ShareSectionGotoAndHighlightManager.gotoAndHighlightSharedSection: started highlighting and creating tooltip for shareSectionContentType = ${dc.contentType}.`);dc.rkb()}Q2b(dc){const Uc=Ib.a.gj(this.ES,
dc);Uc&&(delete this.ES[dc],0>this.PVa.indexOf(dc)&&this.PVa.push(dc),Uc.dispose());0===Object.keys(this.ES).length&&this.Xea()}mgk(){const dc=this.ES;for(const Uc in dc)this.Q2b(Uc);this.Ow&&(this.Ow=!1,this.Xea())}}Object(w.a)(wd,"ShareSectionGotoAndHighlightManager",null,[556,2]);var Md=a(765);let Nd=class{constructor(dc,Uc){this.Gx=!1;this.d6b=new wd(dc,Uc);this.Gx=dc.isMobileMode}ni(dc,Uc){if(this.Gx)return!1;switch(Uc.command){case 1321134125:case 1804990828:case 1045473631:return Da.EwaSettings.isChangeGateEnabled("OfficeVSO:8096934_ShareExcelSection");
case -521202831:return Da.EwaSettings.isChangeGateEnabled("OfficeVSO:8096933_ShareExcelSheet");case -368249625:return Da.EwaSettings.isChangeGateEnabled("OfficeVSO:8501332_ShareExcelNamedSheetView");default:return!1}}executeCommand(dc,Uc){fa.TaskExtensions.sq();dc=Uc.command;switch(dc){case 1321134125:this.d6b.AZi();dc=I.Task.Va(!0);break;case 1804990828:this.d6b.BZi();dc=I.Task.Va(!0);break;case 1045473631:this.d6b.CZi();dc=I.Task.Va(!0);break;case -521202831:this.d6b.HZi();dc=I.Task.Va(!0);break;
case -368249625:this.d6b.EZi();dc=I.Task.Va(!0);break;default:dc=K.a(dc)}return dc}Ji(){return!1}Bi(){return!1}};Nd=Object(e.__decorate)([Object(ea.d)(Ba.Af),Object(e.__param)(0,Object(Ba.Lb)()),Object(e.__param)(1,Object(Md.m)())],Nd);Object(w.a)(Nd,"ShareSectionCommandHandler",null,[39]);var ec=a(208),gc=a(189);const Mb=(dc,Uc,kb,rb,cc,mc,Sa,pb)=>{pb=dc.Za(1,void 0===pb?null:pb);pb.activeCell=Uc;pb.selectedRange=kb;return R.h(dc,"GetSelectAllRange",pb,rb,cc,mc,Sa,4)};var sc;let xd=sc=class{constructor(dc){this.$=
dc;this.da=J.f(dc);this.ha=this.da.ha}get activeRange(){return this.da.inRangePicker||this.da.Pp?this.ha.rangePicker.nHd(!0).clone():this.ha.qa.activeRange.clone()}Bi(){return!1}executeCommand(dc,Uc,kb){let rb=dc=!1;var cc=null;cc=Uc.command;switch(cc){case -2117762619:return this.s3i();case 1941920197:dc=rb=!0;cc="SelectAll";break;case 2110202177:cc="SelectColumns";dc=!0;break;case 104573693:cc="SelectRows";rb=!0;break;default:return K.a(cc)}const mc=this.activeRange;if(mc.ZXf)return I.Task.Va(!0);
const Sa=this.da.Yg.sl(mc,!0),pb=!!Sa||1941920197!==Uc.command,Ac=!pb&&this.EFh()&&Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CompareToCtrlARanges",!1)&&!(null===kb||void 0===kb?0:kb.range);if(pb||Ac)return Ac?(Uc=this.O1c(!0,!0),l.ULS.sendTraceTag(537151697,0,50,"SmartSelectionCommandHandler.ExecuteCommand selecting entire grid")):Uc=Sa?this.y6k(dc,rb,Sa):this.O1c(dc,rb),l.ULS.shipAssertTag(509720675,0,null!=cc,"smartSelectionCommandHandler.executeCommand: gotoCaller is null!"),
this.da.To(v.w(Uc,this.$),null,null,null,0,cc,3),l.ULS.sendTraceTag(19798168,0,50,"SmartSelectionCommandHandler.ExecuteCommand: command handled on client."),I.Task.Va(!0);const yd=this.$.pa.ta;dc=Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CompareToCtrlARanges",!1)&&(null===kb||void 0===kb?void 0:kb.range);const vb=v.p(dc?null===kb||void 0===kb?void 0:kb.range:this.ha.qa.activeCell,this.$),Sc=v.w(dc?null===kb||void 0===kb?void 0:kb.range:mc,this.$);Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CompareToCtrlARanges",
!1)&&(null===kb||void 0===kb?0:kb.sheetName)&&(vb.SheetName=null===kb||void 0===kb?void 0:kb.sheetName,Sc.SheetName=null===kb||void 0===kb?void 0:kb.sheetName);l.ULS.sendTraceTag(19798169,0,50,"SmartSelectionCommandHandler.ExecuteCommand: command sent to server.");return B.a(this.$.userOperationManager,(hd,qc,Lc)=>Mb(yd,vb,Sc,F.c(hd,bd=>{Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CompareToCtrlARanges",!1)&&(null===kb||void 0===kb?0:kb.callback)?kb.callback(bd,null===kb||void 0===
kb?void 0:kb.range,null===kb||void 0===kb?void 0:kb.sheetId):sc.WNd(bd,this.da)}),qc,Lc,null),hd=>new z.a(165,0,hd,16),Uc)}ni(dc,Uc){switch(Uc.command){case 1941920197:case 2110202177:case 104573693:case -2117762619:return!0}return!1}Ji(){return!1}s3i(){const dc=this.da.aga(),Uc=this.O1c(!0,!0);this.da.To(v.w(Uc,this.$),dc,null,null,60,"SmartSelectionCommandHandler.HandleWidgetSelectAllCommand",3);l.ULS.sendTraceTag(19965127,0,50,"SmartSelectionCommandHandler.HandleWidgetSelectAllCommand");return I.Task.Va(!0)}y6k(dc,
Uc,kb){l.ULS.shipAssertTag(537151696,0,!!kb);var rb=this.activeRange;if(!kb)return rb;const cc=rb.top===kb.usedRange.top&&rb.bottom===kb.usedRange.bottom;rb=rb.right===kb.usedRange.right&&rb.left===kb.usedRange.left;if(dc&&!cc||Uc&&!rb)return dc=this.B6k(dc,Uc,kb),2===kb.type&&dc.equals(gc.a(kb))&&this.ha.qa.Gn&&kb.activate({scenario:"namedObject"}),dc;l.ULS.sendTraceTag(537151695,0,50,`SmartSelectionCommandHandler.UpdateSelectionByNamedTable selecting all grid, allRows = ${dc}, allColumns = ${Uc}`);
return this.O1c(dc,Uc)}B6k(dc,Uc,kb){const rb=this.activeRange,cc=this.MIk(rb,kb,dc,Uc);l.ULS.sendTraceTag(537151694,0,50,`Selecting table, allRows = ${dc}, allColumns = ${Uc}, shouldSelectInnerTable = ${cc}, isPivotTable = ${1===kb.type}`);kb=cc?gc.a(kb):kb.usedRange;Uc&&(rb.right=kb.right,rb.left=kb.left);dc&&(rb.top=kb.top,rb.bottom=kb.bottom);return rb}O1c(dc,Uc){l.ULS.sendTraceTag(537151693,0,50,`Selecting grid, allRows = ${dc}, allColumns = ${Uc}`);const kb=this.activeRange;Uc&&(kb.left=1,kb.right=
C.a.Qk);dc&&(kb.top=1,kb.bottom=C.a.gl);return kb}MIk(dc,Uc,kb,rb){if(2!==Uc.type)return!1;Uc=gc.a(Uc);return kb&&rb?Uc.contains(dc)&&!Uc.equals(dc):kb?Uc.contains(dc)&&!(Uc.top===dc.top&&Uc.bottom===dc.bottom):!1}EFh(){const dc=this.activeRange;--dc.top;dc.bottom+=1;--dc.left;dc.right+=1;var Uc=sc.rIi(dc);dc.s_();if(!this.da.Hp.contains(dc))return!1;for(const kb of Uc){Uc=sc.BIi(dc,kb);Uc=this.da.ot("SmartSelectionCommandHandler.AreSelectionEdgesEmpty",Uc,1);try{for(;Uc.$$mn();)if(Uc.$$cu().text)return!1}finally{Uc&&
Uc.dispose()}}return!0}static BIi(dc,Uc){dc=dc.clone();dc.Lme(Uc,dc.JX(Uc));return dc}static rIi(dc){const Uc=new ec.a;1<=dc.top&&Uc.add(1);dc.bottom<=C.a.KF&&Uc.add(2);1<=dc.left&&Uc.add(3);dc.right<=C.a.nE&&Uc.add(4);return Uc}static WNd(dc,Uc){if(!U.a.rx(dc.Errors)&&dc.Result){dc=dc.Result;var kb=v.G(dc);const rb=Uc.Hp.contains(kb);kb=kb.equals(new D.Range(1,1,C.a.gl,C.a.Qk,!0,!0));l.ULS.sendTraceTag(537151692,0,50,`SmartSelectionCommandHandler.HandleGetSelectAllRangeSuccess: newSelectionInLoadedRange = ${rb}, allGridSelection = ${kb}`);
Uc.To(dc,null,null,null,0,"SmartSelectionComandHandler.HandleGetSelectAllRangeSuccess",3)}}};xd=sc=Object(e.__decorate)([Object(ea.d)(Ba.Wf),Object(e.__param)(0,Object(Ba.Lb)())],xd);Object(w.a)(xd,"SmartSelectionCommandHandler",null,[39]);var xb=a(320),Lb=a(2),Rc=a(6);class nd{}Object(w.a)(nd,"SpellCheckFeedbackLoopParameters",null,[]);var $d=a(122),Td=a(78);class He{constructor(dc,Uc,kb){this.wqa=this.k_=null;this.qnb=!1;this.JP=this.hsb=this.yrb=this.R3a=this.H4c=null;this.jRj=rb=>{!ra.a(rb)&&
rb.Result?(l.ULS.sendTraceTag(41956352,0,50,"SpellCheckModel.OnGetSpellCheckSupportedLocaleListWebMethodSuccess GetSpellCheckSupportedLocaleList response success"),rb=rb.Result,this.TUf=rb.IsCurrentLocaleIdSupported,this.xB.vre(rb)):(this.xB.vre(null),l.ULS.sendTraceTag(41956353,0,10,"SpellCheckModel.OnGetSpellCheckSupportedLocaleListWebMethodSuccess GetSpellCheckSupportedLocaleList response error"))};this.iRj=rb=>{rb=$d.a.Qj(rb.data);l.ULS.sendTraceTag(537151387,0,10,`SpellCheckModel.OnGetSpellCheckSupportedLocaleListWebMethodFailed Errors: [${U.a.Kh(rb)}].`);
this.xB.vre(null)};this.hRj=rb=>{this.yrb=this.R3a=null;!ra.a(rb)&&rb.Result?(rb=rb.Result,this.JP=rb.SpellCheckItems,this.k_.FirstRow=rb.ActiveBatchEndRow,this.k_.FirstColumn=rb.ActiveBatchEndColumn,l.ULS.sendTraceTag(537151386,0,50,`SpellCheckModel.OnGetSpellCheckInfoWebMethodSuccess OnGetSpellCheckInfoWebMethod response success, SpellCheck cache: ${this.JP.length}`),this.em=this.JP[0]):(l.ULS.sendTraceTag(537151385,0,10,"SpellCheckModel.OnGetSpellCheckInfoWebMethodSuccess OnGetSpellCheckInfoWebMethod response error"),
this.em=null)};this.gRj=rb=>{rb=$d.a.Qj(rb.data);l.ULS.sendTraceTag(537151384,0,10,`SpellCheckModel.OnGetSpellCheckInfoWebMethodFailed Errors: [${U.a.Kh(rb)}].`);this.em=this.yrb=this.R3a=null};this.rXj=(rb,cc)=>{if(!ra.a(rb)&&rb.Result)if(l.ULS.sendTraceTag(537151383,0,50,"SpellCheckModel.OnSpellCheckChangeAllWebMethodSuccess OnSpellCheckChangeAllWebMethod response success"),rb=rb.Result,!rb.ReplacedCount)l.ULS.sendTraceTag(537151382,0,10,"SpellCheckModel.OnSpellCheckChangeAllWebMethodSuccess Replace Count equal to 0"),
this.em=null;else{if(!cc){this.xB.qCk(rb.ReplacedCount,this.hsb);cc=0;rb=[];for(const mc of this.JP)this.em.Row===mc.Row&&this.em.Column===mc.Column&&(rb[cc++]=mc);this.JP=rb;this.GKg();this.iTb()}}else l.ULS.sendTraceTag(537151381,0,10,"SpellCheckModel.OnSpellCheckChangeAllWebMethodSuccess OnSpellCheckChangeAllWebMethodSuccess response error"),this.em=null};this.qXj=rb=>{rb=$d.a.Qj(rb.data);l.ULS.sendTraceTag(537151380,0,10,`SpellCheckModel.OnSpellCheckChangeAllWebMethodFailed Errors: [${U.a.Kh(rb)}].`);
this.em=null};this.$=dc;this.da=J.f(dc);this.eBa=kb;this.GCc=new ec.a;this.TUf=!0;this.xB=Uc;this.C7b=[];this.XRf()}get em(){return this.H4c}set em(dc){this.H4c=dc;this.TUf?!this.em||0!==this.em.Type&&1!==this.em.Type?this.xB.WTg(!!this.em,this.qnb):fa.TaskExtensions.n_c(this.xB.V0c(this.qnb,this.wqa,D.Range.gi(this.em.Row+1,this.em.Column+1)),()=>{this.xB.WTg(!!this.em,this.qnb);return fa.TaskExtensions.N$()},this.$.xa,11,Td.a.current):l.ULS.sendTraceTag(537151443,0,50,`SpellCheckModel.ActiveSpellCheckItem Current Locale not supported: ${this.eBa}`)}get z7h(){return this.da?
this.da.ha.qa.activeCell:D.Range.gi(1,1)}get I7h(){return this.da?this.da.ha.qa.Ui:D.Range.gi(1,1)}tjj(){return!!this.R3a}XRf(){if(this.qnb=this.ipj()){var dc=this.I7h;this.wqa=v.r(dc,this.$);this.k_=v.p(dc,this.$)}else dc=this.z7h,this.wqa=v.r(dc,this.$),this.k_=v.p(dc,this.$)}qdj(dc){var Uc=this.$.pa.ta,kb=this.jRj,rb=this.iRj;const cc=Uc.Za(1,null);cc.localeName=dc;R.h(Uc,"GetSpellCheckSupportedLocaleList",cc,kb,rb,null,null,0)}iTb(){if(xb.a(this.JP)){var dc=this.$.pa.ta.Jh();this.R3a=dc.ClientRequestId;
var Uc=this.$.pa.ta,kb=this.wqa,rb=this.k_,cc=this.eBa,mc=this.GCc.toArray(),Sa=Rc.AFrameworkApplication.fa.la("ProofingWithEditorServiceInboundaryCloudSuggestionsIsEnabled"),pb=Rc.AFrameworkApplication.fa.la("IsSubscriptionForProofingUser"),Ac=this.hRj,yd=this.gRj;const vb=Uc.Za(1,null);vb.spellCheckRanges=kb;vb.batchStartCell=rb;vb.localeName=cc;vb.ignoredWords=mc;vb.isCompliant=Sa;vb.subscriptionType=pb;this.yrb=R.h(Uc,"GetSpellCheckInfo",vb,Ac,yd,null,dc,0);l.ULS.sendTraceTag(537151436,0,50,"SpellCheckModel.InvokeGetSpellCheckInfoWebMethod GetSpellCheckInfo RequestSent")}else l.ULS.sendTraceTag(537151437,
0,50,"SpellCheckModel.InvokeGetSpellCheckInfoWebMethod SpellCheck Cache Hit"),this.em=this.JP[0]}Idj(dc,Uc){const kb={};this.$.Mq(kb);kb.FirstRow=this.em.Row;kb.FirstColumn=this.em.Column;let rb;(()=>{let vb=this.iji(Uc,dc);({v3b:rb}=vb);return vb})();dc&&(this.hsb=rb);const cc=this.owa(dc),mc=this.wqa,Sa=this.$.pa.ta,pb=()=>new ab(cc,rb,kb,mc,!dc),Ac=this.em.StartIndex,yd=this.em.StartIndex+this.em.Length-1;B.a(this.$.userOperationManager,(vb,Sc,hd)=>{var qc=rb,Lc=!dc;vb=F.c(vb,this.rXj);Sc=F.b(Sc,
this.qXj);var bd=!dc;const jd=Sa.Za(1,null);jd.findData=cc;jd.activeCell=kb;jd.selectedRanges=mc;jd.replaceWith=qc;jd.isSingle=Lc;jd.startIndex=Ac;jd.endIndex=yd;return R.h(Sa,"SpellCheckChangeAll",jd,vb,Sc,hd,bd,0)},vb=>new z.a(213,0,vb,void 0,pb),null);l.ULS.sendTraceTag(537151433,0,50,"SpellCheckModel.InvokeSpellCheckChangeAllWebMethod InvokeSpellCheckChangeAll RequestSent")}Hdj(){this.R3a&&(l.ULS.sendTraceTag(537151430,0,15,"SpellCheckModel.InvokeSpellCheckCancelWebMethod Cancelling pending SpellCheck request"),
R.i(this.$.pa.ta,this.R3a,null,null,null),this.R3a=null);this.yrb&&(Rc.AFrameworkApplication.$i.HD(this.yrb.TC),this.yrb=null)}NRd(dc,Uc){Uc=void 0===Uc?!1:Uc;this.em&&!Uc&&(l.ULS.sendTraceTag(537151427,0,50,"SpellCheckModel.InvokeFeedbackLoopWebMethod SpellCheck FeedbackLoop Item added"),dc=Object(Lb.a)(new nd,{AppId:"Excel_Online",CritiquePriority:0,LanguageId:this.eBa,OriginalText:this.em.InputWord,Suggestions:this.em.Suggestions,SuggestionText:this.mMd(dc),EventId:dc,TraceId:this.em.TraceId,CritiqueTypeId:this.em.CritiqueTypeId}),
this.C7b.push(dc));if(5<this.C7b.length||Uc){l.ULS.sendTraceTag(537151426,0,50,`SpellCheckModel.InvokeFeedbackLoopWebMethod SpellCheck FeedbackLoop webmethod invoked with item count ${this.C7b.length}`);Uc=this.$.pa.ta;dc=this.C7b;const kb=Uc.Za(1,null);kb.spellCheckFeedbackLoopParametersArray=dc;R.h(Uc,"SpellCheckFeedbackLoop",kb,null,null,null,null,0);this.C7b.length=0}}OTc(dc){if(!dc)this.JP=this.H4c=this.wqa=this.k_=null;else if(this.JP){for(;1<this.JP.length;)this.JP.pop();this.qnb?(this.k_.FirstRow=
this.wqa.Ranges[0].FirstRow,this.k_.FirstColumn=this.wqa.Ranges[0].FirstColumn):(this.GKg(),this.wqa=v.u(v.F(this.k_),this.$.na))}this.Hdj();l.ULS.sendTraceTag(537151395,0,50,`SpellCheckModel.ResetSpellCheckModel SpellCheck Model Reset, keepCurrentSpellCheckItem: ${dc}`)}dBg(dc,Uc){l.ULS.sendTraceTag(537151392,0,50,`SpellCheckModel.RemoveSpellCheckItems changeAll: ${dc}, ignoreAll: ${Uc}`);xb.a(this.JP)||(Uc&&(this.GCc.contains(this.em.InputWord)?l.ULS.sendTraceTag(537151391,0,15,"SpellCheckModel.RemoveSpellCheckItems IgnoreAll words encountered again."):
this.GCc.add(this.em.InputWord)),dc||Uc?this.ZZk(dc,Uc):this.JP.splice(0,1))}jji(dc,Uc,kb){let rb=kb.substring(0,this.em.StartIndex);var cc=kb.substr(this.em.StartIndex);dc=this.mMd(dc);cc=Uc?oa.a.ytb(kb,this.em.InputWord,dc,!1,Uc,!0):rb+oa.a.ytb(cc,this.em.InputWord,dc,!1,Uc);if(!xb.a(this.JP))for(const Sa of this.JP)if(this.em.Row===Sa.Row&&this.em.Column===Sa.Column&&this.em.StartIndex<Sa.StartIndex){let pb=0;if(Uc){var mc=String.format("(^|"+qb.a.Sgb+"+)({0})(?:(?="+qb.a.Sgb+")|$)",this.em.InputWord);
rb=kb.substring(0,Sa.StartIndex);for(mc=new RegExp(mc,"g");mc.exec(rb);)++pb}else pb=1;Sa.StartIndex+=(dc.length-this.em.InputWord.length)*pb}return cc}mMd(dc){switch(dc){case 4:case 8:return this.em.Suggestions[0];case 5:case 9:return this.em.Suggestions[1];case 6:case 10:return this.em.Suggestions[2];default:return""}}owa(dc){const Uc={};Uc.SearchString=this.em.InputWord;Uc.MatchCase=!0;Uc.MatchEntireCell=!0;Uc.SearchAllSheets=!1;Uc.SearchUp=!1;Uc.ExcludeFormulaResult=!0;Uc.SheetName=this.wqa.SheetName;
dc&&(Uc.ReplaceWholeWordOnly=!0,Uc.MatchEntireCell=!1);return Uc}ipj(){return this.da.ha.qa.Gn&&!this.da.ha.qa.aya()}iji(dc,Uc){let kb,rb;rb=kb=null;if(!this.em)return l.ULS.shipAssertTag(537151378,0,!!this.em,"SpellCheckModel.EstimateSpellCheckReplaceSingleCell: ActiveSpellCheckItem is null"),{returnValue:!1,dJg:kb,v3b:rb};const cc=J.f(this.$).kh(D.Range.gi(this.em.Row+1,this.em.Column+1));if(!cc)return l.ULS.sendTraceTag(537151377,0,50,"EstimateReplaceSingleCell - currentCell is null"),{returnValue:!1,
dJg:kb,v3b:rb};kb=cc.text;kb=oa.a.Opb(kb);rb=this.jji(dc,Uc,kb);cc.text=rb;Uc&&(rb=this.mMd(dc));return{returnValue:!0,dJg:kb,v3b:rb}}ZZk(dc,Uc){if(!xb.a(this.JP)){var kb=0,rb=0,cc=[];for(const mc of this.JP)dc&&!oa.a.equals(this.em.InputWord,mc.InputWord,!1)||Uc&&!this.GCc.contains(mc.InputWord)?cc[rb++]=mc:kb++;this.JP=cc;0<kb&&l.ULS.sendTraceTag(537151374,0,50,`SpellCheckModel.TrimChangeAndIgnoreAllWordsFromCache SpellCheckItems trimmed count ${kb} for ChangeAll: ${dc}, IgnoreAll: ${Uc}`)}}GKg(){this.k_.FirstColumn=
this.em.Column+1;this.k_.FirstRow=this.em.Row;this.k_.FirstColumn===C.a.nE-1&&(this.k_.FirstColumn=0,this.k_.FirstRow=this.em.Row+1)}}Object(w.a)(He,"SpellCheckModel",null,[575]);var oc=a(181),ld=a(1406),id=a(646);class fc{constructor(dc,Uc){this.$=dc;this.xB=Uc}FS(){const dc=this.pt(!0,1,null,null,null,null,0,null,!1,null,!0);Bb.a.ut()?void ea.a.resolve(Ba.We,{va:0}).then(Uc=>Uc.hS("SpellCheckTaskPane",dc)):oc.a.Go().then(Uc=>{Uc.showTaskPane("SpellCheckTaskPane",dc);return null})}gL(dc,Uc,kb,rb,
cc,mc,Sa,pb,Ac,yd){const vb=this.pt(!1,dc,Uc,kb,rb,cc,mc,Sa,pb,Ac,yd);Bb.a.ut()?void ea.a.resolve(Ba.We,{va:0}).then(Sc=>Sc.updateTaskPane("SpellCheckTaskPane",vb)):oc.a.Go().then(Sc=>{Sc.updateTaskPane("SpellCheckTaskPane",vb);return null})}zU(){Bb.a.ut()?void ea.a.resolve(Ba.We,{va:0}).then(dc=>dc.hideTaskPane("SpellCheckTaskPane")):oc.a.Go().then(dc=>{dc.hideTaskPane("SpellCheckTaskPane",2);return null})}gOa(){Bb.a.ut()?void ea.a.resolve(Ba.We,{va:0}).then(dc=>dc.setSelectedTaskPane("SpellCheckTaskPane")):
oc.a.Go().then(dc=>{dc.setSelectedTaskPane("SpellCheckTaskPane");return null})}pt(dc,Uc,kb,rb,cc,mc,Sa,pb,Ac,yd,vb){dc=dc?{type:"SpellCheckTaskPaneProps",activeTab:1,showLoadingIcon:!0,misspelledWordBoxContent:null,suggestionBoxContent:null,userActionButtons:null,localeInfoContent:null,onMessageButtonExecute:null,previousChangeAllActionInfo:null}:this.m6h(Uc,kb,rb,cc,mc,Sa,pb,Ac,yd,vb);return Object(Lb.a)(new ld.a,{contentProps:dc,onOpen:()=>{this.xB.sha()},onClose:()=>{this.xB.qE()},width:300,title:ba.a.instance.ia(1298)})}m6h(dc,
Uc,kb,rb,cc,mc,Sa,pb,Ac,yd){let vb=null,Sc=null,hd=null,qc=null,Lc=null,bd=null,jd=!0;switch(dc){case 1:({misspelledWordBoxContent:vb,suggestionBoxContent:Sc,userActionButtons:hd,returnValue:jd}=this.F3h(Uc,kb));jd=(()=>{let Yd=this.Mhf(cc,Ac);({localeInfoContent:qc}=Yd);return Yd})().returnValue&&jd;break;case 4:({localeInfoContent:qc,returnValue:jd}=this.Mhf(cc,Ac));break;case 5:bd=()=>{this.xB.bQk()};break;case 2:case 7:case 3:bd=()=>{this.xB.XTg()};break;case 8:bd=()=>{this.xB.cQk()}}0<mc&&!(()=>
{let Yd=fc.P4h(mc,Sa);({previousChangeAllActionInfo:Lc}=Yd);return Yd})().returnValue&&l.ULS.sendTraceTag(537151372,0,10,"SpellCheckReactTaskPane.CreateSpellCheckTaskPaneProps Failed to create previous change all information.");jd||(dc=7);return{type:"SpellCheckTaskPaneProps",showLoadingIcon:yd,activeTab:dc,misspelledWordBoxContent:vb,suggestionBoxContent:Sc,userActionButtons:hd,localeInfoContent:qc,onMessageButtonExecute:bd,worksheetName:rb,previousChangeAllActionInfo:Lc,showOutOfSyncNotification:pb,
onRecheckExecute:()=>{this.xB.XTg()}}}F3h(dc,Uc){let kb;var rb;var cc=rb=kb=null;if(!dc||!Uc)return l.ULS.sendTraceTag(537151371,0,10,"SpellCheckReactTaskPane.CreateMisspelledWordTabData spellCheckItem/spellCheckCellText is null"),{returnValue:!1,misspelledWordBoxContent:kb,suggestionBoxContent:rb,userActionButtons:cc};kb={misspelledWordType:0===dc.Type?0:1,misspelledWordBeginIndex:dc.StartIndex,misspelledWordEndIndex:dc.StartIndex+dc.Length,misspelledWordCellContent:Uc};Uc=null;rb=0;if(!xb.a(dc.Suggestions))for(Uc=
Array(3),cc=0;cc<dc.Suggestions.length&&3>cc;cc++){const mc=dc.Suggestions[cc];let Sa,pb;cc?1===cc?(Sa=5,pb=9):(Sa=6,pb=10):(Sa=4,pb=8);oa.a.qz(mc)||(Uc[rb++]={suggestionText:mc,changeId:Sa,changeAllId:pb})}rb={suggestions:Uc,onChangeButtonExecute:mc=>{this.xB.Ssd(!1,mc)},onChangeAllButtonExecute:mc=>{this.xB.Ssd(!0,mc)}};cc={onIgnoreButtonExecute:()=>{this.xB.AQf(!1,0)},onIgnoreAllOrDeleteButtonExecute:()=>{1===dc.Type?this.xB.Ssd(!1,3):this.xB.AQf(!0,1)}};return{returnValue:!0,misspelledWordBoxContent:kb,
suggestionBoxContent:rb,userActionButtons:cc}}Mhf(dc,Uc){var kb=null;if(xb.a(Uc))return l.ULS.sendTraceTag(537151370,0,10,"SpellCheckReactTaskPane.CreateLocaleInfoContent supportedLocaleList is null"),{returnValue:!1,localeInfoContent:kb};kb=id.a.qU(dc);dc={localeId:dc,localeName:kb?kb.displayName:dc};const rb=Array(Uc.length);let cc=0;for(let mc=0;mc<Uc.length;mc++)(kb=id.a.qU(Uc[mc]))&&(rb[cc++]={localeId:Uc[mc],localeName:kb.displayName});kb={currentLocale:dc,supportedLocaleInfoList:rb,onLanguageChangeExecute:mc=>
{this.xB.aQk(mc)}};return{returnValue:!0,localeInfoContent:kb}}static P4h(dc,Uc){return Uc?{returnValue:!0,previousChangeAllActionInfo:{changeCount:dc,suggestionApplied:Uc}}:{returnValue:!1,previousChangeAllActionInfo:null}}}Object(w.a)(fc,"SpellCheckReactTaskPane",null,[574]);class vc{constructor(dc){this.XOa=this.eBa=null;this.lN=0;this.t7a=null;this.OYc=0;this.CVd=this.Oq=this.NX=this.xYc=!1;this.D7b=null;this.showOutOfSyncNotification=!1;this.wbe=0;this.ZK=this.hsb=null;this.en=()=>{if(3!==this.dF){var Uc=
J.f(this.$).kh(null);Uc&&this.jjc&&Uc.range.equals(this.jjc)&&(l.ULS.sendTraceTag(537151489,0,50,"SpellCheckManager.OnEditStarted SpellCheckPaneTab set to ResumeSpellCheckTab"),this.dF=2)}};this.wH=()=>{this.$.ea.gk!==C.a.kk&&this.$.ea.Ph&&(this.NX=!0)};this.hB=()=>{if(this.$.ea.gk!==C.a.kk&&this.NX&&(this.NX=!1,!this.showOutOfSyncNotification&&2!==this.dF&&3!==this.dF))if(this.L4<this.GN)if(l.ULS.sendTraceTag(537151457,0,50,`SpellCheckManager.OnGridConsistent Unexpected SpellCheck Stateid Changed Expected ${this.L4} Active ${this.GN} StateId`),
this.L4=this.GN,this.OYc=this.ijc,this.iXd)l.ULS.sendTraceTag(537151456,0,15,"SpellCheckManager.OnGridConsistent SpellCheck Stateid Changed while ongoing SpellCheck request"),this.ZK.OTc(!1),this.S5b();else if(this.em&&1===this.dF){var Uc=J.f(this.$).kh(this.jjc);Uc&&this.XOa?(Uc=Uc.rxb,Uc=oa.a.Opb(Uc),oa.a.equals(Uc,this.XOa,!0)?(l.ULS.sendTraceTag(537151454,0,50,"SpellCheckManager.OnGridConsistent SpellCheck Cache cleared except for current active SpellCheckItem"),this.ZK.OTc(!0)):(l.ULS.sendTraceTag(537151453,
0,50,"SpellCheckManager.OnGridConsistent SpellCheck cell content mismatch"),this.dF=2)):(l.ULS.sendTraceTag(537151455,0,50,"SpellCheckManager.OnGridConsistent SpellCheckFormatCell is null"),this.dF=2)}else{if(5===this.lN||6===this.lN||8===this.lN)this.showOutOfSyncNotification=!0,this.updateTaskPane()}else this.L4>this.GN&&(l.ULS.sendTraceTag(537151452,0,50,`SpellCheckManager.OnGridConsistent SpellCheck Unexpected StateId's Encountered, Expected ${this.L4} Active ${this.GN} StateId`),this.L4=this.GN)};
this.aq=(Uc,kb)=>{kb.na?(this.xYc||(this.OYc=kb.na.index,6!==this.dF&&3!==this.dF&&(this.dF=3,l.ULS.sendTraceTag(537151448,0,50,"SpellCheckManager.OnActiveSheetChanged ActiveSpellCheckPaneTab set to ReCheckSpellCheckTab"))),this.xYc=!1):(l.ULS.sendTraceTag(537151449,0,10,"SpellCheckManager.OnActiveSheetChanged Active Sheet is null"),this.dF=7)};this.Li=(Uc,kb)=>{!kb.Hl&&this.Oq&&this.qE()};this.$=dc;this.L4=this.GN;this.fbj(dc);this.ebj();this.$.Lp(this.Li)}get em(){return this.ZK.em}get dF(){return this.lN}set dF(dc){this.showOutOfSyncNotification=
!1;if(4!==this.lN&&7!==this.lN||2!==dc&&3!==dc)this.lN=dc,7!==this.lN&&4!==this.lN&&2!==this.lN&&3!==this.lN&&5!==this.lN&&6!==this.lN&&8!==this.lN||this.ZK.OTc(!1),7===this.lN&&l.ULS.shipAssertTag(537151567,0,!1,"SpellCheckManager.ActiveSpellCheckPaneTab: Unexpected State encountered"),this.Oq?(this.updateTaskPane(),this.Pok()):this.CVd=!0}get iXd(){return this.ZK.tjj()}get GN(){return this.$.ea.gk}get jjc(){return this.em?D.Range.gi(this.em.Row+1,this.em.Column+1):null}get ijc(){return this.$.na?
this.$.na.index:0}dispose(){this.$.Au(this.Li);this.$=null;this.hideTaskPane()}qCk(dc,Uc){this.wbe=dc;this.hsb=Uc}Pok(){this.wbe=0;this.hsb=null}sha(){this.Pdb();this.CVd?(this.updateTaskPane(),this.CVd=!1):(this.OYc=this.$.sa.na.index,this.t7a&&!this.t7a.IsCurrentLocaleIdSupported&&4!==this.dF?this.dF=4:this.S5b())}qE(){this.hideTaskPane();this.xsc();this.ZK.NRd(12,!0);this.ZK.OTc(!1);this.lN=0}ANk(){this.showTaskPane()}Ssd(dc,Uc){l.ULS.sendTraceTag(537151561,0,50,`SpellCheckManager.ChangeButtonClick ${dc}`);
this.iXd?l.ULS.sendTraceTag(537151560,0,10,"SpellCheckManager.ChangeButtonClick SpellCheck in progress"):(J.f(this.$).isEditing&&J.f(this.$).Cz(!0),this.ZK.Idj(dc,Uc),this.L4=this.GN+1,this.ZK.NRd(Uc),this.ZK.dBg(dc,!1),dc||this.ZK.iTb())}AQf(dc,Uc){l.ULS.sendTraceTag(537151557,0,50,`SpellCheckManager.IgnoreButtonClick ${dc}`);this.iXd?l.ULS.sendTraceTag(537151556,0,10,"SpellCheckManager.IgnoreButtonClick SpellCheck in progress"):(J.f(this.$).isEditing&&J.f(this.$).Cz(!0),this.ZK.NRd(Uc),this.ZK.dBg(!1,
dc),this.L4=this.GN,this.ZK.iTb())}aQk(dc){J.f(this.$).isEditing&&J.f(this.$).Cz(!0);l.ULS.sendTraceTag(537151553,0,50,"SpellCheckManager.SpellCheckLocaleChanged SpellCheck Locale changed");this.ZK=new He(this.$,this,dc);this.eBa=dc;this.t7a.IsCurrentLocaleIdSupported=!0;this.ZK.iTb()}cQk(){l.ULS.sendTraceTag(537151523,0,50,"SpellCheckManager.SpellCheckReCheckCurrentSheetButtonClick SpellCheck Check Current Sheet button Clicked on SpellCheck complete on selected range.");const dc=D.Range.gi(1,1);
J.f(this.$).ha.updateSelection(dc,dc,0);this.S5b()}XTg(){J.f(this.$).isEditing&&J.f(this.$).Cz(!0);l.ULS.sendTraceTag(537151521,0,50,"SpellCheckManager.SpellCheckResumeButtonClick SpellCheck Resume Button Clicked");this.S5b()}bQk(){J.f(this.$).isEditing&&J.f(this.$).Cz(!0);l.ULS.sendTraceTag(537151518,0,50,"SpellCheckManager.SpellCheckNextWorkSheetButtonClick SpellCheck NextWorkSheet Button Clicked");const dc=this.tGf(this.ijc);dc?(l.ULS.sendTraceTag(537151517,0,50,`SpellCheckManager.SpellCheckNextWorkSheetButtonClick Worksheet Change from ${this.ijc} to ${dc.index}`),
J.f(this.$).C7(),this.xYc=!0,dc.activate({scenario:"spellChecker"}),J.f(this.$).To(v.w(D.Range.gi(1,1),this.$),null,null,null,60,"SpellCheckManager.SpellCheckNextWorkSheetButtonClick"),this.S5b()):(this.xYc=!1,this.dF=7,l.ULS.sendTraceTag(537151516,0,10,"SpellCheckManager.SpellCheckNextWorkSheetButtonClick SpellCheckSwitchWorksheetTab shown when no next worksheet available."))}vre(dc){l.ULS.sendTraceTag(537151513,0,50,"SpellCheckManager.SpellCheckSupportedLocaleListReceived SpellCheck SupportedLocaleList Received from Server");
dc&&!xb.a(dc.SupportedLocaleList)?(this.t7a=dc,this.t7a.IsCurrentLocaleIdSupported||(l.ULS.sendTraceTag(537151512,0,15,"SpellCheckManager.SpellCheckSupportedLocaleListReceived ActiveSpellCheckPaneTab set to LanguageErrorTab"),this.dF=4)):(l.ULS.sendTraceTag(537151511,0,10,"SpellCheckManager.SpellCheckSupportedLocaleListReceived ActiveSpellCheckPaneTab set to SpellCheckErrorTab"),this.dF=7)}WTg(dc,Uc){if(dc&&this.em){dc=this.tGf(this.ijc);if(0===this.em.Type||1===this.em.Type){Uc=J.f(this.$).kh(this.jjc);
if(!Uc){l.ULS.sendTraceTag(537151507,0,10,"SpellCheckManager.SpellCheckModelUpdated SpellFormatCell is null");this.XOa=null;this.dF=7;return}this.XOa=Uc.rxb;this.XOa=oa.a.Opb(this.XOa);if(!oa.a.equals(this.XOa.substring(this.em.StartIndex,this.em.StartIndex+this.em.Length),this.em.InputWord,!1)){l.ULS.sendTraceTag(537151506,0,15,"SpellCheckManager.SpellCheckModelUpdated Mismatch in Client and Server Misspelled word");this.dF=2;return}this.dF=1}else this.dF=Uc?8:dc&&this.OYc!==dc.index?5:6;l.ULS.sendTraceTag(537151505,
0,50,`SpellCheckManager.SpellCheckModelUpdated, ActiveSpellCheckPaneTab set to ${this.dF}`)}else l.ULS.sendTraceTag(537151508,0,10,"SpellCheckManager.SpellCheckModelUpdated ActiveSpellCheckPaneTab set to SpellCheckErrorTab"),this.dF=7}V0c(dc,Uc,kb){Uc=dc?v.E(Uc.Ranges[0]):kb;l.ULS.sendTraceTag(537151502,0,50,`SpellCheckManager.UpdateCellSelection SpellCheck cell selection updated: isSpellCheckWithInSelection ${dc}`);J.f(this.$).ha.updateSelection(Uc,kb,0,void 0,void 0,"SpellCheck.UpdateCellSelection");
return J.a(J.f(this.$),"SpellCheck.UpdateCellSelection",void 0,60)}fbj(dc){this.D7b=new fc(dc,this)}ebj(){this.eBa=this.$.ua.DataCultureTag.toUpperCase();this.ZK=new He(this.$,this,this.eBa);this.ZK.qdj(this.eBa)}S5b(){l.ULS.shipAssertTag(537151495,0,!this.em,"SpellCheckManager.SetSpellCheckModel ActiveSpellCheckItem should be null");this.ZK.XRf();this.ZK.iTb()}Pdb(){this.$.ea.EL(this.wH);this.$.ea.gFa(this.hB);J.f(this.$).sh.nv(this.en);this.$.sa.Qm(this.aq)}xsc(){this.$.sa&&this.$.sa.hn(this.aq);
var dc=this.$.ea;dc&&(dc.TM(this.wH),dc.Xza(this.hB));(dc=J.f(this.$).sh)&&dc.ev(this.en)}tGf(dc){let Uc=(dc+1)%this.$.sa.count,kb;for(;Uc!==dc;){kb=this.$.sa.getItem(Uc);if(null===kb||void 0===kb?0:kb.visible)return kb;Uc=(Uc+1)%this.$.sa.count}return null}showTaskPane(){this.Oq?this.D7b.gOa():(this.Oq=!0,this.D7b.FS())}updateTaskPane(dc){this.D7b.gL(this.lN,this.em,this.XOa,this.$.na.sheetName,this.eBa,this.wbe,this.hsb,this.showOutOfSyncNotification,this.t7a?this.t7a.SupportedLocaleList:null,void 0===
dc?!1:dc);6!==this.lN||this.showOutOfSyncNotification||fa.TaskExtensions.Ua(Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)?Object(ha.d)(ea.a.resolve(Ba.l,{va:0})):ua.GetServiceTaskFactory.Bj(this.$.ka,211,212,0),Uc=>{Uc=Uc.result;Uc.setEnabled(!0);Uc.readText(ba.a.instance.ia(865))},this.$.xa,3)}hideTaskPane(){this.Oq=!1;this.D7b.zU()}}Object(w.a)(vc,"SpellCheckManager",null,[553,2]);let Tc=class{constructor(dc){this.xB=null;this.$=dc}Bi(){return!1}ni(dc,
Uc){return Da.EwaSettings.Ra(264)&&1===dc&&1570327544===Uc.command}executeCommand(dc,Uc){this.xB||(this.xB=new vc(this.$));dc=fa.TaskExtensions.sq();Uc=Uc.command;switch(Uc){case 1570327544:this.xB.ANk();break;default:dc=K.a(Uc)}return dc}Ji(){return!1}dispose(){this.xB&&(this.xB.dispose(),this.xB=null);this.$=null}};Tc=Object(e.__decorate)([Object(ea.d)(Ba.cg),Object(e.__param)(0,Object(Ba.Lb)())],Tc);Object(w.a)(Tc,"SpellCheckCommandHandler",null,[39,2]);let Bd=class{constructor(dc){this.$=dc}W_g(dc,
Uc){if(Qc.a.qm(dc))return!0;if(1===dc.length&&this.$.ea.isNamedObjectViewMode&&this.$.Gh.yq(dc[0]))return this.$.Gh.dqa(this.$.Gh.getItemByName(dc[0]),Uc),!0;const kb=this.$.sa.na.sheetName;Uc=oa.a.contains(dc[0],"!",!0)?dc[0].split("!")[0]:kb;const rb=[];for(const cc of dc){let mc,Sa;if((()=>{let pb=v.ib(cc,this.$.sa);({sheetName:mc,range:Sa}=pb);return pb})().returnValue){Uc=v.kb(Uc);if(mc?!oa.a.equals(Uc,mc,!0):!oa.a.equals(Uc,kb,!0))return!1;rb.push(Sa)}else if(dc=this.$.Gh.getItemByName(cc))(Sa=
dc.usedRange)&&rb.push(Sa);else return!1}l.ULS.sendTraceTag(508949829,0,50,`GotoDialog.TryToParseAndGoto: Succeeded parsing ${rb.length} ranges.`);dc=rb.length-1;J.f(this.$).p0(rb,dc,Uc,null,null,null,null,3,"GotoDialog.Commit");return!0}BVf(dc){return Qc.a.qm(dc)}Dqg(dc,Uc){return 1===dc.length&&this.$.ea.isNamedObjectViewMode&&this.$.Gh.yq(dc[0])?(l.ULS.sendTraceTag(507617353,0,20,"ViewportHelpers.handleEmptyRangeAndNovModeGoto: NOV mode goto encountered."),{kind:"NovMode",Iwa:dc[0],scenario:Uc}):
{kind:"Failure"}}H_g(dc,Uc){if(this.BVf(dc))return{kind:"Empty"};Uc=this.Dqg(dc,Uc);if(this.TYf(Uc))return Uc;Uc=this.$.sa.na.sheetName;let kb=oa.a.contains(dc[0],"!",!0)?dc[0].split("!")[0]:Uc;const rb=[];for(const cc of dc){let mc,Sa;if((()=>{let pb=v.ib(cc,this.$.sa);({sheetName:mc,range:Sa}=pb);return pb})().returnValue){kb=v.kb(kb);if(mc?!oa.a.equals(kb,mc,!0):!oa.a.equals(kb,Uc,!0))return{kind:"Failure"};rb.push(Sa)}else if(dc=this.$.Gh.getItemByName(cc))(Sa=dc.usedRange)&&rb.push(Sa);else return{kind:"Failure"}}l.ULS.sendTraceTag(507617352,
0,50,`ViewportHelpers.TryParseGotoRange: Succeeded parsing ${rb.length} ranges.`);return{kind:"Success",EWh:kb,Iqg:rb}}jLf(dc){switch(dc.kind){case "Success":const Uc=dc.Iqg.length-1;J.f(this.$).p0(dc.Iqg,Uc,dc.EWh,null,null,null,null,3,"GotoDialog.Commit");break;case "NovMode":this.$.Gh.dqa(this.$.Gh.getItemByName(dc.Iwa),dc.scenario)}}nmj(dc){return"Success"===dc.kind}TYf(dc){return"NovMode"===dc.kind}UYf(dc){return"NovMode"===dc.kind||"Success"===dc.kind}};Bd=Object(e.__decorate)([Object(ea.d)(Ba.Bg),
Object(e.__param)(0,Object(Ba.Lb)())],Bd);Object(w.a)(Bd,"ViewportHelpers",null,[]);let Fd=class{constructor(dc){this.$=dc;this.wH=()=>{this.$.ea.gk!==C.a.kk&&this.Mui(this.$.ea.gk)};this.LTc=()=>{this.VXa.clear()};this.VXa=new Map;this.$.ea.EL(this.wH);this.$.ea.NN(this.LTc);this.$.nr(this.LTc)}dispose(){var dc,Uc,kb,rb,cc;null===(Uc=null===(dc=this.$)||void 0===dc?void 0:dc.ea)||void 0===Uc?void 0:Uc.TM(this.wH);null===(rb=null===(kb=this.$)||void 0===kb?void 0:kb.ea)||void 0===rb?void 0:rb.wP(this.LTc);
null===(cc=this.$)||void 0===cc?void 0:cc.Pr(this.LTc)}exists(dc){return this.VXa.has(dc)}set(dc,Uc){this.VXa.set(dc,Uc)}delete(dc){this.VXa.delete(dc)}search(dc){for(const Uc of this.VXa){const [kb,rb]=Uc;if(dc.equals(kb))return{czf:!0,qwc:rb}}return{czf:!1,qwc:void 0}}Mui(dc){const Uc=[];for(const kb of this.VXa.keys())kb.stateID!==dc&&Uc.push(kb);for(const kb of Uc)this.VXa.delete(kb)}};Fd=Object(e.__decorate)([Object(ea.d)(Ba.ic),Object(e.__param)(0,Object(Ba.Lb)())],Fd);Object(w.a)(Fd,"FindOperationsCache",
null,[2]);var le=a(586);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Find");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ShareSection");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SpellCheck");Type.registerNamespace("_Ewa");Da.EwaSettings.isChangeGateEnabled("OfficeVSO:8622880_migrate_FindCss_FilterDialogsCss_FloatingObjectCss")?a(1460):le.a.gw('.FindDialog .ewa-dlg-body-sectionlabel{margin-bottom:5px}.FindDialog .ewa-dlg-body-fullLine{width:350px}.FindDialog input[type="text"]{width:350px}.FindDialog .ReplaceResultLabel{color:#2db932}.FindDialog .ReplaceResultLabelForFindAll{width:358px;height:auto;background:#dff6dd;border-radius:0}.FindDialog .FindUserAlertLabel{color:#d90000;margin-top:16px}.FindDialog .FindUserAlertLabelForFindAll{background:#fde7e9;border-radius:0;height:auto;width:358px}.FindDialog .FindUserInfoLabelForFindAll{border-radius:0;height:auto;width:358px}.FindDialog .FindUserAlertLabelForFindAllWrapper{padding-top:10px;padding-bottom:10px;display:inline-flex}.ewa-dlg-elements-container-ltr .FindDialog .FindUserAlertLabelForFindAllWrapper{padding-left:7px}.ewa-dlg-elements-container-rtl .FindDialog .FindUserAlertLabelForFindAllWrapper{padding-right:7px}.FindDialog .Collapsed{visibility:hidden;height:0}.ewa-dlg-elements-container-ltr .FindDialog .ChevronDivIdRotated{transform:rotate(90deg) scale(1.2)}.ewa-dlg-elements-container-rtl .FindDialog .ChevronDivIdRotated{transform:rotate(270deg) scale(1.2)}.FindDialog .ChevronStart{transform:rotate(180deg) scale(1.2)}.FindDialog .AdvancedOptionsContainer{display:flex;justify-content:space-between}.FindDialog .CollapsedAdvancedOptionsContainer{height:1px}.FindDialog .SearchOptionsContainer{display:flex;align-items:center;margin-bottom:8px;margin-top:8px}.FindDialog .SearchOptionsLabel{margin-top:0;margin-bottom:0;font-size:14px;cursor:pointer;padding-top:1px;padding-bottom:1px}.ewa-dlg-elements-container-ltr .FindDialog .SearchOptionsLabel{margin-left:7px}.ewa-dlg-elements-container-rtl .FindDialog .SearchOptionsLabel{margin-right:7px}.FindDialog .AdvancedOptionsDropdowns{display:flex;justify-content:space-between}.FindDialog .DropdownWithLabel{flex:0 0 50%}.ewa-dlg-elements-container-ltr .FindDialog .DropdownWithLabel{margin-right:2px}.ewa-dlg-elements-container-rtl .FindDialog .DropdownWithLabel{margin-left:2px}.FindDialog .FindAllTableHeader{width:358px;height:28px;background:#e9f5ee;display:block;font-size:12px;color:#252423}.FindDialog .FindAllTableHeader tr{width:inherit;height:inherit;margin:0;padding:0}.FindDialog .FindAllTableHeader th{border-bottom:1px solid #fff;padding-top:5px;padding-bottom:0;margin:0;height:auto}.ewa-dlg-elements-container-ltr .FindDialog .FindAllTableHeader th{text-align:left;padding-left:8px;border-right:1px solid #fff}.ewa-dlg-elements-container-rtl .FindDialog .FindAllTableHeader th{text-align:right;padding-right:8px;border-left:1px solid #fff}.FindDialog .FindAllTableBody{display:block;overflow-y:auto;overflow-x:hidden;height:auto;max-height:168px;width:358px}.FindDialog .FindAllRow:hover{background-color:#f3f3f3}.FindDialog .FindAllRow{width:358px;height:28px;background:#faf9f8;border-bottom:1px solid #fff}.FindDialog .FindAllTableData{font-size:12px;color:#252423;padding-top:5px}.ewa-dlg-elements-container-ltr .FindDialog .FindAllTableData{padding-left:8px;border-right:1px solid #fff}.ewa-dlg-elements-container-rtl .FindDialog .FindAllTableData{padding-right:8px;border-left:1px solid #fff}.FindDialog .FindAllTableDataSheetName{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:67px}.FindDialog .FindAllTableDataCell{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:54px}.FindDialog .FindAllTableDataValue{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:182px}.FindDialog ::-webkit-scrollbar{width:8px;height:auto}.FindDialog ::-webkit-scrollbar-track{background:#faf9f9;border-radius:10px}.FindDialog ::-webkit-scrollbar-thumb{background:#c6c6c6;height:30px;width:8px;border-radius:4px}.ewa-dlg-buttonarea.FindDialog{display:flex;flex-wrap:wrap;justify-content:flex-end;max-width:358px}.FindDialog .ewa-dlg-button{max-width:79px}');
le.a.gw(".ewr-shareSection-tooltip-container,.ewr-shareSection-floatingoject-tooltip-container{position:absolute;height:20px;display:flex;cursor:pointer;width:auto;border-radius:10px}.ewr-shareSection-tooltip-container{z-index:48}.ewr-shareSection-floatingoject-tooltip-container{z-index:51}.ewr-shareSection-tooltip-hidden{display:none}.ewr-shareSection-tooltip-flyout{position:absolute;height:20px;display:flex;background-color:#217346;overflow:hidden;border-radius:10px;min-width:20px}.ewr-grdcontarea-ltr .ewr-shareSection-tooltip-toggle-leftAndRight{right:0}.ewr-grdcontarea-rtl .ewr-shareSection-tooltip-toggle-leftAndRight{left:0}.ewr-shareSection-tooltip-textContainer{height:20px;display:flex;width:auto;max-width:300px;overflow:hidden;transition:all .1s ease-in}.ewr-shareSection-tooltip-toggle-maxWidth0{max-width:0;transition:all .1s ease-out}.ewr-shareSection-tooltip-icon,.ewr-shareSection-tooltip-close-icon{width:20px;height:20px;overflow:hidden}.ewr-shareSection-tooltip-close-icon{margin-left:-4px;margin-right:2px}.ewr-shareSection-tooltip-text{font-size:10px;color:#fff;margin:4px 2px;padding-left:6px;padding-right:4px;line-height:12px;border-right:1px solid #58a37a;white-space:nowrap}.ewr-shareSection-tooltip-toggle-maxWidth0 .ewr-shareSection-tooltip-text{border-right:none}.ewr-shareSection-highlightDiv-overlay{background-color:#217346;opacity:0;display:block;width:100%;height:100%;transition:all .1s ease-in}.ewr-shareSection-tooltip-toggle-opacity{opacity:.2;transition:all .1s ease-out}");
Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveRequireFromSlices",!1)||a(1462);String(c);String(b);String(f);String(r);String(d);String(k);String(t);String(m);window.___1708742503476_closurehack=c;window.___1708742503476_closurehack=b;window.___1708742503476_closurehack=f;window.___1708742503476_closurehack=r;window.___1708742503476_closurehack=d;window.___1708742503476_closurehack=k;window.___1708742503476_closurehack=t;window.___1708742503476_closurehack=m}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.nav.js.map/f9c205017c5637c85ea8d89a7185fd81/EwaTS.nav.js.map