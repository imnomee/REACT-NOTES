'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[17],{433:function(y,x,a){a.r(x);var c={};a.r(c);a.d(c,"EwaNotificationFocusManager",function(){return D});var b={};a.r(b);a.d(b,"FormulaRemediationManager",function(){return xa});var f={};a.r(f);a.d(f,"LineageDiscoverabilityCallout",function(){return ua});var r={};a.r(r);a.d(r,"OptimizeWorkbookManager",function(){return Wb});var d={};a.r(d);a.d(d,"ShowCalloutCommandHandler",function(){return Lc});var k={};a.r(k);
a.d(k,"TableIntelligenceDarkActivationManager",function(){return bd});var t={};a.r(t);a.d(t,"TableIntelligenceManager",function(){return Bc});var m=a(179),e=a(0),w=a(2),l=a(14),u=a(301),n=a(279),v=a(133),B=a(1265),z=a(97),C=a(5);let D=class{constructor(Ob){this.Uqd=this.FFd=null;this.z6c=this.isFocused=!1;this.$=Ob}dispose(){}get Pi(){return null}get Co(){return this.z6c}get Hk(){return n.a.c5d}zp(Ob,zc){zc||this.isFocused||!this.FFd||this.FFd();return!zc}Yp(Ob){return Ob===document.activeElement&&
this.isFocused}gs(){this.isFocused=!0}Xt(){this.isFocused&&this.Uqd&&(this.Uqd(),this.isFocused=!1)}PRf(){l.ULS.shipAssertTag(537169939,0,v.b("initializeNotificationFocusManagement"),"EwaNotificationFocusManager.InitializeFocusActions: initializeNotificationFocusManagement Api doesnt exist in AppChrome");const Ob=Object(w.a)(new B.a,{onFirstActionableAppear:()=>{u.a(this.$).Eq(this);this.z6c=!0},onLastActionableDisappear:()=>{u.a(this.$).FH(this);this.z6c=!1},onFocus:()=>{this.isFocused=!0},onBlur:()=>
{this.isFocused=!1}});appChrome.initializeNotificationFocusManagement(Ob).then(zc=>{this.FFd=()=>{zc.focus()};this.Uqd=()=>{zc.blur()};return null})}};D=Object(m.__decorate)([Object(z.d)(C.Mb),Object(m.__param)(0,Object(C.Lb)())],D);Object(e.a)(D,"EwaNotificationFocusManager",null,[220,2,59]);var J=a(80),W=a(62),N=a(1),M=a(421),Q;(function(Ob){Ob[Ob.Consent=0]="Consent";Ob[Ob.IndeterminateProgress=1]="IndeterminateProgress";Ob[Ob.DeterminateProgress=2]="DeterminateProgress";Ob[Ob.Error=3]="Error"})(Q||
(Q={}));class R extends M.a{constructor(Ob,zc){super(Ob);zc.initializeCallbacks=this.initializeCallbacks.bind(this);Ob=Object.assign({},{[R.fy]:this.ki,["hideCloseButton"]:!0},zc);this.zl=zc.initialDialogState;this.initializeAndShow("",this.XLb,Ob)}get ki(){return"UserConsentBasedProgressDialog"}hide(Ob){Ob&&super.hide()}dispose(){super.dispose()}o$i(Ob,zc){this.Nog=Ob;this.Mog=zc}h1c(Ob){this.zl=Ob.dialogState;this.O3k(Ob)}initializeCallbacks(Ob){this.O3k=Ob}XLb(Ob){1===Ob?(this.zl===Q.Consent&&
this.Nog&&this.Nog(),this.zl===Q.Error&&this.hide(!0)):2!==Ob&&0!==Ob||this.zl!==Q.Consent||(this.hide(!0),this.Mog&&this.Mog(),this.dispose())}}Object(e.a)(R,"UserConsentBasedProgressDialog",M.a,[]);var O=a(12),U=a(187);class K extends J.a{constructor(Ob){super();this.$=Ob}dispose(){var Ob;this.$=null;null===(Ob=this.ETa)||void 0===Ob?void 0:Ob.dispose();super.dispose()}p8i(Ob,zc){this.ZRf(!0);this.ETa.o$i(Ob,()=>{this.ETa=null;this.YKk(Ob,zc)})}k8i(){this.ETa?this.h1c(Q.IndeterminateProgress):this.ZRf(!1)}jG(){this.h1c(Q.Error)}DNk(){this.ETa.hide(!0)}ZRf(Ob){this.ETa||
(Ob=this.BHi(Ob),this.ETa=new R(this.$,Ob))}YKk(Ob,zc){l.ULS.sendTraceTag(507789585,0,50,"FormulaRemediationDialogController.showConfirmationDialog: User denied consent in remediation dialog.");var od=O.a.instance.ia(2458),ce=O.a.instance.ia(2459),Qb=O.a.instance.ia(2460),Xc=O.a.instance.ia(2461);const md=new U.a;md.Bh=1;md.Yh(1,Qb);md.Yh(0,Xc);md.Io(od,ce,0,ie=>{1===ie?Ob():zc()})}BHi(Ob){return Ob?{initialDialogState:Q.Consent,initialDialogTitle:O.a.instance.ia(2447),initialDialogDescription:O.a.instance.ia(2448),
okButtonLabel:O.a.instance.ia(2449),cancelButtonLabel:O.a.instance.ia(2450),knowMoreLinkLabel:O.a.instance.ia(2451)}:{initialDialogState:Q.IndeterminateProgress,initialDialogTitle:O.a.instance.ia(2454),initialDialogDescription:O.a.instance.ia(2455),progressDescription:O.a.instance.ia(2456),knowMoreLinkLabel:O.a.instance.ia(2451)}}h1c(Ob){let zc;switch(Ob){case Q.IndeterminateProgress:zc={dialogState:Q.IndeterminateProgress,dialogTitle:O.a.instance.ia(2454),dialogDescription:O.a.instance.ia(2455),
progressDescription:O.a.instance.ia(2456)};break;case Q.DeterminateProgress:zc={dialogState:Q.DeterminateProgress,dialogTitle:O.a.instance.ia(2452),dialogDescription:O.a.instance.ia(2453),progress:void 0,progressDescription:O.a.instance.ia(2456)};break;case Q.Error:zc={dialogState:Q.Error,okButtonLabel:O.a.instance.ia(2464),progressDescription:O.a.instance.ia(2465)}}this.ETa.h1c(zc)}}Object(e.a)(K,"FormulaRemediationUIController",J.a,[]);const F={f8g:!0,FBe:"NotStarted"},I={Wah:{SheetId1:3,SheetId2:2}},
P={f9g:0,jCe:["=COUNTUNIQUE(A1:A7)","=ISBETWEEN(A1,A2,A3)","=ADD(A1,A7)"]},Y={f9g:0,jCe:["=AVERAGE.WEIGHTED(A1:A4,A6:A9)","=DIVIDE(A8,A11)"]};var ea=a(122),Ba=a(35),Fa;(function(Ob){Ob.NotStarted="NotStarted";Ob.Automatic="Automatic";Ob.Guided="Guided";Ob.Completed="Completed";Ob.Skipped="Skipped"})(Fa||(Fa={}));Object(e.b)("OptimizationStage",Fa);var za;(function(Ob){Ob[Ob.NotStarted=0]="NotStarted";Ob[Ob.Success=1]="Success";Ob[Ob.Error=2]="Error"})(za||(za={}));Object(e.b)("SheetRemediationState",
za);let xa=class extends J.a{constructor(Ob){super();this.N6a={};this.$ej=N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BrokenFormulasTelemetry",!1);this.$ij=N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaRemediation",!1);this.tZg=N.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.FormulaRemediationTranspilationChunkSize",100);this.XQj=zc=>{if(zc=zc.Result)if(zc.f8g)switch(l.ULS.sendTraceTag(507789583,0,50,`FormulaRemediationManager.onGetRemediationMetadataSuccess: Broken formulas present. OptimizationStage: ${zc.FBe}`),
zc.FBe){case Fa.NotStarted:this.MXi();break;case Fa.Automatic:this.aSf()}else l.ULS.sendTraceTag(507789584,0,50,"FormulaRemediationManager.onGetRemediationMetadataSuccess: No broken formulas.");else l.ULS.sendTraceTag(507785793,0,10,"FormulaRemediationManager.onGetRemediationMetadataSuccess: remediationMetadata is null.")};this.CUi=()=>new Promise((zc,od)=>{this.CVc(ce=>{var Qb;(ce=null===(Qb=ce.Result)||void 0===Qb?void 0:Qb.Wah)||od(Error("onGetSheetsWithIncompatibleFormulasSuccess: data is null."));
zc(ce)},I,3E3,ce=>{ce=(null===ce||void 0===ce?0:ce.data)?ea.a.Qj(ce.data):null;od(Error(`onGetSheetsWithIncompatibleFormulasFailure: ${Ba.a.Kh(ce)}`))})});this.pXi=zc=>new Promise((od,ce)=>{let Qb=P;"SheetId2"===zc&&(Qb=Y);this.CVc(Xc=>{var md;(Xc=null===(md=Xc.Result)||void 0===md?void 0:md.jCe)||ce(Error("onGetUniqueIncompatibleFormulasSuccess: data is null."));od(null!==Xc&&void 0!==Xc?Xc:[])},Qb,1E3,Xc=>{Xc=(null===Xc||void 0===Xc?0:Xc.data)?ea.a.Qj(Xc.data):null;ce(Error(`onGetUniqueIncompatibleFormulasFailure: ${Ba.a.Kh(Xc)}`))})});
this.dZk=zc=>new Promise((od,ce)=>{let Qb=[],Xc=Math.ceil(zc.length/this.tZg);for(;0<zc.length;){const md=zc.splice(0,this.tZg);this.eZk(md).then(ie=>{Qb=[...Qb,...ie];1>--Xc&&od(Qb)}).catch(ie=>{ce(Error(`transpileFormulas: ${null===ie||void 0===ie?void 0:ie.message}`))})}});this.wWh=(zc,od)=>new Promise((ce,Qb)=>{this.CVc(()=>{ce()},{SheetId:zc,ifl:od},1E3,Xc=>{Xc=(null===Xc||void 0===Xc?0:Xc.data)?ea.a.Qj(Xc.data):null;Qb(Error(`FormulaRemediationManager.onCommitOptimizedFormulasFailure: ${Ba.a.Kh(Xc)}`))})});
this.vZj=zc=>{zc.Result&&l.ULS.sendTraceTag(507883930,0,50,"FormulaRemediationManager.onbrokenFormulasTelemetrySuccess: broken formula found")};this.eZk=zc=>new Promise(od=>{const ce=[];setTimeout(()=>{for(const Qb of zc)ce.push({mfl:Qb,Efl:Qb,Action:"Replace"}),od(ce)},2E3)});this.$=Ob;this.initialize()}dispose(){var Ob;this.$=null;null===(Ob=this.jdc)||void 0===Ob?void 0:Ob.dispose();this.jdc=null;super.dispose()}get LOb(){this.jdc||(this.jdc=new K(this.$));return this.jdc}initialize(){this.$ij&&
this.$.ea.e_&&this.$.isEditMode?this.zSi():this.$ej&&this.Fwj()}zSi(){this.CVc(this.XQj,F,1E3)}MXi(){this.LOb.p8i(()=>{l.ULS.sendTraceTag(507789581,0,50,"FormulaRemediationManager.OnUserConsentGiven: User provided consent.");this.aSf()},()=>{l.ULS.sendTraceTag(507789582,0,50,"FormulaRemediationManager.OnUserConsentDenied: User denied consent.");this.dispose()})}aSf(){this.LOb.k8i();this.CUi().then(Ob=>{for(const zc in Ob)this.N6a[zc]={Vil:Ob[zc],D2b:za.NotStarted};this.egk()}).catch(()=>{this.LOb.jG()})}egk(){for(const Ob in this.N6a)this.N6a[Ob].D2b!==
za.Success&&void this.fgk(Ob)}fgk(Ob){const zc=this;return No(function*(){try{const od=yield zc.pXi(Ob),ce=yield zc.dZk(od);yield zc.wWh(Ob,ce);zc.N6a[Ob].D2b=za.Success;zc.b5e()&&zc.Plg()}catch(od){(null===od||void 0===od?0:od.message)&&l.ULS.sendTraceTag(507590115,0,10,`FormulaRemediationManager.remediateFormulasForGivenSheet: ${od.message}`),zc.N6a[Ob].D2b=za.Error,zc.b5e()&&zc.Plg()}})}Plg(){l.ULS.sendTraceTag(507590114,0,50,"FormulaRemediationManager.onRemediationComplete: all sheets are processed.");
this.nFh()?this.LOb.DNk():this.LOb.jG()}nFh(){return Object.values(this.N6a).every(Ob=>Ob.D2b===za.Success)}b5e(){return Object.values(this.N6a).every(Ob=>Ob.D2b!==za.NotStarted)}Fwj(){var Ob=this.$.pa.ta,zc=this.vZj;const od=Ob.Za(1,null);W.h(Ob,"BrokenFormulasTelemetry",od,zc,null,null,null,4)}CVc(Ob,zc,od,ce){setTimeout(()=>{const Qb={};Qb.Result=null!==zc&&void 0!==zc?zc:void 0;Ob?Ob(Qb):ce(null)},od)}};xa=Object(m.__decorate)([Object(z.d)(C.Lc),Object(m.__param)(0,Object(C.Lb)())],xa);Object(e.a)(xa,
"FormulaRemediationManager",J.a,[]);var fa=a(1435),V=a(1092),ba=a(1093),la=a(182),Ta=a(181);class Ea{constructor(Ob){this.LM=null;this.$=Ob}show(){const Ob=this.ewa();l.ULS.shipAssertTag(537169938,0,!!Ob,"EwaReactCallout.Show: Cannot retrieve the Callout Parameters");Ta.a.hK().then(zc=>{const od=zc.callout(Ob);this.LM=zc.addNotification(od)},zc=>{l.ULS.sendTraceTag(537169936,0,15,`EwaReactCallout.Show: Failed to GetNotificationsAPIAsync: ${zc}`);return null})}dismiss(){this.LM&&Ta.a.hK().then(Ob=>
{Ob.removeNotification(this.LM);return this.LM=null})}F8a(Ob){Ta.a.hK().then(zc=>{zc.updateNotification(this.LM,zc.callout(Object.assign(new V.a,Ob)))},zc=>{l.ULS.sendTraceTag(522782336,0,15,`EwaReactCallout.Update: Failed to GetNotificationsAPIAsync: ${zc}`);return null})}}Object(e.a)(Ea,"EwaReactCallout",null,[879]);class sa{static Vmb(Ob){return!!(Ob&1)}static cHc(Ob){return!!(Ob&2)}static L4g(Ob){return!!(Ob&sa.i8i)}}sa.i8i=6;Object(e.a)(sa,"EwaReactCalloutModeUtil",null,[]);class Ya{constructor(){this.nO=
0;this.YKa=null;this.W7b=!0}}Object(e.a)(Ya,"EwaReactShowOrDismissCalloutMetadata",null,[]);var bb=a(65),ra=a(40),Da=a(129),oa=a(1016);class Ha{constructor(Ob,zc,od){this.indexedDB=null;this.$=Ob;this.VN=zc;this.tVa=od}M_d(){const Ob=new la.a,zc=new Ya;ra.TaskExtensions.Ua(this.nqf(),od=>{od.result?ra.TaskExtensions.Ua(this.indexedDB.MYa(this.VN),ce=>{if(ce=ce.result){ce=bb.a.Gp(ce);if(!ce){this.Svf(Ob);return}if(sa.Vmb(this.tVa)){const Qb=ce.NumberOfDisplays;zc.nO=Qb?Number.parseLocale(Qb):0}sa.cHc(this.tVa)&&
(ce=ce.LastDisplay,zc.YKa=ce?new Date(Number.parseLocale(ce)):null)}Ob.setResult(zc)},this.$.xa):this.Svf(Ob)},this.$.xa,3);return Ob.task}ake(Ob){const zc=new la.a;ra.TaskExtensions.Ua(this.nqf(),od=>{od.result||zc.setResult(!1);od={};sa.Vmb(this.tVa)&&(od.NumberOfDisplays=Ob.nO.toString());sa.cHc(this.tVa)&&(od.LastDisplay=Da.toTimestamp(Ob.YKa).m.toString());od=bb.a.li(od);ra.TaskExtensions.Ua(this.indexedDB.W5a(new oa.a(this.VN,od)),ce=>{zc.setResult(ce.result)},this.$.xa,3)},this.$.xa,3)}nqf(){const Ob=
new la.a;this.indexedDB?Ob.setResult(!0):void z.a.resolve(C.qd,{va:1}).then(zc=>{zc.jl()?(zc.initialize("Callouts","EwaCallouts"),this.indexedDB=zc,Ob.setResult(!0)):(l.ULS.sendTraceTag(573609248,0,50,"EwaReactShowOrDismissCalloutIndexedDBLoaderSaver.EnsureIndexedDB: IndexedDb is not supported."),Ob.setResult(!1))});return Ob.task}Svf(Ob){const zc=new Ya;zc.W7b=!1;Ob.setResult(zc)}}Object(e.a)(Ha,"EwaReactShowOrDismissCalloutIndexedDBLoaderSaver",null,[878]);class ka{constructor(Ob,zc,od,ce,Qb,Xc){this.Ieb=
zc;this.Keb=od;this.tVa=ce;this.VN=Qb;this.localStorage=Xc;this.$=Ob}M_d(){const Ob=new la.a,zc=new Ya;if(sa.Vmb(this.tVa)){let od=0;zc.W7b=(()=>{let ce=this.H_k();({Yaa:od}=ce);return ce})().returnValue&&zc.W7b;zc.nO=od}Ob.setResult(zc);return Ob.task}ake(Ob){const zc=new la.a;var od=!0;if(sa.Vmb(this.tVa)){const ce=this.FBf();ce&&(od=Number.parseLocale(ce),od=this.r0k((od&~this.Keb|Ob.nO<<this.Ieb).toString()))}zc.setResult(od)}H_k(){var Ob;return(Ob=this.FBf())?(Ob=(Number.parseLocale(Ob)&this.Keb)>>
this.Ieb,l.ULS.sendTraceTag(537169932,0,50,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver - Callout ${this.VN} already appeared. Found the callout in storage.`),{returnValue:!0,Yaa:Ob}):{returnValue:!1,Yaa:0}}r0k(Ob){try{if(!this.localStorage.jl())return!1;try{return this.localStorage.setItem("CalloutIds",Ob),!0}catch(zc){l.ULS.sendTraceTag(537169931,0,15,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.TrySaveCalloutIdsToCache: Failed to set item to cache. reason: ${zc.message||"Unknown"}`)}}catch(zc){l.ULS.sendTraceTag(537169930,
0,15,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.TrySaveCalloutIdsToCache: Got Exception when trying to save calloutIds to cache. e.Message: ${zc.message}`)}return!1}FBf(){try{if(!this.localStorage.jl())return l.ULS.sendTraceTag(537169929,0,50,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.GetCalloutIdsFromCache: Local storage is not supported and display count (if any) won't be saved for ${this.VN}.`),null;const Ob=this.localStorage.getItem("CalloutIds");return Ob?Ob:(l.ULS.sendTraceTag(537169928,
0,15,"EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.GetCalloutIdsFromCache: item doesn't exist in local storage"),"0")}catch(Ob){return l.ULS.sendTraceTag(537169927,0,15,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.GetCalloutIdsFromCache: Got Exception when trying to get calloutIds. e.Message: ${Ob.message}`),null}}}Object(e.a)(ka,"EwaReactShowOrDismissCalloutLocalStorageLoaderSaver",null,[878]);var wa=a(69),Za=a(150),ab=a(199),db=a(151),mb=a(667);class Ia extends Ea{constructor(Ob,
zc,od,ce,Qb,Xc,md,ie,me,Pe,gf,tf,Qe,Ca,yb,wc,dd,vd,Zd){Pe=void 0===Pe?!1:Pe;gf=void 0===gf?!1:gf;tf=void 0===tf?!1:tf;Qe=void 0===Qe?!1:Qe;Ca=void 0===Ca?!1:Ca;yb=void 0===yb?!0:yb;wc=void 0===wc?!1:wc;dd=void 0===dd?null:dd;vd=void 0===vd?!1:vd;Zd=void 0===Zd?!1:Zd;super(Ob);this.nO=0;this.Fzd=this.Vpe=this.S2c=this.q6g=!1;this.qlg=()=>{this.yDc()};this.y6c=zc;this.GXc=od;this.Qbi=ce;this.MA=Qb;this.ay=Xc;this.localStorage=me;this.x6c=md;this.w6c=ie;this.wuj=Pe;this.qPd=gf;this.Ubi=tf;this.setInitialFocus=
Qe;this.useCoachmark=Ca;this.IUc=!1;this.WAk=yb;this.BYb=this.xKd();this.Jeb=dd;this.Vpe=vd;this.hasDynamicSizing=wc;this.Fzd=Zd}get edb(){return{}}MAe(){}LIa(){return 1}oyc(){return 0}get Yaa(){return 1}get Ctg(){return!0}get VN(){return this.y6c}get Keb(){return this.x6c}get Ieb(){return this.w6c}show(){ra.TaskExtensions.Ua(this.lqa(),Ob=>{Ob.result&&this.bqe()},this.$.xa)}o5f(){db.b(this.$).lj(Za.a.Srf,this.mKf("dismiss"),void 0,!0)}w6f(){db.b(this.$).lj(Za.a.Srf,this.mKf("show"),void 0,!0)}ewa(){var Ob=
Object(w.a)(new fa.a,{label:this.Qbi,onExecute:()=>{this.MAe();this.o5f();this.S2c=!0;this.yDc()}});let zc=null;this.qPd||(zc=Object(w.a)(new fa.a,{label:this.GXc,onExecute:()=>{this.S2c=!0;this.w6f();const ce=ab.c({["InputMethod"]:wa.a.eh},this.edb);this.$.Ma.dh(this.ribbonCommandInfo,ce);this.yDc()}}));const od=this.Fzd||this.qPd?Ob:zc;Ob=this.qPd?null:this.Fzd?zc:Ob;return Object(w.a)(new V.a,{target:this.$fa(),content:this.ay,title:this.MA,primaryButtonProps:od,secondaryButtonProps:Ob,showCloseIcon:this.Vpe,
preventLightDismiss:!this.wuj,hasDynamicSizing:this.hasDynamicSizing,calloutProps:Object(w.a)(new ba.a,{onDismiss:()=>{this.yDc()},directionalHint:this.Jeb,preventDismissOnScroll:!0,preventDismissOnResize:!this.Ubi,isBeakVisible:this.WAk,setInitialFocus:this.setInitialFocus}),useTeachingStyles:!0,hasFocusableControls:!0,useCoachmark:this.useCoachmark})}yDc(){this.q6g=!0;const Ob=z.a.Zg(C.Ne);Ob&&Ob.wkk(this.qlg);(this.Ctg&&this.S2c||this.Vpe)&&this.O_g(!0);this.S2c||l.ULS.sendTraceTag(537169935,0,
50,`EwaReactShowOrDismissCallout - Callout ${this.VN} was dismissed without user interaction`);this.dismiss()}lqa(){const Ob=new la.a;this.aaa()?ra.TaskExtensions.Ua(this.BYb.M_d(),zc=>{var od=this.LIa();zc=zc.result;if(zc.W7b)if(this.nO=zc.nO,sa.Vmb(od)&&(this.IUc||zc.nO>=this.Yaa))l.ULS.sendTraceTag(573609250,0,50,`EwaReactShowOrDismissCallout - Callout ${this.VN} already appeared. Found the callout in storage.`),this.IUc=!0,Ob.setResult(!1);else{if(sa.cHc(od)&&zc.YKa&&(od=Da.getElapsedSeconds(zc.YKa,
new Date),(zc=this.oyc())||l.ULS.shipAssertTag(537169933,0,!1,`GetCooldownPeriodInSeconds returned 0 callout ${this.VN} with mode RestrictedBycooldown`),od<zc)){Ob.setResult(!1);return}od=!this.LM&&!!this.$fa()&&!mb.a(this.$);Ob.setResult(od)}else Ob.setResult(!1),l.ULS.sendTraceTag(537169934,0,50,`EwaReactShowOrDismissCallout.ShouldShowCallout: Failed to retrieve metadata for callout ${this.VN}.`)},this.$.xa):Ob.setResult(!1);return Ob.task}aaa(){return!0}$fa(){if(document.querySelector(this.kV))return this.kV;
if(document.querySelector(this.jV))return this.jV;if(document.querySelector(this.QU))return this.QU;l.ULS.shipAssertTag(592528907,0,!1,`EwaReactShowOrDismissCallout.GetTargetObject: Cannot retrieve the Callout Target Object, Callout: ${this.VN}`);return null}O_g(Ob){Ob=void 0===Ob?!1:Ob;this.IUc=!0;const zc=new Ya;zc.nO=Ob?this.Yaa:this.nO+1;zc.YKa=new Date;this.BYb.ake(zc)}bqe(){this.IUc=!0;this.O_g();l.ULS.sendTraceTag(593494082,0,50,`EwaReactShowOrDismissCallout - Showing ${this.VN} callout, current number of displayes: ${this.nO}`);
void z.a.hj(C.Ne).then(Ob=>{this.q6g||Ob.lAh(this.qlg)});super.show()}xKd(){const Ob=this.LIa();return sa.L4g(Ob)?new Ha(this.$,this.VN,Ob):new ka(this.$,this.Ieb,this.Keb,Ob,this.VN,this.localStorage)}mKf(Ob){return{["selection"]:Ob,["callout"]:this.VN,["Location"]:"floatie",["displayCount"]:this.nO}}}Object(e.a)(Ia,"EwaReactShowOrDismissCallout",Ea,[]);var pa=a(86),lb=a(264),ha;let ua=ha=class extends Ia{constructor(Ob){super(Ob,ha.Cuj,O.a.instance.Ba(650),O.a.instance.Ba(652),O.a.instance.Ba(648),
O.a.instance.Ba(649),3072,10,new lb.a)}cJk(){return this.lqa()}get kV(){return"[data-unique-id=Review]"}get jV(){return"[data-unique-id=pivotOverflowButton]"}get QU(){return'[id="'+this.$.$h+'Ribbon.Review-title"]'}get Ctg(){return!1}get ribbonCommandInfo(){return new pa.a(1834994092,wa.a.eh,this.$.Rh,9,null)}get Yaa(){return 2}LIa(){return 3}oyc(){return 86400}aaa(){return this.$.ea.vob}};ua.Cuj="LineageDiscoverabilityCallout";ua=ha=Object(m.__decorate)([Object(z.d)(C.Dd),Object(m.__param)(0,Object(C.Lb)())],
ua);Object(e.a)(ua,"LineageDiscoverabilityCallout",Ia,[850]);var fb=a(42);const Ka=(Ob,zc,od,ce,Qb,Xc,md)=>{md=Ob.Za(1,void 0===md?null:md);md.sheetName=zc;return W.h(Ob,"EvaluateSheetOptimizableContent",md,od,ce,Qb,Xc,4)};var La=a(24),ib=a(44),Yb=a(158);class Wc{constructor(Ob,zc){this.sessionID=null;this.Tpg=od=>{if(od){let ce=ib.d(od.data);({hz:od}=ce);if(ce.returnValue&&(od=Object(Yb.a)(Object,od))&&"OptimizeWorkbookTaskPane"===od.Origin)if(this.sessionID!==od.SessionId)l.ULS.sendTraceTag(509748062,
0,10,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(od.Event){case "CoauthorsDetected":this.p_j.VKk();l.ULS.sendTraceTag(508117312,0,50,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - Coauth error dialog shown.");break;default:l.ULS.sendTraceTag(509748060,0,10,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - Unhandled Event.")}}};
this.p_j=Ob;this.sessionID=zc}initialize(){window.addEventListener("message",this.Tpg,!1)}dispose(){window.removeEventListener("message",this.Tpg,!1)}}Object(e.a)(Wc,"OptimizeWorkbookTaskPaneListener",null,[]);var Qc=a(93);let Wb=class extends J.a{constructor(Ob){super();this.businessBar=null;this.LAb=2;this.$Cb=-1;this.JUc=!1;this.n0b=null;this.xBc=!1;this.nOj=zc=>{this.$&&((zc=zc.Result)?zc.HasSignificantOptimizableContent?(l.ULS.sendTraceTag(539870352,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Operation completed with significant optimizable content"),
N.EwaSettings.isChangeGateEnabled("OfficeVSO:8234692_8093480_EnableDisableBizBarOnCoauthEvent")&&this.$.ea.Vda(this.sE),zc.OptimizableRangesOrPercentage&&(this.$Cb=zc.OptimizableRangesOrPercentage),0>=this.$Cb&&0!==this.LAb&&(l.ULS.sendTraceTag(512349446,0,50,"OptimizeWorkbookManager.OptimizableRangesOrPercentage Range count or percentage must return valid value"),this.LAb=0),N.EwaSettings.isChangeGateEnabled("OfficeVSO:8234692_8093480_EnableDisableBizBarOnCoauthEvent")&&!zc.Completed?l.ULS.sendTraceTag(508170697,
0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Operation was marked as not complete"):this.S6a()):l.ULS.sendTraceTag(537154764,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Operation completed without significant optimizable content"):l.ULS.sendTraceTag(537154763,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Null result object"))};this.JVj=(zc,od,ce)=>{(zc=zc.Result)?zc.HasSignificantOptimizableContent?(l.ULS.sendTraceTag(512304643,0,50,"OptimizeWorkbookManager.onRetrieveSuccess: Operation completed with significant optimizable content"),
this.JUc=!0,this.yNk(od,ce)):l.ULS.sendTraceTag(512304644,0,50,"OptimizeWorkbookManager.onRetrieveSuccess: Operation completed without significant optimizable content"):l.ULS.sendTraceTag(512304645,0,50,"OptimizeWorkbookManager.onRetrieveSuccess: Null result object")};this.sE=(zc,od)=>{zc=1<od.K4g;this.xBc||zc?this.xBc&&zc&&(this.businessBar&&this.businessBar.N5(62)&&(l.ULS.sendTraceTag(508170695,0,50,"OptimizeWorkbookManager.onUserListChanged: Hide the business bar"),this.s0()),this.$.ea.g7(this.sE)):
(this.S6a(),this.xBc=!0,l.ULS.sendTraceTag(508170696,0,50,"OptimizeWorkbookManager.onUserListChanged: Show the business bar"))};this.$=Ob;this.RQk();this.JUc=!1;this.Iei=N.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.SlowOperationDurationThreshold",2E3);this.n0b=new Wc(this,this.$.ea.sessionId)}dispose(){this.s0();N.EwaSettings.isChangeGateEnabled("OfficeVSO:8234692_8093480_EnableDisableBizBarOnCoauthEvent")&&this.$.ea.g7(this.sE);this.$=this.businessBar=null;this.Omf();super.dispose()}lbj(){this.n0b&&
this.n0b.initialize()}Omf(){this.n0b&&this.n0b.dispose()}s0(){this.businessBar&&this.businessBar.N5(62)&&this.businessBar.removeEntry(62)}RQk(){fb.a.instance.Qi("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Ob=>{Ob.isFeatureEnabled("ExcelOptimizeCellTableBigHammer",!1).then(zc=>{if(zc){var od=this.$.pa.ta,ce=this.LAb,Qb=this.nOj;const Xc=od.Za(1,null);Xc.businessBarMessageType=ce;W.h(od,"EvaluateOptimizableContentV2",Xc,Qb,null,null,null,4)}return zc})})}S6a(){this.xBc=
!0;const Ob=Object(Qc.d)(z.a.resolve(C.C,{va:1}));ra.TaskExtensions.Ua(Ob,()=>{const zc=Ob.result;zc&&(zc.xm(62,null,null,this.SDi()),this.businessBar=zc)},this.$.xa,3)}SDi(){switch(this.LAb){default:return O.a.instance.ia(2239);case 1:return String.format(O.a.instance.Ba(720),this.$Cb);case 2:return String.format(O.a.instance.Ba(721),this.$Cb)}}Mia(Ob,zc,od){if(zc&&zc.RequestTelemetryData&&!(zc.RequestTelemetryData.EcsOperationDuration<this.Iei)&&this.businessBar&&this.businessBar.N5(62)&&!this.JUc){var ce=
od?od:this.$.na.sheetName;if(6===Ob||7===Ob||8===Ob||9===Ob)this.evaluateSheetOptimizableContent(ce,Ob,zc.RequestTelemetryData.EcsOperationDuration);else{const Qb=()=>{La.f(this.$).za.Ix(Qb);this.evaluateSheetOptimizableContent(ce,Ob,zc.RequestTelemetryData.EcsOperationDuration)};La.f(this.$).za.Uy(Qb)}}}evaluateSheetOptimizableContent(Ob,zc,od){Ka(this.$.pa.ta,Ob,ce=>{this.JVj(ce,zc,od)},null,null,null)}yNk(Ob,zc){const od=new pa.a(-847286761,wa.a.eh,this.$.Rh,0,null),ce={CalloutName:18};ce.Target=
this.businessBar.MHd(62);ce.Operation=Ob;ce.Duration=zc;this.$.Ma.dh(od,ce)}VKk(){const Ob=new U.a;Ob.Bh=0;Ob.Io(O.a.instance.Ba(874),O.a.instance.Ba(875),0)}};Wb=Object(m.__decorate)([Object(z.d)(C.ke),Object(m.__param)(0,Object(C.Lb)())],Wb);Object(e.a)(Wb,"OptimizeWorkbookManager",J.a,[853]);var Jc=a(10);const ma='[id="'+Jc.a.JUg+'"]';class Hc extends Ia{constructor(Ob,zc,od,ce,Qb,Xc,md,ie,me,Pe){super(Ob,zc,null,od,ce,Qb,Xc,md,new lb.a,ie,!0,!0,me,!1,!1,void 0,Pe)}get kV(){return ma}get jV(){return ma}get QU(){return ma}get ribbonCommandInfo(){return new pa.a(-847286761,
wa.a.eh,this.$.Rh,0,null)}aaa(){return!(this.$.isMobileMode||this.$.ea.th.inEmbedView||this.$.ea.th.inWebPart)}}Object(e.a)(Hc,"ZoomTeachingCallout",Ia,[]);class Kb extends Hc{constructor(Ob){super(Ob,"AdjustZoomTeachingCallout",O.a.instance.Ba(694),null,O.a.instance.Ba(693),2,1,!1,!0,2)}}Object(e.a)(Kb,"AdjustZoomTeachingCallout",Hc,[]);class pc extends Ia{constructor(Ob){super(Ob,"ConditionalFormattingManageRulesTeachingCallout",O.a.instance.Ba(643),O.a.instance.Ba(644),O.a.instance.Ba(641),O.a.instance.Ba(642),
2,1,new lb.a)}get kV(){return"[data-unique-id=Ribbon-ConditionalFormatting]"}get jV(){return'[data-unique-id="RibbonOverflowMenu"]'}get QU(){return'[id="m_excelWebRenderer_ewaCtl_Styles.CondFmt-Large"]'}get ribbonCommandInfo(){return new pa.a(-20558303,wa.a.eh,this.$.Rh,0,null)}}Object(e.a)(pc,"ConditionalFormattingManageRulesTeachingCallout",Ia,[]);var $b;(function(Ob){Ob[Ob.overrideBrowserShortcuts=0]="overrideBrowserShortcuts";Ob[Ob.conditionalFormattingManageRules=1]="conditionalFormattingManageRules";
Ob[Ob.linkedEntityBlankCellConvert=2]="linkedEntityBlankCellConvert";Ob[Ob.linkedEntityNoCuratedData=3]="linkedEntityNoCuratedData";Ob[Ob.lineageDiscoverability=4]="lineageDiscoverability";Ob[Ob.linkedEntityFirstOrganizationData=6]="linkedEntityFirstOrganizationData";Ob[Ob.adjustZoomTeachingCallout=7]="adjustZoomTeachingCallout";Ob[Ob.linkedEntityGallery=8]="linkedEntityGallery";Ob[Ob.fixedFreezePane=9]="fixedFreezePane";Ob[Ob.phoneticTeachingCallout=10]="phoneticTeachingCallout";Ob[Ob.powerQueryCallout=
11]="powerQueryCallout";Ob[Ob.tableAIConvertToTableCallout=12]="tableAIConvertToTableCallout";Ob[Ob.optimizeWorkbookBusinessBarCallout=13]="optimizeWorkbookBusinessBarCallout";Ob[Ob.tableInNewWorkbook=14]="tableInNewWorkbook";Ob[Ob.formulaByExampleCurtainLifterCallout=15]="formulaByExampleCurtainLifterCallout";Ob[Ob.dataCleansing=16]="dataCleansing";Ob[Ob.optimizeWorkbookSlowOperationsCallout=18]="optimizeWorkbookSlowOperationsCallout";Ob[Ob.excelLiveWebEntryPointCallout=20]="excelLiveWebEntryPointCallout";
Ob[Ob.functionDialog=21]="functionDialog";Ob[Ob.ctrlClickHyperlink=22]="ctrlClickHyperlink";Ob[Ob.fullScreen=23]="fullScreen";Ob[Ob.length=24]="length"})($b||($b={}));Object(e.b)("EwaCalloutName",$b);var Ib=a(39);class Zb extends Hc{constructor(Ob){super(Ob,"FixedFreezePaneTeachingCallout",O.a.instance.Ba(647),O.a.instance.Ba(645),O.a.instance.Ba(646),65536,16,!0,!1,8)}LIa(){return 0}}Object(e.a)(Zb,"FixedFreezePaneTeachingCallout",Hc,[]);var Eb=a(107),ob=a(7),Na=a(59),nb=a(27),Hb=a(1117);class na extends Hb.a{constructor(Ob){super("TextAboveImage");
this.imageHeight=this.imageWidth=this.image=this.paragraphs=null;this.paragraphs=Ob.paragraphs;this.image=Ob.image;this.imageWidth=Ob.imageWidth;this.imageHeight=Ob.imageHeight}}Object(e.a)(na,"TextAboveImage",Hb.a,[]);class Gb{constructor(Ob,zc){this.imageHeight=this.imageWidth=this.image=this.paragraphs=null;this.paragraphs=Ob;this.image=zc}}Object(e.a)(Gb,"TextAboveImageCustomProps",null,[]);var Xa=a(1116),Jb=a(354);class qb extends Ea{constructor(Ob){super(Ob);this.lKg=0;this.d7a=this.target=
null;this.a2c=!1;this.ay=this.MA=null;this.Fqd=0}TX(Ob,zc,od,ce,Qb,Xc){if(!this.xt()){switch(ce){case "DataTypes_PBI":this.Fqd=1;break;default:this.Fqd=0}this.target=Ob;this.MA=String.format(O.a.instance.Ba(676),zc);this.ay=String.format(O.a.instance.Ba(677),od);this.lKg=Xc;this.Wxk(ce,Qb)}}Wxk(Ob,zc){const od=!!this.$.ua&&nb.a.equals(this.$.ua.UICultureTag,"en-us",!0);this.a2c=zc&&od;zc&&!od?this.d7a="BlankCell":Ob?this.d7a=Ob:(l.ULS.sendTraceTag(537169926,0,15,"LinkedEntityBlankCellConvertTeachingCallout.SetActionButtonAndSidePaneId: Callout BlankCellResourceId was null"),
this.d7a="BlankCell")}show(){l.ULS.shipAssertTag(537169925,0,!!this.target&&!!this.ay&&!!this.MA,"LinkedEntityBlankCellConvertTeachingCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");this.xt()||(l.ULS.sendTraceTag(537169924,0,50,"LinkedEntityBlankCellConvertTeachingCallout.Show() - Showing LinkedEntityBlankCellConvertTeachingCallout callout."),super.show())}xt(){return!!this.LM}ewa(){const Ob=Object(w.a)(new fa.a,{label:O.a.instance.Ba(682),ariaDescription:O.a.instance.Ba(683),
onExecute:()=>{l.ULS.sendTraceTag(537169923,0,50,'LinkedEntityBlankCellConvertTeachingCallout - clicked "Got it" button');this.dismiss()}}),zc=Object(w.a)(new fa.a,{label:this.a2c?O.a.instance.Ba(680):O.a.instance.Ba(678),ariaDescription:this.a2c?O.a.instance.Ba(681):O.a.instance.Ba(679),onExecute:()=>{l.ULS.sendTraceTag(537169922,0,50,'LinkedEntityBlankCellConvertTeachingCallout - clicked "'+(this.a2c?"Try sample data":"Learn more")+'" button');var Xc=new Map;Xc.set("Domain",this.lKg.toString());
Eb.Health.instance.recordKpiUsage("LinkedEntityBlankCellCalloutActionUsed",Jb.b.FailureBased,"ropari",Xc);Xc=new pa.a(-859308420,wa.a.eh,this.$.Rh,9,null);this.$.Ma.dh(Xc,{[wa.a.Wk]:"HelpID="+this.d7a,["InputMethod"]:wa.a.eh,["ShouldCanvasTakeFocus"]:!0,[wa.a.Ai]:ob.a.CI});this.dismiss()}});var od=!!this.$&&!!this.$.frame&&!!this.$.frame.oM&&this.$.frame.oM.YX;switch(this.Fqd){case 1:var ce=od?127:124;break;default:ce=od?126:121}ce=Object(w.a)(new Xa.a(Na.a.current.uu(ce)),{alt:O.a.instance.$g(184)});
const Qb=this.ay.split("\n\n");od=Object(w.a)(new Gb(Qb,ce),{imageWidth:280,imageHeight:od?142:192});od=new na(od);return Object(w.a)(new V.a,{target:this.target,content:od,title:this.MA,primaryButtonProps:zc,secondaryButtonProps:Ob,showCloseIcon:!0,calloutProps:Object(w.a)(new ba.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!0,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!0})}}Object(e.a)(qb,"LinkedEntityBlankCellConvertTeachingCallout",
Ea,[]);class Db extends Ia{constructor(Ob){super(Ob,"LinkedEntityFirstOrganizationDataCallout",O.a.instance.Ba(672),O.a.instance.Ba(674),O.a.instance.Ba(670),O.a.instance.Ba(671),8192,13,new lb.a,void 0,void 0,!0,!0);this.target=null;this.d7a="DataTypes_PBI"}get kV(){return this.target.toString()}get jV(){return this.target.toString()}get QU(){return'[id="'+this.$.$h+'Ribbon.Data.LinkedEntity"]'}get ribbonCommandInfo(){return new pa.a(-859308420,wa.a.eh,this.$.Rh,9,null)}get edb(){return{[wa.a.Wk]:"HelpID="+
this.d7a,["ShouldCanvasTakeFocus"]:!0,[wa.a.Ai]:ob.a.CI}}TX(Ob){this.xt()||(this.target=Ob,this.d7a="DataTypes_PBI")}xt(){return!!this.LM}aaa(){l.ULS.shipAssertTag(537169921,0,!!this.target,"LinkedEntityFirstOrganizationDataTeachingCallout.InternalShouldShowCallout(): Cannot retrieve the callout target. InitializeCalloutProperties should be called before InternalShouldShowCallout");return!this.xt()}}Object(e.a)(Db,"LinkedEntityFirstOrganizationDataTeachingCallout",Ia,[]);class gb extends Ia{constructor(Ob){super(Ob,
"LinkedEntityGalleryTeachingCallout","",O.a.instance.Ba(682),O.a.instance.Ba(684),O.a.instance.Ba(685),49152,14,new lb.a,void 0,!0,!0,!0,!0);this.target=null;this.Jeb=5}get Yaa(){return 2}get kV(){return this.target.toString()}get jV(){this.Jeb=7;return"[data-unique-id=Ribbon-ConvertToLinkedEntityGallery]"}get QU(){return""}get ribbonCommandInfo(){return new pa.a(-847286761,wa.a.eh,this.$.Rh,0,ob.a.Hsb)}show(){l.ULS.shipAssertTag(537169920,0,!!this.target,"LinkedEntityGalleryTeachingCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");
this.xt()||(l.ULS.sendTraceTag(558690322,0,50,"LinkedEntityGalleryTeachingCallout.Show() - LinkedEntityGalleryTeachingCallout Coachmark was shown."),super.show())}TX(Ob){this.xt()||(this.target=Ob)}xt(){return!!this.LM}aaa(){l.ULS.shipAssertTag(537168099,0,!!this.target,"LinkedEntityGalleryTeachingCallout.InternalShouldShowCallout(): Cannot retrieve the callout target. InitializeCalloutProperties should be called before InternalShouldShowCallout");return!this.xt()}}Object(e.a)(gb,"LinkedEntityGalleryTeachingCallout",
Ia,[]);var ya=a(13);class Aa extends Ea{constructor(Ob){super(Ob);this.ay=this.MA=this.target=null}TX(Ob,zc,od){this.xt()||(this.target=Ob,this.MA=String.format(O.a.instance.$g(186),zc),this.ay=String.format(O.a.instance.$g(188),od))}show(){l.ULS.shipAssertTag(537168098,0,!!this.target&&!!this.ay&&!!this.MA,"LinkedEntityNoCuratedDataTeachingCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");this.xt()||(l.ULS.sendTraceTag(537168097,0,50,"LinkedEntityNoCuratedDataTeachingCallout.Show() - Showing LinkedEntityNoCuratedDataTeachingCallout callout."),
super.show())}xt(){return!!this.LM}ewa(){const Ob=Object(w.a)(new fa.a,{label:O.a.instance.ia(1806),ariaDescription:O.a.instance.ia(1807),onExecute:()=>{l.ULS.sendTraceTag(537168096,0,50,'LinkedEntityNoCuratedDataTeachingCallout - clicked "Learn how" button');Eb.Health.instance.recordKpiUsage("LinkedEntityNoCuratedDataCalloutActionUsed",Jb.b.FailureBased,"ropari",null);ya.HelperMethods.dm("https://go.microsoft.com/fwlink/?linkid=2134990",void 0,void 0,"NoCuratedDataCallout.NoCuratedDataFWLink");this.dismiss()}});
var zc=Object(w.a)(new Xa.a(Na.a.current.uu(this.$&&this.$.frame&&this.$.frame.oM&&this.$.frame.oM.YX?128:125)),{alt:O.a.instance.$g(189)});zc=Object(w.a)(new Gb([this.ay],zc),{imageWidth:280,imageHeight:142});zc=new na(zc);return Object(w.a)(new V.a,{target:this.target,content:zc,title:this.MA,primaryButtonProps:Ob,showCloseIcon:!0,calloutProps:Object(w.a)(new ba.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!0,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,
isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!0})}}Object(e.a)(Aa,"LinkedEntityNoCuratedDataTeachingCallout",Ea,[]);var sb=a(180),nc=a(386);class Bb extends Ea{constructor(Ob){super(Ob);this.ay=this.MA=null}TX(Ob){this.xt()||(this.target=Ob,this.yyk())}show(){l.ULS.shipAssertTag(526234880,0,!!this.target&&!!this.ay&&!!this.MA,"OptimizeWorkbookBusinessBarCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");this.xt()||(l.ULS.sendTraceTag(526234851,
0,50,"OptimizeWorkbookBusinessBarCallout.Show() - Showing OptimizeWorkbookBusinessBarCallout callout."),sb.a.sendTelemetryEvent(Object(w.a)(new nc.a,{name:"Office.Excel.Online.OptimizeWorkbook.BigHammerBusinessBarCalloutShown"})),super.show())}xt(){return!!this.LM}ewa(){return Object(w.a)(new V.a,{target:this.target,title:this.MA,content:this.ay,showCloseIcon:!0,calloutProps:Object(w.a)(new ba.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!1,preventDismissOnResize:!1,preventDismissOnScroll:!0,
preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!1})}yyk(){let Ob=-1,zc=0;const od=z.a.Zg(C.ke);od&&(Ob=od.$Cb,zc=od.LAb);switch(zc){default:this.MA=O.a.instance.Ba(722);this.ay=O.a.instance.Ba(725);break;case 1:this.MA=String.format(O.a.instance.Ba(723),Ob);this.ay=O.a.instance.Ba(726);break;case 2:this.MA=String.format(O.a.instance.Ba(724),Ob),this.ay=O.a.instance.Ba(726)}}}Object(e.a)(Bb,"OptimizeWorkbookBusinessBarCallout",Ea,[]);var uc=a(147);class Pc extends Ia{constructor(Ob,
zc,od,ce,Qb,Xc,md,ie,me){ie=void 0===ie?!1:ie;super(Ob,void 0===me?"OverrideBrowserShortcutsTeachingCallout":me,zc,od,ce,Qb,Xc,md,new lb.a,ie)}get kV(){return"[data-unique-id=Help]"}get jV(){return"[data-unique-id=pivotOverflowButton]"}get QU(){return'[id="'+this.$.$h+'Ribbon.Help-title"]'}get ribbonCommandInfo(){return new pa.a(-1018439626,wa.a.eh,this.$.Rh,0,ob.a.b7)}aaa(){return!uc.a.get(ob.a.k6b)}}Object(e.a)(Pc,"OverrideBrowserShortcutsTeachingCallout",Ia,[]);class wd extends Pc{constructor(Ob,
zc,od,ce,Qb,Xc,md,ie){super(Ob,zc,od,ce,Qb,Xc,md,void 0===ie?!1:ie,"OverrideBrowserShortcutsTeachingCalloutOptInByDefault")}get ribbonCommandInfo(){return new pa.a(-901364793,wa.a.eh,this.$.Rh,0,ob.a.b7)}get edb(){return{[ob.a.U9d]:!1}}}Object(e.a)(wd,"OverrideBrowserShortcutsTeachingCalloutOptInByDefault",Pc,[]);var Md=a(60);class Nd extends Ia{constructor(Ob,zc,od,ce,Qb,Xc,md,ie,me,Pe,gf,tf,Qe,Ca,yb,wc,dd,vd,Zd){super(Ob,zc,od,ce,Qb,Xc,ie,me,Pe,void 0===gf?!1:gf,void 0===tf?!1:tf,void 0===Qe?!1:
Qe,void 0===Ca?!1:Ca,void 0===yb?!1:yb,void 0===wc?!0:wc,void 0===dd?!1:dd,void 0===vd?null:vd,void 0===Zd?!1:Zd);this.learnMoreUrl=null;this.learnMoreUrl=md}YZj(){try{Md.a.V4(this.learnMoreUrl)}catch(Ob){}}MAe(){null!=this.learnMoreUrl&&this.YZj()}}Object(e.a)(Nd,"EwaReactShowOrLearnMoreCallout",Ia,[]);const ec='[id="'+Jc.a.JUg+'"]';class gc extends Nd{constructor(Ob){super(Ob,"PhoneticTeachingCallout",O.a.instance.Ba(695),O.a.instance.Ba(698),O.a.instance.Ba(697),O.a.instance.Ba(696),"https://go.microsoft.com/fwlink/?linkid=2194045",
131072,17,new lb.a,void 0,void 0,void 0,void 0,void 0,void 0,!0,3,!0)}get kV(){return ec}get jV(){return ec}get QU(){return ec}get ribbonCommandInfo(){return new pa.a(1455037301,wa.a.eh,this.$.Rh,0,null)}o5f(){l.ULS.sendTraceTag(545837391,1,50,"PhoneticTeachingCallout - click learn more")}w6f(){l.ULS.sendTraceTag(545837390,1,50,"PhoneticTeachingCallout - click show")}}Object(e.a)(gc,"PhoneticTeachingCallout",Nd,[]);var Mb=a(162);class sc extends Ia{constructor(Ob,zc,od,ce,Qb,Xc){super(Ob,zc,O.a.instance.Ba(708),
O.a.instance.Ba(707),O.a.instance.Ba(703),od,ce,Qb,new lb.a,!0,!1,void 0,void 0,void 0,!0,!0);this.Jeb=5;this.hua=Xc}get Yaa(){return 2}get kV(){return 1===Mb.a(this.$).rS?"[data-unique-id=Ribbon-Refresh]":"[data-unique-id=Ribbon-RefreshAll]"}get jV(){return"[data-unique-id=Connections_MLR"}aaa(){return this.hua}get QU(){return'[id="'+this.$.$h+'Ribbon.Data.RefreshAll"]'}get ribbonCommandInfo(){return new pa.a(-859308420,wa.a.eh,this.$.Rh,9,null)}get edb(){return{[wa.a.Wk]:"HelpID=PowerQuery_Refresh",
["ShouldCanvasTakeFocus"]:!0,[wa.a.Ai]:ob.a.CI}}w6b(){return this.lqa()}show(){this.$fa()?super.show():l.ULS.sendTraceTag(509677597,0,10,"PowerQueryRefreshTeachingCalloutBase.Show: Target object is null.")}}Object(e.a)(sc,"PowerQueryRefreshTeachingCalloutBase",Ia,[]);class xd extends sc{constructor(Ob){super(Ob,"PowerQueryRefreshFromTableTeachingCallout",O.a.instance.Ba(705),3145728,20,N.EwaSettings.isChangeGateEnabled("OfficeVSO:7111771_PowerQueryRefreshWeb"))}}Object(e.a)(xd,"PowerQueryRefreshFromTableTeachingCallout",
sc,[]);class xb extends Ia{constructor(Ob){super(Ob,"QueriesTaskPaneTeachingCallout",O.a.instance.Ba(702),O.a.instance.Ba(701),O.a.instance.Ba(849),O.a.instance.Ba(850),12582912,22,new lb.a,!0,void 0,void 0,void 0,void 0,!0,!0);this.Jeb=5;this.hua=N.EwaSettings.isChangeGateEnabled("OfficeVSO:7095227_PowerQueryTaskPaneGroupsOperations")}get Yaa(){return 2}get kV(){return"[data-unique-id=Ribbon-OpenQueriesTaskPane]"}get jV(){return"[data-unique-id=Connections_MLR]"}get QU(){return'[id="'+this.$.$h+
'Ribbon.Data.Queries"]'}w6b(){return this.lqa()}show(){this.$fa()?super.show():l.ULS.sendTraceTag(537168092,0,10,"QueriesTaskPaneTeachingCallout.Show: Target object is null.")}aaa(){return this.hua}get ribbonCommandInfo(){return new pa.a(1156885807,wa.a.eh,this.$.Rh,0,ob.a.Hsb)}}Object(e.a)(xb,"QueriesTaskPaneTeachingCallout",Ia,[]);var Lb=a(481),Rc=a(212),nd=a(668),$d=a(252),Td=a(262);class He extends sc{constructor(Ob){super(Ob,"PowerQueryAuthenticatedRefreshTeachingCallout",O.a.instance.Ba(706),
805306368,28,N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1))}}Object(e.a)(He,"PowerQueryAuthenticatedRefreshTeachingCallout",sc,[]);class oc extends Ia{constructor(Ob){super(Ob,"PowerQueryClearAllPermissionsTeachingCallout",O.a.instance.Ba(708),O.a.instance.Ba(701),O.a.instance.Ba(852),O.a.instance.Ba(853),3,32,new lb.a,!0,!1,void 0,void 0,void 0,!0,!0);this.Jeb=5;this.hua=N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryClearAllCredentialTaskPane",
!1)}get Yaa(){return 2}get kV(){return"[data-unique-id=Ribbon-OpenQueriesTaskPane]"}get jV(){return"[data-unique-id=Connections_MLR]"}get QU(){return'[id="'+this.$.$h+'Ribbon.Data.Queries"]'}w6b(){return this.lqa()}show(){this.$fa()?super.show():l.ULS.sendTraceTag(508687132,0,10,"PowerQueryClearAllPermissionsTeachingCallout.Show: Target object is null.")}aaa(){return this.hua}get ribbonCommandInfo(){return new pa.a(-859308420,wa.a.eh,this.$.Rh,9,null)}get edb(){return{[wa.a.Wk]:"HelpID=PowerQuery_Refresh",
["ShouldCanvasTakeFocus"]:!0,[wa.a.Ai]:ob.a.CI}}}Object(e.a)(oc,"PowerQueryClearAllPermissionsTeachingCallout",Ia,[]);class ld{constructor(Ob){this.ANf=this.aOf=!1;this.lqa=!0;this.TQj=zc=>{if(zc&&!$d.a(zc))try{const od=zc.Result,ce=od.QueryGroups;if(0<od.Queries.length||0<ce.length)this.aOf=!0,this.ANf=od.PowerQueryDataSources?od.PowerQueryDataSources.includes("Excel.CurrentWorkbook")||od.PowerQueryDataSources.includes("OData.Feed"):!1,void this.ZLk()}catch(od){l.ULS.sendTraceTag(537168095,0,10,
`PowerQueryCallout.OnGetQueriesSuccess: QueryInfoList retrieval encountered exception ${od}.`)}};this.$Mc=()=>{l.ULS.sendTraceTag(537168094,0,15,"PowerQueryCallout.OnGetQueriesFailure")};this.$=Ob;this.mvg=new xb(Ob);this.powerQueryClearAllPermissionsCallout=new oc(Ob);this.Iae=N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1)?new He(Ob):new xd(Ob)}show(){this.lqa&&this.jwk()}jwk(){this.$.userOperationManager.enqueueOperation(new Rc.a(587,0,(Ob,zc,od)=>
nd.d(this.$.pa.ta,Td.c(Ob,this.TQj),Td.b(zc,this.$Mc),od,null),80,()=>new Lb.a),null)}ZLk(){const Ob=this;return No(function*(){(yield Qc.c(Ob.mvg.w6b()))&&Ob.aOf?Ob.mvg.show():(yield Qc.c(Ob.Iae.w6b()))&&(Ob.Iae instanceof He||Ob.ANf)?Ob.Iae.show():(yield Qc.c(Ob.powerQueryClearAllPermissionsCallout.w6b()))&&Ob.powerQueryClearAllPermissionsCallout.show();Ob.lqa=!1})}}Object(e.a)(ld,"PowerQueryCallout",null,[879]);class id extends Ea{constructor(Ob){super(Ob);this.R4d=this.Svd=this.ay=this.MA=this.target=
null}TX(Ob,zc,od){this.xt()||(this.target=Ob,this.Svd=zc,this.R4d=od,this.MA=O.a.instance.Ba(710),this.ay=O.a.instance.Ba(711))}show(){l.ULS.shipAssertTag(537168091,0,!!this.target&&!!this.ay&&!!this.MA&&!!this.Svd&&!!this.R4d,"TableAIConvertToTableCallout.Show() - Cannot retrieve the Callout Parameters, Initialize should be called before show");this.xt()||(l.ULS.sendTraceTag(0,0,50,"TableAIConvertToTableCallout.Show() - Showing TableAIConvertToTableCallout callout."),super.show())}xt(){return!!this.LM}ewa(){const Ob=
Object(w.a)(new fa.a,{label:O.a.instance.Ba(712),ariaDescription:O.a.instance.Ba(714),onExecute:()=>{l.ULS.sendTraceTag(0,0,50,'TableAIConvertToTableCallout - clicked "Format as table" button');this.Svd();this.dismiss()}}),zc=Object(w.a)(new fa.a,{label:O.a.instance.Ba(713),ariaDescription:O.a.instance.Ba(715),onExecute:()=>{l.ULS.sendTraceTag(0,0,50,'TableAIConvertToTableCallout - clicked "No thanks" button');this.R4d();this.dismiss()}});return Object(w.a)(new V.a,{target:this.target,content:this.ay,
title:this.MA,primaryButtonProps:Ob,secondaryButtonProps:zc,showCloseIcon:!0,calloutProps:Object(w.a)(new ba.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!0,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!1,hasFocusableControls:!0})}}Object(e.a)(id,"TableAIConvertToTableCallout",Ea,[]);var fc=a(192);class vc{constructor(Ob){this.fZk=Ob}show(){fb.a.instance.Qi("Common.ISystemInitiatedFeedback").execute(Ob=>{Ob.logActivity(this.fZk,
null)})}}Object(e.a)(vc,"EwaLppCallout",null,[879]);var Tc=a(45);class Bd extends vc{constructor(Ob){super("ExcelTableInNewWorkbook");this.hTd=this.Yna=!1;this.createTable=()=>{const zc=Tc.w(new fc.a(1,1,8,3,Jc.a.gl,Jc.a.Qk),this.$),od={};od.TableRange=zc;od.HasHeader=!1;this.$.ei(71074531,wa.a.eh,9,od)};this.wif=()=>{this.createSampleTable("0")};this.xif=()=>{this.createSampleTable("2")};this.yif=()=>{this.createSampleTable("1")};this.$=Ob;(this.Yna=N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableInNewWorkbook",
!1))&&window.addEventListener("ExcelCreateSampleTable",this.createTable,!0);if(this.hTd=N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateSampleTableCallout",!1))window.addEventListener("ExcelCreateSampleTableBlank",this.wif,!0),window.addEventListener("ExcelCreateSampleTableContact",this.xif,!0),window.addEventListener("ExcelCreateSampleTableToDo",this.yif,!0)}dispose(){this.Yna&&window.removeEventListener("ExcelCreateSampleTable",this.createTable,!0);this.hTd&&(window.removeEventListener("ExcelCreateSampleTableBlank",
this.wif,!0),window.removeEventListener("ExcelCreateSampleTableContact",this.xif,!0),window.removeEventListener("ExcelCreateSampleTableToDo",this.yif,!0))}createSampleTable(Ob){const zc={};zc[wa.a.Ai]=Ob;this.$.ei(1371713064,wa.a.eh,9,zc)}}Object(e.a)(Bd,"TableInNewWorkbookCallout",vc,[]);var Fd=a(1230);class le extends Ea{constructor(Ob){super(Ob);this.ZXc=5E3;this.MA=Fd.a.Title;this.currentState=0}FHa(Ob,zc){Fd.c.get(this.currentState).includes(Ob)&&(6===Ob?window.requestAnimationFrame(()=>this.Cuc(Ob,
zc)):this.Cuc(Ob,zc))}O9b(Ob){this.target=Ob}show(){super.dismiss();this.QEg();super.show()}dismiss(){this.FHa(0);window.clearTimeout(this.aAg);super.dismiss()}ewa(){return Object(w.a)(new V.a,{target:this.target,title:this.MA,content:this.ay,showCloseIcon:!0,calloutProps:{setInitialFocus:!1,preventDismissOnResize:!0,preventDismissOnScroll:!0,preventDismissOnLostFocus:!0,isBeakVisible:!0,directionalHint:12,onDismiss:void 0},useTeachingStyles:!1,hasFocusableControls:!1})}update(){this.QEg();super.F8a({message:this.ay})}Cuc(Ob,
zc){const od=Fd.b.get(Ob);this.d3k(this.Ndi(Ob)?`${od}${zc}`:od);this.currentState=Ob;0!=this.currentState?(this.update(),this.show()):this.dismiss()}Ndi(Ob){switch(Ob){case 5:case 6:return!0;default:return!1}}QEg(){window.clearTimeout(this.aAg);this.aAg=window.setTimeout(()=>this.dismiss(),this.ZXc)}d3k(Ob){this.ay=Ob}}Object(e.a)(le,"FormulaByExampleCurtainLifterCallout",Ea,[]);var dc=a(175),Uc=a(1063);class kb extends Ia{constructor(Ob){super(Ob,"DataCleansingTeachingCallout",dc.a.ia(2477),dc.a.ia(2478),
dc.a.ia(2476),dc.a.ia(2479),16777216,24,new lb.a,!0,!1,!1,!1,!0,!0,!0,5,!0,!0);this.mod="[data-unique-id=Data]";this.c3e="[data-unique-id=Ribbon-DataCleansingTaskPane]";this.g3e="[data-unique-id=pivotOverflowButton]";this.e3e="[data-unique-id=Ribbon-DataCalculationTools_MLR]"}get kV(){return document.querySelector(this.e3e)?this.e3e:document.querySelector(this.c3e)?this.c3e:document.querySelector(this.mod)?this.mod:this.g3e}get jV(){return this.g3e}get QU(){return this.mod}get edb(){return Uc.a}get ribbonCommandInfo(){return new pa.a(-859308420,
wa.a.eh,this.$.Rh,12,null)}}Object(e.a)(kb,"DataCleansingTeachingCallout",Ia,[]);var rb=a(125);class cc extends Ea{constructor(Ob){super(Ob);this.ay=this.MA=this.target=null;this.duration=0}TX(Ob,zc,od){this.xt()||(this.target=Ob,this.MA=this.rEi(zc),this.ay=O.a.instance.Ba(737),this.operation=zc,this.duration=od)}show(){l.ULS.shipAssertTag(512304648,0,!!this.target&&!!this.ay&&!!this.MA,"OptimizeWorkbookSlowOperationsCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");
if(!this.xt()){l.ULS.sendTraceTag(512304647,0,50,"OptimizeWorkbookSlowOperationsCallout.Show() - Showing OptimizeWorkbookSlowOperationsCallout callout.");var Ob={["Operation"]:this.operation,["Duration"]:this.duration};sb.a.sendTelemetryEvent(Object(w.a)(new nc.a,{name:"Office.Excel.Online.OptimizeWorkbook.BigHammerSlowOperationsCalloutShown",dataFields:rb.a.rn(Ob)}));super.show()}}xt(){return!!this.LM}ewa(){return Object(w.a)(new V.a,{target:this.target,title:this.MA,content:this.ay,showCloseIcon:!0,
calloutProps:Object(w.a)(new ba.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!1,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!1})}rEi(Ob){switch(Ob){case 0:return O.a.instance.Ba(727);case 1:return O.a.instance.Ba(728);case 2:return O.a.instance.Ba(729);case 3:return O.a.instance.Ba(730);case 4:return O.a.instance.Ba(731);case 5:return O.a.instance.Ba(732);case 6:return O.a.instance.Ba(733);case 7:return O.a.instance.Ba(734);
case 8:return O.a.instance.Ba(735);case 9:return O.a.instance.Ba(736);default:return""}}}Object(e.a)(cc,"OptimizeWorkbookSlowOperationsCallout",Ea,[]);class mc extends Ia{constructor(Ob){super(Ob,"FunctionDialogTeachingCallout",void 0,O.a.instance.Ba(763),O.a.instance.Ba(760),O.a.instance.Ba(761),1073741824,30,new lb.a,!0,!0,!1,!1,!0,!0,!0,5,!0)}TX(Ob){this.nod=`[id=${"CellEdit"===Ob?this.$.$h+ob.a.IOb:"InsertFunction"}]`}LIa(){return 1}get kV(){return this.nod}get jV(){return this.nod}get QU(){return this.nod}get ribbonCommandInfo(){return null}}
Object(e.a)(mc,"FunctionDialogTeachingCallout",Ia,[]);class Sa extends vc{constructor(Ob){super("ExcelLiveWebEntryPointCallout");this.Bna=!1;this.dUg=()=>{this.$.ei(327119921,wa.a.eh,9,null)};this.$=Ob;(this.Bna=N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelLiveWebEntryPointCalloutEnabled",!1))&&window.addEventListener("TryCoEditInTeams",this.dUg,!0)}dispose(){this.Bna&&window.removeEventListener("TryCoEditInTeams",this.dUg,!0)}}Object(e.a)(Sa,"ExcelLiveWebEntryPointCallout",vc,
[]);var pb=a(34);class Ac extends Ea{constructor(Ob){super(Ob);this.ay=pb.a.isMac?O.a.instance.ia(2493):O.a.instance.ia(2492);this.hua=N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.HyperlinkImprovementSlice1",!1)}ewa(){return Object(w.a)(new V.a,{target:this.$fa(),content:this.ay,preventLightDismiss:!1,hasDynamicSizing:!1,calloutProps:Object(w.a)(new ba.a,{directionalHint:1,preventDismissOnScroll:!1,preventDismissOnResize:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0,setInitialFocus:!1,
gapSpace:0}),useTeachingStyles:!1,hasFocusableControls:!0,useCoachmark:!1})}xt(){return!!this.LM}aaa(){return this.hua&&!this.xt()}$fa(){return document.querySelector("[id=CtrlClickHyperlinkCalloutTarget]")?"[id=CtrlClickHyperlinkCalloutTarget]":null}dispose(){const Ob=document.querySelector("[id=CtrlClickHyperlinkCalloutTarget]");Ob&&document.removeChild(Ob)}}Object(e.a)(Ac,"CtrlClickHyperlinkCallout",Ea,[]);class yd extends Ea{constructor(Ob){super(Ob);this.y6c="FullScreenTeachingCallout";this.x6c=
8;this.w6c=35;this.MA=O.a.instance.Ba(1004);this.ay=O.a.instance.Ba(1005);this.hua=N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ToggleFullScreenRibbon",!1);this.localStorage=new lb.a;this.BYb=this.xKd();this.nO=0}get VN(){return this.y6c}get Keb(){return this.x6c}get Ieb(){return this.w6c}get jV(){return"[id=ToggleFullScreenButton]"}get kV(){return"[id=ToggleFullScreenButton]"}get QU(){return"[id=ToggleFullScreenButton]"}LIa(){return 3}oyc(){return 86400}get Yaa(){return 3}ewa(){return Object(w.a)(new V.a,
{target:this.$fa(),content:this.ay,title:this.MA,showCloseIcon:!0,preventLightDismiss:!1,hasDynamicSizing:!1,calloutProps:Object(w.a)(new ba.a,{onDismiss:()=>{this.dismiss()},directionalHint:6,preventDismissOnScroll:!1,preventDismissOnResize:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0,setInitialFocus:!1,gapSpace:0}),useTeachingStyles:!1,hasFocusableControls:!1,useCoachmark:!1})}xt(){return!!this.LM}aaa(){return this.hua&&!this.xt()}show(){this.$fa()&&ra.TaskExtensions.Ua(this.lqa(),Ob=>{Ob.result&&
this.bqe()},this.$.xa)}lqa(){const Ob=new la.a;this.aaa()?ra.TaskExtensions.Ua(this.BYb.M_d(),zc=>{var od=this.LIa();zc=zc.result;zc.W7b?(this.nO=zc.nO,sa.Vmb(od)&&zc.nO>=this.Yaa?Ob.setResult(!1):sa.cHc(od)&&zc.YKa&&Da.getElapsedSeconds(zc.YKa,new Date)<this.oyc()?Ob.setResult(!1):(od=!this.LM&&!!this.$fa(),Ob.setResult(od))):Ob.setResult(!1)},this.$.xa):Ob.setResult(!1);return Ob.task}bqe(){const Ob=new Ya;Ob.nO=this.nO+1;Ob.YKa=new Date;this.BYb.ake(Ob);super.show()}$fa(){return document.querySelector(this.kV)?
this.kV:document.querySelector(this.jV)?this.jV:document.querySelector(this.QU)?this.QU:null}xKd(){const Ob=this.LIa();return sa.L4g(Ob)?new Ha(this.$,this.VN,Ob):new ka(this.$,this.Ieb,this.Keb,Ob,this.VN,this.localStorage)}}Object(e.a)(yd,"FullScreenTeachingCallout",Ea,[]);class vb{constructor(Ob){this.$=Ob;this.kF=new Ib.a(!1)}HPi(Ob){if(!this.kF.Vg($b[Ob]))switch(Ob){case 0:this.f0h(Ob);break;case 2:this.kF.add($b[Ob],new qb(this.$));break;case 3:this.kF.add($b[Ob],new Aa(this.$));break;case 6:this.kF.add($b[Ob],
new Db(this.$));break;case 1:this.kF.add($b[Ob],new pc(this.$));break;case 4:this.kF.add($b[Ob],new ua(this.$));break;case 7:this.kF.add($b[Ob],new Kb(this.$));break;case 8:this.kF.add($b[Ob],new gb(this.$));break;case 9:this.kF.add($b[Ob],new Zb(this.$));break;case 13:this.kF.add($b[Ob],new Bb(this.$));break;case 10:this.kF.add($b[Ob],new gc(this.$));break;case 11:this.kF.add($b[Ob],new ld(this.$));break;case 12:this.kF.add($b[Ob],new id(this.$));break;case 14:this.kF.add($b[Ob],new Bd(this.$));
break;case 15:this.kF.add($b[Ob],new le(this.$));break;case 16:this.kF.add($b[Ob],new kb(this.$));break;case 18:this.kF.add($b[Ob],new cc(this.$));break;case 20:this.kF.add($b[Ob],new Sa(this.$));break;case 21:this.kF.add($b[Ob],new mc(this.$));break;case 22:this.kF.add($b[Ob],new Ac(this.$));break;case 23:this.kF.add($b[Ob],new yd(this.$));break;default:return null}return this.kF.getItem($b[Ob])}f0h(Ob){this.kF.add($b[Ob],new wd(this.$,O.a.instance.Ba(640),O.a.instance.Ba(637),O.a.instance.Ba(638),
O.a.instance.Ba(639),16,4,!0))}}Object(e.a)(vb,"EwaCalloutFactory",null,[]);var Sc=a(63),hd=a(66),qc=a(149);let Lc=class{constructor(Ob){this.$=Ob;this.Yji=new vb(this.$)}Bi(){return!1}Ji(){return!1}ni(Ob,zc,od){Ob=od.CalloutName;this.QJk=N.EwaSettings.isChangeGateEnabled("OfficeVSO:6189760_SuppressTeachingCalloutForLiveMeetings")&&Object(qc.c)(this.$)&&!this.nfj(Ob);return!!zc&&-847286761===zc.command&&Sc.a.Al.cY&&!this.QJk}nfj(Ob){return this.$.mC&&9===Ob}executeCommand(Ob,zc,od){Ob=od.CalloutName;
if(zc=this.Yji.HPi(Ob)){switch(Ob){case 2:zc.TX(od.Target,od.RibbonButtonLabel,od.ExampleEntities,od.BlankCellResourceId,od.HasBlankCellWalkthrough,od.ServiceDomain);break;case 3:zc.TX(od.Target,od.RibbonButtonLabel,od.ExampleEntities);break;case 6:zc.TX(od.Target);break;case 8:zc.TX(od.Target);break;case 13:zc.TX(od.Target);break;case 15:return zc.O9b(od.Target),zc.FHa(od.NewState,od.Reason),hd.Task.Va(!0);case 12:zc.TX(od.Target,od.ConvertToTableCallback,od.NoThanksCallback);break;case 18:zc.TX(od.Target,
od.Operation,od.Duration);break;case 21:zc.TX(od.Trigger)}zc.show();return hd.Task.Va(!0)}return hd.Task.Va(!1)}};Lc=Object(m.__decorate)([Object(z.d)(C.Mf),Object(m.__param)(0,Object(C.Lb)())],Lc);Object(e.a)(Lc,"ShowCalloutCommandHandler",null,[39]);let bd=class{constructor(Ob){this.o3e=!1;this.MH=Ob;N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableGridHighlights",!1)&&void z.a.resolve(C.Ye,{va:1});this.MH.Hcb("Valid",()=>{this.o3e||(l.ULS.sendTraceTag(526979921,0,15,"Received annotation with interpretations"),
this.o3e=!0)})}};bd=Object(m.__decorate)([Object(z.d)(C.fg),Object(m.__param)(0,Object(C.gg)()),Object(m.__param)(1,Object(C.Lb)())],bd);Object(e.a)(bd,"TableIntelligenceDarkActivationManager",null,[848]);var jd=a(188),Yd=a(920),te=a(893);class oe extends Yd.a{constructor(){super();this.range=null;this.H_=Object.assign(new te.a,{T_:oe.getTypeName(),B_:oe.getBaseTypes()})}static getTypeName(){return"AugLoop_Excel_ExcelRangeWrapperAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}
Object(e.a)(oe,"ExcelRangeWrapperAnnotation",Yd.a,[]);class Kd extends oe{constructor(){super();this.primaryTable=this.sheetName=this.boundaryConfidence=this.hasMergedcells=this.tableName=this.interpretations=null;this.H_=Object.assign(new te.a,{T_:Kd.getTypeName(),B_:Kd.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelTableAi_ExcelRecognizedTableNew"}static getBaseTypes(){return["AugLoop_Excel_ExcelRangeWrapperAnnotation","AugLoop_Core_Annotation"]}}Object(e.a)(Kd,"ExcelRecognizedTableNew",
oe,[]);class Ee extends Kd{constructor(){super();this.requestId=null;this.H_=Object.assign(new te.a,{T_:Ee.getTypeName(),B_:Ee.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelTableai_ExcelRangeMetadata"}static getBaseTypes(){return["AugLoop_ExcelTableAi_ExcelRecognizedTableNew","AugLoop_Core_Annotation"]}}Object(e.a)(Ee,"ExcelRangeMetadata",Kd,[]);var rc=a(1390);class fd extends rc.a{constructor(){super();this.value=null;this.type=0;this.H_=Object.assign(new te.a,{T_:fd.getTypeName(),B_:fd.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelTableai_ExtendedExcelCell"}static getBaseTypes(){return["AugLoop_Excel_ExcelCell",
"AugLoop_Core_GridCell"]}}Object(e.a)(fd,"ExtendedExcelCell",rc.a,[]);var Ed=a(1017);class Rd extends Ed.a{constructor(){super();this.mergeCellAddresses=this.requestId=this.cells=this.range=null;this.H_=Object.assign(new te.a,{T_:Rd.getTypeName(),B_:Rd.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelTableai_RangeDataSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(e.a)(Rd,"RangeDataSignal",Ed.a,[]);var Fe=a(1202),Ae=a(106),We=a(38);class ve extends Sys.EventArgs{constructor(Ob){super();
this.wRc=Ob}}Object(e.a)(ve,"RecognizedTableUpdateEventArgs",Sys.EventArgs,[]);var Ze=a(208),Oe=a(26),Nf=a(387);class Zf{constructor(Ob,zc,od,ce,Qb){this.analyzedRange=Ob;this.interpretations=zc;this.tableName=od;this.id=ce;this.UNf=Qb}}Object(e.a)(Zf,"RecognizedTable",null,[]);class Rb{constructor(Ob,zc,od){this.classification=Ob;this.aggregations=zc;this.headerReferences=od}}Object(e.a)(Rb,"TableField",null,[]);var Vb=a(1203);const Cc=Ob=>{var zc=new Nf.a(rg(Ob.range),Ob.range.worksheetId);var od=
Ob.interpretations;var ce=new Ze.a;if(od&&od.length)for(const wc of od){b:switch(wc.orientation.toLowerCase()){case "columnmajor":od=2;break b;case "rowmajor":od=1;break b;default:l.ULS.sendTraceTag(537151256,0,50,"Invalid value for table orientaion."),od=0}const dd=od;if(0===dd)l.ULS.sendTraceTag(537151257,0,50,"Invalid value for table orientaion. Skipping current interpretation.");else{od=Vb.a;var Qb=rg(wc.location),Xc=wc.confidence,md=wc.headerRowCount,ie=wc.headerColumnCount;var me=wc.fields;
var Pe=new Ze.a;if(me)for(const vd of me){me=Pe;var gf=me.add;c:switch(vd.classification.toLowerCase()){case "dimension":var tf=1;break c;case "measure":tf=2;break c;default:l.ULS.sendTraceTag(537151255,0,50,"Invalid value %s for field classification."),tf=0}var Qe=vd.aggregations;var Ca=new Ze.a;if(Qe)for(const Zd of Qe)switch(Zd.toLowerCase()){case "sum":Ca.add(0);break;case "count":Ca.add(1);break;case "average":Ca.add(2);break;case "min":Ca.add(3);break;case "max":Ca.add(4);break;case "distinctcount":Ca.add(5);
break;case "stddev":Ca.add(6);break;case "variance":Ca.add(7);break;default:l.ULS.sendTraceTag(537151254,0,50,"Invalid value for aggregation type.")}Qe=Ca;var yb=vd.headerReferences;Ca=new Ze.a;if(yb)for(const Zd of yb)yb=new Oe.Range(Zd.top,Zd.left,Zd.top,Zd.left,!1,!1),Ca.add(yb);gf.call(me,new Rb(tf,Qe,Ca))}od=new od(Qb,Xc,md,ie,dd,Pe);ce.add(od)}}return new Zf(zc,ce,Ob.tableName,Ob.id,Ob.hasMergedcells)},rg=Ob=>new Oe.Range(Ob.top,Ob.left,Ob.bottom,Ob.right,!1,!1);var yf=a(1047);class jg{constructor(Ob,
zc){this.x2c=0;this.EH=new Map;this.KRd=!1;this.MH=Ob;this.Bo=zc;N.EwaSettings.isChangeGateEnabled("OfficeVSO:7748219_LogE2ELatency")&&(this.Utc=new yf.a("WebServiceCall","TableIntelligenceQueryManagerE2ELatency"),this.Utc.start(),this.cZc=!0);this.MH.Hcb("Valid",this.MYj.bind(this));this.MH.Hcb("Invalid",this.pSj.bind(this));N.EwaSettings.isChangeGateEnabled("OfficeVSO:7408706_QueryManagerCoauthVersionChecking")&&this.Bo.Cth(this.eMj.bind(this))}iJa(Ob,zc,od){if(!this.EH)return l.ULS.sendTraceTag(521025344,
306,10,"Recognized table is null"),[];let ce=zc;N.EwaSettings.isChangeGateEnabled("OfficeVSO:7408706_QueryManagerCoauthVersionChecking")&&void 0!==od&&this.x2c>od&&(l.ULS.sendTraceTag(509681793,306,50,`getRecognizedTables: maxRevisions: ${od}, versionChanges: ${this.x2c}`),ce=zc^4);return this.EH.has(Ob.sheetId)?(zc=this.EH.get(Ob.sheetId).filter(Qb=>Qb.table.analyzedRange.range.yi(Ob.range)&&(ce&Qb.metadataState)==Qb.metadataState),l.ULS.sendTraceTag(509681792,306,50,`getRecognizedTables: foundRecords: ${zc.length}`),
zc):[]}MYj(Ob,zc){if(this.EH){if(!this.KRd){N.EwaSettings.isChangeGateEnabled("OfficeVSO:7748219_LogE2ELatency")&&this.cZc&&(this.Utc.stop(),l.ULS.sendTraceTag(509089223,0,15,"Elapsed time since annotation invalidation: {0}",this.Utc.ii),this.cZc=!1);for(const od of this.EH){const [ce,Qb]=od;Qb.every(Xc=>4===Xc.metadataState)?this.EH.delete(ce):this.EH.set(ce,Qb.filter(Xc=>4!==Xc.metadataState))}this.KRd=!0}Ob=zc.wRc;this.EH.has(Ob.analyzedRange.sheetId)||this.EH.set(Ob.analyzedRange.sheetId,[]);
this.EH.get(Ob.analyzedRange.sheetId).push({table:Ob,metadataState:2});this.x2c=0}else l.ULS.sendTraceTag(521025315,306,10,"Recognized table is null")}pSj(Ob,zc){this.KRd=!1;N.EwaSettings.isChangeGateEnabled("OfficeVSO:7748219_LogE2ELatency")&&!this.cZc&&(this.Utc.start(),this.cZc=!0);Ob=zc.wRc;if(!this.EH)l.ULS.sendTraceTag(521025314,306,10,"Recognized table is null");else if(this.EH.has(Ob.analyzedRange.sheetId))for(const od of this.EH.get(Ob.analyzedRange.sheetId))od.table.id===zc.wRc.id&&(od.metadataState=
4)}eMj(){this.x2c++}}Object(e.a)(jg,"TableIntelligenceQueryManager",null,[907]);class If{}Object(e.a)(If,"RecognizedTableLog",null,[]);class cf{}Object(e.a)(cf,"Interpretation",null,[]);class Nb{constructor(Ob){this.EH=new Map;this.ulc=void 0;this.QGb=new Set;this.NZb=void 0;this.MH=Ob}M$g(){this.NZb?l.ULS.shipAssertTag(522303246,306,!1,"LogXlimRecognizedTables should not be called twice."):(this.NZb=this.aqb.bind(this),this.MH.Hcb("Valid",this.NZb))}Pyj(Ob){Ob=this.sanitize(Ob);l.ULS.sendTraceTag(521233111,
306,15,`${JSON.stringify(Ob)}`)}aqb(Ob,zc){Ob=zc.wRc;N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.QGb&&this.EH?(this.QGb.has(Ob.id)||(this.Jwh(Ob),this.QGb.add(Ob.id)),this.ulc||(this.ulc=window.setTimeout(this.oza.bind(this),2E3))):l.ULS.sendTraceTag(522303245,306,15,`AnnotationId set or recognized table store is null. annotationIdSet = ${!!this.QGb}, recognizedTableStore = ${!!this.EH}`))}oza(){for(const Ob of this.EH){const [,zc]=Ob;l.ULS.sendTraceTag(521233110,
306,15,JSON.stringify(zc))}window.clearTimeout(this.ulc);this.QGb=this.ulc=void 0;this.EH.clear();this.EH=void 0;this.MH.zhk(this.NZb);this.NZb=void 0}Jwh(Ob){const zc=Ob.analyzedRange.sheetId;this.EH.has(zc)||this.EH.set(zc,[]);this.EH.get(zc).push(this.sanitize(Ob))}sanitize(Ob){const zc=[];for(const od of Ob.interpretations){let ce=0,Qb=0;for(const Xc of od.fields)1===Xc.classification?ce++:2===Xc.classification&&Qb++;zc.push({confidence:od.confidence,headerRowCount:od.headerRowCount,headerColumnCount:od.headerColumnCount,
orientation:od.orientation,measureCount:Qb,dimensionCount:ce})}return{interpretations:zc,range:{top:Ob.analyzedRange.range.top,bottom:Ob.analyzedRange.range.bottom,left:Ob.analyzedRange.range.left,right:Ob.analyzedRange.range.right},isTable:!!Ob.tableName,annotationId:Ob.id}}}Object(e.a)(Nb,"RecognizedTableLogger",null,[]);let Bc=class extends We.a{constructor(Ob,zc){super();this.QVf=this.PVf=!1;this.instantaneousSupportInformationManager=null;this.Pde=void 0;this.T6f=!1;this.Jqi=(od,ce)=>{var Qb;
if(1===ce.operationType){const md=ce.annotation;if(md){l.ULS.sendTraceTag(537151251,306,50,`TableIntelligenceManager::ExcelRangeMetadataHandler called for requestID = ${md.requestId}`);od=Cc(md);N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(null===(Qb=this.Pde)||void 0===Qb?void 0:Qb.Pyj(od));var Xc=null;(()=>{let ie=this.Mqe.gj(md.requestId);({value:Xc}=ie);return ie})().returnValue?(this.Mqe.remove(md.requestId),Xc(od)):l.ULS.sendTraceTag(537151250,
306,10,`TableIntelligenceManager::ExcelRangeMetadataHandler Callback not found for requestId = ${md.requestId}`)}else l.ULS.sendTraceTag(537151252,306,10,"TableIntelligenceManager::ExcelRangeMetadataHandler excelRangeMetadata is null.")}};this.Bo=Ob;this.$=zc;this.Mqe=new Ae.a;N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.Pde=new Nb(this));this.Bo.register(this.Bo.e5().B7("TableIntelligence").A7(()=>{}).build())}Zfa(){this.P7a||(this.P7a=new jg(this,
this.Bo));return this.P7a}PNi(Ob,zc){if(N.EwaSettings.isChangeGateEnabled("OfficeVSO:6648526_LimitCellsInSignal")&&1E4<Ob.range.cz)return l.ULS.sendTraceTag(520501002,306,15,`Signal with range size of ${Ob.range.cz} exceeds limit of ${1E4}`),4;this.ysh();if(this.hnj(Ob.range))return this.RRi(Ob,zc);l.ULS.sendTraceTag(537151253,306,15,"Range is not completely contained within the viewport");return 2}Gwd(Ob){return(zc,od)=>{this.t7j(this.j2d(Ob),od)}}Hcb(Ob,zc){var od,ce;(null===(ce=null===(od=this.$)||
void 0===od?void 0:od.sa)||void 0===ce?0:ce.count)&&100<this.$.sa.count?l.ULS.sendTraceTag(520720838,306,15,`TableIntelligenceManager::addRecognizedTableAnnotationCallback Exceeded max sheet count threshold. SheetCount ${this.$.sa.count}`):(this.QVf||(this.Bo.xpa("TableIntelligence",{bB:!0,annotationType:Kd.getTypeName(),pY:this.Gwd("New"),dQa:this.Gwd("Valid"),DDc:this.Gwd("Invalid")}),this.QVf=!0),this.Kvh(Ob,zc),this.Qaj())}zhk(Ob){this.removeHandler(this.j2d("Valid"),Ob)}Kvh(Ob,zc){this.addHandler(this.j2d(Ob),
zc)}jek(){this.Bo.xpa("TableIntelligence",{annotationType:Ee.getTypeName(),bB:!1,pY:this.Jqi})}ysh(){this.PVf||(this.PVf=!0,this.jek())}t7j(Ob,zc){1===zc.operationType&&((zc=zc.annotation)?(zc=Cc(zc),this.raiseEvent(Ob,new ve(zc))):l.ULS.sendTraceTag(523772681,306,10,"TableIntelligenceManager::processAndRaiseExcelRecognizedTableAnnotationReceivedEvent ExcelRecognizedTable is null."))}j2d(Ob){return`${"RecognizedTableUpdate"}_${Ob}`}RRi(Ob,zc){l.ULS.sendTraceTag(537151248,306,15,"On-Demand Metadata Triggered");
const od=Ob.range,ce=La.f(this.$).ot("TableIntelligence",od,1),Qb=[],Xc=[];let md=0;const ie=N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1);for(this.instantaneousSupportInformationManager||void z.a.hj(C.wd).then(me=>this.instantaneousSupportInformationManager=me);ce.$$mn();){const me=ce.$$cu();if(!me)continue;if(0===me.Xn.type&&nb.a.qz(me.Xn.value))continue;me.kH&&me.range&&Xc.push(Object(w.a)(new Fe.a,{worksheetId:Ob.sheetId,left:me.range.left-1,top:me.range.top-
1,right:me.range.right-1,bottom:me.range.bottom-1}));const Pe=me.range.top-1,gf=me.range.left-1;let tf=null,Qe=null;({category:Qe}=this.instantaneousSupportInformationManager.Rqa(me.cell.Vn,!0));me.text!=me.Xn.value&&(tf=me.text,ie&&md++);Qb.push(Object.assign(new fd,{row:Pe,column:gf,value:me.Xn.value,type:me.Xn.type,displayText:tf,oql:Qe}))}ie&&l.ULS.sendTraceTag(526260166,306,50,`TableIntelligenceManager::getRangeDataFromGrid requests non-null displayText: ${md}, number of values: ${Qb.length}, range size: ${od.height} rows by ${od.width} columns`);
if(0<Qb.length)return this.e5h(Qb,Ob,Xc,zc),Xc.length?5:0;l.ULS.sendTraceTag(537151247,306,15,"All cells in range were empty");return 3}e5h(Ob,zc,od,ce){var Qb=zc.range;Qb=Object(w.a)(new Fe.a,{top:Qb.top,left:Qb.left,bottom:Qb.bottom,right:Qb.right,worksheetId:zc.sheetId});zc=jd.a.create().toString();Ob=Object(w.a)(new Rd,{cells:Ob,range:Qb,mergeCellAddresses:od,requestId:zc});this.Bo.twb(Ob);this.Mqe.add(zc,ce)}hnj(Ob){const zc=La.f(this.$);if(N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",
!1)){const od=zc.IX();l.ULS.sendTraceTag(520501001,306,50,`viewportWidth: ${od.width}, viewportHeight: ${od.height}`)}return zc.za.Aaa(4,this.$.na)&&!!zc.kh(Ob.topLeft)&&!!zc.kh(Ob.bottomLeft)&&!!zc.kh(Ob.topRight)&&!!zc.kh(Ob.bottomRight)}Qaj(){var Ob;!this.T6f&&N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.T6f=!0,null===(Ob=this.Pde)||void 0===Ob?void 0:Ob.M$g())}};Bc=Object(m.__decorate)([Object(z.d)(C.gg),Object(m.__param)(0,Object(C.p)()),Object(m.__param)(1,
Object(C.Lb)())],Bc);Object(e.a)(Bc,"TableIntelligenceManager",We.a,[2,849]);String(c);String(b);String(f);String(r);String(d);String(k);String(t);window.___1708742503490_closurehack=c;window.___1708742503490_closurehack=b;window.___1708742503490_closurehack=f;window.___1708742503490_closurehack=r;window.___1708742503490_closurehack=d;window.___1708742503490_closurehack=k;window.___1708742503490_closurehack=t}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.pid.js.map/65e1ef6b4ed7fbc84db91ba3ef920a24/EwaTS.pid.js.map