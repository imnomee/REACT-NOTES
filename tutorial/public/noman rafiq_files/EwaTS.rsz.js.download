'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[35],{771:function(y,x,a){function c(kb){return 0<kb&&kb<=ka.a.gl}function b(kb){return 0<kb&&kb<=ka.a.Qk}function f(kb,rb){let cc="";rb.sort((Ac,yd)=>Ac.start-yd.start);let mc=0,Sa=rb.shift();const pb=kb.length;for(;mc<pb&&Sa;)mc===Sa.start?(cc+=Sa.value,Sa.EKa&&(cc+="#"),mc=Sa.end,Sa=rb.shift()):(cc+=kb[mc],mc++);mc<pb&&(cc+=kb.substring(mc));return cc}function r(kb,rb){return kb.top<=rb.top&&kb.left<=rb.left&&
kb.bottom>=rb.bottom&&kb.right>=rb.right}function d(kb,rb,cc){var mc,Sa,pb,Ac,yd;return(null===(mc=kb.rB)||void 0===mc?void 0:mc[0])<=rb&&(null===(Sa=kb.rB)||void 0===Sa?void 0:Sa[kb.rB.length-1])>=rb&&(null===(pb=kb.GG)||void 0===pb?void 0:pb[0])<=cc&&(null===(Ac=kb.GG)||void 0===Ac?void 0:Ac[(null===(yd=kb.GG)||void 0===yd?NaN:yd.length)-1])>=cc}function k(kb,rb){const cc={};cc.X=kb.X-rb.X;cc.Y=kb.Y-rb.Y;return cc}function t(kb,rb,cc,mc){switch(cc){case -706918724:case 674605324:var Sa=kb.destination.jj;
if(!Sa)return M("shouldCurrentBlockPairBeProcessed",cc),!1;if(Sa.right<rb.left)return kb.T5=!0,sa.ULS.sendTraceTag(508150742,0,50,`GridInstantaneousAction.processGridAction command=${cc}, parameter = BlockRangeLessThanSelectedRange, selectedRangeLeftValue=${rb.left}, blockRangeRightMostValue=${Sa.right}, hashCode=${kb.destination.Ci}, isRow=${mc}`),!1;break;case 369708605:case 1415868706:Sa=kb.source.jj;if(!Sa)return M("shouldCurrentBlockPairBeProcessed",cc),!1;if(Sa.right<rb.left)return kb.T5=!0,
sa.ULS.sendTraceTag(508150741,0,50,`GridInstantaneousAction.processGridAction command=${cc}, parameter = BlockRangeLessThanSelectedRange, selectedRangeLeftValue=${rb.left}, blockRangeRightMostValue=${Sa.right}, hashCode=${kb.source.Ci}, isRow=${mc}`),!1;break;case 1542466017:case -1113896058:Sa=kb.source.jj;if(!Sa)return M("shouldCurrentBlockPairBeProcessed",cc),!1;if(Sa.bottom<rb.top)return kb.T5=!0,sa.ULS.sendTraceTag(508150740,0,50,`GridInstantaneousAction.processGridAction command=${cc}, parameter = BlockRangeLessThanSelectedRange, selectedRangeTopValue=${rb.top}, blockRangeBottomMostValue=${Sa.bottom}, hashCode=${kb.source.Ci}, isRow=${mc}`),
!1;break;case 1051390410:case 1554436520:Sa=kb.destination.jj;if(!Sa)return M("shouldCurrentBlockPairBeProcessed",cc),!1;if(Sa.bottom<rb.top)return kb.T5=!0,sa.ULS.sendTraceTag(508150739,0,50,`GridInstantaneousAction.processGridAction command=${cc}, parameter = BlockRangeLessThanSelectedRange, selectedRangeTopValue=${rb.top}, blockRangeBottomMostValue=${Sa.bottom}, hashCode=${kb.destination.Ci}, isRow=${mc}`),!1}return!0}function m(kb,rb,cc,mc,Sa){if(Ya.EwaSettings.H0a()&&kb.Pg.mz&&1===Sa.length){var pb=
Sa[0],Ac=kb.Pg.Sm,yd=kb.Pg.Hm;Sa=[];if(!cc&&pb.right<Ac){Ac=e(rb,cc,mc,2);kb=e(rb,cc,mc,4);var vb=[],Sc=[];-706918724!==mc&&(pb.top<yd&&(Sc=e(rb,cc,mc,3)),vb=e(rb,cc,mc,1));Sa.push(...Ac);Sa.push(...kb);Sa.push(...Sc);Sa.push(...vb);return Sa}if(!cc&&pb.left>=Ac)return pb=e(rb,cc,mc,3),rb=e(rb,cc,mc,1),Sa.push(...pb),Sa.push(...rb),Sa;if(cc&&pb.bottom<yd)return yd=e(rb,cc,mc,2),kb=e(rb,cc,mc,3),vb=[],Sc=[],1051390410!==mc&&(pb.left<Ac&&(Sc=e(rb,cc,mc,4)),vb=e(rb,cc,mc,1)),Sa.push(...yd),Sa.push(...kb),
Sa.push(...Sc),Sa.push(...vb),Sa;if(cc&&(pb.top>=yd||kb.Pg.ZVd(pb)))return pb=e(rb,cc,mc,4),rb=e(rb,cc,mc,1),Sa.push(...pb),Sa.push(...rb),Sa}return e(rb,cc,mc,1)}function e(kb,rb,cc,mc){const Sa=kb.filter(yd=>yd.eK().paneType===mc),pb=rb?C(Sa):z(Sa),Ac=[];if(!Ya.EwaSettings.Lga()&&0===pb&&1===kb.length)return Ac.push({destination:kb[0],source:null,T5:!1}),Ac;if(Ya.EwaSettings.Jxa()||Ya.EwaSettings.Ixa()||Ya.EwaSettings.oKa())Ac.push(...l(Sa,pb,rb,cc));else for(let yd=0;yd<=pb;yd++)for(kb=Sa.filter(vb=>
vb.eK().topLeft.Y===yd),rb=0;rb<kb.length;rb+=1)Ac.push({destination:kb[rb],source:kb[rb+1]?kb[rb+1]:null,T5:!1});sa.ULS.sendTraceTag(509658E3,0,50,`GridInstantaneousAction.getBlockPairsInViewport parameter = blockPairsLength, value=${Ac.length}`);return Ac}function w(kb){const rb=C(kb),cc=z(kb),mc=[],Sa={};kb.forEach(pb=>{const {X:Ac,Y:yd}=pb.eK().topLeft;Sa[`${Ac},${yd}`]=pb});for(kb=0;kb<=rb;kb++)for(let pb=0;pb<=cc;pb++){const Ac=Sa[`${kb+1},${pb}`],yd=Sa[`${kb},${pb+1}`],vb=Sa[`${kb+1},${pb+
1}`],Sc=Sa[`${kb},${pb}`];mc.push({destination:null!==Sc&&void 0!==Sc?Sc:null,OTg:null!==Ac&&void 0!==Ac?Ac:null,KTg:null!==yd&&void 0!==yd?yd:null,LTg:null!==vb&&void 0!==vb?vb:null})}sa.ULS.sendTraceTag(507586694,0,50,`GridInstantaneousAction.getadjacentBlocksInViewport parameter = blockPairsLength, value=${mc.length}`);return mc}function l(kb,rb,cc,mc){const Sa=[];for(let pb=0;pb<=rb;pb++){const Ac=kb.filter(vb=>cc?vb.eK().topLeft.X===pb:vb.eK().topLeft.Y===pb),yd=Ac.length;for(let vb=0;vb<yd;vb+=
1)switch(mc){case -1113896058:case 1542466017:Sa.push({source:Ac[vb],destination:u(vb+1,Ac),T5:!1});break;case 1554436520:case 1051390410:Sa.push({destination:Ac[vb],source:u(vb+1,Ac),T5:!1});break;case 1415868706:case 369708605:Sa.push({source:Ac[vb],destination:u(vb+1,Ac),T5:!1});break;case 674605324:case -706918724:Sa.push({destination:Ac[vb],source:u(vb+1,Ac),T5:!1})}}return Sa}function u(kb,rb){return kb<rb.length?rb[kb]:null}function n(kb,rb,cc,mc,Sa,pb){let Ac,yd=0;yd=O(mc)?Ta.HelperMethods.HM(()=>
{Ac=gridRenderer.CanvasRendererGlobals.performModelRowColOperation(kb,rb,cc,mc,Sa)}):Ta.HelperMethods.HM(()=>{Ac=gridRenderer.CanvasRendererGlobals.hideRowCols(kb,rb,Sa)});D("HideRowCols",yd,pb);return Ac}function v(kb,rb,cc,mc,Sa,pb,Ac){let yd;if(!kb||!rb)return yd;yd=O(Sa)?gridRenderer.CanvasRendererGlobals.performModelCascadeRowColsOperations(kb,rb,cc,mc,Sa,pb):gridRenderer.CanvasRendererGlobals.performModelCascade(kb,rb,cc,pb);yd.metric&&D("ModelCascade",yd.metric.gsl,Ac);return yd}function B(kb,
rb,cc,mc){return cc?-1113896058===mc||1542466017===mc?kb.RowNumbers[kb.RowNumbers.length-rb-1]:kb.RowNumbers[0]:1415868706===mc||369708605===mc?kb.ColumnNumbers[kb.ColumnNumbers.length-rb-1]:kb.ColumnNumbers[0]}function z(kb){let rb=-1;for(let cc=0;cc<kb.length;cc++){const mc=kb[cc].eK().topLeft.Y;mc>rb&&(rb=mc)}return rb}function C(kb){let rb=-1;for(let cc=0;cc<kb.length;cc++){const mc=kb[cc].eK().topLeft.X;mc>rb&&(rb=mc)}return rb}function D(kb,rb,cc){cc=ua?mb.b().kp(cc):cc;lb?sa.ULS.sendTraceTag(509723719,
0,20,`GridInstantaneousAction: Time taken to complete operation=${kb} is time=${rb} and command=${cc}`):sa.ULS.sendTraceTag(507869347,0,50,`GridInstantaneousAction: Time taken to complete operation=${kb} is time=${rb} and command=${cc}`)}function J(kb,rb,cc){var mc,Sa;for(const Ac of rb)if(!Ya.EwaSettings.Lga()||Ac.source&&Ac.destination){if(!(Ya.EwaSettings.Lga()||Ac.source&&Ac.destination))return!0;var pb=null===(mc=Ac.destination)||void 0===mc?void 0:mc.jj;rb=null===(Sa=Ac.source)||void 0===Sa?
void 0:Sa.jj;if(Ya.EwaSettings.GFc()&&(!pb||!rb))return M("isFirstRowColOfNextBlockHidden",cc),!0;pb=kb.sHd(pb);rb=kb.sHd(rb);switch(cc){case -706918724:case 674605324:return pb&&pb.IsFirstColOfNextBlockHidden;case 369708605:case 1415868706:return pb&&(null===pb||void 0===pb?void 0:pb.IsLastColOfPrevBlockHidden)||rb&&(null===rb||void 0===rb?void 0:rb.IsFirstColOfNextBlockHidden);case 1051390410:case 1554436520:return pb&&pb.IsFirstRowOfNextBlockHidden;case 1542466017:case -1113896058:return pb&&(null===
pb||void 0===pb?void 0:pb.IsLastRowOfPrevBlockHidden)||rb&&(null===rb||void 0===rb?void 0:rb.IsFirstRowOfNextBlockHidden)}}return!1}function W(kb,rb,cc){for(const mc of rb){if(Ya.EwaSettings.Ijj()&&!mc)return sa.ULS.sendTraceTag(508339915,0,50,`GridInstantaneousAction.isSelectedRangeAcrossBlocks: blockPair or sourceBlock is null and command=${cc}`),!0;if(!mc.source||!mc.destination)if(Ya.EwaSettings.Lga())continue;else return sa.ULS.sendTraceTag(507875778,0,50,`GridInstantaneousAction.isSelectedRangeAcrossBlocks: sourceBlock or destination Block is null and command=${cc}`),
!0;if(Ya.EwaSettings.GFc()){rb=mc.source.jj;const Sa=mc.destination.jj;if(!rb||!Sa)return M("isSelectedRangeAcrossBlocks",cc),!0;if(Ya.EwaSettings.Hjj()){if(rb.yi(kb)&&Sa.yi(kb))return!0}else{const pb=-706918724===cc||674605324===cc||1051390410===cc||1554436520===cc;if(pb&&rb.yi(kb)||!pb&&Sa.yi(kb))return!0}}else if(mc.source.jj.yi(kb))return!0}return!1}function N(kb,rb,cc,mc,Sa){return Ya.EwaSettings.r0a()?gridRenderer.CanvasRendererGlobals.canMultipleRowColHideOrCascade(kb,rb,cc,mc,Sa):gridRenderer.CanvasRendererGlobals.canRowColHideOrCascade(kb,
rb,mc,Sa)}function M(kb,rb){sa.ULS.sendTraceTag(508347672,0,50,`GridInstantaneousAction: BlockRange was null in the method = ${kb} and command =${rb}`)}function Q(kb,rb,cc){if(-706918724===rb||674605324===rb||1051390410===rb||1554436520===rb){if(kb.destination)return kb=kb.destination.jj,kb?kb.yi(cc):(M("doesBlockRangeIntersectWithSelectedRange",rb),!1);M("doesBlockRangeIntersectWithSelectedRange destinationBlock",rb)}else if(369708605===rb||1415868706===rb||1542466017===rb||-1113896058===rb){if(kb.source)return kb=
kb.source.jj,kb?kb.yi(cc):(M("doesBlockRangeIntersectWithSelectedRange",rb),!1);M("doesBlockRangeIntersectWithSelectedRange sourceBlock",rb)}return!1}function R(kb){switch(kb){case -706918724:case 1051390410:return Ia.Hide;case 369708605:case 1542466017:return Ia.Unhide;case 674605324:case 1554436520:return Ia.Delete;case 1415868706:case -1113896058:return Ia.Insert}throw Error(`GridInstantaneousAction::getGridInstantaneousOperation: Command ${kb} not supported currently`);}function O(kb){switch(kb){case Ia.Hide:return Ya.EwaSettings.r0a()||
Ya.EwaSettings.HFc();case Ia.Insert:return Ya.EwaSettings.Jxa()||Ya.EwaSettings.Ixa();case Ia.Delete:return Ya.EwaSettings.oKa()||Ya.EwaSettings.Zlb();default:return!1}}function U(kb){const rb=Ya.EwaSettings.Jxa()&&-1113896058===kb;return Ya.EwaSettings.Ixa()&&1415868706===kb||rb}function K(kb){const rb=Ya.EwaSettings.HFc()&&1051390410===kb;return Ya.EwaSettings.qmb()&&-706918724===kb||rb}function F(kb){const rb=Ya.EwaSettings.oKa()&&1554436520===kb;return Ya.EwaSettings.Zlb()&&674605324===kb||rb}
function I(){return pa}function P(){pa={dispose(){}}}function Y(kb,rb,cc){const mc=kb.Fj.PaneViewData;kb=kb.jJa();const Sa={};switch(rb){case -1113896058:Sa.Height=kb.BlockHeight;Sa.AbsoluteTop=kb.BlockHeight;Sa.FirstScrollableRow=mc.FirstScrollableRow+cc;Sa.VisibleRows=mc.VisibleRows+cc;Sa.FirstFrozenRow=mc.FirstFrozenRow;break;case 1554436520:case 1051390410:Sa.Height=kb.BlockHeight;Sa.AbsoluteTop=kb.BlockHeight;Sa.FirstScrollableRow=mc.FirstScrollableRow-cc;Sa.VisibleRows=mc.VisibleRows-cc;Sa.FirstFrozenRow=
mc.FirstFrozenRow;break;default:Sa.Height=mc.Height,Sa.AbsoluteTop=mc.AbsoluteTop,Sa.FirstScrollableRow=mc.FirstScrollableRow,Sa.VisibleRows=mc.VisibleRows,Sa.FirstFrozenRow=mc.FirstFrozenRow}switch(rb){case 1415868706:Sa.AbsoluteLeft=kb.BlockWidth;Sa.Width=kb.BlockWidth;Sa.VisibleColumns=mc.VisibleColumns+cc;Sa.FirstScrollableColumn=mc.FirstScrollableColumn+cc;Sa.FirstFrozenColumn=mc.FirstFrozenColumn;break;case 674605324:Sa.AbsoluteLeft=kb.BlockWidth;Sa.Width=kb.BlockWidth;Sa.VisibleColumns=mc.VisibleColumns-
cc;Sa.FirstScrollableColumn=mc.FirstScrollableColumn-cc;Sa.FirstFrozenColumn=mc.FirstFrozenColumn;break;case -706918724:Sa.FirstScrollableColumn=mc.FirstScrollableColumn;Sa.AbsoluteLeft=kb.BlockWidth;Sa.Width=kb.BlockWidth;Sa.VisibleColumns=mc.VisibleColumns-cc;Sa.FirstFrozenColumn=mc.FirstFrozenColumn;break;default:Sa.AbsoluteLeft=mc.AbsoluteLeft,Sa.Width=mc.Width,Sa.VisibleColumns=mc.VisibleColumns,Sa.FirstScrollableColumn=mc.FirstScrollableColumn,Sa.FirstFrozenColumn=mc.FirstFrozenColumn}Sa.State=
mc.State;Sa.IsEstimated=mc.IsEstimated;return Sa}function ea(kb,rb,cc){if(-706918724===rb||1051390410===rb)return!1;let mc=!0;if(kb)switch(rb){case 1415868706:Ba(kb,cc,!0,!1);break;case 674605324:Ba(kb,cc,!1,!1);break;case -1113896058:Ba(kb,cc,!0,!0);break;case 1554436520:Ba(kb,cc,!1,!0)}else mc=!1;return mc}function Ba(kb,rb,cc,mc){if(cc)if(mc)for(cc=0;cc<kb.RowNumbers.length;cc++)kb.RowNumbers[cc]+=rb;else for(cc=0;cc<kb.ColumnNumbers.length;cc++)kb.ColumnNumbers[cc]+=rb;else if(mc)for(cc=0;cc<
kb.RowNumbers.length;cc++)kb.RowNumbers[cc]-=rb;else for(cc=0;cc<kb.ColumnNumbers.length;cc++)kb.ColumnNumbers[cc]-=rb}function Fa(kb){return fb?Math.max(kb-1,1):kb-1}a.r(x);var za={};a.r(za);a.d(za,"GridInstantaneousOperation",function(){return Ia});a.d(za,"GridInstantaneousAction",function(){return Yb});a.d(za,"testableGetBlockPairsInViewport",function(){return m});a.d(za,"testablePerformModelRowColOperation",function(){return n});a.d(za,"testablePerformModelCascade",function(){return v});a.d(za,
"testableGetPartialInteractivityState",function(){return I});a.d(za,"testableInitPartialInteractivityState",function(){return P});a.d(za,"testableIsFirstRowColOfNextBlockHidden",function(){return J});a.d(za,"testableIsSelectedRangeAcrossBlocks",function(){return W});a.d(za,"testableGetRowColNumberForCascade",function(){return B});var xa={};a.r(xa);a.d(xa,"ResizeCommandHandler",function(){return sb});var fa=a(179),V=a(0),ba=a(24),la=a(26),Ta=a(13),Ea=a(188),sa=a(14),Ya=a(1),bb=a(47),ra=a(12),Da=a(96),
oa=a(5),Ha=a(97),ka=a(10),wa=a(1066);class Za{constructor(kb,rb,cc){this.TTb=!0;this.Ej=kb;this.Qha=rb;this.TTb=cc||Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8453101_deleteRowsRefUpdate")}p6k(kb,rb,cc,mc){if(kb){var Sa=kb.includes(this.Qha);if(!this.Ej)return{isRefError:kb.includes(this.Qha),newFormula:kb};var pb=this.Ej.VDd(kb);if(pb){var Ac=0>cc||0>rb,yd=[];for(const Kd of pb)switch(pb=Kd.ref,pb.type){case wa.a.cell:var vb=pb,Sc=vb.row,hd=vb.col;pb="Abs"===Sc.kind;var qc="Abs"===hd.kind;Sc=
Sc.index+1;hd=hd.index+1;var Lc=la.Range.gi(Sc,hd);vb=vb.span;if(Ac&&r(mc,Lc)){yd.push({value:this.Qha,start:vb.start,end:vb.end});Sa=!0;break}var bd=0===cc?!0:Lc.left<mc.right;Lc=0===rb?!0:Lc.bottom<mc.top;if(bd&&Lc)break;Sc=Lc?Sc:Sc+rb;hd=bd?hd:hd+cc;if(!c(Sc)||!b(hd)){yd.push({value:this.Qha,start:vb.start,end:vb.end});Sa=!0;break}pb=la.Range.gi(Sc,hd).Sfa(qc,pb,qc,pb);yd.push({value:pb,start:vb.start,end:vb.end,EKa:this.Ej.CVa(vb.end,kb)});break;case wa.a.column:if(!cc)break;hd=pb;qc=hd.startIndex;
Sc=hd.endIndex;vb=qc.index+1;pb=Sc.index+1;qc="Abs"===qc.kind;Sc="Abs"===Sc.kind;Lc=la.Range.f0(vb,pb);hd=hd.span;if(Ac&&r(mc,Lc)){yd.push({value:this.Qha,start:hd.start,end:hd.end});Sa=!0;break}bd=Lc.left<mc.left;Lc=Lc.right<mc.left;if(bd&&Lc)break;vb=bd?vb:vb+cc;var jd=Lc?pb:pb+cc;Ac&&0<=jd-vb&&1>vb&&(vb=1);this.TTb&&0>cc&&bd&&!Lc&&mc.right>pb&&1<=mc.left-1&&(jd=mc.left-1);if(!b(vb)||!b(jd)){yd.push({value:this.Qha,start:hd.start,end:hd.end});Sa=!0;break}pb=la.Range.f0(vb,jd).Sfa(qc,!1,Sc,!1);yd.push({value:pb,
start:hd.start,end:hd.end});break;case wa.a.row:if(!rb)break;Sc=pb;hd=Sc.startIndex;vb=Sc.endIndex;pb="Abs"===hd.kind;qc="Abs"===vb.kind;hd=hd.index+1;vb=vb.index+1;Lc=la.Range.AX(hd,vb);Sc=Sc.span;if(Ac&&r(mc,Lc)){yd.push({value:this.Qha,start:Sc.start,end:Sc.end});Sa=!0;break}bd=Lc.top<mc.top;Lc=Lc.bottom<mc.top;if(bd&&Lc)break;hd=bd?hd:hd+rb;jd=Lc?vb:vb+rb;Ac&&0<=jd-hd&&1>hd&&(hd=1);this.TTb&&0>rb&&bd&&!Lc&&mc.bottom>vb&&1<=mc.top-1&&(jd=mc.top-1);if(!c(hd)||!c(jd)){yd.push({value:this.Qha,start:Sc.start,
end:Sc.end});Sa=!0;break}pb=la.Range.AX(hd,jd).Sfa(!1,pb,!1,qc);yd.push({value:pb,start:Sc.start,end:Sc.end});break;case wa.a.range:var Yd=pb;vb=Yd.top;hd=Yd.left;bd=Yd.bottom;Lc=Yd.right;var te=vb.index+1;Sc=hd.index+1;pb=bd.index+1;qc=Lc.index+1;vb="Abs"===vb.kind;hd="Abs"===hd.kind;bd="Abs"===bd.kind;jd="Abs"===Lc.kind;var oe=new la.Range(te,Sc,pb,qc,!1,!1);Lc=Yd.topLeftSpan;Yd=Yd.bottomRightSpan;if(Ac&&r(mc,oe)){yd.push({value:this.Qha,start:Lc.start,end:Yd.end});Sa=!0;break}const Ee=0===rb?!0:
oe.top<mc.top,rc=0===cc?!0:oe.left<mc.left,fd=0===rb?!0:oe.bottom<mc.top;oe=0===cc?!0:oe.right<mc.left;if(Ee&&rc&&fd&&oe)break;let Ed=Ee?te:te+rb;te=fd?pb:pb+rb;let Rd=rc?Sc:Sc+cc;Sc=oe?qc:qc+cc;this.TTb&&0>rb&&Ee&&!fd&&mc.bottom>pb&&1<=mc.top-1&&(te=mc.top-1);this.TTb&&0>cc&&rc&&!oe&&mc.right>qc&&1<=mc.left-1&&(Sc=mc.left-1);Ac&&0<=te-Ed&&1>Ed&&(Ed=1);Ac&&0<=te-Rd&&1>Rd&&(Rd=1);b(Rd)&&c(Ed)?b(Sc)&&c(te)?(pb=la.Range.gi(Ed,Rd).Sfa(vb,hd,!1,!1),qc=la.Range.gi(te,Sc).Sfa(bd,jd,!1,!1),yd.push({value:pb,
start:Lc.start,end:Lc.end,EKa:this.Ej.CVa(Lc.end,kb)}),yd.push({value:qc,start:Yd.start,end:Yd.end,EKa:this.Ej.CVa(Yd.end,kb)})):(yd.push({value:this.Qha,start:Yd.start,end:Yd.end}),Sa=!0):(yd.push({value:this.Qha,start:Lc.start,end:Lc.end}),Sa=!0)}return{newFormula:f(kb,yd),isRefError:Sa}}}}dispose(){this.Ej=null}}Object(V.a)(Za,"GridReferenceUpdate",null,[2]);var ab=a(400),db=a(213),mb=a(61),Ia;(function(kb){kb.Hide="Hide";kb.Unhide="Unhide";kb.Insert="Insert";kb.Delete="Delete";kb.FreezePane="FreezePane"})(Ia||
(Ia={}));Object(V.b)("GridInstantaneousOperation",Ia);let pa=null,lb=!1;const ha=Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8524738_CanvasAndSelectionHighlightBugFix");let ua=!1,fb=!1,Ka=!1;const La=ka.a.WQ/4,ib=ka.a.F_/4;let Yb=class{constructor(kb,rb,cc){this.$=kb;this.Ej=rb;this.ek=cc;this.k2b="!REF#";this.Xo=()=>{pa&&(Da.a.Ng(pa),pa=null);this.Gna&&(this.$.rUd=!1)};this.ykg=()=>{this.k2b=this.DRd.hk.ErrorNames[3];this.xNd=new Za(this.Ej,this.k2b)};this.da=ba.f(this.$);this.za=this.da.za;this.Txa=
!1;this.hLb=this.$.ea.gk;this.V3b={};this.sy={};this.fla={};this.Gna=Ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GlobalStylesSlice1",!1);this.n0a=Ya.EwaSettings.xFc();this.za.Uy(this.Xo);this.ehj=Ya.EwaSettings.oKa();this.wkj=Ya.EwaSettings.Jxa();this.skj=Ya.EwaSettings.Ixa();this.dhj=Ya.EwaSettings.Zlb();this.wKa=this.skj||this.wkj||this.ehj||this.dhj;this.XZf=Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8619261_EnableRowColCSEForCellEntryPoint");this.aSd=Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8645280_EnablingRowColCSEIfFirstRowColOfNextBlockHidden");
this.FFc=Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8702535_EnablingHiddenRangeSlice2Ewa");this.hfj=Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8682827_CSEUnattemptedBugFix");this.wKa&&void Ha.a.hj(oa.wd).then(mc=>{this.DRd=mc;mc.hk?(mc.hk.ErrorNames&&3<mc.hk.ErrorNames.length&&(this.k2b=mc.hk.ErrorNames[3]),this.xNd=new Za(this.Ej,this.k2b)):mc.Smd(this.ykg)});lb=Ya.EwaSettings.Fnb();ua=Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8554527_newOpDuration");fb=Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8575809_mathMax");
Ka=Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8699403_measureValidations")}dispose(){this.da=this.$=null;this.sy={};this.Txa=!1;this.V3b={};this.za.Ix(this.Xo);this.DRd&&this.DRd.MSc(this.ykg)}Kpd(kb,rb,cc){try{if(this.Txa)sa.ULS.sendTraceTag(509658009,0,15,`GridInstantaneousAction.attemptInstantaneousGridAction command=${kb}, parameter = isProcessing, value=true, reason = AttemptInstantaneousGridAction is still processing, isRow=${rb}`);else if(this.ijj(kb)){const Lc=this.za.Hxc();this.WGh(kb,
null===cc||void 0===cc?void 0:cc.wz,Lc)}else{var mc=Ya.EwaSettings.r0a()?Ya.EwaSettings.Fje():Ya.EwaSettings.B2d(),Sa=this.za.Hxc(1554436520===kb||1051390410===kb?mc:0,674605324===kb||-706918724===kb?mc:0);this.nF=Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8627749_EnabledSelectedRangePassingAsParameter")&&(null===cc||void 0===cc?0:cc.selectedRanges)?null===cc||void 0===cc?void 0:cc.selectedRanges:this.da.ha.qa.selectedRanges;if(this.XZf){const Lc=this.nF[0];var pb=rb?!(1===Lc.left&&Lc.right===
Lc.maxColumns):!(1===Lc.top&&Lc.bottom===Lc.maxRows)}else pb=!1;this.Xnj=pb;if(this.XZf&&this.Xnj){var Ac=this.nF;if(0===Ac.length)var yd=null;else{mc=[];for(const Lc of Ac){const bd=Lc.clone();rb?(bd.left=1,bd.right=bd.maxColumns):(bd.top=1,bd.bottom=bd.maxRows);mc.push(bd)}yd=mc}this.nF=yd}var vb=m(this.da,Sa,rb,kb,this.nF);this.sy={};this.wKa&&(this.fla={},this.Psb=0,this.LJb=cc);if(!Ka||!this.ncb("WebServiceResponseReceivedInAttemptInstantaneousGridAction",Sa,kb,rb)){var Sc=performance.now();
this.P4d=this.VOi(kb,rb);var hd=this.xkj(kb,Sa,vb,rb),qc=performance.now()-Sc;qc&&Ka&&sa.ULS.sendTraceTag(507556638,0,50,`GridInstantaneousAction.attemptInstantaneousGridAction command=${kb}, time taken for isInstantaneousGridActionPossible=${qc}, isRow=${rb}`);hd?(this.Txa=!0,this.$.rUd=!0,ua&&(this.zpg=performance.now()),this.Fug(kb,rb,vb,Sa)):this.da.nk.Dya(!1)}}}catch(Lc){this.gBc("GridInstantaneousAction.AttemptInstantaneousGridAction",Lc,kb)}}Yde(){this.hLb=this.$.ea.gk}WGh(kb,rb,cc){if(this.hjj(kb,
cc,rb)){this.zpg=performance.now();this.Txa=!0;const mc=w(cc);this.sy={};this.H7j(kb,mc,cc,rb)}else this.da.nk.Dya(!1)}hjj(kb,rb,cc){var mc,Sa;if(!this.gjj(kb)||isNullOrUndefined(cc))return!1;const pb=this.da.mj;if(cc.VisibleColumns+1!==cc.FirstScrollableColumn||cc.VisibleRows+1!==cc.FirstScrollableRow)return sa.ULS.sendTraceTag(507650447,0,50,`GridInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${kb}, parameter = Scroll present`),!1;for(const Ac of rb){rb=Ac.Fj;if(0<(null===
(Sa=null===(mc=null===rb||void 0===rb?void 0:rb.Content)||void 0===mc?void 0:mc.MergedRanges)||void 0===Sa?void 0:Sa.length))return sa.ULS.sendTraceTag(507650446,0,50,`GridInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${kb}, parameter = Merged Cell present`),!1;if(0<Ac.Qo.count)return sa.ULS.sendTraceTag(507650445,0,50,`GridInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${kb}, parameter = FO present`),!1;if(Ac.el.getHasTable())return sa.ULS.sendTraceTag(507650444,
0,50,`GridInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${kb}, parameter = Table present`),!1;if(pb.Pxa(Ac.jj))return sa.ULS.sendTraceTag(507650443,0,50,`GridInstantaneousAction.isFreezePanesInstantaneousGridActionEnabled command=${kb}, parameter = Hidden row/col present`),!1}return!0}xkj(kb,rb,cc,mc){const Sa=this.da,pb=this.da.nk;if(!this.dUf(kb))return pb.lY("CSENotEnabledForCommand"),!1;if(Sa.rtl)return sa.ULS.sendTraceTag(508171339,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${kb}, parameter = hasRtl, value=true, isRow=${mc}`),
pb.lY("RTL"),!1;if(!Ya.EwaSettings.H0a()&&Sa.Pg.mz)return sa.ULS.sendTraceTag(508958784,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${kb}, parameter = hasPanes, value=true, isRow=${mc}`),!1;var Ac=Sa.mj,yd=this.nF,vb=this.nF[0],Sc=yd.length;if(1<Sc)return sa.ULS.sendTraceTag(509658007,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${kb}, parameter = SelectedRanges, value=${Sc}, reason = Discontinuous selection, isRow=${mc}`),pb.lY("Discontinuous selection"),
!1;var hd=Ya.EwaSettings.Jxa()&&-1113896058===kb;Sc=Ya.EwaSettings.Ixa()&&1415868706===kb;if(hd||Sc){if(hd){if(1!==vb.top){var qc=new la.Range(vb.top-1,vb.left,vb.top-1,vb.right,!1,!1);qc=Ac.Ymb(qc)}}else 1!==vb.left&&(qc=new la.Range(vb.top,vb.left-1,vb.bottom,vb.left-1,!1,!1),qc=Ac.Ulb(qc));if(qc)return sa.ULS.sendTraceTag(508072654,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${kb}, parameter = isPreviousRowColHidden, value=true, isRow=${mc}`),pb.lY("isPreviousRowColHidden"),
!1;var Lc;a:{for(const rc of cc){if(Ya.EwaSettings.Lga()){if(!rc.source)continue}else if(!rc.source)break;qc=null===(Lc=rc.source)||void 0===Lc?void 0:Lc.jj;if(!qc){M("isFirstRowColOfNonInitialModel",kb);break}if(qc.yi(vb)){Lc=!1;hd?1!==qc.top&&vb.top===qc.top&&(Lc=!0):!Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8690337_InsertColumnFlickerBugFix")&&1===qc.left||vb.left!==qc.left||(Lc=!0);break a}}Lc=!0}if(Lc)return sa.ULS.sendTraceTag(508065493,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${kb}, parameter = isFirstRowColInNonInitialModel, value=true, isRow=${mc}`),
pb.lY("isFirstRowColInNonInitialModel"),!1}if(Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8598978_EnablingCseForHiddenRangesSlice1")){if(!this.FFc&&!this.m$e(vb,mc))return sa.ULS.sendTraceTag(509658006,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${kb}, parameter = isPartOfRangeHidden, value=true, isRow=${mc}`),!1}else if(Ac.Pxa(vb))return sa.ULS.sendTraceTag(507635548,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${kb}, parameter = isPartOfRangeHidden, value=true, isRow=${mc}`),
!1;Ac=this.P4d;if(Ya.EwaSettings.r0a()?Ac>Ya.EwaSettings.Fje():Ac>Ya.EwaSettings.B2d())return sa.ULS.sendTraceTag(508409418,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${kb}, parameter = rowColCount, value=${Ac}, reason = rowColCount is higher than the limit, isRow=${mc}`),pb.lY("rowColCount is higher than the limit"),!1;if(hd&&(hd=Sa.usedRange.bottom+Ac,hd>ka.a.KF))return sa.ULS.sendTraceTag(508061699,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${kb}, parameter = newRowCount, value=${hd}, reason = newRowCount is higher than the MaxRows, isRow=${mc}`),
pb.lY("newRowCount is higher than the MaxRows"),!1;if(Sc&&(Sc=Sa.usedRange.right+Ac,Sc>ka.a.nE))return sa.ULS.sendTraceTag(508061698,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${kb}, parameter = newColCount, value=${Sc}, reason = newColCount is higher than the MaxRows, isRow=${mc}`),pb.lY("newColCount is higher than the MaxCols"),!1;if(W(vb,cc,kb))return sa.ULS.sendTraceTag(508404044,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${kb}, parameter = isSelectedRangeAcrossBlocks, value=true, isRow=${mc}`),
pb.lY("isSelectedRangeAcrossBlocks"),!1;if(Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8624357_DisableRowColCSEForTables")&&!this.uPh(vb,kb))return sa.ULS.sendTraceTag(507855194,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${kb}, parameter = selectedRangeContainingTable, value=true, isRow=${mc}`),pb.lY("selectedRangeContainingTable"),!1;Sc=rb.length;if(Sc>Ya.EwaSettings.mCj())return sa.ULS.sendTraceTag(509658004,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${kb}, parameter = BlocksInViewport, value=${Sc}, reason = Blocks in viewport limit exceeded, isRow=${mc}`),
pb.lY("Blocks in viewport limit exceeded"),!1;a:{Sc=Ac-1;for(bd of cc){if(!bd){sa.ULS.sendTraceTag(509649925,0,50,`GridInstantaneousAction.canRowColHideOrCascade: blockPair or sourceBlock or destinationBlock is null and command=${kb}`);var bd=!1;break a}Ac=bd.source;if(!Ya.EwaSettings.Lga()||Ac){if(!Ya.EwaSettings.Lga()&&!Ac){bd=!1;break a}Ac=Ac.Fj.GridBlockModel;hd=B(Ac,Sc,mc,kb);if(!N(Ac,hd,Sc,mc,R(kb))){bd=!1;break a}}}bd=!0}if(!bd)return sa.ULS.sendTraceTag(509658003,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${kb}, parameter = canRowColCascade, value=false, reason = Model has complex cells, isRow=${mc}`),
pb.lY("Model has complex cells"),!1;a:{bd=mc?vb.top:vb.left;Sc=mc?vb.bottom-vb.top:vb.right-vb.left;if(vb=this.za.yIa(vb,this.$.activeItemName))for(jd of vb)if(!N(jd.Fj.GridBlockModel,bd,Sc,mc,R(kb))){var jd=!1;break a}jd=!0}if(!jd)return sa.ULS.sendTraceTag(509084812,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${kb}, parameter = canRowColHideOrCascade, value=false, reason = Selected row or Col has complex cells, isRow=${mc}`),pb.lY("Selected row or Col has complex cells"),
!1;a:{yd=yd[0];jd=0;for(Yd of cc)if(!Ya.EwaSettings.Lga()||Yd.source&&Yd.destination){if(!(Ya.EwaSettings.Lga()||Yd.source&&Yd.destination))break;bd=Yd.destination.jj;vb=Yd.source.jj;if(null===bd||null===vb){M("getTransitionCount source or destination block range is null",kb);var Yd=Ya.EwaSettings.D2d()+1;break a}if(!bd&&Ya.EwaSettings.GFc()){M("getTransitionCount",kb);Yd=Ya.EwaSettings.D2d()+1;break a}Sc=yd;(vb=369708605===kb||1415868706===kb||1542466017===kb||-1113896058===kb?vb.yi(Sc):bd.yi(Sc))||
(vb=kb,Ac=Yd,bd=yd,!Ya.EwaSettings.Lga()||Ac.source&&Ac.destination?(Sc=Ac.source.jj,Ac=Ac.destination.jj,!Ya.EwaSettings.GFc()||Ac&&Sc?vb=-706918724===vb||674605324===vb?Ac.left>bd.right:369708605===vb||1415868706===vb?Sc.left>bd.right:1051390410===vb||1554436520===vb?Ac.top>bd.bottom:Sc.top>bd.bottom:(M("shouldPerformTransitions",vb),vb=!1)):vb=!1);vb&&(jd+=1)}Yd=jd}if(Yd>Ya.EwaSettings.D2d())return sa.ULS.sendTraceTag(509658002,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${kb}, parameter = TransitionCount, value=${Yd}, reason = Transition count limit exceeded, isRow=${mc}`),
pb.lY("Transition count limit exceeded"),!1;if(!this.aSd&&J(Sa,cc,kb))return sa.ULS.sendTraceTag(508564123,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${kb}, parameter = isFirstRowColOfNextBlockHidden, value=true, isRow=${mc}`),!1;if(cc=Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8683331_OutlineBugFix")){var te;a:{var oe,Kd,Ee;for(const rc of rb)if(rb=rc.jJa(),mc&&rb&&0<(null===(te=rb.RowOutlines)||void 0===te?void 0:te.length)&&0<(null===(oe=rb.RowOutlinesInformation)||
void 0===oe?void 0:oe.length)||!mc&&rb&&0<(null===(Kd=rb.ColumnOutlines)||void 0===Kd?void 0:Kd.length)&&0<(null===(Ee=rb.ColumnOutlinesInformation)||void 0===Ee?void 0:Ee.length)){te=!1;break a}te=!0}cc=!te}if(cc)return sa.ULS.sendTraceTag(507566090,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${kb}, parameter = outlines, value=true, isRow=${mc}`),pb.lY("Outlines are present"),!1;sa.ULS.sendTraceTag(509658001,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${kb}, parameter = isInstantaneousGridActionPossible, value=true, reason = isInstantaneousGridActionPossible successful, isRow=${mc}`);
return!0}I1b(kb,rb,cc,mc,Sa,pb,Ac){const yd=pb?Sa.Ark:Sa.jVh;Sa=pb?Sa.lVh:Sa.Crk;const vb=pb?"FreezeRow":"FreezeColumn";a:{const Sc=cc.FirstScrollableRow;cc=cc.FirstScrollableColumn;switch(mc){case 1:mc={mUc:pb?kb.RowNumbers[0]:kb.ColumnNumbers[0],BPc:!Ac,APc:!0,performDiagonalCascading:Ac,skipCascadingBeforeRowColIndex:!Ac};break a;case 2:mc={mUc:pb?Sc:cc,BPc:!0,APc:!1,performDiagonalCascading:Ac,skipCascadingBeforeRowColIndex:!1};break a;case 3:mc={mUc:pb?Sc:kb.ColumnNumbers[0],BPc:!0,APc:pb?!1:
!0,performDiagonalCascading:Ac,skipCascadingBeforeRowColIndex:!1};break a;case 4:mc={mUc:pb?kb.RowNumbers[0]:cc,BPc:!0,APc:pb?!0:!1,performDiagonalCascading:Ac,skipCascadingBeforeRowColIndex:!1};break a}mc=null}if(!mc)return sa.ULS.sendTraceTag(507569417,0,15,`GridInstantaneousAction.processFreezePaneBlockAdjustment command=${vb}, parameter = isHideRowColumnSuccessful, value=false, reason = "fpConstructionParams failed", `),!1;if(kb&&0<=yd){if(mc.BPc&&!gridRenderer.CanvasRendererGlobals.performModelRowColOperation(kb,
mc.mUc,yd,Ia.FreezePane,pb))return sa.ULS.sendTraceTag(507586704,0,15,`GridInstantaneousAction.processFreezePaneBlockAdjustment command=${vb}, parameter = freezePaneRestructureSuccessful, isRow =${pb}, value=false, reason = "Restructuring was failure", `),!1;if(rb&&kb&&mc.APc)if(gridRenderer.CanvasRendererGlobals.performModelCascadeRowColsOperations(rb,kb,pb?rb.RowNumbers[0]:rb.ColumnNumbers[0],yd,Ia.FreezePane,pb,{rowColIndexToEndRangeCascade:Sa,skipCascadingBeforeRowColIndex:mc.skipCascadingBeforeRowColIndex,
performDiagonalCascading:mc.performDiagonalCascading}).isSuccess)sa.ULS.sendTraceTag(507576470,0,50,`GridInstantaneousAction.processFreezePaneBlockAdjustment command=${vb}, parameter = freezePaneBlockCascadeOperation, value=true, isRow =${pb}, reason = "BlockCascadeRowColsOperations success", `);else return sa.ULS.sendTraceTag(507586703,0,15,`GridInstantaneousAction.processFreezePaneBlockAdjustment command=${vb}, parameter = freezePaneBlockCascadeOperation, value=false, isRow =${pb}, reason = "BlockCascadeRowColsOperations was failure", `),
!1}return!0}Fug(kb,rb,cc,mc){var Sa;try{if(this.dUf(kb)){var pb=Ta.HelperMethods.uh(),Ac=Ya.EwaSettings.C2d(),yd=cc.filter(Yd=>!Yd.T5),vb=this.nF[0],Sc=this.FFc?this.P4d-1:rb?vb.bottom-vb.top:vb.right-vb.left,hd=R(kb);for(const Yd of yd){if(this.ncb("WebServiceResponseReceivedInProcessGridAction",mc,kb,rb))return;if(this.wKa){if(!t(Yd,vb,kb,rb))continue}else{const fd=Yd.destination.jj;if(!fd){M("processGridAction",kb);return}if(fd.right<vb.left){Yd.T5=!0;sa.ULS.sendTraceTag(509657999,0,50,`GridInstantaneousAction.processGridAction command=${kb}, parameter = BlockRangeLessThanSelectedRange, selectedRangeLeftValue=${vb.left}, blockRangeRightMostValue=${fd.right}, hashCode=${Yd.destination.Ci}, isRow=false`);
continue}}const te=rb?vb.topLeft.top:vb.topLeft.left;let oe,Kd;Ya.EwaSettings.Lga()?(oe=Yd.source?this.dwa("SourceModel",Yd.source,kb):null,Kd=Yd.destination?this.dwa("DestinationModel",Yd.destination,kb):null):(oe=this.dwa("SourceModel",Yd.source,kb),Kd=this.dwa("DestinationModel",Yd.destination,kb));const Ee=Yd.destination?Yd.destination.Ci:Yd.source.Ci;cc=!1;const rc=hd===Ia.Hide||hd===Ia.Delete?Kd:oe;if(Q(Yd,kb,vb)){if(!n(rc,te,Sc,hd,rb,kb)){this.pT();sa.ULS.sendTraceTag(509657998,0,15,`GridInstantaneousAction.processGridAction command=${kb}, parameter = isHideColumnSuccessful, value=false, reason = "HideRowColOperation was failure", hashCode=${Ee}, isRow=${rb}, rowColNumber=${te}`);
return}sa.ULS.sendTraceTag(509657997,0,50,`GridInstantaneousAction.processGridAction command=${kb}, parameter = isHideColumnSuccessful, value=true, reason = "HideRowColOperation was successful", hashCode=${Ee}, isRow=${rb}, rowColNumber=${te}`)}else if(Ya.EwaSettings.H0a()&&this.da.Pg.ZVd(vb)){const fd=this.da.Pg.Hm;if(vb.right<=this.da.Pg.Sm||vb.bottom<=fd)cc=ea(rc,kb,Sc+1)}if(oe&&Kd&&!cc){let fd;fd=this.wKa?B(oe,Sc,rb,kb):oe.ColumnNumbers[0];const Ed=Yd.source.Ci;if(v(oe,Kd,fd,Sc,hd,rb,kb).isSuccess)Yd.T5=
!0,this.aSd&&(this.sy[Ed]||this.iBg(oe,rb),this.sy[null===(Sa=null===Yd||void 0===Yd?void 0:Yd.destination)||void 0===Sa?void 0:Sa.Ci]||this.iBg(Kd,rb),this.M2k(oe,Kd,hd,rb)),sa.ULS.sendTraceTag(509657996,0,50,`GridInstantaneousAction.processGridAction command=${kb}, parameter = cascadeResult.isSuccess, value=true, reason = "CascadeResult was successful", hashCode=${Ed}, isRow=${rb}, rowColNumber=${fd}`);else{this.pT();sa.ULS.sendTraceTag(509657995,0,15,`GridInstantaneousAction.processGridAction command=${kb}, parameter = cascadeResult.isSuccess, value=false, reason = "CascadeResult was failure", hashCode=${Ed}, isRow=${rb}, rowColNumber=${fd}`);
return}}else Yd.T5=!0;this.kSk(Kd,oe,Yd);if(Ta.HelperMethods.uh()-pb>Ac){this.Mtk(kb,rb,yd,mc);return}}var qc=()=>{try{this.vWh(rb,kb,mc,vb),D("ProcessGridAction",Ta.HelperMethods.uh()-pb,kb)}catch(Yd){this.gBc("GridInstantaneousAction.ProcessGridAction",Yd,kb)}};if(this.wKa&&this.LJb&&this.LJb.rDc&&this.LJb.rDc.InsertDeleteRangeItems&&0<this.LJb.rDc.InsertDeleteRangeItems.length)if(this.xNd){var Lc=this.LJb.rDc.InsertDeleteRangeItems[0],bd=(Yd,te)=>0!==Lc.DeltaRow?Yd>=vb.top:0!==Lc.DeltaColumn?te>=
vb.left:!1,jd=Yd=>this.xNd.p6k(Yd,Lc.DeltaRow,Lc.DeltaColumn,vb);Ka?window.setTimeout(()=>{this.fxe(mc,kb,rb,bd,jd,qc)},0):this.fxe(mc,kb,rb,bd,jd,qc)}else this.Txa=!1,this.da.nk.Dya(!1),sa.ULS.sendTraceTag(508063873,0,15,`GridInstantaneousAction:processGridAction gridReferenceUpdates is null command=${kb}`);else qc()}else this.Txa=!1,this.da.nk.Dya(!1)}catch(Yd){this.gBc("GridInstantaneousAction.ProcessGridAction",Yd,kb)}}hYh(kb,rb,cc,mc,Sa,pb){var Ac,yd,vb,Sc,hd,qc,Lc,bd,jd,Yd=Sa.FirstScrollableRow,
te=ka.a.$T;const oe=Yd>te?Yd%te:Yd;var Kd=0,Ee=oe-1,rc=null===(Lc=kb.RowNumbers)||void 0===Lc?void 0:Lc.length;switch(pb){case 1:Yd<=te?Kd=Ee:(Kd=Yd>kb.RowNumbers[rc-1]?0:oe-1,Kd=0>Kd?te-Math.abs(Kd):Kd);break;case 2:Yd<=te||(Ee=Kd=Yd>kb.RowNumbers[rc-1]?kb.RowNumbers[rc-1]:Yd-(null===(bd=kb.RowNumbers)||void 0===bd?NaN:bd[0]));Kd=rc-Ee;break;case 3:Yd<=te||(Ee=Kd=Yd>kb.RowNumbers[rc-1]?kb.RowNumbers[rc-1]:Yd-(null===(jd=kb.RowNumbers)||void 0===jd?NaN:jd[0]));Kd=rc-Ee;break;case 4:Yd<=te||(Kd=Yd>
kb.RowNumbers[rc-1]?kb.RowNumbers[rc-1]:oe-1,Ee=Kd=0>Kd?te-Math.abs(Kd):Kd),Kd=Ee}var fd,Ed,Rd;rc=Sa.FirstScrollableColumn;bd=ka.a.YT;Lc=rc>bd?rc%bd:rc;Yd=0;jd=Lc-1;te=null===(fd=kb.ColumnNumbers)||void 0===fd?void 0:fd.length;switch(pb){case 1:rc<=bd?Yd=jd:(fd=rc>kb.ColumnNumbers[te-1]?0:Lc-1,Yd=fd=0>fd?bd-Math.abs(fd):fd);break;case 2:rc<=bd||(jd=fd=rc>kb.ColumnNumbers[te-1]?kb.ColumnNumbers[te-1]:rc-(null===(Ed=kb.ColumnNumbers)||void 0===Ed?NaN:Ed[0]));Yd=te-jd;break;case 3:rc<=bd||(fd=rc>kb.ColumnNumbers[te-
1]?kb.ColumnNumbers[te-1]:Lc-1,jd=fd=0>fd?bd-Math.abs(fd):fd);Yd=jd;break;case 4:rc<=bd||(jd=fd=rc>kb.ColumnNumbers[te-1]?kb.ColumnNumbers[te-1]:rc-(null===(Rd=kb.ColumnNumbers)||void 0===Rd?NaN:Rd[0])),Yd=te-jd}Ee={Crk:Ee,Ark:Kd-1,lVh:jd,jVh:Yd-1};switch(pb){case 1:if(!this.I1b(kb,cc,Sa,pb,Ee,!0,!1))return this.pT(),sa.ULS.sendTraceTag(507568152,0,15,`GridInstantaneousAction.constructFreezePaneBlocks Constructing paneType=${pb} failed, cascadingType=Row`),null;if(!this.I1b(kb,rb,Sa,pb,Ee,!1,!1))return this.pT(),
sa.ULS.sendTraceTag(507568151,0,15,`GridInstantaneousAction.constructFreezePaneBlocks Constructing paneType=${pb} failed, cascadingType=Col`),null;if(!this.I1b(kb,mc,Sa,pb,Ee,!1,!0))return this.pT(),sa.ULS.sendTraceTag(507568150,0,15,`GridInstantaneousAction.constructFreezePaneBlocks Constructing paneType=${pb} failed, cascadingType=Diagonal-Col`),null;break;case 2:case 3:case 4:if(!this.I1b(kb,cc,Sa,pb,Ee,!0,!1))return this.pT(),sa.ULS.sendTraceTag(507568149,0,15,`GridInstantaneousAction.constructFreezePaneBlocks Constructing paneType=${pb} failed, cascadingType=Row`),
null;if(!this.I1b(kb,rb,Sa,pb,Ee,!1,!1))return this.pT(),sa.ULS.sendTraceTag(507568148,0,15,`GridInstantaneousAction.constructFreezePaneBlocks Constructing paneType=${pb} failed, cascadingType=Col`),null;break;default:return null}return new la.Range(null===(Ac=kb.RowNumbers)||void 0===Ac?void 0:Ac[0],null===(yd=kb.ColumnNumbers)||void 0===yd?void 0:yd[0],null===(vb=kb.RowNumbers)||void 0===vb?void 0:vb[(null===(Sc=kb.RowNumbers)||void 0===Sc?NaN:Sc.length)-1],null===(hd=kb.ColumnNumbers)||void 0===
hd?void 0:hd[(null===(qc=kb.ColumnNumbers)||void 0===qc?NaN:qc.length)-1],!1,!1)}kYh(kb,rb,cc,mc,Sa,pb){a:{var Ac=cc.FirstScrollableRow,yd=cc.FirstScrollableColumn;for(vb of mc)if(d(vb,Ac,yd)){Ac={};Ac.X=vb.Kq.X;Ac.Y=vb.Kq.Y;var vb=Ac;break a}vb=null}if(!vb||!cc)return sa.ULS.sendTraceTag(507576400,0,15,`GridInstantaneousAction.constructNewFreezePaneBlocksForBlockPair command=${rb}, parameter = getRootBlockPostionOfFP, value=false, reason = "Construction failed", blockPosition= Failed to receive the root of FP ops `),
!1;Ac=cc.FirstScrollableRow;yd=cc.FirstScrollableColumn;for(let oe=1;4>=oe;oe++){a:{var Sc=kb.destination;var hd=cc;var qc=mc,Lc=hd.FirstScrollableRow,bd=hd.FirstScrollableColumn;switch(oe){case 1:hd=Sc.GG.length;hd=Sc.rB[Sc.rB.length-1]>=Lc&&Sc.GG[hd-1]>=bd;break a;case 4:qc=void 0;Lc=hd.FirstScrollableRow;hd=hd.FirstScrollableColumn;bd=null===(qc=Sc.rB)||void 0===qc?void 0:qc.length;hd=0<bd&&Sc.rB[bd-1]>=Lc&&hd>=Sc.GG[0];break a;case 3:Lc=void 0;bd=hd.FirstScrollableRow;hd=hd.FirstScrollableColumn;
var jd=Number.MAX_VALUE;for(const Kd of qc)Kd.Kq.Y<jd&&(jd=Kd.Kq.Y);Sc.Kq.Y>jd&&bd<Sc.rB[0]?hd=!1:(qc=null===(Lc=Sc.GG)||void 0===Lc?void 0:Lc.length,hd=0<qc&&Sc.GG[qc-1]>=hd);break a;case 2:Lc=qc=void 0;bd=hd.FirstScrollableRow;jd=hd.FirstScrollableColumn;hd=0<(null===(Lc=Sc.GG)||void 0===Lc?void 0:Lc.length)&&Sc.GG[0]<=jd&&0<(null===(qc=Sc.rB)||void 0===qc?void 0:qc.length)&&Sc.rB[0]<=bd;break a}hd=!1}if(hd){qc=kb.destination;bd=Ac;jd=yd;Sc=oe;Lc=vb;hd={};if(d(qc,bd,jd))switch(Sc){case 1:hd.X=0;
hd.Y=0;break;case 4:hd.X=qc.Kq.X;hd.Y=0;break;case 3:hd.X=0;hd.Y=qc.Kq.Y;break;case 2:hd.X=qc.Kq.X,hd.Y=qc.Kq.Y}else switch(Sc){case 1:qc=k(qc.Kq,Lc);hd.X=qc.X;hd.Y=qc.Y;break;case 4:var Yd=jd=void 0,te=void 0;(null===(te=qc.rB)||void 0===te?void 0:te[0])<=bd&&(null===(Yd=qc.rB)||void 0===Yd?void 0:Yd[(null===(jd=qc.rB)||void 0===jd?NaN:jd.length)-1])>=bd?(hd.X=qc.Kq.X,hd.Y=0):(Lc=k(qc.Kq,Lc),hd.X=qc.Kq.X,hd.Y=Lc.Y);break;case 3:te=Yd=bd=void 0;(null===(te=qc.GG)||void 0===te?void 0:te[0])<=jd&&(null===
(Yd=qc.GG)||void 0===Yd?void 0:Yd[(null===(bd=qc.GG)||void 0===bd?NaN:bd.length)-1])>=jd?hd.X=0:(Lc=k(qc.Kq,Lc),hd.X=Lc.X);hd.Y=qc.Kq.Y;break;case 2:hd.X=qc.Kq.X,hd.Y=qc.Kq.Y}hd.PaneType=Sc;Sc=hd;hd=this.dwa("DestinationModel",kb.destination,rb);qc=kb.KTg?this.dwa("SourceModel",kb.KTg,rb):null;Lc=kb.OTg?this.dwa("SourceModel",kb.OTg,rb):null;bd=1===oe?kb.LTg?this.dwa("SourceModel",kb.LTg,rb):null:null;if(qc=this.hYh(hd,Lc,qc,bd,cc,oe))Sa.set(qc,hd),pb.set(qc,{Kq:Sc,jj:qc,g9e:kb.destination}),sa.ULS.sendTraceTag(507586701,
0,50,`GridInstantaneousAction.constructNewFreezePaneBlocksForBlockPair command=${rb}, parameter = isNewBlockConstructionSuccessful, value=true, reason = "Construction Successful", blockPosition=${JSON.stringify(Sc)}, paneType=${oe}, `);else return sa.ULS.sendTraceTag(507586700,0,15,`GridInstantaneousAction.constructNewFreezePaneBlocksForBlockPair command=${rb}, parameter = isNewBlockConstructionSuccessful, value=false, reason = "Construction failed", blockPosition=${JSON.stringify(Sc)}, paneType=${oe}, `),
!1}}return!0}Z2k(kb,rb,cc){try{let mc=!0;kb.forEach((Sa,pb)=>{if(mc)if(pb=rb.get(pb)){var Ac=this.za.an(pb.g9e.na,pb.Kq);this.lSk(Sa,Ac);this.za.a7j(pb.Kq,pb.g9e.na)?mc=this.za.H3k(Ac,Sa,pb.Kq,this.hLb,cc):(sa.ULS.sendTraceTag(507570071,0,50,'GridInstantaneousAction.updateBlockCacheWithConstructedBlock command=freezeOrUnfreezeOperation, parameter = primeCacheItem, value=false, reason = "Prime Cache Items failed"'),mc=!1)}else mc=!1});return mc?!0:!1}catch(mc){return sa.ULS.sendTraceTag(507570070,
0,10,`encountered exception in updateBlockCacheWithConstructedBlock : ${mc}`),!1}}H7j(kb,rb,cc,mc){mc=void 0===mc?null:mc;try{if(this.ncb("WebServiceResponseReceivedInProcessFreezePanesGridAction",cc,kb,!1))sa.ULS.sendTraceTag(507586699,0,15,`GridInstantaneousAction.processFreezePanesGridAction command=${kb}, parameter = WebServerResponseReceived , value=false, reason = "Latest server response" `);else{var Sa=Ta.HelperMethods.uh();this.Yrg(cc);var pb=new Map,Ac=new Map;for(const yd of rb)if(yd.destination&&
!this.kYh(yd,kb,mc,cc,pb,Ac)){this.pT();sa.ULS.sendTraceTag(507586698,0,15,`GridInstantaneousAction.processFreezePanesGridAction command=${kb}, parameter = isBlockConstructionForPairSuccessful, value=false, reason = "Construction failed", hashCode = ${yd.destination.Ci} , `);return}pb.size!==Ac.size?sa.ULS.sendTraceTag(507576399,0,15,`GridInstantaneousAction.processFreezePanesGridAction command=${kb}, parameter = processFreezePaneGridOperation, value=false, reason = "Constructed models not matching with constructed panes" `):
this.Z2k(pb,Ac,mc)?(this.Olk(kb,mc),D("ProcessFreezePanesGridAction",Ta.HelperMethods.uh()-Sa,kb)):(this.pGg(cc),sa.ULS.sendTraceTag(507570069,0,15,`GridInstantaneousAction.processFreezePanesGridAction command=${kb}, parameter = updateBlockCacheItem, value=false, reason = "Updating constructing model failed" `))}}catch(yd){this.pGg(cc),this.gBc("GridInstantaneousAction.ProcessFreezePanesGridAction",yd,kb)}}vWh(kb,rb,cc,mc){if(!this.ncb("CommitGridInstantaneousActionResults",cc,rb,kb)){var Sa=Ta.HelperMethods.uh();
if(this.sy&&0!==Object.keys(this.sy).length){if(U(rb))for(var pb=0;pb<cc.length;pb++){var Ac=cc[pb].Ci;Ac&&(Ac=this.sy[Ac])&&gridRenderer.CanvasRendererGlobals.removeExtraModelRowCol(Ac)}if(Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8712164_ACEFix_AbortRowColCSEWhenRowColOffsetsAreOutOfBoundsV2"))for(pb=Object.keys(this.sy),Ac=0;Ac<pb.length;Ac++){var yd=this.sy[pb[Ac]];if(yd){if(30<yd.ColumnOffsets.length){sa.ULS.sendTraceTag(507556629,0,15,`GridInstantaneousAction.commitGridInstantaneousActionResults command=${rb},
              block # of columns = ${yd.ColumnOffsets.length} > MaxAllowedRowColCount`);this.pT();return}if(28<yd.RowOffsets.length){sa.ULS.sendTraceTag(507556628,0,15,`GridInstantaneousAction.commitGridInstantaneousActionResults command=${rb},
              block # of Rows = ${yd.RowOffsets.length} > MaxAllowedRowColCount`);this.pT();return}}}var vb=[];vb.push(...cc);ha&&!this.da.Pg.mz&&(pb=this.za.Zz().filter(bd=>this.$.activeItemName===bd.na.sheetName),this.p5k(kb,pb,vb,rb));this.Yrg(vb);if(U(rb)||F(rb)){pb=this.da.usedRange;for(var Sc of vb)Sc.LG=4,this.hfj&&(Sc.l2a=!0),Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8578927_blockModelRestoringBugFix")?this.sy[Sc.Ci]&&!this.Sal(kb,Sc.jJa(),this.sy[Sc.Ci],Sc.eK().paneType)?this.sy[Sc.Ci]=
null:Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8586105_blockRestoringServerReponseBugFix")&&this.za.iAa(Sc.Ci):this.RGk(Sc,pb,mc,kb,rb)?this.sy[Sc.Ci]=null:Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8586105_blockRestoringServerReponseBugFix")&&this.za.iAa(Sc.Ci)}if(this.wKa&&this.fla)for(var hd in this.fla)Sc=this.fla[hd],(pb=Sc.T6j)&&Sc.MSd&&this.ek.Noc(pb.range,!0);if(this.Dbh(rb,vb)){hd=Ea.a.create().toString();Sc=this.da.mj;pb=this.nF;if(K(rb)||F(rb))var qc=0;else if(U(rb)){qc=kb?Fa(mc.top):
mc.top;Ac=kb?Fa(mc.bottom):mc.bottom;yd=kb?mc.left:Fa(mc.left);var Lc=kb?mc.right:Fa(mc.right);qc=new la.Range(qc,yd,Ac,Lc,!1,!1);qc=kb?Sc.getCellHeight(qc):Sc.getCellWidth(qc)}Sc.E9b(pb,qc,kb);if(Ya.EwaSettings.H0a()&&this.da.Pg.mz){qc=this.hTi(mc,kb);pb=!1;Ac={};for(const bd of cc)bd.LG=4,cc=bd.eK().paneType,yd=this.da.Pg.Sm,Lc=this.da.Pg.Hm,(4===cc&&!kb||3===cc&&(mc.right<=yd||mc.bottom<=Lc))&&0===Object.keys(Ac).length&&(Ac=Y(bd,rb,qc)),0!==Object.keys(Ac).length&&(bd.Fj.PaneViewData=Ac,pb=!0,
ab.b(bd.na,Ac,bd.jk.Revision,void 0,!0));pb&&this.da.Jp.uve(Sc,this.da.Pg,!0,La,ib,this.da.KX())}mc=Object.keys(this.sy);this.za.XQc(mc,hd,kb?"row":"column",!0,rb);this.Txa=!1;pa=bb.a(this.$).Bm.VEa(6,"GridInstantaneousAction.commitGridInstantaneousActionResults",void 0,ra.a.instance.ia(2188));D("CommitGridInstantaneousActionResults",Ta.HelperMethods.uh()-Sa,rb);this.wKa&&this.fla?window.setTimeout(()=>{this.ncb("commitGridInstantaneousActionResults",vb,rb,kb)||(this.xwk(),this.ryg())},Ya.EwaSettings.C2d()):
this.ryg()}else this.tFg(vb),this.pT()}else this.pT(),sa.ULS.sendTraceTag(509657994,0,50,`GridInstantaneousAction.commitGridInstantaneousActionResults command=${rb}, parameter = interimModels, value=false, reason = "InterimModels was null", isRow=${kb}`)}}Olk(kb,rb){const cc=Ta.HelperMethods.uh(),mc=Ea.a.create().toString();ab.b(this.$.na,rb,this.hLb,void 0,!0);this.da.Jp.uve(this.da.mj,this.da.Pg,!0,La,ib,this.da.KX());rb=Object.keys(this.sy);this.za.XQc(rb,mc,"both",!0);this.Txa=!1;pa=bb.a(this.$).Bm.VEa(6,
"GridInstantaneousAction.renderFreezePanesGridInstantaneousActionResults",void 0,ra.a.instance.ia(2188));this.s5f();D("renderFreezePaneGridInstantaneousActionResults",Ta.HelperMethods.uh()-cc,kb)}pGg(kb){kb.forEach(rb=>{rb.LG=0;rb.Fj.PaneViewData=null});this.za.cOa({MHa:!0,NHa:"FreezePaneNewCseBlocksDisposed"});this.tFg(kb);this.pT()}Sal(kb,rb,cc,mc){if(this.aSd&&(null===cc||void 0===cc?void 0:cc.AdjacentBlocksHiddensInfo)!==(null===rb||void 0===rb?void 0:rb.AdjacentBlocksHiddensInfo)||Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8632989_FreezePanesRowColCSEFlickerBugFix")&&
(2===mc||3===mc||4===mc)||Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8595615_CSElogsBugFix")&&!this.SWh(rb,cc,kb))return!0;mc=this.nF[0];var Sa=kb?mc.top:mc.left;const pb=kb?null===rb||void 0===rb?void 0:rb.RowNumbers[(null===rb||void 0===rb?NaN:rb.RowNumbers.length)-1]:null===rb||void 0===rb?void 0:rb.ColumnNumbers[(null===rb||void 0===rb?NaN:rb.ColumnNumbers.length)-1],Ac=this.da.usedRange,yd=kb?rb.RowHeights:rb.ColumnWidths,vb=kb?cc.RowHeights:cc.ColumnWidths;if((kb?mc.bottom:mc.right)<(kb?
null===rb||void 0===rb?void 0:rb.RowNumbers[0]:null===rb||void 0===rb?void 0:rb.ColumnNumbers[0]))return 0<rb.Cells.length||Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8615878_willServerSendReponseInsertBugFix")&&0<cc.Cells.length||!this.def(yd,vb);if(Sa>pb)return!1;Sa=this.gVi(kb,Sa,rb);return this.def(yd,vb)&&(kb&&mc.top>Ac.bottom||!kb&&mc.left>Ac.right||!this.$Uf(rb,Sa,kb)&&!this.$Uf(cc,Sa,kb))?!1:!0}SWh(kb,rb,cc){kb=cc?kb.RowNumbers:kb.ColumnNumbers;rb=cc?rb.RowNumbers:rb.ColumnNumbers;for(cc=
0;cc<Math.min(kb.length,rb.length);cc++)if(kb[cc]!==rb[cc])return!1;return!0}gVi(kb,rb,cc){kb=kb?cc.RowNumbers:cc.ColumnNumbers;for(cc=0;cc<kb.length;cc++)if(kb[cc]===rb)return cc;return!(rb<kb[0])&&rb>kb[kb.length-1]?kb.length-1:0}def(kb,rb){for(let cc=0;cc<Math.min(kb.length,rb.length);cc++)if(kb[cc]!==rb[cc])return!1;return!0}$Uf(kb,rb,cc){if(0===kb.Cells.length)return!1;if(cc)return kb.Cells[kb.Cells.length-1].Row>=rb;for(cc=0;cc<kb.Cells.length;cc++)if(kb.Cells[cc].Col>=rb)return!0;return!1}m$e(kb,
rb){const cc=this.da.mj,mc=rb&&cc.Ymb(kb);kb=!rb&&cc.Ulb(kb);return!mc&&!kb}p5k(kb,rb,cc,mc){for(const Sa of rb){const pb=Sa.Ci,Ac=this.dwa("SourceModel",Sa,mc);if(!this.sy[pb]){const yd=this.qGi(kb,Sa,rb);if(!yd)continue;const vb=this.sy[yd.Ci];if(!vb||!yd)break;this.G4k(kb,Ac,vb);Ya.EwaSettings.hXf()&&(Sa.cpe=!0);this.sy[pb]=Ac;cc.push(Sa)}}}G4k(kb,rb,cc){kb?(rb.RowNumbers=cc.RowNumbers,rb.RowHeights=cc.RowHeights,rb.RowOffsets=cc.RowOffsets,rb.RowOutlinesInformation=cc.RowOutlinesInformation,rb.RowOutlines=
cc.RowOutlines,rb.BlockHeight=cc.BlockHeight):(rb.ColumnNumbers=cc.ColumnNumbers,rb.ColumnWidths=cc.ColumnWidths,rb.ColumnOffsets=cc.ColumnOffsets,rb.ColMetadata=cc.ColMetadata,rb.FixedColumns=cc.FixedColumns,rb.BlockWidth=cc.BlockWidth)}qGi(kb,rb,cc){for(const mc of cc)if(kb){if(rb.eK().topLeft.Y===mc.eK().topLeft.Y&&this.sy[mc.Ci])return mc}else if(rb.eK().topLeft.X===mc.eK().topLeft.X&&this.sy[mc.Ci])return mc;return null}xwk(){const kb=[];for(const cc in this.fla){const mc=this.fla[cc];if(!mc.MSd){var rb=
la.Range.gi(mc.rowNum,mc.colNum);(rb=this.da.kh(rb))&&kb.push({Wea:rb,editText:mc.cellText})}}0<kb.length&&this.ek.hOh(kb)}dwa(kb,rb,cc){let mc=this.sy[rb.Ci];if(!mc){const Sa=Ta.HelperMethods.HM(()=>{mc=rb.gFi()});D(kb,Sa,cc)}return mc}Yrg(kb){for(const rb of kb)kb=rb.Ci,this.V3b[kb]||(this.V3b[kb]=rb.jJa())}tFg(kb){for(const rb of kb){kb=rb.Ci;const cc=this.V3b[kb];if(cc&&!rb.ghe(cc)){sa.ULS.sendTraceTag(509653846,0,15,`GridInstantaneousAction.restoreBlockModels parameter = isModelRestored, value=false, hashCode=${kb}`);
this.pT();break}}}Dbh(kb,rb){for(const cc of rb)if(rb=cc.Ci,this.sy[rb]){if(!cc.ghe(this.sy[rb]))return sa.ULS.sendTraceTag(509657993,0,15,`GridInstantaneousAction.UpdateModelsInBlockCacheSuccessful command=${kb}, parameter = isModelUpdated, value=false, reason = "Response Model not updated", hashCode=${rb}, isRow=false`),!1;lb&&(cc.l2a=!0)}return!0}Mtk(kb,rb,cc,mc){window.setTimeout(()=>{this.Fug(kb,rb,cc,mc)},0)}tqj(kb){for(const rb of kb)if(rb.Fj.Information.Revision>this.hLb)return!0;return!1}ncb(kb,
rb,cc,mc){return this.tqj(rb)?(this.hLb=this.$.ea.gk,this.pT(),sa.ULS.sendTraceTag(509657992,0,50,`GridInstantaneousAction.abortIfServerResponseReceived command=${cc}, parameter = ${kb}, value=true, reason = "Server response received before completing client side estimation", isRow=${mc}}`),!0):!1}pT(){this.sy={};this.Txa=!1;this.V3b={};this.da.nk.Dya(!1);this.wKa&&(this.Psb=0,this.fla={})}gBc(kb,rb,cc){this.pT();sa.ULS.sendTraceTag(509723721,0,10,`${kb} encountered exception ${rb} for command=${cc}`)}kSk(kb,
rb,cc){kb&&(this.sy[cc.destination.Ci]=kb);rb&&(this.sy[cc.source.Ci]=rb)}lSk(kb,rb){this.sy[rb]=kb}RGk(kb,rb,cc,mc,Sa){const pb=mc?kb.jj.top>rb.bottom:kb.jj.left>rb.right;rb=this.sy[kb.Ci];if(!rb)return!1;if(kb=(mc?cc.top>kb.jj.bottom:cc.left>kb.jj.right)||pb){if(0<rb.Cells.length)return!1;if(U(Sa)?mc?28<rb.RowNumbers.length:30<rb.ColumnNumbers.length:mc?28>rb.RowNumbers.length:30>rb.ColumnNumbers.length)return!0}return kb}fxe(kb,rb,cc,mc,Sa,pb){if(!this.ncb("updateReferenceForBlocks",kb,rb,cc))if(kb.length-
1===this.Psb)pb();else{for(var Ac=Ta.HelperMethods.uh();Ta.HelperMethods.uh()-Ac<Ya.EwaSettings.C2d()&&kb.length-1>=this.Psb;){var yd=kb[this.Psb].Ci;this.Psb++;var vb=this.QPi(yd);vb=gridRenderer.CanvasRendererGlobals.getChangedCells(vb,mc);for(const Sc of vb)vb=la.Range.gi(Sc.rowNum,Sc.colNum),vb=this.da.kh(vb),this.fla[Sc.rowNum+"|"+Sc.colNum]=Object.assign({},Sc,{MSd:!0,T6j:vb});yd=gridRenderer.CanvasRendererGlobals.updateReferenceUpdateForModel(this.sy[yd],this.k2b,mc,Sa);for(const Sc of yd)this.fla[Sc.rowNum+
"|"+Sc.colNum]=Object.assign({},Sc,{MSd:!1})}kb.length-1>this.Psb?window.setTimeout(()=>{this.fxe(kb,rb,cc,mc,Sa,pb)},0):pb()}}QPi(kb){return this.za.zn(kb).Fj.GridBlockModel}uPh(kb,rb){if(674605324===rb||-706918724===rb)return!0;kb=Object(db.a)(this.da.$,kb);if(!kb)return!0;kb=kb.usedRange;if(Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8616266_RowColCSETableCheckBugFix")){if((rb=this.da.Pg.mz?this.da.EYa():this.da.IX())&&rb.yi(kb))return!1}else if(this.da.IX().contains(kb))return!1;return!0}ijj(kb){return-73576432===
kb||-806625837===kb||-1564089444===kb||340334732===kb||1844679312===kb||83934709===kb?!0:!1}gjj(kb){switch(kb){case -806625837:case 340334732:case 1844679312:case -1564089444:case -73576432:return this.n0a;case 83934709:return!1;default:return!1}}dUf(kb){return-1113896058===kb||1415868706===kb||1554436520===kb||674605324===kb||1051390410===kb?Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8551204_globalStyle")?this.Gna&&gridRenderer.CanvasRendererGlobals.isGlobalBorderStylesEnabledNew()&&gridRenderer.CanvasRendererGlobals.isGlobalFontsAndCellStylesEnabled():
gridRenderer.CanvasRendererGlobals.isGlobalBorderStylesEnabledNew()&&gridRenderer.CanvasRendererGlobals.isGlobalFontsAndCellStylesEnabled():-706918724===kb}ryg(){ua&&this.s5f()}s5f(){const kb=performance.now()-this.zpg;this.da.nk&&this.$.ea&&this.da.nk.TBj(this.$.ea.gk,kb)}iBg(kb,rb){if(kb.AdjacentBlocksHiddensInfo){var cc={},mc=rb?kb.RowNumbers[0]:kb.ColumnNumbers[0],Sa=rb?kb.RowNumbers[kb.RowNumbers.length-1]:kb.ColumnNumbers[kb.ColumnNumbers.length-1],pb=rb?this.nF[0].top:this.nF[0].left,Ac=rb?
this.nF[0].bottom:this.nF[0].right,yd=!1;rb?(kb.AdjacentBlocksHiddensInfo.IsFirstColOfNextBlockHidden&&(yd=cc.IsFirstColOfNextBlockHidden=!0),kb.AdjacentBlocksHiddensInfo.IsLastColOfPrevBlockHidden&&(yd=cc.IsLastColOfPrevBlockHidden=!0),kb.AdjacentBlocksHiddensInfo.IsFirstRowOfNextBlockHidden&&Sa<Ac&&(yd=cc.IsFirstRowOfNextBlockHidden=!0),kb.AdjacentBlocksHiddensInfo.IsLastRowOfPrevBlockHidden&&mc<pb&&(yd=cc.IsLastRowOfPrevBlockHidden=!0)):(kb.AdjacentBlocksHiddensInfo.IsFirstRowOfNextBlockHidden&&
(yd=cc.IsFirstRowOfNextBlockHidden=!0),kb.AdjacentBlocksHiddensInfo.IsLastRowOfPrevBlockHidden&&(yd=cc.IsLastRowOfPrevBlockHidden=!0),kb.AdjacentBlocksHiddensInfo.IsFirstColOfNextBlockHidden&&Sa<Ac&&(yd=cc.IsFirstColOfNextBlockHidden=!0),kb.AdjacentBlocksHiddensInfo.IsLastColOfPrevBlockHidden&&mc<pb&&(yd=cc.IsLastColOfPrevBlockHidden=!0));kb.AdjacentBlocksHiddensInfo=yd?cc:void 0}}M2k(kb,rb,cc,mc){const Sa=this.hej(mc?kb.RowNumbers:kb.ColumnNumbers,mc?rb.RowNumbers:rb.ColumnNumbers,cc);if(Sa)switch(cc){case Ia.Hide:case Ia.Delete:Sa&&
(mc?(this.ZEa(kb,{IsLastRowOfPrevBlockHidden:!0}),this.ZEa(rb,{IsFirstRowOfNextBlockHidden:!0})):(this.ZEa(kb,{IsLastColOfPrevBlockHidden:!0}),this.ZEa(rb,{IsFirstColOfNextBlockHidden:!0})));break;case Ia.Insert:case Ia.Unhide:Sa&&(mc?(this.ZEa(kb,{IsFirstRowOfNextBlockHidden:!0}),this.ZEa(rb,{IsLastRowOfPrevBlockHidden:!0})):(this.ZEa(kb,{IsFirstColOfNextBlockHidden:!0}),this.ZEa(rb,{IsLastColOfPrevBlockHidden:!0})))}}hej(kb,rb,cc){const mc=kb.length,Sa=rb.length;switch(cc){case Ia.Hide:case Ia.Delete:return kb[0]-
1!==rb[Sa-1];case Ia.Insert:case Ia.Unhide:return kb[mc-1]+1!==rb[0]}return!1}ZEa(kb,rb){kb.AdjacentBlocksHiddensInfo?(rb.IsFirstRowOfNextBlockHidden&&(kb.AdjacentBlocksHiddensInfo.IsFirstRowOfNextBlockHidden=!0),rb.IsLastRowOfPrevBlockHidden&&(kb.AdjacentBlocksHiddensInfo.IsLastRowOfPrevBlockHidden=!0),rb.IsFirstColOfNextBlockHidden&&(kb.AdjacentBlocksHiddensInfo.IsFirstColOfNextBlockHidden=!0),rb.IsLastColOfPrevBlockHidden&&(kb.AdjacentBlocksHiddensInfo.IsLastColOfPrevBlockHidden=!0)):kb.AdjacentBlocksHiddensInfo=
rb}VOi(kb,rb){if(!this.FFc||this.m$e(this.nF[0],rb)||-1113896058===kb||1415868706===kb)return rb?this.nF[0].bottom-this.nF[0].top+1:this.nF[0].right-this.nF[0].left+1;kb=this.da.mj.NJd([this.nF[0]]).filter(mc=>rb?mc.isRow:mc.fk);let cc=0;for(const mc of kb)cc+=rb?mc.bottom-mc.top+1:mc.right-mc.left+1;return(rb?this.nF[0].bottom-this.nF[0].top+1:this.nF[0].right-this.nF[0].left+1)-cc}hTi(kb,rb){return this.FFc?this.P4d:rb?kb.bottom-kb.top+1:kb.right-kb.left+1}};Yb=Object(fa.__decorate)([Object(Ha.d)(oa.bd),
Object(fa.__param)(0,Object(oa.Lb)()),Object(fa.__param)(1,Object(oa.E)()),Object(fa.__param)(2,Object(oa.sc)())],Yb);Object(V.a)(Yb,"GridInstantaneousAction",null,[223]);var Wc=a(479),Qc=a(45),Wb=a(419),Jc=a(212),ma=a(161),Hc=a(40),Kb=a(252),pc=a(262),$b=a(64);class Ib{constructor(kb,rb){this.isRow=!1;this.autoFitRange=null;this.isRow=kb;this.autoFitRange=rb}}Object(V.a)(Ib,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[65]);class Zb{constructor(kb){this.resizeParameters=null;this.resizeParameters=
kb}}Object(V.a)(Zb,"MacroRecorderSheetRowsColumnsResizedPayload",null,[65]);var Eb=a(158),ob=a(421),Na=a(69),nb=a(27);class Hb{constructor(kb){this.CAd=kb}Hff(kb){kb=Ta.HelperMethods.NPc(kb);return Math.max(0,Math.min(Hb.P9f,kb))}tff(kb){return this.q3j(kb)}BVh(kb){return Math.round(this.CAd*kb+2*this.nDf()+1)}q3j(kb){return Math.max(0,Math.min(Hb.s9f,(Math.max(0,Math.min(ka.a.FKc,kb))-2*this.nDf()-1)/this.CAd))}nDf(){return Math.floor(Math.max((this.CAd+3)/4,2))}szc(kb,rb){return rb?kb?Hb.P9f:ka.a.J2d:
kb?Hb.s9f:ka.a.FKc}}Hb.P9f=409;Hb.s9f=255;Object(V.a)(Hb,"ResizeHeadersConverter",null,[]);class na extends ob.a{constructor(kb,rb){super(kb);this.Fma=(cc,mc)=>{cc=this.ZJd(cc,mc);return this.TGd(cc)};this.mpk=(cc,mc)=>{var Sa=this.PVb=mc[na.ahj];1===cc?(cc=mc[na.nOk],Sa=this.jKf(cc,Sa),sa.ULS.shipAssertTag(537153996,0,Sa!==na.qna,`ResizeHeadersDialogHandler - invalid size input, size = ${cc}`),cc=Sa!==this.UQd,sa.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",
this.isRow,this.PVb,Sa,cc),cc&&this.q0h(Sa)):sa.ULS.sendTraceTag(537153994,0,50,`ResizeHeadersDialog Cancel button pressed, isRow = ${this.isRow}.`)};this.isRow=2040891415===rb.command;this.da=ba.f(this.$);this.PTc=new Hb(this.$.workbookContext.DxDigitNormal);this.UQd=this.FOh();kb=this.VZh(this.UQd);rb=this.XZh(this.UQd);this.dialogTitle=ra.a.instance.ia(this.isRow?478:479);kb=this.iR(kb,rb);this.initializeAndShow(this.dialogTitle,this.mpk,kb);sa.ULS.sendTraceTag(537153997,0,50,`ResizeHeaders React Dialog opened, isRow = ${this.isRow}.`)}get ki(){return"ResizeHeadersDialog"}get PVb(){return na.zMe}set PVb(kb){na.zMe=
kb}iR(kb,rb){return{[na.sR]:this.ki,[na.$nj]:this.isRow,[na.Z9i]:kb,[na.Y9i]:rb,[na.mkj]:this.PVb,[na.YJd]:this.Fma}}FOh(){const kb=this.JBi();try{return this.GGi(kb)}finally{kb&&kb.dispose()}}q0h(kb){const rb={};rb.SheetMultiRange=Qc.s(this.da.ha.qa.selectedRanges,this.$);na.Ume(rb,this.isRow,kb);this.$.ei(this.isRow?745189930:-445963340,Na.a.eh,8,{["resizeRowColumnParameters"]:rb})}jKf(kb,rb){return nb.a.Hga(kb)?rb?this.UZh(kb):this.WZh(kb):na.qna}WZh(kb){return Math.floor(parseFloat(kb))}UZh(kb){kb=
parseFloat(kb);return 0>kb?na.qna:kb?this.isRow?Ta.HelperMethods.B3j(kb):this.PTc.BVh(kb):0}XZh(kb){return kb===na.qna?"":this.isRow?this.PTc.Hff(kb).toString():this.PTc.tff(kb).toFixed(2)}VZh(kb){return kb===na.qna?"":kb.toString()}GGi(kb){if(!kb||!kb.$$mn()||!kb.mu)return na.qna;var rb=Object(Eb.a)(27,kb.mu);if(!rb)return na.qna;for(rb=this.isRow?rb.i_a:rb.SQd;kb.$$mn();){const cc=Object(Eb.a)(27,kb.mu);if(cc&&(this.isRow?cc.i_a:cc.SQd)!==rb)return na.qna}return rb}JBi(){const kb=[];for(const cc of this.da.ha.qa.selectedRanges){const mc=
cc.clone();var rb=this.da.Zk(this.da.Pg.ro(mc));rb=mc.pk(rb.Hp);if(!rb)return null;this.isRow?mc.right=mc.left=rb.left:mc.top=mc.bottom=rb.top;kb.push(mc)}return kb.length?this.da.Lea("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",kb):null}ZJd(kb,rb){if(!nb.a.Hga(kb))return 1;kb=this.jKf(kb,rb);return 0!==kb||this.da.mj.Y9e(this.da.ha.qa.selectedRanges,this.isRow)?this.Rqj(kb)?0:2:3}TGd(kb){let rb="";switch(kb){case 0:rb="";break;case 1:rb=ra.a.instance.ia(767);break;case 2:rb=String.format(ra.a.instance.$g(99),
0,this.szc(this.PVb));break;case 3:rb=ra.a.instance.ia(768)}return rb}Rqj(kb){return 0<=kb&&kb<=this.szc(!1)}szc(kb){return this.PTc.szc(kb,this.isRow)}static Ume(kb,rb,cc){if(rb){kb.ColumnWidth=na.qna;kb.RowHeight=cc;for(const mc of kb.SheetMultiRange.Ranges)mc.FirstColumn=0,mc.LastColumn=0}else{kb.RowHeight=na.qna;kb.ColumnWidth=cc;for(const mc of kb.SheetMultiRange.Ranges)mc.FirstRow=0,mc.LastRow=0}}}na.sR="id";na.$nj="isRow";na.Z9i="initialSizeInPx";na.Y9i="initialSizeInDefaultUnits";na.mkj="isInitialUnitsDefaultUnits";
na.YJd="getInputErrorIfInvalid";na.nOk="size";na.ahj="isDefaultUnits";na.qna=-1;na.zMe=!0;Object(V.a)(na,"ResizeHeadersDialog",ob.a,[]);var Gb=a(62);const Xa=(kb,rb,cc,mc,Sa,pb,Ac)=>{Ac=kb.Za(41,void 0===Ac?null:Ac);Ac.resizeRowColumnParameters=rb;return Gb.h(kb,"ResizeRowsColumns",Ac,cc,mc,Sa,pb,0)};var Jb=a(79),qb=a(322),Db=a(152),gb=a(35),ya=a(356),Aa=a(103);let sb=class{constructor(kb,rb,cc,mc){this.FVj=(Sa,pb)=>{if(!Kb.a(Sa)&&pb){const Ac=!!Sa&&!!Sa.RequestTelemetryData;ba.f(this.$).nk.V0(pb,
Sa.StateId,Ac?Sa.RequestTelemetryData.EcsOperationDuration:0,Ac?Sa.RequestTelemetryData.EcsRequestDuration:0,Ac?Sa.RequestTelemetryData.WfeRequestDuration:0)}};this.hMj=(Sa,pb)=>{oa.jg.Ha()?void Ha.a.resolve(oa.jg,{va:1}).then(Ac=>{Ac.PZg(pb)}):Hc.TaskExtensions.Ua(Jb.GetServiceTaskFactory.Bj(this.$.ka,534,535,1),Ac=>{Ac.result.PZg(pb)},this.$.xa,3)};this.$=kb;this.ek=rb;this.gridInstantaneousAction=cc;this.grid=ba.f(this.$);this.aRb=mc}Bi(kb,rb){kb=!0;switch(rb){case -445963340:case 1391094586:kb=
this.Hj(8);break;case 745189930:case 146338636:kb=this.Hj(16)}return!kb}executeCommand(kb,rb,cc){var mc=ba.f(this.$),Sa=rb.command;kb=Ea.a.create().toString();var pb=Hc.TaskExtensions.sq();switch(Sa){case 1391094586:case 146338636:pb=1391094586===Sa;(kb=cc.autoFitRanges)&&kb.Ranges&&kb.Ranges.length||(kb=Qc.s(mc.ha.qa.selectedRanges,this.$));pb=this.adi(pb?1:0,kb,rb);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:pb=-445963340===Sa||-706918724===
Sa||369708605===Sa;var Ac=Ya.EwaSettings.qmb()||Ya.EwaSettings.r0a(),yd=Ya.EwaSettings.HFc();(Ac&&-706918724===Sa||yd&&1051390410===Sa)&&mc.nk.KP(18,kb,Wc.a(Sa));if(-445963340===Sa||745189930===Sa){var vb=Wc.a(rb.command);mc.nk.KP(16,kb,vb);var Sc=cc.resizeRowColumnParameters}else{cc=Ya.EwaSettings.w0f()&&(369708605===Sa||1542466017===Sa)&&cc.rangeToUnhide?[cc.rangeToUnhide]:mc.ha.qa.selectedRanges;mc=0;Ac=!1;yd="";let Lc=!1;const bd=Ya.EwaSettings.uUb();bd&&(yd=Wc.a(rb.command),Ac=1<cc.length?!0:
!1);for(var hd of cc){if(bd&&this.aRb){var qc=this.grid.za.DX(hd);this.aRb.Ald(qc,yd)}if(-706918724===Sa||369708605===Sa)qc=hd.right-hd.left+1,mc+=0<qc?qc:-1*qc;else if(1542466017===Sa||1051390410===Sa)Lc=!0,mc+=hd.bottom-hd.top+1}bd&&this.aRb&&(this.aRb.C_e(mc,yd),this.aRb.BZe(yd,Lc,mc,cc[0],rb.command));if(369708605===Sa||1542466017===Sa){if(sa.ULS.sendTraceTag(520938758,0,50,`ResizeCommandHandler.doResize: Unhide Rows/Columns NumberOfRanges=${mc}, isDiscontinuous=${Ac}`),Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8373854_LogUnhideButtonClickOnNoHiddenRangePresent")){mc=
hd=!1;Ac=this.grid.mj;for(Sc of cc)if(hd=Sc.isRow&&Ac.Ymb(Sc),mc=Sc.fk&&Ac.Ulb(Sc),hd||mc)break;hd||mc||sa.ULS.sendTraceTag(508061769,0,50,"ResizeCommandHandler.doResize: unhide Rows/Columns clicked when no hidden range in selected range")}}else-706918724!==Sa&&1051390410!==Sa||sa.ULS.sendTraceTag(520938757,0,50,`ResizeCommandHandler.doResize: hide Rows/Columns NumberOfRanges=${mc}, isDiscontinuous=${Ac}`);Sa=369708605===Sa||1542466017===Sa?-2:0;Sc={};Sc.SheetMultiRange=Qc.s(cc,this.$);if(pb)for(vb of Sc.SheetMultiRange.Ranges)vb.FirstRow=
0,vb.LastRow=0;else for(const jd of Sc.SheetMultiRange.Ranges)jd.FirstColumn=0,jd.LastColumn=0;Sc.RowHeight=pb?-1:Sa;Sc.ColumnWidth=pb?Sa:-1}pb=this.tdi(Sc,rb,kb,pb);break;case 957527587:case 2040891415:Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8202953_HomeTabCleanUpTelemetry")&&"Home"===rb.tabName&&Aa.b("HomeTabFormat"),new na(this.$,rb)}return pb}ni(kb,rb,cc,mc){if(kb=!!cc&&!!mc&&1===mc.ZN)switch(rb.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;
default:kb=!1}return kb}Ji(){return!1}Nxj(kb){sa.ULS.sendTraceTag(537154004,0,50,`ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: ${Object(qb.c)(kb)}. Reason: ${Object(qb.c)(kb)?void 0:kb.reason}.`)}Hj(kb){return(new ma.a(this.$.sa)).Hj(kb)}adi(kb,rb,cc){const mc=this.$.pa.ta.Jh(),Sa=0===kb,pb=()=>new Ib(Sa,rb);return Wb.a(this.$.userOperationManager,(Ac,yd,vb)=>{var Sc=this.$.pa.ta;Ac=pc.c(Ac,this.hMj);var hd={Xfj:!Sa,cqd:rb};const qc=Sc.Za(41,mc);qc.isRow=Sa;qc.autoFitRanges=
rb;return Gb.h(Sc,"AutoFit",qc,Ac,yd,vb,hd,0)},Ac=>new Jc.a(135,0,Ac,void 0,pb),cc)}tdi(kb,rb,cc,mc){const Sa=rb.command,pb=ba.f(this.$),Ac=Qc.h(kb.SheetMultiRange.Ranges);if(Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:7428186_HideLastRowCol")){var yd=-706918724===Sa||-445963340===Sa&&0===kb.ColumnWidth,vb=pb.mj;if((1051390410===Sa||745189930===Sa&&0===kb.RowHeight||yd)&&!vb.Y9e(Ac,!mc))return this.fci(mc),Hc.TaskExtensions.sq()}let Sc;yd=(Ya.EwaSettings.qmb()||Ya.EwaSettings.r0a())&&-706918724===
Sa;vb=Ya.EwaSettings.HFc()&&1051390410===Sa;let hd=void 0;if(745189930===Sa||-445963340===Sa||yd||vb)sa.ULS.shipAssertTag(537154002,0,this.$.activeItemName===kb.SheetMultiRange.SheetName,"ResizeCommandHandler.DoResize: should do CSE for active sheet only!"),yd||vb?(this.gridInstantaneousAction.Yde(),hd=()=>{pb.nk.Dya();this.gridInstantaneousAction.Kpd(Sa,!mc)},Ya.EwaSettings.lGc()||Object(Db.e)(()=>{hd()},this.$.xa,0)):(Sc=this.ek.jqe(pb,Ac,mc?kb.ColumnWidth:kb.RowHeight,!mc),this.Nxj(Sc),Object(qb.c)(Sc)&&
pb.nk.JS(cc,$b.BasicTelemetryCalculator.uR));const qc=this.$.pa.ta.Jh({Cya:!0,ixa:3});yd=(bd,jd,Yd)=>{this.$.AD();Qc.j(Ac,",",this.$,!1);return Xa(this.$.pa.ta,kb,pc.c(bd,this.FVj),jd,Ya.EwaSettings.lGc()?pc.a(Yd,()=>{window.setTimeout(()=>{hd&&hd()},0)}):Yd,cc,qc)};const Lc=()=>new Zb(kb);return Sc&&Object(qb.c)(Sc)?Wb.a(this.$.userOperationManager,yd,bd=>new Jc.a(136,0,bd,64,Lc),rb):Wb.a(this.$.userOperationManager,yd,bd=>new Jc.a(136,0,bd,void 0,Lc),rb)}fci(kb){kb=gb.a.Yi(1,0,kb?769:771,kb?770:
772,0,kb?-2037763134:503471870,kb?"HideAllColumnsError":"HideAllRowsError");new ya.a(this.$,kb)}};sb=Object(fa.__decorate)([Object(Ha.d)(oa.hf),Object(fa.__param)(0,Object(oa.Lb)()),Object(fa.__param)(1,Object(oa.sc)()),Object(fa.__param)(2,Object(oa.bd)()),Object(fa.__param)(3,Object(oa.Uc)())],sb);Object(V.a)(sb,"ResizeCommandHandler",null,[39]);var nc=a(586),Bb=a(9),uc=a(420),Pc=a(19),wd=a(76),Md=a(71),Nd=a(7),ec=a(68);class gc{}gc.Rli="ewa-resizehdr-row-hidden";gc.Qli="ewa-resizehdr-col-hidden";
Object(V.a)(gc,"CssClassNames",null,[]);var Mb=a(302),sc=a(17),xd=a(193),xb=a(756),Lb=a(34),Rc=a(286),nd=a(6),$d=a(242),Td=a(150),He=a(59),oc=a(16),ld=a(74),id=a(105),fc=a(323),vc=a(151),Tc=a(423),Bd=a(115);class Fd{constructor(kb,rb,cc,mc,Sa,pb,Ac){this.KJa=kb;this.IYb=rb;this.dMa=cc;this.WOd=mc;this.Ltb=Sa;this.t0f=pb;this.L3i=Ac}}Object(V.a)(Fd,"HeaderEventCachedInfo",null,[]);var le=a(156);class dc extends id.a{constructor(kb,rb){super(rb.domElement);this.S8=this.hFg=!1;this.wn=this.Znb=this.$Oa=
null;this.jie=!0;this.bHc=!1;this.x4b=this.es=this.offset=0;this.OX=this.z1=this.ica=null;this.V4i="headerResizeTooltip";this.aW=this.I0d=null;this.fqd=this.dda=this.MNa=!1;this.Vpg=this.arb=ka.a.fKa;this.B$b=!1;this.wVb=Ya.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ResizeHeaderUXModernization",!1);this.JZf=Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8511759_RemoveResizeTooltip");this.A_a=Ya.EwaSettings.A_a();this.KKa=Ya.EwaSettings.KKa();this.sWd=!1;this.Goe=!0;this.XI=cc=>{if(this.grid.gp)return!1;
cc=Bd.a().Ik(cc);if(3===cc.oh&&!this.u0f(cc.La)||!this.ctg(cc,!1))return!1;sa.ULS.sendTraceTag(537154058,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");const mc=this.WXc();this.bHd(cc.clientPoint,mc,!0);this.MNa||(Mb.a.instance.ya(sc.a.$u,this.domElement.ownerDocument.body,this.jqb),xd.a.instance.ya(sc.a.kn,this.domElement.ownerDocument.body,this.jqb),this.MNa=!0);this.S8&&this.CQf(cc);return!1};this.YZb=cc=>{cc=Bd.a().Ik(cc);this.fqd&&this.CQf(cc);if(!cc.La.type.includes("touch")&&
cc.La.button!==Sys.UI.MouseButton.leftButton||!this.T0a)return!1;ld.g(cc.La);this.Ppf();cc=this.grid.gp?this.arb:ka.a.fKa;if(this.grid.gp&&this.wn){var mc=cc!==this.es;!mc&&this.B$b&&(this.Lj.removeRowColFromModel(this.wn.aFb,this.wn.a5a),this.Lj.Tia(this.grid.ha.qa.selectedRanges),this.Lj.fr("HeaderResizeBehavior::onDocumentMouseUp"))}else this.wn&&(cc=this.dda?this.MId():this.wn.Nfa()),mc=cc!==this.es;if(this.$Oa&&mc&&cc!==ka.a.fKa){cc=this.grid;var Sa=this.ALd(cc);mc={};mc.SheetMultiRange=Qc.s(Sa,
cc.$);dc.Ume(mc,this.isRow,this.es);if(this.grid.gp){Sa=this.wn?this.wn.aFb:-1;const pb=mc.SheetMultiRange.Ranges[0],Ac=dc.Mna()&&0===this.es?20:50;sa.ULS.sendTraceTag(509694147,2,Ac,`HeaderResizeBehavior.OnDocumentMouseUp: cellAbsoluteIndex=${Sa}, isResizingHiddenHeader=${this.dda}, headerViewBlockHashCode=${this.Lj.hashCode},
          rangeFirstRow=${pb.FirstRow}, rangeFirstColumn=${pb.FirstColumn}, rangeLastRow=${pb.LastRow}, rangeLastColumn=${pb.LastColumn},`)}this.whi(mc);cc.WTk=!0}else this.Am(null,null),this.O2b();this.B$b=this.dda=!1;this.A_a&&this.Poc("onDocumentMouseUp");return!1};this.w6=cc=>{if(this.grid.gp)return!1;cc=xb.a.create(cc.eventName,cc.Qh,cc.La,cc.oh);cc=Bd.a().Ik(cc);if(!this.ctg(cc,!0))return!1;cc=this.grid;var mc=this.ALd(cc);mc=Qc.s(mc,cc.$);this.wVb?cc.rh.zq([this.isRow?51:52]):cc.rh.zq([this.isRow?
13:14]);cc.rh.xia();this.O2b();cc.$.ei(this.isRow?146338636:1391094586,Na.a.eh,30,{["autoFitRanges"]:mc});return!1};this.nig=cc=>{this.S8?(this.dda&&!this.B$b&&(this.Buh(),this.Lj.fr("HeaderResizeBehavior::onHeaderResizeChanged")),this.bHc||this.VRf(),cc=new Sys.UI.DomEvent(cc),cc=xb.a.create(sc.a.$Ua,this.domElement,cc,2),cc=Bd.a().Ik(cc),this.t7d(cc.clientPoint),this.Goe&&(this.Goe=!1,this.Lj.dPg()&&(this.Lj.PEh(),this.cXf=!0))):sa.ULS.sendTraceTag(521480320,2,50,`HeaderResizeBehavior.onHeaderResizeChanged: Reached during no resize mode. cellAbsoluteIndex = ${this.wn?
this.wn.aFb:-1}, isRow = ${this.isRow}`)};this.oig=cc=>{cc=new Sys.UI.DomEvent(cc);cc=xb.a.create(sc.a.$Ua,this.domElement,cc,2);this.YZb(cc)};this.JRj=cc=>{var mc;if(dc.Mna()&&!this.wn){cc=!!this.Lj;const Sa=null===(mc=this.Lj)||void 0===mc?void 0:mc.hashCode;sa.ULS.sendTraceTag(508368662,2,15,`HeaderResizeBehavior.onHeaderResizeTouchStart: cellBeingResized is not set and we don't know which cell needs to be resized. this.isRow=${this.isRow}, isViewBlockSet=${cc}, this.viewBlock.hashCode=${Sa}`)}else this.mMa(cc,
this.wn,!1)};this.jqb=cc=>{cc=Bd.a().Ik(cc);ld.g(cc.La);return this.t7d(cc.clientPoint)};this.eS=cc=>{if(this.grid.gp)return!1;cc=Bd.a().Ik(cc);let mc;if(!this.grid.isResizeAllowed(this.isRow)||-1!==this.grid.ha.selectionType)return bb.a(this.grid.$).Ex()&&(mc=this.LJd(cc))&&(mc.KJa.style.cursor=""),!1;if(this.S8)return this.VRf(),!1;mc=this.LJd(cc);if(!mc)return!1;mc.KJa.style.cursor=!this.grid.isEditing&&this.rYd(mc)?this.isRow?"row-resize":"col-resize":"";ld.g(cc.La);return!0};this.iB=()=>{this.O2b()};
this.Am=()=>{if((3===Na.a.eh||Lb.a.Gx)&&this.grid.ha.qa.Gn){var cc=this.grid.ha.qa.Ui;if(!(!cc.isRow&&!cc.fk||!this.domElement||cc.isRow&&this.isRow&&!this.Lj.iD.includes(cc.top)||cc.fk&&!this.isRow&&!this.Lj.iD.includes(cc.left))){var mc=this.grid.ml(cc,this.Lj.vq.paneType);if(mc){if(this.grid.gp){const Sa=this.isRow?cc.bottom:cc.right;this.wn=this.Lj.WA(la.Range.gi(cc.bottom,cc.right));if(!this.wn){sa.ULS.sendTraceTag(522826880,2,dc.Mna?15:50,`HeaderResizeBehavior.onSelectionEnded: Cell being resized is undefined. Couldn't create touch resizer. Absolute index ${Sa}, is row ${this.isRow}`);
return}}this.aW||this.N6h();cc.isRow&&this.isRow?(this.GWc(!0,"onSelectionEnded"),this.aW.style.top=mc.bottomRight.y-this.aW.offsetHeight/2+"px"):cc.isRow||this.isRow||(this.GWc(!0,"onSelectionEnded"),fc.c(this.aW.style,this.grid.rtl,mc.bottomRight.x-this.aW.offsetWidth/2+"px"))}}}};this.FY=(cc,mc)=>{Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:6385697_HeaderResize_LogOnPartialInteractivityStatusChanged")&&sa.ULS.sendTraceTag(521787422,2,50,`HeaderResizeBehavior.onPartialInteractivityStatusChanged: was called. isActivated ${mc.tT}`);
mc.tT&&this.KIb()};this.Lj=rb;this.isRow=rb.isRow;this.rtl=rb.vq.rtl;this.grid=kb;this.u9f=this.isRow?ka.a.J2d:ka.a.FKc;this.Q4i=ra.a.instance.ia(436);this.Z4i=ra.a.instance.ia(435);this.T4i=ra.a.instance.ia(437);vc.a(this.grid.$,cc=>{this.I0d=cc.A_(Td.a.upk,!1)});this.hek();this.grid.ha.VW(this.Am);this.grid.ha.xta(this.iB);this.grid.Mz(this.Am);bb.a(this.grid.$).Bm.wta(this.FY)}get T0a(){return this.S8}get B5a(){var kb,rb;return null!==(rb=null===(kb=this.wn)||void 0===kb?void 0:kb.a5a)&&void 0!==
rb?rb:-1}get wpk(){this.pii();return dc.Mtb}GRj(kb){Ya.EwaSettings.uVb()&&!this.T0a&&this.Oqj(kb.a5a)&&this.Lj.HWc(kb.a5a,!1)}KRj(kb,rb){Ya.EwaSettings.uVb()&&!this.T0a&&this.Lj.HWc(kb.a5a,rb)}mMa(kb,rb,cc){var mc=new Sys.UI.DomEvent(kb);mc=xb.a.create(sc.a.$Ua,this.domElement,mc,2);mc=Bd.a().Ik(mc);this.btg(rb,mc.clientPoint.x,mc.clientPoint.y,!1,cc,kb);kb=this.WXc();this.bHd(this.$Oa,kb,!0);this.MNa||(kb=this.domElement.ownerDocument.body,kb.addEventListener("pointermove",this.nig),kb.addEventListener("pointerup",
this.oig),this.MNa=!0)}FRj(kb,rb,cc){this.btg(rb,kb.clientX,kb.clientY,!0,cc,kb);kb=this.grid;rb=this.ALd(kb);rb=Qc.s(rb,kb.$);this.wVb?kb.rh.zq([this.isRow?51:52]):kb.rh.zq([this.isRow?13:14]);kb.rh.xia();this.O2b();kb.$.ei(this.isRow?146338636:1391094586,Na.a.eh,30,{["autoFitRanges"]:rb})}dispose(){this.Poc("dispose");this.grid.ha&&(this.grid.ha.UY(this.Am),this.grid.ha.Fpa(this.iB));this.grid.xE(this.Am);bb.a(this.grid.$)&&bb.a(this.grid.$).Bm.$za(this.FY);Rc.a.instance.Na(sc.a.sr,this.domElement,
this.w6);Mb.a.instance.Na(sc.a.jo,this.domElement.ownerDocument.body,this.YZb);xd.a.instance.Na(sc.a.Ok,this.domElement.ownerDocument.body,this.YZb);Lb.a.Gx||(Mb.a.instance.Na(sc.a.Zi,this.domElement,this.XI),Mb.a.instance.Na(sc.a.$u,this.domElement,this.eS));this.MNa&&(Mb.a.instance.Na(sc.a.$u,this.domElement.ownerDocument.body,this.jqb),xd.a.instance.Na(sc.a.kn,this.domElement.ownerDocument.body,this.jqb),this.MNa=!1);this.aW&&(Mb.a.instance.Na(sc.a.Zi,this.aW,this.XI),Rc.a.instance.Na(sc.a.sr,
this.aW,this.w6),dc.Mna()?this.hBg("dispose"):(this.Poc(""),this.aW=null));this.hFg&&(oc.DOMElementExtensions.Km(dc.Mtb),dc.Mtb=null);this.Lj=null;super.dispose()}hek(){Rc.a.instance.ya(sc.a.sr,this.domElement,this.w6);Mb.a.instance.ya(sc.a.jo,this.domElement.ownerDocument.body,this.YZb);xd.a.instance.ya(sc.a.Ok,this.domElement.ownerDocument.body,this.YZb);Lb.a.Gx||(Mb.a.instance.ya(sc.a.Zi,this.domElement,this.XI),Mb.a.instance.ya(sc.a.$u,this.domElement,this.eS))}pii(){if(!dc.Mtb){document.getElementById(dc.gFg);
this.hFg=!0;var kb=dc.Mtb=document.createElement("div");this.grid.$.frame.Bma().appendChild(kb);kb.id=dc.gFg;kb.className=ec.eb;oc.DOMElementExtensions.setVisible(kb,!1)}}Oqj(kb){return-1<=kb?!0:!1}Ppf(){if(this.MNa){const kb=this.domElement.ownerDocument.body;this.grid.gp?(kb.removeEventListener("pointermove",this.nig),kb.removeEventListener("pointerup",this.oig)):(Mb.a.instance.Na(sc.a.$u,kb,this.jqb),xd.a.instance.Na(sc.a.kn,kb,this.jqb));this.MNa=!1}this.S8=!1;Ya.EwaSettings.uVb()&&this.Lj.HWc(this.wn.a5a,
!1);this.Ehk();Tc.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation")}Gqk(){this.wVb?this.sWd?(this.sWd=!1,this.grid.rh.zq(this.isRow?[49,51]:[50,52])):this.grid.rh.zq(this.isRow?[51]:[52]):this.grid.rh.zq([this.isRow?13:14]);this.grid.rh.xia()}Buh(){this.Lj.addRowColToModel(this.wn.aFb-1,this.wn.a5a);this.B$b=!0}t7d(kb){if(!this.S8)return!1;const rb=this.isRow;if(!this.grid.gp&&!this.ica){this.ica=document.createElement("div");this.ica.style.cssText="position: relative; width: inherit; height: inherit;"+
(rb?"top: 0px; ":this.rtl?"right: 0px:":"left: 0px:");for(var cc=this.wn.HO();cc.nextSibling;)this.ica.appendChild(cc.nextSibling);cc.parentNode.appendChild(this.ica)}cc=rb?kb.y-this.Znb.y:(this.rtl?-1:1)*(kb.x-this.Znb.x);const mc=rb?kb.y-this.$Oa.y:(this.rtl?-1:1)*(kb.x-this.$Oa.x),Sa=this.grid.gp?this.arb:this.wn.Nfa();if(Sa===ka.a.fKa)return!1;cc&&(0<this.es||0<Sa+mc)&&Sa+mc<=this.u9f&&(this.es=this.WXc(mc),this.bHd(kb,this.es,!1),this.grid.gp?this.es>=dc.vOf?(this.jie=!0,this.wn.setCellExtent(this.es)):
this.jie&&(this.jie=!1,this.wn.setCellExtent(dc.vOf)):(oc.DOMElementExtensions.TBa(this.wn.HO(),!rb,Math.max(this.x4b+mc,0)),this.ica.style[rb?"top":this.rtl?"right":"left"]=Math.max(mc,-this.x4b)+"px"),cc=(this.grid.gp?this.Vpg:rb?this.wn.Lj.JL:this.wn.Lj.KL)+Math.max(mc,this.grid.gp?-this.arb+dc.TAc:-this.x4b),oc.DOMElementExtensions.TBa(this.wn.Lj.domElement,!rb,cc),this.grid.gp&&this.wn.Lj.tyk(cc),this.Znb=new Sys.UI.Point(kb.x,kb.y),this.GWc(!1,"onHeaderResizeChangedInternal"));return!0}GWc(kb,
rb){var cc;oc.DOMElementExtensions.setVisible(this.aW,kb);dc.Mna()&&sa.ULS.sendTraceTag(508150752,2,50,`HeaderResizeBehavior.setTouchResizerVisible: called with visible: ${kb}. caller:${rb} isRow: ${this.isRow}, blockHash: ${null===(cc=this.Lj)||void 0===cc?void 0:cc.hashCode}`)}Nfa(){return this.wn?this.dda?dc.h5i:this.wn.Nfa():ka.a.fKa}bHd(kb,rb,cc){this.JZf||(this.OX&&cc&&(sa.ULS.sendTraceTag(537154051,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),
this.$Ag()),this.OX||cc||sa.ULS.sendTraceTag(537154050,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead"),this.I0d&&this.I0d(()=>({["Location"]:"canvas"})),this.OX?this.qAf(rb):(this.OX=document.createElement("div"),this.OX.id=this.V4i,this.qAf(rb),this.OX.className=ec.K,rb=document.getElementById(this.grid.$.$h+Nd.a.rag),rb.insertBefore(this.OX,rb.firstChild),kb=Bd.a().Rfa(kb),this.OX.style.left=(this.rtl?Math.max(kb.x-this.OX.offsetWidth,
0):kb.x-Math.max(kb.x+this.OX.offsetWidth-rb.offsetWidth,0)).toString()+"px",rb=document.getElementById(Nd.a.yFa),this.OX.style.top=(kb.y-(nd.AFrameworkApplication.ra&&nd.AFrameworkApplication.ra.$d.Fk?0:rb.offsetHeight)-this.OX.offsetHeight).toString()+"px"))}$Ag(){this.JZf||(oc.DOMElementExtensions.Km(this.OX),this.OX=null)}qAf(kb){var rb=new Hb(this.grid.$.workbookContext.DxDigitNormal);rb=this.isRow?rb.Hff(kb).toFixed(2):rb.tff(kb).toFixed(2);this.OX.innerText=`${this.isRow?this.Q4i:this.Z4i} ${rb} (${kb.toString()} ${this.T4i})`}ctg(kb,
rb){let cc;const mc=this.grid.isResizeAllowed(this.isRow);if(-1!==this.grid.ha.selectionType||2===kb.oh&&kb.La.button!==Sys.UI.MouseButton.leftButton||!this.rYd(cc=this.LJd(kb))||!mc)return!1;ld.g(kb.La);this.$Oa=this.Znb=new Sys.UI.Point(kb.clientPoint.x,kb.clientPoint.y);this.NNh(cc,rb);if(!this.wn)return!1;this.S8=!0;this.Knj(this.wn,cc)&&this.x9i();this.x4b=this.MId();return this.dtg(kb.La.rawEvent,rb)}btg(kb,rb,cc,mc,Sa,pb){this.S8=!0;this.dda=Sa;this.wn=kb;this.E6f("prepareResizeOperation");
this.bHc=!1;this.$Oa=this.Znb=new Sys.UI.Point(rb,cc);kb=this.wn.getRange();this.z1=Sa?this.j2e(kb):kb;this.arb=this.Nfa();this.Vpg=this.isRow?this.wn.Lj.JL:this.wn.Lj.KL;this.dtg(pb,mc)}dtg(kb,rb){const cc=this.grid.gp?{["IsResizingHiddenHeader"]:this.dda,["IsAutoFitting"]:rb,["NumberOfSelectedRanges"]:this.grid.ha.qa.aS,["Location"]:"canvas",["ResizeRange"]:this.z1,["ResizedCellAbsoluteIndex"]:this.wn.aFb,["HeaderViewBlockHashCode"]:this.Lj.hashCode}:{["IsResizingHiddenHeader"]:this.dda,["IsAutoFitting"]:rb,
["NumberOfSelectedRanges"]:this.grid.ha.qa.aS,["Location"]:"canvas"};vc.b(this.grid.$).lj(Td.a.lpk,cc);this.grid.VJk&&(rb=rb?"header_resize_autofit":"header_resize_start",le.b(this.grid.$).ix(kb,rb,void 0));this.offset=this.wn.Oma();this.es=this.grid.gp?this.arb:this.wn.Nfa();if(this.es===ka.a.fKa)return!1;Tc.c(this.grid.$,!1,"HeaderResizeBehavior:prepareResizeOperationInternal");return!0}Knj(kb,rb){var cc=this.wn.HO();if(!cc)return sa.ULS.shipAssertTag(537154049,2,!1,"cell being resized element received is null"),
!1;cc=cc.nextSibling;if(!cc)return!1;kb=kb.getRange();cc=this.Lj.EIa(cc).getRange();if(!kb||!cc)return sa.ULS.shipAssertTag(537154048,2,!1,"IsResizingHidden: range is null"),!1;kb=this.isRow?kb.bottom:kb.right;cc=this.isRow?cc.bottom:cc.right;return kb+1!==cc&&kb!==cc&&this.rYd(rb,!0)}x9i(){var kb=this.wn.HO();const rb=this.Lj.EIa(kb.nextSibling);dc.Lnj(rb,this.isRow)?(this.wn=rb,this.z1=this.wn.getRange()):(this.Cuh(kb),this.wn=rb,kb=this.wn.getRange(),this.z1=this.j2e(kb),this.dda=!0)}j2e(kb){return this.isRow?
new la.Range(kb.top-1,kb.left,kb.top-1,kb.right,!1,!0):new la.Range(kb.top,kb.left-1,kb.bottom,kb.left-1,!1,!0)}Cuh(kb){const rb=this.Lj.EIa(kb.nextSibling),cc=dc.P2h(rb,this.isRow,this.rtl);cc&&kb.parentNode.insertBefore(cc,rb.HO())}ALd(kb){const rb=this.z1,cc=kb.ha.qa.selectedRanges;if(kb.ha.qa.uMb(rb))if(this.isRow){if($d.a.all(cc,mc=>mc.isRow))return cc}else if($d.a.all(cc,mc=>mc.fk))return cc;return[rb]}getCellExtent(){return this.wn.getCellExtent()}MId(){const kb=this.wn.HO().style;return Math.max(0,
Math.min(this.u9f,0|parseInt(this.isRow?kb.height:kb.width,10)))}WXc(kb){kb=void 0===kb?0:kb;const rb=this.grid;var cc=this.Lj.vq.paneType;var mc=this.isRow?3===cc?[3,2]:[1,4]:4===cc?[2,4]:[1,3];var Sa=Math.max(this.grid.gp?this.arb:this.wn.Nfa(),0);Sa=this.dda&&!this.grid.gp?Math.max(this.MId(),0):Math.max(Sa+kb,0);this.wVb?0===kb?kb=[this.isRow?51:52]:(this.sWd=!0,kb=[this.isRow?49:50]):kb=[this.isRow?13:14];rb.rh.Vs(new la.Range(1,1,ka.a.gl,ka.a.Qk,!1,!0),kb,!1);if(this.KKa){cc=new Map;for(var pb of mc)mc=
rb.Zk(pb),mc=this.isRow?new Md.a(mc.vr.topLeft.x,this.offset,mc.zH.x,Sa):new Md.a(this.offset,mc.vr.topLeft.y,Sa,mc.zH.y),cc.set(pb,mc);rb.rh.rw(kb,null,null,!1,!0,cc)}else pb=rb.ANi(cc,this.isRow),pb=this.isRow?new Md.a(0,this.offset,pb,Sa):new Md.a(this.offset,0,Sa,pb),rb.rh.rw(kb,pb,mc);return Sa}Poc(kb){this.z1=this.$Oa=this.Znb=null;if(this.ica){const rb=this.ica.parentNode;if(rb)for(rb.removeChild(this.ica);this.ica.firstChild;)rb.appendChild(this.ica.firstChild);this.ica=null}dc.Mna()?this.wn&&
(this.wn=null,this.E6f("clearResizeState::"+kb)):this.wn=null;this.Goe=!0;this.S8=!1}Ehk(){this.bHc=!1;this.$Ag();this.cXf&&(this.Lj.ehk(),this.cXf=!1);oc.DOMElementExtensions.setVisible(dc.Mtb,!1);this.GWc(!1,"removeResizeArtifacts");this.Gqk()}LJd(kb){if(oc.DOMElementExtensions.uM(kb.Qh,"a"))return null;const rb=this.u0f(kb.La);if(rb&&this.grid.ha.qa.Gn){var cc=this.grid.ha.qa.Ui;cc=this.Lj.WA(la.Range.gi(cc.bottom,cc.right))}else cc=this.Lj.EIa(kb.Qh);if(!cc)return null;const mc=cc.HO(),Sa=new Sys.UI.Bounds(mc.offsetLeft,
mc.offsetTop,mc.offsetWidth,mc.offsetHeight);var pb=oc.DOMElementExtensions.getBoundingClientRect(kb.Qh);pb=new Sys.UI.Point(kb.clientPoint.x-pb.x,kb.clientPoint.y-pb.y);this.isRow&&!rb&&(pb.y+=Ta.HelperMethods.cH(kb.Qh,mc,this.rtl).y);return new Fd(mc,pb,Sa,cc.getRange(),Math.max(dc.fEj,Math.min(dc.YCj,(this.isRow?Sa.height:Sa.width)*dc.vpk)),rb,!this.isRow&&0<mc.getElementsByTagName("input").length)}rYd(kb,rb){rb=void 0===rb?!1:rb;if(!kb||this.grid.isEditing)return!1;if(kb.t0f)return!0;var cc=kb.dMa;
const mc=kb.Ltb;var Sa=this.Lj.vq.paneType,pb=this.grid.Zk(Sa).Hp,Ac=!!pb&&pb.top===kb.WOd.top,yd=!!pb&&pb.left===kb.WOd.left;Sa=!!pb&&pb.bottom===kb.WOd.bottom&&(3===Sa||2===Sa);this.isRow?(yd=kb.IYb.y,kb=yd<=mc&&!Ac,cc=yd>=cc.height-mc-(Sa?dc.kyi:0),rb=rb?kb:cc||kb):(Sa=kb.L3i,Ac=this.rtl,pb=kb.IYb.x,kb=pb<=mc&&(!yd||Ac)&&(!Sa||!Ac),cc=pb>=cc.width-mc&&(!Ac||!yd)&&(!Sa||Ac),rb=rb?Ac?cc:kb:kb||cc);return rb}NNh(kb,rb){const cc=this.isRow;if(kb.t0f)this.wn=this.Lj.EIa(kb.KJa);else if(cc&&kb.IYb.y<=
kb.Ltb&&kb.dMa.height>kb.Ltb||!cc&&kb.dMa.width>kb.Ltb&&(!this.rtl&&kb.IYb.x<=kb.Ltb||this.rtl&&kb.IYb.x>=kb.dMa.width-kb.Ltb)){if(this.wn=kb.KJa.previousSibling?this.Lj.EIa(kb.KJa.previousSibling):this.KMi(),rb&&kb.KJa.classList.contains(cc?ec.Qb:ec.Jb)&&(kb=this.Lj.EIa(kb.KJa)))kb=kb.getRange(),this.z1=cc?new la.Range(kb.top-1,kb.left,kb.top-1,kb.right,!1,!0):new la.Range(kb.top,kb.left-1,kb.bottom,kb.left-1,!1,!0)}else this.wn=this.Lj.EIa(kb.KJa);!this.z1&&this.wn&&(this.z1=this.wn.getRange())}KMi(){var kb=
this.isRow?1:0;return(kb=this.Lj.vq.hL(this.Lj.vq.za.an(this.grid.$.na,wd.a.UT(this.Lj.position.X+kb-1,this.Lj.position.Y-kb,this.Lj.position.PaneType))))?kb.JMi():null}VRf(){this.bHc=!0;const kb=this.wpk;oc.DOMElementExtensions.setVisible(kb,!0);kb.style.cursor=this.wVb?this.isRow?"ns-resize":"ew-resize":this.isRow?ec.gb:ec.g;this.WXc()}whi(kb){this.grid.$.ei(this.isRow?745189930:-445963340,Na.a.eh,30,{["resizeRowColumnParameters"]:kb})}N6h(){const kb=document.createElement("div");kb.className=ec.kb;
const rb=document.createElement("div");rb.className=Pc.a.S3;kb.appendChild(rb);const cc=document.createElement("img");cc.src=He.a.$m(0);cc.className=this.isRow?Pc.a.Pli:Pc.a.Oli;rb.appendChild(cc);this.Lj.gF.domElement.parentNode.insertBefore(kb,this.Lj.gF.domElement);this.grid.gp?kb.addEventListener("pointerdown",this.JRj):(Mb.a.instance.ya(sc.a.Zi,kb,this.XI),Rc.a.instance.ya(sc.a.sr,kb,this.w6));oc.DOMElementExtensions.setVisible(kb,!1);this.aW=kb}E6f(kb){dc.Mna()&&!this.wn&&sa.ULS.sendTraceTag(508368661,
2,20,`HeaderResizeBehavior.logUndefinedCellBeingResized: Cell being resized is undefined. caller: ${kb}`)}O2b(){this.grid.gp&&dc.Mna()&&!this.wn||this.Poc("removeResizer");this.hBg("removeResizer")}hBg(kb){var rb,cc,mc,Sa;if(this.aW){const pb=null===(mc=null===(cc=null===(rb=this.Lj)||void 0===rb?void 0:rb.gF)||void 0===cc?void 0:cc.domElement)||void 0===mc?void 0:mc.parentNode;dc.Mna()&&pb?pb.removeChild(this.aW):this.Lj.gF.domElement.parentNode.removeChild(this.aW);this.aW=null;dc.Mna()&&sa.ULS.sendTraceTag(508150751,
2,50,`HeaderResizeBehavior.removeTouchResizer: Touch resized removed. Was called from caller:${kb}.isRow: ${this.isRow}, blockHash: ${null===(Sa=this.Lj)||void 0===Sa?void 0:Sa.hashCode}, is flowContainer define: ${!!pb}`)}}u0f(kb){return oc.DOMElementExtensions.Cn(this.aW,kb.target)}KIb(){this.S8&&(this.grid.gp&&this.t7d(this.$Oa),this.Ppf(),this.grid.gp||oc.DOMElementExtensions.TBa(this.wn.HO(),!this.isRow,this.x4b),this.O2b(),this.B$b=this.dda=!1)}CQf(kb){(kb=kb.La.rawEvent)&&kb.detail===dc.Quk&&
(kb.type===sc.a.yy?(this.S8=!1,this.fqd=!0):kb.type===sc.a.VR&&(this.S8=!0,this.fqd=!1))}static M2h(kb,rb){return new dc(kb,rb)}static Ume(kb,rb,cc){if(rb){kb.ColumnWidth=-1;kb.RowHeight=cc;for(const mc of kb.SheetMultiRange.Ranges)mc.FirstColumn=0,mc.LastColumn=0}else{kb.RowHeight=-1;kb.ColumnWidth=cc;for(const mc of kb.SheetMultiRange.Ranges)mc.FirstRow=0,mc.LastRow=0}}static Lnj(kb,rb){if(!kb||!kb.HO())return sa.ULS.shipAssertTag(537154014,2,!1,"header after hidden headers is null"),!1;const cc=
kb.getRange();kb=kb.HO().style;if(!cc||!kb)return sa.ULS.shipAssertTag(537154013,2,!1,"header range or style is null"),!1;kb=rb?kb.height:kb.width;return(rb?cc.top:cc.left)===(rb?ka.a.gl:ka.a.Qk)&&kb===dc.o7g}static P2h(kb,rb,cc){if(!kb)return sa.ULS.shipAssertTag(537154012,2,!1,"header after hidden is null"),null;var mc=kb.HO();if(!mc||!mc.style)return sa.ULS.shipAssertTag(537154011,2,!1,"header after hidden element or style is null"),null;kb=document.createElement("div");const Sa=mc.style;kb.style.top=
rb?Sa.top:dc.o7g;rb||(cc?kb.style.right=Sa.right:kb.style.left=Sa.left);kb.classList.add(rb?gc.Rli:gc.Qli);kb.classList.add(rb?ec.Sb:ec.Lb);cc=document.createElement("div");cc.classList.add(rb?ec.Gb:ec.qb);mc=rb?Number.parseInvariant(mc.innerText):la.Range.vfb(mc.innerText);cc.innerText=rb?(mc-1).toString():la.Range.OT(mc-1);kb.appendChild(cc);return kb}static Mna(){return Ya.EwaSettings.isChangeGateEnabled("OfficeVSO:8257683_JSCrash_during_touch_resizeV2")}}dc.fEj=0;dc.YCj=5;dc.TAc=1;dc.vOf=1;dc.h5i=
0;dc.kyi=3;dc.vpk=.1;dc.gFg="ewa-rszrbg";dc.o7g="0px";dc.Quk=2;dc.Mtb=null;Object(V.a)(dc,"HeaderResizeBehavior",id.a,[924]);class Uc extends uc.a{constructor(){super();this.Bl()}create(){this.Yj(dc.M2h)}static Aa(kb){kb.ka.ph(136,new Uc)}}Object(V.a)(Uc,"HeaderResizeBehaviorFactory",uc.a,[]);nc.a.gw(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}");(()=>{Bb.a.Qg(kb=>{Uc.Aa(kb)})})();String(za);String(xa);window.___1708742503501_closurehack=za;window.___1708742503501_closurehack=
xa}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.rsz.js.map/c63a8245ce118735f648e01195f9493b/EwaTS.rsz.js.map