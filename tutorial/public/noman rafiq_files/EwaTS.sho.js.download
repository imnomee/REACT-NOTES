'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[22],{488:function(y,x,a){a.r(x);y={};a.r(y);a.d(y,"HideUnhideSheetCommandHandler",function(){return Q});x={};a.r(x);a.d(x,"RenameSheetCommandHandler",function(){return Ta});var c={};a.r(c);a.d(c,"ReorderSheetCommandHandler",function(){return sa});var b={};a.r(b);a.d(b,"SheetOpsCommandHandler",function(){return Jc});var f={};a.r(f);a.d(f,"SheetOpsApplyChangesHelper",function(){return Kb});var r={};a.r(r);a.d(r,"UnhideRowColButton",
function(){return ob});var d=a(179),k=a(0),t=a(158),m=a(419),e=a(212),w=a(40),l=a(267),u=a(209),n=a(262),v=a(62);const B=(Na,nb,Hb,na,Gb,Xa,Jb,qb=null)=>{qb=Na.Za(9,qb);qb.sheetNames=nb;qb.visibility=Hb;return v.h(Na,"ChangeSheetsVisibility",qb,na,Gb,Xa,Jb,0)};class z{constructor(Na,nb){this.sheetNames=null;this.visibility=!1;this.sheetNames=Na;this.visibility=nb}}Object(k.a)(z,"MacroRecorderSheetsVisibilityChangedPayload",null,[65]);var C=a(962),D=a(390),J=a(12);class W extends C.a{constructor(Na){super(Na);
this.Q4b=this.LOf=null;this.p1k=(nb,Hb)=>{1===nb&&(this.Q4b=Hb.selectedSheets,this.commit())};this.w7d=nb=>{if(nb=nb.Result)Object(t.a)(l.a,this.$.Gh).updateNamedObjects(nb.NamedObjects),nb=Object(t.a)(D.a,this.$.sa),nb.dqa(nb.getItemByName(this.Q4b[0]),"unhideSheet")};Na=J.a.instance.ia(536);this.Bh=1;this.GAk();this.initializeAndShow(Na,this.p1k,{[W.fy]:this.ki,["sheets"]:this.LOf})}get ki(){return"UnHideSheetDialog"}get oJ(){return 239}nt(){return()=>new z(this.Q4b,!0)}UN(){return(Na,nb,Hb)=>B(this.$.pa.ta,
this.Q4b,!0,this.bfb(Na,this.w7d),nb,Hb,this.Q4b)}GAk(){this.LOf=this.$.sa.items.filter(Na=>1===Na.iJ).map(Na=>Na.name)}}Object(k.a)(W,"UnHideSheetDialog",C.a,[]);var N=a(97),M=a(5);let Q=class{constructor(Na){this.$=Na;this.w7d=nb=>{(nb=nb.Result)&&Object(t.a)(l.a,this.$.Gh).updateNamedObjects(nb.NamedObjects)}}executeCommand(Na,nb){Na=w.TaskExtensions.sq();const Hb=nb.command;switch(Hb){case 1458540255:Na=this.shi([this.getSheetName()],nb);break;case 1129633328:new W(this.$);break;default:Na=u.a(Hb)}return Na}ni(Na,
nb,Hb,na){if(Na=!!na&&2===na.ZN)switch(nb.command){case 1458540255:case 1129633328:break;default:Na=!1}return Na}Ji(){return!1}Bi(){return!1}shi(Na,nb){const Hb=()=>new z(Na,!1);return m.a(this.$.userOperationManager,(na,Gb,Xa)=>B(this.$.pa.ta,Na,!1,n.c(na,this.w7d),Gb,Xa,Na),na=>new e.a(239,0,na,void 0,Hb),nb)}getSheetName(){const Na={};this.$.Mq(Na);return Na.SheetName}};Q=Object(d.__decorate)([Object(N.d)(M.hd),Object(d.__param)(0,Object(M.Lb)()),Object(d.__param)(1,Object(M.l)()),Object(d.__param)(2,
Object(M.Gf)())],Q);Object(k.a)(Q,"HideUnhideSheetCommandHandler",null,[39]);var R=a(14),O=a(98),U=a(252),K=a(27);class F{constructor(Na,nb){this.newSheetName=this.oldSheetName=null;this.oldSheetName=Na;this.newSheetName=nb}}Object(k.a)(F,"MacroRecorderSheetRenamedPayload",null,[65]);const I=(Na,nb,Hb,na,Gb,Xa,Jb,qb=null)=>{qb=Na.Za(9,qb);qb.sheetName=nb;qb.newSheetName=Hb;return v.h(Na,"RenameSheet",qb,na,Gb,Xa,Jb,0)};var P=a(25),Y=a(524),ea=a(95);class Ba extends C.a{constructor(Na){super(Na);this.ICc=
RegExp("^'|[?*\\\\/:\\]\\[]|'$");this.newSheetName=this.oldSheetName=null;this.Glk=(na,Gb)=>{1===na?(this.uy&&(na=this.$.sa.na)&&na.name===Y.a.current.lU&&ea.c(this.$.Bk)&&this.$.ka.Ug(237).Oaa(817296323,void 0),this.newSheetName=Gb.txtDocumentName,R.ULS.sendTraceTag(537154063,0,100,"RenameSheetDialog.RenameSheetDialogHandler pressing on OK. new name was given to sheet"),this.commit()):(R.ULS.sendTraceTag(537154062,0,50,"RenameSheetDialog.RenameSheetDialogHandler pressing on Cancel"),this.hide())};
this.Fma=na=>{na=this.t9k(na);return O.a.zm(na)};this.Yo=na=>{U.a(na)||this.$.ea.sa.yq(this.oldSheetName)&&Object(t.a)(D.a,this.$.ea.sa).renameSheet(this.oldSheetName,this.newSheetName)};this.uy=P.a.uy();Na=J.a.instance.ia(525);const nb={},Hb={[Ba.Kbj]:J.a.instance.ia(523),[Ba.Nbj]:this.sheetName,[Ba.GCj]:31,[Ba.sR]:"newName"};nb[Ba.Lbj]=Hb;this.Bh=1;this.aI=!1;this.initializeAndShow(Na,this.Glk,{[Ba.sR]:this.ki,[Ba.tJh]:nb,[Ba.YJd]:this.Fma,[Ba.T9k]:!0})}dispose(){super.dispose()}get ki(){return"RenameSheetDialog"}get oJ(){return 207}get sheetName(){const Na=
{};this.$.Mq(Na);return Na.SheetName}t9k(Na){return Na?31<Na.length?(R.ULS.sendTraceTag(537154061,0,50,"RenameSheetDialog.Validate: Sheet name is too long"),J.a.instance.ia(530)):-1!==Na.search(this.ICc)?J.a.instance.ia(531):!K.a.equals(Na,this.sheetName,!0)&&this.$.sa.yq(Na)?J.a.instance.ia(527):K.a.equals(Na,"History",!0)?J.a.instance.ia(528):"":J.a.instance.ia(529)}UN(){this.oldSheetName=this.sheetName;const Na=Array(this.newSheetName.length);for(let Hb=0;Hb<this.newSheetName.length;Hb++){const na=
this.newSheetName.charCodeAt(Hb);Na[Hb]=11<na?na:32}this.newSheetName=String.fromCharCode(...Na);const nb=this.$.pa.ta.Jh();return(Hb,na,Gb)=>I(this.$.pa.ta,this.sheetName,this.newSheetName,this.bfb(Hb,this.Yo),na,Gb,this.$,nb)}nt(){return()=>new F(this.oldSheetName,this.newSheetName)}}Ba.sR="id";Ba.Kbj="label";Ba.Nbj="value";Ba.GCj="maxLength";Ba.YJd="getInputErrorIfInvalid";Ba.Lbj="nameInputProps";Ba.tJh="bodyControls";Ba.T9k="validateOnChange";Object(k.a)(Ba,"RenameSheetDialog",C.a,[]);var Fa=
a(66),za=a(1),xa=a(16),fa=a(19);const V=document.createElement("canvas").getContext("2d");class ba{constructor(Na,nb){this.newSheetName=this.oldSheetName=null;this.ICc=RegExp("^'|[?*\\\\/:\\]\\[]|'$");this.Fma=Hb=>{Hb=this.W9k(Hb);return O.a.zm(Hb)};this.Yo=Hb=>{U.a(Hb)?(this.dx.name=this.oldSheetName,this.dx.sheet.name=this.oldSheetName):this.$.ea.sa.yq(this.oldSheetName)&&Object(t.a)(D.a,this.$.ea.sa).renameSheet(this.oldSheetName,this.newSheetName);this.vlf()};this.A3g=Hb=>{this.newSheetName=Hb;
this.dx.name=Hb;this.dx.sheet.name=Hb;this.Vm.style.display="none";this.dx.OP.style.display="";m.a(this.$.userOperationManager,this.UN(),na=>new e.a(207,0,na,64),null)};this.XI=Hb=>{Hb.stopPropagation()};this.w6=Hb=>{Hb.stopPropagation()};this.hp=Hb=>{Hb.stopPropagation();Hb.preventDefault()};this.Rig=()=>{this.Vm.style.width=`${this.w9e()}px`;this.dx.name=this.Vm.value};this.onFocus=()=>{this.Vm.select()};this.onBlur=()=>{const Hb=this.Vm.value,na=this.Fma(Hb);na?(this.dx.name=this.oldSheetName,
this.Vm.style.display="none",this.dx.OP.style.display="",this.DRg(na)):this.A3g(Hb)};this.onKeyDown=Hb=>{if(this.ICc.test(Hb.key))Hb.preventDefault();else if("Enter"===Hb.key){const na=this.Vm.value,Gb=this.Fma(na);if(Gb){this.DRg(Gb);this.Vm.select();return}this.A3g(na)}else"Escape"===Hb.key?(this.Vm.style.display="none",this.dx.name=this.oldSheetName,this.dx.OP.style.display="",this.vlf()):Hb.ctrlKey&&"a"===Hb.key&&this.Vm.select();Hb.stopPropagation()};this.pE=Hb=>{Hb.stopPropagation()};this.$=
Na;this.dx=nb;this.sheet=this.$.sa.na;this.oldSheetName=this.dx.name;this.V$a=xa.DOMElementExtensions.getElementById(this.dx.RT,"inlineRenameInput");this.JKb();this.xGh();this.$Aj()}dispose(){xa.DOMElementExtensions.Km(this.V$a);this.sheet=this.dx=this.V$a=null}get oJ(){return 207}JKb(){null!==this.V$a&&xa.DOMElementExtensions.Km(this.V$a);this.V$a=document.createElement("input");this.Vm.setAttribute("id","inlineRenameInput");this.Vm.className=fa.a.nmi;this.Vm.spellcheck=!1;this.Vm.autocomplete="off";
this.Vm.type="text";this.Vm.maxLength=31;this.Vm.dir="ltr";this.dx.RT.insertBefore(this.Vm,this.dx.OP)}get Vm(){return this.V$a}w9e(){const Na=this.Vm.value,nb=window.getComputedStyle(this.Vm,null).getPropertyValue("font");V.font=nb;return V.measureText(Na).width}$Aj(){this.Vm.value=this.oldSheetName;this.Vm.style.display="inline-block";this.Vm.style.width=`${this.w9e()}px`;this.dx.OP.style.display="none";xa.DOMElementExtensions.setFocus(this.Vm)}DRg(Na){Na&&appChrome.renderInvalidSheetNameCallout(Na,
this.dx.$Df().parentElement)}W9k(Na){return""===Na?J.a.instance.ia(529):31<Na.length?J.a.instance.ia(530):-1!==Na.search(this.ICc)?J.a.instance.ia(531):!K.a.equals(Na,this.oldSheetName,!0)&&this.$.sa.yq(Na)?J.a.instance.ia(527):K.a.equals(Na,"History",!0)?J.a.instance.ia(528):null}UN(){const Na=Array(this.newSheetName.length);for(let Hb=0;Hb<this.newSheetName.length;Hb++){const na=this.newSheetName.charCodeAt(Hb);Na[Hb]=11<na?na:32}this.newSheetName=String.fromCharCode(...Na);const nb=this.$.pa.ta.Jh();
return(Hb,na,Gb)=>I(this.$.pa.ta,this.oldSheetName,this.newSheetName,this.bfb(Hb,this.Yo),na,Gb,this.$,nb)}bfb(Na,nb){return n.c((Hb,na,Gb)=>{Hb?(U.a(Hb)&&R.ULS.sendTraceTag(507536390,0,100,"InplaceRenameSheetManager.ChainSuccessCallback: result contains errors,"),nb(Hb,na,Gb)):(R.ULS.sendTraceTag(507536391,0,10,`${Gb} result is null`),this.dx.name=this.oldSheetName,this.dx.sheet.name=this.oldSheetName)},Na)}xGh(){this.Vm.addEventListener("mousedown",this.XI);this.Vm.addEventListener("dblclick",this.w6);
this.Vm.addEventListener("contextmenu",this.hp);this.Vm.addEventListener("input",this.Rig);this.Vm.addEventListener("focus",this.onFocus);this.Vm.addEventListener("blur",this.onBlur);this.Vm.addEventListener("keydown",this.onKeyDown);this.Vm.addEventListener("keypress",this.pE)}vlf(){this.Vm.removeEventListener("mousedown",this.XI);this.Vm.removeEventListener("dblclick",this.w6);this.Vm.removeEventListener("contextmenu",this.hp);this.Vm.removeEventListener("input",this.Rig);this.Vm.removeEventListener("focus",
this.onFocus);this.Vm.removeEventListener("blur",this.onBlur);this.Vm.removeEventListener("keydown",this.onKeyDown);this.Vm.removeEventListener("keypress",this.pE)}}Object(k.a)(ba,"InplaceRenameSheetManager",null,[2]);var la=a(156);let Ta=class{constructor(Na,nb){this.hJ=null;this.$=Na;this.hJ=nb}get dx(){return this.hJ.l5(this.$.sa.na.index)}executeCommand(Na,nb,Hb){za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TrackAsyncDialogRenameSheet",!1)&&la.b(this.$).ix(Hb.event,"dialog-rename",
null,["dialog"]);za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InplaceSheetRename",!1)?setTimeout(()=>{new ba(this.$,this.dx)},50):new Ba(this.$);return Fa.Task.Va(!0)}ni(Na,nb,Hb,na){return 817296323===nb.command&&!!na&&2===na.ZN}Ji(){return!1}Bi(){return!1}};Ta=Object(d.__decorate)([Object(N.d)(M.ef),Object(d.__param)(0,Object(M.Lb)()),Object(d.__param)(1,Object(M.Kf)())],Ta);Object(k.a)(Ta,"RenameSheetCommandHandler",null,[39]);C=a(421);class Ea extends C.a{constructor(Na){super(Na);
this.fhe=null;this.I3d=!1;this.Wlk=(nb,Hb)=>{1===nb&&(this.W7j(Hb),nb=this.zUi(),nb.Uaa=this.NIf(this.sheetName),nb.reorderSheets(this.I3d?null:this.NIf(this.fhe),this.I3d,!1))};this.sheetNames=this.nxc();Na={[Ea.fy]:this.ki,["sheetNames"]:this.sheetNames};this.initializeAndShow(J.a.instance.ia(534),this.Wlk,Na)}get ki(){return"ReorderSheetDialog"}W7j(Na){this.fhe=Na.destinationSheet;this.I3d=Array.indexOf(this.sheetNames,this.fhe)===this.sheetNames.length-1}nxc(){const Na=J.a.instance.ia(535);return this.$.sa.items.filter(nb=>
nb.visible).map(nb=>nb.name).concat(Na)}get sheetName(){const Na={};this.$.Mq(Na);return Na.SheetName}zUi(){return za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateSheetTabBar",!1)?N.a.Zg(M.Kf):this.$.ka.Ug(32)}NIf(Na){const nb=this.$.sa;return nb.yq(Na)?nb.getItemByName(Na):null}}Object(k.a)(Ea,"ReorderSheetDialog",C.a,[]);let sa=class{constructor(Na){this.$=Na}executeCommand(){new Ea(this.$);return Fa.Task.Va(!0)}ni(Na,nb,Hb,na){return-383100692===nb.command&&!!na&&2===na.ZN}Ji(){return!1}Bi(){return!1}};
sa=Object(d.__decorate)([Object(N.d)(M.gf),Object(d.__param)(0,Object(M.Lb)())],sa);Object(k.a)(sa,"ReorderSheetCommandHandler",null,[39]);var Ya=a(96),bb=a(188),ra=a(361),Da=a(7),oa=a(355),Ha=a(196),ka=a(39),wa=a(35),Za=a(117),ab=a(194),db=a(47);class mb{constructor(Na){this.sheetNameBefore=null;this.sheetNameBefore=Na}}Object(k.a)(mb,"MacroRecorderSheetAddedPayload",null,[65]);class Ia{constructor(Na){this.sheetName=null;this.sheetName=Na}getSheetName(){return this.sheetName}}Object(k.a)(Ia,"MacroRecorderSheetDeletedPayload",
null,[65]);class pa{constructor(Na){this.sheetName=null;this.sheetName=Na}getSheetName(){return this.sheetName}}Object(k.a)(pa,"MacroRecorderSheetDuplicatedPayload",null,[65]);class lb{constructor(Na,nb,Hb){this.sheetName=null;this.tabColorValue=this.tabColorType=0;this.sheetName=Na;this.tabColorType=nb;this.tabColorValue=Hb}getSheetName(){return this.sheetName}}Object(k.a)(lb,"MacroRecorderSheetTabColoredPayload",null,[65]);const ha=(Na,nb,Hb,na,Gb,Xa,Jb,qb=null)=>{qb=Na.Za(9,qb);qb.sheetName=nb;
qb.confirmationChoice=Hb;return v.h(Na,"DeleteSheet",qb,na,Gb,Xa,Jb,0)},ua=(Na,nb,Hb,na,Gb,Xa,Jb,qb=null)=>{qb=Na.Za(9,qb);qb.shadowWorkbookBase64=nb;qb.sheetName=Hb;return v.h(Na,"PasteSheetFromShadowWorkbook",qb,na,Gb,Xa,Jb,0)},fb=(Na,nb,Hb,na,Gb,Xa,Jb=null)=>{Jb=Na.Za(25,Jb);Jb.sheetName=nb;return v.h(Na,Jc.AAd,Jb,Hb,na,Gb,Xa,0)};var Ka=a(24),La=a(213);class ib{constructor(Na,nb){this.shadowWorkbookBase64=this.dstSheetName=null;this.shadowWorkbookBase64=Na;this.dstSheetName=nb}}Object(k.a)(ib,
"MacroRecorderFullSheetAddedPayload",null,[65]);var Yb=a(915),Wc=a(643),Qc,Wb;(function(Na){Na[Na.SUCCESS=0]="SUCCESS";Na[Na.FAILURE=1]="FAILURE"})(Wb||(Wb={}));Object(k.b)("CopySheetStatusCalloutType",Wb);let Jc=Qc=class{get copyPasteInfrastructure(){return this.$.ka.Ug(254,!0)}constructor(Na,nb,Hb){this.OF=this.xG=null;this.vH=(na,Gb)=>{U.a(na)||this.$.sa.yq(Gb)&&this.$sd.deleteSheet(this.$.sa.na,!0)};this.O8d=(na,Gb,Xa)=>{if(!U.a(na)){const Db=Object(t.a)(D.a,this.$.sa);var Jb=null;if(Gb.EWf)var qb=
na.Result;else Jb=na.Result,qb=Jb.NewSheetTab.SheetName;Wc.a.nmb&&(Gb.PEc||Gb.EWf)&&this.pasteIndicationManager.Rkb(Gb.id,!0,qb,!0);Db.yq(qb)||Db.insertSheet(Jb.NewSheetTab,Jb.SheetIndex);Jb=Db.na.name;Db.na.name!==qb&&(qb=Db.getItemByName(qb),Gb.PEc?qb.Kyk(Db.na.sheetProcessedData):qb.C5b("NewSheet"),Db.dqa(qb,Xa));za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!0)&&Xa===Qc.AAd&&(Gb=N.a.Zg(M.ke))&&Gb.Mia(2,na,Jb)}};this.$=Na;
this.$sd=nb;this.Jl=Hb;this.rK=P.a.rK();this.uy=P.a.uy()}get sw(){this.xG||(this.xG=N.a.Zg(M.og));return this.xG}pIg(Na){var nb;null===(nb=this.pasteIndicationManager)||void 0===nb?void 0:nb.Htk(Na)}get pasteIndicationManager(){return this.$.ka.Ug(373)}executeCommand(Na,nb,Hb){const na=M.Ob.Ha()?N.a.Zg(M.Ob):this.$.ka.Ug(65);if(this.rK&&1880294140===nb.command&&(Na=N.a.Zg(M.hg))&&0<Na.rangeList.length)for(let Gb=Na.rangeList.length-1;0<=Gb;Gb--){const Xa=Na.rangeList[Gb],Jb=Ka.f(this.$).Yg.sl(Xa,
!1);if(Jb&&Jb.isSampleTable){La.e(this.$,Xa,nb.command,null);break}}if(na&&na.uxa())if(1880294140!==nb.command)na.CUc(),na.Gfb();else return na.Lye.invokeModalConfirmationDialog(()=>{this.qfg(na,nb,Hb)},()=>{na.setFocus(!1,!1)},na.Nbi),Fa.Task.Va(!1);return this.Vuf(nb,Hb)}ni(Na,nb,Hb,na){if(Na=!!na&&2===na.ZN)switch(Na=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateSheetTabBar",!1)?N.a.Zg(M.Kf):this.$.ka.Ug(32),nb.command){case -316075891:case 1609946343:case -1876836819:return!!Na&&
!Na.navigationButtonsDisabled;case -546331179:case -1935155518:case 1880294140:case 467002767:case 1549407384:case -1254662242:case -207190267:case 440556491:case -684145703:return!!Na&&!Na.operationButtonsDisabled;case -221093529:Na=!0;break;case -605730035:Na=P.a.sK();break;default:Na=!1}return Na}Ji(){return!1}Bi(){return!1}dispose(){Ya.a.Ng(this.$sd);this.$sd=null}Vuf(Na,nb){const Hb=Na.command;switch(Hb){case -1876836819:nb=this.switchSheet(Na,nb);break;case -546331179:nb=this.M_e(!0,Na);break;
case -1935155518:nb=this.M_e(!1,Na);break;case 1880294140:nb=this.f$h(Na);break;case -316075891:case 1609946343:nb=this.i_k(Na);break;case -1254662242:nb=this.duplicateSheet(Na);break;case -207190267:nb=this.fullSheetCopy(Na,nb);break;case 440556491:this.copyPasteInfrastructure.ghb()?(nb=bb.a.create().toString(),nb=this.duplicateSheet(Na,nb)):(this.copyPasteInfrastructure.r2j(Na,nb).then(na=>{let Gb=null;({YM:Gb}=this.f9b(na.clipboardItems)).returnValue&&this.xyi(Na,Gb.shadowWorkbookBase64,na.commandParameters.id).continueWith(()=>
{this.copyPasteInfrastructure.ux("fullSheetPaste/success/"+ra.a[Na.method],!0).then(()=>{R.ULS.sendTraceTag(507844232,0,10,"SheetOpsCommandHandler.FullSheetPaste : cleared clipboard")}).catch(Xa=>{Xa||R.ULS.sendTraceTag(507839586,0,10,"SheetOpsCommandHandler.FullSheetPaste : error in clearing clipboard")})})}).catch(na=>{na||R.ULS.sendTraceTag(507847628,0,10,"SheetOpsCommandHandler.FullSheetPaste : returns error")}),nb=Fa.Task.Va(!0));break;case 467002767:nb=this.setSheetTabColor(Na,nb);break;case -605730035:nb=
P.a.sK()?this.Jl.launchEyedropper(Hb,Na):Fa.Task.Va(!1);break;case 1549407384:nb=this.clearSheetTabColor(Na);break;case -684145703:nb=Fa.Task.Va(!0);break;case -221093529:nb=Object(t.a)(D.a,this.$.sa).SIf(this.getSheetName());nb=this.Jl.oob(467002767,Na,nb);break;default:nb=u.a(Hb)}return nb}f9b(Na){let nb;nb=null;Na=Na.getItem(Yb.a.shadowWorkbook);if(!Na)return{returnValue:!1,YM:nb};nb=JSON.parse(Na);return{returnValue:this.$Xd(nb),YM:nb}}$Xd(Na){return!!Na&&(!!Na.shadowWorkbookBase64||Na.shadowWorkbookSizeExceedsLimit)}xyi(Na,
nb,Hb){const na=this.$.pa.ta.Jh();this.pIg(Hb);const Gb=()=>new ib(nb,this.getSheetName()),Xa=()=>{R.ULS.sendTraceTag(507839585,0,50,"SheetOpsCommandHandler.FullSheetPasteRequqest : error in Completing Full Sheet Past Request")};return m.a(this.$.userOperationManager,(Jb,qb,Db)=>ua(this.$.pa.ta,nb,this.getSheetName(),n.c(Jb,this.O8d),n.b(qb,Xa),Db,{EWf:!0,id:Hb},na),Jb=>new e.a(610,0,Jb,void 0,Gb),Na)}qfg(Na,nb,Hb){Na.Fef();Na.Gfb();this.Vuf(nb,Hb)}i_k(Na){Na=Na.command;const nb=this.$.sa;let Hb=
nb.na.index,na=!1;const Gb=-316075891===Na?1:-1;for(;!na&&Qc.A7i(Na,nb,Hb);){Hb+=Gb;const Xa=nb.getItem(Hb);if(null===Xa||void 0===Xa?0:Xa.visible)Xa.activate({scenario:"switchSheet"}),na=!0}na&&(ab.a.current.cZ="TryActivateSheet");return Fa.Task.Va(na)}Wpf(Na,nb,Hb){const na=()=>new Ia(nb);za.EwaSettings.isChangeGateEnabled("OfficeVSO:8380585_InvestigateConditionalFormattingCriticalError_5")&&this.$.ea.rzk();m.a(this.$.userOperationManager,(Gb,Xa,Jb)=>ha(this.$.pa.ta,nb,Na,n.c(Gb,this.vH),Xa,Jb,
nb),Gb=>new e.a(137,0,Gb,void 0,na),Hb)}f$h(Na){ab.a.current.cZ="DeleteActiveSheet";const nb={};this.$.Mq(nb);const Hb=Object(t.a)(Za.a,this.$.sa.getItemByName(nb.SheetName));if(Hb){var na=Hb.hasCodeName&&ea.f(this.$.Bk);na=wa.a.Yi(3,2,0,na?522:521,0,1562173434,"SheetOpsConfirmDelete");return w.TaskExtensions.Ua(db.a(this.$).lp(na),Gb=>{if(0===Gb.result)if(R.ULS.sendTraceTag(537153808,0,50,"SheetOpsConfirmDelete pressed"),this.uy&&1880294140===Na.command&&(Gb=this.$.sa.na)&&Gb.name===Y.a.current.lU&&
ea.c(this.$.Bk)&&this.$.ka.Ug(237).Oaa(1880294140,void 0),Hb.containsOlapSlicer){const Xa=Jb=>{this.Wpf(Jb,nb.SheetName,Na)};void N.a.resolve(M.qb,{va:1}).then(Jb=>{Jb.UL(!0,Xa)})}else this.Wpf(!1,nb.SheetName,Na)},this.$.xa,11)}return Fa.Task.Va(!0)}M_e(Na,nb){ab.a.current.cZ="AddSheet";let Hb="";Na||(Hb=this.getSheetName());const na=this.$.pa.ta.Jh(),Gb=()=>new mb(Hb);return m.a(this.$.userOperationManager,(Xa,Jb,qb)=>{var Db=this.$.pa.ta,gb=Hb;Xa=n.c(Xa,this.O8d);const ya=Db.Za(25,na);ya.sheetNameBefore=
gb;return v.h(Db,"InsertSheet",ya,Xa,Jb,qb,{PEc:!1},0)},Xa=>new e.a(138,0,Xa,void 0,Gb),nb)}switchSheet(Na,nb){ab.a.current.cZ="SwitchSheet";Na=!1;nb=this.$.sa.getItemByName(nb[Da.a.koe]);if(null===nb||void 0===nb?0:nb.visible)nb.activate({scenario:"switchSheet"}),Na=!0;return Fa.Task.Va(Na)}getSheetName(){const Na={};this.$.Mq(Na);return Na.SheetName}duplicateSheet(Na,nb){ab.a.current.cZ=Qc.AAd;let Hb=this.getSheetName();Wc.a.nmb&&(this.pIg(nb),Hb=this.copyPasteInfrastructure.lGi());const na=this.$.pa.ta.Jh(),
Gb=()=>new pa(Hb);return m.a(this.$.userOperationManager,(Xa,Jb,qb)=>fb(this.$.pa.ta,Hb,n.c(Xa,this.O8d),Jb,qb,Wc.a.nmb?{PEc:!0,id:nb}:{PEc:!0},na),Xa=>new e.a(139,0,Xa,void 0,Gb),Na)}YQg(Na,nb){appChrome.renderCopySheetStatusCallout(Na,nb)}fullSheetCopy(Na){ab.a.current.cZ="CopySheet";const nb=this.getSheetName();this.copyPasteInfrastructure.q2j(Na).then(()=>{this.YQg(nb,Wb.SUCCESS);R.ULS.sendTraceTag(507834586,0,50,"SheetOpsCommandHandler.fullSheetCopy is successful")}).catch(()=>{this.YQg(nb,Wb.FAILURE);
R.ULS.sendTraceTag(507834585,0,10,"SheetOpsCommandHandler.fullSheetCopy : returns error")});return Fa.Task.Va(!0)}setSheetTabColor(Na,nb){const Hb=nb.Color,na=Ha.a.FO(Hb,ka.a.Em(nb,"IntColor"));let Gb=Qc.VFg,Xa;({themeColor:Xa}=this.getThemeColor(nb)).returnValue&&(Gb=Qc.JXg);this.Jl&&this.Jl.Oza(nb,Hb,Na);return this.changeSheetTabColor(Na,na,Gb,Xa)}clearSheetTabColor(Na){return this.changeSheetTabColor(Na,-1,Qc.E6e)}changeSheetTabColor(Na,nb,Hb,na=null){const Gb=this.$.pa.ta,Xa=this.getSheetName(),
Jb=Hb===Qc.E6e?null:Ha.a.c2(nb);Object(t.a)(D.a,this.$.sa).setSheetTabColor(Xa,Jb);let qb=Hb;Hb===Qc.JXg&&(qb=Qc.VFg);const Db=()=>new lb(Xa,qb,nb);return m.a(this.$.userOperationManager,(gb,ya,Aa)=>oa.E(Gb,Xa,Hb,nb,na,gb,ya,Aa,null),gb=>new e.a(515,0,gb,64,Db),Na)}getThemeColor(Na){const nb={};if((Na.SqmControlId||"").includes(Qc.tVk)){if(!this.sw)return R.ULS.sendTraceTag(537153806,0,10,"SheetOpsCommandHandler.GetThemeColor: Themes Manager is null"),{returnValue:!1,themeColor:nb};let Hb;const na=
({themeIndex:Na,sPa:Hb}=this.sw.getThemeColor(Na.Color)).returnValue;na&&(nb.ThemeColorIndex=Na,nb.ThemeColorRow=Hb);return{returnValue:na,themeColor:nb}}return{returnValue:!1,themeColor:nb}}static A7i(Na,nb,Hb){return-316075891===Na&&Hb<nb.count-1||1609946343===Na&&0<Hb}};Jc.AAd="DuplicateSheet";Jc.E6e=0;Jc.VFg=2;Jc.JXg=3;Jc.tVk="ThemeColorPicker";Jc=Qc=Object(d.__decorate)([Object(N.d)(M.Ef),Object(d.__param)(0,Object(M.Lb)()),Object(d.__param)(1,Object(M.Gf)()),Object(d.__param)(2,Object(M.Kd)())],
Jc);Object(k.a)(Jc,"SheetOpsCommandHandler",null,[39,2]);var ma=a(724),Hc=a(32);let Kb=class{constructor(Na){this.$Ic=0;this.CF=!1;this.Owa=()=>{const nb=this.$.ea.Cq;za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsertSheetLogging",!1)&&R.ULS.sendTraceTag(507585097,0,50,"SheetOpsApplyChangesHelper.OnWorkbookMetadataChanged: Entering");if((null===nb||void 0===nb?0:nb.Sheets)&&nb.SheetChanges){const Xa=nb.SheetChanges.length,Jb=nb.Sheets,qb=Object(t.a)(D.a,this.$.sa);var Hb=qb.na;if(Hb){za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsertSheetLogging",
!1)&&0>=Xa&&R.ULS.sendTraceTag(507585034,0,50,`sheetChangesCount: ${Xa} is not positive`);for(let Db=0;Db<Xa;Db++){const gb=nb.SheetChanges[Db];this.CF&&1===gb.Type&&this.$.ea.eEk();if(gb.StateVersion>this.$Ic){Hb||(Hb=qb.na);var na=null;if(0!==gb.Type&&2!==gb.Type&&(na=Object(t.a)(Za.a,qb.getItemByName(gb.Name)),!na)){R.ULS.sendTraceTag(537153801,0,10,`SheetOpsApplyChangesHelper.OnWorkbookMetadataChanged: Unable to find sheet. TotalNumSheets=${qb.count}, SheetOptions=${gb.Options}, ChangeType=${gb.Type}, IsDuringTotallySilentReopen=${this.$.ea.Hl()}`);
continue}switch(gb.Type){case 0:if(qb.yq(gb.Name)){R.ULS.shipAssertTag(537153800,0,!1,"SheetChangeType.Insert: A sheet with current name already exists, skipping this sheet.");continue}na=0;let ya=null;for(var Gb=0;Gb<Jb.length;Gb++)if(qb.yq(Jb[Gb].Name)&&(na=qb.getItemByName(Jb[Gb].Name).index+1),Jb[Gb].Name===gb.Name){ya=Jb[Gb];break}Gb={};Gb.SheetName=gb.Name;Gb.SelectionRangeInformation=ma.b();ya?(Gb.TabColor=ya.TabColor,Gb.SheetType=ya.SheetType,Gb.Visible=ya.Visibility,Gb.SheetId=ya.SheetId,
Gb.AllowSheetProtectionFeatures=ya.AllowSheetProtectionFeatures,Gb.NamedSheetViews=ya.NamedSheetViews,Gb.NamedSheetViewActive=ya.NamedSheetViewActive,1===(ya.Flags&1)&&(Gb.SheetOptions|=1),8===(ya.Flags&8)&&(Gb.SheetOptions|=8),2===(ya.Flags&2)&&(Gb.SheetOptions|=2),4===(ya.Flags&4)&&(Gb.SheetOptions|=4),16===(ya.Flags&16)&&(Gb.SheetOptions|=128),32===(ya.Flags&32)&&(Gb.SheetOptions|=1024),64===(ya.Flags&64)&&(Gb.SheetOptions|=2048),128===(ya.Flags&128)&&(Gb.SheetOptions|=4096),256===(ya.Flags&256)&&
(Gb.SheetOptions|=16384),512===(ya.Flags&512)&&(Gb.SheetOptions|=65536),1024===(ya.Flags&1024)&&(Gb.SheetOptions|=131072)):za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsertSheetLogging",!1)&&R.ULS.sendTraceTag(507585095,0,50,"Could not find data on new sheet.");qb.insertSheet(Gb,na);break;case 5:qb.reorderSheet(na,gb.Index,!1);break;case 1:case 3:Hb=na===Hb;if(1===gb.Type)this.deleteSheet(na,Hb);else for(const Aa of Jb)if(Aa.Name===gb.Name){this.M5i(na,Hb,Aa.Visibility);break}Hb&&
(this.$.workbookContext.ActiveNamedObject=qb.na.name,this.$.ea.EOc());Hb=null;break;case 2:Hb=this.$.workbookContext;for(let Aa=0,sb=Hb.SheetTabs.length;Aa<sb;Aa++)if(Hb.SheetTabs[Aa].SheetName===gb.Name){Hb.SheetTabs[Aa].SheetName=gb.NewName;Hb.ActiveNamedObject===gb.Name&&(Hb.ActiveNamedObject=gb.NewName);this.$.ea.EOc();break}this.$.sa.yq(gb.Name)&&qb.renameSheet(gb.Name,gb.NewName);Hb=null;break;case 8:Hb=this.$.workbookContext;for(let Aa=0,sb=Hb.SheetTabs.length;Aa<sb;Aa++)if(Hb.SheetTabs[Aa].SheetName===
gb.Name){Hb.SheetTabs[Aa].TabColor=gb.TabColor;this.$.ea.EOc();break}qb.setSheetTabColor(gb.Name,gb.TabColor);Hb=null;break;case 4:na.iJ=0;qb.unhideSheet(na);Hb=null;break;case 6:case 7:128===gb.Options&&(na.tUa=gb.AllowSheetProtectionFeatures);na.RIb(gb.Options,6===gb.Type);break;case 9:na.Kj.mRf(gb.NamedSheetViews);na.Kj.koc(gb.ActiveNamedSheetView);break;default:za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsertSheetLogging",!1)&&R.ULS.sendTraceTag(507585094,0,50,"SheetOpsApplyChangesHelper.OnWorkbookMetadataChanged: Unknow change type = {0}",
gb.Type)}this.$Ic=gb.StateVersion}else za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsertSheetLogging",!1)&&R.ULS.sendTraceTag(507585033,0,50,`StateVersion: ${gb.StateVersion} is not less than latestSheetChange: ${this.$Ic}`)}}else za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsertSheetLogging",!1)&&R.ULS.sendTraceTag(507585096,0,50,"SheetOpsApplyChangesHelper.OnWorkbookMetadataChanged: ActiveSheet is null")}else za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsertSheetLogging",
!1)&&R.ULS.sendTraceTag(507585032,0,50,`No sheets or no sheet changes. typeof workbookMetadata: ${typeof nb}; typeof Sheets: ${typeof(null===nb||void 0===nb?void 0:nb.Sheets)}; typeof SheetChanges: ${typeof(null===nb||void 0===nb?void 0:nb.SheetChanges)}`)};this.Oi=()=>{this.$Ic=0};this.$=Na;Na.ea.Xy(this.Owa);Na.ea.uq(this.Oi);(this.CF=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8380585_InvestigateConditionalFormattingCriticalError_5"))&&R.ULS.sendTraceTag(507831451,0,50,"loading SheetOpsApplyChangesHelper.ts. (TimeStamp {0})",
Hc.a.Tg.Wh.getTime())}dispose(){this.$&&(this.$.ea.pA(this.Owa),this.$.ea.pq(this.Oi),this.$=null,this.CF&&R.ULS.sendTraceTag(507831450,0,50,"disposing SheetOpsApplyChangesHelper.ts. (TimeStamp {0})",Hc.a.Tg.Wh.getTime()))}M5i(Na,nb,Hb){const na=Object(t.a)(D.a,this.$.sa),Gb=this.nGf(Na,nb);R.ULS.shipAssertTag(537153804,0,1<=Hb,"SheetChangeType.Hide: Trying to hide Sheet with Visibility Visible.");Object(t.a)(Za.a,Na).iJ=Hb;nb&&na.getItem(Gb).activate({scenario:"hideSheet"});na.hideSheet(Na)}deleteSheet(Na,
nb){const Hb=Object(t.a)(D.a,this.$.sa),na=this.nGf(Na,nb);this.CF&&this.$.ea.szk();Hb.D$h(Na);nb&&Hb.getItem(na).activate({scenario:"deleteSheet"});this.CF&&this.$.ea.qzk();Hb.deleteSheet(Na)}nGf(Na,nb){const Hb=this.$.sa;let na=Na.index+1,Gb=1;if(nb)for(;0<=na;){na>=Hb.count&&(na=Na.index-1,Gb=-1);if(0>na||na>=Hb.count)return R.ULS.shipAssertTag(537153797,0,!1,`SheetOpsApplyChangesHelper.GetNewActiveSheetIndex: activeIndex is out of the range of sheets. ActiveIndex: ${na}, Sheets.Count: ${Hb.count}`),
0;if(0===Object(t.a)(Za.a,Hb.getItem(na)).iJ)break;na+=Gb}return na}};Kb=Object(d.__decorate)([Object(N.d)(M.Gf),Object(d.__param)(0,Object(M.Lb)())],Kb);Object(k.a)(Kb,"SheetOpsApplyChangesHelper",null,[140,2]);var pc=a(26),$b=a(45),Ib=a(115),Zb=a(10),Eb=a(161);let ob=class{constructor(Na,nb){this.Lzd=!1;this.nCa=13;this.yog=(Hb,na,Gb)=>{R.ULS.sendTraceTag(507847638,0,50,`UnhideRowColButton.onUnhideSkittleClick: Skittle clicked, isRow: ${na}`);Hb=na?new pc.Range(Hb,1,Hb,1,!1,!1):new pc.Range(1,Hb,
1,Hb,!1,!1);const Xa=this.da.mj;na?Gb?(Gb=$b.H(Hb,Xa),Hb=new pc.Range(Gb.equals(Hb)?1:Gb.top,Hb.left,Hb.bottom,Hb.right,!1,!1)):(Gb=$b.I(Hb,Xa),Hb=new pc.Range(Hb.top,Hb.left,Gb.equals(Hb)?Zb.a.gl:Gb.bottom,Hb.right,!1,!1)):Gb?(Gb=$b.L(Hb,Xa),Hb=new pc.Range(Hb.top,Gb.equals(Hb)?1:Gb.left,Hb.bottom,Hb.right,!1,!1)):(Gb=$b.O(Hb,Xa),Hb=new pc.Range(Hb.top,Hb.left,Hb.bottom,Gb.equals(Hb)?Zb.a.Qk:Gb.right,!1,!1));this.$.ei(na?1542466017:369708605,2,30,{rangeToUnhide:Hb})};this.R7d=()=>{R.ULS.sendTraceTag(507844435,
0,50,"UnhideRowColButton.onMouseEnterSkittle: Hover on skittle");this.Btd()};this.Zsc=()=>{this.Lzd=!0;window.requestAnimationFrame(this.Xbi)};this.Btd=()=>{this.Lzd=!1};this.Xbi=()=>{this.Lzd&&(this.Btd(),appChrome.renderUnhideRowColButton(this.domElement,null,null,!1,this.Zsc,this.R7d,null,!1,0,!1,!1))};this.domElement=document.createElement("div");nb.Ym.appendChild(this.domElement);this.da=nb;this.$=Na}UNk(Na,nb,Hb,na,Gb){na?this.ZPh()&&(this.Btd(),this.Slk(Na,nb,Hb,Gb)):this.Zsc()}ZPh(){return za.EwaSettings.isChangeGateEnabled("OfficeVSO:8544902_DisableUnhideSkittleInNonEditMode")?
!this.$.isEditMode||(new Eb.a(this.$.sa)).Dn||this.$.ih.GF?!1:!0:!0}Slk(Na,nb,Hb,na){R.ULS.sendTraceTag(507847637,0,100,"UnhideRowColButton.renderUnhideRowColButton: Unhide Skittle rendered");var Gb=nb?this.da.$Nb(Na):this.da.uib(Na);const Xa=za.EwaSettings.isChangeGateEnabled("OfficeVSO:8586521_UnhideSkittleCalloutRemoval");var Jb=Gb?Xa?this.da.JJd(Gb,!1):this.da.JJd(Gb,!0):null;Gb=this.da.hga.Pi.getBoundingClientRect();const qb=Ib.a();Jb&&Gb&&qb&&(nb?(Jb=Hb?Jb.y-this.nCa:Jb.y+Jb.height-this.nCa,
appChrome.renderUnhideRowColButton(this.domElement,Xa?Jb-Gb.top:Jb,Xa?Gb.width:qb.Pn(na?Gb.left:Gb.right),!0,this.Zsc,this.R7d,this.yog,nb,Na,Hb,na)):appChrome.renderUnhideRowColButton(this.domElement,Xa?Gb.height:qb.Pn(Gb.bottom),na?Xa?Hb?Jb.x-this.nCa+Jb.width:Jb.x-this.nCa:Hb?Jb.x+this.nCa+Jb.width:Jb.x+this.nCa:Hb?Jb.x-this.nCa:Jb.x+Jb.width-this.nCa,!0,this.Zsc,this.R7d,this.yog,nb,Na,Hb,na))}};ob=Object(d.__decorate)([Object(N.d)(M.tg),Object(d.__param)(0,Object(M.Lb)()),Object(d.__param)(1,
Object(M.dd)())],ob);Object(k.a)(ob,"UnhideRowColButton",null,[]);String(y);String(x);String(c);String(b);String(f);String(r);window.___1708742503507_closurehack=y;window.___1708742503507_closurehack=x;window.___1708742503507_closurehack=c;window.___1708742503507_closurehack=b;window.___1708742503507_closurehack=f;window.___1708742503507_closurehack=r}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.sho.js.map/e2bd6ff586a1fcc19ff6957c4c7eba51/EwaTS.sho.js.map