'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[25],{606:function(y,x,a){a.r(x);var c={};a.r(c);a.d(c,"SortCommandHandler",function(){return Eb});var b={};a.r(b);a.d(b,"SortUtil",function(){return ob});var f={};a.r(f);a.d(f,"TableCommandHandler",function(){return oc});var r={};a.r(r);a.d(r,"TableStyleManager",function(){return Ac});var d=a(179),k=a(0),t=a(14),m=a(86),e=a(253),w=a(26),l=a(69),u=a(65);class n{constructor(rc){this.options=null;this.options=rc}}Object(k.a)(n,
"MacroRecorderRangeCustomSortedPayload",null,[65]);var v=a(1196),B=a(1195),z=a(45),C=a(419),D=a(212),J=a(355),W=a(79),N=a(93),M=a(5),Q=a(97),R=a(161),O=a(40),U=a(35),K=a(252),F=a(1),I=a(209),P=a(27),Y=a(262),ea=a(24),Ba=a(961),Fa=a(932),za=a(422),xa=a(225),fa=a(12),V=a(187);class ba{constructor(rc){this.YC=fd=>{switch(fd){case 0:this.UU("Cancel");break;case 1:this.UU("Expand and sort");this.hvf(!0);break;case 2:this.UU("Just sort"),this.hvf(!1)}};this.hvf=rc}show(){const rc=new V.a;rc.Bh=11;rc.Yh(1,
fa.a.instance.ia(2126));rc.Yh(2,fa.a.instance.ia(2127));rc.gSg(fa.a.instance.ia(2125),fa.a.instance.Ba(658),this.YC)}UU(rc){t.ULS.sendTraceTag(594125219,0,50,`ExpandSortSelectionDialog: user operation: ${rc}`)}}Object(k.a)(ba,"ExpandSortSelectionDialog",null,[]);var la=a(1531);const Ta=(rc,fd)=>{rc=rc.ColumnInfo;switch(fd){case la.c.SortOnCellColor:return rc.CellColors&&rc.CellColors.length?!0:(t.ULS.sendTraceTag(508121568,0,10,"SharedSortConditionColorsOrIconsResultExtension.VerifyColumnInfo: sort on cell color result cell colors is null or there are no colors (must have at least 1)."),
!1);case la.c.SortOnFontColor:return rc.TextColors&&rc.TextColors.length?!0:(t.ULS.sendTraceTag(508121567,0,10,"SharedSortConditionColorsOrIconsResultExtension.VerifyColumnInfo: sort on font color result text colors is nullor there are no colors (must have at least 1)."),!1);case la.c.SortOnIcon:return rc.Icons&&rc.Icons.length?!0:(t.ULS.sendTraceTag(508121566,0,10,"SharedSortConditionColorsOrIconsResultExtension.VerifyColumnInfo: sort on icon result icons is nullor there are no icons (must have at least 1)."),
!1);default:return t.ULS.sendTraceTag(508121565,0,10,"SharedSortConditionColorsOrIconsResultExtension.VerifyColumnInfo: illeagl sort condition type."),!1}},Ea=(rc,fd,Ed,Rd)=>{rc=rc.HeaderColumnInfo;return Rd||rc?fd===la.e.SheetRange&&Ed?rc.CellColors&&1!==rc.CellColors.length?(t.ULS.sendTraceTag(508121563,0,10,"SharedSortConditionColorsOrIconsResultExtension.VerifyHeaderColumnInfo: headerColumnInfo.CellColors should be null or have exactly 1 color."),!1):rc.TextColors&&1!==rc.TextColors.length?(t.ULS.sendTraceTag(508121562,
0,10,"SharedSortConditionColorsOrIconsResultExtension.VerifyHeaderColumnInfo: headerColumnInfo.TextColors should be null or have exactly 1 color"),!1):rc.Icons&&1!==rc.Icons.length?(t.ULS.sendTraceTag(508121561,0,10,"SharedSortConditionColorsOrIconsResultExtension.VerifyHeaderColumnInfo: headerColumnInfo.Icons should be null or have exactly 1 icon"),!1):!0:rc?(t.ULS.sendTraceTag(508121564,0,10,`SharedSortConditionColorsOrIconsResultExtension.VerifyHeaderColumnInfo: headerColumnInfo should be null when range type is not SheetRange, or when headerRowSize${Ed} == 0.`),
!1):!0:!0};var sa=a(208);class Ya{static isValid(rc){return Ya.Iri.includes(rc.Position)?!0:(t.ULS.shipAssertTag(537159826,0,!1,`FillGradientStopExtension.IsValid: unexpected position value [${rc.Position}]`),!1)}}Ya.Iri=[0,.5,1];Object(k.a)(Ya,"FillGradientStopExtension",null,[]);class bb{constructor(rc,fd,Ed,Rd){new Sys.UI.Point(rc,fd);new Sys.UI.Point(Ed,Rd)}}Object(k.a)(bb,"GradientLine",null,[]);class ra{static isValid(rc){if(!(rc.Degree.toString()in ra.Dri))return t.ULS.shipAssertTag(537159829,
0,!1,`FillGradientExtension.IsValid: unexpected degree value [${rc.Degree}]`),!1;if(!rc.GradientStops)return t.ULS.shipAssertTag(537159828,0,!1,"FillGradientExtension.IsValid: no gradient stops"),!1;if(rc.GradientStops.length<ra.aEj||rc.GradientStops.length>ra.CCj)return t.ULS.shipAssertTag(537159827,0,!1,`FillGradientExtension.IsValid: unexpected number of gradient stops [${rc.GradientStops.length}]`),!1;for(const fd of rc.GradientStops)if(!Ya.isValid(fd))return!1;return!0}}ra.aEj=2;ra.CCj=3;ra.Dri=
{["0"]:new bb(0,0,1,0),["180"]:new bb(1,0,0,0),["90"]:new bb(0,0,0,1),["270"]:new bb(0,1,0,0),["45"]:new bb(0,0,1,1),["225"]:new bb(1,1,0,0),["135"]:new bb(1,0,0,1),["315"]:new bb(0,1,1,0)};Object(k.a)(ra,"FillGradientExtension",null,[]);const Da=rc=>rc.SortRange?rc.SortRangeType===la.e.Undefined?(t.ULS.sendTraceTag(537151622,0,10,`SharedSortInfoResultExtension.VerifySortRange: Unsupported sort range type: ${rc.SortRangeType}`),!1):rc.SortRangeType===la.e.SheetRange&&rc.SortTopToBottom&&(null==rc.HeaderRowSize||
0>rc.HeaderRowSize)?(t.ULS.sendTraceTag(537151621,0,10,"SharedSortInfoResultExtension.VerifySortRange: header row size must be equal or greater than 1, when range is sheetrange"),!1):!0:(t.ULS.sendTraceTag(537151623,0,10,"SharedSortInfoResultExtension.VerifySortRange: sort range is null"),!1),oa=rc=>{if(!rc.SortConditions)return!0;for(const fd of rc.SortConditions){if(!ka(rc,fd.RowColOffset))return t.ULS.sendTraceTag(537151620,0,10,`SharedSortInfoResultExtension.VerifySortConditions: offset [${fd.RowColOffset}] is out of bounds. sort range: ${rc.SortRange}`),
!1;if(fd.SortConditionType===la.c.SortOnCellColor&&fd.FillGradient&&!ra.isValid(fd.FillGradient))return t.ULS.sendTraceTag(537151619,0,10,"SharedSortInfoResultExtension.VerifySortConditions: sortCondition contains invalid fillGradient"),!1}return!0},Ha=rc=>{if(!rc.SortColumnInfoItems)return t.ULS.sendTraceTag(537151618,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: SortColumnInfoItems is null"),!1;var fd=new sa.a;for(var Ed of rc.SortColumnInfoItems){if(!ka(rc,Ed.ColumnOffset))return t.ULS.sendTraceTag(537151617,
0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: offset [${Ed.ColumnOffset}] is out of bounds. sort range: ${rc.SortRange}`),!1;if(!Ed.Name)return t.ULS.sendTraceTag(537151616,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: invalid column name for offset [${Ed.ColumnOffset}]`),!1;if(Ed.CellColors&&!Ed.CellColors.length)return t.ULS.sendTraceTag(537151587,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: cell colors are not null but length = [${Ed.CellColors.length}]`),!1;if(Ed.TextColors&&
!Ed.TextColors.length)return t.ULS.sendTraceTag(537151586,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: text colors are not null but length = [${Ed.TextColors.length}]`),!1;if(Ed.Icons&&!Ed.Icons.length)return t.ULS.sendTraceTag(537151585,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: icons are not null but length = [${Ed.Icons.length}]`),!1;fd.add(Ed.ColumnOffset)}if(rc.SortConditions)for(const Rd of rc.SortConditions)if(!fd.contains(Rd.RowColOffset))return t.ULS.shipAssertTag(537151584,
0,!1,`SharedSortInfoResultExtension.VerifyColumnInfo: missing column info item for sort condition [${Rd.RowColOffset}]`),!1;if(rc.HeaderColumnInfoItems){if(rc.HeaderColumnInfoItems.length!==rc.SortColumnInfoItems.length)return t.ULS.shipAssertTag(537151583,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo length doesn't match sort column info length"),!1;for(fd=0;fd<rc.HeaderColumnInfoItems.length;++fd){Ed=rc.HeaderColumnInfoItems[fd];if(Ed.ColumnOffset!==rc.SortColumnInfoItems[fd].ColumnOffset)return t.ULS.shipAssertTag(537151582,
0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo item offset doesn't match sort columnInfo item offset."),!1;if(Ed.CellColors&&1<Ed.CellColors.length)return t.ULS.sendTraceTag(537151581,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.CellColors is not null and has more than 1 background color"),!1;if(Ed.TextColors&&1<Ed.TextColors.length)return t.ULS.sendTraceTag(537151580,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.TextColors is not null and has more than 1 font color"),
!1;if(Ed.Icons&&1<Ed.Icons.length)return t.ULS.sendTraceTag(537151579,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.Icons is not null and has more than 1 icon"),!1}}return!0},ka=(rc,fd)=>{const Ed=rc.SortRange;rc=rc.SortTopToBottom?Ed.LastColumn-Ed.FirstColumn:Ed.LastRow-Ed.FirstRow;return 0<=fd&&fd<=rc};var wa=a(265),Za=a(150),ab=a(98),db=a(151);class mb extends wa.a{constructor(rc,fd){super(rc,fd);this.yYb=this.$Gd();this.Mv()}get ki(){return"SortMergedCellsErrorDialog"}aN(rc,
fd){if(1===rc){var Ed=z.w(this.yYb,this.$);ea.f(this.$).To(Ed,null,null,null,0,"SortErrorDialog.MergeCellRangeSelected")}Ed={["DialogButton"]:rc,["Location"]:"dialog"};db.b(this.$).lj(Za.a.IPk,Ed,null,!0);super.aN(rc,fd)}Mv(){super.Mv();const rc=this.GPk();this.Bh=1;this.Yh(1,fa.a.instance.ia(2245));this.Io(fa.a.instance.ia(2246),ab.a.zm(rc),1,this.X1)}GPk(){return String.format(fa.a.instance.$g(174),this.yYb.toString())}$Gd(){const rc=this.error.Description.split("_");return new w.Range(Number.parseInvariant(rc[1])+
1,Number.parseInvariant(rc[2])+1,Number.parseInvariant(rc[3])+1,Number.parseInvariant(rc[4])+1,!0,!1)}}Object(k.a)(mb,"SortMergedCellsErrorDialog",wa.a,[]);var Ia=a(75),pa=a(669),lb=a(717);class ha extends Ba.a{constructor(rc,fd,Ed,Rd){super(rc);this.KEc=this.qpe=!1;this.Cha=[];this.pdj=(Fe,Ae)=>{const We=this.F2h(Fe);this.r_a(214,(ve,Ze,Oe)=>J.t(this.$.pa.ta,We,this.cfb(ve,this.Kzi(Ae)),this.R3(Ze),Oe,null),16,!0)};this.odj=(Fe,Ae,We)=>{Fe=J.s(this.$.pa.ta,Ae,this.xAi(Ae,We),this.fRj,null,Fe);this.Cha.push(Fe)};
this.fRj=()=>{t.ULS.sendTraceTag(529105632,0,10,"CustomSortDialog.OnGetSortConditionColorsOrIconsRequestFailure: GetSortConditionColorsOrIcons request failed.");this.ctc(ha.FKb())};this.XLb=(Fe,Ae)=>{if(1===Fe){Fe=Ae.sortRangeType;const We={};We.SortOptions=Ae.sortOptions;We.ShouldRestoreSelection=this.qpe;We.SelectedRange=this.selectedRange;We.OriginalActiveCell=this.ROc;We.TopCellAddress=this.tZ;We.ShouldPromptNamedSheetViewTeachingDialog=Fe===la.e.Table||Fe===la.e.AutoFilterRange;ha.G$j(this.$,
We)}else this.qpe&&this.WBa(this.selectedRange,this.ROc)};this.b6i=(Fe,Ae)=>{this.qpe=!0;this.WBa(Fe,Ae)};this.getColorName=Fe=>Fa.a.YIa(xa.a.mM(Fe));t.ULS.shipAssertTag(529105669,0,!!fd.ActiveCell);t.ULS.shipAssertTag(529105668,0,!!fd.SelectedRange);t.ULS.shipAssertTag(529105667,0,z.G(fd.SelectedRange).contains(z.F(fd.ActiveCell)));t.ULS.shipAssertTag(529105666,0,P.a.equals(fd.SelectedRange.SheetName,fd.ActiveCell.SheetName,!0));this.jub=new lb.a(rc,pa.a.T7h,()=>this.KEc,1);this.selectedRange=fd.SelectedRange;
this.ROc=fd.ActiveCell;this.oPh=fd.ExpandSelection;this.oC=Ed;this.tZ=Rd;this.initializeAndShow(fa.a.instance.ia(181),this.XLb,this.AGa(fd))}dispose(){this.KEc||(this.KEc=!0,this.Xnc(),this.Cha=null,this.jub.dispose(),this.jub=null);super.dispose()}get ki(){return"CustomSortDialog"}get ha(){return ea.f(this.$).ha}Kzi(rc){return fd=>{K.b(fd,-901005882)?(Ia.a(this.$).ij.CL(-901005882),this.lce()):K.b(fd,-569193796)?(Ia.a(this.$).ij.CL(-569193796),this.hide(),new mb(this.$,fd.Errors[0])):K.a(fd)?(t.ULS.sendTraceTag(529105665,
0,10,"CustomSortDialog.GenerateGetSortInfoSuccessCallback: GetSortInfo result contains non-status messages"),this.hide()):(fd=fd.Result,this.$.Mq(fd.SortRange),fd&&Da(fd)&&oa(fd)&&Ha(fd)?rc(fd):this.ctc(ha.FKb()))}}xAi(rc,fd){return(Ed,Rd)=>{if(this.KEc)t.ULS.sendTraceTag(529105635,0,50,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: response was received after dialog is disposed");else if(!Ed||K.a(Ed))t.ULS.sendTraceTag(529105634,0,10,`CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: Unexpected error: ${U.a.Kh(Ed.Errors)}`),
this.$.ea.Yw(Ed.Errors),this.hide();else{Ed=Ed.Result;var Fe=rc.RangeType,Ae=rc.HeaderRowSize,We=rc.SortTopToBottom;Ed&&Ta(Ed,rc.ConditionType)&&Ea(Ed,Fe,Ae,We)?(Ed.ColumnInfo.ColumnOffset=Rd,void 0!==Ed.HeaderColumnInfo&&null!==Ed.HeaderColumnInfo&&(Ed.HeaderColumnInfo.ColumnOffset=Rd),fd(Ed,rc.ConditionType,rc.SortTopToBottom)):(t.ULS.sendTraceTag(529105633,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: sortConditionColorsOrIconsResult is not valid"),this.ctc(ha.FKb()))}}}F2h(rc){const fd=
{};fd.SelectedRange=this.selectedRange;fd.ActiveCell=this.ROc;fd.SortInfoMode=rc;fd.ExpandSortSelection=this.oPh;fd.ExpandSortSelectionSupported=!0;return fd}AGa(rc){const fd={};fd[za.a.fy]=this.ki;fd.fromAutoFilter=rc.FromAutoFilter;fd.gridRTL=ea.f(this.$).rtl;fd.activeCell=rc.ActiveCell;fd.selectedRange=rc.SelectedRange;fd.invokeGetSortInfo=this.pdj;fd.invokeGetSortConditionColorsOrIcons=this.odj;fd.highlightSortRange=this.b6i;fd.getColorName=this.getColorName;return fd}WBa(rc,fd){rc=z.G(rc);this.ha.qa.Ui.equals(rc)||
this.ha.updateSelection(rc,z.F(fd),0,void 0,void 0,void 0,!0)}lce(){(new ba(rc=>{const fd={};fd.ActiveCell=this.ROc;fd.SelectedRange=this.selectedRange;fd.ExpandSelection=rc;fd.FromAutoFilter=!1;this.$.ei(-207540907,l.a.eh,8,{["SortCommandData"]:fd})})).show()}Xnc(){if(void 0!==this.Cha&&null!==this.Cha)for(const rc of this.Cha)this.$.pa.ta.uxb(rc.TC)}static G$j(rc,fd){rc.ei(1659552324,l.a.eh,8,{["CustomSortCommandData"]:fd})}static FKb(){return U.a.Yi(1,0,26,0,1,-1517197771,"CustomSortValidationError")}}
Object(k.a)(ha,"CustomSortDialog",Ba.a,[]);var ua=a(1197);class fb{constructor(rc){this.selection=null;this.selection=rc}getSelection(){return this.selection}}Object(k.a)(fb,"MacroRecorderRangeAutoFilterClearedPayload",null,[65]);class Ka{constructor(rc){this.filterRange=null;this.filterRange=rc}}Object(k.a)(Ka,"MacroRecorderRangeFilterReappliedPayload",null,[65]);var La=a(62);const ib=(rc,fd,Ed,Rd,Fe,Ae,We)=>{We=rc.Za(41,void 0===We?null:We);We.options=fd;return La.h(rc,"Sort",We,Ed,Rd,Fe,Ae,0)},
Yb=(rc,fd,Ed,Rd,Fe,Ae,We)=>{We=rc.Za(41,void 0===We?null:We);We.selectedRange=fd;return La.h(rc,"ClearAutoFilter",We,Ed,Rd,Fe,Ae,0)},Wc=(rc,fd,Ed,Rd,Fe,Ae,We)=>{We=rc.Za(41,void 0===We?null:We);We.filterRange=fd;return La.h(rc,"ReapplyAutoFilter",We,Ed,Rd,Fe,Ae,0)};var Qc=a(935),Wb=a(948),Jc=a(140),ma=a(66),Hc=a(196),Kb=a(25),pc=a(524),$b=a(95),Ib=a(103),Zb;let Eb=Zb=class{constructor(rc,fd,Ed,Rd){Rd=void 0===Rd?null:Rd;this.sortOptions=this.p7a=this.selectedRange=null;this.KUf=!1;this.activeCell=
this.Pk=this.lh=this.Dh=null;this.ZX=F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NsvEntryOptimizationApplyForEveryone",!1);this.onContentReady=()=>{this.jzg(!1);const Fe=this.ha();Fe.qa.Gn&&Fe.qa.Ui.equals(this.p7a)&&(F.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")?Fe.updateSelection(this.selectedRange,z.F(this.activeCell),0,void 0,void 0,void 0,!0):Fe.updateSelection(this.selectedRange,Fe.qa.activeCell,0,void 0,void 0,void 0,!0))};
this.QQj=(Fe,Ae)=>{Fe&&!U.a.Jk(Fe.Errors)&&this.Dh&&(this.Dh.tx=Fe.Result,this.v5b(),this.applyPivotSort(Ae))};this.PQj=()=>{};this.jog=(Fe,Ae)=>{M.jg.Ha()?void Q.a.resolve(M.jg,{va:1}).then(We=>{We.RZg(Ae)}):O.TaskExtensions.Ua(W.GetServiceTaskFactory.Bj(this.$.ka,534,535,1),We=>{We.result.RZg(Ae)},this.$.xa,3)};this.$=rc;this.V2f="";this.oC=fd;this.GD=Ed;this.da=ea.f(this.$);this.uy=Kb.a.uy();this.qXd=F.EwaSettings.isChangeGateEnabled("OfficeVSO:8132807_TableHeaderRowUndoOperationFix");this.$.qh.Vl("LoadResource",
"LoadDialogControlsStopwatch");this.zEd=Rd}Mia(rc){if(F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!0)){var fd=Q.a.Zg(M.ke);fd&&fd.Mia(5,rc)}}Bi(rc,fd){return!this.uWd(rc,fd)}executeCommand(rc,fd,Ed){let Rd=null;rc=fd.command;if(this.uy){var Fe=this.$.sa.na;if(Fe&&Fe.name===pc.a.current.lU&&$b.c(this.$.Bk)){Fe=this.$.ka.Ug(237);const Ae=ea.f(this.$);Fe.Oaa(rc,Ae.ha.qa.activeCell)}}F.EwaSettings.isChangeGateEnabled("OfficeVSO:8202953_HomeTabCleanUpTelemetry")&&
"Home"===fd.tabName&&Ib.b("HomeTabSortAndFilter");switch(rc){case -864298118:Rd=this.fdi(fd,Ed);break;case -1010737776:Rd=this.gAd(!0,fd,Ed);break;case 2123420468:Rd=this.gAd(!1,fd,Ed);break;case -1089513346:Ed=this.SCf(Ed);if(!this.RVb([z.G(Ed.SortOptions.SelectedRange)]))return O.TaskExtensions.sq();Rd=this.Ymf(fd,Ed);break;case -1032691499:case -764711886:case -2016161444:Rd=this.I8j(fd,Ed);break;case -207540907:case -1677817820:Rd=this.da.Yg.aY(this.ha().qa.activeCell)?this.s8j():this.p8j(fd,
Ed);break;case 1659552324:Rd=this.Ymf(fd,this.SCf(Ed));break;case 368460465:Rd=this.vdi(fd,Ed);break;case 529856798:Rd=this.bdi(fd);break;case 644342024:Rd=this.rdi(fd)}return Rd||I.a(rc)}ni(rc,fd){if(rc=1===rc)switch(fd.command){case -864298118:case -1010737776:case 2123420468:case -1089513346:case -207540907:case -1677817820:case 1659552324:case 368460465:case 529856798:case 644342024:case -1032691499:case -764711886:case -2016161444:break;default:rc=!1}return rc}Ji(){return!1}ha(){return this.$&&
this.da?this.da.ha:null}jzg(rc){rc?this.da.Mz(this.onContentReady):this.da.xE(this.onContentReady);this.KUf=rc}get qa(){return this.ha().qa}TJk(rc){return!!this.sortOptions&&P.a.equals(this.V2f,rc.Vua,!0)}uWd(rc,fd){const Ed=ea.f(this.$).ha.qa.selectedRanges;return(new R.a(this.$.sa)).Pw(rc,fd,Ed,this.da)}gAd(rc,fd,Ed){Ed=this.ZCf(Ed,rc);return this.RVb([z.G(Ed.SelectedRange)])?this.da.Yg.aY(z.G(Ed.SelectedRange))?this.odi(rc):this.SRd(Ed,fd):O.TaskExtensions.sq()}fdi(rc,fd){t.ULS.shipAssertTag(520901652,
0,!1,"SortCommandHandler.doDefaultSort: using default sort");let Ed=null;const Rd=this.ha();Rd&&(this.TJk(Rd)?this.RVb(Rd.qa.selectedRanges)&&(this.sortOptions.IsAscending=!this.sortOptions.IsAscending,Ed=this.SRd(this.sortOptions,rc)):Ed=this.gAd(!0,rc,fd));return Ed}RVb(rc){return this.$.isEditMode?this.$.cy(rc,!0,1):this.$.apd(rc,!0,1)}odi(rc){this.wQi(rc);return ma.Task.Va(!0)}yLh(rc){if(F.EwaSettings.isChangeGateEnabled("OfficeVSO:4112173_MacroRecorderTableSortOnRange")){const fd=this.da.Yg.sl(this.qa.Ui,
!1);if(fd)return new B.a(fd.name,this.qa.activeCell.left-fd.usedRange.left,rc.IsAscending)}return new v.a(rc)}SRd(rc,fd){this.da.Um.MT(!1);const Ed=()=>this.yLh(rc);return this.ABd((Rd,Fe,Ae)=>ib(this.$.pa.ta,rc,Y.c(Rd,this.yAi(fd)),Fe,Ae,rc),Rd=>new D.a(141,0,Rd,void 0,Ed),fd,this.tIk(rc))}tIk(rc){if(!this.oC)return!1;const fd=this.qa.Ui,Ed=z.w(this.qa.Ui,this.$),Rd=this.da.Yg.bY(fd,!0),Fe=this.qa.aya()&&this.da.Yg.WVd(Ed),Ae=this.da.Yg.enj(Ed);rc=(fd.Daa||fd.I0)&&!fd.isSingle&&(null==rc.ExpandSortSelection?
!1:rc.ExpandSortSelection)&&this.da.Yg.WVd(Ed);return Rd||Fe||Ae||rc}s8j(){return this.$.ei(-1556797033,l.a.eh,8,null)}p8j(rc,fd){rc=8===rc.lk&&fd&&void 0!==fd[Zb.iwb]&&null!==fd[Zb.iwb]?fd[Zb.iwb]:19===rc.lk&&fd&&void 0!==fd[l.a.Wk]&&null!==fd[l.a.Wk]?u.a.Gp(fd[l.a.Wk]):this.K1h();if(!this.RVb([z.G(rc.SelectedRange)]))return O.TaskExtensions.sq();ea.f(this.$).Um.MT(!1);let Ed=null;(fd=fd.TopCellAddress)&&(Ed=z.p(fd,this.$));new ha(this.$,rc,this.oC,Ed);return ma.Task.Va(!0)}SCf(rc){return rc[Zb.S7h]}Ymf(rc,
fd){const Ed=Ae=>{this.VNf(Ae)?this.EMf(Ae.Errors[0]):(fd.ShouldRestoreSelection&&this.WBa(fd.SelectedRange,fd.OriginalActiveCell),t.ULS.sendTraceTag(537151576,0,50,`SortCommandHandler.DoCustomSort.onSortSuccessCallback: Custom Sort succeeded. Called from: ${rc.lk}`),this.GZk(fd),this.Mia(Ae))},Rd=()=>{fd.ShouldRestoreSelection&&this.WBa(fd.SelectedRange,fd.OriginalActiveCell);t.ULS.sendTraceTag(537151575,0,10,`SortCommandHandler.DoCustomSort.onSortFailedCallback: Custom Sort failed. Called from: ${rc.lk}`)},
Fe=()=>new n(fd.SortOptions);return this.ABd((Ae,We,ve)=>ib(this.$.pa.ta,fd.SortOptions,Y.c(Ae,Ed),Y.b(We,Rd),ve,this.sortOptions),Ae=>new D.a(187,0,Ae,void 0,Fe),rc,fd.ShouldPromptNamedSheetViewTeachingDialog)}WBa(rc,fd){rc=z.G(rc);ea.f(this.$).ha.qa.Ui.equals(rc)||ea.f(this.$).ha.updateSelection(rc,z.F(fd),0,void 0,void 0,void 0,!0)}K1h(){const rc={};rc.ActiveCell=z.p(this.qa.activeCell,this.$);rc.SelectedRange=z.w(this.qa.Ui,this.$);rc.FromAutoFilter=!1;rc.ExpandSelection=null;return rc}vdi(rc,
fd){const Ed=this.G$();if(!Ed)return ma.Task.Va(!1);let Rd;if(this.qXd&&(Rd=this.da.Yg.sl(this.qa.Ui,!0))&&!(Rd.attributes&16))return rc=new m.a(341449783,rc.method,rc.mode,rc.lk,"Table"),this.$.Ma.dh(rc);const Fe=this.$.pa.ta.Jh(),Ae=()=>new ua.a(Ed),We=ve=>{this.zEd.UAa(ve.Result,Rd?!0:!1,Rd?Rd.objectId:-1)};return C.a(this.$.userOperationManager,(ve,Ze,Oe)=>F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowFilteredResultsInStatusBar",!1)?J.G(this.$.pa.ta,Ed,Y.c(Qc.a.Jma(Jc.a.QUa,
Wb.a.toggleAutoFilter,ve),We,this.jog),Ze,Oe,{selection:Ed,FYg:fd.On},Fe):J.G(this.$.pa.ta,Ed,Y.c(Qc.a.Jma(Jc.a.QUa,Wb.a.toggleAutoFilter,ve),this.jog),Ze,Oe,{selection:Ed,FYg:fd.On},Fe),ve=>new D.a(516,0,ve,64,Ae),rc)}bdi(rc){const fd=this.G$();if(!fd)return ma.Task.Va(!1);const Ed=this.da.Yg.sl(this.qa.Ui,!0);Ed&&t.ULS.sendTraceTag(537151574,0,50,`DoClearAutoFilter for namedObject: Type : ${Ed.type.toString()}`);const Rd=this.$.pa.ta.Jh(),Fe=()=>new fb(fd),Ae=We=>{var ve;F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowFilteredResultsInStatusBar",
!1)&&(null===(ve=this.zEd)||void 0===ve?void 0:ve.UAa(We.Result,Ed?!0:!1,Ed?Ed.objectId:-1))};return this.ABd((We,ve,Ze)=>F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowFilteredResultsInStatusBar",!1)?Yb(this.$.pa.ta,fd,Y.c(Qc.a.Jma(Jc.a.gea,Wb.a.clearAutoFilter,We),Ae),ve,Ze,null,Rd):Yb(this.$.pa.ta,fd,Qc.a.Jma(Jc.a.gea,Wb.a.clearAutoFilter,We),ve,Ze,null,Rd),We=>new D.a(517,0,We,64,Fe),rc)}ABd(rc,fd,Ed,Rd){Rd=void 0===Rd?!0:Rd;const Fe=()=>C.a(this.$.userOperationManager,rc,fd,
Ed),Ae=this.$.ea.th.allowViewCollab&&F.EwaSettings.isChangeGateEnabled("OfficeVSO:8581585_NsvEntryExitOptimizationInRealTimeView");return Rd&&(this.ZX||Ae)?this.GD.PMa(Fe,null===Ed||void 0===Ed?void 0:Ed.lk,"SortCommandHandler::enqueueSortOrFilterOperation"):Rd&&this.oC?this.oC.W6a().continueWith(We=>{We.result&&Fe()}):Fe()}rdi(rc){const fd=this.G$();if(!fd)return ma.Task.Va(!1);const Ed=this.$.pa.ta.Jh(),Rd=()=>new Ka(fd),Fe=Ae=>{var We;F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowFilteredResultsInStatusBar",
!1)&&(null===(We=this.zEd)||void 0===We?void 0:We.UAa(Ae.Result,!1))};return C.a(this.$.userOperationManager,(Ae,We,ve)=>F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowFilteredResultsInStatusBar",!1)?Wc(this.$.pa.ta,fd,Y.c(Qc.a.Jma(Jc.a.gea,Wb.a.Wwg,Ae),Fe),We,ve,null,Ed):Wc(this.$.pa.ta,fd,Qc.a.Jma(Jc.a.gea,Wb.a.Wwg,Ae),We,ve,null,Ed),Ae=>new D.a(518,0,Ae,64,Rd),rc)}yAi(rc){return(fd,Ed)=>{var Rd;K.b(fd,-901005882)?(Ia.a(this.$).ij.CL(-901005882),this.lce(Ed,rc.command)):this.VNf(fd)?
this.EMf(fd.Errors[0]):!K.a(fd)&&fd.Result&&(this.sortOptions=Ed,this.p7a=z.G(fd.Result.ActualSortRange),this.V2f=this.ha().Vua,this.KUf||(this.selectedRange=this.qa.Ui,this.selectedRange.equals(this.p7a)||(F.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")&&(this.activeCell=z.p(this.qa.activeCell,this.$)),this.zNk())),(null===(Rd=this.sortOptions)||void 0===Rd?0:Rd.ActiveCell)&&this.yQg(this.sortOptions)&&(Ed=this.sortOptions.ActiveCell,Ed=new w.Range(Ed.FirstRow+
1,Ed.FirstColumn+1,Ed.FirstRow+1,Ed.FirstColumn+1,!0,!1),this.Qqa(Ed),this.mve(Ed)),this.Mia(fd))}}VNf(rc){return K.b(rc,-569193796)}EMf(rc){Ia.a(this.$).ij.CL(-569193796);new mb(this.$,rc)}lce(rc,fd){(new ba(Ed=>{const Rd={};Rd.ActiveCell=rc.ActiveCell;Rd.SelectedRange=rc.SelectedRange;Rd.ExpandSelection=Ed;this.$.ei(fd,l.a.eh,8,{[Zb.iwb]:Rd})})).show()}zNk(){const rc=this.ha();if(F.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")){let fd=z.F(this.activeCell);
this.p7a.pk(fd)||(fd=this.p7a.topLeft);rc.updateSelection(this.p7a,fd,0,void 0,void 0,void 0,!0)}else rc.updateSelection(this.p7a,rc.qa.activeCell,0,void 0,void 0,void 0,!0);this.jzg(!0)}G$(){const rc=this.ha();if(!rc)return t.ULS.shipAssertTag(537151573,0,!!rc,"SelectionManger is null"),null;this.da.Um.MT(!1);return z.w(rc.qa.Ui,this.$)}v5b(){this.Dh&&this.Dh.tx&&(this.Pk=this.Dh.tx,this.lh=this.Dh.qyc())}wQi(rc){if(this.$.isEditMode&&(this.Dh=this.da.Yg.Lw(this.qa.activeCell))){this.activeCell=
z.p(this.qa.activeCell,this.$);if(this.Dh&&this.Dh.tx){var fd=this.Dh.tx.CurrentCol;if(this.Dh.tx.CurrentRow===this.activeCell.FirstRow&&fd===this.activeCell.FirstColumn){this.v5b();this.applyPivotSort(rc);return}}fd=new D.a(228,0,(Ed,Rd,Fe)=>J.p(this.$.pa.ta,this.activeCell,Y.c(Ed,this.QQj),Y.b(Rd,this.PQj),Fe,rc),16);this.$.userOperationManager.enqueueOperation(fd,null)}}applyPivotSort(rc){if(this.Dh&&this.lh&&this.activeCell&&this.Pk){var fd=8===this.Pk.CellArea,Ed=1===this.Pk.CellArea||2===this.Pk.CellArea;
(fd||Ed)&&8!==this.Pk.CellType&&4!==this.Pk.CellType&&(fd?C.a(this.$.userOperationManager,(Rd,Fe,Ae)=>J.b(this.$.pa.ta,this.activeCell,rc?1:2,this.lh.Caption,Rd,Fe,Ae,null),Rd=>new D.a(1015,0,Rd,void 0,null),null):(fd=1===this.Pk.CellArea?1:2,F.EwaSettings.Ra(600)?e.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Dh.externalSourceIndex,this.lh.Index.toString(),this.lh.Caption,this.Dh.isOlap?"":this.lh.Caption,fd,rc):e.a.aps(this.$.domElement,this.activeCell.FirstRow,
this.activeCell.FirstColumn,this.Dh.externalSourceIndex,this.lh.Index.toString(),rc)))}}GZk(rc){this.yQg(rc.SortOptions)&&(rc.TopCellAddress?rc=z.F(rc.TopCellAddress):(rc=rc.OriginalActiveCell,rc=new w.Range(rc.FirstRow+1,rc.FirstColumn+1,rc.FirstRow+1,rc.FirstColumn+1,!0,!1)),this.Qqa(rc))}Qqa(rc){Kb.a.CKa(this.$)&&O.TaskExtensions.Ua(W.GetServiceTaskFactory.Bj(this.$.ka,430,431,1),fd=>{fd.result.EPa(rc);t.ULS.sendTraceTag(537151571,306,50,"SortCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},
this.$.xa,3)}mve(rc){F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",!1)&&O.TaskExtensions.Ua(Object(N.d)(Q.a.resolve(M.Qe,{va:0})),fd=>{fd.result.mve(rc,0);t.ULS.sendTraceTag(537151570,0,50,"SortCommandHandler:TriggerProactiveSuggestion Trigger proactive suggestion from sort.")},this.$.xa,3)}I8j(rc,fd){if(!this.RVb(this.qa.selectedRanges))return O.TaskExtensions.sq();fd=this.ZCf(fd);fd.SortConditions=[this.b5h(rc)];fd.OperationType=la.d.SortByColorOrIcon;
return this.SRd(fd,rc)}b5h(rc){const fd=this.da.kh(this.qa.activeCell),Ed={IsAscending:!0,RowColOffset:0,SortConditionType:la.c.SortOnValue,SortColor:0,SortIconSet:0,SortIcon:0};switch(rc.command){case -1032691499:fd.EZa?(rc=Hc.a.tu(fd.backgroundColor),Ed.SortColor=rc.$V(!0)):Ed.SortColor=Zb.NoColor;Ed.SortConditionType=la.c.SortOnCellColor;break;case -764711886:Ed.SortColor=fd.GJb===Zb.NoColor?Zb.NoColor:Hc.a.Bqd(fd.GJb);Ed.SortConditionType=la.c.SortOnFontColor;break;case -2016161444:fd.Hkb?(Ed.SortIcon=
fd.cell.EWb,Ed.SortIconSet=fd.FWb):(Ed.SortIcon=Zb.yBe,Ed.SortIconSet=Zb.yBe);Ed.SortConditionType=la.c.SortOnIcon;break;default:t.ULS.debugAssertTag(522723787,0,!1,"SortCommandHandler.createSortConditionsFromSelectedCell: ribbon command didn't match any of the case statements")}return Ed}ZCf(rc,fd){fd={OperationType:la.d.Default,IsAscending:void 0===fd?!0:fd,HasHeader:!0,GuessHeader:!0,SortTopToBottom:!0,ExpandSortSelectionSupported:!0,SelectedRange:null,ActiveCell:null,IsCaseSensitive:!1,SortConditions:null};
rc&&rc[Zb.iwb]?(rc=rc[Zb.iwb],fd.ActiveCell=rc.ActiveCell,fd.SelectedRange=rc.SelectedRange,fd.ExpandSortSelection=rc.ExpandSelection):(fd.ActiveCell=z.p(this.qa.activeCell,this.$),fd.SelectedRange=z.w(this.qa.Ui,this.$),fd.ExpandSortSelection=null);return fd}yQg(rc){return!rc.SortConditions||rc.SortConditions.some(fd=>fd.SortConditionType===la.c.SortOnValue)}};Eb.S7h="CustomSortCommandData";Eb.iwb="SortCommandData";Eb.yBe=-1;Eb.NoColor=0;Eb=Zb=Object(d.__decorate)([Object(Q.d)(M.Yf),Object(d.__param)(0,
Object(M.Lb)()),Object(d.__param)(1,Object(M.Qd)()),Object(d.__param)(2,Object(M.Zf)()),Object(d.__param)(3,Object(M.gc)())],Eb);Object(k.a)(Eb,"SortCommandHandler",null,[39]);let ob=class{constructor(){}k6h(rc,fd){new mb(rc,fd)}};ob=Object(d.__decorate)([Object(Q.d)(M.ag)],ob);Object(k.a)(ob,"SortUtil",null,[734]);var Na=a(188),nb=a(280),Hb=a(479),na=a(68),Gb=a(7);class Xa{constructor(rc,fd){this.autoFilterOptions=null;this.sortType=0;this.autoFilterOptions=rc;this.sortType=fd}}Object(k.a)(Xa,"MacroRecorderRangeColumnSortedOrFilteredPayload",
null,[65]);class Jb{constructor(rc){this.autoFilterOptions=null;this.autoFilterOptions=rc}}Object(k.a)(Jb,"MacroRecorderRangeItemFilteredPayload",null,[65]);var qb=a(1200),Db=a(189),gb=a(213),ya=a(58),Aa=a(54),sb=a(16);class nc{constructor(rc,fd){this.tableRange=this.tableRanges=null;this.styleIndex=0;this.tableRanges=rc;this.tableRange=z.m(rc.Ranges[0],rc.SheetName);this.styleIndex=fd}KQb(){return this.tableRange}}Object(k.a)(nc,"MacroRecorderTableStyleAppliedPayload",null,[65]);class Bb extends nc{constructor(rc,
fd,Ed,Rd){super(rc,Ed);this.isCreation=this.hasHeaders=!1;this.hasHeaders=fd;this.isCreation=Rd}}Object(k.a)(Bb,"MacroRecorderRangeFormatedAsTablePayload",nc,[]);class uc{constructor(rc,fd){this.tableRange=null;this.sampleTableId=-1;this.tableRange=z.m(rc.Ranges[0],rc.SheetName);this.sampleTableId=fd}KQb(){return this.tableRange}oIf(){return this.sampleTableId}}Object(k.a)(uc,"MacroRecorderSampleTableCreatedPayload",null,[65]);class Pc{constructor(rc,fd,Ed){this.description=this.title=this.tableRange=
null;this.tableRange=rc;this.title=fd;this.description=Ed}my(){return this.tableRange}getTitle(){return this.title}getDescription(){return this.description}}Object(k.a)(Pc,"MacroRecorderTableAltTextEditedPayload",null,[65]);class wd{constructor(rc,fd){this.newName=this.oldName=null;this.oldName=rc;this.newName=fd}}Object(k.a)(wd,"MacroRecorderTableRenamedPayload",null,[65]);class Md{constructor(rc){this.originalRange=null;this.originalRange=rc}}Object(k.a)(Md,"MacroRecorderTableResizedPayload",null,
[65]);class Nd{constructor(rc,fd,Ed){this.isPivotTable=!1;this.tableRange=null;this.optionType=0;this.tableRange=rc;this.optionType=fd;this.isPivotTable=Ed}KQb(){return this.tableRange}}Object(k.a)(Nd,"MacroRecorderTableStyleOptionToggledPayload",null,[65]);var ec=a(47);class gc{constructor(rc){this.tableName=null;this.tableName=rc}}Object(k.a)(gc,"MacroRecorderTableConvertedToRangePayload",null,[65]);var Mb=a(987);class sc{constructor(rc,fd,Ed,Rd){Rd=void 0===Rd?null:Rd;this.isQueryTable=!1;this.vv=
null;this.e_h=()=>{var Fe;null===(Fe=this.vv)||void 0===Fe?void 0:Fe.Ioc()};this.sharedSheetRange=fd;this.$=rc;this.np=this.$.qh.Vl("UserAction","ConvertToRangeManager");this.tableName=Ed;this.vv=Rd}Erb(){this.np.start();const rc=this.$.pa.ta.Jh();return Mb.i(this.$.pa.ta,this.sharedSheetRange,fd=>{this.showDialog(fd)},null,null,null,rc)}showDialog(rc){t.ULS.sendTraceTag(537151193,0,50,`ConvertToRangeManager.ShowDialog: Time taken to show Get IsRangeQueryTable is ${this.np.ii} milliseconds`);rc&&
!K.a(rc)&&((this.isQueryTable=rc.Result)?(rc=U.a.Yi(3,2,0,738,0,-66108047,"ConvertToRange"),O.TaskExtensions.Ua(ec.a(this.$).lp(rc),fd=>{t.ULS.sendTraceTag(537151192,0,50,`ConvertToRangeManager.ShowDialog: Time taken for User Input is ${this.np.ii} milliseconds`);0===fd.result&&this.d_h()},this.$.xa,11)):this.f_h());this.np.stop();t.ULS.sendTraceTag(537151191,0,50,`ConvertToRangeManager.ShowDialog: Total Time taken for complete operation is ${this.np.ii} milliseconds`)}k8e(){const rc={};rc.IsQueryTable=
this.isQueryTable;rc.Range=this.sharedSheetRange;return rc}d_h(){const rc=this.$.pa.ta;t.ULS.sendTraceTag(537151190,0,50,"Convert To Range initiated for Query Table");this.nTf(194,(fd,Ed,Rd)=>Mb.d(rc,this.k8e(),fd,Ed,Rd,null));t.ULS.sendTraceTag(537151189,0,50,"Convert To Range completed for Query Table")}f_h(){const rc=this.$.pa.ta;t.ULS.sendTraceTag(537151188,0,50,"Convert To Range initiated for Normal Table");this.nTf(193,(fd,Ed,Rd)=>Mb.c(rc,this.k8e(),F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowFilteredResultsInStatusBar",
!1)?Y.c(fd,this.e_h):fd,Ed,Rd,null),()=>new gc(this.tableName));t.ULS.sendTraceTag(537151187,0,50,"Convert To Range completed for Normal Table")}nTf(rc,fd,Ed){Ed=void 0===Ed?null:Ed;C.a(this.$.userOperationManager,fd,Rd=>new D.a(rc,0,Rd,void 0,Ed),null)}}Object(k.a)(sc,"ConvertToRangeManager",null,[]);var xd=a(1199),xb=a(1158);class Lb extends xb.a{constructor(rc,fd){super(rc);this.i8b=fd}get ki(){return"FormatAsTableDialog"}get oJ(){return 215}get dialogTitle(){return fa.a.instance.ia(732)}nt(){const rc=
z.t(this.Fla.TableRange);return()=>new Bb(rc,this.hasHeaders,this.i8b,!0)}UN(){const rc=z.t(this.Fla.TableRange),fd=this.Fla.HasTotalRow;return(Ed,Rd,Fe)=>Mb.h(this.$.pa.ta,rc,this.hasHeaders,!1,fd,this.i8b,Ed,Rd,Fe,null)}}Object(k.a)(Lb,"FormatAsTableReactDialog",xb.a,[]);var Rc=a(421);class nd extends Rc.a{constructor(rc){super(rc);this.nUk=(fd,Ed)=>{1===fd&&this.JZk(z.G(this.Bqg(Ed[nd.Qwg])))};this.Fma=fd=>{fd=this.ZJd(fd);return this.TGd(fd)};this.da=ea.f(rc);this.qa=this.da.ha.qa;this.UOc=this.da.Yg.sl(this.qa.activeCell).usedRange;
rc=this.iR(this.UOc.toString());this.initializeAndShow(fa.a.instance.ia(733),this.nUk,rc)}get ki(){return"ResizeTableDialog"}Bqg(rc){let fd,Ed;rc=rc.startsWith("=")?rc.substring(1,rc.length):rc;if((()=>{let Rd=z.ib(rc,this.$.sa);({sheetName:fd,range:Ed}=Rd);return Rd})().returnValue&&Ed){const Rd=z.w(Ed,this.$);Rd.SheetName=P.a.equals(fd,"",!0)?this.$.na.name:fd;return Rd}return null}iR(rc){return{[nd.sR]:"ResizeTableDialog",[nd.Qwg]:rc,["getInputErrorIfInvalid"]:this.Fma}}ZJd(rc){rc=this.Bqg(rc);
if(!rc)return 1;const fd=z.G(rc);return P.a.equals(rc.SheetName,this.$.na.sheetName,!0)&&this.UOc.top===fd.top&&this.UOc.yi(fd)?0:2}TGd(rc){let fd="";switch(rc){case 1:fd=fa.a.instance.ia(75);break;case 2:fd=ab.a.zm(fa.a.instance.ia(74))}return fd}JZk(rc){this.$.ei(-1400250766,l.a.eh,8,{["ResizeTableRange"]:rc,["OriginalTableRange"]:this.UOc})}}nd.sR="id";nd.Qwg="range";Object(k.a)(nd,"ResizeTableDialog",Rc.a,[]);class $d extends Rc.a{constructor(rc){super(rc);rc=ea.f(this.$);rc=rc.Yg.sl(rc.ha.qa.activeCell);
P.a.qm(rc.N7a)?this.P9d="":this.P9d=rc.N7a;P.a.qm(rc.O7a)?this.O9d="":this.O9d=rc.O7a;rc=this.iR(this.P9d,this.O9d);this.initializeAndShow(fa.a.instance.ia(742),this.eUk,rc)}get ki(){return"TableAltTextDialog"}eUk(rc,fd){1===rc&&(rc=fd[$d.KWk],fd=fd[$d.N$h],rc===this.P9d&&fd===this.O9d||this.$.ei(868579142,l.a.eh,8,{["Title"]:rc,["Description"]:fd}))}iR(rc,fd){return{["id"]:"TableAltTextDialog",["title"]:rc,["description"]:fd}}}$d.sR="id";$d.KWk="title";$d.N$h="description";Object(k.a)($d,"TableAltTextDialog",
Rc.a,[]);var Td=a(1198),He=a(437);Object(Q.b)(M.eg,{yk:"singleton"})(rc=>No(function*(){const fd=yield Q.a.resolve(M.Lb,rc),Ed=yield Q.a.resolve(M.hg,rc),Rd=yield Q.a.resolve(M.ig,rc),Fe=yield Q.a.resolve(M.Qd,rc),Ae=yield Q.a.resolve(M.Zf,rc),We=yield Q.a.resolve(M.gc,rc);Kb.a.rK()&&(yield Q.a.resolve(M.Gf,rc));return new oc(fd,Ed,Fe,Rd,Ae,We)}));class oc{constructor(rc,fd,Ed,Rd,Fe,Ae){Ae=void 0===Ae?null:Ae;this.menuId=null;this.iOa=-1;this.ZX=F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NsvEntryOptimizationApplyForEveryone",
!1);this.vv=null;this.Rlc=0;this.sortType=1;this.uYc=null;this.WMj=We=>{if(!K.a(We)){const Ze=ea.f(this.$);var ve=new w.Range(1,1,1,1,!0,!1);ve=z.w(ve,this.$);null!=We.Result&&(Ib.a("CreateSampleTable.NewSheet"),ve.SheetName=We.Result.toString());Ze.To(ve,null,null,null,0,"TableCommandHandler.OnCreateSampleTableDone")}};this.Oaa=(We,ve)=>{const Ze=ea.f(this.$);let Oe=void 0;switch(We){case -2058042992:case 504133448:case -798968736:case 477776686:Oe=ve.TopCellAddress;break;case -1400250766:Oe=ve.OriginalTableRange;
break;case -123538519:case 323142015:case 868579142:case 753331043:case 756677940:case 844144422:case -723113214:case 868579142:case -544558380:case 341449783:case 1544516694:case 2128797448:Oe=Ze.ha.qa.activeCell}Oe&&this.$.ka.Ug(237).Oaa(We,Oe)};this.Tng=()=>{this.wpa()};this.pYj=We=>{if(!(this.qa.hKa()||(!F.EwaSettings.isChangeGateEnabled("OfficeVSO:4124510_JsCrashOnToggleTableStyleOptionSuccessful")||K.a(We)||this.$_a())&&K.a(We)&&this.$_a())){We=this.qa.activeCell;var ve=this.qa.activeRange;
const Ze=this.Cj.Zv.usedRange;this.qXd&&this.oYj();2===this.iOa&&Db.g(this.Cj.Zv)&&We.bottom===Ze.bottom&&(ve=ve.Daa?new w.Range(ve.top-1,ve.left,ve.bottom-1,ve.right,!1,!0):new w.Range(ve.top,ve.left,ve.bottom-1,ve.right,!1,!0),We=ve.contains(We)?We:w.Range.gi(ve.bottom,We.left),ea.f(this.$).ha.updateSelection(ve,We,0,3))}};this.oYj=()=>{var We=this.qa.activeCell,ve=this.qa.activeRange,Ze=this.Cj.Zv.usedRange;0!==this.iOa||!Db.d(this.Cj.Zv)||We.top!==Ze.top||ve.left<Ze.left||ve.right>Ze.right||(Ze=
Db.a(this.Cj.Zv),ve=ve.Daa?new w.Range(ve.top+1,ve.left,ve.bottom+1,ve.right,!1,!0):new w.Range(ve.top+1,ve.left,ve.bottom,ve.right,!1,!0),We=Ze.contains(We)?We:w.Range.gi(Ze.top,We.left),ea.f(this.$).ha.updateSelection(ve,We,0,3))};this.KXj=We=>{K.a(We)?(t.ULS.sendTraceTag(594130062,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename failed due invalid user input"),this.$.jm()):t.ULS.sendTraceTag(594130061,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename successful")};this.JXj=
()=>{t.ULS.sendTraceTag(594130060,0,15,"TableManager.OnTableRenameFailure-Rename table failed");this.$.jm()};this.LXj=(We,ve)=>{var Ze={Rmc:0,Omc:0,range:0,LZc:!1},Oe="";ve&&(this.Qqa(ve),F.EwaSettings.isChangeGateEnabled("OfficeVSO:8475764_AutofilterRangeCompute")&&ve&&(Oe=this.Cj.my(ve)?Td.d:Td.c,Ze=Object(Td.a)(ea.f(this.$),ve,Oe)));K.b(We,-569193796)&&(Ia.a(this.$).ij.CL(-569193796),this.Mtj(We.Errors[0]));ve=void 0;F.EwaSettings.isChangeGateEnabled("OfficeVSO:8494257_FilterAndSortTelemetry")&&
this.Rlc&&(ve={["ApplyTableSortTime"]:performance.now()-this.Rlc,["SortType"]:this.sortType,["blocksWithTableInViewport"]:Ze.Rmc,["blockWithTableNotInViewport"]:Ze.Omc,["range"]:Ze.range,["FilterByValueType"]:Oe},F.EwaSettings.isChangeGateEnabled("OfficeVSO:8665655_AdditionalFilterAndSortTelemetry")&&(ve=Object.assign({},ve,{["tableExistsInClient"]:Ze.LZc})),ve=JSON.stringify(ve),t.ULS.sendTraceTag(507871958,0,20,`TableCommandHandler::ApplyTableSort Perf Telemetry : ${ve}`));if(F.EwaSettings.isChangeGateEnabled("OfficeVSO:8653981_captureApplyFilterAndSortIndag5e")){Ze=
!!We&&!!We.RequestTelemetryData;Oe=new He.a;const Nf=ea.f(this.$).nk;Nf.V0(this.uYc,We.StateId,Ze?We.RequestTelemetryData.EcsOperationDuration:0,Ze?We.RequestTelemetryData.EcsRequestDuration:0,Ze?We.RequestTelemetryData.WfeRequestDuration:0);Oe.Flc(ve);Nf.Zue(this.uYc,Oe)}this.Rlc=0};this.$=rc;this.Cj=fd;this.oC=Ed;this.GD=Fe;this.frame=this.$.frame;this.ha=ea.f(this.$).ha;this.qa=this.ha.qa;this.rK=Kb.a.rK();this.uy=Kb.a.uy();this.qXd=F.EwaSettings.isChangeGateEnabled("OfficeVSO:8132807_TableHeaderRowUndoOperationFix");
this.tableStyleManager=Rd;this.tableStyleManager.tAh(this.Tng);this.vv=Ae}Bi(rc,fd){switch(fd){case -544558380:return!(this.Cj&&this.qa.FI()&&!this.$_a()&&Db.d(this.Cj.Zv));case 1544516694:return!(this.Cj&&(this.qa.FI()?!this.$_a():this.qa.hKa()));case -697806646:case 323142015:return!this.qa.FI();case 341449783:case 2128797448:return F.EwaSettings.isChangeGateEnabled("OfficeVSO:6083078_HeaderAndTotalRowDisabledFix")?!(this.Cj&&(this.qa.FI()?!this.$_a():this.qa.hKa())):!(this.Cj&&this.Cj.rXd(this.qa.activeCell));
case -123538519:return!(this.qa.FI()&&this.tableStyleManager&&this.tableStyleManager.sXd());case 756677940:return!this.Sdj();case 753331043:case 2105103744:case -585683120:return!(this.tableStyleManager&&this.Tdj());case 844144422:return!this.qa.FI();case -723113214:return!this.qa.FI();case 1371713064:case 875133075:return!Kb.a.rK()||$b.l(this.$.Bk)}return!1}executeCommand(rc,fd,Ed){var Rd;rc=O.TaskExtensions.sq();const Fe=this.$.pa.ta;let Ae=null,We=1;const ve=fd.command,Ze=this.$.pa.ta.Jh();let Oe=
null;if(this.rK)switch(ve){case -2058042992:case 504133448:case -798968736:case 477776686:gb.e(this.$,Ed.TopCellAddress,ve,null);break;case -1400250766:gb.e(this.$,Ed.OriginalTableRange,ve,null);break;case -123538519:case 323142015:case 868579142:case 753331043:case 756677940:case 341449783:case 1544516694:case 2128797448:var Nf=ea.f(this.$);gb.e(this.$,Nf.ha.qa.activeCell,ve,null)}this.uy&&(Nf=this.$.sa.na)&&Nf.name===pc.a.current.lU&&$b.c(this.$.Bk)&&this.Oaa(ve,Ed);let Zf=!0;switch(ve){case -2058042992:const Vb=
u.a.Gp(Ed[l.a.Wk]);F.EwaSettings.isChangeGateEnabled("OfficeVSO:7010744_RegressionFix_MacroRecording_ClearFilterInAFMenu")&&!Vb.CriteriaType&&(Vb.CriteriaType=0);oc.EKg(this.$,Vb);const Cc=Qe=>{var Ca;null===(Ca=this.vv)||void 0===Ca?void 0:Ca.UAa(Qe.Result,"Table"===Vb.AutoFilterType,Vb.Id)};F.EwaSettings.MYf()&&Ed&&Ed.TopCellAddress&&(Zf=gb.g(this.$,Ed.TopCellAddress));Ae=(Qe,Ca,yb)=>F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowFilteredResultsInStatusBar",!1)?Mb.a(Fe,Vb,null,
null,!1,!1,!1,Y.c(Qc.a.Jma(Jc.a.gea,Wb.a.clearAutoFilter,Qe),Cc),Ca,yb,null):Mb.a(Fe,Vb,null,null,!1,!1,!1,Qc.a.Jma(Jc.a.gea,Wb.a.clearAutoFilter,Qe),Ca,yb,null);We=176;Oe=()=>new Jb(Vb);break;case 504133448:case -798968736:case 477776686:const rg=u.a.Gp(Ed[l.a.Wk]),yf=Ed.TopCellAddress;oc.EKg(this.$,rg);const jg=504133448===fd.command?1:-798968736===fd.command?2:3;F.EwaSettings.isChangeGateEnabled("OfficeVSO:8494257_FilterAndSortTelemetry")&&(this.Rlc=performance.now(),this.sortType=jg);if(yf){Ed=
this.Cj.my(yf);if(!Ed){var Rb=this.$.sa.na;(null===(Rd=z.G(Rb.WK))||void 0===Rd?0:Rd.contains(yf))?Ed=z.G(Rb.WK):t.ULS.sendTraceTag(527700033,0,15,"TableCommandHandler.executeCommand: unknown sort range; unable to check for protected ranges")}if(!this.$.isEditMode){if(Ed&&!this.$.apd([Ed],!0,1))break}else if(Ed&&!this.$.cy([Ed],!0,1))break}F.EwaSettings.isChangeGateEnabled("OfficeVSO:8653981_captureApplyFilterAndSortIndag5e")&&(this.uYc=Na.a.create().toString(),ea.f(this.$).nk.KP(22,this.uYc,Hb.a(fd.command)));
Ae=(Qe,Ca,yb)=>La.I(Fe,rg,jg,Y.c(Qe,this.LXj),Ca,yb,yf,Ze);We=177;Oe=()=>new Xa(rg,jg);break;case 341449783:case 2128797448:this.iOa=341449783===ve?0:2;({nQa:Ae,operationName:We,nt:Oe}=this.toggleTableStyleOption(Fe,Ze));break;case -712419744:this.kdj(Ed[Gb.a.event]);break;case 875133075:case 1371713064:const If=z.s(this.qa.selectedRanges,this.$);if(!If)break;const cf=this.oIf(Ed);Ae=(Qe,Ca,yb)=>Mb.e(Fe,If,cf,Y.c(Qe,this.WMj),Ca,yb,null,Ze);Oe=()=>new uc(If,cf);We=1025;break;case 1868184698:if(F.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&
({OTb:Rd,nQa:Ae,nt:Oe}=this.m_g(null,Ze),Rd)){We=206;break}new xd.a(this.$);break;case 844144422:new nd(this.$);break;case 1544516694:case -544558380:if(Rd=Ed[l.a.Ai])this.iOa=this.cWi(Rd),-1!==this.iOa&&({nQa:Ae,operationName:We,nt:Oe}=this.toggleTableStyleOption(Fe,Ze));break;case 756677940:if(this.$_a()&&this.mZf()){t.ULS.sendTraceTag(537151177,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while executing rename command");break}const Nb=
Ed.Text,Bc=this.HMi();if(Bc){Ae=(Ca,yb,wc)=>Mb.j(Fe,Nb,Bc,Y.c(Ca,this.KXj),Y.b(yb,this.JXj),wc,Ze);We=217;let Qe=null;this.Cj.Zv?Qe=this.Cj.Zv.name:this.Cj.Ebe?Qe=this.Cj.Ebe.name:t.ULS.sendTraceTag(537151176,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while fetching oldName during executing rename command");Qe&&(Oe=()=>new wd(Qe,Nb))}else return t.ULS.sendTraceTag(537151175,0,10,"TableCommandHandler.RenameTable: Selected Table Range is null"),
ma.Task.Va(!1);break;case 323142015:if(this.$_a())break;return(new sc(this.$,this.mHd(),this.Cj.Zv.name,this.vv)).Erb();case -1400250766:We=211;Ae=this.spk(Ed,Fe,Ze);const Ob=z.n(Ed.OriginalTableRange,this.$.sa.na);Oe=()=>new Md(Ob);break;case 1872288872:this.Cj.T9j();break;case -123538519:const zc=this.bWi(Ed);Rd=P.a.contains(Ed[l.a.Ai],Gb.a.v1b,!0)||P.a.contains(Ed[Gb.a.FE],"TableStyleIcon",!0)?"Preview Gallery":"Pop-out Gallery";t.ULS.sendTraceTag(51181323,0,50,`TableStyleManager.ApplyTableStyleWebInvocation - Apply Table Style Invoked from ${Rd} with style index ${zc.toString()}`);
const od=this.DIf();od&&(Ae=(Qe,Ca,yb)=>Mb.b(Fe,od,zc,Qe,Ca,yb,null,Ze),Oe=()=>new nc(od,zc),We=212);break;case 753331043:F.EwaSettings.isChangeGateEnabled("OfficeVSO:8202953_HomeTabCleanUpTelemetry")&&"Home"===fd.tabName&&Ib.b("HomeTabFormatAsTable");Rd=Ed[l.a.Ai];if(!Rd)break;const ce=Number.parseInvariant(Rd);if(this.qa.FI()){t.ULS.sendTraceTag(51181321,0,50,`TableCommandHandler.FormatAsTable invoked on existing table with style index: ${ce}`);const Qe=this.DIf();Qe&&(Ae=(Ca,yb,wc)=>Mb.h(Fe,Qe,
!1,!1,!1,ce,Ca,yb,wc,null,Ze),Oe=()=>new Bb(Qe,!1,ce,!1),We=215);break}if(F.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&({OTb:Ed,nQa:Ae,nt:Oe}=this.m_g(ce,Ze),Ed)){We=215;break}t.ULS.sendTraceTag(51181322,0,50,`TableCommandHandler.FormatAsTable invoked on newly created table with style index: ${ce}`);new Lb(this.$,Number.parseInvariant(Rd));break;case 71074531:const Qb=Ed.HasHeader;Rd=Ed.TableRange;const Xc=null!==(Rb=Ed.StyleIndex)&&void 0!==Rb?Rb:22,md=z.t(Rd);Ae=
(Qe,Ca,yb)=>Mb.h(Fe,md,Qb,!1,!1,Xc,Qe,Ca,yb,null,Ze);Oe=()=>new Bb(md,Qb,Xc,!0);We=206;break;case -723113214:new $d(this.$);break;case 868579142:t.ULS.sendTraceTag(526463700,0,50,"AltText on table changed.");We=1022;const ie=Ed.Title,me=Ed.Description,Pe=this.mHd();Ae=(Qe,Ca,yb)=>Mb.g(Fe,ie,me,Pe,Qe,Ca,yb,null);let gf,tf;this.Cj.Zv&&(gf=P.a.qm(this.Cj.Zv.N7a)?"":this.Cj.Zv.N7a,tf=P.a.qm(this.Cj.Zv.O7a)?"":this.Cj.Zv.O7a);Oe=ie==gf?()=>new Pc(Pe,void 0,me):me==tf?()=>new Pc(Pe,ie,void 0):()=>new Pc(Pe,
ie,me);break;default:return I.a(ve)}if(Ae){const Vb=rg=>new D.a(We,0,rg,177===We&&Zf?128:void 0,Oe),Cc=()=>C.a(this.$.userOperationManager,Ae,Vb,fd);-2058042992===ve||504133448===ve||-798968736===ve||477776686===ve?(rc=this.$.ea.th.allowViewCollab&&F.EwaSettings.isChangeGateEnabled("OfficeVSO:8581585_NsvEntryExitOptimizationInRealTimeView"),rc=this.ZX||rc?this.GD.PMa(Cc,null===fd||void 0===fd?void 0:fd.lk,"TableCommandHandler::executeCommand"):this.oC?this.oC.W6a().continueWith(rg=>{rg.result&&Cc()}):
Cc()):rc=Cc()}return rc}toggleTableStyleOption(rc,fd){const Ed=this.qa.hKa();t.ULS.sendTraceTag(41996800,0,50,`TableCommandHandler: The selected ${Ed?"PivotTable":"table"} style option ${this.iOa} was toggled.`);const Rd=this.mHd();return{nQa:(Fe,Ae,We)=>Mb.l(rc,Rd,this.iOa,Y.c(Fe,this.pYj),Ae,We,null,fd),operationName:196,nt:()=>new Nd(Rd,this.iOa,Ed)}}spk(rc,fd,Ed){const Rd=rc.OriginalTableRange,Fe=z.n(rc.ResizeTableRange,this.$.sa.na),Ae=()=>{this.Cj.OWg(Rd)},We=ve=>{ve.Errors&&this.Cj.OWg(Rd)};
return(ve,Ze,Oe)=>Mb.k(fd,Fe,Y.c(ve,We),Y.b(Ze,Ae),Oe,null,Ed)}bWi(rc){var fd=-1;rc[l.a.Ai]&&(fd=rc[l.a.Ai],fd=P.a.contains(fd,Gb.a.v1b,!0)?this.tableStyleManager.XPb(fd):Number.parseInvariant(rc[l.a.Ai]));return fd}oIf(rc){return(rc=rc[l.a.Ai])?Number.parseInvariant(rc):0}ni(rc,fd){rc=!1;switch(fd.command){case -2058042992:case 504133448:case -798968736:case 477776686:case 341449783:case 2128797448:case -712419744:case 1868184698:case 1872288872:case 323142015:case 1544516694:case -544558380:case -1400250766:case -123538519:case 753331043:case 844144422:case 71074531:case -723113214:case 756677940:case 868579142:rc=
!0;break;case 875133075:case 1371713064:rc=Kb.a.rK()}return rc}Ji(rc,fd,Ed){rc=!1;switch(fd){case "PopulateTableMoreStylesMenu":this.menuId=Ed.MenuId;this.tableStyleManager.sXd()||this.tableStyleManager.hkb("formatAsTableMenu");rc=this.tableStyleManager.nsg(fd,Ed);break;case "PopulateTableAccessibleStylesMenu":this.menuId=Ed.MenuId,this.tableStyleManager.sXd()||this.tableStyleManager.hkb("accessibilityTab"),rc=this.tableStyleManager.nsg(fd,Ed)}return rc}dispose(){this.tableStyleManager.Dkk(this.Tng)}wpa(){(P.a.contains(this.menuId,
"Format",!0)||P.a.contains(this.menuId,"Accessible",!0))&&this.menuId&&this.frame.wA(this.menuId)}mHd(){return z.w(this.qa.activeCell,this.$)}HMi(){const rc=this.Cj.ZYd;return rc?z.w(rc,this.$):null}kdj(rc){if(this.Cj){var fd=ea.f(this.$),Ed=this.qa.activeCell,Rd=this.Cj.my(Ed),Fe=null;if(!Rd||Rd.o7a){for(const Ae of fd.T3)for(const We of Ae)fd=We.iD,Ed.left>=fd[0]&&Ed.left<=fd[fd.length-1]&&(Fe=(fd=We.WA(Ed).HO())?sb.DOMElementExtensions.Uu(fd,na.a):null);Fe&&ya.a.instance.create(()=>{sb.DOMElementExtensions.JDc(Fe,
null)},0,Aa.a.IWg,!0,!0)}else{const Ae=fd.kh(w.Range.gi(Rd.top,Ed.left));ya.a.instance.create(()=>{Ae.invoke(8,rc)},0,Aa.a.IWg,!0,!0)}}}cWi(rc){rc=Number.parseInvariant(rc);return-1<rc&&8>=rc?rc:-1}$_a(){return!this.Cj.Zv}mZf(){return this.Cj.Ebe?!1:(t.ULS.sendTraceTag(537151173,0,15,"TableCommandHandler.IsPreviousSelectedTableObjectNull PreviousSelectedTableObject is null"),!0)}Tdj(){const rc=this.qa.FI(),fd=this.qa.Gn&&!ea.f(this.$).Yg.yaa(this.qa.Ui);return rc||fd}Sdj(){return this.qa.FI()||!this.mZf()}eWi(rc){const fd=
[];for(const Ed of rc)if(rc=gb.b(this.$,Ed),null===rc||void 0===rc?0:rc.length)for(const Rd of rc)Rd.usedRange&&!fd.includes(Rd.usedRange)&&fd.push(Rd.usedRange);return fd}DIf(){const rc=this.qa.selectedRanges;let fd=[];if(F.EwaSettings.isChangeGateEnabled("OfficeVSO:3987000_ApplyTableStylesOnMultipleTablesInSingleRange"))fd=this.eWi(rc);else for(const Ed of rc)ea.f(this.$).Yg.yaa(Ed)&&fd.push(Ed);return fd&&fd.length?z.s(fd,this.$):null}Qqa(rc){Kb.a.CKa(this.$)&&O.TaskExtensions.Ua(W.GetServiceTaskFactory.Bj(this.$.ka,
430,431,1),fd=>{fd.result.EPa(rc);t.ULS.sendTraceTag(537151172,306,50,"TableCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.xa,3)}Mtj(rc){void Q.a.resolve(M.ag,{va:0}).then(fd=>{fd.k6h(this.$,rc)})}static EKg(rc,fd){fd.SheetName=rc.na.name;fd.NamedObjectView=rc.ea.isNamedObjectViewMode}m_g(rc,fd){let Ed,Rd;if(!this.qa.Gn||1!=this.qa.Ui.cz)return{OTb:!1,nQa:Ed,nt:Rd};const Fe=z.w(this.qa.Ui,this.$);Fe.LastColumn=Fe.FirstColumn+3-1;Fe.LastRow=Fe.FirstRow+4-1;const Ae=
z.G(Fe),We=ea.f(this.$);if(!Ae.nD||!We.Yg.FKa(Ae))return{OTb:!1,nQa:Ed,nt:Rd};nb.a.UU("XLS-CreateTableInEmptyCell-Treatment;XLS-CreateTableInEmptyCell-Control");if(!F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateTableInEmptyCell",!1))return{OTb:!1,nQa:Ed,nt:Rd};if(null==rc)Ed=(ve,Ze,Oe)=>Mb.f(this.$.pa.ta,Fe,!1,!1,!1,ve,Ze,Oe,fd),Rd=()=>new qb.a(!1,Fe);else{const ve=z.t(Fe);Ed=(Ze,Oe,Nf)=>Mb.h(this.$.pa.ta,ve,!1,!1,!1,rc,Ze,Oe,Nf,fd);Rd=()=>new Bb(ve,!1,rc,!0)}return{OTb:!0,nQa:Ed,
nt:Rd}}}Object(k.a)(oc,"TableCommandHandler",null,[39]);var ld=a(2),id=a(94),fc=a(984),vc=a(1550),Tc=a(907),Bd=a(1187),Fd=a(38),le=a(162),dc=a(129),Uc=a(199);a(31);class kb{}Object(k.a)(kb,"TableStyleElement",null,[]);var rb=a(101),cc=a(612);class mc{static e7f(rc,fd){return mc.RWg[rc.Type]-mc.RWg[fd.Type]}static Mjb(rc,fd){try{return appChrome.buildTableStyleGalleryIconNew(mc.jPa,mc.mBa,rc,fd)}catch(Ed){return null}}static Z_f(rc){return rc&&l.a.Ai in rc&&(rc=rc[l.a.Ai])?P.a.aL(rc,Gb.a.v1b):!1}static vGa(rc){const fd=
[];let Ed=0;for(const Rd of rc){fd[Ed]={};fd[Ed].backgroundColor="white";fd[Ed].color="black";for(const Fe in Rd)switch(rc=Rd[Fe],Fe){case "background-color":fd[Ed].backgroundColor=rc;break;case "color":fd[Ed].color=rc;break;case "font-size":fd[Ed].fontSize=rc;break;case "border-bottom":fd[Ed].borderBottom=rc;break;case "border-right":fd[Ed].borderRight=rc;break;case "border-left":fd[Ed].borderLeft=rc;break;case "border-top":fd[Ed].borderTop=rc}Ed++}return fd}static fqc(rc,fd){const Ed=[];if(null===
rc||void 0===rc?0:rc.TableStyleElementsList){var Rd=0===rc.Category;for(let Fe=0;Fe<mc.mBa;Fe++)Ed.push(...mc.AGi(rc,fd,Rd,Fe))}else{if(mc.Wyd)return mc.Wyd;rc={color:"black","background-color":"white"};for(fd=0;fd<mc.mBa;fd++)for(Rd=0;Rd<mc.jPa;Rd++)Ed.push(rc);mc.Wyd=Ed}return Ed}static aWi(rc,fd){if(!rc.TableStyleElementsList)return"";let Ed="";for(const Rd of rc.TableStyleElementsList)if(Rd.BackgroundColor&&"#000000"!==Rd.BackgroundColor)switch(Rd.Type){case 0:Ed=Rd.BackgroundColor;break;case 5:case 7:if(fd.xua||
fd.E1)Ed=Rd.BackgroundColor;break;case 3:case 4:if(fd.firstCol||fd.lastCol)Ed=Rd.BackgroundColor;break;case 2:fd.totalRow&&(Ed=Rd.BackgroundColor);break;case 1:fd.headerRow&&(Ed=Rd.BackgroundColor)}return Ed}static npc(rc){rc=new xa.a(parseInt(String("0x"+rc.substr(1,2)),16),parseInt(String("0x"+rc.substr(3,2)),16),parseInt(String("0x"+rc.substr(5,2)),16));return Fa.a.YIa(rc)}static yJf(rc,fd){if(!rc||!fd)return"";fd=(fd=mc.aWi(rc,fd))?mc.npc(fd)+", ":fa.a.instance.ia(2070)+", ";switch(rc.Index){case 0:return fd+
fa.a.instance.ia(2004);case 1:return fd+fa.a.instance.ia(2005);case 2:return fd+fa.a.instance.ia(2006);case 3:return fd+fa.a.instance.ia(2007);case 4:return fd+fa.a.instance.ia(2008);case 5:return fd+fa.a.instance.ia(2009);case 6:return fd+fa.a.instance.ia(2010);case 7:return fd+fa.a.instance.ia(2011);case 8:return fd+fa.a.instance.ia(2012);case 9:return fd+fa.a.instance.ia(2013);case 10:return fd+fa.a.instance.ia(2014);case 11:return fd+fa.a.instance.ia(2015);case 12:return fd+fa.a.instance.ia(2016);
case 13:return fd+fa.a.instance.ia(2017);case 14:return fd+fa.a.instance.ia(2018);case 15:return fd+fa.a.instance.ia(2019);case 16:return fd+fa.a.instance.ia(2020);case 17:return fd+fa.a.instance.ia(2021);case 18:return fd+fa.a.instance.ia(2022);case 19:return fd+fa.a.instance.ia(2023);case 20:return fd+fa.a.instance.ia(2024);case 21:return fd+fa.a.instance.ia(2025);case 22:return fd+fa.a.instance.ia(2026);case 23:return fd+fa.a.instance.ia(2027);case 24:return fd+fa.a.instance.ia(2028);case 25:return fd+
fa.a.instance.ia(2029);case 26:return fd+fa.a.instance.ia(2030);case 27:return fd+fa.a.instance.ia(2031);case 28:return fd+fa.a.instance.ia(2032);case 29:return fd+fa.a.instance.ia(2033);case 30:return fd+fa.a.instance.ia(2034);case 31:return fd+fa.a.instance.ia(2035);case 32:return fd+fa.a.instance.ia(2036);case 33:return fd+fa.a.instance.ia(2037);case 34:return fd+fa.a.instance.ia(2038);case 35:return fd+fa.a.instance.ia(2039);case 36:return fd+fa.a.instance.ia(2040);case 37:return fd+fa.a.instance.ia(2041);
case 38:return fd+fa.a.instance.ia(2042);case 39:return fd+fa.a.instance.ia(2043);case 40:return fd+fa.a.instance.ia(2044);case 41:return fd+fa.a.instance.ia(2045);case 42:return fd+fa.a.instance.ia(2046);case 43:return fd+fa.a.instance.ia(2047);case 44:return fd+fa.a.instance.ia(2048);case 45:return fd+fa.a.instance.ia(2049);case 46:return fd+fa.a.instance.ia(2050);case 47:return fd+fa.a.instance.ia(2051);case 48:return fd+fa.a.instance.ia(2052);case 49:return fd+fa.a.instance.ia(2053);case 50:return fd+
fa.a.instance.ia(2054);case 51:return fd+fa.a.instance.ia(2055);case 52:return fd+fa.a.instance.ia(2056);case 53:return fd+fa.a.instance.ia(2057);case 54:return fd+fa.a.instance.ia(2058);case 55:return fd+fa.a.instance.ia(2059);case 56:return fd+fa.a.instance.ia(2060);case 57:return fd+fa.a.instance.ia(2061);case 58:return fd+fa.a.instance.ia(2062);case 59:return fd+fa.a.instance.ia(2063);default:return rc.Name?rc.Name:""}}static UOi(rc){return(rc+1)%mc.Y6i}static MQb(rc,fd,Ed){Ed=void 0===Ed?"":
Ed;return rc||!Ed?`${mc.mQf}, ${rc.Index.toString()}, -version, ${fd.toString()}`:`${mc.mQf}, ${Ed}, -version, ${fd.toString()}`}static AGi(rc,fd,Ed,Rd){const Fe=[];for(let Ae=0;Ae<mc.jPa;Ae++)Fe.push(mc.tId(rc,fd,Ed,Rd,Ae));return Fe}static tId(rc,fd,Ed,Rd,Fe){rc=rc.TableStyleElementsList;let Ae=new kb;const We={};if(!rc)return We;for(var ve of rc)if(0===ve.Type){Ae=ve;break}ve=!!Ae.BackgroundColor;let Ze="";!Ed&&Ae.TableStyleBorderFromatList&&0<Ae.TableStyleBorderFromatList.length&&(Ze=Ae.TableStyleBorderFromatList[0].Color);
We["background-color"]=ve?Ae.BackgroundColor:"#FFFFFF";Ae.FontColor||(Ae.FontColor="#000000");We.color=Ae.FontColor;mc.Qaf(Rd,Fe,We,Ae,Ze,Ed,ve);for(const Oe of rc)Oe&&0!==Oe.Type&&(2!==Oe.Type||ve||(Oe.BackgroundColor=Ae.BackgroundColor),mc.kXd(Oe,Rd,Fe,fd)&&(Oe.BackgroundColor&&(We["background-color"]=Oe.BackgroundColor),We.color=Oe.FontColor||Ae.FontColor,mc.Qaf(Rd,Fe,We,Oe,Ze,Ed,ve)));return We}static f5(rc,fd,Ed,Rd,Fe,Ae){Ed&&(Ed.Color&&!Ed.Style&&(Ed.Style=1),Ed.Style&&!Ed.Color&&(Ed.Color=
Fe?"#000000":Rd?Rd:Ae?"#FFFFFF":"#000000"),fd[mc.borders[rc]]="1px "+mc.Kaa[Ed.Style]+" "+Ed.Color)}static kXd(rc,fd,Ed,Rd){return-1===rc.Type?!1:mc.mXd(rc,fd,Ed,Rd)||mc.spj(rc,fd,Ed,Rd)||mc.nXd(rc,fd,Ed,Rd)}static spj(rc,fd,Ed,Rd){return!fd&&Rd.headerRow||fd===mc.mBa-1&&Rd.totalRow?!1:1===fd%2&&5===rc.Type&&Rd.E1&&Rd.headerRow||1<fd&&!!((fd-1)%(rc.BandSize+1))&&6===rc.Type&&Rd.E1&&Rd.headerRow||!(fd%2)&&5===rc.Type&&Rd.E1&&!Rd.headerRow||!!(fd%(rc.BandSize+1))&&6===rc.Type&&Rd.E1&&!Rd.headerRow||
!(Ed%2)&&7===rc.Type&&Rd.xua||!!(Ed%(rc.BandSize+1))&&8===rc.Type&&Rd.xua}static nXd(rc,fd,Ed,Rd){return fd===mc.mBa-1&&2===rc.Type&&Rd.totalRow||Ed===mc.jPa-1&&fd===mc.mBa-1&&12===rc.Type&&Rd.totalRow&&Rd.lastCol||!Ed&&fd===mc.mBa-1&&11===rc.Type&&Rd.totalRow&&Rd.firstCol||Ed===mc.jPa-1&&4===rc.Type&&Rd.lastCol}static mXd(rc,fd,Ed,Rd){return!fd&&1===rc.Type&&Rd.headerRow||!Ed&&3===rc.Type&&Rd.firstCol||!Ed&&!fd&&9===rc.Type&&Rd.headerRow&&Rd.firstCol||Ed===mc.jPa-1&&!fd&&10===rc.Type&&Rd.headerRow&&
Rd.lastCol}static Qaf(rc,fd,Ed,Rd,Fe,Ae,We){if(Rd.TableStyleBorderFromatList)for(const ve of Rd.TableStyleBorderFromatList)if(ve.Style)switch(ve.Position){case 0:rc&&12!==Rd.Type&&11!==Rd.Type&&2!==Rd.Type&&5!==Rd.Type&&6!==Rd.Type||mc.f5(0,Ed,ve,Fe,Ae,We);break;case 1:rc!==mc.mBa-1&&1!==Rd.Type&&10!==Rd.Type&&9!==Rd.Type&&5!==Rd.Type&&6!==Rd.Type||mc.f5(1,Ed,ve,Fe,Ae,We);break;case 2:fd&&12!==Rd.Type&&10!==Rd.Type&&7!==Rd.Type&&8!==Rd.Type&&4!==Rd.Type||mc.f5(2,Ed,ve,Fe,Ae,We);break;case 3:fd!==
mc.jPa-1&&9!==Rd.Type&&11!==Rd.Type&&3!==Rd.Type&&7!==Rd.Type&&8!==Rd.Type||mc.f5(3,Ed,ve,Fe,Ae,We);break;case 5:fd!==mc.jPa-1&&3!==Rd.Type&&4!==Rd.Type&&7!==Rd.Type&&8!==Rd.Type&&mc.f5(3,Ed,ve,Fe,Ae,We);break;case 6:rc!==mc.mBa-1&&2!==Rd.Type&&1!==Rd.Type&&5!==Rd.Type&&6!==Rd.Type&&mc.f5(1,Ed,ve,Fe,Ae,We)}}static dWi(){const rc=Array(12);rc[0]=0;rc[7]=1;rc[8]=2;rc[5]=3;rc[6]=4;rc[4]=5;rc[3]=6;rc[1]=7;rc[2]=8;rc[9]=9;rc[10]=10;rc[11]=11;rc[12]=13;return rc}}mc.mBa=5;mc.jPa=5;mc.Y6i=5;mc.mQf="TableStyleIcon";
mc.Kaa=[null,rb.a.solid,rb.a.dashed,rb.a.dotted,rb.a.dashed,rb.a.dotted,rb.a.dashed,rb.a.double];mc.borders=[cc.a.borderTop,cc.a.borderBottom,cc.a.borderLeft,cc.a.borderRight];mc.RWg=mc.dWi();mc.Wyd=null;Object(k.a)(mc,"TableStyleHelper",null,[]);class Sa{constructor(rc,fd,Ed,Rd,Fe,Ae){this.headerRow=rc;this.totalRow=fd;this.firstCol=Ed;this.lastCol=Rd;this.E1=Fe;this.xua=Ae}equals(rc){return rc?this.headerRow===rc.headerRow&&this.totalRow===rc.totalRow&&this.firstCol===rc.firstCol&&this.lastCol===
rc.lastCol&&this.xua===rc.xua&&this.E1===rc.E1:!1}}Object(k.a)(Sa,"TableStyleOptions",null,[]);var pb=a(959);let Ac=class extends Fd.a{constructor(rc,fd,Ed){super();this.Q6j={["height"]:"100%"};this.x2b={};this.DWa=this.rMd=0;this.lastSyncTime=new Date;this.Wpa=-1;this.JK=null;this.Gza={};this.UV=null;this.LS={};this.Q7a={};this.GRc=null;this.VVb=this.omb=this.isInitialized=this.iZf=!1;this.OUc=null;this.iZc=this.Q7b=this.Fyf=!1;this.nRj=(Rd,Fe,Ae)=>{let We=!1;if(K.a(Rd))-315732528!==Rd.Errors[0].MessageId&&
(t.ULS.sendTraceTag(42821707,0,10,`TableStyleManager.OnGetTableStyleSuccess - Webservice call failed with Unexpected error : ${U.a.Kh(Rd.Errors)}`),this.Vhg(null,Fe,Ae));else if(t.ULS.sendTraceTag(537151202,0,50,"TableStyleManager.OnGetTableStyleSuccess - Webservice call Success"),(Rd=Rd.Result)&&Rd.TableStyleItems.length){Ae=60<Rd.TableStyleItems.length;var ve=!1,Ze=!1;if(this.UV)for(var Oe=0;60>Oe;++Oe){const Nf=Rd.TableStyleItems[Oe],Zf=this.UV.TableStyleItems[Oe];if(Nf.HasStyleViolations!==Zf.HasStyleViolations){We=
Ze=!0;break}for(let Rb=0;9>Rb&&!(Rb>=Nf.TableStyleElementsList.length);Rb++)if(!P.a.equals(Nf.TableStyleElementsList[Rb].BackgroundColor,Zf.TableStyleElementsList[Rb].BackgroundColor,!1)){We=ve=!0;break}}else{this.DWa=0;for(Oe of Rd.TableStyleItems)Oe.TableStyleElementsList&&Oe.TableStyleElementsList.sort(mc.e7f),this.LS[Oe.Name]=Oe}if(ve||Ze)for(ve=0;60>ve;++ve)Ze=Rd.TableStyleItems[ve],this.LS[Ze.Name]=Ze;if(Ae&&this.UV)for(t.ULS.sendTraceTag(42821700,0,50,`TableStyleManager.OnGetTableStyleSuccess, Number Custom Styles present - ${Rd.TableStyleItems.length-
60}`),We=!0,Ae=60;Ae<Rd.TableStyleItems.length;++Ae)ve=Rd.TableStyleItems[Ae],ve.Name in this.LS||ve.TableStyleElementsList&&ve.TableStyleElementsList.sort(mc.e7f),this.LS[ve.Name]=ve;if(pb.a(this.LS).length!==Rd.TableStyleItems.length)for(We=!0,ve=Ae=60;ve<this.UV.TableStyleItems.length;)Ae>=Rd.TableStyleItems.length?delete this.LS[this.UV.TableStyleItems[ve].Name]:Ae>=Rd.TableStyleItems.length||!P.a.equals(Rd.TableStyleItems[Ae].Name,this.UV.TableStyleItems[ve].Name,!1)?delete this.LS[this.UV.TableStyleItems[ve].Name]:
++Ae,++ve;this.UV=Rd;this.Zyg(We);We&&this.urd();Fe&&("accessibility"===Fe?(this.Q7b=!1,this.iZc=!0):this.iZc=!1);this.iZf||(this.Ipj()&&this.$.jm(),this.iZf=!0);this.rMd=0;this.VVb||this.Fyf?this.iZc&&this.raiseEvent("RefreshTableStyleGallery"):(this.raiseEvent("RefreshTableStyleGallery"),this.Fyf=!0)}};this.Vhg=()=>{t.ULS.sendTraceTag(42821712,0,10,"TableStyleManager.OnGetTableStyleFailed - Webservice call failed");this.rMd++;5>this.rMd&&ya.a.instance.create(()=>{this.hkb("getTableStylesFailed")},
1E3,Aa.a.QWg,!0,!0)};this.Sng=()=>{this.VVb&&(this.VVb=!1,this.OUc&&this.OUc(),ya.a.instance.create(()=>{this.hkb("galleryMenuClosed")},1E3,Aa.a.QWg,!0,!0))};this.$=rc;this.Ya=fd;this.Cj=Ed;M.ig.Ha()||this.$.ka.ph(329,this);this.Srd=this.APb();this.$.Ma.fGb(this.Sng)}h3i(rc){const fd=this.Cj.Zv;if(!fd)return!1;rc=rc[l.a.Ai];if(!rc)return!1;switch(Number.parseInvariant(rc)){case 0:return Db.d(fd);case 1:return Db.c(fd);case 2:return Db.g(fd);case 3:return Db.e(fd);case 4:return Db.f(fd);case 5:return Db.b(fd);
case 6:return fd.hasAutoFilter}return!1}nsg(rc,fd){if(id.a.isEmpty(this.LS))return!0;if("PopulateTableMoreStylesMenu"!==rc&&"PopulateTableAccessibleStylesMenu"!==rc)return!1;if("PopulateTableAccessibleStylesMenu"===rc&&!this.iZc)return this.Q7b||(this.Q7b=!0,this.hkb("accessibilityTab")),!0;this.VVb=!0;const Ed=this.Ya.Vv("TableStylesMenu"),Rd=this.Ya.$L("Ribbon.TableTools.TableStyles.Gallery.Custom",7,"Size48by48"),Fe=this.Ya.$L("Ribbon.TableTools.TableStyles.Gallery.Dark",7,"Size48by48"),Ae=this.Ya.$L("Ribbon.TableTools.TableStyles.Gallery.Medium",
7,"Size48by48"),We=this.Ya.$L("Ribbon.TableTools.TableStyles.Gallery.Light",7,"Size48by48");let ve=-123538519,Ze;if(fd.MenuId)if(P.a.contains(fd.MenuId,"FormatAsTable",!0))ve=753331043,this.omb=!0;else{Ze=fa.a.instance.ia(2003);var Oe=mc.MQb(null,1,"-1");F.EwaSettings.isChangeGateEnabled("OfficeVSO:4185429_NonNullIconNameForSLRGalleryItem")?We.QC("-1",ve,"QueryTableStyle",0,"-1",Oe,void 0,void 0,Ze):We.QC("-1",ve,"QueryTableStyle",0,"-1",void 0,void 0,void 0,Ze);this.omb=!1}Oe=0;const Nf=this.LS;
for(const Zf in Nf){const Rb=Nf[Zf];if("PopulateTableAccessibleStylesMenu"===rc&&Rb.HasStyleViolations)continue;let Vb;Ze=mc.yJf(Rb,this.APb());Vb=mc.MQb(Rb,this.DWa);if(Rb)switch(Rb.Category){case 0:Rd.QC(Rb.Index.toString(),ve,"QueryTableStyle",0,Rb.Index.toString(),Vb,void 0,void 0,Ze);Oe++;break;case 3:Fe.QC(Rb.Index.toString(),ve,"QueryTableStyle",0,Rb.Index.toString(),Vb,void 0,void 0,Ze);break;case 2:Ae.QC(Rb.Index.toString(),ve,"QueryTableStyle",0,Rb.Index.toString(),Vb,void 0,void 0,Ze);
break;case 1:We.QC(Rb.Index.toString(),ve,"QueryTableStyle",0,Rb.Index.toString(),Vb,void 0,void 0,Ze)}}0<Oe&&this.Qda(Ed,Rd,1971);this.Qda(Ed,We,1972);this.Qda(Ed,Ae,1973);this.Qda(Ed,Fe,1974);fd.MenuItems=Ed.ML();this.isInitialized||(this.isInitialized=!0);return!0}mOd(rc){rc[fc.a.On]=!1;let fd=rc[l.a.Ai];if(fd&&!id.a.isEmpty(this.LS)){P.a.contains(rc.ParentMenuId,"FormatAsTable",!0)?this.omb=!0:this.omb=!1;this.omb||this.Z1g();mc.Z_f(rc)&&(fd=this.XPb(fd).toString());var Ed=this.APb();rc[fc.a.Alt]=
"-1"===fd?fa.a.instance.ia(2003):mc.yJf(this.xJf(fd),Ed);if(fd in this.Q7a&&Ed.equals(this.Srd))this.psg(rc,fd,Ed,!0);else{if(!this.GRc||this.GRc&&!this.GRc.wt)this.Gza={},this.GRc=ya.a.instance.create(()=>{this.Zyg();this.Srd=this.APb()},0,Aa.a.oUk,!0,!0);this.vae(Ed,rc,fd)}}}getTableStyleIndexFromName(rc){if(!rc||id.a.isEmpty(this.LS))return-1;if(rc in this.LS)return this.LS[rc].Index;this.hkb("getTableStyleIndexFromName");return-1}sXd(){return!!this.UV}XPb(rc){this.JK||this.urd();return rc in this.JK?
this.JK[rc]:-1}hkb(rc){if(this.$.isEditMode){var fd=new Date;if(30<dc.getElapsedSeconds(this.lastSyncTime,fd)||id.a.isEmpty(this.LS)||this.Q7b){const Ed=this.$.pa.ta.Jh();this.lastSyncTime=fd;rc=this.Q7b&&"accessibilityTab"===rc||"galleryMenuClosed"===rc;La.n(this.$.pa.ta,rc,this.nRj,this.Vhg,null,rc?"accessibility":"normal",Ed)}}}dispose(){this.JK=this.Q7a=this.UV=this.LS=null;this.$.Ma.c3b(this.Sng);super.dispose()}tAh(rc){this.addHandler("RefreshTableStyleGallery",rc)}Dkk(rc){this.removeHandler("RefreshTableStyleGallery",
rc)}urd(){const rc={};this.Cj.Zv&&(this.Wpa=this.getTableStyleIndexFromName(this.Cj.Zv.OZc));for(let fd=1;7>=fd;fd++)rc["preview"+fd]=this.INi(fd);this.JK=rc}INi(rc){var fd=this.UV.TableStyleItems.length;fd=4>=this.Wpa?this.Wpa+rc-1:4<this.Wpa&&this.Wpa<fd-4?4===rc?this.Wpa:Math.floor(this.Wpa+rc-4):this.Wpa+rc-1;-1===fd||fd.toString()in this.Q7a||(fd=rc-3);return fd}Z1g(){if(this.Cj.Zv){let rc=!1;const fd=this.getTableStyleIndexFromName(this.Cj.Zv.OZc);if(fd!==this.Wpa){if(this.JK){const Ed=this.JK;
for(const Rd in Ed)Ed[Rd]===fd&&(rc=!0)}this.Wpa=fd;rc||id.a.isEmpty(this.Q7a)||this.urd()}}}Qda(rc,fd,Ed){const Rd=this.Ya.Oh();Rd.iz="Thin";Rd.title=fa.a.instance.ia(Ed);Rd.buttons.push(fd);rc.vh.push(Rd)}APb(){const rc=this.Cj.Zv;return this.omb||!rc?new Sa(!0,!1,!1,!1,!0,!1):new Sa(Db.d(rc),Db.g(rc),Db.c(rc),Db.e(rc),Db.f(rc),Db.b(rc))}Zyg(rc){rc=void 0===rc?!1:rc;const fd={},Ed={},Rd=this.APb();if(!id.a.isEmpty(this.LS)&&(this.Cj.Zv&&this.Z1g(),!Rd.equals(this.Srd)||rc||id.a.isEmpty(this.Q7a))){this.DWa=
mc.UOi(this.DWa);rc=this.LS;for(var Fe in rc){const Ae=rc[Fe],We=mc.MQb(Ae,this.DWa);fd[Ae.Index.toString()]=mc.Mjb(mc.vGa(mc.fqc(Ae,Rd)),We);Ed[We]=fd[Ae.Index.toString()];this.yNa(Ed)}Fe=mc.MQb(null,this.DWa,"-1");fd["-1"]=mc.Mjb(mc.vGa(mc.fqc(null,Rd)),Fe);Ed[Fe]=fd["-1"];this.yNa(Ed);Uc.c(this.Q7a,fd,!1)}}Ipj(){const rc=le.a(this.$);return rc?rc.ns.rA===Gb.a.a2b:!1}vae(rc,fd,Ed){"-1"===Ed&&P.a.contains(fd.ParentMenuId,"FormatAsTable",!0)||this.psg(fd,Ed,rc,!1)}psg(rc,fd,Ed,Rd){const Fe=mc.MQb(null,
this.DWa,fd);mc.Z_f(rc)?(Fe in this.Gza?Ed=this.Gza[Fe]:(Ed=mc.vGa(mc.fqc(this.xJf(fd),Ed)),this.Gza[Fe]=Ed),rc[fc.a.GalleryButtonProps]=Object(ld.a)(new vc.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:Fe,Alt:rc[fc.a.Alt],MenuItemId:fd,TableCellStyles:Ed,TableStyles:this.Q6j})):(rc[Tc.a.Icon]=Fe,rc[fc.a.GalleryButtonProps]=Object(ld.a)(new Bd.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:Fe,Alt:rc[fc.a.Alt],MenuItemId:fd}),Rd||(Rd=[],"-1"===fd||P.a.contains(rc.ParentMenuId,
"FormatAsTable",!0)||(Rd=mc.fqc(this.UV.TableStyleItems[Number.parseInvariant(fd)],Ed)),this.Q7a[fd]=mc.Mjb(mc.vGa(Rd),Fe)))}yNa(rc){if(this.VVb)this.OUc=()=>{this.yNa(rc)};else{this.OUc=null;var fd=[];for(const Rd in rc){var Ed=Rd;Ed in this.x2b?fd.push(Ed):this.x2b[Ed]=!0}try{0<fd.length&&appChrome.api.unregisterIcons(fd),id.a.isEmpty(rc)||appChrome.api.registerIconProvider(()=>rc)}catch(Rd){}}}xJf(rc){rc=Number.parseInvariant(rc);if(-1===rc||!this.UV)return null;if(60<rc)for(let fd=60;fd<this.UV.TableStyleItems.length;++fd){const Ed=
this.UV.TableStyleItems[fd];if(Ed.Index===rc)return Ed}return this.UV.TableStyleItems[rc]}};Ac=Object(d.__decorate)([Object(Q.d)(M.ig),Object(d.__param)(0,Object(M.Lb)()),Object(d.__param)(1,Object(M["if"])()),Object(d.__param)(2,Object(M.hg)())],Ac);Object(k.a)(Ac,"TableStyleManager",Fd.a,[732,2]);var yd=a(9),vb=a(420);class Sc extends vb.a{constructor(rc){super();this.tableStyleManager=null;this.$=rc;this.Bl()}create(){const rc=Object(N.d)(Q.a.resolve(M["if"],{va:this.hh})),fd=Object(N.d)(Q.a.resolve(M.hg,
{va:this.hh}));O.TaskExtensions.Ua(ma.Task.XP(rc,fd),()=>{this.Yj(this.tableStyleManager||(this.tableStyleManager=new Ac(this.$,rc.result,fd.result)))},this.$.xa,8)}}Object(k.a)(Sc,"TableStyleManagerFactory",vb.a,[]);var hd=a(96),qc=a(80),Lc=a(10),bd=a(77),jd=a(34),Yd=a(19),te=a(59);class oe extends qc.a{constructor(rc,fd,Ed,Rd){super();this.isMac=jd.a.isMac;this.$=rc;this.ariaLiveNotifier=Rd;this.NL=Ed.NKb(rc,null,fd,Yd.a.eni,te.a.$m(9),fa.a.instance.ia(1740),"PulloutPointerDown")}get iE(){return this.NL.iE}get buttonWidth(){return this.NL.buttonWidth}dispose(){this.NL.dispose();
this.$=null;super.dispose()}domElement(rc){return this.NL.domElement(rc)}getButton(rc){return this.NL.getButton(rc,!1)}R9b(rc,fd){this.NL.R9b(rc,fd,!1)}oqa(rc,fd){const Ed=ea.f(this.$),Rd=Ed.Pg.ro(rc);this.NL.R9b(fd?fa.a.instance.ia(1740):fa.a.instance.ia(1741),Rd);fd=this.isMac?fd?fa.a.instance.ia(1745):fa.a.instance.ia(1746):fd?fa.a.instance.ia(1743):fa.a.instance.ia(1744);var Fe=Ed.ml(rc,Rd);rc=Ed.Zk(Rd).vr;if(Fe&&0<=Fe.x&&0<=Fe.y){const Ae=Fe.bottomRight.x+this.iE;Fe=Fe.topLeft.y-this.iE-this.buttonWidth;
if(Fe<rc.topLeft.y+this.iE){if(Ed.Pg.j8a){this.hide();return}Fe=rc.topLeft.y+this.iE}this.Ft(Ae,Fe,Ed.rtl,Rd);this.ariaLiveNotifier.readText(fd)}else this.hide()}Ft(rc,fd,Ed,Rd){this.NL.Ft(rc,fd,Ed,Rd,!1)}hide(){this.NL.hide()}}Object(k.a)(oe,"PulloutLaunchButton",qc.a,[]);class Kd extends qc.a{constructor(rc,fd,Ed,Rd){super();this.Dbb=this.fed=this.$Uc=this.PTa=this.p7=this.yZ=null;this.lSe=0;this.$4c=!1;this.Am=()=>{this.iKa&&(this.da?1===this.da.ha.wk?(this.da.ha.qa.activeCell.equals(this.PTa)||
this.L0||this.jD(),this.rHb.qA()):this.jD():t.ULS.shipAssertTag(537154141,0,!1,"GridView is null during selection"))};this.en=()=>{this.jD()};this.xj=()=>{this.T1()};this.Li=()=>{this.jD()};this.fj=()=>{this.showCallout()};this.d_b=()=>{if(this.pu.xx&&this.pu.xx.length)if(this.Crd)this.pu.Uvj||(this.$4c=this.pu.xx[0].BlockingDataForExpand),this.pu.jJi&&t.ULS.sendTraceTag(537154140,0,50,"User clicked pullout launch button before fieldInfo web service returned"),this.lSe=this.pu.Txd&&this.pu.szf<this.pu.Txd.left-
1?this.pu.Txd.left-1-this.pu.szf:-1,this.showCallout();else if(this.da.ha.qa.Gn){var Fe=this.da.ha.qa.activeCell;if(Fe&&this.p7){var Ae=this.Cj.my(Fe);this.Jbd=!!Ae;const We=this.da.ha.qa.Ui;Ae=this.L0&&this.p7.yi(Ae);const ve=this.wNd&&!this.L0&&We.equals(this.selectedRange);Ae||ve?(t.ULS.sendTraceTag(39662912,0,50,"Field TableWidget shown on grid"),this.Wvc=!0,F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&!this.L0&&this.Cj.vwa(Fe)?t.ULS.shipAssertTag(537154139,0,
!1,"PulloutManager:OnFieldInfoListContextLoaded fetch rich fields for a cell on PivotTable range"):(this.L0?this.nq.oqa(this.p7,this.L0):this.nq.oqa(We,this.L0),this.qie())):t.ULS.shipAssertTag(537154138,0,!1,"PulloutManager:OnFieldInfoListContextLoaded FAILURE")}}};this.Rp=()=>{this.Hmb()&&this.nq.hide();1===this.da.ha.wk&&this.T1()};this.oE=()=>{const Fe=this.da.ha.wk;this.da.ha.qa.activeCell&&1===Fe&&this.T1()};this.zy=()=>{if(F.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds"))if(this.L0){if(this.p7&&
this.PTa){var Fe=this.Cj.my(this.PTa);Fe&&1<Fe.bottom-Fe.top&&(--Fe.bottom,this.da.xaa(Fe)&&this.rHb.qA())}}else this.da.ha.qa.Gn&&this.da.xaa(this.da.ha.qa.Ui)&&this.rHb.qA();else this.p7&&this.PTa&&this.L0&&(Fe=this.Cj.my(this.PTa))&&1<Fe.bottom-Fe.top&&(--Fe.bottom,this.da.xaa(Fe)&&this.rHb.qA())};this.T1=()=>{if(this.$&&this.da){if(this.Wvc&&this.L0){const Fe=this.da.ha.qa.activeCell;this.p7=this.Xwf();const Ae=!!this.$Uc&&this.$Uc.contains(Fe);if(this.p7&&(Fe.equals(this.PTa)||Ae)){this.nq.oqa(this.p7,
this.L0);return}}this.Wvc=!1;(this.p7=this.Xwf())&&this.VLa&&this.da&&this.da.za.yx(this.VLa)?(this.Crd=!1,this.Hjb()):(this.pu.ksd(),this.pu.Unc());this.Wvc||this.nq.hide()}};this.$=rc;this.Cj=Ed;this.nq=new oe(rc,this.fj,fd,Rd);this.pu=fd.Hwd(rc,Ed);this.Wvc=this.Crd=!1;this.wNd=F.EwaSettings.Ra(128);this.Jbd=!0;this.da=ea.f(this.$);this.da.sh.nv(this.en);this.da.Mz(this.oE);this.$.nr(this.xj);this.$.Lp(this.Li);this.$.hI(this.Rp);this.da.view.Wy(this.zy);this.da.ha.VW(this.Am);this.rHb=ya.a.instance.create(this.T1,
250,Aa.a.E8j);t.ULS.sendTraceTag(537154143,0,50,"Feature TableWidget enabled");this.pu.zmd(this.d_b);this.T1();rc.ka.ph(261,this)}get Pi(){return this.nq.domElement(1)}get VLa(){return this.fed}get selectedRange(){return this.Dbb}get L0(){return this.Jbd}get ivg(){return this.lSe}get cJc(){const rc=this.nq.domElement(this.Yia);return rc?sb.DOMElementExtensions.isVisible(rc):!1}get iKa(){return this.$.isEditMode&&F.EwaSettings.Ra(128)?!(new R.a(this.$.sa)).Dn:!1}get SBh(){return this.$4c}get Yia(){return this.VLa?
this.da.Pg.ro(this.yZ):1}dispose(){this.da&&(this.da.ha.UY(this.Am),this.da.view.Kx(this.zy),this.da.sh&&this.da.sh.ev(this.en));if(this.$){const rc=this.$;rc.Pr(this.xj);rc.Au(this.Li);rc.LK(this.Rp);ea.f(rc).xE(this.oE)}this.pu&&this.pu.Zfe(this.d_b);hd.a.Ng(this.nq);this.pu=this.$=this.da=this.rHb=this.nq=null;super.dispose()}jD(){this.nq.hide()}Etb(){this.nq?this.nq.getButton(this.Yia).L3b():t.ULS.sendTraceTag(537154142,0,15,"PulloutManager.ResetButtonAppearance: launchButton is null.")}Vok(){this.p7=
null}yug(){this.nq&&this.nq.hide()}dYi(){if(!this.wNd||1!==this.selectedRange.width)return null;const rc=this.selectedRange.clone();for(;this.da.xaa(rc);){rc.left+=1;rc.right+=1;if(!this.da.Zk(this.da.Pg.ro(rc)).Hp.pk(rc))break;if(!this.da.za.yx(rc))continue;const fd=this.da.ot("PulloutManager.GetValidatedRangeToFill",rc,2);try{if(Kd.s9k(fd))return rc}finally{fd&&fd.dispose()}}return null}qie(){this.pu.MTc()}showCallout(){this.iKa&&(this.pu.TTd?(this.nq.getButton(this.Yia).Nrb(),M.db.Ha()?void Q.a.resolve(M.db,
{va:0}).then(rc=>{rc&&(rc.lyc("tableFieldList").Yba(null,this.nq.domElement(this.Yia),this.pu,null,!0),this.qie())}):O.TaskExtensions.Ua(W.GetServiceTaskFactory.Bj(this.$.ka,8,9,0),rc=>{rc.result.lyc("tableFieldList").Yba(null,this.nq.domElement(this.Yia),this.pu,null,!0);this.qie()},this.$.xa,3)):(this.Crd=!0,this.Hjb()))}Xwf(){if(!this.iKa||!this.da||this.da.ha.$e.yh||!this.da.ha.qa.Gn)return null;var rc=this.da.ha.qa.activeCell,fd=ea.f(this.$).Pg.ro(rc);if(!rc)return null;this.PTa=rc.clone();const Ed=
this.Cj.my(rc);this.Jbd=!!Ed;if(this.L0){this.nq.R9b(fa.a.instance.ia(1740),fd);this.yZ=Kd.i5g(Ed);if(!this.yZ)return null;let Rd=!1;rc=(()=>{let Fe=this.Cj.J_h(Ed,this.da);({I9:Rd}=Fe);return Fe})().returnValue||Rd;this.$4c=Rd;if(rc)return this.$Uc=new w.Range(Ed.top,Ed.left,Ed.bottom,Ed.right,!1,!1),this.fed=new w.Range(this.yZ.top,this.yZ.right+1,this.yZ.top,this.yZ.right+1,!1,!1),this.yZ}else if(this.wNd){this.nq.R9b(fa.a.instance.ia(1741),fd);this.Dbb=this.da.ha.qa.Ui.clone();fd=ea.f(this.$).Yg.MKa(this.selectedRange);
this.yZ=Kd.i5g(this.selectedRange);if(!fd||!this.yZ||!this.selectedRange||F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&this.Cj.vwa(this.selectedRange))return null;this.fed=this.dYi();fd=!1;if((fd=F.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?this.da.xaa(this.selectedRange):this.da.xaa(this.yZ))&&this.VLa)return this.$Uc=this.yZ,t.ULS.sendTraceTag(537154137,0,50,`PulloutManager:FindSelection, NextRange, ${this.VLa?
this.VLa.toString():"null"}, RightColumnHeader, ${this.yZ?this.yZ.toString():"null"}, ActiveCell, ${rc?rc.toString():"null"}`),this.yZ}return null}Hjb(){this.L0?this.pu.Hjb(z.w(this.VLa,this.$),!1,!0):F.EwaSettings.Ra(128)&&this.pu.Hjb(z.w(this.selectedRange,this.$),!0,!1)}Hmb(){return this.$.ea.isNamedObjectViewMode&&bd.f(this.$.na)}static s9k(rc){for(;rc.$$mn();)if(rc.$$cu().text||rc.$$cu().kH||rc.$$cu().tn||rc.mu.GZa)return!1;return!0}static i5g(rc){return rc.right===Lc.a.Qk?null:new w.Range(rc.top,
rc.right,rc.top,rc.right,!1,!1)}}Object(k.a)(Kd,"PulloutManager",qc.a,[763,2]);class Ee extends vb.a{constructor(rc){super();this.$=rc;this.Bl()}create(){yd.a.Qg(rc=>{const fd=Object(N.d)(Q.a.resolve(M.Cf,{va:this.hh})),Ed=Object(N.d)(Q.a.resolve(M.hg,{va:this.hh})),Rd=F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)?Object(N.d)(Q.a.resolve(M.l,{va:this.hh})):W.GetServiceTaskFactory.Bj(rc.ka,211,212,this.hh);O.TaskExtensions.Ua(O.TaskExtensions.Ln([fd,Ed,
Rd],rc.xa),()=>{this.Yj(this.$.ka.Ug(261)||new Kd(this.$,fd.result,Ed.result,Rd.result))},rc.xa)})}static Aa(rc){rc.ka.ph(262,new Ee(rc))}}Object(k.a)(Ee,"PulloutManagerFactory",vb.a,[]);(()=>{yd.a.Qg(rc=>{M.ig.Ha()||rc.ka.ph(330,new Sc(rc))})})();(()=>{yd.a.Qg(rc=>{F.EwaSettings.Ra(128)&&Ee.Aa(rc)})})();String(c);String(b);String(f);String(r);window.___1708742503524_closurehack=c;window.___1708742503524_closurehack=b;window.___1708742503524_closurehack=f;window.___1708742503524_closurehack=r}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.tbl.js.map/44409ec083aa4930e650f4a74e4fb1a4/EwaTS.tbl.js.map