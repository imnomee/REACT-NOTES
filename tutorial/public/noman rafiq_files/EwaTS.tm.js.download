'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[10],{1047:function(y,x,a){a.d(x,"a",function(){return r});y=a(0);var c=a(14);class b{}Object(y.a)(b,"ExtraInfo",null,[]);class f{}Object(y.a)(f,"PerfOperation",null,[]);class r{constructor(d,k){this.wN=this.Ds=null;this.vw=d;this.lr=k}get wt(){return!!this.Ds}get ii(){return this.Ds?(new Date).getTime()-this.Ds.getTime():0}get id(){throw Error.notImplemented();}start(){this.Ds=new Date;return this.wN=null}stop(){this.Ds&&
c.ULS.sendTraceTag(4257028,200,50,"Stopwatch stopped: {0}",{["Operation"]:this.vw,["Target"]:this.lr,["StartTime"]:this.Ds.toUTCString(),["DurationInMilliseconds"]:this.ii})}reset(){this.stop();this.wN=this.Ds=null}qm(d){return!d||""===d}}Object(y.a)(r,"Stopwatch",null,[108,34])},1048:function(y,x,a){a.d(x,"a",function(){return e});y=a(0);var c=a(14);x=a(913);var b=a(592),f=a(6),r=a(17),d=a(123);class k{constructor(w,l,u,n){this.origin=w;this.data=l;this.source=u;this.La=void 0===n?null:n}}Object(y.a)(k,
"MessageEventArgs",null,[]);class t{constructor(w,l){this.Gda=null;this.f1b=u=>this.OZ?this.OZ(new k(u.origin,u.data,u.source,u.La)):!1;this.ZEb=w;this.$j=l;this.OZ=null}get Y7(){return this.ZEb.value}get bN(){return this.$j.value}LUa(w,l){this.OZ=w;this.Gda=this.f1b;this.Y7.addHandler(r.a.message,this.Gda,l)}ZWa(){this.OZ=null;this.Y7.removeHandler(r.a.message,this.Gda)}gKa(w,l){const u=new d.a(0,1,1,()=>{w(l)},7);this.bN.Ol(u)}hTb(w,l){const u=new d.a(0,1,1,()=>{w(l)},7);this.bN.Ol(u)}static get instance(){return t.bwa()}static bwa(){return new t(new b.a(()=>
f.AFrameworkApplication.Y7),new b.a(()=>f.AFrameworkApplication.pp))}}Object(y.a)(t,"MessageEventHandler",null,[453]);var m=a(936);class e extends x.a{constructor(w,l,u){super(w,l,(void 0===u?null:u)||t.instance,e.PSb)}static PSb(){m.a.sendTraceTag=e.$4b;m.a.debugAssertTag=e.FLb}static $4b(w,l,u,...n){c.ULS.sendTraceTag.apply(null,[w,204,e.ZKb(l),u].concat(n))}static FLb(){}static ZKb(w){switch(w){case 0:return 200;case 1:return 100;case 2:return 50;case 4:return 15;case 3:return 10;default:return 100}}}
e.C1b="wdPreviousSession";e.mLb="wdUserSession";Object(y.a)(e,"CommonCrossDocumentMessenger",x.a,[])},1072:function(y,x,a){a.d(x,"a",function(){return c});y=a(0);class c{}c.HAd="stid";c.FAd="iid";c.GAd="DynamicImageProvider.aspx";c.y1="RequestStartTime";c.isEwaJsSplitEnabled="IsEwaJsSplitEnabled";c.A0a="IsJsSelfProfilerOnBootEnabled";Object(y.a)(c,"WebServiceConstants",null,[])},1157:function(y,x,a){a.r(x);a.d(x,"RenderingFidelityTracker",function(){return e});y=a(179);x=a(0);var c=a(14),b=a(107),
f=a(80),r=a(13),d=a(420);class k extends d.a{constructor(w){super();this.$=w;this.Bl()}create(){const {RenderingFidelityTracker:w}=a(1157);let l=this.$.ka.Ug(462);l||(l=this.$.ka.ph(462,new w));this.Yj(l)}}Object(x.a)(k,"RenderingFidelityTrackerFactory",d.a,[]);var t=a(43);d=a(5);var m=a(97);let e=class extends f.a{constructor(){super();this.mEj=3E4;this.dxb={};this.Hye={};this.u7e={};b.Health.instance.addQosPillar("Fidelity")}static Aa(w){w.ka.ph(463,new k(w))}a3e(w,l,u,n){if(!(t.a.instance.Tfa(new Date)<
this.mEj)){var v=r.HelperMethods.HM(()=>{var B=gridRenderer.CanvasRendererGlobals.analyzeLowRenderingFidelity(l),z=Object.keys(B),C=this.u7e[w];for(var D=0;D<z.length;D++){var J=z[D];this.Hye[J]||(null===C||void 0===C?0:C[J])&&this.dxb[J]&&(this.dxb[J]-=C[J])}this.u7e[w]=B;for(D=0;D<z.length;D++)if(C=z[D],!this.Hye[C])if(J=B[C],this.dxb[C]&&(J+=this.dxb[C]),gridRenderer.CanvasRendererGlobals.hasRenderingFidelityThresholdExceeded(C,J)){this.Hye[C]=!0;B=gridRenderer.CanvasRendererGlobals.getErrorTypeForRenderingFidelityProblem(C);
z=gridRenderer.CanvasRendererGlobals.getVetoForRenderingFidelityProblem(C);D=!("ThickBorder"===C||"MediumBorder"===C);B&&z&&D&&b.Health.instance.recordQosError(B,[z],!1,!0,!0,!1,null);c.ULS.sendTraceTag(527472324,0,50,"Session Vetoed because of : { key:"+C+", isHC:"+u+", scaleFactor:"+n+"}");break}else this.dxb[C]=J});1<v&&c.ULS.sendTraceTag(527472323,1,50,`RenderingFidelityTracker.AnalyzeModelForLowFidelity: Duration for AnalyzeModelForLowFidelity the model, duration=${v}`)}}};e=Object(y.__decorate)([Object(m.d)(d.ff)],
e);Object(x.a)(e,"RenderingFidelityTracker",f.a,[647,2])},1201:function(y,x,a){a.d(x,"a",function(){return b});y=a(0);var c=a(14);class b{static lWa(f){f=new Date(f);return c.ULS.uef([b.Kuh(f.getUTCFullYear()),"-",b.Ecb(f.getUTCMonth()+1),"-",b.Ecb(f.getUTCDate()),"T",b.Ecb(f.getUTCHours()),":",b.Ecb(f.getUTCMinutes()),":",b.Ecb(f.getUTCSeconds()),".",b.c_e(f.getUTCMilliseconds()),"Z"])}static Kuh(f){return 1E3>f?"0"+b.c_e(f):f.toString()}static c_e(f){return 100>f?"0"+b.Ecb(f):f.toString()}static Ecb(f){return 10>
f?"0"+f:f.toString()}}Object(y.a)(b,"UlsUtils",null,[])},358:function(y,x,a){function c(Qa){switch(!0){case Qa.DF:return R.MergedCell;case Qa.oR:return R.Y8g;case Qa.iC:return R.Formula;case Qa.hasAutoFilter:return R.AutoFilter;case Qa.Tma:return R.PivotFilter;case !!Qa.JPc:return R.PivotTable;case Qa.Pwa:return R.Comment;case Qa.Mkb:return R.Sparkline;case Qa.GZa:return R.InCellImage;case Qa.hasRichText:return R.Fah;default:return""}}function b(Qa){if(bb.get(Qa))return bb.get(Qa);var Ma=Qa.replace(/-.*/g,
()=>"");Ma=bb.get(Ma);return null!==Ma&&void 0!==Ma?Ma:Qa.startsWith("ooux")?"ooux":"other"}a.r(x);var f={};a.r(f);a.d(f,"DocumentVisibilityObserver",function(){return W});var r={};a.r(r);a.d(r,"GridActionTelemetryManager",function(){return O});var d={};a.r(d);a.d(d,"EwaHostMessenger",function(){return ba});var k={};a.r(k);a.d(k,"InteractivityTrackerService",function(){return wa});var t={};a.r(t);a.d(t,"PageLoadEngagementInfo",function(){return Ka});var m={};a.r(m);a.d(m,"ServiceWorkerRegistrationManager",
function(){return Qc});var e={};a.r(e);a.d(e,"ValidationTelemetryManager",function(){return pc});var w={};a.r(w);a.d(w,"VirtualGetRangeTelemetryManager",function(){return $b});var l=a(179),u=a(0),n=a(96),v=a(38),B=a(129),z=a(32),C=a(155),D=a(5),J=a(97);let W=class extends v.a{constructor(){super();this.fT=!1;this.nNe=this.mNe=null;this.R6d=()=>{this.O2g()};this.e8d=()=>{n.a.Ng(this.j$);n.a.Ng(this.Ht)};this.j$=C.a.instance.sWa();this.Ht=C.a.instance.WT();this.j$.Aa("visibilitychange",this.R6d);this.Ht.Aa("pagehide",
this.e8d);this.O2g()}get tn(){return this.fT}get h2f(){return this.mNe}get rIc(){return this.nNe}t9(Qa){this.addHandler("ekdh",Qa)}p5a(Qa){this.removeHandler("ekdh",Qa)}t3(Qa){this.addHandler("ekduh",Qa)}FNa(Qa){this.removeHandler("ekduh",Qa)}tM(Qa){return this.tn?!0:this.rIc?B.getElapsedMilliseconds(this.rIc,z.a.Tg.Wh)<Qa:!1}dispose(){n.a.Ng(this.j$);n.a.Ng(this.Ht);super.dispose()}O2g(){this.fT="hidden"===window.document.visibilityState;this.tn?(this.raiseEvent("ekdh"),this.mNe=z.a.Tg.Wh):(this.raiseEvent("ekduh"),
this.nNe=z.a.Tg.Wh)}};W=Object(l.__decorate)([Object(J.d)(D.Ab)],W);Object(u.a)(W,"DocumentVisibilityObserver",v.a,[227,2]);var N=a(14),M=a(1),Q=a(24);const R={MergedCell:"MergedCell",Y8g:"ConditionalFormat",Comment:"Comment",Formula:"Formula",AutoFilter:"AutoFilter",PivotFilter:"PivotFilter",PivotTable:"PivotTable",Sparkline:"Sparkline",InCellImage:"InCellImage",Fah:"RichText"};let O=class{constructor(Qa){this.Li=()=>{const Ma=JSON.stringify(this.vdf),$c=JSON.stringify(this.udf);N.ULS.sendTraceTag(508929763,
0,50,`GridActionTelemetryManager.onWorkBookClosing: {"commandNameToRowColCount": ${Ma}}`);N.ULS.sendTraceTag(508826823,0,50,`GridActionTelemetryManager.onWorkBookClosing: {"commandNameToComplexCellInfo": ${$c}}`)};this.$=Qa;this.vdf=[];this.udf=[];M.EwaSettings.uUb()&&this.$.Lp(this.Li)}dispose(){this.$=null}C_e(Qa,Ma){this.vdf.push({commandName:Ma,rowColCount:Qa.toString()})}Ald(Qa,Ma){if(Qa&&0!==Qa.length){var $c=[];const de={};for(const Be of Qa)Be.xfj()&&(Qa=c(Be),""!==Qa&&(de[Qa]=de[Qa]?de[Qa]+
1:1));for(const Be of Object.keys(de))$c.push({cellType:Be,count:de[Be]});0!==$c.length&&this.udf.push({commandName:Ma,complexCellTypes:$c})}}BZe(Qa,Ma,$c,de,Be){const nf=Q.f(this.$);var Tf=M.EwaSettings.r0a()?M.EwaSettings.Fje():M.EwaSettings.B2d(),Xf=nf.za.Hxc(1554436520===Be||1051390410===Be?Tf:0,674605324===Be||-706918724===Be?Tf:0);Be=[];Tf=!1;"UnhideColumn"!==Qa&&"UnhideRow"!==Qa&&"insertColumns"!==Qa&&"insertRows"!==Qa||(Tf=!0);for(const Ug of Xf){{Xf=Ug.jj;var zg=de,$f=$c,Ng=Ma,pg=Tf;let Og=
null;if(zg&&Xf||!M.EwaSettings.isChangeGateEnabled("OfficeVSO:7990966_GridActionTelemetryBlockRangeFix"))pg?Xf.yi(zg)&&(Og=Xf,Ng?Og.top=Og.bottom-$f+1:Og.left=Og.right-$f+1):Xf.yi(zg)||(Og=Xf,Ng?Og.bottom=Og.top+$f-1:Og.right=Og.left+$f-1);Xf=Og}Xf&&(Xf=nf.za.DX(Xf))&&(Be=[...Be,...Xf])}this.Ald(Be,Qa+"Cascade")}};O=Object(l.__decorate)([Object(J.d)(D.Uc),Object(l.__param)(0,Object(D.Lb)())],O);Object(u.a)(O,"GridActionTelemetryManager",null,[649,2]);var U=a(1048),K=a(6),F=a(42),I=a(113),P=a(159),
Y=a(478),ea=a(231),Ba=a(253),Fa=a(63),za=a(86),xa=a(27),fa=a(169),V=a(913);Object(J.b)(D.id,{yk:"singleton"})(Qa=>No(function*(){const Ma=yield J.a.resolve(D.Lb,Qa),$c=window.parent,de=M.EwaSettings.isChangeGateEnabled("OfficeVSO:5135167_PostMessageOriginFixup")?Ma.ua.DocumentHostInfo.PostMessageOrigin||V.a.HL:K.AFrameworkApplication.$Pc||V.a.HL,Be=K.AFrameworkApplication.fa.la("HostSendReadyToAcceptPostMessage");F.a.instance.register(ba,"Microsoft.Office.Excel.WebUI.Client.PostMessage.EwaHostMessenger").as("Postmessage.IHostPostmessenger").hi().mi(()=>
new ba(Ma,$c,de,Be));return F.a.instance.resolve("Postmessage.IHostPostmessenger")}));class ba extends U.a{constructor(Qa,Ma,$c){super(Ma,$c);this.Og=new I.a;this.q6i=de=>{if(M.EwaSettings.isChangeGateEnabled("OfficeVSO:3449424_AgaveValidateHost")){const Be=de.Values.m_Origin;K.AFrameworkApplication.wopiHostOriginFromPostMessage||(K.AFrameworkApplication.wopiHostOriginFromPostMessage=Be)}switch(de.MessageId){case P.a.HPd:fa.a(this.$).vMf(de);break;case P.a.T_d:Ba.a.ltas(null);break;case P.a.wCc:this.ORj();
break;case P.a.LPd:this.NRj(de)}};this.$=Qa;$c!==V.a.HL&&this.PW($c);this.Paj();this.V$i();Qa=this.q6i;this.Ip(P.a.HPd,Qa);this.Ip(P.a.T_d,Qa);this.Ip(P.a.wCc,Qa);this.Ip(P.a.LPd,Qa)}dispose(){this.$=null;super.dispose()}Paj(){this.Tq(P.a.U9e);this.Tq(P.a.HPd);this.Tq(P.a.wCc);this.Tq(P.a.LPd);this.UTa(P.a.T_d);this.Tq(P.a.KPd)}V$i(){this.OW("App_EwrWorkbookNotSupportedCancelResponse");this.OW(P.a.SEa);this.OW(P.a.t4);this.OW("App_CloseTab");this.OW(P.a.b9a);this.OW(P.a.c9a);this.OW(P.a.CPf);this.OW(P.a.tCc);
this.OW("App_ModifyURLState")}ORj(){const Qa={};Qa.hostMessageReceived=(new Date).getTime();N.ULS.sendTraceTag(537162883,0,50,"EwaHostMessenger.OnHostUnload");K.AFrameworkApplication.tHc=!0;Qa.appUnloadStart=(new Date).getTime();Qa.sendBeaconFlight=K.AFrameworkApplication.fa.la("SendBeaconOnShuttingDownRequestsEnabled");Qa.sendBeaconSupported=Fa.a.$pa();Fa.a.P3e();Qa.appUnloadEnd=(new Date).getTime();Qa.appMessageSent=(new Date).getTime();this.sendMessage(P.a.XDh,Qa)}NRj(Qa){N.ULS.sendTraceTag(537162882,
0,50,"EwaHostMessenger.OnHostSwitchMode");Qa.Values&&Y.a.B4d in Qa.Values&&xa.a.equals(Qa.Values[Y.a.B4d],ea.a.edit,!0)&&!this.$.isEditMode&&(N.ULS.sendTraceTag(537162881,0,50,`EwaHostMessenger.OnHostSwitchMode: Switching to ${Qa.Values[Y.a.B4d]}`),Qa=new za.a(-8805455,0,1,0,null),this.$.Ma.dh(Qa))}}Object(u.a)(ba,"EwaHostMessenger",U.a,[648,474,2]);var la=a(17),Ta=a(2),Ea=a(43);class sa{constructor(){this.appInfoProperties=this.appState=null}}Object(u.a)(sa,"CurrentAppInfo",null,[]);const Ya="context-menu floatie task-pane context-menu-auto-filter context-menu-auto-filter-items dialog".split(" "),
bb=new Map;[{name:"keyboard_selection",actions:new Set("move_down move_left move_right move_up extend_down extend_left extend_right extend_up cell_text_move_down cell_text_move_left cell_text_move_right cell_text_move_up cell_text_extend_down cell_text_extend_left cell_text_extend_right cell_text_extend_up formulaBar_extend_left formulaBar_extend_right formulaBar_extend_down formulaBar_extend_up formulaBar_move_right formulaBar_move_down formulaBar_move_left formulaBar_move_up commit_down commit_right formulaBar_commit_down formulaBar_commit_right cell_text_commit_right cell_text_commit_down".split(" "))},
{name:"cell_edit",actions:new Set("commit_down_end_edit commit_right_end_edit formulaBar_commit_down_end_edit formulaBar_commit_right_end_edit cell_text_commit_down_end_edit cell_text_commit_right_end_edit cell_text_edit_end cell_text_edit_type cell_text_edit_typing cell_text_start_edit cell_text_start_edit_replace formulaBar_start_edit_replace formulaBar_start_edit formulaBar_end_edit_ok_cancel_btn cell_text_end_edit_ok_cancel_btn formulaBar_end_edit_sheet_changed cell_text_end_edit_sheet_changed move_down_end_edit move_left_end_edit move_right_end_edit move_up_end_edit extend_down_end_edit extend_left_end_edit extend_right_end_edit extend_up_end_edit cell_text_move_down_end_edit cell_text_move_left_end_edit cell_text_move_right_end_edit cell_text_move_up_end_edit cell_text_extend_down_end_edit cell_text_extend_left_end_edit cell_text_extend_right_end_edit cell_text_extend_up_end_edit cell_text_active_cell_selection_change_entire_row_end_edit formulaBar_active_cell_selection_change_entire_row_end_edit cell_text_active_cell_selection_change_entire_column_end_edit formulaBar_active_cell_selection_change_entire_column_end_edit cell_text_active_cell_selection_change_right_click_end_edit formulaBar_active_cell_selection_change_right_click_end_edit cell_text_active_cell_selection_change_end_edit formulaBar_active_cell_selection_change_end_edit formulaBar_edit_type formulaBar_move_left_end_edit formulaBar_move_down_end_edit formulaBar_extend_left_end_edit formulaBar_move_right_end_edit formulaBar_move_up_end_edit formulaBar_extend_up_end_edit formulaBar_extend_right_end_edit formulaBar_extend_down_end_edit".split(" "))},
{name:"active_cell_selection",actions:new Set("cell_text_active_cell_selection_change_entire_row formulaBar_active_cell_selection_change_entire_row cell_text_active_cell_selection_change_entire_column formulaBar_active_cell_selection_change_entire_column cell_text_active_cell_selection_change_right_click formulaBar_active_cell_selection_change_right_click cell_text_active_cell_selection_change formulaBar_active_cell_selection_change".split(" "))},{name:"headers",actions:new Set(["header_resize_start",
"header_resize_autofit"])},{name:"scroll_animation",actions:new Set(["viewport_scroll"])},{name:"drag_animation",actions:new Set("drag_range_insert drag_range_replace drag_table_row_rearrange drag_table_column_rearrange drag_row_insert drag_row_replace drag_column_insert drag_column_replace drag_pivot_replace drag_pivot_row_rearrange drag_pivot_column_rearrange".split(" "))},{name:"async_ui",actions:new Set(Ya)}].forEach(Qa=>{Qa.actions.forEach(Ma=>{bb.set(Ma,Qa.name)})});class ra{constructor(){this.value=
this.key=null}}Object(u.a)(ra,"AppInfoProperty",null,[]);class Da{constructor(Qa){this.$=Qa}getAppState(){const Qa=Ea.a.instance.Tfa(new Date);return-1===Qa?"boot":3E4>Qa?"postboot":"steady"}isChangeGateEnabled(Qa){return M.EwaSettings.isChangeGateEnabled(Qa)}getBooleanFeatureGate(Qa,Ma){return M.EwaSettings.getBooleanFeatureGate(Qa,Ma)}getCurrentAppInfo(){return Object(Ta.a)(new sa,{appState:this.getAppState(),appInfoProperties:[Object(Ta.a)(new ra,{key:"coauthCount",value:this.$.ea.yt.length.toString()})]})}sendBeaconTraceTag(Qa,
Ma,$c,de){this.$.sendBeaconTraceTag(Qa,Ma,$c,de)}getActionBucket(Qa){return b(Qa)}getAppInfoForReport(){return`${"maxCoauthCount"}: ${this.$.ea.iDj}`}logSlowActionsHandler(){return""}logAsyncActionHandler(){return""}}Object(u.a)(Da,"InteractivityTrackerCallbacks",null,[660]);class oa{constructor(){this.events=null;this.durationThresholdInMs=0;this.asyncUiTracking=this.animationTracking=this.periodicReport=this.patchTaskScheduling=this.callbacks=null}}Object(u.a)(oa,"InteractivityTrackerOptions",null,
[]);var Ha=a(897);const ka=(Qa,Ma)=>No(function*(){return M.EwaSettings.isChangeGateEnabled("OfficeVSO:8428325_ExtractChunkLoading")?Object(Ha.a)("interactivity",Ma):J.a.resolve(D.Eb,Ma).then($c=>$c("interactivity"))});Object(J.b)(D.yd,{yk:"singleton"})(Qa=>No(function*(){const Ma=yield J.a.resolve(D.Lb,Qa);yield ka(Ma,Qa);const $c=interactivity.InteractivityTrackerFactoryGlobal.create();return new wa(Ma,$c)}));class wa{constructor(Qa,Ma){this.qM=void 0===Ma?null:Ma;wa.QFc?N.ULS.sendTraceTag(537155545,
0,50,"InteractivityTrackerService: instance was already created once. skipping initialization."):(this.initialize(Qa),wa.QFc=!0)}initialize(Qa){N.ULS.sendTraceTag(555360983,0,15,"InteractivityTrackerService: starting InteractivityTracker");if(this.qM){const Ma=new oa;M.EwaSettings.IXd()&&wa.wZc.push(la.a.aua);wa.wZc.push("mouseup");wa.wZc.push("touchstart");Ma.events=wa.wZc;Ma.durationThresholdInMs=wa.durationThresholdInMs;Ma.callbacks=new Da(Qa);M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackAsyncUI",
!1)&&(Ma.asyncUiTracking={slowUiEventThresholdMs:M.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.SlowUIEventThresholdMs",500),asyncUiEventTimeoutMs:M.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.AsyncUIEventTimeoutMs",3E4),allowedAsyncUiNames:[...Ya],slowActionTimeoutOverrides:[]});Ma.periodicReport={isPassiveTestEnabled:!1,intervalMs:6E4};M.EwaSettings.isChangeGateEnabled("OfficeVSO:8570179_TrackingScrollAnimation")&&(Ma.animationTracking={chunkDurationMs:M.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.TrackingScrollAnimationChunkDurationMs",
100),minFramesPerChunk:M.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.TrackingScrollAnimationMinFramesPerChunk",3),animationTimeoutMs:M.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.animationTimeoutMs",5E3)});Qa=this.qM.start(Ma);Qa.started?N.ULS.sendTraceTag(537155543,0,50,"InteractivityTrackerService: InteractivityTracker started"):N.ULS.sendTraceTag(537155542,0,15,"InteractivityTrackerService InteractivityTracker start failed: "+Qa.failureReason)}else N.ULS.sendTraceTag(537155541,
0,15,"InteractivityTrackerService: InteractivityTracker not created")}ix(Qa,Ma,$c,de){if(this.qM)return this.qM.trackInteraction(Qa,Ma,$c,de);N.ULS.sendTraceTag(524326924,0,50,`InteractivityTrackerService.TrackInputEventPerf: interactivityTracker not initialized. Discarding userAction: ${Ma}`)}Hif(){return this.qM?this.qM.createActionsRetriever():(N.ULS.sendTraceTag(537155539,0,15,"InteractivityTrackerService.CreateSlowActionsRetriever: interactivityTracker not initialized."),null)}dispose(){this.qM&&
(this.qM.stop(),this.qM=null)}addContext(Qa,Ma,$c){this.qM?this.qM.addContext(Qa,Ma,$c):N.ULS.sendTraceTag(509445952,0,15,"InteractivityTrackerService.addContext: interactivityTracker not initialized.")}startTrackAnimation(Qa,Ma){return this.qM?wa.QFc?this.qM.startTrackAnimation(Qa,Ma):(N.ULS.sendTraceTag(507847813,0,50,"InteractivityTrackerService.startTrackAnimation: trying startTrackAnimation but interactivityTrackerService instance was no created."),!1):(N.ULS.sendTraceTag(508343192,0,50,"InteractivityTrackerService.startTrackAnimation: interactivityTracker not initialized."),
!1)}stopTrackAnimation(Qa){this.qM?M.EwaSettings.isChangeGateEnabled("OfficeVSO:8500180_checkIfInteractivityServiceExistsBeforeStartTracking")&&!wa.QFc?N.ULS.sendTraceTag(507847812,0,50,"InteractivityTrackerService.startTrackAnimation: trying stopTrackAnimation but interactivityTrackerService instance was no created."):this.qM.stopTrackAnimation(Qa):N.ULS.sendTraceTag(508343191,0,50,"InteractivityTrackerService.endTrackAnimation: interactivityTracker not initialized.")}}wa.durationThresholdInMs=100;
wa.wZc="click mousedown contextmenu keypress keydown dblclick touchend".split(" ");wa.QFc=!1;Object(u.a)(wa,"InteractivityTrackerService",null,[60]);var Za=a(150),ab=a(58),db=a(54);class mb{constructor(){this.order=0;this.componentName=this.name=null;this.timeFromNavigationStart=0}}Object(u.a)(mb,"ActionData",null,[]);class Ia{constructor(){this.hasBlockedActions=!1;this.blockedActions=[]}}Object(u.a)(Ia,"BlockedEngagementInfo",null,[]);class pa extends mb{constructor(){super();this.inputMethod=null;
this.isCommand=!1}}Object(u.a)(pa,"SuccessfulActionData",mb,[]);class lb{constructor(){this.successfulActions=[]}}Object(u.a)(lb,"SuccessfulEngagementInfo",null,[]);var ha=a(47),ua=a(44),fb;let Ka=fb=class{constructor(Qa){this.TXa=new Set;this.U7b=null;this.xxf=this.TVg=!1;this.Tqb=(Ma,$c)=>{this.SHb.hasBlockedActions=!0;Ma=this.SHb.blockedActions.length;const de=$c.details?$c.actionName+"_"+$c.details:$c.actionName;$c=Object(Ta.a)(new mb,{order:Ma+1,name:de,componentName:$c.componentName,timeFromNavigationStart:$c.timeFromNavigationStart});
this.SHb.blockedActions.push($c)};this.sm=()=>{ha.a(this.$).f3b(this.Tqb);this.Ewj();this.U7b=ab.a.instance.create(()=>{this.GXb()},fb.YSk,db.a.GXb)};this.Li=()=>{this.GXb()};this.Uce=()=>{this.$.ei(2009315810,-1,0,null);this.kpe=!1};this.SHb=new Ia;this.SHb.hasBlockedActions=!1;this.vwb=new lb;this.Eti();this.$=Qa;M.EwaSettings.fl()?this.$.ea.Jq(this.sm):this.$.ea.Uq(this.sm);this.$.Lp(this.Li);this.aTk=0;this.kpe=!1;M.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")&&
(this.Rff=new Promise(Ma=>{this.m_h=Ma}));ha.a(this.$).Fkc(this.Tqb)}dispose(){this.$.ea&&!M.EwaSettings.fl()&&this.$.ea.dv(this.sm);this.$.Au(this.Li);n.a.Ng(this.U7b);this.$=this.U7b=null}Uck(Qa,Ma,$c){if(void 0!==Qa&&null!==Qa&&Ma){var de=this.vwb.successfulActions.length+1,Be="InputMethod"in Ma?Ma.InputMethod:"",nf="IsCommand"in Ma&&Ma.IsCommand;if(this.xqj(Qa,Ma,Be,nf)){++this.aTk===fb.d8k?(this.kpe=!0,this.A2j=ab.a.instance.create(this.Uce,5E3,db.a.Uce)):this.kpe&&this.A2j.qA();if(M.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")){const Tf=
!nf&&Qa;this.xxf||Tf===Za.a.d6g||Tf===Za.a.e6g||Tf===Za.a.Z5g||Tf===Za.a.$5g||(this.xxf=!0,this.m_h(void 0))}de>fb.x9f||(Qa=Object(Ta.a)(new pa,{order:de,name:Qa,componentName:"Location"in Ma?Ma.Location:"",timeFromNavigationStart:$c,inputMethod:Be,isCommand:nf}),this.vwb.successfulActions.push(Qa),1===de?this.zxj():de===fb.x9f&&this.GXb())}}}Ewj(){N.ULS.sendTraceTag(254546634,0,50,`${ua.c(this.SHb)}`)}zxj(){Ea.a.instance.Tfa(new Date)>fb.Tti?N.ULS.sendTraceTag(537154758,0,50,`First user interaction was filtered: ${ua.c(this.vwb.successfulActions[0])}`):
N.ULS.sendTraceTag(254563592,0,50,`${ua.c(this.vwb.successfulActions[0])}`)}GXb(){!this.TVg&&this.vwb.successfulActions.length&&(this.TVg=!0,n.a.Ng(this.U7b),this.U7b=null,this.$.sendBeaconTraceTag(254559496,50,!1,ua.c(this.vwb)))}Eti(){this.TXa.add(Za.a.Ykd);this.TXa.add(Za.a.ele);this.TXa.add(Za.a.hbe);this.TXa.add(Za.a.itg);this.TXa.add(Za.a.ktg);this.TXa.add(Za.a.mtg)}xqj(Qa,Ma,$c,de){$c=!$c||"unknown"===$c;const Be="IsSystemInitiated"in Ma&&Ma.IsSystemInitiated;Ma="NoReporting"in Ma&&Ma.NoReporting;
const nf=this.TXa.has(Qa);Qa=xa.a.equals(Qa,Za.a.hVc,!0)&&$c;return!Be&&!Ma&&!nf&&!Qa&&!(de&&$c)}};Ka.x9f=10;Ka.Tti=6E4;Ka.YSk=12E4;Ka.d8k=25;Ka=fb=Object(l.__decorate)([Object(J.d)(D.me),Object(l.__param)(0,Object(D.Lb)())],Ka);Object(u.a)(Ka,"PageLoadEngagementInfo",null,[]);var La=a(1157),ib=a(10),Yb=a(34),Wc;let Qc=Wc=class{constructor(){this.o2i=()=>{const Qa=this;return No(function*(){M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseServiceWorker",!1)?yield Qa.register():yield Qa.unregister()})};
this.init().then(()=>{N.ULS.sendTraceTag(507654145,0,50,"ServiceWorkerRegistrationManager.init: Initialization complete")}).catch(Qa=>{N.ULS.sendTraceTag(507654144,0,15,`ServiceWorkerRegistrationManager.init: Initialization failed: ${Qa}`)})}init(){const Qa=this;return No(function*(){Yb.a.iKh&&navigator.serviceWorker.getRegistrations?(Ea.a.instance.ym("ServiceWorkerSupported"),navigator.serviceWorker.controller&&Ea.a.instance.ym("ServiceWorkerControlled"),yield Qa.o2i(),Qa.JIh()):Ea.a.instance.ym("ServiceWorkerNotSupported")})}register(){return No(function*(){try{const Qa=
yield navigator.serviceWorker.register(`${ib.a.Exk}`);N.ULS.sendTraceTag(507795410,0,15,`ServiceWorkerRegistrationManager.register: Registration succeeded. workerState = ${Qa.active?"active":Qa.waiting?"waiting":Qa.installing?"installing":"none"}, scope = ${Qa.scope}`)}catch(Qa){N.ULS.sendTraceTag(507795409,0,15,`ServiceWorkerRegistrationManager.register: call to serviceWorker.register failed: ${Qa}`)}})}unregister(){return No(function*(){try{const Qa=yield navigator.serviceWorker.getRegistrations();
for(const Ma of Qa)(yield Ma.unregister())?N.ULS.sendTraceTag(507795408,0,15,"ServiceWorkerRegistrationManager.unregister: Unregistration succeeded"):N.ULS.sendTraceTag(507795407,0,10,"ServiceWorkerRegistrationManager.unregister: Unregistration failed")}catch(Qa){N.ULS.sendTraceTag(507795406,0,50,`ServiceWorkerRegistrationManager.unregister: call to serviceWorker.unregister failed: ${Qa}`)}})}static D2i(Qa){try{const Ma=Date.now(),$c=JSON.parse(Qa.data).serviceWorkerTime;N.ULS.sendTraceTag(507606657,
0,50,`ServiceWorkerRegistrationManager.handleServiceWorkerHeartbeatMessage: delta between sending message from SW to processing message in main thread: ${Ma-$c}`)}catch(Ma){N.ULS.sendTraceTag(507606656,0,10,`ServiceWorkerRegistrationManager.handleServiceWorkerHeartbeatMessage: failed: ${Ma}`)}}static E2i(Qa){M.EwaSettings.isChangeGateEnabled("OfficeVSO:8617694_HandleServiceWorkerHeartbeat")&&Qa.data.includes("heartbeat")?Wc.D2i(Qa):N.ULS.sendTraceTag(507795405,0,50,`ServiceWorkerRegistrationManager.handleServiceWorkerMessage: ${Qa.data}`)}JIh(){navigator.serviceWorker.addEventListener("message",
Wc.E2i)}};Qc=Wc=Object(l.__decorate)([Object(J.d)(D.rf)],Qc);Object(u.a)(Qc,"ServiceWorkerRegistrationManager",null,[]);var Wb=a(208),Jc=a(214),ma=a(111);class Hc{constructor(Qa,Ma,$c){this.e$k=Qa;this.L4=Ma;this.name=$c}}Object(u.a)(Hc,"Validation",null,[]);var Kb;let pc=Kb=class{constructor(Qa){this.$pb=()=>{this.hrg(this.Mxf)};this.Xo=()=>{this.hrg(this.SIh)};this.$=Qa;this.SIh=new Wb.a;this.Mxf=new Wb.a;Q.f(this.$).za.Uy(this.Xo);Q.f(this.$).za.j0e(this.$pb)}Kld(Qa,Ma,$c,de,Be){if(Qa&&de){const nf=
Jc.a.vI(Ma,$c);this.Ljc(()=>!!ma.a(Qa).ky(nf),de.StateId,Be)}}Ljc(Qa,Ma,$c){this.Twh(this.Mxf,Qa,Ma,$c)}Twh(Qa,Ma,$c,de){Qa&&Ma&&$c!==ib.a.kk&&Qa.add(new Hc(Ma,$c,de))}hrg(Qa){if(Qa){var Ma=new Wb.a;for(const $c of Qa){if($c.L4===this.$.ea.gk)try{$c.e$k()||N.ULS.sendTraceTag(537151010,0,15,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation result is false. Validation Name: [${$c.name}]`)}catch(de){N.ULS.sendTraceTag(537151009,0,10,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation has caused an exception to be thrown. Validation Name: [${$c.name}]. Exception: [${de}]`)}Ma.add($c)}for(const $c of Ma)Qa.remove($c)}else N.ULS.shipAssertTag(537151011,
0,!!Qa,"ValidationTelemetryManager.PerformAndRemoveValidations: Validation list is null")}dispose(){Q.f(this.$)&&Q.f(this.$).za&&(Q.f(this.$).za.Ix(this.Xo),Q.f(this.$).za.Ofe(this.$pb));this.$=null}static Aa(Qa){const Ma=new Kb(Qa);Qa.ka.ph(277,Ma)}};pc=Kb=Object(l.__decorate)([Object(J.d)(D.yg),Object(l.__param)(0,Object(D.Lb)())],pc);Object(u.a)(pc,"ValidationTelemetryManager",null,[646,2]);let $b=class{constructor(Qa){this.l4a=void 0;this.f9f=()=>{this.z5g(!0)};this.e9f=()=>{this.z5g(!1)};this.a1=
(Ma,$c)=>{$c.T5d!==ib.a.kk&&(this.l4a=$c.KGj===ib.a.kk?this.$.ea.pD:$c.T5d)};this.SYc=new Map;Qa.ea.EL(this.a1);this.da=Q.f(Qa);this.$=Qa}YBj(Qa){this.SYc.set(this.$.ea.pD,Qa);this.Auh()}z5g(Qa){if(void 0!==this.l4a&&this.SYc.has(this.l4a)){const Ma=this.SYc.get(this.l4a);this.Byj(Ma,this.l4a,Qa);this.SYc.delete(this.l4a)}else this.Ayj(this.l4a);this.$gk()}Byj(Qa,Ma,$c){N.ULS.sendTraceTag(507623310,1,20,`VirtualGetRangeTelemetryManager.logPrefetchResult. PrefetchResult is ${$c} for the operation with the details OpName ${Qa} and stateId ${Ma}`)}Ayj(Qa){N.ULS.sendTraceTag(507623309,
1,20,`VirtualGetRangeTelemetryManager.logPrefetchErrorForStateId. currentStateID ${Qa} is not present in StateIdToOperationData`)}Auh(){this.da.Jp.mBh(this.f9f);this.da.Jp.lBh(this.e9f)}$gk(){this.da.Jp.xlk(this.f9f);this.da.Jp.wlk(this.e9f)}};$b=Object(l.__decorate)([Object(J.d)(D.Eg),Object(l.__param)(0,Object(D.Lb)())],$b);Object(u.a)($b,"VirtualGetRangeTelemetryManager",null,[645]);class Ib{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=
this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(u.a)(Ib,"BrowserInfo",
null,[]);class Zb{constructor(){this.Version=this.Name=null}}Object(u.a)(Zb,"PluginInfo",null,[]);class Eb{static o0d(){if(K.AFrameworkApplication.fa.la("LogBrowserInfoIsEnabled")){var Qa=Eb.Wyi();try{const Ma=JSON.stringify(Qa);N.ULS.sendTraceTag(6903563,102,50,Ma)}catch(Ma){N.ULS.sendTraceTag(6903564,102,15,Ma.message)}}else N.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static CQi(){const Qa=window.navigator.plugins;if(!Qa||!Qa.length)return null;const Ma=[];for(let $c=
0;$c<Qa.length;$c++){const de=Qa[$c].name,Be=Qa[$c].version;Array.add(Ma,Object.assign(new Zb,{Name:de,Version:Be}))}return Ma}static Wyi(){const Qa=new Ib,Ma=new Sys.StringBuilder;Eb.gC($c=>{Qa.DocElemClientHeight=$c},()=>document.documentElement.clientHeight,Ma);Eb.gC($c=>{Qa.DocElemClientWidth=$c},()=>document.documentElement.clientWidth,Ma);Eb.gC($c=>{Qa.DocElemOffsetHeight=$c},()=>document.documentElement.offsetHeight,Ma);Eb.gC($c=>{Qa.DocElemOffsetWidth=$c},()=>document.documentElement.offsetWidth,
Ma);Eb.gC($c=>{Qa.ScreenAvailHeight=$c},()=>window.screen.availHeight,Ma);Eb.gC($c=>{Qa.ScreenAvailWidth=$c},()=>window.screen.availWidth,Ma);Eb.gC($c=>{Qa.ScreenWidth=$c},()=>window.screen.width,Ma);Eb.gC($c=>{Qa.ScreenHeight=$c},()=>window.screen.height,Ma);Eb.gC($c=>{Qa.ScreenLogicalXdpi=$c},()=>window.screen.logicalXDPI,Ma);Eb.gC($c=>{Qa.ScreenLogicalYdpi=$c},()=>window.screen.logicalYDPI,Ma);Eb.gC($c=>{Qa.ScreenDeviceXdpi=$c},()=>window.screen.deviceXDPI,Ma);Eb.gC($c=>{Qa.ScreenDeviceYdpi=$c},
()=>window.screen.deviceYDPI,Ma);Eb.gC($c=>{Qa.WinInnerHeight=$c},()=>window.self.innerHeight,Ma);Eb.gC($c=>{Qa.WinInnerWidth=$c},()=>window.self.innerWidth,Ma);Eb.gC($c=>{Qa.WinOuterHeight=$c},()=>window.self.outerHeight,Ma);Eb.gC($c=>{Qa.WinOuterWidth=$c},()=>window.self.outerWidth,Ma);Eb.gC($c=>{Qa.WinOrientation=$c},()=>window.self.orientation,Ma);Eb.gC($c=>{Qa.WinDevicePixelRatio=$c},()=>window.self.devicePixelRatio,Ma);Eb.gC($c=>{Qa.SupportsTouch=$c},()=>Yb.a.zZc,Ma);Eb.gC($c=>{Qa.NavAppName=
$c},()=>window.navigator.appName,Ma);Eb.gC($c=>{Qa.NavAppVersion=$c},()=>window.navigator.appVersion,Ma);Eb.gC($c=>{Qa.NavLanguage=$c},()=>window.navigator.browserLanguage||window.navigator.language,Ma);Eb.gC($c=>{Qa.NavUserAgent=$c},()=>window.navigator.userAgent,Ma);Eb.gC($c=>{Qa.NavPlatform=$c},()=>window.navigator.platform,Ma);Eb.gC($c=>{Qa.NavPlugins=$c},Eb.CQi,Ma);Eb.gC($c=>{Qa.CalculatedDevicePixelRatio=$c},()=>Eb.devicePixelRatio,Ma);Qa.Error=Ma.toString();return Qa}static get devicePixelRatio(){const Qa=
window.devicePixelRatio;return isNaN(Qa)?window.screen.deviceXDPI/window.screen.logicalXDPI:Qa}static gC(Qa,Ma,$c){try{const de=Ma();Qa(de)}catch(de){$c.isEmpty()||$c.append(" | "),$c.append(de.message||"null")}}}Object(u.a)(Eb,"BrowserInfoLogger",null,[]);var ob=a(278);class Na{get name(){return"Common.App.BrowserInfoLogger"}ao(){}init(){Eb.o0d()}dispose(){}static main(){ob.a.instance.Lo(new Na)}}Object(u.a)(Na,"BrowserInfoLoggerPackage",null,[12,13]);var nb=a(81);class Hb{constructor(Qa){this.g5c=
Qa}oVf(Qa){if(!this.g5c)return!0;Qa=nb.a.OJd(Qa);if(!Qa)return!1;Qa=Qa.toLowerCase();for(let Ma=0;Ma<this.g5c.length;Ma++)if(Qa.endsWith(this.g5c[Ma]))return!0;return!1}}Object(u.a)(Hb,"DomainAllowListManager",null,[]);class na{constructor(Qa,Ma){this.m4=null;this.mjd=Qa;this.url=Ma}get Jxe(){return nb.a.Dba(this.url)}get Dz(){return this.mjd}pue(){const Qa={},Ma=this.Dz;Qa.a=this.Jxe;Qa.b=this.round(Ma.navigationStart);Qa.c=this.round(Ma.unloadEventStart);Qa.d=this.round(Ma.unloadEventEnd);Qa.e=
this.round(Ma.redirectStart);Qa.f=this.round(Ma.redirectEnd);Qa.g=this.round(Ma.fetchStart);Qa.h=this.round(Ma.domainLookupStart);Qa.i=this.round(Ma.domainLookupEnd);Qa.j=this.round(Ma.connectStart);Qa.k=this.round(Ma.connectEnd);Qa.l=void 0!==Ma.secureConnectionStart&&null!==Ma.secureConnectionStart?this.round(Ma.secureConnectionStart):0;Qa.m=this.round(Ma.requestStart);Qa.n=this.round(Ma.responseStart);Qa.o=this.round(Ma.responseEnd);Qa.q=this.round(Ma.domInteractive);Qa.r=this.round(Ma.domContentLoadedEventStart);
Qa.s=this.round(Ma.domContentLoadedEventEnd);Qa.t=this.round(Ma.domComplete);Qa.u=this.round(Ma.loadEventStart);Qa.v=this.round(Ma.loadEventEnd);Qa.w=this.m4;return Qa}round(Qa){return Math.round(1E3*Qa)/1E3}}Object(u.a)(na,"PerformanceTimingEntry",null,[]);const Gb=(Qa,Ma)=>{var $c,de;const Be={};let nf=null;switch(Qa){case 0:nf="ResourceTiming";Qa=Ma.a;null!=Qa&&(Be.Url=Qa);Qa=Ma.b;null!=Qa&&(Be.InitiatorType=Qa);Qa=null==Ma.c?null:Ma.c.toString();null!=Qa&&(Be.RedirectStart=Qa);Qa=null==Ma.d?null:
Ma.d.toString();null!=Qa&&(Be.RedirectEnd=Qa);Qa=null==Ma.e?null:Ma.e.toString();null!=Qa&&(Be.FetchStart=Qa);Qa=null==Ma.f?null:Ma.f.toString();null!=Qa&&(Be.DomainLookupStart=Qa);Qa=null==Ma.g?null:Ma.g.toString();null!=Qa&&(Be.DomainLookupEnd=Qa);Qa=null==Ma.h?null:Ma.h.toString();null!=Qa&&(Be.ConnectStart=Qa);Qa=null==Ma.i?null:Ma.i.toString();null!=Qa&&(Be.ConnectEnd=Qa);Qa=null==Ma.j?null:Ma.j.toString();null!=Qa&&(Be.SecureConnectionStart=Qa);Qa=null==Ma.k?null:Ma.k.toString();null!=Qa&&(Be.RequestStart=
Qa);Qa=null==Ma.l?null:Ma.l.toString();null!=Qa&&(Be.ResponseStart=Qa);Qa=null==Ma.m?null:Ma.m.toString();null!=Qa&&(Be.ResponseEnd=Qa);Qa=Ma.n;null!=Qa&&(Be.CustomText=Qa);Qa=null==Ma.o?null:Ma.o.toString();null!=Qa&&(Be.DecodedBodySize=Qa);Qa=null==Ma.p?null:Ma.p.toString();null!=Qa&&(Be.EncodedBodySize=Qa);Qa=null==Ma.q?null:Ma.q.toString();null!=Qa&&(Be.TransferSize=Qa);Ma=null!==(de=null===($c=Ma.r)||void 0===$c?void 0:$c.toString())&&void 0!==de?de:null;null!=Ma&&(Be.responseStatus=Ma);break;
case 1:nf="PerformanceTiming",$c=Ma.a,null!=$c&&(Be.Url=$c),$c=null==Ma.b?null:Ma.b.toString(),null!=$c&&(Be.NavigationStart=$c),$c=null==Ma.c?null:Ma.c.toString(),null!=$c&&(Be.UnloadEventStart=$c),$c=null==Ma.d?null:Ma.d.toString(),null!=$c&&(Be.UnloadEventEnd=$c),$c=null==Ma.e?null:Ma.e.toString(),null!=$c&&(Be.RedirectStart=$c),$c=null==Ma.f?null:Ma.f.toString(),null!=$c&&(Be.RedirectEnd=$c),$c=null==Ma.g?null:Ma.g.toString(),null!=$c&&(Be.FetchStart=$c),$c=null==Ma.h?null:Ma.h.toString(),null!=
$c&&(Be.DomainLookupStart=$c),$c=null==Ma.i?null:Ma.i.toString(),null!=$c&&(Be.DomainLookupEnd=$c),$c=null==Ma.j?null:Ma.j.toString(),null!=$c&&(Be.ConnectStart=$c),$c=null==Ma.k?null:Ma.k.toString(),null!=$c&&(Be.ConnectEnd=$c),$c=null==Ma.l?null:Ma.l.toString(),null!=$c&&(Be.SecureConnectionStart=$c),$c=null==Ma.m?null:Ma.m.toString(),null!=$c&&(Be.RequestStart=$c),$c=null==Ma.n?null:Ma.n.toString(),null!=$c&&(Be.ResponseStart=$c),$c=null==Ma.o?null:Ma.o.toString(),null!=$c&&(Be.ResponseEnd=$c),
$c=null==Ma.p?null:Ma.p.toString(),null!=$c&&(Be.DomLoading=$c),$c=null==Ma.q?null:Ma.q.toString(),null!=$c&&(Be.DomInteractive=$c),$c=null==Ma.r?null:Ma.r.toString(),null!=$c&&(Be.DomContentLoadedEventStart=$c),$c=null==Ma.s?null:Ma.s.toString(),null!=$c&&(Be.DomContentLoadedEventEnd=$c),$c=null==Ma.t?null:Ma.t.toString(),null!=$c&&(Be.DomComplete=$c),$c=null==Ma.u?null:Ma.u.toString(),null!=$c&&(Be.LoadEventStart=$c),$c=null==Ma.v?null:Ma.v.toString(),null!=$c&&(Be.LoadEventEnd=$c),Ma=Ma.w,null!=
Ma&&(Be.CustomText=Ma)}Be.Table=nf;return Sys.Serialization.JavaScriptSerializer.serialize(Be)};var Xa=a(56),Jb=a(173),qb=a(483);class Db{constructor(Qa,Ma,$c){this.cI=Qa;this.Ixe=this;this.jih=(void 0===Ma?null:Ma)||(()=>window.location.href);this.p8c=new Hb(void 0===$c?null:$c)}run(){if(Db.K3(window.performance))try{const Be=this.jih();if(Db.Vqh.exec(Be)&&this.p8c.oVf(Be)){var Qa=new na(window.performance.timing,Be);qb.a.instance.ock(Qa.Dz.fetchStart);qb.a.instance.pck(Qa.Dz.navigationStart);qb.a.instance.tYb(Xa.a.Sxi,
"connectStart","requestStart");qb.a.instance.tYb(Xa.a.$xi,"requestStart","responseStart");qb.a.instance.tYb(Xa.a.cyi,"responseStart","responseEnd");this.Ixe.tl(1,Qa.pue());this.cI.Gs(Xa.a.nIa,Qa.Dz.fetchStart);this.cI.Gs(Xa.a.Xxi,Qa.Dz.domainLookupStart);this.cI.Gs(Xa.a.Wxi,Qa.Dz.domainLookupEnd);this.cI.Gs(Xa.a.Uxi,Qa.Dz.connectStart);this.cI.Gs(Xa.a.dyi,Qa.Dz.secureConnectionStart);this.cI.Gs(Xa.a.Txi,Qa.Dz.connectEnd);this.cI.Gs(Xa.a.ayi,Qa.Dz.requestStart);this.cI.Gs(Xa.a.MOb,Qa.Dz.responseStart);
this.cI.Gs(Xa.a.Yxi,Qa.Dz.responseEnd-Qa.Dz.responseStart);this.cI.Gs(Xa.a.byi,Qa.Dz.responseStart-Qa.Dz.requestStart);var Ma=0,$c=0,de=0;(()=>{let nf=this.$_k(Be);({transferSize:Ma,rBd:$c,Iyd:de}=nf);return nf})().returnValue&&(this.cI.Gs(Xa.a.eyi,Ma),this.cI.Gs(Xa.a.Vxi,de),this.cI.Gs(Xa.a.Zxi,$c));this.cI.Gs(Xa.a.sGd,Qa.Dz.navigationStart)}}catch(Be){N.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",Be)}}$_k(Qa){let Ma,$c,de;de=$c=Ma=-1;if(void 0===window.performance.getEntriesByName||
null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:Ma,rBd:$c,Iyd:de};Qa=window.performance.getEntriesByName(Qa,"navigation");if(void 0===Qa||null===Qa||1!==Qa.length)return{returnValue:!1,transferSize:Ma,rBd:$c,Iyd:de};Qa=Qa[0];var Be=Qa.transferSize;void 0!==Ma&&null!==Ma&&(Ma=Be);Be=Qa.decodedBodySize;void 0!==Be&&null!==Be&&(de=Be);Qa=Qa.encodedBodySize;void 0!==Qa&&null!==Qa&&($c=Qa);return{returnValue:!0,transferSize:Ma,rBd:$c,Iyd:de}}tl(Qa,Ma){N.ULS.sendTraceTag(4551815,
306,50,Gb(Qa,Ma))}static get instance(){return Db.Wa||(Db.Wa=new Db(Jb.a.instance,null,K.AFrameworkApplication.fa.la("PerfTimingLoggerFilterDomainsIsEnabled")?K.AFrameworkApplication.fa.aA("ResourceLoggerDomainAllowList"):null))}static K3(Qa){return!(void 0===Qa||null===Qa)&&!(void 0===Qa.timing||null===Qa.timing)}}Db.Wa=null;Db.Vqh=RegExp("^https?://.*","i");Object(u.a)(Db,"PerformanceTimingLogger",null,[668]);var gb=a(158);class ya{constructor(Qa,Ma){this.m4=null;this.mjd=Qa;this.behavior=Ma;this.url=
this.Dz.name}get Jxe(){return 2===this.behavior?this.url:nb.a.Dba(this.url)}get Dz(){return this.mjd}pue(){const Qa={},Ma=this.Dz;Qa.a=this.Jxe;Qa.b=Ma.initiatorType;Qa.c=this.round(Ma.redirectStart);Qa.d=this.round(Ma.redirectEnd);Qa.e=this.round(Ma.fetchStart);Qa.f=this.round(Ma.domainLookupStart);Qa.g=this.round(Ma.domainLookupEnd);Qa.h=this.round(Ma.connectStart);Qa.i=this.round(Ma.connectEnd);Qa.j=void 0!==Ma.secureConnectionStart&&null!==Ma.secureConnectionStart?this.round(Ma.secureConnectionStart):
0;Qa.k=this.round(Ma.requestStart);Qa.l=this.round(Ma.responseStart);Qa.m=this.round(Ma.responseEnd);Qa.o=this.round(ya.xwa(Ma,"decodedBodySize"));Qa.p=this.round(ya.xwa(Ma,"encodedBodySize"));Qa.q=this.round(ya.xwa(Ma,"transferSize"));Qa.n=this.m4;Qa.r=ya.xwa(Ma,"responseStatus")||0;return Qa}round(Qa){return Math.round(1E3*Qa)/1E3}static xwa(Qa,Ma){return Qa[Ma]}}Object(u.a)(ya,"ResourceTimingEntry",null,[676]);var Aa=a(107),sb=a(201),nc=a(94);class Bb{constructor(Qa,Ma,$c){this.CVe=!1;this.QDe=
Qa;this.Vhc=void 0===Ma?null:Ma;this.uCa={};this.Meh=void 0===$c?100:$c;this.DDe=K.AFrameworkApplication&&K.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableAdvancedNetworkLogging",!1)}l_k(Qa){var Ma=Qa.name.toLowerCase();const $c=nb.a.Ofa(Ma);this.oFg($c,Ma)&&($c in this.uCa?N.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",$c):(Ma={},Ma.starttime=Qa.startTime,Ma.workerstart=Qa.workerStart,Ma.redirectstart=Qa.redirectStart,
Ma.redirectend=Qa.redirectEnd,Ma.fetchstart=Qa.fetchStart,Ma.domainlookupstart=Qa.domainLookupStart,Ma.domainlookupend=Qa.domainLookupEnd,Ma.connectstart=Qa.connectStart,Ma.secureconnectionstart=Qa.secureConnectionStart,Ma.connectend=Qa.connectEnd,Ma.requeststart=Qa.requestStart,Ma.responsestart=Qa.responseStart,Ma.responseend=Qa.responseEnd,Ma.iscached=this.n0f(Qa),Ma.nexthopprotocol=Qa.nextHopProtocol,Ma.encodedsize=ya.xwa(Qa,"encodedBodySize"),Ma.decodedsize=ya.xwa(Qa,"decodedBodySize"),this.uCa[$c]=
Ma))}m_k(Qa){var Ma=Qa.name.toLowerCase();const $c=nb.a.Ofa(Ma);this.Ppk($c,Ma)&&($c in this.uCa?N.ULS.sendTraceTag(508925201,306,50,"AppStaticResourceManager: file downloaded multiple times for filename: {0}",$c):(Ma={},Ma.starttime=Qa.startTime,Ma.workerstart=Qa.workerStart,Ma.redirectstart=Qa.redirectStart,Ma.redirectend=Qa.redirectEnd,Ma.fetchstart=Qa.fetchStart,Ma.domainlookupstart=Qa.domainLookupStart,Ma.domainlookupend=Qa.domainLookupEnd,Ma.connectstart=Qa.connectStart,Ma.secureconnectionstart=
Qa.secureConnectionStart,Ma.connectend=Qa.connectEnd,Ma.requeststart=Qa.requestStart,Ma.responsestart=Qa.responseStart,Ma.responseend=Qa.responseEnd,Ma.iscached=this.n0f(Qa),Ma.nexthopprotocol=Qa.nextHopProtocol,Ma.encodedsize=ya.xwa(Qa,"encodedBodySize"),Ma.decodedsize=ya.xwa(Qa,"decodedBodySize"),Ma.it=Qa.initiatorType,Ma.ress=Qa.responseStart,Ma.cs=Qa.connectStart,Ma.ce=Qa.connectEnd,Ma.dls=Qa.domainLookupStart,Ma.dle=Qa.domainLookupEnd,Ma.rs=Qa.redirectStart,Ma.re=Qa.redirectEnd,Ma.reqs=Qa.requestStart,
Ma.scs=Qa.secureConnectionStart,this.uCa[$c]=Ma))}oFg(Qa,Ma){if(this.QDe)return Array.contains(this.QDe,Qa);if(this.Vhc)for(Qa=nb.a.sU(Ma),Ma=0;Ma<this.Vhc.length;Ma++)if(this.Vhc[Ma]&&Qa.endsWith(this.Vhc[Ma]))return!0;return!1}Ppk(Qa,Ma){return this.oFg(Qa,Ma)?Qa.endsWith(".js")||Qa.endsWith(".css"):!1}n0f(Qa){try{const Ma=ya.xwa(Qa,"transferSize");if(void 0!==Ma&&null!==Ma)return!Ma;N.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");
return Qa.responseEnd-Qa.fetchStart<this.Meh}catch(Ma){N.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",Ma.message)}return!1}Sck(){if(nc.a.qm(this.uCa))N.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else if(K.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.StaticResourceMetricsForKpiLogOnlyOnce",!1)&&this.CVe)N.ULS.sendTraceTag(507581086,
306,15,"Static Resource Metrics already logged in KPI");else{var Qa=K.AFrameworkApplication.flightId?K.AFrameworkApplication.flightId.split(";"):[],Ma=Object.assign({},{extendedProperties:sb.a.ey()});Ma.extendedProperties.set("Flights",ua.c(Qa));this.Txj(Ma,this.uCa,Aa.Health.instance);this.CVe=!0}}vHd(Qa){var Ma,$c;let de=0,Be=0,nf=0,Tf=0,Xf=0;const zg=this.uCa;for(const pg in zg){var $f=pg,Ng=zg[pg];$f.endsWith(".js")&&(Ng=Object(gb.a)(Object,Ng),Ng.responseend<Qa&&(de+=1,Be+=Ng.decodedsize,Tf+=
Ng.encodedsize,nf+=Ng.iscached?0:Ng.encodedsize,$f=$f.toLowerCase(),this.DDe&&((null===($c=null===(Ma=K.AFrameworkApplication.fa)||void 0===Ma?void 0:Ma.Xa("Slice1Name"))||void 0===$c?0:$c.toLowerCase().endsWith($f))?Xf|=1:$f.endsWith(".common.js")||$f.endsWith(".othercommon.js")||$f.endsWith(".ext.js")?Xf|=2:$f.endsWith("common50.min.js")&&(Xf|=4))))}Qa={};Qa.filesLoaded=de;Qa.decodedBytes=Be;Qa.transferredBytes=nf;Qa.encodedBytes=Tf;this.DDe&&(Qa.lazyChunksLoaded=Xf);return Qa}Txj(Qa,Ma,$c){if(Ma){var de=
0,Be=0,nf=0,Tf=0,Xf=0,zg=0,$f=0,Ng=0,pg=0,Ug=0,Og=0;for(const mh in Ma){var bh=Ma[mh];try{const Tg=Object(gb.a)(Object,bh);if(!Tg)continue;const Vg=Tg.iscached?Boolean.parse(Tg.iscached.toString()):!1,nh=Tg.fetchstart?this.parseFloat(Tg.fetchstart.toString()):0,wh=(Tg.responseend?this.parseFloat(Tg.responseend.toString()):0)-nh,oh=Tg.encodedsize?this.parseFloat(Tg.encodedsize.toString()):0,gh=Tg.decodedsize?this.parseFloat(Tg.decodedsize.toString()):0;de+=wh;Tf+=oh;$f+=gh;Ug++;Vg?(nf+=wh,zg+=oh,pg+=
gh,Og++):(Be+=wh,Xf+=oh,Ng+=gh)}catch(Tg){N.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",Tg.message)}}Qa.extendedProperties.set("StaticResources",ua.c(Ma));Qa.extendedProperties.set("TotalResourceDownloadLatency",de.toString());Qa.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",Be.toString());Qa.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",nf.toString());Qa.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",
Tf.toString());Qa.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",Xf.toString());Qa.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",zg.toString());Qa.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",$f.toString());Qa.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",Ng.toString());Qa.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",pg.toString());Qa.extendedProperties.set("TotalNumberOfResourcesDownloaded",
Ug.toString());Qa.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",Og.toString());$c.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);$c.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",Qa)}}parseFloat(Qa){if(!Qa)return 0;Qa=parseFloat(Qa);return isNaN(Qa)?0:Qa}}Object(u.a)(Bb,"AppStaticResourceManager",null,[]);class uc extends Sys.EventArgs{constructor(Qa){super();this.entries=Qa}}Object(u.a)(uc,"EntriesAvailableEventArgs",
Sys.EventArgs,[]);var Pc=a(123);class wd{constructor(Qa,Ma,$c,de,Be,nf){$c=void 0===$c?null:$c;de=void 0===de?null:de;Be=void 0===Be?100:Be;nf=void 0===nf?!1:nf;this.Lbd=!1;this.iq=null;this.Uzb=0;this.Rg=new I.a;this.KQa=null;this.R2=!1;this.CWe=0;this.$j=Qa;this.JGe=0;this.Ixe=this;this.p8c=new Hb($c);this.RD=Ma;de&&(this.KQa=new Bb(null,de,Be));this.pdh=nf}get f8e(){try{return!(void 0===this.RD||null===this.RD)&&!(void 0===this.RD.getEntriesByType||null===this.RD.getEntriesByType)}catch(Qa){return N.ULS.sendTraceTag(50873240,
306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",Qa),!1}}get X8h(){return this.JGe}get isActive(){return this.R2}get eue(){return this.CWe}myh(Qa){this.Rg.addHandler(wd.RBd,Qa)}Sik(Qa){this.Rg.removeHandler(wd.RBd,Qa)}ao(Qa,Ma){const $c=this.eue!==Qa;this.CWe=Qa;this.isActive&&this.$j&&$c&&(this.wx(),this.Ol());this.JGe=Ma}activate(){!this.isActive&&this.f8e&&(this.Ol(),this.R2=!0)}deactivate(Qa){this.isActive&&(this.wx(),Qa&&this.flush(),this.R2=!1)}flush(){if(this.isActive&&
this.f8e)try{var Qa=window.performance.getEntriesByType("resource");0<Qa.length-this.Uzb&&N.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",Qa.length-this.Uzb);const Ma=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);Ma&&(window.performance.clearResourceTimings(),this.Uzb=0);const $c=[];for(let de=this.Uzb;de<Qa.length;de++)this.p8c.oVf(Qa[de].name)&&(this.KQa&&(this.pdh?
this.KQa.m_k(Qa[de]):this.KQa.l_k(Qa[de])),$c.push(new ya(Qa[de],this.X8h)));Ma||(this.Uzb=Qa.length);this.Rg.raiseEvent(wd.RBd,new uc($c));for(Qa=0;Qa<$c.length;Qa++)0!==$c[Qa].behavior&&2!==$c[Qa].behavior||this.Ixe.tl(0,$c[Qa].pue());0<$c.length&&N.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",$c.length)}catch(Ma){N.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",Ma)}}tl(Qa,Ma){N.ULS.sendTraceTag(4310804,
306,50,Gb(Qa,Ma))}nck(){this.KQa.Sck()}vHd(Qa){return this.KQa.vHd(Qa)}Ol(){this.$j&&0<this.eue&&(this.iq=new Pc.a(3,2,1E3*this.eue,()=>{this.flush()},5),this.$j.Ol(this.iq),this.Lbd=!0)}wx(){this.Lbd&&(this.$j.wx(this.iq),this.iq=null,this.Lbd=!1)}}wd.RBd="EntriesAvailable";Object(u.a)(wd,"ResourceTimingLogger",null,[659,668]);var Md=a(135);class Nd{constructor(){this.Mh=null}get name(){return"Common.ResourceTiming"}init(){F.a.instance.resolve("Common.NetworkTiming.IResourceTimingLogger");Db.instance.run()}dispose(){}ao(Qa){this.Mh=
Qa;let Ma=null;if(K.AFrameworkApplication.fa.la("ResourceLoggerFilterDomainsIsEnabled"))try{Ma=K.AFrameworkApplication.fa.aA("ResourceLoggerDomainAllowList")}catch(nf){N.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const $c=[];$c.push(nb.a.sU(Md.a.TV).toLowerCase());$c.push(nb.a.sU(Md.a.nvb).toLowerCase());const de=K.AFrameworkApplication.fa.vj("AppStaticResourceMonitorCacheThresholdInMs",100),Be=K.AFrameworkApplication.fa.la("PPTAggregateResourceTimingV2Enabled");
Qa.register(659,"Common.NetworkTiming.IResourceTimingLogger").hi().mi(()=>new wd(K.AFrameworkApplication.pp,window.performance,Ma,$c,de,Be))}static main(){ob.a.instance.Lo(new Nd)}}Object(u.a)(Nd,"ResourceTimingPackage",null,[12,13]);var ec=a(139);class gc extends Sys.EventArgs{constructor(Qa,Ma){super();this.BVk=Qa;this.actualValue=Ma}}Object(u.a)(gc,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);var Mb=a(116);class sc{constructor(){this.X9a=[];this.jGe=this.G7c=0;this.wra=null;this.Rg=
new I.a;this.Q_h=(Qa,Ma)=>{Mb.a(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.P1h(Ma.BVk,Ma.actualValue))}}init(Qa,Ma,$c){this.wra=Qa;this.G7c=Ma;this.jGe=$c;this.wra.f1e(Object(ec.a)(this,this.UMj,"onCpuMeterFrameAvailable"));this.Gzh(this.Q_h)}UMj(Qa,Ma){Ma.mbg&&(Array.enqueue(this.X9a,Ma.mbg.CP),this.X9a.length>this.jGe&&(Array.dequeue(this.X9a),this.kSh()))}kSh(){var Qa=this.X9a.length;let Ma=0;for(let $c=0;$c<Qa;$c++){const de=Array.dequeue(this.X9a);Ma+=de;Array.enqueue(this.X9a,
de)}Qa=Ma/Qa;Qa>this.G7c&&this.Rg.raiseEvent("CPTTE",new gc(this.G7c,Qa))}Gzh(Qa){this.Rg.addHandler("CPTTE",Qa)}P1h(Qa,Ma){const $c={};$c.ThresholdValue=Qa;$c.ActualValue=Ma;return $c}}Object(u.a)(sc,"CpuMeterMonitor",null,[673]);var xd=a(182);class xb{constructor(){this.S=this.T=this.M=this.C=0}}Object(u.a)(xb,"ProfileInformation",null,[]);var Lb=a(52),Rc=a(288);class nd{constructor(Qa,Ma){this.ead=!1;this.SRa={};this.$ec=void 0===Qa?0:Qa;this.ifc=void 0===Ma?0:Ma;this.Cjd=0;Lb.a.addHandler(window.self,
la.a.DCh,()=>{this.ead=!0});Lb.a.addHandler(window.self,la.a.ECh,()=>{this.ead=!1})}z2e(Qa,Ma,$c){const de=nd.generateKey(Ma,$c);de in this.SRa?Ma=this.SRa[de]:(Ma=new xb,Ma.S=$c?1:0,this.SRa[de]=Ma,this.Cjd++);Ma.C++;Ma.M=Qa>Ma.M?Qa:Ma.M;Ma.T+=Qa}Hka(Qa,Ma){this.z2e(Qa,Ma,!1);this.ead&&this.z2e(Qa,Ma,!0)}getData(){if(0<this.ifc&&this.Cjd>this.ifc)return this.BGi();const Qa=0<this.$ec,Ma={},$c=this.SRa;for(const Be in $c){var de=Be;const nf=$c[Be];this.yGg(nf);Qa&&nf.T>=this.$ec&&(Ma[de]=nf)}return Qa?
nc.a.qm(Ma)?null:Ma:this.SRa}BGi(){var Qa=0<this.$ec,Ma=[];const $c=this.SRa;for(const de in $c){const Be={key:de,value:$c[de]},nf=Be.value;(!Qa||nf.T>=this.$ec)&&Array.add(Ma,Be)}if(Ma.length>this.ifc)Ma.sort((de,Be)=>Be.value.T-de.value.T),Ma=Ma.slice(0,this.ifc);else if(!Ma.length)return null;Qa={};for(const de of Ma)Ma=de.value,this.yGg(Ma),Qa[de.key]=Ma;return Qa}yGg(Qa){Qa.M=Rc.a.Zha(Qa.M,0);Qa.T=Rc.a.Zha(Qa.T,0)}reset(){this.SRa={};this.Cjd=0}static generateKey(Qa,Ma){return Ma?Qa+" [it]":
Qa}}Object(u.a)(nd,"FunctionCallAggregator",null,[669]);class $d{}$d.kIh="BatchedOperation";$d.Cmk="Replication";$d.I0k="25";$d.Dmk="9_"+$d.kIh+"_"+$d.Cmk;Object(u.a)($d,"CpuMeterConstants",null,[]);class Td{}Object(u.a)(Td,"CpuMeterFrame",null,[]);class He extends Sys.EventArgs{constructor(Qa){super();this.mbg=Qa}}Object(u.a)(He,"CpuMeterFrameAvailableEventArgs",Sys.EventArgs,[]);class oc{}Object(u.a)(oc,"MiniTaskItemInfo",null,[]);class ld{}Object(u.a)(ld,"TaskItemInfo",null,[]);var id=a(592),fc=
a(106);class vc{static UYi(){if(!vc.Gac&&(vc.Gac=new fc.a,K.AFrameworkApplication.fa&&K.AFrameworkApplication.fa.rv("AggregatorIdDisabledList"))){const Qa=K.AFrameworkApplication.fa.aA("AggregatorIdDisabledList");for(let Ma=0;Ma<Qa.length;Ma++)vc.Gac.ga(Qa[Ma],!0)}return vc.Gac}}vc.Gac=null;Object(u.a)(vc,"DisabledAggregatorListStore",null,[]);var Tc=a(292);class Bd{constructor(Qa,Ma,$c,de,Be,nf,Tf,Xf){nf=void 0===nf?!0:nf;Tf=void 0===Tf?null:Tf;this.Hjf=Xf;this.E8=this.RVe=this.HMe=!1;this.$j=null;
if(!Qa)throw Tc.a.argument("taskManagerLazy");if(!Be)throw Tc.a.argument("dataAggregator");this.jqh=Qa;this.ved=Ma;this._id=$c;this.VKe=6E4*de;this.$bc=Be;this.WSe=nf;this.TDb=Tf;vc.UYi().Vg(this._id.toString())&&(this.E8=!0)}get bN(){return this.$j||(this.$j=this.jqh.value)}track(Qa,Ma){Ma=void 0===Ma?null:Ma;this.E8||(this.xii(),this.Ktk(),this.$bc.Hka(Qa,Ma))}Ktk(){!this.HMe&&0<this.VKe&&(this.HMe=!0,this.vIg())}vIg(){const Qa=new Pc.a(5,1,this.VKe,()=>{this.Wvk()},19,this._id.toString());this.bN.Ol(Qa)}Wvk(){!this.TDb||
this.TDb.QGk()?this.IJg():this.WSe&&this.$bc.reset();this.vIg()}IJg(){const Qa=this.$bc.getData();if(Qa){const Ma=parseInt(String(Qa.length));if(isNaN(Ma)||0<Ma)this.wVc(Qa),this.Hjf&&this.Hjf(Qa),this.WSe&&this.$bc.reset()}}wVc(Qa){N.ULS.sendTraceTag(7079840,335,50,"Aggregator: {0}",{["ID"]:this._id.toString(),["Data"]:Qa})}xii(){this.RVe||(this.ved(()=>{this.IJg()}),this.RVe=!0)}static HX(Qa,Ma,$c,de,Be,nf){return new Bd(new id.a(()=>K.AFrameworkApplication.pp),K.AFrameworkApplication.fPa,Qa,Ma,
$c,de,Be,nf)}static kjb(Qa,Ma,$c){return Bd.HX(Qa,Ma,$c,!0,null,void 0)}}Object(u.a)(Bd,"Aggregator",null,[670]);class Fd{constructor(Qa){Qa=void 0===Qa?null:Qa;this.Ju=null;this.reset();this.TDb=Qa}Hka(Qa,Ma){if(!this.TDb||this.TDb.QGk())Ma in this.Ju||(this.Ju[Ma]=[]),this.Ju[Ma].push(Qa)}getData(){return nc.a.count(this.Ju)?this.Ju:null}reset(){this.Ju={}}}Object(u.a)(Fd,"NamedValuesAggregator",null,[669]);var le=a(242);class dc{constructor(Qa,Ma,$c,de,Be){this.nTa=0;this.BN=null;this.$gc=this.AVe=
0;this.MTe=!1;this.x$a=0;this.LBb=!1;this.$Da=null;this.Sdc=0;this.wQe=new I.a;this.hqh=[];this.rW=Qa;this.idd=Ma;this.N9c=$c;this.IOe=de;K.AFrameworkApplication.fa&&K.AFrameworkApplication.fa.la("WrapSetTimeoutForTelemetryIsEnabled")&&this.OYd();this.nhh=Be;this.O9c=new nd(100);this.tlh=Bd.kjb(1,5,new Fd)}f1e(Qa){this.wQe.addHandler("OnCpuMeterFrameAvailable",Qa)}msb(Qa,Ma,$c,de){$c=(de=void 0===de?null:de)?de.priority:7;const Be=this.rW();this.start(Ma,$c);try{Qa()}finally{this.stop(Ma,de),Qa=this.rW()-
Be,this.IOe.track(Qa,Ma)}}W6(Qa,Ma){const $c=this.rW();try{Qa()}finally{Qa=this.rW()-$c,this.N9c.Hka(Qa,Ma),0<this.nTa&&this.O9c.Hka(Qa,Ma),this.IOe.track(Qa,Ma)}}Y8d(Qa){const Ma=new ld;Ma.TN=Qa.XJc;Ma.TP=Qa.priority;this.Hwg(1,Ma)}dpb(Qa){this.Sdc|=Qa}start(Qa,Ma){if(!this.nTa){this.O9c.reset();const $c=this.G0f(Qa);$c&&this.w2d(1);this.BN=new ld;this.BN.TN=Qa;this.BN.TP=Ma;this.BN.ST=(new Date).toISOString();this.BN.STS=Rc.a.Zha(this.rW(),2);$c?this.BN.UI=1:this.wlj(Qa)?this.BN.UI=2:this.BN.UI=
0}this.nTa++}w2d(Qa){this.x$a|=Qa}Dtd(Qa,Ma){this.x$a=void 0===Qa||Qa?0:this.x$a&~(void 0===Ma?0:Ma)}stop(Qa,Ma){Ma=void 0===Ma?null:Ma;let $c;this.nTa--;0>=this.nTa&&this.BN&&($c=this.rW()-this.BN.STS,this.$gc+=$c,this.idd.Hka($c,Qa),this.G0f(Qa)&&this.Dtd(!1,1),this.BN.TRT=Rc.a.Zha($c,2),Ma&&(this.BN.TQT=Rc.a.Zha(Ma.H9j,2),this.BN.TDT=Rc.a.Zha(Ma.g2f,2)),this.nhh&&(this.Hwg(0,this.BN),this.onk()),this.nTa=0);0<=Qa.indexOf($d.I0k)&&this.dpb(2);0<=Qa.indexOf($d.Dmk)&&this.dpb(4);1===(this.x$a&1)&&
this.dpb(1);2===(this.x$a&2)&&this.dpb(8)}onk(){var Qa=this.BN.TRT;if(750<Qa){let $c=this.O9c.getData();if($c){const de={};for(const Be in $c){var Ma=$c[Be];const nf=Be;nf.startsWith("SiOp_")||nf.endsWith("[it]")||(de[nf]=Math.round(100*Ma.T/Qa))}$c=de}Qa=Object.assign(new oc,{B:this.BN.STS,T:Qa,S:$c});this.tlh.track(Qa,this.BN.TN)}}BPk(){var Qa=this.rW()-this.AVe,Ma=Rc.a.Zha(this.$gc/Qa*100,2);Qa=new Td;Qa.CP=Ma;Qa.II=this.Sdc;Ma=this.idd.getData();nc.a.count(Ma)&&(Qa.LRT=Ma);Ma=this.N9c.getData();
nc.a.count(Ma)&&(Qa.FP=Ma);this.wQe.raiseEvent("OnCpuMeterFrameAvailable",new He(Qa));this.jUg()}jUg(){this.idd.reset();this.N9c.reset();this.$gc=this.nTa=0;this.AVe=this.rW();this.Sdc=0;this.BN=null}run(){this.MTe?this.BPk():(this.jUg(),this.MTe=!0);this.$Da?this.$Da(Object(ec.a)(this,this.run,"run"),1E3):window.setTimeout(Object(ec.a)(this,this.run,"run"),1E3)}Hwg(Qa,Ma){Qa=this.hqh[Qa];if(!le.a.qm(Qa))for(let de=0;de<Qa.length;de++){var $c=Qa[de];const Be=$c[0];$c=$c[1];Be&&!Be(Ma)||$c(Ma)}}OYd(){if(!this.LBb){const Qa=
window.setTimeout;this.$Da=(Ma,$c)=>Qa(Ma,$c);this.LBb=!0}}G0f(Qa){return Qa.startsWith("key")||Qa.startsWith("input")}wlj(Qa){return Qa.startsWith("click")||Qa.startsWith("mouse")||Qa.startsWith("pointer")}}Object(u.a)(dc,"CpuMeter",null,[113]);class Uc{constructor(Qa){this.Szb=null;this.Fs=new xd.a;this.rW=Qa}initialize(Qa,Ma,$c,de){this.Szb||(this.Szb=new dc(this.rW,Qa,Ma,$c,void 0===de?!1:de),this.Fs.setResult(this.Szb));return this.Szb}}Object(u.a)(Uc,"CpuMeterProvider",null,[671]);class kb{constructor(Qa){this.aF=
[];this.icc=[];this._count=void 0===Qa?1:Qa}Eui(){let Qa=0;for(let Ma=0;Ma<this.aF.length;Ma++)this.aF[Ma]<this.aF[Qa]&&(Qa=Ma);return Qa}Hka(Qa,Ma){Qa=Rc.a.Zha(Qa,2);if(this.aF.length<this._count)Array.add(this.aF,Qa),Array.add(this.icc,Ma);else{var $c=this.Eui();Qa>this.aF[$c]&&(this.aF[$c]=Qa,this.icc[$c]=Ma)}}getData(){return this.aF.length?{["Vals"]:this.aF,["Desc"]:this.icc}:null}reset(){this.aF=[];this.icc=[]}}Object(u.a)(kb,"MaxDataAggregator",null,[669]);var rb=a(60);class cc{get name(){return"Common.App.CpuMeter"}ao(Qa){Qa.register(Uc,
"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").hi().mi(()=>new Uc(rb.a.rj));Qa.register(sc,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").hi().mi(()=>new sc)}init(){const Qa=K.AFrameworkApplication.fa;if(Qa.la("CpuMeterIsEnabled")&&!Qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableCpuMeter",!1)){const Ma=F.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");qb.a.instance.F3e.continueWith(()=>{cc.r$i(Qa,Ma)})}}dispose(){}static r$i(Qa,
Ma){const $c=Bd.kjb(10,5,new nd(Qa.vj("TaskManagerLoggingThreshold",0),Qa.vj("CpuMeterMaximumEntriesToLog",0)));Ma=Ma.initialize(new kb(5),new nd,$c,Qa.la("CPUMeterExposeTaskDetailsIsEnabled"));Qa.la("WordEditorInteractivePerfDisableCpuMeterFrames")||(Ma.run(),Qa.la("CpuMeterMonitorIsEnabled")&&F.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(Ma,Qa.Kfa("CpuMeterAverageCpuPercentThreshold",80),Qa.vj("CpuMeterRollingAverageFramesCount",15)));Mb.a(16827671,306,50,"Initializing CpuMeter")}static main(){ob.a.instance.Lo(new cc)}}
Object(u.a)(cc,"CpuMeterPackage",null,[12,13]);var mc=a(1148);class Sa{get name(){return"Common.App.EventsCachePackage"}ao(){}init(){mc.a.instance.init()}dispose(){}static main(){ob.a.instance.Lo(new Sa)}}Object(u.a)(Sa,"EventsCachePackage",null,[12,13]);var pb=a(9),Ac=a(420);class yd extends Ac.a{constructor(Qa){super();this.lef=!1;this.$=Qa;this.Bl()}create(){const Qa=this.$.ka,Ma=F.a.instance;if(!this.lef){this.lef=!0;let $c;$c=M.EwaSettings.isChangeGateEnabled("OfficeVSO:5135167_PostMessageOriginFixup")?
this.$.ua.DocumentHostInfo.PostMessageOrigin||V.a.HL:K.AFrameworkApplication.$Pc||V.a.HL;Ma.register(ba,"Microsoft.Office.Excel.WebUI.Client.PostMessage.EwaHostMessenger").as("Postmessage.IHostPostmessenger").hi().mi(()=>new ba(this.$,window.parent,$c,K.AFrameworkApplication.fa.la("HostSendReadyToAcceptPostMessage")))}this.Yj(Qa.Ug(21)||Qa.ph(21,Ma.resolve("Postmessage.IHostPostmessenger")))}}Object(u.a)(yd,"HostMessengerFactory",Ac.a,[]);var vb=a(125),Sc=a(180),hd=a(842),qc=a(641),Lc=a(80),bd=a(239),
jd=a(361),Yd=a(360),te=a(496),oe=a(7),Kd=a(61),Ee=a(69);class rc{constructor(Qa,Ma,$c){this.correlations=this.properties=this.operation=null;this.operation=Qa;this.properties=Ma;this.correlations=$c}static Yri(Qa,Ma,$c){const de={},Be=Kd.b();switch(Qa.command){case -1537138325:de.Action=Ma.LabelText;break;case -1104934572:de.PrevTab=Be.kp(parseInt(Ma.OldContextCommand,10));de.NextTab=Be.kp(parseInt(Ma.NewContextCommand,10));break;case 802602464:de.Origin=Ma[oe.a.zO];break;case -1027730316:case -1059615499:de.MenuType=
Ma.launcherId;break;case -236759591:case 1650812936:case 1970784898:case 1378078823:case -400966242:case 467002767:"SqmControlId"in Ma&&(de.SqmControlId=Ma.SqmControlId);break;case 1371713064:case 875133075:Ee.a.Ai in Ma&&(de.SampleTableId=Ma[Ee.a.Ai])}de.InputMethod=jd.a[Qa.method];de.Location=Yd.a[Qa.lk];de.Mode=te.a[Qa.mode];de.ParentName=Qa.tabName;de.IsSystemInitiated="IsSystemInitiated"in Ma?Ma.IsSystemInitiated:!1;de.NoReporting="NoReporting"in Ma?Ma.NoReporting:!1;"ControlIdToLog"in Ma&&(de.ControlId=
Ma.ControlIdToLog);"TerminalParentControlIdToLog"in Ma&&(de.TerminalParentControlId=Ma.TerminalParentControlIdToLog);for(const nf of Object.keys($c))de[nf]=$c[nf];return de}}Object(u.a)(rc,"InteractivityRecord",null,[]);class fd extends rc{constructor(Qa,Ma,$c){super(Qa.operation,Qa.properties,Qa.correlations);this.timeFromNavigationStart=this.timeFromAppInteractive=0;this.timeFromAppInteractive=Ma;this.timeFromNavigationStart=$c}}Object(u.a)(fd,"FirstUserInteractivityRecord",rc,[]);var Ed=a(760);
class Rd{constructor(){this.commandSurface=this.triggerMethod=vb.a.Axb}static J$i(){Rd.xib||(Rd.xib=new Ed.a(qc.a.lm()),Rd.xib.add("InputMethod"),Rd.xib.add("Location"),Rd.xib.add("Mode"))}}Rd.xib=null;Object(u.a)(Rd,"ExcelUserAction",null,[]);var Fe=a(202),Ae=a(494),We=a(152),ve=a(110);class Ze extends Lc.a{constructor(Qa){super();this.ESf=0;this.yxf=!1;this.AZd=Array(Ze.hpb);this.xrc=0;this.$=Qa;this.b0f=M.EwaSettings.isChangeGateEnabled("OfficeVSO:3683664_AddTelemetryForNonCommandActions");vb.a.UPi();
this.pna={};Ze.$ic||(Ze.$ic=new hd.a(qc.a.lm()),Ze.O9i(Ze.$ic));Rd.J$i();if(M.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback"))for(Qa=0;Qa<Ze.hpb;Qa++)this.AZd[Qa]="NA"}dispose(){this.$=this.pna=null;super.dispose()}rDg(Qa,Ma,$c){const de=Kd.b().kp(Qa.command),Be=JSON.stringify(Qa);de||N.ULS.sendTraceTag(537155555,3,50,`InteractivityLogger.ReportCommand: command name is null or empty. commandName: ${de}, command: ${Qa.command}, commandInfo: ${Be}`);Ma=rc.Yri(Qa,
Ma,$c);$c=!!Ma&&(!("IsSystemInitiated"in Ma)||!Ma.IsSystemInitiated);this.$&&this.$.ea.Ul&&$c&&mc.a.instance.dyg("OtelUserAction",new Ae.a(de,Qa.tabName,Date.now()));this.FDg(de,Ma,null,!0,!0)}lj(Qa,Ma,$c,de){this.FDg(Qa,Ma,void 0===$c?null:$c,!1,void 0===de?!1:de)}nUg(Qa){if(this.pna){++this.ESf;this.pna[Qa]||(this.pna[Qa]=[]);var Ma=this.ESf.toString();this.pna[Qa].push(Ma);N.ULS.sendTraceTag(537155553,0,50,`StartInteractivityCorrellation - '${Qa}', correlation=${Ma}`)}else N.ULS.shipAssertTag(537155554,
0,!1,`StartInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${Qa}] == null`)}ZUg(Qa){if(this.pna&&this.pna[Qa]){var Ma=this.pna[Qa],$c=Ma.pop().toString();Ma.length||delete this.pna[Qa];N.ULS.sendTraceTag(537155551,0,50,`StopInteractivityCorrellation - '${Qa}', correlation=${$c}`)}else N.ULS.shipAssertTag(537155552,0,!1,`StopInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${Qa}] == null`)}A_(Qa,Ma,$c){$c=void 0===
$c?!1:$c;return bd.b(de=>{this.lj(Qa,de(),void 0,$c)},Ze.DVk,this.xa,db.a.Jcj,!1,!Ma)}she(){let Qa="";for(let Ma=0;Ma<Ze.hpb;Ma++)Qa+=this.AZd[(this.xrc+Ze.hpb-Ma-1)%Ze.hpb]+",";N.ULS.sendTraceTag(557188890,0,15,`Last operations ${Qa}`)}h5k(Qa){Qa&&(this.AZd[this.xrc]=Qa,this.xrc=(this.xrc+1)%Ze.hpb)}Pxj(Qa,Ma,$c){K.AFrameworkApplication.tuc();const de=Qa.operation,Be=Qa.properties;void 0!==$c?void J.a.resolve(D.me,{va:0}).then(nf=>{nf.Uck(de,Be,$c)}):this.S0k(Qa);this.T0k(Qa);this.y_j(Ma,Be,de)}S0k(Qa){this.GOk(Qa)||
(this.yxf=!0,Qa=new fd(Qa,Ea.a.instance.Tfa(new Date),Object(ve.b)()),Qa=Sys.Serialization.JavaScriptSerializer.serialize(Qa),N.ULS.sendTraceTag(458261331,0,50,`${Qa}`))}GOk(Qa){const Ma=Qa.properties;Qa=Qa.operation;return this.yxf||void 0===Qa||null===Qa||Qa===Za.a.Ykd||Qa===Za.a.ele||Qa===Za.a.hbe||Fa.a.UVd(Qa)||!!Ma&&"IsSystemInitiated"in Ma&&Ma.IsSystemInitiated}T0k(Qa){M.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback")&&this.h5k(Qa.operation);Qa=Sys.Serialization.JavaScriptSerializer.serialize(Qa);
N.ULS.sendTraceTag(21542793,0,50,`${Qa}`)}y_j(Qa,Ma,$c){vb.a.dya()&&(Ma?"NoReporting"in Ma&&Ma.NoReporting||"IsSystemInitiated"in Ma&&Ma.IsSystemInitiated||!Qa&&!this.b0f||((Qa=vb.a.rn(Ma,Ze.$ic,Rd.xib))?(Ma=Ze.gsi(Ma))?Sc.a.sendUserActionEvent(vb.a.brc($c,null,Ma.triggerMethod,Ma.commandSurface,Qa)):N.ULS.sendTraceTag(537155550,0,50,"user action was null"):N.ULS.sendTraceTag(537155549,0,15,"OtelUtils.DictionaryToDataFields returned null")):N.ULS.sendTraceTag(537155548,0,50,`Not logging action telemetry because adction data was null, actionName: ${$c}`))}FDg(Qa,
Ma,$c,de,Be){const nf=Fe.a(this.$);if(this.b0f){let Xf=null;xa.a.equals(Qa,Za.a.hVc,!0)&&Ma&&"InputMethod"in Ma&&(Xf=Za.a.Jyf(Qa,Ma.InputMethod));nf.A3b(Xf||Qa,$c)}else xa.a.equals(Qa,Za.a.hVc,!0)&&Ma&&"InputMethod"in Ma&&(Qa=Za.a.Jyf(Qa,Ma.InputMethod)),nf.A3b(Qa,$c);Ma&&(Ma.IsCommand=de);const Tf="ActionRelativeTime"in Ma?Ma.ActionRelativeTime:Object(ve.b)();Object(We.e)(()=>{const Xf=new rc(Qa,Ma,this.pna);this.Pxj(Xf,Be,Tf)},this.$.xa,50)}static gsi(Qa){if(!Qa)return null;const Ma=new Rd;"InputMethod"in
Qa&&(Ma.triggerMethod=Qa.InputMethod);"Location"in Qa&&(Ma.commandSurface=Qa.Location);return Ma}static O9i(Qa){Qa?(Qa.add("Origin",2),Qa.add("InputMethod",2),Qa.add("ButtonType",2),Qa.add("selectedRange",2),Qa.add("SelectedRanges",2),Qa.add("editRange",2),Qa.add("Location",2),Qa.add("Mode",2),Qa.add("CurrentSelectionMode",2),Qa.add("Action",2),Qa.add("type",2),Qa.add("floatingObjectType",2),Qa.add("PrevTab",2),Qa.add("NextTab",2),Qa.add("DialogName",2),Qa.add("dx",3),Qa.add("dy",3),Qa.add("NumberOfSelectedRanges",
3),Qa.add("IsCommand",1),Qa.add("IsInFormulaBarEdit",1),Qa.add("isLink",1),Qa.add("isSheetRef",1),Qa.add("isEmptyText",1),Qa.add("isFormula",1),Qa.add("IsResizingHiddenHeader",1)):N.ULS.sendTraceTag(537155547,0,15,"InitTypeSpecifier was passed in a null dictionary")}}Ze.DVk=1E3;Ze.hpb=40;Ze.$ic=null;Object(u.a)(Ze,"InteractivityLogger",Lc.a,[29]);var Oe=a(79),Nf=a(85),Zf=a(143),Rb=a(591),Vb=a(90),Cc=a(65),rg=a(304),yf=a(40),jg=a(39),If=a(260);class cf extends Sys.EventArgs{constructor(Qa){super();
this.wO=Qa}}Object(u.a)(cf,"ErrorDataArgs",Sys.EventArgs,[]);var Nb=a(764);class Bc{constructor(Qa,Ma){this.ybc=null;this.Rrc=this.CPd=!1;this.ZTe=this.$Te=null;this.blb=this.alb=0;this.HIg=Qa;this.eRe=Ma}get iqg(){return this.eRe}get A4b(){return this.$Te}get GIg(){return this.ZTe}get Xrj(){return this.I9e(this.HIg.getTime())}get E0j(){return this.I9e(this.GIg.getTime())}get DPg(){return!(this.Rrc||void 0===window.bsqmXLSPageLoadStartTime)}get $td(){try{return this.ybc||(this.ybc=B.toUtc(window.bsqmXLSPageLoadStartTime)),
this.ybc}catch(Qa){return null}}set $td(Qa){this.ybc=Qa}XCk(Qa){this.Rrc||(this.$Te=Qa,this.ZTe=B.toUtc(this.A4b))}w6i(Qa){if(Qa.Values&&(!this.alb||!this.blb))try{Y.a.HPf in Qa.Values&&(this.alb=parseInt(Qa.Values[Y.a.HPf].toString(),10));Y.a.IPf in Qa.Values&&(this.blb=parseInt(Qa.Values[Y.a.IPf].toString(),10));const Ma=qb.a.instance;0<this.alb&&(this.K5f(this.alb,"PageLoadFromHostClick"),Ma.Wck(this.alb));0<this.blb&&(this.K5f(this.blb,"PageLoadFromHostFrameCreation"),Ma.Yck(this.blb));const $c=
Qa.Values[Y.a.z6i]||0,de=Qa.Values[Y.a.x6i]||Qa.Values[Y.a.y6i]||0;0<de&&Ma.Ack(de);Ma.Bck($c)}catch(Ma){}}cpk(){this.HIg=this.$td=z.a.Tg.Wh;this.eRe=0;this.CPd=this.Rrc=!1}I9e(Qa){const Ma=this.$td.getTime();return Ma>=Qa?0:Qa-Ma+this.iqg}K5f(Qa,Ma){if(Qa){const $c=Kd.b();$c.MYc("UserAction",Ma,Ma,z.a.f2d(Qa),Nb.EcmaDateClock.instance.appStart);$c.quc(Ma,B.toTimestamp(this.A4b))}}}Object(u.a)(Bc,"PageLoadPerfInfo",null,[]);var Ob=a(74);class zc{constructor(Qa,Ma,$c){this.gid=Qa.keyCode;this.q5b(Qa.ctrlKey,
1);this.q5b(Qa.shiftKey,2);this.q5b(Qa.altKey,4);this.q5b(Ob.b(Qa),8);this.q5b($c,16);this.gid=this.kwb|Ma<<24}get kwb(){return this.gid}get keyCode(){return this.kwb&65535}q5b(Qa,Ma){Qa&&(this.gid=this.kwb|Ma<<16)}}Object(u.a)(zc,"ShortcutSqmData",null,[]);class od{constructor(){this.c1d=null;this.PVh={["0"]:0,["1"]:1,["2"]:2,["4"]:3,["8"]:4,["16"]:5,["32"]:6};this.TEg()}AQh(Qa,Ma,$c){0===$c&&($c=this.PVh[Ma.toString()]);return od.shouldLog(Qa,$c)&&(Qa=new zc(Qa,$c,Yb.a.isMac),!jg.a.Em(this.c1d,
Qa.kwb.toString()))?(this.c1d[Qa.kwb.toString()]=!0,Qa):null}TEg(){this.c1d={}}static ljj(Qa){return 112<=Qa&&123>=Qa||61440<=Qa&&61451>=Qa}static blj(Qa){return 17!==Qa&&18!==Qa&&16!==Qa&&91!==Qa&&93!==Qa}static shouldLog(Qa,Ma){let $c=Qa.ctrlKey||Qa.altKey||Ob.b(Qa);Qa=Qa.keyCode;$c=od.ljj(Qa)||$c;$c=od.blj(Qa)&&$c;return 0!==Ma&&$c}}Object(u.a)(od,"UnhandledShortcutLogger",null,[]);class ce{constructor(Qa){this.upc=[];this.VDh=null;this.sqmManager=Qa}Fjc(Qa){this.upc.push(Qa)}Maa(Qa,Ma,$c){try{if(Ma)Ma.endTime=
$c,this.sqmManager.zZe(Ma);else for(let de=0,Be=this.upc.length;de<Be;de++){const nf=this.upc[de];Qa?(nf.endTime=nf.startTime,nf.wdf=0):nf.endTime=$c;this.sqmManager.zZe(nf)}}catch(de){}finally{this.upc.length=0}}}Object(u.a)(ce,"UserInteractionPerfInfo",null,[]);var Qb=a(36),Xc=a(75),md=a(257);class ie extends Lc.a{constructor(Qa,Ma){super();this.sOd=this.D3b=!1;this.GPg=!0;this.Og=new v.a;this.K7c=!1;this.Li=()=>{const $c=Xc.a(this.$).ij.activityState,de=jg.a.Em($c,Qb.a.fZe);jg.a.Em($c,Qb.a.sFb)||
de||this.upload()};this.$=Qa;this.GPb=Ma;this.ea=Qa.ea;this.$.Lp(this.Li);this.x0g=new od;this.H3a=new Bc(Fa.a.lke,Qa.ua.PageGenerationMetrics.TimeToCompleteFirstFlush);this.j2c=new ce(this)}vmd(Qa){this.Og.addHandler("EREK",Qa)}Xfe(Qa){this.Og.removeHandler("EREK",Qa)}get J7h(){return this.K7c}get Fcj(){return this.$.frame.J0?ib.a.Hcj:ib.a.Gcj}get workbookContext(){return this.$.workbookContext}get L3(){ie.fzb||(ie.fzb=this.$pf());ie.erd||(ie.erd=!0,this.IRf());return ie.fzb}set L3(Qa){ie.fzb=Qa;
ie.fzb||(ie.erd=!1)}get sea(){return Vb.a(this.$.ua,3)}dispose(){this.J7h&&K.AFrameworkApplication.Gt&&K.AFrameworkApplication.Gt.disable();this.$&&this.$.Au(this.Li);this.$=this.j2c=this.H3a=this.L3=null;super.dispose()}vMf(Qa){this.H3a.w6i(Qa);this.Gxj()}Qle(Qa){this.setDw(9415,Qa)}Fjc(Qa){this.j2c.Fjc(Qa)}Maa(Qa,Ma,$c){this.j2c.Maa(Qa,Ma,$c)}v0d(Qa){this.sea&&(Qa=this.$.isEditMode||Qa&&this.ea.workbookContext.Options&512?2:this.ea.th.inEmbedView?14:1,this.setDw(8721,Qa),this.Ivi(Qa),this.K7c=!1)}$5f(){const Qa=
this.H3a;this.sea&&Qa.DPg&&(this.setDw(9450,Qa.iqg),this.setDw(9085,Qa.Xrj))}a6f(Qa){if(!this.D3b){this.D3b=!0;const Ma=this.H3a;let $c=0;this.sea&&Ma.DPg?(Ma.XCk(Qa),this.j2c.VDh=Ma.GIg,this.setDw(9086,Ma.E0j),Ma.Rrc=!0,$c=this.H3a.A4b.getTime()):$c=Qa.getTime();yf.TaskExtensions.Ua(this.GPb.value,de=>{de.result.sendMessage(P.a.PDh,{[Y.a.QDh]:$c})},this.xa,3)}}zZe(Qa){this.sea&&Qa&&1!==Qa.xqa&&this.rta(8327,If.b(Qa),If.l(Qa),If.a(Qa),2,Qa.wdf,If.m(Qa),If.d(Qa),If.e(Qa))}ohe(Qa,Ma){Qa&&Qa.MessageIdHash&&
this.nhe(Qa.MessageIdHash,Qa.MessageIdName,Qa.MessageId,Qa.ErrorCause?Qa.ErrorCause:Nf.a.v0c,!1,Ma,Qa,null)}nhe(Qa,Ma,$c,de,Be,nf,Tf,Xf){ie.vod||(ie.vod=!0,Zf.a.get_instance().isCompleted(13)||(Zf.a.get_instance().tB(13),N.ULS.sendTraceTag(537151323,0,50,"App encountered its first error so updating app init status")));Qa=this.Nhb(Qa);const zg=!!Tf,$f={};$f.ErrorName=Ma;$f.ErrorHashCode=Qa.toString();$f.ErrorId=$c.toString();$f.ErrorCause=de.toString();$f.ErrorType=0===nf?"ErrorDialog":"BusinessBar";
$f.BusinessBarEntryName=Xf||"null";$f.ServerCorrelationId=zg?Tf.CorrelationId:"null";$f.WebMethodName=zg?Tf.WebMethodName:"null";$f.SessionHostingEcs=this.ea.workbookContext?this.ea.workbookContext.EcsServerName:"null";$f.WfeServerId=zg?Tf.WfeServerId:"null";Ma=Cc.a.li($f);this.Og.raiseEvent("EREK",new cf($f));N.ULS.sendTraceTag(1881314,0,15,Ma);this.sea&&(sb.a.fyg(Qa.toString()),this.rta(9134,Qa,de,Nf.a.Wve),this.ea.eA||Be||(this.setDw(10459,Qa),this.v0d(!0),this.sOd=!0,this.upload(),this.IRf()))}Nhb(Qa){return 5439488|
(Qa>>>16^Qa&65535)&65535}V0d(Qa,Ma,$c){Qa=this.x0g.AQh(Qa,Ma,$c);this.sea&&Qa&&this.rta(11007,Qa.kwb)}upload(){!this.sea||!this.D3b&&!this.sOd||Yb.a.hm&&K.AFrameworkApplication.Il?Yb.a.hm&&K.AFrameworkApplication.Il&&N.ULS.sendTraceTag(537151320,0,15,"SqmManager.Upload: skipped UploadWsaData"):(this.L3.U9b(),this.K7c=!0);K.AFrameworkApplication.Gt=this.L3=null;this.H3a.cpk();this.D3b=!1;K.AFrameworkApplication.Gt=this.L3=this.$pf();this.x0g.TEg()}Gxj(){const Qa=this.H3a;if(this.sea&&!Qa.CPd){var Ma=
Qa.alb,$c=Qa.blb,de=Qa.A4b.getTime();K.AFrameworkApplication.oX=Qa.A4b;Ma&&this.setDw(10324,Ma>de?0:de-Ma);$c&&this.setDw(10325,$c>de?0:de-$c);Qa.CPd=!0}}rta(Qa,...Ma){this.sea&&this.L3.rta(Qa,...Ma)}setDw(Qa,Ma){this.sea&&this.L3.setDw(Qa,Ma)}$pf(){rg.a.yqf(this.$.ua);return K.AFrameworkApplication.Gt}Ivi(Qa){let Ma;try{Ma=Object(gb.a)(Object,Cc.a.Gp(K.AFrameworkApplication.fa.appSettings.SessionStartInfoJson))}catch($c){N.ULS.sendTraceTag(537151311,0,15,`Couldn't parse SessionStartInfoJson. Message: ${$c.message}`);
return}if(Ma){let $c=Object(gb.a)(String,Ma.ApplicationModeExtended),de=Object(gb.a)(String,Ma.ApplicationMode);$c&&de&&($c=$c.toUpperCase(),2!==Qa&&16!==Qa||"VIEW"!==$c&&"UNIFIED"!==$c?1!==Qa||"EDIT"!==$c&&"UNIFIED"!==$c||($c="VIEW",de="View"):($c="EDIT",de="Edit"),Ma.ApplicationModeExtended=$c,Ma.ApplicationMode=de,K.AFrameworkApplication.fa.appSettings.SessionStartInfoJson=Cc.a.li(Ma))}}IRf(){const Qa=this.$.ua;this.L3.dY=!0;this.L3.G8a(Qa.BWsaStartTime);this.setDw(59,83);this.D3b=!1;if(this.sea){const Ma=
Qa.DocumentHostInfo;this.p6h();this.setDw(8491,this.$.fL);this.setDw(9236,Qa.RequestedUILcid);this.setDw(8473,Qa.WacHostId);this.setDw(9902,If.c(Ma.ClusterId));M.EwaSettings.Ra(398)?this.L3.GLg(""):this.L3.GLg(Qa.FlightHolder?Qa.FlightHolder.FlightId:"");this.Qle(this.ea.th.inEmbedView?1:0);this.sOd=!1;this.setDw(9104,If.c(Ma.FileSourceId));this.setDw(10309,this.Fcj);this.$Ek();K.AFrameworkApplication.jh.Mee(Rb.a.getInstance(!1))}}$Ek(){qb.a.instance.U9i(this.L3);if(this.GPg){const Qa=qb.a.instance;
Qa.uck();Qa.Rck();Qa.Ock();Qa.Nck();Qa.Hck();this.GPg=!1}}p6h(){this.createStream(8327,1,md.a.y9h,md.a.Kgb);this.createStream(9134,1,3,md.a.Kgb);this.createStream(11007,1,1,md.a.Kgb)}createStream(Qa,Ma,$c,de){this.L3.createStream(Qa,Ma,$c,de)}}ie.fzb=null;ie.erd=!1;ie.vod=!1;Object(u.a)(ie,"SqmManager",Lc.a,[218,657]);var me=a(93),Pe=a(923);class gf{constructor(Qa,Ma){this.entryTypes=null;this.buffered=!1;this.entryTypes=Qa;this.buffered=void 0===Ma?!1:Ma}}Object(u.a)(gf,"PerformanceObserverInit",
null,[]);class tf extends Sys.EventArgs{constructor(Qa){super();this.Cqf=Qa}}Object(u.a)(tf,"LongTaskObservedEventArgs",Sys.EventArgs,[]);class Qe extends Sys.EventArgs{constructor(Qa){super();this.oDc=Qa}}Object(u.a)(Qe,"LongTaskPerformanceObserverInitializedEventArgs",Sys.EventArgs,[]);class Ca{constructor(Qa){this.Og=new v.a;this.pad=!1;this.sm=()=>{if(Yb.a.Av){try{void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&((new PerformanceObserver(this.Yzj)).observe(new gf([ib.a.g1d])),
this.pad=!0)}catch(Ma){this.pad=!1,N.ULS.sendTraceTag(537153885,0,10,`Exception related to PerformanceObserver: ${Ma}`)}this.Og.raiseEvent("ltpoiek",new Qe(this.oDc))}};this.Yzj=Ma=>{this.Og.raiseEvent("ltoek",new tf(Ma))};this.$=Qa;this.$.ea.Ul?this.sm():M.EwaSettings.fl()?this.$.ea.Jq(this.sm):this.$.ea.Uq(this.sm)}get oDc(){return this.pad}W0e(Qa){this.Og.addHandler("ltoek",Qa)}Ojk(Qa){this.Og.removeHandler("ltoek",Qa)}qzh(Qa){this.Og.addHandler("ltpoiek",Qa)}Pjk(Qa){this.Og.removeHandler("ltpoiek",
Qa)}dispose(){M.EwaSettings.fl()||this.$.ea.dv(this.sm);n.a.Ng(this.Og);this.$=this.Og=null}}Object(u.a)(Ca,"LongTaskPerformanceObserver",null,[2]);var yb=a(183);class wc{constructor(Qa,Ma){this.longTaskDuration=this.activeSessionDuration=0;this.activeSessionDuration=void 0===Qa?0:Qa;this.longTaskDuration=void 0===Ma?0:Ma}get h1d(){return this.activeSessionDuration?this.longTaskDuration/this.activeSessionDuration:0}Vqj(Qa){return 100*this.h1d>Qa}Gwh(Qa){this.V_e(Qa.longTaskDuration);this.emd(Qa.activeSessionDuration)}V_e(Qa){this.longTaskDuration+=
Qa}emd(Qa){this.activeSessionDuration+=Qa}}Object(u.a)(wc,"LongTaskPerformanceData",null,[]);class dd{constructor(Qa,Ma,$c,de,Be){this.isVetoSession=!1;this.postBootWindowData=this.worstWindowData=this.entireSessionData=null;this.maxUsersCount=0;this.isVetoSession=Qa;this.entireSessionData=Ma;this.worstWindowData=$c;this.postBootWindowData=de;this.maxUsersCount=Be}get reportName(){return"LongTaskPerformance"}static get Fgi(){return new dd(!1,new wc,new wc,new wc,0)}}Object(u.a)(dd,"LongTaskPerformanceDataStatistics",
null,[85]);class vd extends Sys.EventArgs{constructor(Qa){super();this.i1d=Qa}}Object(u.a)(vd,"LongTaskTrackedEventArgs",Sys.EventArgs,[]);var Zd=a(429),Re=a(306),ff=a(354);class af{constructor(Qa,Ma){this.Og=new v.a;this.y1a=this.Yga=this.p2=this.Wj=null;this.X1f=this.Dpe=this.KHc=!1;this.Z1a=null;this.maxUsersCount=0;this.sNc=($c,de)=>{$c=de.Cqf.getEntriesByType(ib.a.g1d);for(const Be of $c)this.Wj.tM(Be.duration)||K.AFrameworkApplication.d1a||(this.p2.V_e(Be.duration),this.Og.raiseEvent("lttek",
new vd(Be)),$c={},$c.LongTaskDuration=Be.duration,$c.LongTaskStartTime=Be.startTime,N.ULS.sendTraceTag(187982418,0,50,JSON.stringify($c)))};this.sm=()=>{this.Dpe=!0;this.J7b()};this.sE=($c,de)=>{de&&(this.maxUsersCount=Math.max(this.maxUsersCount,de.K4g));this.Yga.maxUsersCount=this.maxUsersCount};this.xj=()=>{this.J7b()};this.Li=()=>{this.M7b()};this.Fjg=($c,de)=>{de.oDc&&this.J7b()};this.I6f=()=>{this.p2.emd(B.getElapsedMilliseconds(this.y1a,z.a.Tg.Wh));this.Cre(!0);var $c=!1;this.Yga.postBootWindowData.activeSessionDuration?
(!this.X1f&&M.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&(Kd.b().IDg(2),Aa.Health.instance.recordKpiUsage(Re.a.longJsTask,ff.b.FailureBased,Zd.a.Yrj,null),this.X1f=!0),!this.Yga.isVetoSession&&this.p2.Vqj(this.M5g)&&(this.Yga.isVetoSession=!0,M.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&(Kd.b().JDg(2,this.Wzj),Aa.Health.instance.recordKpiFailure(Re.a.longJsTask,"SessionVetoedJsLoadTooSlow",!1,!0,null))),this.Yga.worstWindowData.h1d<=
this.p2.h1d&&(this.Yga.worstWindowData=this.p2),this.Yga.entireSessionData.Gwh(this.p2)):(this.Yga.postBootWindowData=new wc(this.p2.activeSessionDuration,this.p2.longTaskDuration),$c=!0);const de={};de.LastWindowScore=this.p2;de.postBootWindow=$c;de.CoauthersNumber=this.$.ea.yt.length;$c=JSON.stringify(de);N.ULS.sendTraceTag(20779346,0,50,$c);this.p2=new wc};this.iMc=()=>{this.Wj.tn||K.AFrameworkApplication.d1a||this.Cre(!1)};this.hMc=()=>{this.p2.emd(B.getElapsedMilliseconds(this.y1a,z.a.Tg.Wh));
this.y1a=null;this.Z1a.cancel()};this.$=Qa;this.M5g=Qa.ua.LongTaskPerformanceVetoThreshold;this.Wzj="PercentageOver_"+this.M5g.toString();this.j1d=Qa.ua.LongTaskPerformanceWindowDurationInMs;this.jY=Ma;M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void J.a.resolve(D.Ab).then($c=>{this.Wj=$c;this.J7b()}):this.$.ka.Lh(291,$c=>{this.Wj=$c;this.J7b()});this.$.ea.Ul?this.sm():M.EwaSettings.fl()?this.$.ea.Jq(this.sm):this.$.ea.Uq(this.sm);this.jY.qzh(this.Fjg);
this.$.nr(this.xj);this.$.Lp(this.Li)}rzh(Qa){this.Og.addHandler("lttek",Qa)}Qjk(Qa){this.Og.removeHandler("lttek",Qa)}dispose(){this.Dpe=!1;this.M7b();this.$.Pr(this.xj);this.$.Au(this.Li);this.jY.Pjk(this.Fjg);n.a.Ng(this.Z1a);this.jY=this.$=this.Z1a=null;void 0!==this.Wj&&null!==this.Wj&&n.a.Ng(this.Wj)}J7b(){void 0===this.Wj||null===this.Wj?N.ULS.sendTraceTag(537153884,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but visibilityObserver is not ready yet"):
this.jY.oDc?this.KHc?N.ULS.sendTraceTag(537153882,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we already tracking"):this.Dpe?(this.KHc=!0,this.Yga=dd.Fgi,this.p2=new wc,this.$.ea.Vda(this.sE),this.maxUsersCount=this.$.ea.yt.length,this.jY.W0e(this.sNc),this.Wj.t9(this.hMc),this.Wj.t3(this.iMc),K.AFrameworkApplication.kmd(this.hMc),K.AFrameworkApplication.lmd(this.iMc),this.Z1a=ab.a.instance.create(this.I6f,this.j1d,db.a.P5f,!1),Fe.a(this.$).r3(this.Yga),
this.Wj.tn||K.AFrameworkApplication.d1a||this.Cre(!0),N.ULS.sendTraceTag(537153880,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: Start tracking")):N.ULS.sendTraceTag(537153881,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we still not ready to start tracking"):N.ULS.sendTraceTag(537153883,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but longTaskPerformanceObserver InitializedSuccessfully")}M7b(){this.KHc&&
(this.KHc=!1,M.EwaSettings.fl()||this.$.ea.dv(this.sm),this.jY.Ojk(this.sNc),this.$.ea.g7(this.sE),void 0!==this.Wj&&null!==this.Wj&&(this.Wj.p5a(this.hMc),this.Wj.FNa(this.iMc)),K.AFrameworkApplication.rBg(this.hMc),K.AFrameworkApplication.sBg(this.iMc),this.Z1a.cancel(),this.y1a=this.p2=this.Yga=null,this.maxUsersCount=0)}Cre(Qa){Qa||void 0===this.y1a||null===this.y1a?(this.y1a=z.a.Tg.Wh,this.Z1a=yb.AsyncMethodContext.PKb(this.I6f,Qa?this.j1d:this.j1d-this.p2.activeSessionDuration,db.a.P5f,this.Z1a)):
N.ULS.sendTraceTag(589875356,0,15,"LongTaskPerformanceTracker:StampLastAppAwakeAndDocumentUnhiddenEcmaDateAndRestartTimer lastAppAwakeAndDocumentUnhiddenEcmaDate is not null when resuming a window")}}Object(u.a)(af,"LongTaskPerformanceTracker",null,[2]);var xf=a(25);class eg extends v.a{constructor(Qa,Ma){super();this.statusBarManager=this.Wj=null;this.Gjg=($c,de)=>{de.i1d&&de.i1d.duration>=this.Zzj&&(this.b7f++,this.z2f=de.i1d.duration)};this.$=Qa;this.$.ka.Lh(29,$c=>{this.statusBarManager=$c;$c.DL(this)});
M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void J.a.resolve(D.Ab).then($c=>{this.Wj=$c}):this.$.ka.Lh(291,$c=>{this.Wj=$c});this.z2f=this.b7f=0;this.Zzj=Qa.ua.LongTaskThresholdMs;this.Oob=Ma;this.Oob.rzh(this.Gjg)}Xx(Qa){this.addHandler("LTSCEK",Qa)}Jx(Qa){this.removeHandler("LTSCEK",Qa)}Ev(){this.Yq("QueryLongTasksCount")&&this.raiseEvent("LTSCEK")}hy(Qa,Ma){if("QueryLongTasksCount"!==Qa)return!1;this.$1i(Ma);return!0}Yq(){return M.EwaSettings.Ra(505)}dispose(){this.statusBarManager&&
(this.statusBarManager.$I(this),this.statusBarManager=null);this.Oob.Qjk(this.Gjg);super.dispose()}$1i(Qa){const Ma=`Long Tasks: ${this.b7f} | Last Task Duration: ${Math.round(this.z2f)}ms`;xf.a.eo(this.$)?(Qa.LabelText=Ma,Qa.Visible=!0):Qa.Value=Ma}}Object(u.a)(eg,"LongTasksStatusBarManager",v.a,[2,161,162]);var Ab=a(13);class xc{constructor(){this.rttMs=this.bandwidthMps=0;this.effectiveConnection=this.connectionType=null;this.downlinkMaxMps=0}}Object(u.a)(xc,"NetworkInfoData",null,[]);class eb extends v.a{constructor(Qa){super();
this.statusBarManager=null;this.Pld=!1;this.fcg=()=>{this.raiseEvent("NetworkInformation")};this.$=Qa;M.EwaSettings.isChangeGateEnabled("OfficeVSO:3539919_AddNetworkInformationTelemetry")&&(this.XR=this.yve("connection")||this.yve("mozConnection")||this.yve("webkitConnection"))&&M.EwaSettings.Ra(410)&&Qa.ka.Lh(29,Ma=>{this.statusBarManager=Ma;Ma.DL(this);this.XR.addEventListener("change",this.fcg);this.Pld=!0})}Xx(Qa){this.addHandler("NetworkInformation",Qa)}Jx(Qa){this.removeHandler("NetworkInformation",
Qa)}$Ia(){return this.XR?Object(Ta.a)(new xc,{bandwidthMps:this.XR.downlink,rttMs:this.XR.rtt,connectionType:this.XR.type,effectiveConnection:this.XR.effectiveType,downlinkMaxMps:this.XR.downlinkMax}):null}hy(Qa,Ma){if("QueryNetworkInformation"!==Qa)return!1;this.a2i(Ma);return!0}Yq(){return this.Pld}dispose(){this.Pld&&(this.statusBarManager&&(this.statusBarManager.$I(this),this.statusBarManager=null),this.XR&&this.XR.removeEventListener("change",this.fcg));this.$=null;super.dispose()}yve(Qa){return Ab.HelperMethods.Bv(window.navigator,
Qa)?window.navigator[Qa]:null}a2i(Qa){const Ma="Network: "+this.XR.downlink.toString()+" Mbps, "+this.XR.rtt.toString()+" ms";xf.a.eo(this.$)?(Qa.LabelText=Ma,Qa.Visible=!0):Qa.Value=Ma}}Object(u.a)(eb,"NetworkInformationManager",v.a,[161,162]);class Ub{constructor(Qa,Ma,$c,de,Be,nf,Tf,Xf,zg,$f){this.name=null;this.startToResponseRenderEnd=this.startToNextFrame=this.startTime=0;this.isPartOfGroup=this.isGroupBreaking=this.isUserOperation=this.wasHidden=!1;this.operationThatLedToLogging=null;this.startToOperationThatLedToLogging=
0;this.name=void 0===Qa?"":Qa;this.startTime=void 0===Ma?-1:Ma;this.startToNextFrame=void 0===$c?-1:$c;this.startToResponseRenderEnd=void 0===de?-1:de;this.wasHidden=void 0===Be?!1:Be;this.isUserOperation=void 0===nf?!0:nf;this.isGroupBreaking=void 0===Tf?!0:Tf;this.operationThatLedToLogging=void 0===zg?"":zg;this.startToOperationThatLedToLogging=void 0===$f?-1:$f;this.isPartOfGroup=void 0===Xf?!1:Xf}}Object(u.a)(Ub,"OperationStatisticsData",null,[]);class Fc{constructor(){this.operationsGroups=null;
this.f9i()}isGroup(Qa,Ma,$c){const de=new Wb.a;de.addRange(Qa);de.addRange(Ma);for(let Be=0;Be<this.operationsGroups.count;Be++)if(this.Mmj(this.operationsGroups.ma(Be),de,$c))return N.ULS.sendTraceTag(595194768,1,50,`OperationsGroupDetector: Operation '${$c}' is part of a group ( operationsList: ${this.Spg(Qa)} , frameOperationsList: ${this.Spg(Ma)})`),!0;N.ULS.sendTraceTag(595194767,1,50,`OperationsGroupDetector: Operation '${$c}' is NOT part of a group.`);return!1}Mmj(Qa,Ma,$c){let de=0;for(let Be=
0;Be<Ma.count;Be++)if(Ma.ma(Be).isGroupBreaking){if(Qa.count<=de||!xa.a.equals(Ma.ma(Be).name,Qa.ma(de),!0))return!1;de++}return Qa.count>de&&xa.a.equals($c,Qa.ma(de),!0)}Spg(Qa){return`[${Qa.toArray().map(Ma=>Ma.name).join(", ")}]`}f9i(){this.operationsGroups=new Wb.a;this.Fcb(new Wb.a(["Paste","SelectingRange_unknown"]));this.Fcb(new Wb.a(["AutoSum","SelectingRange_unknown"]));this.Fcb(new Wb.a(["ChangeSheetDirection","ActiveItemChanged"]));this.Fcb(new Wb.a(["InsertSheet","ActiveItemChanged","SelectingRange_unknown"]));
this.Fcb(new Wb.a(["DeleteSheet","DialogButtonClick","ActiveItemChanged","SelectingRange_unknown"]));this.Fcb(new Wb.a(["EditBoxEndEdit","SetCell","SelectingRange_keyboard","MoveDownWithinSelectionOrCommitEdit"]))}Fcb(Qa){this.operationsGroups.add(Qa)}}Object(u.a)(Fc,"OperationsGroupDetector",null,[]);var rd=a(28);class Gd{constructor(Qa,Ma,$c,de){this.framePerformanceTracker=this.t3b=this.hba=this.hca=null;this.ank=()=>{this.qod=-1;const Be=Ab.HelperMethods.uh();this.P6k(Be);this.K4b&&(N.ULS.sendTraceTag(537153878,
1,50,"GroupDetector: Setting current frame operations render duration due to rendering without additional blocks."),this.L9b(this.lO,Be),this.K4b=!1);this.SFc&&(this.L9b(this.pP,Be),this.K4b||this.L9b(this.lO,Be));window.setTimeout(this.Dxj,0)};this.Dxj=()=>{var Be=[];const nf=this.$.ua.OperationToPrevOperationThreshold;for(var Tf=0;Tf<this.lO.count;Tf++){var Xf=this.lO.ma(Tf);Tf<nf&&Be.push(Xf);this.pP.add(Xf)}Q.f(this.$)&&Q.f(this.$).za?((Tf=this.sessionStatisticsManager.zId(0))?(Xf=JSON.stringify(this.NXb),
Be=JSON.stringify(Be),N.ULS.sendTraceTag(237798547,1,50,`DOM count: (${Tf.dEj}, ${Tf.SHh}, ${Tf.KCj}), long tasks: ${Xf}, operations count: ${this.lO.count}, operations: ${Be}`)):N.ULS.sendTraceTag(537153876,1,50,"Report Manager NumberOfDomElements does not exist"),this.lO.count>nf&&N.ULS.sendTraceTag(537153875,1,50,`More than ${nf} operations are in the operationsList. count: ${this.lO.count}`),this.lO.clear(),this.NXb.clear()):N.ULS.sendTraceTag(537153877,1,10,"Grid == null or BlockManager == null")};
this.sNc=(Be,nf)=>{this.Xzj(nf.Cqf)};this.$=Qa;this.BS=Ma;this.Bp=this.Bp||z.a.Tg;this.pP=new Wb.a;this.lO=new Wb.a;this.qod=this.Xnb=-1;this.NXb=new Wb.a;this.m_j=new Fc;this.K4b=this.SFc=!1;this.I9i();this.h9i();this.g9i();this.sessionStatisticsManager=$c;this.jY=de;this.jY.W0e(this.sNc);M.EwaSettings.isChangeGateEnabled("OfficeVSO:8759538_removeXLFPSTag")||this.$.ka.Lh(263,Be=>{this.framePerformanceTracker=Be})}A3b(Qa,Ma){var $c=Ab.HelperMethods.uh();const de=this.m_j.isGroup(this.pP,this.lO,Qa);
(this.SFc=this.bmj(Qa))&&0<this.pP.count&&!de&&(this.M5k(),this.L5k(Qa,$c),this.owi());this.Xnb=-1;if(Q.f(this.$)&&Q.f(this.$).za){var Be=!this.hca.contains(Qa);$c=new Ub(Qa,$c,void 0,void 0,void 0,Be,this.SFc,de);this.lO.add($c);this.framePerformanceTracker&&this.framePerformanceTracker.jRk($c.name,Ma);!this.K4b&&this.t3b.contains(Qa)&&(this.K4b=!0);-1===this.qod&&(this.qod=window.requestAnimationFrame(this.ank))}else N.ULS.sendTraceTag(537153879,1,10,"Grid == null or BlockManager == null")}rTc(){this.Xnb=
Ab.HelperMethods.uh()}ATc(){this.pP.count||this.lO.count?(this.L9b(this.lO,this.Xnb),this.L9b(this.pP,this.Xnb)):N.ULS.sendTraceTag(0,1,50,`ReportOnBlockCacheConsistent when no operations in the list. Last block render time: ${this.Xnb}`);this.Xnb=-1}bmj(Qa){return!this.hba.contains(Qa)&&!Qa.includes("Menu")&&!Qa.includes("TellMe")}owi(){for(let Qa=0;Qa<this.pP.count;Qa++){const Ma=this.pP.ma(Qa);this.BS.ksh(Ma);this.jyj(Ma)}this.pP.clear()}P6k(Qa){for(let Ma=0;Ma<this.lO.count;Ma++)this.lO.ma(Ma).startToNextFrame=
this.QKd(this.lO.ma(Ma).startTime,Qa),this.lO.ma(Ma).wasHidden=Pe.a.tM(this.lO.ma(Ma).startToNextFrame)}L5k(Qa,Ma){for(let $c=0;$c<this.pP.count;$c++)-1===this.pP.ma($c).startToResponseRenderEnd&&(this.pP.ma($c).operationThatLedToLogging=Qa,this.pP.ma($c).startToOperationThatLedToLogging=this.QKd(this.pP.ma($c).startTime,Ma))}M5k(){var Qa=!1;for(const Ma of this.pP)if(Ma.isPartOfGroup){Qa=!0;break}if(Qa)for(Qa=0;Qa<this.pP.count;Qa++)this.pP.ma(Qa).isPartOfGroup=this.pP.ma(Qa).isGroupBreaking}L9b(Qa,
Ma){for(let $c=0;$c<Qa.count;$c++)Qa.ma($c).startToResponseRenderEnd=this.QKd(Qa.ma($c).startTime,Ma),Qa.ma($c).wasHidden=Pe.a.tM(Qa.ma($c).startToResponseRenderEnd)}jyj(Qa){Qa=JSON.stringify(Qa);N.ULS.sendTraceTag(2020372336,1,50,`${Qa}`)}QKd(Qa,Ma){return-1===Qa?-1:-1===Ma?-2:Ma-Qa}Xzj(Qa){Qa=Qa.getEntriesByType(ib.a.g1d);for(let Ma=0;Ma<Qa.length;Ma++)if(30>this.NXb.count)if(this.lO.count)this.NXb.add(this.y2j(Qa[Ma]));else{const $c=Qa[Ma];if(null===$c||void 0===$c?0:$c.attribution)void 0!==$c.attribution.containerSrc&&
null!==$c.attribution.containerSrc&&($c.attribution.containerSrc=""),void 0!==$c.attribution.containerId&&null!==$c.attribution.containerId&&($c.attribution.containerId=""),void 0!==$c.attribution.containerName&&null!==$c.attribution.containerName&&($c.attribution.containerName="");N.ULS.sendTraceTag(40777251,1,50,"LongTaskObserverAction: long task occur when operations list was empty.")}else{N.ULS.sendTraceTag(537153874,1,50,`More then ${30} long tasks are in the longTaskList. entries length: ${Qa.length} First long task: ${this.NXb.ma(0)}`);
break}}y2j(Qa){return`name:${Qa.name}, startTime:${Qa.startTime}, duration:${Qa.duration}`}I9i(){this.hca||(this.hca=new Ed.a(qc.a.lm()),this.hca.add("ActiveItemChanged"),this.hca.add(Kd.b().kp(-1398645260)),this.hca.add(Kd.b().kp(722290388)),this.hca.add(Kd.b().kp(974713501)),this.hca.add(rd.a.k0(rd.a.ipc)),this.hca.add(rd.a.k0(rd.a.hpc)),this.hca.add(rd.a.k0(rd.a.EJb)),this.hca.add(rd.a.k0(rd.a.qvg)),this.hca.add(rd.a.k0(rd.a.Mpa)))}h9i(){this.hba||(this.hba=new Ed.a(qc.a.lm()),this.hba.add("PromptEditInBrowser"),
this.hba.add(Kd.b().kp(-1398645260)),this.hba.add(Kd.b().kp(722290388)),this.hba.add(Kd.b().kp(974713501)),this.hba.add(rd.a.k0(rd.a.ipc)),this.hba.add(rd.a.k0(rd.a.hpc)),this.hba.add(rd.a.k0(rd.a.EJb)),this.hba.add(rd.a.k0(rd.a.qvg)),this.hba.add(rd.a.k0(rd.a.Mpa)))}g9i(){this.t3b||(this.t3b=new Ed.a(qc.a.lm()),this.t3b.add("SelectingRange_keyboard"),this.t3b.add("SelectingRange_mouse"))}}Object(u.a)(Gd,"OperationStatistics",null,[]);var ue=a(681);class Ce{constructor(Qa,Ma){this.messageIdName=null;
this.errorCause=0;this.messageIdName=Qa;this.errorCause=Ma}}Object(u.a)(Ce,"RequestError",null,[]);class Se{constructor(Qa,Ma,$c,de,Be,nf,Tf,Xf,zg,$f,Ng,pg,Ug,Og,bh,mh,Tg){this.requestName=null;this.isPromotedUTRRequest=this.isFullyLoggedKPIRequest=this.isUserTriggeredRequest=!1;this.TimeFromLastEcsFreeze=this.WfeRequestDuration=this.EcsRequestDuration=this.ecsOperationDuration=this.requestInvokedTime=this.requestTimeInQueue=this.totalOperationDuration=this.requestDuration=0;this.DuringLoadOnDemand=
!1;this.errors=this.correlationID=null;this.httpStatus=0;this.requestResourceTiming=null;this.communicationErrorRetryCount=0;this.isDocumentHidden=this.successfulCall=!1;this.responseSize=this.coauthorsCount=0;this.networkInfoData=null;this.responseToCallbackTime=0;this.requestName=Qa;this.isUserTriggeredRequest=Se.nMi(Qa);this.isFullyLoggedKPIRequest=Se.dMi(Qa);this.isPromotedUTRRequest=Se.fMi(Qa);this.requestDuration=Ma;this.totalOperationDuration=$c;this.requestTimeInQueue=de;this.requestInvokedTime=
Be;this.ecsOperationDuration=nf.EcsOperationDuration;this.EcsRequestDuration=nf.EcsRequestDuration;this.WfeRequestDuration=nf.WfeRequestDuration;this.TimeFromLastEcsFreeze=nf.TimeFromLastEcsFreeze;this.DuringLoadOnDemand=nf.DuringLoadOnDemand;this.correlationID=Tf;this.errors=Se.mYh(Xf);this.httpStatus=zg;this.requestResourceTiming=$f;this.communicationErrorRetryCount=Ng;this.successfulCall=pg;this.isDocumentHidden=Ug;this.coauthorsCount=Og;this.responseSize=bh;this.networkInfoData=mh;this.responseToCallbackTime=
Tg}static mYh(Qa){if(!Qa)return[];const Ma=[];for(const $c of Qa)Ma.push(new Ce($c.MessageIdName,$c.ErrorCause));return Ma}static nMi(Qa){return!Se.iHj.contains(Qa)}static ZOi(){const Qa=new Ed.a(qc.a.lm());Qa.add("CheckPersistedContentUpdate");Qa.add("GetContentBundle");Qa.add("GetSessionStatus");Qa.add("GetStatusBarAggregates");Qa.add("PollSessionStatus");Qa.add("UpdatePresenceUsers");Qa.add("UploadLatencyTelemetry");return Qa}static dMi(Qa){return Se.zyi.contains(Qa)}static fMi(Qa){return Se.o8j.contains(Qa)}static yKi(){const Qa=
new Ed.a(qc.a.lm());Qa.add("SetRichTextCell");Qa.add("Copy");Qa.add("FormatCells");Qa.add("PasteRange");Qa.add("FindCell");Qa.add("ApplyToRangesV2");Qa.add("ResizeRowsColumns");Qa.add("InsertDeleteCells");Qa.add("FillRange");Qa.add("PasteHtmlContent");Qa.add("ApplyFilter");Qa.add("PasteString");Qa.add("Undo");Qa.add("LineageUpdateView");Qa.add("FindAll");Qa.add("ApplyHyperlink");Qa.add("AutoFit");Qa.add("GetPrintSettings");Qa.add("GetEdgeCell");Qa.add("Paste");Qa.add("MoveAndResizeFloatingObject");
Qa.add("FindRange");Qa.add("SetCustomFilter");Qa.add("RenameSheet");Qa.add("ApplyThreadedComment");Qa.add("SortFilterColumn");Qa.add("InsertCopiedCutCellsV2");Qa.add("InsertSheet");Qa.add("ToggleAutoFilter");Qa.add("ReorderSheets");Qa.add("SetOutlineLevel");Qa.add("RefreshAll");Qa.add("LineageOpenPaneOrChangeFilter");Qa.add("ApplySlicerSelection");Qa.add("GetCardViewCardByCell");Qa.add("AutoSum");Qa.add("LineageClosePane");Qa.add("Sort");Qa.add("ClearAutoFilter");Qa.add("DeleteSheet");Qa.add("Redo");
M.EwaSettings.isChangeGateEnabled("OfficeVSO:5317483_AdditionalOperationsInXlreqKPI")&&(Qa.add("RemovePageBreak"),Qa.add("InsertPageBreak"),Qa.add("SetPrintArea"),Qa.add("ClearPrintArea"));return Qa}static gMi(){const Qa=new Ed.a(qc.a.lm());Qa.add("DeleteConditionalFormattingRules");Qa.add("GetConditionalFormattingRules");Qa.add("AddConditionalFormattingRule");Qa.add("QuickEditConditionalFormattingRule");Qa.add("GetPrintSettings");Qa.add("UpdatePresenceUsers");Qa.add("GetThemeInfo");Qa.add("InsertCopiedCutCellsV2");
Qa.add("PasteRange");Qa.add("FillRange");Qa.add("InsertCopiedCutCellsCrossSession");M.EwaSettings.isChangeGateEnabled("OfficeVSO:5738374_UTR_xlreq_lineage")&&(Qa.add("LineageOpenPaneOrChangeFilter"),Qa.add("LineageUpdateView"),Qa.add("LineageRefreshView"),Qa.add("LineageLoadMore"));M.EwaSettings.isChangeGateEnabled("OfficeVSO:8609133_PromoteGetNumberFormatViewModelData")&&Qa.add("GetNumberFormatViewModelData");Qa.add("PasteString");return Qa}}Se.iHj=Se.ZOi();Se.zyi=Se.yKi();Se.o8j=Se.gMi();Object(u.a)(Se,
"RequestStatisticsData",null,[]);class of{constructor(Qa,Ma,$c){this.$=Qa;this.BS=Ma;this.Mya=$c}ETc(Qa,Ma,$c,de,Be,nf,Tf,Xf,zg,$f,Ng,pg,Ug,Og){pg=ue.a(pg);Qa=new Se(Qa,Ma,$c,de,Be,nf,Tf,Xf,zg,pg,$f,Ng,Pe.a.tM(Ma),this.gKd(null),Ug,this.Mya.$Ia(),Og);this.Uhe(Qa)}Yo(Qa,Ma){Qa="UnknownMethodName";var $c=-1;void 0!==Ma.context&&null!==Ma.context&&(Qa=Ma.context.methodName,$c=Ma.context.communicationErrorRetryCount);let de,Be={EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,
DuringLoadOnDemand:!1};Ma.Uj?(de=Ma.Uj.Errors||[],this.BS.Tmk(Ma.Uj.EditSessionIsDirty),void 0!==Ma.Uj.RequestTelemetryData&&null!==Ma.Uj.RequestTelemetryData&&(Be=Ma.Uj.RequestTelemetryData)):de=[];const nf=Ma.duration,Tf=ue.a(Ma.url);Qa=new Se(Qa,nf,Ma.totalOperationDuration,Ma.Ute,Ma.VO,Be,Ma.zle,de,Ma.httpStatus,Tf,$c,!0,Pe.a.tM(nf),this.gKd(Ma.Uj),Ma.responseSize,this.Mya.$Ia(),Ma.responseToCallbackTime);this.Uhe(Qa);Qa.requestResourceTiming&&($c=Qa.requestResourceTiming.totalDuration-Qa.WfeRequestDuration,
$c>=this.$.ua.LongNetworkTimeTelemetryThresholdInMilliseconds&&Ma.responseHeaders&&N.ULS.sendTraceTag(508880928,0,50,`RequestStatistics.onWebMethodSuccess: Slow network time detected: requestName = ${Qa.requestName}, requestDuration = ${Qa.requestDuration}, networkTime = ${$c},  ServerCorrelation = ${Qa.correlationID}, msEdgeHeader = ${ib.a.OYb in Ma.responseHeaders?Ma.responseHeaders[ib.a.OYb]:""}, backendDatacenter = ${ib.a.F5d in Ma.responseHeaders?Ma.responseHeaders[ib.a.F5d]:""}, proxyDatacenter = ${ib.a.H5d in
Ma.responseHeaders?Ma.responseHeaders[ib.a.H5d]:""}`))}Ay(Qa,Ma){Qa="UnknownMethodName";let $c=-1;void 0!==Ma.context&&null!==Ma.context&&(Qa=Ma.context.methodName,$c=Ma.context.communicationErrorRetryCount);const de=Ma.duration,Be=ue.a(Ma.url);Ma=new Se(Qa,de,Ma.totalOperationDuration,Ma.Ute,Ma.VO,{EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1},Ma.zle,Ma.errors||[],Ma.httpStatus,Be,$c,!1,Pe.a.tM(de),this.gKd(null),-1,this.Mya.$Ia(),
Ma.responseToCallbackTime);this.Uhe(Ma)}Uhe(Qa){this.BS.ICh(Qa);if(M.EwaSettings.Ra(212)){var Ma=Qa.requestName;if(Ma!==ib.a.hJa&&"SetCell"!==Ma&&"FindRange"!==Ma&&"FindAll"!==Ma&&"FindCell"!==Ma)return}Ma=M.EwaSettings.isChangeGateEnabled("OfficeVSO:5514802_UTRBasedOnULS_xlreq")&&!(void 0===Qa.requestName||null===Qa.requestName)&&Qa.isPromotedUTRRequest;of.Dei(Qa,Ma);this.BS.lsh(Qa)}gKd(Qa){var Ma;if(null===(Ma=null===Qa||void 0===Qa?void 0:Qa.CollaborationResult)||void 0===Ma?0:Ma.Users)return Qa.CollaborationResult.Users.length;
Qa=this.$.ea.yt.length;return 0<Qa?Qa:1}static Dei(Qa,Ma){Ma?Kd.b().yVc(388829456,0,15,Qa):(Ma=Sys.Serialization.JavaScriptSerializer.serialize(Qa),N.ULS.sendTraceTag(388829456,0,50,Ma));if(M.EwaSettings.isChangeGateEnabled("OfficeVSO:5294200_ReportXlreqKPI")&&void 0!==Qa.requestName&&null!==Qa.requestName&&Qa.isFullyLoggedKPIRequest){Ma=new Map;Ma.set("isUserTriggeredRequest",Qa.isUserTriggeredRequest.toString());Ma.set("requestDuration",Qa.requestDuration.toString());Ma.set("totalOperationDuration",
Qa.totalOperationDuration.toString());Ma.set("requestTimeInQueue",Qa.requestTimeInQueue.toString());Ma.set("requestInvokedTime",Qa.requestInvokedTime.toString());Ma.set("ecsOperationDuration",Qa.ecsOperationDuration.toString());Ma.set("ecsRequestDuration",Qa.EcsRequestDuration.toString());Ma.set("wfeRequestDuration",Qa.WfeRequestDuration.toString());Ma.set("timeFromLastEcsFreeze",Qa.TimeFromLastEcsFreeze.toString());Ma.set("duringLoadOnDemand",Qa.DuringLoadOnDemand.toString());Ma.set("correlationID",
Qa.correlationID);Ma.set("errors",Qa.errors.toString());Ma.set("httpStatus",Qa.httpStatus.toString());if(Qa.networkInfoData){var $c=Qa.networkInfoData;Ma.set("networkInfoData_bandwidthMps",void 0===$c.bandwidthMps||null===$c.bandwidthMps?"NA":$c.bandwidthMps.toString());Ma.set("networkInfoData_rttMs",void 0===$c.rttMs||null===$c.rttMs?"NA":$c.rttMs.toString());Ma.set("networkInfoData_effectiveConnection",void 0===$c.effectiveConnection||null===$c.effectiveConnection?"NA":$c.effectiveConnection)}Qa.requestResourceTiming&&
($c=Qa.requestResourceTiming,Ma.set("requestResourceTiming_fetchStart",void 0===$c.downloadDuration||null===$c.downloadDuration?"NA":$c.downloadDuration.toString()));Ma.set("communicationErrorRetryCount",Qa.communicationErrorRetryCount.toString());Ma.set("successfulCall",Qa.successfulCall.toString());Ma.set("isDocumentHidden",Qa.isDocumentHidden.toString());Ma.set("coauthorsCount",Qa.coauthorsCount.toString());Ma.set("responseSize",Qa.responseSize.toString());Ma.set("responseToCallbackTime",Qa.responseToCallbackTime.toString());
Kd.b().BTc(Qa.requestName,Qa.successfulCall,Ma)}}}Object(u.a)(of,"RequestStatistics",null,[]);var jf=a(232),bf=a(62),pf=a(264);class Ud{constructor(){this.operationName=null;this.isUserOperation=!1;this.longestStartToResponse=this.longestStartToNextFrame=this.totalCount=0;this.startToResponsePercentiles=this.startToNextFramePercentiles=null}}Object(u.a)(Ud,"OperationTypeStatisticsData",null,[]);class Ff{constructor(Qa,Ma){this.data=new Ud;this.data.operationName=Qa;this.data.isUserOperation=Ma;this.data.totalCount=
0;this.AUg=[];this.BUg=[];this.data.longestStartToNextFrame=-1;this.data.longestStartToResponse=-1;this.data.startToNextFramePercentiles="";this.data.startToResponsePercentiles=""}lj(Qa){this.data.totalCount<Ff.BAd&&(this.AUg.push(Qa.startToNextFrame),this.BUg.push(Qa.startToResponseRenderEnd));this.data.totalCount++;this.data.longestStartToNextFrame<Qa.startToNextFrame&&(this.data.longestStartToNextFrame=Qa.startToNextFrame);this.data.longestStartToResponse<Qa.startToResponseRenderEnd&&(this.data.longestStartToResponse=
Qa.startToResponseRenderEnd)}AEd(){0<this.data.totalCount&&(this.data.startToNextFramePercentiles=this.fHf(this.AUg),this.data.startToResponsePercentiles=this.fHf(this.BUg))}fHf(Qa){Qa.sort(Ab.HelperMethods.$R);let Ma;Ma="("+Pe.a.lwa(Qa,25).toString();Ma=Ma+", "+Pe.a.lwa(Qa,50).toString();Ma=Ma+", "+Pe.a.lwa(Qa,75).toString();Ma=Ma+", "+Pe.a.lwa(Qa,95).toString();return Ma+")"}}Ff.BAd=1E3;Object(u.a)(Ff,"OperationTypeStatistics",null,[]);class Uf{constructor(){this.requestName=null;this.averageWfeDuration=
this.averageEcsDuration=this.averageEcsOperationDuration=this.averageDuration=this.callsDuringLoadOnDemand=this.callsDuringEcsFreeze=this.unsuccessfulCalls=this.successfulCalls=this.totalCount=0;this.longestRequest=null;this.requestDurationPercentile95=this.requestDurationPercentile75=this.requestDurationPercentile50=this.requestDurationPercentile25=0}}Object(u.a)(Uf,"RequestTypeStatisticsData",null,[]);class Gf{constructor(Qa){this.data=new Uf;this.data.requestName=Qa;this.data.totalCount=0;this.Btb=
[];this.Uue=this.Mue=this.Nue=this.Rue=0;this.data.successfulCalls=0;this.data.unsuccessfulCalls=0;this.data.callsDuringEcsFreeze=0;this.data.longestRequest=null;this.data.requestDurationPercentile25=-1;this.data.requestDurationPercentile50=-1;this.data.requestDurationPercentile75=-1;this.data.requestDurationPercentile95=-1}Enk(Qa){this.data.totalCount<Gf.BAd&&this.Btb.push(Qa.requestDuration);this.data.totalCount++;this.Rue+=Qa.requestDuration;this.Nue+=Gf.qHd(Qa.ecsOperationDuration);this.Mue+=
Gf.qHd(Qa.EcsRequestDuration);this.Uue+=Gf.qHd(Qa.WfeRequestDuration);0<Qa.TimeFromLastEcsFreeze&&Qa.TimeFromLastEcsFreeze<Gf.jyi&&this.data.callsDuringEcsFreeze++;Qa.successfulCall?this.data.successfulCalls++:this.data.unsuccessfulCalls++;Qa.DuringLoadOnDemand&&this.data.callsDuringLoadOnDemand++;if(void 0===this.data.longestRequest||null===this.data.longestRequest||this.data.longestRequest.requestDuration<Qa.requestDuration)this.data.longestRequest=Qa}AEd(){0<this.data.totalCount&&(this.data.averageDuration=
Math.floor(this.Rue/this.data.totalCount),0<this.data.successfulCalls?(this.data.averageEcsOperationDuration=Math.floor(this.Nue/this.data.successfulCalls),this.data.averageEcsDuration=Math.floor(this.Mue/this.data.successfulCalls),this.data.averageWfeDuration=Math.floor(this.Uue/this.data.successfulCalls)):(this.data.averageEcsOperationDuration=0,this.data.averageEcsDuration=0,this.data.averageWfeDuration=0),this.Btb.sort(Ab.HelperMethods.$R),this.data.requestDurationPercentile25=Pe.a.lwa(this.Btb,
25),this.data.requestDurationPercentile50=Pe.a.lwa(this.Btb,50),this.data.requestDurationPercentile75=Pe.a.lwa(this.Btb,75),this.data.requestDurationPercentile95=Pe.a.lwa(this.Btb,95))}static qHd(Qa){return 0>Qa?0:Qa}}Gf.jyi=3E3;Gf.BAd=1E3;Object(u.a)(Gf,"RequestTypeStatistics",null,[]);class lg{constructor(Qa,Ma,$c,de,Be,nf,Tf,Xf){this.mode=null;this.dirtySessionOnLastRecordedRequest=this.endedBySplashScreen=this.ocsCapable=!1;this.maxCoauthorsCount=this.loadOnDemandCount=0;this.everConnectedToOcs=
!1;this.requests=null;this.mode=Qa;this.ocsCapable=Ma;this.endedBySplashScreen=$c;this.dirtySessionOnLastRecordedRequest=de;this.loadOnDemandCount=Be;this.maxCoauthorsCount=nf;this.everConnectedToOcs=Tf;Qa=[];for(const zg in Xf)Ma=Xf[zg],Ma.AEd(),Qa.push(Ma.data);this.requests=Qa}}Object(u.a)(lg,"SessionStatisticsData",null,[]);class Pa{constructor(Qa){this.dirtySessionOnLastRecordedRequest=this.wre=!1;this.k4f=0;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.$=Qa;this.eFb={};this.dFb={};
this.gyd={}}Li(){var Qa=this.m7h();if(Fa.a.$pa()){var Ma={};Ma.xlendJson=Qa;this.$.wAa(jf.a.Jbl,Ma,!1)}else bf.O(this.$.pa.ta,Qa,null,null,null,null,null);Qa=this.n7h();Fa.a.$pa()?(Ma={},Ma.xlenoJson=Qa,this.$.wAa(jf.a.Kbl,Ma,!1)):N.ULS.sendTraceTag(388776782,0,50,Qa);Qa=this.E1h();Fa.a.$pa()?(Ma={},Ma.xlencJson=Qa,this.$.wAa(jf.a.Ibl,Ma,!1)):N.ULS.sendTraceTag(388776770,0,50,Qa);this.rok()}PHc(){this.everConnectedToOcs=this.$.ea.znb||this.everConnectedToOcs;Aa.Health.instance&&Aa.Health.instance.addOrUpdatePartCDimension("IsOcsSession",
this.everConnectedToOcs.toString())}sm(){const Qa=new pf.a;let Ma="";const $c=!this.$.isAnonymousUser(),de=Qa.jl();if(de){if($c){Qa.Wub("UMI_Linkable","true");return}Ma=Qa.WIa("UMI_Linkable")}$c||N.ULS.sendTraceTag(537153870,0,50,`SessionStatistics.OnCommandUIGeneratedAndGridInteractive: IsLocalStorageSupported:${de}, UMIIsLinkable:${!!Ma}`)}ztb(){this.wre=!0}Tmk(Qa){this.dirtySessionOnLastRecordedRequest=Qa}ICh(Qa){this.maxCoauthorsCount=Math.max(this.maxCoauthorsCount,Qa.coauthorsCount);Aa.Health.instance&&
Aa.Health.instance.addOrUpdatePartCDimension("MaxNumEditors",this.maxCoauthorsCount.toString())}lsh(Qa){if(!(Qa.requestName in this.eFb)){const Ma=new Gf(Qa.requestName);this.eFb[Qa.requestName]=Ma}this.eFb[Qa.requestName].Enk(Qa)}ksh(Qa){if(!(Qa.name in this.dFb)){const Ma=new Ff(Qa.name,Qa.isUserOperation);this.dFb[Qa.name]=Ma}this.dFb[Qa.name].lj(Qa)}r3(Qa){this.gyd[Qa.reportName]=Qa}rok(){this.dirtySessionOnLastRecordedRequest=this.wre=!1;this.k4f=this.$.ea.O_d;this.maxCoauthorsCount=1;this.everConnectedToOcs=
!1;this.eFb={};this.dFb={};this.gyd={}}m7h(){const Qa=new lg(this.$.isEditMode?"edit":"view",this.$.ea.ocsCapable,this.wre,this.dirtySessionOnLastRecordedRequest,this.$.ea.O_d-this.k4f,this.maxCoauthorsCount,this.everConnectedToOcs,this.eFb);return Sys.Serialization.JavaScriptSerializer.serialize(Qa)}n7h(){var Qa=new Wb.a;const Ma=this.dFb;for(const $c in Ma){const de=Ma[$c];de.AEd();Qa.add(de.data)}Qa=Qa.toArray();return Sys.Serialization.JavaScriptSerializer.serialize(Qa)}E1h(){return Sys.Serialization.JavaScriptSerializer.serialize(this.gyd)}}
Object(u.a)(Pa,"SessionStatistics",null,[]);class lc extends Lc.a{constructor(Qa){super();this.fAa=this.rza=null;this.Fjf=Array(1);this.hdd=this.k1d=null;this.Yo=(Ma,$c)=>{M.EwaSettings.Ra(39)&&(this.fAa=this.fAa||new of(this.$,this.BS,this.Mya),this.fAa.Yo(Ma,$c))};this.Ay=(Ma,$c)=>{M.EwaSettings.Ra(39)&&(this.fAa=this.fAa||new of(this.$,this.BS,this.Mya),this.fAa.Ay(Ma,$c))};this.Li=(Ma,$c)=>{M.EwaSettings.Ra(39)&&this.BS.Li(Ma,$c)};this.sm=()=>{M.EwaSettings.Ra(39)&&this.BS.sm()};this.PHc=(Ma,
$c)=>{M.EwaSettings.Ra(39)&&this.BS.PHc(Ma,$c)};this.$=Qa;M.EwaSettings.Ra(39)&&(Pe.a.tRf(this.$),this.jY=new Ca(this.$),this.w3h(),M.EwaSettings.Ra(505)&&this.Oob&&(this.k1d=new eg(this.$,this.Oob)),this.BS=new Pa(this.$),this.Mya=new eb(this.$),this.$.Lp(this.Li),this.$.pa.iI(this.Yo),this.$.pa.WW(this.Ay),this.$.ea.Q0e(this.PHc),M.EwaSettings.fl()?this.$.ea.Jq(this.sm):this.$.ea.Uq(this.sm))}get Oob(){return this.hdd}dispose(){this.$&&M.EwaSettings.Ra(39)&&(this.$.Au(this.Li),this.$.pa.MK(this.Yo),
this.$.pa.VY(this.Ay),this.$.ea.WBg(this.PHc),M.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&this.$.ea.dv(this.sm));n.a.Ng(this.Mya);n.a.Ng(this.Oob);this.hdd=null;n.a.Ng(this.jY);this.jY=null;n.a.Ng(this.k1d);this.$=this.k1d=null;super.dispose()}ztb(){M.EwaSettings.Ra(39)&&this.BS.ztb()}ETc(Qa,Ma,$c,de,Be,nf,Tf,Xf,zg,$f,Ng,pg,Ug,Og){M.EwaSettings.Ra(39)&&(this.fAa=this.fAa||new of(this.$,this.BS,this.Mya),this.fAa.ETc(Qa,Ma,$c,de,Be,nf,Tf,Xf,zg,$f,Ng,pg,Ug,Og))}A3b(Qa,Ma){M.EwaSettings.Ra(39)&&
(this.rza=this.rza||new Gd(this.$,this.BS,this,this.jY),this.rza.A3b(Qa,Ma))}rTc(){M.EwaSettings.Ra(39)&&(this.rza=this.rza||new Gd(this.$,this.BS,this,this.jY),this.rza.rTc())}ATc(){M.EwaSettings.Ra(39)&&(this.rza=this.rza||new Gd(this.$,this.BS,this,this.jY),this.rza.ATc())}r3(Qa){M.EwaSettings.Ra(39)&&this.BS.r3(Qa)}zId(Qa){return M.EwaSettings.Ra(39)?this.Fjf[Qa]:null}jLg(Qa){Qa&&(this.Fjf[Qa.type]=Qa)}$Ia(){return this.Mya.$Ia()}w3h(){Yb.a.Av&&void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&
(this.hdd=new af(this.$,this.jY))}}Object(u.a)(lc,"SessionStatisticsManager",Lc.a,[20]);var Gc=a(120),Cd=a(1193),Qd=a(144);class ge{constructor(Qa,Ma){this.hadConnectivityIssuesDuringUnload=this.wasOfflineDuringUnload=!1;this.timestamp=0;this.dataLossInfo=null;this.wasDataLostDuringUnload=!1;this.inactivityDurationBeforeUnloadSeconds=0;this.workbookHashedId=null;this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=!1;this.wacSessionId=null;this.timeFromLastStatusCode0=this.timeFromLastDisconnectionStart=
this.timeFromLastConnectivity=0;this.wasUpdatedOnBeforeUnload=this.wasUpdatedOnUnload=!1;this.lastSilentReopenEndTime=this.lastSilentReopenStartTime=this.disconnectionSource=null;this.workbookHashedId=Qa;this.wasUpdatedOnUnload=this.wasDataLostDuringUnload=this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=!1;this.wacSessionId=Ma}mue(){return Cc.a.li(this)}}Object(u.a)(ge,"AppUnloadInfo",null,[]);var ye=a(888),$e=a(127),qf=a(656);class h{constructor(Qa){this.lostOperationsCount=
0;this.mostCommonOperationName=null;this.mostCommonOperationCount=0;this.dataLossReason=null;this.lostOperationsCount=Qa.Pcf+Qa.k0g;this.dataLossReason=Qa.Q9e;this.aOh(Qa.aye)}aOh(Qa){const Ma=new ye.a(qf.a.vU());let $c=0,de=0;for(const Be of Qa)Ma.Vg(Be)||Ma.ga(Be,0),Qa=Ma.ga(Be,Ma.ma(Be)+1),Qa>$c&&($c=Qa,de=Be);$c>this.mostCommonOperationCount&&(this.mostCommonOperationName=$e.a(de),this.mostCommonOperationCount=$c)}}Object(u.a)(h,"DataLossInfo",null,[]);var Z=a(70);class E{constructor(Qa){this.Aod=
"AppUnloadInfo";this.Ht=this.$=this.workbookHashedId=this.jI=null;this.LDe=this.eHe=!1;this.ql=null;this.QQf=0;this.Ooa=(Ma,$c)=>{this.QQf=$c.r_c};this.Rog=(Ma,$c)=>{$c.aye.length&&this.$.BU&&(this.jI.dataLossInfo=new h($c),this.jI.wasDataLostDuringUnload=!0,this.kub())};this.sm=()=>{this.V4b();this.$.ea.dv(this.sm)};this.Pq=()=>{this.V4b();this.$.ea.qB(this.Pq)};this.S2a=()=>{this.jI.wasUpdatedOnBeforeUnload=!0;this.jI.inactivityDurationBeforeUnloadSeconds=this.ql.Rwb<E.dDj?this.QQf:this.ql.Rwb;
this.b3g()};this.b0b=()=>{this.jI.wasUpdatedOnUnload=!0;this.b3g();Sys.Application.remove_unload(this.b0b)};this.pOc=()=>{this.jI.lastSilentReopenStartTime=z.a.Tg.Wh;this.jI.lastSilentReopenEndTime=null;this.kub();this.$.nr(this.S_b)};this.S_b=()=>{this.jI.lastSilentReopenEndTime=z.a.Tg.Wh;this.kub();this.$.Pr(this.S_b)};this.localStorage=new pf.a;this.localStorage.jl()&&(this.$=Qa,this.workbookHashedId=Z.a(this.$),this.jI=new ge(this.workbookHashedId,this.$.ua.UserSessionId),this.Ht=C.a.instance.WT(),
this.Ht.Aa("beforeunload",this.S2a),this.$.userOperationManager.jBh(this.Rog),M.EwaSettings.Bn("AppUnloadTelemetryManager")?Qa.ea.An?this.V4b():this.$.ea.Bw(this.Pq):Qa.ea.Ul?this.V4b():M.EwaSettings.fl()?this.$.ea.Jq(this.V4b):this.$.ea.Uq(this.sm),this.ql=this.$.ea.ql,this.ql.jFa(this.Ooa),Sys.Application.add_unload(this.b0b),this.$.ea.qGb(this.pOc))}get dialogPromptedOnUnload(){return this.eHe}set dialogPromptedOnUnload(Qa){this.eHe=Qa;this.jI?(this.jI.dialogPromptedOnUnload=Qa,this.kub()):this.localStorage.jl()&&
N.ULS.sendTraceTag(537151058,0,10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.jl()}`)}get apiBeforeCloseNotificationEnabledOnUnload(){return this.LDe}set apiBeforeCloseNotificationEnabledOnUnload(Qa){this.LDe=Qa;this.jI?(this.jI.apiBeforeCloseNotificationEnabledOnUnload=Qa,this.kub()):this.localStorage.jl()&&N.ULS.sendTraceTag(537151057,0,10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.jl()}`)}dispose(){this.$&&
this.$.userOperationManager&&this.$.userOperationManager.ulk(this.Rog);this.ql&&(this.ql.HNa(this.Ooa),this.ql=null);this.Ht.sO();this.$=this.Ht=null}b3g(){this.NDk();this.kub()}NDk(){this.jI.wasOfflineDuringUnload=this.$.Ql.Iga;this.jI.timeFromLastConnectivity=Qd.a(z.a.Tg,this.$.Ql.X2f);this.jI.timeFromLastDisconnectionStart=Qd.a(z.a.Tg,this.$.Ql.Jsj);this.jI.disconnectionSource=Enum.toString(Cd.a,this.$.Ql.disconnectionSource);this.jI.hadConnectivityIssuesDuringUnload=this.$.Ql.xxa;this.jI.timeFromLastStatusCode0=
Qd.a(z.a.Tg,this.$.Ql.W2f)}kub(){this.jI.timestamp=Date.now();this.localStorage.Wub(this.Aod,this.jI.mue())}V4b(){const Qa=this.localStorage.WIa(this.Aod);if(Qa)try{const Ma=Cc.a.Gp(Qa);this.localStorage.HAg(this.Aod);const $c=this.hBj(Ma);N.ULS.sendTraceTag(574677456,0,50,$c)}catch(Ma){N.ULS.sendTraceTag(537151056,0,15,`AppUnloadTelemetryManager.SendLogFromLocalStorage: Exception message: ${Ma.message}`)}else N.ULS.sendTraceTag(574677457,0,50,"AppUnloadTelemetryManager.SendLogFromLocalStorage: No previous app-unload information")}hBj(Qa){const Ma=
{};Ma.WACSessionID=Qa.wacSessionId;Ma.wasRefreshed=this.DSh(Qa,this.$.ua.MaxAppReloadDurationIndicatingRefresh);Ma.closedWithDialogConfirmation=Qa.dialogPromptedOnUnload;Ma.wasOfflineDuringUnload=Qa.wasOfflineDuringUnload;Ma.TimeFromLastConnectivityMs=Qa.timeFromLastConnectivity;Ma.TimeFromLastDisconnectionStart=Qa.timeFromLastDisconnectionStart;Ma.wasDataLostDuringUnload=Qa.wasDataLostDuringUnload;Ma.DataLossInfo=Qa.dataLossInfo;Ma.flushedOnUnload=Qa.wasUpdatedOnUnload;Ma.flushedOnBeforeUnload=Qa.wasUpdatedOnBeforeUnload;
Ma.InactivityDurationBeforeUnload=Qa.inactivityDurationBeforeUnloadSeconds;Ma.DisconnectionSource=Qa.disconnectionSource;Ma.hadConnectivityIssuesDuringUnload=Qa.hadConnectivityIssuesDuringUnload;Ma.TimeFromLastStatusCode0=Qa.timeFromLastStatusCode0;Ma.LastSilentReopenStartTime=Qa.lastSilentReopenStartTime;Ma.LastSilentReopenEndTime=Qa.lastSilentReopenEndTime;M.EwaSettings.isChangeGateEnabled("OfficeVSO:5144186_LogBeforeCloseNotificationApiStatusOnUnload")&&(Ma.ApiBeforeCloseNotificationEnabledOnUnload=
Qa.apiBeforeCloseNotificationEnabledOnUnload);return ua.c(Ma)}DSh(Qa,Ma){const $c=window.performance.timing.navigationStart-Qa.timestamp;(Qa=this.workbookHashedId===Qa.workbookHashedId&&$c<Ma)&&N.ULS.sendTraceTag(537151055,0,50,"AppUnloadTelemetryManager.CheckRefresh: Session is after refresh");return Qa}static Aa(Qa){Qa.ea.th.inWebPart||Qa.ka.ph(410,new E(Qa))}}E.dDj=10;Object(u.a)(E,"AppUnloadTelemetryManager",null,[658,2]);var aa=a(12),Ja=a(68),tb=a(323);class S{constructor(Qa){this.qkf=!1;this.skf=
null;this.tj=()=>{this.ask();Q.f(this.$).ha&&Q.f(this.$).ha.Fba(this.tj)};this.aq=(Ma,$c)=>{$c.na&&!this.Fte.has($c.na.name)&&(this.Fte.add($c.na.name),Q.f(this.$).ha&&(Q.f(this.$).ha.Fba(this.tj),Q.f(this.$).ha.u9(this.tj)))};this.$=Qa;this.uXg=new Set;this.Fte=new Set;this.$.sa&&this.$.sa.na&&this.Fte.add(this.$.sa.na.name);Q.f(this.$).ha.u9(this.tj);this.$.sa.Qm(this.aq)}dispose(){this.$=null}ask(){this.skf||this.lOh();var Qa=Q.f(this.$);const Ma=[];for(var $c of Qa.J$()){Qa=$c.domElement.getElementsByClassName(Ja.pb);
for(let Be=Qa.length-1;0<=Be;Be--){var de=Qa[Be].firstChild;(de=de?tb.b(de.currentStyle):"")&&!Ma.includes(de)&&Ma.push(de)}}this.qkf||($c=aa.a.instance.Ba(281).split(","),Ma.push(...$c),this.qkf=!0);for(const Be of Ma)Be&&!this.uXg.has(Be)&&(this.Bxj(Be),this.uXg.add(Be))}Bxj(Qa){this.KPh(Qa)}lOh(){this.skf=S.QIa("monospace");S.QIa("sans-serif");S.QIa("serif")}KPh(Qa){S.QIa(`${Qa},${"monospace"}`);S.QIa(`${Qa},${"sans-serif"}`);S.QIa(`${Qa},${"serif"}`)}static Aa(Qa){if(M.EwaSettings.Ra(61)){const Ma=
new S(Qa);Qa.ka.ph(210,Ma)}}static QIa(Qa){const Ma=document.createElement("div"),$c=document.createElement("div");Ma.style.cssText="position: absolute; overflow: auto; visibility: hidden;";S.ADk($c,Qa);document.body.appendChild(Ma);Ma.appendChild($c);$c.innerText="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890~!@#$%^&*()-+";Qa=$c.offsetWidth+"x"+$c.offsetHeight;document.body.removeChild($c.parentNode);return Qa}static ADk(Qa,Ma){Qa.style.cssText="display: inline; visibility: hidden;";
Qa.style.fontSize="100px";Qa.style.fontWeight="normal";Qa.style.fontStyle="normal";Qa.style.letterSpacing="normal";Qa.style.lineHeight="normal";Qa.style.whiteSpace="nowrap";Qa.style.fontFamily=Ma}}Object(u.a)(S,"FontTelemetryManager",null,[2]);var Wa=a(259),zb=a(162),hc;(function(Qa){Qa[Qa.legacyMultiLineRibbon=0]="legacyMultiLineRibbon";Qa[Qa.reactSingleLineRibbon=1]="reactSingleLineRibbon";Qa[Qa.reactMultiLineRibbon=2]="reactMultiLineRibbon";Qa[Qa.invalid=3]="invalid"})(hc||(hc={}));Object(u.b)("RibbonMode",
hc);var cd=a(131);class ta{constructor(){this.longFramesOverThresholdOpsPercentage=this.longFramesOverThresholdOps=this.fpsUnderThresholdOpsPercentage=this.fpsUnderThresholdOps=0;this.maxLongFrameDuration=-1}}Object(u.a)(ta,"FramePerformanceData",null,[]);class wb{constructor(Qa){this.name=null;this.count=0;this.minFPS=-1;this.maxFPS=0;this.l1FramePerformanceData=new ta;this.l2FramePerformanceData=new ta;this.l3FramePerformanceData=new ta;this.name=Qa}}Object(u.a)(wb,"FramePerformanceDataGroup",null,
[]);class ic{constructor(){this._reportName=null;this.operationsGroups=[];this._reportName="FramePerformanceCanvas"}get reportName(){return this._reportName}}Object(u.a)(ic,"FramePerformanceSessionEndsReport",null,[85]);class Oa{constructor(Qa){this.H9d={};this.Cta=null;this.Mxb=(Ma,$c)=>{Ma.longFramesOverThresholdOps++;Ma.maxLongFrameDuration=Math.max(Ma.maxLongFrameDuration,$c)};this.Ak=new ic;this.l4h();Qa.ka.Lh(276,()=>{Fe.a(Qa).r3(this.Ak)})}l4h(){this.Cta=new wb("AllGridOperationsData");this.Ak.operationsGroups.push(this.Cta);
this.HKb("Selection","SelectingRange_keyboard SelectingRange_mouse WidgetSelectAll SelectAll ExtendDown ExtendEnd ExtendLeft ExtendRight ExtendRowEnd ExtendRowStart ExtendScreenDown ExtendScreenUp ExtendSelectionToA1 ExtendSelectionToUsedRangeEnd ExtendStart ExtendToBottomEdge ExtendToLeftEdge ExtendToRightEdge ExtendToTopEdge ExtendUp MoveRight MoveUp MoveLeft MoveDown MoveToRightEdge MoveToLeftEdge MoveToBottomEdge Goto GotoA1 GotoRowStart GotoUsedRangeEnd MoveRightWithinSelectionOrFunctionAutoComplete MoveLeftWithinSelection".split(" "));
this.HKb("DragScroll",["DragScroll"]);this.HKb("Scroll",["ViewportVerticalScroll","ViewportHorizontalScroll"]);this.HKb("Typing",["GridTypingKeyPressed","FormulaBarTypingKeyPressed","EditBoxStartEdit"]);this.HKb("FloatingObjects",["SelectingFloatingObject","FloatingObjectMove","FloatingObjectResize"])}unk(Qa,Ma,$c,de){const Be=this.tKi(Qa);Be&&(this.Ak.operationsGroups.some(nf=>xa.a.equals(nf.name,Be.name,!1))||this.Ak.operationsGroups.push(Be),Be.count++,this.D1c(Ma,Be),this.z1c($c,Be),this.Cta.count++,
this.D1c(Ma,this.Cta),this.z1c($c,this.Cta),0<de&&this.r5k(de,Be),0<=Ma&&this.B4k(Ma,Be))}W5k(){for(const Qa of this.Ak.operationsGroups)Oa.J4k(Qa)}HKb(Qa,Ma){Qa=new wb(Qa);for(const $c of Ma)this.H9d[$c]=Qa}tKi(Qa){return Qa in this.H9d?this.H9d[Qa]:null}B4k(Qa,Ma){30>Qa&&this.swe($c=>{$c.l1FramePerformanceData.fpsUnderThresholdOps++},Ma);15>Qa&&this.swe($c=>{$c.l2FramePerformanceData.fpsUnderThresholdOps++},Ma);5>Qa&&this.swe($c=>{$c.l3FramePerformanceData.fpsUnderThresholdOps++},Ma)}r5k(Qa,Ma){100<=
Qa&&(this.Nxb(Ma.l1FramePerformanceData,Qa,this.Mxb),this.Nxb(this.Cta.l1FramePerformanceData,Qa,this.Mxb));300<=Qa&&(this.Nxb(Ma.l2FramePerformanceData,Qa,this.Mxb),this.Nxb(this.Cta.l2FramePerformanceData,Qa,this.Mxb));600<=Qa&&(this.Nxb(Ma.l3FramePerformanceData,Qa,this.Mxb),this.Nxb(this.Cta.l3FramePerformanceData,Qa,this.Mxb))}swe(Qa,Ma){Ma&&(Qa(Ma),Qa(this.Cta))}Nxb(Qa,Ma,$c){Qa&&$c(Qa,Ma)}D1c(Qa,Ma){Ma.minFPS=-1===Ma.minFPS?Qa:Math.min(Ma.minFPS,Qa)}z1c(Qa,Ma){Ma.maxFPS=Math.max(Ma.maxFPS,
Qa)}static J4k(Qa){Oa.Xwe(Qa.l1FramePerformanceData,Qa.count);Oa.Xwe(Qa.l2FramePerformanceData,Qa.count);Oa.Xwe(Qa.l3FramePerformanceData,Qa.count)}static Xwe(Qa,Ma){Qa.fpsUnderThresholdOpsPercentage=100*Qa.fpsUnderThresholdOps/Ma;Qa.longFramesOverThresholdOpsPercentage=100*Qa.longFramesOverThresholdOps/Ma}}Object(u.a)(Oa,"FramePerformanceSessionEndsReportManager",null,[]);class Cb{constructor(){this.f=null}}Object(u.a)(Cb,"FpsDataWrapper",null,[]);class yc{constructor(Qa,Ma){this.duration=this.startSecond=
0;this.startSecond=void 0===Qa?-1:Qa;this.duration=void 0===Ma?-1:Ma}}Object(u.a)(yc,"LongFrameData",null,[]);var Nc=a(388);class Id{constructor(Qa,Ma,$c,de,Be,nf,Tf,Xf,zg,$f){this.Op=null;this.Min=this.Max=this.Avg=this.end=this.start=this.count=0;this.LFrame=null;this.tfAppInt=this.coauth=this.longFrameCount=0;this.Props=null;this.Op=void 0===Qa?null:Qa;this.count=void 0===Ma?0:Ma;this.start=void 0===$c?-1:$c;this.end=void 0===de?-1:de;this.Avg=void 0===Be?0:Be;this.Max=void 0===nf?-1:nf;this.Min=
Nc.a.C9g;this.longFrameCount=void 0===Tf?0:Tf;this.coauth=(void 0===Xf?-1:Xf)||1;this.tfAppInt=void 0===zg?-1:zg;this.Props=void 0===$f?null:$f;this.LFrame=null}}Object(u.a)(Id,"OperationFPSData",null,[]);var ke=a(959);class Ie extends Lc.a{constructor(Qa,Ma){super();this.PGb=-1;this.xZd=0;this.jLa=new Date(0);this.O9=null;this.Tua={};this.CHa=new Wb.a;this.$ie=this.bob=!1;this.Sib=null;this.h_c=this.Pya=0;this.isSynthetic=!1;this.ezf=()=>{const $c=new Date;var de=$c.getMinutes();const Be=$c.getSeconds();
this.RWb&&$c.getTime()-this.RWb.getTime()>this.AVk?(this.stop(),this.vFd($c)):(de!==this.xZd&&(this.vFd($c),this.xZd=de),this.bob&&(this.Wj.tn?this.O9[Be]=Ie.Xsc:(this.$lf(Be),this.bob=!1,this.CHa.clear(),this.Tua={})),this.O9[Be]!==Ie.Xsc&&(this.O9[Be]++,de=$c.getTime()-this.jLa.getTime(),de>this.Y6f&&this.Yxj(this.jLa,de)),this.PGb=window.requestAnimationFrame(this.ezf),this.jLa=$c)};this.mP=()=>{this.bob=!0};this.Adg=()=>{this.pause()};this.Bdg=()=>{this.$ie&&this.resume()};this.Xo=()=>{this.za.H5()&&
this.A5k()};this.zoom=Ma;this.RWb=new Date;this.Wj=new W;this.Wj.t9(this.mP);K.AFrameworkApplication.kmd(this.Adg);K.AFrameworkApplication.lmd(this.Bdg);this.$=Qa;this.Y6f=Qa.ua.LongFrameThresholdMs;this.Vzj="MoreThan_"+this.Y6f.toString()+"_Ms";this.zVk=Qa.ua.ThresholdToEndOperationTrackingSeconds;this.AVk=Qa.ua.ThresholdToStopFPSTrackingMS;this.za=Q.f(this.$).za;K.AFrameworkApplication.Nh&&K.AFrameworkApplication.Nh.IsSynthetic&&(this.isSynthetic=xa.a.compare(K.AFrameworkApplication.Nh[ib.a.isSynthetic],
"True",!0)?!1:!0);this.za.Uy(this.Xo);this.tie()}get zoomManager(){return this.zoom.zoomManager}start(){this.$ie=!0;this.resume()}stop(){this.$ie=!1;this.pause()}dispose(){this.stop();this.Wj.p5a(this.mP);K.AFrameworkApplication.rBg(this.Adg);K.AFrameworkApplication.sBg(this.Bdg);n.a.Ng(this.Wj);this.za.Ix(this.Xo);super.dispose()}jRk(Qa,Ma){const $c=Qa in this.Tua?this.Tua[Qa]:null;this.RWb=new Date;this.start();const de=this.RWb.getSeconds(),Be=de+this.zVk;$c&&de<=$c.end?($c.count++,$c.end=Be):
($c&&de>$c.end&&this.CHa.add($c),this.Tua[Qa]=new Id(Qa,1,de,Be,void 0,void 0,void 0,this.$.ea.yt.length,Ea.a.instance.Tfa(this.RWb),Ma))}y2h(){this.Sib||(this.vFd(new Date),this.Sib=new Oa(this.$))}resume(){this.VVf()||!this.za.WY||this.isSynthetic||(this.bob=this.Wj.tn,this.jLa=new Date,this.xZd=this.jLa.getMinutes(),this.tie(),this.$lf(this.jLa.getSeconds()),this.PGb=window.requestAnimationFrame(this.ezf))}VVf(){return 0<=this.PGb}pause(){this.VVf()&&(this.bob||(this.amf((new Date).getSeconds()),
N.ULS.sendTraceTag(21280654,0,50,`FPS : ${this.O9.toString()}`)),window.cancelAnimationFrame(this.PGb),this.PGb=-1)}vFd(Qa){if(Qa.getTime()-this.jLa.getTime()<Ie.YDj&&(this.bob&&this.amf(this.jLa.getSeconds()),this.chi(),0<this.CHa.count&&(Qa={},Qa.NonEmptyCellsCount=this.Pya,Qa.TextCellsCount=this.h_c,Qa.xlfpsJson=Object(Ta.a)(new Cb,{f:this.CHa.toArray()}),Qa.memoryInfo=this.sDj(),Qa.zoom=this.zoomManager?this.zoomManager.zoom:1,Qa.RibbonMode=zb.a(this.$)?hc[zb.a(this.$).rS]:Ie.invalid,Qa.deviceMemory=
navigator.deviceMemory||0,Qa.hardwareConcurrency=navigator.hardwareConcurrency||0,Qa=JSON.stringify(Qa),N.ULS.sendTraceTag(537151044,0,50,`FPS : ${this.O9.toString()}`),!this.isSynthetic))){if(Fa.a.$pa()){var Ma={};Ma.xlfpsJson=Qa;this.$.wAa(jf.a.Lbl,Ma,!1)}else N.ULS.sendTraceTag(388781010,0,50,`${Qa}`);for(const $c of this.CHa){Ma=1E3>=this.Pya?"0_1000":3E3>=this.Pya?"1000_3000":"3000_inf";const de=new Map;de.set("Operation",$c.Op);de.set("BucketOfRenderedCells",Ma);Aa.Health.instance.recordKpiUsage(Re.a.longFrame,
ff.b.FailureBased,Zd.a.canvas,de);0<$c.longFrameCount&&Aa.Health.instance.recordKpiFailure(Re.a.longFrame,"LongFrame",!1,!0,{extendedProperties:de});3E4<$c.tfAppInt&&(0<$c.longFrameCount?Kd.b().GDg(0,this.Vzj,de):Kd.b().HDg(0,de))}N.ULS.sendTraceTag(537151043,0,50,`Operations message length: ${Qa.length}`)}this.reset()}sDj(){const Qa={};if(window.performance){const Ma=window.performance.memory;Ma&&(Qa.jsHeapSizeLimit=Ma.jsHeapSizeLimit,Qa.usedJSHeapSize=Ma.usedJSHeapSize,Qa.totalJSHeapSize=Ma.totalJSHeapSize)}return Qa}reset(){this.CHa.clear();
this.Tua={};this.tie()}chi(){var Qa=!0;Qa=void 0===Qa?!0:Qa;if(this.O9){for(const Ma of ke.a(this.Tua)){const $c=this.Tua[Ma];$c.end=Math.min(this.O9.length-1,$c.end);this.CHa.add($c)}this.JOh(this.CHa,this.O9,Qa)}}JOh(Qa,Ma,$c){$c=void 0===$c?!0:$c;for(const de of Qa){let Be=Qa=0;if(de.end<Ma.length){for(let nf=de.start;nf<=de.end;nf++){const Tf=Ma[nf];0<=Tf&&(de.Max=Math.round(Math.max(de.Max,Tf)),de.Min=Math.round(Math.min(de.Min,Tf)),Qa+=Tf,Be++)}0<Be&&(de.Avg=Math.round(Qa/Be));$c&&this.Sib&&
this.Sib.unk(de.Op,de.Min,de.Max,de.LFrame?de.LFrame.duration:-1);de.Props&&(this.Y_k(de),de.Props=null)}}$c&&this.Sib&&this.Sib.W5k()}tie(){this.O9=Array(60).fill(0)}$lf(Qa){Qa++;for(let Ma=0;Ma<Qa;Ma++)this.O9[Ma]=Ie.Xsc}amf(Qa){for(;60>Qa;Qa++)this.O9[Qa]=Ie.Xsc}Yxj(Qa,Ma){Qa=Qa.getSeconds();var $c=ke.a(this.Tua);if(0<$c.length)for(const de of $c)if($c=this.Tua[de],Qa>=$c.start&&Qa<$c.end)$c.LFrame?$c.LFrame.duration<Ma&&($c.LFrame.startSecond=Qa,$c.LFrame.duration=Ma,$c.longFrameCount++):($c.LFrame=
new yc(Qa,Ma),$c.longFrameCount++)}A5k(){this.h_c=this.Pya=0;for(const Qa of Q.f(this.$).yu){const Ma=Qa.hQa;for(const $c in Ma){const de=this.za.zn(Ma[$c].hashCode);if(null===de||void 0===de?0:de.Fp)this.Pya+=de.Fj.NonEmptyCellsCount,this.h_c+=de.Fj.TextValueCellsCount}}}Y_k(Qa){const Ma=Qa.Props;if(oe.a.s6b in Ma&&Ma[oe.a.s6b]&&oe.a.v8b in Ma){let $c;($c=Object(gb.a)(Wa.a,Ma[oe.a.v8b]))&&$c.continueWith(de=>{cd.TextEditorTelemetry.instance.Iuh(Qa.Op,Qa.Min,!!Qa.LFrame,Qa.LFrame?Qa.LFrame.duration:
0,de.result)})}}}Ie.Xsc=-1;Ie.YDj=6E4;Ie.invalid="Invalid";Object(u.a)(Ie,"FramePerformanceTracker",Lc.a,[667,2]);class Le extends Ac.a{constructor(Qa){super();this.$=Qa;this.Bl()}create(){let Qa=this.$.ka.Ug(263);void J.a.resolve(D.Lg).then(Ma=>{Qa||(Qa=this.$.ka.ph(263,new Ie(this.$,Ma)));this.Yj(Qa)})}static Aa(Qa){M.EwaSettings.isChangeGateEnabled("OfficeVSO:8759538_removeXLFPSTag")||Qa.ka.ph(264,new Le(Qa))}}Object(u.a)(Le,"FramePerformanceTrackerFactory",Ac.a,[]);var wf=a(1047);class Kf{Vl(Qa,
Ma){return new wf.a(Qa,Ma)}vi(Qa,Ma){Qa=this.Vl(Qa,Ma);Qa.start();return Qa}}Object(u.a)(Kf,"DefaultStopwatchBuilder",null,[911]);class cg{constructor(){this.gDa=new Kf}Vl(Qa,Ma){return this.gDa.Vl(Qa,Ma)}vi(Qa,Ma){return this.gDa.vi(Qa,Ma)}}Object(u.a)(cg,"StopwatchBuilder",null,[911]);var Bg=a(353),dh=a(1072),Sf=a(1201),eh;(function(Qa){Qa[Qa.actions=0]="actions";Qa[Qa.correlationStart=1]="correlationStart";Qa[Qa.reorderSheetOp=2]="reorderSheetOp";Qa[Qa.formatCellOp=3]="formatCellOp";Qa[Qa.copyOp=
4]="copyOp";Qa[Qa.pasteOp=5]="pasteOp";Qa[Qa.getNumberViewModelDataOp=6]="getNumberViewModelDataOp";Qa[Qa.instantaneousSetData=7]="instantaneousSetData";Qa[Qa.immediateSetData=8]="immediateSetData";Qa[Qa.dependentCellsCalc=9]="dependentCellsCalc";Qa[Qa.dependentCellsGraphStat=10]="dependentCellsGraphStat";Qa[Qa.dependentCellsGraphSectionStat=11]="dependentCellsGraphSectionStat";Qa[Qa.getRangeContentPrefetchFailures=12]="getRangeContentPrefetchFailures";Qa[Qa.gridBlockUpdates=13]="gridBlockUpdates";
Qa[Qa.browserAppStart=14]="browserAppStart";Qa[Qa.linkedObjects=15]="linkedObjects";Qa[Qa.longFrames=16]="longFrames";Qa[Qa.task=17]="task";Qa[Qa.conflictInEditing=18]="conflictInEditing";Qa[Qa.incomingPresenceData=19]="incomingPresenceData";Qa[Qa.editorTableDelay=20]="editorTableDelay";Qa[Qa.presenceStartup=21]="presenceStartup";Qa[Qa.presenceDelete=22]="presenceDelete";Qa[Qa.editorEvent=23]="editorEvent";Qa[Qa.editorTime=24]="editorTime";Qa[Qa.gridScreenReaderOps=25]="gridScreenReaderOps";Qa[Qa.sendPresenceToService=
26]="sendPresenceToService";Qa[Qa.IME=27]="IME";Qa[Qa.freezePaneFloatingObjects=28]="freezePaneFloatingObjects";Qa[Qa.customizeStatusBar=29]="customizeStatusBar";Qa[Qa.clientWebRequests=30]="clientWebRequests";Qa[Qa.showCommentTaskPane=31]="showCommentTaskPane";Qa[Qa.applyThreadedCommentChange=32]="applyThreadedCommentChange";Qa[Qa.upgradeLegacyCommentsChange=33]="upgradeLegacyCommentsChange";Qa[Qa.findNextOrPreviousComment=34]="findNextOrPreviousComment";Qa[Qa.goto=35]="goto";Qa[Qa.launchOfficeAddInDialog=
36]="launchOfficeAddInDialog";Qa[Qa.richApiInvocation=37]="richApiInvocation";Qa[Qa.fxLibrary=38]="fxLibrary";Qa[Qa.embeddedApiSession=39]="embeddedApiSession";Qa[Qa.numberFormattingCalculator=40]="numberFormattingCalculator";Qa[Qa.requestDataAfterSend=41]="requestDataAfterSend";Qa[Qa.floatingObjectsStopwatchData=42]="floatingObjectsStopwatchData";Qa[Qa.copy=43]="copy";Qa[Qa.paste=44]="paste";Qa[Qa.dragDrop=45]="dragDrop";Qa[Qa.clearCopyState=46]="clearCopyState";Qa[Qa.webWorkerRecalcStats=47]="webWorkerRecalcStats";
Qa[Qa.dataValidationEditOpenDialog=48]="dataValidationEditOpenDialog";Qa[Qa.dataValidationEditSubmitRule=49]="dataValidationEditSubmitRule";Qa[Qa.customSort=50]="customSort";Qa[Qa.namedSheetViewUserAction=51]="namedSheetViewUserAction";Qa[Qa.namedSheetViewTeachingCallout=52]="namedSheetViewTeachingCallout";Qa[Qa.namedSheetViewTeachingDialog=53]="namedSheetViewTeachingDialog";Qa[Qa.namedSheetViewOptionsDialog=54]="namedSheetViewOptionsDialog";Qa[Qa.namedSheetViewTempViewSaveDialog=55]="namedSheetViewTempViewSaveDialog";
Qa[Qa.temporaryViewStartedDataRestore=56]="temporaryViewStartedDataRestore";Qa[Qa.temporaryViewFetchedVersion=57]="temporaryViewFetchedVersion";Qa[Qa.raiseEventsAndGenerateBlockRequests=58]="raiseEventsAndGenerateBlockRequests";Qa[Qa.launchMakerCodeEditor=59]="launchMakerCodeEditor"})(eh||(eh={}));Object(u.b)("UsageTable",eh);var Rg=a(479),Dg=a(541),Kg=a(705),Hg=a(767),fh=a(307);class Vh extends Sys.EventArgs{constructor(){super();this.uGj=0;this.operation="DOMUpdate";this.sender=this.target=null}}
Object(u.a)(Vh,"CalculatedAverageUpdatedEventArgs",Sys.EventArgs,[]);class Yf{constructor(Qa,Ma){this.Uje=void 0===Ma?1:Ma;this.total=Qa}get average(){return this.total/this.Uje}KVh(Qa){return new Yf(this.total+Qa.total,this.Uje+Qa.Uje)}static uLh(Qa,Ma){return`${Qa}_${Ma}`}}Object(u.a)(Yf,"StopwatchAverage",null,[]);var Eg;(function(Qa){Qa[Qa.longFrame=0]="longFrame";Qa[Qa.longGetRange=1]="longGetRange";Qa[Qa.longJsTask=2]="longJsTask";Qa[Qa.viewportCalculationLoops=3]="viewportCalculationLoops"})(Eg||
(Eg={}));Object(u.b)("UtrKpiVeto",Eg);class hg{static mkb(Qa){return Enum.toString(Eg,Qa)}}hg.aQa="UTR";Object(u.a)(hg,"KpiConstants",null,[]);class qg{}qg.W4g="UTRVetoName";qg.O4g="UTRErrorName";qg.S4g="UTROperationName";qg.m2c="UTRDuration";qg.U4g="UTREndedInPhase";qg.dye="UTRMessage";qg.V4g="UtrUnavailabilityType";qg.operationName="OperationName";qg.duration="Duration";qg.message="Message";Object(u.a)(qg,"UtrAdditionalData",null,[]);class jh{}jh.G$k="VetoLike";jh.jof="E2EOperationPerf";jh.dok=
"RequestPerf";jh.X0k="UnavailabilityDurations";Object(u.a)(jh,"UtrTypes",null,[]);class dg{y3b(Qa,Ma,$c){$c=void 0===$c?null:$c;M.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||($c=$c?{extendedProperties:$c}:null,Qa=hg.mkb(Qa),Aa.Health.instance.recordKpiImpliedFailure("UTR_Veto_"+Qa,Ma,!1,!0,"",$c))}e5b(Qa,Ma,$c,de,Be,nf){nf[hg.aQa]=jh.G$k;nf[qg.W4g]=hg.mkb(de);nf[qg.O4g]=Be;N.ULS.sendTraceTag(Qa,Ma,$c,Cc.a.li(nf));delete nf[hg.aQa];delete nf[qg.W4g];delete nf[qg.O4g]}}Object(u.a)(dg,
"UtrKpiVetoReporter",null,[]);class Wh{Rhe(Qa,Ma){Ma=void 0===Ma?null:Ma;M.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||Aa.Health.instance.recordKpiUsage("UTR_Veto_Usage_"+hg.mkb(Qa),ff.b.FailureBased,"",Ma)}y3b(Qa,Ma,$c){$c=void 0===$c?null:$c;M.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(Qa=hg.mkb(Qa),Aa.Health.instance.recordKpiFailure("UTR_Veto_Usage_"+Qa,Ma,!1,!0,this.pwd($c)))}gnk(Qa,Ma){Ma=void 0===Ma?null:Ma;M.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||
Aa.Health.instance.recordKpiImpliedSuccess("UTR_Veto_Usage_"+hg.mkb(Qa),"",this.pwd(Ma))}fnk(Qa,Ma,$c){$c=void 0===$c?null:$c;M.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(Qa=hg.mkb(Qa),Aa.Health.instance.recordKpiImpliedFailure("UTR_Veto_Usage_"+Qa,Ma,!1,!0,"",this.pwd($c)))}pwd(Qa){return Qa?{extendedProperties:Qa}:null}}Object(u.a)(Wh,"UtrKpiVetoUsageReporter",null,[]);class Ch{sTc(Qa,Ma,$c){$c=void 0===$c?null:$c;M.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||
Aa.Health.instance.recordKpiImpliedSuccess("UTR_Perf_E2EOperation_"+Qa,"",{extendedProperties:$c,durationMs:Ma})}BTc(Qa,Ma,$c){$c=void 0===$c?null:$c;M.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(Ma?Aa.Health.instance.recordKpiImpliedSuccess("UTR_Perf_Request_"+Qa,"",{extendedProperties:$c}):Aa.Health.instance.recordKpiImpliedFailure("UTR_Perf_Request_"+Qa,"",!1,!1,"",{extendedProperties:$c}))}b5b(Qa,Ma,$c,de,Be,nf,Tf,...Xf){Tf=String.format(Tf,...Xf);Xf={};Xf[hg.aQa]=
jh.jof;Xf[qg.S4g]=de;Xf[qg.U4g]=Be;Xf[qg.m2c]=nf;Xf[qg.dye]=Tf;N.ULS.sendTraceTag(Qa,Ma,$c,Cc.a.li(Xf))}xVc(Qa,Ma,$c,de,Be,nf,Tf){const Xf={};Xf[hg.aQa]=jh.jof;Xf[qg.S4g]=de;Xf[qg.U4g]=Be;Xf[qg.m2c]=nf;Xf[qg.dye]=Tf;N.ULS.sendTraceTag(Qa,Ma,$c,Cc.a.li(Xf))}d5b(Qa,Ma,$c,de,Be,nf){this.JNg(nf,de,Be);N.ULS.sendTraceTag(Qa,Ma,$c,Cc.a.li(nf));this.B$h(nf)}c5b(Qa,Ma,$c,de,Be,nf,...Tf){nf=String.format(nf,...Tf);Tf={};this.JNg(Tf,de,Be,nf);N.ULS.sendTraceTag(Qa,Ma,$c,Cc.a.li(Tf))}yVc(Qa,Ma,$c,de){de[hg.aQa]=
jh.dok;N.ULS.sendTraceTag(Qa,Ma,$c,Cc.a.li(de));delete de[hg.aQa]}JNg(Qa,Ma,$c,de){de=void 0===de?null:de;Qa[hg.aQa]=jh.X0k;Qa[qg.V4g]=Ma;Qa[qg.m2c]=$c;de&&(Qa[qg.dye]=de)}B$h(Qa){delete Qa[hg.aQa];delete Qa[qg.V4g];delete Qa[qg.m2c]}}Object(u.a)(Ch,"UtrOperationPerfReporter",null,[]);class Fg extends v.a{constructor(Qa,Ma,$c,de,Be,nf){$c=void 0===$c?null:$c;de=void 0===de?null:de;Be=void 0===Be?null:Be;nf=void 0===nf?!1:nf;super();this.Oqi=[oe.a.K7e,oe.a.orf,oe.a.prf,oe.a.bDc,oe.a.yJc,oe.a.Tvj,oe.a.renderCachedContent,
oe.a.renderServerContent,oe.a.crc,oe.a.htk,oe.a.$Hg,oe.a.aIg,oe.a.lxk];this.ODb=this.oRa=this.X9b=this.ayb=this.yOe=this.R6e=this.Xab=this.JVe=null;this.brg=this.I7e=!1;this.R4g=this.Q4g=this.T4g=this.fie=this.n6g=null;this.Zlg=(Tf,Xf)=>{for(Tf=0;Tf<Xf.entries.length;Tf++){const pg=Xf.entries[Tf];pg.url=nb.a.removeParameter(pg.url,K.AFrameworkApplication.BL);var zg=nb.a.Dba(pg.url);!M.EwaSettings.Ra(426)&&this.Bnj(pg.url,zg)&&(pg.behavior=1);if("img"===pg.Dz.initiatorType&&zg.endsWith(dh.a.GAd)){var $f=
nb.a.Pfa(pg.url,dh.a.FAd),Ng=nb.a.Pfa(pg.url,dh.a.HAd);pg.m4=`${pg.m4}imageID=${$f}, imgStateID=${Ng}`}"css"===pg.Dz.initiatorType&&"responseStatus"in pg.Dz&&($f=`responseStatus=${pg.Dz.responseStatus}`,pg.m4=pg.m4?`${pg.m4},${$f}`:$f);$f=pg.Dz.transferSize;let Ug;Ng=pg.Dz.decodedBodySize;void 0!==$f&&null!==$f&&void 0!==Ng&&null!==Ng?Ug=0===$f&&0<Ng:void 0!==$f&&null!==$f&&(Ug=0===$f);Ea.a.instance.Svh(zg,Math.round(pg.Dz.fetchStart),Math.round(pg.Dz.responseEnd),Ug,this.lpj);xa.a.contains(zg,oe.a.richTextEditor,
!0)&&(zg=cd.TextEditorTelemetry.instance,zg.JN(oe.a.Kpk,Math.round(pg.Dz.fetchStart)),zg.JN(oe.a.Mpk,Math.round(pg.Dz.responseEnd)))}};this.mP=()=>{const Tf=this.Cia;for(const Xf in Tf)Tf[Xf].h=!0};this.userSessionId=Qa;this.Zfb=$c=$c||new Kg.a;this.Bp=de||z.a.Tg;this.cSk=Be||this;this.lpj=nf;this.kkf=$c.apb();M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void J.a.resolve(D.Ab).then(Tf=>{this.Wj=Tf;this.Wj.t9(this.mP)}):(this.Wj=new W,this.Wj.t9(this.mP),
Ma.ph(291,this.Wj))}get Cia(){return this.JVe||(this.JVe={})}get njf(){return this.ayb||this.kkf}get yjf(){return this.oRa||Fg.Gbg}get ise(){return this.R6e=this.R6e||{}}get xPc(){return this.Xab||"undefined"===typeof Stw?this.Xab:this.Xab=Stw.swpc}get S6f(){return this.yOe=this.yOe||{}}get PNa(){return this.ODb||(this.ODb=F.a.instance.Qi("Common.NetworkTiming.IResourceTimingLogger"))}get P4g(){return this.Q4g||(this.Q4g=new dg)}get S8a(){return this.T4g||(this.T4g=new Ch)}get n2c(){return this.R4g||
(this.R4g=new Wh)}MYc(Qa,Ma,$c,de,Be){Be=void 0===Be?null:Be;if(this.Cia[$c])throw Error.invalidOperation("The specified stopwatchId is already in use.");this.Cia[$c]=this.Lif(Qa,Ma,$c,de,Be)}quc(Qa,Ma){const $c=this.Cia[Qa];$c&&(this.ief($c,Ma),this.W2k($c),delete this.Cia[Qa])}eBg(Qa){delete this.Cia[Qa]}CUg(Qa,Ma){this.ayb||this.rUg(Qa,Ma)}kUg(){this.CUg(Fg.yNd,this.Bp.qk)}Tpf(Qa,Ma){Ma=void 0===Ma?!1:Ma;if(this.ayb){if(this.oRa===Fg.Z9d||this.oRa===Fg.yNd){const $c=qb.a.instance;$c.userSessionId=
this.userSessionId;if(this.oRa===Fg.Z9d){this.I7e||(this.moa(Qa.m,Object(ec.a)($c,$c.tck,"recordContentFetchEnd")),this.I7e=!0);if(Ma){this.brg||(this.moa(Qa.m,Object(ec.a)($c,$c.Ick,"recordPerceivedContentDisplayed")),this.brg=!0);return}this.moa(Qa.m,Object(ec.a)($c,$c.sck,"recordContentDisplayed"))}else this.oRa===Fg.yNd&&(Ma=this.Cia[this.X9b])&&this.moa(fh.a(Qa,Ma.s),Object(ec.a)($c,$c.Cck,"recordInteractivityContentDisplayed"),!1)}this.quc(this.X9b,Qa);this.X9b=this.oRa=this.ayb=null}}moa(Qa,
Ma,$c){$c=void 0===$c?!0:$c;qb.a.K3&&Object(Bg.a)(Hg.PerformanceClock,z.a.Tg)&&$c&&(Qa+=window.performance.timing.navigationStart);Ma(Qa)}kp(Qa){return Rg.a(Qa)}tl(Qa,Ma,$c){$c=void 0===$c?!1:$c;try{if(this.S6f[eh[Qa]]=!0,$c){var de=N.ULS,Be=de.sendTraceTag;const Dd={};let Lg=null;switch(Qa){case 0:Lg="Actions";var nf=Ma.a;null!=nf&&(Dd.Id=nf);var Tf=null==Ma.b?null:Ma.b;null!=Tf&&(Dd.Operation=Tf);var Xf=Ma.c;null!=Xf&&(Dd.Target=Xf);var zg=null==Ma.d?null:Ma.d.toString();null!=zg&&(Dd.StartTime=
zg);var $f=null==Ma.e?null:Ma.e.toString();null!=$f&&(Dd.Duration=$f);var Ng=Ma.f;null!=Ng&&(Dd.CorrelationId=Ng);var pg=Ma.g;null!=pg&&(Dd.ParentAction=pg);var Ug=null==Ma.h?null:Ma.h.toString();null!=Ug&&(Dd.DocumentHidden=Ug);break;case 1:Lg="CorrelationStart";var Og=Ma.a;null!=Og&&(Dd.CorrelationId=Og);var bh=Ma.b;null!=bh&&(Dd.UserSessionId=bh);var mh=Ma.c;null!=mh&&(Dd.UserAction=mh);break;case 2:Lg="ReorderSheetOp";var Tg=Ma.a;null!=Tg&&(Dd.UserSessionId=Tg);var Vg=null==Ma.b?null:Ma.b.toString();
null!=Vg&&(Dd.IsDragReorder=Vg);var nh=null==Ma.c?null:Ma.c.toString();null!=nh&&(Dd.DocumentUp=nh);var wh=null==Ma.d?null:Ma.d.toString();null!=wh&&(Dd.OldIndex=wh);var oh=null==Ma.e?null:Ma.e.toString();null!=oh&&(Dd.NewIndex=oh);var gh=null==Ma.f?null:Ma.f.toString();null!=gh&&(Dd.TotalSheets=gh);break;case 3:Lg="FormatCellOp";var lh=Ma.a;null!=lh&&(Dd.UserSessionId=lh);var Sh=null==Ma.b?null:Ma.b.toString();null!=Sh&&(Dd.TaskId=Sh);var ih=null==Ma.c?null:Ma.c.toString();null!=ih&&(Dd.NumberOfRanges=
ih);var di=Ma.d;null!=di&&(Dd.Ranges=di);var Ra=Ma.e;null!=Ra&&(Dd.ActiveCell=Ra);var Tb=null==Ma.f?null:Ma.f.toString();null!=Tb&&(Dd.ActionId=Tb);var Dc=Ma.g;null!=Dc&&(Dd.CommandParameters=Dc);var Yc=Ma.h;null!=Yc&&(Dd.UserActionStopwatchId=Yc);break;case 4:Lg="CopyOp";var Ad=Ma.a;null!=Ad&&(Dd.UserSessionId=Ad);var he=null==Ma.b?null:Ma.b.toString();null!=he&&(Dd.IsChrome=he);var re=null==Ma.c?null:Ma.c.toString();null!=re&&(Dd.IsIE=re);var Me=null==Ma.d?null:Ma.d.toString();null!=Me&&(Dd.IsFromUI=
Me);var Ve=null==Ma.e?null:Ma.e.toString();null!=Ve&&(Dd.IsCopyInLoadedRange=Ve);var Hf=null==Ma.f?null:Ma.f.toString();null!=Hf&&(Dd.IsRepeatedCopy=Hf);var Qf=null==Ma.g?null:Ma.g.toString();null!=Qf&&(Dd.IsClipboarAccessSupported=Qf);var ia=null==Ma.h?null:Ma.h.toString();null!=ia&&(Dd.IsClipboarAccessInstallationSupported=ia);var Xb=null==Ma.i?null:Ma.i.toString();null!=Xb&&(Dd.RibbonCommand=Xb);var Vc=null==Ma.j?null:Ma.j.toString();null!=Vc&&(Dd.CutCopyPasteFlags=Vc);var ud=null==Ma.k?null:Ma.k.toString();
null!=ud&&(Dd.IsDrag=ud);var xe=null==Ma.l?null:Ma.l.toString();null!=xe&&(Dd.IsIeBeforeAlowDenyPopUp=xe);var fe=Ma.m;null!=fe&&(Dd.IsPasteMatchCopy=fe);var Te=Ma.n;null!=Te&&(Dd.WaitMessageInClipboard=Te);var Bf=null==Ma.o?null:Ma.o.toString();null!=Bf&&(Dd.CallCount=Bf);break;case 5:Lg="PasteOp";var Cf=Ma.a;null!=Cf&&(Dd.UserSessionId=Cf);var Lf=null==Ma.b?null:Ma.b.toString();null!=Lf&&(Dd.IsChrome=Lf);var df=null==Ma.c?null:Ma.c.toString();null!=df&&(Dd.IsIE=df);var T=null==Ma.d?null:Ma.d.toString();
null!=T&&(Dd.IsCopyActive=T);var Ga=null==Ma.e?null:Ma.e.toString();null!=Ga&&(Dd.IsFromUI=Ga);var hb=null==Ma.f?null:Ma.f.toString();null!=hb&&(Dd.IsClipboarAccessSupported=hb);var jc=null==Ma.g?null:Ma.g.toString();null!=jc&&(Dd.IsClipboarAccessInstallationSupported=jc);var Zc=null==Ma.h?null:Ma.h.toString();null!=Zc&&(Dd.RibbonCommand=Zc);var kd=null==Ma.i?null:Ma.i.toString();null!=kd&&(Dd.CutCopyPasteFlags=kd);var qd=Ma.j;null!=qd&&(Dd.WaitMessageInClipboard=qd);var ae=Ma.k;null!=ae&&(Dd.PopupDialog=
ae);var ne=Ma.l;null!=ne&&(Dd.SimplePopupMessage=ne);var Pd=Ma.m;null!=Pd&&(Dd.DialogCloseButton=Pd);var Vd=Ma.n;null!=Vd&&(Dd.UserPressedInstallLink=Vd);var Je=null==Ma.o?null:Ma.o.toString();null!=Je&&(Dd.CallCount=Je);break;case 6:Lg="GetNumberViewModelDataOp";var Ge=Ma.a;null!=Ge&&(Dd.UserSessionId=Ge);var sf=Ma.b;null!=sf&&(Dd.NumberFormatOptionsPreviousOutputJson=sf);var Mf=Ma.c;null!=Mf&&(Dd.NumberFormatOptionsNewInputJson=Mf);break;case 7:Lg="InstantaneousSetData";var Df=Ma.a;null!=Df&&(Dd.Id=
Df);var Of=null==Ma.b?null:Ma.b.toString();null!=Of&&(Dd.WasEmpty=Of);var ig=null==Ma.c?null:Ma.c.toString();null!=ig&&(Dd.ValueNotChanged=ig);var Ag=Ma.d;null!=Ag&&(Dd.Source=Ag);var ng=null==Ma.e?null:Ma.e.toString();null!=ng&&(Dd.ProcessingCompleted=ng);break;case 8:Lg="ImmediateSetData";var xg=Ma.a;null!=xg&&(Dd.ClientStopwatchId=xg);var Pf=Ma.b;null!=Pf&&(Dd.Operation=Pf);var ca=Ma.c;null!=ca&&(Dd.Parameters=ca);var cb=null==Ma.d?null:Ma.d.toString();null!=cb&&(Dd.WasUpdatedByImmediate=cb);var tc=
null==Ma.e?null:Ma.e.toString();null!=tc&&(Dd.areHtmlElementsEqualClientComparison=tc);var Kc=null==Ma.f?null:Ma.f.toString();null!=Kc&&(Dd.WasDecisionMadeByHtmlComparison=Kc);var Xd=null==Ma.g?null:Ma.g.toString();null!=Xd&&(Dd.IsNumeric=Xd);var qe=null==Ma.h?null:Ma.h.toString();null!=qe&&(Dd.IsDateTime=qe);var rf=null==Ma.i?null:Ma.i.toString();null!=rf&&(Dd.HasCurrencySymbol=rf);var Af=null==Ma.j?null:Ma.j.toString();null!=Af&&(Dd.HasPercentSymbol=Af);var gg=null==Ma.k?null:Ma.k.toString();null!=
gg&&(Dd.IsFunc=gg);var mg=null==Ma.l?null:Ma.l.toString();null!=mg&&(Dd.DiffInWrappingWhitespace=mg);var og=Ma.m;null!=og&&(Dd.ImmediatePattern=og);var ph=null==Ma.n?null:Ma.n.toString();null!=ph&&(Dd.TextAlignmentMatch=ph);var Yg=null==Ma.o?null:Ma.o.toString();null!=Yg&&(Dd.FontColorMatch=Yg);var Qh=null==Ma.p?null:Ma.p.toString();null!=Qh&&(Dd.FormulaTextMatch=Qh);var Lh=null==Ma.q?null:Ma.q.toString();null!=Lh&&(Dd.isFormula=Lh);var Xh=Ma.r;null!=Xh&&(Dd.FormulaText=Xh);var xh=Ma.s;null!=xh&&
(Dd.InstantaneousPattern=xh);var qh=null==Ma.t?null:Ma.t.toString();null!=qh&&(Dd.AreHtmlInnerTextElementsEqualClientComparison=qh);var Zh=Ma.u;null!=Zh&&(Dd.HtmlComparisonDecision=Zh);break;case 9:Lg="DependentCellsCalc";var $h=Ma.a;null!=$h&&(Dd.CalcStatus=$h);var hh=null==Ma.b?null:Ma.b.toString();null!=hh&&(Dd.SuccessfullyCalculatedRanges=hh);var Gh=null==Ma.c?null:Ma.c.toString();null!=Gh&&(Dd.RangesSkipped=Gh);var Mh=null==Ma.d?null:Ma.d.toString();null!=Mh&&(Dd.TotalErrors=Mh);var Bi=null==
Ma.e?null:Ma.e.toString();null!=Bi&&(Dd.Partial=Bi);var $i=null==Ma.f?null:Ma.f.toString();null!=$i&&(Dd.Canceled=$i);var Hi=null==Ma.g?null:Ma.g.toString();null!=Hi&&(Dd.Aggregate=Hi);var zh=null==Ma.h?null:Ma.h.toString();null!=zh&&(Dd.Unknown=zh);var rj=null==Ma.i?null:Ma.i.toString();null!=rj&&(Dd.UnavailableData=rj);var Hj=null==Ma.j?null:Ma.j.toString();null!=Hj&&(Dd.Cycle=Hj);var Ii=null==Ma.k?null:Ma.k.toString();null!=Ii&&(Dd.NotImplemented=Ii);var Cg=null==Ma.l?null:Ma.l.toString();null!=
Cg&&(Dd.InvalidInput=Cg);var Wf=null==Ma.m?null:Ma.m.toString();null!=Wf&&(Dd.AreDepCells=Wf);break;case 10:Lg="DependentCellsGraphStat";var sj=null==Ma.a?null:Ma.a.toString();null!=sj&&(Dd.ParsedFormulas=sj);var ii=null==Ma.b?null:Ma.b.toString();null!=ii&&(Dd.GraphNodes=ii);var aj=null==Ma.c?null:Ma.c.toString();null!=aj&&(Dd.GraphArcs=aj);var rh=null==Ma.d?null:Ma.d.toString();null!=rh&&(Dd.AnalyzedBlocks=rh);var Ji=null==Ma.e?null:Ma.e.toString();null!=Ji&&(Dd.IterationId=Ji);var Dh=Ma.f;null!=
Dh&&(Dd.UniqueId=Dh);var Ld=null==Ma.g?null:Ma.g.toString();null!=Ld&&(Dd.Aborted=Ld);break;case 11:Lg="DependentCellsGraphSectionStat";var ze=null==Ma.a?null:Ma.a.toString();null!=ze&&(Dd.IterationId=ze);var Bj=Ma.b;null!=Bj&&(Dd.BlockHash=Bj);var Ah=Ma.c;null!=Ah&&(Dd.Functions=Ah);var Hh=Ma.d;null!=Hh&&(Dd.Operators=Hh);var Ki=null==Ma.e?null:Ma.e.toString();null!=Ki&&(Dd.CrossDocRefs=Ki);var Rh=null==Ma.f?null:Ma.f.toString();null!=Rh&&(Dd.CrossSheetRefs=Rh);var Cj=null==Ma.g?null:Ma.g.toString();
null!=Cj&&(Dd.ErrRefs=Cj);var Li=null==Ma.h?null:Ma.h.toString();null!=Li&&(Dd.LargeRanges=Li);var Eh=null==Ma.i?null:Ma.i.toString();null!=Eh&&(Dd.NameRefs=Eh);var Ih=null==Ma.j?null:Ma.j.toString();null!=Ih&&(Dd.ParserErrors=Ih);var qi=null==Ma.k?null:Ma.k.toString();null!=qi&&(Dd.RowRefs=qi);var Si=null==Ma.l?null:Ma.l.toString();null!=Si&&(Dd.ColumnRefs=Si);var dj=null==Ma.m?null:Ma.m.toString();null!=dj&&(Dd.TableRefs=dj);var ri=Ma.n;null!=ri&&(Dd.UniqueId=ri);var Ig=null==Ma.o?null:Ma.o.toString();
null!=Ig&&(Dd.UnreachableReferences=Ig);break;case 12:Lg="GetRangeContentPrefetchFailures";var Fh=Ma.a;null!=Fh&&(Dd.UserSessionId=Fh);var si=Ma.b;null!=si&&(Dd.ClientStopwatchId=si);var Yh=null==Ma.c?null:Ma.c.toString();null!=Yh&&(Dd.StateId=Yh);break;case 13:Lg="GridBlockUpdates";var ti=Ma.a;null!=ti&&(Dd.UserSessionId=ti);var ni=Ma.b;null!=ni&&(Dd.CorrelationId=ni);var nj=Ma.c;null!=nj&&(Dd.Operation=nj);var Ti=null==Ma.d?null:Ma.d.toString();null!=Ti&&(Dd.PerformanceType=Ti);var ei=Ma.e;null!=
ei&&(Dd.BlockHash=ei);var fi=null==Ma.f?null:Ma.f.toString();null!=fi&&(Dd.DurationInMs=fi);break;case 14:Lg="BrowserAppStart";var fg=null==Ma.a?null:Sf.a.lWa(Ma.a.getTime());null!=fg&&(Dd.ScriptExecutionStart=fg);var uh=Ma.b;null!=uh&&(Dd.UserSessionId=uh);var Jh=Ma.c;null!=Jh&&(Dd.ClockMechanism=Jh);var sh=null==Ma.d?null:Ma.d.toString();null!=sh&&(Dd.ScreenDPI=sh);var Nh=null==Ma.e?null:Ma.e.toString();null!=Nh&&(Dd.NavigationToScriptExecutionDelta=Nh);break;case 15:Lg="LinkedObjects";var oi=Ma.a;
null!=oi&&(Dd.ChildId=oi);var gi=Ma.b;null!=gi&&(Dd.ParentId=gi);var Ui=Ma.c;null!=Ui&&(Dd.ChildTable=Ui);var ui=Ma.d;null!=ui&&(Dd.ParentTable=ui);break;case 16:Lg="LongFrames";var Mi=null==Ma.a?null:Sf.a.lWa(Ma.a.getTime());null!=Mi&&(Dd.StartTime=Mi);var ej=null==Ma.b?null:Ma.b.toString();null!=ej&&(Dd.DurationInMs=ej);break;case 17:Lg="Task";var vi=Ma.a;null!=vi&&(Dd.StopwatchId=vi);var wi=null==Ma.b?null:Ma.b.toString();null!=wi&&(Dd.Status=wi);var xi=null==Ma.c?null:Ma.c.toString();null!=xi&&
(Dd.CreateTime=xi);var Vi=null==Ma.d?null:Ma.d.toString();null!=Vi&&(Dd.TaskId=Vi);break;case 18:Lg="ConflictInEditing";var Ni=Ma.a;null!=Ni&&(Dd.OtherUserState=Ni);var fj=Ma.b;null!=fj&&(Dd.UserSessionId=fj);var tj=null==Ma.c?null:Sf.a.lWa(Ma.c.getTime());null!=tj&&(Dd.ConflictTime=tj);break;case 19:Lg="IncomingPresenceData";var ai=Ma.a;null!=ai&&(Dd.UserSessionId=ai);var bi=Ma.b;null!=bi&&(Dd.UserId=bi);var ji=null==Ma.c?null:Ma.c.toString();null!=ji&&(Dd.Disconnected=ji);var Wi=null==Ma.d?null:
Sf.a.lWa(Ma.d.getTime());null!=Wi&&(Dd.ReceivedTime=Wi);break;case 20:Lg="EditorTableDelay";var Ij=Ma.a;null!=Ij&&(Dd.UserSessionId=Ij);var Ef=Ma.b;null!=Ef&&(Dd.UserId=Ef);var Ci=null==Ma.c?null:Ma.c.toString();null!=Ci&&(Dd.Received=Ci);var kf=null==Ma.d?null:Ma.d.toString();null!=kf&&(Dd.DurationInMs=kf);var uj=null==Ma.e?null:Ma.e.toString();null!=uj&&(Dd.NotAloneAtLogTime=uj);var Zg=null==Ma.f?null:Sf.a.lWa(Ma.f.getTime());null!=Zg&&(Dd.Time=Zg);break;case 21:Lg="PresenceStartup";var oj=Ma.a;
null!=oj&&(Dd.UserSessionId=oj);var Xi=null==Ma.b?null:Ma.b.toString();null!=Xi&&(Dd.EverReceived=Xi);var Yi=null==Ma.c?null:Ma.c.toString();null!=Yi&&(Dd.NotAloneOnOpen=Yi);var Di=null==Ma.d?null:Ma.d.toString();null!=Di&&(Dd.NotAloneAtLogTime=Di);var $g=null==Ma.e?null:Ma.e.toString();null!=$g&&(Dd.EditorCount=$g);var vj=null==Ma.f?null:Ma.f.toString();null!=vj&&(Dd.WorkbookOpenToFirstReceivedInMs=vj);break;case 22:Lg="PresenceDelete";var yj=Ma.a;null!=yj&&(Dd.UserSessionId=yj);var bj=Ma.b;null!=
bj&&(Dd.UserId=bj);var gj=Ma.c;null!=gj&&(Dd.Context=gj);var th=Ma.d;null!=th&&(Dd.Reason=th);var Th=null==Ma.e?null:Sf.a.lWa(Ma.e.getTime());null!=Th&&(Dd.Time=Th);break;case 23:Lg="EditorEvent";var Oh=Ma.a;null!=Oh&&(Dd.UserSessionId=Oh);var pi=Ma.b;null!=pi&&(Dd.UserId=pi);var kh=Ma.c;null!=kh&&(Dd.Context=kh);var cj=null==Ma.d?null:Sf.a.lWa(Ma.d.getTime());null!=cj&&(Dd.Time=cj);break;case 24:Lg="EditorTime";var wj=Ma.a;null!=wj&&(Dd.UserSessionId=wj);var Ei=Ma.b;null!=Ei&&(Dd.UserId=Ei);var Oi=
null==Ma.c?null:Ma.c.toString();null!=Oi&&(Dd.DurationInMs=Oi);break;case 25:Lg="GridScreenReaderOps";var Zi=Ma.a;null!=Zi&&(Dd.UserSessionId=Zi);var Ph=Ma.b;null!=Ph&&(Dd.CommandTaskId=Ph);var Pi=null==Ma.c?null:Ma.c.toString();null!=Pi&&(Dd.CommandId=Pi);var L=null==Ma.d?null:Ma.d.toString();null!=L&&(Dd.ClientSideOnly=L);var qa=null==Ma.e?null:Ma.e.toString();null!=qa&&(Dd.DurationInMS=qa);var Va=null==Ma.f?null:Ma.f.toString();null!=Va&&(Dd.ReachedMaxReadoutCells=Va);var Fb=null==Ma.g?null:Ma.g.toString();
null!=Fb&&(Dd.RequstedCellCount=Fb);var bc=null==Ma.h?null:Ma.h.toString();null!=bc&&(Dd.NonEmptyCellCount=bc);var Ic=null==Ma.i?null:Ma.i.toString();null!=Ic&&(Dd.Succeeded=Ic);var td=null==Ma.j?null:Ma.j.toString();null!=td&&(Dd.Canceled=td);var Hd=Ma.k;null!=Hd&&(Dd.ErrorType=Hd);break;case 26:Lg="SendPresenceToService";var pe=Ma.a;null!=pe&&(Dd.UserSessionId=pe);var Ke=null==Ma.b?null:Ma.b.toString();null!=Ke&&(Dd.TotalCount=Ke);var uf=null==Ma.c?null:Ma.c.toString();null!=uf&&(Dd.SendCount=uf);
break;case 27:Lg="IME";var zf=Ma.a;null!=zf&&(Dd.UserSessionId=zf);break;case 28:Lg="FreezePaneFloatingObjects";var bg=Ma.a;null!=bg&&(Dd.UserSessionId=bg);var kg=null==Ma.b?null:Ma.b.toString();null!=kg&&(Dd.ObjectType=kg);var ug=Ma.c;null!=ug&&(Dd.ObjectID=ug);var Gg=null==Ma.d?null:Ma.d.toString();null!=Gg&&(Dd.SpannedPanesCount=Gg);break;case 29:Lg="CustomizeStatusBar";var ah=Ma.a;null!=ah&&(Dd.UserSessionId=ah);var Qg=Ma.b;null!=Qg&&(Dd.UIControlName=Qg);var Uh=null==Ma.c?null:Ma.c.toString();
null!=Uh&&(Dd.IsControlVisible=Uh);break;case 30:Lg="ClientWebRequests";var vh=Ma.a;null!=vh&&(Dd.Path=vh);var X=Ma.b;null!=X&&(Dd.ProxyStopwatchId=X);var jb=Ma.c;null!=jb&&(Dd.RequestStatus=jb);var Pb=null==Ma.d?null:Ma.d.toString();null!=Pb&&(Dd.ResponseSizeInBytes=Pb);var ed=Ma.e;null!=ed&&(Dd.ClientRequestId=ed);var zd=null==Ma.f?null:Ma.f.toString();null!=zd&&(Dd.StateId=zd);break;case 31:Lg="ShowCommentTaskPane";var be=Ma.a;null!=be&&(Dd.UserSessionId=be);var we=null==Ma.b?null:Ma.b.toString();
null!=we&&(Dd.IsFromKeyboardShortcut=we);var ef=null==Ma.c?null:Ma.c.toString();null!=ef&&(Dd.IsShowPane=ef);var vf=null==Ma.d?null:Ma.d.toString();null!=vf&&(Dd.ShowForDeepLink=vf);var Jf=null==Ma.e?null:Ma.e.toString();null!=Jf&&(Dd.DeepLinkFound=Jf);break;case 32:Lg="ApplyThreadedCommentChange";var yg=Ma.a;null!=yg&&(Dd.UserSessionId=yg);var Pg=null==Ma.b?null:Ma.b.toString();null!=Pg&&(Dd.Operation=Pg);var Wg=Ma.c;null!=Wg&&(Dd.CommentId=Wg);var ch=null==Ma.d?null:Ma.d.toString();null!=ch&&(Dd.CommentsCount=
ch);break;case 33:Lg="UpgradeLegacyCommentsChange";var yh=Ma.a;null!=yh&&(Dd.UserSessionId=yh);var A=null==Ma.b?null:Ma.b.toString();null!=A&&(Dd.OperationSuccessful=A);break;case 34:Lg="FindNextOrPreviousComment";var ja=Ma.a;null!=ja&&(Dd.UserSessionId=ja);var Ua=null==Ma.b?null:Ma.b.toString();null!=Ua&&(Dd.Succeeded=Ua);break;case 35:Lg="Goto";var ac=Ma.a;null!=ac&&(Dd.UserSessionId=ac);var Ec=null==Ma.b?null:Ma.b.toString();null!=Ec&&(Dd.IsSucceeded=Ec);var gd=null==Ma.c?null:Ma.c.toString();
null!=gd&&(Dd.IsNOVMode=gd);break;case 36:Lg="LaunchOfficeAddInDialog";var ad=Ma.a;null!=ad&&(Dd.UserSessionId=ad);var Jd=Ma.b;null!=Jd&&(Dd.SourceId=Jd);var De=Ma.c;null!=De&&(Dd.SourceLabel=De);var Xe=Ma.d;null!=Xe&&(Dd.Flight=Xe);var lf=Ma.e;null!=lf&&(Dd.Experiment=lf);var mf=Ma.f;null!=mf&&(Dd.UICultureTag=mf);var Rf=null==Ma.g?null:Ma.g.toString();null!=Rf&&(Dd.UICultureTagLcid=Rf);var sg=null==Ma.h?null:Ma.h.toString();null!=sg&&(Dd.WacHostId=sg);break;case 37:Lg="RichApiInvocation";var wg=
Ma.a;null!=wg&&(Dd.UserSessionId=wg);var Mg=null==Ma.b?null:Ma.b.toString();null!=Mg&&(Dd.Succeeded=Mg);var Sg=Ma.c;null!=Sg&&(Dd.ErrorType=Sg);var Qi=Ma.d;null!=Qi&&(Dd.ResultInfo=Qi);var ci=Ma.e;null!=ci&&(Dd.Source=ci);break;case 38:Lg="FxLibrary";var hj=Ma.a;null!=hj&&(Dd.EntityName=hj);var nk=null==Ma.b?null:Ma.b.toString();null!=nk&&(Dd.EntryPoint=nk);var bk=null==Ma.c?null:Ma.c.toString();null!=bk&&(Dd.Action=bk);var Bh=null==Ma.d?null:Ma.d.toString();null!=Bh&&(Dd.InsertLocation=Bh);break;
case 39:Lg="EmbeddedApiSession";var Xk=Ma.a;null!=Xk&&(Dd.UserSessionId=Xk);break;case 40:Lg="NumberFormattingCalculator";var Fk=Ma.a;null!=Fk&&(Dd.Id=Fk);var Yk=Ma.b;null!=Yk&&(Dd.CounterName=Yk);var Tj=Ma.c;null!=Tj&&(Dd.Values=Tj);break;case 41:Lg="RequestDataAfterSend";var Dj=Ma.a;null!=Dj&&(Dd.ClientStopwatchId=Dj);var Gk=Ma.b;null!=Gk&&(Dd.RequestStatus=Gk);var Vf=null==Ma.c?null:Ma.c.toString();null!=Vf&&(Dd.SendDuration=Vf);var ok=null==Ma.d?null:Ma.d.toString();null!=ok&&(Dd.RequestId=ok);
break;case 42:Lg="FloatingObjectsStopwatchData";var Hk=Ma.a;null!=Hk&&(Dd.StopMessage=Hk);var ck=null==Ma.b?null:Ma.b.toString();null!=ck&&(Dd.Type=ck);var Ik=Ma.c;null!=Ik&&(Dd.GUID=Ik);var Jj=null==Ma.d?null:Ma.d.toString();null!=Jj&&(Dd.Pane=Jj);var Zk=null==Ma.e?null:Ma.e.toString();null!=Zk&&(Dd.IsAboveGrid=Zk);var pk=Ma.f;null!=pk&&(Dd.StartCorrelation=pk);var ij=Ma.g;null!=ij&&(Dd.LoadImageCorrelation=ij);var Uj=null==Ma.h?null:Ma.h.toString();null!=Uj&&(Dd.SkippedGetEffectsExtents=Uj);var dk=
null==Ma.i?null:Ma.i.toString();null!=dk&&(Dd.Version=dk);break;case 43:Lg="Copy";var zj=Ma.a;null!=zj&&(Dd.UserSessionId=zj);var Jk=Ma.b;null!=Jk&&(Dd.Trigger=Jk);var $k=Ma.c;null!=$k&&(Dd.RibbonCommandName=$k);var Ri=Ma.d;null!=Ri&&(Dd.SourceItem=Ri);var Oj=null==Ma.e?null:Ma.e.toString();null!=Oj&&(Dd.SourceRangeCellCount=Oj);var al=Ma.f;null!=al&&(Dd.ClientSideStopwatchId=al);var jj=Ma.g;null!=jj&&(Dd.CopyOperationId=jj);var Vj=null==Ma.h?null:Ma.h.toString();null!=Vj&&(Dd.IsAsync=Vj);var ki=
null==Ma.i?null:Ma.i.toString();null!=ki&&(Dd.IsFromCache=ki);var Wj=null==Ma.j?null:Ma.j.toString();null!=Wj&&(Dd.IsSuccessiveCopy=Wj);var Kk=null==Ma.k?null:Ma.k.toString();null!=Kk&&(Dd.IsSelectionAllowed=Kk);var Lj=null==Ma.l?null:Ma.l.toString();null!=Lj&&(Dd.IsSuccess=Lj);var qk=null==Ma.m?null:Ma.m.toString();null!=qk&&(Dd.IsExpectedError=qk);var Pj=Ma.n;null!=Pj&&(Dd.ExpectedErrorReason=Pj);var pj=Ma.o;null!=pj&&(Dd.ErrorMessage=pj);var ek=null==Ma.p?null:Ma.p.toString();null!=ek&&(Dd.ClientSideCopyTimeInMs=
ek);var bl=null==Ma.q?null:Ma.q.toString();null!=bl&&(Dd.TotalTimeInMs=bl);var Mj=null==Ma.r?null:Ma.r.toString();null!=Mj&&(Dd.PlainTextPayloadSize=Mj);var fk=Ma.s;null!=fk&&(Dd.CopyPasteTargetType=fk);var Lk=null==Ma.t?null:Ma.t.toString();null!=Lk&&(Dd.ShadowWorkbookPayloadSize=Lk);var Xj=null==Ma.u?null:Ma.u.toString();null!=Xj&&(Dd.HtmlPayloadSize=Xj);var Nj=null==Ma.v?null:Ma.v.toString();null!=Nj&&(Dd.HtmlSizeExceedsLimit=Nj);var Mk=null==Ma.w?null:Ma.w.toString();null!=Mk&&(Dd.CopyTotalSizeExceedsLimit=
Mk);var rk=null==Ma.x?null:Ma.x.toString();null!=rk&&(Dd.ErrorReason=rk);var cl=Ma.y;null!=cl&&(Dd.ErrorName=cl);var dl=null==Ma.z?null:Ma.z.toString();null!=dl&&(Dd.IsSucceededWithAlert=dl);var sl=null==Ma.ba?null:Ma.ba.toString();null!=sl&&(Dd.EncounteredDeploymentErrors=sl);var el=null==Ma.bb?null:Ma.bb.toString();null!=el&&(Dd.ShadowWorkbookSizeExceedsLimit=el);var Yj=Ma.bc;null!=Yj&&(Dd.CopyPasteTargetName=Yj);var gk=Ma.bd;null!=gk&&(Dd.CCPSliceName=gk);var tl=Ma.be;null!=tl&&(Dd.SyncClipboardItemsKeys=
tl);var sk=Ma.bf;null!=sk&&(Dd.AsyncClipboardItemsKeys=sk);var tk=Ma.bg;null!=tk&&(Dd.CopyPasteHandlerName=tk);var uk=Ma.bh;null!=uk&&(Dd.SucceededPopulatingSystemClipboardSync=uk);var Nk=Ma.bi;null!=Nk&&(Dd.SucceededPopulatingSystemClipboardAsync=Nk);var ul=Ma.bj;null!=ul&&(Dd.Location=ul);var fl=Ma.bk;null!=fl&&(Dd.CopyContextId=fl);var vk=null==Ma.bl?null:Ma.bl.toString();null!=vk&&(Dd.ServerRequestTimeInMs=vk);var li=null==Ma.bm?null:Ma.bm.toString();null!=li&&(Dd.EcsOperationDuration=li);var Ok=
null==Ma.bn?null:Ma.bn.toString();null!=Ok&&(Dd.EcsRequestDuration=Ok);var wk=null==Ma.bo?null:Ma.bo.toString();null!=wk&&(Dd.WfeRequestDuration=wk);var yi=null==Ma.bp?null:Ma.bp.toString();null!=yi&&(Dd.OriginalSourceRangesCountExceedsLimit=yi);var xk=null==Ma.bq?null:Ma.bq.toString();null!=xk&&(Dd.UploadToClipServiceAttempted=xk);var vl=null==Ma.br?null:Ma.br.toString();null!=vl&&(Dd.FloatingObjectType=vl);var wl=null==Ma.bs?null:Ma.bs.toString();null!=wl&&(Dd.IsCopyWithAsyncClipboardAPI=wl);break;
case 44:Lg="Paste";var gl=Ma.a;null!=gl&&(Dd.UserSessionId=gl);var yk=Ma.b;null!=yk&&(Dd.Trigger=yk);var xl=Ma.c;null!=xl&&(Dd.RibbonCommandName=xl);var Pk=null==Ma.d?null:Ma.d.toString();null!=Pk&&(Dd.PasteTypeFlagValue=Pk);var yl=Ma.e;null!=yl&&(Dd.PasteOperationId=yl);var hl=Ma.f;null!=hl&&(Dd.CopyOperationId=hl);var zk=Ma.g;null!=zk&&(Dd.ClientSideStopwatchId=zk);var Ej=Ma.h;null!=Ej&&(Dd.OriginalDestinationRange=Ej);var Fj=Ma.i;null!=Fj&&(Dd.ExpandDestinationRange=Fj);var il=Ma.j;null!=il&&(Dd.SourceItem=
il);var jl=null==Ma.k?null:Ma.k.toString();null!=jl&&(Dd.SourceRangeCellCount=jl);var Qk=null==Ma.l?null:Ma.l.toString();null!=Qk&&(Dd.IsSuccess=Qk);var hk=null==Ma.m?null:Ma.m.toString();null!=hk&&(Dd.IsExpectedError=hk);var zl=Ma.n;null!=zl&&(Dd.ClipboardFormatReadTimeInMs=zl);var ik=Ma.o;null!=ik&&(Dd.ClipboardFormatReadStatus=ik);var jk=null==Ma.p?null:Ma.p.toString();null!=jk&&(Dd.ClipboardReadPermissionPromptShown=jk);var mi=null==Ma.q?null:Ma.q.toString();null!=mi&&(Dd.AsyncApiReadTimedOut=
mi);var Zj=Ma.r;null!=Zj&&(Dd.ExpectedErrorReason=Zj);var kl=Ma.s;null!=kl&&(Dd.ErrorMessage=kl);var Kj=null==Ma.t?null:Ma.t.toString();null!=Kj&&(Dd.TotalTimeInMs=Kj);var Aj=null==Ma.u?null:Ma.u.toString();null!=Aj&&(Dd.PlainTextPayloadSize=Aj);var kj=null==Ma.v?null:Ma.v.toString();null!=kj&&(Dd.ShadowWorkbookPayloadSize=kj);var kk=null==Ma.w?null:Ma.w.toString();null!=kk&&(Dd.HtmlPayloadSize=kk);var Rk=Ma.x;null!=Rk&&(Dd.CopyPasteTargetType=Rk);var ll=null==Ma.y?null:Ma.y.toString();null!=ll&&
(Dd.IsLastCopyWasExternal=ll);var Sk=null==Ma.z?null:Ma.z.toString();null!=Sk&&(Dd.IsClipboardDataContainShadowWorkbook=Sk);var Tk=null==Ma.ba?null:Ma.ba.toString();null!=Tk&&(Dd.IsShadowWorkbookParsedSuccessfully=Tk);var lk=Ma.bb;null!=lk&&(Dd.ActiveSelectionType=lk);var Ak=Ma.bc;null!=Ak&&(Dd.PasteResult=Ak);var Bk=null==Ma.bd?null:Ma.bd.toString();null!=Bk&&(Dd.ErrorReason=Bk);var ml=Ma.be;null!=ml&&(Dd.ErrorName=ml);var Uk=null==Ma.bf?null:Ma.bf.toString();null!=Uk&&(Dd.IsSucceededWithAlert=Uk);
var Fi=null==Ma.bg?null:Ma.bg.toString();null!=Fi&&(Dd.IsAfterCut=Fi);var nl=null==Ma.bh?null:Ma.bh.toString();null!=nl&&(Dd.EncounteredDeploymentErrors=nl);var mk=null==Ma.bi?null:Ma.bi.toString();null!=mk&&(Dd.IsCrossSession=mk);var Ck=null==Ma.bj?null:Ma.bj.toString();null!=Ck&&(Dd.ShadowWorkbookSizeExceedsLimit=Ck);var Qj=null==Ma.bk?null:Ma.bk.toString();null!=Qj&&(Dd.ClipboardContainXLOPayload=Qj);var ol=Ma.bl;null!=ol&&(Dd.CopyPasteTargetName=ol);var Vk=Ma.bm;null!=Vk&&(Dd.ChromeExtensionId=
Vk);var lj=Ma.bn;null!=lj&&(Dd.PayloadOrigin=lj);var pl=Ma.bo;null!=pl&&(Dd.PayloadType=pl);var Wk=Ma.bp;null!=Wk&&(Dd.CCPSliceName=Wk);var Gj=Ma.bq;null!=Gj&&(Dd.ClipboardItemsKeys=Gj);var qj=Ma.br;null!=qj&&(Dd.CopyPasteHandlerName=qj);var ql=null==Ma.bs?null:Ma.bs.toString();null!=ql&&(Dd.IsSourceItemOriginSameSession=ql);var Rj=Ma.bt;null!=Rj&&(Dd.Location=Rj);var vg=Ma.bu;null!=vg&&(Dd.ExternalAppSource=vg);var Sj=Ma.bv;null!=Sj&&(Dd.PasteContextId=Sj);var Dk=null==Ma.bw?null:Ma.bw.toString();
null!=Dk&&(Dd.ServerRequestTimeInMs=Dk);var H=null==Ma.bx?null:Ma.bx.toString();null!=H&&(Dd.IndicationDisplayScheduled=H);var va=Ma.by;null!=va&&(Dd.PasteIndicationDisplayStatus=va);var ub=null==Ma.bz?null:Ma.bz.toString();null!=ub&&(Dd.PasteRecoveryUIDisplayed=ub);var kc=null==Ma.ca?null:Ma.ca.toString();null!=kc&&(Dd.IsFromPasteRecoveryUI=kc);var Oc=null==Ma.cb?null:Ma.cb.toString();null!=Oc&&(Dd.EcsOperationDuration=Oc);var pd=null==Ma.cc?null:Ma.cc.toString();null!=pd&&(Dd.EcsRequestDuration=
pd);var Sd=null==Ma.cd?null:Ma.cd.toString();null!=Sd&&(Dd.WfeRequestDuration=Sd);var Wd=null==Ma.ce?null:Ma.ce.toString();null!=Wd&&(Dd.OriginalSourceRangesCountExceedsLimit=Wd);var ee=Ma.cf;null!=ee&&(Dd.PasteRecoveryUndoStopwatchId=ee);var je=null==Ma.cg?null:Ma.cg.toString();null!=je&&(Dd.PasteRecoveryUndoTimeInMs=je);var Ue=null==Ma.ch?null:Ma.ch.toString();null!=Ue&&(Dd.PasteCSEPerformed=Ue);var G=null==Ma.ci?null:Ma.ci.toString();null!=G&&(Dd.CSEStatus=G);var da=null==Ma.cj?null:Ma.cj.toString();
null!=da&&(Dd.IsFromEnterShortcut=da);var $a=null==Ma.ck?null:Ma.ck.toString();null!=$a&&(Dd.pasteDestinationHasMergedCells=$a);var Sb=Ma.cl;null!=Sb&&(Dd.ArtSourceItemType=Sb);var Mc=null==Ma.cm?null:Ma.cm.toString();null!=Mc&&(Dd.IsPasteWithAsyncClipboardAPI=Mc);var sd=null==Ma.cn?null:Ma.cn.toString();null!=sd&&(Dd.IsPasteWithChromiumExtension=sd);break;case 45:Lg="DragDrop";var Od=Ma.a;null!=Od&&(Dd.UserSessionId=Od);var se=Ma.b;null!=se&&(Dd.Trigger=se);var Ye=Ma.c;null!=Ye&&(Dd.RibbonCommandName=
Ye);var hf=Ma.d;null!=hf&&(Dd.OperationId=hf);var ag=Ma.e;null!=ag&&(Dd.ClientSideStopwatchId=ag);var Jg=Ma.f;null!=Jg&&(Dd.SourceRange=Jg);var tg=Ma.g;null!=tg&&(Dd.DestinationRange=tg);var Xg=Ma.h;null!=Xg&&(Dd.CutCopyType=Xg);var hi=null==Ma.i?null:Ma.i.toString();null!=hi&&(Dd.IsShiftKeyDown=hi);var xj=null==Ma.j?null:Ma.j.toString();null!=xj&&(Dd.IsDragInsert=xj);var zi=null==Ma.k?null:Ma.k.toString();null!=zi&&(Dd.IsSuccess=zi);var Gi=null==Ma.l?null:Ma.l.toString();null!=Gi&&(Dd.IsExpectedError=
Gi);var Ai=Ma.m;null!=Ai&&(Dd.ExpectedErrorReason=Ai);var ak=Ma.n;null!=ak&&(Dd.ErrorMessage=ak);var mj=null==Ma.o?null:Ma.o.toString();null!=mj&&(Dd.TotalTimeInMs=mj);var Ek=Ma.p;null!=Ek&&(Dd.ErrorName=Ek);var rl=null==Ma.q?null:Ma.q.toString();null!=rl&&(Dd.IsSucceededWithAlert=rl);var Al=Ma.r;null!=Al&&(Dd.CopyPasteTargetType=Al);var Bl=null==Ma.s?null:Ma.s.toString();null!=Bl&&(Dd.EncounteredDeploymentErrors=Bl);var Dl=null==Ma.t?null:Ma.t.toString();null!=Dl&&(Dd.IsHeaderDrag=Dl);break;case 46:Lg=
"ClearCopyState";var El=Ma.a;null!=El&&(Dd.UserSessionId=El);var Fl=Ma.b;null!=Fl&&(Dd.ClientSideStopwatchId=Fl);var Gl=Ma.c;null!=Gl&&(Dd.Trigger=Gl);var Hl=null==Ma.d?null:Ma.d.toString();null!=Hl&&(Dd.IsClearClipboard=Hl);var Il=null==Ma.e?null:Ma.e.toString();null!=Il&&(Dd.IsExplicit=Il);var Jl=null==Ma.f?null:Ma.f.toString();null!=Jl&&(Dd.IsSuccess=Jl);var Kl=Ma.g;null!=Kl&&(Dd.ErrorMessage=Kl);var Ll=Ma.h;null!=Ll&&(Dd.ErrorName=Ll);var Ml=null==Ma.i?null:Ma.i.toString();null!=Ml&&(Dd.TotalTimeInMs=
Ml);var Nl=Ma.j;null!=Nl&&(Dd.CopyPasteTargetType=Nl);break;case 47:Lg="WebWorkerRecalcStats";var Ol=null==Ma.a?null:Ma.a.toString();null!=Ol&&(Dd.SuccessCount=Ol);var Pl=null==Ma.b?null:Ma.b.toString();null!=Pl&&(Dd.FailureCount=Pl);var Ql=null==Ma.c?null:Ma.c.toString();null!=Ql&&(Dd.ValueTypeMismatchCount=Ql);var Rl=null==Ma.d?null:Ma.d.toString();null!=Rl&&(Dd.CellValueMismatchCount=Rl);var Sl=null==Ma.e?null:Ma.e.toString();null!=Sl&&(Dd.IfmtMismatchCount=Sl);var Tl=null==Ma.f?null:Ma.f.toString();
null!=Tl&&(Dd.FormattedTextMismatchCount=Tl);var Ul=null==Ma.g?null:Ma.g.toString();null!=Ul&&(Dd.CellValueStringMismatchCount=Ul);var Vl=null==Ma.h?null:Ma.h.toString();null!=Vl&&(Dd.CellValueNumberMismatchCount=Vl);var Wl=null==Ma.i?null:Ma.i.toString();null!=Wl&&(Dd.CellValueBooleanMismatchCount=Wl);var Xl=null==Ma.j?null:Ma.j.toString();null!=Xl&&(Dd.CellValueBlankMismatchCount=Xl);var Yl=null==Ma.k?null:Ma.k.toString();null!=Yl&&(Dd.CellValueErrorMismatchCount=Yl);var Zl=null==Ma.l?null:Ma.l.toString();
null!=Zl&&(Dd.FormattedTextStringMismatchCount=Zl);var $l=null==Ma.m?null:Ma.m.toString();null!=$l&&(Dd.FormattedTextNumberMismatchCount=$l);var am=null==Ma.n?null:Ma.n.toString();null!=am&&(Dd.FormattedTextBooleanMismatchCount=am);var bm=null==Ma.o?null:Ma.o.toString();null!=bm&&(Dd.FormattedTextBlankMismatchCount=bm);var cm=null==Ma.p?null:Ma.p.toString();null!=cm&&(Dd.FormattedTextErrorMismatchCount=cm);var dm=null==Ma.q?null:Ma.q.toString();null!=dm&&(Dd.StringMismatchCount=dm);var em=null==Ma.r?
null:Ma.r.toString();null!=em&&(Dd.NumericMismatchCount=em);var fm=null==Ma.s?null:Ma.s.toString();null!=fm&&(Dd.ErrorMismatchCount=fm);var gm=null==Ma.t?null:Ma.t.toString();null!=gm&&(Dd.StringValuesCount=gm);var hm=null==Ma.u?null:Ma.u.toString();null!=hm&&(Dd.NumericValuesCount=hm);var im=null==Ma.v?null:Ma.v.toString();null!=im&&(Dd.BooleanValuesCount=im);var jm=null==Ma.w?null:Ma.w.toString();null!=jm&&(Dd.BlankValuesCount=jm);var km=null==Ma.x?null:Ma.x.toString();null!=km&&(Dd.ErrorValuesCount=
km);var lm=null==Ma.y?null:Ma.y.toString();null!=lm&&(Dd.NumericValuesDiffAverage=lm);var mm=Ma.z;null!=mm&&(Dd.NumericEvaluatedValuesMismatchSamples=mm);var nm=Ma.ba;null!=nm&&(Dd.NumericFormattedTextMismatchSamples=nm);var om=Ma.bb;null!=om&&(Dd.NumericMismatchSamples=om);var pm=Ma.bc;null!=pm&&(Dd.CellValueTypeMismatchSamples=pm);var qm=Ma.bd;null!=qm&&(Dd.IfmtMismatchSamples=qm);var rm=Ma.be;null!=rm&&(Dd.BlockHashCode=rm);break;case 48:Lg="DataValidationEditOpenDialog";var sm=Ma.a;null!=sm&&
(Dd.ServerCommand=sm);var tm=null==Ma.b?null:Ma.b.toString();null!=tm&&(Dd.SubDialogOpened=tm);var um=Ma.c;null!=um&&(Dd.SubDialogButtonClicked=um);var vm=null==Ma.d?null:Ma.d.toString();null!=vm&&(Dd.DialogOpened=vm);var wm=Ma.e;null!=wm&&(Dd.RuleType=wm);var xm=Ma.f;null!=xm&&(Dd.ConditionType=xm);var ym=null==Ma.g?null:Ma.g.toString();null!=ym&&(Dd.LowerBoundaryFilled=ym);var zm=null==Ma.h?null:Ma.h.toString();null!=zm&&(Dd.UpperBoundaryFilled=zm);var Am=null==Ma.i?null:Ma.i.toString();null!=Am&&
(Dd.IgnoreBlank=Am);var Bm=null==Ma.j?null:Ma.j.toString();null!=Bm&&(Dd.InCellDropdown=Bm);var Cm=null==Ma.k?null:Ma.k.toString();null!=Cm&&(Dd.ShowInputMessage=Cm);var Dm=null==Ma.l?null:Ma.l.toString();null!=Dm&&(Dd.InputTitleFilled=Dm);var Em=null==Ma.m?null:Ma.m.toString();null!=Em&&(Dd.InputMessageFilled=Em);var Fm=null==Ma.n?null:Ma.n.toString();null!=Fm&&(Dd.ShowErrorAlert=Fm);var Gm=null==Ma.o?null:Ma.o.toString();null!=Gm&&(Dd.AlertBlocking=Gm);var Hm=null==Ma.p?null:Ma.p.toString();null!=
Hm&&(Dd.AlertTitleFilled=Hm);var Im=null==Ma.q?null:Ma.q.toString();null!=Im&&(Dd.AlertMessageFilled=Im);var Jm=Ma.r;null!=Jm&&(Dd.StopWatchId=Jm);break;case 49:Lg="DataValidationEditSubmitRule";var Km=Ma.a;null!=Km&&(Dd.RuleType=Km);var Lm=Ma.b;null!=Lm&&(Dd.ConditionType=Lm);var Mm=null==Ma.c?null:Ma.c.toString();null!=Mm&&(Dd.LowerBoundaryFilled=Mm);var Nm=null==Ma.d?null:Ma.d.toString();null!=Nm&&(Dd.UpperBoundaryFilled=Nm);var Om=null==Ma.e?null:Ma.e.toString();null!=Om&&(Dd.IgnoreBlank=Om);
var Pm=null==Ma.f?null:Ma.f.toString();null!=Pm&&(Dd.InCellDropdown=Pm);var Qm=null==Ma.g?null:Ma.g.toString();null!=Qm&&(Dd.ShowInputMessage=Qm);var Rm=null==Ma.h?null:Ma.h.toString();null!=Rm&&(Dd.InputTitleFilled=Rm);var Sm=null==Ma.i?null:Ma.i.toString();null!=Sm&&(Dd.InputMessageFilled=Sm);var Tm=null==Ma.j?null:Ma.j.toString();null!=Tm&&(Dd.ShowErrorAlert=Tm);var Um=null==Ma.k?null:Ma.k.toString();null!=Um&&(Dd.AlertBlocking=Um);var Vm=null==Ma.l?null:Ma.l.toString();null!=Vm&&(Dd.AlertTitleFilled=
Vm);var Wm=null==Ma.m?null:Ma.m.toString();null!=Wm&&(Dd.AlertMessageFilled=Wm);var Xm=null==Ma.n?null:Ma.n.toString();null!=Xm&&(Dd.ClearAllPressed=Xm);var Ym=Ma.o;null!=Ym&&(Dd.ActionStatus=Ym);var Zm=Ma.p;null!=Zm&&(Dd.Error=Zm);var $m=Ma.q;null!=$m&&(Dd.StopWatchId=$m);var an=null==Ma.r?null:Ma.r.toString();null!=an&&(Dd.InsertDropdownButton=an);break;case 50:Lg="CustomSort";var bn=Ma.a;null!=bn&&(Dd.RangeType=bn);var cn=null==Ma.b?null:Ma.b.toString();null!=cn&&(Dd.HasHeaders=cn);var dn=null==
Ma.c?null:Ma.c.toString();null!=dn&&(Dd.SortTopToBottom=dn);var en=null==Ma.d?null:Ma.d.toString();null!=en&&(Dd.ColumnCount=en);var fn=null==Ma.e?null:Ma.e.toString();null!=fn&&(Dd.RowCount=fn);var gn=null==Ma.f?null:Ma.f.toString();null!=gn&&(Dd.RangeLimitExceeded=gn);var hn=null==Ma.g?null:Ma.g.toString();null!=hn&&(Dd.CaseSensitive=hn);var jn=null==Ma.h?null:Ma.h.toString();null!=jn&&(Dd.GetSortInfoDuration=jn);var kn=null==Ma.i?null:Ma.i.toString();null!=kn&&(Dd.LevelCount=kn);var ln=null==Ma.j?
null:Ma.j.toString();null!=ln&&(Dd.SortOnValuesCount=ln);var mn=null==Ma.k?null:Ma.k.toString();null!=mn&&(Dd.SortOnCellColorCount=mn);var nn=null==Ma.l?null:Ma.l.toString();null!=nn&&(Dd.SortOnFontColorCount=nn);var on=null==Ma.m?null:Ma.m.toString();null!=on&&(Dd.SortOnIconCount=on);var pn=null==Ma.n?null:Ma.n.toString();null!=pn&&(Dd.CustomOrderCount=pn);var qn=null==Ma.o?null:Ma.o.toString();null!=qn&&(Dd.AvgCellColorCount=qn);var rn=null==Ma.p?null:Ma.p.toString();null!=rn&&(Dd.MaxCellColorCount=
rn);var sn=null==Ma.q?null:Ma.q.toString();null!=sn&&(Dd.AvgFontColorCount=sn);var tn=null==Ma.r?null:Ma.r.toString();null!=tn&&(Dd.MaxFontColorCount=tn);var un=null==Ma.s?null:Ma.s.toString();null!=un&&(Dd.AvgIconsCount=un);var vn=null==Ma.t?null:Ma.t.toString();null!=vn&&(Dd.MaxIconsCount=vn);var wn=null==Ma.u?null:Ma.u.toString();null!=wn&&(Dd.Executed=wn);break;case 51:Lg="NamedSheetViewUserAction";var xn=Ma.a;null!=xn&&(Dd.UserSessionId=xn);var yn=Ma.b;null!=yn&&(Dd.UserActionName=yn);var zn=
null==Ma.c?null:Ma.c.toString();null!=zn&&(Dd.UserActionSource=zn);var An=Ma.d;null!=An&&(Dd.UserActionData=An);var Bn=Ma.e;null!=Bn&&(Dd.OtherData=Bn);break;case 52:Lg="NamedSheetViewTeachingCallout";var Cn=Ma.a;null!=Cn&&(Dd.UserSessionId=Cn);var Dn=null==Ma.b?null:Ma.b.toString();null!=Dn&&(Dd.TeachingCalloutSequence=Dn);var En=null==Ma.c?null:Ma.c.toString();null!=En&&(Dd.TeachingCalloutIndex=En);var Fn=null==Ma.d?null:Ma.d.toString();null!=Fn&&(Dd.UserActionName=Fn);var Gn=Ma.e;null!=Gn&&(Dd.UserActionData=
Gn);var Hn=null==Ma.f?null:Ma.f.toString();null!=Hn&&(Dd.DurationInMs=Hn);break;case 53:Lg="NamedSheetViewTeachingDialog";var In=Ma.a;null!=In&&(Dd.UserSessionId=In);var Jn=Ma.b;null!=Jn&&(Dd.UserActionName=Jn);var Kn=Ma.c;null!=Kn&&(Dd.ButtonClicked=Kn);var Ln=null==Ma.d?null:Ma.d.toString();null!=Ln&&(Dd.DurationInMs=Ln);var Mn=null==Ma.e?null:Ma.e.toString();null!=Mn&&(Dd.IsNewTeachingDialog=Mn);break;case 54:Lg="NamedSheetViewOptionsDialog";var Nn=Ma.a;null!=Nn&&(Dd.UserSessionId=Nn);var On=null==
Ma.b?null:Ma.b.toString();null!=On&&(Dd.OptionsAction=On);var Pn=Ma.c;null!=Pn&&(Dd.OptionsActionData=Pn);var Qn=Ma.d;null!=Qn&&(Dd.OptionsOtherData=Qn);var Rn=null==Ma.e?null:Ma.e.toString();null!=Rn&&(Dd.DurationInMs=Rn);break;case 55:Lg="NamedSheetViewTempViewSaveDialog";var Sn=Ma.a;null!=Sn&&(Dd.UserSessionId=Sn);var Tn=Ma.b;null!=Tn&&(Dd.TriggeredFrom=Tn);var Un=Ma.c;null!=Un&&(Dd.ButtonClicked=Un);var Vn=null==Ma.d?null:Ma.d.toString();null!=Vn&&(Dd.NameUpdated=Vn);var Wn=null==Ma.e?null:Ma.e.toString();
null!=Wn&&(Dd.DurationInMs=Wn);break;case 56:Lg="TemporaryViewStartedDataRestore";var Xn=Ma.a;null!=Xn&&(Dd.UserSessionId=Xn);var Yn=null==Ma.b?null:Ma.b.toString();null!=Yn&&(Dd.CountOfTempViews=Yn);break;case 57:Lg="TemporaryViewFetchedVersion";var Zn=Ma.a;null!=Zn&&(Dd.UserSessionId=Zn);var $n=null==Ma.b?null:Ma.b.toString();null!=$n&&(Dd.NumberOfBytes=$n);break;case 58:Lg="RaiseEventsAndGenerateBlockRequests";var ao=null==Ma.a?null:Ma.a.toString();null!=ao&&(Dd.ReturnContentStatus=ao);var bo=
null==Ma.b?null:Ma.b.toString();null!=bo&&(Dd.CacheState=bo);var co=null==Ma.c?null:Ma.c.toString();null!=co&&(Dd.FromXhrCallback=co);var eo=null==Ma.d?null:Ma.d.toString();null!=eo&&(Dd.AreGeneralErrorsPresent=eo);var fo=Ma.e;null!=fo&&(Dd.BlockCacheItemHash=fo);var go=Ma.f;null!=go&&(Dd.StopwatchId=go);var ho=Ma.g;null!=ho&&(Dd.BlockCacheItemProcessingStopwatchId=ho);var io=null==Ma.h?null:Ma.h.toString();null!=io&&(Dd.StateId=io);var jo=null==Ma.i?null:Ma.i.toString();null!=jo&&(Dd.IsHighPriority=
jo);var ko=null==Ma.j?null:Ma.j.toString();null!=ko&&(Dd.CalcComplete=ko);var lo=null==Ma.k?null:Ma.k.toString();null!=lo&&(Dd.EditedCellsUpdatedByCse=lo);var mo=null==Ma.l?null:Ma.l.toString();null!=mo&&(Dd.DependentCellsUpdatedByCse=mo);var no=null==Ma.m?null:Ma.m.toString();null!=no&&(Dd.Revision=no);var oo=null==Ma.n?null:Ma.n.toString();null!=oo&&(Dd.SheetProcessedDataVersion=oo);var po=null==Ma.o?null:Ma.o.toString();null!=po&&(Dd.RefCount=po);var qo=null==Ma.p?null:Ma.p.toString();null!=qo&&
(Dd.ExistsInView=qo);var ro=null==Ma.q?null:Ma.q.toString();null!=ro&&(Dd.ContentSource=ro);break;case 59:Lg="LaunchMakerCodeEditor";var so=Ma.a;null!=so&&(Dd.SessionId=so);var to=Ma.b;null!=to&&(Dd.Command=to);var uo=null==Ma.c?null:Ma.c.toString();null!=uo&&(Dd.IsPreviewGallery=uo);var vo=Ma.d;null!=vo&&(Dd.MenuItemId=vo);var wo=Ma.e;null!=wo&&(Dd.ScriptId=wo);var xo=Ma.f;null!=xo&&(Dd.ShareId=xo);var yo=null==Ma.g?null:Ma.g.toString();null!=yo&&(Dd.IsOwner=yo);var zo=null==Ma.h?null:Ma.h.toString();
null!=zo&&(Dd.PublishedScriptCount=zo);var Ao=null==Ma.i?null:Ma.i.toString();null!=Ao&&(Dd.RecentScriptCount=Ao);var Bo=null==Ma.j?null:Ma.j.toString();null!=Bo&&(Dd.WorkbookScriptCount=Bo)}Dd.Table=Lg;var Do=Sys.Serialization.JavaScriptSerializer.serialize(Dd);Be.call(de,3704927,0,50,Do)}}catch(Dd){N.ULS.sendTraceTag(3704928,0,10,`Error when serializing usage table: ${Qa} exception: ${Dd}`)}}wBd(Qa,Ma,$c){if(this.xPc){const de=this.Xab[Qa+Ma];de&&(de.e=$c,this.BEd(de));delete this.Xab[Qa+Ma]}}f0d(Qa,
Ma){eh[Qa]in this.S6f||this.tl(Qa,Ma)}J2j(){this.Bp.appStart&&this.rUg(Fg.Z9d,this.Bp.appStart)}pzj(Qa){const Ma={};Ma.a=Qa.i;Ma.b=Qa.o;Ma.c=Qa.t;Ma.d=fh.a(Qa.s,Qa.p||this.Bp.appStart);Ma.e=fh.a(Qa.e,Qa.s);Ma.f=Qa.c;Ma.g=Qa.a;Ma.h=Qa.h;this.tl(0,Ma,this.cmj(Ma.b,Ma.c))}cmj(Qa,Ma){return["CommandTask","QueuedTask","Task"].includes(Qa)&&!this.Oqi.includes(Ma)?!1:!0}fI(Qa,Ma,$c,de,Be){if(Qa&&Ma){const nf={};nf.a=Qa;nf.b=Ma;nf.c=$c.toString();nf.d=de.toString();this.tl(15,nf,void 0===Be?!0:Be)}}z6f(Qa,
Ma,$c,de){const Be={};Qa&&(Be.c=fh.a(Qa,this.Bp.appStart));Be.b=Ma;Be.a=$c;Be.d=de;this.tl(17,Be)}dispose(){this.PNa.execute(Qa=>{Qa.deactivate(!0);Qa.Sik(this.Zlg)});this.Wj&&this.Wj.p5a(this.mP);super.dispose()}CKf(){return this.n6g=this.n6g||new cg}Lif(Qa,Ma,$c,de,Be){const nf={};nf.o=Qa;nf.t=Ma;nf.p=void 0===Be?null:Be;nf.s=(void 0===de?null:de)||this.Bp.qk;this.gRd(nf,void 0===$c?null:$c);return nf}ief(Qa,Ma){Qa&&(Qa.e=(void 0===Ma?null:Ma)||this.Bp.qk,Qa.i=Qa.i||this.Zfb.apb(),Qa.c=Qa.c||this.njf,
Qa.a=Qa.a||this.yjf,Qa.h=void 0!==Qa.h&&null!==Qa.h?Qa.h:this.Wj?this.Wj.tn:!1,this.BEd(Qa))}H6f(Qa){const Ma=Qa.context;Qa.duration>Fg.Jei&&(Ma.methodName===ib.a.yQb||Ma.methodName===ib.a.hJa)&&this.xTc(1,Fg.SRi);if("GetSessionStatus"!==Ma.methodName){const $c={};$c.a=Ma.methodName;$c.b=Ma.stopwatch.id;$c.c=Qa.JTc;$c.d=Qa.responseSize;$c.e=Ma.LVa;$c.f=Qa.Uj?Qa.Uj.StateId:ib.a.Qve;this.tl(30,$c,!0);this.fI($c.b,Qa.Uj.ServerCorrelationId,"clientWebRequests","ServerActions")}}iVg(){if(this.xPc){const Qa=
this.Xab.LoadingUIShownSplashScreen;Qa&&Ea.a.instance.rBk(Qa.s)}}xTc(Qa,Ma){this.P4g.y3b(Qa,Ma,null)}HDg(Qa,Ma){this.n2c.gnk(Qa,void 0===Ma?null:Ma)}GDg(Qa,Ma,$c){this.n2c.fnk(Qa,Ma,void 0===$c?null:$c)}IDg(Qa){this.n2c.Rhe(Qa,null)}JDg(Qa,Ma){this.n2c.y3b(Qa,Ma,null)}sTc(Qa,Ma,$c){this.S8a.sTc(Qa,Ma,void 0===$c?null:$c)}BTc(Qa,Ma,$c){this.S8a.BTc(Qa,Ma,void 0===$c?null:$c)}b5b(Qa,Ma,$c,de,Be,nf,Tf,...Xf){this.S8a.b5b(Qa,Ma,$c,de,Be,nf,Tf,...Xf)}xVc(Qa,Ma,$c,de,Be,nf,Tf){this.S8a.xVc(Qa,Ma,$c,de,
Be,nf,Tf)}d5b(Qa,Ma,$c,de,Be,nf){this.S8a.d5b(Qa,Ma,$c,de,Be,nf)}c5b(Qa,Ma,$c,de,Be,nf,...Tf){this.S8a.c5b(Qa,Ma,$c,de,Be,nf,...Tf)}e5b(Qa,Ma,$c,de,Be,nf){this.P4g.e5b(Qa,Ma,$c,de,Be,nf)}yVc(Qa,Ma,$c,de){this.S8a.yVc(Qa,Ma,$c,de)}BEd(Qa){this.cSk.pzj(Qa)}K2j(){if(this.xPc){Stw.swpc=null;const Qa=this.xPc;for(const Ma in Qa)this.gRd(Qa[Ma])}}hui(){const Qa=window[Dg.a.namespace];if(Qa){const Ma=Qa[Dg.a.gdf];Ma&&(delete Qa[Dg.a.gdf],Ma.forEach($c=>{this.gRd($c);this.BEd($c)}))}}Bnj(Qa,Ma){if("about:blank"===
Qa||"renamehandler.ashx"===Ma&&"2"===nb.a.lz(Qa,"u"))return!0;for(Qa=0;Qa<this.fie.length;Qa++)if(Ma.endsWith(this.fie[Qa]))return!0;return!1}Gwj(){this.PNa.execute(Qa=>{Qa.ao(Fg.FHh,0);Qa.myh(this.Zlg);Qa.activate()})}ywj(){const Qa={};Qa.a=new Date(Nb.EcmaDateClock.instance.appStart.m);Qa.b=this.userSessionId;Qa.c=this.Bp.oYg;Qa.d=Fg.Z8h*Eb.devicePixelRatio;Qa.e=z.a.Tg.appStart.m;this.tl(14,Qa,!0);this.moa(z.a.Tg.appStart.m,Object(ec.a)(qb.a.instance,qb.a.instance.jck,"recordAppInitStart"))}rUg(Qa,
Ma){this.ayb=this.Zfb.apb();this.X9b=this.Zfb.apb();this.oRa=Qa;this.MYc("UserAction",Qa,this.X9b,Ma);this.l5f(Qa,this.ayb)}yUk(){const Qa=window[Dg.a.namespace];Qa&&!Fg.Qgf&&(Qa[Dg.a.cRk]=(Ma,$c)=>this.Lif(Ma,$c),Qa[Dg.a.ehi]=Ma=>{this.ief(Ma)},Fg.Qgf=!0)}W2k(Qa){const Ma=Yf.uLh(Qa.o,Qa.t),$c=new Yf(fh.a(Qa.e,Qa.s)),de=Ma in this.ise?this.ise[Ma].KVh($c):$c;this.ise[Ma]=de;if($c===de||$c.average!==de.average)Qa=Object(Ta.a)(new Vh,{operation:Qa.o,target:Qa.t,uGj:de.average,sender:this}),this.raiseEvent(Ma,
Qa)}l5f(Qa,Ma){const $c={};$c.a=Ma;$c.b=this.userSessionId;$c.c=Qa;this.tl(1,$c,!0)}E$i(){this.fie=[ib.a.igk,ib.a.getSessionStatus,ib.a.hJa,ib.a.xVh,ib.a.jSh,ib.a.Sxb,ib.a.zzc,ib.a.getObjectMetadata,ib.a.oPi,ib.a.setRichTextCell,ib.a.oJa,ib.a.J7k,ib.a.pollSessionStatus,ib.a.nVi,ib.a.bTi,ib.a.WLi]}gRd(Qa,Ma){Qa.i=(void 0===Ma?null:Ma)||this.Zfb.apb();Qa.a=this.yjf;Qa.c=this.njf;Qa.h=this.Wj?this.Wj.tn:!1}static Aa(Qa){const Ma=new Fg(Qa.ua.UserSessionId,Qa.ka,void 0,void 0,void 0,!0);Ma.l5f(Fg.Gbg,
Ma.kkf);N.ULS.sendTraceTag(524166239,0,50,"TelemetryManager: Activating BrowserResourceTiming Telemetry logs");Ma.Gwj();Ma.yUk();Ma.J2j();Ma.ywj();Ma.hui();Ma.K2j();Ma.E$i();Fg.Ryk(Qa);Gc.a.Ax.ph(41,Ma)}static Ryk(Qa){const Ma=Eb.devicePixelRatio;1<Ma&&Qa.th.BE(!0,2<=Ma?8388608:4194304)}}Fg.Gbg="UnassignedUserAction";Fg.Z9d="PageLoad";Fg.yNd="GridUpdateOperation";Fg.Jei=5E3;Fg.SRi="MoreThan_5000_Ms";Fg.Z8h=96;Fg.FHh=30;Fg.Qgf=!1;Object(u.a)(Fg,"TelemetryManager",v.a,[18,19,655,656]);Type.registerNamespace("_Ewa");
Type.registerNamespace("Common.App.BrowserInfoLogger");Na.main();Type.registerNamespace("CNT");Nd.main();Type.registerNamespace("CACPU");cc.main();Type.registerNamespace("Common.App.EventsCacheManager");Sa.main();(()=>{pb.a.Qg(Qa=>{D.id.Ha()||Qa.ka.ph(137,new yd(Qa))})})();(()=>{pb.a.Qg(Qa=>{Qa.ka.ph(37,new Ze(Qa))})})();(()=>{pb.a.Qg(Qa=>{Qa.ka.ph(40,new ie(Qa,new id.a(()=>D.id.Ha()?Object(me.d)(J.a.resolve(D.id,{va:1})):Oe.GetServiceTaskFactory.create(Qa.ka,137,Qa.xa,1))))})})();(()=>{pb.a.Qg(Qa=>
{Qa.ka.ph(276,new lc(Qa))})})();(()=>{pb.a.Qg(Qa=>{Gc.a.Ax.Lh(135,()=>{Fg.Aa(Qa);S.Aa(Qa);M.EwaSettings.isChangeGateEnabled("OfficeVSO:8434150_MigrateValidationTelemetryManager")||pc.Aa(Qa);Le.Aa(Qa);E.Aa(Qa);M.EwaSettings.isChangeGateEnabled("OfficeVSO:8680491_MigrateRenderingFidelityTracker")||La.RenderingFidelityTracker.Aa(Qa)})})})();String(f);String(r);String(d);String(k);String(t);String(La);String(m);String(e);String(w);window.___1708742503528_closurehack=f;window.___1708742503528_closurehack=
r;window.___1708742503528_closurehack=d;window.___1708742503528_closurehack=k;window.___1708742503528_closurehack=t;window.___1708742503528_closurehack=La;window.___1708742503528_closurehack=m;window.___1708742503528_closurehack=e;window.___1708742503528_closurehack=w},897:function(y,x,a){function c(d,k){k=void 0===k?{}:k;return b.AFrameworkApplication.fa.la("IsWebpack5RibbonEnabled")?runtime.loadChunk(d):f.a.resolve(r.Eb,k).then(t=>t(d))}a.d(x,"a",function(){return c});var b=a(6),f=a(97),r=a(5)},
913:function(y,x,a){a.d(x,"a",function(){return l});y=a(0);var c=a(6),b=a(81),f=a(34),r=a(31),d=a(188);class k{constructor(u,n){this.message=u;this.KHa=n}}Object(y.a)(k,"CrossDocumentEventArgs",null,[]);var t=a(937),m=a(478),e=a(289),w=a(936);class l{constructor(u,n,v,B){this._name="";this.FB={};this.ida=null;this.ackMessageHandler=z=>{z=z.CorrelationId;""!==z&&z in this.FB&&(w.a.sendTraceTag(42783044,2,"Received Ack for Message {0} CorrelationId: {1}",this.FB[z],z),this.FB[z]="ACK_RECEIVED")};this.zYb=
z=>{const C=this.kQb(z);if(!C)return!1;if(this.Cr[C.MessageId])return this.rQ.gKa(this.Cr[C.MessageId],C),!0;if(this.ft[C.MessageId]){const D=this.ft[C.MessageId];z=new k(C,z);this.rQ.hTb(D,z);return!0}return!1};this.wQ=[];this.kQ=[];this.lQ=[];this.uQ=[];this.EEa=u;this.CEa=n;this.Cr={};this.ft={};this.rQ=v;l._id++;B&&B();this.Ku=this.enable()}get targetOrigin(){return this.CEa}get lPa(){return this.EEa}enable(){if(!e.a())return w.a.sendTraceTag(5018251,2,"Not supported for current browser."),!1;
this.aTb();w.a.sendTraceTag(5018252,2,"Enabled.");return!0}isEnabled(){return this.Ku}aTb(){w.a.debugAssertTag(5018253,!!this.rQ,null);this.ida=this.zYb;this.rQ.LUa(this.ida,null)}disable(){this.Ku=!1;this.wQ=[];this.kQ=[];this.lQ=[];this.uQ=[];this.EEa=null;this.CEa="";this.rQ.ZWa(this.ida);this.Cr={};this.ft={}}dispose(){this.disable()}Dga(u){return!!this.wQ&&Array.contains(this.wQ,u)||this.xKa(u)}xKa(u){return!!this.kQ&&Array.contains(this.kQ,u)}Tq(u){w.a.debugAssertTag(5018259,!!this.wQ,null);
Array.add(this.wQ,u);w.a.sendTraceTag(5018260,2,"Allow receiving : {0}",u)}UTa(u){w.a.debugAssertTag(5018261,!!this.kQ,null);Array.add(this.kQ,u);w.a.sendTraceTag(5018262,2,"Allow free receiving: {0}",u)}SUb(u){return!!this.lQ&&Array.contains(this.lQ,u)}OW(u){w.a.debugAssertTag(5018263,!!this.lQ,null);Array.add(this.lQ,u);w.a.sendTraceTag(5018264,2,"Allow free sending: {0}",u)}bVb(u){u=b.a.getOrigin(u);return!!u&&!!this.uQ&&Array.contains(this.uQ,u)}PW(u){w.a.debugAssertTag(5018265,!!this.uQ,null);
if(u===l.HL)return w.a.debugAssertTag(5018266,!1,null),!1;let n=b.a.getOrigin(u);if(!n)return w.a.sendTraceTag(5018267,4,"Get origin fail:{0}",u),!1;c.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.NormalizePostMessageOrigin")&&(n=r.a.Rr(n));Array.add(this.uQ,n);w.a.sendTraceTag(5018268,2,"Add origin:{0}",n);return!0}send(u,n){n=void 0===n?null:n;let v=this.targetOrigin;if(n){n=b.a.getOrigin(n);if(!n)return!1;v=n}return this.hia(u,this.lPa,v)}sendMessage(u,
n,v){v=(v=void 0===v?"":v)&&""!==v?v:d.a.create().toString();return this.send(this.Aha(u,n,v,c.AFrameworkApplication.userSessionId))}postMessage(u){const n=d.a.create().toString();if(!c.AFrameworkApplication.fa.la("RetryablePostMessagingIsEnabled")||!u.kqa)return this.send(this.Aha(u.messageId,u.values,n,u.userSessionId));this.Cr[u.l9]||(this.Tq(u.l9),this.Ip(u.l9,this.ackMessageHandler));this.FB[n]="";return this.YMa(u,n,1)}YMa(u,n,v){if(""!==n&&n in this.FB&&"ACK_RECEIVED"===this.FB[n])return delete this.FB[n],
!0;if(v>u.iP)return w.a.sendTraceTag(40716250,4,'No retries remaining. {{"MessageId":{0}, "CorrelationId":{1}}}',u.l9,n),delete this.FB[n],!1;w.a.sendTraceTag(40716251,1<v?4:2,'Sending postmessage. Attempts remaining {0}. {{"MessageId":{1}, "CorrelationId":{2}}}',u.iP-v,u.messageId,n);v++;window.setTimeout(()=>{this.YMa(u,n,v)},u.zkd);u.values[m.a.xkd]=!0;return this.send(this.Aha(u.messageId,u.values,n,u.userSessionId))}Aha(u,n,v,B){u=new t.a(u);u.CorrelationId=v;n&&(u.Values=n);u.Values.wdUserSession=
B;return u}hia(u,n,v){w.a.debugAssertTag(5018269,!!u,null);if(!this.Ku)return!1;w.a.debugAssertTag(5018270,!!n,null);w.a.debugAssertTag(5018271,!!v,null);if(!n||!v)return w.a.debugAssertTag(5018272,!1,null),!1;if(v===l.HL&&!this.SUb(u.MessageId))return w.a.sendTraceTag(5018273,1,"Got unregistered message {0}",{["id"]:u.MessageId}),!1;u.SendTime=(new Date).getTime();let B="";try{B=Sys.Serialization.JavaScriptSerializer.serialize(u)}catch(z){return w.a.sendTraceTag(5018274,4,"JSON Ser failed {0}",{["Exception"]:z.message}),
!1}n=l.sendMessage(n,B,v);w.a.sendTraceTag(5018275,2,"Send {0}. {1}",n?"succeeded":"failed",{["id"]:u.MessageId,["origin"]:v});return n}Ip(u,n){w.a.debugAssertTag(5018304,!!n,null);w.a.debugAssertTag(5018305,!!this.Cr&&!!this.ft,null);if(!this.Ku)return!1;if(!this.Dga(u))return w.a.sendTraceTag(5018306,2,"Not allow receiving {0}",{["id"]:u}),!1;this.Cr[u]!==n&&(w.a.debugAssertTag(5018307,!this.Cr[u]&&!this.ft[u],null),this.Cr[u]=n,delete this.ft[u]);return!0}registerEventCallback(u,n){w.a.debugAssertTag(40420062,
!!n,null);w.a.debugAssertTag(40420063,!!this.ft&&!!this.Cr,null);if(!this.Ku)return!1;if(!this.Dga(u))return w.a.sendTraceTag(40420064,2,"Not allow receiving {0}",{["id"]:u}),!1;this.ft[u]!==n&&(w.a.debugAssertTag(40420065,!this.Cr[u]&&!this.ft[u],null),this.ft[u]=n,delete this.Cr[u]);return!0}wZ(u){this.Ku&&(this.Cr[u]&&delete this.Cr[u],this.ft[u]&&delete this.ft[u])}kQb(u){const n=new Date;this.EXb(u);if(!u.origin||!u.source||void 0===u.data||null===u.data)return w.a.sendTraceTag(5018308,4,"eventArgs missing required properties."),
null;const v=this.xWb(u.data);if(!v)return null;if(!this.bVb(u.origin)){if(!this.xKa(v.MessageId))return w.a.sendTraceTag(5018309,1,"{0}",{["id"]:v.MessageId}),null;if(!f.a.Q5&&u.source!==this.lPa)return w.a.sendTraceTag(5018310,4,"Received message came from a source other than the parent window."),null}w.a.debugAssertTag(5018311,!!v.Values,null);v.Values.m_Source=u.source;v.Values.m_Origin=u.origin;v.Values.m_ReceivedTime=n.getTime();return v}xWb(u){if(!u)return null;let n=null;try{n=Sys.Serialization.JavaScriptSerializer.deserialize(u,
!0)}catch(z){return 2>l.VCa&&(w.a.sendTraceTag(5018312,2,"Deser failed"),l.VCa++),null}if(!n)return w.a.debugAssertTag(5018313,!1,null),null;for(u=0;u<l.C_.length;u++)if(!n[l.C_[u]])return"MessageId"!==l.C_[u]&&w.a.sendTraceTag(41502555,2,"Cannot find required message field: {0}",l.C_[u]),null;if(n.Values)try{n.Values}catch(z){return w.a.sendTraceTag(5018314,4,"Not a valid dictionary: {0}",z.message),null}else w.a.sendTraceTag(41502556,2,"No values in message");u=n.MessageId;if(!this.Dga(u))return w.a.sendTraceTag(5018315,
1,"Ignore recvd {0}",{["id"]:u}),null;const v=n.SendTime,B=(new Date).getTime()-v;if(0>v)return w.a.sendTraceTag(520435660,2,"{0}",{["t"]:v,["id"]:u}),null;6E4<B&&w.a.sendTraceTag(520435659,2,"{0}",{["t"]:v,["delta"]:B,["id"]:u});-300>B&&w.a.sendTraceTag(520435658,2,"{0}",{["t"]:v,["delta"]:B,["id"]:u});u=new t.a;u.MessageId=n.MessageId;u.SendTime=n.SendTime;u.CorrelationId=n.CorrelationId;n.Values&&(u.Values=n.Values);w.a.sendTraceTag(40640779,1,"Received message with MessageId:{0}, SendTime:{1}, CorrelationId:{2}",
u.MessageId,u.SendTime,u.CorrelationId);return u}EXb(u){w.a.sendTraceTag(5018318,1,String.format("Received: {0}",{["origin"]:u.origin,["data"]:u.data,["source"]:u.source}))}static sendMessage(u,n,v){if(!e.a())return w.a.debugAssertTag(5018319,!1,null),!1;try{return u.postMessage(n,v),!0}catch(B){w.a.sendTraceTag(5018320,4,"{0}",{["exception"]:B.message})}return!1}}l.C_=["MessageId","SendTime"];l.HL="*";l._id=0;l.VCa=0;Object(y.a)(l,"CrossDocumentMessenger",null,[2,474])},923:function(y,x,a){a.d(x,
"a",function(){return r});y=a(0);var c=a(1),b=a(97),f=a(5);class r{static tRf(d){r.$=d;c.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void b.a.resolve(f.Ab).then(k=>{r.Wj=k}):r.$.ka.Lh(291,k=>{r.Wj=k})}static lwa(d,k){return d[Math.round((d.length-1)*k/100)]}static tM(d){return r.Wj?r.Wj.tM(d):!1}}r.Wj=null;r.$=null;Object(y.a)(r,"SessionStatisticsManagerHelper",null,[])},936:function(y,x,a){a.d(x,"a",function(){return c});y=a(0);class c{static a5b(){}static GLb(){}}
c.sendTraceTag=c.a5b;c.debugAssertTag=c.GLb;Object(y.a)(c,"BULS",null,[])},937:function(y,x,a){a.d(x,"a",function(){return c});y=a(0);class c{constructor(b){this.MessageId=b;this.SendTime=0;this.CorrelationId="";this.Values={}}}Object(y.a)(c,"CrossDocumentMessage",null,[])},959:function(y,x,a){a.d(x,"a",function(){return c});const c=b=>{if(Object.keys)b=Object.keys(b);else{const f=[];for(const r in b)f.push(r);b=f}return b}}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.tm.js.map/755d6c812a1d2a4f11354630c32e69f3/EwaTS.tm.js.map