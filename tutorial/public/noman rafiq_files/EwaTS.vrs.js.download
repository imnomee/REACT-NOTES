'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[12],{1245:function(y,x,a){x=a(476);a=a(1431);a=a.kv?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);x(a,{insert:"head",AC:!1});y.exports=a.oH||{}},1431:function(y,x,a){x=a(477)(!1);x.push([y.i,".ewa-svg-icon{height:100%;width:100%}",""]);y.exports=x},1432:function(y,x,a){x=a(476);a=a(1433);a=a.kv?a.default:a;"string"===typeof a&&(a=[[y.i,a,""]]);x(a,{insert:"head",AC:!1});y.exports=a.oH||{}},1433:function(y,x,
a){x=a(477)(!1);x.push([y.i,'.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}a.ewa-stb-navbutton.cui-disabled:focus{outline:auto 1px}.ewa-stb-navareaextra a.ewa-stb-navbutton:focus-visible{outline-offset:-1px}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-invalid-sheetname-container{position:fixed;top:0;right:0;bottom:0;left:0;z-index:-1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media (prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}.ewa-stb-uir .rename-textbox-active{background-color:#e0e0e0!important}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.tab-anchor-text:focus-visible{outline-offset:-1px}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:transparent;border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width .4s cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-uir .tab-active.rename-textbox-active .tab-content-container::before{width:calc(100%)}.ewa-stb-tabs .tab-content-container,.ewa-stb-tabs .tab-text{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px!important;height:14px}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0!important;margin-right:4px!important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar ::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:700;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:700;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px!important;height:13px!important;width:12px!important}.ewa-stb-tabs .ewa-stb-locked-sheet-svg-16px{margin-right:4px}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0!important;margin-left:4px!important}.ewa-stb-rename-textbox{position:relative;display:none;border:none;outline:0;font-family:inherit;font-size:inherit;background:0 0}.ewa-stb-rename-textbox::selection{color:#fff;background-color:#616161}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover,.ewr-presentMode-on .ewa-stb-uir .tab-hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39!important;border:1px solid #e5e5e5!important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}',
""]);y.exports=x},392:function(y,x,a){a.r(x);var c={};a.r(c);a.d(c,"IndexedDB",function(){return M});var b={};a.r(b);a.d(b,"MoreColorsHelper",function(){return ka});var f={};a.r(f);var r={};a.r(r);a.d(r,"OAuthManagerWrapper",function(){return db});var d={};a.r(d);a.d(d,"PopulateDynamicHelper",function(){return ob});var k={};a.r(k);a.d(k,"RibbonControlsManager",function(){return Md});var t={};a.r(t);a.d(t,"SheetDropdownMenuCommandHandler",function(){return ec});var m={};a.r(m);a.d(m,"SheetTabBarFactory",
function(){return cf});var e=a(179),w=a(0),l=a(14),u=a(34),n=a(182),v=a(229),B=a(40),z=a(32),C=a(1);class D{constructor(Pa){this.keyPath=Pa}}Object(w.a)(D,"KeyPathClass",null,[]);var J=a(66),W=a(97),N=a(5);let M=class extends v.a{constructor(Pa){super();this.swb=this.syd=null;this.Vjf=1;this.U$a=null;this.$=Pa}get indexedDBFactory(){this.U$a||(window.indexedDB?this.U$a=window.indexedDB:window.webkitIndexedDB?this.U$a=window.webkitIndexedDB:window.mozIndexedDB?this.U$a=window.mozIndexedDB:window.msIndexedDB&&
(this.U$a=window.msIndexedDB));return this.U$a}get initialized(){return!!this.syd&&!!this.swb}initialize(Pa,lc,Gc){this.syd=Pa;this.swb=lc;this.Vjf=Gc}jl(){try{return C.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&u.a.Una||u.a.hm&&91===u.a.WEd?!1:!!this.indexedDBFactory&&"undefined"!==typeof this.indexedDBFactory.open}catch(Pa){return l.ULS.sendTraceTag(537157640,0,15,`IndexedDB.IsSupported() failed. Exception: ${Pa.message}`),!1}}W5a(Pa){return this.jl()&&this.initialized?
B.TaskExtensions.iWa(this.y9d(),lc=>{if(void 0===lc.result)return!1;lc=lc.result;this.Jqc(lc);const Gc=z.a.Tg.qk.m;this.hMd(lc,!1).put(Pa);l.ULS.sendTraceTag(537157638,0,50,`IndexedDB.SaveToIndexedDB takes ${z.a.Tg.qk.m-Gc} Millisecond.`);return!0},this.xa):(l.ULS.sendTraceTag(537157639,0,15,"IndexedDB.SaveToIndexedDB: not supported or wasn't initilized."),J.Task.Va(!1))}bzd(Pa){return this.jl()&&this.initialized?B.TaskExtensions.iWa(this.y9d(),lc=>{if(void 0===lc.result&&C.EwaSettings.isChangeGateEnabled("OfficeVSO:6476652_SuppressCouldntOpenIndexedDbJsCrash"))return!1;
lc=lc.result;this.Jqc(lc);const Gc=z.a.Tg.qk.m;this.hMd(lc,!1)["delete"](Pa);l.ULS.sendTraceTag(537157636,0,50,`IndexedDB.DeleteFromIndexedDB takes ${z.a.Tg.qk.m-Gc} Millisecond.`);return!0},this.xa):(l.ULS.sendTraceTag(537157637,0,15,"IndexedDB.DeleteFromIndexedDB: not supported or wasn't initilized."),J.Task.Va(!1))}MYa(Pa){return this.jl()&&this.initialized?B.TaskExtensions.hZh(this.y9d(),lc=>void 0===lc.result&&C.EwaSettings.isChangeGateEnabled("OfficeVSO:6476652_SuppressCouldntOpenIndexedDbJsCrash")?
J.Task.Va(""):this.wKi(lc.result,Pa),this.xa):(l.ULS.sendTraceTag(537157635,0,15,"IndexedDB.DeleteFromIndexedDB: not supported or wasn't initilized."),J.Task.Va(""))}deleteDatabase(Pa){if(!this.jl())return l.ULS.sendTraceTag(507872215,0,15,"IndexedDB.deleteDatabase: not supported."),J.Task.Va(!1);const lc=new n.a;Pa=this.indexedDBFactory.deleteDatabase(Pa);Pa.onsuccess=()=>{lc.setResult(!0)};Pa.onerror=()=>{lc.setResult(!1)};return lc.task}Jqc(Pa){Pa.objectStoreNames.contains(this.swb)||Pa.createObjectStore(this.swb,
new D("key"))}y9d(){const Pa=new n.a,lc=this.indexedDBFactory.open(this.syd,this.Vjf);lc.onsuccess=()=>{const Gc=lc.result;l.ULS.sendTraceTag(537157634,0,50,`OpenIndexedDB ${Gc.name} success`);Pa.setResult(Gc)};lc.onupgradeneeded=()=>{const Gc=lc.result;l.ULS.sendTraceTag(520902218,0,50,`OpenIndexedDB ${Gc.name} upgrade needed`);try{this.Jqc(Gc),l.ULS.sendTraceTag(520902217,0,50,`OpenIndexedDB ${Gc.name} upgrade done`)}catch(Cd){l.ULS.sendTraceTag(520902216,0,10,`OpenIndexedDB upgrade failed: ${Cd}`),
C.EwaSettings.isChangeGateEnabled("OfficeVSO:6463223_Bug6241905")?Pa.setResult(void 0):Pa.setException(Error.create("Failed to upgrade IndexedDB"))}};lc.onerror=Gc=>{l.ULS.sendTraceTag(588288084,0,50,`OpenIndexedDB ${Gc} failed`);Pa.setResult(void 0)};return Pa.task}hMd(Pa,lc){return Pa.transaction([this.swb],lc?"readonly":"readwrite").objectStore(this.swb)}wKi(Pa,lc){const Gc=new n.a;this.Jqc(Pa);const Cd=z.a.Tg.qk.m,Qd=this.hMd(Pa,!0).get(lc);Qd.onsuccess=ge=>{(ge=ge.target.result)?(Gc.setResult(ge.value),
l.ULS.sendTraceTag(537157633,0,50,`IndexedDB.GetFromIndexedDB takes ${z.a.Tg.qk.m-Cd} Millisecond.`)):Gc.setResult("")};Qd.onerror=()=>{Gc.setException(Error.create(Qd.error?Qd.error.message:"DB error"))};return Gc.task}};M=Object(e.__decorate)([Object(W.d)(N.qd,{yk:"transient"}),Object(e.__param)(0,Object(N.Lb)())],M);Object(w.a)(M,"IndexedDB",v.a,[219]);var Q=a(31),R=a(360),O=a(361),U=a(208),K=a(86),F=a(388),I=a(150),P=a(419),Y=a(212),ea=a(225),Ba=a(196),Fa=a(35),za=a(252),xa=a(262),fa=a(151);class V{constructor(Pa,
lc,Gc,Cd){this.red=Pa;this.green=lc;this.blue=Gc;this.alpha=Cd}toString(){return this.red.toString()+this.green.toString()+this.blue.toString()+this.alpha.toString()}}Object(w.a)(V,"ColorObject",null,[]);class ba{constructor(Pa){this.j9=this.nQ=null;this.ssd=Pa}get head(){return this.nQ}get jte(){return this.j9}Vkf(Pa){this.head&&(Pa.pre?Pa.next?(Pa.pre.next=Pa.next,Pa.next.pre=Pa.pre):(this.j9=Pa.pre,this.jte.next=null):Pa.next?(this.nQ=Pa.next,this.head.pre=null):this.j9=this.nQ=null,Pa.next=null,
Pa.pre=null)}Ewh(Pa){this.head?(Pa.next=this.head,this.nQ=Pa,Pa.next.pre=this.head):this.j9=this.nQ=Pa}getItems(){if(!this.head)return null;const Pa=new U.a;let lc=this.head;for(;lc;)if(Pa.add(lc.value),lc=lc.next,Pa.count>this.ssd){l.ULS.sendTraceTag(537155399,0,10,"CustomLinkedList.GetItems - Size of Linked List exceeded max capacity.");break}return Pa}}Object(w.a)(ba,"CustomLinkedList",null,[]);class la{constructor(Pa){this.pre=this.next=null;this.value=Pa}}Object(w.a)(la,"CustomLinkedListNode",
null,[]);class Ta{constructor(Pa){this.ssd=Pa;this.oLc={};this.xob=new ba(Pa);this.count=0}add(Pa,lc){Pa&&lc?(lc=new la(lc),this.contains(Pa)?this.xob.Vkf(this.oLc[Pa]):this.count<this.ssd?this.count++:(delete this.oLc[this.xob.jte.value.toString()],this.xob.Vkf(this.xob.jte)),this.xob.Ewh(lc),this.oLc[Pa]=lc):l.ULS.sendTraceTag(537155358,0,15,`MRUCache.Add: Key ${Pa} or Value ${lc} is null.`)}getItems(){return this.xob.getItems()}contains(Pa){return Pa?Pa in this.oLc:!1}}Object(w.a)(Ta,"MRUCache",
null,[]);var Ea=a(236),sa=a(12);class Ya extends Ea.a{constructor(Pa,lc,Gc,Cd){Cd=void 0===Cd?null:Cd;super(!1,!1,!0);this.Jl=null;this.AVh=(Qd,ge)=>{this.jdf(Qd,ge)};this.$=Pa;this.A8i=lc;this.cRf=Gc;this.kdf=Cd}Im(){const Pa=sa.a.instance.ia(1346),lc={};lc[Ya.t$g]=this.A8i;lc[Ya.Q7g]=Ya.cac;lc[Ya.o$g]=Ya.cac;lc[Ya.tbh]=Ya.cac;lc[Ya.Sah]=Ya.cac;lc[Ya.pah]=sa.a.instance.ia(2105);lc[Ya.e$g]=sa.a.instance.ia(2089);lc[Ya.n8g]=sa.a.instance.ia(2076);lc[Ya.l$g]=sa.a.instance.ia(1347);lc[Ya.R7g]=sa.a.instance.ia(1348);
this.cRf!==Ya.S7g&&(lc[Ya.T7g]=Ya.ALPHA,lc[Ya.ALPHA]=this.cRf);this.initializeAndShow(Pa,this.AVh,{[Ya.z9g]:Ya.N8g,[Ya.o8g]:lc})}jdf(Pa,lc){lc=lc[Ya.W3c];1===Pa&&this.ecg(Ba.a.Wha(lc));this.kdf&&this.kdf(1===Pa,1===Pa?lc:null)}ecg(Pa){this.Jl||(this.Jl=W.a.Zg(N.Kd));Pa=ea.a.mM(Ba.a.FO(Pa,!1));this.Jl.EUc(Pa.r,Pa.g,Pa.b,F.a.bac)}}Ya.t$g="initColor";Ya.z9g="id";Ya.N8g="ColorPickerDialog";Ya.o8g="bodyControls";Ya.W3c="selectedColorText";Ya.o$g="hueAriaLabel";Ya.tbh="transparencyAriaLabel";Ya.Sah="svAriaLabel";
Ya.cac="Use left & right arrows keys to change values in color picker & hue slider";Ya.ALPHA="alpha";Ya.s3c="alphaValue";Ya.Q7g="alphaAriaLabel";Ya.T7g="alphaSliderType";Ya.S7g=-1;Ya.S$g=100;Ya.pah="redLabel";Ya.n8g="blueLabel";Ya.e$g="greenLabel";Ya.l$g="hexLabel";Ya.R7g="alphaLabel";Object(w.a)(Ya,"MoreColorsDialog",Ea.a,[]);var bb=a(7),ra=a(600),Da=a(61);class oa extends Ya{constructor(Pa,lc,Gc,Cd,Qd){super(Pa,Cd,Qd);this.commandName=null;this.GTf=!1;this.command=lc;this.Ah=Gc;this.r8i=Qd}Im(){super.Im();
this.commandName=Da.b().kp(this.Ah.command);l.ULS.sendTraceTag(545051016,0,50,`More Colors:: Dialog Opened From Entry Point: ${this.commandName}, Command SourceUILocation: ${this.Ah.lk}`)}jdf(Pa,lc){if(1===Pa)if(Pa=this.$.qh.Vl("UserAction",this.commandName),Pa.start(),ra.a(Pa),lc)if(Ya.W3c in lc){var Gc=lc[Ya.W3c];if(Pa=Ba.a.Wha(Gc)){Gc=new K.a(this.command,this.Ah.method,this.Ah.mode,this.Ah.lk,this.Ah.tabName?this.Ah.tabName:1378078823===this.command||-400966242===this.command?bb.a.oNa:bb.a.lS);
var Cd={};Cd.Color=Pa;Cd.UILocation=this.Ah.lk;Ya.s3c in lc&&(this.r8i!==lc[Ya.s3c]&&(this.GTf=!0),Cd.Alpha=(lc[Ya.s3c]/Ya.S$g).toString(),l.ULS.sendTraceTag(508822752,0,50,"Alpha Value selected from the MoreColors Dialog."));this.$.Ma.dh(Gc,Cd);this.$.jm();this.ecg(Pa);lc={["Command"]:this.commandName,["Location"]:this.Ah.lk};lc.AlphaApplied=this.GTf.toString();fa.b(this.$).lj(I.a.MEj,lc,null,!0)}else this.hide(),l.ULS.sendTraceTag(537155360,0,10,`Color picker dialog did not return the color in expected format RRGGBB. Color returned: ${Gc}, Command: ${this.commandName}`)}else this.hide(),
l.ULS.sendTraceTag(537155361,0,10,`Dictionary does not contain color, Command: ${this.commandName}`);else this.hide(),l.ULS.sendTraceTag(537155362,0,10,`Dictionary is null Command: ${this.commandName}`)}}Object(w.a)(oa,"MoreColorsRibbonDialog",Ya,[]);var Ha=a(62);Object(W.b)(N.Kd,{yk:"singleton"})(Pa=>No(function*(){const lc=yield W.a.resolve(N.Lb,Pa),Gc=(yield W.a.resolve(N.Ve,Pa)).c4f();return new ka(lc,Gc)}));class ka{constructor(Pa,lc){this.GSe="00FFFF";this.HSe="0000FF";this.ayg="00FFFF";this.byg=
"BF7000";this.J4a=null;this.OFf=!1;this.hOe=null;this.Mw=C.EwaSettings.Bn("MoreColorsHelper");this.mud=()=>{var Gc;null===(Gc=this.rkd)||void 0===Gc?void 0:Gc.abort()};this.bMf=Gc=>{Gc&&Gc.key&&(1===Gc.key.length||"Backspace"===Gc.key||"Delete"===Gc.key||"Enter"===Gc.key?(Gc.preventDefault(),Gc.stopImmediatePropagation()):this.mud())};this.AQj=Gc=>{if(!za.a(Gc)){Gc=Gc.Result;this.J4a=new Ta(10);for(let Qd=Gc.length-1;0<=Qd;Qd--){var Cd=Gc[Qd];Cd=new V(Cd.Red,Cd.Green,Cd.Blue,Cd.Alpha);this.J4a.add(Cd.toString(),
Cd)}this.Zrg();l.ULS.sendTraceTag(537155395,0,50,"MoreColorsHelper.OnGetMRUColorsSuccessCallback : Successfully fetched Recent colors ")}};this.zQj=()=>{l.ULS.sendTraceTag(537155394,0,50,"MoreColorsHelper.OnGetMRUColorsFailureCallback - Webservice call failed")};this.SI=()=>{this.Svc()};this.Pq=()=>{this.Svc()};this.$=Pa;this.oXb=lc;this.Mw?this.$.ea.An?this.Pq():this.$.ea.Bw(this.Pq):this.$.ea.Ul?this.Svc():C.EwaSettings.fl()?this.$.ea.Jq(this.SI):this.$.ea.Uq(this.SI)}get mXb(){return this.hOe}get K4a(){return this.GSe}set K4a(Pa){this.GSe=
Pa}get Msb(){return this.HSe}set Msb(Pa){this.HSe=Pa}get uRc(){return this.ayg}set uRc(Pa){this.ayg=Pa}get vRc(){return this.byg}set vRc(Pa){this.byg=Pa}oob(Pa,lc,Gc,Cd){Cd=void 0===Cd?-1:Cd;return this.oXb?B.TaskExtensions.Ua(this.oXb,()=>{(new oa(this.$,Pa,lc,Gc,Cd)).Im()},this.$.xa):null}launchEyedropper(Pa,lc,Gc){const Cd=window.EyeDropper,Qd=new Cd;if(!Cd||!Qd||!(null!=Gc||Pa&&lc))return J.Task.Va(!1);let ge=null;if(!Gc)switch(Pa){case 1188510340:ge=1650812936;break;case -1828502776:ge=1970784898;
break;case -1252156667:ge=1378078823;break;case -2063061844:ge=-400966242;break;case -260488795:ge=-236759591;break;case -605730035:ge=467002767;break;case -984702347:ge=409031041;break;default:return l.ULS.shipAssertTag(508063765,0,!1,`MoreColorsHelper.launchEyedropper: Invalid eyedropper command ${Pa}`),J.Task.Va(!1)}this.rkd=new AbortController;const ye=lc?Da.b().kp(lc.command):"EyedropperConditionalFormatting";Qd.open({signal:this.rkd.signal}).then($e=>{var qf=this.$.qh.Vl("UserAction",ye);qf.start();
ra.a(qf);qf=Ba.a.Wha($e.sRGBHex);if(!qf)return l.ULS.shipAssertTag(508065669,0,!1,"MoreColorsHelper.launchEyedropper: Failed to return the color in expected format BBGGRR."),J.Task.Va(!1);null!=Gc&&C.EwaSettings.isChangeGateEnabled("OfficeVSO:8572137_Eyedropper_Conditional_Formatting")?(l.ULS.sendTraceTag(507774978,0,50,"MoreColorsHelper.launchEyedropper: Eyedropper is used for Conditional Formatting."),Gc($e.sRGBHex?!0:!1,$e.sRGBHex.substring(1))):($e=new K.a(ge,lc.method,lc.mode,lc.lk,lc.tabName),
this.$.Ma.dh($e,{["Color"]:qf,["UILocation"]:lc.lk}),this.$.jm());$e=ea.a.mM(Ba.a.FO(qf,!1));null!=$e&&this.EUc($e.r,$e.g,$e.b,F.a.bac);$e=ge?{["Command"]:Da.b().kp(lc.command),["Location"]:lc.lk}:{["IsCommand"]:!1,["Location"]:12};fa.b(this.$).lj(I.a.isi,$e,null,!0);return J.Task.Va(!0)}).catch($e=>{l.ULS.sendTraceTag(508065668,0,10,"MoreColorsHelper.launchEyedropper: Failed to apply eyedropper color. Exception: {0}",$e.toString());return J.Task.Va(!1)}).finally(()=>{window.removeEventListener("blur",
this.mud);window.removeEventListener("keydown",this.bMf,!0);this.rkd=null});window.addEventListener("blur",this.mud);window.addEventListener("keydown",this.bMf,!0);return J.Task.Va(!0)}Dtj(Pa,lc){var Gc=void 0;Gc=void 0===Gc?-1:Gc;lc=void 0===lc?null:lc;this.oXb&&B.TaskExtensions.Ua(this.oXb,()=>{(new Ya(this.$,Pa,Gc,lc)).Im()},this.$.xa)}kSi(Pa){let lc=null;switch(Pa){case "QueryRecentFillColor":lc=this.K4a;break;case "QueryRecentFontColor":lc=this.Msb;break;case "QueryRecentShapesFillColor":lc=
this.uRc;break;case "QueryRecentShapesOutlineColor":lc=this.vRc}return lc?Q.a.bkb(lc):null}dispose(){this.oXb=null;this.$&&(this.Mw?this.$.ea.qB(this.Pq):C.EwaSettings.fl()||this.$.ea.dv(this.SI))}Svc(){if(this.$.isEditMode)if(this.J4a)this.Zrg();else{this.OFf&&l.ULS.sendTraceTag(575939106,0,15,"MoreColorsHelper.FetchMRUColors : Recent Colors not shown since data not available from GetMRUColors operation");var Pa=this.$.pa.ta;this.$.userOperationManager.enqueueOperation(new Y.a(1009,0,(lc,Gc,Cd)=>
{lc=xa.c.call(null,lc,this.AQj);Gc=xa.b.call(null,Gc,this.zQj);const Qd=Pa.Za(1,null);return Ha.h(Pa,"GetMRUColors",Qd,lc,Gc,Cd,null,4)},80),null);this.OFf=!0}}Zrg(){var Pa=this.J4a.getItems();if(Pa){this.hOe=new U.a;for(const lc of Pa)Pa=lc,Pa=new ea.a(Pa.red,Pa.green,Pa.blue),this.mXb.add(Ba.a.lJ(Pa))}}EUc(Pa,lc,Gc,Cd){this.J4a||(this.J4a=new Ta(10));const Qd=new V(Pa,lc,Gc,Cd);this.J4a.add(Qd.toString(),Qd);this.saveMRUColor(null,Pa,lc,Gc,Cd)}Oza(Pa,lc,Gc){(Pa||this.$.isEditMode)&&this.bQg(Pa.SqmControlId)&&
(Pa=ea.a.mM(Ba.a.FO(lc,!1)))&&(this.EUc(Pa.r,Pa.g,Pa.b,F.a.bac),Gc={["Command"]:Da.b().kp(Gc.command),["Location"]:R.a[Gc.lk],["InputMethod"]:O.a[Gc.method]},fa.b(this.$).lj(I.a.Oza,Gc,null,!0))}bQg(Pa){return!!Pa&&Pa.startsWith("RecentColorPicker")}saveMRUColor(Pa,lc,Gc,Cd,Qd){return P.a(this.$.userOperationManager,(ge,ye,$e)=>{var qf=this.$.pa.ta;ge=xa.c(ge,ka.$Vj());ye=xa.b(ye,ka.ZVj());const h=qf.Za(9,null);h.bRed=lc;h.bGreen=Gc;h.bBlue=Cd;h.bAlpha=Qd;return Ha.h(qf,"SaveMRUColor",h,ge,ye,$e,
null,0)},ge=>new Y.a(1008,0,ge,C.EwaSettings.isChangeGateEnabled("OfficeVSO:8546775_SaveMRUColor_NonBlockingOperation")?64:null),Pa)}static $Vj(){return Pa=>{Fa.a.Jk(Pa.Errors)?l.ULS.sendTraceTag(537155393,0,10,"MoreColorsHelper.OnSaveMRUColorFailure - Webservice call failed with errors"):l.ULS.sendTraceTag(537155392,0,50,"MoreColorsHelper.OnSaveMRUColorSuccess - Successfully saved color to workbook")}}static ZVj(){return()=>{l.ULS.sendTraceTag(537155363,0,10,"MoreColorsHelper.OnSaveMRUColorFailure - Webservice call failed.")}}}
Object(w.a)(ka,"MoreColorsHelper",null,[861,2]);var wa=a(42);Object(W.b)(N.ae)(()=>wa.a.instance.resolve("Common.App.OAuth.IOAuthManager"));var Za=a(2),ab=a(1033);let db=class{constructor(Pa){this.$La=Pa}JD(Pa,lc){return this.$La?this.$La.JD(Pa,lc).then(Gc=>{Gc.IsSuccess||l.ULS.sendTraceTag(51401292,0,15,"Error retrieving auth token. Message: "+Gc.ErrorMessage+" Error code: "+Gc.ErrorCode+" App name: "+Pa);return Object(Za.a)(new ab.a,{IsSuccess:Gc.IsSuccess,Token:Gc.Token,ErrorCode:Gc.ErrorCode,
ErrorMessage:Gc.ErrorMessage})}):(l.ULS.sendTraceTag(537154971,0,10,"Oauth manager is null"),Promise.resolve(Object(Za.a)(new ab.a,{IsSuccess:!1,Token:null,ErrorCode:"FailedToResolve",ErrorMessage:"Failed to resolve IOAuthManager from the container."})))}D_a(){return this.$La?this.$La.D_a():null}};db=Object(e.__decorate)([Object(W.d)(N.be),Object(e.__param)(0,Object(N.ae)())],db);Object(w.a)(db,"OAuthManagerWrapper",null,[858]);var mb=a(482),Ia=a(6),pa=a(424),lb=a(285),ha=a(704);class ua{constructor(){this.Alt=
this.DisplayColor=this.Color=null;this.Disabled=!1}}Object(w.a)(ua,"ColorCellProps",null,[]);var fb=a(353),Ka=a(19),La=a(59),ib=a(242),Yb=a(158),Wc=a(241),Qc=a(332),Wb=a(13),Jc=a(390),ma=a(27),Hc=a(24);class Kb{constructor(Pa){this.Z5c=null;this.$=Pa;this.grid=Hc.f(this.$)}get borderFormatManager(){this.Z5c||(this.Z5c=this.$.ka.Ug(296));return this.Z5c}sLi(Pa){var lc=null;switch(Pa){case 467002767:lc={};this.$.Mq(lc);lc=Object(Yb.a)(Jc.a,this.$.sa).SIf(lc.SheetName,!0);break;case -236759591:lc=this.BDi();
break;case 1970784898:lc=this.rJd(0);break;case 1650812936:case 1378078823:lc=this.rJd(1);break;case -400966242:lc=this.getShapeOutlineColor();break;case 1597684571:C.EwaSettings.isChangeGateEnabled("OfficeVSO:8495239_persistChartColorPicker")&&this.grid.ha.$e&&this.grid.ha.$e.yh&&(Pa=this.grid.ha.$e.yh.floatingObject,0===Pa.type&&Pa.Ki&&(lc=this.rJd(1)));break;case 409031041:C.EwaSettings.isChangeGateEnabled("OfficeVSO:8495239_persistChartColorPicker")&&(lc=this.WBf(Pa));break;default:l.ULS.sendTraceTag(537154460,
0,50,`ColorHighlighterHelper.GetHighlightColorBasedOnCommand: HighlightColor is not supported for ribbon command '${Pa}'`)}return lc}BDi(){let Pa=null;this.borderFormatManager&&(Pa=this.borderFormatManager.Nea);(Pa="black"===Pa?"000000":Pa)&&(Pa=Q.a.bkb(Pa));return Pa}getShapeOutlineColor(){let Pa=null;if(this.grid.ha.$e&&this.grid.ha.$e.yh){const lc=this.grid.ha.$e.yh.floatingObject;5===lc.type&&lc.nh&&-1!==lc.nh.ShapeOutlineColor&&(Pa=Ba.a.c2(lc.nh.ShapeOutlineColor),Pa=Pa.toUpperCase())}return Pa}WBf(Pa){let lc=
null;if(this.grid.ha.$e&&this.grid.ha.$e.yh){const Gc=this.grid.ha.$e.yh,Cd=Gc.floatingObject;0===Cd.type&&Cd.Ki&&(lc=Gc.EQb(Pa))}return lc}rJd(Pa){let lc=null;if(this.grid.ha.$e&&this.grid.ha.$e.yh){var Gc=this.grid.ha.$e.yh.floatingObject;if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:8495239_persistChartColorPicker")&&0===Gc.type&&Gc.Ki){if(0===Pa||1===Pa)lc=this.WBf(0===Pa?1970784898:1597684571);return lc}5===Gc.type&&Gc.nh?1===Pa&&-1!==Gc.nh.ShapeFillColor?(lc=Ba.a.c2(Gc.nh.ShapeFillColor),
lc=lc.toUpperCase()):l.ULS.sendTraceTag(537154459,0,50,"ColorHighlighterHelper.GetFontOrFillColor: HighlightColor for Font ColorPicker is not supported for Shapes."):l.ULS.sendTraceTag(537154458,0,50,"ColorHighlighterHelper.GetFontOrFillColor: HighlightColor for Font or Fill ColorPicker is not supported for Floating Object other than Shapes.");return lc}Gc=this.grid.Lea("ColorHighlighterHelper.GetFontOrFillColor",this.grid.ha.qa.selectedRanges,1,!0);try{for(Gc.$$rst();Gc.$$mn();){const Cd=Gc.$$cu().cell;
if(!Cd)continue;let Qd="#000000";if(0===Pa){Qd=Cd.color;if(this.grid.isEditing)return this.$Ji();Cd.hasRichText&&(Qd=this.aKi(Cd))}else if(1===Pa){const ge=Cd.backgroundColor;Qd=ma.a.compare(ge,"transparent",!0)&&ge?Cd.backgroundColor:null}if(!lc)lc=Qd;else if(lc!==Qd){lc=null;break}}}finally{Gc&&Gc.dispose()}return lc}$Ji(){var Pa=null,lc=this.grid.sh,Gc=this.grid.cellTextEditBox.formattedText;if(Gc){Pa=Gc.TextRuns;const Cd=ib.a.map(Pa,Qd=>Qd.StartIndex);Gc=Gc.Fonts;lc=lc.$b.caretPosition;lc=Wb.HelperMethods.Nwf(new Wc.a(Cd),
Cd.length,lc,Wb.HelperMethods.$R);Pa=Gc[Pa[lc].FontID].Color}return Pa?Pa.toUpperCase():null}aKi(Pa){Pa=Qc.a(Pa.formattedText.Fonts);if(Qc.e(Pa,32))(Pa=Ba.a.Wha(Ba.a.c2(Pa.FontColor)))&&(Pa="#"+Pa.toUpperCase());else return null;return Pa}}Object(w.a)(Kb,"ColorHighlighterHelper",null,[908]);var pc=a(224),$b=a(25),Ib=a(657);class Zb{constructor(Pa,lc,Gc){this.sRc=this.E7b=this.m_c=null;this.uJg="-1";this.fgj=Ia.AFrameworkApplication.fa.la("IsO365ConsumerHost");this.$=Pa;this.Jl=lc;this.sw=Gc;this.hdf=
new Kb(Pa)}TFf(Pa,lc,Gc,Cd,Qd,ge,ye,$e,qf,h,Z){lc=void 0===lc?null:lc;Gc=void 0===Gc?null:Gc;Cd=void 0===Cd?null:Cd;$e=void 0===$e?null:$e;qf=void 0===qf?null:qf;return this.z_(null!=lc,null!=Gc,null!=Cd,null!=$e,null!=qf,!0,void 0===h?!1:h,Pa,lc,Gc,Cd,void 0===Qd?null:Qd,void 0===ge?null:ge,void 0===ye?null:ye,$e,qf,void 0===Z?null:Z)}eVi(Pa,lc,Gc,Cd,Qd){return this.z_(Pa,lc,Gc,Cd,Qd,!1)}UFf(Pa,lc,Gc,Cd,Qd,ge,ye){const $e=[];Pa=this.TFf(Pa,void 0===lc?null:lc,void 0===Gc?null:Gc,void 0===Cd?null:
Cd,void 0,void 0,void 0,void 0===Qd?null:Qd,void 0===ge?null:ge,!1,void 0===ye?null:ye);for(let qf=0,h=Pa.length;qf<h;qf++)$e.push(pc.r(Pa[qf]));return $e}z_(Pa,lc,Gc,Cd,Qd,ge,ye,$e,qf,h,Z,E,aa,Ja,tb,S,Wa){ye=void 0===ye?!1:ye;$e=void 0===$e?null:$e;qf=void 0===qf?null:qf;h=void 0===h?null:h;Z=void 0===Z?null:Z;E=void 0===E?null:E;aa=void 0===aa?null:aa;Ja=void 0===Ja?null:Ja;tb=void 0===tb?null:tb;S=void 0===S?null:S;Wa=void 0===Wa?null:Wa;l.ULS.shipAssertTag(537154456,0,!ge||null!=$e,"ColorPickerBuilder: must provide value for applyColorCommand if created for ribbon.");
const zb=[];let hc=null,cd=3,ta=null,wb=null,ic=null;this.uii();if(this.$&&this.$.isEditMode&&!this.D4j(Wa))return l.ULS.sendTraceTag(537154455,0,50,`Theme Info not present at the time of ${Wa} menu opening`),zb;ye&&C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.60DF7594-6F61-4C0E-983C-712E11F4F99A",!1)&&$b.a.FU()&&$b.a.dFc()&&(ye=sa.a.instance.ia(2501),zb.push(this.Awa(Zb.Uff,this.hzi(Zb.Uff,ye))));Pa&&(ge&&null==qf?l.ULS.shipAssertTag(537154454,0,!1,"ColorPickerBuilder: must provide automaticColorCommand when addAutomaticSection is true."):
zb.push(this.Awa(Zb.NHh,this.czi(Zb.N6e,qf,Ja,aa))));ge&&null!=$e&&this.hdf&&(wb=ta="-1",hc=this.hdf.sLi($e))&&(l.ULS.sendTraceTag(537154453,0,50,`ColorPickerBuilder: Highlighter color for the command ${$e} is not null .`),hc=Ba.a.Wha(hc),cd=this.LEf(hc),ta=this.LLd(hc,cd,0,!0),wb=this.LLd(hc,cd,1,!1));zb.push(this.Awa(Zb.uVk,this.QGd(Zb.KXg,ta,this.m_c,$e,E,aa),1341));zb.push(this.Awa(Zb.EQk,this.QGd(Zb.DQk,wb,this.E7b,$e,E,aa),1342));this.$&&this.$.isEditMode&&this.Jl&&(this.A4j(),ge&&(ic="-1",
hc&&(ic=this.LLd(hc,cd,2,!0))),this.Jl&&this.Jl.mXb&&0<this.Jl.mXb.count&&zb.push(this.Awa(Zb.cck,this.QGd(Zb.bck,ic,this.sRc,$e,E,aa),1349)));lc&&(ge&&null==h?l.ULS.shipAssertTag(537154452,0,!1,"ColorPickerBuilder: must provide clearColorCommand when addClearColorSection is true."):zb.push(this.Awa(Zb.WGj,this.dzi(Zb.Nbf,h,this.cFi(h),Ja,aa))));!Gc||C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInEditMode",!1)&&this.$.isMobileMode&&this.$.isEditMode||!this.fgj&&!C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ColorPickerHighlightWhenEnabled",
!1)||(ge&&!Z?l.ULS.shipAssertTag(520668946,0,!1,"ColorPickerBuilder: must provide highlightWhenCommand when addHighlightWhenSection is true."):zb.push(this.Awa(Zb.e6i,this.Mzi(Zb.rPf,Z))));Cd&&(ge&&null==tb?l.ULS.shipAssertTag(537154451,0,!1,"ColorPickerBuilder: must provide moreColorsCommand when addMoreColorsSection is true."):zb.push(this.Awa(Zb.NEj,this.mAi(Zb.S$f,tb,this.cOi(tb)))));$b.a.sK()&&Qd&&zb.push(this.Awa(Zb.XDd,this.yzi(Zb.XDd,S)));return zb}LLd(Pa,lc,Gc,Cd){3===lc&&(lc=this.LEf(Pa));
return 0===Gc&&lc===Gc?this.uJg.toLowerCase():lc===Gc?Cd?Pa.toLowerCase():Pa:"-1"}LEf(Pa){if(!Pa)return 3;const lc=Pa.toLowerCase();return this.m_c&&this.$pj(lc,this.m_c)?0:this.E7b&&this.zUf(Pa,this.E7b)?1:this.sRc&&this.zUf(lc,this.sRc)?2:3}Awa(Pa,lc,Gc){Gc=void 0===Gc?null:Gc;Pa=Object(Za.a)(new pa.a,{Id:Pa,Title:null!=Gc?sa.a.instance.ia(Gc):"",ControlList:[],ControlsId:Pa+".Controls"});Pa.ControlList.push(lc);return Pa}dzi(Pa,lc,Gc,Cd,Qd){return this.Kzf(Pa,lc,Gc,Ka.a.csf,"transparent",void 0===
Cd?null:Cd,void 0===Qd?null:Qd)}Mzi(Pa,lc){return Object(Za.a)(new lb.a,{Command:null!=lc?lc.toString():null,LabelText:sa.a.instance.ia(1433),Id:Pa,ExternalId:this.Dma(Pa,lc),ExternalImageId:"ConditionalFormatting_20"})}czi(Pa,lc,Gc,Cd){return this.Kzf(Pa,lc,542,Ka.a.bsf,"000000",void 0===Gc?null:Gc,void 0===Cd?null:Cd)}Kzf(Pa,lc,Gc,Cd,Qd,ge,ye){ge=void 0===ge?null:ge;ye=void 0===ye?null:ye;return Object(Za.a)(new lb.a,{Command:null!=lc?lc.toString():null,CommandPreviewId:null!=ge?ge.toString():null,
CommandRevertId:null!=ye?ye.toString():null,MenuItemsStatefulData:this.JNi(Pa,lc,Qd),LabelText:sa.a.instance.ia(Gc),Id:Pa,ExternalId:this.Dma(Pa,lc),Image16by16:La.a.$m(1),Image16by16Class:Cd})}JNi(Pa,lc,Gc){const Cd={};Pa=this.Dma(Pa,lc);Cd[Pa]={};Cd[Pa].iconColor=Gc;return Cd}zUf(Pa,lc){for(let Gc=0;Gc<lc.length;Gc++)if(Pa===lc[Gc].Color)return!0;return!1}noj(Pa,lc){Pa=Ba.a.tu(Pa);lc=Ba.a.tu(lc);return 1>=Math.abs(Pa.r-lc.r)&&1>=Math.abs(Pa.g-lc.g)&&1>=Math.abs(Pa.b-lc.b)?!0:!1}$pj(Pa,lc){for(let Gc=
0;Gc<lc.length;Gc++){const Cd=lc[Gc].Color;if(this.noj(Pa,Cd))return this.uJg=Cd.toLowerCase(),!0}return!1}QGd(Pa,lc,Gc,Cd,Qd,ge){Qd=void 0===Qd?null:Qd;ge=void 0===ge?null:ge;return Object(Za.a)(new ha.a,{McuLayout:!0,Command:null!=Cd?Cd.toString():null,CommandPreviewId:null!=Qd?Qd.toString():null,CommandRevertId:null!=ge?ge.toString():null,Width:10,Id:`${Pa}.ColorPicker`,SelectedColorId:lc,Colors:Gc,Stateful:!0,ExternalId:this.Dma(Pa,Cd),McuExternalId:`${this.Dma(Pa,Cd)}.MCU`})}Dma(Pa,lc){return`${Pa}.${null!=
lc?lc.toString():""}`}PGd(...Pa){const lc=[];for(let Gc=0,Cd=Pa.length;Gc<Cd;Gc+=2)lc.push(Object(Za.a)(new ua,{Color:Pa[Gc],DisplayColor:Ba.a.lJ(ea.a.mM(parseInt(String("0x"+Pa[Gc]),16))),Alt:Object(fb.a)(String,Pa[Gc+1])&&this.$?Pa[Gc+1]:sa.a.instance.ia(Pa[Gc+1])}));return lc}mAi(Pa,lc,Gc){const Cd=Ka.a.rsf;Pa=Object(Za.a)(new lb.a,{Command:null!=lc?lc.toString():null,LabelText:sa.a.instance.ia(Gc),Id:Pa,ExternalId:this.Dma(Pa,lc),Image16by16:La.a.$m(1),Image16by16Class:Cd});Pa.ShouldTakeFocus=
!1;return Pa}XKh(){const Pa=[2502,2503,2504,2505].map(lc=>{lc=sa.a.instance.ia(lc);return Object(Za.a)(new lb.a,{Command:(-1997160483).toString(),LabelText:lc,Id:lc,MenuItemId:lc,ExternalId:this.Dma(lc,-1997160483)})});return Object(Za.a)(new pa.a,{ControlList:Pa})}uKh(){var Pa=sa.a.instance.ia(2506);Pa=[Object(Za.a)(new lb.a,{Command:(1485761473).toString(),LabelText:Pa,Id:Zb.VFh,ExternalId:this.Dma(Pa,1485761473),ExternalImageId:"ChatSparkle_20"})];return Object(Za.a)(new pa.a,{ControlList:Pa})}hzi(Pa,
lc){const Gc=Object(Za.a)(new mb.a,{MenuSectionList:[],UpdateDynamically:!0});Gc.MenuSectionList.push(this.XKh());Gc.MenuSectionList.push(this.uKh());return Object(Za.a)(new Ib.a,{Command:(1485761473).toString(),LabelText:lc,ImageIsVisible:!0,Id:Pa,ExternalId:this.Dma(Pa,1485761473),ExternalImageId:"M365Excel_20",Menu:Gc})}yzi(Pa,lc){Pa=Object(Za.a)(new lb.a,{Command:null!=lc?lc.toString():null,LabelText:sa.a.instance.ia(2401),Id:Pa,ExternalId:this.Dma(Pa,lc),Image16by16:La.a.$m(1),ExternalImageId:"EyedropperFillColor_20"});
Pa.ShouldTakeFocus=!1;return Pa}uii(){this.E7b||(this.E7b=this.PGd("0000C0",1355,"0000FF",1352,"00C0FF",1354,"00FFFF",1356,"50D092",1357,"50B000",1358,"F0B000",1359,"C07000",1351,"602000",1350,"A03070",1353))}A4j(){this.Jl.Svc();if(this.Jl.mXb){var Pa=this.Jl.mXb;const lc=[];for(const Gc of Pa)Pa=Ba.a.Wha(Gc.substr(1)),lc.push(Pa,Gc);this.sRc=this.PGd(...lc)}}D4j(Pa){this.sw.WHa(Pa);if(this.sw.Lwb&&this.sw.LXg&&!this.sw.k0f){Pa=this.sw.Lwb;const lc=this.sw.LXg,Gc=[];for(let Cd=0;Cd<Pa.count;Cd++)Gc.push(Pa.ma(Cd),
lc.ma(Cd));this.m_c=this.PGd(...Gc);return!0}return!1}cOi(Pa){switch(Pa){case -458147525:Pa=1344;break;case 1610379174:Pa=1345;break;default:Pa=1343}return Pa}cFi(Pa){switch(Pa){case 1549407384:Pa=541;break;case -1744769642:Pa=539;break;default:Pa=540}return Pa}}Zb.WGj="NoColor";Zb.NHh="Automatic";Zb.uVk="ThemeColors";Zb.EQk="StandardColors";Zb.cck="RecentColors";Zb.Nbf="ClearColor";Zb.e6i="HighlightWhen";Zb.rPf="HighlightWhen";Zb.N6e="AutomaticColor";Zb.KXg="ThemeColorPicker";Zb.DQk="StandardColorPicker";
Zb.NEj="MoreColors";Zb.S$f="MoreColors";Zb.bck="RecentColorPicker";Zb.XDd="Eyedropper";Zb.Uff="CopilotSuggestions";Zb.VFh="AskCopilot";Object(w.a)(Zb,"ColorPickerBuilder",null,[]);class Eb{constructor(Pa,lc,Gc,Cd){this.$=Pa;this.lB=lc;this.Jl=Gc;this.sw=Cd}getColorPickerButtonMenuProps(Pa){Pa=this.lB.fJf(Pa.automaticColor,Pa.clearColor,Pa.highlightWhen,Pa.moreColors,Pa.eyedropper);return{sections:this.cSi(Pa)}}showMoreColorsDialog(Pa,lc){this.Jl.Dtj(Pa,lc)}onColorUsed(Pa){Pa=ea.a.mM(Ba.a.FO(Ba.a.Wha(Pa),
!1));this.Jl.EUc(Pa.r,Pa.g,Pa.b,F.a.bac)}getThemeColor(Pa){const lc=Ba.a.Wha(Pa);let Gc,Cd;return(()=>{let Qd=this.sw.getThemeColor(lc);({themeIndex:Gc,sPa:Cd}=Qd);return Qd})().returnValue?{index:Gc,row:Cd}:(l.ULS.shipAssertTag(538514630,0,!1,"ColorPickerButtonController: invalid theme color in GetThemeColor."),null)}launchEyedropper(Pa){C.EwaSettings.isChangeGateEnabled("OfficeVSO:8572137_Eyedropper_Conditional_Formatting")&&this.Jl.launchEyedropper(null,null,Pa)}cSi(Pa){const lc=[];for(let Cd=
0;Cd<Pa.length;Cd++){var Gc=Object(Yb.a)(pa.a,Pa[Cd]);const Qd={type:0};Qd.title=Gc.Title;const ge=Object(Yb.a)(ha.a,Gc.ControlList[0]);ge?(Qd.type=1,Qd.colorSwatchProps=this.pFi(ge),lc.push(Qd)):(Gc=Object(Yb.a)(lb.a,Gc.ControlList[0]))&&null!=this.lCf(Gc.Id)?(Qd.type=2,Qd.buttonProps={type:this.lCf(Gc.Id),label:Gc.LabelText},lc.push(Qd)):l.ULS.shipAssertTag(542200588,0,!1,"ColorPickerButtonController: Unknown color menu control type")}return lc}pFi(Pa){const lc=Pa.Colors;Pa={colors:Array(Pa.Colors.length),
notifyOnColorUsed:this.Jl.bQg(Pa.ExternalId),isThemeColorSection:!!Pa.ExternalId&&Pa.ExternalId.includes(Zb.KXg)};for(let Gc=0;Gc<lc.length;Gc++)Pa.colors[Gc]={id:lc[Gc].DisplayColor,color:lc[Gc].DisplayColor,label:lc[Gc].Alt,index:Gc};return Pa}lCf(Pa){switch(Pa){case Zb.S$f:return 1;case Zb.Nbf:return 2;case Zb.N6e:return 3;case Zb.rPf:return 4;case Zb.XDd:return 5}return null}}Object(w.a)(Eb,"ColorPickerButtonController",null,[]);Object(W.b)(N.Be,{yk:"singleton"})(Pa=>No(function*(){const lc=yield W.a.resolve(N.Lb,
Pa),Gc=yield W.a.resolve(N.Kd,Pa),Cd=yield W.a.resolve(N.og,Pa);return new ob(lc,Gc,Cd)}));class ob{constructor(Pa,lc,Gc){this.wy=this.Qq=null;this.$=Pa;this.Jl=lc;this.NMh();this.MMh();this.sw=Gc;this.opc=new Zb(Pa,lc,Gc)}NMh(){this.Qq={};this.Qq.style0=1535;this.Qq.style1=1536;this.Qq.style2=1537;this.Qq.style3=1538;this.Qq.style4=1539;this.Qq.style5=1540;this.Qq.style6=1541;this.Qq.style7=1542;this.Qq.style8=1543;this.Qq.style9=1544;this.Qq.style10=1545;this.Qq.style11=1546;this.Qq.style12=1547;
this.Qq.style13=1548;this.Qq.style14=1549;this.Qq.style15=1550;this.Qq.style16=1551;this.Qq.style17=1552;this.Qq.style18=1553;this.Qq.style19=1554;this.Qq.style20=1555;this.Qq.style21=1556;this.Qq.style22=1557;this.Qq.style23=1558;this.Qq.style24=1559;this.Qq.style25=1560;this.Qq.style26=1561;this.Qq.style27=1562;this.Qq.style28=1563;this.Qq.style29=1564;this.Qq.style30=1565;this.Qq.style31=1566;this.Qq.style32=1567;this.Qq.style33=1568;this.Qq.style34=1569;this.Qq.style35=1570;this.Qq.style36=1571;
this.Qq.style37=1572;this.Qq.style38=1573;this.Qq.style39=1574;this.Qq.style40=1575;this.Qq.style41=1576}MMh(){this.wy={};this.wy.style0=1507;this.wy.style1=1508;this.wy.style2=1509;this.wy.style3=1510;this.wy.style4=1511;this.wy.style5=1512;this.wy.style6=1513;this.wy.style7=1514;this.wy.style8=1515;this.wy.style9=1516;this.wy.style10=1517;this.wy.style11=1518;this.wy.style12=1519;this.wy.style13=1520;this.wy.style14=1521;this.wy.style15=1522;this.wy.style16=1523;this.wy.style17=1524;this.wy.style18=
1525;this.wy.style19=1526;this.wy.style20=1527;this.wy.style21=1528;this.wy.style22=1529;this.wy.style23=1530;this.wy.style24=1531;this.wy.style25=1532;this.wy.style26=1533;this.wy.style27=1534}mCf(Pa){return pc.i(this.opc.UFf(Pa,null,null,null,null,null,null))}cyc(Pa,lc,Gc,Cd,Qd,ge,ye,$e,qf,h,Z){lc=void 0===lc?null:lc;Gc=void 0===Gc?null:Gc;Cd=void 0===Cd?null:Cd;Qd=void 0===Qd?null:Qd;ge=void 0===ge?null:ge;ye=void 0===ye?null:ye;$e=void 0===$e?null:$e;qf=void 0===qf?null:qf;h=void 0===h?!1:h;Z=
void 0===Z?null:Z;return Object(Za.a)(new mb.a,{MenuSectionList:this.opc.TFf(Pa,lc,Gc,Cd,Qd,ge,ye,$e,qf,h,Z),UpdateDynamically:!0})}fJf(Pa,lc,Gc,Cd,Qd){return this.opc.eVi(Pa,lc,Gc,Cd,Qd)}qFi(Pa,lc,Gc,Cd,Qd,ge,ye){return this.opc.UFf(Pa,void 0===lc?null:lc,void 0===Gc?null:Gc,void 0===Cd?null:Cd,void 0===Qd?null:Qd,void 0===ge?null:ge,void 0===ye?null:ye)}kMd(Pa,lc){return(void 0===lc?0:lc)?this.wy[Pa]:this.Qq[Pa]}e1h(){return new Eb(this.$,this,this.Jl,this.sw)}uU(Pa){var lc;const Gc=null===(lc=
this.$.shortcutKeyManager)||void 0===lc?void 0:lc.uk(Pa);return Gc?Gc.substring(1,Gc.length-1):null}}Object(w.a)(ob,"PopulateDynamicHelper",null,[860]);var Na=a(39),nb=a(1105);class Hb{constructor(Pa,lc,Gc,Cd,Qd,ge,ye,$e,qf,h){this.J4e=lc;this.M6e=void 0===Gc?null:Gc;this.Mbf=void 0===Qd?null:Qd;this.qPf=void 0===ge?null:ge;this.R$f=void 0===$e?null:$e;this.lB=Pa;this.Nvf=void 0===qf?null:qf;this.menuId=void 0===h?null:h}L9(){let Pa="";const lc=this.lB.qFi(this.J4e,this.M6e,this.Mbf,this.qPf,this.R$f,
this.Nvf,this.menuId);for(const Gc of lc)Pa+=Gc;return Pa}ML(){return this.lB.cyc(this.J4e,this.M6e,this.Mbf,this.qPf,void 0,void 0,void 0,this.R$f,this.Nvf,!1,this.menuId)}}Object(w.a)(Hb,"RibbonColorPicker",null,[238]);var na=a(664);class Gb{constructor(Pa,lc){this._id=Pa;this.AL=void 0===lc?"":lc}get id(){return this._id}get text(){return this.AL}get label(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Label property");}set label(Pa){throw Error.notImplemented("RibbonLabel doesn't have set implementation for the Label property");
}get alt(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Alt property");}get disabled(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Disabled property");}L9(){return`<Label id="${this._id}" LabelText="${this.AL}" />`}P1(){throw Error.notImplemented("RibbonLabel doesn't have SetImage implementation ");}z5b(){throw Error.notImplemented("RibbonLabel doesn't have SetCustomizedImage implementation ");}L1(){throw Error.notImplemented("RibbonLabel doesn't have SetAlt implementation ");
}Loc(){throw Error.notImplemented("RibbonLabel doesn't have ClearImage implementation ");}dua(){return Object(Za.a)(new na.a,{Id:this.id,LabelText:this.text})}}Object(w.a)(Gb,"RibbonLabel",null,[896,237,238]);class Xa{constructor(Pa){this.Glh=[];this.id=Pa}get vh(){return this.Glh}L9(){return pc.q(this.ML())}ML(){const Pa=Object(Za.a)(new mb.a,{Id:this.id,UpdateDynamically:!0,MenuSectionList:[]});for(const lc of this.vh)Object(fb.a)(Hb,lc)?Pa.MenuSectionList.push(...Object(Yb.a)(Hb,lc).ML().MenuSectionList):
Pa.MenuSectionList.push(lc.gnc());return Pa}}Object(w.a)(Xa,"RibbonMenu",null,[874,238]);class Jb{constructor(){this.title=null;this.v8=[];this.iz="Menu16";this.pYg=this.FSg=this.GSg=!0}get buttons(){return this.v8}L9(){return pc.r(this.gnc())}gnc(){const Pa=Object(Za.a)(new pa.a,{ControlList:[]});if(1===this.buttons.length&&Object(fb.a)(875,this.buttons[0]))Pa.ControlList.push(this.buttons[0].fnc());else{let Gc="";for(let Cd=0;Cd<this.buttons.length;Cd++){var lc=Object(Yb.a)(237,this.buttons[Cd]);
lc&&(lc=lc.dua(),Pa.ControlList.push(lc),Gc+=lc.Id)}Pa.ControlsId=Gc+".Controls"}Pa.Title=this.title;Pa.DisplayMode=this.iz;Pa.ShowMenuSectionTitleIcon=this.GSg;Pa.ShowMenuSectionTitleBackground=this.FSg;Pa.MenuSectionTitleFocusable=this.pYg;return Pa}}Object(w.a)(Jb,"RibbonMenuSection",null,[418,238]);class qb{constructor(Pa,lc,Gc,Cd,Qd,ge,ye,$e,qf,h,Z,E,aa){aa=void 0===aa?null:aa;this.id=Pa;this.command=Gc;this.esg=Cd;this.populateOnlyOnce=Qd;this.u4a=ge;this.x4j=ye;this.alt=$e;this.nlc=qf;this.width=
h;this.ZCh=Z;this.autoComplete=E;this.RDa=new Xa(lc);this.F5e=aa;Cd&&ye&&(Pa=new Jb,Pa.iz="MenuLoading",lc=new Gb(lc+"LoadingLabel"),Pa.buttons.push(lc),this.menu.vh.push(Pa))}L9(){return this.SKh()}get menu(){return this.RDa}SKh(){let Pa=pc.d(this.id,this.command,this.esg,this.populateOnlyOnce,this.u4a,this.x4j,this.alt,this.nlc,this.width);const lc=Pa.indexOf(" />");Pa=Pa.substring(0,lc);Pa+=` ${"AllowDefaultContent"}="${this.ZCh.toString()}"`;Pa+=` ${"AutoComplete"}="${this.autoComplete?"true":
"false"}"`;this.F5e&&(Pa+=` ${"ArrowImgId"}="${this.F5e}"`);Pa=Pa+">"+this.menu.L9();return Pa+"</ComboBox>"}}Object(w.a)(qb,"RibbonComboBox",null,[897,238]);var Db=a(619),gb=a(1106);class ya extends gb.a{constructor(Pa,lc,Gc,Cd,Qd,ge,ye,$e,qf,h,Z,E,aa){E=void 0===E?null:E;aa=void 0===aa?null:aa;super(Pa,lc,Gc,Qd,ge,ye,$e,Z,0);this.aBb=null;this.Cra=0===qf?null:sa.a.instance.ia(qf);this.Bdd=h;this.Lfd=Cd;this.Uph=E;this.Ju=aa}get description(){return this.Cra}get WOb(){return this.aBb}get menuItemId(){return this.Bdd}get u4a(){return this.Lfd}get styles(){return this.Uph}get data(){return this.Ju}L9(){return pc.n(this.dua())}ime(Pa){this.Cra=
Pa}toString(){this.WOb||(this.aBb=this.L9());return this.WOb}dua(){const Pa=new Db.a;this.cwc(Pa);Pa.MenuItemId=this.menuItemId;Pa.QueryCommand=this.u4a;Pa.Description=this.description;Pa.Styles=this.styles;Pa.Data=this.data;return Pa}}Object(w.a)(ya,"RibbonComboBoxItem",gb.a,[236,237,238]);class Aa extends gb.a{constructor(Pa,lc,Gc,Cd,Qd,ge,ye,$e,qf){super(Pa,Gc,Cd,Qd,ge,ye,$e,!1,0);this.populateOnlyOnce=!1;this.BWb=this.menuCloseCommand=this.menuOpenCommand=this.vD=null;this.RDa=new Xa(lc);this.GQf=
!0;this.Hid=qf}get menu(){return this.RDa}L9(){return pc.o(this.dua())}dua(){const Pa=new Ib.a;this.cwc(Pa);Pa.PopulateOnlyOnce=this.populateOnlyOnce;Pa.MenuCloseCommand=null==this.menuCloseCommand?null:this.menuCloseCommand.toString();Pa.MenuOpenCommand=null==this.menuOpenCommand?null:this.menuOpenCommand.toString();Pa.PopulateQueryCommand=this.vD;Pa.KeyTip=this.BWb;Pa.Menu=this.menu.ML();Pa.ImageIsVisible=this.GQf;Pa.ExternalImageId=this.Hid;return Pa}}Object(w.a)(Aa,"RibbonFlyoutAnchor",gb.a,[419,
237,238]);var sb=a(1187),nc=a(663);class Bb{constructor(){this.$ib=[];this.id=null;this.width=0;this.title=this.ova=null}L9(){return pc.p(this.fnc())}QC(Pa,lc,Gc,Cd,Qd,ge,ye,$e,qf,h,Z){Cd=void 0===Cd?0:Cd;Qd=void 0===Qd?null:Qd;ge=void 0===ge?null:ge;ye=void 0===ye?null:ye;$e=void 0===$e?null:$e;qf=void 0===qf?null:qf;h=void 0===h?null:h;Z=(Z=void 0===Z?null:Z)?sa.a.instance.ia(Cd)+Wb.HelperMethods.baf+Z:sa.a.instance.ia(Cd);this.oSf(this.$ib.length,Pa,lc,Gc,0===Cd?qf:Z,Qd,ge,ye,$e,h)}oSf(Pa,lc,Gc,
Cd,Qd,ge,ye,$e,qf,h){ge=void 0===ge?null:ge;ye=void 0===ye?null:ye;$e=void 0===$e?null:$e;qf=void 0===qf?null:qf;h=void 0===h?null:h;(Pa>this.$ib.length||0>Pa)&&Error.argumentOutOfRange("Invalid Index");this.$ib.splice(Pa,0,Object(Za.a)(new sb.a,{Id:lc,Command:Gc.toString(),QueryCommand:null!==Cd&&void 0!==Cd?Cd:null,Alt:Qd,MenuItemId:ge,Icon:ye,Image:$e?La.a.$m($e):null,ImageClass:qf,LabelText:h}))}fnc(Pa){Pa=void 0===Pa?!1:Pa;let lc=null,Gc=null;switch(this.ova){case "Size120by20":lc=this.dIb(120,
20,Pa);Gc=this.bIb(130,30,Pa);break;case "Size90by21":lc=this.dIb(90,21,Pa);Gc=this.bIb(100,33,Pa);break;case "Size24by24With7Options":lc=this.dIb(24,24,Pa);Gc=this.bIb(34,34,Pa);break;case "Size24by24":lc=this.dIb(28,28,Pa);Gc=this.bIb(38,38,Pa);break;case "Size112by64":lc=this.dIb(24,24,Pa),Gc=this.bIb(112,64,Pa)}for(Pa=0;Pa<this.$ib.length;Pa++)this.$ib[Pa].FullIconStyle=lc;return Object(Za.a)(new nc.a,{Id:this.id,ExternalId:this.id,Type:4,Title:this.title,Width:this.width,ElementDimensions:this.ova,
GalleryItems:this.$ib,GalleryStyle:Gc})}dIb(Pa,lc,Gc){const Cd={},Qd={};Qd.width=Pa;Qd.height=lc;Gc&&(Qd.alignSelf="center",Qd.marginBottom="4px");Cd.root=Qd;return Cd}bIb(Pa,lc,Gc){const Cd={},Qd={},ge={};ge.width=Pa;ge.height=lc;Qd.root=ge;Gc&&(Qd.flexContainer={display:"flex",flexDirection:"column",alignItems:"stretch"});Cd.galleryButtonInExpanded=Qd;return Cd}}Object(w.a)(Bb,"RibbonGallery",null,[875,238]);var uc=a(1246),Pc=a(902),wd;let Md=wd=class{constructor(Pa){this.lB=void 0===Pa?null:Pa}get Mzc(){return this.lB}Vv(Pa){return new Xa(void 0===
Pa?null:Pa)}Oh(){return new Jb}Sg(Pa){var lc=Na.a.gj(wd.zeb,Pa.toString());if(lc)return lc;switch(Pa){case 249:return this.Sh(Pa,"ContextMenu.Show.ChartTaskPane",1221897806,Ka.a.ttf,4,983);case 287:return this.Sh(Pa,"ContextMenu.Show.ChartTaskPaneData",1930653487,null,4,890,void 0,void 0,"ChartSourceData_20");case 141:return this.rp(Pa,"DataLabels.None.BoxWhisker",374300079,Ka.a.btf,929,930,1600);case 0:return this.rp(Pa,"DataLabels.None.Column",374300079,Ka.a.atf,929,930,1600);case 1:return this.rp(Pa,
"DataLabels.None.Line",374300079,Ka.a.ctf,929,930,1600);case 2:return this.rp(Pa,"DataLabels.None.Pie",374300079,Ka.a.dtf,929,930,1600);case 3:return this.rp(Pa,"DataLabels.Show.Column",-1809877936,Ka.a.evc,931,932,1601);case 143:return this.rp(Pa,"DataLabels.Show.Funnel",-1809877936,Ka.a.evc,931,934,1601);case 144:return this.rp(Pa,"DataLabels.Show.Treemap",-1809877936,Ka.a.UCd,931,938,1601);case 145:return this.rp(Pa,"DataLabels.Show.Sunburst",-1809877936,Ka.a.TCd,931,934,1601);case 4:return this.rp(Pa,
"DataLabels.Center.Column",-1996266048,Ka.a.evc,933,934,1602);case 5:return this.rp(Pa,"DataLabels.Center.Line",-1996266048,Ka.a.Wsf,933,934,1602);case 6:return this.rp(Pa,"DataLabels.Center.Pie",-1996266048,Ka.a.TCd,933,934,1602);case 7:return this.rp(Pa,"DataLabels.InsideEnd.Column",493396546,Ka.a.Xsf,935,936,1603);case 8:return this.rp(Pa,"DataLabels.InsideEnd.Pie",493396546,Ka.a.Ysf,935,936,1603);case 9:return this.rp(Pa,"DataLabels.InsideBase.Column",1599247052,Ka.a.UCd,937,938,1604);case 10:return this.rp(Pa,
"DataLabels.OutsideEnd.Column",342855531,Ka.a.etf,939,940,1605);case 11:return this.rp(Pa,"DataLabels.OutsideEnd.Pie",342855531,Ka.a.ftf,939,940,1605);case 140:return this.rp(Pa,"DataLabels.Left.BoxWhisker",-472675112,Ka.a.$sf,941,942,1606);case 12:return this.rp(Pa,"DataLabels.Left.Line",-472675112,Ka.a.Zsf,941,942,1606);case 142:return this.rp(Pa,"DataLabels.Right.BoxWhisker",-1774499423,Ka.a.htf,943,944,1607);case 13:return this.rp(Pa,"DataLabels.Right.Line",-1774499423,Ka.a.gtf,943,944,1607);
case 138:return this.rp(Pa,"DataLabels.Above.BoxWhisker",-204160914,Ka.a.Ssf,945,946,1608);case 14:return this.rp(Pa,"DataLabels.Above.Line",-204160914,Ka.a.itf,945,946,1608);case 139:return this.rp(Pa,"DataLabels.Below.BoxWhisker",-87783054,Ka.a.Tsf,947,948,1609);case 15:return this.rp(Pa,"DataLabels.Below.Line",-87783054,Ka.a.Vsf,947,948,1609);case 16:return this.rp(Pa,"DataLabels.BestFit.Pie",1650379138,Ka.a.Usf,949,950,1610);case 17:return this.rp(Pa,"Axes.Horizontal.None",895828731,Ka.a.Hsf,
929,951,1613);case 18:return this.rp(Pa,"Axes.Horizontal.ShowLTR",683614408,Ka.a.RCd,952,953,1614);case 19:return this.rp(Pa,"Axes.Horizontal.NoLabels",-1612014670,Ka.a.Gsf,956,957,1615);case 20:return this.rp(Pa,"Axes.Horizontal.ShowRTL",1259259728,Ka.a.Isf,958,959,1616);case 21:return this.rp(Pa,"Axes.Horizontal.Default",683614408,Ka.a.RCd,954,955,1617);case 22:return this.rp(Pa,"Axes.Horizontal.Thousands",-220179662,Ka.a.Jsf,960,961,1618);case 23:return this.rp(Pa,"Axes.Horizontal.Millions",1534680966,
Ka.a.Fsf,962,963,1619);case 24:return this.rp(Pa,"Axes.Horizontal.Billions",-238895611,Ka.a.Dsf,964,965,1620);case 25:return this.rp(Pa,"Axes.Horizontal.LogScale",-892714755,Ka.a.Esf,966,967,1621);case 26:return this.rp(Pa,"Axes.Vertical.None",2006508979,Ka.a.Osf,929,951,1613);case 27:return this.rp(Pa,"Axes.Vertical.Default",252405382,Ka.a.Qsf,954,955,1617);case 28:return this.rp(Pa,"Axes.Vertical.Thousands",670842692,Ka.a.Rsf,960,961,1618);case 29:return this.rp(Pa,"Axes.Vertical.Millions",-572426128,
Ka.a.Msf,962,963,1619);case 30:return this.rp(Pa,"Axes.Vertical.Billions",-806496391,Ka.a.Ksf,964,965,1620);case 31:return this.rp(Pa,"Axes.Vertical.LogScale",-1700998151,Ka.a.Lsf,966,967,1621);case 32:return this.rp(Pa,"Axes.Vertical.NoLabels",2104548628,Ka.a.Nsf,956,957,1615);case 33:return this.rp(Pa,"Axes.Vertical.ShowRTL",1717508862,Ka.a.Psf,958,959,1616);case 34:return this.rp(Pa,"Gridlines.Horizontal.None",80515665,Ka.a.ntf,929,970,1624);case 35:return this.rp(Pa,"Gridlines.Horizontal.Major",
-306129902,Ka.a.ktf,972,973,1625);case 36:return this.rp(Pa,"Gridlines.Horizontal.Minor",2147076534,Ka.a.ltf,975,976,1626);case 37:return this.rp(Pa,"Gridlines.Horizontal.MajorMinor",-1253752845,Ka.a.mtf,978,979,1627);case 38:return this.rp(Pa,"Gridlines.Vertical.None",1711257557,Ka.a.stf,929,971,1624);case 39:return this.rp(Pa,"Gridlines.Vertical.Major",-1772953364,Ka.a.ptf,972,974,1625);case 40:return this.rp(Pa,"Gridlines.Vertical.Minor",680253336,Ka.a.qtf,975,977,1626);case 41:return this.rp(Pa,
"Gridlines.Vertical.MajorMinor",-215161981,Ka.a.rtf,978,980,1627);case 135:return this.Sh(Pa,"ContextMenu.NumberFormating",2105621672,Ka.a.HCd,1,476,135!==Pa,null,null,this.lB.uU(406));case 300:return this.Sh(Pa,"ContextMenu.FormatCells",2055979337,null,1,477,300!==Pa,void 0,"PaintBrushandBucket_20",this.lB.uU(406));case 361:return this.Sh(Pa,"ContextMenu.FormatCellsNumberFormatTaskPane",-395879625,null,1,477,361!==Pa,void 0,"PaintBrushandBucket_20",this.lB.uU(406));case 362:return this.Sh(Pa,"ContextMenu.FontTaskPane",
456320978,null,1,477,362!==Pa,void 0,"PaintBrushandBucket_20",this.lB.uU(406));case 136:return this.Sh(Pa,"ContextMenu.NumberFormatingApplyToPivotField",-168056295,Ka.a.HCd,1,476,136!==Pa);case 42:return this.Sh(Pa,"ContextMenu.Cut",-1985798686,Ka.a.fsf,1,12,!1,null,null,this.lB.uU(172));case 43:return this.Sh(Pa,"ContextMenu.Copy",-911352779,Ka.a.Yuc,1,11,!1,null,null,this.lB.uU(174));case 212:return this.Sh(Pa,"ContextMenu.InsertCopiedCells",-160032004,Ka.a.jDd,3,15);case 213:return this.Sh(Pa,
"ContextMenu.InsertCutCells",-1065525230,Ka.a.jDd,3,21);case 354:return this.Sh(Pa,"ContextMenu.PasteValues",-185374993,Ka.a.usf,8,1149,null,null,"PasteValues_20",this.lB.uU(178));case 355:return this.Sh(Pa,"ContextMenu.PasteFormulas",1766348718,Ka.a.usf,8,1150,null,null,"PasteFormulas_20");case 356:return this.Sh(Pa,"ContextMenu.PasteFormatting",1804571062,Ka.a.Rmi,3,1152,null,null,"PasteFormatting_20");case 357:return this.Sh(Pa,"ContextMenu.PasteLink",42074747,Ka.a.Umi,3,1153,null,null,"PasteLink_20");
case 358:return this.Sh(Pa,"ContextMenu.PasteWithColumnWidths",264209770,null,3,2299,null,null,"PasteWithColumnWidths_20");case 359:return this.Sh(Pa,"ContextMenu.PasteTranspose",-958589048,Ka.a.Wmi,3,1151,null,null,"PasteTranspose_20");case 44:case 57:return this.Sh(Pa,"ContextMenu.Paste",237279923,Ka.a.cvc,1,13,44!==Pa,"Paste",null,this.lB.uU(176));case 248:return this.Sh(Pa,"PasteAdvancedOptionsGallery",237279923,Ka.a.cvc,1,13,44!==Pa,"Paste");case 45:case 120:return this.Sh(Pa,"ContextMenu.EditHyperlink",
-1583422759,Ka.a.ZCd,8,1140,45!==Pa,"EditHyperlink");case 46:case 121:return this.Sh(Pa,"ContextMenu.InsertHyperlink",-1583422759,Ka.a.ZCd,8,1141,46!==Pa,"InsertHyperlink",null,this.lB.uU(156));case 47:case 122:return this.Sh(Pa,"ContextMenu.RemoveHyperlink",-1253126584,Ka.a.bDd,8,1142,47!==Pa,"RemoveHyperlink");case 48:case 123:return this.Sh(Pa,"ContextMenu.RemoveHyperlinks",-1253126584,Ka.a.bDd,8,1143,48!==Pa,"RemoveHyperlinks");case 250:return this.wq(Pa,"ContextMenu.ContextMenuSmartLookup",-983891024,
1810);case 187:case 188:case 165:case 173:return this.Sh(Pa,"ContextMenu.InsertCellsShiftRight",1035996630,Ka.a.osf,1,165===Pa||173===Pa?C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?18:341:C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?19:342,173===Pa||188===Pa,"InsertCellsShiftRight");case 166:case 174:return this.Sh(Pa,"ContextMenu.InsertCellsShiftDown",1035996630,Ka.a.nsf,1,C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)?20:344,166!==Pa,"InsertCellsShiftDown");case 189:case 190:case 167:case 175:return this.Sh(Pa,"ContextMenu.DeleteCellsShiftLeft",1035996630,Ka.a.jsf,1,167===Pa||175===Pa?C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?19:342:C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?18:341,175===Pa||190===Pa,"DeleteCellsShiftLeft");case 168:case 176:return this.Sh(Pa,"ContextMenu.DeleteCellsShiftUp",1035996630,
Ka.a.ksf,1,343,168!==Pa,"DeleteCellsShiftUp");case 177:case 181:return this.Sh(Pa,"ContextMenu.InsertRowsSheet",-1113896058,Ka.a.xNb,1,C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StringChangesForInsertOperation",!1)||C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?430:429,177!==Pa,"InsertRows");case 363:case 364:return this.Sh(Pa,"ContextMenu.InsertRowsAfterSheet",75170472,Ka.a.xNb,1,2526,363!==Pa,"InsertRowsAfter");case 49:case 116:return this.Sh(Pa,
"ContextMenu.InsertRows",-1113896058,Ka.a.xNb,1,C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StringChangesForInsertOperation",!1)||C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?2420:346,49!==Pa,"InsertRows");case 365:case 366:return this.Sh(Pa,"ContextMenu.InsertRowsAfter",75170472,Ka.a.xNb,1,2531,365!==Pa,"InsertRowsAfter");case 161:case 169:return this.Sh(Pa,"ContextMenu.InsertRowsTable",942362098,Ka.a.qsf,1,421,161!==Pa,"InsertRowsTable");
case 50:case 117:return this.Sh(Pa,"ContextMenu.InsertColumns",1415868706,Ka.a.qfa,1,406,50!==Pa,"InsertColumns");case 336:case 337:return this.Sh(Pa,"ContextMenu.InsertColumnsToTheLeft",1415868706,Ka.a.qfa,1,407,336!==Pa,"InsertColumns");case 369:case 370:return this.Sh(Pa,"ContextMenu.InsertColumnsToTheLeft",-612877076,Ka.a.qfa,1,407,369!==Pa,"InsertColumns");case 288:case 289:return this.Sh(Pa,"ContextMenu.contextMenuInsertColumnsToTheRight",1415868706,Ka.a.qfa,1,408,288!==Pa,"InsertColumns");
case 367:case 368:return this.Sh(Pa,"ContextMenu.contextMenuInsertColumnsAfterToTheRight",-612877076,Ka.a.qfa,1,408,367!==Pa,"InsertColumnsAfter");case 178:case 182:return this.Sh(Pa,"ContextMenu.InsertColumnsSheet",1415868706,Ka.a.qfa,1,426,178!==Pa,"InsertColumns");case 334:case 335:return this.Sh(Pa,"ContextMenu.InsertColumnsSheetToTheLeft",1415868706,Ka.a.qfa,1,427,334!==Pa,"InsertColumns");case 371:case 372:return this.Sh(Pa,"ContextMenu.InsertColumnsAfterSheetToTheLeft",-612877076,Ka.a.qfa,
1,427,371!==Pa,"InsertColumnsAfter");case 290:case 291:return this.Sh(Pa,"ContextMenu.InsertColumnsSheet",1415868706,Ka.a.qfa,1,428,290!==Pa,"InsertColumns");case 373:case 374:return this.Sh(Pa,"ContextMenu.InsertColumnsAfterSheetToTheRight",-612877076,Ka.a.qfa,1,428,373!==Pa,"InsertColumnsAfter");case 191:case 192:case 162:case 170:return this.Sh(Pa,"ContextMenu.InsertColumnsTable",622604322,Ka.a.psf,1,162===Pa||170===Pa?419:420,170===Pa||192===Pa,"InsertColumnsTable");case 179:case 183:return this.Sh(Pa,
"ContextMenu.DeleteRowsSheet",1554436520,Ka.a.avc,1,429,179!==Pa,"DeleteRows");case 51:case 118:return this.Sh(Pa,"ContextMenu.DeleteRows",1554436520,Ka.a.avc,1,410,51!==Pa,"DeleteRows");case 163:case 171:return this.Sh(Pa,"ContextMenu.DeleteRowsTable",1405456548,Ka.a.avc,1,418,163!==Pa,"DeleteRowsTable");case 180:case 184:return this.Sh(Pa,"ContextMenu.DeleteColumnsSheet",674605324,Ka.a.$uc,1,426,180!==Pa,"DeleteColumns");case 52:case 119:return this.Sh(Pa,"ContextMenu.DeleteColumns",674605324,Ka.a.$uc,
1,411,52!==Pa,"DeleteColumns");case 164:case 172:return this.Sh(Pa,"ContextMenu.DeleteColumnsTable",284490184,Ka.a.$uc,1,417,164!==Pa,"DeleteColumnsTable");case 53:case 124:return this.wq(Pa,"ContextMenu.OpenHyperlink",-1396319072,1144,53!==Pa,"OpenHyperlink",this.lB.uU(101));case 263:return this.Sh(Pa,"SheetOpsContextMenu.ShowChanges",1834994092,Ka.a.cDd,8,443,void 0,bb.a.QKk);case 264:return this.Sh(Pa,"GridContextMenu.ZoomFitToScreen",1409187195,null,8,1154,void 0,void 0,"FitToScreen_16");case 265:return this.Sh(Pa,
"GridContextMenu.ZoomFitToScreenUndo",-1836771825,null,8,1155,void 0,void 0,"RevertZoom_16");case 262:return this.Sh(Pa,"GridContextMenu.ShowChanges",1834994092,Ka.a.cDd,8,443,void 0,bb.a.OQg);case 54:return this.Sh(Pa,"ContextMenu.InsertSheet",-1935155518,Ka.a.ICd,1,514);case 360:return this.Sh(Pa,"ContextMenu.AppendSheet",-546331179,Ka.a.ICd,1,514);case 56:case 127:return this.Sh(Pa,"ContextMenu.DeleteSheet",1880294140,Ka.a.lsf,1,515,56!==Pa,"DeleteSheet");case 55:return this.wq(Pa,"ContextMenu.RenameSheet",
817296323,516);case 125:case 126:return this.wq(Pa,"ContextMenu.ReorderSheet",-383100692,517,125!==Pa,"ReorderSheet");case 158:return this.wq(Pa,"ContextMenu.DuplicateSheet",-1254662242,441);case 338:case 339:return lc=338!==Pa,this.Sh(Pa,lc?"ContextMenu.FullSheetCopyDisabled":"ContextMenu.FullSheetCopy",-207190267,Ka.a.Yuc,1,2431,lc,null);case 340:case 341:return lc=340!==Pa,this.Sh(Pa,lc?"ContextMenu.FullSheetPasteDisabled":"ContextMenu.FullSheetPaste",440556491,Ka.a.cvc,1,2430,lc,null);case 112:case 114:return this.wq(Pa,
"ContextMenu.HideSheet",1458540255,519,112!==Pa,"HideSheet");case 113:case 115:return this.wq(Pa,"ContextMenu.UnhideSheet",1129633328,520,113!==Pa,"UnhideSheet");case 277:return this.Sh(Pa,"ContextMenu.ManageProtection",1723441034,null,8,1995,void 0,void 0,"ProtectSheet_20");case 278:return this.Sh(Pa,"ContextMenu.PauseProtection",-278145964,null,8,1996,void 0,void 0,"UnlockVariant_20");case 279:return this.Sh(Pa,"ContextMenu.ResumeProtection",-278145964,null,8,1998,void 0,void 0,"ProtectForm_20");
case 242:return this.wq(Pa,"ContextMenu.PivotExpandCollapse",589118293,1167);case 243:return this.Sh(Pa,"ContextMenu.PivotExpand",-1687560254,Ka.a.MCd,9,1168);case 244:return this.Sh(Pa,"ContextMenu.PivotCollapse",1176256599,Ka.a.LCd,9,1169);case 245:return this.Sh(Pa,"ContextMenu.PivotExpandEntireField",-1751201991,Ka.a.MCd,9,1170);case 246:return this.Sh(Pa,"ContextMenu.PivotCollapseEntireField",-232434744,Ka.a.LCd,9,1171);case 247:return this.Sh(Pa,"ContextMenu.PivotShowDetails",1771091375,null,
17,1172,void 0,void 0,"PivotShowDetails_20");case 301:return this.Sh(Pa,"ContextMenu.DeletePivotTable",1885005049,null,17,2292,void 0,void 0,Pc.a.c3j);case 306:return this.Sh(Pa,"ContextMenu.ManualUngroup",-1683649734,null,17,2347,void 0,void 0);case 307:return this.Sh(Pa,"ContextMenu.ManualGroup",660506187,null,17,2346,void 0,void 0);case 59:return this.Sh(Pa,"ContextMenu.PivotFieldListShow",2140436015,Ka.a.NCd,9,1173);case 58:return this.Sh(Pa,"ContextMenu.PivotFieldListHide",-1006032470,Ka.a.NCd,
9,1174);case 258:return this.Sh(Pa,"ContextMenu.PivotSettingsPaneShow",1529441790,Ka.a.zNb,17,636);case 257:return this.Sh(Pa,"ContextMenu.PivotSettingsPaneHide",1529441790,Ka.a.zNb,17,637);case 259:return this.wq(Pa,"ContextMenu.PivotTableNoSubtotal",-2016405815,638);case 260:return this.wq(Pa,"ContextMenu.PivotTableSubtotalOnTop",671485366,639);case 261:return this.wq(Pa,"ContextMenu.PivotTableSubtotalOnBottom",772221736,640);case 60:case 64:return lc=60!==Pa,this.wq(Pa,lc?"ContextMenu.FieldWellMoveUpDisabled":
"ContextMenu.FieldWellMoveUp",-1170196828,1089,lc,null);case 61:case 65:return lc=61!==Pa,this.wq(Pa,lc?"ContextMenu.FieldWellMoveDownDisabled":"ContextMenu.FieldWellMoveDown",-889576107,1090,lc,null);case 62:case 66:return lc=62!==Pa,this.wq(Pa,lc?"ContextMenu.FieldWellMoveToBeginningDisabled":"ContextMenu.FieldWellMoveToBeginning",389774337,1091,lc,null);case 63:case 67:return lc=63!==Pa,this.wq(Pa,lc?"ContextMenu.FieldWellMoveToEndDisabled":"ContextMenu.FieldWellMoveToEnd",2033235475,1092,lc,null);
case 68:case 72:return lc=68!==Pa,this.Sh(Pa,lc?"ContextMenu.FieldWellMoveToReportFilterDisabled":"ContextMenu.FieldWellMoveToReportFilter",-96230454,Ka.a.Vuc,9,1093,lc,null);case 69:case 73:return lc=69!==Pa,this.Sh(Pa,lc?"ContextMenu.FieldWellMoveToRowLabelsDisabled":"ContextMenu.FieldWellMoveToRowLabels",74086617,Ka.a.Whb,9,1094,lc,null);case 70:case 74:return lc=70!==Pa,this.Sh(Pa,lc?"ContextMenu.FieldWellMoveToColumnLabelsDisabled":"ContextMenu.FieldWellMoveToColumnLabels",1529312473,Ka.a.Vhb,
9,1095,lc,null);case 71:case 75:return lc=71!==Pa,this.Sh(Pa,lc?"ContextMenu.FieldWellMoveToValuesDisabled":"ContextMenu.FieldWellMoveToValues",563292088,Ka.a.Wuc,9,1098,lc,null);case 76:return this.Sh(Pa,"ContextMenu.FieldWellRemoveField",-1092351914,Ka.a.hsf,9,1099);case 77:return this.Sh(Pa,"ContextMenu.FieldWellValueFieldSettings",-2141589616,Ka.a.Csf,9,1100);case 79:case 83:return this.Sh(Pa,"ContextMenu.FieldListMoveToReportFilter",359279088,Ka.a.Vuc,9,1082,79!==Pa,null);case 80:case 84:return this.Sh(Pa,
"ContextMenu.FieldListMoveToRowLabels",-67292059,Ka.a.Whb,9,1083,80!==Pa,null);case 81:case 85:return this.Sh(Pa,"ContextMenu.FieldListMoveToColumnsLabels",745182485,Ka.a.Vhb,9,1084,81!==Pa,null);case 82:case 86:return this.Sh(Pa,"ContextMenu.FieldListMoveToValues",926905850,Ka.a.Wuc,9,1087,82!==Pa,null);case 95:case 97:return lc=95!==Pa,this.Sh(Pa,lc?"ContextMenu.FieldWellMoveToRowChartLabelsDisabled":"ContextMenu.FieldWellMoveToRowChartLabels",74086617,Ka.a.Whb,9,1096,lc,null);case 96:case 98:return lc=
96!==Pa,this.Sh(Pa,lc?"ContextMenu.FieldWellMoveToColumnChartLabelsDisabled":"ContextMenu.FieldWellMoveToColumnChartLabels",1529312473,Ka.a.Vhb,9,1097,lc,null);case 78:return this.Sh(Pa,"ContextMenu.FieldListAddAsSlicer",547535945,Ka.a.ECd,9,1088);case 332:case 333:return this.Sh(Pa,"ContextMenu.FieldListAddAsTimeline",-2108836646,null,9,2393,333===Pa,void 0,"TimeSlicerInsert_20");case 91:case 93:return this.Sh(Pa,"ContextMenu.FieldListMoveToRowChartLabels",-67292059,Ka.a.Whb,9,1085,91!==Pa,null);
case 92:case 94:return this.Sh(Pa,"ContextMenu.FieldListMoveToColumnChartLabels",745182485,Ka.a.Vhb,9,1086,92!==Pa,null);case 99:return this.Sh(Pa,"ContextMenu.BIExploreShowCallout",1529658657,Ka.a.Xuc,9,1193);case 100:return this.Sh(Pa,"ContextMenu.ContextMenuRefresh",2054778433,Ka.a.xsf,9,1181);case 102:return this.Sh(Pa,"ContextMenu.EditCell",324156914,Ka.a.aDd,8,579);case 101:return this.Sh(Pa,"Contextenu.DeleteChart",2045211913,Ka.a.fvc,8,578);case 308:return this.Sh(Pa,"Contextmenu.DeleteChartElement",
2045211913,Ka.a.fvc,8,2358);case 321:return this.wq(Pa,"Contextmenu.AddDataLabels",1849330294,2359,!1);case 350:return this.wq(Pa,"Contextmenu.AddErrorBarX",-873142594,2367,!1);case 351:return this.wq(Pa,"Contextmenu.AddErrorBarY",1855740761,2367,!1);case 352:return this.wq(Pa,"Contextmenu.AddErrorBarHz",-873142594,2438,!1);case 353:return this.wq(Pa,"Contextmenu.AddErrorBarVt",1855740761,2440,!1);case 322:return this.wq(Pa,"Contextmenu.AddTrendline",2117491830,2363,!1);case 323:return this.wq(Pa,
"Contextmenu.AddTrendlineTitle",2107851680,2365,!1);case 324:return this.wq(Pa,"Contextmenu.AddAxisTitle",-1986737526,2386,!1);case 325:return this.wq(Pa,"Contextmenu.AddMajorGridlines",119706583,2370,!1);case 326:return this.wq(Pa,"Contextmenu.AddMinorGridlines",-1741941813,2372,!1);case 342:return this.wq(Pa,"Contextmenu.EditTextChartTitle",419803868,818,!1);case 343:return this.wq(Pa,"Contextmenu.EditTextAxisTitleHorizontal",-2011789595,818,!1);case 344:return this.wq(Pa,"Contextmenu.EditTextAxisTitleVertical",
-1513952223,818,!1);case 146:return this.Sh(Pa,"Contextenu.AltText",1804967129,Ka.a.YCd,8,817);case 302:return this.Sh(Pa,"ContextMenu.CellImageAltText",1516436924,Ka.a.YCd,8,817);case 147:return this.Sh(Pa,"ContextMenu.EditShapeText",-445658892,Ka.a.Ctf,8,818);case 186:return this.Sh(Pa,"ContextMenu.ExitEditShapeText",1166778132,null,8,819);case 281:return this.Sh(Pa,"ContextMenu.BringForward",-1024854261,null,8,820,!1,"ContextMenu.BringForward",Pc.a.bringForward);case 282:return this.Sh(Pa,"ContextMenu.BringToFront",
-1480025782,null,8,822,!1,"ContextMenu.BringToFront",Pc.a.bringToFront);case 283:return this.Sh(Pa,"ContextMenu.SendBackWard",565697619,null,8,821,!1,"ContextMenu.SendBackWard",Pc.a.sendBackward);case 284:return this.Sh(Pa,"ContextMenu.SendToBack",-884976206,null,8,823,!1,"ContextMenu.SendToBack",Pc.a.sendToBack);case 273:return this.Sh(Pa,"ContextMenu.OfficeScriptsViewScript",-585097204,Ka.a.asf,8,2151);case 160:return this.Sh(Pa,"ContextMenu.InsertComment",-1667294294,Ka.a.Etf,8,1146,!1,null,null,
this.lB.uU(351));case 221:return this.Sh(Pa,"ContextMenu.DeleteComment",467845448,Ka.a.Btf,8,1162);case 159:return this.Sh(Pa,"ContextMenu.InsertReply",-1667294294,Ka.a.Ftf,8,1145);case 226:return this.Sh(Pa,"ContextMenu.NewNote",2041505397,null,8,1156,void 0,void 0,"AddNoteboardNote_20",this.lB.uU(348));case 227:return this.Sh(Pa,"ContextMenu.EditNote",2041505397,null,8,1157,void 0,void 0,"EditNote_20");case 228:return this.Sh(Pa,"ContextMenu.DeleteNote",-865270283,null,8,1158,void 0,void 0,"DeleteNote_20");
case 229:return this.Sh(Pa,"ContextMenu.ShowOrHideNote",1627476102,null,8,1159,void 0,void 0,"OLNoteYellow_20");case 230:return this.wq(Pa,"ContextMenu.ConvertNote",-1565161385,1161);case 103:return this.b4(Pa,"Form.InsertForm",1305810481,Ka.a.KCd,1,"Image16by16",1267,0,null,!1,1595);case 107:return this.b4(Pa,"Form.ViewForm",330035228,Ka.a.KCd,1,"Image16by16",1269,0,null,!1,1596);case 104:return this.b4(Pa,"Form.EditForm",1305810481,Ka.a.msf,1,"Image16by16",1268,0,null,!1,1597);case 105:return this.b4(Pa,
"Form.DeleteForm",-509039657,Ka.a.isf,1,"Image16by16",1270,0,null,!1,1598);case 106:return this.b4(Pa,"Form.ShareForm",1334518759,Ka.a.ysf,1,"Image16by16",1271,0,null,!1,1599);case 148:case 149:return this.wq(Pa,"ContextMenu.ClearContent",-848953656,445,148!==Pa);case 150:case 151:return this.Sh(Pa,"ContextMenu.RowHeight",2040891415,Ka.a.Gtf,8,434,151===Pa);case 152:case 153:return this.Sh(Pa,"ContextMenu.ColumnWidth",957527587,Ka.a.Atf,8,433,153===Pa);case 108:case 154:return this.wq(Pa,"ContextMenu.HideRows",
1051390410,432,154===Pa);case 110:case 156:return this.wq(Pa,"ContextMenu.UnhideRows",1542466017,439,156===Pa);case 109:case 155:return this.wq(Pa,"ContextMenu.HideColumns",-706918724,438,155===Pa);case 111:case 157:return this.wq(Pa,"ContextMenu.UnhideColumns",369708605,440,157===Pa);case 216:return this.wq(Pa,"ContextMenu.ShowCard",-843616717,1786,216!==Pa);case 217:return this.wq(Pa,"ContextMenu.ShowImageDetails",-843616717,1787);case 303:return this.Sh(Pa,"ContextMenu.PlaceInCell",-700002548,
null,8,2300,void 0,void 0,"PictureInCell_20");case 304:return this.Sh(Pa,"ContextMenu.PlaceOverCell",2000316912,null,8,2301,void 0,void 0,"InsertPictureSimple_20");case 305:return this.Sh(Pa,"ContextMenu.CreateReference",1983877126,null,8,2302,void 0,void 0,"PictureLinked_20");case 215:case 268:return this.wq(Pa,"ContextMenu.ConvertLinkedEntityToText",311599363,1784,268===Pa);case 218:case 269:return this.wq(Pa,"ContextMenu.RefreshLinkedEntities",439914789,1788,269===Pa);case 220:case 271:return this.wq(Pa,
"ContextMenu.ShowLinkedEntityRefreshPane",-1753056834,1785,271===Pa);case 219:case 270:return this.wq(Pa,"ContextMenu.ChangeLinkedEntityObject",2127195269,1796,270===Pa);case 234:return this.Sh(Pa,"ContextMenu.FilterClear",-1977666927,null,1,220,void 0,void 0,"DeleteFilter_20");case 235:return this.Sh(Pa,"ContextMenu.FilterReapply",1549396389,null,1,221,void 0,void 0,"XLReapplyFilter_20");case 233:return this.Sh(Pa,"ContextMenu.FilterByValue",1803952894,null,1,C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)?2522:222);case 313:return this.Sh(Pa,"ContextMenu.FilterByCellColor",486423932,null,1,C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?2523:2375);case 314:return this.Sh(Pa,"ContextMenu.FilterByCellFontColor",-652157481,null,1,C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?2524:2376);case 315:return this.Sh(Pa,"ContextMenu.FilterByCellIcon",-1656122924,null,1,C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",
!1)?2525:2377);case 223:return this.Sh(Pa,"ContextMenu.SortAscending",-1010737776,Ka.a.Asf,1,228);case 292:return this.wq(Pa,"ContextMenu.PutSelectedCellColorOnTop",-1032691499,C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?2518:230);case 293:return this.wq(Pa,"ContextMenu.PutSelectedFontColorOnTop",-764711886,C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?2519:231);case 294:return this.wq(Pa,"ContextMenu.PutSelectedFormattingIconOnTop",
-2016161444,C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FluentV9ContextMenuEnabled",!1)?2520:232);case 224:return this.Sh(Pa,"ContextMenu.SortDescending",2123420468,Ka.a.Bsf,1,229);case 225:return this.Sh(Pa,"ContextMenu.SortCustom",-207540907,Ka.a.dvc,1,233);case 232:return this.Sh(Pa,"ContextMenu.ConvertToRange",323142015,Ka.a.esf,1,740);case 272:return this.Sh(Pa,"ContextMenu.ShowOpenInAppDialogOnMobile",213236505,Ka.a.aDd,8,661);case 239:return this.Sh(Pa,"ContextMenu.IgnoreError",
886009118,Ka.a.$Cd,8,2112,239!==Pa);case 240:return this.Sh(Pa,"ContextMenu.IgnoreErrors",886009118,Ka.a.$Cd,8,2113,240!==Pa);case 241:return this.wq(Pa,"ContextMenu.ShowError",-1779556985,2114,241!==Pa);case 251:return this.Sh(Pa,"ContextMenu.SlicerRefresh",-231711729,Ka.a.wsf,0,2177,251!==Pa);case 252:return this.Sh(Pa,"ContextMenu.SlicerClearFilter",-1909381757,Ka.a.FCd,0,2178,252!==Pa);case 375:return this.Sh(Pa,"ContextMenu.AutoToggleFilter",368460465,null,0,247,375!==Pa);case 345:return this.Sh(Pa,
"ContextMenu.TimeSlicerClearFilter",-741340954,Ka.a.FCd,0,2178,345!==Pa);case 254:return this.wq(Pa,"ContextMenu.SlicerDelete",2045211913,2181,254!==Pa);case 253:return this.Sh(Pa,"ContextMenu.SlicerMultiSelect",2108047455,Ka.a.JCd,0,2180,253!==Pa);case 255:return this.Sh(Pa,"ContextMenu.SlicerSortAscending",-923375148,Ka.a.gvc,8,2183,255!==Pa);case 256:return this.Sh(Pa,"ContextMenu.SlicerSortDescending",1164937340,Ka.a.hvc,8,2182,256!==Pa);case 267:return this.Sh(Pa,"ContextMenu.SlicerSettingsPaneShow",
522377926,Ka.a.zNb,17,636);case 266:return this.Sh(Pa,"ContextMenu.SlicerSettingsPaneHide",522377926,Ka.a.zNb,17,637);case 128:return this.xGa(Pa,-619033944,1,1438);case 129:return this.xGa(Pa,-619033944,2,1440);case 130:return this.xGa(Pa,-619033944,3,1442);case 131:return this.xGa(Pa,-619033944,4,1443);case 132:return this.Iea(Pa,-1736601456,7,1447);case 133:return this.Iea(Pa,-1736601456,8,1449);case 134:return this.Iea(Pa,-1736601456,0,1450);case 196:return this.xGa(Pa,-2136556471,1,1438);case 198:return this.xGa(Pa,
-2136556471,2,1440);case 200:return this.xGa(Pa,-2136556471,3,1442);case 201:return this.xGa(Pa,-2136556471,4,1443);case 204:return this.Iea(Pa,1201641489,0,1447);case 205:return this.Iea(Pa,1201641489,1,1448);case 206:return this.Iea(Pa,1201641489,7,1449);case 207:return this.Iea(Pa,1201641489,2,1450);case 208:return this.Iea(Pa,1201641489,4,1451);case 209:return this.Iea(Pa,1201641489,3,1452);case 210:return this.Iea(Pa,1201641489,5,1453);case 211:return this.Iea(Pa,1201641489,6,1454);case 274:return this.Sh(Pa,
"ContextMenu.ShareChart",353606613,null,1,2261,void 0,void 0,$b.a.isFluentIconsEnabled()&&C.EwaSettings.isChangeGateEnabled("OfficeVSO:8728203_CollabCornerIconFix")?"LinkToSection_20":"ShareSectionEntry_20");case 275:return this.Sh(Pa,"ContextMenu.ShareRange",-1099009678,null,1,2262,void 0,void 0,$b.a.isFluentIconsEnabled()&&C.EwaSettings.isChangeGateEnabled("OfficeVSO:8728203_CollabCornerIconFix")?"LinkToSection_20":"ShareSectionEntry_20");case 276:return this.Sh(Pa,"ContextMenu.ShareTable",192430811,
null,1,2263,void 0,void 0,$b.a.isFluentIconsEnabled()&&C.EwaSettings.isChangeGateEnabled("OfficeVSO:8728203_CollabCornerIconFix")?"LinkToSection_20":"ShareSectionEntry_20");case 317:return this.Sh(Pa,"ContextMenu.ShareNamedSheetView",-1592351768,null,1,2382,void 0,void 0,$b.a.isFluentIconsEnabled()&&C.EwaSettings.isChangeGateEnabled("OfficeVSO:8728203_CollabCornerIconFix")?"LinkToSection_20":"ShareSectionEntry_20");case 319:return this.Sh(Pa,"ContextMenu.ExitNamedSheetView",1690118309,null,3,2381,
void 0,void 0,"ExitSheetView_20");case 299:return this.Sh(Pa,"ContextMenu.ShareSheet",783415632,null,1,2264,void 0,void 0,$b.a.isFluentIconsEnabled()&&C.EwaSettings.isChangeGateEnabled("OfficeVSO:8728203_CollabCornerIconFix")?"LinkToSection_20":"ShareSectionEntry_20");case 312:return this.Sh(Pa,"ContextMenu.ShareSheet",783415632,null,1,2374,void 0,void 0,$b.a.isFluentIconsEnabled()&&C.EwaSettings.isChangeGateEnabled("OfficeVSO:8728203_CollabCornerIconFix")?"LinkToSection_20":"ShareSectionEntry_20");
case 309:return this.Sh(Pa,"ContextMenu.FlyoutShareSheet",783415632,null,1,2355,void 0,void 0);case 310:return this.Sh(Pa,"ContextMenu.FlyoutShareRange",-1099009678,null,1,2356,void 0,void 0);case 311:return this.Sh(Pa,"ContextMenu.FlyoutShareTable",192430811,null,1,2357,void 0,void 0);case 285:return this.Sh(Pa,"ContextMenu.ToggleTotalRow",2128797448,null,1,741,void 0,void 0,"ToggleTotalRow_20");case 286:return this.Sh(Pa,"ContextMenu.TableAltText",-723113214,null,1,817,void 0,void 0,"ShowTableAltTextDlg_20");
case 330:return this.Sh(Pa,"ContextMenu.CopyHyperlink",-1257360929,Ka.a.Yuc,1,2410,330!==Pa);case 331:return this.Sh(Pa,"ContextMenu.ShowLinkPreview",1915212877,null,1,2411,331!==Pa)}return null}b4(Pa,lc,Gc,Cd,Qd,ge,ye,$e,qf,h,Z,E,aa){lc=new nb.a(lc,ye,Gc,null,Qd,Cd,ge,ye,$e,qf,h,Z,!0,void 0===E?null:E,void 0===aa?null:aa);return wd.zeb[Pa.toString()]=lc}Sh(Pa,lc,Gc,Cd,Qd,ge,ye,$e,qf,h){qf=void 0===qf?null:qf;return this.b4(Pa,lc,Gc,qf?null:Cd,Qd,"Image16by16",ge,0,void 0===$e?null:$e,void 0===ye?
!1:ye,0,qf,void 0===h?null:h)}WKb(Pa,lc,Gc,Cd,Qd,ge,ye,$e,qf,h){return new ya(Pa,ge,lc,null,Cd,Gc,Qd,ge,ye,$e,!1,void 0===qf?null:qf,void 0===h?null:h)}Hhf(Pa,lc){return new Gb(Pa,void 0===lc?"":lc)}j0h(Pa,lc,Gc,Cd){return new uc.a(Pa,0,lc,null,8,null,"None",0,0,null,!1,0,Gc,Cd)}rWa(Pa,lc,Gc,Cd,Qd,ge,ye,$e,qf){$e=void 0===$e?null:$e;qf=void 0===qf?!1:qf;let h=Na.a.gj(wd.zeb,Pa);if(h)return h;h=new nb.a(Pa,0,Gc,null,3,null,"None",0,0,ge,ye,0);h.L1(lc);h.label=lc;h.ime(qf?null:lc);h.z5b(Qd,Cd,$e);return wd.zeb[Pa]=
h}kfe(Pa){this.wSd(Pa)&&delete wd.zeb[Pa]}wSd(Pa){return Pa in wd.zeb}fz(Pa,lc,Gc,Cd){Pa=new Aa(Pa,lc,0,Cd,3,null,"None",0);Pa.L1(Gc);Pa.label=Gc;return Pa}Iqc(Pa,lc,Gc,Cd,Qd,ge,ye){Pa=new Aa(Pa,lc,0,Cd,Qd,ye?null:ge,"Image16by16",0,ye);Pa.L1(Gc);Pa.label=Gc;return Pa}BKb(Pa,lc,Gc,Cd,Qd,ge){return new Hb(this.lB,Pa,null,null,void 0===lc?null:lc,null,void 0===Gc?null:Gc,void 0===Cd?null:Cd,void 0===Qd?null:Qd,void 0===ge?null:ge)}$L(Pa,lc,Gc,Cd){Gc=void 0===Gc?null:Gc;Cd=void 0===Cd?null:Cd;return Object(Za.a)(new Bb,
{id:Pa,width:lc,ova:Gc,title:Cd})}rp(Pa,lc,Gc,Cd,Qd,ge,ye){return this.b4(Pa,lc,Gc,Cd,4,"Image32by32",Qd,ge,null,!1,ye)}wq(Pa,lc,Gc,Cd,Qd,ge,ye){return this.b4(Pa,lc,Gc,null,1,"None",Cd,0,void 0===ge?null:ge,void 0===Qd?!1:Qd,0,null,void 0===ye?null:ye)}vgf(Pa,lc,Gc,Cd,Qd,ge){return this.b4(Pa,lc,Gc,Cd,4,"Image16by16",Qd,0,ge.toString(),!1,0)}Iea(Pa,lc,Gc,Cd){return this.vgf(Pa,"OutlineDashStylePresent,"+Gc,lc,Ka.a.Zuc,Cd,Gc)}xGa(Pa,lc,Gc,Cd){return this.vgf(Pa,"OutlineWidthPresent,"+Gc,lc,Ka.a.bvc,
Cd,Gc)}};Md.zeb={};Md=wd=Object(e.__decorate)([Object(W.d)(N["if"]),Object(e.__param)(0,Object(N.Be)()),Object(e.__param)(1,Object(N.ab)())],Md);Object(w.a)(Md,"RibbonControlsManager",null,[859]);var Nd=a(209);let ec=class{constructor(Pa){this.yei=Pa.NFk}Bi(){return!1}executeCommand(Pa,lc){Pa=lc.command;lc=null;switch(Pa){case 1243860697:this.yei.wXk();break;default:lc=Nd.a(Pa)}return lc||J.Task.Va(!0)}ni(Pa,lc){return 1243860697===lc.command}Ji(){return!1}};ec=Object(e.__decorate)([Object(W.d)(N.Df),
Object(e.__param)(0,Object(N.Kf)()),Object(e.__param)(1,Object(N.Ue)())],ec);Object(w.a)(ec,"SheetDropdownMenuCommandHandler",null,[39]);var gc=a(420),Mb=a(90),sc=a(79),xd=a(325),xb=a(17),Lb=a(399),Rc=a(96),nd=a(52),$d=a(302),Td=a(193),He=a(154),oc=a(60),ld=a(197);class id{constructor(){this.kmf=new Na.a(!0);this.j8c=0}get Dzd(){return this.j8c}get navigationButtonsDisabled(){return!!(this.Dzd&1)}get operationButtonsDisabled(){return!!(this.Dzd&2)}KEh(Pa,lc){this.kmf.add(Pa,lc);this.j2()}j2(){this.j8c=
0;Na.a.forEach(this.kmf.eB,Pa=>{this.j8c=this.Dzd|Pa.value})}}Object(w.a)(id,"SheetTabBarDisabledStateManager",null,[]);var fc=a(263),vc=a(68),Tc=a(958),Bd=a(301),Fd=a(95),le=a(279),dc=a(54),Uc=a(327),kb=a(16),rb=a(74),cc=a(239),mc=a(117),Sa=a(156),pb=a(423),Ac=a(416),yd=a(47),vb=a(286),Sc=a(100);class hd extends fc.a{constructor(Pa,lc,Gc){Gc=void 0===Gc?!1:Gc;super(Pa);this.r1b=this.jVa=null;this.$=lc;this.POb=this.E8=Gc}get disabled(){return this.E8}dispose(){this.r1b=this.jVa=this.$=null;super.dispose()}d2(Pa){this.E8=
Pa;this.domElement.setAttribute(bb.a.HUa,Pa.toString());kb.DOMElementExtensions.toggleCssClass(this.domElement,Tc.a.HGa,Pa)}C_c(Pa){this.POb=Pa}eQa(Pa,lc){return this.disabled?!1:this.POb&&C.EwaSettings.isChangeGateEnabled("OfficeVSO:8509448_StartSheetTabBarButtonsEnabled")?(yd.a(this.$).sP(Pa,lc),!1):!0}}Object(w.a)(hd,"SheetBarButton",fc.a,[]);var qc=a(918),Lc=a(185),bd=a(160);class jd extends hd{constructor(Pa,lc,Gc,Cd){Cd=void 0===Cd?!1:Cd;super(document.createElement("a"),lc,Cd);this.fj=Qd=>
{var ge;if(!this.eQa(bd.a.sheetTabBar,Lc.a.ZFk))return!0;null===(ge=W.a.Zg(N.Dg))||void 0===ge?void 0:ge.xJa(qc.a.insertSheet);this.$.ei(-1935155518,Qd.oh,30,null);return!0};this.en=()=>{this.d2(!0)};this.yl=()=>{Hc.f(this.$).cellTextEditBox.isEditing||this.d2(!1)};this.jVa=Gc.Sg(this.domElement,sa.a.instance.ia(509),0,jd.kVa,sa.a.instance.ia(510),Pc.a.Yud,Cd);Pa.appendChild(this.domElement);this.Wi.Aa("contextmenu",Qd=>{rb.g(Qd)});vb.a.instance.ya(xb.a.click,this.domElement,this.fj);this.u1a=He.a.instance.r1(this.domElement,
this.fj,Sc.a.fu,Sc.a.bCa);Hc.f(this.$).cellTextEditBox.nv(this.en);Hc.f(this.$).cellTextEditBox.RW(this.yl)}dispose(){vb.a.instance.Na(xb.a.click,this.domElement,this.fj);He.a.instance.h2(this.domElement,this.u1a);Hc.f(this.$)&&Hc.f(this.$).cellTextEditBox&&(Hc.f(this.$).cellTextEditBox.ev(this.en),Hc.f(this.$).cellTextEditBox.v1(this.yl));super.dispose()}d2(Pa){const lc=jd.tPg(this.$);super.d2(Pa||lc)}static tPg(Pa){return!Pa.isEditMode||!Pa.sa.count}}jd.kVa=Ka.a.DCd;Object(w.a)(jd,"InsertSheetButton",
hd,[]);class Yd extends hd{constructor(Pa,lc,Gc){super(document.createElement("a"),lc);this.fj=Cd=>{if(!this.eQa(bd.a.sheetTabBar,Lc.a.$Fk))return!0;this.$.ei(-684145703,Cd.oh,0,null);return!0};this.Ujg=Cd=>{Wb.HelperMethods.lXk(this.U8e,Yd.kVa,Yd.kVa+bb.a.QPf,("mouseover"===Cd.type||"focus"===Cd.type)&&!Hc.f(this.$).inRangePicker)};this.$=lc;this.U8e=Gc.Sg(this.domElement,sa.a.instance.ia(511),0,Yd.kVa,sa.a.instance.ia(512),Pc.a.Yud);Pa.appendChild(this.domElement);this.Wi.Aa("contextmenu",Cd=>{rb.g(Cd)});
this.Wi.Aa("mouseover",this.Ujg);this.Wi.Aa("mouseout",this.Ujg);vb.a.instance.ya(xb.a.click,this.domElement,this.fj);this.u1a=He.a.instance.r1(this.domElement,this.fj,Sc.a.fu,Sc.a.bCa)}dispose(){vb.a.instance.Na(xb.a.click,this.domElement,this.fj);He.a.instance.h2(this.domElement,this.u1a);this.U8e=null;super.dispose()}}Yd.kVa=Ka.a.DCd;Object(w.a)(Yd,"InsertTemplateButton",hd,[]);class te{constructor(Pa,lc){this.sheetName=null;this.newSheetIndex=0;this.sheetName=Pa;this.newSheetIndex=lc}getSheetName(){return this.sheetName}}
Object(w.a)(te,"MacroRecorderSheetReorderedPayload",null,[65]);class oe extends fc.a{constructor(Pa,lc){super(document.createElement("div"));this.e1=()=>{l.ULS.sendTraceTag(537153794,0,50,"SheetDropdownMenu.OnSheetsChanges");this.cDg(!1,"OnSheetsChanged")};this.RNj=()=>{this.fq()};this.QNj=()=>{this.$o()};this.$=Pa;this.zUk=lc;this.K4=!1;this.O8b=0}dispose(){this.$o();super.dispose()}wXk(){this.cDg(!0,"TogglerSheetDropdownMenu")}cDg(Pa,lc){l.ULS.sendTraceTag(537153795,0,50,`SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: ${lc}, toggle: ${Pa}, toggleStateId: ${this.O8b}`);
Pa&&(this.O8b+=1);const Gc=this.$.qh.vi("UserAction",`SheetDropdownMenu.RenderSheetMenuInternal: caller: ${lc}, toggle: ${Pa}, toggleStateId: ${this.O8b}, sheetCount: ${this.$.sa.count}`);Pa=this.Z5h();appChrome.renderSheetDropdownMenu(this.domElement,this.zUk,Pa,this.O8b,this.RNj,this.QNj,()=>{Gc.stop()},pb.a(this.$))}Z5h(){const Pa=this.$.sa,lc=[];for(let Cd=0;Cd<Pa.count;Cd++){var Gc=Object(Yb.a)(mc.a,Pa.getItem(Cd));0===Gc.iJ&&(Gc=this.Y5h(Gc),lc.push(Gc))}return lc}Y5h(Pa){const lc={};lc.key=
Pa.name;lc.text=Pa.name;lc.onClick=this.$5h(Pa);Pa.active&&(lc.className=pb.a(this.$)?"ewa-active-sheet-menu-item-present-mode":"ewa-active-sheet-menu-item");return lc}$5h(Pa){return()=>{const lc=new K.a(-1876836819,0,this.$.Rh,30,null);this.$.Ma.dh(lc,{[bb.a.koe]:Pa.name})}}fq(){if(!this.K4){const Pa=this.$.sa;Pa.Qm(this.e1);Pa.nmd(this.e1);Pa.u3(this.e1);Pa.tta(this.e1);Pa.uta(this.e1);Pa.T0e(this.e1);Pa.Rcb(this.e1);this.K4=!0}}$o(){if(this.K4){const Pa=this.$.sa;Pa.hn(this.e1);Pa.Qfe(this.e1);
Pa.Eba(this.e1);Pa.Yza(this.e1);Pa.Zza(this.e1);Pa.ZBg(this.e1);Pa.b3b(this.e1);this.K4=!1}}}Object(w.a)(oe,"SheetDropdownMenu",fc.a,[909,2]);class Kd extends hd{constructor(Pa,lc,Gc){super(document.createElement("a"),Pa,!C.EwaSettings.isChangeGateEnabled("OfficeVSO:8509448_StartSheetTabBarButtonsEnabled"));this.sm=()=>{this.d2(!1);C.EwaSettings.fl()||this.$.ea.dv(this.sm)};this.fj=Cd=>{if(!this.eQa(bd.a.sheetTabBar,Lc.a.cGk))return!0;this.HYg(Cd.oh);return!0};this.onKeyDown=Cd=>13===Cd.La.keyCode||
32===Cd.La.keyCode?(this.HYg(Cd.oh),!0):!1;this.jVa=lc.Sg(this.domElement,sa.a.instance.ia(513),0,Ka.a.emi,sa.a.instance.ia(513),Pc.a.n_i,this.disabled);this.domElement.classList.add("ewa-stb-dropdown-menu-button");Gc.appendChild(this.domElement);C.EwaSettings.isChangeGateEnabled("OfficeVSO:8509448_StartSheetTabBarButtonsEnabled")||this.Kgi();this.fek()}dispose(){this.M1k();super.dispose()}d2(Pa){super.d2(Pa||!this.$.ea.txa)}Kgi(){const Pa=this.$.ea;Pa.Ul?this.d2(!1):C.EwaSettings.fl()?this.$.ea.Jq(this.sm):
Pa.Uq(this.sm)}HYg(Pa){this.disabled||(l.ULS.sendTraceTag(537153793,0,50,`SheetDropdownMenuAnchor.ToggleMenu: inputMethod: ${O.a[Pa]}`),this.$.Ma.dh(new K.a(1243860697,Pa,this.$.Rh,30,null)))}fek(){vb.a.instance.ya(xb.a.click,this.domElement,this.fj);He.a.instance.ya(xb.a.zi,this.domElement,this.onKeyDown)}M1k(){vb.a.instance.Na(xb.a.click,this.domElement,this.fj);He.a.instance.Na(xb.a.zi,this.domElement,this.onKeyDown)}}Object(w.a)(Kd,"SheetDropdownMenuAnchor",hd,[]);var Ee=a(181),rc=a(147),fd=a(63),
Ed=a(194);class Rd{constructor(Pa){this.sheet=Pa;this.altText=sa.a.instance.ia(1994)}LU(){return this.sheet.active}Gxa(){return this.sheet.isLockPausedInSession}kBa(){return this.sheet.Dn?Pc.a.dvg:Pc.a.y1k}Tse(){return 16}aGa(){return null}bGa(){return"ewa-stb-locked-sheet-svg-16px"}Fue(){return null}uA(){return null}Bod(){return!0}}Object(w.a)(Rd,"LockPausedSheetIconDataSource",null,[925]);class Fe{constructor(Pa){this.sheet=Pa;this.altText=sa.a.instance.ia(1993)}LU(){return this.sheet.active}Gxa(){return this.sheet.Dn}kBa(){return Pc.a.dvg}Tse(){return 16}aGa(){return null}bGa(){return"ewa-stb-locked-sheet-svg-16px"}Fue(){return null}uA(){return null}Bod(){return!0}}
Object(w.a)(Fe,"LockedSheetIconDataSource",null,[925]);class Ae{constructor(Pa,lc,Gc){this.sheet=Pa;this.altText=sa.a.instance.ia(1908);this.LXk=lc;this.jKk=Gc}LU(){return this.sheet.active}Gxa(){return this.sheet.Kj.Ow}aGa(){return this.LU()?"ewa-stb-nsv-active-svg":"ewa-stb-nsv-inactive-svg"}kBa(){return!this.LU()&&this.jKk()?Pc.a.qGk:Pc.a.pGk}Tse(){return 14}bGa(){return"ewa_nsv_margin"}Fue(){return this.sheet.Kj.qFb}uA(){return this.LXk}Bod(){return!1}}Object(w.a)(Ae,"NamedSeetViewSheetIconDataSource",
null,[925]);var We=a(155);class ve{constructor(Pa,lc){this.Scd=this.Vca=this.iPa=this.bA=null;this.lZf=!1;this.eid=this.kBa=this.bGa=this.aGa=null;this.CY=()=>{this.dataSource.LU()&&B.TaskExtensions.Ua(this.t4f,()=>{dialogControls.renderToolTip(this.dataSource.uA(),"SheetIconTooltip",this.dataSource.Fue(),this.W1,10,!1,!1,1)},this.$.xa,3)};this.BY=()=>{this.dataSource.LU()&&this.clearToolTip()};this.$=Pa;this.dataSource=lc}get Wi(){return this.Vca||(this.Vca=We.a.instance.Ek(this.W1))}get t4f(){if(this.Scd)return this.Scd;
const Pa=new n.a;this.$.k5(lc=>{B.TaskExtensions.Ua(lc.c4f(),()=>{Pa.setResult(!0)},this.$.xa,3)});return this.Scd=Pa.task}get W1(){return this.eid}G2g(){if(this.W1&&(this.bA||this.iPa)){var Pa=this.dataSource.kBa();this.kBa!==Pa&&(this.iPa&&this.iPa.parentNode.removeChild(this.iPa),this.mSf(),this.kBa=Pa);Pa=this.dataSource.aGa();this.aGa!==Pa&&(this.kmk(this.iPa,this.aGa,Pa),this.aGa=Pa);Pa=this.dataSource.bGa();this.bGa!==Pa&&(this.jmk(this.W1,this.bGa,Pa),this.bGa=Pa);this.dataSource.uA()&&!this.dataSource.LU()&&
this.clearToolTip()}}QLk(Pa,lc,Gc){this.dbj(Pa,lc,Gc);kb.DOMElementExtensions.setVisible(this.W1,this.dataSource.Gxa())}clearToolTip(){B.TaskExtensions.Ua(this.t4f,()=>{dialogControls.clearToolTip(this.dataSource.uA())},this.$.xa,3)}dbj(Pa,lc,Gc){this.W1&&this.lZf!==Pa&&(this.W1.parentNode.removeChild(this.W1),this.bGa=this.aGa=this.kBa=this.eid=null,this.dataSource.uA()&&(this.Wi.detach("mouseover",!0),this.Wi.detach("mouseout",!0)));this.W1||(this.eid=document.createElement("span"),Sys.UI.DomElement.addCssClass(this.W1,
Tc.a.irc),Sys.UI.DomElement.addCssClass(this.W1,Ka.a.S3),Pa===this.dataSource.Bod()?lc.appendChild(this.W1):lc.insertBefore(this.W1,Gc),this.mSf(),this.dataSource.uA()&&(this.Wi.Aa("mouseover",this.CY,!0),this.Wi.Aa("mouseout",this.BY,!0)),this.lZf=Pa)}kmk(Pa,lc,Gc){Pa&&(Sys.UI.DomElement.removeCssClass(Pa,lc),Sys.UI.DomElement.addCssClass(Pa,Gc))}jmk(Pa,lc,Gc){lc&&Sys.UI.DomElement.removeCssClass(Pa,lc);Gc&&Sys.UI.DomElement.addCssClass(Pa,Gc)}dispose(){Rc.a.Ng(this.Vca)}mSf(){const Pa=this.$.ka.Ug(388);
Pa?(this.iPa=Pa.kZa(this.dataSource.kBa(),this.dataSource.Tse()))?this.W1.appendChild(this.iPa):l.ULS.shipAssertTag(537153763,0,!1,`Sheeticon.InsertCurrentSvgIcon: Svg with id ${this.dataSource.kBa()} was not found.`):l.ULS.shipAssertTag(537153792,0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to receive SvgIconProvider service.")}}Object(w.a)(ve,"SheetIcon",null,[2]);var Ze=a(105);class Oe extends Ze.a{constructor(Pa,lc){super(Pa.domElement);this.onKeyDown=Gc=>{121===Gc.keyCode&&Gc.shiftKey&&!this.dx.disabled&&
(this.showContextMenu(new Sys.UI.Point(0,0),1,this.dx.anchor),rb.g(Gc))};this.w6=Gc=>{if(!this.$.isEditMode||this.dx.disabled)return!0;this.rename(!1,Gc.oh);return!0};this.hp=Gc=>{if(this.dx.disabled)return!0;C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TrackAsyncSheetOpsContextMenu",!1)&&Sa.b(this.$).ix(Gc.La.rawEvent,"context_menu_sheet_ops",null,["context-menu"]);return this.showContextMenu(Gc.clientPoint,Gc.oh,Gc.Qh)};this.OUe=Pa;this.$=lc;vb.a.instance.ya(xb.a.sr,Pa.domElement,
this.w6);Lb.a.instance.ya(Pa.domElement,this.hp);this.Wi.Aa("keydown",this.onKeyDown)}get dx(){return this.OUe}dispose(){this.dx&&(vb.a.instance.Na(xb.a.sr,this.dx.domElement,this.w6),Lb.a.instance.Na(this.dx.domElement,this.hp),this.OUe=null);this.$=null;super.dispose()}showContextMenu(Pa,lc,Gc){if(!this.dx.eQa(bd.a.sheetTabBar,Lc.a.dGk))return!0;this.dx.activate("showContextMenu",lc,$b.a.U_f());lc=new K.a(-1075099431,lc,this.$.Rh,30,null);let Cd;return!ld.a(Cd=this.$.Ma.dh(lc,{[bb.a.loe]:Pa,[Oe.OFk]:this.dx.sheet,
[bb.a.moe]:Gc}))&&(6!==Cd.status||Cd.result)}rename(Pa,lc){this.$.ei(817296323,lc,Pa?19:0,null)}}Oe.OFk="Sheet";Object(w.a)(Oe,"SheetOpsSheetClickHelper",Ze.a,[]);var Nf=a(44),Zf=a(118);class Rb extends hd{constructor(Pa,lc,Gc,Cd,Qd){super(document.createElement("li"),Pa);this.LFk=100;this.MFk=500;this.sjf=Wb.HelperMethods.poe;this.K4=this.ioe=!1;this.color=this.Y7c=this.v7c=this.VYb=this.ajd=null;this.HGc=this.MXf=!1;this.Erc="#BEBBB8";this.l5c=null;this.onKeyDown=ge=>13===ge.La.keyCode&&this.eQa(bd.a.sheetTabBar,
Lc.a.iGk)?(this.activateSheet(1),!0):!1;this.pE=ge=>32===ge.La.charCode&&this.eQa(bd.a.sheetTabBar,Lc.a.jGk)?(this.activateSheet(1),!0):!1;this.CY=()=>{this.disabled||this.POb||this.hJ.F0||this.IAa(!0,void 0,"OnMouseOver")};this.BY=()=>{this.disabled||this.POb||this.IAa(!1,void 0,"OnMouseOut")};this.w_b=()=>{if(!this.hJ.F0){this.VQk();const ge=this.sheet.sheetProcessedData;this.disabled||this.POb||Object(Zf.d)(ge)||"PartialResult"===(null===ge||void 0===ge?void 0:ge.reason)||Hc.f(this.$).KNa(this.sheet.sheetName,
"sheetTabButton.onMouseEnter",!0)}return!1};this.rha=()=>{this.Kpf(!1);return!1};this.fj=ge=>{if(!this.eQa(bd.a.sheetTabBar,Lc.a.gGk))return!0;const ye=Hc.f(this.$);this.sheet.active||3!==ge.oh||!$b.a.m1a()&&!this.jWb||ye.isEditing||ye.Pp||ye.fMb();this.activateSheet(ge.oh);return 3!==ge.oh};this.onPointerDown=ge=>{if(!this.eQa(bd.a.sheetTabBar,Lc.a.hGk))return!0;this.Kpf(!0);Hc.f(this.$).inRangePicker&&l.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");
var ye=3===ge.oh;if(2===ge.oh||ye&&this.JKa)this.IAa(!0,!ye,"OnPointerDown"),ye=J.Task.delay(ye?this.MFk:this.LFk).RA(()=>!0),this.vVb&&(this.HGc=!0,this.hJ.mTc=B.TaskExtensions.Ua(ye,()=>{this.HGc&&this.hJ.XWj(this,ge)},this.xa,11));return!1};this.io=ge=>{if(this.disabled||!this.vVb&&C.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))return!0;this.HGc=!1;this.IAa(2===ge.oh,void 0,"OnPointerUp");this.hJ.mTc&&(B.TaskExtensions.Ua(this.hJ.mTc,()=>{this.hJ.WWj()},
this.xa,11),this.hJ.mTc=null);return!1};this.HY=()=>{this.HGc=!1;this.ioe||this.IAa(!1,void 0,"OnTouchMove");return!1};this.lcf=new Oe(this,Pa);this.jWb=$b.a.jWb();this.$=Pa;this.xhc=Cd;this.hJ=Qd;this.vVb=Qd.L2e();this.l6h();this.d0h();this.QPd=Pa.qh.Vl("UserAction",this.name);this.zUd=!1;kb.DOMElementExtensions.UK(this.domElement,bb.a.Yy,null,null);this.domElement.appendChild(this.anchor);this.anchor.appendChild(this.RT);this.MAa=new U.a;Pa=new Fe(this.sheet);this.MAa.add(new ve(this.$,Pa));this.$.ea.g6b&&
(Pa=new Rd(this.sheet),this.MAa.add(new ve(this.$,Pa)));Pa=new Ae(this.sheet,this.hJ.TWc,()=>this.color?Rb.Jpe(this.color):!1);this.VYb=new ve(this.$,Pa);this.MAa.add(this.VYb);this.JKa=this.hJ.JKa;this.Vxb();this.Cfk();this.Z7e=new Uc.a(this.domElement,1);lc.insertBefore(this.domElement,Gc);pb.a(this.$)&&this.D3g(!0);l.ULS.sendTraceTag(507643663,0,50,`SheetTabButton.ctor: index=${Cd.index}, navigationButtonsDisabled=${Qd.navigationButtonsDisabled}, operationButtonsDisabled=${Qd.operationButtonsDisabled}`)}get Vyd(){return this.Y7c||
(this.Y7c=Ba.a.tu("#F5F5F5"))}get name(){return this.OP.innerText}set name(Pa){this.OP&&(this.OP.innerText=Pa,this.Q0c(),this.E3g())}get sheet(){return this.xhc}get anchor(){return this.l5c}get OP(){return this.ajd}get RT(){return this.v7c}get tabIndex(){return this.anchor.tabIndex}set tabIndex(Pa){this.anchor.tabIndex=Pa}$Df(){return kb.DOMElementExtensions.Co(this.anchor)?this.anchor:null}dispose(){if(this.K4){$d.a.instance.Na(xb.a.Zi,this.domElement,this.onPointerDown);He.a.instance.Na(xb.a.zi,
this.domElement,this.onKeyDown);He.a.instance.Na(xb.a.Qw,this.domElement,this.pE);vb.a.instance.Na(xb.a.click,this.domElement,this.fj);$d.a.instance.Na(xb.a.T6,this.domElement,this.w_b);$d.a.instance.Na(xb.a.HK,this.domElement,this.rha);if(this.vVb||C.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))$d.a.instance.Na(xb.a.jo,this.domElement,this.io),this.JKa&&(Td.a.instance.Na(xb.a.Ok,this.domElement,this.io),Td.a.instance.Na(xb.a.kn,this.domElement,this.HY));this.K4=
!1;this.Erc="#BEBBB8"}Rc.a.Ni([this.lcf,this.Z7e]);this.ajd=this.v7c=this.l5c=this.hJ=this.Z7e=this.lcf=null;if(this.MAa){for(const Pa of this.MAa)Pa.dispose();this.MAa=null}this.color=this.xhc=null;super.dispose()}d2(Pa){Pa&&this.IAa(!1,!1);super.d2(Pa)}ORg(Pa){fd.a.Al.cY&&(this.tmf(),void W.a.resolve(N.Rd,{va:1}).then(lc=>{Ee.a.hK().then(Gc=>{lc.IBk(Gc);lc.show(Pa);return null},Gc=>{l.ULS.sendTraceTag(537153688,0,15,`SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: ${Gc}`);
return null})}))}Nvh(){if(this.sheet.active&&this.$.Gw){var Pa=this.$.Gw,lc=Hc.f(this.$),Gc=lc.gp;if(this.sheet.Kj.Ow){if(!this.VYb){const Cd=new Ae(this.sheet,this.hJ.TWc,()=>this.color?Rb.Jpe(this.color):!1);this.VYb=new ve(this.$,Cd);this.MAa.add(this.VYb)}Gc&&lc.Jxb(1);Pa.classList.add(Ka.a.euf);Pa=Rb.jGf(bb.a.Mag);lc=Rb.jGf(bb.a.a4d);"true"===Pa&&"true"===lc?this.$.ea.wpe&&this.$.ea.z6b&&(this.sheet.Kj.BM?(Pa=1,rc.a.hG(bb.a.a4d,"false",rc.a.Raa),this.$.ea.z6b=!1):Pa=0,rc.a.hG(bb.a.Mag,"false",
rc.a.Raa),this.$.ea.wpe=!1,this.ORg(Pa)):this.sheet.Kj.BM&&"true"===lc&&this.$.ea.z6b&&(rc.a.hG(bb.a.a4d,"false",rc.a.Raa),this.$.ea.z6b=!1,this.ORg(2))}else this.tmf(),Gc&&lc.Jxb(0),Pa.classList.remove(Ka.a.euf)}}tmf(){const Pa=W.a.Zg(N.Rd);Pa&&Pa.dismiss()}Vxb(){this.name=this.sheet.name;this.domElement.className=this.sheet.active||this.Jmb()?"tab-active":"tab-inactive";C.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?this.OP.parentNode.classList.add("leave-size-fixed-on-tab-hover"):
this.OP.parentNode.classList.add("leave-size-fixed-on-tab-hover-old");this.E3g();this.RLk();this.L3g();this.Q0c();this.Nvh()}VWj(){this.ioe=!0;this.IAa(!0,!0,"OnSheetReorderStarted")}UWj(){this.ioe=!1;this.IAa(!1,void 0,"OnSheetReorderEnded")}activate(Pa,lc,Gc){lc=void 0===lc?0:lc;Gc=void 0===Gc?!1:Gc;this.soc()||(this.sheet.activate({scenario:Pa}),Gc&&Hc.f(this.$).focus(),Pa={["InputMethod"]:O.a[lc],["AppMode"]:this.$.Rh,["Location"]:"canvas"},fa.b(this.$).lj(I.a.IFk,Pa))}D3g(Pa){this.Erc=Pa?"#797775":
"#BEBBB8";this.sjf=Pa?-.5:Wb.HelperMethods.poe;this.Y7c=Pa?Ba.a.tu("#3B3A39"):Ba.a.tu("#F5F5F5");this.L3g()}cyk(Pa){this.vVb=Pa}VWh(Pa){var lc;const Gc=[];this.name!==Pa.SheetName&&Gc.push(`SheetName. CachedSheetName null or empty: ${null==Pa.SheetName||""===Pa.SheetName}`);if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:8625911_addStbSheetColorSsr")){const Cd=null!==(lc=Pa.TabColor)&&void 0!==lc?lc:Ba.a.lJ(this.Vyd);Ba.a.lJ(this.color).toLowerCase()!==Cd.toLowerCase()&&Gc.push("TabColor")}else this.color.xBa()!==
this.Vyd.xBa()&&Gc.push("TabColor");C.EwaSettings.isChangeGateEnabled("OfficeVSO:8654274_addLockedSheetSsr")?this.sheet.uK(128)!==Wb.HelperMethods.AR(Pa.SheetOptions,128)&&Gc.push("Locked"):this.sheet.Dn&&Gc.push("Locked");return Gc}vRh(Pa){Pa.Gfb();this.sheet.activate({scenario:"switchSheet"})}Gsh(Pa){Pa=new K.a(-1876836819,Pa,this.$.Rh,30,null);return this.$.Ma.dh(Pa,{[bb.a.koe]:this.sheet.name})}E3g(){this.OP.parentNode.setAttribute("sheet-title",this.OP.innerText)}Q0c(){const Pa=this.KCi();this.anchor.setAttribute(bb.a.RC,
Pa);this.anchor.setAttribute(bb.a.Qka,this.sheet.active.toString())}KCi(){const Pa=this.sheet.Kj.Ow,lc=this.sheet.Kj.qFb,Gc=this.sheet.Dn,Cd=this.sheet.isLockPausedInSession;return Pa&&Gc?String.format(sa.a.instance.$g(20),this.name,lc):Pa&&Cd?String.format(sa.a.instance.$g(22),this.name,lc):Pa?String.format(sa.a.instance.$g(19),this.name,lc):Gc?String.format(sa.a.instance.$g(18),this.name):Cd?String.format(sa.a.instance.$g(21),this.name):this.name}activateSheet(Pa){Pa=void 0===Pa?0:Pa;var lc;if($b.a.U_f()){if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&
this.soc())return J.Task.Va(!1);Ed.a.current.cZ="ActivateSheet";null===(lc=W.a.Zg(N.Dg))||void 0===lc?void 0:lc.xJa(qc.a.switchSheet);this.sheet.activate({scenario:"switchSheet"});return J.Task.Va(!0)}return this.Gsh(Pa)}L3g(){const Pa=this.sheet.tabColor;this.color=Pa?Ba.a.tu(Pa):this.Vyd;this.MXf=Rb.Jpe(this.color);this.IAa(!1,void 0,"UpdateTabColor")}IAa(Pa,lc,Gc){lc=void 0===lc?!1:lc;Gc=void 0===Gc?null:Gc;if(this.sheet){Gc=this.sheet.active;var Cd=this.Jmb(),Qd=!!this.sheet.tabColor,ge=Ba.a.lJ(Gc||
Cd?ea.a.qyb:this.color);this.RT.style.background="";Gc||Cd?(Qd&&(C.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.$.Wwa?this.DDk():this.CDk()),this.RT.style.height=Wb.HelperMethods.SOg.toString()+"px"):(this.RT.style.filter="",this.RT.style.backgroundColor=ge,this.RT.style.height=Wb.HelperMethods.TOg.toString()+"px");this.OP.className=Gc?"tab-active-text":Cd?"dark":this.MXf?"light":"dark";for(const ye of this.MAa)ye.G2g();Pa&&!Qd&&(this.RT.style.backgroundColor=
"#E1DFDD");kb.DOMElementExtensions.toggleCssClass(this.domElement,"tab-hover",Pa);lc?(Qd||(this.RT.style.backgroundColor=this.Erc),this.domElement.style.backgroundColor=this.Erc):(Qd||(this.RT.style.backgroundColor=""),this.domElement.style.backgroundColor="");this.OP.style.fontWeight=Gc||Cd?"600":""}else l.ULS.sendTraceTag(537153687,0,15,`SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, which means its not rendered. caller: ${Gc}`)}CDk(){const Pa=this.RT.style,lc=Ba.a.lJ(Ba.a.vaf(this.color,
this.sjf));Pa.background=lc}DDk(){this.RT.style.background="transparent"}d0h(){this.l5c=document.createElement("a");this.anchor.removeAttribute("Href");this.anchor.className="tab-anchor-text";kb.DOMElementExtensions.UK(this.anchor,bb.a.mHb,null,null);this.tabIndex=-1}l6h(){this.v7c=document.createElement("span");this.RT.className="tab-content-container";this.ajd=document.createElement("span");this.OP.className="tab-text";this.OP.dir=this.sheet.rtlName?"rtl":"ltr";this.RT.appendChild(this.OP)}RLk(){const Pa=
this.$.LW;for(const lc of this.MAa)lc.QLk(Pa,this.RT,this.OP)}Jmb(){return Hc.f(this.$).Jmb(this.sheet)}VQk(){this.QPd.start();this.zUd=!0}Kpf(Pa){this.zUd&&(this.QPd.stop(),l.ULS.sendTraceTag(537153686,0,50,Nf.c({["Sheet index"]:this.sheet.index,["Active Sheet"]:this.sheet.active,["Hovering time"]:this.QPd.ii,["Has been clicked"]:Pa})),this.zUd=!1)}Cfk(){$d.a.instance.ya(xb.a.Zi,this.domElement,this.onPointerDown);He.a.instance.ya(xb.a.zi,this.domElement,this.onKeyDown);He.a.instance.ya(xb.a.Qw,
this.domElement,this.pE);this.Wi.Aa("mouseover",this.CY);this.Wi.Aa("mouseout",this.BY);$d.a.instance.ya(xb.a.T6,this.domElement,this.w_b);$d.a.instance.ya(xb.a.HK,this.domElement,this.rha);if(this.vVb||C.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))$d.a.instance.ya(xb.a.jo,this.domElement,this.io),this.JKa&&(Td.a.instance.ya(xb.a.Ok,this.domElement,this.io),Td.a.instance.ya(xb.a.kn,this.domElement,this.HY));vb.a.instance.ya(xb.a.click,this.domElement,this.fj);
this.K4=!0}soc(){const Pa=N.Ob.Ha()?W.a.Zg(N.Ob):this.$.ka.Ug(65);return Pa&&Pa.uxa()?(Pa.CUc(),this.vRh(Pa),!0):!1}static jGf(Pa){let lc=rc.a.get(Pa);lc||(rc.a.hG(Pa,"true",rc.a.Raa),lc=rc.a.get(Pa));return lc}static Jpe(Pa){return 128>=(222*Pa.r+707*Pa.g+71*Pa.b)/1E3}}Object(w.a)(Rb,"SheetTabButton",hd,[]);class Vb extends hd{constructor(Pa,lc,Gc){super(document.createElement("a"),lc);this.kVa=Ka.a.DCd;Gc.Sg(this.domElement,sa.a.instance.ia(713),0,this.kVa,sa.a.instance.ia(713),Pc.a.Yud,!0);Pa.appendChild(this.domElement);
this.Wi.Aa("contextmenu",Cd=>{rb.g(Cd)})}}Object(w.a)(Vb,"WorkbookProtectionButton",hd,[]);var Cc=a(43),rg=a(70),yf=a(643);class jg extends fc.a{constructor(Pa,lc,Gc,Cd){Cd=void 0===Cd?null:Cd;super(lc);this.aBa=Gc;this.sheetTabActivatePreviousHidden=sa.a.instance.ia(722);this.sheetTabActivateNextHidden=sa.a.instance.ia(724);this.svgIconProvider=null;this.wo=[];this.nY=Array(6);this.j4d=Array(6);this.uvb=this.soe=this.roe=this.Fu=null;this.WDg=!1;this.J6a=this.WSb=this.w0=null;this.isRtl=!1;this.hoa=
this.BO=0;this.Btc=this.lTc=!1;this.sAa=0;this.tDc=!0;this.PPc=0;this.pX=this.cfa=this.bma=this.Ltc=null;this.NAc=this.nM=0;this.c8b=null;this.JWb=-1;this.Qea=null;this.TOc=0;this.NYc=-1;this.Jza=0;this.fHa=new id;this.ybd=!1;this.mTc=this.wvb=this.vvb=this.MUe=this.Uaa=null;this.qMe=!1;this.LUe=null;this.gRf=()=>{this.fRf("onWorkbookOpened");this.$.Pr(this.gRf)};this.vH=(Qd,ge)=>{this.lng(ge.item)};this.d1=(Qd,ge)=>{Qd=this.$.sa.na.index;for(let ye=0,$e=this.wo.length;ye<$e;ye++){const qf=this.l5(ye);
if(qf.name===ge.oldName){qf.name=ge.newName;this.zba();ye===Qd&&this.Spa(6);break}}};this.ong=(Qd,ge)=>{(Qd=this.YNb(ge.item))&&Qd.Vxb()};this.qng=(Qd,ge)=>{ge.visible?(this.E6a(!1),this.mng(ge.item)):this.lng(ge.item)};this.$2a=Qd=>{this.F0?(this.Qea=Qd,this.u9b()):(this.Qea&&(this.PPc+=this.Qea.clientPoint.x-Qd.clientPoint.x),this.Qea=Qd,Math.abs(this.PPc)>=this.qei&&this.u9b());return!0};this.HY=Qd=>{Qd.La.preventDefault();return!1};this.WIg=Qd=>{this.TIg(Qd,!0)};this.VIg=Qd=>{this.TIg(Qd,!1)};
this.a3a=Qd=>{if(this.F0){this.Btc=this.Yhj(Qd);let ge;Qd=(ge=this.l5(this.nM+1))?ge.sheet:null;this.reorderSheets(Qd,this.nM+1===this.h6b,!0)}this.G4();return!0};this.aq=(Qd,ge)=>{ge.mB&&this.Bxe(ge.mB);this.bWc(!1);this.zba();ge.na&&(this.Bxe(ge.na),this.Spa(6),this.ea.EMa())};this.ndg=(Qd,ge)=>{this.Q1c(ge.item)};this.odg=(Qd,ge)=>{this.Q1c(ge.item)};this.pdg=(Qd,ge)=>{this.Q1c(ge.item)};this.g3a=(Qd,ge)=>{this.Q1c(ge.item)};this.jMa=()=>{this.Ptd()};this.xj=()=>{this.isVisible=!this.ea.isNamedObjectViewMode;
this.Ptd();this.xxd();C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReportStbMetricsAfterDomReady",!1)||!rg.d(this.$)&&!rg.e(this.$)||this.VDg();this.fxd();this.zba();this.E6a(!0);this.Spa(6);C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReportStbMetricsAfterDomReady",!1)&&(rg.d(this.$)||rg.e(this.$))&&this.VDg()};this.Rp=()=>{this.isVisible&&(this.zba(),this.Spa(6))};this.ol=()=>{Object(fb.a)(jd,this.w0)===Fd.l(this.$.Bk)&&this.fxd();for(const Qd of this.wo)Qd.cyk(!Fd.l(this.$.Bk))};
this.nng=(Qd,ge)=>{this.Ylk(ge.item,ge.isUserOperation)};this.N_b=(Qd,ge)=>{this.mng(ge.item)};this.onKeyDown=Qd=>{switch(Qd.keyCode){case 9:var ge=this.domElement.querySelectorAll(kb.DOMElementExtensions.zI);const ye=kb.DOMElementExtensions.fE(ge);ge=kb.DOMElementExtensions.K$(ge);kb.DOMElementExtensions.u6a(Qd,ye,ge);break;case 39:case 37:kb.DOMElementExtensions.TLg(Qd,this.domElement.querySelectorAll(kb.DOMElementExtensions.zI),39===Qd.keyCode?!this.isRtl:this.isRtl)}l.ULS.sendTraceTag(537153691,
0,50,`SheetTabBarControl.OnKeyDown: Press on ${Qd.keyCode}`)};this.onScroll=()=>{this.Fu.scrollLeft!==this.sAa&&this.FVk()};this.EY=Qd=>{if(Qd.ctrlKey||Qd.Fea)return!1;this.Fu.scrollLeft+=Math.floor(30*Qd.eCa);if(this.F0){const ge=this.qEf("OnMouseWheel");ge&&this.Vse(0<Qd.eCa,ge.x+ge.width/2)}return!0};this.hp=Qd=>{if(!yf.a.nmb||!C.EwaSettings.isChangeGateEnabled("OfficeVSO:8678119_showConTextMenuOnEmptySTB"))return!1;const ge=new K.a(-1075099431,Qd.oh,this.$.Rh,30,null);let ye;return!ld.a(ye=this.$.Ma.dh(ge,
{[bb.a.loe]:Qd.clientPoint,[bb.a.moe]:Qd.Qh,["EnableContextMenuOnSheetTabBar"]:!0}))&&(6!==ye.status||ye.result)};this.FY=(Qd,ge)=>{if(this.fHa)l.ULS.sendTraceTag(507847647,0,50,`SheetTabBarControl.onPartialInteractivityStatusChanged: sender=${!!Qd}, activated=${ge.tT}, swappedPIType=${ge.Gqa}`),this.QMf("PartialInteractivity",ge.tT?3:0);else if(this.G4(!1),this.Kme(ge.tT),C.EwaSettings.isChangeGateEnabled("OfficeVSO:8509448_StartSheetTabBarButtonsEnabled")){for(const ye of this.xmc)ye&&ye.C_c(ge.tT);
for(const ye of this.wo)ye&&ye.C_c(ge.tT)}else{for(const ye of this.xmc)ye&&ye.d2(ge.tT);for(const ye of this.wo)ye&&ye.d2(ge.tT)}};this.WZb=(Qd,ge)=>{Qd=0|(ge.fld?2:0);Qd|=ge.fld&&ge.PFk?1:0;this.QMf("ComponentRangePicker",Qd)};this.$=Pa;this.svgIconProvider=Cd;this.$.sa?this.fRf("ctor"):this.$.nr(this.gRf);Gc||l.ULS.sendTraceTag(507536514,0,10,"SheetTabBarControl.ctor: SkeletonManager must always exist.")}fRf(Pa){l.ULS.sendTraceTag(507847648,0,50,`SheetTabBarControl.initComponent: caller=${Pa}`);
this.ea=this.$.ea;this.Stc=!C.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");this.Roj=C.EwaSettings.isChangeGateEnabled("OfficeVSO:8749006_EnrichSTBSkeleton");this.y_f=!this.$.mC;this.qMe=!u.a.IU;this.kkj=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InSheetTemplates",!1);this.VFj=this.$.ua.SheetTabNavigateButtonLongKeyPressPeriodMS;this.UFj=this.$.ua.SheetTabNavigateButtonIntervalPeriodMS;this.qei=this.$.ua.SheetTabDragStartPixelThreshold;
this.Z3a=this.$3a=-1;this.Gvd=!1;this.LL=new Uc.a(this.domElement,3);this.domElement.classList.add("ewa-stb-uir");this.R3h();this.q1h();this.S3h();document.getElementById(bb.a.iga)||this.Y4h();this.bWc(!0);this.xj(null,null);Pa=this.$.sa;Pa.Qm(this.aq);Pa.nmd(this.jMa);Pa.u3(this.vH);Pa.tta(this.N_b);Pa.uta(this.d1);Pa.T0e(this.nng);Pa.Rcb(this.qng);Pa.Zyh(this.ong);Pa.Kmd(this.ndg);Pa.R0e(this.odg);Pa.Lmd(this.pdg);Pa.S0e(this.g3a);this.$.nr(this.xj);this.$.hI(this.Rp);Bd.a(this.$).Eq(this);C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateSheetTabBar",
!1)||this.$.ka.ph(32,this);C.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport")&&this.$.ea.Xy(this.ol);this.VWc=this.Xk.Ek(this.domElement);this.VWc.Aa("keydown",this.onKeyDown);yd.a(this.$).Ex()&&this.FY(null,new Ac.a(!0));yd.a(this.$).Bm.wta(this.FY);Hc.f(this.$).t0e(this.WZb);this.VWc.Aa("mousedown",lc=>{lc.preventDefault()});xd.a.instance.ya(xb.a.IM,this.domElement,this.EY);Lb.a.instance.ya(this.domElement,this.hp);this.qoe=this.Xk.Ek(this.Fu);this.qoe.Aa("scroll",
this.onScroll);this.FVk=cc.b(()=>{this.zba()},200,this.$.xa,dc.a.XFk,!0);C.EwaSettings.isChangeGateEnabled("OfficeVSO:8728441_moveHideSkeleton")?this.aBa.NO(bb.a.o7b):this.$.OO(bb.a.o7b);this.y_f&&(this.LUe=new oe(this.$,this.J6a.domElement))}X8g(){if(!this.Roj)return!1;Cc.a.instance.$K("SheetTabBarPromotion");const Pa=this.KWh(this.aBa.mTg);Cc.a.instance.WG("SheetTabBarPromotion");const lc=0===Pa.length;l.ULS.sendTraceTag(507839499,0,15,`SheetTabBar Skeleton Model Comparison ${lc?"Succeeded":"Failed"}.${lc?
"":` Mismatches: ${Pa.join(", ")}.`}`);lc&&Cc.a.instance.ym("SheetTabBarTTVRPromoted");return lc}get Pi(){return this.domElement}get Co(){return this.isVisible}get Hk(){return le.a.ooe}get F0(){return this.ybd}get h6b(){return this.wo.length}get TWc(){return this.MUe}get JKa(){return this.qMe}get navigationButtonsDisabled(){return!!this.fHa&&this.fHa.navigationButtonsDisabled}get operationButtonsDisabled(){return!!this.fHa&&this.fHa.operationButtonsDisabled}get fGj(){return this.$.LW?[Ka.a.Xrf,Ka.a.Yrf,
Ka.a.Zrf,Ka.a.Wrf,Ka.a.Uuc,Ka.a.Uuc]:[Ka.a.Wrf,Ka.a.Zrf,Ka.a.Yrf,Ka.a.Xrf,Ka.a.Uuc,Ka.a.Uuc]}get k4d(){return this.$.LW?[null,Pc.a.Udf,Pc.a.Sdf]:[null,Pc.a.Sdf,Pc.a.Udf]}get otg(){return this.$.LW?[null,Pc.a.Vdf,Pc.a.Tdf]:[null,Pc.a.Tdf,Pc.a.Vdf]}get gXb(){if(this.isRtl){if(u.a.KI)return 0;if(u.a.hm)return-1*(this.Fu.scrollWidth-this.Fu.clientWidth);if(u.a.IU)return this.Fu.scrollWidth-this.Fu.clientWidth;l.ULS.sendTraceTag(537153762,0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}get e4b(){if(this.isRtl){if(u.a.KI)return this.Fu.scrollWidth-
this.Fu.clientWidth;if(u.a.hm||u.a.IU)return 0;l.ULS.sendTraceTag(537153761,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.Fu.scrollWidth-this.Fu.clientWidth}get xmc(){return this.fHa?[this.w0,this.WSb]:[this.w0,this.WSb,this.J6a]}get GWg(){return this.wo.concat(this.J6a)}get kde(){return!this.BO}get lde(){return this.hoa===this.wo.length-1}get NFk(){return this.LUe}Sg(Pa,lc,Gc,Cd,Qd,ge,ye){ye=void 0===ye?!1:ye;Pa.removeAttribute("Href");Pa.setAttribute(bb.a.Oj,bb.a.fF);
Pa.className="ewa-stb-navbutton";Pa.title=lc;Pa.tabIndex=0;ge?Gc=this.svgIconProvider.lna(ge,12,12,Pa,24,24):(lc=document.createElement("span"),lc.className=Ka.a.pUh,lc.classList.add(Tc.a.irc),lc.tabIndex=-1,Pa.appendChild(lc),ge=document.createElement("img"),ge.src=La.a.$m(Gc),ge.className=Cd,ge.alt=Qd,ge.tabIndex=-1,lc.appendChild(ge),Gc=ge);ye&&Pa.classList.add(Tc.a.HGa);return Gc}dispose(){if(this.$){var Pa=this.$.sa;Pa.hn(this.aq);Pa.Qfe(this.jMa);Pa.Eba(this.vH);Pa.Yza(this.N_b);Pa.Zza(this.d1);
Pa.ZBg(this.nng);Pa.b3b(this.qng);Pa.yjk(this.ong);Pa.jge(this.ndg);Pa.XBg(this.odg);Pa.kge(this.pdg);Pa.YBg(this.g3a);this.$.Pr(this.xj);this.$.LK(this.Rp);yd.a(this.$)&&yd.a(this.$).Bm.$za(this.FY);this.fHa&&Hc.f(this.$).CBg(this.WZb);xd.a.instance.Na(xb.a.IM,this.domElement,this.EY);Lb.a.instance.Na(this.domElement,this.hp)}Rc.a.Ni(this.j4d);this.j4d=null;if(this.nY)for(Pa=0;Pa<this.nY.length;Pa++){const lc=kb.DOMElementExtensions.HO(this.nY[Pa],this.domElement,!1,"a");lc&&nd.a.BNa(lc)}Rc.a.Ng(this.LL);
Rc.a.Ng(this.VWc);Rc.a.Ng(this.qoe);this.qoe=this.VWc=this.WSb=this.w0=this.LL=null;this.$&&this.G4(!1);this.bma=null;this.jme(null,"Dispose");this.c8b=this.pX=this.Ltc=null;this.Ptd();this.uvb=this.soe=this.roe=this.Fu=this.nY=this.$=this.ea=null;super.dispose()}KWh(Pa){var lc,Gc;const Cd=[],Qd=[];if(null==Pa)Cd.push("WorkbookCacheItem was null, no cached state to compare");else if(Pa.xvb&&0!==Pa.xvb.length)if(this.h6b!==Pa.xvb.length)Cd.push(`SheetTab visible sheet number mismatch. Cached: ${Pa.xvb.length} Actual: ${this.h6b}`);
else{var ge=Pa.xvb;for(let ye=0;ye<this.wo.length;ye++){const $e=this.wo[ye].VWh(ge[ye]);0<$e.length&&Qd.push(`Button position ${ye}: ${$e.join(", ")}`)}(ge=null===(Gc=null===(lc=this.$.sa)||void 0===lc?void 0:lc.na)||void 0===Gc?void 0:Gc.name)&&ge===Pa.activeSheetName||Cd.push(`Active sheet mismatch. Cached value is null: ${!(null===Pa||void 0===Pa?0:Pa.activeSheetName)} Actual value is null: ${!ge}`);this.isRtl!==Pa.nVf&&Cd.push(`Rtl: isRtl: ${this.isRtl} cacheDisplayRtl: ${Pa.nVf}`);this.JWh(Cd,
Pa)}else Cd.push(`No cached sheet tabs, sheetTabs null: ${!Pa.xvb}`);0<Qd.length&&Cd.push(`SheetTabButton: [${Qd.join(", ")}]`);return Cd}zp(Pa,lc){if(!lc){l.ULS.shipAssertTag(537153760,0,0<this.wo.length,"There is no sheet tab button.");if(!this.wo.length)return!1;Pa=null;for(const Gc of this.wo)if(Pa=Gc.$Df())break;if(!Pa)return l.ULS.shipAssertTag(537153759,0,!1,"There is no focusable tab element."),!1;kb.DOMElementExtensions.setFocus(Pa)}return!lc}Yp(Pa){return kb.DOMElementExtensions.Cn(this.Pi,
Pa)}gs(){}Xt(){}reorderSheets(Pa,lc,Gc){if(this.Uaa&&this.Uaa!==Pa){const Cd=this.Uaa.index;this.Xlk(this.Uaa,Pa,lc);Pa=Pa?Pa.index-1:lc?this.$.sa.count-1:0;Cd!==Pa&&(this.Vyj(Cd,Pa,Gc),this.uhi(this.Uaa.name,Pa))}}vYi(Pa){Pa=this.Jva(Pa);return-1!==Pa&&this.BO<=Pa&&Pa<=this.hoa?this.wo[Pa].domElement:null}C3g(Pa){for(var lc=0;lc<this.nY.length;lc++){const Gc=this.nY[lc];if(Gc&&this.svgIconProvider){const Cd=Gc.parentNode;this.fBg(Gc);Cd&&(this.nY[lc]=this.svgIconProvider.lna(Pa?this.otg[lc]:this.k4d[lc],
12,12,Cd,24,24))}}for(lc=0;lc<this.wo.length;lc++)this.wo[lc].D3g(Pa);this.J6a&&this.J6a.jVa&&this.B3g(Pc.a.o_i,this.J6a,Pa);this.w0&&this.w0.jVa&&this.B3g(Pc.a.BWh,this.w0,Pa)}B3g(Pa,lc,Gc){lc.r1b||(lc.r1b=this.svgIconProvider.lna(Pa,12,12,lc.jVa.parentNode,24,24));lc.r1b&&(kb.DOMElementExtensions.setVisible(lc.jVa,!Gc),kb.DOMElementExtensions.setVisible(lc.r1b,Gc))}XWj(Pa,lc){var Gc=Hc.f(this.$);const Cd=Gc.inRangePicker,Qd=Wb.HelperMethods.$z(lc);if(Gc.isEditing&&!Cd){const ge=Gc.fA?"formulaBar_end_edit_sheet_changed":
"cell_text_end_edit_sheet_changed";let ye;ye=[Object(Sa.a)(Gc.cellTextEditBox.$b.oPa)];Sa.b(this.$).ix(Qd.rawEvent,ge,ye);Gc.endEdit(!0,"SheetTabBar.OnSheetTabMouseDown")}Gc=this.JKa&&3===lc.oh;!(2===lc.oh&&Qd.button===Sys.UI.MouseButton.leftButton||Gc)||Cd||this.F0||yd.a(this.$).Ex()||(Gc&&Pa.VWj(),this.JWb=lc.clientPoint.x,this.Qea=lc,this.AIh(Pa))}WWj(){this.zba()}L2e(){return this.$.isEditMode&&!Fd.l(this.$.Bk)}zba(){const Pa=Wb.HelperMethods.HM(()=>{this.i4k();this.dDk();this.Kme()});l.ULS.sendTraceTag(537153757,
0,50,`SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = ${Pa}`)}dDk(){const Pa=this.lde;kb.DOMElementExtensions.toggleCssClass(this.uvb,this.$.LW?"ewa-stb-right-scrollable":"ewa-stb-left-scrollable",!this.kde);kb.DOMElementExtensions.toggleCssClass(this.uvb,this.$.LW?"ewa-stb-left-scrollable":"ewa-stb-right-scrollable",!Pa)}Kme(Pa){Pa=void 0===Pa?!1:Pa;const lc=this.kde,Gc=this.lde;this.CMg(4,this.sheetTabActivatePreviousHidden,!lc);this.CMg(5,this.sheetTabActivateNextHidden,!Gc);
this.pWc(0,lc||Pa);this.pWc(1,lc||Pa);this.pWc(2,Gc||Pa);this.pWc(3,Gc||Pa)}CMg(Pa,lc,Gc){if(Pa=this.nY[Pa]){kb.DOMElementExtensions.setVisible(Pa,Gc);var Cd=this.lGf(Pa);Cd.title="img"===Pa.nodeName?Pa.alt=0<this.wo.length&&Gc?lc:"":Pa.title=0<this.wo.length&&Gc?lc:"";Cd.tabIndex=Gc?0:-1}}lGf(Pa){return Pa.parentNode}pWc(Pa,lc){if(Pa=this.nY[Pa])Pa=this.lGf(Pa),void 0!==Pa&&null!==Pa&&(!this.wo.length||lc?(Pa.classList.add(Tc.a.HGa),Pa.setAttribute(bb.a.HUa,"true")):(Pa.classList.remove(Tc.a.HGa),
Pa.setAttribute(bb.a.HUa,"false")))}E6a(Pa){const lc=this.$.LW?this.wo.length-1:0;let Gc=this.RIf(this.$.LW?0:this.wo.length-1);Gc&&(Gc.borderRightWidth=Pa?"1px":"0");this.BO!==this.hoa&&(Gc=this.RIf(lc))&&(Gc.borderRightWidth="0")}N_e(Pa,lc){this.wo||(this.wo=[]);-1===lc?this.wo.push(Pa):this.wo.splice(lc,0,Pa)}Zqc(Pa,lc){let Gc=-1,Cd=null;lc||(Gc=this.TOi(Pa.index),-1!==Gc&&(Cd=this.hZa(Gc)));Pa=new Rb(this.$,this.Fu,Cd,Pa,this);this.N_e(Pa,Gc);kb.DOMElementExtensions.setVisible(Pa.domElement,!0)}Spa(Pa){const lc=
Wb.HelperMethods.HM(()=>{switch(Pa){case 0:this.SUc(0);break;case 1:this.SUc(this.BO-1);break;case 2:this.SUc(this.BO+1);break;case 3:this.scrollIntoView(this.wo.length-1);break;case 6:this.tuk()}});this.Stc&&this.F0&&this.u9b();l.ULS.sendTraceTag(537153755,0,50,`SheetTabBarControl.ScrollSheetTabs: operation = ${Pa}, duration = ${lc}`)}Yui(Pa){if(0===Pa.iJ){const lc=this.$.sa;let Gc=0;for(let Cd=0,Qd=lc.count;Cd<Qd;Cd++){const ge=Object(Yb.a)(mc.a,lc.getItem(Cd));if(ge===Pa)return Gc;0===ge.iJ&&Gc++}}return-1}Lui(Pa){const lc=
this.$.sa;for(let Gc=Pa.index+1,Cd=lc.count;Gc<Cd;Gc++)if(Pa=Object(Yb.a)(mc.a,lc.getItem(Gc)),0===Pa.iJ)return Pa;return null}Jva(Pa){for(let lc=0;lc<this.wo.length;lc++){const Gc=this.l5(lc);if(!Gc)l.ULS.sendTraceTag(537153754,0,15,`SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[${lc}] is null even though index is not out of bounds!`);else if(Gc.sheet===Pa)return lc}return-1}YNb(Pa){Pa=this.Jva(Pa);return this.l5(Pa)}Vyj(Pa,lc,Gc){const Cd={};Cd.a=this.$.ua.UserSessionId;Cd.b=Gc;Cd.c=
this.Btc;Cd.d=Pa;Cd.e=lc;Cd.f=this.$.sa.count;Da.b().tl(2,Cd,Gc)}Xlk(Pa,lc,Gc){const Cd=Object(Yb.a)(Jc.a,this.$.sa);lc?(lc=lc.index,lc=Pa.index<lc?lc-1:lc):lc=Gc?Cd.count-1:0;Cd.reorderSheet(Pa,lc,!0)}zAk(Pa){Hc.f(this.$).Um.Mx(Pa)}AIh(Pa){if(!this.lTc){const lc=this.domElement.ownerDocument.body;$d.a.instance.ya(xb.a.$u,document.documentElement,this.$2a);this.JKa&&(Td.a.instance.ya(xb.a.kn,document.documentElement,this.$2a),Td.a.instance.ya(xb.a.kn,this.domElement,this.HY));$d.a.instance.ya(xb.a.jo,
document.documentElement,this.a3a);Td.a.instance.ya(xb.a.Ok,lc,this.a3a);this.lTc=!0}this.Uaa=Pa.sheet;this.Btc=!1;this.pX=null;this.Ltc=Pa;this.bma=Pa.domElement;this.jme(kb.DOMElementExtensions.getBoundingClientRect(this.bma),"BeginSheetTabButtonDrag")}G4(Pa){Pa=void 0===Pa?!0:Pa;if(this.lTc){this.zAk(bb.a.Q$);const lc=this.domElement.ownerDocument.body;$d.a.instance.Na(xb.a.$u,document.documentElement,this.$2a);this.JKa&&(Td.a.instance.Na(xb.a.kn,document.documentElement,this.$2a),Td.a.instance.Na(xb.a.kn,
this.domElement,this.HY));$d.a.instance.Na(xb.a.jo,document.documentElement,this.a3a);Td.a.instance.Na(xb.a.Ok,lc,this.a3a);this.ybd=this.lTc=!1}this.PPc=0;this.Btc=!1;this.Uaa=null;this.bma&&(this.bma.style.visibility="visible",this.bma=null);this.Ltc=null;this.jme(null,"EndSheetTabButtonDrag");this.pX&&(this.pX.parentNode&&this.pX.parentNode.removeChild(this.pX),this.pX=null);this.Gok(Pa)}Gok(Pa){this.gse(Pa);this.nM=this.JWb=-1}uhi(Pa,lc){const Gc=this.$.pa,Cd=Gc?Gc.ta:null;this.$.userOperationManager.enqueueOperation(new Y.a(557,
0,(Qd,ge,ye)=>{const $e=Cd.Za(9,null);$e.sheetName=Pa;$e.newSheetIndex=lc;return Ha.h(Cd,"ReorderSheets",$e,Qd,ge,ye,null,0)},64,()=>new te(Pa,lc)),null)}l5(Pa){return 0<=Pa&&Pa<this.wo.length?this.wo[Pa]:null}AUi(Pa){return(Pa=this.l5(Pa))?Pa.sheet:null}hZa(Pa){return(Pa=this.l5(Pa))?Pa.domElement:null}RIf(Pa){return(Pa=this.hZa(Pa))?Pa.style:null}TOi(Pa){const lc=this.$.sa;Pa+=1;let Gc=-1;const Cd=this.wo?this.wo.length:0;for(;Pa<lc.count;){const Qd=Object(Yb.a)(mc.a,lc.getItem(Pa));if(0===Qd.iJ){for(Gc=
0;Gc<Cd&&this.AUi(Gc)!==Qd;Gc++);break}Pa++}return-1===Gc||Gc===Cd?-1:Gc}lng(Pa){var lc=this.YNb(Pa);lc&&(this.F0&&(l.ULS.sendTraceTag(537153751,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),C.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.G4()),this.Fu.removeChild(lc.domElement),lc=Array.indexOf(this.wo,lc),this.wo.splice(lc,1),this.zba(),(!this.isRtl&&lc===this.wo.length||
this.isRtl&&!lc)&&this.E6a(!0),this.Stc&&this.F0?Pa===this.Uaa?(this.G4(),this.Spa(6)):this.u9b():this.Spa(6))}mng(Pa){const lc=Object(Yb.a)(mc.a,Pa);this.F0&&(l.ULS.sendTraceTag(537153750,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),C.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.G4());if(0===lc.iJ){this.E6a(!1);var Gc=this.Jva(Pa);-1===Gc&&(l.ULS.sendTraceTag(537153749,
0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),this.Zqc(lc,!1),Gc=this.Jva(Pa));this.ZMf(Gc,!0)}}Ylk(Pa,lc){const Gc=this.YNb(Pa);Gc&&(this.F0&&!lc&&(l.ULS.sendTraceTag(537153748,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),C.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.G4()),Pa=this.RTk(Pa,Gc),!C.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&
Pa&&lc&&Pa.UWj())}RTk(Pa,lc){var Gc=Array.indexOf(this.wo,lc);const Cd=this.Yui(Object(Yb.a)(mc.a,Pa));if(-1===Cd||-1===Gc)return null;this.E6a(!1);({Cvi:this.BO,Ssj:this.hoa}=jg.Ulk(Gc,Cd,this.BO,this.hoa));lc&&lc.domElement.parentNode===this.Fu&&(this.Fu.removeChild(lc.domElement),this.wo.splice(Gc,1));lc=this.Lui(Pa);lc=this.Jva(lc);Gc=new Rb(this.$,this.Fu,this.hZa(lc),Object(Yb.a)(mc.a,Pa),this);this.N_e(Gc,lc);lc=this.Jva(Pa);this.ZMf(lc,!1);return Gc}tii(){const Pa=this.wo?this.wo.length:0,
lc=this.BO,Gc=this.hoa;for(let Cd=0;Cd<Pa;Cd++){const Qd=this.l5(Cd),ge=Cd>=lc;Qd&&(Qd.tabIndex=ge&&Cd<=Gc?0:-1)}}Q2k(){const Pa=this.wo?this.wo.length:0;for(let lc=0;lc<Pa;lc++){const Gc=this.l5(lc);Gc&&Gc.Vxb()}}ZMf(Pa,lc){lc&&Pa<=this.BO&&this.BO++;this.tii();this.E6a(!0);this.zba();this.Stc&&this.F0&&this.u9b()}bWc(Pa){const lc=this.$.LW;if(Pa||this.isRtl!==lc)this.isRtl=lc,this.domElement.classList.remove(this.isRtl?Ka.a.uNb:Ka.a.vNb),this.domElement.classList.add(this.isRtl?Ka.a.vNb:Ka.a.uNb),
this.domElement.dir=this.isRtl?"rtl":"ltr",this.Q2k();Pa||this.E6a(!0);for(Pa=0;Pa<this.nY.length;Pa++)0!==Pa&&3!==Pa&&4!==Pa&&5!==Pa&&this.DMg(Pa)}R3h(){const Pa=this.roe=document.createElement("div");Pa.className="ewa-stb-navarea";Pa.classList.add("ewa-stb-navarea-dimensions");this.domElement.appendChild(Pa);this.Rhf(Pa,1,717,716);this.Rhf(Pa,2,719,718);this.y_f&&(this.J6a=new Kd(this.$,this,Pa))}S3h(){const Pa=this.soe=document.createElement("div");Pa.className="ewa-stb-navareaextra";this.domElement.appendChild(Pa);
this.fxd()}Y4h(){const Pa=document.getElementById(bb.a.JFk),lc=document.getElementById(bb.a.KFk);Pa&&!lc&&l.ULS.sendTraceTag(537153746,0,50,`CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: ${Pa.parentNode.id}. progressBar div has child: ${!!Pa.firstChild}. ProgressBarMessage div exists: ${!!document.getElementById(bb.a.goe)}`);const Gc=$b.a.D_f(this.$);if(Gc&&Pa&&lc)this.domElement.appendChild(Pa),this.vvb=Pa.firstChild,this.wvb=document.getElementById(bb.a.goe),
lc.style.visibility="visible";else{const Cd=document.createElement("div"),Qd=document.createElement("div");Cd.className=Ka.a.lmi;Qd.className=Ka.a.jmi;Qd.id=bb.a.foe;Qd.style.display="none";const ge=document.createElement("div");ge.className=Ka.a.mmi;const ye=document.createElement("div");ye.className=Ka.a.kmi;const $e=document.createElement("div");$e.className=Ka.a.imi;Qd.appendChild(ge);Qd.appendChild(ye);Qd.appendChild($e);Cd.appendChild(Qd);this.domElement.appendChild(Cd);this.vvb=Qd;this.wvb=
ye;l.ULS.sendTraceTag(512275475,0,50,"SheetTabBarControl.createProgressBarArea: Create the progress bar in this function, because isSkeletonProgressBarEnabled = {0}, skeletonProgressBar={1}, skeletonProgressBarSeperator={2}.",Gc,Pa,lc)}}DMg(Pa){var lc=this.nY[Pa];if(lc){const Gc=lc.parentNode;this.fBg(lc);lc=pb.a(this.$)?this.otg[Pa]:this.k4d[Pa];this.nY[Pa]=this.svgIconProvider.lna(lc,12,12,Gc,24,24)}}fBg(Pa){(null===Pa||void 0===Pa?0:Pa.parentNode)&&Pa.parentNode.removeChild(Pa)}q1h(){const Pa=
this.uvb=document.createElement("div");Pa.className="ewa-stb-contentarea";this.domElement.appendChild(Pa);this.a6h(Pa)}a6h(Pa){const lc=document.createElement("div");lc.className="ewa-stb-tabarea";lc.classList.add("ewa-stb-disable-scrollbar");this.$.printingEnabled||lc.classList.add(vc.Bb);Pa.appendChild(lc);this.Fu=document.createElement("ul");kb.DOMElementExtensions.UK(this.Fu,bb.a.npd,null,null);this.Fu.className=vc.hb;lc.appendChild(this.Fu);this.J3h();this.MUe=document.createElement("div");this.TWc.id=
"SheetIconTooltipContainer";lc.appendChild(this.TWc)}J3h(){const Pa=document.createElement("div"),lc=document.createElement("div"),Gc=La.a.jCf(Ka.a.dni);lc.className=Ka.a.tUh;lc.appendChild(Gc);Pa.appendChild(lc);Pa.className="ewa-stb-sheettabmoveindicator";kb.DOMElementExtensions.setVisible(Pa,!1);this.Fu.appendChild(Pa)}xxd(){const Pa=this.$.sa;for(let lc=0,Gc=Pa.count;lc<Gc;lc++){const Cd=Object(Yb.a)(mc.a,Pa.getItem(lc));0===Cd.iJ&&(this.Zqc(Cd,!0),Cd.active&&Cd.activate({scenario:"createSheetTabs"}))}}Ptd(){Rc.a.Ni(this.wo);
this.wo=[];this.hoa=this.BO=0}Rhf(Pa,lc,Gc,Cd){const Qd=document.createElement("a");Pa.appendChild(Qd);Pa=this.k4d[lc];this.nY[lc]=this.Sg(Qd,sa.a.instance.ia(Cd),0,this.fGj[lc],sa.a.instance.ia(Gc),Pa);if(5===lc||4===lc)kb.DOMElementExtensions.HO(this.nY[lc],Qd,!1,"span").style.marginTop="10px";this.DMg(lc);Gc=this.j4d[lc]=this.Xk.Ek(Qd);$d.a.instance.ya(xb.a.Zi,Qd,ye=>ye.ctrlKey&&this.aNj(lc)?!0:this.lkg(lc));$d.a.instance.ya(xb.a.jo,Qd,()=>this.mkg());Td.a.instance.ya(xb.a.Ok,Qd,()=>this.mkg());
$d.a.instance.ya(xb.a.kB,Qd,()=>this.Itd());He.a.instance.ya(xb.a.zi,Qd,ye=>13!==ye.La.keyCode&&32!==ye.La.keyCode||this.Gvd?!1:(this.Gvd=!0,this.lkg(lc)));He.a.instance.ya(xb.a.Rj,Qd,ye=>13===ye.La.keyCode||32===ye.La.keyCode?(this.Gvd=!1,this.Itd()):!1);const ge=this.L2e();Cd=ye=>{"mouseup"===ye.type&&this.F0||rb.g(ye);!Qd.classList.contains(Tc.a.HGa)&&ge&&this.CTj(ye,lc)};Gc.Aa("mouseover",Cd);Gc.Aa("mouseout",Cd);Gc.Aa("focus",Cd);Gc.Aa("blur",Cd);ge&&Gc.Aa("mouseup",Cd)}Yhj(Pa){let lc=!1;const Gc=
this.$.ll;Gc&&(lc=oc.a.$X(kb.DOMElementExtensions.getBoundingClientRect(Gc),Pa.clientPoint));return lc}u9b(){if(!this.pX){l.ULS.sendTraceTag(537153743,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");this.pX=this.bma.cloneNode(!0);if(!this.oHg(this.pX,this.bma,!0,"UpdateDragAndDropState"))return;this.bma.style.visibility="hidden";this.pX.classList.add("ewa-stb-tabs-ghost");this.pX.style.borderRightWidth="";this.NAc=this.Qea.clientPoint.x-this.cfa.width/2;
this.pX.style.left=this.NAc+"px";this.nM=this.Jva(this.Uaa);0>this.nM&&l.ULS.sendTraceTag(537153742,0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.Stc&&(this.nM=this.Jva(this.Uaa));var Pa=kb.DOMElementExtensions.getBoundingClientRect(this.Fu);const lc=Pa.x;Pa=Pa.x+Pa.width;let Gc=this.Qea.clientPoint.x-this.cfa.width/2;Gc=Math.min(Gc,Pa-this.cfa.width);Gc=Math.max(Gc,lc);this.pX.style.transform="translateX("+Math.abs(Gc-this.NAc)*(this.NAc<Gc?1:-1)+"px)";const Cd=this.Qea.clientPoint.x>
this.JWb;let Qd=this.Qea.clientPoint.x;Gc>=Pa-this.cfa.width?(Qd=Pa-this.cfa.width/2,this.vke()||this.Jza||(l.ULS.sendTraceTag(537153741,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.TOc=this.Fu.scrollLeft,this.Jza=window.requestAnimationFrame(this.WIg))):Gc<=lc?(Qd=lc+this.cfa.width/2,this.uke()||this.Jza||(l.ULS.sendTraceTag(537153740,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),
this.TOc=this.Fu.scrollLeft,this.Jza=window.requestAnimationFrame(this.VIg))):this.Jza&&(l.ULS.sendTraceTag(537153739,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.gse());this.Qea.clientPoint.x!==this.JWb&&(this.Vse(Cd,Qd),this.JWb=this.Qea.clientPoint.x);this.ybd=!0}Vse(Pa,lc){let Gc;for(;(()=>{let Cd=this.rei(lc,Pa);({Znc:Gc}=Cd);return Cd})().returnValue;)this.c8b=Gc,this.vDh(Pa)}vDh(Pa){if(this.c8b){var lc=(Pa?1:-1)*this.cfa.width;
if(Pa&&!this.$.LW||!Pa&&this.$.LW){var Gc=this.bma;var Cd=this.nM+1;var Qd=!0}else Gc=(Cd=this.l5(this.nM+1))?Cd.domElement:null,Cd=this.nM-1,Qd=!1;if(this.oHg(this.c8b,Gc,Qd,"AnimateSheetSwap")){l.ULS.sendTraceTag(537153738,0,50,`SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index ${this.nM} and other sheet-index ${Cd}. amount of sheets in the bar: ${this.h6b} isMovingRight: ${Pa}`);0<=this.nM&&this.nM<this.wo.length&&0<=Cd&&Cd<this.wo.length?(Pa=this.wo[Cd],this.wo[Cd]=this.wo[this.nM],
this.wo[this.nM]=Pa):(l.ULS.sendTraceTag(537153737,0,15,`SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: ${this.wo.length}, ghostIndex: ${this.nM}, swappedSheetIndex: ${Cd}`),this.G4());this.nM=Cd;var ge=this.c8b;ge.style.transform="translateX("+lc+"px)";window.requestAnimationFrame(()=>{ge.style.transform="translateX(0px)"})}}}oHg(Pa,lc,Gc,Cd){const Qd=ge=>ge?`Node ID: ${ge.id} , Node class: ${ge.className}, Node name: ${ge.nodeName},`:null;try{return this.Fu.insertBefore(Pa,
lc),!0}catch(ge){return Pa=this.YNb(this.Uaa),l.ULS.sendTraceTag(537153736,0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",Pa?Pa!==this.Ltc?"Changed":"NoChange":"Removed",Cd,Qd(lc),Qd(lc.parentNode),Qd(this.Fu),Gc,
this.nM,this.h6b,ge),this.G4(),!1}}rei(Pa,lc){var Gc=this.$.LW===lc?this.l5(this.nM-1):this.l5(this.nM+1);if(!Gc)return{returnValue:!1,Znc:null};Gc=Gc.domElement;const Cd=kb.DOMElementExtensions.getBoundingClientRect(Gc);return this.cfa?lc?{returnValue:Pa+this.cfa.width/2>=Cd.x+.5*Cd.width,Znc:Gc}:{returnValue:Pa-this.cfa.width/2<=Cd.x+.5*Cd.width,Znc:Gc}:(l.ULS.sendTraceTag(537153735,0,50,"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),
this.G4(),{returnValue:!1,Znc:Gc})}TIg(Pa,lc){let Gc;Gc=lc?this.WIg:this.VIg;if(-1===this.NYc)this.NYc=Pa,this.Jza=window.requestAnimationFrame(Gc);else{Pa=Math.floor((Pa-this.NYc)/1E3*300);var Cd=this.e4b>this.gXb?1:-1;this.scrollLeft(Math.abs(this.Fu.scrollLeft-(lc?this.TOc+Pa*Cd:this.TOc-Pa*Cd))*(lc?-1:1));if(Pa=this.qEf("ScrollStep"))this.Vse(lc,Pa.x+Pa.width/2),lc&&!this.vke()||!lc&&!this.uke()?this.Jza=window.requestAnimationFrame(Gc):(l.ULS.sendTraceTag(537153734,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),
this.gse())}}vke(){const Pa=this.e4b>this.gXb;return Pa&&this.sAa>=this.e4b||!Pa&&this.sAa<=this.e4b}uke(){const Pa=this.e4b>this.gXb;return Pa&&this.sAa<=this.gXb||!Pa&&this.sAa>=this.gXb}gse(Pa){Pa=void 0===Pa?!0:Pa;this.Fu&&(this.sAa=this.Fu.scrollLeft);window.cancelAnimationFrame(this.Jza);this.Jza=0;this.NYc=-1;Pa&&this.zba()}jme(Pa,lc){Pa||l.ULS.sendTraceTag(537153733,0,50,`SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by ${lc}`);this.cfa=Pa}aNj(Pa){return 2===
Pa?(this.Spa(3),!0):1===Pa?(this.Spa(0),!0):!1}lkg(Pa){l.ULS.shipAssertTag(537153732,0,-1===this.$3a&&-1===this.Z3a,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");-1!==this.$3a&&(window.clearTimeout(this.$3a),this.$3a=-1);-1!==this.Z3a&&(window.clearInterval(this.Z3a),this.Z3a=-1);this.Spa(Pa);this.$3a=window.setTimeout(()=>{this.lRk(Pa)},this.VFj);return!0}lRk(Pa){this.Z3a=window.setInterval(()=>{this.Spa(Pa)},
this.UFj)}mkg(){this.Itd();return!this.F0}Itd(){window.clearTimeout(this.$3a);window.clearInterval(this.Z3a);this.Z3a=this.$3a=-1;return!0}CTj(Pa,lc){const Gc=this.AUb(lc),Cd=5===lc;"mouseup"!==Pa.type||!Cd&&4!==lc||(Gc||this.reorderSheets(null,Cd,!1),this.G4())}AUb(Pa){return!!kb.DOMElementExtensions.MDf(this.nY[Pa],"a").title}Q1c(Pa){this.Bxe(Pa);this.zba()}Bxe(Pa){(Pa=this.YNb(Pa))&&Pa.Vxb()}tuk(){var Pa=this.$.sa;if(Pa.na&&(!rg.e(this.$)||Pa.count))if(Pa=this.Jva(Pa.na),-1===Pa)l.ULS.sendTraceTag(537153729,
0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");else{var lc=this.hZa(Pa);Pa<this.BO?this.SUc(Pa):Pa>this.BO&&!this.pXd(lc)&&this.scrollIntoView(Pa)}}i4k(){this.BO=0;this.hoa=this.wo.length-1;let Pa=!1;for(let lc=0;lc<this.wo.length;lc++){const Gc=this.l5(lc);if(!Gc)break;const Cd=this.pXd(Gc.domElement);Gc.tabIndex=Cd?0:-1;if(!Pa&&Cd)this.BO=lc,Pa=!0;else if(Pa&&!Cd){this.hoa=lc-1;break}}}SUc(Pa){this.$.sa.count&&(this.wo.length||this.xxd(),this.HKg(this.hZa(Math.max(0,
Math.min(Pa,this.wo.length-1)))),this.zba())}scrollIntoView(Pa){l.ULS.shipAssertTag(537153697,0,Pa>=this.BO,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visible sheet tab index!");if(this.$.sa.count){this.wo.length||this.xxd();var lc=this.hZa(Math.max(0,Math.min(Pa,this.wo.length-1))),Gc=this.hZa(this.BO);if(!this.pXd(lc)){lc=kb.DOMElementExtensions.getBoundingClientRect(lc);var Cd=kb.DOMElementExtensions.getBoundingClientRect(this.uvb);lc=this.isRtl?Cd.x-lc.x:
lc.x+lc.width-(Cd.x+Cd.width);for(Cd=0;Gc&&Cd<lc;){const Qd=kb.DOMElementExtensions.getBoundingClientRect(Gc);Cd+=Qd.width;Gc=Gc.nextSibling}Gc?this.HKg(Gc):l.ULS.sendTraceTag(537153696,0,15,`SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = ${this.BO}, lastVisibleSheetTabIndex = ${this.hoa}, scroll to index: ${Pa}`)}this.zba()}}HKg(Pa){const lc=kb.DOMElementExtensions.getBoundingClientRect(this.Fu);Pa=kb.DOMElementExtensions.getBoundingClientRect(Pa);this.isRtl?
this.scrollLeft(Math.floor(lc.x+lc.width-(Pa.x+Pa.width+.5))):this.scrollLeft(Math.ceil(lc.x-Pa.x-.5))}scrollLeft(Pa){(0>Pa&&this.vke()||0<Pa&&this.uke())&&l.ULS.sendTraceTag(537153695,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");const lc=this.Fu.scrollLeft;if(this.isRtl){if(u.a.KI||u.a.hm){this.Fu.scrollLeft=this.sAa=lc-Pa;return}if(u.a.YO){this.Fu.scrollLeft=this.sAa=lc+Pa;return}l.ULS.sendTraceTag(537153694,0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.Fu.scrollLeft=
this.sAa=lc-Pa}pXd(Pa){Pa=kb.DOMElementExtensions.getBoundingClientRect(Pa);const lc=kb.DOMElementExtensions.getBoundingClientRect(this.uvb);return Pa&&lc?Pa.x>=lc.x-1&&Pa.x+Pa.width<=lc.x+lc.width+1:(l.ULS.sendTraceTag(537153693,0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1)}n4h(){const Pa=this.soe;jd.tPg(this.$)?(Rc.a.Ng(this.w0),this.w0=new jd(Pa,this.$,this,!0),C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReportStbMetricsAfterDomReady",
!1)&&(this.tDc=!1)):(Rc.a.Ng(this.w0),Fd.l(this.$.Bk)?this.w0=new Vb(Pa,this.$,this):this.w0=new jd(Pa,this.$,this),C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReportStbMetricsAfterDomReady",!1)&&(this.tDc=!0))}$hf(Pa,lc){var Gc=this.$.sa;if(!this.$.isEditMode||!Gc.count)Rc.a.Ng(lc),lc=null;else if(!lc)if(Gc=this.roe,Fd.l(this.$.Bk))lc=new Vb(Gc,this.$,this);else switch(Pa){case 0:lc=new jd(Gc,this.$,this);break;case 1:lc=new Yd(Gc,this.$,this);break;default:l.ULS.sendTraceTag(537153692,
0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return lc}VDg(){this.WDg||(this.X8g()?Cc.a.instance.rsb(bb.a.R1,["sheetTabBar"]):(this.aBa.mTg||Cc.a.instance.w1(bb.a.R1,["sheetTabBar"]),this.aBa.sTh(),Cc.a.instance.x1(bb.a.R1,["sheetTabBar"])),Cc.a.instance.Iba(bb.a.R1,["sheetTabBar"]),this.WDg=!0)}fxd(){this.kkj?(this.w0=this.$hf(0,this.w0),this.WSb=this.$hf(1,
this.WSb)):this.n4h()}qEf(Pa){const lc=kb.DOMElementExtensions.getBoundingClientRect(this.pX);lc||(l.ULS.sendTraceTag(537153689,0,50,`SheetTabBarControl.${Pa}: GetBoundingClientRect returned null for the dragged sheet.`),this.G4());return lc}QMf(Pa,lc){l.ULS.sendTraceTag(507646810,0,50,`SheetTabBarControl.handleRequestToChangeDisabledState: requestId=${Pa}, requestedState=${lc}`);this.fHa.KEh(Pa,lc);this.G4(!1);this.Kme(this.navigationButtonsDisabled);if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:8509448_StartSheetTabBarButtonsEnabled")){for(const Gc of this.GWg)Gc&&
Gc.C_c(this.navigationButtonsDisabled);for(const Gc of this.xmc)Gc&&Gc.C_c(this.operationButtonsDisabled)}else{for(const Gc of this.GWg)Gc&&Gc.d2(this.navigationButtonsDisabled);for(const Gc of this.xmc)Gc&&Gc.d2(this.operationButtonsDisabled)}}JWh(Pa,lc){if(C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SheetTabCompareButtonsState",!1)){var Gc=!this.kde,Cd=!this.lde;Gc===lc.ztg&&Cd===lc.Abg||Pa.push(`Sheet scroll buttons enabled mismatch. prevNavButtonEnabled: ${Gc} nextNavButtonEnabled: ${Cd}, cached prevNavButtonEnabled: ${lc.ztg} cached nextNavButtonEnabled: ${lc.Abg}`);
this.tDc!==lc.qSf&&Pa.push(`New sheet button mismatch. insertSheetButtonEnabled: ${this.tDc}, skeletonNewSheetEnabled: ${lc.qSf}`)}}static Ulk(Pa,lc,Gc,Cd){Pa<Gc?(lc>Gc&&Gc--,lc>Cd&&Cd--):Pa>Cd?(lc<Gc&&Gc++,lc<Cd&&Cd++):lc<Gc&&Gc++;return{Cvi:Gc,Ssj:Cd}}}Object(w.a)(jg,"SheetTabBarControl",fc.a,[898,2,59]);var If=a(93);Object(W.b)(N.Kf,{yk:"singleton"})(Pa=>No(function*(){const lc=yield W.a.resolve(N.Lb,Pa);var Gc=lc.$h;if(Mb.a(lc.ua,1))return Cc.a.instance.v5a(bb.a.R1,["sheetTabBar"]),null;Gc=document.getElementById(Gc+
bb.a.Vrc);if(!Gc)return Cc.a.instance.v5a(bb.a.R1,["sheetTabBar"]),null;Cc.a.instance.NBa(bb.a.R1);const Cd=Object(If.e)(sc.GetServiceTaskFactory.Bj(lc.ka,388,387,null===Pa||void 0===Pa?void 0:Pa.va)),Qd=W.a.resolve(N.Of),[ge,ye]=yield Promise.all([Cd,Qd]);return new jg(lc,Gc,ye,ge)}));class cf extends gc.a{constructor(Pa){super();this.$=Pa;this.Bl()}create(){var Pa=this.$.$h;if(Mb.a(this.$.ua,1))Cc.a.instance.v5a(bb.a.R1,["sheetTabBar"]);else{var lc=document.getElementById(Pa+bb.a.Vrc);if(lc){if(C.EwaSettings.isChangeGateEnabled("OfficeVSO:8494154_FixSheetTabBarInitTime")&&
(Pa=this.$.ka.Ug(32))){this.Yj(Pa);return}Cc.a.instance.NBa(bb.a.R1);var Gc=sc.GetServiceTaskFactory.Bj(this.$.ka,388,387,this.hh),Cd=Object(If.d)(W.a.resolve(N.Of));B.TaskExtensions.Ua(B.TaskExtensions.Ln([Gc,Cd],this.$.xa),()=>{this.Yj(this.$.ka.Ug(32)||new jg(this.$,lc,Cd.result,Gc.result))},this.$.xa,3)}else Cc.a.instance.v5a(bb.a.R1,["sheetTabBar"])}}static Aa(Pa){Pa.ka.ph(33,new cf(Pa))}}Object(w.a)(cf,"SheetTabBarFactory",gc.a,[]);var Nb=a(1103),Bc=a(1536),Ob;(function(Pa){Pa[Pa.unknown=0]=
"unknown";Pa[Pa.supported=1]="supported";Pa[Pa.vsl=2]="userUnsupportedAnonymous";Pa[Pa.wsl=3]="userUnsupportedNoLoginHint";Pa[Pa.Mil=4]="hostUnsupported";Pa[Pa.Iql=5]="perfAutomation"})(Ob||(Ob={}));Object(w.b)("SupportStatus",Ob);var zc;(function(Pa){Pa[Pa.external=0]="external";Pa[Pa.Rjl=1]="msa";Pa[Pa.Jgl=2]="aad"})(zc||(zc={}));Object(w.b)("AuthorityType",zc);var od=a(949);class ce{constructor(Pa){this.Jlh=Pa}initialize(){return Promise.resolve(0)}uJc(){return Promise.resolve(0)}JD(){l.ULS.sendTraceTag(574239257,
3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new od.a,{IsSuccess:!0,Token:this.Jlh}))}g0c(){return Promise.resolve(Object.assign(new od.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}dCc(){}AZc(){return!1}LQb(){return"MockAuthTokenStrategy"}}Object(w.a)(ce,"MockAuthTokenStrategy",null,[899]);var Qb=a(1156);class Xc{static get(Pa,lc,Gc){if(!Gc)return Pa;
let Cd=0;return Promise.race([Pa,new Promise(Qd=>{Cd=window.setTimeout(()=>{Qd(lc)},Gc)})]).then(Qd=>{window.clearTimeout(Cd);return Promise.resolve(Qd)}).catch(()=>{window.clearTimeout(Cd);return Promise.resolve(lc)})}}Object(w.a)(Xc,"PromiseWithTimeout",null,[]);var md=a(596);class ie{constructor(Pa,lc,Gc,Cd,Qd){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=null;this.resource=Pa;this.scope=lc;this.silentLogin=Gc;this.options=Cd;this.correlationId=Qd}}Object(w.a)(ie,
"TokenRequestParameters",null,[312]);class me{constructor(){this.QXe=null;let Pa=Ia.AFrameworkApplication.fa.Xa(Ia.AFrameworkApplication.vZ),lc=Ia.AFrameworkApplication.fa.Xa(Ia.AFrameworkApplication.g0g);this.Nbb=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",Pa&&""!==Pa?Pa:"Unspecified",lc&&""!==lc?lc:"Unspecified")}initialize(){return new Promise(Pa=>{wa.a.instance.Qi("Common.App.WopiIdentity.IWopiIdentity").execute(lc=>{this.QXe=lc;Pa(0)})})}Lq(Pa){const lc=["HTTPS:",
"API:"];let Gc=!1;const Cd=Pa.toLocaleUpperCase();for(const Qd of lc)if(Cd.startsWith(Qd)){Gc=!0;break}return Gc||this.Cjj(Pa)?Pa+"/.default":Pa}Cjj(Pa){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(Pa)}uJc(){return Promise.resolve(0)}JD(Pa,lc,Gc,Cd,Qd,ge,ye){if(u.a.PKa){Qd=md.a.lal;if(!Qd)return lc=Object.assign(new od.a,{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(lc);if(!Array.contains(Qd,
Pa))return lc=Object.assign(new od.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+Pa}),Promise.resolve(lc)}Pa=this.Lq(Gc);Gc=new ie(Gc,Pa,!Cd,null,Ia.AFrameworkApplication.userSessionId);return this.QXe.getAccessToken(Gc,lc,ye).then($e=>Object.assign(new od.a,{IsSuccess:!0,Token:$e.accessToken}),$e=>Object.assign(new od.a,{IsSuccess:!1,ErrorCode:$e}))}g0c(){return Promise.resolve(Object.assign(new od.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",
ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}dCc(){}AZc(){return!1}LQb(){return this.Nbb}}Object(w.a)(me,"ParentFrameTokenStrategy",null,[899]);var Pe=a(1152);class gf{constructor(){this.reject=this.resolve=null;this.startTime=0;this.Xug=this.zmc=null}}Object(w.a)(gf,"PromiseWrapper",null,[]);class tf{constructor(Pa){Pa=void 0===Pa?0:Pa;this.pL=0;this.kDb=!1;this.Pv=new U.a;this._timeout=Pa}enqueue(Pa){return new Promise((lc,Gc)=>{this.Pv.add(Object.assign(new gf,
{Xug:Pa,resolve:lc,reject:Gc}));this.process()})}process(){if(this.kDb||this.pL===this.Pv.count)return!1;const Pa=this.Pv.ma(this.pL++);try{this.kDb=!0,Pa.Xug().then(lc=>{this.kDb=!1;this.evd(Pa,lc,null,!0)}).catch(lc=>{this.kDb=!1;this.evd(Pa,null,lc,!1)})}catch(lc){this.kDb=!1,this.evd(Pa,null,lc,!1)}return!0}evd(Pa,lc,Gc,Cd){if(Cd){const Qd=()=>{Pa.resolve(lc);this.process()};0<this._timeout?window.setTimeout(()=>{Qd()},this._timeout):Qd()}else{const Qd=()=>{Pa.reject(Gc);this.process()};0<this._timeout?
window.setTimeout(()=>{Qd()},this._timeout):Qd()}}}Object(w.a)(tf,"PromiseQueue",null,[]);class Qe{constructor(){this.correlationId=this.resolve=null}}Object(w.a)(Qe,"ResolveWithCorrelation",null,[]);var Ca=a(937),yb=a(159),wc=a(23);class dd extends Ea.a{constructor(Pa,lc,Gc,Cd,Qd,ge){super(!1,!1,!0);this.gHe=this.Rca=null;this.QWj=()=>{this.Cyf()};this.x2h=()=>this.PC;this.zFk=ye=>{0===ye&&(this.Zqh.reject(Object.assign(new od.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),
this.dSa(null))};this.g3=Pa;this.lnh=Gc;this.VE=Cd;this.Zqh=Qd;this.dSa=ge;this.PC=document.createElement("iframe");this.PC.id="SharedAuthInteractiveFrame";this.PC.setAttribute("name","SharedAuthInteractiveFrame");this.PC.setAttribute("title","SharedAuthInteractiveFrame");this.PC.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.PC.style.border="0";this.PC.style.height="48px";this.PC.style.width="190px";$addHandler(this.PC,"error",this.QWj);Pa=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",
this.g3,lc,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1","&WacUserType=",Ia.AFrameworkApplication.userType);this.PC.src=Pa;this.Dgh=new Promise(ye=>{this.gHe=ye});this.hHe=!1}Rpe(){this.Rca={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.lnh,["errorText"]:Object(wc.a)("InternalError"),["rtl"]:Ia.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:this.x2h,["resolveDialogStyles"]:this.gHe}};this.Bh=5;this.initializeAndShow(Object(wc.a)("SignIn"),
this.zFk,this.Rca)}F8a(Pa,lc,Gc){Pa=void 0===Pa?!1:Pa;lc=void 0===lc?!1:lc;Gc=void 0===Gc?5:Gc;this.Rca&&this.Rca.bodyControls&&(Pa!==Object(Yb.a)(Object,this.Rca.bodyControls).frameLoaded&&(Object(Yb.a)(Object,this.Rca.bodyControls).frameLoaded=Pa),lc!==Object(Yb.a)(Object,this.Rca.bodyControls).frameLoadSuccess&&(Object(Yb.a)(Object,this.Rca.bodyControls).frameLoadSuccess=lc),Gc!==this.Rca.dialogButtonsOption&&(this.Rca.dialogButtonsOption=null,this.Bh=Gc),this.update(this.Rca))}vNk(Pa,lc){const Gc=
new Ca.a(yb.a.DFk);Pa={["signInLabel"]:Object(wc.a)("SignIn"),["cancelLabel"]:Object(wc.a)("DialogCancel"),["rtl"]:Ia.AFrameworkApplication.isRtl,["messageCorrelationId"]:Pa,["dialogStyles"]:lc};Gc.Values=Pa;this.VE.hia(Gc,this.PC.contentWindow,this.g3)}Cyf(){this.F8a(!0,!1,6)}get xOg(){return this.PC}get gbi(){return this.Dgh.then(Pa=>{this.hHe=!0;return Pa})}get hbi(){return this.hHe}}Object(w.a)(dd,"SharedAuthConsentDialog",Ea.a,[910]);var vd=a(1048),Zd=a(107),Re=a(201),ff=a(188);class af{}af.kw=
"OAuthManager";Object(w.a)(af,"OAuthManagerConstants",null,[]);class xf{constructor(){this.PC=null;this.Gdc=0;this.T2=this.ccb=this.D5c=this.dSa=this.IW=this.KWe=null;this.RRj=()=>{const Pa=oc.a.rj()-this.Gdc;l.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",Pa)};this.fNc=Pa=>{const lc=oc.a.rj()-this.Gdc,Gc=Object.assign({},{durationMs:lc});Zd.Health.instance.recordKpiFailure(af.kw,"SharedAuthWACOAuthAspxFrameError",!1,!0,Gc);l.ULS.sendTraceTag(572346567,3E3,
10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",lc,this.YHe?JSON.stringify(Pa):"")};this.kWj=Pa=>{const lc=this.rda.loadFrame;var Gc=oc.a.rj()-lc.startTime,Cd=Pa.Values.AuthLibrary.toString();Pa=Pa.Values.Success.toString();l.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",Pa,Cd,Gc);Cd&&(this.Nbb="SharedAuthTokenStrategy "+Cd);Cd=Boolean.parse(Pa);Cd||(Pa=Re.a.ey(),void 0!==Pa&&null!==Pa&&(Pa.set("AuthLibrary",this.LQb()),
Gc=Object.assign({},{durationMs:Gc,extendedProperties:Pa}),Zd.Health.instance.recordKpiFailure(af.kw,"SharedAuthStrategyInitFailed",!1,!0,Gc)));lc.resolve(Cd?0:1)};this.jWj=Pa=>{if(Pa.Values.interactive&&this.ccb&&this.ccb.Values.messageCorrelationId){const Gc=this.ccb.Values.messageCorrelationId.toString();if(Pa.Values.interactive&&this.IW){this.IW.gbi.then(Cd=>{this.VE.hia(this.ccb,this.IW.xOg.contentWindow,this.g3);this.IW.vNk(Gc,Cd);this.IW.F8a(!0,!0);this.ccb=null});return}}Pa=this.rda.initFrame;
const lc=oc.a.rj()-Pa.startTime;l.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",lc);Pa.resolve(0)};this.rRj=Pa=>{if(Pa.Values.messageCorrelationId&&Pa.Values.messageCorrelationId.toString()){var lc=Pa.Values.messageCorrelationId.toString(),Gc=this.rda[lc];if(Gc){var Cd=oc.a.rj()-Gc.startTime;l.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",Cd);Pa.Values.isSuccess&&Pa.Values.isSuccess?Gc.resolve(Pa.Values.response):
Gc.reject(Pa.Values.response);this.L_g(lc)}else l.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else l.ULS.sendTraceTag(573112904,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")};this.oSj=()=>{if(this.IW.hbi)this.IW.Cyf();else if(this.D5c&&this.IW){const Pa=new Ca.a(yb.a.AOg);Pa.Values=this.w6e(this.D5c,!0);this.VE.hia(Pa,this.IW.xOg.contentWindow,this.g3)}};this.LRj=()=>
{this.IW&&this.IW.Tkb()};this.ZLj=Pa=>{if(Pa.Values.cancelled&&Pa.Values.cancelled&&Pa.Values.messageCorrelationId){Pa=Pa.Values.messageCorrelationId.toString();const lc=this.rda[Pa];if(lc){const Gc=new od.a;Gc.ErrorCode="UserCancelled";Gc.ErrorMessage="The interactive flow was cancelled by the user";lc.reject(Gc)}this.L_g(Pa)}this.IW&&this.IW.hide()};this.cTj=Pa=>{if(Pa.Values.messageCorrelationId&&Pa.Values.messageCorrelationId.toString()){var lc=this.rda[Pa.Values.messageCorrelationId.toString()];
if(lc){var Gc=oc.a.rj()-lc.startTime;l.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",Gc);Pa.Values.isSuccess&&Pa.Values.isSuccess?lc.resolve(Pa.Values.response):lc.reject(Pa.Values.response)}else l.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else l.ULS.sendTraceTag(555049439,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")};this.VE=
new vd.a(null,null);this.Nbb="SharedAuthTokenStrategy Unloaded";this.g3=md.a.BFk;this.HUe=md.a.AFk;md.a.Mne&&""!==md.a.Mne&&(this.IUe=this.g3+md.a.Mne);this.YHe=md.a.enableConsoleLogging;this.$gh=Ia.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",!1);this.wph=Ia.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",!1);this.nrh=Ia.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedWebWorkerEnabled",
!1);this.lrh=Ia.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedMsalV3Enabled",!1);this.rda={};this.yjh=new tf(1500)}LQb(){return this.Nbb}initialize(){if("loadFrame"in this.rda)return this.rda.loadFrame.zmc;if(!this.g3)return Zd.Health.instance.recordKpiFailure(af.kw,"SharedAuthFrameOriginNotSet",!1,!1,null),l.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);const Pa=this.fZc("loadFrame");this.Gdc=
oc.a.rj();var lc=this.g3+this.HUe+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+Ia.AFrameworkApplication.userSessionId+"&WacUserType="+Ia.AFrameworkApplication.userType;this.lrh?lc+="&msalv3=1":this.nrh&&(lc+="&webworker=1");this.PC=document.createElement("iframe");this.dxa(this.PC);this.PC.style.cssText="height:0;width:0;display:none;";this.PC.id="SharedAuthFrame";this.PC.setAttribute("name","SharedAuthFrame");this.PC.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");
this.PC.src=lc;document.body.appendChild(this.PC);lc=oc.a.rj()-this.Gdc;l.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}.",lc,this.PC.src);return Pa}uJc(Pa){this.D5c=Pa;const lc=new Ca.a(yb.a.AOg);lc.Values=this.w6e(Pa);Pa=this.fZc("initFrame");this.VE.hia(lc,this.PC.contentWindow,this.g3);l.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return Pa}JD(Pa,lc,Gc,Cd,Qd,ge){const ye=
new Ca.a(yb.a.EFk),$e=this.YHf();ye.Values=this.B_g(Pa,lc,Gc,Cd,Qd,ge,$e);Pa=this.fZc($e);Cd?(ge&&0!=ge.length||(ge=Object(wc.a)("WAC_OAuth_CompleteSignIn_Body")),this.yjh.enqueue(()=>new Promise(qf=>{this.Q_k(ge,ye,qf,$e)}))):(this.VE.hia(ye,this.PC.contentWindow,this.g3),l.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",lc));return Pa}Q_k(Pa,lc,Gc,Cd){const Qd=this.rda[Cd];Qd&&(this.ccb=lc,this.dSa=Object.assign(new Qe,{resolve:Gc,correlationId:Cd}),
this.IW=new dd(this.g3,this.HUe,Pa,this.VE,Qd,Gc),this.IW.Rpe())}YHf(){return ff.a.create().toString()}B_g(Pa,lc,Gc,Cd,Qd,ge,ye){const $e={};$e.appName=Pa;$e.appId=lc;$e.target=Gc;$e.withPopup=Cd;$e.claims=Qd;$e.promptMessage=ge;$e.messageCorrelationId=ye;return $e}dxa(Pa){$addHandler(Pa,"load",this.RRj);$addHandler(Pa,"error",this.fNc);this.VE.PW(this.g3);this.VE.Tq(yb.a.DOg);this.VE.Ip(yb.a.DOg,this.kWj);this.VE.Tq(yb.a.COg);this.VE.Ip(yb.a.COg,this.jWj);this.VE.Tq(yb.a.yOg);this.VE.Ip(yb.a.yOg,
this.rRj);this.VE.Tq(yb.a.EOg);this.VE.Ip(yb.a.EOg,this.cTj);this.VE.Tq(yb.a.BOg);this.VE.Ip(yb.a.BOg,this.oSj);this.VE.Tq(yb.a.zOg);this.VE.Ip(yb.a.zOg,this.LRj);this.VE.Tq(yb.a.wOg);this.VE.Ip(yb.a.wOg,this.ZLj)}fZc(Pa){const lc=new gf;lc.startTime=oc.a.rj();const Gc=new Promise((Cd,Qd)=>{lc.resolve=Cd;lc.reject=Qd});lc.zmc=Gc;this.rda[Pa]=lc;return Gc}w6e(Pa,lc){lc=void 0===lc?!1:lc;const Gc={};Gc.appIds=this.ACi();Gc.upn=Pa.loginHint;Gc.authority=Pa.authority;Gc.authorityType=Object(Bc.a)(zc,
Pa.authorityType);Gc.tenantId=Pa.tenantId;Gc.correlationId=Ia.AFrameworkApplication.userSessionId;Gc.enableConsoleLogging=this.YHe;Gc.enablePopupFlash=this.$gh;Gc.skipUpnCheck=this.wph;Gc.interactive=lc;this.IUe&&(Gc.redirectUri=this.IUe);return Gc}ACi(){const Pa=[],lc=md.a.yod;for(const Cd in lc){var Gc=lc[Cd];Array.contains(Pa,Gc)||Array.add(Pa,Gc)}return Pa}g0c(Pa,lc,Gc,Cd,Qd,ge){const ye=new Ca.a(yb.a.CFk),$e=this.YHf();ye.Values=this.B_g(Pa,lc,Gc,Cd,Qd,ge,$e);this.KWe=ye;Pa=this.fZc($e);l.ULS.sendTraceTag(555049437,
3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",lc);this.GKk($e);return Pa}AZc(){return!0}dCc(){var Pa;this.T2&&(null===(Pa=Ia.AFrameworkApplication.ra.businessBar)||void 0===Pa?void 0:Pa.removeEntry(this.T2))}GKk(Pa){if(!this.T2){this.T2=new Pe.a(Object(wc.a)("WAC_OAuth_CompleteSignIn_Title"),Object(wc.a)("WAC_OAuth_CompleteSignIn_Body"),null);this.T2.id=16;this.T2.gVd=!1;this.T2.nqd=0;this.T2.closeable=!0;var lc=!1;this.T2.iX=()=>{if(!lc){const Gc=this.rda[Pa];if(Gc){const Cd=
new od.a;Cd.ErrorCode="UserCancelled";Cd.ErrorMessage="The interactive flow was cancelled by the user";Gc.reject(Cd)}}};this.T2.addButton(Object(wc.a)("WAC_OAuth_CompleteSignIn_Button"),()=>{l.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");lc=!0;this.VE.hia(this.KWe,this.PC.contentWindow,this.g3);this.T2=void 0},Object(wc.a)("WAC_OAuth_CompleteSignIn_Button"),!0);if(!Ia.AFrameworkApplication.ra.$d.Hjc(this.T2)){l.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user.");
this.T2=void 0;const Gc=this.rda[Pa];if(Gc){const Cd=new od.a;Cd.ErrorCode="Cookies Disabled";Cd.ErrorMessage="Interaction Required - Current App Context does not support Business Bar";Gc.reject(Cd)}}}}L_g(Pa){this.dSa&&this.dSa.correlationId===Pa&&(this.dSa.resolve(null),this.dSa=null)}}Object(w.a)(xf,"SharedAuthTokenStrategy",null,[899]);class eg{constructor(Pa){this.Yfd=Pa;this.Nbb="UnsupportedAuthTokenStrategy Reason="+Ob[this.Yfd]}initialize(){return Promise.resolve(0)}uJc(){return Promise.resolve(0)}JD(){return Promise.resolve(Object.assign(new od.a,
{IsSuccess:!1,ErrorCode:Ob[this.Yfd],ErrorMessage:"Unable to get a token. Reason: ["+Ob[this.Yfd]+"]"}))}g0c(){return Promise.resolve(Object.assign(new od.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}dCc(){}AZc(){return!1}LQb(){return this.Nbb}}Object(w.a)(eg,"UnsupportedAuthTokenStrategy",null,[899]);var Ab=a(908),xc=a(354);class eb{constructor(Pa){Pa=void 0===Pa?null:Pa;this.aQ=
0;this.ZS=null;this.Snh=0;this.gMe=!!window.location.search.match(RegExp("wdpa=1","gi"));const lc=oc.a.rj();var Gc=new od.a;Gc.ErrorCode=eb.L3c;this.ngd=Promise.resolve(Gc);const Cd=new gf;Cd.startTime=oc.a.rj();Gc=new Promise((Qd,ge)=>{Cd.resolve=Qd;Cd.reject=ge});Cd.zmc=Gc;this.NRe=Cd;this.njh=this.xai(Pa).then(Qd=>Qd?this.w8i():(l.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.VA(),Math.floor(oc.a.rj()-lc)),
Qd=Re.a.ey(),void 0!==Qd&&null!==Qd&&(Qd.set("AuthLibrary",this.VA()),Qd=Object.assign({},{durationMs:Math.floor(oc.a.rj()-lc),extendedProperties:Qd}),Zd.Health.instance.recordKpiFailure(af.kw,"StrategyPickFailed",!1,!0,Qd)),Promise.resolve(1))).then(Qd=>0!==Qd?Promise.resolve(Qd):this.Yuj())}yai(){if(this.gMe)this.aQ=5,this.ZS=new eg(this.aQ);else{var Pa=md.a.AEj;Pa&&0<Pa.length?(this.aQ=1,this.ZS=new ce(Pa)):Ia.AFrameworkApplication.fa.la("IsO365ConsumerHost")||Ia.AFrameworkApplication.fa.la("IsO365CommercialHost")?
Ia.AFrameworkApplication.fa.la("IsAnonymousUser")?(this.aQ=2,this.ZS=new eg(this.aQ)):(Pa=Qb.a.getAuthContext().loginHint)&&Pa.length?md.a.cSb?(this.aQ=1,this.ZS=new me):(this.aQ=1,this.ZS=new xf):(this.aQ=3,this.ZS=new eg(this.aQ)):(this.aQ=4,this.ZS=new eg(this.aQ))}}VA(){return this.ZS?this.ZS.LQb()||"Unknown":"None"}xai(Pa){Pa=void 0===Pa?null:Pa;l.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const lc=oc.a.rj();return Ia.AFrameworkApplication.fa.zJd().then(Gc=>{Gc?(this.yai(),Pa&&
(this.ZS=Pa),l.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",md.a.clientVersion,md.a.appVersion,md.a.xdi,this.VA(),Math.floor(oc.a.rj()-lc))):l.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(oc.a.rj()-lc));return Promise.resolve(Gc)},()=>{l.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",
Math.floor(oc.a.rj()-lc));return Promise.resolve(!1)})}w8i(){l.ULS.sendTraceTag(573390991,3E3,50,"Initializing {0}",this.VA());const Pa=oc.a.rj();return Xc.get(this.ZS.initialize(),2,md.a.kce).then(lc=>{if(0===lc)l.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",this.VA(),Math.floor(oc.a.rj()-Pa));else if(1===lc){l.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.VA(),Math.floor(oc.a.rj()-Pa));
var Gc=Re.a.ey();void 0!==Gc&&null!==Gc&&(Gc.set("AuthLibrary",this.VA()),Gc=Object.assign({},{durationMs:Math.floor(oc.a.rj()-Pa),extendedProperties:Gc}),Zd.Health.instance.recordKpiFailure(af.kw,"StrategyInitFailed",!1,!0,Gc))}else 2===lc&&(l.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.VA(),Math.floor(oc.a.rj()-Pa)),Gc=Re.a.ey(),void 0!==Gc&&null!==Gc&&(Gc.set("AuthLibrary",this.VA()),Gc=Object.assign({},{durationMs:Math.floor(oc.a.rj()-
Pa),extendedProperties:Gc}),Zd.Health.instance.recordKpiFailure(af.kw,"StrategyInitTimedOut",!1,!0,Gc)));return Promise.resolve(lc)},()=>{l.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.VA(),Math.floor(oc.a.rj()-Pa));return Promise.resolve(1)})}Yuj(){l.ULS.sendTraceTag(562128581,3E3,50,"Loading {0}",this.VA());const Pa=oc.a.rj();return Xc.get(this.ZS.uJc(Qb.a.getAuthContext()),2,md.a.kce).then(lc=>{if(0===lc)l.ULS.sendTraceTag(562128582,
3E3,50,"Load succeeded for {0} in {1} ms.",this.VA(),Math.floor(oc.a.rj()-Pa));else if(1===lc){l.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.VA(),Math.floor(oc.a.rj()-Pa));var Gc=Re.a.ey();void 0!==Gc&&null!==Gc&&(Gc.set("AuthLibrary",this.VA()),Gc=Object.assign({},{durationMs:Math.floor(oc.a.rj()-Pa),extendedProperties:Gc}),Zd.Health.instance.recordKpiFailure(af.kw,"StrategyLoadFailed",!1,!0,Gc))}else 2===lc&&(l.ULS.sendTraceTag(558469660,
3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.VA(),Math.floor(oc.a.rj()-Pa)),Gc=Re.a.ey(),void 0!==Gc&&null!==Gc&&(Gc.set("AuthLibrary",this.VA()),Gc=Object.assign({},{durationMs:Math.floor(oc.a.rj()-Pa),extendedProperties:Gc}),Zd.Health.instance.recordKpiFailure(af.kw,"StrategyLoadTimedOut",!1,!0,Gc)));return Promise.resolve(lc)},()=>{l.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",
this.VA(),Math.floor(oc.a.rj()-Pa));return Promise.resolve(1)})}JD(Pa,lc,Gc,Cd){return this.HPa(Pa,lc,!1,Cd,"",void 0===Gc?null:Gc)}e0c(Pa,lc,Gc,Cd,Qd){return this.HPa(Pa,lc,!0,Gc,Cd,void 0===Qd?null:Qd)}HPa(Pa,lc,Gc,Cd,Qd,ge,ye,$e){ye=void 0===ye?0:ye;$e=void 0===$e?0:$e;ye+=1;l.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",Pa,this.U5a(Pa,lc),this.VA(),ye);var qf=Re.a.ey();void 0!==qf&&null!==qf&&(qf.set("AuthLibrary",
this.VA()),qf.set("AppName",Pa),qf.set("Target",this.U5a(Pa,lc)),Zd.Health.instance.recordKpiUsage(af.kw,xc.b.FailureBased,"WacOAuthFC",qf));if(!md.a.isEnabled||this.gMe){var h;return this.l0d((h=new od.a,h.IsSuccess=!1,h.Token=null,h.ErrorCode="NotEnabled",h.ErrorMessage="OAuthManager is disabled.",h),Pa)}const Z=md.a.yod[Pa];if(void 0===Z||null===Z){l.ULS.sendTraceTag(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",Pa);var E;
return this.l0d((E=new od.a,E.IsSuccess=!1,E.Token=null,E.ErrorCode="DisallowedApp",E.ErrorMessage="Disallowed appName: "+Pa,E),Pa)}const aa=oc.a.rj();let Ja=aa;const tb=this;qf=this.njh.then(hc=>{Ja=oc.a.rj();return tb.Jdj(Pa,Z,lc,1==ye?!1:Gc,Cd,Qd,ge,hc)});h=Gc?0:md.a.kce;let S;E=(S=new od.a,S.IsSuccess=!1,S.Token=null,S.ErrorCode="authTokenStrategy_timeout",S.ErrorMessage="Auth Strategy timed out after ["+h+"] ms when fetching token",S);const Wa=this,zb=this;return Xc.get(qf,E,h).then(hc=>{if(ye<=
eb.$Cj&&(hc.ErrorCode===eb.hCe||hc.ErrorCode===eb.oHh))return l.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",ye,Math.floor(oc.a.rj()-aa)),Wa.HPa(Pa,lc,Gc,Cd,Qd,ge,ye,$e|4);if(hc.ErrorCode===eb.g4c||hc.ErrorCode===eb.iac){l.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken failed with ITP error.  Fallback Flow Enabled: [{0}], Popup Requested [{1}]",eb.tpf,Gc);if(Gc)return Wa.HPa(Pa,lc,!0,Cd,Qd,ge,ye,$e|32);if(eb.Icj(Z))return this.ngd=this.ngd.then(cd=>
{if(cd.IsSuccess)return Wa.HPa(Pa,lc,Gc,Cd,Qd,ge,ye,$e|8);if(cd.ErrorCode===eb.L3c||cd.ErrorCode===eb.g4c)return Wa.kTf(Pa,Z,lc,Gc,Cd,Qd,ge,aa,Ja,$e|16).then(ta=>ta.ErrorCode===eb.iac?Wa.HPa(Pa,lc,!0,Cd,Qd,ge,ye,$e|32):ta);if(cd.ErrorCode===eb.iac)return Wa.HPa(Pa,lc,!0,Cd,Qd,ge,ye,$e|32);if(cd.ErrorCode===eb.mCe)return cd}).catch(()=>Wa.kTf(Pa,Z,lc,Gc,Cd,Qd,ge,aa,Ja,$e))}return Promise.resolve(Wa.QJc(hc,Pa,lc,Z,aa,Ja,$e,ye))}).catch(()=>{let hc;const cd=(hc=new od.a,hc.IsSuccess=!1,hc.Token=null,
hc.ErrorCode="authTokenStrategy_failure",hc.ErrorMessage="Auth Strategy failed with an unknown error",hc);return Promise.resolve(zb.QJc(cd,Pa,lc,Z,aa,Ja,$e,ye))})}kTf(Pa,lc,Gc,Cd,Qd,ge,ye,$e,qf,h){const Z=new od.a;Z.IsSuccess=!1;if(!this.ZS.AZc())return Z.ErrorCode="authTokenStrategy_loginNotSupported",Z.ErrorMessage="This Token Strategy does not support login flow, TryLogin could not be completed",Promise.resolve(Z);const E=this.ZS.g0c(Pa,lc,Gc,Cd,Qd,ge).then(Ja=>Promise.resolve(this.LLc(Ja,!0,Pa))).catch(Ja=>
Promise.resolve(this.LLc(Ja,!1,Pa))).then(Ja=>{h|=16;return Promise.resolve(this.QJc(Ja,Pa,Gc,lc,$e,qf,h))}).catch(()=>{Z.ErrorCode="authTokenStrategy_failure";Z.ErrorMessage="LoginPopup failed, GetToken could not be called";h|=16;return Promise.resolve(this.QJc(Z,Pa,Gc,lc,$e,qf,h))}),aa=this.NRe.zmc.then(()=>this.HPa(Pa,Gc,Cd,Qd,ge,ye,0,h|8));return Promise.race([aa,E])}Jdj(Pa,lc,Gc,Cd,Qd,ge,ye,$e){return 1===$e||2===$e?this.l0d(Object.assign(new od.a,{IsSuccess:!1,Token:null,ErrorCode:1===$e?"InitFailed":
"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),Pa):this.ZS.JD(Pa,lc,Gc,Cd,Qd,ge,ye).then(qf=>{if(Cd){const h=new od.a;h.IsSuccess=!0;this.ZS.dCc();this.NRe.resolve(h)}return Promise.resolve(this.LLc(qf,!0,Pa))}).catch(qf=>Promise.resolve(this.LLc(qf,!1,Pa)))}QJc(Pa,lc,Gc,Cd,Qd,ge,ye,$e){ye=void 0===ye?0:ye;$e=void 0===$e?0:$e;var qf;const h={},Z=oc.a.rj()-ge;h.IsSuccess=Pa.IsSuccess;h.ErrorCode=Pa.IsSuccess?"Success":Pa.ErrorCode||"";h.ErrorMessage=Pa.IsSuccess?"Success":this.U5a(lc,
Pa.ErrorMessage||"");h.Target=this.U5a(lc,Gc||"");h.TimeInMS=Math.floor(Z);h.LoadTimeInMS=Math.floor(ge-Qd);h.AuthLibrary=this.VA();h.AppName=lc;h.AuthorityType=Object(Bc.a)(zc,Qb.a.Gxc());h.UserType=this.XXi(Qb.a.getAuthContext());h.IsAuthSupportedInSession=Ob[this.aQ];h.RequestCount=++this.Snh;h.AppId=Cd;h.RetryCount=$e;Pa.IsSuccess&&(ye=(null===(qf=Pa.Telemetry)||void 0===qf?0:qf.fromCache)?ye|1:ye|2);h.Type=ye;l.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(h));Gc=Re.a.ey();Pa.IsSuccess?void 0!==
Gc&&null!==Gc&&(Gc.set("AppName",lc),Gc.set("AuthLibrary",this.VA()),Gc.set("RetryCount",$e.toString()),Gc.set("Type",ye.toString()),lc=Object.assign({},{durationMs:Z,extendedProperties:Gc}),Zd.Health.instance.recordKpiSuccess(af.kw,lc)):void 0!==Gc&&null!==Gc&&(Gc.set("AppName",lc),Gc.set("AuthLibrary",this.VA()),Gc.set("ErrorCode",Pa.ErrorCode),Gc.set("ErrorMessage",this.U5a(lc,Pa.ErrorMessage)),Gc.set("Type",ye.toString()),lc=Object.assign({},{durationMs:Z,extendedProperties:Gc}),Zd.Health.instance.recordKpiFailure(af.kw,
"TryGetTokenFailure",!1,!0,lc));return Pa}l0d(Pa,lc){l.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",lc,this.U5a(lc,Pa.ErrorMessage));const Gc=Re.a.ey();void 0!==Gc&&null!==Gc&&(Gc.set("AppName",lc),Gc.set("AuthLibrary",this.VA()),Gc.set("ErrorCode",Pa.ErrorCode),Gc.set("ErrorMessage",this.U5a(lc,Pa.ErrorMessage)),lc=Object.assign({},{extendedProperties:Gc}),Zd.Health.instance.recordKpiFailure(af.kw,"FailureBeforeGetToken",!1,!0,lc));
return Promise.resolve(Pa)}rWf(Pa){return Pa===Ab.a.Nwb}U5a(Pa,lc){return this.rWf(Pa)&&lc?"REDACTED":lc}XXi(Pa){return Ia.AFrameworkApplication.fa.la("IsAnonymousUser")?"anonymous":!Pa.loginHint||1>Pa.loginHint.length?"empty":-1<Pa.loginHint.indexOf("guest#")?"guest":-1<Pa.loginHint.indexOf("ext#")?"external":0>Pa.upn.indexOf("@")?"no-at":"supported"}D_a(){return 1===this.aQ}LLc(Pa,lc,Gc){let Cd=null,Qd=null,ge=null,ye=null;Pa?Pa.ErrorCode||Pa.ErrorMessage?(Qd=Pa.ErrorCode?Pa.ErrorCode:eb.B3c,ge=
Pa.ErrorMessage?Pa.ErrorMessage:"No message"):Pa.errorCode||Pa.errorMessage?(Qd=Pa.errorCode?Pa.errorCode:eb.B3c,ge=Pa.errorMessage?Pa.errorMessage:"No message"):Pa.Token?lc?Cd=Pa.Token:(Qd=eb.vah,ge="A rejected promise returned a token."):(Qd=eb.B3c,ge=JSON.stringify(Pa)):(Qd=eb.L3c,ge="No result came from Auth Token Strategy");Pa&&Pa.Telemetry&&!this.rWf(Gc)&&(ye=Pa.Telemetry,l.ULS.sendTraceTag(579166408,3E3,50,JSON.stringify(ye)));if(Qd===eb.kHh||Qd===eb.mHh)Qd=eb.hCe,ge="Auth Library Timed Out";
Qd===eb.iHh&&(Qd=eb.g4c);if(Qd===eb.lHh||Qd===eb.hHh||Qd===eb.jHh)Qd=eb.iac;Qd===eb.nHh&&(Qd=eb.mCe);if(Qd||ge)Cd=null;return Object.assign(new od.a,{IsSuccess:!!Cd,Token:Cd,ErrorCode:Qd,ErrorMessage:ge,Telemetry:ye})}static Icj(Pa){return eb.tpf&&"243c63a3-247d-41c5-9d83-7788c43f1c43"===Pa}static get tpf(){return Ia.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}}eb.mHh="token_renewal_error";eb.kHh="monitor_window_timeout";eb.iHh=
"login_required";eb.lHh="popup_window_error";eb.hHh="consent_required";eb.jHh="invalid_grant";eb.nHh="user_cancelled";eb.oHh="authTokenStrategy_timeout";eb.hCe="Timeout";eb.g4c="Cookies Disabled";eb.iac="UserInteractionRequired";eb.B3c="Exception";eb.L3c="NoResult";eb.vah="RejectToken";eb.mCe="UserCancelled";eb.$Cj=2;Object(w.a)(eb,"OAuthManager",null,[872]);var Ub=a(278),Fc=a(81),rd=a(94),Gd=a(106);class ue{F0k(Pa){if(Pa&&Ia.AFrameworkApplication.fa&&Ia.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.WacTokenValidation",
!1)){Pa=Pa.startsWith("Bearer ")?Pa:"Bearer "+Pa;var lc=md.a.pWa.Endpoint;if(lc){var Gc=oc.a.rj();Pa={["Authorization"]:Pa};var Cd=new Gd.a;Cd.add("IsSpoWacToken","1");lc=Fc.a.r_e(lc,Cd);Ia.AFrameworkApplication.$i.$Ta(lc,1,null,Pa,"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(Qd=>{var ge=Math.floor(oc.a.rj()-Gc),ye=null;Qd.Sn?Qd="Canceled":Qd.om?Qd="Faulted":(ye=Qd.result,Qd=ye.succeeded?"Completed":"Failed");ge={["TaskResult"]:Qd,["BrowserValidationDurationMS"]:ge};ye&&(ge.HttpStatus=
ye.$n.data.httpStatus,ye.succeeded&&(ye=Nf.a(ye.$n.data.responseData),ge.ServerValidationDurationMS=ye.ElapsedMilliseconds,ge.ServerValidationResult=ye.ValidatedToken,ge.KMSI=ye.KMSI,ge.Scopes=ye.Scopes,ge.TokenExpiration=Math.floor(parseInt(ye.Expiration)-(new Date).getTime()/1E3)));l.ULS.sendTraceTag(507639839,3E3,"Completed"===Qd?20:15,rd.a.toJSON(ge))})}}}}Object(w.a)(ue,"WacTokenValidator",null,[873]);class Ce{tdk(Pa,lc){let Gc=Ce.jBe;lc&&(Gc=1E3*lc-Date.now()-Ce.jBe);l.ULS.sendTraceTag(507524500,
3E3,50,"Core Token Refresh: Scheduling Refresh in {0} ms",Gc);setTimeout(()=>{this.HCf(Pa)},Gc)}HCf(Pa){return Pa.JD("Core",Ce.JAe).then(lc=>{var Gc,Cd;const Qd=lc.IsSuccess,ge=null===(Gc=lc.Telemetry)||void 0===Gc?void 0:Gc.expiresOn;Gc=!1;if(lc.IsSuccess){const ye="Bearer "+lc.Token;Gc=Ia.AFrameworkApplication.$i.Cca!==ye;Ia.AFrameworkApplication.$i.Cca=ye}l.ULS.sendTraceTag(507524499,3E3,50,"Core Token Fetch: Success={0}, ExpirationTime={1}, FetchedNewToken={2}",Qd,ge,Gc);this.tdk(Pa,null===(Cd=
lc.Telemetry)||void 0===Cd?void 0:Cd.expiresOn);return lc})}get name(){return"Common.App.OAuth.OAuthPackage"}ao(Pa){Pa.register(872,"Common.App.OAuth.IOAuthManager").hi().mi(()=>new eb);Pa.register(873,"Common.App.OAuth.IWacTokenValidator").hi().mi(()=>new ue)}init(){const Pa=Object(Nb.a)();wa.a.instance.resolve("Common.App.OAuth.IWacTokenValidator");this.C0k(Pa);this.B0k(Pa)}B0k(Pa){if(Ia.AFrameworkApplication.fa&&Ia.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthTokenWithCAEClaimTestEnabled",
!1)){var lc=Ia.AFrameworkApplication.fa.Xa("FileSource");if(Ia.AFrameworkApplication.fa.la("IsO365ConsumerHost")||Ia.AFrameworkApplication.fa.la("IsO365CommercialHost")||"WopiTest"===lc){var Gc=md.a.pWa;if(Gc&&Gc.IsEnabled){var Cd=Gc.Application,Qd=md.a.authority;if(void 0!==Cd&&null!==Cd&&Cd.length&&void 0!==Qd&&null!==Qd&&Qd.length){var ge=Ob[Pa.aQ],ye=u.a.K9,$e=Pa.VA();Qd=JSON.stringify({Lgl:{["xms_cc"]:{values:["cp1"]}}});var qf=oc.a.rj();Pa.JD("CAETest",Cd,null,Qd).then(h=>{const Z=Math.floor(oc.a.rj()-
qf);ge=Ob[Pa.aQ];ye=u.a.K9;$e=Pa.VA();l.ULS.sendTraceTag(508950355,3E3,50,'OAuthManager attempted to get a CAE test token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',Z,h.IsSuccess,ge,h.ErrorCode,lc,ye,$e);if(h.IsSuccess){h="Bearer "+h.Token;var E=Gc.Endpoint;if(E){var aa=oc.a.rj();h={["Authorization"]:h};var Ja=new Gd.a;Ja.add("EnforceCAE","1");Ja.add("IsCAEToken","1");E=Fc.a.r_e(E,Ja);Ia.AFrameworkApplication.$i.$Ta(E,
1,null,h,"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(tb=>{var S,Wa=Math.floor(oc.a.rj()-aa),zb=null;tb.Sn?tb="Canceled":tb.om?tb="Faulted":(zb=tb.result,tb=zb.succeeded?"Completed":"Failed");Wa={["TaskResult"]:tb,["BrowserTokenDurationMS"]:Z,["BrowserValidationDurationMS"]:Wa};zb&&(Wa.HttpStatus=zb.$n.data.httpStatus,zb.succeeded&&(zb=Nf.a(zb.$n.data.responseData),Wa.ServerValidationDurationMS=zb.ElapsedMilliseconds,Wa.ServerValidationResult=zb.ValidatedToken,Wa.KMSI=zb.KMSI,
Wa.Scopes=zb.Scopes,Wa.TokenExpirationS=Math.floor(parseInt(zb.Expiration)-(new Date).getTime()/1E3),Wa.ClaimChallenge=null===(S=zb.ClaimChallenge)||void 0===S?void 0:S.length));l.ULS.sendTraceTag(508950354,3E3,"Completed"===tb?50:15,rd.a.toJSON(Wa))})}}else l.ULS.sendTraceTag(508950353,3E3,15,"ValidateAccess Failed: ErrorCode: {0}, ErrorMessage: {1}",h.ErrorCode,h.ErrorMessage)}).catch(h=>{const Z=Math.floor(oc.a.rj()-qf);l.ULS.sendTraceTag(508950352,3E3,15,"UNEXPECTED CATCH: {0}, duration: {1}",
h.toString(),Z)})}}}}}C0k(Pa){const lc=Ia.AFrameworkApplication.fa.Xa("FileSource");if(Ia.AFrameworkApplication.fa.la("IsO365ConsumerHost")||Ia.AFrameworkApplication.fa.la("IsO365CommercialHost")||"WopiTest"===lc){var Gc=md.a.pWa;if(Gc&&Gc.IsEnabled){var Cd=Gc.Application,Qd=md.a.authority;if(void 0!==Cd&&null!==Cd&&Cd.length&&void 0!==Qd&&null!==Qd&&Qd.length){Ce.JAe=Cd;var ge=Ob[Pa.aQ],ye=u.a.K9,$e=Pa.VA();try{var qf=new Map;void 0!==qf&&null!==qf?(qf.set("SupportStatus",ge),qf.set("Browser",ye),
qf.set("AuthStrategy",$e)):qf=null}catch(Z){qf=null}Zd.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",qf);var h=oc.a.rj();(Ia.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthCorePFTRefreshEnabled",!0)?this.HCf(Pa):Pa.JD("Core",Cd)).then(Z=>{const E=Math.floor(oc.a.rj()-h);ge=Ob[Pa.aQ];ye=u.a.K9;$e=Pa.VA();l.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',
E,Z.IsSuccess,ge,Z.ErrorCode,lc,ye,$e);qf&&(qf.set("SupportStatus",ge),qf.set("Browser",ye),qf.set("AuthStrategy",$e));var aa=Object.assign({},{durationMs:E,extendedProperties:qf});if(Z.IsSuccess){if(Zd.Health.instance.recordKpiSuccess("WacCorePFT",aa),Z="Bearer "+Z.Token,Ia.AFrameworkApplication.$i.Cca=Z,aa=Gc.Endpoint){var Ja=oc.a.rj();Ia.AFrameworkApplication.$i.$Ta(aa,1,null,{["Authorization"]:Z},"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(tb=>{var S=Math.floor(oc.a.rj()-
Ja),Wa=null;tb.Sn?tb="Canceled":tb.om?tb="Faulted":(Wa=tb.result,tb=Wa.succeeded?"Completed":"Failed");S={["TaskResult"]:tb,["BrowserTokenDurationMS"]:E,["BrowserValidationDurationMS"]:S};Wa&&(S.HttpStatus=Wa.$n.data.httpStatus,Wa.succeeded&&(Wa=Nf.a(Wa.$n.data.responseData),S.ServerValidationDurationMS=Wa.ElapsedMilliseconds,S.ServerValidationResult=Wa.ValidatedToken,S.KMSI=Wa.KMSI,S.Scopes=Wa.Scopes,S.TokenExpirationS=Math.floor(parseInt(Wa.Expiration)-(new Date).getTime()/1E3)));l.ULS.sendTraceTag(520632322,
3E3,"Completed"===tb?50:15,rd.a.toJSON(S))})}}else Zd.Health.instance.recordKpiFailure("WacCorePFT",Z.ErrorCode,!1,!1,aa)}).catch(Z=>{var E=Math.floor(oc.a.rj()-h);E=Object.assign({},{durationMs:E,extendedProperties:qf});Zd.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+Z.toString(),!1,!1,E)})}}}}dispose(){}static main(){Ub.a.instance.Lo(new Ce)}}Ce.JAe="";Ce.jBe=3E5;Object(w.a)(Ce,"OAuthPackage",null,[12,13]);var Se=a(9),of=a(217),jf=a(245),bf=a(425),pf=a(897),Ud=a(1245);class Ff{constructor(Pa){this.sm=
()=>{this.a4f($b.a.bFa("excel-uiSlice20-sprite"));C.EwaSettings.fl()||this.$.ea.dv(this.sm)};this.$=Pa;this.uWg={};this.Use={};const lc=this.VEf("excelInitialAppSprite");lc?(this.S_e(lc),this.$.ea.Ul?this.a4f($b.a.bFa("excel-uiSlice20-sprite")):C.EwaSettings.fl()?Pa.ea.Jq(this.sm):Pa.ea.Uq(this.sm),this.$.ka.ph(388,this)):l.ULS.sendTraceTag(537151263,0,15,"window[excelInitialAppSprite].icons returned null.")}dispose(){this.Use=null;C.EwaSettings.fl()||this.$.ea.dv(this.sm)}kZa(Pa,lc,Gc,Cd){Gc=void 0===
Gc?null:Gc;Cd=void 0===Cd?null:Cd;let Qd;(Qd=this.Use[Pa])||(this.Use[Pa]=Qd=this.C1j(this.uWg[Pa]));if(!Qd)return l.ULS.shipAssertTag(537151262,0,!1,`SvgIconProvider.GetSvgElement: id ${Pa} was not found in loaded SVG sprites.`),null;const ge=Qd.cloneNode(!0);if(!ge.style){const ye=bf.b(Qd),$e=bf.b(ge),qf={};qf.iconId=Pa;qf.isOriginalNodeStyleNull=void 0===Qd.style||null===Qd.style;qf.isOriginalNodeCurrentStyleNull=void 0===Qd.currentStyle||null===Qd.currentStyle;qf.isClonedNodeCurrentStyleNull=
void 0===ge.currentStyle||null===ge.currentStyle;qf.originalNode=ye.substring(0,ye.indexOf(">")+1);qf.clonedNode=$e.substring(0,$e.indexOf(">")+1);l.ULS.sendTraceTag(537151261,0,10,`SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: ${JSON.stringify(qf)}`)}ge.setAttribute("style",`height: ${lc}px; width: ${lc}px;`);Cd&&(Pa=document.createElement("title"),Pa.textContent=Cd,ge.insertBefore(Pa,ge.childNodes[0]));if(Gc)for(const ye of Gc)C.EwaSettings.isChangeGateEnabled("OfficeVSO:8719525_RemoveIE11Hacks")?
ge.classList.add(ye):Sys.UI.DomElement.addCssClass(ge,ye);return ge}lna(Pa,lc,Gc,Cd,Qd,ge,ye,$e){Qd=void 0===Qd?0:Qd;ge=void 0===ge?0:ge;ye=void 0===ye?null:ye;$e=void 0===$e?null:$e;Qd&&ge||(ge=kb.DOMElementExtensions.getBoundingClientRect(Cd),Qd=ge.height,ge=ge.width);if(ye=this.kZa(Pa,lc,ye,$e))Cd.appendChild(ye),(Cd=kb.DOMElementExtensions.Gfa(ye,"style",null))?ye.setAttribute("style",Cd+` margin: ${(Qd-lc)/2}px ${(ge-Gc)/2}px;`):l.ULS.sendTraceTag(537151260,0,10,`SvgIconProvider.InsertAndCenterSvgElement: svgElement's GetAttribte("styl") returned null. Icon ID: ${Pa}`);
return ye}a4f(Pa){C.EwaSettings.isChangeGateEnabled("OfficeVSO:8428325_ExtractChunkLoading")?void Object(pf.a)(Pa,{va:0}).then(()=>this.R_e()):void W.a.resolve(N.Eb,{va:0}).then(lc=>lc(Pa)).then(()=>this.R_e())}R_e(){const Pa=this.VEf("excelUiSlice20Sprite");Pa?this.S_e(Pa):l.ULS.sendTraceTag(537151259,0,15,"window[excelUiSlice20Sprite].icons returned null.")}S_e(Pa){for(const lc of Pa)lc.type===jf.a.Sse&&(this.uWg[lc.id]=lc)}C1j(Pa){if(!Pa)return null;const lc=Pa.viewBox;Pa=Pa.children;const Gc=
document.createElementNS(of.a.lBa,jf.a.Sse);C.EwaSettings.isChangeGateEnabled("OfficeVSO:8719525_RemoveIE11Hacks")?Gc.classList.add("ewa-svg-icon"):Sys.UI.DomElement.addCssClass(Gc,"ewa-svg-icon");Gc.setAttribute("focusable","false");Gc.setAttribute("viewBox",lc);this.twh(Gc,Pa);return Gc}twh(Pa,lc){for(const Cd of lc){const Qd=document.createElementNS(of.a.lBa,Cd.type);for(const ge in Cd){lc=ge;var Gc=Cd[ge];"className"===lc?Qd.setAttribute("class",Gc):Qd.setAttribute(lc,Gc)}Pa.appendChild(Qd)}}VEf(Pa){return(Pa=
window[Pa])?Pa.icons:null}}Object(w.a)(Ff,"SvgIconProvider",null,[884,2]);String(Ud);window.___1708742462305_closurehack=Ud;class Uf extends gc.a{constructor(Pa){super();this.$=Pa;this.Bl()}create(){const Pa=[this.evj()];B.TaskExtensions.Ua(B.TaskExtensions.Ln(Pa,this.$.xa),()=>{window.excelInitialAppSprite?this.Yj(this.$.ka.Ug(388)||new Ff(this.$)):l.ULS.sendTraceTag(537151258,0,50,"window.[excelInitialAppSprite] returned null.")},this.xa,3)}evj(){let Pa=bb.a.XGb;Ia.AFrameworkApplication.fa.la("IsStringExperimentEnabled")&&
(Pa=bb.a.Alc);Pa=$b.a.bFa(Pa);return C.EwaSettings.isChangeGateEnabled("OfficeVSO:8428325_ExtractChunkLoading")?Object(If.d)(Object(pf.a)(Pa,{va:this.hh})):Object(If.d)(W.a.resolve(N.Eb,{va:this.hh}).then(lc=>No(function*(){return lc(Pa)})))}static Aa(Pa){Pa.ka.ph(387,new Uf(Pa))}}Object(w.a)(Uf,"SvgIconProviderFactory",gc.a,[]);var Gf=a(894);class lg extends Gf.a{constructor(Pa){super(Pa)}Qs(){void W.a.resolve(N.Ue,{va:this.hh}).then(()=>{B.TaskExtensions.Ua(C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateSheetTabBar",
!1)?Object(If.d)(W.a.resolve(N.Kf,{va:this.hh})):sc.GetServiceTaskFactory.Bj(this.$.ka,32,33,this.hh),Pa=>{this.cr([new ec(Pa.result)])},this.$.xa)})}static Aa(Pa){Gf.a.sx(392,new lg(Pa))}}Object(w.a)(lg,"SheetDropdownMenuCommandHandlerFactory",Gf.a,[]);Type.registerNamespace("Common.App.OAuth");Ce.main();C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveRequireFromSlices",!1)||a(1245);Se.a.Qg(Uf.Aa);(()=>{Se.a.Qg(Pa=>{a(1432);C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateSheetTabBar",
!1)||cf.Aa(Pa);N.Df.Ha()||lg.Aa(Pa)})})();String(c);String(b);String(f);String(r);String(d);String(k);String(t);String(m);window.___1708742503553_closurehack=c;window.___1708742503553_closurehack=b;window.___1708742503553_closurehack=f;window.___1708742503553_closurehack=r;window.___1708742503553_closurehack=d;window.___1708742503553_closurehack=k;window.___1708742503553_closurehack=t;window.___1708742503553_closurehack=m}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.vrs.js.map/ab6ec3e3260aba8597289f1d120ef305/EwaTS.vrs.js.map